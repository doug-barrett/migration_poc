fileVersion: 1
id: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
name: OPC_ACCOUNT
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: "FILTER ALL ACCOUNT RELATED EXCEPTIONS AT ONE PLACE."
  isMultisource: false
  locationName: OMNIA_CONNECT_OPC
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 667852d6-2359-424d-8d9d-cd2a7d10bb6d
          stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE HIGHEST-LEVEL OF HIERARCHY FOR AN ACCOUNT
        isBusinessKey: true
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2dafae34-a134-4231-bc7c-fd77a5d95582
                stepCounter: e6f00723-a598-4272-b25a-ed544e4c0a06
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a0c67b8-f809-4bfd-a87f-6669c341ef02
          stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE UNIQUE IDENTIFIER FOR AN ACCOUNT
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 349c7dc1-e387-4400-9038-4c5b022f35f8
                stepCounter: e6f00723-a598-4272-b25a-ed544e4c0a06
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05df5302-51b2-484f-ab2c-2b3753904f6f
          stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE SAME VALUE AS THE ACCOUNTNAME COLUMN, BUT HAS BEEN RUN THROUGH A PROPERCASE FUNCTION
        name: DISPLAYACCOUNTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 29f18007-a753-4033-bf87-959cfdfc2fa5
                stepCounter: e6f00723-a598-4272-b25a-ed544e4c0a06
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1346dedc-5849-4c0b-9fd6-7a150730c82d
          stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE TYPE, OR CLASSIFICATION, OF THE ACCOUNT
        name: ACCOUNTTYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2863456-3a38-496f-8edf-22f87ad9fabd
                stepCounter: e6f00723-a598-4272-b25a-ed544e4c0a06
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 60390977-b407-4e0f-91b7-04cf3b3805fe
          stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE FIRST LINE OF THE ACCOUNT'S STREET ADDRESS
        name: ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 359b0c52-158e-436f-9305-10c01358224b
                stepCounter: e6f00723-a598-4272-b25a-ed544e4c0a06
            transform: COALESCE(INITCAP(ACCOUNT.USPSADDRESS),'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c86bb5e1-b3d7-4c68-9abb-baebb0c6c52b
          stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE SECOND LINE OF THE ACCOUNT'S STREET ADDRESS, USUALLY THE SUITE, BUILDING, OR FLOOR
        name: ADDRESS2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cafe0ef3-5a5d-4d6e-a9e9-8cc335b74562
                stepCounter: e6f00723-a598-4272-b25a-ed544e4c0a06
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dd659638-db08-4f93-a762-dac2aced04b8
          stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE NAME OF THE CITY THE ACCOUNT IS LOCATED IN
        name: CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cc30f0a3-600a-45a1-af77-2b34eedd0af8
                stepCounter: e6f00723-a598-4272-b25a-ed544e4c0a06
            transform: COALESCE(ACCOUNT.USPSCITY,ACCOUNT.CITY,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4e40cfb-3d8c-4211-8464-70283e92a698
          stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE NAME OF THE COUNTY OR PARISH THE ACCOUNT IS LOCATED IN
        name: COUNTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1119fad5-08ae-4d14-8453-8bc566a6a514
                stepCounter: e6f00723-a598-4272-b25a-ed544e4c0a06
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bc04b9de-4804-41bd-a23a-1e6250a379e9
          stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE STATE OR PROVINCE THE ACCOUNT IS LOCATED IN
        name: STATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bb17df05-2e46-497f-90ce-12dc202dfb00
                stepCounter: e6f00723-a598-4272-b25a-ed544e4c0a06
            transform: COALESCE(ACCOUNT.USPSSTATE,ACCOUNT.STATE,'') \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a0e829e1-c161-4793-ad08-9c108b7d8785
          stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE POSTAL CODE FOR THE ACCOUNT
        name: ZIPCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8668e199-e143-42e3-8cf6-a1a02cc72246
                stepCounter: e6f00723-a598-4272-b25a-ed544e4c0a06
            transform: COALESCE(ACCOUNT.USPSZIPCODE,ACCOUNT.ZIPCODE,'0') \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b9a34757-8ac9-429d-8bdd-002be654a9ca
          stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
        config: {}
        dataType: DATE
        defaultValue: ""
        description: IS THE DATE THAT THE ACCOUNT EITHER REGISTERED OR, IN THE EVENT WE DO NOT HAVE A REGISTRATION, WILL BE THE DATE OF FIRST PURCHASE
        name: STARTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9ce9c8c-3a28-41ce-bba7-10781a77376b
                stepCounter: e6f00723-a598-4272-b25a-ed544e4c0a06
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3f648ad-0b7e-4b7a-9267-3aee6a30d094
          stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE TIER A LEVEL 1 ACCOUNT IS CLASSIFIED AS. BASICALLY, HOW MUCH ATTENTION ARE WE GOING TO GIVE THIS CUSTOMER.
        name: TIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d393d3e-0826-4b49-9070-d2885752cff6
                stepCounter: e6f00723-a598-4272-b25a-ed544e4c0a06
            transform: COALESCE(ACCOUNT.STRATEGICACCOUNTREASON,ACCOUNT.MEMBERSEGMENT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34c5ebb3-b193-4a5a-bd65-44953be23551
          stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE 9-DIGIT EIN (EMPLOYER IDENTIFICATION NUMBER) FOR THE ACCOUNT
        name: FEDERALTAXID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1dcc12d6-c111-48bc-b26e-3dfff2c1fff2
                stepCounter: e6f00723-a598-4272-b25a-ed544e4c0a06
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88af4975-240e-4040-bd6b-e1a32d081b52
          stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE PRIMARY URL FOR THE ACCOUNT
        name: WEBSITE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d0c1e036-eac6-4c07-ac6d-09eb01564ad2
                stepCounter: e6f00723-a598-4272-b25a-ed544e4c0a06
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2abf7401-0e3f-4695-b373-d6bf1611658e
          stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: CUSTOMER_SIZE_BAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24570ae5-4abb-4988-a87f-306b51953bf9
                stepCounter: bb755271-2e35-4786-9147-d43f139e223f
            transform: IFNULL(LOADOPC_CUSTOMER_SIZE_BAND.CUSTOMER_SIZE_BAND,'UNKNOWN')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 327eb386-7159-4ede-ad2e-d3bf30401fa9
          stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: THE SIZE BAND ARE CATEGORIZED INTO DIFFERENT SIZE BAND CODE DEPENDING ON THE CUSTOMER SIZE AND THE ACCOUNTTYPES.
        name: CUSTOMER_SIZE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b057c9a4-8235-4358-a2fe-2ab89e5a763c
                stepCounter: e6f00723-a598-4272-b25a-ed544e4c0a06
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca442d69-7b41-453f-9e7f-a7d8581237b6
          stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CUSTOMER_SIZE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eac41613-b8f3-484d-b67f-2e063615cf2d
                stepCounter: e6f00723-a598-4272-b25a-ed544e4c0a06
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea0a24a7-b682-4577-8c61-62c8e0b45a33
          stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: ACCOUNTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd325e05-7e18-499b-bd60-b3144ec04cb9
                stepCounter: e6f00723-a598-4272-b25a-ed544e4c0a06
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1eafc440-3db5-46d5-bd1b-9334b6ab0179
          stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "STAGEACCOUNT_ADDKEYS.ORGANIZATIONID=SALESTERRITORY.ORGANIZATIONID\nSTAGEACCOUNT_ADDKEYS.ACCOUNTTERRITORY=SALESTERRITORY.TERRITORYNAME"
        name: SALESTERRITORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ecfad5fa-3bbe-40f7-aaf3-495b14c9fc45
                stepCounter: e6f00723-a598-4272-b25a-ed544e4c0a06
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8897eab-bf0c-47df-9f3a-78a60228fa84
          stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: SECTORKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2babe22-c6a0-4320-a7cd-a472e20ab3d0
                stepCounter: 161c4b57-96e7-4549-91ae-6414742a3b70
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2123d7b3-f375-47c2-8ea7-07690e30cc67
          stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE IDENTIFIER FOR WHICH SECTOR AN ACCOUNT BELONGS TO. 1 = PUBLIC SECTOR, 2 = PRIVATE SECTOR
        name: SECTORID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 74827771-4df4-4710-b96b-a6512dc2d5f9
                stepCounter: e6f00723-a598-4272-b25a-ed544e4c0a06
            transform: |-
              CASE \NWHEN ACCOUNT.ACCOUNTLINEOFBUSINESS ='PUBLIC' THEN 1 \NWHEN ACCOUNT.ACCOUNTLINEOFBUSINESS ='PRIVATE' THEN 2 \NELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8528c774-17f7-470e-b2a9-b02d54b8ad6e
          stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: STREET ADDRESS LINE 1 MATCHED WITH USPS.
        name: USPSADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 359b0c52-158e-436f-9305-10c01358224b
                stepCounter: e6f00723-a598-4272-b25a-ed544e4c0a06
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e64a1bb-dc1f-49b4-aa7c-386b3225eb0f
          stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: STREET ADDRESS LINE 2 MATCHED WITH USPS.
        name: USPSADDRESS2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cafe0ef3-5a5d-4d6e-a9e9-8cc335b74562
                stepCounter: e6f00723-a598-4272-b25a-ed544e4c0a06
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50c57ea9-7982-4b52-81f6-a79d459e316f
          stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ADDRESS CITY MATCHED WITH USPS.
        name: USPSCITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cc30f0a3-600a-45a1-af77-2b34eedd0af8
                stepCounter: e6f00723-a598-4272-b25a-ed544e4c0a06
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38bd082c-830a-4084-b4d1-a8996c329592
          stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ADDRESS STATE MATCHED WITH USPS.
        name: USPSSTATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bb17df05-2e46-497f-90ce-12dc202dfb00
                stepCounter: e6f00723-a598-4272-b25a-ed544e4c0a06
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e93cd2ec-56fa-4a55-b47d-5c3d87ace006
          stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ADDRESS POSTALCODE MATCHED WITH USPS.
        name: USPSZIPCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8668e199-e143-42e3-8cf6-a1a02cc72246
                stepCounter: e6f00723-a598-4272-b25a-ed544e4c0a06
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bc652ba7-ec58-4ffe-8985-89a126e8a197
          stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ADDRESS COUNTY MATCHED WITH USPS.
        name: USPSCOUNTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1119fad5-08ae-4d14-8453-8bc566a6a514
                stepCounter: e6f00723-a598-4272-b25a-ed544e4c0a06
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc32eae0-53ee-44b1-82c8-8e64aed7beb6
          stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "STAGEACCOUNT_ADDKEYS.ORGANIZATIONID=ACCOUNTGEOGRAPHY.ORGANIZATIONID\nSTAGEACCOUNT_ADDKEYS.FORCEID=ACCOUNTGEOGRAPHY.FORCEID"
        name: ACCOUNTGEOGRAPHYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e08f3beb-2980-4ad2-9966-0a3014cef18b
                stepCounter: e6f00723-a598-4272-b25a-ed544e4c0a06
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6271df2e-e068-4f02-bedb-6eeceb6ca5eb
          stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: ACCOUNTCLASSIFICATIONNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2863456-3a38-496f-8edf-22f87ad9fabd
                stepCounter: e6f00723-a598-4272-b25a-ed544e4c0a06
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 37b55bdf-de7f-410d-bdb7-99c64dc5098e
          stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: MEMBERSEGMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9378cd0-9969-494b-b6ca-cd8ed33c863f
                stepCounter: e6f00723-a598-4272-b25a-ed544e4c0a06
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca42a5ae-643a-4db8-9ac9-e5a4de8477de
          stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: DENOTES WHETHER THE ROW IS AN ACCOUNT, CHILD ACCOUNT, DUPLICATE, OR DELIVERY LOCATION.
        name: RECORDDESIGNATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3032fdc-9970-4fa5-84a5-3dc2a7e085cb
                stepCounter: e6f00723-a598-4272-b25a-ed544e4c0a06
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7f2eb8c-8bc9-4200-a477-145835f106d1
          stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ACCOUNTLINEOFBUSINESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 74827771-4df4-4710-b96b-a6512dc2d5f9
                stepCounter: e6f00723-a598-4272-b25a-ed544e4c0a06
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17bab7b4-49fa-4cf1-b8ea-759060af8fa9
          stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        name: WESHARE_PARTICIPANT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2af3effd-e7b2-492e-ad8c-03724c313375
                stepCounter: e6f00723-a598-4272-b25a-ed544e4c0a06
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1144f863-8e3d-4171-93f9-b97d968f5e02
          stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE TIER A LEVEL 1 ACCOUNT IS CLASSIFIED AS. BASICALLY, HOW MUCH ATTENTION ARE WE GOING TO GIVE THIS CUSTOMER.
        name: STRATEGICACCOUNTREASON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d393d3e-0826-4b49-9070-d2885752cff6
                stepCounter: e6f00723-a598-4272-b25a-ed544e4c0a06
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 63955f71-584f-472c-b8d1-4ea8bd69e298
          stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE OMNIA PARTNERS ORGANIZATIONAL BUSINESS UNIT, OR DIVISION, THE ACCOUNT BELONGS TO
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 29524b9c-165a-4eae-8762-d26093398c2a
                stepCounter: e6f00723-a598-4272-b25a-ed544e4c0a06
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 078a2a0f-14ab-42b2-98ad-ad734562369c
          stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: OPUS_ACCOUNT_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 458a5fc1-746f-46d4-9c13-bc5b1ae188f3
                stepCounter: e6f00723-a598-4272-b25a-ed544e4c0a06
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9702fcd-a07c-47f1-a94f-0c74ed58605e
          stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PARTICIPATING_PROGRAM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 724663e8-a1a3-4281-b0d1-a68af71e81c2
                stepCounter: e6f00723-a598-4272-b25a-ed544e4c0a06
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ACCOUNT: e6f00723-a598-4272-b25a-ed544e4c0a06
          SECTOR: 161c4b57-96e7-4549-91ae-6414742a3b70
          LOADOPC_CUSTOMER_SIZE_BAND: bb755271-2e35-4786-9147-d43f139e223f
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: DIM
            nodeName: SECTOR
          - locationName: LOAD
            nodeName: LOADOPC_CUSTOMER_SIZE_BAND
        join:
          joinCondition: |-
            FROM {{ ref('DIM','ACCOUNT') }} ACCOUNT
              LEFT JOIN {{ ref('DIM','SECTOR') }} SECTOR
                ON ACCOUNT.ACCOUNTLINEOFBUSINESS = SECTOR.SECTORNAME
              LEFT JOIN {{ ref('LOAD','LOADOPC_CUSTOMER_SIZE_BAND') }} LOADOPC_CUSTOMER_SIZE_BAND
                ON ACCOUNT.CUSTOMER_SIZE_CODE = LOADOPC_CUSTOMER_SIZE_BAND.CUSTOMER_SIZE_CODE
               AND ACCOUNT.ACCOUNTCLASSIFICATIONNAME =LOADOPC_CUSTOMER_SIZE_BAND.ACCOUNTCLASSIFICATIONNAME
             WHERE ACCOUNT.ACCOUNTCLASSIFICATIONNAME NOT IN ('SUPPLIER DEEMED ELIGIBLE', 'UNCLASSIFIED')
               AND ACCOUNT.ACCOUNTLINEOFBUSINESS ='PUBLIC'
               AND ACCOUNT.ORGANIZATIONID <>14
        name: OPC_ACCOUNT
        noLinkRefs: []
  name: OPC_ACCOUNT
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
