fileVersion: 1
id: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
name: OPC_ACCOUNT
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: "FILTER ALL ACCOUNT RELATED EXCEPTIONS AT ONE PLACE."
  isMultisource: false
  locationName: OMNIA_CONNECT_OPC
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39164390-b1a7-436f-a2ab-0050dbb721c0
          stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE HIGHEST-LEVEL OF HIERARCHY FOR AN ACCOUNT
        isBusinessKey: true
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4f18fec1-1103-4ed1-87e3-bf56edf0211e
                stepCounter: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0496d4c9-e184-4f52-9202-c05cc9999a6e
          stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE UNIQUE IDENTIFIER FOR AN ACCOUNT
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a3160ab-05f3-4f3a-9c6b-05cb492a0191
                stepCounter: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a453e57-10cf-4e12-ab9d-57a473cc094c
          stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE SAME VALUE AS THE ACCOUNTNAME COLUMN, BUT HAS BEEN RUN THROUGH A PROPERCASE FUNCTION
        name: DISPLAYACCOUNTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 36a11dcd-419e-47a9-b34f-875ca1d727b0
                stepCounter: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3efc5d16-23e5-4acb-8724-6c8701a80a31
          stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE TYPE, OR CLASSIFICATION, OF THE ACCOUNT
        name: ACCOUNTTYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 248f3f72-5c36-4888-9543-1a7bae575764
                stepCounter: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d60199d8-6f79-4db4-aaa6-93691bb408af
          stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE FIRST LINE OF THE ACCOUNT'S STREET ADDRESS
        name: ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 373e6390-68ca-4c84-96c5-1be0d88718d0
                stepCounter: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
            transform: COALESCE(INITCAP(ACCOUNT.USPSADDRESS),'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e76c58ad-0d98-4e10-a1e2-7d9877bed967
          stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE SECOND LINE OF THE ACCOUNT'S STREET ADDRESS, USUALLY THE SUITE, BUILDING, OR FLOOR
        name: ADDRESS2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7fafd6e5-11da-4d76-968a-c7c1027bbbdc
                stepCounter: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c230ea2c-11c4-4fe7-85c1-a95299c0fd63
          stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE NAME OF THE CITY THE ACCOUNT IS LOCATED IN
        name: CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c504ae9-57a2-4b0d-9ce6-46cde68acd04
                stepCounter: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
            transform: COALESCE(ACCOUNT.USPSCITY,ACCOUNT.CITY,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ea698e1-28e2-4a59-81cc-9ac037b67678
          stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE NAME OF THE COUNTY OR PARISH THE ACCOUNT IS LOCATED IN
        name: COUNTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9ec1b62c-dd17-419a-853f-dadcc6873fce
                stepCounter: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b5775d24-2751-4c07-82ac-b556a0c2c56b
          stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE STATE OR PROVINCE THE ACCOUNT IS LOCATED IN
        name: STATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: df05598b-9701-41bb-a520-b0fce03783d9
                stepCounter: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
            transform: COALESCE(ACCOUNT.USPSSTATE,ACCOUNT.STATE,'') \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ee04339-50ab-407c-b718-af7106bd1aa6
          stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE POSTAL CODE FOR THE ACCOUNT
        name: ZIPCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a0aff87-daf3-406b-ac4c-28cd62b3e29a
                stepCounter: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
            transform: COALESCE(ACCOUNT.USPSZIPCODE,ACCOUNT.ZIPCODE,'0') \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7bc8df4-c0a7-4237-8205-41b60dfeb239
          stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
        config: {}
        dataType: DATE
        defaultValue: ""
        description: IS THE DATE THAT THE ACCOUNT EITHER REGISTERED OR, IN THE EVENT WE DO NOT HAVE A REGISTRATION, WILL BE THE DATE OF FIRST PURCHASE
        name: STARTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39fa5837-d429-4493-9323-a91bf6f1ffe6
                stepCounter: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba478ecd-0d20-4d7c-8a51-ab87c4a54e34
          stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE TIER A LEVEL 1 ACCOUNT IS CLASSIFIED AS. BASICALLY, HOW MUCH ATTENTION ARE WE GOING TO GIVE THIS CUSTOMER.
        name: TIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7eccb49b-323c-4e6b-800b-6eede388b8b0
                stepCounter: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
            transform: COALESCE(ACCOUNT.STRATEGICACCOUNTREASON,ACCOUNT.MEMBERSEGMENT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3629f92-b13f-43ce-88da-b685d545e8f6
          stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE 9-DIGIT EIN (EMPLOYER IDENTIFICATION NUMBER) FOR THE ACCOUNT
        name: FEDERALTAXID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72b44ed7-af56-46e1-a784-c7176d1a8661
                stepCounter: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ab5b297-2be9-4df7-9e84-d3c376ed46e4
          stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE PRIMARY URL FOR THE ACCOUNT
        name: WEBSITE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f3efb2b-d8b1-4ef4-a534-eb0423394dfe
                stepCounter: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a87f5d3-27ce-4362-bc0c-2b87b5f3afe1
          stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: CUSTOMER_SIZE_BAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cf59daff-6c7f-4d31-8ffb-fd46d8ce9abf
                stepCounter: 59ea7c50-5eb8-4354-93cd-69d2c7a87520
            transform: IFNULL(LOADOPC_CUSTOMER_SIZE_BAND.CUSTOMER_SIZE_BAND,'UNKNOWN')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fbc9b040-1378-46a2-be9a-5517592e12e9
          stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: THE SIZE BAND ARE CATEGORIZED INTO DIFFERENT SIZE BAND CODE DEPENDING ON THE CUSTOMER SIZE AND THE ACCOUNTTYPES.
        name: CUSTOMER_SIZE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 40949fc2-1725-4e90-be6b-d395dd050f9e
                stepCounter: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50c094cd-c8f1-42be-b203-ebb7b9ed4071
          stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CUSTOMER_SIZE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f1fdd6e-230a-4460-8ef0-a46039dfdaf6
                stepCounter: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 73101027-373e-40ba-a7a7-d0e1c69a5523
          stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: ACCOUNTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b17fba0-9db5-4ba8-9eeb-d24027f151eb
                stepCounter: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 830e9663-2704-4f6d-8f7e-affd04a751ab
          stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "STAGEACCOUNT_ADDKEYS.ORGANIZATIONID=SALESTERRITORY.ORGANIZATIONID\nSTAGEACCOUNT_ADDKEYS.ACCOUNTTERRITORY=SALESTERRITORY.TERRITORYNAME"
        name: SALESTERRITORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 507dc1ed-5079-4334-92f2-87e91eae11b3
                stepCounter: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a4bbb8c-6a6a-4348-b2dd-a9380c3f4b69
          stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: SECTORKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: da47fcb6-33af-4334-bd07-81a5a689ceff
                stepCounter: 7aaa6819-efc2-428a-bc37-7044056371c8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25e8b8c1-fe4e-4a97-8e38-648f1ef8c41d
          stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE IDENTIFIER FOR WHICH SECTOR AN ACCOUNT BELONGS TO. 1 = PUBLIC SECTOR, 2 = PRIVATE SECTOR
        name: SECTORID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1734275-1cd8-42bc-b3bb-c511b1e4dc1d
                stepCounter: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
            transform: |-
              CASE \NWHEN ACCOUNT.ACCOUNTLINEOFBUSINESS ='PUBLIC' THEN 1 \NWHEN ACCOUNT.ACCOUNTLINEOFBUSINESS ='PRIVATE' THEN 2 \NELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 670b9cf8-497f-4e29-a2e8-948c83e7d696
          stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: STREET ADDRESS LINE 1 MATCHED WITH USPS.
        name: USPSADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 373e6390-68ca-4c84-96c5-1be0d88718d0
                stepCounter: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: acecf308-4aa1-446d-ad4d-accfb0ec077c
          stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: STREET ADDRESS LINE 2 MATCHED WITH USPS.
        name: USPSADDRESS2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7fafd6e5-11da-4d76-968a-c7c1027bbbdc
                stepCounter: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9d568a3-c5e9-4930-86d8-3a9f02a924e7
          stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ADDRESS CITY MATCHED WITH USPS.
        name: USPSCITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c504ae9-57a2-4b0d-9ce6-46cde68acd04
                stepCounter: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 99f23eca-1c0a-477c-9c6d-9b89c9dd2161
          stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ADDRESS STATE MATCHED WITH USPS.
        name: USPSSTATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: df05598b-9701-41bb-a520-b0fce03783d9
                stepCounter: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7091cbf2-f44f-4b11-b7c3-0f4d0b4b517d
          stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ADDRESS POSTALCODE MATCHED WITH USPS.
        name: USPSZIPCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a0aff87-daf3-406b-ac4c-28cd62b3e29a
                stepCounter: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b3f1c35-198b-4e06-9459-f059ab90c54a
          stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ADDRESS COUNTY MATCHED WITH USPS.
        name: USPSCOUNTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9ec1b62c-dd17-419a-853f-dadcc6873fce
                stepCounter: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 540335ea-0863-4025-987b-27ec2d55ba7e
          stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "STAGEACCOUNT_ADDKEYS.ORGANIZATIONID=ACCOUNTGEOGRAPHY.ORGANIZATIONID\nSTAGEACCOUNT_ADDKEYS.FORCEID=ACCOUNTGEOGRAPHY.FORCEID"
        name: ACCOUNTGEOGRAPHYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2e861e6e-be4d-44d6-8c98-4b1d78f04d3d
                stepCounter: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3cde709-139f-46e0-babf-14c5435ffd1f
          stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: ACCOUNTCLASSIFICATIONNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 248f3f72-5c36-4888-9543-1a7bae575764
                stepCounter: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94d34e1a-7502-4a29-8ce5-c5c659bd048c
          stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: MEMBERSEGMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c3e846ce-e446-4942-b3f6-12e2ca43e815
                stepCounter: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f34fd43b-b046-4e6c-afbf-b9c8d8ea3fcb
          stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: DENOTES WHETHER THE ROW IS AN ACCOUNT, CHILD ACCOUNT, DUPLICATE, OR DELIVERY LOCATION.
        name: RECORDDESIGNATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f70d049-1a7e-4ffd-a79c-5de2a9ace03b
                stepCounter: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 582ad839-8a77-4446-ae6f-45aaf6e071db
          stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ACCOUNTLINEOFBUSINESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1734275-1cd8-42bc-b3bb-c511b1e4dc1d
                stepCounter: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c81b55be-0006-4928-b9f3-85331759934b
          stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        name: WESHARE_PARTICIPANT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76821a1f-11c4-4240-a3b8-27751fdd22f7
                stepCounter: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e02100c4-f84b-4e74-9b93-ce736f832885
          stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE TIER A LEVEL 1 ACCOUNT IS CLASSIFIED AS. BASICALLY, HOW MUCH ATTENTION ARE WE GOING TO GIVE THIS CUSTOMER.
        name: STRATEGICACCOUNTREASON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7eccb49b-323c-4e6b-800b-6eede388b8b0
                stepCounter: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: becf7c0d-54a1-493f-bce5-33d7b57d62cd
          stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE OMNIA PARTNERS ORGANIZATIONAL BUSINESS UNIT, OR DIVISION, THE ACCOUNT BELONGS TO
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 593bfe11-7d80-476c-b1cc-6fb83f099a9d
                stepCounter: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 35605b1e-6f35-414f-a300-a9a037e0e72d
          stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: OPUS_ACCOUNT_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e084b71d-e842-4664-88fd-8d7d7779bd0b
                stepCounter: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 58b29e48-2977-4a85-8c63-ef67a69d6c1f
          stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PARTICIPATING_PROGRAM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d42f894-afdf-4f9a-a1af-8e6b02eeb8cf
                stepCounter: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ACCOUNT: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
          SECTOR: 7aaa6819-efc2-428a-bc37-7044056371c8
          LOAD_OPC_CUSTOMER_SIZE_BAND: 59ea7c50-5eb8-4354-93cd-69d2c7a87520
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: DIM
            nodeName: SECTOR
          - locationName: LOAD
            nodeName: LOAD_OPC_CUSTOMER_SIZE_BAND
        join:
          joinCondition: |-
            FROM {{ ref('DIM','ACCOUNT') }} ACCOUNT
              LEFT JOIN {{ ref('DIM','SECTOR') }} SECTOR
                ON ACCOUNT.ACCOUNTLINEOFBUSINESS = SECTOR.SECTORNAME
              LEFT JOIN {{ ref('LOAD','LOAD_OPC_CUSTOMER_SIZE_BAND') }} LOAD_OPC_CUSTOMER_SIZE_BAND
                ON ACCOUNT.CUSTOMER_SIZE_CODE = LOAD_OPC_CUSTOMER_SIZE_BAND.CUSTOMER_SIZE_CODE
               AND ACCOUNT.ACCOUNTCLASSIFICATIONNAME =LOAD_OPC_CUSTOMER_SIZE_BAND.ACCOUNTCLASSIFICATIONNAME
             WHERE ACCOUNT.ACCOUNTCLASSIFICATIONNAME NOT IN ('SUPPLIER DEEMED ELIGIBLE', 'UNCLASSIFIED')
               AND ACCOUNT.ACCOUNTLINEOFBUSINESS ='PUBLIC'
               AND ACCOUNT.ORGANIZATIONID <>14
        name: OPC_ACCOUNT
        noLinkRefs: []
  name: OPC_ACCOUNT
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
