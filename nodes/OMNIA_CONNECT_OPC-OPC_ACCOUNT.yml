fileVersion: 1
id: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
name: OPC_ACCOUNT
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: "Filter all account related exceptions at one place."
  isMultisource: false
  locationName: OMNIA_CONNECT_OPC
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21211ff2-8822-4e39-aae7-8f707fba7e37
          stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
        config: {}
        dataType: INT
        defaultValue: ""
        description: is the highest-level of hierarchy for an account
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8bba630b-6452-4c7c-a30c-d7493361464e
                stepCounter: c278473c-12f0-41e1-b65b-faa4b3c2a978
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5582b423-d45b-4fe9-9338-99c588e50b45
          stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
        config: {}
        dataType: INT
        defaultValue: ""
        description: is the unique identifier for an account
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 264325ce-e680-46a0-99e5-d80139b1ea05
                stepCounter: c278473c-12f0-41e1-b65b-faa4b3c2a978
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: adcdda35-f145-4a49-81a5-8405e0edda62
          stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the same value as the AccountName column, but has been run through a ProperCase function
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DISPLAYACCOUNTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 264c1dd2-3c39-4a54-9b07-20de97ec5747
                stepCounter: c278473c-12f0-41e1-b65b-faa4b3c2a978
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f89edba-12b2-4f52-9b42-ca6b8bbafa39
          stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the type, or classification, of the account
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ACCOUNTTYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea2a8199-84cf-40b8-be86-866cfbca8510
                stepCounter: c278473c-12f0-41e1-b65b-faa4b3c2a978
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d617ba24-0eda-433e-a888-fa1cea56ac1f
          stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the first line of the account's street address
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 805e1cff-c192-44d5-8df8-f778a2e5eca8
                stepCounter: c278473c-12f0-41e1-b65b-faa4b3c2a978
            transform: COALESCE(INITCAP(Account.UspsAddress),'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd0e29ce-eb35-401b-b0ed-5b5152404316
          stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the second line of the account's street address, usually the suite, building, or floor
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ADDRESS2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67ca0e3e-9a6c-4425-be0c-74d12cb1103e
                stepCounter: c278473c-12f0-41e1-b65b-faa4b3c2a978
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c47be048-d7ae-4dc6-b757-493a1623e952
          stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the name of the city the account is located in
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1264cd16-62c5-4af5-b141-e3f04f84903f
                stepCounter: c278473c-12f0-41e1-b65b-faa4b3c2a978
            transform: COALESCE(Account.UspsCity,Account.City,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fabf4781-bd02-4505-99c0-764319218bf4
          stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the name of the county or parish the account is located in
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: COUNTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 405478b8-1fa0-4523-9d91-b161713ec850
                stepCounter: c278473c-12f0-41e1-b65b-faa4b3c2a978
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5710cf60-c842-4143-a509-897be92d6b3a
          stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the state or province the account is located in
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: STATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b30e209-7f94-4d6c-a420-d042e1b120ae
                stepCounter: c278473c-12f0-41e1-b65b-faa4b3c2a978
            transform: COALESCE(Account.UspsState,Account.State,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f84ba1ed-fb7f-4cc9-be0e-600adf3a5314
          stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the postal code for the account
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ZIPCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0bda42ae-a2a5-4c36-ab90-43ccde179880
                stepCounter: c278473c-12f0-41e1-b65b-faa4b3c2a978
            transform: COALESCE(Account.UspsZipCode,Account.ZipCode,'0')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2de7fdd-9f2f-4c90-b41c-4ec64a884aba
          stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
        config: {}
        dataType: DATE
        defaultValue: ""
        description: is the date that the account either registered or, in the event we do not have a registration, will be the date of first purchase
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: STARTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9e0c5244-0974-41a3-ba40-fc70d71ef912
                stepCounter: c278473c-12f0-41e1-b65b-faa4b3c2a978
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 034825fb-dd3c-46f0-ab47-1734e9a6c88b
          stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the tier a level 1 account is classified as. Basically, how much attention are we going to give this customer.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 01cbf576-e982-4eed-9f52-9ce2a114e957
                stepCounter: c278473c-12f0-41e1-b65b-faa4b3c2a978
            transform: COALESCE(Account.StrategicAccountReason,Account.MemberSegment)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 855e2c28-c8f5-453f-a922-fb464c50b8ec
          stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the 9-digit EIN (employer identification number) for the account
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: FEDERALTAXID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 157eb11b-58d8-4a50-8c94-252ed5026784
                stepCounter: c278473c-12f0-41e1-b65b-faa4b3c2a978
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 154fc7bb-8c0e-4470-8563-ed9be43a77c3
          stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the primary URL for the account
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: WEBSITE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18a58816-1a72-4e12-aa75-eebaa2f20cc3
                stepCounter: c278473c-12f0-41e1-b65b-faa4b3c2a978
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae59306d-841c-48ff-8f2a-86dea689fc92
          stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CUSTOMER_SIZE_BAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ead962fb-d29d-4211-a90b-bed6afa5dd42
                stepCounter: 9bc5446e-998c-4946-b2c2-0dfec7c715b6
            transform: IFNULL(LoadOPC_CUSTOMER_SIZE_BAND.CUSTOMER_SIZE_BAND,'Unknown')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 99e2a756-8b2c-4cfd-9716-422b5d519931
          stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: The Size band are categorized into different Size Band Code depending on the customer size and the AccountTypes.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CUSTOMER_SIZE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 976b92d7-9d2b-4143-8a35-51a8379ed15c
                stepCounter: c278473c-12f0-41e1-b65b-faa4b3c2a978
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39c32a95-0e5d-4d61-b18d-584df26a74f1
          stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CUSTOMER_SIZE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f6d6df61-fa99-4ed3-994e-761bd03e510e
                stepCounter: c278473c-12f0-41e1-b65b-faa4b3c2a978
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dd6b0231-7b7f-4a19-85e2-93af3ed439bc
          stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ACCOUNTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 142e5dc4-d508-469e-862b-8ad4d3c7b053
                stepCounter: c278473c-12f0-41e1-b65b-faa4b3c2a978
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd552a55-8607-4f88-a4e2-d4321704991d
          stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "StageAccount_AddKeys.OrganizationId=SalesTerritory.OrganizationId\nStageAccount_AddKeys.AccountTerritory=SalesTerritory.TerritoryName"
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SALESTERRITORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 517014ce-1b95-4edb-a301-810bbe271b03
                stepCounter: c278473c-12f0-41e1-b65b-faa4b3c2a978
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a01da3e7-8ea6-4927-8ba3-5b6f1f3ef8bb
          stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SECTORKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16788f60-7432-46fa-8b69-61c54b1b3e07
                stepCounter: 85493fd2-0856-4b9b-9baa-aeff138297e1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2590a6d-5a80-46b8-bb11-7ce1aa0acf0a
          stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
        config: {}
        dataType: INT
        defaultValue: ""
        description: is the identifier for which sector an account belongs to. 1 = Public Sector, 2 = Private Sector
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SECTORID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27cabbf3-c7b2-484a-9c15-92cbce0808fc
                stepCounter: c278473c-12f0-41e1-b65b-faa4b3c2a978
            transform: |-
              CASE WHEN Account.AccountLineOfBusiness ='PUBLIC'  THEN 1
                          WHEN Account.AccountLineOfBusiness ='PRIVATE' THEN 2
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91e1c718-2ec2-4078-acd2-492cb00b8093
          stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Street Address Line 1 matched with USPS.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: USPSADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 805e1cff-c192-44d5-8df8-f778a2e5eca8
                stepCounter: c278473c-12f0-41e1-b65b-faa4b3c2a978
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 377142e5-2a19-4143-b3e8-568d303e630e
          stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Street Address Line 2 matched with USPS.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: USPSADDRESS2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67ca0e3e-9a6c-4425-be0c-74d12cb1103e
                stepCounter: c278473c-12f0-41e1-b65b-faa4b3c2a978
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2045265-384b-484e-b970-a2a2f816fe7a
          stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Address City matched with USPS.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: USPSCITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1264cd16-62c5-4af5-b141-e3f04f84903f
                stepCounter: c278473c-12f0-41e1-b65b-faa4b3c2a978
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14821ff5-4e8b-4de7-80b4-29ec0f3f497f
          stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Address State matched with USPS.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: USPSSTATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b30e209-7f94-4d6c-a420-d042e1b120ae
                stepCounter: c278473c-12f0-41e1-b65b-faa4b3c2a978
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4adc7b3-dc8c-4396-afaa-f6e150cccac5
          stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Address PostalCode matched with USPS.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: USPSZIPCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0bda42ae-a2a5-4c36-ab90-43ccde179880
                stepCounter: c278473c-12f0-41e1-b65b-faa4b3c2a978
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 537f9aa2-6003-476e-a7a7-249ba858ffcf
          stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Address County matched with USPS.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: USPSCOUNTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 405478b8-1fa0-4523-9d91-b161713ec850
                stepCounter: c278473c-12f0-41e1-b65b-faa4b3c2a978
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 73589d98-c008-4df4-870c-5da20585f6c5
          stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "StageAccount_AddKeys.OrganizationId=AccountGeography.OrganizationId\nStageAccount_AddKeys.ForceId=AccountGeography.ForceId"
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ACCOUNTGEOGRAPHYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1414d85e-7a87-49e8-993a-23c4fe93d9a9
                stepCounter: c278473c-12f0-41e1-b65b-faa4b3c2a978
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c40582bf-7331-4cbd-8ac1-8714e1ebcda6
          stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ACCOUNTCLASSIFICATIONNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea2a8199-84cf-40b8-be86-866cfbca8510
                stepCounter: c278473c-12f0-41e1-b65b-faa4b3c2a978
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 62be4e87-1787-448d-bc7e-ab076eeb6a24
          stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: MEMBERSEGMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9dbcf548-26de-4553-ac26-080243eaeee9
                stepCounter: c278473c-12f0-41e1-b65b-faa4b3c2a978
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1aafd628-644f-4d98-af7e-79efe4401c2c
          stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: denotes whether the row is an Account, Child Account, Duplicate, or Delivery Location.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: RECORDDESIGNATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eca0353a-55b3-47cd-99f7-fff17cb14535
                stepCounter: c278473c-12f0-41e1-b65b-faa4b3c2a978
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88562096-ffc6-40d5-8af5-6f53ca436127
          stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ACCOUNTLINEOFBUSINESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27cabbf3-c7b2-484a-9c15-92cbce0808fc
                stepCounter: c278473c-12f0-41e1-b65b-faa4b3c2a978
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ca553eb-eb4a-460d-8202-348eae5c2096
          stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: WESHARE_PARTICIPANT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a50bf75-0c8a-4fc5-8350-2f8e4f51bcf5
                stepCounter: c278473c-12f0-41e1-b65b-faa4b3c2a978
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f54ec149-7cf1-4c44-8fa1-7adaefa60c01
          stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the tier a level 1 account is classified as. Basically, how much attention are we going to give this customer.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: STRATEGICACCOUNTREASON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 01cbf576-e982-4eed-9f52-9ce2a114e957
                stepCounter: c278473c-12f0-41e1-b65b-faa4b3c2a978
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72e27c6b-a15d-4aeb-bd93-e94a37798c68
          stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
        config: {}
        dataType: INT
        defaultValue: ""
        description: is the OMNIA Partners organizational business unit, or division, the account belongs to
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d6ecb03-602a-454b-b876-2a8bbff4b6a9
                stepCounter: c278473c-12f0-41e1-b65b-faa4b3c2a978
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a16d54a0-a43e-4171-ae74-3fc78f405770
          stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPUS_ACCOUNT_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ae5c3c8f-270c-426e-90a4-49a90657e7cd
                stepCounter: c278473c-12f0-41e1-b65b-faa4b3c2a978
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: faad0887-9047-4a6f-8169-80948e275c5b
          stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PARTICIPATING_PROGRAM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ad88c103-1b65-4d5a-a0a9-975db9da368a
                stepCounter: c278473c-12f0-41e1-b65b-faa4b3c2a978
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ACCOUNT: c278473c-12f0-41e1-b65b-faa4b3c2a978
          SECTOR: 85493fd2-0856-4b9b-9baa-aeff138297e1
          LOADOPC_CUSTOMER_SIZE_BAND: 9bc5446e-998c-4946-b2c2-0dfec7c715b6
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: DIM
            nodeName: SECTOR
          - locationName: LOAD
            nodeName: LOADOPC_CUSTOMER_SIZE_BAND
        join:
          joinCondition: |-
            FROM {{ ref('DIM','ACCOUNT') }} ACCOUNT
              LEFT JOIN {{ ref('DIM','SECTOR') }} Sector
                ON Account.AccountLineOfBusiness = Sector.SectorName
              LEFT JOIN {{ ref('LOAD','LOADOPC_CUSTOMER_SIZE_BAND') }} LoadOPC_CUSTOMER_SIZE_BAND
                ON Account.Customer_Size_Code = LoadOPC_CUSTOMER_SIZE_BAND.CUSTOMER_SIZE_CODE
               AND Account.AccountClassificationName =LoadOPC_CUSTOMER_SIZE_BAND.ACCOUNTCLASSIFICATIONNAME
             WHERE Account.AccountClassificationName NOT IN ('Supplier Deemed Eligible', 'Unclassified')
               AND Account.AccountLineOfBusiness ='PUBLIC'
               AND Account.OrganizationId <>14
        name: OPC_ACCOUNT
        noLinkRefs: []
  name: OPC_ACCOUNT
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
