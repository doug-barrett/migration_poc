fileVersion: 1
id: 3353bc4b-96a5-43e1-9c39-6e2080820932
name: OPC_ACCOUNT
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: "FILTER ALL ACCOUNT RELATED EXCEPTIONS AT ONE PLACE."
  isMultisource: false
  locationName: OMNIA_CONNECT_OPC
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45b1e391-1f57-4616-bfb8-5a95e8fa0bf7
          stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE HIGHEST-LEVEL OF HIERARCHY FOR AN ACCOUNT
        isBusinessKey: true
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a8e6fcf7-67f0-49f8-a570-d075eeaeed7d
                stepCounter: 745ecacb-59f4-457a-9a6f-e827d225494e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45b8ca31-a3c4-4854-84ab-6dce26144004
          stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE UNIQUE IDENTIFIER FOR AN ACCOUNT
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 87ea6a58-f1f0-4c3d-996d-16565db55a0a
                stepCounter: 745ecacb-59f4-457a-9a6f-e827d225494e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09d28d69-519f-447f-8b65-4727420cafdf
          stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE SAME VALUE AS THE ACCOUNTNAME COLUMN, BUT HAS BEEN RUN THROUGH A PROPERCASE FUNCTION
        name: DISPLAYACCOUNTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2bad7bf6-79a5-47cf-ac98-4866da8dec33
                stepCounter: 745ecacb-59f4-457a-9a6f-e827d225494e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22d869e0-abeb-4bbe-bca9-75515b13b847
          stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE TYPE, OR CLASSIFICATION, OF THE ACCOUNT
        name: ACCOUNTTYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94572884-fbf1-4a5c-9bd5-4c8f48831efe
                stepCounter: 745ecacb-59f4-457a-9a6f-e827d225494e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be0e46b6-00fc-436e-bd4c-edda32e279de
          stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE FIRST LINE OF THE ACCOUNT'S STREET ADDRESS
        name: ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec10c31c-0602-4087-8256-50ad4027b03e
                stepCounter: 745ecacb-59f4-457a-9a6f-e827d225494e
            transform: COALESCE(INITCAP(ACCOUNT.USPSADDRESS),'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 36db7855-96ce-4edb-b02a-cd96615f2c3e
          stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE SECOND LINE OF THE ACCOUNT'S STREET ADDRESS, USUALLY THE SUITE, BUILDING, OR FLOOR
        name: ADDRESS2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22984fbb-44c0-4899-ac77-fd45c951f1d8
                stepCounter: 745ecacb-59f4-457a-9a6f-e827d225494e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9de6e6f0-0132-4c17-bf96-5a18f6846ccf
          stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE NAME OF THE CITY THE ACCOUNT IS LOCATED IN
        name: CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a53f57b7-483d-4466-bbcd-f9f49a42cd47
                stepCounter: 745ecacb-59f4-457a-9a6f-e827d225494e
            transform: COALESCE(ACCOUNT.USPSCITY,ACCOUNT.CITY,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 925ccd51-f2f6-457a-8b87-ea7cb5123094
          stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE NAME OF THE COUNTY OR PARISH THE ACCOUNT IS LOCATED IN
        name: COUNTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 42662a2c-f90e-4242-86ec-2f0fcaac83ef
                stepCounter: 745ecacb-59f4-457a-9a6f-e827d225494e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dbcfe9b8-29ae-4c7a-9a85-2c7c94f5c537
          stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE STATE OR PROVINCE THE ACCOUNT IS LOCATED IN
        name: STATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bcbc8a60-fcfa-46c1-9487-4b8f2a7be934
                stepCounter: 745ecacb-59f4-457a-9a6f-e827d225494e
            transform: COALESCE(ACCOUNT.USPSSTATE,ACCOUNT.STATE,'') \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 44f9c510-63b8-4530-84e3-75a6a0bc01b0
          stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE POSTAL CODE FOR THE ACCOUNT
        name: ZIPCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f12428a2-26d0-47cd-9c56-1584fb41befd
                stepCounter: 745ecacb-59f4-457a-9a6f-e827d225494e
            transform: COALESCE(ACCOUNT.USPSZIPCODE,ACCOUNT.ZIPCODE,'0') \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 274e66f2-2cd0-415f-8e4f-e516950eaec3
          stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
        config: {}
        dataType: DATE
        defaultValue: ""
        description: IS THE DATE THAT THE ACCOUNT EITHER REGISTERED OR, IN THE EVENT WE DO NOT HAVE A REGISTRATION, WILL BE THE DATE OF FIRST PURCHASE
        name: STARTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7021695b-5af0-49ad-830c-b418c1316951
                stepCounter: 745ecacb-59f4-457a-9a6f-e827d225494e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d0e5666-91bd-41e1-bf7c-30341285c264
          stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE TIER A LEVEL 1 ACCOUNT IS CLASSIFIED AS. BASICALLY, HOW MUCH ATTENTION ARE WE GOING TO GIVE THIS CUSTOMER.
        name: TIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b104a6a-52ee-49bd-a4eb-766fc6457650
                stepCounter: 745ecacb-59f4-457a-9a6f-e827d225494e
            transform: COALESCE(ACCOUNT.STRATEGICACCOUNTREASON,ACCOUNT.MEMBERSEGMENT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ac658b1-7ee0-4ab7-bf38-4a245f5e0a90
          stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE 9-DIGIT EIN (EMPLOYER IDENTIFICATION NUMBER) FOR THE ACCOUNT
        name: FEDERALTAXID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 272f6354-eaa6-478b-836d-698412b9e253
                stepCounter: 745ecacb-59f4-457a-9a6f-e827d225494e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d1c6f580-97a8-447a-83a3-cabcd6c439ff
          stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE PRIMARY URL FOR THE ACCOUNT
        name: WEBSITE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9e903e4-25b7-4b2c-a0dd-0a8298f8ffed
                stepCounter: 745ecacb-59f4-457a-9a6f-e827d225494e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 600bb171-27fc-4f2f-86b6-a88ddfd468b3
          stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: CUSTOMER_SIZE_BAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a85167a-d2cc-4a67-af33-5ca9c987418e
                stepCounter: 134cb21b-5070-490c-9fbd-870c163e0090
            transform: IFNULL(LOADOPC_CUSTOMER_SIZE_BAND.CUSTOMER_SIZE_BAND,'UNKNOWN')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c7208171-d75f-4fab-bace-2ec38fa672b8
          stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: THE SIZE BAND ARE CATEGORIZED INTO DIFFERENT SIZE BAND CODE DEPENDING ON THE CUSTOMER SIZE AND THE ACCOUNTTYPES.
        name: CUSTOMER_SIZE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3398de3c-d014-4d9d-b680-255479a74403
                stepCounter: 745ecacb-59f4-457a-9a6f-e827d225494e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c307adac-b53a-4806-8372-085884d8172b
          stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CUSTOMER_SIZE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4ac99b6-912b-4109-bacb-716350ee1930
                stepCounter: 745ecacb-59f4-457a-9a6f-e827d225494e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec624ec5-f65d-4fb7-ad8b-f762060c5614
          stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: ACCOUNTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9809deca-da5b-4fe0-a80a-ab6cafa8782e
                stepCounter: 745ecacb-59f4-457a-9a6f-e827d225494e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5fca724d-f24b-427d-a882-472a044b3020
          stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "STAGEACCOUNT_ADDKEYS.ORGANIZATIONID=SALESTERRITORY.ORGANIZATIONID\nSTAGEACCOUNT_ADDKEYS.ACCOUNTTERRITORY=SALESTERRITORY.TERRITORYNAME"
        name: SALESTERRITORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84fc8cef-c8ea-44ec-b783-11fbdb595e11
                stepCounter: 745ecacb-59f4-457a-9a6f-e827d225494e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94801baf-1854-4f19-b323-a810ba56847b
          stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: SECTORKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 669c7820-5ac2-4ef8-b6d3-2c58d064a380
                stepCounter: a087658c-732e-4983-8055-10c77da80366
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d379ed0-e0fb-44b8-9582-33f64d122aa6
          stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE IDENTIFIER FOR WHICH SECTOR AN ACCOUNT BELONGS TO. 1 = PUBLIC SECTOR, 2 = PRIVATE SECTOR
        name: SECTORID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cbfee6b3-3c59-4b11-aa17-0b9641615273
                stepCounter: 745ecacb-59f4-457a-9a6f-e827d225494e
            transform: |-
              CASE \NWHEN ACCOUNT.ACCOUNTLINEOFBUSINESS ='PUBLIC' THEN 1 \NWHEN ACCOUNT.ACCOUNTLINEOFBUSINESS ='PRIVATE' THEN 2 \NELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34dd0325-bdf8-464c-8a59-b5271d3577f5
          stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: STREET ADDRESS LINE 1 MATCHED WITH USPS.
        name: USPSADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec10c31c-0602-4087-8256-50ad4027b03e
                stepCounter: 745ecacb-59f4-457a-9a6f-e827d225494e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0523e6b9-4784-4ede-b143-736ccd7b4582
          stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: STREET ADDRESS LINE 2 MATCHED WITH USPS.
        name: USPSADDRESS2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22984fbb-44c0-4899-ac77-fd45c951f1d8
                stepCounter: 745ecacb-59f4-457a-9a6f-e827d225494e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 813084ef-8c40-446d-a99e-4e1363c6c4c6
          stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ADDRESS CITY MATCHED WITH USPS.
        name: USPSCITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a53f57b7-483d-4466-bbcd-f9f49a42cd47
                stepCounter: 745ecacb-59f4-457a-9a6f-e827d225494e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06ea2b65-4762-4098-a147-c6a7b2712887
          stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ADDRESS STATE MATCHED WITH USPS.
        name: USPSSTATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bcbc8a60-fcfa-46c1-9487-4b8f2a7be934
                stepCounter: 745ecacb-59f4-457a-9a6f-e827d225494e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 85d681a7-0d4c-4f6d-bec9-29971837b8f5
          stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ADDRESS POSTALCODE MATCHED WITH USPS.
        name: USPSZIPCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f12428a2-26d0-47cd-9c56-1584fb41befd
                stepCounter: 745ecacb-59f4-457a-9a6f-e827d225494e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb6c2e78-61ef-40d8-91c0-59f55c815a00
          stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ADDRESS COUNTY MATCHED WITH USPS.
        name: USPSCOUNTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 42662a2c-f90e-4242-86ec-2f0fcaac83ef
                stepCounter: 745ecacb-59f4-457a-9a6f-e827d225494e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df405f88-0391-44ee-900c-3f86fc980700
          stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "STAGEACCOUNT_ADDKEYS.ORGANIZATIONID=ACCOUNTGEOGRAPHY.ORGANIZATIONID\nSTAGEACCOUNT_ADDKEYS.FORCEID=ACCOUNTGEOGRAPHY.FORCEID"
        name: ACCOUNTGEOGRAPHYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8fe54cad-a528-4794-a1c1-8bfbf357110d
                stepCounter: 745ecacb-59f4-457a-9a6f-e827d225494e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c4f0c9a-03b2-42b6-8007-cfab1446a9f0
          stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: ACCOUNTCLASSIFICATIONNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94572884-fbf1-4a5c-9bd5-4c8f48831efe
                stepCounter: 745ecacb-59f4-457a-9a6f-e827d225494e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f8c24fec-5dd8-4244-804b-1c306827640e
          stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: MEMBERSEGMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 129219b9-6924-46b0-8a73-e2dcfc193783
                stepCounter: 745ecacb-59f4-457a-9a6f-e827d225494e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ff3ea4e-a612-47e0-a706-f43a6caee5d3
          stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: DENOTES WHETHER THE ROW IS AN ACCOUNT, CHILD ACCOUNT, DUPLICATE, OR DELIVERY LOCATION.
        name: RECORDDESIGNATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d48d908a-dfd0-4e60-88ef-708d8389fe4e
                stepCounter: 745ecacb-59f4-457a-9a6f-e827d225494e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f45986c-c695-4656-b4c1-5c818db4f790
          stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ACCOUNTLINEOFBUSINESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cbfee6b3-3c59-4b11-aa17-0b9641615273
                stepCounter: 745ecacb-59f4-457a-9a6f-e827d225494e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1956570d-899f-43fb-8561-a63d8f1de0a8
          stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        name: WESHARE_PARTICIPANT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8a4e649c-17af-496e-82b1-31e369851089
                stepCounter: 745ecacb-59f4-457a-9a6f-e827d225494e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15ff087f-90cc-4dad-bdaa-eb6d3d7f8ac0
          stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE TIER A LEVEL 1 ACCOUNT IS CLASSIFIED AS. BASICALLY, HOW MUCH ATTENTION ARE WE GOING TO GIVE THIS CUSTOMER.
        name: STRATEGICACCOUNTREASON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b104a6a-52ee-49bd-a4eb-766fc6457650
                stepCounter: 745ecacb-59f4-457a-9a6f-e827d225494e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c922b3da-437d-402b-939f-d2642766ca0a
          stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE OMNIA PARTNERS ORGANIZATIONAL BUSINESS UNIT, OR DIVISION, THE ACCOUNT BELONGS TO
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6bdb5cf4-6288-4b60-b3ba-e7e1d1926d9b
                stepCounter: 745ecacb-59f4-457a-9a6f-e827d225494e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7851033d-34f6-4213-9e11-23d516e23c3f
          stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: OPUS_ACCOUNT_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84db21e6-7878-446d-a447-b54bf039526b
                stepCounter: 745ecacb-59f4-457a-9a6f-e827d225494e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 865dad22-4118-4060-851f-9c80e828b3f7
          stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PARTICIPATING_PROGRAM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 30488a27-4348-492c-9e93-acc8e7926971
                stepCounter: 745ecacb-59f4-457a-9a6f-e827d225494e
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ACCOUNT: 745ecacb-59f4-457a-9a6f-e827d225494e
          SECTOR: a087658c-732e-4983-8055-10c77da80366
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: DIM
            nodeName: SECTOR
          - locationName: LOAD
            nodeName: LOAD_OPC_CUSTOMER_SIZE_BAND
          - locationName: UNKNOWN
            nodeName: LOADOPC_CUSTOMER_SIZE_BAND
        join:
          joinCondition: |-
            FROM {{ ref('DIM','ACCOUNT') }} ACCOUNT
              LEFT JOIN {{ ref('DIM','SECTOR') }} SECTOR
                ON ACCOUNT.ACCOUNTLINEOFBUSINESS = SECTOR.SECTORNAME
              LEFT JOIN {{ ref('UNKNOWN','LOADOPC_CUSTOMER_SIZE_BAND') }} LOADOPC_CUSTOMER_SIZE_BAND
                ON ACCOUNT.CUSTOMER_SIZE_CODE = LOADOPC_CUSTOMER_SIZE_BAND.CUSTOMER_SIZE_CODE
               AND ACCOUNT.ACCOUNTCLASSIFICATIONNAME =LOADOPC_CUSTOMER_SIZE_BAND.ACCOUNTCLASSIFICATIONNAME
             WHERE ACCOUNT.ACCOUNTCLASSIFICATIONNAME NOT IN ('SUPPLIER DEEMED ELIGIBLE', 'UNCLASSIFIED')
               AND ACCOUNT.ACCOUNTLINEOFBUSINESS ='PUBLIC'
               AND ACCOUNT.ORGANIZATIONID <>14
        name: OPC_ACCOUNT
        noLinkRefs: []
  name: OPC_ACCOUNT
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
