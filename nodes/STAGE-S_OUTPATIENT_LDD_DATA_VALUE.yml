fileVersion: 1
id: ade37d4e-d83f-4407-b139-f5f8d334d5ea
name: S_OUTPATIENT_LDD_DATA_VALUE
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: false
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f0280ae-435b-4e9f-9197-fb97324bf7da
          stepCounter: ade37d4e-d83f-4407-b139-f5f8d334d5ea
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SCHEDULE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95343780-cbd2-4bea-a071-24f2b6dd0726
          stepCounter: ade37d4e-d83f-4407-b139-f5f8d334d5ea
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: TREATMENT_DELAY_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: NULLIF(MAX(ds_pims_reference_values.rfval_refno),1000020260)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7c2dcae-ab2a-4b3c-a58b-49742a80f022
          stepCounter: ade37d4e-d83f-4407-b139-f5f8d334d5ea
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: TREATMENT_DECISION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: NULLIF(MAX(ds_pims_ldd_local_datavalues.ussob_dttm_value_1),getdate())
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f1faff1-f326-4591-82f1-239f086b40b4
          stepCounter: ade37d4e-d83f-4407-b139-f5f8d334d5ea
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: SORCE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da06e8b4-614d-4478-a332-d66b3d2ab12f
          stepCounter: ade37d4e-d83f-4407-b139-f5f8d334d5ea
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: UNKNOWN
            nodeName: DS_SHARED_SCHEDULE
        join:
          joinCondition: |-
            FROM ds_shared_schedule,
                   ds_pims_ldd_local_datavalues,
                   ds_pims_reference_values
             WHERE ds_shared_schedule.schedule_reference_no = ds_pims_ldd_local_datavalues.sorce_refno
               AND ds_pims_ldd_local_datavalues.sorce_code = 'SCHDL'
               AND ds_pims_reference_values.rfvdm_code IN ('CTTDR')
               AND CONVERT(varchar, ds_pims_reference_values.rfval_refno) IN (USSOB_VALUE_1)
             GROUP BY ds_pims_ldd_local_datavalues.sorce_code,
                      ds_shared_schedule.schedule_reference_no
        name: S_OUTPATIENT_LDD_DATA_VALUE
        noLinkRefs: []
  name: S_OUTPATIENT_LDD_DATA_VALUE
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
