fileVersion: 1
id: e14d9513-78cc-436a-b138-5ef32c30f66a
name: DIM_PROGRAM
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Program is a county-specific line of business, such as Monterey Medi-Cal."
  isMultisource: false
  locationName: EDW
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57c028d9-dbb2-4e7d-a16f-fdc39ade54d4
          stepCounter: e14d9513-78cc-436a-b138-5ef32c30f66a
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_PROGRAM_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a737fc2-1a1d-497a-93e4-a0f5a751841f
          stepCounter: e14d9513-78cc-436a-b138-5ef32c30f66a
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: Program Number
        isBusinessKey: true
        name: PROGRAMNUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d08efd2e-dcbb-4dd3-8da6-7bec5fd103f4
                stepCounter: c6c2bb5c-526d-47e1-b9b0-fd8b17905c24
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f5323ba-4eaf-4e85-ac31-d96d50b9a8f0
          stepCounter: e14d9513-78cc-436a-b138-5ef32c30f66a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: short abbreviation for a program
        name: PROGRAMABBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3de85d17-bd46-4d6e-bee7-456fdfc55ca1
                stepCounter: c6c2bb5c-526d-47e1-b9b0-fd8b17905c24
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94523e4e-9a16-46ba-895c-37838aa374f4
          stepCounter: e14d9513-78cc-436a-b138-5ef32c30f66a
        config: {}
        dataType: VARCHAR(60)
        defaultValue: ""
        description: Long description for a program
        name: PROGRAMDESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90d9ed88-fc30-43b2-ae81-ebb7010c6ebd
                stepCounter: c6c2bb5c-526d-47e1-b9b0-fd8b17905c24
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: faaac763-fc8a-4226-9500-028d1c0c4900
          stepCounter: e14d9513-78cc-436a-b138-5ef32c30f66a
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: County Code for the program
        name: PROGRAMCOUNTYCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 349f61ae-39d5-49ea-a5a1-0b00f60065ed
                stepCounter: c6c2bb5c-526d-47e1-b9b0-fd8b17905c24
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc649689-64b7-4537-b5d1-a98adffe33f8
          stepCounter: e14d9513-78cc-436a-b138-5ef32c30f66a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: County name for the program
        name: PROGRAMCOUNTYDESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 355fb40c-72b4-4656-881e-6ed28a146ef4
                stepCounter: c6c2bb5c-526d-47e1-b9b0-fd8b17905c24
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78e3d2b2-c407-4bf6-bbb0-69196475d4d1
          stepCounter: e14d9513-78cc-436a-b138-5ef32c30f66a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: region for the program (Santa Cruz or Merced)
        name: REGIONALGROUPDESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9609d53f-eea6-4195-9fe6-080460e328a1
                stepCounter: c6c2bb5c-526d-47e1-b9b0-fd8b17905c24
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98100278-9d8b-47e6-bcb8-b3fd92e3bcf1
          stepCounter: e14d9513-78cc-436a-b138-5ef32c30f66a
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: Line of Business for the program
        name: PROGRAMLINEOFBUSINESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 998b27bf-d3ce-4e3c-915c-547dce2480ec
                stepCounter: c6c2bb5c-526d-47e1-b9b0-fd8b17905c24
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 561fb37b-a999-4581-ac31-bc22b06c770f
          stepCounter: e14d9513-78cc-436a-b138-5ef32c30f66a
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: Line of Business type short description
        name: PROGRAMLOBTYPEABBREVIATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e816af46-d46d-4a0a-96b7-e6e3523604f4
                stepCounter: c6c2bb5c-526d-47e1-b9b0-fd8b17905c24
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 118ee66e-2ee2-4518-814c-231d8985aae4
          stepCounter: e14d9513-78cc-436a-b138-5ef32c30f66a
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: Program type long description
        name: PROGRAMLOBTYPEDESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f6765f49-90d2-4753-ab0b-f87eee3e4029
                stepCounter: c6c2bb5c-526d-47e1-b9b0-fd8b17905c24
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 548347e5-e108-495c-8a1e-15a709f7e1c9
          stepCounter: e14d9513-78cc-436a-b138-5ef32c30f66a
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: 'The government agency or contracting entity that oversees the program.  '
        name: PROGRAMGOVERNINGBODY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b03053dd-5daa-407d-81f2-12d334360185
                stepCounter: c6c2bb5c-526d-47e1-b9b0-fd8b17905c24
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f937d853-70ee-45e2-8ca3-e1891247ac76
          stepCounter: e14d9513-78cc-436a-b138-5ef32c30f66a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date the program started in county
        name: PROGRAMSTARTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e27c7d5d-9540-42da-ade9-2f46d33d0e6a
                stepCounter: c6c2bb5c-526d-47e1-b9b0-fd8b17905c24
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95b42c94-ae8a-484c-9d83-c6a60486fa0a
          stepCounter: e14d9513-78cc-436a-b138-5ef32c30f66a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date the program ended in the county
        name: PROGRAMENDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76384501-ae45-4ed0-b642-58b6407bd153
                stepCounter: c6c2bb5c-526d-47e1-b9b0-fd8b17905c24
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7107169e-e8f2-45b6-90bc-80380c653593
          stepCounter: e14d9513-78cc-436a-b138-5ef32c30f66a
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Indicates whether program is active or inactive, based on the program end date
        name: PROGRAMACTIVEIND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3ff111c1-35c4-49c7-8a96-5020b0e12b5b
                stepCounter: c6c2bb5c-526d-47e1-b9b0-fd8b17905c24
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 576135f6-6bbd-4cad-8597-2ba48bbddef9
          stepCounter: e14d9513-78cc-436a-b138-5ef32c30f66a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: DHCS Program Code
        name: PROGRAMPLANCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 379fb2d6-856c-4517-8380-1a08b46f7f92
                stepCounter: c6c2bb5c-526d-47e1-b9b0-fd8b17905c24
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f527ec2-b4a6-453e-833e-6cfd70f10fdd
          stepCounter: e14d9513-78cc-436a-b138-5ef32c30f66a
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: Medi-Cal Program Indicator
        name: ISMEDICAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 73bafe91-3722-480e-a0a1-1c416e404891
                stepCounter: c6c2bb5c-526d-47e1-b9b0-fd8b17905c24
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9acb61c9-6b4e-4e95-b03c-c7efc47221fa
          stepCounter: e14d9513-78cc-436a-b138-5ef32c30f66a
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: Medicare-related Indicator
        name: ISMEDICARE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 41b96240-e158-4a8d-9833-75ac2a08d1ec
                stepCounter: c6c2bb5c-526d-47e1-b9b0-fd8b17905c24
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59dcbb83-e071-467c-a691-c4312c2c4e67
          stepCounter: e14d9513-78cc-436a-b138-5ef32c30f66a
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: Data Source of Record
        name: DSS_SOURCE_SYSTEM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 44169677-458f-4732-9e87-8e005f3cd93b
                stepCounter: c6c2bb5c-526d-47e1-b9b0-fd8b17905c24
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5bed1f5e-24aa-416c-8336-b49c9f27f42d
          stepCounter: e14d9513-78cc-436a-b138-5ef32c30f66a
        config: {}
        dataType: CHAR(32)
        defaultValue: ""
        description: MD5 Change Hash
        name: DSS_CHANGE_HASH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00af7711-3886-4cb0-83cc-4dd0419e4be7
                stepCounter: c6c2bb5c-526d-47e1-b9b0-fd8b17905c24
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03792a75-594a-4c3c-84b9-fb3adc6c9dc0
          stepCounter: e14d9513-78cc-436a-b138-5ef32c30f66a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_DIM_PROGRAM_FINAL: c6c2bb5c-526d-47e1-b9b0-fd8b17905c24
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: STAGE
            nodeName: STAGE_DIM_PROGRAM_FINAL
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','STAGE_DIM_PROGRAM_FINAL') }} stage_dim_Program_final
             WHERE stage_dim_Program_final.DSS_CHANGE_HASH <> IFNULL(dim_Program.DSS_CHANGE_HASH,'')
               AND stage_dim_Program_final.RANKING = 1
        name: DIM_PROGRAM
        noLinkRefs: []
  name: DIM_PROGRAM
  overrideSQL: false
  schema: ""
  sqlType: Dimension
  type: sql
  version: 1
type: Node
