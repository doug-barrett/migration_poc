fileVersion: 1
id: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
name: S_EVITALS_OBSERVATION_SET_03
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Get more details about the linked ED and IP events."
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6de54df8-ed23-4f2c-963e-6c6d111c3d74
          stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient NHI number.
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7bd77763-1ace-482a-8fca-2aa24b6229a1
                stepCounter: 637621f1-ebc9-4e62-b367-3187a03d45a5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 60451795-af65-443c-b576-e9f2f65cc24d
          stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: 'Internal unique identifier for a patient from the Patient Management System '
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5afc370-1985-444c-8869-4c6ee25d0d27
                stepCounter: 637621f1-ebc9-4e62-b367-3187a03d45a5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 23eebd64-a492-45af-adfc-a14b18a60a74
          stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: Inpatient or ED event associated with the observation set for the patient.
        name: ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 008d4082-ab2a-471d-90ae-dead8f8cfa50
                stepCounter: 637621f1-ebc9-4e62-b367-3187a03d45a5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7cd41fec-ba62-4c4a-a367-1f576ab2373d
          stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: Look up to Patient Management System to match Inpatient or ED event associated with the observation set for the patient as PatienTrack version becomes unreliable under certain conditions
        name: MATCHED_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5fca8c15-49ca-4c1c-ab5c-244e33883c4c
                stepCounter: 7ce22382-e113-45ba-aa61-7288091a4d7b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b553899-09a6-4a62-8f11-381338999d2c
          stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
        config: {}
        dataType: INT
        defaultValue: ""
        description: Integer ID that uniquely identifies a patient admission in Patientrack. Sourced from admsn_pk.
        name: ADMISSION_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4d57a0f8-8b05-4833-843c-53acf0a310ee
                stepCounter: 637621f1-ebc9-4e62-b367-3187a03d45a5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d138cc62-2d33-4fa6-9b26-139b0a7bce44
          stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
        config: {}
        dataType: INT
        defaultValue: ""
        description: Integer ID that uniquely identifies an observation set in Patientrack. Sourced from obset_pk.
        name: OBSERVATION_SET_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8b9106e-ffb9-42b3-87c0-d00326b77646
                stepCounter: 637621f1-ebc9-4e62-b367-3187a03d45a5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7c03362-e736-4b7f-94e9-a86823c14a9e
          stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time when the observation measure started.
        name: OBSERVATION_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ed12009-8632-49c2-be2d-aa9b63c5edf4
                stepCounter: 637621f1-ebc9-4e62-b367-3187a03d45a5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c613573-67d6-4d2e-bc58-95138567e0f1
          stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time when the observation measure was due.
        name: OBSERVATION_DUE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64026ce4-577b-49a6-9f79-96914ca33825
                stepCounter: 637621f1-ebc9-4e62-b367-3187a03d45a5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9467d3be-1a62-4f48-a082-be17d587bf03
          stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: 'Date and time when the observation measure was taken. '
        name: OBSERVATION_TAKEN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4499b9e-3da0-4bd0-8a64-c8c99268ed03
                stepCounter: 637621f1-ebc9-4e62-b367-3187a03d45a5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2735ed0b-bbc3-459c-bd8b-121a641a3454
          stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Early Warning Score for the observation.
        name: EWS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a1f7c1a-b461-4190-a081-e120ee9c9539
                stepCounter: 637621f1-ebc9-4e62-b367-3187a03d45a5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 68fc62aa-5dd8-4f0d-9121-040f2bc66321
          stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Set to 1 if the EWS for the observation is greater than the value of parameter eVitals_EWS_alert.
        name: EWS_ALERT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd8ef4a9-3023-4381-a240-0c98d1338a62
                stepCounter: 637621f1-ebc9-4e62-b367-3187a03d45a5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3cefebdf-6800-4540-8c5b-caeb7216060e
          stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Set to 1 if the regime for the observation set is set to anything other than NEWS.
        name: EWS_MODIFIED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 17a1c1e2-4dbc-44c0-8df3-90511bc4fb63
                stepCounter: 637621f1-ebc9-4e62-b367-3187a03d45a5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d7bef01-cd1a-4912-b687-590274f4e7be
          stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: REGIME_MOD_REASON_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 32099340-752f-4363-9b47-86ebd1791118
                stepCounter: 637621f1-ebc9-4e62-b367-3187a03d45a5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81022571-4233-4aa5-a132-c17550a7180f
          stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
        config: {}
        dataType: INT
        defaultValue: ""
        description: Integer ID that uniquely identifies a specialty in Patientrack. Sourced from wardd_rfval.
        name: WARD_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 419038a8-df63-4a73-b3d4-09377d288b2c
                stepCounter: 637621f1-ebc9-4e62-b367-3187a03d45a5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 151a38f9-686e-47da-b328-77abda0932fd
          stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Alphanumeric code that uniquely identifies a ward in Patientrack.
        name: WARD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07ad9648-90c4-4fc9-8378-d57c01345fdb
                stepCounter: 637621f1-ebc9-4e62-b367-3187a03d45a5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0055e85a-5183-4eef-be35-54b1a5857588
          stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
        config: {}
        dataType: INT
        defaultValue: ""
        description: Integer ID that uniquely identifies a specialty in Patientrack. Sourced from spect_rfval.
        name: SPECIALTY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 191cc154-67f6-44f5-8fa6-f4987c6f54ed
                stepCounter: 637621f1-ebc9-4e62-b367-3187a03d45a5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 611d6232-281a-40b7-9837-e84c2fa3a148
          stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Alphanumeric code that uniquely identifies a specialty in Patientrack.
        name: SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed3352c5-81a1-4b5d-9a17-b464bfadeec1
                stepCounter: 637621f1-ebc9-4e62-b367-3187a03d45a5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 728b928b-0f49-4582-a41b-643c50eef2ce
          stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Numbers stays found for each observation start date so that a single row per observation set can be easily selected.
        name: STAY_ROW_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c2f06a6c-bc2b-4943-a499-b407228ccabd
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: ROW_NUMBER() OVER(PARTITION BY s_eVitals_observation_set_01.observation_set_id ORDER BY s_in_patient_stay_05.stay_start_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b9066a02-50a3-4abe-8ed3-d944d14e3afb
          stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Unique identifier for a ward.
        name: WARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d472e0a-9450-43d9-8936-e9c7bcb46f38
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: COALESCE(s_in_patient_stay_05.stay_spont_refno, s_ed_stay_05.spont_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4270bb77-6d2f-4458-8433-0c842eeba116
          stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Unique identifier for a clinician.
        name: CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 387fe979-349f-4207-b25a-b1a1ec419319
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: COALESCE(s_in_patient_stay_05.stay_proca_refno, s_ed_stay_05.proca_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c748caef-b840-4617-b295-41a1bff6e689
          stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Service point (i.e. ward) identifier related to the IP event linked to the eVitals observation.
        name: IP_SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d472e0a-9450-43d9-8936-e9c7bcb46f38
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1dbb8c21-4799-4a7b-93a3-86711919b7c0
          stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Clinician identifier related to the IP event linked to the eVitals observation.
        name: IP_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 387fe979-349f-4207-b25a-b1a1ec419319
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b9024508-6ee6-4e84-97dc-827c5c040193
          stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: IP_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a81084e6-9d1e-4ba7-943e-da806b2afba1
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41a10cca-8bc8-4e7d-87dc-fdbc89bf8819
          stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: IP_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: acf1501d-b3bf-4770-a8eb-377c17b5bb68
                stepCounter: 8df670f5-1ae7-4d72-aa3e-f032f348b011
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf0bac42-f8ca-42eb-b103-c8eb355cd810
          stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Service point (i.e. ward) identifier related to the ED event linked to the eVitals observation.
        name: ED_SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 785fb0ed-30c6-4c09-9c3d-25e3cfe950ce
                stepCounter: 98f05ebc-0bbd-408a-93d3-9ee096f24d3e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5f217c6-e669-40c5-a159-04d551794e3d
          stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Clinician identifier related to the ED event linked to the eVitals observation.
        name: ED_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4fd25562-559b-483e-be77-c339470e6203
                stepCounter: 98f05ebc-0bbd-408a-93d3-9ee096f24d3e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91f495cc-5916-45da-8ac6-be798e81f89f
          stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ED_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed930fe6-e10e-4e2c-8f27-abd9c35f1291
                stepCounter: 98f05ebc-0bbd-408a-93d3-9ee096f24d3e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88979467-84fd-4f2c-a31a-7ea36fa769ca
          stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ED_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 214703f5-38ec-4c14-a6b0-bcf2e4eef5cc
                stepCounter: 98f05ebc-0bbd-408a-93d3-9ee096f24d3e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75fa8481-c0c6-4290-a7f9-5c177f74c949
          stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_EVITALS_OBSERVATION_SET_01
        join:
          joinCondition: |-
            FROM s_eVitals_observation_set_01
              JOIN s_eVitals_observation_set_02
                ON s_eVitals_observation_set_02.observation_set_id = s_eVitals_observation_set_01.observation_set_id
               AND s_eVitals_observation_set_02.row_num = 1
              LEFT OUTER JOIN s_in_patient_stay_05
                ON s_eVitals_observation_set_01.encounter_id = s_in_patient_stay_05.event_encounter_id
               AND s_eVitals_observation_set_01.observation_start_date BETWEEN s_in_patient_stay_05.stay_start_date AND s_in_patient_stay_05.stay_end_date
              LEFT OUTER JOIN s_ed_stay_05
                ON s_ed_stay_05.encounter = s_eVitals_observation_set_01.encounter_id
               AND s_ed_stay_05.attendance_stay_seq_num = s_ed_stay_05.attendance_stay_count
             WHERE s_eVitals_observation_set_01.row_num = 1
        name: S_EVITALS_OBSERVATION_SET_03
        noLinkRefs: []
  name: S_EVITALS_OBSERVATION_SET_03
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
