fileVersion: 1
id: e83f105c-a502-4051-8553-43f3132ea1b6
name: S_MOH_FACILITY
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad0a7ae7-18ab-40f9-a712-f1233ff185d5
          stepCounter: e83f105c-a502-4051-8553-43f3132ea1b6
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: DIM_MOH_EVENT_FACILITY_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 337ce67e-81e5-4c9d-889e-8e157645b1a4
                stepCounter: aa5b5f9e-6c4c-42f3-9b07-2ebe14b90a78
            transform: l_NMDS_dim_event_facility.DIM_EVENT_FACILITY_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 231ba8d1-48b0-4f6a-94b4-41dbc9b7fd17
          stepCounter: e83f105c-a502-4051-8553-43f3132ea1b6
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: AGENCY_FACILITY_BK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf7c870b-b74a-4555-9a3a-d11ff7f1ecac
                stepCounter: dae20ab8-a341-4bb4-bdad-a6ba497fb7e2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ce2af2c-12e4-444d-af6b-67bbe0073126
          stepCounter: e83f105c-a502-4051-8553-43f3132ea1b6
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: AGENCY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f88f754-3eba-4467-9046-ebe755a7dd89
                stepCounter: dae20ab8-a341-4bb4-bdad-a6ba497fb7e2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7654d020-47ea-45ad-9146-18f3a24baadd
          stepCounter: e83f105c-a502-4051-8553-43f3132ea1b6
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: AGENCY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c9882b2c-86c6-4d35-a22d-d65c7c4c8d34
                stepCounter: dae20ab8-a341-4bb4-bdad-a6ba497fb7e2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0067da2-500a-42dc-8c75-423aed1adc24
          stepCounter: e83f105c-a502-4051-8553-43f3132ea1b6
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: AGENCY_ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 92b1aab8-1993-48ea-a961-d21a97ef3948
                stepCounter: dae20ab8-a341-4bb4-bdad-a6ba497fb7e2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 478ae4fe-dc2b-4132-9a29-809e27a3b43c
          stepCounter: e83f105c-a502-4051-8553-43f3132ea1b6
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: AGENCY_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0bc484ae-ec2b-45c3-bf0a-5836c59d792c
                stepCounter: dae20ab8-a341-4bb4-bdad-a6ba497fb7e2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78f44ddb-2b02-4f2a-95da-d94346f6f321
          stepCounter: e83f105c-a502-4051-8553-43f3132ea1b6
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: AGENCY_TYPE_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 61addc40-48bb-4fb8-a46d-b7d020ca46b0
                stepCounter: dae20ab8-a341-4bb4-bdad-a6ba497fb7e2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 812438e7-19cb-4e98-802d-9fd735bd86cc
          stepCounter: e83f105c-a502-4051-8553-43f3132ea1b6
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: AGENCY_OPEN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8a140325-2feb-4a6d-9303-4d88630b6396
                stepCounter: dae20ab8-a341-4bb4-bdad-a6ba497fb7e2
            transform: CONVERT(date, NULLIF(agency_open_date, ''))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de9ed23e-d7cf-46cf-88b1-2a047ad5ea13
          stepCounter: e83f105c-a502-4051-8553-43f3132ea1b6
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: AGENCY_CLOSE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3343e23c-4dc2-493a-a3d4-724d3095d184
                stepCounter: dae20ab8-a341-4bb4-bdad-a6ba497fb7e2
            transform: CONVERT(date, NULLIF(agency_close_date, ''))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 991dec88-393d-49fe-ac62-74a2366d9d39
          stepCounter: e83f105c-a502-4051-8553-43f3132ea1b6
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: REGION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3f98236f-0b39-4f86-89a0-55eae1ccee88
                stepCounter: dae20ab8-a341-4bb4-bdad-a6ba497fb7e2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39d15190-153e-4401-b2f3-119adca104f2
          stepCounter: e83f105c-a502-4051-8553-43f3132ea1b6
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: DHB_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f93fecd1-a521-4fc1-9d83-ff11adbca1fc
                stepCounter: dae20ab8-a341-4bb4-bdad-a6ba497fb7e2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 909612f8-3554-41e8-902e-67e080100ab0
          stepCounter: e83f105c-a502-4051-8553-43f3132ea1b6
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: DHB_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e52759da-2a66-4f9e-acb3-705916287d07
                stepCounter: dae20ab8-a341-4bb4-bdad-a6ba497fb7e2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 769f5edf-ac1d-4251-8e1c-ea7300b1f748
          stepCounter: e83f105c-a502-4051-8553-43f3132ea1b6
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: FACILITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eee8692e-dd78-42c4-9c5e-e5c136e444a5
                stepCounter: dae20ab8-a341-4bb4-bdad-a6ba497fb7e2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1498d9da-ede1-4ea4-851a-e08bd52b273b
          stepCounter: e83f105c-a502-4051-8553-43f3132ea1b6
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: FACILITY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e34a1a69-67e8-4ce3-97c8-7242e5fa1961
                stepCounter: dae20ab8-a341-4bb4-bdad-a6ba497fb7e2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e14c78bc-037a-4e2f-ba45-5c2f37534d09
          stepCounter: e83f105c-a502-4051-8553-43f3132ea1b6
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: CURRENT_FACILITY_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 46a1ee9f-7da6-4f7c-ab53-525e5b1fd60c
                stepCounter: dae20ab8-a341-4bb4-bdad-a6ba497fb7e2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e609d1e-cda5-4b34-a193-f6b2ecaeb775
          stepCounter: e83f105c-a502-4051-8553-43f3132ea1b6
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: FACILITY_TYPE_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19ea2cdd-1782-409f-976b-075941d8fac1
                stepCounter: dae20ab8-a341-4bb4-bdad-a6ba497fb7e2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 62b75ba1-f910-478e-96a1-71d0cbbe0c20
          stepCounter: e83f105c-a502-4051-8553-43f3132ea1b6
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: FACILITY_ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56fcd524-33d2-403c-a2d2-e5f0eaedf396
                stepCounter: dae20ab8-a341-4bb4-bdad-a6ba497fb7e2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d855dc3-5318-496d-924b-7f3f57b1d361
          stepCounter: e83f105c-a502-4051-8553-43f3132ea1b6
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: FACILITY_OPEN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cdaef5ae-cafa-453b-be55-477f27220de5
                stepCounter: dae20ab8-a341-4bb4-bdad-a6ba497fb7e2
            transform: CONVERT(date, NULLIF(facility_open_date, ''))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1bb8cbbe-4b36-4684-a745-24a29cde7b54
          stepCounter: e83f105c-a502-4051-8553-43f3132ea1b6
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: FACILITY_CLOSE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1fcb4435-8b77-4df0-80ce-f5ef705997cc
                stepCounter: dae20ab8-a341-4bb4-bdad-a6ba497fb7e2
            transform: CONVERT(date, NULLIF(facility_close_date, ''))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 573df90a-3121-405d-b118-c5507396539e
          stepCounter: e83f105c-a502-4051-8553-43f3132ea1b6
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: DOMICILE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83ed66ce-ff36-4059-898d-8352ac7b9255
                stepCounter: dae20ab8-a341-4bb4-bdad-a6ba497fb7e2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5eff9193-ddcc-4160-9103-3495915ccfa3
          stepCounter: e83f105c-a502-4051-8553-43f3132ea1b6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: L_NMDS_DHB_EVENTS_ALL
        join:
          joinCondition: |-
            FROM l_NMDS_dim_event_facility
             WHERE dim_event_facility_key IN (
                    SELECT DISTINCT dim_event_facility_key
                      FROM l_NMDS_dhb_events_all
                   )
        name: S_MOH_FACILITY
        noLinkRefs: []
  name: S_MOH_FACILITY
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
