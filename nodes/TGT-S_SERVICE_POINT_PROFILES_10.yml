fileVersion: 1
id: b57c78e5-df93-479d-bfee-e98396c879fe
name: S_SERVICE_POINT_PROFILES_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a8074d3-f3aa-4dea-a6d1-433f1f44224d
          stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: SERVICE_POINT_PROFILE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 89831664-3294-4f0a-95a0-0f5f77d797ed
                stepCounter: 8ab86d6f-e6ab-4a86-9aa5-69a7f463850e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d18d542-aa7a-4f21-8b2e-2dfecc8a5865
          stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: SERVICE_POINT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 975b506d-dd9a-4e0b-8a69-4d8ef052f0db
                stepCounter: 8ab86d6f-e6ab-4a86-9aa5-69a7f463850e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 164f476c-1277-4c10-aadb-2e383a249d72
          stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TRENDCARE_WARD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cdbc00c1-2798-480c-94e0-a1400c2e9ab6
          stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: SERVICE_POINT_BAY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9e07f275-aa7a-436f-9e9b-06e4f0e0d6ca
                stepCounter: 8ab86d6f-e6ab-4a86-9aa5-69a7f463850e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 626f90ac-041c-417f-9527-1929cb824bcf
          stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: SERVICE_POINT_BED_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c88167e-c425-4514-8c58-8e202b67c825
                stepCounter: 8ab86d6f-e6ab-4a86-9aa5-69a7f463850e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6fa64817-2531-40bc-b718-2a70fdff18be
          stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8cd6e449-476f-4525-88bb-bb4c8e8aee7e
                stepCounter: 8ab86d6f-e6ab-4a86-9aa5-69a7f463850e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 106855a0-9dcf-4e30-b093-8d0fa272aef8
          stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: PROFESSIONAL_CARER_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4bcc1ddc-c082-4257-8be0-a01fe53fd5e6
                stepCounter: 8ab86d6f-e6ab-4a86-9aa5-69a7f463850e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ef5e639-7728-47d9-81b9-9dbef25dfd7a
          stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ' Beds surrogate key  '
        name: BED_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2345243-f731-4a5a-85e9-210c38c5589e
                stepCounter: 8ab86d6f-e6ab-4a86-9aa5-69a7f463850e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b0f670f-63e3-438c-8fce-580ff1ba8527
          stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: REFERENCE_VALUE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3830f8b1-bba2-4fe0-8b8e-fb6e3b867af0
                stepCounter: 8ab86d6f-e6ab-4a86-9aa5-69a7f463850e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 945f7981-bc62-4529-87ae-87a08f122267
          stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: RULES_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd110ae0-96c9-4c29-93c4-3c00df9c66c8
                stepCounter: 8ab86d6f-e6ab-4a86-9aa5-69a7f463850e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2cfdb70-6760-4f81-a24d-46a64fa8c7bc
          stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: OPERATOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 65c31a54-b7a1-4b15-8a82-1d4ff1ff0b2e
                stepCounter: 8ab86d6f-e6ab-4a86-9aa5-69a7f463850e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc759f21-32e4-4590-9224-429ee421dc5d
          stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SERVICE_POINT_PROFILE_VALUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e8e3e4ba-0a38-41e8-8be4-bfa95e732b92
                stepCounter: 8ab86d6f-e6ab-4a86-9aa5-69a7f463850e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd16ed9e-77d8-450d-8ba2-44c704ee56d7
          stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: BED_CATEGORY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e6c480d7-b621-4036-9118-0d4610833132
                stepCounter: 8ab86d6f-e6ab-4a86-9aa5-69a7f463850e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e0e86b5-e6a7-4466-ae5d-086fa611c8ab
          stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SERVICE_POINT_PROFILE_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 404fc0df-2f76-4b7d-9633-f4d75201ab8c
                stepCounter: 8ab86d6f-e6ab-4a86-9aa5-69a7f463850e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 12dd13c2-66fc-44bf-af73-d44041205bae
          stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SERVICE_POINT_PROFILE_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd16acd3-77a8-4a2b-8592-313cd7db2798
                stepCounter: 8ab86d6f-e6ab-4a86-9aa5-69a7f463850e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7bd0f47-05ae-4b58-beaa-4bf4dfefe0aa
          stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SERVICE_POINT_PROFILE_CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39b2f215-16ce-40ee-8504-14995855ec01
                stepCounter: 8ab86d6f-e6ab-4a86-9aa5-69a7f463850e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e72c5d0-d000-4d60-bf2e-c6e0ef34b699
          stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SERVICE_POINT_PROFILE_MODIFIED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f07e74cc-343a-4651-80f3-69cd77c4d87b
                stepCounter: 8ab86d6f-e6ab-4a86-9aa5-69a7f463850e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d776e239-4de8-4b68-835f-44184dfc603c
          stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SERVICE_POINT_PROFILE_USER_CREATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3912ff1f-3023-421c-8bb0-dffe70f0eeec
                stepCounter: 8ab86d6f-e6ab-4a86-9aa5-69a7f463850e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee2b8341-56e6-4379-af02-8da71d7e0f99
          stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SERVICE_POINT_PROFILE_USER_MODIFIED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e39ccc0a-8238-4499-abaa-574165b1ed30
                stepCounter: 8ab86d6f-e6ab-4a86-9aa5-69a7f463850e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 940cf415-3686-4724-ae72-27c88d7d747c
          stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: ARCHIVE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de48b57f-7fa5-45be-9770-c4aa31db9f97
                stepCounter: 8ab86d6f-e6ab-4a86-9aa5-69a7f463850e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9b8dadf-38c6-4807-9635-8f9646687cb4
          stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: 'Surrogate Key of last session transaction affecting this row.  '
        name: SESSION_TRANSACTION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3dba1d69-451f-40fe-8a00-826f615da980
                stepCounter: 8ab86d6f-e6ab-4a86-9aa5-69a7f463850e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1dc635f-7adc-4e62-b713-1f7263fddca2
          stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EXTERNAL_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03f77740-26a6-42b3-9d79-067f6a488c90
                stepCounter: 8ab86d6f-e6ab-4a86-9aa5-69a7f463850e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea12a9fd-6c55-4c53-88ca-3253c0d43b06
          stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: SERVICE_POINT_CHANGE_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c363530-699b-4400-9b65-2c1f58c49389
                stepCounter: 8ab86d6f-e6ab-4a86-9aa5-69a7f463850e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2731d1d8-e1ae-4d70-ba9d-1a90e532966a
          stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: WARD_PROFILE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 837e5607-ea3e-4486-b7ee-d4f6b9729c93
                stepCounter: 8ab86d6f-e6ab-4a86-9aa5-69a7f463850e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ea96ec1-68f5-404d-99b2-97c3f708c5c5
          stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SERVICE_POINT_PROFILE_PLANNED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc6b4f66-da4d-4b10-8fee-732cebebbf47
                stepCounter: 8ab86d6f-e6ab-4a86-9aa5-69a7f463850e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f938b0b-10d0-44e1-bfd7-33541f99c6e6
          stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: OWNER_HEALTH_ORGANISATION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 252c9b81-bd9c-4267-8fdd-3021fa8470d0
                stepCounter: 8ab86d6f-e6ab-4a86-9aa5-69a7f463850e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d12830e-4f4b-4b6c-b8bc-af67afacf585
          stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_service_point_profiles_10.service_point_reference_no=dim_service_point.service_point_reference_no
        name: DIM_SERVICE_POINT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 66428538-0101-4e75-9137-beccf8a67c9a
                stepCounter: 331048bb-7ff9-400f-b8c4-4ac7cc91d7e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0be9ccfa-ceca-47f1-89ab-e114bfd58e68
          stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
        config: {}
        dataType: INT
        defaultValue: ""
        description: s_service_point_profiles_10.specialty_reference_no=dim_specialty.specialty_reference_no
        name: DIM_SPECIALTY_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79aee918-ff6f-4b0a-a656-000827899f3e
                stepCounter: 4182a75e-d07b-4637-97fa-4c01e2878360
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ecf6a71d-3a7d-437a-8cdc-fbbfe7b3669b
          stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_service_point_profiles_10.professional_carer_reference_no=dim_healthcare_professional.healthcare_professional_reference_no
        name: DIM_HEALTHCARE_PROFESSIONAL_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b3b22451-95b4-47f3-b7c1-48136447e09b
                stepCounter: 2b7fcd6a-6a5f-4454-9d5e-f87e946f60fa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 379b8c4f-c492-4e8f-8465-87a144db7b86
          stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 302b23a1-4c97-42e6-98ea-efe8908f05c3
          stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Operator in service_point_profile is '-' (minus) indicating the total number of closed beds
        name: IPM_CLOSED_BEDS
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN OPERATOR = '-' THEN value
                          ELSE 0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7baf2f43-2444-4af6-9751-eaaab7a384fe
          stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Operator in service_point_profile is = indicating the total number of physical beds
        name: IPM_PHYSICAL_BEDS
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN OPERATOR = '=' THEN value
                          ELSE 0
                           END
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: L_PIMS_SERVICE_POINT_PROFILES
        join:
          joinCondition: |-
            FROM l_pims_service_point_profiles
              JOIN ds_mappings_service_points
                ON ds_mappings_service_points.spont_refno = l_pims_service_point_profiles.spont_refno
               AND ds_mappings_service_points.end_date IS NULL
             WHERE l_pims_service_point_profiles.archv_flag = 'N'
               AND (l_pims_service_point_profiles.modif_dttm > @v_pa_inpatient_incremental OR ds_mappings_service_points.dss_update_time > @v_pa_inpatient_incremental)
        name: S_SERVICE_POINT_PROFILES_10
        noLinkRefs: []
  name: S_SERVICE_POINT_PROFILES_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
