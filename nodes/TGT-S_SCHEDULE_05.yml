fileVersion: 1
id: fc747bd5-7053-43a8-9d29-af514a058fe1
name: S_SCHEDULE_05
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Schedule Type (Code)   'CNTCT' = Contact  'NPBAC' = Contact (Non-Patient Based Activity)  'OTPAT' = Outpatient  'THEAT' = Surgical Theatre"
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5cd99a07-0007-450f-8449-eaef7286bd90
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SCHEDULE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b5ab558-a34e-4fd8-9b8e-311c0d96346a
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3750fcd5-93b3-46a8-acf2-4599b1e94ebe
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SCHEDULE_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8824d637-5987-4055-bb23-efe67780c146
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2da573f4-2884-4464-bb5c-4b21f868800c
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: SCHEDULE_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fbb01e3b-4612-47c8-9a4a-5d6abddc60ef
                stepCounter: 06fa4241-360c-43d0-8e4a-8b860f92fc09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 652e5e3f-468e-411f-a44a-5898936228d2
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SCHEDULE_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b5ab558-a34e-4fd8-9b8e-311c0d96346a
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: "'T'+CONVERT(varchar,ds_pims_schedules.schdl_refno)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c38e465-256b-4c35-a411-f23c1652f127
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PARENT_SCHEDULE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c5f73ea-acfb-4af5-820e-0e674c22c0ce
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5df1cde9-8599-4e93-9edc-9c7abe63a315
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b97bdc6-cf45-46a3-b6b6-36dca9fe2232
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: IFNULL(ds_pims_schedules.patnt_refno,ds_pims_schedules_p.patnt_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f33aab3d-c8cd-4cac-a1f6-73ea8636c9d3
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60bbe3fa-43fe-4657-ac28-76e533f4a346
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: IFNULL(ds_pims_schedules.spect_refno,ds_pims_schedules_p.spect_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1c4bba7-a12d-4153-b6b7-36edc6d4e201
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Health Specialty Code
        name: HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eb9f10c2-27db-445e-baee-c136d6d85afd
                stepCounter: 810f0140-d555-4744-97b7-398fe4ee4d78
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7432f029-61bd-467e-910e-d35c2f5b77c5
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0316b81f-4748-44f1-80f4-a91999ba799c
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: IFNULL(ds_pims_schedules.proca_refno,ds_pims_schedules_p.proca_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba91014d-c70e-48bc-8134-2f7abd31d49b
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b113274-654e-463e-960f-6d804d4bea85
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: IFNULL(ds_pims_schedules.spont_refno,ds_pims_schedules_p.spont_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dcf1b09b-45bd-4e97-a6f6-80b3fe8bb507
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WARD_TRANSFER_TO_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab427a4c-65f5-4b0a-a128-a55ca053ea68
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b24adbf2-29ff-4772-8469-d3f62783c137
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: baa08465-b3f2-4440-b391-88b5934cedf0
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21327020-d048-4154-bb12-23f48e617ad0
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3d5fad60-aeb3-445c-ac8a-50a6290df729
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 510c3de8-86a2-4576-997f-10c9ae1810f8
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ED_ATTENDANCE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7be05faf-ca2a-4713-bbab-0b8120601801
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 541b2743-b541-4dde-9d1f-21e77597fc65
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: IP_WARD_STAY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72335e71-39a5-4d6c-ab26-c3908b823fca
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fcd09818-233f-427e-a654-21d0383c1876
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REQUEST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc484e8b-5901-4477-9488-a4471434433e
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f810e9fb-2140-4e03-9cfe-9bb418d929b3
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec8fa2c5-ca35-4bea-9290-bc50185e05e7
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: COALESCE(ds_pims_schedules.start_dttm,ds_pims_schedules_p.start_dttm,CONVERT(datetime,'19840701'))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e212f986-562e-4934-8d96-f93299ea75de
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47aba488-a08d-44c7-a39c-dff4d9faf905
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: COALESCE(ds_pims_schedules.end_dttm,ds_pims_schedules_p.end_dttm,CONVERT(datetime,'19840701'))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d154ddd1-0a99-4dc5-897c-370e916a6c3e
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CALLED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91773d76-de1a-4fa1-abbb-721a71e51e5f
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15141f8a-d76f-4aa5-b349-ae32797d7d6f
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ARRIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 42dc6e15-0bae-4d3a-bc34-2382e756620e
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7da1e53-2b79-449b-a0e3-33fbdae5a8da
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SEEN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05061787-8189-4211-8374-c5bda53d20cc
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18714ebf-4cd5-41bc-8efb-71ea7aefab6a
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DEPARTED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56262cc4-3c5d-4bb2-aff2-25f462272168
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2a4b4d7-2b39-4038-89cd-6ab0d3808c1b
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CANCELLATION_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa7cb54b-d3ea-4367-8d24-8f4cb8e99a97
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 043bd800-edda-4eee-a722-e633a6407de5
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: CANCELLATION_REASON_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 293516cc-4340-412e-87c5-a3cad5721421
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CANCELLATION_BY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bb1921f3-2f31-47db-9efd-d5afb08e390c
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16958820-5376-4cac-8b33-263c93ed2f5c
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CANCELLATION_REASON_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb2710e7-b881-4bb5-ae2b-0889a66f4b3a
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6079a938-628e-4651-8965-0347f7e55773
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: INTO_THEATRE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c01145d-05ea-469e-a23e-c6e535beaa5f
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d55370b-7f0e-4c9c-a06f-6a4e7d84d369
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: INTO_POSTOP_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6729847a-5cf2-44b7-bdec-f6e832938444
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc306c7b-371b-44a4-9e03-9de14e4adae3
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ANAESTHETIC_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3893369d-9605-4e98-b786-e0115a7c7f67
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf5b11ee-ca9b-41c3-9791-0dd2cf190a41
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SCHEDULE_MOVEMENT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: afe920aa-72e2-4941-a599-c6672965acf6
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 589c8c22-fd4e-4d67-afd9-6991de9daf45
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: DECIMAL(4)
        defaultValue: ""
        description: ""
        name: MOVE_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5408f32c-36bf-41c5-9484-5e9fab4255ad
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0c49be3-1d0d-483f-bc13-29a828b97223
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SCHEDULE_MOVEMENT_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a5adc512-d976-46a8-8907-62a6b8c198df
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f943bf8-a6c4-460d-be71-71cf5ecbee04
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SCHEDULE_MOVEMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5408f32c-36bf-41c5-9484-5e9fab4255ad
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b6efed6-fb24-4cb3-920d-58d7b063d022
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: schedule_theatre_status_code, "A=Actual", "P=Planned", "C=Cancelled"
        name: SCHEDULE_THEATRE_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb2710e7-b881-4bb5-ae2b-0889a66f4b3a
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: |-
              CASE WHEN ds_pims_schedules.cancr_dttm IS NOT NULL THEN 'C'
                          ELSE CASE WHEN ds_pims_schedules.start_dttm IS NOT NULL AND ds_pims_schedules.start_dttm > getdate() THEN 'P' ELSE 'A' END
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7810fc8f-5389-4c74-a99b-66b84b0d3d16
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: schedule_outpatient_status_code, "A=Actual", "P=Planned", "C=Cancelled"
        name: SCHEDULE_OUTPATIENT_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb2710e7-b881-4bb5-ae2b-0889a66f4b3a
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: |-
              CASE WHEN ds_pims_schedules.cancr_dttm IS NOT NULL THEN 'C'
                          WHEN ds_pims_schedules.attnd_refno = 11540    THEN 'P'
                          ELSE 'A'
                           END -- Attendance "Not Specified"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b648ddf5-63d5-4fc9-b4c8-8469c728aa28
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: schedule_contact_status_code, "A=Actual", "P=Planned", "C=Cancelled"
        name: SCHEDULE_CONTACT_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb2710e7-b881-4bb5-ae2b-0889a66f4b3a
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: |-
              CASE WHEN ds_pims_schedules.cancr_dttm IS NOT NULL   THEN 'C'
                          WHEN ds_pims_schedules.arrived_dttm IS NOT NULL THEN 'A'
                          ELSE 'P'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 243b7fa5-2276-41d7-9a74-cb6d2954b25c
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SERVICE_POINT_SESSION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 849899d1-23c5-4751-9dee-2a919651f1c0
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 638b542a-b727-4e06-9192-f632bf3dadcc
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: VISIT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b31ae495-5e88-4319-b3c9-3653ea2f9a42
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 961e6234-2666-448a-ab3a-3d125c037557
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8e10c2e-ccfe-4c51-94e8-abc4fbb8b679
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2db991a0-968f-4e77-9a34-f9da5e35315a
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: URGENCY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a8d6c8de-7add-4987-bb24-dd6698f67cd2
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3896ebb-e509-47cf-98dc-c97e254f685d
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRIORITY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 179fdf92-2dcd-4095-b2ff-be7c86105e92
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f3e7a165-4a1f-4d9e-95ce-2c16b734414d
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: TRANSPORT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0fb8b748-1f90-4879-9661-408713a70c48
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25e865ef-89f2-43e3-a6d7-29f7fbd519f0
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ATTENDANCE_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb36ef5c-1146-41cc-9fb4-99ce9ec5c8f4
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd456e3f-92b2-4389-91f6-bf9c7caa03cb
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: ATTENDANCE_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27b97253-88ca-4fef-ad36-b76ca99a6c75
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DID_NOT_ATTEND_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02282144-ed5a-4b5b-83a8-cd1531fb8c5f
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b581021e-e5c9-470b-98d6-4a20880a5f6d
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SCHEDULE_OUTCOME_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e7f381e-95f6-4162-ba11-4ac5b6792701
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b36d8a23-eda6-4091-84d9-65bff0eeb7de
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OLD_SCHEDULE_OUTCOME_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9ba7457d-72b1-4197-96e1-50c9e7bfb119
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d82139e6-881f-401f-8f3a-a0e1fabdc4cd
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMIN_CATEGORY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e490f0c0-51ec-4d9d-af58-01a27d6592d5
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c716199-7d41-478e-93f7-5f3e99e90edd
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LOCATION_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f51ea3f1-56a3-4096-8fc8-77254252a7c6
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 19682c36-aedc-40f2-ba8e-89115a90b3c2
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CONTACT_PURPOSE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c9731af4-7c21-49b1-8751-ea46d16e224c
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bfcf0b12-e483-49ba-8b6c-7df67913c405
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CONTACT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 758cd941-37c1-4a16-a6e9-813afd680bf7
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1057bc50-189b-4669-a7a7-ddd2b9bc5ba2
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: RESOURCE_UNIT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 42e1d653-e8dc-4312-9b0d-593b1312fd97
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7675c83d-f262-45d9-89f4-5e4974930a2b
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAFF_ACTIVITY_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eae2a1cb-4910-4184-b584-1541090f5a5d
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b922ab0c-fa32-47a3-a087-cab3c95a2457
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SCHEDULE_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f83c923-15c2-4224-b229-e8a58310f5bf
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e046fb9-7bc0-4cbe-a889-89dfa82f67b4
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: SCHEDULE_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b53b3de-06e0-4814-8e34-fbdcc5b7cdc7
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREVIOUS_SCHEDULE_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a87fc2c-684d-47ff-a301-1e941693ffe5
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a801350-5462-4da7-835b-6f57647cc496
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: MOVE_REQUESTED_BY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2023145-1654-4335-ad0d-d59dfc921854
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e383c3d5-35fb-4057-b904-00ec7c471802
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CODING_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3b36a00-c1c4-4013-b826-aee25f9e8008
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3494114-54a0-4459-8a07-c709f710390a
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_CONFIRMATION_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 735d23f9-51eb-4695-a648-33e61e958eee
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15bfb272-ef7e-432e-b68a-2006ead8cf96
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ANAESTHETIC_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 28c67e03-c824-4763-9930-912a3cb988ca
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82df31ae-fc4f-4819-bf30-48eae4312c8f
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LATE_START_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5978ebcb-a002-4019-809e-f87146d1db75
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 482f7180-4f4c-4064-9be9-b76fcafab87a
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 579a78b0-9f4b-4250-8c6b-24768c86b245
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3cee6a4e-dd75-4743-b632-cc2d97f6433e
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ANAESTHETIC_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 658367a1-12a6-4e9f-a31d-34fbe7e3d413
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e47c80ad-63c6-4e9b-a3a9-9dd60ece9f3c
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIETARY_REQUIREMENTS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb40ed2a-15a1-486b-9c10-e1e99d35431c
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff73a69e-92df-4fea-a7fd-d8f92348302a
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: BOOKING_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9342c83d-d32d-493b-83ad-0bde3045d3b9
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06a9cc8e-1444-42fd-a355-6dc9c917fc0d
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FUNDING_ARRANGEMENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5b535f9b-0436-4e00-8fef-4bfc27aa34b3
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f711fe8-369c-40ba-927f-e8512d5c1429
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CONTACT_RESCHEDULE_BY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 878cbd8b-322d-4d1f-916c-4ec3dbc0ffa3
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae8b8812-db32-46d0-8e37-db50aee1ea62
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CONTACT_RESCHEDULE_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddf1f2b9-6228-432f-b5aa-3d8ab1b0a787
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34af1115-e573-4d0e-a7f7-a5a3aacc2557
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: UNPLANNED_RETURN_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9288a8ba-19c0-405b-9241-dd7dc90e3276
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc386b6a-08cd-409e-b9f5-176dfbeb8ca3
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: APPROXIMATE_SCHEDULE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 88bd02db-83d7-44c6-b737-f9a58f4368aa
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57011edd-41a6-42c9-8d99-e0208bcd7d90
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: OVERBOOKED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c95b2f1-72cd-48ec-8e3d-69175a117c4e
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20a4e915-58a0-42a0-a4cb-b46667560ba7
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FOLLOWUP_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd93f5f4-a9d9-41bd-b636-7caa753b0c62
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a3cf009-3a16-43c7-9af1-e0e9e8476fb7
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b70dea0e-01bd-4366-9db3-73d40d276084
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0407a4c9-db53-4862-9579-3040dd4c5acf
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: REASN_COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cda66633-23fe-4208-82fb-fcb1d9b4872e
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f717a0de-e256-44a3-9f90-a98dc2dc295c
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SCHEDULE_DURATION_ARRIVED_TO_DEPARTED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4505ba62-c5e4-410e-98a4-e8c908b04229
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: DATEDIFF(mi,ds_pims_schedules.arrived_dttm,ds_pims_schedules.departed_dttm)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4cba7815-fd4a-4f0e-a41d-63fb79171ebe
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SCHEDULE_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4505ba62-c5e4-410e-98a4-e8c908b04229
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: IFNULL(CONVERT(integer,ds_pims_schedules.duration),DATEDIFF(mi,ds_pims_schedules.start_dttm,ds_pims_schedules.end_dttm))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 971bb514-dfb7-4cd3-91ea-d985422b096b
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OPERATION_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b62d30a-d15d-41bf-8fae-ac083bb84437
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b736051a-4eba-413f-85c8-4801b720a020
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ANAESTHETIC_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f00fe29b-877b-4f34-a307-33f9f35b3833
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e6c84ed-4433-4dbf-99a2-031a08d67ddd
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_SCHEDULE_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b97bdc6-cf45-46a3-b6b6-36dca9fe2232
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: |-
              CASE WHEN ds_pims_schedules.patnt_refno IS NOT NULL THEN (ROW_NUMBER() OVER (PARTITION BY ds_pims_schedules.patnt_refno, ds_pims_schedules.sctyp_refno ORDER BY IFNULL(ds_pims_schedules.start_dttm,getdate())))
                          ELSE 1
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 43de9fed-42fd-44e8-9771-153196c221f9
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_SCHEDULE_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b97bdc6-cf45-46a3-b6b6-36dca9fe2232
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: |-
              CASE WHEN ds_pims_schedules.patnt_refno IS NOT NULL THEN (COUNT(1) OVER (PARTITION BY ds_pims_schedules.patnt_refno,ds_pims_schedules.sctyp_refno))
                          ELSE 1
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c51deb1c-b606-4b7f-ae9d-c066859e0d43
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Sequence for appointment within waitlist ordered from oldest to most recent
        name: WAITLIST_SCHEDULE_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b97bdc6-cf45-46a3-b6b6-36dca9fe2232
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ROW_NUMBER() OVER (PARTITION BY IFNULL(ds_pims_schedules.wlist_refno,ds_pims_schedules.refrl_refno) ORDER BY IFNULL(ds_pims_schedules.start_dttm,getdate())DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a203c3d-31ed-43c0-a4f7-488940015925
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Sequence for appointment within waitlist ordered from most recent to oldest
        name: WAITLIST_SCHEDULE_REV_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b97bdc6-cf45-46a3-b6b6-36dca9fe2232
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ROW_NUMBER() OVER (PARTITION BY IFNULL(ds_pims_schedules.wlist_refno,ds_pims_schedules.refrl_refno) ORDER BY IFNULL(ds_pims_schedules.start_dttm,getdate())DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9cab15e3-ae97-4e72-9674-774b8ba6b25c
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Count of appointments on this waitlist
        name: WAITLIST_APPOINTMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b97bdc6-cf45-46a3-b6b6-36dca9fe2232
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: count(*) OVER (PARTITION BY IFNULL(ds_pims_schedules.wlist_refno,ds_pims_schedules.refrl_refno) ORDER BY IFNULL(ds_pims_schedules.start_dttm,getdate())DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9697b33-0d12-4848-b3a3-c95c3bb0f975
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_SCHEDULE_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b97bdc6-cf45-46a3-b6b6-36dca9fe2232
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: |-
              CASE WHEN ds_pims_schedules.refrl_refno IS NOT NULL THEN (ROW_NUMBER() OVER (PARTITION BY ds_pims_schedules.refrl_refno ORDER BY IFNULL(ds_pims_schedules.start_dttm,getdate())DESC))
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3a1cbb7-9830-4665-9ac6-9950df0cd833
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_SCHEDULE_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b97bdc6-cf45-46a3-b6b6-36dca9fe2232
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: |-
              CASE WHEN ds_pims_schedules.refrl_refno IS NOT NULL THEN (COUNT(1) OVER (PARTITION BY ds_pims_schedules.refrl_refno))
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 504977d5-5d1c-4636-a216-3de8e5d951f4
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: PRVSP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 55657448-be2f-4a2b-8320-a7b85d67d592
                stepCounter: 741f0f92-29c2-403f-b62f-c119050c2375
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9c22f9c-12b0-4de7-9b2f-e42350dcf406
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea80fece-3c3c-4ae5-85de-0a3b4428f05d
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f736c50-4be3-47c6-b86d-deeab04312e6
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2fac099-ecf1-4e68-938f-dc8ae0acfb1e
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e49492bd-44f1-48dd-981f-f2f75693e710
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIFY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 566905f2-228b-4771-b1c9-c34ac9cb9083
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 810ce475-b276-4361-ba0d-f8b03cfb9078
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MODIFY_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d916717a-ff0c-4752-bc4f-86a55c06115e
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 278a83c5-3e2f-4950-9f17-b9dfc627180c
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DSS_DATA_QUALITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN ((ds_pims_schedules.start_dttm IS NULL AND ds_pims_schedules.end_dttm IS NOT NULL) OR ds_pims_schedules.start_dttm > ds_pims_schedules.end_dttm OR ds_pims_schedules.start_dttm < '1984-07-01') OR ((ds_pims_schedules.arrived_dttm IS NULL AND ds_pims_schedules.departed_dttm IS NOT NULL) OR ds_pims_schedules.arrived_dttm > ds_pims_schedules.departed_dttm) OR (ds_pims_schedules.reqst_dttm > ds_pims_schedules.start_dttm) THEN 'DT'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7efcb826-d8c4-4094-9172-54bf1d98599e
          stepCounter: fc747bd5-7053-43a8-9d29-af514a058fe1
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DS_PIMS_SERVICE_POINTS: 00ad68b8-b3a1-4406-bae4-ef41c7c67d56
          S_HEALTH_ORG_2: 4dbeb7b4-8557-4965-a256-fab03c67ecf4
          S_PIMS_PROVIDER_SPELLS: 741f0f92-29c2-403f-b62f-c119050c2375
          S_HEALTH_SPECIALTY_V: 810f0140-d555-4744-97b7-398fe4ee4d78
          DS_PIMS_REFERENCE_VALUES: 06fa4241-360c-43d0-8e4a-8b860f92fc09
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_PIMS_SCHEDULES
          - locationName: TGT
            nodeName: DS_PIMS_SERVICE_POINTS
          - locationName: TGT
            nodeName: S_HEALTH_ORG_2
          - locationName: TGT
            nodeName: S_PIMS_PROVIDER_SPELLS
          - locationName: TGT
            nodeName: S_HEALTH_SPECIALTY_V
          - locationName: TGT
            nodeName: DS_PIMS_REFERENCE_VALUES
        join:
          joinCondition: FROM ds_pims_schedules -- LEFT OUTER JOIN ds_pims_schedules ds_pims_schedules_parent     -- ON ds_pims_schedules.parnt_refno IS NOT NULL     -- AND ds_pims_schedules.parnt_refno = ds_pims_schedules_parent.schdl_refno       LEFT OUTER JOIN ds_pims_schedules ds_pims_schedules_p    ON ds_pims_schedules.parnt_refno IS NOT NULL AND ds_pims_schedules_p.schdl_refno = ds_pims_schedules.parnt_refno          LEFT OUTER JOIN dim.dim_schedule_status    ON ds_pims_schedules.scsda_refno = dim_schedule_status.schedule_status_reference_no    AND IFNULL(ds_pims_schedules.start_dttm,ds_pims_schedules.create_dttm) BETWEEN dim_schedule_status.dss_start_date AND dim_schedule_status.dss_end_date       LEFT OUTER JOIN dim.dim_cancellation_reason    ON ds_pims_schedules.cancr_refno = dim_cancellation_reason.cancellation_reason_reference_no    AND IFNULL(ds_pims_schedules.start_dttm,ds_pims_schedules.create_dttm) BETWEEN dim_cancellation_reason.dss_start_date AND dim_cancellation_reason.dss_end_date      LEFT OUTER JOIN dim.dim_attendance_status    ON ds_pims_schedules.attnd_refno = dim_attendance_status.attendance_status_reference_no     AND IFNULL(ds_pims_schedules.start_dttm,ds_pims_schedules.create_dttm) BETWEEN dim_attendance_status.dss_start_date AND dim_attendance_status.dss_end_date    LEFT OUTER JOIN {{ ref('TGT','DS_PIMS_SERVICE_POINTS') }}  ON ds_pims_schedules.spont_refno = ds_pims_service_points.spont_refno  LEFT OUTER JOIN {{ ref('TGT','S_HEALTH_ORG_2') }}  ON ds_pims_service_points.heorg_refno = s_health_org_2.health_org_reference_no    LEFT OUTER JOIN {{ ref('TGT','S_PIMS_PROVIDER_SPELLS') }}  ON ds_pims_schedules.patnt_refno = s_pims_provider_spells.patnt_refno      and ( COALESCE (ds_pims_schedules.into_theatre_dttm,ds_pims_Schedules.arrived_dttm,ds_pims_schedules.start_dttm)   between s_pims_provider_spells.admit_dttm and IFNULL(s_pims_provider_spells.disch_dttm,getdate())  or coalesce(ds_pims_Schedules.departed_dttm,ds_pims_schedules.end_dttm)  between s_pims_provider_spells.admit_dttm and IFNULL(s_pims_provider_spells.disch_dttm,getdate()))  and s_pims_provider_spells.hospital_id = s_health_org_2.hospital_id  LEFT OUTER JOIN {{ ref('TGT','S_HEALTH_SPECIALTY_V') }}  ON ds_pims_schedules.spect_refno = s_health_specialty_v.specialty_reference_no  LEFT OUTER JOIN {{ ref('TGT','DS_PIMS_REFERENCE_VALUES') }}  ON ds_pims_schedules.sctyp_refno = ds_pims_reference_values.rfval_refno  LEFT OUTER JOIN {{ ref('TGT','DS_PIMS_REFERENCE_VALUES') }} cancr  on ds_pims_schedules.cancr_refno = cancr.rfval_refno  LEFT OUTER JOIN {{ ref('TGT','DS_PIMS_REFERENCE_VALUES') }} attnd  on ds_pims_schedules.attnd_refno = attnd.rfval_refno  LEFT OUTER JOIN {{ ref('TGT','DS_PIMS_REFERENCE_VALUES') }} scsda  on ds_pims_schedules.scsda_refno = scsda.rfval_refno
        name: S_SCHEDULE_05
        noLinkRefs: []
  name: S_SCHEDULE_05
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
