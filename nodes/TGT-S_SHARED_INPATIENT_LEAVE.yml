fileVersion: 1
id: 9f45ed41-f617-40cd-af34-ecbaecddfb87
name: S_SHARED_INPATIENT_LEAVE
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1545cf5-82d6-4f5f-97dd-e0610090d168
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRVSP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd338d02-eac7-4d45-806a-1831b0f3775b
                stepCounter: 3e756094-7e86-4086-a4af-59124cd9e961
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6afcf1f5-acfc-40ed-9614-27ef52ade64c
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc28819c-55e3-49c8-b08c-b1de8ea0eb0d
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ff2a938-5e5a-4562-b9f3-fd6bfac2fec7
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'H'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a95fabdb-db48-4c90-8f6a-9d6c7cadc271
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_LEAVE_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8489b9a1-19ea-4ffb-8d1c-c09c0a49ec68
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ROW_NUMBER() OVER (PARTITION BY ds_pims_home_leaves.prvsp_refno ORDER BY ds_pims_home_leaves.homel_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3696f2e1-14cb-4dd3-97e8-c369f2346466
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_LEAVE_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8489b9a1-19ea-4ffb-8d1c-c09c0a49ec68
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: COUNT(1) OVER (PARTITION BY ds_pims_home_leaves.prvsp_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 295e6910-6829-43ae-b08a-cf2bdc05eae4
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_LEAVE_TOTAL_DURATION_MINUTES
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: SUM(DATEDIFF(MINUTE,ds_pims_home_leaves.start_dttm,ds_pims_home_leaves.end_dttm)) OVER (PARTITION BY ds_pims_home_leaves.prvsp_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7b96db8-6ed6-4339-8ac9-bb9fd7d4beee
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_LEAVE_TOTAL_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: SUM(DATEDIFF(dd,ds_pims_home_leaves.start_dttm,ds_pims_home_leaves.end_dttm)) OVER (PARTITION BY ds_pims_home_leaves.prvsp_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 347d4b42-2b85-43be-8fc3-dd9256d87b04
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f7b850f-ce72-4e87-b4f3-6e2838f4dd0a
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca8722cf-8323-47e0-ab3e-572351d4b1b0
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11ba3682-5d1a-4a53-bfaf-b4b646e6c99f
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d37908c2-24e7-4796-afc0-ec610583d2d8
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a06254d-d86c-4cf5-ab17-b37af0d69b0a
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d24cc83-54a1-4675-933a-052528cbfa10
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72c532b7-79a7-49aa-8bc0-c737daef331d
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 068a9eb3-d04f-4ae3-bd68-65937677b606
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1125cf7f-7027-45ac-acc8-b3a92505c4da
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: |-
              CASE WHEN ds_pims_provider_spells.admit_dttm IS NULL OR ds_pims_provider_spells.admit_dttm <= '1990-01-01' OR ds_pims_provider_spells.admit_dttm > GETDATE() THEN ds_pims_provider_spells.disch_dttm
                          ELSE ds_pims_provider_spells.admit_dttm
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8385f1b-c998-4bc1-b7c1-2ffff523b20a
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMIT_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1125cf7f-7027-45ac-acc8-b3a92505c4da
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c11534e1-c200-47ec-9c0f-3e20041f7c4e
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCH_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee3a67e8-1a53-44ab-aa64-cafc588de09c
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: |-
              CASE WHEN ds_pims_provider_spells.disch_dttm IS NULL OR ds_pims_provider_spells.disch_dttm <= '1990-01-01' OR ds_pims_provider_spells.disch_dttm > GETDATE() THEN ds_pims_provider_spells.admit_dttm
                          ELSE ds_pims_provider_spells.disch_dttm
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e229f15-13b2-4d57-96f6-3503a6b9c8e8
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCH_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee3a67e8-1a53-44ab-aa64-cafc588de09c
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7f15dc8-90dc-4b2c-8f7b-7f5e1dbaae5a
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: HOMEL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 231569e9-0ac1-4568-aa07-b0501058bee7
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a96d5f11-0f69-46a2-aefb-8c812e38a3fc
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SSTAY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24eeb20d-18d1-4bd8-8f55-2f75643a24d3
                stepCounter: 33fe902a-f28a-4da8-b9d5-2e4311242008
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5307a0f0-fbac-4f87-b778-98f709de1f61
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SSTAY_REFNO_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18404477-4bb7-4dc4-a4fb-6548f91cda07
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d583ffa-1199-4193-b63f-cbafe6c4803f
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_PATNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f7b850f-ce72-4e87-b4f3-6e2838f4dd0a
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94c7ab00-a5db-47a8-811c-ec27dd0b018d
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: FREE_BED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 62e2fdf5-9452-4499-b416-d6fee65c21d3
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 08444413-2a6e-4b7b-bd8a-6ddc3af7abcf
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LEAVE_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4f863b45-1753-4712-88f4-d3e9bc7e1040
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: |-
              CASE WHEN ds_pims_home_leaves.start_dttm IS NULL OR ds_pims_home_leaves.start_dttm <= '1990-01-01' OR ds_pims_home_leaves.start_dttm > GETDATE() OR ds_pims_home_leaves.start_dttm > ds_pims_home_leaves.end_dttm OR ds_pims_home_leaves.start_dttm < CASE WHEN ds_pims_provider_spells.admit_dttm IS NULL OR ds_pims_provider_spells.admit_dttm <= '1990-01-01' OR ds_pims_provider_spells.admit_dttm > GETDATE() THEN ds_pims_provider_spells.disch_dttm ELSE ds_pims_provider_spells.admit_dttm END THEN CASE WHEN ds_pims_provider_spells.admit_dttm IS NULL OR ds_pims_provider_spells.admit_dttm <= '1990-01-01' OR ds_pims_provider_spells.admit_dttm > GETDATE() THEN ds_pims_provider_spells.disch_dttm ELSE ds_pims_provider_spells.admit_dttm END
                          ELSE ds_pims_home_leaves.start_dttm
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 922a1cce-aa32-4609-b423-db776adf3fd3
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LEAVE_START_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4f863b45-1753-4712-88f4-d3e9bc7e1040
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e600eb14-f931-4e80-8228-cb680532770a
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: STAY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d98e645e-b2cf-4f8d-95d1-1d45aaa6fcce
                stepCounter: 33fe902a-f28a-4da8-b9d5-2e4311242008
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd2a55d4-43de-49e3-909d-4bdf4aa0a75f
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LEAVE_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: acf53736-2adf-4256-898d-573f8b10ce7f
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: |-
              CASE WHEN ds_pims_home_leaves.end_dttm IS NULL OR ds_pims_home_leaves.end_dttm <= '1990-01-01' OR ds_pims_home_leaves.end_dttm > GETDATE() OR ds_pims_home_leaves.end_dttm < ds_pims_home_leaves.start_dttm OR ds_pims_home_leaves.end_dttm > CASE WHEN ds_pims_provider_spells.disch_dttm <= '1990-01-01' OR ds_pims_provider_spells.disch_dttm > GETDATE() THEN ds_pims_provider_spells.admit_dttm ELSE ds_pims_provider_spells.disch_dttm END THEN CASE WHEN ds_pims_provider_spells.disch_dttm IS NULL OR ds_pims_provider_spells.disch_dttm <= '1990-01-01' OR ds_pims_provider_spells.disch_dttm > GETDATE() THEN ds_pims_provider_spells.admit_dttm ELSE ds_pims_provider_spells.disch_dttm END
                          ELSE ds_pims_home_leaves.end_dttm
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1dc50f9c-c061-46e5-ab64-4a85298ec97a
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LEAVE_END_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: acf53736-2adf-4256-898d-573f8b10ce7f
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 73ed17c7-7a91-440b-ba05-64f6386ed70c
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: STAY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b3b399b6-cd48-42b7-8d10-914fd8747ca8
                stepCounter: 33fe902a-f28a-4da8-b9d5-2e4311242008
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 84decf69-1b54-48bc-8a8b-a22ab49cc04b
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ARCHV_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 98d73ce3-c35f-434a-b71f-08fc7d60355a
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7c5813b-e1b8-4a97-a8e5-9692e5715dc6
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ccdfe81-76a4-4c5f-9e97-0cc7fed4d6d3
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5868ba92-4461-498a-ab71-1a02dc16953e
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIF_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef293cda-df71-4ea8-988d-90f1c98f64e3
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 63f4a593-14c5-45de-87e4-de9b5d24a0f3
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: USER_CREATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e97e0181-ea71-4b3c-bc18-5f352037437b
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32b13026-b93b-4242-9360-d198cfa5d637
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: USER_MODIF
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7e945eb-312e-4af9-82bc-bccce396c34c
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 380afa2c-8f32-4c7a-bae0-892f18e30bf4
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STRAN_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e3d8527-cc49-48e9-855a-c278bee8caae
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a146ca38-2656-4dd2-ae9d-cb0207c25c6a
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRIOR_POINTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ef1e0a3-132c-408f-b8a1-d14cd365d18a
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c048319-a1d2-47dc-95bc-a123e352e966
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EXTERNAL_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7bd34f97-ceb7-43fe-9de6-1eb5bcce98ee
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef555e11-1895-4235-9764-7a092e7a821e
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: EXPECTED_RETURN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b35ae8b5-425f-461e-bab5-e4d357726f70
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8102a62-a810-40cc-9078-b3aa55eef5b9
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LATEST_RETURN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d118ff52-6649-4420-a794-a328a70cf924
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 312d94ca-a5dd-443c-a49e-d0bb12038f7e
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PLGST_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0853d527-a7c1-4cce-a573-00d140387136
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 272084e3-cb50-4006-8b1b-c0ee82c505b5
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REHML_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 69df30bd-eeff-42b4-a5ac-38b21df3ba43
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 077c1855-f332-4f9d-b5ec-1461a653395f
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LVTYP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: da5ecf69-b663-437d-9557-5b7f8a83b977
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50985151-dd4d-41fa-8fbb-70ad131d0fa9
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LVEOC_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 282c23ef-5f27-486c-aaae-235891540106
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a70fd974-3ae5-4111-ab74-2dfbd687709f
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: RECALL_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db213c80-2452-493c-a902-3d9abc143c36
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25348418-1576-4701-89e9-b890a2a1b8d1
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 87e10cb7-8c4d-41f9-afbe-e7f0ef569705
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5faa28d-6708-4526-8a83-ea00d7edb991
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: PRVSN_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dda0c1df-3728-4814-a7d6-4edd0f969e4a
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b88ff3a5-5e3a-473a-98e9-3c2ee7ce1149
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PERCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b3767370-402e-4e83-b93d-3cf104f4224b
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 10c477a5-e1a6-4eb0-9f9a-02f199a8ba42
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OWNER_HEORG_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3cb3c8fe-2302-4eaf-a4e2-1f30523c6171
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1265d504-6e7b-4713-9ca6-c8d0009cfee5
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EXT_HEORG_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c055e901-1f7b-47b7-8dc1-358c05c494ab
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3fe09f0a-973f-416f-a489-b1b65495bf9b
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EXT_HEORG_PASID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e95ec39-fd18-4cea-95d0-c778049ff5e1
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aaa4139a-078c-44ff-ae06-eb41f9329088
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DSS_DATA_QUALITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a033b8a-2c74-4be4-9ee2-d9afde981c86
          stepCounter: 9f45ed41-f617-40cd-af34-ecbaecddfb87
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_SHARED_INPATIENT_CHANGES
        join:
          joinCondition: |-
            FROM s_shared_inpatient_changes
              JOIN ds_pims_home_leaves
                ON s_shared_inpatient_changes.prvsp_refno = ds_pims_home_leaves.prvsp_refno
              JOIN ds_pims_provider_spells
                ON ds_pims_home_leaves.prvsp_refno = ds_pims_provider_spells.prvsp_refno
              LEFT OUTER JOIN (
                    SELECT MAX(sstay_refno) sstay_refno,
                           MAX(start_dttm) start_dttm,
                           MAX(end_dttm) end_dttm,
                           prvsp_refno
                      FROM ds_pims_service_point_stays
                     GROUP BY prvsp_refno
                   ) ds_pims_service_point_stays
                ON ds_pims_home_leaves.prvsp_refno = ds_pims_service_point_stays.prvsp_refno
               AND (CONVERT(date, ds_pims_home_leaves.start_dttm) BETWEEN CONVERT(date, ds_pims_service_point_stays.start_dttm-1) AND CONVERT(date, ds_pims_service_point_stays.end_dttm+1) OR COALESCE(CONVERT(date, ds_pims_home_leaves.end_dttm), GETDATE()) BETWEEN CONVERT(date, ds_pims_service_point_stays.start_dttm-1) AND COALESCE(CONVERT(date, ds_pims_service_point_stays.end_dttm+1),GETDATE()))
             WHERE s_shared_inpatient_changes.event_changed_flag = 1
        name: S_SHARED_INPATIENT_LEAVE
        noLinkRefs: []
  name: S_SHARED_INPATIENT_LEAVE
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
