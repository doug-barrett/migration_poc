fileVersion: 1
id: d13fd7b9-eb3a-4180-b830-932525c6e38f
name: VIEW_DIM_FDC_ON_PROD_DATE
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8f4afc3-74fd-4f59-a554-d247a754ea77
          stepCounter: d13fd7b9-eb3a-4180-b830-932525c6e38f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated key for the date dimension. Nominal format is YYYYMMDD, but DD equal to 0 and greater than 31 permited for special date handling.
        name: DIM_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b8f4afc3-74fd-4f59-a554-d247a754ea77
                stepCounter: d13fd7b9-eb3a-4180-b830-932525c6e38f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a152c37e-6551-4124-81c5-3ab692ca13a7
          stepCounter: d13fd7b9-eb3a-4180-b830-932525c6e38f
        config: {}
        dataType: DATE
        defaultValue: ""
        description: The calendar date for this row.
        name: CALENDAR_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a152c37e-6551-4124-81c5-3ab692ca13a7
                stepCounter: d13fd7b9-eb3a-4180-b830-932525c6e38f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8f7dc0e-c2e3-4e51-a88a-f98aeb2855d6
          stepCounter: d13fd7b9-eb3a-4180-b830-932525c6e38f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The calendar year. Format YYYY
        name: YEAR_SORT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b32a87f-ba2b-4965-97c0-36a11babe35e
          stepCounter: d13fd7b9-eb3a-4180-b830-932525c6e38f
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: The calendar year. Format YYYY
        name: YEAR_GROUPING
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "'On Prod ' || VIEW_DIM_FDC_ON_PROD_DATE.CAL_YEAR"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b48f868-7c02-4adf-b27a-0d2960e6ab24
          stepCounter: d13fd7b9-eb3a-4180-b830-932525c6e38f
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: The calendar quarter number 1-4.
        name: QUARTER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "'On Prod ' || VIEW_DIM_FDC_ON_PROD_DATE.CAL_YEAR || ' Q' || VIEW_DIM_FDC_ON_PROD_DATE.CAL_QUARTER_NO"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70eea257-eeef-4363-8437-164614de7e5c
          stepCounter: d13fd7b9-eb3a-4180-b830-932525c6e38f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The calendar month number 1-12.
        name: CAL_MONTH_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 70eea257-eeef-4363-8437-164614de7e5c
                stepCounter: d13fd7b9-eb3a-4180-b830-932525c6e38f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f30fe84-4627-47bc-be66-0beb27f98d81
          stepCounter: d13fd7b9-eb3a-4180-b830-932525c6e38f
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: 'The calendar month name. Format MON. Examples: jan, feb, mar.'
        name: CAL_MONTH_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f30fe84-4627-47bc-be66-0beb27f98d81
                stepCounter: d13fd7b9-eb3a-4180-b830-932525c6e38f
            transform: "'On Prod ' || VIEW_DIM_FDC_ON_PROD_DATE.CAL_MONTH_NAME || ' ' || VIEW_DIM_FDC_ON_PROD_DATE.CAL_YEAR"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02620bca-03b7-4af0-96a1-14a391ce1113
          stepCounter: d13fd7b9-eb3a-4180-b830-932525c6e38f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The calendar quarter representation. Format YYYYQQ. Example 200204.
        name: MONTH_SORT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_DIM_FDC_ON_PROD_DATE: d13fd7b9-eb3a-4180-b830-932525c6e38f
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_DIM_FDC_ON_PROD_DATE') }} AS SELECT '-1' AS DIM_DATE_KEY,
                   '1900-01-01' AS CALENDAR_DATE,
                   '1900' AS YEAR_SORT,
                   'Unknown On Prod Date' AS YEAR_GROUPING,
                   'Unknown On Prod Date' AS QUARTER_NAME,
                   NULL AS CAL_MONTH_NO,
                   'Unknown On Prod Date' AS CAL_MONTH_NAME,
                   NULL AS MONTH_SORT
            UNION ALL SELECT DIM_DATE_SF.DIM_DATE_KEY AS DIM_DATE_KEY,
                   DIM_DATE_SF.CALENDAR_DATE AS CALENDAR_DATE,
                   DIM_DATE_SF.CAL_YEAR AS YEAR_SORT,
                   'On Prod ' || DIM_DATE_SF.CAL_YEAR AS YEAR_GROUPING,
                   'On Prod ' || DIM_DATE_SF.CAL_YEAR || ' Q' || DIM_DATE_SF.CAL_QUARTER_NO AS QUARTER_NAME,
                   DIM_DATE_SF.CAL_MONTH_NO AS CAL_MONTH_NO,
                   'On Prod ' || DIM_DATE_SF.CAL_MONTH_NAME || ' ' || DIM_DATE_SF.CAL_YEAR AS CAL_MONTH_NAME,
                   DIM_DATE_SF.CAL_QUARTER AS MONTH_SORT
              FROM "WS_EDW"."DIM_DATE_SF" DIM_DATE_SF
             WHERE DIM_DATE_SF.DIM_DATE_KEY != 0 ;
        dependencies:
          - locationName: TARGET
            nodeName: VIEW_DIM_FDC_ON_PROD_DATE
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','VIEW_DIM_FDC_ON_PROD_DATE') }}
        name: VIEW_DIM_FDC_ON_PROD_DATE
        noLinkRefs: []
  name: VIEW_DIM_FDC_ON_PROD_DATE
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
