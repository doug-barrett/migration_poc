fileVersion: 1
id: cd389f47-4b0b-4a89-8bc5-8cba7b565df5
name: VIEW_DIM_FDC_ON_PROD_DATE
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 214a0826-2656-4a05-8a00-06b0dc60be83
          stepCounter: cd389f47-4b0b-4a89-8bc5-8cba7b565df5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated key for the date dimension. Nominal format is YYYYMMDD, but DD equal to 0 and greater than 31 permited for special date handling.
        name: DIM_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 214a0826-2656-4a05-8a00-06b0dc60be83
                stepCounter: cd389f47-4b0b-4a89-8bc5-8cba7b565df5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88912ae7-cb16-427e-b287-30b02b129ba9
          stepCounter: cd389f47-4b0b-4a89-8bc5-8cba7b565df5
        config: {}
        dataType: DATE
        defaultValue: ""
        description: The calendar date for this row.
        name: CALENDAR_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 88912ae7-cb16-427e-b287-30b02b129ba9
                stepCounter: cd389f47-4b0b-4a89-8bc5-8cba7b565df5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 51d85da2-43ab-44a3-9ca0-57497a87f68e
          stepCounter: cd389f47-4b0b-4a89-8bc5-8cba7b565df5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The calendar year. Format YYYY
        name: YEAR_SORT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17523c3c-7f47-431b-a745-dd64f838c095
          stepCounter: cd389f47-4b0b-4a89-8bc5-8cba7b565df5
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: The calendar year. Format YYYY
        name: YEAR_GROUPING
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "'On Prod ' || VIEW_DIM_FDC_ON_PROD_DATE.CAL_YEAR"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6213e07-21c8-41cf-83ad-8bcdae59a92f
          stepCounter: cd389f47-4b0b-4a89-8bc5-8cba7b565df5
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: The calendar quarter number 1-4.
        name: QUARTER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "'On Prod ' || VIEW_DIM_FDC_ON_PROD_DATE.CAL_YEAR || ' Q' || VIEW_DIM_FDC_ON_PROD_DATE.CAL_QUARTER_NO"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bfea8a3d-e4b0-4c82-bb3e-8f3b14bc4948
          stepCounter: cd389f47-4b0b-4a89-8bc5-8cba7b565df5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The calendar month number 1-12.
        name: CAL_MONTH_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bfea8a3d-e4b0-4c82-bb3e-8f3b14bc4948
                stepCounter: cd389f47-4b0b-4a89-8bc5-8cba7b565df5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef74ca4f-06c9-4d34-952d-75bd741aaad2
          stepCounter: cd389f47-4b0b-4a89-8bc5-8cba7b565df5
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: 'The calendar month name. Format MON. Examples: jan, feb, mar.'
        name: CAL_MONTH_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef74ca4f-06c9-4d34-952d-75bd741aaad2
                stepCounter: cd389f47-4b0b-4a89-8bc5-8cba7b565df5
            transform: "'On Prod ' || VIEW_DIM_FDC_ON_PROD_DATE.CAL_MONTH_NAME || ' ' || VIEW_DIM_FDC_ON_PROD_DATE.CAL_YEAR"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fddeb1a2-06af-4713-b3ee-503a604ce4ce
          stepCounter: cd389f47-4b0b-4a89-8bc5-8cba7b565df5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The calendar quarter representation. Format YYYYQQ. Example 200204.
        name: MONTH_SORT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_DIM_FDC_ON_PROD_DATE: cd389f47-4b0b-4a89-8bc5-8cba7b565df5
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_DIM_FDC_ON_PROD_DATE') }} AS SELECT '-1' AS DIM_DATE_KEY,
                   '1900-01-01' AS CALENDAR_DATE,
                   '1900' AS YEAR_SORT,
                   'Unknown On Prod Date' AS YEAR_GROUPING,
                   'Unknown On Prod Date' AS QUARTER_NAME,
                   NULL AS CAL_MONTH_NO,
                   'Unknown On Prod Date' AS CAL_MONTH_NAME,
                   NULL AS MONTH_SORT
            UNION ALL SELECT DIM_DATE_SF.DIM_DATE_KEY AS DIM_DATE_KEY,
                   DIM_DATE_SF.CALENDAR_DATE AS CALENDAR_DATE,
                   DIM_DATE_SF.CAL_YEAR AS YEAR_SORT,
                   'On Prod ' || DIM_DATE_SF.CAL_YEAR AS YEAR_GROUPING,
                   'On Prod ' || DIM_DATE_SF.CAL_YEAR || ' Q' || DIM_DATE_SF.CAL_QUARTER_NO AS QUARTER_NAME,
                   DIM_DATE_SF.CAL_MONTH_NO AS CAL_MONTH_NO,
                   'On Prod ' || DIM_DATE_SF.CAL_MONTH_NAME || ' ' || DIM_DATE_SF.CAL_YEAR AS CAL_MONTH_NAME,
                   DIM_DATE_SF.CAL_QUARTER AS MONTH_SORT
              FROM "WS_EDW"."DIM_DATE_SF" DIM_DATE_SF
             WHERE DIM_DATE_SF.DIM_DATE_KEY != 0 ;
        dependencies:
          - locationName: TARGET
            nodeName: VIEW_DIM_FDC_ON_PROD_DATE
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','VIEW_DIM_FDC_ON_PROD_DATE') }}
        name: VIEW_DIM_FDC_ON_PROD_DATE
        noLinkRefs: []
  name: VIEW_DIM_FDC_ON_PROD_DATE
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
