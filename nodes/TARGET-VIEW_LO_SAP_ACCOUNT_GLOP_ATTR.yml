fileVersion: 1
id: 66c11f38-e3db-448c-a66b-8829bced9257
name: VIEW_LO_SAP_ACCOUNT_GLOP_ATTR
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed17fc7a-c64e-4c44-a51f-b5436615bfed
          stepCounter: 66c11f38-e3db-448c-a66b-8829bced9257
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: LINE_NO_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4460264-eeac-48f7-bae2-1748cdbcf9cb
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba2b8a61-2449-441b-b618-bb61cbeb21d7
          stepCounter: 66c11f38-e3db-448c-a66b-8829bced9257
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: ""
        name: LINE_NO_GROUP_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d5c91b8-bbdb-4a28-9f19-8240c943cc67
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57f4aef7-78ff-491e-8bc4-4a48bbf758c8
          stepCounter: 66c11f38-e3db-448c-a66b-8829bced9257
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: Lease Ops Line Number
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1a83d4b-9af5-4a64-b5b2-f6f811cf7698
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6042547b-800e-4728-ab93-cebf5290d122
          stepCounter: 66c11f38-e3db-448c-a66b-8829bced9257
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: LINE_NO_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f76558f-c881-4626-a101-a4e56bec46be
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c1cbaec-b9d3-4c45-b803-f5f8461dafb5
          stepCounter: 66c11f38-e3db-448c-a66b-8829bced9257
        config: {}
        dataType: DECIMAL(38)
        defaultValue: ""
        description: Report Sequence of LINE_NO
        name: LINE_NO_SEQ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a953943-462a-4e35-ba62-2e80d34da8a3
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e1e108a-b9cf-48c3-80fc-bf56eb93fd2e
          stepCounter: 66c11f38-e3db-448c-a66b-8829bced9257
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: One of "DOLLAR","VOLUME","RATE" - for Net Amount line number inclusion logic
        name: LINE_NO_AMT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb502f0b-51ee-4921-9832-b1e05667ab62
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ea31393-00a1-4811-9bf3-68a1ca9867e5
          stepCounter: 66c11f38-e3db-448c-a66b-8829bced9257
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: One of "LI","SUM","CALC" - for Lease Ops report layer only
        name: LINE_NO_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00c5fd7a-5311-4b89-a6ff-55fc95a025b1
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6161468-8a1f-4dc4-89d2-e8a07ced1993
          stepCounter: 66c11f38-e3db-448c-a66b-8829bced9257
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: GL Account SAP Code (ACDOCA.SAKNR)
        name: ACCOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 307ce211-4fd9-4035-bb90-9beb58bfe118
                stepCounter: 95e4d277-8530-4e7c-b5fc-957bab063b60
            transform: COALESCE(LOAD_VET_FIN_SAP_ACCOUNT_ATTR.ACCOUNT, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_5.ACCOUNT, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_10.ACCOUNT, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_13.ACCOUNT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9553e268-b92a-4b4d-8e29-fd8072047a2c
          stepCounter: 66c11f38-e3db-448c-a66b-8829bced9257
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ACCT_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3361fee1-f29a-425f-bfa8-2b6f6b054891
                stepCounter: 435a18b2-1dc7-4fc8-b5d0-3eab3af614fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a62a130-73ab-4aca-bc87-d35ee84d8180
          stepCounter: 66c11f38-e3db-448c-a66b-8829bced9257
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Line Item Fucntional Area SAP Code (ACDOCA.RFAREA)
        name: FUNCTIONAL_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0eec6a8b-23d3-44ef-afdd-a2c8cb10f329
                stepCounter: 95e4d277-8530-4e7c-b5fc-957bab063b60
            transform: COALESCE(LOAD_VET_FIN_SAP_ACCOUNT_ATTR.FAREA, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_5.FAREA, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_10.FAREA, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_13.FAREA)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 93f1629c-e7c8-49c2-8dee-87a56052606d
          stepCounter: 66c11f38-e3db-448c-a66b-8829bced9257
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: FUNCTIONAL_AREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f862aee-a2e0-462c-be94-281d06d5a42e
                stepCounter: deacf6ea-f8a6-4783-88a5-38cfcabbf1d3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96199d45-9710-437b-9915-565bed43e1a8
          stepCounter: 66c11f38-e3db-448c-a66b-8829bced9257
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: Lease Ops Account Group Code
        name: ACCT_GROUP_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4213f9b-3386-4dfb-9a42-60fadcc8d51e
                stepCounter: 95e4d277-8530-4e7c-b5fc-957bab063b60
            transform: COALESCE(LOAD_VET_FIN_SAP_ACCOUNT_ATTR.ACCT_GROUP_CODE, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_5.ACCT_GROUP_CODE, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_10.ACCT_GROUP_CODE, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_13.ACCT_GROUP_CODE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8fe205c1-3090-4b01-ae0f-c93160798856
          stepCounter: 66c11f38-e3db-448c-a66b-8829bced9257
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: Lease Ops Product Code
        name: PROD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c281e3c-599f-4197-9368-3ad9f09c050b
                stepCounter: 95e4d277-8530-4e7c-b5fc-957bab063b60
            transform: COALESCE(LOAD_VET_FIN_SAP_ACCOUNT_ATTR.PROD_CODE, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_5.PROD_CODE, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_10.PROD_CODE, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_13.PROD_CODE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d228e3bc-89b4-443d-a3f7-7e5ed79ac957
          stepCounter: 66c11f38-e3db-448c-a66b-8829bced9257
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: AFE_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 15dded3e-20ac-4399-9582-0cd9a37c7604
                stepCounter: f93a8e45-7804-49aa-b6a3-966e768997dc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 30e7c5d7-ed80-4b5c-9962-cea463284825
          stepCounter: 66c11f38-e3db-448c-a66b-8829bced9257
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: Description for the code.
        name: AFE_TYPE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67785ce3-e522-42ca-b754-609d323237b2
                stepCounter: f93a8e45-7804-49aa-b6a3-966e768997dc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98937509-f228-4a59-a3a2-2926a54a9be8
          stepCounter: 66c11f38-e3db-448c-a66b-8829bced9257
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Is Summary Subset Line No
        name: FLG_SUMMARY_SUBSET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 28d4efe8-45ab-400e-a853-650bc58c43fa
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e2f92f1-8a3d-49ea-9b23-812798bcabd1
          stepCounter: 66c11f38-e3db-448c-a66b-8829bced9257
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Is Financial Subset Line No
        name: FLG_FIN_SUBSET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d6cec9ae-c1e0-494c-8ad0-02509df3029c
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3bfcf2f1-b7fe-406a-b2b7-fb49783e314a
          stepCounter: 66c11f38-e3db-448c-a66b-8829bced9257
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Financial Subset Name
        name: FIN_SUBSET_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c4cd98a-f346-4dee-a14a-28536f46e231
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 13736240-338b-4439-a4be-cdc4b98c8557
          stepCounter: 66c11f38-e3db-448c-a66b-8829bced9257
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6d43193-58f2-4dd8-b1a7-fc8354d4ba5d
                stepCounter: 95e4d277-8530-4e7c-b5fc-957bab063b60
            transform: COALESCE(LOAD_VET_FIN_SAP_ACCOUNT_ATTR.CREATE_DATE, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_5.CREATE_DATE, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_10.CREATE_DATE, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_13.CREATE_DATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 637b2b98-d804-4447-90e9-9088d85d0425
          stepCounter: 66c11f38-e3db-448c-a66b-8829bced9257
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: UPDATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 836c1d2a-131b-499a-80d5-19ecaad202fe
                stepCounter: 95e4d277-8530-4e7c-b5fc-957bab063b60
            transform: COALESCE(LOAD_VET_FIN_SAP_ACCOUNT_ATTR.UPDATE_DATE, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_5.UPDATE_DATE, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_10.UPDATE_DATE, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_13.UPDATE_DATE)
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DIM_LO_SAP_LEASE_OPS_HIER: 82938641-7c51-4aff-ad3a-c7a56af30c01
          LOAD_VET_FIN_SAP_ACCOUNT_ATTR: 95e4d277-8530-4e7c-b5fc-957bab063b60
          DIM_LO_SAP_GL_ACCOUNT: 435a18b2-1dc7-4fc8-b5d0-3eab3af614fd
          ODS_SAP_TFKBT: deacf6ea-f8a6-4783-88a5-38cfcabbf1d3
          LOAD_VET_FIN_SAP_AFE_TYPE_ATTR: 89b6853d-ec92-4ce1-87b8-e50bebc37373
          DIM_LO_SAP_AFE_TYPE: f93a8e45-7804-49aa-b6a3-966e768997dc
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_HIER
          - locationName: TARGET
            nodeName: LOAD_VET_FIN_SAP_ACCOUNT_ATTR
          - locationName: TARGET
            nodeName: DIM_LO_SAP_GL_ACCOUNT
          - locationName: TARGET
            nodeName: ODS_SAP_TFKBT
          - locationName: TARGET
            nodeName: LOAD_VET_FIN_SAP_AFE_TYPE_ATTR
          - locationName: TARGET
            nodeName: DIM_LO_SAP_AFE_TYPE
        join:
          joinCondition: |-
            FROM {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_HIER') }} DIM_LO_SAP_LEASE_OPS_HIER
              LEFT JOIN {{ ref('TARGET','LOAD_VET_FIN_SAP_ACCOUNT_ATTR') }} LOAD_VET_FIN_SAP_ACCOUNT_ATTR
                ON LOAD_VET_FIN_SAP_ACCOUNT_ATTR.LINE_NO = DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','LOAD_VET_FIN_SAP_ACCOUNT_ATTR') }}
                     WHERE LINE_NO IN ('20.1','20.2','20.3', '20.4')
                   ) LOAD_VET_FIN_SAP_ACCOUNT_ATTR_5
                ON REPLACE(LOAD_VET_FIN_SAP_ACCOUNT_ATTR_5.LINE_NO, '20.', '5.') = DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','LOAD_VET_FIN_SAP_ACCOUNT_ATTR') }}
                     WHERE LINE_NO IN ('20.1','20.2','20.3', '20.4')
                   ) LOAD_VET_FIN_SAP_ACCOUNT_ATTR_10
                ON REPLACE(LOAD_VET_FIN_SAP_ACCOUNT_ATTR_10.LINE_NO, '20.', '10.') = DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','LOAD_VET_FIN_SAP_ACCOUNT_ATTR') }}
                     WHERE LINE_NO IN ('20.1','20.2','20.3', '20.4')
                   ) LOAD_VET_FIN_SAP_ACCOUNT_ATTR_13
                ON REPLACE(LOAD_VET_FIN_SAP_ACCOUNT_ATTR_13.LINE_NO, '20.', '13.') = DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_GL_ACCOUNT') }} DIM_LO_SAP_GL_ACCOUNT
                ON COALESCE(LOAD_VET_FIN_SAP_ACCOUNT_ATTR.ACCOUNT, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_5.ACCOUNT, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_10.ACCOUNT, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_13.ACCOUNT) = DIM_LO_SAP_GL_ACCOUNT.ACCOUNT
              LEFT JOIN {{ ref('TARGET','ODS_SAP_TFKBT') }} ODS_SAP_TFKBT
                ON COALESCE(LOAD_VET_FIN_SAP_ACCOUNT_ATTR.FAREA, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_5.FAREA, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_10.FAREA, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_13.FAREA) = ODS_SAP_TFKBT.FKBER
               AND ODS_SAP_TFKBT.SPRAS = 'E'
              LEFT JOIN {{ ref('TARGET','LOAD_VET_FIN_SAP_AFE_TYPE_ATTR') }} LOAD_VET_FIN_SAP_AFE_TYPE_ATTR
                ON DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO = LOAD_VET_FIN_SAP_AFE_TYPE_ATTR.LINE_NO
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_AFE_TYPE') }} DIM_LO_SAP_AFE_TYPE
                ON LOAD_VET_FIN_SAP_AFE_TYPE_ATTR.AFE_TYPE = DIM_LO_SAP_AFE_TYPE.AFE_TYPE
             ORDER BY DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO_SEQ,
                      COALESCE(LOAD_VET_FIN_SAP_ACCOUNT_ATTR.ACCOUNT, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_5.ACCOUNT, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_10.ACCOUNT, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_13.ACCOUNT),
                      LOAD_VET_FIN_SAP_AFE_TYPE_ATTR.AFE_TYPE
        name: VIEW_LO_SAP_ACCOUNT_GLOP_ATTR
        noLinkRefs: []
  name: VIEW_LO_SAP_ACCOUNT_GLOP_ATTR
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
