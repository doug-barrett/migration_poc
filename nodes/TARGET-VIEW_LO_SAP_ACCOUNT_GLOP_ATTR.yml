fileVersion: 1
id: edd4a3a3-5fa1-415e-9d11-a1bdd00bee99
name: VIEW_LO_SAP_ACCOUNT_GLOP_ATTR
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9523207-9dd0-498f-ab5c-e6b404ee90f5
          stepCounter: edd4a3a3-5fa1-415e-9d11-a1bdd00bee99
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: LINE_NO_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4607c855-a49d-4eb4-bbf8-11be2b047885
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 30253561-1042-4f0e-b33b-95682d33cec5
          stepCounter: edd4a3a3-5fa1-415e-9d11-a1bdd00bee99
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: ""
        name: LINE_NO_GROUP_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: da99671c-2200-4c20-b04f-0e5973f1746a
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5efa71d-a2c7-4b1d-b43f-d5b90d82905b
          stepCounter: edd4a3a3-5fa1-415e-9d11-a1bdd00bee99
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: Lease Ops Line Number
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3f84c21-4ee9-4cae-88e0-9ce9656d3204
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5f6586b-3842-4ceb-af5d-7495cc2352fd
          stepCounter: edd4a3a3-5fa1-415e-9d11-a1bdd00bee99
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: LINE_NO_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b33d1283-b87f-47de-99a6-a3ee69543603
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9748436-9789-45af-9ddb-93d8a564ab4f
          stepCounter: edd4a3a3-5fa1-415e-9d11-a1bdd00bee99
        config: {}
        dataType: DECIMAL(38)
        defaultValue: ""
        description: Report Sequence of LINE_NO
        name: LINE_NO_SEQ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb3df596-66af-48d1-a81d-3b43a5ba8411
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b646de9d-b26d-4654-ab26-4757c9512a5c
          stepCounter: edd4a3a3-5fa1-415e-9d11-a1bdd00bee99
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: One of "DOLLAR","VOLUME","RATE" - for Net Amount line number inclusion logic
        name: LINE_NO_AMT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eaf1dca2-9782-422e-85c5-da635ee6821c
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 68d2939e-9127-4d81-93d0-f8d537c02548
          stepCounter: edd4a3a3-5fa1-415e-9d11-a1bdd00bee99
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: One of "LI","SUM","CALC" - for Lease Ops report layer only
        name: LINE_NO_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9589f932-295b-412c-b2ea-3122714a785b
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6bdceb5d-12e1-4bfb-8830-b0965b802bb8
          stepCounter: edd4a3a3-5fa1-415e-9d11-a1bdd00bee99
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: GL Account SAP Code (ACDOCA.SAKNR)
        name: ACCOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d80edae6-90cb-4e0f-af00-343821892399
                stepCounter: 181145f3-06a6-4ad9-b836-9a574745c577
            transform: COALESCE(LOAD_VET_FIN_SAP_ACCOUNT_ATTR.ACCOUNT, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_5.ACCOUNT, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_10.ACCOUNT, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_13.ACCOUNT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e68ba7c-1b29-4246-9e23-8bcae96a0b3c
          stepCounter: edd4a3a3-5fa1-415e-9d11-a1bdd00bee99
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ACCT_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2237daf0-4078-468f-a937-1b6f0113f180
                stepCounter: eded27ac-fd68-4b41-8110-94b692c365d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 73f93b26-dd41-424a-8561-588d0587cf3e
          stepCounter: edd4a3a3-5fa1-415e-9d11-a1bdd00bee99
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Line Item Fucntional Area SAP Code (ACDOCA.RFAREA)
        name: FUNCTIONAL_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4dd125fa-6f51-491e-9664-b156fa6e1cc6
                stepCounter: 181145f3-06a6-4ad9-b836-9a574745c577
            transform: COALESCE(LOAD_VET_FIN_SAP_ACCOUNT_ATTR.FAREA, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_5.FAREA, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_10.FAREA, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_13.FAREA)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bdf99b09-1fce-4156-a568-1c63a5328920
          stepCounter: edd4a3a3-5fa1-415e-9d11-a1bdd00bee99
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: FUNCTIONAL_AREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b04d2b4d-12c4-487d-9c2f-e05dd85350f9
                stepCounter: 43c13db8-7f40-4ec6-b4cb-fb85c4f1f157
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69380289-ae34-487c-91b6-084901fcb7bd
          stepCounter: edd4a3a3-5fa1-415e-9d11-a1bdd00bee99
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: Lease Ops Account Group Code
        name: ACCT_GROUP_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1688c7bb-3d0d-4a5c-90c0-e36aee96f970
                stepCounter: 181145f3-06a6-4ad9-b836-9a574745c577
            transform: COALESCE(LOAD_VET_FIN_SAP_ACCOUNT_ATTR.ACCT_GROUP_CODE, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_5.ACCT_GROUP_CODE, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_10.ACCT_GROUP_CODE, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_13.ACCT_GROUP_CODE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b7024a5-91fd-4187-9808-5a9dd2972ff8
          stepCounter: edd4a3a3-5fa1-415e-9d11-a1bdd00bee99
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: Lease Ops Product Code
        name: PROD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a9735c6e-3acf-4cb3-9ad5-d21dfe0c8063
                stepCounter: 181145f3-06a6-4ad9-b836-9a574745c577
            transform: COALESCE(LOAD_VET_FIN_SAP_ACCOUNT_ATTR.PROD_CODE, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_5.PROD_CODE, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_10.PROD_CODE, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_13.PROD_CODE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db6a0fc5-5753-4ee4-ae3c-448dfca4a9dd
          stepCounter: edd4a3a3-5fa1-415e-9d11-a1bdd00bee99
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: AFE_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe5e0b24-3c8e-4ddf-a3f1-3e9faead87ed
                stepCounter: f1879670-70ca-4133-bc5d-193fd6cd9104
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6defdc01-a2db-4c06-bbd2-bc52ea5e4b15
          stepCounter: edd4a3a3-5fa1-415e-9d11-a1bdd00bee99
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: Description for the code.
        name: AFE_TYPE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 25bfe9a8-74d3-4767-9717-c5569c90a7fd
                stepCounter: f1879670-70ca-4133-bc5d-193fd6cd9104
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a92ce284-8f39-4b13-b6f8-48538f81e2f1
          stepCounter: edd4a3a3-5fa1-415e-9d11-a1bdd00bee99
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Is Summary Subset Line No
        name: FLG_SUMMARY_SUBSET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa1b948b-088f-4207-9269-889f0283a6bf
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 763834c0-7b56-420d-b1c5-50d0e685817a
          stepCounter: edd4a3a3-5fa1-415e-9d11-a1bdd00bee99
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Is Financial Subset Line No
        name: FLG_FIN_SUBSET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c1a6232c-e0c8-41af-b57c-33ba2ff0162e
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15e72026-c67e-4d15-83af-6996ce87dfa6
          stepCounter: edd4a3a3-5fa1-415e-9d11-a1bdd00bee99
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Financial Subset Name
        name: FIN_SUBSET_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b97d0a8d-337c-47f3-aaee-101b624646fb
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf9da43a-b93d-453f-b32c-d498c6d6c9c6
          stepCounter: edd4a3a3-5fa1-415e-9d11-a1bdd00bee99
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83f42790-e306-4c73-b069-965825f6ccb6
                stepCounter: 181145f3-06a6-4ad9-b836-9a574745c577
            transform: COALESCE(LOAD_VET_FIN_SAP_ACCOUNT_ATTR.CREATE_DATE, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_5.CREATE_DATE, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_10.CREATE_DATE, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_13.CREATE_DATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5456bf70-48cc-409f-8e9a-536b6e5257ff
          stepCounter: edd4a3a3-5fa1-415e-9d11-a1bdd00bee99
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: UPDATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 04397b26-d6fe-4b7a-9ce5-f13371820b94
                stepCounter: 181145f3-06a6-4ad9-b836-9a574745c577
            transform: COALESCE(LOAD_VET_FIN_SAP_ACCOUNT_ATTR.UPDATE_DATE, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_5.UPDATE_DATE, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_10.UPDATE_DATE, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_13.UPDATE_DATE)
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DIM_LO_SAP_LEASE_OPS_HIER: e0b535c4-f94e-4ac1-b685-dfdff6293176
          LOAD_VET_FIN_SAP_ACCOUNT_ATTR: 181145f3-06a6-4ad9-b836-9a574745c577
          DIM_LO_SAP_GL_ACCOUNT: eded27ac-fd68-4b41-8110-94b692c365d5
          ODS_SAP_TFKBT: 43c13db8-7f40-4ec6-b4cb-fb85c4f1f157
          LOAD_VET_FIN_SAP_AFE_TYPE_ATTR: 8702aa25-7591-4f91-9bfe-26019e5744dc
          DIM_LO_SAP_AFE_TYPE: f1879670-70ca-4133-bc5d-193fd6cd9104
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_HIER
          - locationName: TARGET
            nodeName: LOAD_VET_FIN_SAP_ACCOUNT_ATTR
          - locationName: TARGET
            nodeName: DIM_LO_SAP_GL_ACCOUNT
          - locationName: TARGET
            nodeName: ODS_SAP_TFKBT
          - locationName: TARGET
            nodeName: LOAD_VET_FIN_SAP_AFE_TYPE_ATTR
          - locationName: TARGET
            nodeName: DIM_LO_SAP_AFE_TYPE
        join:
          joinCondition: |-
            FROM {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_HIER') }} DIM_LO_SAP_LEASE_OPS_HIER
              LEFT JOIN {{ ref('TARGET','LOAD_VET_FIN_SAP_ACCOUNT_ATTR') }} LOAD_VET_FIN_SAP_ACCOUNT_ATTR
                ON LOAD_VET_FIN_SAP_ACCOUNT_ATTR.LINE_NO = DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','LOAD_VET_FIN_SAP_ACCOUNT_ATTR') }}
                     WHERE LINE_NO IN ('20.1','20.2','20.3', '20.4')
                   ) LOAD_VET_FIN_SAP_ACCOUNT_ATTR_5
                ON REPLACE(LOAD_VET_FIN_SAP_ACCOUNT_ATTR_5.LINE_NO, '20.', '5.') = DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','LOAD_VET_FIN_SAP_ACCOUNT_ATTR') }}
                     WHERE LINE_NO IN ('20.1','20.2','20.3', '20.4')
                   ) LOAD_VET_FIN_SAP_ACCOUNT_ATTR_10
                ON REPLACE(LOAD_VET_FIN_SAP_ACCOUNT_ATTR_10.LINE_NO, '20.', '10.') = DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','LOAD_VET_FIN_SAP_ACCOUNT_ATTR') }}
                     WHERE LINE_NO IN ('20.1','20.2','20.3', '20.4')
                   ) LOAD_VET_FIN_SAP_ACCOUNT_ATTR_13
                ON REPLACE(LOAD_VET_FIN_SAP_ACCOUNT_ATTR_13.LINE_NO, '20.', '13.') = DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_GL_ACCOUNT') }} DIM_LO_SAP_GL_ACCOUNT
                ON COALESCE(LOAD_VET_FIN_SAP_ACCOUNT_ATTR.ACCOUNT, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_5.ACCOUNT, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_10.ACCOUNT, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_13.ACCOUNT) = DIM_LO_SAP_GL_ACCOUNT.ACCOUNT
              LEFT JOIN {{ ref('TARGET','ODS_SAP_TFKBT') }} ODS_SAP_TFKBT
                ON COALESCE(LOAD_VET_FIN_SAP_ACCOUNT_ATTR.FAREA, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_5.FAREA, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_10.FAREA, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_13.FAREA) = ODS_SAP_TFKBT.FKBER
               AND ODS_SAP_TFKBT.SPRAS = 'E'
              LEFT JOIN {{ ref('TARGET','LOAD_VET_FIN_SAP_AFE_TYPE_ATTR') }} LOAD_VET_FIN_SAP_AFE_TYPE_ATTR
                ON DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO = LOAD_VET_FIN_SAP_AFE_TYPE_ATTR.LINE_NO
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_AFE_TYPE') }} DIM_LO_SAP_AFE_TYPE
                ON LOAD_VET_FIN_SAP_AFE_TYPE_ATTR.AFE_TYPE = DIM_LO_SAP_AFE_TYPE.AFE_TYPE
             ORDER BY DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO_SEQ,
                      COALESCE(LOAD_VET_FIN_SAP_ACCOUNT_ATTR.ACCOUNT, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_5.ACCOUNT, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_10.ACCOUNT, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_13.ACCOUNT),
                      LOAD_VET_FIN_SAP_AFE_TYPE_ATTR.AFE_TYPE
        name: VIEW_LO_SAP_ACCOUNT_GLOP_ATTR
        noLinkRefs: []
  name: VIEW_LO_SAP_ACCOUNT_GLOP_ATTR
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
