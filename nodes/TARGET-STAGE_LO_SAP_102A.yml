fileVersion: 1
id: 3e3753cd-2f4b-4cb9-9dbc-07e0acb4d7ba
name: STAGE_LO_SAP_102A
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e404f9e6-6bde-43f3-ab84-3c27fd02ab2c
          stepCounter: 3e3753cd-2f4b-4cb9-9dbc-07e0acb4d7ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEDGER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3d15d52d-aa78-4a52-95d1-a4ad5c668dee
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2eee269a-79d8-41ea-b686-01fb93ff48ec
          stepCounter: 3e3753cd-2f4b-4cb9-9dbc-07e0acb4d7ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACTVY_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 54526b1e-45d8-48aa-bb3b-bfef2e8ff111
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02899eb5-b310-401c-9160-7da31c6ed335
          stepCounter: 3e3753cd-2f4b-4cb9-9dbc-07e0acb4d7ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACCT_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc270c5c-d31f-4a6a-8b81-e546b72614b6
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c81e626d-2978-4a28-917a-8e423a33d10a
          stepCounter: 3e3753cd-2f4b-4cb9-9dbc-07e0acb4d7ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_COST_CENTER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 124036cf-4525-4288-ae32-53c4b83c69f6
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ab1ebb6-d378-4103-847d-45284f2c5afa
          stepCounter: 3e3753cd-2f4b-4cb9-9dbc-07e0acb4d7ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec389d53-6581-4b6d-aa98-762d53c5aee4
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5da66d78-440f-481a-a015-d0c6cccf0094
          stepCounter: 3e3753cd-2f4b-4cb9-9dbc-07e0acb4d7ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_DEST_ORGANIZATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 62f1e7a5-2cf8-4b1e-a279-743f79de109b
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ed1fb3c-9fed-41b9-ae01-9f16077ce692
          stepCounter: 3e3753cd-2f4b-4cb9-9dbc-07e0acb4d7ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GL_ACCOUNT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b3eee47-9239-408b-8dd8-c70ea98c5af3
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 35002150-780d-4360-88b9-af48718f2937
          stepCounter: 3e3753cd-2f4b-4cb9-9dbc-07e0acb4d7ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 154068f9-4120-427b-9543-030412be64f4
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0fd6fd82-c864-4b63-a8ec-9ddeafb795a3
          stepCounter: 3e3753cd-2f4b-4cb9-9dbc-07e0acb4d7ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_HIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21fac97a-151e-4cc2-8783-56a1148d309b
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9d803b0-5c09-4cbd-9c8c-042fc8ad50fb
          stepCounter: 3e3753cd-2f4b-4cb9-9dbc-07e0acb4d7ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_VERSION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5bac2b5d-65d6-45f4-b87f-59ea54635d37
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ebfb915-a2a2-4b1a-af77-5fc847a86041
          stepCounter: 3e3753cd-2f4b-4cb9-9dbc-07e0acb4d7ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LINE_ITEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a38e2a1f-fc5e-4c3e-b3ee-918fd8e715ea
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 588dac2e-3cdb-4d26-9769-6af1b17e05f1
          stepCounter: 3e3753cd-2f4b-4cb9-9dbc-07e0acb4d7ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_VOUCHER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6410658d-ee93-46a9-9b43-e51ba4044476
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bcc888d5-050f-4b37-8e3a-b8b7ea208a93
          stepCounter: 3e3753cd-2f4b-4cb9-9dbc-07e0acb4d7ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79f0c691-6e9d-476d-b7dc-11207d4ffd5e
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b25c66fb-36ca-4b63-8ce5-920cd6be2960
          stepCounter: 3e3753cd-2f4b-4cb9-9dbc-07e0acb4d7ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_INVOICE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c720c959-a12b-4fd8-b12b-1cca9d613b94
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f57e251-e1d8-47b5-b5f6-bc4d635e86f4
          stepCounter: 3e3753cd-2f4b-4cb9-9dbc-07e0acb4d7ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_PRODUCT_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3933b1e5-6132-4961-8d98-bdcbf5304485
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 718d4aa8-2666-4944-8e2f-64f07ab58383
          stepCounter: 3e3753cd-2f4b-4cb9-9dbc-07e0acb4d7ba
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1a83d4b-9af5-4a64-b5b2-f6f811cf7698
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80e7921a-ef0e-47c0-ace5-4ca4f2d19e83
          stepCounter: 3e3753cd-2f4b-4cb9-9dbc-07e0acb4d7ba
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6316db0f-0ffe-4164-b4f0-ee82cf5a4f2e
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: SUM(OP_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 813378e3-fd14-43fc-81df-f61444ac3fa5
          stepCounter: 3e3753cd-2f4b-4cb9-9dbc-07e0acb4d7ba
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8193d3fc-ef33-46f0-8de4-59ce89ac19a1
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: SUM(CAD_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4dfea071-54e2-4768-89ff-0ccea2b5a8f6
          stepCounter: 3e3753cd-2f4b-4cb9-9dbc-07e0acb4d7ba
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: 'Gross Line Item Net Op Amount '
        name: NET_OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33f00836-a784-43e0-8c43-37f890b196b6
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: SUM(NET_OP_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 12f0eea4-bc15-4143-84b6-5634d275bce7
          stepCounter: 3e3753cd-2f4b-4cb9-9dbc-07e0acb4d7ba
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: LI_VOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24e990a3-fd59-4608-9c40-4f07d5c0acfa
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da537fc4-5975-420c-9980-ec9b7a442dac
          stepCounter: 3e3753cd-2f4b-4cb9-9dbc-07e0acb4d7ba
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in cubic meters (m3)
        name: LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91df505d-670d-4080-82b4-c2135a4c8e29
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8feecc71-de04-4d81-94cb-ac741c5bfd87
          stepCounter: 3e3753cd-2f4b-4cb9-9dbc-07e0acb4d7ba
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in imperial measurement
        name: LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e9be255-7a00-4d64-9245-87e8580d76df
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07b72633-c168-4f5c-aa3b-7fe9cb1b1722
          stepCounter: 3e3753cd-2f4b-4cb9-9dbc-07e0acb4d7ba
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in BOE (Barrel of Oil Equivalent)
        name: LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 455f1e13-fd1c-4b60-8d28-b1e065f6dc16
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 468379d0-23d9-4be8-940d-688f258ee545
          stepCounter: 3e3753cd-2f4b-4cb9-9dbc-07e0acb4d7ba
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in normalized cubic meters (nm3)
        name: LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b3902e89-72c5-46f5-b553-e54f82534123
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0674e77-36ed-4e71-8bf1-1b6d63e69c8a
          stepCounter: 3e3753cd-2f4b-4cb9-9dbc-07e0acb4d7ba
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: ""
        name: EXCHANGE_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 066b21ad-5d5f-4b6a-9764-68487cc90eb2
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd603440-1784-4f04-83c9-2ea05a4ad939
          stepCounter: 3e3753cd-2f4b-4cb9-9dbc-07e0acb4d7ba
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f51c159-b610-41c4-999c-06d6d16fe1a7
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26d3a3fe-2540-4db9-9a34-4c6a50cff8b1
          stepCounter: 3e3753cd-2f4b-4cb9-9dbc-07e0acb4d7ba
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Indicates amounts are gross or net.
        name: GROSS_OR_NET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 201dfbac-08f1-41ae-8696-1029994419d9
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4690ad66-1f04-4e2c-819d-8bbdd793ca52
          stepCounter: 3e3753cd-2f4b-4cb9-9dbc-07e0acb4d7ba
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: LINE_NO_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4460264-eeac-48f7-bae2-1748cdbcf9cb
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79d264b3-af81-4165-9260-7ff63d5bceec
          stepCounter: 3e3753cd-2f4b-4cb9-9dbc-07e0acb4d7ba
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: OP_NONOP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a2fd8fa-b76c-431e-8314-a93c76526811
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7bb57a4-65db-4d97-bf3c-623c2d359ece
          stepCounter: 3e3753cd-2f4b-4cb9-9dbc-07e0acb4d7ba
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PROD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_LO_SAP_FIRST_PASS: 7f87de3d-bdfa-4c2a-af50-4179beced526
          DIM_LO_SAP_LEASE_OPS_HIER: 82938641-7c51-4aff-ad3a-c7a56af30c01
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_FIRST_PASS
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_HIER
        join:
          joinCondition: |-
            FROM {{ ref('TARGET','STAGE_LO_SAP_FIRST_PASS') }} STAGE_LO_SAP_FIRST_PASS
             CROSS JOIN (
                    SELECT DIM_LEASE_OPS_HIER_KEY,
                           LINE_NO,
                           LINE_NO_GROUP
                      FROM {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_HIER') }}
                     WHERE DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO = '102A'
                   ) DIM_LO_SAP_LEASE_OPS_HIER
             WHERE STAGE_LO_SAP_FIRST_PASS.LINE_NO = '102A'
             GROUP BY STAGE_LO_SAP_FIRST_PASS.DIM_LEDGER_KEY,
                      STAGE_LO_SAP_FIRST_PASS.DIM_ACTVY_PER_DATE_KEY,
                      STAGE_LO_SAP_FIRST_PASS.DIM_ACCT_PER_DATE_KEY,
                      STAGE_LO_SAP_FIRST_PASS.DIM_COST_CENTER_KEY,
                      STAGE_LO_SAP_FIRST_PASS.DIM_AFE_TYPE_KEY,
                      STAGE_LO_SAP_FIRST_PASS.DIM_DEST_ORGANIZATION_KEY,
                      STAGE_LO_SAP_FIRST_PASS.DIM_GL_ACCOUNT_KEY,
                      STAGE_LO_SAP_FIRST_PASS.DIM_GROSS_NET_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.DIM_LEASE_OPS_HIER_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO_GROUP,
                      STAGE_LO_SAP_FIRST_PASS.DIM_LEASE_OPS_VERSION_KEY,
                      STAGE_LO_SAP_FIRST_PASS.DIM_LINE_ITEM_KEY,
                      STAGE_LO_SAP_FIRST_PASS.DIM_VOUCHER_KEY,
                      STAGE_LO_SAP_FIRST_PASS.DIM_AFE_KEY,
                      STAGE_LO_SAP_FIRST_PASS.DIM_INVOICE_KEY,
                      STAGE_LO_SAP_FIRST_PASS.DIM_PRODUCT_TYPE_KEY,
                      STAGE_LO_SAP_FIRST_PASS.EXCHANGE_RATE,
                      STAGE_LO_SAP_FIRST_PASS.OP_CURR_CODE,
                      STAGE_LO_SAP_FIRST_PASS.GROSS_OR_NET_CODE,
                      STAGE_LO_SAP_FIRST_PASS.OP_NONOP
        name: STAGE_LO_SAP_102A
        noLinkRefs: []
  name: STAGE_LO_SAP_102A
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
