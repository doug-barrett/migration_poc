fileVersion: 1
id: a1e708a4-e1c7-4d04-959f-c031c26752a5
name: S_NEEDS_ASSESSMENT_NASC_20
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94f7fd29-a9a8-45c2-806c-be2c9c5d11d4
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: CONTACT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5a5bca8-5b53-48e5-9a5d-43330397db67
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 723cdec9-6f90-43f9-af56-889b20be700b
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: CONTACT_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 743442aa-a5a5-484e-bc0d-a1bb73b97078
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6d9f731-4040-4b34-ba5b-897012313c12
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_needs_assessment_NASC_20.contact_encounter_type_code=dim_encounter_type.encounter_type_code
        name: DIM_ENCOUNTER_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3ba8df3-db2e-40a1-97dc-d5ad6a5186a7
                stepCounter: 1d0ea6a1-9563-4fb3-a1fa-9d43dbdf296e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab91a429-5ee3-4c12-9738-bee09665481a
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: TASK_REQUEST_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b56e376-8504-4ef2-bd9c-96035e0e8eb9
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0dfd653-664b-4704-9884-ea50a156ddec
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: ""
        name: PROGRAMME_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1fa1901-710e-4b3e-8c96-559f6cb28cd9
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a12783d-3a0e-48bd-a9c0-1eb426d53cb4
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: patient_programme_status
        name: PROGRAMME_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 865d01c5-a819-44e5-adae-016332b0c111
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b73d7f25-9f6a-435f-9c97-8f4817cfe71c
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b83539f9-858b-450a-9cc0-f5f046995825
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69edfcb4-4a31-4406-a239-f456fbf1f9ea
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: Generated artificial key
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9962a01b-5f3d-4c1a-b371-997edef38d0f
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: IFNULL(dim_patient.dim_patient_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4567513-b615-4094-8aba-77fab2f9f5e0
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_AGE_AT_CONTACT_YEARS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f201416-ac35-4870-a0c1-0836d1b9e5b7
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: FLOOR(DATEDIFF(dd,dim_patient.patient_date_of_birth, CASE WHEN IFNULL(dim_patient.patient_date_of_death,s_needs_assessment_NASC_10.task_request_date) < s_needs_assessment_NASC_10.task_request_date THEN IFNULL(dim_patient.patient_date_of_death,s_needs_assessment_NASC_10.task_request_date) ELSE s_needs_assessment_NASC_10.task_request_date END) / 365.25)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a917cb4-a120-4d9d-b858-16236a495af2
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_needs_assessment_NASC_20.patient_age_at_contact_years=dim_age_group.age_years
        name: DIM_AGE_GROUP_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18bfabd7-19aa-4de0-9ce7-aa560645bce6
                stepCounter: 3d5ba8a8-80ec-4848-b58a-d31b34cc53ed
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f64916db-39fc-43d5-b92a-babca60822b6
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: DOMICILE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 13e3f44a-7125-438f-b00f-42c54a307c05
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1cd73291-94bb-4230-9ca7-3b5b3154ebfd
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_needs_assessment_NASC_20.domicile_code=dim_domicile.domicile_code
        name: DIM_DOMICILE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e049fc8-a2a3-4bad-9b91-11b9d158b35e
                stepCounter: 330ad0aa-b8b1-4da9-ab37-b4fe8f889452
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e298c865-662c-4cfd-944d-ee71891f5d9d
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: TASK_TYPE_DESC
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b7fefe7-5283-4090-912d-bad78ceee80b
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c99f003b-1639-409b-b4f0-ba9c6cd77a51
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: HEALTH_ORG_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6df705c5-bce4-4aa5-9ef1-2a85fc39289d
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb032760-b231-4b30-90dc-08b31763bf4b
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_needs_assessment_NASC_20.health_org_reference_no=dim_health_organisation.health_org_reference_no
        name: DIM_HEALTH_ORG_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78290bb6-3cd5-4503-8179-d1f65525ba15
                stepCounter: 0790fdf4-e815-4587-a9cd-954ea13f53c6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1984aa45-252c-40e6-a3f3-adde6cb2a6ed
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SEEN_BY_CLINICIAN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27fe06ea-e657-43a5-a88b-262d9cb5b3ce
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f49d9aa5-3300-4915-b3e8-fc5ab550bf69
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f93cf72c-5ae3-45ce-8645-39da33b020c0
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0cf87ed3-dcf5-4d1b-8ba5-754da0ffe0dc
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_needs_assessment_NASC_20.seen_by_clinician_reference_no=dim_seen_by_clinician.seen_by_clinician_reference_no
        name: DIM_SEEN_BY_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6980c5e-497d-45d3-854e-f5d17228ad86
                stepCounter: 293e84bb-0ad7-4a27-96ab-0a0cb38c50c5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b63b2b1f-a9ae-4c32-8b23-bc0d6a2377ca
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa708a27-f6c0-42fc-b15c-e72d715067eb
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a60d590-ed19-4a25-b536-cafcf50aa6d9
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: HOSPITAL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc623566-1691-4f77-a604-7f14ea11d481
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2cc5e18-5b18-4357-a342-3da0e60e98eb
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PROVIDER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 139d5753-dbab-4e53-8e81-4a7eaef94af8
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7af35cc2-6370-4d30-ab26-1f2d453c0cac
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_needs_assessment_NASC_20.provider_id=dim_provider_community.provider_id
        name: DIM_PROVIDER_COMMUNITY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 81b90d7a-0e1c-4ff6-a2e5-e32763dfcbcd
                stepCounter: fe333361-f763-4fd4-b86e-f42e95e81344
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f351c8bb-8d2b-4ac8-92d1-10037efc666a
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PROVIDER_ROLE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b4f2d5e-bb4a-4e13-b92d-de2cecfe8560
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 858c35f5-2cf6-44e8-8ff8-0882e48a57d5
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PROGRAMME_ROLE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a8ad8577-fa52-4a93-832e-052ad4b7e16b
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b381899a-1917-4b8b-96b5-3f3b8e1b9a62
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_needs_assessment_NASC_20.programme_role_code=dim_role_community.role_code
        name: DIM_ROLE_COMMUNITY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: acff4fff-07f1-43da-966d-53a96d429471
                stepCounter: ab48ab83-7613-4d28-acbd-ba81b413fe84
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 906bd741-47c8-43a4-9159-38149a6c23ec
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: DEPARTMENT_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b17ea66a-cfc5-4a03-a815-9c14396cfcb9
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a24e1bce-a178-4d6a-adda-7ec59caac818
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SERVICE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2cdcae8c-79ee-4ab7-9fde-0824c5e87227
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd05c27a-7c6b-4da7-a47a-f5be96c5550f
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: TASK_REQUEST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9065bedf-9b21-49ad-9889-a49bbf625088
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d19883f-445b-4bb8-89a3-3c74641723fc
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_needs_assessment_NASC_20.CONVERT(date,s_needs_assessment_NASC_10.task_request_date)=dim_request_date.request_calendar_date
        name: DIM_REQUEST_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 776fe4b8-0bb6-494d-a530-7fae3de7a539
                stepCounter: d1b797ef-4926-45af-a745-f75c3ed18b1f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e85c56a1-0db8-4c4f-8f99-0d9e4e336fb3
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: EPISODE_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dd739ffd-6732-4fe7-a492-a6e9c7d12bde
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e330ca1-d3c0-4769-8928-98b08b77c855
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: CSC_CARD_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8fa18f47-0bd2-454b-9910-38d736a4347e
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15d7c1fc-b60f-443d-9206-1bc9ca43a323
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: LIVING_SITUATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 32c8da2a-1a84-46f9-82bf-6067bd6bfad4
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad0671a0-25c6-4b76-b8c2-d7fd2e0aada5
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: WHERE_THEY_LIVE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d41db2a0-1164-40d6-95c2-aac38ef50872
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6084621d-d9be-4039-914d-46d76bd25e4c
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SPA_BAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: da4f7da4-b076-417d-97a3-efeadbb779c4
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 760c2df2-1aea-4049-8b46-e868b2d18733
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ASSESSMENT_LOCATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7690f420-0667-424b-aa24-c354462689dd
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b995c259-bfd3-489e-b004-6bd95a318012
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: OUTCOME_ACTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0d624fd8-8a52-4e06-9aef-cf353f89c830
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d9d57b2-f97f-4f5b-a6d5-683ef673ea9d
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: EXIT_REASON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00197cf2-ec84-43e4-b38c-be913df6842a
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c942f48d-96a5-4778-969f-564d58412207
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: EXIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f87ffd72-0be4-41d6-b890-34c3978f74d0
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2519681-fdf8-4f14-a956-3ea6aa727777
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SCID_MIGRATED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b71529f3-b1e3-42ed-a49c-7e2c2d19682e
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ece99a9a-aa48-45b6-aa33-792cfc53cb99
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ASSESSMENT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a6197b1-e926-47ce-9518-ce6b04bf8316
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e3f57f9-9c22-4525-95e1-66a426174ba5
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ASSESSMENT_COMPLETED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe358716-3bbe-4528-95c6-bdef18655fb5
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bc306dff-93ae-4ee7-80af-d8f7c073eb9b
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: TRANSFER_NASC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3f5a5406-3316-426c-bd08-adc076d23f50
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33caf0e4-5a35-4352-9048-3b7d0ac093a3
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: TRANSFER_DHB
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 42e01970-f0c7-4ef0-9a3a-b1654f4511b4
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f726468-c031-4ba0-b9d3-10a43c303305
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: TRANSFER_REASON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c03c554-7636-4dfc-a15c-d904cccb0331
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f939267c-67f2-47d8-bd43-7cc70949fe47
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: TRANSFER_OUT_RESIDENTIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a99019b1-6ed8-4c7a-8d44-35ebfe4ebe1f
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df87f994-766c-4770-a7cb-55792e651316
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: TRANSFER_OUT_DHB
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd25267b-712f-4017-9f6b-e2c236c23556
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91db0e90-d045-491d-8460-916f12306c21
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_needs_assessment_NASC_20.CSC_card_flag=dim_NASC_needs_assessment.CSC_card_flag  s_needs_assessment_NASC_20.living_situation=dim_NASC_needs_assessment.living_situation  s_needs_assessment_NASC_20.where_they_live=dim_NASC_needs_assessment.where_they_live  s_needs_assessment_NASC_20.SPA_band=dim_NASC_needs_assessment.SPA_band  s_needs_assessment_NASC_20.assessment_location=dim_NASC_needs_assessment.assessment_location  s_needs_assessment_NASC_20.outcome_action=dim_NASC_needs_assessment.outcome_action  s_needs_assessment_NASC_20.exit_reason=dim_NASC_needs_assessment.exit_reason  s_needs_assessment_NASC_20.assessment_type=dim_NASC_needs_assessment.assessment_type  s_needs_assessment_NASC_20.transfer_NASC=dim_NASC_needs_assessment.transfer_NASC  s_needs_assessment_NASC_20.transfer_DHB=dim_NASC_needs_assessment.transfer_DHB  s_needs_assessment_NASC_20.transfer_reason=dim_NASC_needs_assessment.transfer_reason  s_needs_assessment_NASC_20.transfer_out_residential=dim_NASC_needs_assessment.transfer_out_residential  s_needs_assessment_NASC_20.transfer_out_DHB=dim_NASC_needs_assessment.transfer_out_DHB  s_needs_assessment_NASC_20.programme_status=dim_NASC_needs_assessment.patient_programme_status  s_needs_assessment_NASC_20.observation_report_status=dim_NASC_needs_assessment.observation_report_status
        name: DIM_NASC_NEEDS_ASSESSMENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dd274ca2-a09c-40dd-993a-66d170bd1e2c
                stepCounter: df4f5709-602f-4379-a7e8-96419c32c63a
            transform: IFNULL(dim_NASC_needs_assessment.dim_NASC_needs_assessment_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf8515b9-bcc4-43be-b7a0-e6cbf4e72b8b
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: FIRST_ASSESSMENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a6b32733-2c01-4d5c-a4d9-080eeab7f011
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: |-
              CASE WHEN s_needs_assessment_NASC_10.referral_assessment_seq_num = 1 THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ea5b7e1-9d21-40e9-9886-76c0f24f1e7b
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: '  '
        name: CURRENT_ASSESSMENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a6b32733-2c01-4d5c-a4d9-080eeab7f011
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: |-
              CASE WHEN s_needs_assessment_NASC_10.referral_assessment_seq_num = s_needs_assessment_NASC_10.referral_assessment_count THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a6d821b-5ba1-4aea-8f00-b448e8313dbf
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: OBSERVATION_REPORT_DUE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d174b09f-7860-489d-8ce3-6976934be6a9
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be351d77-795f-477d-8c76-2a9d0146d442
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: COMPLETION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 363469b0-543e-47e3-92d0-b3d72f39392e
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b4f7c9e-712d-4bf6-821a-9c6547543264
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: OBSERVATION_REPORT_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 81500a58-4e65-41c2-8b58-d32853606a48
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 676db258-18fc-4f76-a5a3-0d54b0bbd98c
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_ASSESSMENT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a6b32733-2c01-4d5c-a4d9-080eeab7f011
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4abdc90e-b574-40c6-bd27-a97b9b00444f
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_ASSESSMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bea2b352-cc1d-4010-a874-ea71a99da4bb
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a9521a2-26b3-422c-a99d-a6dd23e2e1d3
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NEEDS_ASSESSMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '1'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16334a19-2a61-4223-9592-6301ca9fc2bf
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a82f238f-3be3-432c-afdc-1c9924ea0a05
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ebcf91b-5b76-48a2-b759-0d5310f30dd4
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 313a6926-2269-45ab-82c0-59b371aef3de
                stepCounter: f584a610-5628-456a-a45f-eac66678a76e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b64bff1-aedf-4cab-9e95-a33502a4c8e4
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_needs_assessment_NASC_20.create_user_login_name=dim_user_login_concerto.user_name
        name: DIM_USER_LOGIN_CONCERTO_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16f2ac98-6185-439c-9a15-757698e43d58
                stepCounter: 4bf64241-1d0b-4a30-8919-350bb5d33ed1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b41c1fab-4ecf-4941-a8bc-3205470e5399
          stepCounter: a1e708a4-e1c7-4d04-959f-c031c26752a5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DIM_NASC_NEEDS_ASSESSMENT: df4f5709-602f-4379-a7e8-96419c32c63a
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_NEEDS_ASSESSMENT_NASC_10
          - locationName: TGT
            nodeName: DIM_NASC_NEEDS_ASSESSMENT
        join:
          joinCondition: |-
            FROM s_needs_assessment_NASC_10
              LEFT OUTER JOIN dim.dim_patient
                ON dim_patient.patient_NHI = s_needs_assessment_NASC_10.patient_NHI
               AND dim_patient.NHI_sequence = 1
              LEFT OUTER JOIN {{ ref('TGT','DIM_NASC_NEEDS_ASSESSMENT') }}
                ON s_needs_assessment_NASC_10.CSC_card_flag = dim_NASC_needs_assessment.CSC_card_flag
               AND s_needs_assessment_NASC_10.living_situation = dim_NASC_needs_assessment.living_situation
               AND s_needs_assessment_NASC_10.where_they_live = dim_NASC_needs_assessment.where_they_live
               AND s_needs_assessment_NASC_10.SPA_band = dim_NASC_needs_assessment.SPA_band
               AND s_needs_assessment_NASC_10.assessment_location = dim_NASC_needs_assessment.assessment_location
               AND s_needs_assessment_NASC_10.outcome_action = dim_NASC_needs_assessment.outcome_action
               AND s_needs_assessment_NASC_10.exit_reason = dim_NASC_needs_assessment.exit_reason
               AND s_needs_assessment_NASC_10.assessment_type = dim_NASC_needs_assessment.assessment_type
               AND s_needs_assessment_NASC_10.transfer_NASC = dim_NASC_needs_assessment.transfer_NASC
               AND s_needs_assessment_NASC_10.transfer_DHB = dim_NASC_needs_assessment.transfer_DHB
               AND s_needs_assessment_NASC_10.transfer_reason = dim_NASC_needs_assessment.transfer_reason
               AND s_needs_assessment_NASC_10.transfer_out_residential = dim_NASC_needs_assessment.transfer_out_residential
               AND s_needs_assessment_NASC_10.transfer_out_DHB = dim_NASC_needs_assessment.transfer_out_DHB
               AND s_needs_assessment_NASC_10.programme_status = dim_NASC_needs_assessment.patient_programme_status
               AND s_needs_assessment_NASC_10.observation_report_status = dim_NASC_needs_assessment.observation_report_status
        name: S_NEEDS_ASSESSMENT_NASC_20
        noLinkRefs: []
  name: S_NEEDS_ASSESSMENT_NASC_20
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
