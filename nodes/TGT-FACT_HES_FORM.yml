fileVersion: 1
id: 1b1269af-66b5-455a-92a8-4609aa7e7956
name: FACT_HES_FORM
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Form level information for HES forms including stuats out come etc"
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7fb89034-5216-48c6-9a5e-07277d2032eb
          stepCounter: 1b1269af-66b5-455a-92a8-4609aa7e7956
        config: {}
        dataType: INT
        defaultValue: ""
        description: s_HES_form.user_code=dim_user_login_concerto.user_name
        name: DIM_USER_LOGIN_CONCERTO_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16f2ac98-6185-439c-9a15-757698e43d58
                stepCounter: 4bf64241-1d0b-4a30-8919-350bb5d33ed1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be2631c0-3a3a-4d28-97aa-e799c81b949c
          stepCounter: 1b1269af-66b5-455a-92a8-4609aa7e7956
        config: {}
        dataType: BIT
        defaultValue: ""
        description: ""
        name: DECLINED_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d77b0335-a41c-484e-8eb7-527cfde33141
                stepCounter: 3453b109-b1e8-4c6c-aea8-1ac7ed5eee99
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26c7ce71-8e9c-4c61-a0ab-7b766a022888
          stepCounter: 1b1269af-66b5-455a-92a8-4609aa7e7956
        config: {}
        dataType: BIT
        defaultValue: ""
        description: ""
        name: ACCEPTED_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 87cd76aa-8555-4217-ba0f-6def474148c9
                stepCounter: 3453b109-b1e8-4c6c-aea8-1ac7ed5eee99
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18f2451a-c1ac-47bc-b678-61140000f0b7
          stepCounter: 1b1269af-66b5-455a-92a8-4609aa7e7956
        config: {}
        dataType: BIT
        defaultValue: ""
        description: ""
        name: FINAL_COMPLETED_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 86c1b059-5e38-43aa-8dc6-b86dd34ce6cf
                stepCounter: 3453b109-b1e8-4c6c-aea8-1ac7ed5eee99
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09a106e2-9056-4a0c-a1fe-8a17b3c2e6ad
          stepCounter: 1b1269af-66b5-455a-92a8-4609aa7e7956
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_HES_form.responsible_clinician=dim_HES_clinician.clinician
        name: DIM_HES_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d22144e7-1941-4187-8770-509957da90c3
                stepCounter: 5a59fe4c-4447-4897-ad87-83666b76c9e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6fdeded0-bcf7-4b88-b9b6-1831e9465f11
          stepCounter: 1b1269af-66b5-455a-92a8-4609aa7e7956
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8439b89d-98a9-46cb-8da5-4615c2702c04
                stepCounter: 3453b109-b1e8-4c6c-aea8-1ac7ed5eee99
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5342bb46-8850-4813-8d5a-056bfdd21aef
          stepCounter: 1b1269af-66b5-455a-92a8-4609aa7e7956
        config: {}
        dataType: VARCHAR(8000)
        defaultValue: ""
        description: ""
        name: REASON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ff2bb736-97d9-4ec1-b062-bc67db1a4148
                stepCounter: 3453b109-b1e8-4c6c-aea8-1ac7ed5eee99
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b142079e-f61b-46b3-aa65-2e7ef73f6080
          stepCounter: 1b1269af-66b5-455a-92a8-4609aa7e7956
        config: {}
        dataType: VARCHAR(8000)
        defaultValue: ""
        description: ""
        name: LAST_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 156c0975-13ae-4f48-bfa5-9ed28d9458c0
                stepCounter: 3453b109-b1e8-4c6c-aea8-1ac7ed5eee99
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf5a415c-c065-47da-be72-0072c967326b
          stepCounter: 1b1269af-66b5-455a-92a8-4609aa7e7956
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: BOOKING_SENT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0bfaebcd-039b-4b6d-8fb6-f523f24fcbf2
                stepCounter: 3453b109-b1e8-4c6c-aea8-1ac7ed5eee99
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8343e7cf-267e-4d48-8e35-f00741b3fd1d
          stepCounter: 1b1269af-66b5-455a-92a8-4609aa7e7956
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee7f8c91-e3b3-4225-80e7-ca1ee2894608
                stepCounter: 3453b109-b1e8-4c6c-aea8-1ac7ed5eee99
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25d6d799-85c1-45c2-8c7c-fb045550f441
          stepCounter: 1b1269af-66b5-455a-92a8-4609aa7e7956
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52fde1ec-beb6-4630-aa82-9fa7bb135a89
                stepCounter: 3453b109-b1e8-4c6c-aea8-1ac7ed5eee99
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c0db41a-42bf-4e22-a35a-646898d6f813
          stepCounter: 1b1269af-66b5-455a-92a8-4609aa7e7956
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ACTIVE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 186e598a-b808-4f0e-aa75-010e00d4baef
                stepCounter: 3453b109-b1e8-4c6c-aea8-1ac7ed5eee99
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb4afab5-fc49-4d32-8104-2001362196cd
          stepCounter: 1b1269af-66b5-455a-92a8-4609aa7e7956
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CVDIS_UPDATED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 10c64d11-ae06-4146-bbd1-5ae4722e1cab
                stepCounter: 3453b109-b1e8-4c6c-aea8-1ac7ed5eee99
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d21eccf-29d0-476d-8b20-c2986ba5d749
          stepCounter: 1b1269af-66b5-455a-92a8-4609aa7e7956
        config: {}
        dataType: INT
        defaultValue: ""
        description: common reference between cardiology system and Specialist referrals
        name: CDA_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84d96ea2-1d25-48af-8c37-b4b2052df787
                stepCounter: 3453b109-b1e8-4c6c-aea8-1ac7ed5eee99
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24dc888f-6182-40f8-9a1b-7dbe01ce41a6
          stepCounter: 1b1269af-66b5-455a-92a8-4609aa7e7956
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: HES_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1a5cd08f-67ad-4d5c-852f-fa81b42f9fba
                stepCounter: 3453b109-b1e8-4c6c-aea8-1ac7ed5eee99
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f7cddd7-675b-453b-8e9a-4cb6bc92635c
          stepCounter: 1b1269af-66b5-455a-92a8-4609aa7e7956
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ACCEPTED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ddaae59-aa81-4163-8373-79c44a0a2e13
                stepCounter: 3453b109-b1e8-4c6c-aea8-1ac7ed5eee99
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f33449d-194d-48bc-8254-06be21be4d9b
          stepCounter: 1b1269af-66b5-455a-92a8-4609aa7e7956
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PROCEDURE_COMPLETED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 58cd09e2-fa50-42ee-98b2-6d1e24300450
                stepCounter: 3453b109-b1e8-4c6c-aea8-1ac7ed5eee99
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: efed3843-bc69-444f-9921-a6ca130d8089
          stepCounter: 1b1269af-66b5-455a-92a8-4609aa7e7956
        config: {}
        dataType: INT
        defaultValue: ""
        description: s_HES_form.booking_sent_date=dim_HES_booking_sent_date.calendar_date
        name: DIM_HES_BOOKING_SENT_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8628e926-8789-4663-8901-a10e7c37b1b8
                stepCounter: 62ba7a9b-ac4a-4221-bfc7-fb44090a4ed9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57dee2f4-a759-4853-b97c-b64593cec3bb
          stepCounter: 1b1269af-66b5-455a-92a8-4609aa7e7956
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_HES_form.CIMS_service_order_code=dim_HES_CIMS_service_order_code.CIMS_service_order_code
        name: DIM_HES_CIMS_SERVICE_ORDER_CODE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 503c052b-91b8-46ac-b705-256228399bc6
                stepCounter: fe81005e-2c55-4bf7-a861-18ca79de5a29
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86180d32-9aff-41a7-9744-4d36f4bc0136
          stepCounter: 1b1269af-66b5-455a-92a8-4609aa7e7956
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_HES_form.outcome=dim_HES_outcome.outcome
        name: DIM_HES_OUTCOME_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f3bca8a-e288-4792-9bbd-0bc6ad186839
                stepCounter: a34d5914-112d-4328-8afc-f2e82d925732
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6dd71df4-b2b7-4b17-a9d9-78d1571b77d2
          stepCounter: 1b1269af-66b5-455a-92a8-4609aa7e7956
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_HES_form.priority=dim_HES_priority.priority
        name: DIM_HES_PRIORITY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 371ac592-dbe7-4fb4-a416-afe8078d73b9
                stepCounter: a86188be-17a6-4447-ac9c-f12287f58bef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 00885018-0eb3-4374-b2f8-dfae698c85ec
          stepCounter: 1b1269af-66b5-455a-92a8-4609aa7e7956
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_HES_form.procedure_outcome=dim_HES_procedure_outcome.procedureOutcome
        name: DIM_HES_PROCEDURE_OUTCOME_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50fbf931-f80d-4e5b-8fea-f70eb078f178
                stepCounter: 2e6ef219-d654-4877-ad8f-eb144807e4e3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b2d3562-dced-4026-9ac0-258f23cc1939
          stepCounter: 1b1269af-66b5-455a-92a8-4609aa7e7956
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_HES_form.referral_to_service=dim_HES_referral_to_service.referral_to_service
        name: DIM_HES_REFERRAL_TO_SERVICE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07d11a97-6a12-4ba5-9980-ce02ee05adc4
                stepCounter: 1bd49c9e-d112-4e7e-b563-de7bc2531700
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff7f64b7-edc0-4d97-8bd0-47f2e04d6f51
          stepCounter: 1b1269af-66b5-455a-92a8-4609aa7e7956
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_HES_form.referred_from=dim_HES_referred_from.referred_from
        name: DIM_HES_REFERRED_FROM_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 700ca555-6f27-4b76-9e14-12858d060c79
                stepCounter: 0ab6ca4c-ab8e-40c8-8e2e-06863d2c28d0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c27dffa5-882a-4dc4-ab3c-ba0166c2e7f0
          stepCounter: 1b1269af-66b5-455a-92a8-4609aa7e7956
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_HES_form.referred_to=dim_HES_referred_to.referred_to
        name: DIM_HES_REFERRED_TO_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9e610aa0-3f09-4ee8-8512-b1b73d48c856
                stepCounter: 05800ed7-a368-4a8e-b439-e1781b86744e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2c9aea0-e28c-4615-946c-761468c80669
          stepCounter: 1b1269af-66b5-455a-92a8-4609aa7e7956
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_HES_form.referral_ward=dim_HES_referral_ward.referral_ward
        name: DIM_HES_REFERRAL_WARD_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 205cd091-5256-4278-a421-5bcb972a8dff
                stepCounter: 30f10ff6-a787-4208-bd5b-c9312c4b4658
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e5b082b-93c3-469a-ba73-50616c691352
          stepCounter: 1b1269af-66b5-455a-92a8-4609aa7e7956
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_HES_form.patient_status=dim_HES_patient_status.patient_status
        name: DIM_HES_PATIENT_STATUS_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4d0110ec-15fe-4697-97b5-8c8f157f47a9
                stepCounter: 1656e03f-f056-47a3-a604-08777d45607c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3fe42709-d71d-4a0a-b7f5-a4de40fe0b4a
          stepCounter: 1b1269af-66b5-455a-92a8-4609aa7e7956
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_HES_form.template=dim_HES_template_names.template_code
        name: DIM_HES_TEMPLATE_NAMES_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef86d1ec-8037-4940-9fc5-e1ca66e47928
                stepCounter: a7419ce6-d590-440a-a9c9-37ba33cb0324
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d12fdbb-19ad-48cd-879d-f597e91335e6
          stepCounter: 1b1269af-66b5-455a-92a8-4609aa7e7956
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_HES_form.patient_reference_no=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9962a01b-5f3d-4c1a-b371-997edef38d0f
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3be083a-fbb9-4086-8c38-aeb6db1acb4d
          stepCounter: 1b1269af-66b5-455a-92a8-4609aa7e7956
        config: {}
        dataType: INT
        defaultValue: ""
        description: s_HES_form.procedure_completed_date=dim_HES_procedure_completed_date.calendar_date
        name: DIM_HES_PROCEDURE_COMPLETED_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4613cdab-892a-4713-82ba-0166e5ee83fd
                stepCounter: 518eb33d-5754-4650-8462-9d48fe5b128b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 36a7325d-704f-45ad-befe-4724131a24d0
          stepCounter: 1b1269af-66b5-455a-92a8-4609aa7e7956
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FINAL_COMPLETED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52edba34-d2ff-4c91-80d8-860e475d13e3
                stepCounter: 3453b109-b1e8-4c6c-aea8-1ac7ed5eee99
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f00447ab-cb4c-42b7-8940-607b204f544a
          stepCounter: 1b1269af-66b5-455a-92a8-4609aa7e7956
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DECLINED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 033c46ad-df42-4bf9-a172-c533bf50edbe
                stepCounter: 3453b109-b1e8-4c6c-aea8-1ac7ed5eee99
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9384061d-24e3-4aec-8657-8101b5c0c7b5
          stepCounter: 1b1269af-66b5-455a-92a8-4609aa7e7956
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_HES_form.health_org_reference_no=dim_hospital.health_org_reference_no
        name: DIM_HOSPITAL_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c1eff0c-fd0d-4a47-ad0f-2fd4a80c00a7
                stepCounter: ce5e5ba3-482d-46a9-a8ae-9f160067f51d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ed5f068-3318-4fec-a5d4-068e722ee87e
          stepCounter: 1b1269af-66b5-455a-92a8-4609aa7e7956
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_HES_form.status=dim_HES_status.status_code
        name: DIM_HES_STATUS_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a7d01aa-6f3e-4dda-b6cf-0664f9f4c676
                stepCounter: fc1a6aef-13c9-4fe4-881e-6a7d81cc3e1a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6adcd0cd-b9c9-4456-8239-de3f0b70d073
          stepCounter: 1b1269af-66b5-455a-92a8-4609aa7e7956
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_HES_FORM: 3453b109-b1e8-4c6c-aea8-1ac7ed5eee99
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DIM_USER_LOGIN_CONCERTO
          - locationName: TGT
            nodeName: S_HES_FORM
        join:
          joinCondition: |-
            FROM {{ ref('TGT','S_HES_FORM') }} s_HES_form
             WHERE 1=1
               AND status<> 0
        name: FACT_HES_FORM
        noLinkRefs: []
  name: FACT_HES_FORM
  overrideSQL: false
  schema: ""
  sqlType: Fact
  type: sql
  version: 1
type: Node
