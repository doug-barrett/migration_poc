fileVersion: 1
id: a9e5b6b5-c7fb-4e25-8db3-dbbff506de0d
name: AGGACCOUNTCURR12MOSTATS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: REPORTS
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 459629af-6940-43c6-bf61-4b2b9e37145e
          stepCounter: a9e5b6b5-c7fb-4e25-8db3-dbbff506de0d
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: FORCEPARENTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aaa0b8ea-2737-4185-8d58-9eba3759bc29
                stepCounter: ec3fe8ff-dfc1-44ec-8476-adb6bb53e332
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72dbb4b8-8225-4705-8336-5f9232aa332b
          stepCounter: a9e5b6b5-c7fb-4e25-8db3-dbbff506de0d
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Name of the Account's Parent. If there is no parent or this account is the top of the hierarchy then this will be the same as the Account Name.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ACCOUNTPARENTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de309bbb-e2d9-4c60-b88a-336eb195f986
                stepCounter: ec3fe8ff-dfc1-44ec-8476-adb6bb53e332
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f63cbc6c-b0df-4853-83a6-bb58a865b17f
          stepCounter: a9e5b6b5-c7fb-4e25-8db3-dbbff506de0d
        config: {}
        dataType: INT
        defaultValue: ""
        description: Number of suppliers used in the most recent 12 month period. The count is based upon the field FinancialReportingSupplierName.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CURR12MONUMOFSUPPLIERSUSED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c053359-4233-4379-80c2-b22a0087cfdc
                stepCounter: ec3fe8ff-dfc1-44ec-8476-adb6bb53e332
            transform: COUNT (DISTINCT FinancialReportingSupplierName)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 679e8293-8d80-44f1-b6c9-1277e6d42172
          stepCounter: a9e5b6b5-c7fb-4e25-8db3-dbbff506de0d
        config: {}
        dataType: INT
        defaultValue: ""
        description: Number of contracts used in the most recent 12 months. Count is based on PPAContractNumber
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CURR12MONUMOFCONTRACTSUSED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 917854bf-4f7d-4458-a52e-e73c35362d8d
                stepCounter: ec3fe8ff-dfc1-44ec-8476-adb6bb53e332
            transform: COUNT (DISTINCT PPAContractNumber)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 811a4e6d-8443-4b85-81d2-684121fe61cc
          stepCounter: a9e5b6b5-c7fb-4e25-8db3-dbbff506de0d
        config: {}
        dataType: INT
        defaultValue: ""
        description: Number of contract categories used in the most recent 12 months. Count is based on ContractCategory.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CURR12MONUMOFCATEGORIESUSED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 10cd6d5c-5ae7-4d92-928b-6fbd8e1a3c22
                stepCounter: ec3fe8ff-dfc1-44ec-8476-adb6bb53e332
            transform: COUNT (DISTINCT ContractCategory)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1cab9a5-6d3b-400e-a40d-a4e2a83d3ec5
          stepCounter: a9e5b6b5-c7fb-4e25-8db3-dbbff506de0d
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Last transaction date for account.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LASTTRANSACTIONDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7424409b-6105-4f21-9301-f3dbfd96fdbb
                stepCounter: ec3fe8ff-dfc1-44ec-8476-adb6bb53e332
            transform: MAX(ReceiptDate)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71e638b3-440d-473f-935a-963e3c906fb4
          stepCounter: a9e5b6b5-c7fb-4e25-8db3-dbbff506de0d
        config: {}
        dataType: INT
        defaultValue: ""
        description: Last transaction date for account.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: MONTHSSINCELASTTRANSACTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7424409b-6105-4f21-9301-f3dbfd96fdbb
                stepCounter: ec3fe8ff-dfc1-44ec-8476-adb6bb53e332
            transform: DATEDIFF(MONTH, MAX(TransactionDate), MAX(MaxReceiptDate))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39b4ac7c-baa7-4893-93db-8e55a55d9843
          stepCounter: a9e5b6b5-c7fb-4e25-8db3-dbbff506de0d
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Last transaction date for account.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CURR12MOLASTTRANSACTIONDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d419e78f-74ae-4c3e-944f-b79b22b35126
                stepCounter: ec3fe8ff-dfc1-44ec-8476-adb6bb53e332
            transform: MAX(TransactionDate)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d8d3cff-53fb-4584-bcbf-9b17e677ad44
          stepCounter: a9e5b6b5-c7fb-4e25-8db3-dbbff506de0d
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: Sum of Sales for the last 12 months
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CURR12MOSALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ead1eda-ce99-454b-9c29-673c6e5e55f3
                stepCounter: ec3fe8ff-dfc1-44ec-8476-adb6bb53e332
            transform: SUM(Sales)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f72f1640-d193-4449-9e53-ffb1d8dfa4a5
          stepCounter: a9e5b6b5-c7fb-4e25-8db3-dbbff506de0d
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: Sum of Revenue for last 12 months
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CURR12MOREVENUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4648ed9d-37a6-4c20-a538-ffc915b05493
                stepCounter: ec3fe8ff-dfc1-44ec-8476-adb6bb53e332
            transform: SUM(Revenue)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d36fa12-3568-42c5-bb0a-506d81e1487e
          stepCounter: a9e5b6b5-c7fb-4e25-8db3-dbbff506de0d
        config: {}
        dataType: INT
        defaultValue: ""
        description: New of new contracts used by account on a rolling 12 month basis.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CURR12MONUMOFNEWCONTRACTSUSED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: COUNT (DISTINCT CASE WHEN IsContractUseNewOrRecurringInTrailing12MonthsForForceParentId = 'New' THEN PPAcontractNumber END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 51432c8d-0a58-4446-956a-55f054fbb70a
          stepCounter: a9e5b6b5-c7fb-4e25-8db3-dbbff506de0d
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d24cf91-ccc6-4ad0-bd6a-fd7a9c3a5189
          stepCounter: a9e5b6b5-c7fb-4e25-8db3-dbbff506de0d
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VWSALESANDREVENUE: ec3fe8ff-dfc1-44ec-8476-adb6bb53e332
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: REPORTS
            nodeName: VWSALESANDREVENUE
        join:
          joinCondition: FROM {{ ref('REPORTS','VWSALESANDREVENUE') }}
        name: AGGACCOUNTCURR12MOSTATS
        noLinkRefs: []
  name: AGGACCOUNTCURR12MOSTATS
  overrideSQL: false
  schema: ""
  sqlType: Fact
  type: sql
  version: 1
type: Node
