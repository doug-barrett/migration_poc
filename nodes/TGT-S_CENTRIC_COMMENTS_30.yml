fileVersion: 1
id: 9a673d31-4691-471d-8013-54ba71518217
name: S_CENTRIC_COMMENTS_30
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 892f2574-088e-4eeb-867c-50ec62e2d002
          stepCounter: 9a673d31-4691-471d-8013-54ba71518217
        config: {}
        dataType: VARCHAR(MAX)
        defaultValue: ""
        description: ""
        name: STREAM_PATH
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN IPS.stream_path IS NULL THEN IFNULL(EDS.stream_path,EDS1.stream_path)
                          WHEN EDS.stream_path IS NULL THEN IPS.stream_path
                          ELSE replace(EDS.stream_path,'^|','|') + replace(IPS.stream_path,'|^','')
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3941fc3b-7a7d-45a3-b6db-bd08558298e1
          stepCounter: 9a673d31-4691-471d-8013-54ba71518217
        config: {}
        dataType: VARCHAR(MAX)
        defaultValue: ""
        description: ""
        name: ED_STREAM_PATH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IFNULL(EDS.stream_path,EDS1.stream_path)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6bf80121-19c7-4f0c-b0bd-e33d7d68ee39
          stepCounter: 9a673d31-4691-471d-8013-54ba71518217
        config: {}
        dataType: VARCHAR(MAX)
        defaultValue: ""
        description: ""
        name: IP_STREAM_PATH
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN IPS.stream_path IS NOT NULL AND right(EDS.stream_path,8) like '%Lilac%'                        THEN '|^Lilac|' + replace(IFNULL(IPS.stream_path,''),'|^','')
                          WHEN IPS.stream_path IS NOT NULL AND right(EDS.stream_path,8) like '%Blue%'                         THEN '|^Blue|' + replace(IFNULL(IPS.stream_path,''),'|^','')
                          WHEN IPS.stream_path IS NOT NULL AND right(EDS.stream_path,8) like '%Yellow%'                       THEN '|^Yellow|' + replace(IFNULL(IPS.stream_path,''),'|^','')
                          WHEN IPS.stream_path IS NOT NULL AND right(EDS.stream_path,8) like '%White%'                        THEN '|^White|' + replace(IFNULL(IPS.stream_path,''),'|^','')
                          WHEN IPS.stream_path IS NULL AND event_encounter_id IS NULL AND attendance_encounter_id IS NOT NULL THEN NULL
                          WHEN IPS.stream_path IS NULL AND right(IFNULL(EDS.stream_path,EDS1.stream_path),8) like '%Lilac%'   THEN '|^Lilac^|'
                          WHEN IPS.stream_path IS NULL AND right(IFNULL(EDS.stream_path,EDS1.stream_path),8) like '%Yellow%'  THEN '|^Yellow^|'
                          WHEN IPS.stream_path IS NULL AND right(IFNULL(EDS.stream_path,EDS1.stream_path),8) like '%White%'   THEN '|^White^|'
                          WHEN IPS.stream_path IS NULL AND right(IFNULL(EDS.stream_path,EDS1.stream_path),8) like '%Blue%'    THEN '|^Blue^|'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e8f301b-bf04-45aa-87f4-7df36f352af8
          stepCounter: 9a673d31-4691-471d-8013-54ba71518217
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a29176ff-dc40-4eb7-9897-00c913a75668
                stepCounter: a6dae28f-2628-448c-abb8-f5edbf0a742e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad753183-0719-40f9-8f1e-4be0b8b04d51
          stepCounter: 9a673d31-4691-471d-8013-54ba71518217
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b8dcd9a-28bb-40c6-bf65-6ef5db262872
                stepCounter: a6dae28f-2628-448c-abb8-f5edbf0a742e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f506e45-3348-4571-891d-f6c67758862a
          stepCounter: 9a673d31-4691-471d-8013-54ba71518217
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ATTENDANCE_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 351d00bb-0cec-4107-849a-4b13aeb2fcf2
                stepCounter: a6dae28f-2628-448c-abb8-f5edbf0a742e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49b18a8d-24e0-4494-abe3-4ae459901ae0
          stepCounter: 9a673d31-4691-471d-8013-54ba71518217
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: STREAM_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b8656aa0-2074-4db6-ba94-b5338321ef62
                stepCounter: a6dae28f-2628-448c-abb8-f5edbf0a742e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7cf54428-4ffb-46fa-b3c0-23a2cac9183c
          stepCounter: 9a673d31-4691-471d-8013-54ba71518217
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: STREAM_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7df01ce-d7ca-43e4-89ac-ff79448e9ae3
                stepCounter: a6dae28f-2628-448c-abb8-f5edbf0a742e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31d00cba-6949-4927-9604-aebfee4b67d2
          stepCounter: 9a673d31-4691-471d-8013-54ba71518217
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f188fd7e-0deb-449e-bcc7-3fab1a7380cf
                stepCounter: a6dae28f-2628-448c-abb8-f5edbf0a742e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 13f36b1b-7e7d-45c6-9f6b-d6ab9f726aac
          stepCounter: 9a673d31-4691-471d-8013-54ba71518217
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c559679-08ea-4c80-83b5-6ae5b5c886e8
                stepCounter: a6dae28f-2628-448c-abb8-f5edbf0a742e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8af99052-3971-420e-9ce8-b6fac9d13439
          stepCounter: 9a673d31-4691-471d-8013-54ba71518217
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a12bc6a9-dadc-4587-988e-587faf4c4264
                stepCounter: a6dae28f-2628-448c-abb8-f5edbf0a742e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49813fc4-598f-4f0c-9572-398f3e56574a
          stepCounter: 9a673d31-4691-471d-8013-54ba71518217
        config: {}
        dataType: VARCHAR(MAX)
        defaultValue: ""
        description: ""
        name: STREAM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e84fc0e6-3e0c-4061-9322-ed20e8096871
                stepCounter: a6dae28f-2628-448c-abb8-f5edbf0a742e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b1f9674-e0e8-402e-abd2-75003e61ef3b
          stepCounter: 9a673d31-4691-471d-8013-54ba71518217
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: CREATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 82d74a3f-d41d-4550-bc94-74a4ac52a663
                stepCounter: a6dae28f-2628-448c-abb8-f5edbf0a742e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f4146d6-e9b6-4fc5-9eca-afd95d7d3581
          stepCounter: 9a673d31-4691-471d-8013-54ba71518217
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 409d78c5-38be-46f6-9951-a8c48d7f599d
                stepCounter: a6dae28f-2628-448c-abb8-f5edbf0a742e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a456d4f-6137-4f9a-9204-9cc232224466
          stepCounter: 9a673d31-4691-471d-8013-54ba71518217
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DELETED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3d4b0d56-c634-4275-9a8d-544d834c14b0
                stepCounter: a6dae28f-2628-448c-abb8-f5edbf0a742e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a38c0d94-eac3-4ec4-9df8-e0d4a505d7bb
          stepCounter: 9a673d31-4691-471d-8013-54ba71518217
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DELETED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f25d9cb4-58d4-4c37-984c-260181c72e47
                stepCounter: a6dae28f-2628-448c-abb8-f5edbf0a742e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26421cf6-eb7d-4074-8add-a1d49cc2d1d8
          stepCounter: 9a673d31-4691-471d-8013-54ba71518217
        config: {}
        dataType: BIT
        defaultValue: ""
        description: ""
        name: DEPRECATED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b2d9335-d629-4ec1-8515-2e856a0b6d4d
                stepCounter: a6dae28f-2628-448c-abb8-f5edbf0a742e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8acb688-9aae-4827-8473-f03a5ee509cd
          stepCounter: 9a673d31-4691-471d-8013-54ba71518217
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies: []
        join:
          joinCondition: |-
            FROM s_centric_comments_20
              LEFT JOIN s_centric_stream_pathway_v IPS
                ON s_centric_comments_20.event_encounter_id = IPS.encounter
              LEFT JOIN s_centric_stream_pathway_v EDS
                ON s_centric_comments_20.attendance_encounter_id = EDS.encounter
              LEFT JOIN s_centric_stream_pathway_v EDS1
                ON s_centric_comments_20.encounter = EDS1.encounter
        name: S_CENTRIC_COMMENTS_30
        noLinkRefs: []
  name: S_CENTRIC_COMMENTS_30
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
