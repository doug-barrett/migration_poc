fileVersion: 1
id: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
name: S_ED_ATTENDANCE_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Combine all source data required to build the ED Attendance Fact"
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed9e5167-8032-4f20-8210-7c5200b8b023
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Encounter unique identifier
        name: ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 98e7bbf9-19d9-4ad3-9762-fc48190944fa
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b9444ebd-95ff-47a2-82e4-2f32512eef78
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Contains Null fields where no diagnosis exists
        name: EDS_TEXT_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a432d61-8f7a-4029-82bf-5565c3ede614
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: VARCHAR(MAX)
        defaultValue: ""
        description: ""
        name: STREAM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: daae5d51-303a-49f2-b66b-5fd9e6aa6aa9
                stepCounter: 817fbf5c-5799-4bcb-9b66-9ad5b75c55b8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22ffbbe1-3dac-4a9c-83a4-bb2ef806777c
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Yes if not part of the Diagnosis codes
        name: FREE_TEXT_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 52e67909-b5a0-4605-93a2-b1e2063144b2
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Attendance ref no.
        name: AEATT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f105f398-1042-471d-ba39-935c000ef834
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b393004-65ab-4dd8-b16e-1ff4fce46cf6
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: PIMS health organisation ref no
        name: HEORG_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 607e1d92-8895-4962-a382-8f9bf18d0d79
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 84b68756-ce19-4408-b83c-cf109a0720cf
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: PIMS service point ref no
        name: SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d738d0ff-4a44-4a6f-8113-fe1750dbf3df
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: IFNULL(ds_shared_ed_Attendance.spont_refno,s_ed_stay_first_last.first_stay_spont_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0374d2c-1a5d-4ce3-82e5-e9a7eab9e8e8
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Service_Point_Code
        name: SERVICE_POINT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd8b5dc7-5f8d-48f1-96e5-e9f85b2dc97c
                stepCounter: 331048bb-7ff9-400f-b8c4-4ac7cc91d7e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0367603a-90ef-436e-bcab-1457f2d0e5fe
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: health_org_code
        name: HEALTH_ORG_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a695067b-41a5-45f5-9479-aad869885f1e
                stepCounter: 331048bb-7ff9-400f-b8c4-4ac7cc91d7e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aac86195-78ca-4d4e-a55c-4038338fdeb9
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: HOSPITAL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c859f23e-870e-43b1-a6e4-7ff0f4ff7626
                stepCounter: 331048bb-7ff9-400f-b8c4-4ac7cc91d7e8
            transform: |-
              --case
              --when IFNULL(dim_service_point.hospital_id,s_health_org_2.hospital_id) = 1
              --then '1021' else IFNULL(dim_service_point.hospital_id,s_health_org_2.hospital_id) end
               CASE WHEN try_convert(int,IFNULL(dim_service_point.hospital_id,s_health_org_2.hospital_id)) = 1 THEN '1021'
                          ELSE try_convert(int,IFNULL(dim_service_point.hospital_id,s_health_org_2.hospital_id))
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b6f402a-2320-4b2e-ab43-ca85381b8e39
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Intended specialty ref no.
        name: INTENDED_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0193af51-0c9d-40d9-9fa5-472f8d2e60f8
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de699a05-f9cd-48ef-b885-1e7121e4559b
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Referral ref no.
        name: REFRL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 662697ec-c773-4224-a540-21a14bd62d2b
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c4fe2ee-9eed-47f3-8319-6cbf908226e7
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Referral date and time.
        name: REFERRAL_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50f8e45e-6bbe-4ab4-b10f-c2c21a2fabfb
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be3429ba-741b-47ca-85be-e22a5dd9830f
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Visit date and time.
        name: ARRIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50f8e45e-6bbe-4ab4-b10f-c2c21a2fabfb
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31c6b3db-9ed3-4f13-835d-2832b6e1d9e2
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Visit date arrival and time.
        name: ARRIVED_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50f8e45e-6bbe-4ab4-b10f-c2c21a2fabfb
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: convert(varchar(8),ds_shared_ed_Attendance.arrived_date,108)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 231bcd55-c072-4edd-a680-e7bf1562eeae
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Time patient discharged.
        name: DEPARTED_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7336d1a4-8c0b-4d69-aea3-ab2ed99d57ba
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: convert(varchar(8),ds_shared_ed_Attendance.departed_date,108)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 532e3de2-62b0-4123-86ed-622f72c76a64
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time patient discharged.
        name: DEPARTED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7336d1a4-8c0b-4d69-aea3-ab2ed99d57ba
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f360b93-5e1d-4e43-b466-654f0a29c803
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Medical discharge date.
        name: MEDICAL_DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e9e2a84-16db-47bb-a1bb-92e7d30ebd75
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6830f97-0798-4c36-bd09-b604021cb9df
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: discharge_destination_reference_no
        name: DISCHARGE_DESTINATION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 32018e16-9ee3-494b-b6ab-38dc3895bd62
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01770141-b7c7-41c0-8880-d7f4306562b9
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: Discharge destination.
        name: DISCHARGE_DESTINATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd1e2093-af53-430f-9415-7cdc97855d61
                stepCounter: a05a4266-44b7-4574-abee-00c3094cf764
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb1c990c-4c65-4d01-b53c-4bc941df4125
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: discharge_reason_reference_no
        name: DISCHARGE_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91000b7b-f068-46df-b7be-2c4a334d77ee
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5eaa3bc2-793a-4281-846d-1bcaa198768f
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: Reason for discharge code
        name: DISCHARGE_REASON_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6c760a8-963a-401f-be66-041a533500a7
                stepCounter: 9bacfc57-3a94-40a0-99e8-44500f0ad467
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b64fc73-31ed-4784-b989-60198e9f8140
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: YN flag indicating whether patient self-discharged.
        name: SELF_DISCHARGE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 566743e6-e728-494e-ae51-d3c1280ff6fa
                stepCounter: 9bacfc57-3a94-40a0-99e8-44500f0ad467
            transform: IFNULL(dim_discharge_reason.self_discharge_flag,'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db942281-9cb6-4830-a229-f16408cc8db2
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Flag indicating if patient currently not physically discharged and still in emergency care.
        name: ED_DISCHARGED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3d60c752-dcc2-482d-b5d3-e8c11f77a74f
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: |-
              CASE WHEN ds_pims_provider_spells.aeatt_refno IS NULL THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02ce5bb1-13e9-4886-810a-7e47b4268f11
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Attendance role ref no
        name: ATROL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 74b8928b-2372-449d-bf03-37948d30054f
                stepCounter: 8ae7d8f3-bbca-4c09-981b-c715dd1cc566
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6287d7f-ed5e-4fa0-9f65-fb34f398a6e6
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Triage Category Reference No
        name: TRCAT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d481450-8927-4017-9459-4bbfe7b9a322
                stepCounter: 8ae7d8f3-bbca-4c09-981b-c715dd1cc566
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9de8323-fbc1-46af-bbcf-a17b36f3498b
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Triage start date and time..
        name: TRIAGE_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f8b7379-6baf-4fbe-b210-8ffcd87e4bff
                stepCounter: 8ae7d8f3-bbca-4c09-981b-c715dd1cc566
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 326ac4c1-2380-41d5-acda-2da411f7274f
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Triage end date and time.
        name: TRIAGE_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 61a64da2-d998-471e-bb26-d184a9b34da8
                stepCounter: 8ae7d8f3-bbca-4c09-981b-c715dd1cc566
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88e46572-5664-4edd-94b4-92b34907369f
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Triage professional carer ref no.
        name: TRIAG_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 99a0bde1-b057-42c7-9169-298c7566c7e1
                stepCounter: 8ae7d8f3-bbca-4c09-981b-c715dd1cc566
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9bce110c-2624-40ed-b018-0733a3950f55
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: symptom_refno
        name: SYMPTOM_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc2e8627-e038-4322-947c-4808f6561c71
                stepCounter: 1eab9be9-1c78-4695-8dc4-8edb804831c7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5db3bea3-114d-40ff-b45d-bc01ba1ec38d
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: Symptom code.
        name: SYMPTOM_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f51eebbf-3c15-4f85-ac82-cf2ce16ebb41
                stepCounter: 1eab9be9-1c78-4695-8dc4-8edb804831c7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be1af943-96b1-402d-ab2e-ab386e0900a0
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: VARCHAR(2000)
        defaultValue: ""
        description: Patient symptom list
        name: SYMPTOM_LIST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 478520b4-7a5b-4f79-94dc-c856e79fe415
                stepCounter: 1eab9be9-1c78-4695-8dc4-8edb804831c7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5426443a-da5c-4825-9b5a-99e10f17f32d
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: VARCHAR(2000)
        defaultValue: ""
        description: Notes presented on patient's arrival.
        name: PRESENTATION_NOTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 66a72656-cf11-4f32-99c1-1c71817024cd
                stepCounter: e78a1b00-6f8e-4fc6-a022-090c640a38fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25c43f13-9324-4747-964c-94742de3d4c3
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: VARCHAR(2000)
        defaultValue: ""
        description: Notes presented on patient's discharge
        name: DISCHARGE_NOTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 332f3de6-1675-49b6-9290-79b4801359c9
                stepCounter: fda09028-5409-4a2f-8da0-03d506737519
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aeac6204-aba2-4ae2-9dea-aa331cbd5b47
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Principal diagnosis code.
        name: PRINCIPAL_DIAGNOSIS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3d6fcbe8-f39f-4552-bea8-1aca09f8791f
                stepCounter: 6a87fd59-a926-4750-aaaf-2adb2b04769f
            transform: IFNULL(s_ed_attendance_diagnosis.diag_code, 'NSP')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 52c4cc93-e3ad-4aae-be83-8efa3d85751b
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8426be4c-5ae2-4ce6-b1ee-79d1a66c4b2a
                stepCounter: 6a87fd59-a926-4750-aaaf-2adb2b04769f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4229b51a-b89e-41bc-a473-d1fa9fd357b4
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: ARMOD_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2beab26-6243-4755-a444-086415723d37
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2798dbb-db95-4b49-9b2f-d310b7b271c6
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Attendance category ref no
        name: ATCAT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 31987dac-3d20-4035-a638-3bd5fd234123
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad156f5f-3eac-4765-90ef-bc23d5029c96
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: attendance_category code.
        name: ATTENDANCE_CATEGORY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bda3664e-5811-4a6b-bba4-4b3feb819f26
                stepCounter: 9b9c79c3-de71-43ad-9a4a-a1bbef0d1a2a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 358d1ef9-88cd-49e7-8e11-da9edf7f1670
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Y/N flag indicating whether this is a planned return visit.
        name: PLANNED_RETURN_VISIT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 31987dac-3d20-4035-a638-3bd5fd234123
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: |-
              CASE WHEN dim_ed_attendance_category.attendance_category_code IN ('PLRET','FUPPL') THEN 'Y'
                          ELSE 'N'
                           END -- Planned Return/Follow-Up
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c29a8448-3c4d-4a50-8b6f-f64592ff2b93
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Ref no for the first stay of the encounter.
        name: FIRST_STAY_AESTY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b52d681a-a628-4b09-a906-161e1dbbebc8
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b6517be-0a2c-4309-ab2a-d4d35ac9269d
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FIRST_STAY_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d655d3e0-39b0-4b64-8918-e8481d30f6a0
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 022dfc41-6a8d-45e4-a13a-62b02c4eedd9
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Presenting (first stay) specialty Ref No
        name: FIRST_STAY_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a24882fb-316c-4cec-9179-57a4048d9fa5
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae32bf43-a6fd-4d8e-9020-5f983654b050
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FIRST_STAY_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddea4cb4-8549-4a2c-884c-fc2f9f0982eb
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ed86f81-8a5d-4ddc-9708-e8b964ed486c
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FIRST_STAY_HEALTH_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 06489741-4a7b-4c6e-846a-5d9e899d13a2
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb6d4236-0da9-4065-aa67-8a36a1361ca8
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FIRST_STAY_SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cc30736c-88ee-4e18-bed6-b331211ef4dc
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 832bae86-66e1-459c-939a-3e159c54a98d
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FIRST_STAY_SPONT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eee0e08c-00ab-4fd3-af37-0696688fb34b
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c71e0183-074b-47a9-b103-c8a6afe5d913
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: First Stay reference for a location within ADU
        name: FIRST_ADU_AESTY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2acf4059-98e9-4f8b-be71-9ad492524801
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc4dad61-9bed-4729-b7ec-97b05783f7fb
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: 'First date time within ADU '
        name: ADU_ADMIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3af9028f-4239-49dc-b151-52f30b27b2ac
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d88d79be-3532-4860-b1ed-e9a32ca36a28
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: YN flag indicating whether first stay is in ADU.
        name: FIRST_STAY_ADU_LOCATION_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef89d22e-d42f-4d47-b906-dd3650de8c8a
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: IFNULL(first_stay_ADU_location_flag,'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27a0ee84-4e65-458f-8752-bfbef39811ef
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: inappropriate_location_flag
        name: INAPPROPRIATE_LOCATION_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab30da64-9a1d-4d0e-8992-79f0f9566a75
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 84faf327-3ed2-4f49-8faf-526b1bcec8fb
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: observation_location_flag
        name: OBSERVATION_LOCATION_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 46538566-85a8-4cc9-8e7c-84bdc5a6ef98
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07720c99-6c20-4c62-9b78-ba232d3f4720
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Patient ref no.
        name: PATNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ccc5b70b-93b2-4083-8a6a-640bcf63f44e
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b15d240d-297e-45a4-837e-3073979c549f
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 985f0ba0-97cf-4152-a49b-7e86cb71409e
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8223d028-434c-49ac-b5b5-72b17afec9f9
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Patient_Date_Of_Birth
        name: PATIENT_DATE_OF_BIRTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f201416-ac35-4870-a0c1-0836d1b9e5b7
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6af532ab-4b60-45d5-bcc6-676fd9be1f2f
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: DOMICILE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 13e3f44a-7125-438f-b00f-42c54a307c05
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fba7020e-2fec-481d-b4bf-87082c29bc6e
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: patient_age_on_arrival_years
        name: PATIENT_AGE_ON_ARRIVAL_YEARS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: FLOOR(DATEDIFF(dd,dim_patient.patient_date_of_birth, CASE WHEN IFNULL(dim_patient.patient_date_of_death,ds_shared_ed_attendance.arrived_date) < ds_shared_ed_attendance.arrived_date THEN IFNULL(dim_patient.patient_date_of_death,ds_shared_ed_attendance.arrived_date) ELSE ds_shared_ed_attendance.arrived_date END) / 365.25)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe9fddf6-bbdf-4dcb-9a5b-e67d84b750b4
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: patient_age_on_arrival_months
        name: PATIENT_AGE_ON_ARRIVAL_MONTHS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: FLOOR(DATEDIFF(mm,dim_patient.patient_date_of_birth, CASE WHEN IFNULL(dim_patient.patient_date_of_death,ds_shared_ed_attendance.arrived_date) < ds_shared_ed_attendance.arrived_date THEN IFNULL(dim_patient.patient_date_of_death,ds_shared_ed_attendance.arrived_date) ELSE ds_shared_ed_attendance.arrived_date END) % 12)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e147cd3-c4ed-46f0-877a-7a06a9b5f4ca
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: patient_visit_num
        name: PATIENT_VISIT_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0255dfca-b984-4e53-ad30-792566f2bd51
                stepCounter: 80fc3e6b-f7c1-4b90-8177-1abc26dbb2b0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab2ae2b9-2b2f-41c5-8c15-a72c3501d182
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: patient_visit_count
        name: PATIENT_VISIT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2572c055-2b9e-4108-b069-e840f7e1b4f7
                stepCounter: 80fc3e6b-f7c1-4b90-8177-1abc26dbb2b0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 30541089-b2d7-45cf-98de-6c13b765ae39
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Ref no of the encounter stay with the ealiest start date.
        name: EARLIEST_START_AESTY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ade8f8fd-eac2-4a68-bb61-96d4074ad137
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20f61975-7860-4eb3-9777-5d8b8dd6a0a5
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EARLIEST_START_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: abf97c90-75a1-4c8c-8d0b-421531babc70
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b55a171b-877c-43fa-bd11-7d39a57128de
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: triage_priority
        name: TRIAGE_PRIORITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07bc2750-2317-4a91-a4b7-7c1c3c426eee
                stepCounter: e54396c4-42ab-493b-8c49-31e8636f0c5f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0218601e-6280-4a59-aa33-02805bc4c764
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Triage professional carer code.
        name: TRIAGE_HEALTHCARE_PROFESSIONAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e393c87d-2bfd-47b3-a557-82745248467a
                stepCounter: 2b7fcd6a-6a5f-4454-9d5e-f87e946f60fa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ece050ea-4f31-4807-ac22-324732c417a3
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EARLIEST_START_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6b6ccff-3084-40f9-b0ed-debad6edc802
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7dc1fe66-9b20-4978-be55-5bbc4c5aae68
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EARLIEST_START_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6489ed44-9cdb-49d2-b1a1-023a8b64908f
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0286843e-8376-42ef-a0d8-64e27ce41e1b
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EARLIEST_START_HEALTH_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a62ce8a2-9e8c-4634-8660-65c066223ff3
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9bfc4b07-6b9e-478f-bd00-8146e7b993af
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EARLIEST_START_SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 37793134-6ba2-48e3-bd2a-9bf94bde1270
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2af10e89-028c-4bbe-8ce5-f555c62d0ab4
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EARLIEST_START_SPONT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 884095da-a1e6-48ef-abc8-56bc71fc7c10
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18a79220-0699-422d-ad95-c2d2513aa602
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OBSERVATION_AESTY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78845edd-612d-4802-9067-0d6dc08f8eb4
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 93692e6c-8c9f-4ff4-9a81-e3a3b902eecc
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: OBS_admit_date
        name: OBS_ADMIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d34a0e9a-1629-4c12-bc0a-c88cae85be78
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 301d0034-b8d6-4cdc-b18e-71777d6ef281
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time when patient first seen by a clinician.
        name: FIRST_SEEN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b702bc30-0b52-459e-b13d-8537b2fee830
                stepCounter: 5b9011ca-ce7b-479e-a396-a373777b78d7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e120af1-ff04-4672-8796-b7a6bf732ae6
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FIRST_SEEN_AESTY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e24a7617-883d-4224-99ee-b1590a9cd565
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c58d6d9c-176e-4781-9ba2-ddd28bb875a7
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: first_seen_proca_refno
        name: FIRST_SEEN_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 620f2ce6-6e14-4ebd-afe5-3b24fb160e93
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a504a97b-6678-49ec-aa86-489a0b1ac203
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FIRST_SEEN_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79b72b87-f3c6-4d49-a0a0-73284730b5bc
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59807125-f9f1-42c8-8f32-db3a22f28db9
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FIRST_SEEN_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0d3ee8f2-9bba-4958-aaa3-2ac8aa6d4af4
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da6d1d2d-75cc-412d-b638-b6cb22814678
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FIRST_SEEN_HEALTH_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 04b80e37-2335-46e6-9cd2-6f3526d186a1
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d63c4af-7050-440b-9a3c-5f76169eff14
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FIRST_SEEN_SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 374b32bf-f194-4cdd-9289-e46cf74fff45
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bdfe212b-1fb0-4425-816b-7ef13ae87789
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FIRST_SEEN_SPONT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bb432dad-d092-4449-bf20-f415646ba25a
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4067a1c4-1b5f-41e0-9d54-cb3d5a2755a8
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time when patient last seen by a clinician.
        name: LAST_SEEN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 377cc22e-b4b1-4603-83c7-583ab2f8b8a9
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32d9ede0-1753-43cf-a2c5-bc043ffb34c2
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LAST_SEEN_AESTY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: abe18a6a-1fac-4f16-ac23-444a72f8fcb8
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ad9e279-944a-4941-aa23-0ec265afa407
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Last seen (Discharge) Clinician Ref No.
        name: LAST_SEEN_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f6e92e2-d08c-4402-bed1-28e3589f7092
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d02c3a76-9ea3-442d-95ee-b5fd32987100
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: last seen (Discharge) specialty Ref No
        name: LAST_SEEN_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c205e28e-6fe1-4254-a3aa-4d64ab87024f
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8b6aaec-b5dd-4fa3-9d98-3712c7815a56
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LAST_SEEN_HEALTH_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48ef868b-40eb-458c-9f17-123ccb7b1664
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 756f11fe-af71-4a77-86b6-0ba7ab1fb8e4
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LAST_SEEN_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 999eadfc-f158-4d1f-a4f1-30bd08b995e8
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c7473ca1-ea5e-4f0c-af88-3529dd16a6d0
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LAST_SEEN_SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d047c696-c8e4-4e4a-9f5f-3fdfc0c21ede
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54832034-209e-42e8-896d-2ac567cb2278
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LAST_SEEN_SPONT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83db24b2-f176-40a1-bb50-35b4a922c7f8
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77763eed-1335-456b-98df-7cf3f861df02
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LAST_STAY_AESTY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16c341d5-8ed3-41ab-93a1-643892934c0c
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 36605894-3fd8-4a1a-b9d7-7b0abe0e8310
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LAST_STAY_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1594de1f-09d1-4a4e-9d25-a350ff41b680
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71cac84f-11d1-45b3-8260-6c7eb200360a
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LAST_STAY_CLINICIAN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 53987a42-ac0d-483d-9dc3-d58c8ee8b8d4
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c14c88ba-eb46-4fc8-b45e-068aa783d0c0
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LAST_STAY_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 31b5bd41-10f3-4c22-86ee-ff93c8bdb46a
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: |-
              CASE WHEN ds_shared_ed_attendance.departed_date IS NOT NULL AND s_ed_stay_first_last.last_stay_spect_refno IS NULL THEN 1000000009
                          ELSE s_ed_stay_first_last.last_stay_spect_refno
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c996a126-f5ab-472e-b8d9-26aa721ba972
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LAST_STAY_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb3da572-47b5-4809-876d-388468c550f0
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82d69b96-29b2-4867-bb17-1a49e1805413
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LAST_STAY_HEALTH_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0e5f39e7-6bff-41d3-9ecb-251b45bfe6c0
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea1d52fd-418d-4b91-88a2-e9fe28d6cecb
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LAST_STAY_SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ff027d88-cb5b-41c5-b4c1-8ebdb80d0891
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e272ef3e-1d5c-400e-8d81-df8b3e2de855
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LAST_STAY_SPONT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27a44ade-5a56-43b5-9b37-a10f13399ef3
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 747e74c4-6db0-473a-ad48-84a56301c764
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Ref no for the first stay after/outside ED for the encounter.
        name: FIRST_NON_ED_AESTY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6b329085-9765-4289-b2ee-252acf48edae
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 85b3a426-54a9-4f7b-b7a5-e9ba773c415d
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: First seen_date after/outside ED for the encounter
        name: FIRST_NON_ED_SEEN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e8a80bd-12e7-4073-8914-4e3657b7d9c4
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5897d212-be78-4d39-9564-6d8de0ad06de
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Stop-Clock Datetime for LOS measurement used in ED 6-hour target compliance
        name: STOP_CLOCK_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE WHEN s_ed_stay_first_last.stop_clock_stay_start_date IS NOT NULL AND ADU_admit_date < s_ed_stay_first_last.stop_clock_stay_start_date                                                    THEN ADU_admit_date
                          WHEN s_ed_stay_first_last.stop_clock_stay_start_date IS NOT NULL                                                                                                                         THEN s_ed_stay_first_last.stop_clock_stay_start_date
                          WHEN ds_shared_ed_attendance.medical_discharge_date IS NOT NULL AND ds_shared_ed_attendance.create_dttm < '01-July-2020 00:00:01' AND s_ed_stay_first_last.last_seen_specialty = 'EMMED' THEN ds_shared_ed_attendance.medical_discharge_date
                          ELSE ds_shared_ed_attendance.departed_date
                           END --CASE
              --  WHEN s_ed_stay_first_last.stop_clock_stay_start_date IS NOT NULL
              --  THEN s_ed_stay_first_last.stop_clock_stay_start_date
              --  WHEN s_ed_attendance_05.med_disch_dttm  IS NOT NULL
              -- and s_ed_attendance_05.create_dttm < '01-July-2020 00:00:01'
               --  AND s_ed_stay_first_last.last_seen_specialty = 'EMMED'
              --  THEN s_ed_attendance_05.med_disch_dttm
              --  ELSE s_ed_attendance_05.departed_dttm
              -- END
               --CASE
               -- WHEN s_ed_stay_first_last.stop_clock_stay_start_date IS NOT NULL
               -- THEN s_ed_stay_first_last.stop_clock_stay_start_date
               --  WHEN s_ed_attendance_05.med_disch_dttm IS NOT NULL
               --  AND s_ed_stay_first_last.last_seen_specialty = 'EMMED'
               -- THEN s_ed_attendance_05.med_disch_dttm
               --  ELSE s_ed_attendance_05.departed_dttm
               -- END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a102f695-f0ae-427c-ba0e-cc31c6243395
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: stop_clock_location_flag
        name: STOP_CLOCK_LOCATION_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: baa28ea3-63a2-4f76-bfeb-436bab4e2952
                stepCounter: 706071c8-638d-47f9-aa95-37851328e017
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db4b1f63-3d28-490f-8d95-e9a147e22fe8
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: EMMED end date and time.
        name: EMMED_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bd8a450f-849d-4bb4-b318-1719fa1afa56
                stepCounter: 5b9011ca-ce7b-479e-a396-a373777b78d7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a1a4121-e5a4-4d2e-83be-2e03fabfdd72
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: EM final clinician seen, clinician at EM referral time
        name: EM_REFERRAL_CLINICIAN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7a88923-4003-45ca-ab0a-198b6bd80a28
                stepCounter: 4426446d-7e6c-4735-8e0a-2b97040e9b11
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4005009c-ff93-4730-9f0c-7422b63f7448
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NON_EMMED_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e24bbf9-df88-462a-adf2-bf2299ffbe1b
                stepCounter: 5b9011ca-ce7b-479e-a396-a373777b78d7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3b5eced-120c-41cf-8548-9d9844370092
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: First seen date by a clinician outside of EMMED.
        name: IP_RESPONSE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e24bbf9-df88-462a-adf2-bf2299ffbe1b
                stepCounter: 5b9011ca-ce7b-479e-a396-a373777b78d7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c7bfaf0f-da09-4e21-95bf-3c14f87dafb8
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: IP end date and time
        name: IP_SEEN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e24bbf9-df88-462a-adf2-bf2299ffbe1b
                stepCounter: 5b9011ca-ce7b-479e-a396-a373777b78d7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b14998c5-6206-4905-a6ce-ca0fdaba74ee
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: TREATMENT_PROTOCOL_INITIATION_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d1b4633b-f21d-47be-9fcf-2e159a3d718e
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: treatmentprotocolid
        name: TREATMENTPROTOCOLID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d4c37217-1f82-4af3-a051-3722935d9311
                stepCounter: e0bb5602-6936-4c6a-b32b-8c9a413726d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b9e31597-56e4-4769-8710-58dd2ce5a61c
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 550d8577-9040-4bdb-b6fd-5386704a08b0
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b9224d00-d246-46c1-9229-c8a4d6cdf6eb
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2040732b-30a6-4967-9684-d0565f6f4b79
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c799ab65-076a-40df-9edc-e5766f5b1ebf
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_whiteboard_action.WB_action_seenby_doctor=dim_ED_WB_action_seenby_clinician.WB_action_seenby_clinician_user_code
        name: DIM_FIRST_SEENBY_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eb58e73a-e183-4478-9478-c5730ede154f
                stepCounter: 5b9011ca-ce7b-479e-a396-a373777b78d7
            transform: IFNULL(s_ed_wb_action_seen_encounter_v.dim_first_seenby_clinician_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d14a54b-33f3-4804-a0c3-4f2fcf15966c
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: datetime at which the action was performed
        name: FIRST_SEENBY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 31e448b6-e468-4c84-90b5-7501f1eba901
                stepCounter: 5b9011ca-ce7b-479e-a396-a373777b78d7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 30e08132-6d6f-44ae-8f3b-260d77f8e09f
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_whiteboard_action.WB_action_seenby_doctor=dim_ED_WB_action_seenby_clinician.WB_action_seenby_clinician_user_code
        name: DIM_SECOND_SEENBY_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b939c844-3f0b-48df-bd77-b0718256272d
                stepCounter: 5b9011ca-ce7b-479e-a396-a373777b78d7
            transform: IFNULL(s_ed_wb_action_seen_encounter_v.dim_second_seenby_clinician_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 468419b2-4065-48ab-a3eb-c69f7143dfce
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: datetime at which the action was performed
        name: SECOND_SEENBY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a0d5e8a-9e37-4229-a3f9-d7d29aa5f48f
                stepCounter: 5b9011ca-ce7b-479e-a396-a373777b78d7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 551c2197-5faf-4c23-80c7-07f38874695c
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_whiteboard_action.WB_action_seenby_doctor=dim_ED_WB_action_seenby_clinician.WB_action_seenby_clinician_user_code
        name: DIM_THIRD_SEENBY_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d6e9bdec-e80d-4605-8071-5be2a370b437
                stepCounter: 5b9011ca-ce7b-479e-a396-a373777b78d7
            transform: IFNULL(s_ed_wb_action_seen_encounter_v.dim_third_seenby_clinician_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 667f90e1-0fbc-45c0-b309-1849d5e8cd4c
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: datetime at which the action was performed
        name: THIRD_SEENBY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4dfb4349-29e2-4f9b-b8bf-f921bbe0c315
                stepCounter: 5b9011ca-ce7b-479e-a396-a373777b78d7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dd5df15e-3232-450d-81c7-57555f199e8d
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_whiteboard_action.WB_action_seenby_doctor=dim_ED_WB_action_seenby_clinician.WB_action_seenby_clinician_user_code
        name: DIM_FORTH_SEENBY_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c432140-e875-47de-aa8a-125221ddface
                stepCounter: 5b9011ca-ce7b-479e-a396-a373777b78d7
            transform: IFNULL(s_ed_wb_action_seen_encounter_v.dim_fourth_seenby_clinician_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 573e3218-a1aa-48a8-a516-d8bdf16485f2
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: datetime at which the action was performed
        name: FORTH_SEENBY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: acb37c48-c217-414e-89de-4d2538e75b8b
                stepCounter: 5b9011ca-ce7b-479e-a396-a373777b78d7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d887e602-8fc9-4cd5-8688-5b2eaa725938
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_whiteboard_action.WB_action_seenby_doctor=dim_ED_WB_action_seenby_clinician.WB_action_seenby_clinician_user_code
        name: DIM_FIFTH_SEENBY_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3f5317fa-69bb-4ed8-a26c-dd79a639b8e0
                stepCounter: 5b9011ca-ce7b-479e-a396-a373777b78d7
            transform: IFNULL(s_ed_wb_action_seen_encounter_v.dim_fifth_seenby_clinician_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cbf7f290-740b-4d81-91e7-41b60501205e
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: datetime at which the action was performed
        name: FIFTH_SEENBY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d799f667-65f8-4373-9065-476ba5b39c26
                stepCounter: 5b9011ca-ce7b-479e-a396-a373777b78d7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e7bfaca-a457-40a6-9fcc-a5555b1e7105
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: datetime at which the first specialty transfer was performed
        name: SPECIALTY_TRANSFER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 74ed4132-fc14-484c-98c9-096beb48f6f8
                stepCounter: 5b9011ca-ce7b-479e-a396-a373777b78d7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b5d9e69-3f6c-4ad6-83ca-c0f0aa4fc316
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: NURSE_SEEN_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c2ef785c-5d49-4249-80f2-fd340593073b
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c435953f-0e4d-4d32-a811-9afccee9aef1
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NURSE_SEEN_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a89ce6d-3364-4983-8aee-4f640fe6733c
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c73594a3-f78a-4d17-9fa6-5ec74d15f2d5
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: NATIONAL_EHEALTH_RECORD_EXCLUSION_FLAG_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19db2258-194b-49e3-b2a6-c5c14d37a95c
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78172ee6-dd5f-4074-9ef3-433bfec15048
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: ALCOHOL_ANSWER_MAIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fbb01e3b-4612-47c8-9a4a-5d6abddc60ef
                stepCounter: 06fa4241-360c-43d0-8e4a-8b860f92fc09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16e3cd40-c86c-481c-8c45-453579ec5db4
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MODIFY_USER_LOGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 899d6141-3a92-4863-9440-2bbfdacea541
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 160c5096-99a7-46c6-8283-abc76e412a33
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIF_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0af3e531-c057-445b-9e6a-87a64f3b4547
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5830abed-7da5-4d36-92cd-692998333f6f
          stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_SHARED_ED_ATTENDANCE
        join:
          joinCondition: |-
            EXTENDED
              FROM s_ed_changes
              JOIN ds_shared_ed_attendance
                ON s_ed_changes.aeatt_refno = ds_shared_ed_attendance.aeatt_refno --join s_ed_attendance_patient_count_v  --on s_ed_attendance_patient_count_v.aeatt_refno = ds_shared_ed_attendance.aeatt_refno    LEFT OUTER JOIN s_ed_attendance_role_v    ON ds_shared_ed_attendance.aeatt_refno = s_ed_attendance_role_v.aeatt_refno  left outer join s_ed_attendance_stream_v  on s_ed_attendance_stream_v.encounter = ds_shared_ed_attendance.encounter  and priority_sequence=1      LEFT OUTER JOIN dim.dim_healthcare_professional    ON s_ed_attendance_role_v.triag_proca_refno = dim.dim_healthcare_professional.healthcare_professional_reference_no    AND ds_shared_ed_attendance.arrived_date BETWEEN dim.dim_healthcare_professional.dss_start_date AND dim.dim_healthcare_professional.dss_end_date      LEFT OUTER JOIN dim.dim_ed_triage_category    ON s_ed_attendance_role_v.trcat_refno = dim.dim_ed_triage_category.triage_category_reference_no    AND ds_shared_ed_attendance.arrived_date BETWEEN dim.dim_ed_triage_category.dss_start_date AND dim.dim_ed_triage_category.dss_end_date         inner JOIN dim.dim_patient    ON  ds_shared_ed_attendance.patnt_refno = dim.dim_patient.patient_reference_no         LEFT OUTER JOIN dim.dim_discharge_destination    ON ds_shared_ed_attendance.discharge_destination_reference_no = dim.dim_discharge_destination.discharge_destination_reference_no    AND ds_shared_ed_attendance.arrived_date BETWEEN dim.dim_discharge_destination.dss_start_date AND dim.dim_discharge_destination.dss_end_date         LEFT OUTER JOIN dim.dim_ed_attendance_category    ON ds_shared_ed_attendance.atcat_refno = dim.dim_ed_attendance_category.attendance_category_reference_no    AND ds_shared_ed_attendance.arrived_date BETWEEN dim.dim_ed_attendance_category.dss_start_date AND dim.dim_ed_attendance_category.dss_end_date         LEFT OUTER JOIN dim.dim_discharge_reason    ON ds_shared_ed_attendance.discharge_reason_reference_no = dim.dim_discharge_reason.discharge_reason_reference_no    AND ds_shared_ed_attendance.arrived_date BETWEEN dim.dim_discharge_reason.dss_start_date AND dim.dim_discharge_reason.dss_end_date         LEFT OUTER JOIN s_ed_stay_first_last  s_ed_stay_first_last -- s_ed_stay_10    ON  s_ed_stay_first_last.aeatt_refno = ds_shared_ed_attendance.aeatt_refno           LEFT OUTER JOIN s_ed_stay_first_non_emmed_v  -- s_ed_stay_30    ON  s_ed_stay_first_last.aeatt_refno = s_ed_stay_first_non_emmed_v.aeatt_refno         LEFT OUTER JOIN ds_ed_note  -- l_pims_notes    ON  ds_ed_note.sorce_refno = s_ed_attendance_role_v.atrol_refno    AND ds_ed_note.row_num = 1    LEFT OUTER JOIN  s_ed_discharge_note    ON  s_ed_discharge_note.sorce_refno = s_ed_attendance_role_v.aeatt_refno    AND s_ed_discharge_note.row_num = 1         LEFT OUTER JOIN s_ed_attendance_symptom  -- l_pims_ae_attendance_roles / l_pims_diagnosis_procedures     ON ds_shared_ed_attendance.aeatt_refno = s_ed_attendance_symptom.aeatt_refno         LEFT OUTER JOIN s_ed_attendance_diagnosis  -- l_pims_diagnosis_procedure / l_pims_odpcd_codes    ON  s_ed_attendance_diagnosis.aeatt_refno = ds_shared_ed_attendance.aeatt_refno    AND s_ed_attendance_diagnosis.row_num = 1         LEFT OUTER JOIN    (SELECT DISTINCT aeatt_refno FROM ds_pims_provider_spells        WHERE disch_dttm IS NULL OR spont_refno IN (1000000039, 1000005245)) ds_pims_provider_spells -- Service_Point_Code in ('ECC', 'ECCW')      ON ds_pims_provider_spells.aeatt_refno = ds_shared_ed_attendance.aeatt_refno           LEFT OUTER JOIN dim.dim_service_point    ON IFNULL(ds_shared_ed_attendance.spont_refno,s_ed_stay_first_last.first_stay_spont_refno) = dim.dim_service_point.service_point_reference_no    AND ds_shared_ed_attendance.arrived_date BETWEEN dim_service_point.dss_start_date AND dim.dim_service_point.dss_end_date  left outer join  (SELECT encounter, min(actiondttm) TreatmentProtocolInitiationTime, treatmentprotocolid,   ROW_NUMBER() OVER (PARTITION BY encounter ORD
        name: S_ED_ATTENDANCE_10
        noLinkRefs: []
  name: S_ED_ATTENDANCE_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
