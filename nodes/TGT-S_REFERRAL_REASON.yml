fileVersion: 1
id: 4a510baa-6f36-4f2c-b0c5-5b96faa2ef84
name: S_REFERRAL_REASON
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e4b9cb65-2ffb-453d-a813-8b686959792c
          stepCounter: 4a510baa-6f36-4f2c-b0c5-5b96faa2ef84
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: referral_reason_reference_no
        name: REFERRAL_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 97aebd53-8994-45f0-9fea-1b3150a90054
                stepCounter: 06fa4241-360c-43d0-8e4a-8b860f92fc09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d02c0aff-a074-4409-aa01-02a1a00a941f
          stepCounter: 4a510baa-6f36-4f2c-b0c5-5b96faa2ef84
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: referral_reason_code
        name: REFERRAL_REASON_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fbb01e3b-4612-47c8-9a4a-5d6abddc60ef
                stepCounter: 06fa4241-360c-43d0-8e4a-8b860f92fc09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 994b0d07-8028-49f1-b49e-acb8b0020fb6
          stepCounter: 4a510baa-6f36-4f2c-b0c5-5b96faa2ef84
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: referral_reason_desc
        name: REFERRAL_REASON_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 551f483d-a948-4558-87f8-d3e65fffac3c
                stepCounter: 06fa4241-360c-43d0-8e4a-8b860f92fc09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c9b9fc4-4bc3-46a5-b2cb-e9d933c8b602
          stepCounter: 4a510baa-6f36-4f2c-b0c5-5b96faa2ef84
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: referral_reason_validity_start_date
        name: REFERRAL_REASON_VALIDITY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d93e8a96-b2c6-4ecb-bd0a-f2f089d15d02
                stepCounter: 06fa4241-360c-43d0-8e4a-8b860f92fc09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9de6d8f2-31c0-4bbf-ac63-be028c1979ea
          stepCounter: 4a510baa-6f36-4f2c-b0c5-5b96faa2ef84
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: referral_reason_validity_end_date
        name: REFERRAL_REASON_VALIDITY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b83a3aaf-eb08-4e0f-b5c8-1be21d38ef47
                stepCounter: 06fa4241-360c-43d0-8e4a-8b860f92fc09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 396c0051-6bc1-4f9f-b001-5660727a5da1
          stepCounter: 4a510baa-6f36-4f2c-b0c5-5b96faa2ef84
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: referral_reason_reference_code
        name: REFERRAL_REASON_REFERENCE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc52b689-cd00-4eb4-ae6e-f2b338d8975a
                stepCounter: 06fa4241-360c-43d0-8e4a-8b860f92fc09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b5490fb4-e4f9-40fd-b3e7-403116b17a49
          stepCounter: 4a510baa-6f36-4f2c-b0c5-5b96faa2ef84
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: This is the service type for a referral reason, where it cannot be defaulted to FSA  This is overridden by the wailtist if generated or the referral diagnosis where it denotes service.
        name: NPF_SERVICE_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ad619822-9322-4056-9a1d-ce0d03a313e0
                stepCounter: 410d8e56-9f7e-4108-8289-feac32247ef2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26718d19-13dd-445b-a5d8-fdbcd6f84d37
          stepCounter: 4a510baa-6f36-4f2c-b0c5-5b96faa2ef84
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: NPF_SERVICE_TYPE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c68f0157-b568-4a06-b64c-bb51ca342424
          stepCounter: 4a510baa-6f36-4f2c-b0c5-5b96faa2ef84
        config: {}
        dataType: CHAR(4)
        defaultValue: ""
        description: This is the service sub type for a referral reason, where it cannot be defaulted to FSA  This is overridden by the wailtist if generated or the referral diagnosis where it denotes service.
        name: NPF_SERVICE_SUB_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c910b510-ddc6-47ba-b9e0-504079d3abe4
                stepCounter: 410d8e56-9f7e-4108-8289-feac32247ef2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7652209-b875-4270-b9ac-da3cce854d5f
          stepCounter: 4a510baa-6f36-4f2c-b0c5-5b96faa2ef84
        config: {}
        dataType: NVARCHAR(255)
        defaultValue: ""
        description: ""
        name: NPF_SERVICE_SUB_TYPE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ae4ecd8-e335-4d7e-a1e2-92601b10c326
          stepCounter: 4a510baa-6f36-4f2c-b0c5-5b96faa2ef84
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: This is the encounter type for a referral reason, where it cannot be defaulted to FSA  This is overridden by the wailtist if generated or the referral diagnosis where it denotes service.
        name: NPF_ENCOUNTER_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9ec327c3-d053-4455-b3e5-93843a84a01c
                stepCounter: 410d8e56-9f7e-4108-8289-feac32247ef2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03dc7dcc-d00d-4c44-b8f0-06972c12a1f5
          stepCounter: 4a510baa-6f36-4f2c-b0c5-5b96faa2ef84
        config: {}
        dataType: NVARCHAR(255)
        defaultValue: ""
        description: ""
        name: NPF_ENCOUNTER_TYPE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2112371-2d7d-4331-a6dc-bcc0ce679292
          stepCounter: 4a510baa-6f36-4f2c-b0c5-5b96faa2ef84
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          L_MAPPINGS_REFERRAL_REASON: 410d8e56-9f7e-4108-8289-feac32247ef2
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_PIMS_REFERENCE_VALUES
          - locationName: TGT
            nodeName: L_MAPPINGS_REFERRAL_REASON
        join:
          joinCondition: |-
            FROM ds_pims_reference_values
              LEFT OUTER JOIN {{ ref('TGT','L_MAPPINGS_REFERRAL_REASON') }}
                ON ds_pims_reference_values.rfval_refno = l_mappings_referral_reason.RFVAL_REFNO
              LEFT OUTER JOIN l_reference_MOH_NPF_Codesets l_reference_MOH_NPF_Codesets_STYP
                ON l_reference_MOH_NPF_Codesets_STYP.code = npf_service_type
               AND l_reference_MOH_NPF_Codesets_STYP.codeset = 'SRV'
              LEFT OUTER JOIN l_reference_MOH_NPF_Codesets l_reference_MOH_NPF_Codesets_SSTY
                ON l_reference_MOH_NPF_Codesets_SSTY.code = npf_service_sub_type
               AND l_reference_MOH_NPF_Codesets_SSTY.codeset = 'SRVSUB'
              LEFT OUTER JOIN l_reference_MOH_NPF_Codesets l_reference_MOH_NPF_Codesets_ETYP
                ON l_reference_MOH_NPF_Codesets_ETYP.code = npf_encounter_type
               AND l_reference_MOH_NPF_Codesets_ETYP.codeset = 'ENCTYP'
             WHERE rfvdm_code = 'REASN'
        name: S_REFERRAL_REASON
        noLinkRefs: []
  name: S_REFERRAL_REASON
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
