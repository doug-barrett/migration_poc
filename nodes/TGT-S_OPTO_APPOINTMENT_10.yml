fileVersion: 1
id: 5e6c56b0-d2ee-40e0-bcfa-156b2864939d
name: S_OPTO_APPOINTMENT_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c6f9ce9-f855-467e-87d0-fce223e3494b
          stepCounter: 5e6c56b0-d2ee-40e0-bcfa-156b2864939d
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: APPOINTMENT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 81da71d2-34a1-473c-92e9-b24a9f065d9e
                stepCounter: 925ea0f6-51e5-4e28-93e6-0dc4ec67a76f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0be63644-6307-45ec-b6ec-74355c14c6db
          stepCounter: 5e6c56b0-d2ee-40e0-bcfa-156b2864939d
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CLINIC_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: badabf29-d790-4bdf-aeec-4aaedd8b85dd
                stepCounter: 925ea0f6-51e5-4e28-93e6-0dc4ec67a76f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f90ac68-2cb1-41db-b8de-05f71946ad1d
          stepCounter: 5e6c56b0-d2ee-40e0-bcfa-156b2864939d
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CLINICAL_LOCATION_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 917f3ef1-15b6-4392-8a5c-f542b1301ea9
                stepCounter: d139446d-0543-44a5-aab6-a6bfec82032b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b3486a5-4c02-4a70-b2d2-0a1b0bcb5272
          stepCounter: 5e6c56b0-d2ee-40e0-bcfa-156b2864939d
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: CLINICAL_LOCATION_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e136c1fd-8651-44dd-9e98-ccbfc145926f
                stepCounter: d139446d-0543-44a5-aab6-a6bfec82032b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e17e64cb-64dc-4228-9fe7-cda40843b140
          stepCounter: 5e6c56b0-d2ee-40e0-bcfa-156b2864939d
        config: {}
        dataType: NVARCHAR(25)
        defaultValue: ""
        description: ""
        name: CLINICAL_LOCATION_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c081769e-51a1-4456-a79d-a0ac7f491243
                stepCounter: d139446d-0543-44a5-aab6-a6bfec82032b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8bf50088-f419-4734-8e15-787beb1838f3
          stepCounter: 5e6c56b0-d2ee-40e0-bcfa-156b2864939d
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CLINIC_PLAN_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa4567aa-7fde-4f17-87f6-af798dd78322
                stepCounter: 19c0d3b4-93c3-4010-9c3f-73cf7dfa1e52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9868688-d326-4868-b58c-42be3cd09915
          stepCounter: 5e6c56b0-d2ee-40e0-bcfa-156b2864939d
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: CLINIC_PLAN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0446789c-1d84-4e37-85b1-0a9d5223a317
                stepCounter: a3c03cbf-0bbc-4d93-9ddb-a56fa512d9c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b5bd8f41-bf73-4cd3-82d8-268b0e643034
          stepCounter: 5e6c56b0-d2ee-40e0-bcfa-156b2864939d
        config: {}
        dataType: NVARCHAR(25)
        defaultValue: ""
        description: ""
        name: CLINIC_PLAN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bb18c4f5-3cf0-456a-847f-9a4211dc84c4
                stepCounter: a3c03cbf-0bbc-4d93-9ddb-a56fa512d9c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 36a70e4b-22cb-480f-8adb-016f61452348
          stepCounter: 5e6c56b0-d2ee-40e0-bcfa-156b2864939d
        config: {}
        dataType: NVARCHAR(250)
        defaultValue: ""
        description: ""
        name: CLINIC_PLAN_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2dd5d2d8-6820-4fb9-ba1d-ac4493ef615b
                stepCounter: a3c03cbf-0bbc-4d93-9ddb-a56fa512d9c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7377a63a-3673-4523-8828-aea0deba8585
          stepCounter: 5e6c56b0-d2ee-40e0-bcfa-156b2864939d
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9b27d649-23e1-47ae-a9e3-d3aec8fd654b
                stepCounter: 547430dd-0168-46d8-b63f-70fc2a77c3eb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24a16f89-4144-438b-92c8-5b1674078b7f
          stepCounter: 5e6c56b0-d2ee-40e0-bcfa-156b2864939d
        config: {}
        dataType: VARCHAR(14)
        defaultValue: ""
        description: ""
        name: SOURCE_ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9b27d649-23e1-47ae-a9e3-d3aec8fd654b
                stepCounter: 547430dd-0168-46d8-b63f-70fc2a77c3eb
            transform: "'OPTO-' + cast(l_opto_appointment_encounter.encounterid AS varchar)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4e59c5b-d99c-450f-9d0d-01cbede1d5be
          stepCounter: 5e6c56b0-d2ee-40e0-bcfa-156b2864939d
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PATIENT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ba765e9-f089-490b-bb32-96e8201720f1
                stepCounter: 925ea0f6-51e5-4e28-93e6-0dc4ec67a76f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33cc60c4-b170-4b60-8815-e2007f867891
          stepCounter: 5e6c56b0-d2ee-40e0-bcfa-156b2864939d
        config: {}
        dataType: NVARCHAR(40)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 25e0890d-32a4-417b-8c18-e6798a0089ee
                stepCounter: 687e8b78-238c-4482-942c-cfcefb43673b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e707d6f6-0f27-46f3-9b2f-f88cf4b26e72
          stepCounter: 5e6c56b0-d2ee-40e0-bcfa-156b2864939d
        config: {}
        dataType: BIT
        defaultValue: ""
        description: ""
        name: DROP_IN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d5baa5c-eb34-4fb0-bee6-3d469724a8bf
                stepCounter: 925ea0f6-51e5-4e28-93e6-0dc4ec67a76f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 13629536-6710-4ce2-bfd9-582c3cd5cb57
          stepCounter: 5e6c56b0-d2ee-40e0-bcfa-156b2864939d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eff45ba0-653d-4d1a-8bba-5539865e53ce
                stepCounter: 925ea0f6-51e5-4e28-93e6-0dc4ec67a76f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f852896-7e6d-4e14-b5bf-ba885478d190
          stepCounter: 5e6c56b0-d2ee-40e0-bcfa-156b2864939d
        config: {}
        dataType: NVARCHAR(100)
        defaultValue: ""
        description: ""
        name: DOMICILE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e160f223-8510-485d-a3f5-e62f76b75e19
                stepCounter: 329ad9eb-3b55-484f-a208-a4b5c5655f4a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4cc7cf61-3e51-43fc-8f9e-29fb4acf003d
          stepCounter: 5e6c56b0-d2ee-40e0-bcfa-156b2864939d
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f25fab31-3296-4039-b906-344c5fcb038d
                stepCounter: 925ea0f6-51e5-4e28-93e6-0dc4ec67a76f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf1d9ca0-6a95-47ba-a8eb-063526c859cf
          stepCounter: 5e6c56b0-d2ee-40e0-bcfa-156b2864939d
        config: {}
        dataType: NVARCHAR(MAX)
        defaultValue: ""
        description: ""
        name: NOTES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e3a6a5dd-0da8-4b64-a9b9-0081b1f418cc
                stepCounter: 925ea0f6-51e5-4e28-93e6-0dc4ec67a76f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3eb04542-8f89-4871-a7fe-72abf20d1350
          stepCounter: 5e6c56b0-d2ee-40e0-bcfa-156b2864939d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: VALID_FROM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 306d38f1-b1c9-43f2-b39a-9a867262edc6
                stepCounter: 925ea0f6-51e5-4e28-93e6-0dc4ec67a76f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc6286c1-e679-47fb-a1b8-44bacf069936
          stepCounter: 5e6c56b0-d2ee-40e0-bcfa-156b2864939d
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: ENCOUNTER_PROCEDURE_DESCR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aae0f232-8c40-47f1-8708-8e2b49a5a86c
                stepCounter: 47fc8d5d-6322-47a0-8807-209fdd8bdaa9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ce077c4-cb1c-4982-8a0e-ed0ff4b0f08f
          stepCounter: 5e6c56b0-d2ee-40e0-bcfa-156b2864939d
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ENCOUNTER_PROCEDURE_CODES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3942810d-0949-47af-b6ac-b9efbaa1734e
                stepCounter: 47fc8d5d-6322-47a0-8807-209fdd8bdaa9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e4d48645-3fe5-4cac-8a56-16d6ef60418c
          stepCounter: 5e6c56b0-d2ee-40e0-bcfa-156b2864939d
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: RETINAL_SCREENING_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 566ff77c-0945-48fa-927b-d0e6791a4330
                stepCounter: 47fc8d5d-6322-47a0-8807-209fdd8bdaa9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 919b3356-6113-4bc8-9407-5316af5d0bab
          stepCounter: 5e6c56b0-d2ee-40e0-bcfa-156b2864939d
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: ""
        name: HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'M96'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0d1d1f8-0a86-4003-b1bb-c588827144b3
          stepCounter: 5e6c56b0-d2ee-40e0-bcfa-156b2864939d
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f86a74a-69c1-40a2-9a1b-587b24e50fd1
                stepCounter: 47fc8d5d-6322-47a0-8807-209fdd8bdaa9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7e1bfd4-d060-4358-afa6-3090cef55c1e
          stepCounter: 5e6c56b0-d2ee-40e0-bcfa-156b2864939d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: VALID_TO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33a5f362-b29e-4a83-8f5c-10b63be1c90f
                stepCounter: 925ea0f6-51e5-4e28-93e6-0dc4ec67a76f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ef28a82-6a65-42fb-a604-49b7aa5cd325
          stepCounter: 5e6c56b0-d2ee-40e0-bcfa-156b2864939d
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CANCELATION_REASON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b7689d1f-a25e-41c6-9a74-1d647deb25b8
                stepCounter: 925ea0f6-51e5-4e28-93e6-0dc4ec67a76f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 276607ce-b57f-4b4b-82f5-766d699bf015
          stepCounter: 5e6c56b0-d2ee-40e0-bcfa-156b2864939d
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CANCELATION_CLINICIAN_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6588ec3b-86d5-424a-a855-a93398f65576
                stepCounter: 925ea0f6-51e5-4e28-93e6-0dc4ec67a76f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ca35173-c3ef-4235-b30d-89624979b675
          stepCounter: 5e6c56b0-d2ee-40e0-bcfa-156b2864939d
        config: {}
        dataType: CHAR(36)
        defaultValue: ""
        description: ""
        name: UNIQUE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ed75695-77c0-4081-bc01-73c1f2afa486
                stepCounter: 925ea0f6-51e5-4e28-93e6-0dc4ec67a76f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b69e035-f272-4ab6-83a6-62811ff2a1c3
          stepCounter: 5e6c56b0-d2ee-40e0-bcfa-156b2864939d
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CLINIC_LOG_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 402a0d62-b126-4d2b-8b45-5ff27e4f0010
                stepCounter: 925ea0f6-51e5-4e28-93e6-0dc4ec67a76f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b4356dc-f4f0-42f1-b983-b6ec296171f2
          stepCounter: 5e6c56b0-d2ee-40e0-bcfa-156b2864939d
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CLINICIAN_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ecedfe68-817f-4a2f-a785-c5e1861ed5ca
                stepCounter: 925ea0f6-51e5-4e28-93e6-0dc4ec67a76f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1cc9f0a2-840c-4056-9836-74905a404b77
          stepCounter: 5e6c56b0-d2ee-40e0-bcfa-156b2864939d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_VOLUME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07bdfb31-902e-4150-b696-0c272100f5db
                stepCounter: aa0b5686-4888-466a-9e29-35394f9c2a84
            transform: |-
              CASE WHEN l_opto_encounter.didnotattend = 1 AND l_opto_appointment.cancelationreason <>0 THEN 0
                          ELSE 1
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77869252-c2ca-4da7-8635-be291cffb5a5
          stepCounter: 5e6c56b0-d2ee-40e0-bcfa-156b2864939d
        config: {}
        dataType: BIT
        defaultValue: ""
        description: ""
        name: DID_NOT_ATTEND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07bdfb31-902e-4150-b696-0c272100f5db
                stepCounter: aa0b5686-4888-466a-9e29-35394f9c2a84
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e854afb3-7b94-4d12-b71e-297d869e9947
          stepCounter: 5e6c56b0-d2ee-40e0-bcfa-156b2864939d
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: VISIT_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 142303b1-6ce6-4151-804f-6d5cc9e47b89
                stepCounter: aa0b5686-4888-466a-9e29-35394f9c2a84
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 56be3216-08db-4793-8bad-283b59b31a95
          stepCounter: 5e6c56b0-d2ee-40e0-bcfa-156b2864939d
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ENCOUNTER_TYPE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: df54ca30-62a1-40eb-baf9-b23464cdfc5e
                stepCounter: aa0b5686-4888-466a-9e29-35394f9c2a84
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9bac04f-2110-4df7-b748-6113fd895b1d
          stepCounter: 5e6c56b0-d2ee-40e0-bcfa-156b2864939d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: START_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 31921044-79fc-4ac5-a305-6b2e525fca21
                stepCounter: aa0b5686-4888-466a-9e29-35394f9c2a84
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b3eff8f-bddd-462c-a136-7650fcc0d56c
          stepCounter: 5e6c56b0-d2ee-40e0-bcfa-156b2864939d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: END_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 20824a0e-10c6-4e98-b196-9348decc9416
                stepCounter: aa0b5686-4888-466a-9e29-35394f9c2a84
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c166043-9ff1-4d07-af05-b0a30c1b4c8a
          stepCounter: 5e6c56b0-d2ee-40e0-bcfa-156b2864939d
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Record source.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea761564-c4a9-4add-a17e-22435dbc6897
                stepCounter: 925ea0f6-51e5-4e28-93e6-0dc4ec67a76f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6149b548-69fb-4c05-b981-0e24457728d1
          stepCounter: 5e6c56b0-d2ee-40e0-bcfa-156b2864939d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Load date.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e8d3ad73-b39d-41ef-8ce6-44b5a4960c6b
                stepCounter: 925ea0f6-51e5-4e28-93e6-0dc4ec67a76f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f72ba09d-1569-46cc-9fa0-3c345b0f6cf8
          stepCounter: 5e6c56b0-d2ee-40e0-bcfa-156b2864939d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          L_OPTO_APPOINTMENT: 925ea0f6-51e5-4e28-93e6-0dc4ec67a76f
          L_OPTO_APPOINTMENT_ENCOUNTER: 547430dd-0168-46d8-b63f-70fc2a77c3eb
          L_OPTO_ENCOUNTER: aa0b5686-4888-466a-9e29-35394f9c2a84
          L_OPTO_CLINIC: 19c0d3b4-93c3-4010-9c3f-73cf7dfa1e52
          L_OPTO_CLINIC_PLAN: a3c03cbf-0bbc-4d93-9ddb-a56fa512d9c3
          S_OPTO_PATIENT_10: 687e8b78-238c-4482-942c-cfcefb43673b
          L_OPTO_CLINICALLOCATION: d139446d-0543-44a5-aab6-a6bfec82032b
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: L_OPTO_APPOINTMENT
          - locationName: TGT
            nodeName: L_OPTO_APPOINTMENT_ENCOUNTER
          - locationName: TGT
            nodeName: L_OPTO_ENCOUNTER
          - locationName: TGT
            nodeName: L_OPTO_CLINIC
          - locationName: TGT
            nodeName: L_OPTO_CLINIC_PLAN
          - locationName: TGT
            nodeName: S_OPTO_PATIENT_10
          - locationName: TGT
            nodeName: L_OPTO_CLINICALLOCATION
        join:
          joinCondition: |-
            FROM {{ ref('TGT','L_OPTO_APPOINTMENT') }} l_opto_appointment
              JOIN {{ ref('TGT','L_OPTO_APPOINTMENT_ENCOUNTER') }} l_opto_appointment_encounter
                ON l_opto_appointment.id = l_opto_appointment_encounter.appointmentid
              JOIN {{ ref('TGT','L_OPTO_ENCOUNTER') }} l_opto_encounter
                ON l_opto_appointment_encounter.encounterid = l_opto_encounter.id
              JOIN {{ ref('TGT','L_OPTO_CLINIC') }} l_opto_clinic
                ON l_opto_appointment.clinicid = l_opto_clinic.id
              JOIN {{ ref('TGT','L_OPTO_CLINIC_PLAN') }} l_opto_clinic_plan
                ON l_opto_clinic.clinicplanid = l_opto_clinic_plan.id
              JOIN {{ ref('TGT','S_OPTO_PATIENT_10') }} s_opto_patient_10
                ON l_opto_appointment.patientid = s_opto_patient_10.patient_id
              JOIN {{ ref('TGT','L_OPTO_CLINICALLOCATION') }} l_opto_clinicallocation
                ON l_opto_clinic_plan.clinicallocationid = l_opto_clinicallocation.id
              LEFT JOIN s_opto_patient_demographic_details_10
                ON s_opto_patient_demographic_details_10.patient_id = l_opto_appointment.patientid
               AND s_opto_patient_demographic_details_10.demographic_kind_id = 28
               AND l_opto_encounter.starttime BETWEEN s_opto_patient_demographic_details_10.demographic_valid_from AND s_opto_patient_demographic_details_10.demographic_valid_to
              LEFT JOIN s_opto_flatten_procedures_v
                ON s_opto_flatten_procedures_v.encounter_id = l_opto_encounter.id
        name: S_OPTO_APPOINTMENT_10
        noLinkRefs: []
  name: S_OPTO_APPOINTMENT_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
