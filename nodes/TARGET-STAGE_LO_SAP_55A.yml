fileVersion: 1
id: 1b576086-f4c6-4588-815d-1ed6a1a52f0c
name: STAGE_LO_SAP_55A
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef3513bf-7436-4973-bf22-dc48b3cf8638
          stepCounter: 1b576086-f4c6-4588-815d-1ed6a1a52f0c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEDGER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5039fa2-b095-4634-a991-8b69170d819c
                stepCounter: f98646cc-7f95-4803-964e-99e86b22da8b
            transform: TARGET.DIM_LEDGER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 989be729-7b31-413e-844a-ba04a50033bc
          stepCounter: 1b576086-f4c6-4588-815d-1ed6a1a52f0c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACTVY_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3af2a499-3699-4b40-819b-fc3d56a98283
                stepCounter: f98646cc-7f95-4803-964e-99e86b22da8b
            transform: TARGET.DIM_ACTVY_PER_DATE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bceda273-0187-4afe-aad1-5d5fb5310f97
          stepCounter: 1b576086-f4c6-4588-815d-1ed6a1a52f0c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACCT_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ba934cb-0b85-4d41-8000-ecbac18fb7ba
                stepCounter: 7264c4d7-6959-48bb-b933-f944255adb7f
            transform: TARGET.DIM_ACCT_PER_DATE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01ca9aed-a29a-4135-b3eb-67049e83c3d1
          stepCounter: 1b576086-f4c6-4588-815d-1ed6a1a52f0c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_COST_CENTER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c144282f-07d5-4ae9-92e6-ae12cce41439
                stepCounter: bffac1cf-288d-42f6-a1ab-ac15b1edf2b6
            transform: TARGET.DIM_COST_CENTER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee546da8-1da0-4173-a580-0ec70cea1889
          stepCounter: 1b576086-f4c6-4588-815d-1ed6a1a52f0c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7aa4af50-3b5a-497a-a0cb-7f2c03f311bd
          stepCounter: 1b576086-f4c6-4588-815d-1ed6a1a52f0c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_DEST_ORGANIZATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4a608b7-efa1-486c-86ea-bbca120779fb
                stepCounter: 98a317d9-4ad6-46b1-9bc3-a3b980264876
            transform: TARGET.DIM_DEST_ORGANIZATION_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 924149be-3c78-465f-845f-fd5f83f973a1
          stepCounter: 1b576086-f4c6-4588-815d-1ed6a1a52f0c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GL_ACCOUNT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c262a54d-76f3-490b-8d27-3b8a5e563582
          stepCounter: 1b576086-f4c6-4588-815d-1ed6a1a52f0c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c60fedbd-d644-4e72-bb59-e0dcdeb0515f
                stepCounter: f98646cc-7f95-4803-964e-99e86b22da8b
            transform: TARGET.DIM_GROSS_NET_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75687ec0-ce1f-4faf-b51e-2886b78f072d
          stepCounter: 1b576086-f4c6-4588-815d-1ed6a1a52f0c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_HIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03094dcc-28c0-4fee-b106-8de0eba3539c
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98eb2348-73a0-463e-bdab-666764cb0f1a
          stepCounter: 1b576086-f4c6-4588-815d-1ed6a1a52f0c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_VERSION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27c6bdf7-4402-4e27-be7a-1bb43c06bf9c
                stepCounter: f98646cc-7f95-4803-964e-99e86b22da8b
            transform: TARGET.DIM_LEASE_OPS_VERSION_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45820546-90e1-4d45-808c-5ece2857e0dc
          stepCounter: 1b576086-f4c6-4588-815d-1ed6a1a52f0c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LINE_ITEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7e17338-a307-439b-8c0f-df0f0ab49162
          stepCounter: 1b576086-f4c6-4588-815d-1ed6a1a52f0c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_VOUCHER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0fa79b5-e39b-4bb6-ade1-819947676cb2
          stepCounter: 1b576086-f4c6-4588-815d-1ed6a1a52f0c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d10e0e9-8f55-4b3a-9431-88c60cffa8c3
          stepCounter: 1b576086-f4c6-4588-815d-1ed6a1a52f0c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_INVOICE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b93bee8-0e92-4896-8fbc-587a2aca0143
          stepCounter: 1b576086-f4c6-4588-815d-1ed6a1a52f0c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_PRODUCT_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81f7f27b-6424-4906-b576-3b1440236aa8
          stepCounter: 1b576086-f4c6-4588-815d-1ed6a1a52f0c
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3f84c21-4ee9-4cae-88e0-9ce9656d3204
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f662678-6332-49ef-85ec-0571a3c2781f
          stepCounter: 1b576086-f4c6-4588-815d-1ed6a1a52f0c
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1897ef54-0523-4dc1-a66c-871446ec90f7
                stepCounter: f98646cc-7f95-4803-964e-99e86b22da8b
            transform: SUM(OP_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e8d847c-bd6a-40eb-9d30-91b930d3b323
          stepCounter: 1b576086-f4c6-4588-815d-1ed6a1a52f0c
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c62b3eb-22db-45f5-a9a6-a9c7bebf82ea
                stepCounter: f98646cc-7f95-4803-964e-99e86b22da8b
            transform: SUM(CAD_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9885e47-106f-470b-9cd2-2588d3ca57fe
          stepCounter: 1b576086-f4c6-4588-815d-1ed6a1a52f0c
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: 'Gross Line Item Net Op Amount '
        name: NET_OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb4af965-8552-4339-bedb-118b12b8b365
                stepCounter: f98646cc-7f95-4803-964e-99e86b22da8b
            transform: SUM(NET_OP_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a78b2859-7d6b-474f-b0b5-a778404576b4
          stepCounter: 1b576086-f4c6-4588-815d-1ed6a1a52f0c
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: LI_VOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75ef865f-f4e6-4b8e-8c76-e3cb636fb0fd
                stepCounter: f98646cc-7f95-4803-964e-99e86b22da8b
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: daac9b09-330c-414c-93c8-98c323905811
          stepCounter: 1b576086-f4c6-4588-815d-1ed6a1a52f0c
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in cubic meters (m3)
        name: LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ca03f45-9be5-460c-b6e8-192005d5834a
                stepCounter: f98646cc-7f95-4803-964e-99e86b22da8b
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9cb19953-8d17-46f3-a2a2-6e74b24532ed
          stepCounter: 1b576086-f4c6-4588-815d-1ed6a1a52f0c
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in imperial measurement
        name: LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 41ecbeb9-fa5c-49e3-acc1-5e59855bf794
                stepCounter: f98646cc-7f95-4803-964e-99e86b22da8b
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c9530cc-41c8-4924-b562-1c48a4ae380b
          stepCounter: 1b576086-f4c6-4588-815d-1ed6a1a52f0c
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in BOE (Barrel of Oil Equivalent)
        name: LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a0b82536-2fb8-4498-a3da-a933fd6338ce
                stepCounter: f98646cc-7f95-4803-964e-99e86b22da8b
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cfac22bd-7ffa-44f0-ac6d-a148b89dbf15
          stepCounter: 1b576086-f4c6-4588-815d-1ed6a1a52f0c
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in normalized cubic meters (nm3)
        name: LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: acaf17de-5801-438d-bb29-e0572c509e05
                stepCounter: f98646cc-7f95-4803-964e-99e86b22da8b
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de940a7f-e888-4fb7-84a3-43277d324863
          stepCounter: 1b576086-f4c6-4588-815d-1ed6a1a52f0c
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: ""
        name: EXCHANGE_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18bc465a-475c-4c94-a024-cda534308be9
                stepCounter: f98646cc-7f95-4803-964e-99e86b22da8b
            transform: TARGET.EXCHANGE_RATE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 151385d8-a449-4077-a236-cd0738bbb6ec
          stepCounter: 1b576086-f4c6-4588-815d-1ed6a1a52f0c
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cbc3029a-5d73-4e82-b747-6b133b6b2dd0
                stepCounter: f98646cc-7f95-4803-964e-99e86b22da8b
            transform: TARGET.OP_CURR_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79cd6874-6205-47cb-94c4-0a4e0207c743
          stepCounter: 1b576086-f4c6-4588-815d-1ed6a1a52f0c
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Indicates amounts are gross or net.
        name: GROSS_OR_NET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1030e29b-5833-47e8-aefc-6b6ce19b3d5e
                stepCounter: f98646cc-7f95-4803-964e-99e86b22da8b
            transform: TARGET.GROSS_OR_NET_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aab74ec2-28a2-4f4d-be8e-21a9bbdc8d3c
          stepCounter: 1b576086-f4c6-4588-815d-1ed6a1a52f0c
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: LINE_NO_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4607c855-a49d-4eb4-bbf8-11be2b047885
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4721ae20-6dc2-4ff9-92d5-e0a7fa97982c
          stepCounter: 1b576086-f4c6-4588-815d-1ed6a1a52f0c
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: OP_NONOP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8171964a-b44e-47c1-b370-02d96da7f270
                stepCounter: f98646cc-7f95-4803-964e-99e86b22da8b
            transform: TARGET.OP_NONOP
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 082161a2-86a9-4ad2-bfb4-7ff8d2759765
          stepCounter: 1b576086-f4c6-4588-815d-1ed6a1a52f0c
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PROD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_LO_SAP_40A: f98646cc-7f95-4803-964e-99e86b22da8b
          STAGE_LO_SAP_42A: 7264c4d7-6959-48bb-b933-f944255adb7f
          STAGE_LO_SAP_45A: bffac1cf-288d-42f6-a1ab-ac15b1edf2b6
          STAGE_LO_SAP_50A: 98a317d9-4ad6-46b1-9bc3-a3b980264876
          DIM_LO_SAP_LEASE_OPS_HIER: e0b535c4-f94e-4ac1-b685-dfdff6293176
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_40A
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_42A
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_45A
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_50A
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_HIER
        join:
          joinCondition: |-
            FROM (
                    SELECT STAGE_LO_SAP_40A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_40A') }} STAGE_LO_SAP_40A
                 UNION ALL SELECT STAGE_LO_SAP_42A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_42A') }} STAGE_LO_SAP_42A
                 UNION ALL SELECT STAGE_LO_SAP_45A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_45A') }} STAGE_LO_SAP_45A
                 UNION ALL SELECT STAGE_LO_SAP_50A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_50A') }} STAGE_LO_SAP_50A
                   ) TARGET
             CROSS JOIN (
                    SELECT DIM_LEASE_OPS_HIER_KEY,
                           LINE_NO,
                           LINE_NO_GROUP
                      FROM {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_HIER') }}
                     WHERE DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO = '55A'
                   ) DIM_LO_SAP_LEASE_OPS_HIER
             GROUP BY TARGET.DIM_LEDGER_KEY,
                      TARGET.DIM_ACTVY_PER_DATE_KEY,
                      TARGET.DIM_ACCT_PER_DATE_KEY,
                      TARGET.DIM_COST_CENTER_KEY,
                      TARGET.DIM_DEST_ORGANIZATION_KEY,
                      TARGET.DIM_GROSS_NET_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.DIM_LEASE_OPS_HIER_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO_GROUP,
                      TARGET.DIM_LEASE_OPS_VERSION_KEY,
                      TARGET.EXCHANGE_RATE,
                      TARGET.OP_CURR_CODE,
                      TARGET.GROSS_OR_NET_CODE,
                      TARGET.OP_NONOP
        name: STAGE_LO_SAP_55A
        noLinkRefs: []
  name: STAGE_LO_SAP_55A
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
