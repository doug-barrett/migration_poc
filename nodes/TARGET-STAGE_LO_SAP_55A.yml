fileVersion: 1
id: 865dacfb-5b76-4e19-aa47-68446bc10b70
name: STAGE_LO_SAP_55A
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3813a02d-ce5f-4c55-953d-695817e13a98
          stepCounter: 865dacfb-5b76-4e19-aa47-68446bc10b70
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEDGER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9887ce32-920d-46e4-8b43-ebd335d83e39
                stepCounter: 7ae18038-e473-4708-b512-99f3867d252c
            transform: TARGET.DIM_LEDGER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3fb0daba-35cb-4862-a9f2-2a880ea59db8
          stepCounter: 865dacfb-5b76-4e19-aa47-68446bc10b70
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACTVY_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19b93a16-f50d-431e-aadd-02250dfcdf94
                stepCounter: 7ae18038-e473-4708-b512-99f3867d252c
            transform: TARGET.DIM_ACTVY_PER_DATE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66bd3a6f-f1d7-479e-ab9c-9d7abff17f80
          stepCounter: 865dacfb-5b76-4e19-aa47-68446bc10b70
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACCT_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b75ad6e-b60c-4c8b-a5b3-0c21d2640737
                stepCounter: d8e6052c-1f2e-4a39-a93e-a534f97558f6
            transform: TARGET.DIM_ACCT_PER_DATE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d601a89-f948-4403-a060-cb24dc7f02af
          stepCounter: 865dacfb-5b76-4e19-aa47-68446bc10b70
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_COST_CENTER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f138154a-d7ae-46c2-a29d-92ed137813e5
                stepCounter: bd862475-f3d6-4917-b585-55a2a2bc7592
            transform: TARGET.DIM_COST_CENTER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d577796-22ee-43da-bfc0-2fc3f1df4c92
          stepCounter: 865dacfb-5b76-4e19-aa47-68446bc10b70
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b9a37e1-07b8-449b-b311-9370f87659cb
          stepCounter: 865dacfb-5b76-4e19-aa47-68446bc10b70
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_DEST_ORGANIZATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 519e05a5-cbe7-483e-a652-0a637095e7ad
                stepCounter: f595ab1f-e57d-49c2-90cf-8c94521784bb
            transform: TARGET.DIM_DEST_ORGANIZATION_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47d728c7-052c-4b81-8f42-75df6cfce728
          stepCounter: 865dacfb-5b76-4e19-aa47-68446bc10b70
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GL_ACCOUNT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11f9ab49-48de-4561-bbf9-933b7efc30a6
          stepCounter: 865dacfb-5b76-4e19-aa47-68446bc10b70
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db20ea6f-6310-45d5-9a29-6db5bacd262d
                stepCounter: 7ae18038-e473-4708-b512-99f3867d252c
            transform: TARGET.DIM_GROSS_NET_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 916f71ed-184d-4c70-b484-7c31d40adf3f
          stepCounter: 865dacfb-5b76-4e19-aa47-68446bc10b70
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_HIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21fac97a-151e-4cc2-8783-56a1148d309b
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8426c83b-537c-49a3-b6ba-f0782ba42244
          stepCounter: 865dacfb-5b76-4e19-aa47-68446bc10b70
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_VERSION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e01fc3bd-480e-47cc-92cd-4345f793bb21
                stepCounter: 7ae18038-e473-4708-b512-99f3867d252c
            transform: TARGET.DIM_LEASE_OPS_VERSION_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb1a853f-e99e-4df7-ac41-18f4ef7a843c
          stepCounter: 865dacfb-5b76-4e19-aa47-68446bc10b70
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LINE_ITEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 915c7e59-618e-401e-91df-f2d99018d676
          stepCounter: 865dacfb-5b76-4e19-aa47-68446bc10b70
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_VOUCHER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09412e4e-f9bc-4cd7-b5dc-bcf310c0a34b
          stepCounter: 865dacfb-5b76-4e19-aa47-68446bc10b70
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd91c47d-1296-4fb0-80c0-1d7e00311cb8
          stepCounter: 865dacfb-5b76-4e19-aa47-68446bc10b70
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_INVOICE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d7731b7-a7cc-4a58-bab4-ebba8ba29208
          stepCounter: 865dacfb-5b76-4e19-aa47-68446bc10b70
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_PRODUCT_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bde529a5-59d6-401a-9831-1c3f2d42b44c
          stepCounter: 865dacfb-5b76-4e19-aa47-68446bc10b70
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1a83d4b-9af5-4a64-b5b2-f6f811cf7698
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15a5c952-9403-4f14-8f50-30e5aaaab3f1
          stepCounter: 865dacfb-5b76-4e19-aa47-68446bc10b70
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 71118413-808f-488f-9d82-9975d1eab888
                stepCounter: 7ae18038-e473-4708-b512-99f3867d252c
            transform: SUM(OP_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ddba55ec-48b5-4503-b0b1-3275184696ed
          stepCounter: 865dacfb-5b76-4e19-aa47-68446bc10b70
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59311274-738d-42ac-b668-ac37d56ca417
                stepCounter: 7ae18038-e473-4708-b512-99f3867d252c
            transform: SUM(CAD_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b87adc6-96e2-4fd4-a58c-3de4ec1babb2
          stepCounter: 865dacfb-5b76-4e19-aa47-68446bc10b70
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: 'Gross Line Item Net Op Amount '
        name: NET_OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f49d95b-bb40-4bcd-a893-d148e2964691
                stepCounter: 7ae18038-e473-4708-b512-99f3867d252c
            transform: SUM(NET_OP_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6fb85b1a-ebf7-4cb1-8ffa-5f9287f1a481
          stepCounter: 865dacfb-5b76-4e19-aa47-68446bc10b70
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: LI_VOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a0eb357-875d-403f-9e64-452a4df56ae8
                stepCounter: 7ae18038-e473-4708-b512-99f3867d252c
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f6456f9-6b2b-4ffa-95e2-dd5fee9c5e83
          stepCounter: 865dacfb-5b76-4e19-aa47-68446bc10b70
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in cubic meters (m3)
        name: LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e8fc11d-0a2f-4fea-af60-0928e28d9e4a
                stepCounter: 7ae18038-e473-4708-b512-99f3867d252c
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d5c57ad-07be-48f2-abb7-008067291736
          stepCounter: 865dacfb-5b76-4e19-aa47-68446bc10b70
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in imperial measurement
        name: LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8d8cffae-7117-4489-91c9-0b2fa326f295
                stepCounter: 7ae18038-e473-4708-b512-99f3867d252c
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de278e60-6c42-4748-bc0b-561d0c20575b
          stepCounter: 865dacfb-5b76-4e19-aa47-68446bc10b70
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in BOE (Barrel of Oil Equivalent)
        name: LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cf31bd3c-ba92-4a37-bcec-8f977d3f516f
                stepCounter: 7ae18038-e473-4708-b512-99f3867d252c
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8736282-c1e9-470d-84e9-832259617c64
          stepCounter: 865dacfb-5b76-4e19-aa47-68446bc10b70
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in normalized cubic meters (nm3)
        name: LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 026c7308-1806-4654-bd2a-44c6244af606
                stepCounter: 7ae18038-e473-4708-b512-99f3867d252c
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca5997d2-9d55-48af-a7d9-985c77715734
          stepCounter: 865dacfb-5b76-4e19-aa47-68446bc10b70
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: ""
        name: EXCHANGE_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 95374741-1488-4910-8640-2231cc097600
                stepCounter: 7ae18038-e473-4708-b512-99f3867d252c
            transform: TARGET.EXCHANGE_RATE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cfc5ef92-c071-43f5-aba0-0ecddd863a52
          stepCounter: 865dacfb-5b76-4e19-aa47-68446bc10b70
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d53a7cac-937f-4ba8-ada1-1baffa747384
                stepCounter: 7ae18038-e473-4708-b512-99f3867d252c
            transform: TARGET.OP_CURR_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2ebdb1a-c327-4836-a87a-8683414acd4b
          stepCounter: 865dacfb-5b76-4e19-aa47-68446bc10b70
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Indicates amounts are gross or net.
        name: GROSS_OR_NET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa6a5b2e-cf2c-49cc-81e5-4767e0630774
                stepCounter: 7ae18038-e473-4708-b512-99f3867d252c
            transform: TARGET.GROSS_OR_NET_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7c3c332-9ebe-4062-8ff9-33f0b67979e0
          stepCounter: 865dacfb-5b76-4e19-aa47-68446bc10b70
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: LINE_NO_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4460264-eeac-48f7-bae2-1748cdbcf9cb
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1345ac18-61cb-4306-bf13-4258ee621d6c
          stepCounter: 865dacfb-5b76-4e19-aa47-68446bc10b70
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: OP_NONOP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7fe847d0-68ec-472b-87d1-cc9caa130713
                stepCounter: 7ae18038-e473-4708-b512-99f3867d252c
            transform: TARGET.OP_NONOP
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b50f7edf-d45b-45ca-92c2-522e6c3613f2
          stepCounter: 865dacfb-5b76-4e19-aa47-68446bc10b70
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PROD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_LO_SAP_40A: 7ae18038-e473-4708-b512-99f3867d252c
          STAGE_LO_SAP_42A: d8e6052c-1f2e-4a39-a93e-a534f97558f6
          STAGE_LO_SAP_45A: bd862475-f3d6-4917-b585-55a2a2bc7592
          STAGE_LO_SAP_50A: f595ab1f-e57d-49c2-90cf-8c94521784bb
          DIM_LO_SAP_LEASE_OPS_HIER: 82938641-7c51-4aff-ad3a-c7a56af30c01
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_40A
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_42A
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_45A
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_50A
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_HIER
        join:
          joinCondition: |-
            FROM (
                    SELECT STAGE_LO_SAP_40A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_40A') }} STAGE_LO_SAP_40A
                 UNION ALL SELECT STAGE_LO_SAP_42A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_42A') }} STAGE_LO_SAP_42A
                 UNION ALL SELECT STAGE_LO_SAP_45A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_45A') }} STAGE_LO_SAP_45A
                 UNION ALL SELECT STAGE_LO_SAP_50A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_50A') }} STAGE_LO_SAP_50A
                   ) TARGET
             CROSS JOIN (
                    SELECT DIM_LEASE_OPS_HIER_KEY,
                           LINE_NO,
                           LINE_NO_GROUP
                      FROM {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_HIER') }}
                     WHERE DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO = '55A'
                   ) DIM_LO_SAP_LEASE_OPS_HIER
             GROUP BY TARGET.DIM_LEDGER_KEY,
                      TARGET.DIM_ACTVY_PER_DATE_KEY,
                      TARGET.DIM_ACCT_PER_DATE_KEY,
                      TARGET.DIM_COST_CENTER_KEY,
                      TARGET.DIM_DEST_ORGANIZATION_KEY,
                      TARGET.DIM_GROSS_NET_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.DIM_LEASE_OPS_HIER_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO_GROUP,
                      TARGET.DIM_LEASE_OPS_VERSION_KEY,
                      TARGET.EXCHANGE_RATE,
                      TARGET.OP_CURR_CODE,
                      TARGET.GROSS_OR_NET_CODE,
                      TARGET.OP_NONOP
        name: STAGE_LO_SAP_55A
        noLinkRefs: []
  name: STAGE_LO_SAP_55A
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
