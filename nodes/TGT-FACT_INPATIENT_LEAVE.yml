fileVersion: 1
id: f428f8fb-9d1d-434a-8bf1-4ef01cc02bfe
name: FACT_INPATIENT_LEAVE
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Inpatient Leave periods during an Inpatient Event/Encounter "
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e06e1c42-0c86-4c7d-96bb-41131036bab1
          stepCounter: f428f8fb-9d1d-434a-8bf1-4ef01cc02bfe
        config: {}
        dataType: INTEGER IDENTITY(0,1)
        defaultValue: ""
        description: ""
        name: FACT_INPATIENT_LEAVE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f4e0a317-4d14-48ee-9e59-4ec37fc20fd3
          stepCounter: f428f8fb-9d1d-434a-8bf1-4ef01cc02bfe
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72b2b8ca-b8ec-40ba-a613-ee6372ca91a2
                stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0ecb732-f6e9-463f-90be-a85a3b0acc87
          stepCounter: f428f8fb-9d1d-434a-8bf1-4ef01cc02bfe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_LEAVE_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 531e06f6-08df-4f05-888b-452643cd6c99
                stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3597f9b1-b3c1-4aa0-8a0b-3d3de373df5b
          stepCounter: f428f8fb-9d1d-434a-8bf1-4ef01cc02bfe
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9af62039-44af-4925-8f33-af7f697b8c3c
                stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77c42391-db48-4344-8400-809aa0987207
          stepCounter: f428f8fb-9d1d-434a-8bf1-4ef01cc02bfe
        config: {}
        dataType: "INTEGER "
        defaultValue: ""
        description: s_in_patient_leave_10.leave_patient_reference_no=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 248342e5-1fae-495a-bc01-608e6bee932e
                stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a80bcb3-d1ba-4bfa-bbd0-0d34cc55aa52
          stepCounter: f428f8fb-9d1d-434a-8bf1-4ef01cc02bfe
        config: {}
        dataType: "INTEGER "
        defaultValue: ""
        description: s_in_patient_leave_10.event_encounter_type_code=dim_encounter_type.encounter_type_code
        name: DIM_ENCOUNTER_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 177b27a8-7bc7-43c4-b453-d5f315040d5a
                stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2940cf92-acb5-428d-85eb-c3455049729d
          stepCounter: f428f8fb-9d1d-434a-8bf1-4ef01cc02bfe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e16b9f68-0c3d-4d55-938c-fc189642f2bf
                stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9260d466-d4c5-433c-9317-23de1f44af22
          stepCounter: f428f8fb-9d1d-434a-8bf1-4ef01cc02bfe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: HOME_LEAVE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4f08fec5-e5d1-4370-bc83-3732df90c66c
                stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5eea5b5-1838-4c82-bb04-296ec85c3bd7
          stepCounter: f428f8fb-9d1d-434a-8bf1-4ef01cc02bfe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9f49e773-08d8-4ccc-9fa6-785d99d7f55a
                stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9cf59f58-43ff-4f97-9152-8972651fd14d
          stepCounter: f428f8fb-9d1d-434a-8bf1-4ef01cc02bfe
        config: {}
        dataType: "INTEGER "
        defaultValue: ""
        description: s_in_patient_leave_10.ward_code=dim_ward.ward_code
        name: DIM_WARD_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f6ced25-4bc4-48a3-b1a3-a2e59f75c755
                stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1a5a161-7f13-4b50-9a80-7634a3d2689f
          stepCounter: f428f8fb-9d1d-434a-8bf1-4ef01cc02bfe
        config: {}
        dataType: "INTEGER "
        defaultValue: ""
        description: s_in_patient_leave_10.clinician_reference_no=dim_clinician.clinician_reference_no
        name: DIM_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 71c24739-c624-4b28-88e1-4adc829ec9f4
                stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be69b2f8-a8e2-47af-81b6-e7ac237e747f
          stepCounter: f428f8fb-9d1d-434a-8bf1-4ef01cc02bfe
        config: {}
        dataType: "INTEGER "
        defaultValue: ""
        description: s_in_patient_leave_10.specialty_reference_no=dim_specialty.specialty_reference_no
        name: DIM_SPECIALTY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c355b24-08ca-49a7-8e4a-e9212076be03
                stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54ec6ff3-9170-4daf-a336-34c9fd427a4e
          stepCounter: f428f8fb-9d1d-434a-8bf1-4ef01cc02bfe
        config: {}
        dataType: INT
        defaultValue: ""
        description: s_in_patient_leave_10.CONVERT(date,admit_date)=dim_admission_date.admission_calendar_date
        name: DIM_ADMISSION_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec461b37-831a-43b8-afb4-d002e2a57e19
                stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5752cf3-3a15-45e3-b426-10341a1d4e23
          stepCounter: f428f8fb-9d1d-434a-8bf1-4ef01cc02bfe
        config: {}
        dataType: INT
        defaultValue: ""
        description: s_in_patient_leave_10.CONVERT(date,disch_date)=dim_discharge_date.discharge_calendar_date
        name: DIM_DISCHARGE_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c65af5d-35d1-4904-bc79-bf41c019dc89
                stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3488e46f-17b8-4286-b7de-608e43c2ffb6
          stepCounter: f428f8fb-9d1d-434a-8bf1-4ef01cc02bfe
        config: {}
        dataType: "INTEGER "
        defaultValue: ""
        description: s_in_patient_leave_10.leave_type_reference_no=dim_leave_type.leave_type_reference_no
        name: DIM_LEAVE_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bda319b6-02aa-4d4b-b1e1-e5313937bd1a
                stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b55ba8f3-03f1-440e-a307-00a09b7a45cc
          stepCounter: f428f8fb-9d1d-434a-8bf1-4ef01cc02bfe
        config: {}
        dataType: "INTEGER "
        defaultValue: ""
        description: s_in_patient_leave_10.leave_reason_reference_no=dim_leave_reason.leave_reason_reference_no
        name: DIM_LEAVE_REASON_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9f45d6e6-90fe-464a-9abd-3b9d5a0f7114
                stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 245cf875-145c-474b-9415-ce0763e9fceb
          stepCounter: f428f8fb-9d1d-434a-8bf1-4ef01cc02bfe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LEAVE_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 85cc98fd-7731-4f9a-860d-ab1dadf3c4a2
                stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c89db4b-18a0-4d18-841d-dc6173a9ae2f
          stepCounter: f428f8fb-9d1d-434a-8bf1-4ef01cc02bfe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_leave_10.CONVERT(date,s_in_patient_leave_05.leave_start_date)=dim_leave_start_date.leave_start_calendar_date
        name: DIM_LEAVE_START_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2bacd0f-261c-4a0e-9c89-d67f50abc083
                stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c52cefd-7d32-44dc-a9a7-1c684cd5056e
          stepCounter: f428f8fb-9d1d-434a-8bf1-4ef01cc02bfe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_leave_10.CONVERT(date,s_in_patient_leave_05.leave_end_date)=dim_leave_end_date.leave_end_calendar_date
        name: DIM_LEAVE_END_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a8553633-0de1-4987-ac59-686906208844
                stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bc9c2d39-df43-47d7-a4c2-3ee9111684b9
          stepCounter: f428f8fb-9d1d-434a-8bf1-4ef01cc02bfe
        config: {}
        dataType: INT
        defaultValue: ""
        description: s_in_patient_leave_10.CONVERT(date,stay_start_date)=dim_stay_start_date.stay_start_calendar_date
        name: DIM_STAY_START_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78acdcf1-b400-4e0a-8500-7e828d5a7b69
                stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42ddab56-70a5-4cb0-a797-71bc6a944712
          stepCounter: f428f8fb-9d1d-434a-8bf1-4ef01cc02bfe
        config: {}
        dataType: INT
        defaultValue: ""
        description: s_in_patient_leave_10.CONVERT(date,stay_end_date)=dim_stay_end_date.stay_end_calendar_date
        name: DIM_STAY_END_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2fc8f735-8306-40ba-b53a-1a80d451964a
                stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1af36f2e-d264-496a-b4e5-fbe60c31c1a0
          stepCounter: f428f8fb-9d1d-434a-8bf1-4ef01cc02bfe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LEAVE_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e9215f71-0644-457b-87c1-0c81df3d8750
                stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4be92da9-5be9-49d3-8467-db5e575927b9
          stepCounter: f428f8fb-9d1d-434a-8bf1-4ef01cc02bfe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: EXPECTED_RETURN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 44f4ac7c-63ef-43aa-bd03-5ad716735b8e
                stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 329671d0-de10-49dd-a3c9-b74a3e1ec632
          stepCounter: f428f8fb-9d1d-434a-8bf1-4ef01cc02bfe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: RECALL_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 89bf6d6a-794b-4a7e-934b-c71e17686bae
                stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82542c22-df0f-4a1a-b715-624a678eeb24
          stepCounter: f428f8fb-9d1d-434a-8bf1-4ef01cc02bfe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LATEST_RETURN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 664c3178-160d-42e5-9b8c-6e2bc4d8606e
                stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab73a584-6f67-4961-94b5-38f30e708c70
          stepCounter: f428f8fb-9d1d-434a-8bf1-4ef01cc02bfe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_LEAVE_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2fb8b2b7-7b16-41e8-9957-1904e83680e6
                stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27c5b205-9be9-46f2-b3d2-2c03fcfc4c09
          stepCounter: f428f8fb-9d1d-434a-8bf1-4ef01cc02bfe
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: duration_unit
        name: DURATION_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b513da29-9ea6-4121-a55c-6f8c04837e98
                stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f699176a-ceea-4b57-a1c9-c0598260c394
          stepCounter: f428f8fb-9d1d-434a-8bf1-4ef01cc02bfe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_LEAVE_TOTAL_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67f69e50-08dc-4719-8405-4c61577ee3df
                stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bab19484-84e3-4f61-97c8-94630847207b
          stepCounter: f428f8fb-9d1d-434a-8bf1-4ef01cc02bfe
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DSS_DATA_QUALITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 37164eda-3e96-436d-ba52-b90330369043
                stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1931112-c6d4-42e9-ab82-46efaa932aac
          stepCounter: f428f8fb-9d1d-434a-8bf1-4ef01cc02bfe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_IN_PATIENT_LEAVE_10: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_IN_PATIENT_LEAVE_10
        join:
          joinCondition: |
            FROM {{ ref('TGT', 'S_IN_PATIENT_LEAVE_10') }} "S_IN_PATIENT_LEAVE_10"
        name: FACT_INPATIENT_LEAVE
        noLinkRefs: []
  name: FACT_INPATIENT_LEAVE
  overrideSQL: false
  schema: ""
  sqlType: Fact
  type: sql
  version: 1
type: Node
