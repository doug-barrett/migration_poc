fileVersion: 1
id: d6d9a1a5-0497-4360-8920-f88f3e85c0ae
name: STAGE_LO_SAP_103A
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 157eec27-adf7-4b87-83ea-8c4c22e12d8c
          stepCounter: d6d9a1a5-0497-4360-8920-f88f3e85c0ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEDGER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e36db70-c89f-4674-b78f-2706b681a5af
                stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
            transform: TARGET.DIM_LEDGER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 003a0266-2ca5-42ff-b326-b7b9ab84330c
          stepCounter: d6d9a1a5-0497-4360-8920-f88f3e85c0ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACTVY_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 111b85f3-ab20-4ba5-8023-28067939388c
                stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
            transform: TARGET.DIM_ACTVY_PER_DATE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22198660-dbdd-4635-8327-2c2fc06b7e0b
          stepCounter: d6d9a1a5-0497-4360-8920-f88f3e85c0ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACCT_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c6484b8b-f820-4bc1-a826-6f9b0761df9c
                stepCounter: 5897a9a0-39fb-411e-9206-d39cbaf9ec23
            transform: TARGET.DIM_ACCT_PER_DATE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5fc2ff45-29e1-47dd-919a-e0dc167aa094
          stepCounter: d6d9a1a5-0497-4360-8920-f88f3e85c0ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_COST_CENTER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a49123d8-0d1e-4520-8211-a8a0b96cd7f5
                stepCounter: 69c06b9c-7e3a-43e6-b267-6669bcd021f0
            transform: TARGET.DIM_COST_CENTER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09f7af1c-c359-4dda-b069-8c9d598c4ace
          stepCounter: d6d9a1a5-0497-4360-8920-f88f3e85c0ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d827baf-72a1-47a2-972d-c950284993d3
          stepCounter: d6d9a1a5-0497-4360-8920-f88f3e85c0ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_DEST_ORGANIZATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24faff2d-a65f-4b28-a829-6116c5124b63
                stepCounter: 142cc4b4-8bc7-4091-948b-2cabe5a302a2
            transform: TARGET.DIM_DEST_ORGANIZATION_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 186d953e-7051-485a-8c34-0a7ccc3c9761
          stepCounter: d6d9a1a5-0497-4360-8920-f88f3e85c0ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GL_ACCOUNT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2fb6077e-3c85-4d05-ac11-88d406216435
          stepCounter: d6d9a1a5-0497-4360-8920-f88f3e85c0ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 35002150-780d-4360-88b9-af48718f2937
                stepCounter: 3e3753cd-2f4b-4cb9-9dbc-07e0acb4d7ba
            transform: TARGET.DIM_GROSS_NET_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 116ee024-659b-4474-a87f-87242f00e7ff
          stepCounter: d6d9a1a5-0497-4360-8920-f88f3e85c0ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_HIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21fac97a-151e-4cc2-8783-56a1148d309b
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 43212074-07ed-412c-a3b8-1db89bb8843d
          stepCounter: d6d9a1a5-0497-4360-8920-f88f3e85c0ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_VERSION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e77590a9-3346-4ead-a254-fcefcf2e8735
                stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
            transform: TARGET.DIM_LEASE_OPS_VERSION_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce3c9b48-f4a3-494d-aad9-fdfa1cab0288
          stepCounter: d6d9a1a5-0497-4360-8920-f88f3e85c0ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LINE_ITEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4bee5700-b769-4dfa-bf73-7c12d08fc6d7
          stepCounter: d6d9a1a5-0497-4360-8920-f88f3e85c0ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_VOUCHER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6723ad78-07c3-481b-b728-0e51abbffb4a
          stepCounter: d6d9a1a5-0497-4360-8920-f88f3e85c0ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1eed69f7-a11e-457d-9acd-7c3c63267c6c
          stepCounter: d6d9a1a5-0497-4360-8920-f88f3e85c0ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_INVOICE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea602cbc-92f2-420f-884c-67b778fb1174
          stepCounter: d6d9a1a5-0497-4360-8920-f88f3e85c0ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_PRODUCT_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95658363-c53d-4705-a915-bd68384a3ad0
          stepCounter: d6d9a1a5-0497-4360-8920-f88f3e85c0ae
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1a83d4b-9af5-4a64-b5b2-f6f811cf7698
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 322a62e1-6468-41f4-a958-23b36525c0f1
          stepCounter: d6d9a1a5-0497-4360-8920-f88f3e85c0ae
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e65fe7b2-540e-436e-b9e3-94e1d4bbe3ed
                stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
            transform: SUM(OP_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94226de3-1d49-44c8-8188-c2d68f8376ae
          stepCounter: d6d9a1a5-0497-4360-8920-f88f3e85c0ae
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c1453fb-9c6c-4535-bfaf-47e320d3b93d
                stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
            transform: SUM(CAD_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de11edcf-0a95-479a-97af-602121f983fb
          stepCounter: d6d9a1a5-0497-4360-8920-f88f3e85c0ae
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: 'Gross Line Item Net Op Amount '
        name: NET_OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 70c81554-7c0c-47ac-9d27-251fbe65855b
                stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
            transform: SUM(NET_OP_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16fcdc6a-8948-4f9a-860c-8ad569327aa8
          stepCounter: d6d9a1a5-0497-4360-8920-f88f3e85c0ae
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: LI_VOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4125db9-1013-41ca-a71a-b89ae2d5f15f
                stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ffe701ff-3c89-4de2-929d-9ef2d79b5693
          stepCounter: d6d9a1a5-0497-4360-8920-f88f3e85c0ae
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in cubic meters (m3)
        name: LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 37612632-c867-415d-bcc9-836a1397abaf
                stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b25438c-dcd4-43a4-9224-8142cfba4c41
          stepCounter: d6d9a1a5-0497-4360-8920-f88f3e85c0ae
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in imperial measurement
        name: LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d450f0c6-74a2-4c66-b652-ddf70b520fc4
                stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee2efe5c-c2c8-4b52-bf58-ca3d33d8dc19
          stepCounter: d6d9a1a5-0497-4360-8920-f88f3e85c0ae
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in BOE (Barrel of Oil Equivalent)
        name: LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9db5f218-cf2a-4afe-8ea0-c1898439fab2
                stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: daefb01d-9238-4645-88c3-f0be3a15378e
          stepCounter: d6d9a1a5-0497-4360-8920-f88f3e85c0ae
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in normalized cubic meters (nm3)
        name: LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 136eb159-faad-46f1-a467-e00b22f38b98
                stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5df9bc08-3bf7-451f-a51e-df4427866b4a
          stepCounter: d6d9a1a5-0497-4360-8920-f88f3e85c0ae
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: ""
        name: EXCHANGE_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ded51c88-1b16-4f56-8f76-79199aeeb016
                stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
            transform: TARGET.EXCHANGE_RATE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 494b33e5-f16d-4865-8bec-6e2cb13e7571
          stepCounter: d6d9a1a5-0497-4360-8920-f88f3e85c0ae
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d36fd29f-d56a-4522-bc21-229ac7304d6a
                stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
            transform: TARGET.OP_CURR_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42b3f20b-8bd8-48c6-bf5c-114b474ccfff
          stepCounter: d6d9a1a5-0497-4360-8920-f88f3e85c0ae
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Indicates amounts are gross or net.
        name: GROSS_OR_NET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 57280888-f636-4420-a830-c2c69fc8a3bb
                stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
            transform: TARGET.GROSS_OR_NET_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb9372b7-dabf-4d5a-a6ea-d00827a66584
          stepCounter: d6d9a1a5-0497-4360-8920-f88f3e85c0ae
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: LINE_NO_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4460264-eeac-48f7-bae2-1748cdbcf9cb
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 715a0474-fceb-464b-8757-311796c9aae6
          stepCounter: d6d9a1a5-0497-4360-8920-f88f3e85c0ae
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: OP_NONOP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 58982312-56be-4b31-a53b-fc4f30ac663a
                stepCounter: 175558ec-f91d-404c-bf6f-7289a5ba4432
            transform: TARGET.OP_NONOP
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7048d968-ccd7-44ed-921e-2ae1e6481c32
          stepCounter: d6d9a1a5-0497-4360-8920-f88f3e85c0ae
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PROD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_LO_SAP_80A: 175558ec-f91d-404c-bf6f-7289a5ba4432
          STAGE_LO_SAP_81A: 5897a9a0-39fb-411e-9206-d39cbaf9ec23
          STAGE_LO_SAP_100A: 69c06b9c-7e3a-43e6-b267-6669bcd021f0
          STAGE_LO_SAP_101A: 142cc4b4-8bc7-4091-948b-2cabe5a302a2
          STAGE_LO_SAP_102A: 3e3753cd-2f4b-4cb9-9dbc-07e0acb4d7ba
          DIM_LO_SAP_LEASE_OPS_HIER: 82938641-7c51-4aff-ad3a-c7a56af30c01
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_80A
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_81A
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_100A
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_101A
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_102A
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_HIER
        join:
          joinCondition: |-
            FROM (
                    SELECT STAGE_LO_SAP_80A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_80A') }} STAGE_LO_SAP_80A
                 UNION ALL SELECT STAGE_LO_SAP_81A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_81A') }} STAGE_LO_SAP_81A
                 UNION ALL SELECT STAGE_LO_SAP_100A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_100A') }} STAGE_LO_SAP_100A
                 UNION ALL SELECT STAGE_LO_SAP_101A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_101A') }} STAGE_LO_SAP_101A
                 UNION ALL SELECT STAGE_LO_SAP_102A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_102A') }} STAGE_LO_SAP_102A
                   ) TARGET
             CROSS JOIN (
                    SELECT DIM_LEASE_OPS_HIER_KEY,
                           LINE_NO,
                           LINE_NO_GROUP
                      FROM {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_HIER') }}
                     WHERE DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO = '103A'
                   ) DIM_LO_SAP_LEASE_OPS_HIER
             GROUP BY TARGET.DIM_LEDGER_KEY,
                      TARGET.DIM_ACTVY_PER_DATE_KEY,
                      TARGET.DIM_ACCT_PER_DATE_KEY,
                      TARGET.DIM_COST_CENTER_KEY,
                      TARGET.DIM_DEST_ORGANIZATION_KEY,
                      TARGET.DIM_GROSS_NET_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.DIM_LEASE_OPS_HIER_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO_GROUP,
                      TARGET.DIM_LEASE_OPS_VERSION_KEY,
                      TARGET.EXCHANGE_RATE,
                      TARGET.OP_CURR_CODE,
                      TARGET.GROSS_OR_NET_CODE,
                      TARGET.OP_NONOP
        name: STAGE_LO_SAP_103A
        noLinkRefs: []
  name: STAGE_LO_SAP_103A
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
