fileVersion: 1
id: 66700bd8-5a3c-4d8a-abef-eeee97c45a6c
name: STAGE_LO_SAP_103A
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f453558d-33e6-42b6-b8f0-9e5ceeaf1a03
          stepCounter: 66700bd8-5a3c-4d8a-abef-eeee97c45a6c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEDGER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3ab277bd-2293-4081-a914-d1d76fa22d0b
                stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
            transform: TARGET.DIM_LEDGER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4bf7b941-5602-48db-a901-6d4d60498c92
          stepCounter: 66700bd8-5a3c-4d8a-abef-eeee97c45a6c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACTVY_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ff3c468-78e3-4992-8e46-582694a43181
                stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
            transform: TARGET.DIM_ACTVY_PER_DATE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a6d206a-4fb7-4488-b286-ddf6cf41a6ed
          stepCounter: 66700bd8-5a3c-4d8a-abef-eeee97c45a6c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACCT_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 37097f7a-0a56-4043-b053-8b261dcc2cf8
                stepCounter: e7e35d6c-578b-4384-9bbe-7f9a8f10a20b
            transform: TARGET.DIM_ACCT_PER_DATE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8ff2015-a158-42b4-8f7b-f30d429f51cb
          stepCounter: 66700bd8-5a3c-4d8a-abef-eeee97c45a6c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_COST_CENTER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b92cbd57-f709-485b-9b30-3b0314aa9c4e
                stepCounter: fa8bab81-e98e-4dee-966c-d25cfe351824
            transform: TARGET.DIM_COST_CENTER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c087e486-d4d3-4345-835c-e14357cbf74b
          stepCounter: 66700bd8-5a3c-4d8a-abef-eeee97c45a6c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a62e3ca1-8c2b-49cc-8df9-9f0da7313954
          stepCounter: 66700bd8-5a3c-4d8a-abef-eeee97c45a6c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_DEST_ORGANIZATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4d7a4579-47e6-4cae-af21-2026eb511f4c
                stepCounter: 384ac485-7c8c-4439-b03b-2b3ae5a13cb8
            transform: TARGET.DIM_DEST_ORGANIZATION_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4bd284ab-f644-4d63-a3a2-d1bbdf370ea6
          stepCounter: 66700bd8-5a3c-4d8a-abef-eeee97c45a6c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GL_ACCOUNT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9094fd9e-79f3-49ec-9ada-5c5650aad745
          stepCounter: 66700bd8-5a3c-4d8a-abef-eeee97c45a6c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc999a85-9cf2-417f-95f9-4fe7f3be2dcb
                stepCounter: 91f70b3c-2442-422f-8692-f957f99ef490
            transform: TARGET.DIM_GROSS_NET_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d34ab4df-1b99-4e8f-addd-8b57a098a738
          stepCounter: 66700bd8-5a3c-4d8a-abef-eeee97c45a6c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_HIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03094dcc-28c0-4fee-b106-8de0eba3539c
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c549aa3-e677-4331-9aef-7cfb64b8659f
          stepCounter: 66700bd8-5a3c-4d8a-abef-eeee97c45a6c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_VERSION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 221ebc68-c41d-4dec-a57f-e7bee1a353c9
                stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
            transform: TARGET.DIM_LEASE_OPS_VERSION_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18c51208-ee65-4256-8e70-de61a1328a85
          stepCounter: 66700bd8-5a3c-4d8a-abef-eeee97c45a6c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LINE_ITEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53a4b1d8-94fd-4704-b140-521f329bf5c6
          stepCounter: 66700bd8-5a3c-4d8a-abef-eeee97c45a6c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_VOUCHER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 44e69a08-9014-42d4-ad65-62b164b4cde0
          stepCounter: 66700bd8-5a3c-4d8a-abef-eeee97c45a6c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 99536415-4ae4-4ac1-8bb0-a37b33f2bf3b
          stepCounter: 66700bd8-5a3c-4d8a-abef-eeee97c45a6c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_INVOICE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 148a3468-be33-4168-9a8b-a79640c9d62c
          stepCounter: 66700bd8-5a3c-4d8a-abef-eeee97c45a6c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_PRODUCT_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80703acc-daa6-46e2-b001-781317594a7d
          stepCounter: 66700bd8-5a3c-4d8a-abef-eeee97c45a6c
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3f84c21-4ee9-4cae-88e0-9ce9656d3204
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e185a76-b4ca-4b40-869c-98c575399d0f
          stepCounter: 66700bd8-5a3c-4d8a-abef-eeee97c45a6c
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6222fa4c-b32d-4456-b58b-470b619ee765
                stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
            transform: SUM(OP_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ba6f056-159d-4c0c-afbf-57af1287b2bf
          stepCounter: 66700bd8-5a3c-4d8a-abef-eeee97c45a6c
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f891247-27eb-494e-a290-5a2ccc90884a
                stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
            transform: SUM(CAD_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 56d8bb46-cd35-4877-9d59-ae36b843d4b6
          stepCounter: 66700bd8-5a3c-4d8a-abef-eeee97c45a6c
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: 'Gross Line Item Net Op Amount '
        name: NET_OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c962078d-c486-42ba-8faa-fbe5612e98d1
                stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
            transform: SUM(NET_OP_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9adc6e3d-2e66-42a7-8b60-d3dc8e2d872d
          stepCounter: 66700bd8-5a3c-4d8a-abef-eeee97c45a6c
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: LI_VOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b5ee34fa-bb8a-481d-8de7-2794e44196f7
                stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 093f19d6-30ef-42ec-915a-7baf9d90313a
          stepCounter: 66700bd8-5a3c-4d8a-abef-eeee97c45a6c
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in cubic meters (m3)
        name: LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b50b824e-bdf6-43e9-b44b-2b03f9f989e1
                stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa674112-ee94-4121-bf22-47c3a48455e9
          stepCounter: 66700bd8-5a3c-4d8a-abef-eeee97c45a6c
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in imperial measurement
        name: LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe773cb1-ed4e-4bda-98cd-b28102c125c7
                stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ce83588-cb5e-4076-b340-33d466a00db7
          stepCounter: 66700bd8-5a3c-4d8a-abef-eeee97c45a6c
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in BOE (Barrel of Oil Equivalent)
        name: LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 526327cc-a975-4fd2-bd0c-403202678547
                stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9a0f34a-9229-401b-9a4e-9d51651bc864
          stepCounter: 66700bd8-5a3c-4d8a-abef-eeee97c45a6c
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in normalized cubic meters (nm3)
        name: LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f1276737-a827-48ec-84f3-10c2a415066b
                stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f605b63-bb65-4505-aa7f-c0b1f3e0eac7
          stepCounter: 66700bd8-5a3c-4d8a-abef-eeee97c45a6c
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: ""
        name: EXCHANGE_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 515ed479-5c89-4ed7-9ef0-e6d0bd0d049c
                stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
            transform: TARGET.EXCHANGE_RATE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b813f4a-bd21-4528-999c-789797b02f07
          stepCounter: 66700bd8-5a3c-4d8a-abef-eeee97c45a6c
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4bbca964-55d9-4a65-a713-c4339c961ea9
                stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
            transform: TARGET.OP_CURR_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f43ded37-93f1-4ff8-8a70-ded5e74fce90
          stepCounter: 66700bd8-5a3c-4d8a-abef-eeee97c45a6c
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Indicates amounts are gross or net.
        name: GROSS_OR_NET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 843d9f03-db21-4ead-bdff-8eff0edd67cd
                stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
            transform: TARGET.GROSS_OR_NET_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b3f0f46a-edcc-4209-a77d-340d08a2f0e4
          stepCounter: 66700bd8-5a3c-4d8a-abef-eeee97c45a6c
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: LINE_NO_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4607c855-a49d-4eb4-bbf8-11be2b047885
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9bbf188-e9ec-4940-bc5d-5052f8c90e4d
          stepCounter: 66700bd8-5a3c-4d8a-abef-eeee97c45a6c
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: OP_NONOP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eeffca2a-7bc4-42ef-868f-6f03c9fb6c7f
                stepCounter: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
            transform: TARGET.OP_NONOP
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49345ec2-fee1-487a-936d-b1d32b269deb
          stepCounter: 66700bd8-5a3c-4d8a-abef-eeee97c45a6c
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PROD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_LO_SAP_80A: 77b0ff91-916e-45c7-a4c6-d8e28fb6014b
          STAGE_LO_SAP_81A: e7e35d6c-578b-4384-9bbe-7f9a8f10a20b
          STAGE_LO_SAP_100A: fa8bab81-e98e-4dee-966c-d25cfe351824
          STAGE_LO_SAP_101A: 384ac485-7c8c-4439-b03b-2b3ae5a13cb8
          STAGE_LO_SAP_102A: 91f70b3c-2442-422f-8692-f957f99ef490
          DIM_LO_SAP_LEASE_OPS_HIER: e0b535c4-f94e-4ac1-b685-dfdff6293176
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_80A
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_81A
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_100A
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_101A
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_102A
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_HIER
        join:
          joinCondition: |-
            FROM (
                    SELECT STAGE_LO_SAP_80A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_80A') }} STAGE_LO_SAP_80A
                 UNION ALL SELECT STAGE_LO_SAP_81A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_81A') }} STAGE_LO_SAP_81A
                 UNION ALL SELECT STAGE_LO_SAP_100A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_100A') }} STAGE_LO_SAP_100A
                 UNION ALL SELECT STAGE_LO_SAP_101A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_101A') }} STAGE_LO_SAP_101A
                 UNION ALL SELECT STAGE_LO_SAP_102A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_102A') }} STAGE_LO_SAP_102A
                   ) TARGET
             CROSS JOIN (
                    SELECT DIM_LEASE_OPS_HIER_KEY,
                           LINE_NO,
                           LINE_NO_GROUP
                      FROM {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_HIER') }}
                     WHERE DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO = '103A'
                   ) DIM_LO_SAP_LEASE_OPS_HIER
             GROUP BY TARGET.DIM_LEDGER_KEY,
                      TARGET.DIM_ACTVY_PER_DATE_KEY,
                      TARGET.DIM_ACCT_PER_DATE_KEY,
                      TARGET.DIM_COST_CENTER_KEY,
                      TARGET.DIM_DEST_ORGANIZATION_KEY,
                      TARGET.DIM_GROSS_NET_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.DIM_LEASE_OPS_HIER_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO_GROUP,
                      TARGET.DIM_LEASE_OPS_VERSION_KEY,
                      TARGET.EXCHANGE_RATE,
                      TARGET.OP_CURR_CODE,
                      TARGET.GROSS_OR_NET_CODE,
                      TARGET.OP_NONOP
        name: STAGE_LO_SAP_103A
        noLinkRefs: []
  name: STAGE_LO_SAP_103A
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
