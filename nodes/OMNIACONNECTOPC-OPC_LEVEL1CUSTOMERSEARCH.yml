fileVersion: 1
id: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
name: OPC_LEVEL1CUSTOMERSEARCH
operation:
  config:
    distinct: true
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: OMNIACONNECT.OPC
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 35e8df75-4365-494c-8c7c-b58320f8fac5
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE HIGHEST-LEVEL OF HIERARCHY FOR AN ACCOUNT
        isBusinessKey: true
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b51c7309-985e-4d41-8f5c-c6f313af6bc4
                stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f8520962-7d0a-4e2e-81a9-07b1a523eb3c
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE SAME VALUE AS THE ACCOUNTNAME COLUMN, BUT HAS BEEN RUN THROUGH A PROPERCASE FUNCTION
        name: DISPLAYACCOUNTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0dcdc149-395b-495b-a947-babe5c44c5a2
                stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71c61d0c-efd6-4e68-b6b2-3e8d5791b8d2
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE TYPE, OR CLASSIFICATION, OF THE ACCOUNT
        name: ACCOUNTTYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc26ca61-a0e8-47c0-bcdd-b214ad2837fd
                stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 261158cb-738e-4237-a903-5051726578bd
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: STREET ADDRESS LINE 1 MATCHED WITH USPS.
        name: ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c7c87e5-2dc9-467e-9b26-59ddb4f6d51e
                stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
            transform: COALESCE(INITCAP(OPC_ACCOUNT.USPSADDRESS),'')
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 83367a9e-78d8-49de-9809-cb3930c90f92
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: STREET ADDRESS LINE 2 MATCHED WITH USPS.
        name: ADDRESS2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7174f974-b705-4839-b493-d29a5ee90477
                stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4bcd39a-0484-4a45-9534-9fda146919b5
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ADDRESS CITY MATCHED WITH USPS.
        name: CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: df9f4c82-bbe6-49cc-a5a5-a8daf652dc92
                stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
            transform: COALESCE(OPC_ACCOUNT.USPSCITY, OPC_ACCOUNT.CITY,'')
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b316a903-b639-4a84-bd01-04c40ec8ce15
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ADDRESS COUNTY MATCHED WITH USPS.
        name: COUNTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24e8152f-4686-49aa-b8eb-dbb74168d9bc
                stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b2a7cf65-4f78-4fd9-bfd0-600f7a1909d4
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ADDRESS STATE MATCHED WITH USPS.
        name: STATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3221db8-2ca6-4193-b3b4-a3ceb1f1755f
                stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
            transform: COALESCE(OPC_ACCOUNT.USPSSTATE, OPC_ACCOUNT.STATE, '')
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d742607-622b-44bd-bd30-3d1b9e91bd2e
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ADDRESS POSTALCODE MATCHED WITH USPS.
        name: ZIPCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d48ecf7e-2083-4aaf-8ebf-754a8a1b72b6
                stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
            transform: COALESCE(OPC_ACCOUNT.USPSZIPCODE, OPC_ACCOUNT.ZIPCODE, '0')
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 85f38dd6-4f96-4b6c-9123-f92f5336c9bf
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: DATE
        defaultValue: ""
        description: IS THE DATE THAT THE ACCOUNT EITHER REGISTERED OR, IN THE EVENT WE DO NOT HAVE A REGISTRATION, WILL BE THE DATE OF FIRST PURCHASE
        name: STARTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: da0b98c9-5b8c-442d-958a-98c9e36b543f
                stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a7397e5-e4a0-4676-a4d2-4b64ea6ee8aa
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: STRATEGIC ACCOUNT REASON
        name: TIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9743677-54cd-47fb-b88a-2f2956a30e09
                stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
            transform: COALESCE(OPC_ACCOUNT.STRATEGICACCOUNTREASON,OPC_ACCOUNT.MEMBERSEGMENT)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8c1a245-4079-4950-a6b1-2c773c48528c
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE 9-DIGIT EIN (EMPLOYER IDENTIFICATION NUMBER) FOR THE ACCOUNT
        name: FEDERALTAXID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4870c870-6bff-4774-a984-04619798e603
                stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b5f13222-eb33-4e8f-a27d-7dd2ce3b2ca5
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE PRIMARY URL FOR THE ACCOUNT
        name: WEBSITE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: be970beb-9197-4ffe-b8ae-170c0c1ba852
                stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20378ca7-67db-44bb-892b-6934b731b06a
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: TERRITORY NAME
        name: TERRITORYNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: abe76b01-5b96-41af-b85f-ab14f73ca60d
                stepCounter: 0800d08b-3992-497e-9eb7-c478c017e794
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b54e20f-afdc-4107-903a-b6139f582a33
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYDIVISIONLEADERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ebbd46a2-02ca-4779-9fb5-2a421ce3286f
                stepCounter: 0800d08b-3992-497e-9eb7-c478c017e794
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 778316a7-0716-45b8-9d54-79e58b615c07
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYDIVISIONLEADERUPN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 323ef3a1-0453-4964-a6b5-0ba5f297b5ce
                stepCounter: 0800d08b-3992-497e-9eb7-c478c017e794
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a608727-cea8-4b40-9699-2bb50b319f44
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYGROUPLEADERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0068929b-444b-4a32-9c88-82432d3d1e01
                stepCounter: 0800d08b-3992-497e-9eb7-c478c017e794
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4248eab6-453a-42b0-825d-9871e349d7fb
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYGROUPLEADERUPN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 41b4ab0c-2344-4d1c-83f0-f304abd386fc
                stepCounter: 0800d08b-3992-497e-9eb7-c478c017e794
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7cb5d64-adde-478b-a8cd-74e665234dda
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: TERRITORY MANAGER NAME
        name: TERRITORYMANAGER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9553e089-2d35-4832-aa6e-90613768edcc
                stepCounter: 0800d08b-3992-497e-9eb7-c478c017e794
            transform: |-
              CASE \N--  WHEN OPC_ACCOUNT.STRATEGICACCOUNTREASON LIKE 'TIER 3%' THEN ''
              \N WHEN EMPLOYEE.EMAIL = 'SHAYNE.CALZAVARA@OMNIAPARTNERS.COM' THEN '' \N WHEN EMPLOYEE.EMAIL = 'DOUG.LOONEY@OMNIAPARTNERS.COM' THEN 'OMNIA PARTNERS SUPPORT' \N ELSE SALESTERRITORY.TERRITORYMANAGER \NEND
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9287d560-1053-4730-bb26-ace26d0776e6
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYMANAGERUPN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ef8c1c4-5949-47bb-a0a7-6b8e627f488a
                stepCounter: 0800d08b-3992-497e-9eb7-c478c017e794
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 19651e21-44bb-475f-9f33-231e567fba46
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: TERRITORY MANAGER EMAIL
        name: TERRITORYMANAGEREMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c83f09a-cb6b-43f5-a0fa-401ce7f8849c
                stepCounter: 37b89a5b-de90-4f57-a466-7ffe5c90f7bf
            transform: |-
              CASE \N--  WHEN OPC_ACCOUNT.STRATEGICACCOUNTREASON LIKE 'TIER 3%'
              \N WHEN EMPLOYEE.EMAIL = 'SHAYNE.CALZAVARA@OMNIAPARTNERS.COM' \N THEN IFF(OPC_ACCOUNT.USPSSTATE = 'TX','ISO.TIER3TX@OMNIAPARTNERS.COM','ISO.TIER3@OMNIAPARTNERS.COM') \N WHEN EMPLOYEE.EMAIL ='DOUG.LOONEY@OMNIAPARTNERS.COM' THEN 'INFO@OMNIAPARTNERS.COM' \N ELSE EMPLOYEE.EMAIL \NEND \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d82ab92-d304-4f0c-b211-c90b6589f981
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: TERRITORY MANAGER OFFICE PHONE NUMBER
        name: TERRITORYMANAGEROFFICEPHONENUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8845efb5-2402-4576-9b2c-2acbc8527e42
                stepCounter: 37b89a5b-de90-4f57-a466-7ffe5c90f7bf
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f34122a5-a18a-4b9f-8f58-39d9a935d498
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: TERRITORY MANAGER MOBILE PHONE NUMBER
        name: TERRITORYMANAGERMOBILEPHONENUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dcc2d524-c00e-4933-a765-556306553fc7
                stepCounter: 37b89a5b-de90-4f57-a466-7ffe5c90f7bf
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1974e65-9331-44a9-907b-e2fdee23d8e1
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE NAME OF THE OMNIA PARTNERS SPD TEAM VP, WHO SUPERVISES A GROUP OF SPD DIRECTORS.
        name: SPDVP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d0d7d242-68da-4b35-b5e0-d906a258df0a
                stepCounter: 8d733483-4c1e-4c52-8f3e-9f99b8022f6d
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "NULL"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c32afd75-bf83-4372-ae0d-2497988a4629
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SPDVPEMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4f4927d9-9473-4d3c-bac1-be9632a65b58
                stepCounter: 8d733483-4c1e-4c52-8f3e-9f99b8022f6d
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "NULL"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 346366bc-8c8c-47ca-9da9-31cb72ab783b
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE NAME OF THE OMNIA PARTNERS SPD TEAM MEMBER RESPONSIBLE FOR MANAGING THE RELATIONSHIP WITH THIS SUPPLIER.
        name: SPDDIRECTOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d1e7548a-c0b4-4948-8ee3-1bf3a9cc8d8e
                stepCounter: 8d733483-4c1e-4c52-8f3e-9f99b8022f6d
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "NULL"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 68240135-d2a8-4114-b69d-23d465fa743b
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SPDDIRECTOREMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 309dfc9e-18d2-4e78-adf8-32b58cb8c519
                stepCounter: 8d733483-4c1e-4c52-8f3e-9f99b8022f6d
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "NULL"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5275be91-a6e0-49a3-bb89-a3aab5e06ca7
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE PREFERRED, CLEANED UP NAME OF THE SUPPLIER. THIS IS THE ONE YOU WANT TO USE FOR REPORTS
        name: REPORTINGSUPPLIERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4bae49f-4046-468f-b6f5-58dbc6854b64
                stepCounter: 8d733483-4c1e-4c52-8f3e-9f99b8022f6d
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "NULL"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0136c969-c5c3-4d61-817c-0ec754242361
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: METROAREANAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 14f286b0-c696-49f8-a99c-ca1be3bd2122
                stepCounter: edd2bdaf-5dbd-4108-bb25-d6c33fdbc711
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 258ad347-e306-4f45-a3e7-3768013520c2
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: ""
        name: METROAREATOTALPOPULATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a955f44e-633b-4769-99b6-644fb67845e2
                stepCounter: edd2bdaf-5dbd-4108-bb25-d6c33fdbc711
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da6e67bd-3a41-4593-8b5b-564526016a58
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: LATITUDE
        name: LAT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce6c5768-9b21-4db2-9b99-546418a33405
                stepCounter: edd2bdaf-5dbd-4108-bb25-d6c33fdbc711
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 829d9f7d-2dcd-40a3-851f-fde1c9f55bc3
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: LONGITUDE
        name: LON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 295eee81-3bc2-4f81-92b5-5f6c7a09ebec
                stepCounter: edd2bdaf-5dbd-4108-bb25-d6c33fdbc711
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc8d2777-563f-4eae-a23c-4461e66800b3
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SECTOR
        name: SECTOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: debbbf75-f6be-4a79-b532-d6862f39034f
                stepCounter: 8c570149-b7fe-4278-931c-6a2e904ce078
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39d029d0-f850-4904-9d5a-fb800f9fac0f
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER ID
        isBusinessKey: true
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "NULL"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b75c8ccb-f6f0-430e-9422-ff04d4e9a9be
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: INT
        defaultValue: ""
        description: NUMBER OF CONTACTS FOR GIVEN LEVEL 1 FORCEID
        name: NUMBEROFCONTACTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c155b6d-1b88-4556-bb75-e0efd302c832
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: PREVIOUS 12 MONTHS SUM OF SALES
        name: PREVIOUS12MONTHS_SUMOFSALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IFNULL(OPC_VWAGGLEVEL1FORCEIDUSAGESTATS_ALL.PREVIOUS12MONTHS_SUMOFSALES,0)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "0"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f3df701-d196-4a13-ac14-b6fe62827894
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: CURRENT 12 MONTHS SUM OF SALES
        name: CURRENT12MONTHS_SUMOFSALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IFNULL(OPC_VWAGGLEVEL1FORCEIDUSAGESTATS_ALL.CURRENT12MONTHS_SUMOFSALES,0)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "0"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 973bc53b-c7f5-4f79-972a-869109c7558f
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: (CURRENT 12 MONTHS SALES) - (PREVIOUS 12 MONTHS SALES)
        name: CURRENT12MONTHS_SALESDIFF
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IFNULL(CURRENT12MONTHS_SUMOFSALES - PREVIOUS12MONTHS_SUMOFSALES,0)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "0"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7a44466-f306-4597-ac0a-7aedc33163c5
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ((CURRENT 12 MONTHS SALES) - (PREVIOUS 12 MONTHS SALES)) / (PREVIOUS 12 MONTHS SALES)
        name: CURRENT12MONTHS_SALESDIFFPERC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IFNULL((CURRENT12MONTHS_SUMOFSALES - PREVIOUS12MONTHS_SUMOFSALES)/NULLIF(PREVIOUS12MONTHS_SUMOFSALES,0),0)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "0"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2aabe6de-d5a8-4d87-b27f-6b0add7bf819
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: INT
        defaultValue: ""
        description: PREVIOUS 12 MONTHS NUMBER OF SUPPLIERS USED
        name: PREVIOUS12MONTHS_NUMOFSUPPLIERSUSED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IFNULL(OPC_AGGLEVEL1_PY_LTM.LEVEL1_PY_LTM_NUMOFSUPPLIERSUSED,0)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ad8907e-4c5e-4c46-adc5-02fd17c08dae
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: INT
        defaultValue: ""
        description: CURRENT 12 MONTHS NUMBER OF SUPPLIERS USED
        name: CURRENT12MONTHS_NUMOFSUPPLIERSUSED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IFNULL(OPC_AGGLEVEL1_LTM.LEVEL1_LTM_NUMOFSUPPLIERSUSED,0)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f87ba925-fd93-4d2c-a828-a79cd01559cf
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: INT
        defaultValue: ""
        description: (CURRENT 12 MONTHS NUMBER OF SUPPLIERS USED) - (PREVIOUS 12 MONTHS NUMBER OF SUPPLIERS USED)
        name: CURRENT12MONTHS_NUMOFSUPPLIERSUSEDDIFF
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ZEROIFNULL(OPC_AGGLEVEL1_LTM.LEVEL1_LTM_NUMOFSUPPLIERSUSED) - ZEROIFNULL(OPC_AGGLEVEL1_PY_LTM.LEVEL1_PY_LTM_NUMOFSUPPLIERSUSED)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6eb6fe56-5680-4390-8d34-ea201cff670e
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ((CURRENT 12 MONTHS NUMBER OF SUPPLIERS USED) - (PREVIOUS 12 MONTHS NUMBER OF SUPPLIERS USED)) / (PREVIOUS 12 MONTHS NUMBER OF SUPPLIERS USED)
        name: CURRENT12MONTHS_NUMOFSUPPLIERSUSEDDIFFPERC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IFNULL((ZEROIFNULL(OPC_AGGLEVEL1_LTM.LEVEL1_LTM_NUMOFSUPPLIERSUSED) - ZEROIFNULL(OPC_AGGLEVEL1_PY_LTM.LEVEL1_PY_LTM_NUMOFSUPPLIERSUSED) \N)/NULLIF(OPC_AGGLEVEL1_PY_LTM.LEVEL1_PY_LTM_NUMOFSUPPLIERSUSED, 0),0)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e05b9f72-0542-46d9-acbe-bdb988434c3d
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: OMNIA ENGAGEMENT SCORE
        name: OMNIA_SCORE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1dae672-eac2-4246-8475-10bc9f90f869
                stepCounter: 7e634189-fddc-4ad8-9b81-584322a613e9
            transform: |-
              CASE COALESCE(OPC_ACCOUNT.STRATEGICACCOUNTREASON,OPC_ACCOUNT.MEMBERSEGMENT) \N --PUBLIC (ACCOUNT.STRATEGICACCOUNTREASON)
              \N WHEN 'MARKET MOVER' THEN '10' \N WHEN 'TIER 1' THEN '10' \N WHEN 'TIER 2' THEN '10' \N --PRIVATE (ACCOUNT.MEMBERSEGMENT)
              \N WHEN 'FORTUNE 1000' THEN '10' \N WHEN 'BULLSEYE' THEN '10' \N --ELSE
              \N ELSE IFNULL(OMNIA_SCORE.OMNIA_SCORE,'STARTER') \NEND
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b2d0906-7f40-4f3e-a723-0cbc36c917ff
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: MAXRECEIPTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 344808c1-28e1-4466-a93c-78597f575b6c
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SIZE BAND CODE
        name: CUSTOMER_SIZE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2e67de50-c9f3-47d0-b624-82bc6d95b3af
                stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
            transform: IFNULL(OPC_ACCOUNT.CUSTOMER_SIZE_CODE,'')
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1317acb-336d-462c-be77-3d95631405ae
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: CUSTOMER SIZE BAND
        name: CUSTOMERSIZEBAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 43d38b3e-2a14-42b1-ad3f-c6051df9b30e
                stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
            transform: IFNULL(OPC_ACCOUNT.CUSTOMER_SIZE_BAND,'UNKNOWN')
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b88677a5-bcd0-4834-afac-2b5c90e6eb09
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: INT
        defaultValue: ""
        description: SIZE BAND NUMBER
        name: CUSTOMER_SIZE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ff1486c1-7e5a-48a4-8c25-15626d9585b0
                stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 686e3947-03c8-4a39-b626-559a398d5a44
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SIGNIFICANT CAPITAL SPEND IN LAST 3 YEARS
        name: SIGNIFICANTCAPITALSPENDINLAST3YEARS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "NULL"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: adffce8d-c56b-4cd7-a208-f1d06024df0d
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        name: WESHARE_PARTICIPANT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78b35ef9-d4e2-4504-929e-4bd43aaf3e04
                stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 530c8c63-013c-46c7-b5a9-bae341634607
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PARTICIPATING_PROGRAM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 745c47ca-9fe5-4f77-9520-446af4c05473
                stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07f1baf0-37e5-4074-87bd-f4f79dee74d1
          stepCounter: df4128b6-d9f9-4307-9f4e-e3f361fcd1ed
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: DENOTES WHETHER THE ROW IS AN ACCOUNT, CHILD ACCOUNT, DUPLICATE, OR DELIVERY LOCATION.
        name: RECORDDESIGNATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00d6bbb2-0866-4de1-b27d-91325a3cd6d5
                stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ACCOUNTGEOGRAPHY: edd2bdaf-5dbd-4108-bb25-d6c33fdbc711
          EMPLOYEE: 37b89a5b-de90-4f57-a466-7ffe5c90f7bf
          OMNIA_SCORE: 7e634189-fddc-4ad8-9b81-584322a613e9
          OPC_ACCOUNT: 36cf5555-b43d-45fa-a452-8b92590b7cdd
          OPC_AGGLEVEL1_LTM: 9c47ff1f-dc0a-4b3a-87d5-0fb07a062c24
          OPC_AGGLEVEL1_PY_LTM: c0a68865-0383-4a1f-83fc-504860e25f42
          OPC_VWAGGLEVEL1FORCEIDUSAGESTATS_ALL: 2ecd0ae4-5b56-4e2c-845a-820341e29409
          OPC_VWAGGLEVEL1FORCEIDUSAGESTATS_LIFETIME_CONTACTS: e3c173d9-41f7-43ec-808a-dc49e7e4bd68
          SALESTERRITORY: 0800d08b-3992-497e-9eb7-c478c017e794
          SECTOR: 8c570149-b7fe-4278-931c-6a2e904ce078
          SUPPLIER: 8d733483-4c1e-4c52-8f3e-9f99b8022f6d
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNTGEOGRAPHY
          - locationName: DIM
            nodeName: EMPLOYEE
          - locationName: DIM
            nodeName: OMNIA_SCORE
          - locationName: DIM
            nodeName: SALESTERRITORY
          - locationName: DIM
            nodeName: SECTOR
          - locationName: DIM
            nodeName: SUPPLIER
          - locationName: OMNIACONNECT.OPC
            nodeName: OPC_ACCOUNT
          - locationName: OMNIA_PARTNERS_CONNECT
            nodeName: OPC_VWAGGLEVEL1FORCEIDUSAGESTATS_LIFETIME_CONTACTS
          - locationName: OMNIA_PARTNERS_CONNECT
            nodeName: OPC_VWAGGLEVEL1FORCEIDUSAGESTATS_ALL
          - locationName: OMNIA_PARTNERS_CONNECT
            nodeName: OPC_AGGLEVEL1_LTM
          - locationName: OMNIA_PARTNERS_CONNECT
            nodeName: OPC_AGGLEVEL1_PY_LTM
        join:
          joinCondition: |-
            FROM {{ ref('OMNIACONNECT.OPC','OPC_ACCOUNT') }} OPC_ACCOUNT
              LEFT JOIN {{ ref('DIM','SECTOR') }} SECTOR
                ON OPC_ACCOUNT.SECTORKEY = SECTOR.SECTORKEY
              LEFT JOIN {{ ref('DIM','ACCOUNTGEOGRAPHY') }} ACCOUNTGEOGRAPHY
                ON OPC_ACCOUNT.ACCOUNTGEOGRAPHYKEY = ACCOUNTGEOGRAPHY.ACCOUNTGEOGRAPHYKEY
              LEFT JOIN {{ ref('DIM','SALESTERRITORY') }} SALESTERRITORY
                ON OPC_ACCOUNT.SALESTERRITORYKEY = SALESTERRITORY.SALESTERRITORYKEY
              LEFT JOIN {{ ref('DIM','EMPLOYEE') }} EMPLOYEE
                ON SALESTERRITORY.TERRITORYMANAGERUPN = EMPLOYEE.USERPRINCIPALNAME
              LEFT JOIN {{ ref('OMNIA_PARTNERS_CONNECT','OPC_VWAGGLEVEL1FORCEIDUSAGESTATS_LIFETIME_CONTACTS') }} OPC_VWAGGLEVEL1FORCEIDUSAGESTATS_LIFETIME_CONTACTS
                ON OPC_ACCOUNT.LEVEL1FORCEID = OPC_VWAGGLEVEL1FORCEIDUSAGESTATS_LIFETIME_CONTACTS.FORCEID
              LEFT JOIN {{ ref('OMNIA_PARTNERS_CONNECT','OPC_VWAGGLEVEL1FORCEIDUSAGESTATS_ALL') }} OPC_VWAGGLEVEL1FORCEIDUSAGESTATS_ALL
                ON OPC_ACCOUNT.LEVEL1FORCEID = OPC_VWAGGLEVEL1FORCEIDUSAGESTATS_ALL.LEVEL1FORCEID
              LEFT JOIN {{ ref('DIM','OMNIA_SCORE') }} OMNIA_SCORE
                ON OPC_ACCOUNT.ACCOUNTKEY = OMNIA_SCORE.ACCOUNTKEY
              LEFT JOIN {{ ref('OMNIA_PARTNERS_CONNECT','OPC_AGGLEVEL1_LTM') }} OPC_AGGLEVEL1_LTM
                ON OPC_ACCOUNT.LEVEL1FORCEID = OPC_AGGLEVEL1_LTM.LEVEL1FORCEID
              LEFT JOIN {{ ref('OMNIA_PARTNERS_CONNECT','OPC_AGGLEVEL1_PY_LTM') }} OPC_AGGLEVEL1_PY_LTM
                ON OPC_ACCOUNT.LEVEL1FORCEID = OPC_AGGLEVEL1_PY_LTM.LEVEL1FORCEID
              LEFT JOIN {{ ref('DIM','SUPPLIER') }} SUPPLIER
                ON OPC_VWAGGLEVEL1FORCEIDUSAGESTATS_ALL.SUPPLIERID = SUPPLIER.SUPPLIERID
             WHERE OPC_ACCOUNT.RECORDDESIGNATION = 'ACCOUNT'
                OR (OPC_ACCOUNT.RECORDDESIGNATION = 'PROSPECT' AND OPC_ACCOUNT.PARTICIPATING_PROGRAM = 'CLUB 25 AGENCY')
        name: SRC_OPC_LEVEL1CUSTOMERSEARCH_1_SUPPLIERID
        noLinkRefs: []
  name: OPC_LEVEL1CUSTOMERSEARCH
  overrideSQL: false
  schema: ""
  sqlType: "390"
  type: sql
  version: 1
type: Node
