fileVersion: 1
id: bec6cc65-d2b8-4b6a-aadd-eaa03158629d
name: VIEW_PVIEW_VRL_UNIT_REMARKS_MERGED_VW
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 196c86d3-44e9-4bf0-9302-a6bb9d80a796
          stepCounter: bec6cc65-d2b8-4b6a-aadd-eaa03158629d
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: UNIT_IDREC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 196c86d3-44e9-4bf0-9302-a6bb9d80a796
                stepCounter: bec6cc65-d2b8-4b6a-aadd-eaa03158629d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: deec4c2e-44b0-46fb-b1b3-052f5a7b4cda
          stepCounter: bec6cc65-d2b8-4b6a-aadd-eaa03158629d
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: deec4c2e-44b0-46fb-b1b3-052f5a7b4cda
                stepCounter: bec6cc65-d2b8-4b6a-aadd-eaa03158629d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6671b6b9-1cf1-432b-b8d0-5b0baf1e4f23
          stepCounter: bec6cc65-d2b8-4b6a-aadd-eaa03158629d
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: COM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6671b6b9-1cf1-432b-b8d0-5b0baf1e4f23
                stepCounter: bec6cc65-d2b8-4b6a-aadd-eaa03158629d
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_PVIEW_VRL_UNIT_REMARKS_MERGED_VW: bec6cc65-d2b8-4b6a-aadd-eaa03158629d
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_PVIEW_VRL_UNIT_REMARKS_MERGED_VW') }} AS SELECT rr.idrecparent unit_idrec,
                   rr.dttm,
                   SUBSTR(LISTAGG(r.com,', '),1,9999) AS com
              FROM EDW.DS_PRODVIEW.PVT_pvunitremark rr
             INNER JOIN EDW.DS_PRODVIEW.PVT_pvunitremark r
                ON (rr.idrecparent = r.idrecparent AND rr.dttm = r.dttm)
             GROUP BY rr.idrecparent,
                      rr.dttm
        dependencies: []
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref_no_link('TARGET','VIEW_PVIEW_VRL_UNIT_REMARKS_MERGED_VW') }}
        name: VIEW_PVIEW_VRL_UNIT_REMARKS_MERGED_VW
        noLinkRefs:
          - locationName: TARGET
            nodeName: VIEW_PVIEW_VRL_UNIT_REMARKS_MERGED_VW
  name: VIEW_PVIEW_VRL_UNIT_REMARKS_MERGED_VW
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
