fileVersion: 1
id: d3bb075f-6876-4033-9918-0cb6a950552c
name: STAGE_FIN_SAP_COST_CENTER_ECON_ATTR
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be0f4123-463d-48f4-bc9f-dfa12ae0a64a
          stepCounter: d3bb075f-6876-4033-9918-0cb6a950552c
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: UNION SOURCE
        isBusinessKey: true
        name: SOURCE
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: "'CDM_ECONOMICS'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 248abb9a-182b-4ee7-8889-c64fb3635a97
          stepCounter: d3bb075f-6876-4033-9918-0cb6a950552c
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4f345ae8-3b59-46e1-a6d3-098448fcfe07
                stepCounter: 8f4f3d1c-46d5-481b-96bb-c3eef002c08c
            transform: NULLIF(TRIM(LTRIM(TARGET.CC,'0'),' '),'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17ba3303-f8a9-4b95-a02c-0d0cc1141244
          stepCounter: d3bb075f-6876-4033-9918-0cb6a950552c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Number CC_NUM rows ordered by Status Date Descending
        name: CC_OCCURRENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ROW_NUMBER() OVER (PARTITION BY TARGET.CC ORDER BY TARGET.VOLUME_YEAR ASC, TARGET.CAPITAL_YEAR ASC, TARGET.BUDGET_YEAR ASC, TARGET.PRODUCTION_ENGINEER DESC, TARGET.EXPLOITATION_ENGINEER DESC, TARGET.PLAY DESC, TARGET.WELL_COUNT_YEAR DESC, TARGET.RIG_RELEASE_DATE DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e534d4ef-42f0-424c-beb1-2c5481a45902
          stepCounter: d3bb075f-6876-4033-9918-0cb6a950552c
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: BUDGET_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2efb83f4-257b-49e6-aa75-e02cfa77807d
                stepCounter: 8f4f3d1c-46d5-481b-96bb-c3eef002c08c
            transform: TARGET.BUDGET_YEAR
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 76f4c031-bf51-4f09-8d81-082c8c7a4453
          stepCounter: d3bb075f-6876-4033-9918-0cb6a950552c
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: CAPITAL_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ddc7c40-c894-4b17-8342-b85ba7bdacfb
                stepCounter: 8f4f3d1c-46d5-481b-96bb-c3eef002c08c
            transform: TARGET.CAPITAL_YEAR
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a897687-842a-4f6d-a807-e0e94cfd5e18
          stepCounter: d3bb075f-6876-4033-9918-0cb6a950552c
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: VOLUME_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: abf2efac-c380-4a77-bfb0-7d2a048a5477
                stepCounter: 8f4f3d1c-46d5-481b-96bb-c3eef002c08c
            transform: TARGET.VOLUME_YEAR
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e315c793-5589-4f76-91c1-c2e87270f2c5
          stepCounter: d3bb075f-6876-4033-9918-0cb6a950552c
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: PRODUCTION_ENGINEER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9165cf0b-d218-4039-8a67-6eccd9c3bfdf
                stepCounter: 8f4f3d1c-46d5-481b-96bb-c3eef002c08c
            transform: TARGET.PRODUCTION_ENGINEER
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98fc03f4-3544-46e6-b20a-8c039938a8b0
          stepCounter: d3bb075f-6876-4033-9918-0cb6a950552c
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: EXPLOITATION_ENGINEER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39be7c38-7ad3-4418-a29c-39b63534af2a
                stepCounter: 8f4f3d1c-46d5-481b-96bb-c3eef002c08c
            transform: TARGET.EXPLOITATION_ENGINEER
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1b57f6c-5099-4c05-b199-50d3642547e7
          stepCounter: d3bb075f-6876-4033-9918-0cb6a950552c
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: PLAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 13e10819-7fe0-42d9-86c9-2c04a80a31c8
                stepCounter: 8f4f3d1c-46d5-481b-96bb-c3eef002c08c
            transform: TARGET.PLAY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ff5d0f4-9ab7-495a-a6ac-5896602ec40e
          stepCounter: d3bb075f-6876-4033-9918-0cb6a950552c
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: WELL_COUNT_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 68c58977-47c7-4e44-a43e-22c7371a65e9
                stepCounter: 8f4f3d1c-46d5-481b-96bb-c3eef002c08c
            transform: TARGET.WELL_COUNT_YEAR
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ea31901-3ca5-4d45-856f-3714a0f89461
          stepCounter: d3bb075f-6876-4033-9918-0cb6a950552c
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: RIG_RELEASE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8bbe2149-9fcf-40f4-8dd4-03a52e06f305
                stepCounter: 8f4f3d1c-46d5-481b-96bb-c3eef002c08c
            transform: TARGET.RIG_RELEASE_DATE
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_MOSAIC_CDM_ECONOMICS: 8f4f3d1c-46d5-481b-96bb-c3eef002c08c
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: VIEW_MOSAIC_CDM_ECONOMICS
        join:
          joinCondition: |-
            FROM (
                    SELECT DISTINCT NULLIF(TRIM(LTRIM(CC,'0'),' '),'') AS CC,
                           BUDGET_YEAR,
                           CAPITAL_YEAR,
                           VOLUME_YEAR,
                           PRODUCTION_ENGINEER,
                           EXPLOITATION_ENGINEER,
                           PLAY,
                           WELL_COUNT_YEAR,
                           RIG_RELEASE_DATE
                      FROM {{ ref('TARGET','VIEW_MOSAIC_CDM_ECONOMICS') }} VIEW_MOSAIC_CDM_ECONOMICS
                     WHERE VIEW_MOSAIC_CDM_ECONOMICS.ENTITY_STATE_ID = 0
                   ) AS TARGET
        name: STAGE_FIN_SAP_COST_CENTER_ECON_ATTR
        noLinkRefs: []
  name: STAGE_FIN_SAP_COST_CENTER_ECON_ATTR
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
