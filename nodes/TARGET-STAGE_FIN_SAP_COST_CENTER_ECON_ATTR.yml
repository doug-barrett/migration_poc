fileVersion: 1
id: 4862a13d-6a3e-4e2c-a822-ee9a20721bbf
name: STAGE_FIN_SAP_COST_CENTER_ECON_ATTR
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d26a81e3-825f-4750-a35f-f324b2041155
          stepCounter: 4862a13d-6a3e-4e2c-a822-ee9a20721bbf
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: UNION SOURCE
        isBusinessKey: true
        name: SOURCE
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: "'CDM_ECONOMICS'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c19d113-ec16-46d6-8d5a-3f6978f8c92d
          stepCounter: 4862a13d-6a3e-4e2c-a822-ee9a20721bbf
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64e966a7-6d4f-474d-866f-2d3927d14bee
                stepCounter: 6a153077-f654-4dcf-a1a5-284b17fb227d
            transform: NULLIF(TRIM(LTRIM(TARGET.CC,'0'),' '),'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d073c707-707d-4ccf-8a1f-733c38eff872
          stepCounter: 4862a13d-6a3e-4e2c-a822-ee9a20721bbf
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Number CC_NUM rows ordered by Status Date Descending
        name: CC_OCCURRENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ROW_NUMBER() OVER (PARTITION BY TARGET.CC ORDER BY TARGET.VOLUME_YEAR ASC, TARGET.CAPITAL_YEAR ASC, TARGET.BUDGET_YEAR ASC, TARGET.PRODUCTION_ENGINEER DESC, TARGET.EXPLOITATION_ENGINEER DESC, TARGET.PLAY DESC, TARGET.WELL_COUNT_YEAR DESC, TARGET.RIG_RELEASE_DATE DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f53775e-de2e-4a56-a638-b56f370f0c04
          stepCounter: 4862a13d-6a3e-4e2c-a822-ee9a20721bbf
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: BUDGET_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d9837c6-c4b4-4695-94f1-0ef8fff2ed5b
                stepCounter: 6a153077-f654-4dcf-a1a5-284b17fb227d
            transform: TARGET.BUDGET_YEAR
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17813c13-3dcb-4a90-8814-b87a6a9b3c42
          stepCounter: 4862a13d-6a3e-4e2c-a822-ee9a20721bbf
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: CAPITAL_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 248cce17-e264-41bb-b649-d2bb01797e23
                stepCounter: 6a153077-f654-4dcf-a1a5-284b17fb227d
            transform: TARGET.CAPITAL_YEAR
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 08aa4b17-6731-4e4a-bb01-9816682c7671
          stepCounter: 4862a13d-6a3e-4e2c-a822-ee9a20721bbf
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: VOLUME_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4b30daa-f1db-431c-8340-ab447482e224
                stepCounter: 6a153077-f654-4dcf-a1a5-284b17fb227d
            transform: TARGET.VOLUME_YEAR
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ecce4c3-3d0e-4c26-94f2-d69576c525ca
          stepCounter: 4862a13d-6a3e-4e2c-a822-ee9a20721bbf
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: PRODUCTION_ENGINEER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3c522ef-1481-4581-b12a-b8daf5470f2d
                stepCounter: 6a153077-f654-4dcf-a1a5-284b17fb227d
            transform: TARGET.PRODUCTION_ENGINEER
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f55c389-8624-4c8f-8481-8f641b75e3aa
          stepCounter: 4862a13d-6a3e-4e2c-a822-ee9a20721bbf
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: EXPLOITATION_ENGINEER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 596f91a9-d24f-462c-a2d3-84491bb25adf
                stepCounter: 6a153077-f654-4dcf-a1a5-284b17fb227d
            transform: TARGET.EXPLOITATION_ENGINEER
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8358a8c1-fca3-465e-b7d2-b69d888aa73a
          stepCounter: 4862a13d-6a3e-4e2c-a822-ee9a20721bbf
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: PLAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4eb9c53e-6e3f-4ca9-9042-7b429e0fcc33
                stepCounter: 6a153077-f654-4dcf-a1a5-284b17fb227d
            transform: TARGET.PLAY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f8d93d5-171b-490e-b17a-140e86932e16
          stepCounter: 4862a13d-6a3e-4e2c-a822-ee9a20721bbf
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: WELL_COUNT_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56011270-83d1-4673-86b5-1ca90b0f23a6
                stepCounter: 6a153077-f654-4dcf-a1a5-284b17fb227d
            transform: TARGET.WELL_COUNT_YEAR
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1db59e4-9152-4444-b03a-5f3bf9dd6fe5
          stepCounter: 4862a13d-6a3e-4e2c-a822-ee9a20721bbf
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: RIG_RELEASE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c495a34-9a84-4085-b1d0-c0cebd6be636
                stepCounter: 6a153077-f654-4dcf-a1a5-284b17fb227d
            transform: TARGET.RIG_RELEASE_DATE
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_MOSAIC_CDM_ECONOMICS: 6a153077-f654-4dcf-a1a5-284b17fb227d
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: VIEW_MOSAIC_CDM_ECONOMICS
        join:
          joinCondition: |-
            FROM (
                    SELECT DISTINCT NULLIF(TRIM(LTRIM(CC,'0'),' '),'') AS CC,
                           BUDGET_YEAR,
                           CAPITAL_YEAR,
                           VOLUME_YEAR,
                           PRODUCTION_ENGINEER,
                           EXPLOITATION_ENGINEER,
                           PLAY,
                           WELL_COUNT_YEAR,
                           RIG_RELEASE_DATE
                      FROM {{ ref('TARGET','VIEW_MOSAIC_CDM_ECONOMICS') }} VIEW_MOSAIC_CDM_ECONOMICS
                     WHERE VIEW_MOSAIC_CDM_ECONOMICS.ENTITY_STATE_ID = 0
                   ) AS TARGET
        name: STAGE_FIN_SAP_COST_CENTER_ECON_ATTR
        noLinkRefs: []
  name: STAGE_FIN_SAP_COST_CENTER_ECON_ATTR
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
