fileVersion: 1
id: 6b68a643-c103-486c-a9f9-377fcb9a9439
name: VIEW_PWRANALYTICS_USBU_POWERALLOCATION_MTH
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e831d4ef-943b-46a3-a694-a108cb1b8b25
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: VARCHAR(13)
        defaultValue: ""
        description: ""
        name: COUNTRY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 551f9a67-3d0a-4308-8da6-2c872317607b
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6b5f32b-f4b1-403d-a820-51f4cccfef3b
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: VARCHAR(12)
        defaultValue: ""
        description: ""
        name: PROVINCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d34a6f6-0a3e-4ca5-b097-b36f860c667a
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57e82550-ac33-4bcf-9df3-91cd959bc28c
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: VARCHAR(14)
        defaultValue: ""
        description: ""
        name: LANGUAGE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d9ff86e3-9b52-456f-8d68-728597308eb3
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 826682e0-c29a-4209-9af1-4eb6a60109d6
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: CURRENCY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 43c724ed-fff6-48c7-ae2c-3b5ddee88deb
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e93aa9d-0b20-41fb-a176-df76295569de
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: VARCHAR(24)
        defaultValue: ""
        description: ""
        name: UTILITY_PROVIDER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ebe2ef39-6f47-46f3-81b2-74c57ad76e3a
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c32777bd-e325-4632-bb8d-cb5c4ccc1e9f
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: NUMBER(38,0)
        defaultValue: ""
        description: ""
        name: INVOICE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a902f4d7-62cd-473d-bbe3-8931852772d4
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 691e75bb-0f97-4d3f-90b1-fef97c479a74
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: ACCOUNT_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3e91efb-6ec0-4569-b119-033fb4e4721a
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 058530a2-52c1-4f3e-a775-4ecf8f0fc105
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: DELIVERY_POINT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51e8d3ad-9d54-4599-a4f9-99a75e33923b
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 19c15ad0-9617-49cb-acaf-f93fe457cea1
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: CONSUMPTION_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3df7eb8-8e35-4b14-81ca-1be68ec9404b
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae006ade-ed4b-4bf0-8dee-058ffe4ee552
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: METER_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33c8515b-de83-4168-ad80-c2fc9c50172a
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 99975537-da3b-4027-a8d5-d9a51eeb453f
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: COST_CENTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ab53299-259b-4928-b0c2-dab7fb86f9a7
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f96daea6-b82b-40a4-95d8-db251e1d3529
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CC_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 861b27d3-feeb-4ead-b658-2fabdcfcb379
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CORE_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ebd74fd5-e542-430a-ae36-9c63be70d682
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5c74d3a-d7d9-4960-983e-db91fb538068
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f436a2dd-c32a-4bb1-b104-c3562539602d
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: TOTAL_CONSUMPTION_KWH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5f28d0f-a40a-44fc-a596-6181b3950041
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 149f108a-5e15-486c-9aeb-9ed930bdcd38
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PEAK_CONSUMPTION_KWH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2fbee53c-3df1-45ea-ac33-7d167009271a
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 545acd1b-8dbd-4921-9287-bdb81e6ec5d4
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OFF_PEAK_CONSUMPTION_KWH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50ab3767-a40c-45b0-b64c-8b10f24c65df
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f1275288-6a10-4dca-8271-48c7a6144a07
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: REGISTERED_DEMAND_KVA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e4ad9561-afaf-4f35-b2f5-d791d2aea243
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86212956-9705-42d6-9288-7195c28dcf4b
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BILLED_DEMAND_KVA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2b416c4b-2762-432d-bbc8-e3d7f5d29446
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c1c12f1-855d-4d4c-aa65-7d0db9dd3dd9
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CURRENT_METER_READ_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 57159ea2-95bc-4567-a6af-f8d8e3901cdc
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 68ca2326-aec4-477a-be06-83c710bdc8c6
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: CURRENT_METER_READ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9ebb5afe-e9e6-4322-b028-cb62db41a8df
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c940df36-af34-42fe-a1cc-6166810c2044
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: PREVIOUS_METER_READ_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eea745f5-fedf-46e2-b5bf-c70c86e62e60
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09baee90-bddd-4af7-86d9-544c3d82fe99
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PREVIOUS_METER_READ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc5d994d-bdf2-4740-a17b-786534bd35cf
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5768eac4-7bb9-4d78-91bd-37bd75725148
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: TOTAL_AMOUNT_DUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 10f9a403-baf1-40e6-84d8-ff0972bee74a
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5b68c40-6c1d-4091-a063-22566b44c890
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: SUBTOTAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b12196d2-2e5a-49a9-836f-936508f2b3a2
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b2e4e65-8222-44a9-9a2f-e95a16fc227e
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: ENERGY_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47e97593-b106-4d8a-8196-b85b365245a4
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d0d4586f-df30-4d31-a1ea-84fb0f44c531
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PEAK_ENERGY_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ea5b4eb-1d80-404e-b698-1ea010245a80
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 93144872-7901-428d-8d18-c25d8e55ff56
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OFF_PEAK_ENERGY_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 73c890a4-2f50-4c2b-948e-a34b5627393e
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a002101-94be-43fd-a4fb-1613d1a6e539
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BASIC_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d0b46c7b-4c29-46f6-a9dd-506c0990b0b4
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9666ab8-ceb7-4c8f-aac0-cff790c14108
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: DEMAND_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 308df3ee-a506-4fef-a6eb-b268045802b4
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e25f627f-ff8b-4ee8-a7d2-2a03a366d40c
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: REACTIVE_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b24f9e44-d123-4115-af96-0ddb3e0aa6ab
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7107102a-cbe3-4f9a-8b82-5ae623b88fb5
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: TRANSMISSION_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f35e291-cba0-4245-a0a6-e70f74bdf89d
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 145d89f5-b351-48b7-a505-12ec23b38e78
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OTHER_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 31faba84-0aae-4753-9d49-2d33c2c2dc56
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb86f251-6de6-43e8-928c-c95c5f5b31ab
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: SERVICE_ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 968a0c92-58fa-4dc2-b08e-34733ca91cea
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53f94523-d483-49b6-899a-2e13e5263984
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: CARBON_TAX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ecad125-b597-4621-b72d-d824fa8e2124
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0bfdbafc-7486-4039-9f00-6643d04e8b5e
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: CARBON_TAX_GST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02769d7f-4192-46e6-90a2-154b3bc98685
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a583a27-445e-41a9-bda8-5740d24a659e
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: FEDERAL_TAX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9e915cf-86ba-4a95-8f4f-d2f6c4532f2c
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5041cae6-8c60-4efe-b768-10038d99fad5
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f0502bc-32e6-4ba3-8b7e-2e9be769f239
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: MST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9bf96de8-be78-45fb-bbc5-54516b9edc10
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5327d83-83fa-4b11-b45d-7664c42d3416
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: VAT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2eb6d102-7f58-4704-bdc9-1b85f6a974ed
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f96eb7c-ea41-4221-9405-1e90d5f5ffd0
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: METER_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 021a816a-7e41-4b8e-b675-5748aaba72fe
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9ab4f1b-5c24-4475-b702-601064f147d1
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BILL_MULTIPLIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 778179fe-76e2-4483-bb9e-b17b8fc5d6b7
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e478a5c2-a64f-49b5-9c28-1a88262281dc
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8165284a-362e-49e1-8f03-856a3bd31cea
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 504cfed2-10e9-4f30-9bf4-0b26d4e07919
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: POWER_FACTOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7977c21-7309-4841-8a55-a7de137c4f09
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ad6d1e3-5b37-4f6b-a193-1a7be4dab4b4
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PEAK_DEMAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 952e6ba9-dc92-4704-815b-8c6afb059cb1
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6672ebd0-36fc-415c-a122-33b9b9485a42
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BILL_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33da730e-1876-4932-b6b7-c5a972caed42
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de76dee7-7cd7-4940-874d-320a7abbf5f1
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 104ff53e-5107-4ec3-9dec-73b7e19d6a73
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PROD_YEARMONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: efc9f3f9-715c-497e-9aea-a37b0df7deea
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: WELL_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06f7f346-8e48-4703-8b94-7e6f5d0519ff
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: FOREMAN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24e1e25c-7f0c-4bf0-b510-329ed50c821d
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: BATTERY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 58fa674e-5d34-4ace-9c68-6ba1f952c6fc
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f8096df7-b7ce-4baf-ae46-b22c1ac32393
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: WELL_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ff36dd1-5fe4-498d-a4af-f428a55f2735
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: RUN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 65ebc8c4-c74b-4646-9b8c-f5e2e8dce580
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: SURFACE_LOCATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d19f9d1-d4a6-40b2-ac19-44f7fd431c45
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: SURFACE_LATITUDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d083282e-dd44-4426-bf70-ad69716bec2d
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: SURFACE_LONGITUDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18ebd77e-098c-4217-b9d0-8f86569f7653
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OPERATING_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3893ff05-e940-474a-8f25-4e6dcb5d0100
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: DOWNTIME_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55aa9734-1fa8-468d-af38-5d66f68665f7
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OIL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd75375e-0979-4cfa-b8f8-5a807b3fe72b
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: WATER_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 279a693a-33aa-4b65-9a53-e34a633f8829
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: GAS_E3M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9742fab9-04ca-4254-a6c2-764b1349e22f
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OIL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e37d318-cc4c-483c-baf7-2e16b971429a
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: GAS_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fca4e815-dbc2-4d85-9305-b820e70250ce
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da2943e1-e3a7-48f1-bdda-e53d415c8d02
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: FACILITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce331f12-8e14-4eee-8cb0-7716392896ae
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: WORKING_INTEREST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4cd0b039-9250-400e-9dee-251b73f38522
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: PUMP_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6715240-fea9-4d63-bf10-bdbd36f4c6c3
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03fd97d5-7216-42b4-90b5-94c65dcde4c9
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: TOTAL_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3350aa71-6960-4edf-b64b-b573abda171c
          stepCounter: 6b68a643-c103-486c-a9f9-377fcb9a9439
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: NORM_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_PWRANALYTICS_USBU_POWERALLOCATION_MTH: 6b68a643-c103-486c-a9f9-377fcb9a9439
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_PWRANALYTICS_USBU_POWERALLOCATION_MTH') }} AS WITH MJ AS (
                    SELECT *
                      FROM (
                            SELECT DISTINCT(WELL_NAME),
                                   CHILD_ACCOUNT_NUMBER ,
                                   METER_NUMBER,
                                   CC_NUM ,
                                   AREA,
                                   CORE_AREA ,
                                   PROVINCE,
                                   FACILITY ,
                                   FOREMAN,
                                   RUN_NAME ,
                                   BATTERY,
                                   'ProdView' AS SOURCE
                              FROM WS_EDW.VIEW_FDC_PWRANALYTICS PV
                             WHERE COUNTRY = 'UNITED STATES'
                           ) MJ3
                     CROSS JOIN DS_POWER.VET_DIMDATE M
                     WHERE Year(Date) >= 2021
                       AND Year(Date) <= Year(GetDate())
                   ),
                   PV_AGG_A AS (
                    SELECT MJ.CHILD_ACCOUNT_NUMBER ,
                           MJ.DATE ,
                           Sum(IFNULL(PV.WATER_M3,0)) + Sum(IFNULL(PV.OIL_M3,0)) AS BOE ,
                           count(*) AS WELL_COUNT ,
                           1.00/Count(*) AS WELLCOUNT_PRORATION
                      FROM MJ
                      LEFT OUTER JOIN WS_EDW.VIEW_FDC_PWRANALYTICS PV
                        ON MJ.Well_Name = PV.WELL_NAME
                       AND MJ.Date = LAST_DAY(DATE(concat(SUBSTRING(cast(Prod_YEARMONTH AS varchar),1,4), '-', SUBSTRING(cast(Prod_YEARMONTH AS varchar),5,2), '-01')))
                     GROUP BY MJ.CHILD_ACCOUNT_NUMBER,
                              MJ.Date
                   ),
                   PV AS (
                    SELECT MJ.WELL_NAME,
                           PV_W.UWI ,
                           IFNULL(PV_W.CC_NUM,MJ.CC_NUM) AS CC_NUM,
                           PV_W.CC_NAME ,
                           IFNULL(MJ.PROVINCE,PV_W.PROVINCE) AS Province,
                           IFNULL(MJ.CORE_AREA,PV_W.CORE_AREA) AS CORE_AREA ,
                           IFNULL(MJ.AREA,PV_W.AREA) AS Area,
                           IFNULL(MJ.FOREMAN,PV_W.FOREMAN) AS FOREMAN ,
                           IFNULL(PV_W.RUN_NAME,MJ.RUN_NAME) AS RUN_NAME,
                           IFNULL(MJ.FACILITY,PV_W.FACILITY) AS FACILITY ,
                           IFNULL(PV_W.BATTERY,MJ.Battery) AS BATTERY,
                           PV_W.WELL_TYPE ,
                           PV_W.SURFACE_LOCATION,
                           PV_W.SURFACE_LATITUDE ,
                           PV_W.SURFACE_LONGITUDE,
                           PV_W.OPERATING_HOURS ,
                           PV_W.DOWNTIME_HOURS,
                           PV_W.ON_PROD_DATE ,
                           PV_W.LAST_PROD_DATE,
                           PV_W.PROD_YEAR ,
                           PV_W.PROD_MONTH,
                           PV_W.PROD_YEARMONTH ,
                           PV_W.WORKING_INTEREST,
                           PV_W.PUMP_TYPE ,
                           PV_W.METER_NUMBER,
                           MJ.CHILD_ACCOUNT_NUMBER AS CHILD_ACCOUNT_NUMBER ,
                           MJ.Date AS EoProdMonth,
                           (DATEFROMPARTS(year(MJ.Date), MONTH (MJ.Date), 01)) AS FOM ,
                           IFNULL(PV_W.WATER_M3,0) AS WATER_M3,
                           IFNULL(PV_W.OIL_M3,0) AS OIL_M3 ,
                           PV_W.GAS_E3M3,
                           PV_W.OIL_BOE ,
                           PV_W.GAS_BOE,
                           IFNULL(PV_W.BOE,0) AS BOE ,
                           IFNULL(PV_AGG_A.BOE,0) AS TOTALBOE,
                           PV_AGG_A.WELL_COUNT AS PV_WELL_COUNT ,
                           PV_AGG_A.WELL_COUNT AS MJ_WELL_COUNT,
                           PV_AGG_A.WELLCOUNT_PRORATION ,
                           SOURCE ,
                           CASE WHEN PV_AGG_A.BOE = 0                                          THEN 1.00/PV_AGG_A.WELL_COUNT
                                WHEN PV_AGG_A.BOE IS NULL AND 1.00/PV_AGG_A.WELL_COUNT IS NULL THEN 1.00
                                ELSE (PV_W.WATER_M3+PV_W.OIL_M3)/PV_AGG_A.BOE
                                 END AS PRORATION_BOE ,
                           CASE WHEN (PV_AGG_A.BOE = 0 AND PV_AGG_A.WELL_COUNT >= 1) OR ((PV_W.WATER_M3+PV_W.OIL_M3) = 0 AND PV_AGG_A.BOE = 0 AND PV_AGG_A.WELL_COUNT > 1) THEN 1.00/PV_AGG_A.WELL_COUNT
                                ELSE (PV_W.WATER_M3+PV_W.OIL_M3)/PV_AGG_A.BOE
                                 END AS WELL_PRORATION
                      FROM MJ
                      LEFT JOIN WS_EDW.VIEW_FDC_PWRANALYTICS PV_W
                        ON MJ.Well_Name = PV_W.WELL_NAME
                       AND MJ.Date = LAST_DAY(DATE(concat(SUBSTRING(cast(PV_W.Prod_YEARMONTH AS varchar),1,4), '-', SUBSTRING(cast(PV_W.Prod_YEARMONTH AS varchar),5,2), '-01')))
                      LEFT JOIN PV_AGG_A
                        ON MJ.CHILD_ACCOUNT_NUMBER = PV_AGG_A.CHILD_ACCOUNT_NUMBER
                       AND MJ.Date = PV_AGG_A.Date
                   ),
                   Fin AS(
                    SELECT PB.COUNTRY ,
                           PB.PROVINCE ,
                           PB.LANGUAGE ,
                           PB.CURRENCY ,
                           UTILITY_PROVIDER,
                           INVOICE_NUMBER ,
                           ACCOUNT_NUMBER ,
                           PB.DELIVERY_POINT ,
                           CONSUMPTION_MONTH,
                           PB.METER_NUMBER AS METER_NUMBER ,
                           COST_CENTER ,
                           PV.CC_NAME AS CC_NAME ,
                           PV.CORE_AREA AS CORE_AREA ,
                           PV.AREA ,
                           IFNULL(WELL_PRORATION,0) * TOTAL_CONSUMPTION_KWH AS TOTAL_CONSUMPTION_KWH ,
                           IFNULL(WELL_PRORATION,0) *PEAK_CONSUMPTION_KWH AS PEAK_CONSUMPTION_KWH ,
                           IFNULL(WELL_PRORATION,0) *OFF_PEAK_CONSUMPTION_KWH AS OFF_PEAK_CONSUMPTION_KWH ,
                           IFNULL(WELL_PRORATION,0) *REGISTERED_DEMAND_KVA AS REGISTERED_DEMAND_KVA ,
                           IFNULL(WELL_PRORATION,0) *BILLED_DEMAND_KVA AS BILLED_DEMAND_KVA ,
                           CURRENT_METER_READ_DATE ,
                           CURRENT_METER_READ ,
                           PREVIOUS_METER_READ_DATE ,
                           PREVIOUS_METER_READ ,
                           IFNULL(WELL_PRORATION,0) * TOTAL_AMOUNT_DUE AS TOTAL_AMOUNT_DUE ,
                           IFNULL(WELL_PRORATION,0) *SUBTOTAL AS SUBTOTAL ,
                           IFNULL(WELL_PRORATION,0) *ENERGY_COST AS ENERGY_COST ,
                           IFNULL(WELL_PRORATION,0) *PEAK_ENERGY_COST AS PEAK_ENERGY_COST ,
                           IFNULL(WELL_PRORATION,0) *OFF_PEAK_ENERGY_COST AS OFF_PEAK_ENERGY_COST ,
                           BASIC_COST/PV.MJ_WELL_COUNT AS BASIC_COST ,
                           IFNULL(WELL_PRORATION,0) *DEMAND_COST AS DEMAND_COST ,
                           IFNULL(WELL_PRORATION,0) * REACTIVE_COST AS REACTIVE_COST ,
                           IFNULL(WELL_PRORATION,0) * TRANSMISSION_COST AS TRANSMISSION_COST ,
                           IFNULL(WELL_PRORATION,0) * OTHER_COST AS OTHER_COST ,
                           SERVICE_ADDRESS ,
                           IFNULL(WELL_PRORATION,0) *CARBON_TAX AS CARBON_TAX ,
                           IFNULL(WELL_PRORATION,0) *CARBON_TAX_GST AS CARBON_TAX_GST ,
                           IFNULL(WELL_PRORATION,0) * FEDERAL_TAX_GST AS FEDERAL_TAX ,
                           IFNULL(WELL_PRORATION,0) *PST AS PST ,
                           IFNULL(WELL_PRORATION,0) *MST AS MST ,
                           IFNULL(WELL_PRORATION,0) *VAT AS VAT ,
                           CAST(METER_TYPE AS VARCHAR) AS METER_TYPE ,
                           BILL_MULTIPLIER ,
                           RATE ,
                           POWER_FACTOR ,
                           PEAK_DEMAND ,
                           BILL_DAYS ----- Prodview ---------
             ,
                           PV.CC_NUM AS CC_NUM ,
                           PV.PROD_YEARMONTH ,
                           PV.Well_Name AS WELL_NAME,
                           CASE WHEN PV.FOREMAN IS NULL THEN PV.FOREMAN
                                ELSE PV.FOREMAN
                                 END AS FOREMAN ,
                           PV.RUN_NAME ,
                           BATTERY ,
                           UWI ,
                           WELL_TYPE ,
                           PV.SURFACE_LOCATION ,
                           PV.SURFACE_LATITUDE ,
                           PV.SURFACE_LONGITUDE ,
                           PV.OPERATING_HOURS ,
                           PV.DOWNTIME_HOURS ,
                           PV.OIL_M3 ,
                           PV.WATER_M3 ,
                           PV.GAS_E3M3 ,
                           PV.OIL_BOE ,
                           PV.GAS_BOE ,
                           PV.BOE ,
                           CASE WHEN PV.FACILITY IS NULL THEN PV.FACILITY
                                ELSE PV.FACILITY
                                 END AS FACILITY ,
                           WORKING_INTEREST ,
                           PUMP_TYPE ,
                           PV.SOURCE ----calculated columns below provide by the business to include in view
             ,
                           (IFNULL(Well_Proration,0))*Subtotal AS TOTAL_COST ,
                           '' AS NORM_TYPE
                      FROM WS_EDW.VIEW_PWRANALYTICS_VET_POWER_MTH_UNION PB
                      LEFT JOIN PV
                        ON PB.Account_Number=PV.CHILD_ACCOUNT_NUMBER
                       AND PV.FOM = (PB.Consumption_Month)
                     WHERE COUNTRY = 'United States'
                   ) SELECT COUNTRY,
                   PROVINCE ,
                   LANGUAGE,
                   CURRENCY ,
                   UTILITY_PROVIDER,
                   INVOICE_NUMBER ,
                   ACCOUNT_NUMBER,
                   DELIVERY_POINT ,
                   CONSUMPTION_MONTH,
                   METER_NUMBER ,
                   COST_CENTER,
                   CC_NAME ,
                   CORE_AREA,
                   AREA ,
                   TOTAL_CONSUMPTION_KWH,
                   PEAK_CONSUMPTION_KWH ,
                   OFF_PEAK_CONSUMPTION_KWH,
                   REGISTERED_DEMAND_KVA ,
                   BILLED_DEMAND_KVA,
                   CURRENT_METER_READ_DATE ,
                   CURRENT_METER_READ,
                   PREVIOUS_METER_READ_DATE ,
                   PREVIOUS_METER_READ,
                   TOTAL_AMOUNT_DUE ,
                   SUBTOTAL,
                   ENERGY_COST ,
                   PEAK_ENERGY_COST,
                   OFF_PEAK_ENERGY_COST ,
                   BASIC_COST,
                   DEMAND_COST ,
                   REACTIVE_COST,
                   TRANSMISSION_COST ,
                   OTHER_COST,
                   SERVICE_ADDRESS ,
                   CARBON_TAX,
                   CARBON_TAX_GST ,
                   FEDERAL_TAX,
                   PST ,
                   MST,
                   VAT ,
                   METER_TYPE ,
                   BILL_MULTIPLIER ,
                   RATE ,
                   POWER_FACTOR ,
                   PEAK_DEMAND,
                   BILL_DAYS ,
                   CC_NUM,
                   PROD_YEARMONTH ,
                   WELL_NAME,
                   FOREMAN ,
                   BATTERY,
                   UWI ,
                   WELL_TYPE,
                   RUN_NAME ,
                   SURFACE_LOCATION,
                   SURFACE_LATITUDE ,
                   SURFACE_LONGITUDE,
                   OPERATING_HOURS ,
                   DOWNTIME_HOURS,
                   OIL_M3 ,
                   WATER_M3,
                   GAS_E3M3 ,
                   OIL_BOE,
                   GAS_BOE ,
                   BOE,
                   FACILITY ,
                   WORKING_INTEREST,
                   PUMP_TYPE ,
                   SOURCE,
                   TOTAL_COST ,
                   NORM_TYPE
              FROM Fin
        dependencies:
          - locationName: TARGET
            nodeName: VIEW_PWRANALYTICS_VET_POWER_MTH_UNION
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','VIEW_PWRANALYTICS_VET_POWER_MTH_UNION') }}
        name: VIEW_PWRANALYTICS_USBU_POWERALLOCATION_MTH
        noLinkRefs: []
  name: VIEW_PWRANALYTICS_USBU_POWERALLOCATION_MTH
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
