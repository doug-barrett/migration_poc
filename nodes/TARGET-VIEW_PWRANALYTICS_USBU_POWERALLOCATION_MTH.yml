fileVersion: 1
id: f5fee093-d521-47d9-b6e4-0c08801764f6
name: VIEW_PWRANALYTICS_USBU_POWERALLOCATION_MTH
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32ce4572-cd80-49b7-85b4-15591c1e09e1
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: VARCHAR(13)
        defaultValue: ""
        description: ""
        name: COUNTRY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa554cce-aa4e-4c5e-bed7-4dd950e90af0
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 001e96f3-c259-41c1-8c33-b2a64446bc8b
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: VARCHAR(12)
        defaultValue: ""
        description: ""
        name: PROVINCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9bdbfeb3-13e8-442d-9aed-8d56112464b2
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6bfe64c-a9bd-4145-9c3d-3701301b3a8e
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: VARCHAR(14)
        defaultValue: ""
        description: ""
        name: LANGUAGE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 449144c9-0612-47a3-aa8d-4d5a5839c450
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4817e0ac-b613-43f0-a88d-999e233b416e
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: CURRENCY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 290506b2-3b5c-43c9-adec-0c26685119a4
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c5e0af1-5926-4253-911d-c3df3e6fc7b4
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: VARCHAR(24)
        defaultValue: ""
        description: ""
        name: UTILITY_PROVIDER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b55f17c-eaf7-41be-81e8-1511ca98facd
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d55a7e3-6c04-4556-b04e-d2ced4ec6235
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: NUMBER(38,0)
        defaultValue: ""
        description: ""
        name: INVOICE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 96e616e8-f0da-466d-b452-9b2a4d91c15c
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5cb5082c-7153-45e3-b260-eb68b26a7306
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: ACCOUNT_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 28354c2e-d1a2-4efc-bb1a-b5f6a4b27b9f
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dbcc1d6d-51bc-4c69-b5ae-353112c75fc4
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: DELIVERY_POINT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8474c817-ed24-4714-9682-d81badbb4351
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0dafa233-3825-4179-8ffb-26fb84687b1d
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: CONSUMPTION_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 093df048-a345-4bba-8eea-252aa09a0aca
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 712c3ffd-85f2-4ad1-8f84-1bce4ae76217
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: METER_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fee92307-11b5-4d28-8771-4ecdf5e7db4a
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b73b843-a379-4b33-8ea0-12f8f59418bb
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: COST_CENTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c790732c-e794-40bb-8e30-4b67cbe4f242
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 319ceea3-2053-44f4-8bd5-167a2f6eb576
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CC_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4cc00713-3d35-4ce1-9008-1b3edbe1aad0
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CORE_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c08e5d9-ffa3-4400-b9de-6a0ba849087a
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d54199f7-d275-4649-9560-3be3621d9a72
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 067f23bb-7888-4478-b044-7408f31a7997
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: TOTAL_CONSUMPTION_KWH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c5c3f56-211b-42ec-8d06-95d79e12c0e5
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 76b9922d-ea95-4e21-b9ec-2cb4fb740635
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PEAK_CONSUMPTION_KWH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 62cb0094-e7da-452e-8f75-9ff9d8b3de66
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0211cb02-7a51-44b3-961c-ba8306263414
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OFF_PEAK_CONSUMPTION_KWH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6b01c50a-ac04-425e-b21f-e5c8179e2f83
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e6258d3-b09a-461e-8561-06385cd67f47
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: REGISTERED_DEMAND_KVA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8a7d28dc-0b23-4e35-96ff-b25bc6829d8d
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a0a70372-9aa2-4386-8ba4-9c17b74278e8
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BILLED_DEMAND_KVA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f959cc5-3ea3-4513-a384-3f6a12348b17
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 780a9a2b-fabc-43aa-972c-e4836b699dd1
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CURRENT_METER_READ_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f9ba970b-ac96-4b7c-8370-2096939dfc22
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c68ac2b-395e-455e-ba1a-ba63cf8515c5
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: CURRENT_METER_READ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 29f5dd18-09b5-4487-ad3a-6817a2503576
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eabd32a8-ca39-4a1f-bee9-128c5eefa53d
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: PREVIOUS_METER_READ_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 804440e4-1482-42db-bac9-b71d959cd343
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ad6d7df-7861-42dc-829a-0c768d8f79bb
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PREVIOUS_METER_READ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ff57042-ec29-40a6-911a-4381194ed0d3
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50683629-b427-4da7-b79d-0f86a99b6e9c
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: TOTAL_AMOUNT_DUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 57ac190f-0b4d-4c4b-bd49-e555a1aabaf2
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0843e4b1-86ee-4032-820a-178d25e9ae5f
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: SUBTOTAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e6078465-1781-44f6-adc4-1e934e936b7c
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d1e9cff-70af-4b8b-b6a4-fdee87f50bd4
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: ENERGY_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1be3a8bb-76c8-4664-b9d4-19eb4713fbfc
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b62e366-70b1-4dc0-9033-8d4c403ea184
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PEAK_ENERGY_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0674dc6e-63b4-4d3a-8131-bc3907e705a3
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8964a718-5012-4e60-ad1d-0f5e3b66331c
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OFF_PEAK_ENERGY_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c62ff5f-a58f-4d28-8075-704b1093047d
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 84d15c22-b2b3-4d24-9754-3357375dfcef
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BASIC_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 65702267-8925-410a-9454-e0bf59cbbf7a
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 391e03da-fc27-469e-a383-90142722f2a7
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: DEMAND_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e0b273ac-e043-4ee0-aa97-c4abedf67933
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da1453b4-6456-427d-98cf-9914911040f2
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: REACTIVE_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67c8011f-ba45-4a70-966f-00d4e76e0b8b
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 491cde31-b8bc-4741-b78f-36edcbb6be5b
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: TRANSMISSION_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 40fafa9f-a8b7-4bcc-8e13-66a7f61019b0
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72b5b3bb-ea87-4196-9426-2af03a395632
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OTHER_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2f86f4da-6d89-462a-89fc-75cde9da0921
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c7d0c20-74bd-4d52-8b00-027039000270
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: SERVICE_ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 851c7eae-5096-4b15-8011-3db81829235e
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53c9bd8b-3f57-4e2e-94ab-26f116966f79
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: CARBON_TAX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d43bd47c-5d87-4e09-b17a-73883c60b1ba
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 715ed1e5-9f80-4e14-989c-c17af44696bd
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: CARBON_TAX_GST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a9954d46-2cb8-4670-aaec-6163edd515ed
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c5adca9-dbf8-487a-ba65-ca0d493d982e
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: FEDERAL_TAX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb7ca45b-14d4-4a3c-a834-c32f17c5c6fd
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f4ad04f-8d11-4d64-ab29-d1cde0606cd3
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 761fd394-6b89-4b47-8d15-8f1d1396a068
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: MST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67837649-9af0-4f7c-bb1d-6e00a8b067ef
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e20bead-fc11-4cda-bb13-b96e416a4e32
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: VAT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b859f894-9247-4f45-9f3c-900bce2298af
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0877908-c697-487e-8722-4b8f5086c288
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: METER_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72693e63-7f83-4aa6-86c9-0029bae791a1
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5496688d-a2fe-44d5-b1f3-139a55eb217d
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BILL_MULTIPLIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39aed6e2-9a56-469c-ad39-c62968146169
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e0537b3-ee59-48bc-9e31-5956f0e26339
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5aab0e90-27b2-47c7-9f2a-ad083e3b5605
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6c18eb4-d504-454a-9371-7885e37ccb83
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: POWER_FACTOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 55f4c84d-d4db-4498-9e72-6db8265679e8
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d6ea9e6-e65b-44df-895b-00855ca52cbd
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PEAK_DEMAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2fb3f2f1-11c6-421b-b4ce-fcbe13d35f4b
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ceb2f17-f234-4afb-9df9-6323d0b4feaf
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BILL_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 40861f14-a125-4d5b-b8cd-c28365b8f583
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2788ce9b-0576-4f19-8ca2-f5f0e8fff3c2
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b19c6695-282f-4e7b-b035-ae8721338d6d
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PROD_YEARMONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4cce00a-8cd6-44f7-982f-b7eff7689c40
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: WELL_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb84a560-81cc-4fe5-a49a-c08534b2b1f5
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: FOREMAN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da9540a6-1b7e-47cb-b4e0-ba1d81c6f922
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: BATTERY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc48c18d-89ab-47d2-8910-98dd5089739d
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c201c862-08b5-402f-b6b6-594970fbba1f
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: WELL_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 378c7dac-bfd5-44ec-948e-a1d68068014e
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: RUN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 066aecd1-19da-4997-bebf-054b71f44a20
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: SURFACE_LOCATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bef7d989-be43-4e30-8106-bbc173062fe2
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: SURFACE_LATITUDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 615a00c9-dc8f-46de-9152-63daee758268
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: SURFACE_LONGITUDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 807f6cf0-2a4b-439c-b555-ad26758e96c6
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OPERATING_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 268f51f8-7dba-4753-ad74-b984c310f207
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: DOWNTIME_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29895faf-4ce9-4fe9-8c60-de2a5c269fb7
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OIL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9807c41a-1299-40f0-b877-81a34fbdf7e7
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: WATER_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b6b50fb-3cd1-4d43-a7a2-d7b35043a789
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: GAS_E3M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71962b80-3e77-4d65-9f73-589e12c5e5ac
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OIL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ad0e285-ffef-45df-8745-e7cf1baa5a17
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: GAS_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3b88077-cbf0-4303-b2d5-89d60fabd1f8
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 340bbc8e-8cf9-41c6-8d63-c3af0c20ffec
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: FACILITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e2afac5-9d99-4e63-95bc-59c26a729124
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: WORKING_INTEREST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 30974259-9d16-4bda-8a52-6282d439d252
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: PUMP_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf6dc3bf-5707-48c6-9121-cc99eb5ff920
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b3d174ac-1e71-494b-9ccc-76083381d951
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: TOTAL_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e765669c-accd-443f-9862-099736bd0c95
          stepCounter: f5fee093-d521-47d9-b6e4-0c08801764f6
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: NORM_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_PWRANALYTICS_USBU_POWERALLOCATION_MTH: f5fee093-d521-47d9-b6e4-0c08801764f6
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_PWRANALYTICS_USBU_POWERALLOCATION_MTH') }} AS WITH MJ AS (
                    SELECT *
                      FROM (
                            SELECT DISTINCT(WELL_NAME),
                                   CHILD_ACCOUNT_NUMBER ,
                                   METER_NUMBER,
                                   CC_NUM ,
                                   AREA,
                                   CORE_AREA ,
                                   PROVINCE,
                                   FACILITY ,
                                   FOREMAN,
                                   RUN_NAME ,
                                   BATTERY,
                                   'ProdView' AS SOURCE
                              FROM WS_EDW.VIEW_FDC_PWRANALYTICS PV
                             WHERE COUNTRY = 'UNITED STATES'
                           ) MJ3
                     CROSS JOIN DS_POWER.VET_DIMDATE M
                     WHERE Year(Date) >= 2021
                       AND Year(Date) <= Year(GetDate())
                   ),
                   PV_AGG_A AS (
                    SELECT MJ.CHILD_ACCOUNT_NUMBER ,
                           MJ.DATE ,
                           Sum(IFNULL(PV.WATER_M3,0)) + Sum(IFNULL(PV.OIL_M3,0)) AS BOE ,
                           count(*) AS WELL_COUNT ,
                           1.00/Count(*) AS WELLCOUNT_PRORATION
                      FROM MJ
                      LEFT OUTER JOIN WS_EDW.VIEW_FDC_PWRANALYTICS PV
                        ON MJ.Well_Name = PV.WELL_NAME
                       AND MJ.Date = LAST_DAY(DATE(concat(SUBSTRING(cast(Prod_YEARMONTH AS varchar),1,4), '-', SUBSTRING(cast(Prod_YEARMONTH AS varchar),5,2), '-01')))
                     GROUP BY MJ.CHILD_ACCOUNT_NUMBER,
                              MJ.Date
                   ),
                   PV AS (
                    SELECT MJ.WELL_NAME,
                           PV_W.UWI ,
                           IFNULL(PV_W.CC_NUM,MJ.CC_NUM) AS CC_NUM,
                           PV_W.CC_NAME ,
                           IFNULL(MJ.PROVINCE,PV_W.PROVINCE) AS Province,
                           IFNULL(MJ.CORE_AREA,PV_W.CORE_AREA) AS CORE_AREA ,
                           IFNULL(MJ.AREA,PV_W.AREA) AS Area,
                           IFNULL(MJ.FOREMAN,PV_W.FOREMAN) AS FOREMAN ,
                           IFNULL(PV_W.RUN_NAME,MJ.RUN_NAME) AS RUN_NAME,
                           IFNULL(MJ.FACILITY,PV_W.FACILITY) AS FACILITY ,
                           IFNULL(PV_W.BATTERY,MJ.Battery) AS BATTERY,
                           PV_W.WELL_TYPE ,
                           PV_W.SURFACE_LOCATION,
                           PV_W.SURFACE_LATITUDE ,
                           PV_W.SURFACE_LONGITUDE,
                           PV_W.OPERATING_HOURS ,
                           PV_W.DOWNTIME_HOURS,
                           PV_W.ON_PROD_DATE ,
                           PV_W.LAST_PROD_DATE,
                           PV_W.PROD_YEAR ,
                           PV_W.PROD_MONTH,
                           PV_W.PROD_YEARMONTH ,
                           PV_W.WORKING_INTEREST,
                           PV_W.PUMP_TYPE ,
                           PV_W.METER_NUMBER,
                           MJ.CHILD_ACCOUNT_NUMBER AS CHILD_ACCOUNT_NUMBER ,
                           MJ.Date AS EoProdMonth,
                           (DATEFROMPARTS(year(MJ.Date), MONTH (MJ.Date), 01)) AS FOM ,
                           IFNULL(PV_W.WATER_M3,0) AS WATER_M3,
                           IFNULL(PV_W.OIL_M3,0) AS OIL_M3 ,
                           PV_W.GAS_E3M3,
                           PV_W.OIL_BOE ,
                           PV_W.GAS_BOE,
                           IFNULL(PV_W.BOE,0) AS BOE ,
                           IFNULL(PV_AGG_A.BOE,0) AS TOTALBOE,
                           PV_AGG_A.WELL_COUNT AS PV_WELL_COUNT ,
                           PV_AGG_A.WELL_COUNT AS MJ_WELL_COUNT,
                           PV_AGG_A.WELLCOUNT_PRORATION ,
                           SOURCE ,
                           CASE WHEN PV_AGG_A.BOE = 0                                          THEN 1.00/PV_AGG_A.WELL_COUNT
                                WHEN PV_AGG_A.BOE IS NULL AND 1.00/PV_AGG_A.WELL_COUNT IS NULL THEN 1.00
                                ELSE (PV_W.WATER_M3+PV_W.OIL_M3)/PV_AGG_A.BOE
                                 END AS PRORATION_BOE ,
                           CASE WHEN (PV_AGG_A.BOE = 0 AND PV_AGG_A.WELL_COUNT >= 1) OR ((PV_W.WATER_M3+PV_W.OIL_M3) = 0 AND PV_AGG_A.BOE = 0 AND PV_AGG_A.WELL_COUNT > 1) THEN 1.00/PV_AGG_A.WELL_COUNT
                                ELSE (PV_W.WATER_M3+PV_W.OIL_M3)/PV_AGG_A.BOE
                                 END AS WELL_PRORATION
                      FROM MJ
                      LEFT JOIN WS_EDW.VIEW_FDC_PWRANALYTICS PV_W
                        ON MJ.Well_Name = PV_W.WELL_NAME
                       AND MJ.Date = LAST_DAY(DATE(concat(SUBSTRING(cast(PV_W.Prod_YEARMONTH AS varchar),1,4), '-', SUBSTRING(cast(PV_W.Prod_YEARMONTH AS varchar),5,2), '-01')))
                      LEFT JOIN PV_AGG_A
                        ON MJ.CHILD_ACCOUNT_NUMBER = PV_AGG_A.CHILD_ACCOUNT_NUMBER
                       AND MJ.Date = PV_AGG_A.Date
                   ),
                   Fin AS(
                    SELECT PB.COUNTRY ,
                           PB.PROVINCE ,
                           PB.LANGUAGE ,
                           PB.CURRENCY ,
                           UTILITY_PROVIDER,
                           INVOICE_NUMBER ,
                           ACCOUNT_NUMBER ,
                           PB.DELIVERY_POINT ,
                           CONSUMPTION_MONTH,
                           PB.METER_NUMBER AS METER_NUMBER ,
                           COST_CENTER ,
                           PV.CC_NAME AS CC_NAME ,
                           PV.CORE_AREA AS CORE_AREA ,
                           PV.AREA ,
                           IFNULL(WELL_PRORATION,0) * TOTAL_CONSUMPTION_KWH AS TOTAL_CONSUMPTION_KWH ,
                           IFNULL(WELL_PRORATION,0) *PEAK_CONSUMPTION_KWH AS PEAK_CONSUMPTION_KWH ,
                           IFNULL(WELL_PRORATION,0) *OFF_PEAK_CONSUMPTION_KWH AS OFF_PEAK_CONSUMPTION_KWH ,
                           IFNULL(WELL_PRORATION,0) *REGISTERED_DEMAND_KVA AS REGISTERED_DEMAND_KVA ,
                           IFNULL(WELL_PRORATION,0) *BILLED_DEMAND_KVA AS BILLED_DEMAND_KVA ,
                           CURRENT_METER_READ_DATE ,
                           CURRENT_METER_READ ,
                           PREVIOUS_METER_READ_DATE ,
                           PREVIOUS_METER_READ ,
                           IFNULL(WELL_PRORATION,0) * TOTAL_AMOUNT_DUE AS TOTAL_AMOUNT_DUE ,
                           IFNULL(WELL_PRORATION,0) *SUBTOTAL AS SUBTOTAL ,
                           IFNULL(WELL_PRORATION,0) *ENERGY_COST AS ENERGY_COST ,
                           IFNULL(WELL_PRORATION,0) *PEAK_ENERGY_COST AS PEAK_ENERGY_COST ,
                           IFNULL(WELL_PRORATION,0) *OFF_PEAK_ENERGY_COST AS OFF_PEAK_ENERGY_COST ,
                           BASIC_COST/PV.MJ_WELL_COUNT AS BASIC_COST ,
                           IFNULL(WELL_PRORATION,0) *DEMAND_COST AS DEMAND_COST ,
                           IFNULL(WELL_PRORATION,0) * REACTIVE_COST AS REACTIVE_COST ,
                           IFNULL(WELL_PRORATION,0) * TRANSMISSION_COST AS TRANSMISSION_COST ,
                           IFNULL(WELL_PRORATION,0) * OTHER_COST AS OTHER_COST ,
                           SERVICE_ADDRESS ,
                           IFNULL(WELL_PRORATION,0) *CARBON_TAX AS CARBON_TAX ,
                           IFNULL(WELL_PRORATION,0) *CARBON_TAX_GST AS CARBON_TAX_GST ,
                           IFNULL(WELL_PRORATION,0) * FEDERAL_TAX_GST AS FEDERAL_TAX ,
                           IFNULL(WELL_PRORATION,0) *PST AS PST ,
                           IFNULL(WELL_PRORATION,0) *MST AS MST ,
                           IFNULL(WELL_PRORATION,0) *VAT AS VAT ,
                           CAST(METER_TYPE AS VARCHAR) AS METER_TYPE ,
                           BILL_MULTIPLIER ,
                           RATE ,
                           POWER_FACTOR ,
                           PEAK_DEMAND ,
                           BILL_DAYS ----- Prodview ---------
             ,
                           PV.CC_NUM AS CC_NUM ,
                           PV.PROD_YEARMONTH ,
                           PV.Well_Name AS WELL_NAME,
                           CASE WHEN PV.FOREMAN IS NULL THEN PV.FOREMAN
                                ELSE PV.FOREMAN
                                 END AS FOREMAN ,
                           PV.RUN_NAME ,
                           BATTERY ,
                           UWI ,
                           WELL_TYPE ,
                           PV.SURFACE_LOCATION ,
                           PV.SURFACE_LATITUDE ,
                           PV.SURFACE_LONGITUDE ,
                           PV.OPERATING_HOURS ,
                           PV.DOWNTIME_HOURS ,
                           PV.OIL_M3 ,
                           PV.WATER_M3 ,
                           PV.GAS_E3M3 ,
                           PV.OIL_BOE ,
                           PV.GAS_BOE ,
                           PV.BOE ,
                           CASE WHEN PV.FACILITY IS NULL THEN PV.FACILITY
                                ELSE PV.FACILITY
                                 END AS FACILITY ,
                           WORKING_INTEREST ,
                           PUMP_TYPE ,
                           PV.SOURCE ----calculated columns below provide by the business to include in view
             ,
                           (IFNULL(Well_Proration,0))*Subtotal AS TOTAL_COST ,
                           '' AS NORM_TYPE
                      FROM WS_EDW.VIEW_PWRANALYTICS_VET_POWER_MTH_UNION PB
                      LEFT JOIN PV
                        ON PB.Account_Number=PV.CHILD_ACCOUNT_NUMBER
                       AND PV.FOM = (PB.Consumption_Month)
                     WHERE COUNTRY = 'United States'
                   ) SELECT COUNTRY,
                   PROVINCE ,
                   LANGUAGE,
                   CURRENCY ,
                   UTILITY_PROVIDER,
                   INVOICE_NUMBER ,
                   ACCOUNT_NUMBER,
                   DELIVERY_POINT ,
                   CONSUMPTION_MONTH,
                   METER_NUMBER ,
                   COST_CENTER,
                   CC_NAME ,
                   CORE_AREA,
                   AREA ,
                   TOTAL_CONSUMPTION_KWH,
                   PEAK_CONSUMPTION_KWH ,
                   OFF_PEAK_CONSUMPTION_KWH,
                   REGISTERED_DEMAND_KVA ,
                   BILLED_DEMAND_KVA,
                   CURRENT_METER_READ_DATE ,
                   CURRENT_METER_READ,
                   PREVIOUS_METER_READ_DATE ,
                   PREVIOUS_METER_READ,
                   TOTAL_AMOUNT_DUE ,
                   SUBTOTAL,
                   ENERGY_COST ,
                   PEAK_ENERGY_COST,
                   OFF_PEAK_ENERGY_COST ,
                   BASIC_COST,
                   DEMAND_COST ,
                   REACTIVE_COST,
                   TRANSMISSION_COST ,
                   OTHER_COST,
                   SERVICE_ADDRESS ,
                   CARBON_TAX,
                   CARBON_TAX_GST ,
                   FEDERAL_TAX,
                   PST ,
                   MST,
                   VAT ,
                   METER_TYPE ,
                   BILL_MULTIPLIER ,
                   RATE ,
                   POWER_FACTOR ,
                   PEAK_DEMAND,
                   BILL_DAYS ,
                   CC_NUM,
                   PROD_YEARMONTH ,
                   WELL_NAME,
                   FOREMAN ,
                   BATTERY,
                   UWI ,
                   WELL_TYPE,
                   RUN_NAME ,
                   SURFACE_LOCATION,
                   SURFACE_LATITUDE ,
                   SURFACE_LONGITUDE,
                   OPERATING_HOURS ,
                   DOWNTIME_HOURS,
                   OIL_M3 ,
                   WATER_M3,
                   GAS_E3M3 ,
                   OIL_BOE,
                   GAS_BOE ,
                   BOE,
                   FACILITY ,
                   WORKING_INTEREST,
                   PUMP_TYPE ,
                   SOURCE,
                   TOTAL_COST ,
                   NORM_TYPE
              FROM Fin
        dependencies:
          - locationName: TARGET
            nodeName: VIEW_PWRANALYTICS_VET_POWER_MTH_UNION
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','VIEW_PWRANALYTICS_VET_POWER_MTH_UNION') }}
        name: VIEW_PWRANALYTICS_USBU_POWERALLOCATION_MTH
        noLinkRefs: []
  name: VIEW_PWRANALYTICS_USBU_POWERALLOCATION_MTH
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
