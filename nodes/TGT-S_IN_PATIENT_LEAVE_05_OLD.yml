fileVersion: 1
id: d3db7a8a-3ea5-4993-9968-b08836b24bc3
name: S_IN_PATIENT_LEAVE_05_OLD
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8433de4f-2267-41b5-a8e6-e31d6c8caf5f
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8489b9a1-19ea-4ffb-8d1c-c09c0a49ec68
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: "'H'+CONVERT(varchar,ds_pims_home_leaves.prvsp_refno)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ac2eeab-df63-47bc-b3ef-5071026a26b3
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'H'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8cac7ba-3f6b-429c-b39c-9a4d191a4eff
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRVSP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59d3088d-97f2-4c53-9ebc-ae021c7b49e2
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5252ac55-9d6c-4d4d-b8c3-d14ec833d203
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11ba3682-5d1a-4a53-bfaf-b4b646e6c99f
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 357dc4bf-b79b-46e0-93c1-843f4b9fc6a6
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a06254d-d86c-4cf5-ab17-b37af0d69b0a
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82f675a6-a270-4df5-a697-3319dd13ede3
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72c532b7-79a7-49aa-8bc0-c737daef331d
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54932b54-3d16-4528-b9f0-8ad76901bf1a
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1125cf7f-7027-45ac-acc8-b3a92505c4da
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: |-
              CASE WHEN ds_pims_provider_spells.admit_dttm IS NULL OR ds_pims_provider_spells.admit_dttm <= '1990-01-01' OR ds_pims_provider_spells.admit_dttm > GETDATE() THEN ds_pims_provider_spells.disch_dttm
                          ELSE ds_pims_provider_spells.admit_dttm
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d1163943-380d-418f-a4ed-180defdc7408
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMIT_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1125cf7f-7027-45ac-acc8-b3a92505c4da
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 30f0230b-b160-4894-a0f0-14511ba3429f
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCH_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee3a67e8-1a53-44ab-aa64-cafc588de09c
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: |-
              CASE WHEN ds_pims_provider_spells.disch_dttm IS NULL OR ds_pims_provider_spells.disch_dttm <= '1990-01-01' OR ds_pims_provider_spells.disch_dttm > GETDATE() THEN ds_pims_provider_spells.admit_dttm
                          ELSE ds_pims_provider_spells.disch_dttm
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf1b4553-6564-4a3c-aba1-9877115d83d0
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCH_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee3a67e8-1a53-44ab-aa64-cafc588de09c
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48d61dde-15e7-42a4-9b67-3ae8222d3dec
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: HOMEL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 231569e9-0ac1-4568-aa07-b0501058bee7
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67e498a4-347e-45ad-80cb-fa80daf7a02c
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SSTAY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24eeb20d-18d1-4bd8-8f55-2f75643a24d3
                stepCounter: 33fe902a-f28a-4da8-b9d5-2e4311242008
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c76e85d3-9f04-4014-bb20-7eb994f4f8f5
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SSTAY_REFNO_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18404477-4bb7-4dc4-a4fb-6548f91cda07
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b2456c24-42c0-441b-8aff-17305113e8bf
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d784265-74e1-48f4-9054-fc43f791a5a1
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ac37687-893b-475d-8c1b-012a11d047d0
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_PATNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f7b850f-ce72-4e87-b4f3-6e2838f4dd0a
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b2508730-af31-40d5-b7ac-57167e15a075
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: FREE_BED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 62e2fdf5-9452-4499-b416-d6fee65c21d3
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e590e41f-74eb-4c95-afbe-3b9fca118033
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LEAVE_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4f863b45-1753-4712-88f4-d3e9bc7e1040
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: |-
              CASE WHEN ds_pims_home_leaves.start_dttm IS NULL OR ds_pims_home_leaves.start_dttm <= '1990-01-01' OR ds_pims_home_leaves.start_dttm > GETDATE() OR ds_pims_home_leaves.start_dttm > ds_pims_home_leaves.end_dttm OR ds_pims_home_leaves.start_dttm < CASE WHEN ds_pims_provider_spells.admit_dttm IS NULL OR ds_pims_provider_spells.admit_dttm <= '1990-01-01' OR ds_pims_provider_spells.admit_dttm > GETDATE() THEN ds_pims_provider_spells.disch_dttm ELSE ds_pims_provider_spells.admit_dttm END THEN CASE WHEN ds_pims_provider_spells.admit_dttm IS NULL OR ds_pims_provider_spells.admit_dttm <= '1990-01-01' OR ds_pims_provider_spells.admit_dttm > GETDATE() THEN ds_pims_provider_spells.disch_dttm ELSE ds_pims_provider_spells.admit_dttm END
                          ELSE ds_pims_home_leaves.start_dttm
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1bbe8d17-9bfe-4803-b143-aadfa5020548
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LEAVE_START_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4f863b45-1753-4712-88f4-d3e9bc7e1040
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9cd18e4-2ac5-4ff3-a262-9f5476f230cd
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: STAY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d98e645e-b2cf-4f8d-95d1-1d45aaa6fcce
                stepCounter: 33fe902a-f28a-4da8-b9d5-2e4311242008
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8905386-d0c0-4f7e-828a-7e586944a2dd
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LEAVE_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: acf53736-2adf-4256-898d-573f8b10ce7f
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: |-
              CASE WHEN ds_pims_home_leaves.end_dttm IS NULL OR ds_pims_home_leaves.end_dttm <= '1990-01-01' OR ds_pims_home_leaves.end_dttm > GETDATE() OR ds_pims_home_leaves.end_dttm < ds_pims_home_leaves.start_dttm OR ds_pims_home_leaves.end_dttm > CASE WHEN ds_pims_provider_spells.disch_dttm <= '1990-01-01' OR ds_pims_provider_spells.disch_dttm > GETDATE() THEN ds_pims_provider_spells.admit_dttm ELSE ds_pims_provider_spells.disch_dttm END THEN CASE WHEN ds_pims_provider_spells.disch_dttm IS NULL OR ds_pims_provider_spells.disch_dttm <= '1990-01-01' OR ds_pims_provider_spells.disch_dttm > GETDATE() THEN ds_pims_provider_spells.admit_dttm ELSE ds_pims_provider_spells.disch_dttm END
                          ELSE ds_pims_home_leaves.end_dttm
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 753d57ad-8caf-4c7b-86cc-3de3536f896f
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LEAVE_END_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: acf53736-2adf-4256-898d-573f8b10ce7f
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8038acd0-24c8-4184-b5a2-f8a6bf86e537
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: STAY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b3b399b6-cd48-42b7-8d10-914fd8747ca8
                stepCounter: 33fe902a-f28a-4da8-b9d5-2e4311242008
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4adf6e7b-98d3-45c0-87c6-83d33a383a43
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ARCHV_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 98d73ce3-c35f-434a-b71f-08fc7d60355a
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed1e9d20-f423-490f-8fef-6af60d6adcb6
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ccdfe81-76a4-4c5f-9e97-0cc7fed4d6d3
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d91fc50-2aae-40ab-9825-e4c57064b64e
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIF_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef293cda-df71-4ea8-988d-90f1c98f64e3
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 51200eb0-8272-4080-99ad-dede11bd34fd
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: USER_CREATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e97e0181-ea71-4b3c-bc18-5f352037437b
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74ed9c79-0056-49ca-90fb-1503fb0ce3bd
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: USER_MODIF
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7e945eb-312e-4af9-82bc-bccce396c34c
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d494ca0-34af-439c-bf7e-cdeb07614686
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STRAN_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e3d8527-cc49-48e9-855a-c278bee8caae
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6247d4c0-1f84-4da8-9753-6e1388fe8381
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRIOR_POINTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ef1e0a3-132c-408f-b8a1-d14cd365d18a
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15c5b160-f445-43f9-9d5e-efa8a159528f
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EXTERNAL_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7bd34f97-ceb7-43fe-9de6-1eb5bcce98ee
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c63a3c41-343d-4687-b067-42d656053189
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: EXPECTED_RETURN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b35ae8b5-425f-461e-bab5-e4d357726f70
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b1fb813-32f2-4c79-ba3e-53d545e7def9
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LATEST_RETURN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d118ff52-6649-4420-a794-a328a70cf924
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa9df767-df0b-484e-ad2f-05ea40a854ea
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PLGST_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0853d527-a7c1-4cce-a573-00d140387136
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e72ab241-73bd-4334-95c2-9a2c589eea2b
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REHML_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 69df30bd-eeff-42b4-a5ac-38b21df3ba43
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74f46451-47f4-41e4-8fe8-05419dc4aa0e
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LVTYP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: da5ecf69-b663-437d-9557-5b7f8a83b977
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf610c93-c454-4c05-8f83-84d51c427862
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LVEOC_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 282c23ef-5f27-486c-aaae-235891540106
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3e06504-b223-484b-a0b6-8959e7e55877
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: RECALL_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db213c80-2452-493c-a902-3d9abc143c36
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7bec5bd6-fb89-4135-ba40-669acda133bf
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 87e10cb7-8c4d-41f9-afbe-e7f0ef569705
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3dedd19b-2c2a-4934-81a6-65ee73cea83b
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: PRVSN_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dda0c1df-3728-4814-a7d6-4edd0f969e4a
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: def6e2c2-ca00-420f-95fd-499bb74d3389
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PERCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b3767370-402e-4e83-b93d-3cf104f4224b
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fcadc86b-be5e-4f33-ba8a-84162aa9e017
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OWNER_HEORG_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3cb3c8fe-2302-4eaf-a4e2-1f30523c6171
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d3b19d4-b3a0-49a5-89f6-aa750de0bec6
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EXT_HEORG_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c055e901-1f7b-47b7-8dc1-358c05c494ab
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71db04ff-768e-44f4-a921-14deedd8068b
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EXT_HEORG_PASID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e95ec39-fd18-4cea-95d0-c778049ff5e1
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf93f7db-0407-4043-9833-cb1232bd8cf7
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_LEAVE_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8489b9a1-19ea-4ffb-8d1c-c09c0a49ec68
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: ROW_NUMBER() OVER (PARTITION BY ds_pims_home_leaves.prvsp_refno ORDER BY ds_pims_home_leaves.homel_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a2fbf6b-c8bc-4818-ac61-b0b7222d18e3
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_LEAVE_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8489b9a1-19ea-4ffb-8d1c-c09c0a49ec68
                stepCounter: 722adbeb-338a-4596-a2f1-da45fa35fba5
            transform: COUNT(1) OVER (PARTITION BY ds_pims_home_leaves.prvsp_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3100c021-e7e2-422c-acb6-247f517968ad
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_LEAVE_TOTAL_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: SUM(DATEDIFF(dd,ds_pims_home_leaves.start_dttm,ds_pims_home_leaves.end_dttm)) OVER (PARTITION BY ds_pims_home_leaves.prvsp_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d4a6d1f-d952-4bf6-adfc-9b02a0cd3b0f
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_LEAVE_TOTAL_DURATION_MINUTES
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: SUM(DATEDIFF(MINUTE,ds_pims_home_leaves.start_dttm,ds_pims_home_leaves.end_dttm)) OVER (PARTITION BY ds_pims_home_leaves.prvsp_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a41625a0-6dd5-4bee-8c47-1cdac382fc9e
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DSS_DATA_QUALITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a431416-9a93-4476-9ef7-1a06394e6439
          stepCounter: d3db7a8a-3ea5-4993-9968-b08836b24bc3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_PIMS_HOME_LEAVES
        join:
          joinCondition: |-
            FROM ds_pims_home_leaves
              JOIN ds_pims_provider_spells
                ON ds_pims_home_leaves.prvsp_refno = ds_pims_provider_spells.prvsp_refno
              LEFT OUTER JOIN (SELECT MAX(sstay_refno) sstay_refno,
                   MAX(start_dttm) start_dttm,
                   MAX(end_dttm) end_dttm,
                   prvsp_refno --, patnt_refno     FROM ds_pims_service_point_stays GROUP BY prvsp_refno) ds_pims_service_point_stays    ON  ds_pims_home_leaves.prvsp_refno = ds_pims_service_point_stays.prvsp_refno     --AND ds_pims_home_leaves.patnt_refno = ds_pims_provider_spells.patnt_refno     AND (CONVERT(date,ds_pims_home_leaves.start_dttm) BETWEEN CONVERT(date,ds_pims_service_point_stays.start_dttm-1) AND CONVERT(date,ds_pims_service_point_stays.end_dttm+1)     OR COALESCE(CONVERT(date,ds_pims_home_leaves.end_dttm),GETDATE()) BETWEEN CONVERT(date,ds_pims_service_point_stays.start_dttm-1) AND COALESCE(CONVERT(date,ds_pims_service_point_stays.end_dttm+1),GETDATE()))
        name: S_IN_PATIENT_LEAVE_05_OLD
        noLinkRefs: []
  name: S_IN_PATIENT_LEAVE_05_OLD
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
