fileVersion: 1
id: fd180a2f-15e9-4fed-bbc5-17cb1d19b67d
name: S_PLANNED_REVIEW_NASC_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f02fab95-7b16-431b-af40-3e2898e8f29e
          stepCounter: fd180a2f-15e9-4fed-bbc5-17cb1d19b67d
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: CONTACT_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'NA'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77fc3840-39df-460f-b90b-4e251ec3792d
          stepCounter: fd180a2f-15e9-4fed-bbc5-17cb1d19b67d
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: CONTACT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 44c05a6f-9fc8-480b-bdf6-29ae992908a9
                stepCounter: 9e89e89f-4fe9-4a5e-8b07-866623118452
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11c2085d-5a38-4fbb-bdc9-4cf050597086
          stepCounter: fd180a2f-15e9-4fed-bbc5-17cb1d19b67d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: TASK_REQUEST_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7570d12b-fd39-4264-b31d-03c84467ba42
                stepCounter: 9e89e89f-4fe9-4a5e-8b07-866623118452
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c89f4b9-9147-4d9d-9805-46d72a6fefd1
          stepCounter: fd180a2f-15e9-4fed-bbc5-17cb1d19b67d
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 652c3c0c-9042-4f1b-904b-ffa6dd37e09d
                stepCounter: 9e89e89f-4fe9-4a5e-8b07-866623118452
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be2dcfa3-e90d-4f68-a849-2d0eda99cfc3
          stepCounter: fd180a2f-15e9-4fed-bbc5-17cb1d19b67d
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: patient_programme_id
        name: PROGRAMME_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aec16b68-bdd1-4c88-8e56-9c80a2ce106e
                stepCounter: 9e89e89f-4fe9-4a5e-8b07-866623118452
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c51cf6aa-9be1-4716-ab2e-292e34b0a4ae
          stepCounter: fd180a2f-15e9-4fed-bbc5-17cb1d19b67d
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: patient_programme_status
        name: PROGRAMME_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23780e84-24af-47c9-a52a-61be3e85e811
                stepCounter: 9e89e89f-4fe9-4a5e-8b07-866623118452
            transform: IFNULL(s_planned_review_NASC_v.programme_status,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 10420096-4023-4f57-a5c0-59749e0234c3
          stepCounter: fd180a2f-15e9-4fed-bbc5-17cb1d19b67d
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PLANNED_REVIEW_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27b84bee-3113-446c-aa1d-e249bd134d05
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: IFNULL(s_support_plan_NASC_10.review_type,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b14b9f6-b821-4aaa-9cae-1559b976983f
          stepCounter: fd180a2f-15e9-4fed-bbc5-17cb1d19b67d
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: TASK_DESC
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec848d8b-bb59-4edf-a742-d4d88bd25a32
                stepCounter: 9e89e89f-4fe9-4a5e-8b07-866623118452
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1ddd64f-7976-4fa4-8b99-142358a7fb17
          stepCounter: fd180a2f-15e9-4fed-bbc5-17cb1d19b67d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: HEALTH_ORG_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 71b4fd5a-880a-4479-986d-0220672f07bd
                stepCounter: 9e89e89f-4fe9-4a5e-8b07-866623118452
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b34cffe-59c9-4847-98cd-e58f0296b61f
          stepCounter: fd180a2f-15e9-4fed-bbc5-17cb1d19b67d
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 788b28a4-3aa0-437a-94b0-48f757be0904
                stepCounter: 9e89e89f-4fe9-4a5e-8b07-866623118452
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ecafc341-6928-4be5-a7fc-e2894168c0a0
          stepCounter: fd180a2f-15e9-4fed-bbc5-17cb1d19b67d
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: HOSPITAL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a89a406f-cb43-4ae6-a5cd-1645a681e6dd
                stepCounter: 9e89e89f-4fe9-4a5e-8b07-866623118452
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e276416-9d80-4388-8960-135c7bf21b09
          stepCounter: fd180a2f-15e9-4fed-bbc5-17cb1d19b67d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PROVIDER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b49f65ac-33e0-4bb6-8854-b11147d85862
                stepCounter: 9e89e89f-4fe9-4a5e-8b07-866623118452
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a6619c9-109f-498c-a26e-e38c01ca120f
          stepCounter: fd180a2f-15e9-4fed-bbc5-17cb1d19b67d
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PROVIDER_ROLE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1bf22bba-9f79-4fda-a9df-7bd90f7d10e6
                stepCounter: 9e89e89f-4fe9-4a5e-8b07-866623118452
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34b623ee-9957-4eac-a9e6-1b9152ca8f2c
          stepCounter: fd180a2f-15e9-4fed-bbc5-17cb1d19b67d
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PROGRAMME_ROLE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 925809fe-a22f-4c4b-afe5-8ca54f2b15ee
                stepCounter: 9e89e89f-4fe9-4a5e-8b07-866623118452
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4858a8e3-5b66-4b90-a513-4a790876609b
          stepCounter: fd180a2f-15e9-4fed-bbc5-17cb1d19b67d
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: DEPARTMENT_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d987929e-5376-4f54-8f22-634411f4e6d6
                stepCounter: 9e89e89f-4fe9-4a5e-8b07-866623118452
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f331967-f793-41de-a95c-0e5f66b8aa05
          stepCounter: fd180a2f-15e9-4fed-bbc5-17cb1d19b67d
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SERVICE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d7844938-b85f-4982-9eee-68dcb014fd0c
                stepCounter: 9e89e89f-4fe9-4a5e-8b07-866623118452
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 440cc242-3387-4317-9f16-873cb53b29a9
          stepCounter: fd180a2f-15e9-4fed-bbc5-17cb1d19b67d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: TASK_REQUEST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2f373f7-1c7e-4b2a-81bc-6e400af1e62c
                stepCounter: 9e89e89f-4fe9-4a5e-8b07-866623118452
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87117e8c-b2e3-45d5-9653-d5774b85dccf
          stepCounter: fd180a2f-15e9-4fed-bbc5-17cb1d19b67d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: EPISODE_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e3f6dc00-b716-4159-851f-cb45922c72e8
                stepCounter: 9e89e89f-4fe9-4a5e-8b07-866623118452
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: daaeebd5-01a8-4b90-b47f-479df9c70e6c
          stepCounter: fd180a2f-15e9-4fed-bbc5-17cb1d19b67d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_PLANNED_REVIEW_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2f373f7-1c7e-4b2a-81bc-6e400af1e62c
                stepCounter: 9e89e89f-4fe9-4a5e-8b07-866623118452
            transform: ROW_NUMBER() OVER (PARTITION BY s_planned_review_NASC_v.patient_NHI ORDER BY s_planned_review_NASC_v.task_request_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2209afcb-731e-4abe-82b0-688752512544
          stepCounter: fd180a2f-15e9-4fed-bbc5-17cb1d19b67d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_PLANNED_REVIEW_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 652c3c0c-9042-4f1b-904b-ffa6dd37e09d
                stepCounter: 9e89e89f-4fe9-4a5e-8b07-866623118452
            transform: COUNT(1) OVER (PARTITION BY s_planned_review_NASC_v.patient_NHI)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c42a883-b514-48ea-ae93-b660ca4144b1
          stepCounter: fd180a2f-15e9-4fed-bbc5-17cb1d19b67d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_PLANNED_REVIEW_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2f373f7-1c7e-4b2a-81bc-6e400af1e62c
                stepCounter: 9e89e89f-4fe9-4a5e-8b07-866623118452
            transform: ROW_NUMBER() OVER (PARTITION BY s_planned_review_NASC_v.referral_encounter_id ORDER BY s_planned_review_NASC_v.task_request_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6704f8c9-8f65-443f-8871-da88f9b17422
          stepCounter: fd180a2f-15e9-4fed-bbc5-17cb1d19b67d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_PLANNED_REVIEW_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 788b28a4-3aa0-437a-94b0-48f757be0904
                stepCounter: 9e89e89f-4fe9-4a5e-8b07-866623118452
            transform: COUNT(1) OVER (PARTITION BY s_planned_review_NASC_v.referral_encounter_id)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e56f611-d1ef-4ad4-aa57-a87fad8827f4
          stepCounter: fd180a2f-15e9-4fed-bbc5-17cb1d19b67d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PLANNED_REVIEW_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2f373f7-1c7e-4b2a-81bc-6e400af1e62c
                stepCounter: 9e89e89f-4fe9-4a5e-8b07-866623118452
            transform: '1'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96e0bd26-6640-4332-adf6-14ab8f59eb39
          stepCounter: fd180a2f-15e9-4fed-bbc5-17cb1d19b67d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies: []
        join:
          joinCondition: |-
            FROM s_planned_review_NASC_v
              LEFT OUTER JOIN (
                    SELECT programme_id,
                           MAX(review_type) review_type
                      FROM s_support_plan_NASC_10
                     GROUP BY programme_id
                   ) s_support_plan_NASC_10
                ON s_planned_review_NASC_v.programme_id = s_support_plan_NASC_10.programme_id
        name: S_PLANNED_REVIEW_NASC_10
        noLinkRefs: []
  name: S_PLANNED_REVIEW_NASC_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
