fileVersion: 1
id: af178a82-a37e-4f26-ad7d-e05f15a0dcee
name: S_ED_SEEN_BY_05_CENTRIC
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Seen by info sourced from Centric."
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d07758b3-0394-4c49-b8cf-a76b60b78eb7
          stepCounter: af178a82-a37e-4f26-ad7d-e05f15a0dcee
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CACHENUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9fe1daa9-9d45-412c-afc2-9ccdb84eb882
                stepCounter: 60ab9d33-92b5-415b-8c36-69df6265898d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25c61361-a599-4cc9-84b6-104b944320de
          stepCounter: af178a82-a37e-4f26-ad7d-e05f15a0dcee
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 689fcdbf-c459-4faf-95ae-35ac1e3d1548
                stepCounter: 3780b6ae-de68-49c7-aff3-0a34c07e229f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d2f7d10-263d-423d-95b5-8bf9e4c45c61
          stepCounter: af178a82-a37e-4f26-ad7d-e05f15a0dcee
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: AEATT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dba6e569-0eb6-49a2-8e0b-c50fa5562fc3
                stepCounter: 60ab9d33-92b5-415b-8c36-69df6265898d
            transform: SUBSTRING(ds_centric_Patient_Clinician.encounter, 2, 20)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5333631-a186-4409-9103-339e9a97d005
          stepCounter: af178a82-a37e-4f26-ad7d-e05f15a0dcee
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b35850f1-588a-4a0a-afb8-add22820d99c
                stepCounter: 60ab9d33-92b5-415b-8c36-69df6265898d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c285f39b-514c-40cd-bfd4-91c567b3fc8b
          stepCounter: af178a82-a37e-4f26-ad7d-e05f15a0dcee
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: EPISODETYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'E'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: daa7ddc0-45e4-4a59-892c-2001514b3e42
          stepCounter: af178a82-a37e-4f26-ad7d-e05f15a0dcee
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Original value of Patient NHI from Source (may contain Encounter ID)
        name: WHITEBOARD_PATIENTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce08e6ee-6507-4273-91b6-68d491666b56
                stepCounter: 60ab9d33-92b5-415b-8c36-69df6265898d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4010faa5-0903-40a8-ae11-eeb2e1720580
          stepCounter: af178a82-a37e-4f26-ad7d-e05f15a0dcee
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Derived from Whiteboard Patient ID
        name: PATIENTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce08e6ee-6507-4273-91b6-68d491666b56
                stepCounter: 60ab9d33-92b5-415b-8c36-69df6265898d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c5363e2-6f1d-4305-a986-06bf4781c069
          stepCounter: af178a82-a37e-4f26-ad7d-e05f15a0dcee
        config: {}
        dataType: VARCHAR(170)
        defaultValue: ""
        description: ""
        name: PATIENTFULLNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59281c8e-8639-4425-bfae-7f113857df4e
          stepCounter: af178a82-a37e-4f26-ad7d-e05f15a0dcee
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SPECIALTYID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef5f7466-1675-49bd-a439-2b8e4ca5a2b1
          stepCounter: af178a82-a37e-4f26-ad7d-e05f15a0dcee
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 86b530d6-a9a9-40c5-82cb-e7811c26b29f
                stepCounter: b2d7a019-6237-4a72-88cd-1bae78be8a8b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a4c57031-9231-41b4-acfb-a471b3580ea5
          stepCounter: af178a82-a37e-4f26-ad7d-e05f15a0dcee
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: HOSPITAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76f12c9b-3638-4332-a64b-7e450c3d1b49
                stepCounter: 523d842b-4fef-4e04-97c8-3354993cb557
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 61f73cfa-e917-41a4-8bf0-c75571533d20
          stepCounter: af178a82-a37e-4f26-ad7d-e05f15a0dcee
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LOCATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2206f504-19be-4372-90bc-31e3fa965a54
                stepCounter: 523d842b-4fef-4e04-97c8-3354993cb557
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31a0fa8d-4115-41bf-97e0-d27bb4c5a242
          stepCounter: af178a82-a37e-4f26-ad7d-e05f15a0dcee
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SERVICE_POINT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d697c24-09bb-426b-ac8e-106535a5f515
                stepCounter: 2ba00b75-4b69-44b1-874d-b68a17a3810d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f87227e5-4354-4cab-aef8-13d71901bd97
          stepCounter: af178a82-a37e-4f26-ad7d-e05f15a0dcee
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FACILITYCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76f12c9b-3638-4332-a64b-7e450c3d1b49
                stepCounter: 523d842b-4fef-4e04-97c8-3354993cb557
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb141563-ae78-41c6-8a30-db68eb487877
          stepCounter: af178a82-a37e-4f26-ad7d-e05f15a0dcee
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CLINIC_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c285060-6dc5-4497-b1d5-c867c0a647a5
          stepCounter: af178a82-a37e-4f26-ad7d-e05f15a0dcee
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ARRIVEDDTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bd6036cc-4caf-4fa7-955b-36c2ac5a99bb
                stepCounter: 99bbbe22-5934-4b71-a05c-126d23681f8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b3c9111-6121-47f0-b4ca-fae1dfff40ae
          stepCounter: af178a82-a37e-4f26-ad7d-e05f15a0dcee
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: TRIAGECATEGORY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 821b4e6e-964f-4aae-bea3-45882d5658bc
          stepCounter: af178a82-a37e-4f26-ad7d-e05f15a0dcee
        config: {}
        dataType: VARCHAR(512)
        defaultValue: ""
        description: ""
        name: PRESENTINGCOMPLAINT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ade2b2c-c185-4334-89f0-c54fa5b6bfb0
          stepCounter: af178a82-a37e-4f26-ad7d-e05f15a0dcee
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: BEDREQUESTSTATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8c4a431-121c-4a72-bd64-c8c7c08ef93b
          stepCounter: af178a82-a37e-4f26-ad7d-e05f15a0dcee
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CURRENTSTATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a9c09a8-4088-4bcf-8cb5-9aa31e8a8797
          stepCounter: af178a82-a37e-4f26-ad7d-e05f15a0dcee
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ASSIGNEDNURSEID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8c61bc0-ac70-4f07-aac1-872e8d37df14
          stepCounter: af178a82-a37e-4f26-ad7d-e05f15a0dcee
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NURSESEENBYDTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48aedbde-6bbc-4c82-a61e-d5b0b5044730
          stepCounter: af178a82-a37e-4f26-ad7d-e05f15a0dcee
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ASSIGNEDDOCTORID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94437a9d-870f-45aa-b66e-f5f7509b4d47
          stepCounter: af178a82-a37e-4f26-ad7d-e05f15a0dcee
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SEENBYDOCTORID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 19db9b4a-6855-4c02-830c-c49ebcebf22d
          stepCounter: af178a82-a37e-4f26-ad7d-e05f15a0dcee
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: treatmentprotocolid
        name: TREATMENTPROTOCOLID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4bf0ce4-db07-400e-8628-be024f333e0a
                stepCounter: bd13b777-a329-4951-97c9-c2573930ff73
            transform: |-
              -- Centric IDs in dim_ED_treatment_protocol have 1000 added.
              s_ips_pathway_record_v.pathwayId + 1000
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03ac192c-65fc-4964-8499-247fadd732fa
          stepCounter: af178a82-a37e-4f26-ad7d-e05f15a0dcee
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DOCTORSEENBYDTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 874c144d-b4ab-4294-9b4d-4c691a82e84c
          stepCounter: af178a82-a37e-4f26-ad7d-e05f15a0dcee
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SEENBYDOCTORSURNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e96bf55-d2bc-4d66-a011-7f5353caf826
          stepCounter: af178a82-a37e-4f26-ad7d-e05f15a0dcee
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SEENBYDOCTORFIRSTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 310913e8-eec9-4b16-b811-1f4a3814676b
          stepCounter: af178a82-a37e-4f26-ad7d-e05f15a0dcee
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: CONSULTANT_HEALTHCARE_PROFESSIONAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cf7cb395-d12e-4f04-acd3-784289e6c1d1
                stepCounter: 60ab9d33-92b5-415b-8c36-69df6265898d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27df5720-54b8-4e16-889d-d793443be71c
          stepCounter: af178a82-a37e-4f26-ad7d-e05f15a0dcee
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ASSIGNEDCONSULTANTSURNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb29871d-b626-4d77-92c8-4f4ee64dddcd
          stepCounter: af178a82-a37e-4f26-ad7d-e05f15a0dcee
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: ASSIGNEDCONSULTANTFIRSTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5eabcf3d-f321-4f35-9d71-56848f152447
          stepCounter: af178a82-a37e-4f26-ad7d-e05f15a0dcee
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: DISCHARGETYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff2c897f-a253-497a-8a17-41bf0ef4172f
          stepCounter: af178a82-a37e-4f26-ad7d-e05f15a0dcee
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DISCHARGECLINICIANID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a20829b6-fa1d-475d-864c-211a828f12dd
          stepCounter: af178a82-a37e-4f26-ad7d-e05f15a0dcee
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DISCHARGECLINICIANTYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d49a9d9-98ea-49e8-a8d8-b78c49a5ca9c
          stepCounter: af178a82-a37e-4f26-ad7d-e05f15a0dcee
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MEDICALDISCHARGEDTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19b9ba6d-f0b0-40d7-951e-e2e7b3c20f78
                stepCounter: 99bbbe22-5934-4b71-a05c-126d23681f8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ec3c30a-6417-4be3-bdd5-be3b07fffe36
          stepCounter: af178a82-a37e-4f26-ad7d-e05f15a0dcee
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SITEDEPARTEDDTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3bc6b225-5ec5-4541-840d-a42767e450f4
                stepCounter: 99bbbe22-5934-4b71-a05c-126d23681f8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be1cd687-7e04-48f9-8e16-1a16f4a0f1b0
          stepCounter: af178a82-a37e-4f26-ad7d-e05f15a0dcee
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PERFORMEDACTION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a2c39d5-4652-4481-b04f-828447b47ed8
          stepCounter: af178a82-a37e-4f26-ad7d-e05f15a0dcee
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ACTIONDTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ede0d04-0bf6-483b-bd60-2976ca28c3a2
                stepCounter: 60ab9d33-92b5-415b-8c36-69df6265898d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d06e4528-7cc9-4d54-9717-04928577efc6
          stepCounter: af178a82-a37e-4f26-ad7d-e05f15a0dcee
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: TRANSACTIONDTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c0d096e2-a4e9-4a84-83e2-5afcbf98929c
                stepCounter: 60ab9d33-92b5-415b-8c36-69df6265898d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07546281-243a-4c81-88fd-c0e2c8870f04
          stepCounter: af178a82-a37e-4f26-ad7d-e05f15a0dcee
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: table_number
        name: TABLE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '2'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce99a717-a5c3-49b4-9e51-ff2f1305334a
          stepCounter: af178a82-a37e-4f26-ad7d-e05f15a0dcee
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: rn
        name: RN
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ROW_NUMBER() OVER (PARTITION BY ds_centric_Patient_Clinician.id ORDER BY ds_centric_Patient_Clinician.id)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cbefe1b1-c8e3-49fc-b560-183e9077547d
          stepCounter: af178a82-a37e-4f26-ad7d-e05f15a0dcee
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_CENTRIC_PATIENT_CLINICIAN
        join:
          joinCondition: |-
            FROM s_centric_encounter_changes
              JOIN ds_centric_Patient_Clinician
                ON s_centric_encounter_changes.encounter = ds_centric_Patient_Clinician.encounter
              LEFT OUTER JOIN ds_centric_WB_Patient
                ON ds_centric_Patient_Clinician.nhi = ds_centric_WB_Patient.nhi
               AND ds_centric_Patient_Clinician.encounter = ds_centric_WB_Patient.encounter
              LEFT OUTER JOIN l_centric_Patient_Specialty
                ON ds_centric_Patient_Clinician.nhi = l_centric_Patient_Specialty.nhi
               AND ds_centric_Patient_Clinician.aesty_refno = l_centric_Patient_Specialty.aesty_refno
              LEFT OUTER JOIN l_centric_Patient_Location
                ON ds_centric_Patient_Clinician.nhi = l_centric_Patient_Location.nhi
               AND ds_centric_Patient_Clinician.aesty_refno = l_centric_Patient_Location.aesty_refno
              LEFT OUTER JOIN l_centric_Locations
                ON l_centric_Locations.ipmBedCode = l_centric_Patient_Location.ipmBedCode
               AND l_centric_Locations.deletedDTTM IS NULL
              LEFT OUTER JOIN s_ips_pathway_record_v
                ON s_ips_pathway_record_v.nhi = ds_centric_Patient_Clinician.nhi
               AND s_ips_pathway_record_v.encounter = ds_centric_Patient_Clinician.encounter
               AND s_ips_pathway_record_v.row_num = 1
        name: S_ED_SEEN_BY_05_CENTRIC
        noLinkRefs: []
  name: S_ED_SEEN_BY_05_CENTRIC
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
