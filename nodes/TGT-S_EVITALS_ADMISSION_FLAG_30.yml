fileVersion: 1
id: 432d1ae0-8bf7-472d-b6d2-54366c14d4ea
name: S_EVITALS_ADMISSION_FLAG_30
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Strip down column admission_note leaving just the last set of characters delimited by a pipe."
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39536ea1-552f-404a-8e1e-e2b24710f652
          stepCounter: 432d1ae0-8bf7-472d-b6d2-54366c14d4ea
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ADMISSION_FLAG_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef94cd12-c916-4cf8-85e9-b6b6d936fe20
                stepCounter: 17800dce-ce48-4da6-94b8-550ed58c38e5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ff35560-ab8b-449a-afc8-0d1c35c28b18
          stepCounter: 432d1ae0-8bf7-472d-b6d2-54366c14d4ea
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ADMISSION_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8669752-860d-47d8-ae0b-57f7ef153010
                stepCounter: 17800dce-ce48-4da6-94b8-550ed58c38e5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 339a840f-5e2a-4733-a07e-5285472de6e9
          stepCounter: 432d1ae0-8bf7-472d-b6d2-54366c14d4ea
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient NHI number.
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 62172925-fa30-4783-9d2f-67e98b66aefe
                stepCounter: 17800dce-ce48-4da6-94b8-550ed58c38e5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d803749-39a8-49c4-ba46-56b834decf8e
          stepCounter: 432d1ae0-8bf7-472d-b6d2-54366c14d4ea
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: FLAG_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 12a4b7aa-292f-41f5-930c-3aed0af6a7c0
                stepCounter: 17800dce-ce48-4da6-94b8-550ed58c38e5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 63bb1059-f266-46f2-b0b3-c6fd226ab3d9
          stepCounter: 432d1ae0-8bf7-472d-b6d2-54366c14d4ea
        config: {}
        dataType: CHAR(5)
        defaultValue: ""
        description: ""
        name: FLAG_DOMAIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a121ce8-6f1b-4919-8c09-3fa4799b6bb8
                stepCounter: 17800dce-ce48-4da6-94b8-550ed58c38e5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd1791ec-1ede-4348-8122-078326105873
          stepCounter: 432d1ae0-8bf7-472d-b6d2-54366c14d4ea
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FLAG_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c3ca939d-4c01-41d8-9275-e02649f82a27
                stepCounter: 17800dce-ce48-4da6-94b8-550ed58c38e5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa2589be-6859-40f4-840a-af6221065219
          stepCounter: 432d1ae0-8bf7-472d-b6d2-54366c14d4ea
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: FLAG_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d0faf72-c660-41fc-a24b-5b77e69ff0b8
                stepCounter: 17800dce-ce48-4da6-94b8-550ed58c38e5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6278e4b6-c3f6-486e-befd-fd5de295d0fe
          stepCounter: 432d1ae0-8bf7-472d-b6d2-54366c14d4ea
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FLAG_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3211632e-8ff1-4f40-87da-f5f24a050833
                stepCounter: 17800dce-ce48-4da6-94b8-550ed58c38e5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ff3ed8a-1282-4f3e-9974-861065e10053
          stepCounter: 432d1ae0-8bf7-472d-b6d2-54366c14d4ea
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FLAG_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa66ee29-c85a-404f-9f61-5ba19506f816
                stepCounter: 17800dce-ce48-4da6-94b8-550ed58c38e5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3bb0d27-f4cd-47c8-bdf8-568616748ed5
          stepCounter: 432d1ae0-8bf7-472d-b6d2-54366c14d4ea
        config: {}
        dataType: VARCHAR(200)
        defaultValue: ""
        description: Part of the admission note prior to the first pipe character.
        name: FIRST_ADMISSION_NOTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c6723fa-69ef-4b2a-8cb8-d0572141f282
                stepCounter: 17800dce-ce48-4da6-94b8-550ed58c38e5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7459177-d7e8-4297-a7e7-fab2f0a10e7d
          stepCounter: 432d1ae0-8bf7-472d-b6d2-54366c14d4ea
        config: {}
        dataType: VARCHAR(200)
        defaultValue: ""
        description: Part of the admission note after the last pipe character. Will be null if no pipes found.
        name: LAST_ADMISSION_NOTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 465c2e5c-744a-4259-a3f6-3c33d78bfce9
                stepCounter: 17800dce-ce48-4da6-94b8-550ed58c38e5
            transform: |-
              CASE WHEN first_note = last_note THEN ''
                          WHEN first_note IS NOT NULL THEN IFNULL(last_note, '')
                          ELSE last_note
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4681ff5-b5f5-4413-ae4b-29f8138098ff
          stepCounter: 432d1ae0-8bf7-472d-b6d2-54366c14d4ea
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CREATED_USER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 97e451b0-9969-4290-a901-06f909699ae4
                stepCounter: 17800dce-ce48-4da6-94b8-550ed58c38e5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e7f2440-ffd7-4df3-8f56-283e551841e3
          stepCounter: 432d1ae0-8bf7-472d-b6d2-54366c14d4ea
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FLAG_CREATED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e50026e-ef84-47d6-b164-3e9739d434da
                stepCounter: 17800dce-ce48-4da6-94b8-550ed58c38e5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c719d779-360e-4d9f-9b2f-781e142c44d3
          stepCounter: 432d1ae0-8bf7-472d-b6d2-54366c14d4ea
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: MODIFIED_USER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7363ac46-49fe-4acf-911b-9b0fca24ec96
                stepCounter: 17800dce-ce48-4da6-94b8-550ed58c38e5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 541292e4-ec87-4435-aec2-501ca6429a73
          stepCounter: 432d1ae0-8bf7-472d-b6d2-54366c14d4ea
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FLAG_MODFIED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d722e156-e8eb-4563-9765-f8c43af719f6
                stepCounter: 17800dce-ce48-4da6-94b8-550ed58c38e5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88da7a8c-a58e-4f0f-861a-17545213b9e3
          stepCounter: 432d1ae0-8bf7-472d-b6d2-54366c14d4ea
        config: {}
        dataType: INT
        defaultValue: ""
        description: Integer ID that uniquely identifies an observation set in Patientrack. Sourced from obset_pk.
        name: OBSERVATION_SET_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52f145bc-4ff0-42a7-af75-3306cdf96088
                stepCounter: c1903550-bd87-42b1-bba3-941161362397
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d4db691-1d35-4b55-ba75-33a8604cd707
          stepCounter: 432d1ae0-8bf7-472d-b6d2-54366c14d4ea
        config: {}
        dataType: INT
        defaultValue: ""
        description: Integer ID that uniquely identifies an observation set in Patientrack. Sourced from obset_pk.
        name: CURRENT_OBSERVATION_SET_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cf06acd7-f425-4163-90a2-2839022d9941
                stepCounter: c1903550-bd87-42b1-bba3-941161362397
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6995e13-aa8c-47c2-b2c3-3e6f1f8190e6
          stepCounter: 432d1ae0-8bf7-472d-b6d2-54366c14d4ea
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: Look up to Patient Management System to match Inpatient or ED event associated with the observation set for the patient as PatienTrack version becomes unreliable under certain conditions
        name: MATCHED_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 87736553-e1fe-497c-bfb8-c37e64d51008
                stepCounter: c1903550-bd87-42b1-bba3-941161362397
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a14dd47-fe93-478e-89d8-3254dfb5c10f
          stepCounter: 432d1ae0-8bf7-472d-b6d2-54366c14d4ea
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_EVITALS_ADMISSION_FLAG_10
        join:
          joinCondition: |-
            FROM s_eVitals_admission_flag_10
              LEFT OUTER JOIN s_eVitals_admission_flag_20
                ON s_eVitals_admission_flag_20.admission_flag_id = s_eVitals_admission_flag_10.admission_flag_id
               AND s_eVitals_admission_flag_20.row_num = 1
        name: S_EVITALS_ADMISSION_FLAG_30
        noLinkRefs: []
  name: S_EVITALS_ADMISSION_FLAG_30
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
