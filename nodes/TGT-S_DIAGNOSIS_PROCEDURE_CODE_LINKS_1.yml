fileVersion: 1
id: 09259da2-dd4b-4547-9b99-07e0117522c4
name: S_DIAGNOSIS_PROCEDURE_CODE_LINKS_1
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc61203d-cf10-4cb2-9ce6-98df2f2518ce
          stepCounter: 09259da2-dd4b-4547-9b99-07e0117522c4
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_LINK_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4c93363-0a57-46e2-a503-6c787b30521e
                stepCounter: 9e7c57fa-a09d-41a5-9ea9-2a2367aa7dbc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7622ad8c-7178-4489-a03f-a21620bf6d0a
          stepCounter: 09259da2-dd4b-4547-9b99-07e0117522c4
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1= the most recent mapped valu form a code list by start_date
        name: MAP_SEQUENCE
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ROW_NUMBER() OVER (PARTITION BY ds_pims_odpcd_code_links.FROM_ODPCD_REFNO ,ds_pims_odpcd_codes.ccsxt_code ORDER BY ds_pims_odpcd_code_links.START_DTTM DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82f71c75-e2ec-43c7-bb40-056ba747c777
          stepCounter: 09259da2-dd4b-4547-9b99-07e0117522c4
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: FROM_ODPCD_REFERENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ed6dd3c-263e-47e6-9d59-4c75b2205e4e
                stepCounter: 9e7c57fa-a09d-41a5-9ea9-2a2367aa7dbc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b3830e8a-3802-48c2-a494-1ed8cdd8cbf7
          stepCounter: 09259da2-dd4b-4547-9b99-07e0117522c4
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: TO_ODPCD_REFERENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 45bb6ff0-085b-4458-a650-80527a46fba1
                stepCounter: 9e7c57fa-a09d-41a5-9ea9-2a2367aa7dbc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d17cec0b-9182-4eed-b4b3-b7ae3c82b710
          stepCounter: 09259da2-dd4b-4547-9b99-07e0117522c4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8fc85521-b365-49b0-ab4a-98b6801c7cb4
                stepCounter: 9e7c57fa-a09d-41a5-9ea9-2a2367aa7dbc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7944a076-061f-4496-b987-e79e0c6cde9f
          stepCounter: 09259da2-dd4b-4547-9b99-07e0117522c4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9aace648-ab88-4fcb-810f-d5941763232b
                stepCounter: 9e7c57fa-a09d-41a5-9ea9-2a2367aa7dbc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e3170ac-b541-4937-964f-26b6d2977963
          stepCounter: 09259da2-dd4b-4547-9b99-07e0117522c4
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 69e79d4e-4038-413e-a887-e2194fc00a0b
                stepCounter: 9e7c57fa-a09d-41a5-9ea9-2a2367aa7dbc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fbacf8e0-7c8d-408c-b2a6-f455297824d0
          stepCounter: 09259da2-dd4b-4547-9b99-07e0117522c4
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MODIFY_USER_LOGON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23a2ecd7-7d9f-40a8-9087-acb954869298
                stepCounter: 9e7c57fa-a09d-41a5-9ea9-2a2367aa7dbc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 680898dc-471a-4217-a295-ffdb5a52eedc
          stepCounter: 09259da2-dd4b-4547-9b99-07e0117522c4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a5b3732-9300-47a4-a1fd-ce2bb14e75ef
                stepCounter: 9e7c57fa-a09d-41a5-9ea9-2a2367aa7dbc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 371dd0da-26bd-450c-bfad-34024c911e34
          stepCounter: 09259da2-dd4b-4547-9b99-07e0117522c4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIFY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a8cdeca7-ab8f-494f-b4b7-adb3d3f0b7e9
                stepCounter: 9e7c57fa-a09d-41a5-9ea9-2a2367aa7dbc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bab88032-3806-4176-ba07-76e93a860986
          stepCounter: 09259da2-dd4b-4547-9b99-07e0117522c4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce926fd2-6430-4eb3-b6ba-fb347c954088
                stepCounter: 314df606-ff6a-4436-bfb4-272353ca2b9e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed7141a2-21b5-4693-a609-4a358c87cc01
          stepCounter: 09259da2-dd4b-4547-9b99-07e0117522c4
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: CCSXT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cc2f5486-2ed2-49c9-81e6-0c2bb9bd27bf
                stepCounter: 314df606-ff6a-4436-bfb4-272353ca2b9e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3027582f-c3d2-4e9c-8892-b400f6582ed2
          stepCounter: 09259da2-dd4b-4547-9b99-07e0117522c4
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CODE_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2b78537e-2603-4547-936d-1413eb60d381
                stepCounter: 314df606-ff6a-4436-bfb4-272353ca2b9e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba7d296f-533a-4d51-b907-cd6baf77afa9
          stepCounter: 09259da2-dd4b-4547-9b99-07e0117522c4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DS_PIMS_ODPCD_CODE_LINKS: 9e7c57fa-a09d-41a5-9ea9-2a2367aa7dbc
          DS_PIMS_ODPCD_CODES: 314df606-ff6a-4436-bfb4-272353ca2b9e
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_PIMS_ODPCD_CODE_LINKS
          - locationName: TGT
            nodeName: DS_PIMS_ODPCD_CODES
        join:
          joinCondition: |-
            FROM {{ ref('TGT','DS_PIMS_ODPCD_CODE_LINKS') }}
              JOIN {{ ref('TGT','DS_PIMS_ODPCD_CODES') }}
                ON ds_pims_odpcd_code_links.TO_ODPCD_REFNO = ds_pims_odpcd_codes.odpcd_refno
        name: S_DIAGNOSIS_PROCEDURE_CODE_LINKS_1
        noLinkRefs: []
  name: S_DIAGNOSIS_PROCEDURE_CODE_LINKS_1
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
