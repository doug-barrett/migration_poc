fileVersion: 1
id: 16046caa-0e21-4501-abd9-fc6a817b0803
name: DIM_LO_SAP_ACCT_PER_DATE
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25381cf9-3703-41d6-b9ba-0b0525bb8912
          stepCounter: 16046caa-0e21-4501-abd9-fc6a817b0803
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated key for the date dimension. Nominal format is YYYYMMDD, but DD equal to 0 and greater than 31 permited for special date handling.
        name: DIM_ACCT_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d67dd194-392b-41c2-a867-1d286b03a749
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45fe8510-7013-4779-ad36-b2fca6a58b30
          stepCounter: 16046caa-0e21-4501-abd9-fc6a817b0803
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: The calendar date for this row.
        name: DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9cafcfb4-e64b-48a7-a8b7-ac2946945d8c
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 230decd1-0e30-4ef2-b458-4d968a7c5bd8
          stepCounter: 16046caa-0e21-4501-abd9-fc6a817b0803
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The calendar month number 1-12.
        name: MONTH_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c65aa60-d958-46ff-a0ff-7fd9866c63be
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: TO_NUMBER(TO_CHAR(DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE),'MM'),'99')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: feb7cc2a-c8fa-4938-9ac2-6e4764eba6d6
          stepCounter: 16046caa-0e21-4501-abd9-fc6a817b0803
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: 'The calendar month representation. Format YYYYMM. Example: 200206.'
        name: MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 705122d1-4e8b-4357-8445-cf24443c78b6
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: TO_NUMBER(TO_CHAR(DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE),'YYYYMM'),'999999')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1df75793-4292-4abd-8148-5484021079da
          stepCounter: 16046caa-0e21-4501-abd9-fc6a817b0803
        config: {}
        dataType: VARCHAR(7)
        defaultValue: ""
        description: 'The calendar month name. Format MON. Examples: jan, feb, mar.'
        name: MONTH_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ebed47fc-a249-4cfc-839b-753f0dd2390c
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: TO_CHAR(DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE),'Mon')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f12b1db8-084c-4949-b4c5-7c5c726712c8
          stepCounter: 16046caa-0e21-4501-abd9-fc6a817b0803
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The calendar quarter number 1-4.
        name: QUARTER_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ed2507c-0acd-42e0-88dc-c56344ac7d6d
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: TO_NUMBER(TO_CHAR(DATE_PART('Q',DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE))),'9')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b1175af-a330-4673-b995-9479a19c9b3d
          stepCounter: 16046caa-0e21-4501-abd9-fc6a817b0803
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: QUARTER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ed2507c-0acd-42e0-88dc-c56344ac7d6d
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: TO_NUMBER(TO_CHAR(DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE),'YYYY'),'9999') || ' Q' || TO_NUMBER(TO_CHAR(DATE_PART('Q',DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE))),'9')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16427f7d-0b56-416c-aca0-3a08c721830f
          stepCounter: 16046caa-0e21-4501-abd9-fc6a817b0803
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The calendar quarter representation. Format YYYYQQ. Example 200204.
        name: QUARTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51d9af37-47d2-4723-a6c5-f3cafaf883c0
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: TO_NUMBER(TO_CHAR(DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE), 'YYYY') || '0' || TO_CHAR(DATE_PART('Q',DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE))), '999999')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bca1ec7a-c305-4d76-9611-111df4bc61cf
          stepCounter: 16046caa-0e21-4501-abd9-fc6a817b0803
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The calendar year. Format YYYY
        name: YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52559a82-8e7c-4739-8223-a5afc69ed5a3
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: TO_NUMBER(TO_CHAR(DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE),'YYYY'),'9999')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21ffa03e-d0c0-4dcb-8eef-6480a3e5b26e
          stepCounter: 16046caa-0e21-4501-abd9-fc6a817b0803
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: YEAR_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52559a82-8e7c-4739-8223-a5afc69ed5a3
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: "'ACCOUNTING ' || TO_NUMBER(TO_CHAR(DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE),'YYYY'),'9999')"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b247bd85-23fc-4ad0-b0b5-92cc31c3390d
          stepCounter: 16046caa-0e21-4501-abd9-fc6a817b0803
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: YEAR_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52559a82-8e7c-4739-8223-a5afc69ed5a3
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: TO_NUMBER(TO_CHAR(DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE),'YYYY'),'9999') || ' - ' || TO_CHAR(DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE),'Mon')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b46049c-4029-4848-97f6-9d34a43386a9
          stepCounter: 16046caa-0e21-4501-abd9-fc6a817b0803
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate the current month. Set as per current_cal_day.
        name: CURRENT_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7a81ac4-125b-4a7c-a258-81162fe2e311
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: DECODE(DIM_DATE.DIM_DATE_KEY,0,'No',DIM_DATE.CURRENT_CAL_MONTH)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff57779c-37a4-44b7-9091-5d23cc0ab3e1
          stepCounter: 16046caa-0e21-4501-abd9-fc6a817b0803
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate the current year. Set as per current_cal_day.
        name: CURRENT_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d98f4b5-c5df-443a-a8e6-2cada8b59e1d
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: DECODE(DIM_DATE.DIM_DATE_KEY,0,'No',DIM_DATE.CURRENT_CAL_YEAR)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dda310b0-1426-422f-9fef-d06c4d12fe1e
          stepCounter: 16046caa-0e21-4501-abd9-fc6a817b0803
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate days in the current month to date. Set as per current_cal_day.
        name: CURRENT_MTD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa668c22-1a25-40a1-b22d-ab5e6ed4fa65
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: DECODE(DIM_DATE.DIM_DATE_KEY,0,'No',DIM_DATE.CURRENT_CAL_MTD)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 08809b78-c567-493e-b5ad-b7b2a12c8bb7
          stepCounter: 16046caa-0e21-4501-abd9-fc6a817b0803
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate days in the current year to date. Set as per current_cal_day.
        name: CURRENT_YTD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a7ff769-cb53-4c9c-beb6-f23a5309087a
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: DECODE(DIM_DATE.DIM_DATE_KEY,0,'No',DIM_DATE.CURRENT_CAL_YTD)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d92645b-0d6d-409a-9919-0927e57d986e
          stepCounter: 16046caa-0e21-4501-abd9-fc6a817b0803
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate days that constitute a full year counting back from the current day. Set as per current_cal_day.
        name: MOVING_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 88fcac99-72c8-450a-8b6b-89f8b982f741
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: DECODE(DIM_DATE.DIM_DATE_KEY,0,'No',DIM_DATE.MOVING_CAL_YEAR)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ecedbff-aacd-41be-944b-8a0958eb9bd7
          stepCounter: 16046caa-0e21-4501-abd9-fc6a817b0803
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date/time that this record was inserted in the data warehouse
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c04cbc11-68f6-4f7e-8836-e29eac1879f2
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b65c2203-a8cf-4897-92fa-9abef204889b
          stepCounter: 16046caa-0e21-4501-abd9-fc6a817b0803
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date/time that this record was updated in the data warehouse
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 989dc3b8-ad89-43bb-85a2-83ea36a1a9de
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DIM_DATE: e36e3241-fb91-480b-b6e9-be9a8d12930f
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: DIM_DATE
        join:
          joinCondition: FROM {{ ref('TARGET','DIM_DATE') }}
        name: DIM_LO_SAP_ACCT_PER_DATE
        noLinkRefs: []
  name: DIM_LO_SAP_ACCT_PER_DATE
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
