fileVersion: 1
id: 030f9454-0584-4b79-8319-768ccf1fc4ab
name: DIM_LO_SAP_ACCT_PER_DATE
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 181c6f17-4ebf-46a1-b5ba-e8fd39fce1a8
          stepCounter: 030f9454-0584-4b79-8319-768ccf1fc4ab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated key for the date dimension. Nominal format is YYYYMMDD, but DD equal to 0 and greater than 31 permited for special date handling.
        name: DIM_ACCT_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f10c496e-43e4-4922-b52a-6ad1c4ad8e74
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0531083-75c3-40ab-9120-804f63efb3a4
          stepCounter: 030f9454-0584-4b79-8319-768ccf1fc4ab
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: The calendar date for this row.
        name: DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22fc0aa6-a875-4164-ab11-fd35b6a269ec
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0aa8ade8-ea2f-416a-81c0-9e5c62d4ed74
          stepCounter: 030f9454-0584-4b79-8319-768ccf1fc4ab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The calendar month number 1-12.
        name: MONTH_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 101a7a76-b6e1-4e7a-99ec-cbfefd368862
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: TO_NUMBER(TO_CHAR(DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE),'MM'),'99')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8f66efe-8fca-4f42-9b74-da6124009467
          stepCounter: 030f9454-0584-4b79-8319-768ccf1fc4ab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: 'The calendar month representation. Format YYYYMM. Example: 200206.'
        name: MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c44bfcf3-11ec-463f-9a7c-b6c87dbfa903
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: TO_NUMBER(TO_CHAR(DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE),'YYYYMM'),'999999')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc06b556-7477-405e-81eb-3fd83fdc053e
          stepCounter: 030f9454-0584-4b79-8319-768ccf1fc4ab
        config: {}
        dataType: VARCHAR(7)
        defaultValue: ""
        description: 'The calendar month name. Format MON. Examples: jan, feb, mar.'
        name: MONTH_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 37be88a7-ff8a-46d7-b4bc-d309ffeef97a
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: TO_CHAR(DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE),'Mon')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc0e3f8a-110a-4991-ae85-c19feb702d39
          stepCounter: 030f9454-0584-4b79-8319-768ccf1fc4ab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The calendar quarter number 1-4.
        name: QUARTER_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75b5251d-c8ee-4b60-ab66-5042d173479c
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: TO_NUMBER(TO_CHAR(DATE_PART('Q',DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE))),'9')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69f1216f-1c3c-44e2-bb2b-aa0bb08a08ec
          stepCounter: 030f9454-0584-4b79-8319-768ccf1fc4ab
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: QUARTER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75b5251d-c8ee-4b60-ab66-5042d173479c
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: TO_NUMBER(TO_CHAR(DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE),'YYYY'),'9999') || ' Q' || TO_NUMBER(TO_CHAR(DATE_PART('Q',DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE))),'9')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 226a9944-ebb3-4cb7-8ffd-a4f10f69ea42
          stepCounter: 030f9454-0584-4b79-8319-768ccf1fc4ab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The calendar quarter representation. Format YYYYQQ. Example 200204.
        name: QUARTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b83e744a-bea9-41ee-a1a1-c0c855a6b4a3
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: TO_NUMBER(TO_CHAR(DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE), 'YYYY') || '0' || TO_CHAR(DATE_PART('Q',DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE))), '999999')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dae3dab8-4928-40de-82e1-409b43e8cb1c
          stepCounter: 030f9454-0584-4b79-8319-768ccf1fc4ab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The calendar year. Format YYYY
        name: YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7dc8b9d7-b462-4cf5-8544-d9b98f76c383
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: TO_NUMBER(TO_CHAR(DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE),'YYYY'),'9999')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: effd5e5d-5135-4ad9-a01b-7a047cf0ac54
          stepCounter: 030f9454-0584-4b79-8319-768ccf1fc4ab
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: YEAR_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7dc8b9d7-b462-4cf5-8544-d9b98f76c383
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: "'ACCOUNTING ' || TO_NUMBER(TO_CHAR(DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE),'YYYY'),'9999')"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88b62d63-9583-47e7-a110-0b79f84448b8
          stepCounter: 030f9454-0584-4b79-8319-768ccf1fc4ab
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: YEAR_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7dc8b9d7-b462-4cf5-8544-d9b98f76c383
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: TO_NUMBER(TO_CHAR(DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE),'YYYY'),'9999') || ' - ' || TO_CHAR(DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE),'Mon')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6667d58-4b5b-4417-8f22-d66f5b5ab0bf
          stepCounter: 030f9454-0584-4b79-8319-768ccf1fc4ab
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate the current month. Set as per current_cal_day.
        name: CURRENT_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c8abb136-d9ea-44b6-bd0c-b3beb4271a0b
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: DECODE(DIM_DATE.DIM_DATE_KEY,0,'No',DIM_DATE.CURRENT_CAL_MONTH)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4fc53155-8c0c-4aa5-931c-34d05b40c2da
          stepCounter: 030f9454-0584-4b79-8319-768ccf1fc4ab
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate the current year. Set as per current_cal_day.
        name: CURRENT_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f99f829f-5044-4d00-af54-6675d1b1abd1
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: DECODE(DIM_DATE.DIM_DATE_KEY,0,'No',DIM_DATE.CURRENT_CAL_YEAR)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cbb85f6b-1760-496a-923e-a7169d895542
          stepCounter: 030f9454-0584-4b79-8319-768ccf1fc4ab
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate days in the current month to date. Set as per current_cal_day.
        name: CURRENT_MTD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3f4acc77-5529-4206-a1c2-9541dc57724b
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: DECODE(DIM_DATE.DIM_DATE_KEY,0,'No',DIM_DATE.CURRENT_CAL_MTD)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4582b757-b1de-4530-8e54-f91dd45f5a18
          stepCounter: 030f9454-0584-4b79-8319-768ccf1fc4ab
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate days in the current year to date. Set as per current_cal_day.
        name: CURRENT_YTD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b233f7d-fbf8-4645-babf-d20f3ab279f4
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: DECODE(DIM_DATE.DIM_DATE_KEY,0,'No',DIM_DATE.CURRENT_CAL_YTD)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cfe65741-0c7e-4a4b-aadb-42b69988d94b
          stepCounter: 030f9454-0584-4b79-8319-768ccf1fc4ab
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate days that constitute a full year counting back from the current day. Set as per current_cal_day.
        name: MOVING_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5871881f-8bd7-445d-9872-ad07ae4c46e4
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: DECODE(DIM_DATE.DIM_DATE_KEY,0,'No',DIM_DATE.MOVING_CAL_YEAR)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ff07778-f8cc-43a9-8ab7-0cd0898923c7
          stepCounter: 030f9454-0584-4b79-8319-768ccf1fc4ab
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date/time that this record was inserted in the data warehouse
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0fea260d-2077-4417-b8d7-31fd14652b30
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ddfc9fc-51d8-479b-a578-1483318482cf
          stepCounter: 030f9454-0584-4b79-8319-768ccf1fc4ab
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date/time that this record was updated in the data warehouse
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee1a52d9-502e-4f9a-853f-104f1152f9a8
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DIM_DATE: 514e5b21-eab9-4985-9a00-e22a0e84a361
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: DIM_DATE
        join:
          joinCondition: FROM {{ ref('TARGET','DIM_DATE') }}
        name: DIM_LO_SAP_ACCT_PER_DATE
        noLinkRefs: []
  name: DIM_LO_SAP_ACCT_PER_DATE
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
