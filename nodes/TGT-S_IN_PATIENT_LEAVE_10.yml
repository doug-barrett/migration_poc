fileVersion: 1
id: dfdef104-6c44-45aa-aafa-cb47c0158ab0
name: S_IN_PATIENT_LEAVE_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72b2b8ca-b8ec-40ba-a613-ee6372ca91a2
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c20f32fb-48f7-4590-8fe8-6860b55571af
                stepCounter: 0078f140-2991-41a6-bc3a-cf398f0bb29e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03040fed-4a9d-4c34-96bd-a25b6c671e56
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2f0b54fd-8a70-4962-804a-3a959e09b993
                stepCounter: 0078f140-2991-41a6-bc3a-cf398f0bb29e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 177b27a8-7bc7-43c4-b453-d5f315040d5a
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_leave_10.event_encounter_type_code=dim_encounter_type.encounter_type_code
        name: DIM_ENCOUNTER_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3ba8df3-db2e-40a1-97dc-d5ad6a5186a7
                stepCounter: 1d0ea6a1-9563-4fb3-a1fa-9d43dbdf296e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e16b9f68-0c3d-4d55-938c-fc189642f2bf
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e73d3914-34db-4309-a827-663b849fbcea
                stepCounter: 0078f140-2991-41a6-bc3a-cf398f0bb29e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f08fec5-e5d1-4370-bc83-3732df90c66c
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: HOME_LEAVE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 541a3c07-8a69-4344-b488-c395b07ce2aa
                stepCounter: 0078f140-2991-41a6-bc3a-cf398f0bb29e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f49e773-08d8-4ccc-9fa6-785d99d7f55a
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 08758d20-51e4-4f7b-94b7-948a91ebd6f6
                stepCounter: 0078f140-2991-41a6-bc3a-cf398f0bb29e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c90b59d9-ede7-4881-8cf9-79c3bd1ce94e
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAY_REFERENCE_NO_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5530b89e-9731-4607-af90-3d6a84f3e791
                stepCounter: 0078f140-2991-41a6-bc3a-cf398f0bb29e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f09da902-b118-450f-90de-8b2ba11102c9
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LEAVE_PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f88ded1e-bebb-46ab-a529-5b7a5af573c6
                stepCounter: 0078f140-2991-41a6-bc3a-cf398f0bb29e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1313c85-ce61-4d8a-9e5a-425cffd8ae92
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LEAVE_PATIENT_REFERENCE_NO_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 398374a7-571f-4931-9812-458046f8f802
                stepCounter: 0078f140-2991-41a6-bc3a-cf398f0bb29e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9af62039-44af-4925-8f33-af7f697b8c3c
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 985f0ba0-97cf-4152-a49b-7e86cb71409e
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 248342e5-1fae-495a-bc01-608e6bee932e
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_leave_10.leave_patient_reference_no=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9962a01b-5f3d-4c1a-b371-997edef38d0f
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 192b8a8f-fc4c-404a-b11b-0fbf987f54e1
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a9e4d4e7-d3f1-4df8-bcfa-f4f716ba12ba
                stepCounter: 0078f140-2991-41a6-bc3a-cf398f0bb29e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f6ced25-4bc4-48a3-b1a3-a2e59f75c755
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_leave_10.ward_code=dim_ward.ward_code
        name: DIM_WARD_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6aa5e7b8-4dc5-4b87-a4c2-5013db0e1dfc
                stepCounter: 50c31151-9204-4154-9caf-5d28244bde1a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6126fcaf-398b-4b4c-bc54-83b78bf20b0f
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f6e707a4-ff1f-4ed1-8d5c-49454c7a5b32
                stepCounter: 0078f140-2991-41a6-bc3a-cf398f0bb29e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71c24739-c624-4b28-88e1-4adc829ec9f4
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_leave_10.clinician_reference_no=dim_clinician.clinician_reference_no
        name: DIM_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 911a8788-86e5-4a5c-a00a-a957d59070b8
                stepCounter: e8e4a684-3ef8-4076-846f-48d5689e824f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16971bd2-b450-40f3-91ce-b4a445ff2c71
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5decf3a5-291d-4c13-aa92-1dfa4f49d1e8
                stepCounter: 0078f140-2991-41a6-bc3a-cf398f0bb29e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c355b24-08ca-49a7-8e4a-e9212076be03
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_leave_10.specialty_reference_no=dim_specialty.specialty_reference_no
        name: DIM_SPECIALTY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79aee918-ff6f-4b0a-a656-000827899f3e
                stepCounter: 4182a75e-d07b-4637-97fa-4c01e2878360
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64fcadb2-f988-4b30-8d03-0e50c988938f
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMISSION_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 299bb283-0b4f-4ef9-a3b3-9ad625c68757
                stepCounter: 0078f140-2991-41a6-bc3a-cf398f0bb29e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec461b37-831a-43b8-afb4-d002e2a57e19
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: INT
        defaultValue: ""
        description: s_in_patient_leave_10.CONVERT(date,admit_date)=dim_admission_date.admission_calendar_date
        name: DIM_ADMISSION_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b402ec63-d2cf-47e5-ab27-e5c03a6296f4
                stepCounter: 9996feda-efbd-41f4-8569-36f5c8b63c75
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fea8d6b3-a645-47f2-8d64-fd82da60a92a
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a681d89-3608-4ebd-928f-4744cd7175ee
                stepCounter: 0078f140-2991-41a6-bc3a-cf398f0bb29e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98e56120-5acd-4b4e-94eb-8a3a9e358854
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCHARGE_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9e7e5803-7fed-4429-ac62-debeaa0b5015
                stepCounter: 0078f140-2991-41a6-bc3a-cf398f0bb29e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c65af5d-35d1-4904-bc79-bf41c019dc89
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: INT
        defaultValue: ""
        description: s_in_patient_leave_10.CONVERT(date,disch_date)=dim_discharge_date.discharge_calendar_date
        name: DIM_DISCHARGE_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 985b56af-022e-46b3-82b0-51ae204ca926
                stepCounter: 45fbd3a8-64d0-4be6-b03a-8d128a18b549
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fbfb1979-d507-4232-8123-8512f042938f
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LEAVE_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ff70325-ded7-449b-aa33-41496767231d
                stepCounter: 0078f140-2991-41a6-bc3a-cf398f0bb29e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bda319b6-02aa-4d4b-b1e1-e5313937bd1a
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_leave_10.leave_type_reference_no=dim_leave_type.leave_type_reference_no
        name: DIM_LEAVE_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f3bc2335-d452-4354-9ecd-e686aae96457
                stepCounter: e0e492bc-c42d-467c-be16-a27d6b2ad8b3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2d3a917-6327-47c8-a5ca-afda3fd25aec
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LEAVE_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 895c41c5-52e4-43fa-b7ef-2f6920067e89
                stepCounter: 0078f140-2991-41a6-bc3a-cf398f0bb29e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f45d6e6-90fe-464a-9abd-3b9d5a0f7114
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_leave_10.leave_reason_reference_no=dim_leave_reason.leave_reason_reference_no
        name: DIM_LEAVE_REASON_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 651ddf87-8f8e-4619-ab74-3aca4b3c8522
                stepCounter: d17204dd-0ebc-4ca9-81a2-04159ec7294c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 85cc98fd-7731-4f9a-860d-ab1dadf3c4a2
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LEAVE_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd7741bc-e30b-4f63-bcd6-80461b6d940a
                stepCounter: 0078f140-2991-41a6-bc3a-cf398f0bb29e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e83e6f6-3ebb-4e5b-ab3d-97861b390ac7
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LEAVE_START_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eed9e55a-248e-4cc2-ad76-7e224c98e606
                stepCounter: 0078f140-2991-41a6-bc3a-cf398f0bb29e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2bacd0f-261c-4a0e-9c89-d67f50abc083
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_leave_10.CONVERT(date,s_in_patient_leave_05.leave_start_date)=dim_leave_start_date.leave_start_calendar_date
        name: DIM_LEAVE_START_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5b91998-fa0f-4130-b97e-f0cb7cb9c2c4
                stepCounter: c76a6611-5c73-4438-acea-a34a7ff27f82
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e9a64b3-ee87-4b0a-b105-1266b19a3867
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: STAY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cc01d369-1954-4ce6-b8c1-a1f36dc06913
                stepCounter: 0078f140-2991-41a6-bc3a-cf398f0bb29e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78acdcf1-b400-4e0a-8500-7e828d5a7b69
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: INT
        defaultValue: ""
        description: s_in_patient_leave_10.CONVERT(date,stay_start_date)=dim_stay_start_date.stay_start_calendar_date
        name: DIM_STAY_START_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b442fea-c72d-4a06-ba4d-ed4b58ee5dbb
                stepCounter: f6a5fae2-5a40-4523-824d-c265ca1bc409
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9215f71-0644-457b-87c1-0c81df3d8750
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LEAVE_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9bae86fb-a620-4103-b2c8-3c749990744e
                stepCounter: 0078f140-2991-41a6-bc3a-cf398f0bb29e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59300740-cfef-479e-bd3c-72e2f9491b67
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LEAVE_END_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8af496a7-6586-4fdb-a697-d80a7e92f930
                stepCounter: 0078f140-2991-41a6-bc3a-cf398f0bb29e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8553633-0de1-4987-ac59-686906208844
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_leave_10.CONVERT(date,s_in_patient_leave_05.leave_end_date)=dim_leave_end_date.leave_end_calendar_date
        name: DIM_LEAVE_END_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b8b59779-e5c7-49d2-b62f-760de34ca7c4
                stepCounter: e64e9602-f652-4ca9-adbe-fd76f5ef9e70
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b584345-a2d2-472c-90b3-b8f3bb13f19a
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: STAY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a42ff15b-29f6-46a4-a6c9-8389c8ce7306
                stepCounter: 0078f140-2991-41a6-bc3a-cf398f0bb29e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2fc8f735-8306-40ba-b53a-1a80d451964a
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: INT
        defaultValue: ""
        description: s_in_patient_leave_10.CONVERT(date,stay_end_date)=dim_stay_end_date.stay_end_calendar_date
        name: DIM_STAY_END_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8c85017-50dd-42e9-aadb-9f1aa7ee54d3
                stepCounter: 2d82251b-b816-4891-b02b-7b0b9160306d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 44f4ac7c-63ef-43aa-bd03-5ad716735b8e
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: EXPECTED_RETURN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56ea6051-532f-4611-9abd-7f2e02e8db84
                stepCounter: 0078f140-2991-41a6-bc3a-cf398f0bb29e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 89bf6d6a-794b-4a7e-934b-c71e17686bae
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: RECALL_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 70971d45-0498-4a5a-ae53-7848ddd3bc5d
                stepCounter: 0078f140-2991-41a6-bc3a-cf398f0bb29e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 664c3178-160d-42e5-9b8c-6e2bc4d8606e
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LATEST_RETURN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c6f0f147-ee0e-41c6-a6db-a595783826f7
                stepCounter: 0078f140-2991-41a6-bc3a-cf398f0bb29e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 531e06f6-08df-4f05-888b-452643cd6c99
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_LEAVE_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 70d9cf6e-bd6c-4f1a-8a46-54ca79ef1f14
                stepCounter: 0078f140-2991-41a6-bc3a-cf398f0bb29e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2fb8b2b7-7b16-41e8-9957-1904e83680e6
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_LEAVE_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 469304df-ebef-4b86-b936-ae5707c5b101
                stepCounter: 0078f140-2991-41a6-bc3a-cf398f0bb29e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b513da29-9ea6-4121-a55c-6f8c04837e98
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: duration_unit
        name: DURATION_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'day'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67f69e50-08dc-4719-8405-4c61577ee3df
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_LEAVE_TOTAL_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d649d141-3afb-4fee-b79e-69e0548a3f71
                stepCounter: 0078f140-2991-41a6-bc3a-cf398f0bb29e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8af97cc-8536-4d26-b55c-168eda4f6dff
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_LEAVE_TOTAL_DURATION_MINUTES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d01d3af5-2186-4bd6-9d6f-349f6a2e7161
                stepCounter: 0078f140-2991-41a6-bc3a-cf398f0bb29e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 37164eda-3e96-436d-ba52-b90330369043
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DSS_DATA_QUALITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f0151e5-c47e-4b8c-a963-e74c4f3b8084
                stepCounter: 0078f140-2991-41a6-bc3a-cf398f0bb29e
            transform: |-
              CASE WHEN (s_in_patient_leave_05.leave_start_date <> s_in_patient_leave_05.leave_start_date_orig OR s_in_patient_leave_05.leave_end_date <> s_in_patient_leave_05.leave_end_date_orig OR s_in_patient_leave_05.admit_date <> s_in_patient_leave_05.admit_date_orig OR s_in_patient_leave_05.disch_date <> s_in_patient_leave_05.disch_date_orig) AND s_in_patient_leave_05.event_patnt_refno <> s_in_patient_leave_05.patnt_refno THEN 'DT,NHI'
                          ELSE CASE WHEN (s_in_patient_leave_05.leave_start_date <> s_in_patient_leave_05.leave_start_date_orig OR s_in_patient_leave_05.leave_end_date <> s_in_patient_leave_05.leave_end_date_orig OR s_in_patient_leave_05.admit_date <> s_in_patient_leave_05.admit_date_orig OR s_in_patient_leave_05.disch_date <> s_in_patient_leave_05.disch_date_orig) THEN 'DT' ELSE CASE WHEN s_in_patient_leave_05.event_patnt_refno <> s_in_patient_leave_05.patnt_refno THEN 'NHI' END END
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5423374-05a9-4fac-a392-51766f1e73bd
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a0a6ecbd-aa4e-48de-bdd7-e35a3f3f2e8c
          stepCounter: dfdef104-6c44-45aa-aafa-cb47c0158ab0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMISSION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c3c061d4-28dc-4bfb-ba50-02a61ef4d0ff
                stepCounter: 0078f140-2991-41a6-bc3a-cf398f0bb29e
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_IN_PATIENT_LEAVE_05
        join:
          joinCondition: |-
            FROM s_in_patient_leave_05
              LEFT OUTER JOIN dim.dim_ward
                ON s_in_patient_leave_05.spont_refno = dim_ward.ward_reference_no
               AND IFNULL(dim_ward.dss_start_date, GETDATE()-10000) <= s_in_patient_leave_05.leave_start_date
               AND IFNULL(dim_ward.dss_end_date, GETDATE()+10000) >= s_in_patient_leave_05.leave_start_date
        name: S_IN_PATIENT_LEAVE_10
        noLinkRefs: []
  name: S_IN_PATIENT_LEAVE_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
