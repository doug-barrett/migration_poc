fileVersion: 1
id: 8b3951ea-5680-4cf2-b1ee-d203eb788b32
name: VIEW_DIM_FDC_ACTIVITY_PERIOD_DATE
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96b6dab9-57cb-462f-8023-32d03e190ea0
          stepCounter: 8b3951ea-5680-4cf2-b1ee-d203eb788b32
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated key for the date dimension. Nominal format is YYYYMMDD, but DD equal to 0 and greater than 31 permited for special date handling.
        name: DIM_ACTIVITY_PERIOD_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d67dd194-392b-41c2-a867-1d286b03a749
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d0ad837-d480-48d6-a9a3-11d8cb25c48d
          stepCounter: 8b3951ea-5680-4cf2-b1ee-d203eb788b32
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: ACTIVITY_YEAR_GROUP
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52559a82-8e7c-4739-8223-a5afc69ed5a3
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: |-
              CASE WHEN DIM_DATE.CAL_YEAR <= (TO_NUMBER(YEAR(GETDATE())) - 3) THEN 'Prior Activity Periods'
                          WHEN DIM_DATE.CAL_YEAR >= (TO_NUMBER(YEAR(GETDATE())) + 3) THEN 'Future Activity Periods'
                          ELSE 'ACTIVITY ' || TO_VARCHAR(DIM_DATE.CAL_YEAR)
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb5639e9-7080-4671-8b1b-6a561b3f3b75
          stepCounter: 8b3951ea-5680-4cf2-b1ee-d203eb788b32
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: The calendar date for this row.
        name: FULL_DATE_DISPLAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9cafcfb4-e64b-48a7-a8b7-ac2946945d8c
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0267c68c-d6c6-40e2-ac33-5da6c1946953
          stepCounter: 8b3951ea-5680-4cf2-b1ee-d203eb788b32
        config: {}
        dataType: DATE
        defaultValue: ""
        description: The calendar date for this row.
        name: FULL_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9cafcfb4-e64b-48a7-a8b7-ac2946945d8c
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4c94c10-09bb-4e6c-91ee-b9087f19aa01
          stepCounter: 8b3951ea-5680-4cf2-b1ee-d203eb788b32
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: The calendar year. Format YYYY
        name: ACTIVITY_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52559a82-8e7c-4739-8223-a5afc69ed5a3
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: TO_VARCHAR(CAL_YEAR) || ' - ' || CAL_MONTH_NAME
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c4f172d-7e29-4aab-88e5-0ee0ed92e0f7
          stepCounter: 8b3951ea-5680-4cf2-b1ee-d203eb788b32
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The calendar month number 1-12.
        name: ACTIVITY_MONTH_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c65aa60-d958-46ff-a0ff-7fd9866c63be
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 621dd201-cc3c-4b22-a287-5a31ef46d53f
          stepCounter: 8b3951ea-5680-4cf2-b1ee-d203eb788b32
        config: {}
        dataType: VARCHAR(7)
        defaultValue: ""
        description: 'The calendar month name. Format MON. Examples: jan, feb, mar.'
        name: ACTIVITY_MONTH_NAME_SHORT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ebed47fc-a249-4cfc-839b-753f0dd2390c
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 880dfff0-0fe0-4b03-9fcc-4b3fe96a8b0a
          stepCounter: 8b3951ea-5680-4cf2-b1ee-d203eb788b32
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: 'The calendar month representation. Format YYYYMM. Example: 200206.'
        name: MONTH_SORT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 705122d1-4e8b-4357-8445-cf24443c78b6
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df62e5d0-cb55-4bba-a888-7f990733fab9
          stepCounter: 8b3951ea-5680-4cf2-b1ee-d203eb788b32
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: The calendar year. Format YYYY
        name: ACTIVITY_QUARTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52559a82-8e7c-4739-8223-a5afc69ed5a3
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: TO_VARCHAR(CAL_YEAR) || ' Q' || CAL_QUARTER_NO
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7cd77142-f23e-40a3-bd83-0d1121de3a30
          stepCounter: 8b3951ea-5680-4cf2-b1ee-d203eb788b32
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The calendar quarter number 1-4.
        name: ACTIVITY_QUARTER_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ed2507c-0acd-42e0-88dc-c56344ac7d6d
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5de4a01d-1629-4dad-b917-bd7ceab226bd
          stepCounter: 8b3951ea-5680-4cf2-b1ee-d203eb788b32
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: The calendar quarter number 1-4.
        name: ACTIVITY_QUARTER_NAME_SHORT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ed2507c-0acd-42e0-88dc-c56344ac7d6d
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: "'Q' || CAL_QUARTER_NO"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df890b22-5ce7-4855-93d7-d6970605d363
          stepCounter: 8b3951ea-5680-4cf2-b1ee-d203eb788b32
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The calendar year. Format YYYY
        name: QUARTER_SORT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52559a82-8e7c-4739-8223-a5afc69ed5a3
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: TO_VARCHAR(CAL_YEAR) || RIGHT('0' || TO_VARCHAR(CAL_QUARTER_NO),2)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 46295238-1e68-4d66-96f2-bb9c6605f675
          stepCounter: 8b3951ea-5680-4cf2-b1ee-d203eb788b32
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: The calendar year. Format YYYY
        name: ACTIVITY_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52559a82-8e7c-4739-8223-a5afc69ed5a3
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: "'ACTIVITY ' || TO_VARCHAR(CAL_YEAR)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49a9c5b8-0d77-4e70-9797-2a9522f94775
          stepCounter: 8b3951ea-5680-4cf2-b1ee-d203eb788b32
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The calendar year. Format YYYY
        name: ACTIVITY_YEAR_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52559a82-8e7c-4739-8223-a5afc69ed5a3
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66a1d79a-0572-45dd-9f25-994f5598f693
          stepCounter: 8b3951ea-5680-4cf2-b1ee-d203eb788b32
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: The calendar date for this row.
        name: WEEK_SPAN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9cafcfb4-e64b-48a7-a8b7-ac2946945d8c
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: LEFT(TO_VARCHAR(DATEADD(DD, CASE CAL_DAY_IN_WEEK_NO WHEN 7 THEN 0 ELSE CAL_DAY_IN_WEEK_NO * -1 END, CALENDAR_DATE)), 10) || ' - ' || LEFT(TO_VARCHAR(DATEADD(DD, 7 - CASE CAL_DAY_IN_WEEK_NO WHEN 7 THEN 1 ELSE CAL_DAY_IN_WEEK_NO + 1 END, CALENDAR_DATE)), 10)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1db38b67-53d5-4197-9366-d556d2fea9f0
          stepCounter: 8b3951ea-5680-4cf2-b1ee-d203eb788b32
        config: {}
        dataType: DATE
        defaultValue: ""
        description: The day number in the week. 1-7 where Sunday is day 1.
        name: WEEK_START_DATE_FULL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ccbc1fa-3e2f-49bd-aa87-eb8e51d6511d
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: DATEADD(DD, CASE CAL_DAY_IN_WEEK_NO WHEN 7 THEN 0 ELSE CAL_DAY_IN_WEEK_NO * -1 END, CALENDAR_DATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80dd489b-bcd9-4970-a9fc-726ad5134c74
          stepCounter: 8b3951ea-5680-4cf2-b1ee-d203eb788b32
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: The day number in the week. 1-7 where Sunday is day 1.
        name: WEEK_START_DATE_DD_MON_YYYY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ccbc1fa-3e2f-49bd-aa87-eb8e51d6511d
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: TO_VARCHAR(DATEADD(DD, CASE CAL_DAY_IN_WEEK_NO WHEN 7 THEN 0 ELSE CAL_DAY_IN_WEEK_NO * -1 END, CALENDAR_DATE), 'DD_MON_YYYY')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2ab120b-0f19-4266-8aaf-5e14e4ec06fc
          stepCounter: 8b3951ea-5680-4cf2-b1ee-d203eb788b32
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Flag to indicate if a week day Y=week day N=week end.
        name: WEEKDAY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 599f3243-0653-4907-9193-d776ccb16627
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb295b2e-1644-4f9c-8827-69b484008382
          stepCounter: 8b3951ea-5680-4cf2-b1ee-d203eb788b32
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: The calendar date for this row.
        name: FIRST_DAY_OF_CALENDAR_MONTH_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9cafcfb4-e64b-48a7-a8b7-ac2946945d8c
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: |-
              CASE WHEN TO_DATE(DATE_TRUNC(MM,CALENDAR_DATE)) = CALENDAR_DATE THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db5e97a7-bce8-4231-8422-87675fb92226
          stepCounter: 8b3951ea-5680-4cf2-b1ee-d203eb788b32
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: The calendar date for this row.
        name: LAST_DAY_OF_CALENDAR_MONTH_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9cafcfb4-e64b-48a7-a8b7-ac2946945d8c
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: |-
              CASE WHEN TO_DATE(LAST_DAY(CALENDAR_DATE)) = CALENDAR_DATE THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d96fa8d0-1384-4d3c-82e6-00d8936b25ed
          stepCounter: 8b3951ea-5680-4cf2-b1ee-d203eb788b32
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NUMBER_OF_DAYS
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: '1'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 707a5a8d-74a5-43b6-8977-5f6341a56bb6
          stepCounter: 8b3951ea-5680-4cf2-b1ee-d203eb788b32
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: The calendar date for this row.
        name: YTD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9cafcfb4-e64b-48a7-a8b7-ac2946945d8c
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: |-
              CASE WHEN CALENDAR_DATE BETWEEN TO_DATE(TO_VARCHAR(DATE_PART(YY,GETDATE()) || '-01-01')) AND GETDATE() THEN 'YES'
                          ELSE 'NO'
                           END
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DIM_DATE: e36e3241-fb91-480b-b6e9-be9a8d12930f
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: DIM_DATE
        join:
          joinCondition: |-
            FROM {{ ref('TARGET','DIM_DATE') }} DIM_DATE
             WHERE DIM_DATE.DIM_DATE_KEY != 0
        name: VIEW_DIM_FDC_ACTIVITY_PERIOD_DATE
        noLinkRefs: []
  name: VIEW_DIM_FDC_ACTIVITY_PERIOD_DATE
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
