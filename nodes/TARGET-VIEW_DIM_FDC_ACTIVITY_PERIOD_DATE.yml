fileVersion: 1
id: 3e87f02f-8fe3-47a8-8853-5e53097df39e
name: VIEW_DIM_FDC_ACTIVITY_PERIOD_DATE
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f7a9888-2442-444a-90e4-4fa74035c6d2
          stepCounter: 3e87f02f-8fe3-47a8-8853-5e53097df39e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated key for the date dimension. Nominal format is YYYYMMDD, but DD equal to 0 and greater than 31 permited for special date handling.
        name: DIM_ACTIVITY_PERIOD_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f10c496e-43e4-4922-b52a-6ad1c4ad8e74
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 339367fc-7e70-4e6f-b9f3-dacb5f76c694
          stepCounter: 3e87f02f-8fe3-47a8-8853-5e53097df39e
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: ACTIVITY_YEAR_GROUP
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7dc8b9d7-b462-4cf5-8544-d9b98f76c383
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: |-
              CASE WHEN DIM_DATE.CAL_YEAR <= (TO_NUMBER(YEAR(GETDATE())) - 3) THEN 'Prior Activity Periods'
                          WHEN DIM_DATE.CAL_YEAR >= (TO_NUMBER(YEAR(GETDATE())) + 3) THEN 'Future Activity Periods'
                          ELSE 'ACTIVITY ' || TO_VARCHAR(DIM_DATE.CAL_YEAR)
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 90109059-3543-445e-bea1-ed7f2a403b47
          stepCounter: 3e87f02f-8fe3-47a8-8853-5e53097df39e
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: The calendar date for this row.
        name: FULL_DATE_DISPLAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22fc0aa6-a875-4164-ab11-fd35b6a269ec
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c4d076c-a141-4c2e-9b30-96dcedc1ea47
          stepCounter: 3e87f02f-8fe3-47a8-8853-5e53097df39e
        config: {}
        dataType: DATE
        defaultValue: ""
        description: The calendar date for this row.
        name: FULL_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22fc0aa6-a875-4164-ab11-fd35b6a269ec
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c8f390b-6db9-49ee-9c90-ff8ee7fcc5cb
          stepCounter: 3e87f02f-8fe3-47a8-8853-5e53097df39e
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: The calendar year. Format YYYY
        name: ACTIVITY_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7dc8b9d7-b462-4cf5-8544-d9b98f76c383
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: TO_VARCHAR(CAL_YEAR) || ' - ' || CAL_MONTH_NAME
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a691b9ec-d322-464d-b88c-ab06e8023669
          stepCounter: 3e87f02f-8fe3-47a8-8853-5e53097df39e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The calendar month number 1-12.
        name: ACTIVITY_MONTH_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 101a7a76-b6e1-4e7a-99ec-cbfefd368862
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c82dc27-c05a-4649-b090-e040268f1250
          stepCounter: 3e87f02f-8fe3-47a8-8853-5e53097df39e
        config: {}
        dataType: VARCHAR(7)
        defaultValue: ""
        description: 'The calendar month name. Format MON. Examples: jan, feb, mar.'
        name: ACTIVITY_MONTH_NAME_SHORT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 37be88a7-ff8a-46d7-b4bc-d309ffeef97a
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b92435b1-a447-43df-b078-6f1e648efe5e
          stepCounter: 3e87f02f-8fe3-47a8-8853-5e53097df39e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: 'The calendar month representation. Format YYYYMM. Example: 200206.'
        name: MONTH_SORT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c44bfcf3-11ec-463f-9a7c-b6c87dbfa903
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f73ea041-8d57-489f-b0a2-4710e686eac7
          stepCounter: 3e87f02f-8fe3-47a8-8853-5e53097df39e
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: The calendar year. Format YYYY
        name: ACTIVITY_QUARTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7dc8b9d7-b462-4cf5-8544-d9b98f76c383
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: TO_VARCHAR(CAL_YEAR) || ' Q' || CAL_QUARTER_NO
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 46071739-fcca-4c47-8f72-390e4c533f23
          stepCounter: 3e87f02f-8fe3-47a8-8853-5e53097df39e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The calendar quarter number 1-4.
        name: ACTIVITY_QUARTER_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75b5251d-c8ee-4b60-ab66-5042d173479c
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1edca827-6c76-4663-95c1-2416da6b86c9
          stepCounter: 3e87f02f-8fe3-47a8-8853-5e53097df39e
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: The calendar quarter number 1-4.
        name: ACTIVITY_QUARTER_NAME_SHORT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75b5251d-c8ee-4b60-ab66-5042d173479c
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: "'Q' || CAL_QUARTER_NO"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c77f1b66-c473-490d-9f31-0308751728ee
          stepCounter: 3e87f02f-8fe3-47a8-8853-5e53097df39e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The calendar year. Format YYYY
        name: QUARTER_SORT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7dc8b9d7-b462-4cf5-8544-d9b98f76c383
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: TO_VARCHAR(CAL_YEAR) || RIGHT('0' || TO_VARCHAR(CAL_QUARTER_NO),2)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9feed6fe-1574-44d5-8a7f-9cf9c2adab6d
          stepCounter: 3e87f02f-8fe3-47a8-8853-5e53097df39e
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: The calendar year. Format YYYY
        name: ACTIVITY_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7dc8b9d7-b462-4cf5-8544-d9b98f76c383
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: "'ACTIVITY ' || TO_VARCHAR(CAL_YEAR)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f3e84a55-831b-4451-b71d-905397bc9345
          stepCounter: 3e87f02f-8fe3-47a8-8853-5e53097df39e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The calendar year. Format YYYY
        name: ACTIVITY_YEAR_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7dc8b9d7-b462-4cf5-8544-d9b98f76c383
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 211ada97-5931-41a0-a095-900d811ea953
          stepCounter: 3e87f02f-8fe3-47a8-8853-5e53097df39e
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: The calendar date for this row.
        name: WEEK_SPAN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22fc0aa6-a875-4164-ab11-fd35b6a269ec
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: LEFT(TO_VARCHAR(DATEADD(DD, CASE CAL_DAY_IN_WEEK_NO WHEN 7 THEN 0 ELSE CAL_DAY_IN_WEEK_NO * -1 END, CALENDAR_DATE)), 10) || ' - ' || LEFT(TO_VARCHAR(DATEADD(DD, 7 - CASE CAL_DAY_IN_WEEK_NO WHEN 7 THEN 1 ELSE CAL_DAY_IN_WEEK_NO + 1 END, CALENDAR_DATE)), 10)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5bf9b71a-8728-4be6-8fc9-3315fcbe3d1d
          stepCounter: 3e87f02f-8fe3-47a8-8853-5e53097df39e
        config: {}
        dataType: DATE
        defaultValue: ""
        description: The day number in the week. 1-7 where Sunday is day 1.
        name: WEEK_START_DATE_FULL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c854c772-cd6b-483a-9099-b657c75d4f39
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: DATEADD(DD, CASE CAL_DAY_IN_WEEK_NO WHEN 7 THEN 0 ELSE CAL_DAY_IN_WEEK_NO * -1 END, CALENDAR_DATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a642ae6-a4cd-44be-a56d-d2300fb7765d
          stepCounter: 3e87f02f-8fe3-47a8-8853-5e53097df39e
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: The day number in the week. 1-7 where Sunday is day 1.
        name: WEEK_START_DATE_DD_MON_YYYY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c854c772-cd6b-483a-9099-b657c75d4f39
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: TO_VARCHAR(DATEADD(DD, CASE CAL_DAY_IN_WEEK_NO WHEN 7 THEN 0 ELSE CAL_DAY_IN_WEEK_NO * -1 END, CALENDAR_DATE), 'DD_MON_YYYY')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21f47965-c3ff-454e-a3fa-0c51eba3b874
          stepCounter: 3e87f02f-8fe3-47a8-8853-5e53097df39e
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Flag to indicate if a week day Y=week day N=week end.
        name: WEEKDAY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b21af778-ee7f-43ae-b52c-941748194fd7
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9fadd30d-981e-4af8-9e6c-540cce197d15
          stepCounter: 3e87f02f-8fe3-47a8-8853-5e53097df39e
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: The calendar date for this row.
        name: FIRST_DAY_OF_CALENDAR_MONTH_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22fc0aa6-a875-4164-ab11-fd35b6a269ec
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: |-
              CASE WHEN TO_DATE(DATE_TRUNC(MM,CALENDAR_DATE)) = CALENDAR_DATE THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff1f6ff5-dbda-4bde-891c-34b7065fc560
          stepCounter: 3e87f02f-8fe3-47a8-8853-5e53097df39e
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: The calendar date for this row.
        name: LAST_DAY_OF_CALENDAR_MONTH_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22fc0aa6-a875-4164-ab11-fd35b6a269ec
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: |-
              CASE WHEN TO_DATE(LAST_DAY(CALENDAR_DATE)) = CALENDAR_DATE THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f1decf51-e11b-4a47-ac4c-180cad225841
          stepCounter: 3e87f02f-8fe3-47a8-8853-5e53097df39e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NUMBER_OF_DAYS
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: '1'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ee8f77e-cd85-44b8-8138-03e48170498d
          stepCounter: 3e87f02f-8fe3-47a8-8853-5e53097df39e
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: The calendar date for this row.
        name: YTD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22fc0aa6-a875-4164-ab11-fd35b6a269ec
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: |-
              CASE WHEN CALENDAR_DATE BETWEEN TO_DATE(TO_VARCHAR(DATE_PART(YY,GETDATE()) || '-01-01')) AND GETDATE() THEN 'YES'
                          ELSE 'NO'
                           END
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DIM_DATE: 514e5b21-eab9-4985-9a00-e22a0e84a361
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: DIM_DATE
        join:
          joinCondition: |-
            FROM {{ ref('TARGET','DIM_DATE') }} DIM_DATE
             WHERE DIM_DATE.DIM_DATE_KEY != 0
        name: VIEW_DIM_FDC_ACTIVITY_PERIOD_DATE
        noLinkRefs: []
  name: VIEW_DIM_FDC_ACTIVITY_PERIOD_DATE
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
