fileVersion: 1
id: eea19e0f-50ee-466a-9a1f-0ef01b469903
name: S_ED_SEEN_BY_30
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Dimensionalise the \"Seen-By Clinician\" events, from the WhiteBoard (WB), which occurred during a PIMS ED Encounter/Stays"
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ddc79a6-f4d9-4bce-b725-6523c07a7233
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WHITEBOARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 99e64803-1cd5-4d53-89cb-0e79d4ab2730
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dd0e4337-400b-43c3-82c0-f5f66a0fca95
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: attendance_encounter_id
        name: ATTENDANCE_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50a48107-0f97-4cca-8f8a-9b672a4dabde
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1aec5d20-43d8-4518-ae95-322e71def3ad
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: attendance_encounter_type_code
        name: ATTENDANCE_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6587599f-b95d-4a22-88b7-674923b74a4f
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e22c946a-c6ef-45f1-947b-2d234c731c49
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_ed_seen_by_30.attendance_encounter_type_code=dim_encounter_type.encounter_type_code
        name: DIM_ENCOUNTER_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3ba8df3-db2e-40a1-97dc-d5ad6a5186a7
                stepCounter: 1d0ea6a1-9563-4fb3-a1fa-9d43dbdf296e
            transform: IFNULL(dim_encounter_type.dim_encounter_type_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e4e46b92-c065-4cb2-94c2-bb3a1de1a091
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: EPISODE_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50ca1aeb-ccfb-4ea7-a87a-1aada55ed1e1
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 93381ee5-ba93-44e9-a3f0-b627ed6f376e
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: current seen-by sequence number within an encounter
        name: ATTENDANCE_SEEN_BY_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e22e1cdd-60a8-4a7d-8e83-3314d9501c78
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 52b28a42-8ac2-4744-a218-7bd168050b3e
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ATTENDANCE_SEEN_BY_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 80439ec5-5020-400d-8bbe-acd971c08165
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9da21e95-79a5-4467-a59e-24174439a3fe
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time patient arrived for encounter
        name: ATTENDANCE_ARRIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8d924cba-deef-4bcb-a36a-436ab322a3dd
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: baf36fc6-e24a-43d1-a3b0-2d283f04c699
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time patient departed
        name: ATTENDANCE_DEPARTED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6053b3d3-19d5-4d17-8fc5-16f3fe570537
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6664e86b-7d87-455c-85bc-a04a7350b03c
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Patient Reference Number
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e65ba134-c911-4a9a-82d3-1ac2c621c98d
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98cda1ce-6a6a-4e20-bf87-b06095aa7452
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 205bb18d-8bcf-4812-8cd9-2d459b93daa7
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a99c8b0c-6971-4f2c-8595-94f1c61d46c2
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Patient_Date_Of_Birth
        name: PATIENT_DATE_OF_BIRTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 537a8744-ad31-4b38-8aec-9bd619174cd4
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2e9d4eb-876e-4f30-a6b0-adb8ef86ecba
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_ed_seen_by_30.patient_reference_no=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9962a01b-5f3d-4c1a-b371-997edef38d0f
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: IFNULL(dim_patient.dim_patient_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48b7c39d-e401-4dbf-8e08-2183d3ab004e
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: HOSPITAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 15b793fb-56e7-484e-9e78-603586d13c09
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eeaec530-3cd8-49f7-9ff7-8bc0eb429238
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_ed_seen_by_30.hospital_code=dim_hospital.hospital_id
        name: DIM_HOSPITAL_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c1eff0c-fd0d-4a47-ad0f-2fd4a80c00a7
                stepCounter: ce5e5ba3-482d-46a9-a8ae-9f160067f51d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa679fc6-34a2-43fa-a354-d757ae8847a9
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FACILITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c0cdb860-435c-40bc-9bbc-ffd85faae07f
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a745eff-59ad-4bae-88fa-ca1b42d2e6d8
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: TREATMENT_PROTOCOL_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bcfa50a6-75b4-48d6-b503-d791c1cabc5d
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2da60428-24df-4cbc-b2dd-e0f8096790f8
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_ed_seen_by_30.treatment_protocol_no=dim_ED_treatment_protocol.treatment_protocol_no
        name: DIM_ED_TREATMENT_PROTOCOL_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fbd13b77-1d33-4021-91de-c191ad877dbc
                stepCounter: bca3ad6c-7baa-4f42-8e2f-7ab945c58863
            transform: IFNULL(dim_ED_treatment_protocol.dim_ed_treatment_protocol_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc75458e-d3a1-487e-a0b0-bfb4b6c8138f
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b77084cc-0b92-4419-a281-4859a345d9cf
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f105420b-cbda-43ea-a2f6-dc78f5b0e87d
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: STAY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72c4e5a3-41ff-40f0-a956-d79790032e72
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9500dbcc-521f-4ff6-beae-60e01071bb3f
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: STAY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c92738a-a264-4619-b9f8-70b894218fb4
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca598dac-4213-4517-b0d5-0de1d6bca803
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SEEN_BY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5574de99-8def-4863-92eb-3ef74e07198c
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c997c39-ece2-482c-9c58-9dedef6c404f
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_seen_by_30.CONVERT(DATE,s_ed_seen_by_20.cur_seen_by_date)=dim_seen_by_date.seen_by_calendar_date
        name: DIM_SEEN_BY_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 083b97e3-9e75-4d0c-b01a-311619a5d8a6
                stepCounter: 959a8424-358c-43e3-83ba-4de45f80a77d
            transform: IFNULL(dim_seen_by_date.dim_seen_by_date_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f337692-13e8-4db1-ac53-e2fd3e0dd7fa
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: NVARCHAR(20)
        defaultValue: ""
        description: ""
        name: CONSULTANT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d052de53-1512-4177-92af-9a46efe4d735
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d6143bb-1841-41f6-90c9-0c6839e4e79e
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CONSULTANT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ce24988-28e4-4b65-b22f-0e99753f74b7
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 781fe18e-74fd-49c3-b1fb-c95461408390
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_ed_seen_by_30.consultant_reference_no=dim_consultant.consultant_reference_no
        name: DIM_CONSULTANT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05566e93-fccf-4f7e-a94d-eccee306c604
                stepCounter: e96e7db3-4f9b-403d-812d-3aff25b5ddca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e464401d-4e7f-4eec-bbbe-9f5190485e2e
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SEEN_BY_CLINICIAN_USER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 15474664-7992-461b-9f6e-0dd1d378562a
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15040611-81b6-45cc-a1a0-197ca0e35928
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_seen_by_30.hospital_code=dim_seen_by_lead_clinician.shift_location_code
        name: DIM_SEEN_BY_LEAD_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 93ab91ce-7db7-4a6c-bb83-33f5cc63e2e5
                stepCounter: be60fee4-c5ba-4920-a8fa-404171c68e38
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 93283e07-fe19-450e-9515-f2bd5ed7afb5
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_ed_seen_by_30.seen_by_clinician_user_name=dim_seen_by_clinician_user_login.seen_by_clinician_user_name
        name: DIM_SEEN_BY_CLINICIAN_USER_LOGIN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9c9a4b0-27c3-4ca3-9206-1e76dc49715b
                stepCounter: b9d64804-8c38-4165-9635-2908a836cae9
            transform: IFNULL(dim_seen_by_clinician_user_login.dim_seen_by_clinician_user_login_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fcb3b0f2-d50c-4aeb-b8a1-b32344e5a405
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SEEN_BY_CLINICIAN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5dbd2b1-c544-4a33-89dc-7bee84e4c012
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a23c6ed1-4d00-4141-a931-f70bf726a939
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3d2f9d08-3f79-4fcf-b7fe-314b2ca4b8ee
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4aac5a65-1845-4392-b2f9-7757506e7e60
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_ed_seen_by_30.seen_by_clinician_reference_no=dim_seen_by_clinician.seen_by_clinician_reference_no
        name: DIM_SEEN_BY_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6980c5e-497d-45d3-854e-f5d17228ad86
                stepCounter: 293e84bb-0ad7-4a27-96ab-0a0cb38c50c5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd8ef5cb-b633-421a-bef9-90f5d72fd4d1
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SERVICE_POINT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e2ab3a9-e8ae-49e7-9dad-3dde8c2d035f
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6930f2dd-9090-4cd0-9248-b913fb33a04f
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SERVICE_POINT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 87f36cd2-4d85-459a-af1c-e9b082c9495a
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dfffd3ec-c8be-47f0-a770-f251696e8932
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_ed_seen_by_30.service_point_reference_no=dim_service_point.service_point_reference_no
        name: DIM_SERVICE_POINT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 66428538-0101-4e75-9137-beccf8a67c9a
                stepCounter: 331048bb-7ff9-400f-b8c4-4ac7cc91d7e8
            transform: IFNULL(dim_service_point.dim_service_point_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3af51fb5-90db-4794-976d-2484bb2e184d
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aba169fe-dde1-4f66-af7b-0fb5427740e5
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6532391-4248-46a5-89f6-dc9a80150bf6
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3df58b4e-ce56-462b-89ec-69415efb5062
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57f8ba98-d2cd-433b-aae6-cc6580a0e3be
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_ed_seen_by_30.specialty_reference_no=dim_specialty.specialty_reference_no
        name: DIM_SPECIALTY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79aee918-ff6f-4b0a-a656-000827899f3e
                stepCounter: 4182a75e-d07b-4637-97fa-4c01e2878360
            transform: IFNULL(dim_specialty.dim_specialty_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f92195ee-17c0-48cb-98b8-cb2868095f2c
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: previous seen-by sequence number
        name: PREVIOUS_SEEN_BY_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b3dcef40-ca5e-444a-baa2-d0d8f98babcd
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57c46e3f-670a-4cb9-930e-6e338b3a1fa1
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PREVIOUS_SEEN_BY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fda0547d-edfe-4cca-9a75-c4fd5c88c5fe
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e758c81c-b331-4737-9645-190dbcd03804
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PREVIOUS_SEEN_BY_CLINICIAN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e0513eec-63bc-488b-a3f8-83011b043ea0
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c4d2150-eff1-48d4-a7c3-035c32e4d9f2
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREVIOUS_SEEN_BY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8bdae2ce-aadb-4e03-8fed-284ef6a05db2
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eec3fe17-cc58-4468-af14-9ef3cd50bdcc
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PREVIOUS_SERVICE_POINT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 98bdcf18-cd5f-44c2-95fb-c69e09fe516a
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da4b5940-65e1-4319-b1f3-3f3eaf0be867
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREVIOUS_SERVICE_POINT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3a289dc-a8a7-4993-946f-2bf83847f7d7
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 788cad83-1e7b-4061-8d1c-58c25d089699
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PREVIOUS_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 613a42e0-4ca4-4bb0-9be1-d823acf9dca5
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78491222-87d8-49ea-a2fd-b02c832c2477
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREVIOUS_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64ee0810-9434-480d-9732-ed805b8ea824
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 300ddf67-ae5e-40d4-823c-4f60d87ade9b
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PREVIOUS_SEEN_BY_CLINICIAN_USER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ca8dc6a-b853-4b5e-bf55-f59ca83d535c
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96c0dd0d-9455-4ac2-b537-c0aa55cb556f
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: next seen-by sequence number
        name: NEXT_SEEN_BY_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ec7bedb-d465-4d61-bdb1-6b80a5b25dbb
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad8e164d-4e5d-4700-9693-6e5064998d42
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NEXT_SEEN_BY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c700bb66-54ce-4652-b17c-b7b0381e8d09
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e8b85b8-4e94-43c9-a356-4f36937c0e01
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NEXT_SEEN_BY_CLINICIAN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0a2dea7f-255f-4b63-a088-ae1c14eefc4a
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07dd763e-ae75-4247-9d59-5aa799bc396e
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NEXT_SEEN_BY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c2b7a0c4-213d-4223-bf2e-b877297eb08f
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 90d9eea6-bbb7-41b9-abb1-532cc55a2875
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NEXT_SERVICE_POINT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a921cb23-8d2a-4303-b396-6514f4cc8750
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b14d980a-33e3-4629-a7b4-2583a669b521
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NEXT_SERVICE_POINT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e62b1136-0a7a-466a-b105-d36af838e688
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a399abf9-6dfa-4c2e-8ec3-aee43ce94cf8
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NEXT_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c93f69d6-5284-44a0-88f1-bfdaacd30711
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a00b94b4-ff2f-45c0-b632-39805acf72fd
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NEXT_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9c2b614-523a-4b4f-97b4-107141d721c7
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: edfe6283-eebc-413a-871d-73e8a1a8c5f2
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NEXT_SEEN_BY_CLINICIAN_USER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 85b1035b-2edb-4203-a280-d1e6a8a9f5b1
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e540ad10-59ce-4265-b05f-5ebaa44965d5
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: duration_unit
        name: DURATION_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 15717b5f-4e45-47f7-95d4-623a6a06f562
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad5cdb81-fec4-4f49-b456-77b6649f7e32
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: previous_to_current_seen_by_duration
        name: PREVIOUS_TO_CURRENT_SEEN_BY_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 43f903e0-a576-4eb3-ac4f-932d26e801b7
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d492a266-ab7e-4b42-b082-acec0dce421c
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: current_to_next_seen_by_duration
        name: CURRENT_TO_NEXT_SEEN_BY_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a884d996-7286-4c39-9116-7676e0d117e5
                stepCounter: cf02b96c-a1f4-49af-8791-bb95b0b18e55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5c1baa7-3203-47bb-bb3c-236b3dfb7a54
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: seen_by_count
        name: SEEN_BY_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '1'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5836862-4c58-4235-8730-1033aef06c6d
          stepCounter: eea19e0f-50ee-466a-9a1f-0ef01b469903
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DIM_HOSPITAL: ce5e5ba3-482d-46a9-a8ae-9f160067f51d
          DIM_SEEN_BY_CLINICIAN_USER_LOGIN: b9d64804-8c38-4165-9635-2908a836cae9
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_ED_SEEN_BY_20
          - locationName: TGT
            nodeName: DIM_HOSPITAL
          - locationName: TGT
            nodeName: DIM_SEEN_BY_CLINICIAN_USER_LOGIN
        join:
          joinCondition: |-
            FROM s_ed_seen_by_20
              JOIN {{ ref('TGT','DIM_HOSPITAL') }}
                ON ISNULL (s_ed_seen_by_20.hospital_code,'Unknown') = dim_hospital.hospital_code
              LEFT OUTER JOIN {{ ref('TGT','DIM_SEEN_BY_CLINICIAN_USER_LOGIN') }}
                ON s_ed_seen_by_20.seen_by_clinician_user_name = dim_seen_by_clinician_user_login.seen_by_clinician_user_name
               AND s_ed_seen_by_20.cur_seen_by_date BETWEEN dim_seen_by_clinician_user_login.validity_start_date AND dim_seen_by_clinician_user_login.validity_end_date
        name: S_ED_SEEN_BY_30
        noLinkRefs: []
  name: S_ED_SEEN_BY_30
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
