fileVersion: 1
id: 4ce7c19b-7661-4d0a-b366-25cd113e6dec
name: S_CONTRACT_ACTIVITY_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Unions activity together"
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d4e590d-d021-414b-8518-dae973e44e20
          stepCounter: 4ce7c19b-7661-4d0a-b366-25cd113e6dec
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Generated column used to join to correct Price Volume Schdule Line
        name: PROVIDER_FUNDER_SPLIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f13a3853-b119-402c-89af-9f60529e1e8d
                stepCounter: 740983b9-cd4c-4197-8383-1495413cac49
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fbb37cfb-96db-47ea-8a4f-b9bd1b59b8fd
          stepCounter: 4ce7c19b-7661-4d0a-b366-25cd113e6dec
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PUC_MAP_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 10d309bf-98ae-4275-b1f1-7ec90a83edc1
                stepCounter: 839359a3-0c19-4125-8240-943e4c5c7973
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e45becd0-96ee-41dc-b848-e1d5790a0310
          stepCounter: 4ce7c19b-7661-4d0a-b366-25cd113e6dec
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: Agency code for the providing organisation
        name: PROVIDER_AGENCY_CODE
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: "'1021'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea463ba8-19fd-49d1-92ed-fe0e67736db7
          stepCounter: 4ce7c19b-7661-4d0a-b366-25cd113e6dec
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: 'Agency code for the funding organisation. This could include ACC and Ministry of Health '
        name: FUNDER_AGENCY_CODE
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: "'1021'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c465912c-f6ca-4a74-9c91-d3e5a05e5640
          stepCounter: 4ce7c19b-7661-4d0a-b366-25cd113e6dec
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: RESPONSIBILITY_CENTRE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d874338a-9227-4dd5-91d9-99be747b5003
                stepCounter: 740983b9-cd4c-4197-8383-1495413cac49
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 99bd6c68-4945-4029-8963-0c10ac37b698
          stepCounter: 4ce7c19b-7661-4d0a-b366-25cd113e6dec
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: health_specialty_code
        name: HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 43727191-56a5-4113-9387-fbb07505d8e5
                stepCounter: 740983b9-cd4c-4197-8383-1495413cac49
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6bee6b0-deb1-4702-a0c7-1ab3c5ff2c19
          stepCounter: 4ce7c19b-7661-4d0a-b366-25cd113e6dec
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: facility_code
        name: FACILITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 355fefc4-0446-4133-af21-fc64d5e4f56b
                stepCounter: 740983b9-cd4c-4197-8383-1495413cac49
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2aaf5936-6d68-4140-a736-bed1293b38f8
          stepCounter: 4ce7c19b-7661-4d0a-b366-25cd113e6dec
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: date activity occurred. Differs from reporting date which is at the monthly grain to join with contracts
        name: SERVICE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3f220b2f-b986-40a9-bf50-63c82bdf2a62
                stepCounter: 740983b9-cd4c-4197-8383-1495413cac49
            transform: reporting_date
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e111c50-5f0a-46a6-9b16-eb9063203f33
          stepCounter: 4ce7c19b-7661-4d0a-b366-25cd113e6dec
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Has twelve months added to it for testing
        name: REPORTING_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3f220b2f-b986-40a9-bf50-63c82bdf2a62
                stepCounter: 740983b9-cd4c-4197-8383-1495413cac49
            transform: EOMonth(cast(s_contract_activity_05a.reporting_date AS date),0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07a782a1-1cd8-41c0-ae1e-734f2ea6c1c1
          stepCounter: 4ce7c19b-7661-4d0a-b366-25cd113e6dec
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SOURCE_ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6976fe75-cede-4995-b954-56c00009c762
                stepCounter: 740983b9-cd4c-4197-8383-1495413cac49
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 23099204-9888-4c20-91d4-1fba6b36759e
          stepCounter: 4ce7c19b-7661-4d0a-b366-25cd113e6dec
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FUNDED_EVENT_ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6bb1b413-9f70-491a-82a0-c6f89c200f80
                stepCounter: 740983b9-cd4c-4197-8383-1495413cac49
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 411f5c9b-3195-4273-b817-e86116f0057d
          stepCounter: 4ce7c19b-7661-4d0a-b366-25cd113e6dec
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75b9d47e-c49f-41db-8934-4d2340ba3583
                stepCounter: 740983b9-cd4c-4197-8383-1495413cac49
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff3c2599-06c8-4b99-b2ff-c30e848a210f
          stepCounter: 4ce7c19b-7661-4d0a-b366-25cd113e6dec
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa33b5bf-d849-46a8-83e8-c94ab44e80b9
                stepCounter: 740983b9-cd4c-4197-8383-1495413cac49
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e082bc82-9f6f-427f-8ba6-63626c1ae4f2
          stepCounter: 4ce7c19b-7661-4d0a-b366-25cd113e6dec
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.patient_reference_no=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3cf65aa4-dcd9-4139-afe6-c885540998d6
                stepCounter: 740983b9-cd4c-4197-8383-1495413cac49
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88f1c0b8-d6c3-4164-8a13-6607a8cb0ee1
          stepCounter: 4ce7c19b-7661-4d0a-b366-25cd113e6dec
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f68a357d-0cf2-4abc-b3d0-7a68c1b7f0eb
                stepCounter: 740983b9-cd4c-4197-8383-1495413cac49
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d809f8f-c7db-4e2a-b4bc-2c840542baba
          stepCounter: 4ce7c19b-7661-4d0a-b366-25cd113e6dec
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMIN_CATEGORY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 493d731e-d1a3-41a8-a591-46c34c7e318b
                stepCounter: 740983b9-cd4c-4197-8383-1495413cac49
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b41cc40-79e3-451a-8d0b-6e497f9e0cef
          stepCounter: 4ce7c19b-7661-4d0a-b366-25cd113e6dec
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: CONTRACT_ADMIT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0936f4ba-274c-4ecf-bbc0-dbc6af92f6ce
                stepCounter: 740983b9-cd4c-4197-8383-1495413cac49
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 441b933e-15d6-403a-b21f-54511994a4d4
          stepCounter: 4ce7c19b-7661-4d0a-b366-25cd113e6dec
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: ADMISSION_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1256c7c3-1e7c-4996-b8f7-65765fc1f339
                stepCounter: 740983b9-cd4c-4197-8383-1495413cac49
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 000dcf04-66c7-4a36-821d-b66f0eea6d5e
          stepCounter: 4ce7c19b-7661-4d0a-b366-25cd113e6dec
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: DRG_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8657db26-1c83-4e7b-b644-497452cc0577
                stepCounter: 740983b9-cd4c-4197-8383-1495413cac49
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 240c5e5e-f122-49eb-9a96-4dd8d278548d
          stepCounter: 4ce7c19b-7661-4d0a-b366-25cd113e6dec
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: IDF_CLASS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e28b4eac-050f-4055-ac63-7bbff9cfd09b
                stepCounter: 740983b9-cd4c-4197-8383-1495413cac49
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 13aacf86-f6b1-4e51-b0c1-751d689ca970
          stepCounter: 4ce7c19b-7661-4d0a-b366-25cd113e6dec
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DOMICILE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ba76c3d1-d10e-471b-9879-5034d747b7e0
                stepCounter: 740983b9-cd4c-4197-8383-1495413cac49
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96de77de-0f24-448a-b428-f294033a80bd
          stepCounter: 4ce7c19b-7661-4d0a-b366-25cd113e6dec
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: This is the volume of units for the method by which the event is funded. i.e. WIES or 1 for procedure funded purchase units.
        name: PURCHASE_UNIT_VOLUME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed4a30be-bf9e-4602-b2fe-214d1401403d
                stepCounter: 740983b9-cd4c-4197-8383-1495413cac49
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bce355fa-e888-4c71-972d-70dffbbac083
          stepCounter: 4ce7c19b-7661-4d0a-b366-25cd113e6dec
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: ESTIMATED_PURCHASE_UNIT_VOLUME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c18f6d60-c187-48dd-a59b-c015b82fd199
                stepCounter: 740983b9-cd4c-4197-8383-1495413cac49
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d9985dd-d75d-443e-b2d4-7b67596a218a
          stepCounter: 4ce7c19b-7661-4d0a-b366-25cd113e6dec
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_PLANNED_CARE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dd4d1b42-61a6-4466-8f20-fcead18fcc93
                stepCounter: 740983b9-cd4c-4197-8383-1495413cac49
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5087eedf-dc28-4964-b866-0dbd5e23c7cd
          stepCounter: 4ce7c19b-7661-4d0a-b366-25cd113e6dec
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: DIM_AGE_GROUP_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0e1fbe57-c3d3-4ed5-bd14-4c72d2130f9f
                stepCounter: 740983b9-cd4c-4197-8383-1495413cac49
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95392d6d-ae3a-4797-bfb4-663405e89ecb
          stepCounter: 4ce7c19b-7661-4d0a-b366-25cd113e6dec
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2f26db3-9f31-4d9d-ae95-b64f4a901d60
                stepCounter: 740983b9-cd4c-4197-8383-1495413cac49
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5901e8c7-6e90-40bb-b276-0ec631548e7f
          stepCounter: 4ce7c19b-7661-4d0a-b366-25cd113e6dec
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: SOURCE_SYSTEM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3dafc408-07bc-4db9-90c0-f7c25c20182f
                stepCounter: 740983b9-cd4c-4197-8383-1495413cac49
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_CONTRACT_ACTIVITY_05A: 740983b9-cd4c-4197-8383-1495413cac49
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_CONTRACT_ACTIVITY_05A
        join:
          joinCondition: FROM {{ ref('TGT','S_CONTRACT_ACTIVITY_05A') }}
        name: S_CONTRACT_ACTIVITY_10
        noLinkRefs: []
  name: S_CONTRACT_ACTIVITY_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
