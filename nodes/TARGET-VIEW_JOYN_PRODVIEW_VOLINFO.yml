fileVersion: 1
id: 3ccad9ad-adba-4425-821a-da8029d66e6d
name: VIEW_JOYN_PRODVIEW_VOLINFO
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9a59af1-f684-4ff3-9de0-47d72111fdcc
          stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: WELL_IDREC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a9a59af1-f684-4ff3-9de0-47d72111fdcc
                stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e63af428-9611-4294-a043-4aa467c7f86c
          stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: LAST_PROD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e63af428-9611-4294-a043-4aa467c7f86c
                stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fbdae032-f94e-4edf-bfad-5677dce8dcd5
          stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fbdae032-f94e-4edf-bfad-5677dce8dcd5
                stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72b3dc30-9bff-43a9-a69a-2674371f285d
          stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CURR_PROD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72b3dc30-9bff-43a9-a69a-2674371f285d
                stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 819d29c7-b454-4e11-b0bc-363631e0df11
          stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: DOWNTIME_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 819d29c7-b454-4e11-b0bc-363631e0df11
                stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 463b7563-9dc8-43b7-a227-f0ed7bc02204
          stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: OPERATING_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 463b7563-9dc8-43b7-a227-f0ed7bc02204
                stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d19a0a2c-8967-4bd7-82ed-42a57a8492e0
          stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: WI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d19a0a2c-8967-4bd7-82ed-42a57a8492e0
                stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d2b846a-18f2-4abb-84ac-34340c26a95b
          stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: GATH_WATER_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d2b846a-18f2-4abb-84ac-34340c26a95b
                stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 480e465f-ad4a-4a5f-9c9d-846d84320b32
          stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: GATH_OIL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 480e465f-ad4a-4a5f-9c9d-846d84320b32
                stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7c79530-b515-4351-a8c8-52e508bcee69
          stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: GATH_GAS_E3M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d7c79530-b515-4351-a8c8-52e508bcee69
                stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 464b531d-1f5c-41ec-8caf-c91dbe6e4c37
          stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: GATH_OIL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 464b531d-1f5c-41ec-8caf-c91dbe6e4c37
                stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 63469ec7-b1f1-463f-9223-05729cdcdf5e
          stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: GATH_GAS_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 63469ec7-b1f1-463f-9223-05729cdcdf5e
                stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 36bdffbc-2ac2-4607-b735-950bce40b269
          stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: GATH_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 36bdffbc-2ac2-4607-b735-950bce40b269
                stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1237654-f883-40d6-b9c1-568b31029d4d
          stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: GATH_AVG_OIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1237654-f883-40d6-b9c1-568b31029d4d
                stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ff04d6d-a028-4946-b60f-03f69ef19d3a
          stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: GATH_AVG_WATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ff04d6d-a028-4946-b60f-03f69ef19d3a
                stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3bd88db0-aaef-48ea-81db-986eb36afed0
          stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: GATH_AVG_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3bd88db0-aaef-48ea-81db-986eb36afed0
                stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fca9ef22-6e0f-4eab-b366-f6311dc81dda
          stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: GATH_AVG_OIL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fca9ef22-6e0f-4eab-b366-f6311dc81dda
                stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: afcba089-0980-4fd0-9e74-ce887bb9253f
          stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: GATH_AVG_GAS_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: afcba089-0980-4fd0-9e74-ce887bb9253f
                stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3624d9d6-89bc-4ec8-9e50-bf22c3f00b66
          stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: GATH_AVG_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3624d9d6-89bc-4ec8-9e50-bf22c3f00b66
                stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9052c1d6-5a31-4800-9a8c-3312ae1fa6bf
          stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: ALLOC_AVG_OIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9052c1d6-5a31-4800-9a8c-3312ae1fa6bf
                stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb77a488-a4d1-4050-b461-2f9a4fcc7092
          stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: ALLOC_AVG_WATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eb77a488-a4d1-4050-b461-2f9a4fcc7092
                stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c7fe771-6bcd-4fc0-8866-cf1c77656c64
          stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: ALLOC_AVG_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c7fe771-6bcd-4fc0-8866-cf1c77656c64
                stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a353928-17cd-4af0-b8a6-73cc8b189b96
          stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: ALLOC_AVG_OIL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a353928-17cd-4af0-b8a6-73cc8b189b96
                stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f702c8be-3b7a-44b2-a992-00ccc43e5b99
          stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: ALLOC_AVG_GAS_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f702c8be-3b7a-44b2-a992-00ccc43e5b99
                stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de65c21b-6c0b-46ff-8e88-ff57f809cae2
          stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: ALLOC_AVG_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de65c21b-6c0b-46ff-8e88-ff57f809cae2
                stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8d81d54-0067-4649-ba07-371bf9e3b17a
          stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: JTF
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c8d81d54-0067-4649-ba07-371bf9e3b17a
                stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f412c43-0aea-4f54-960a-4423659020c9
          stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: JIH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f412c43-0aea-4f54-960a-4423659020c9
                stepCounter: 3ccad9ad-adba-4425-821a-da8029d66e6d
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_JOYN_PRODVIEW_VOLINFO: 3ccad9ad-adba-4425-821a-da8029d66e6d
          ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY: b78e68df-21f7-427c-9ce7-426d1d304567
          ODS_PVIEW_PVT_PVUNIT: d554b1ad-15ef-40f5-8fff-8a730cc8b68e
          ODS_PVIEW_PVT_PVFLOWNETHEADER: bd388a52-3d72-4c70-833d-7de7c6a8abd1
          ODS_PVIEW_PVT_PVUNITCOMPMEASMETH: 56efdfd1-7a07-4ab6-917a-e20b72b23662
          ODS_PVIEW_PVT_PVUNITCOMP: b2609f15-a93c-4c5d-b86e-0898ad7558d0
          ODS_PVIEW_PVT_PVROUTESETROUTE: 7c5021e0-ddd6-4b14-9b91-645b71f83303
          ODS_PVIEW_PVT_PVFACILITY: 2069364e-b829-44bc-90fd-46cb967ac2ee
          ODS_PVIEW_PVT_PVUNITCOMPFLUIDLEVEL: 9e06fc76-3384-44e3-a094-eb3f74a386c0
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE SECURE VIEW {{ ref_no_link('TARGET','VIEW_JOYN_PRODVIEW_VOLINFO') }} AS WITH last_prod AS (
                    SELECT MAX(d.dttm) AS lp_date,
                           MAX(u.idrec) AS idrec
                      FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY') }} d
                     INNER JOIN {{ ref('TARGET','ODS_PVIEW_PVT_PVUNIT') }} u
                        ON u.idrec = d.idrecunit
                       AND u.DSS_CURRENT_FLAG = 'Y'
                       AND u.DSS_DELETE_FLAG != 'Y'
                     INNER JOIN {{ ref('TARGET','ODS_PVIEW_PVT_PVFLOWNETHEADER') }} h
                        ON h.idflownet = d.idflownet
                       AND h.DSS_CURRENT_FLAG = 'Y'
                       AND h.DSS_DELETE_FLAG != 'Y'
                     WHERE (d.volprodgathgas + d.volprodgathwater + d.volprodgathhcliq) > 0
                       AND h.usertxt1 = 'CANADA'
                       AND d.DSS_CURRENT_FLAG = 'Y'
                       AND d.DSS_DELETE_FLAG != 'Y'
                     GROUP BY u.idrec
                   ),
                   Avgs AS (
                    SELECT AVG(a.volprodgathhcliq) Gath_Avg_Oil,
                           CASE WHEN m.flowdirection = 'injection' THEN AVG(a.volinjectwater)
                                ELSE AVG(a.volprodgathwater)
                                 END AS Gath_Avg_Water,
                           AVG(a.volprodgathgas) / 1000 Gath_Avg_Gas,
                           AVG(a.volprodgathhcliq) * 6.29 AS Gath_Avg_Oil_BOE,
                           AVG(a.volprodgathgas) / 1000 * 5.88 AS Gath_Avg_Gas_BOE,
                           (AVG(a.volprodgathhcliq) * 6.29) + (AVG(a.volprodgathgas) / 1000 * 5.88) AS Gath_Avg_BOE,
                           AVG(a.volprodallocoil) Alloc_Avg_Oil,
                           CASE WHEN m.flowdirection = 'injection' THEN AVG(a.volinjectwater)
                                ELSE AVG(a.volprodallocwater)
                                 END AS Alloc_Avg_Water,
                           AVG(a.volprodallocgas) / 1000 Alloc_Avg_Gas,
                           AVG(a.volprodallocoil) * 6.29 AS Alloc_Avg_Oil_BOE,
                           AVG(a.volprodallocgas) / 1000 * 5.88 AS Alloc_Avg_Gas_BOE,
                           (AVG(a.volprodallocoil) * 6.29) + (AVG(a.volprodallocgas) / 1000 * 5.88) AS Alloc_Avg_BOE,
                           a.idrecunit AS avgidrec
                      FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY') }} a
                     INNER JOIN {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITCOMPMEASMETH') }} m
                        ON m.idrec = a.idrecmeasmeth
                       AND m.DSS_CURRENT_FLAG = 'Y'
                       AND m.DSS_DELETE_FLAG != 'Y'
                     WHERE a.dttm >= ADD_MONTHS(CURRENT_DATE(), -6)
                       AND a.DSS_CURRENT_FLAG = 'Y'
                       AND a.DSS_DELETE_FLAG != 'Y'
                     GROUP BY a.idrecunit,
                              m.flowdirection
                   ) SELECT u.idrec AS Well_IDREC,
                   CAST(lp.lp_date AS date) AS Last_Prod_Date,
                   c.wellname AS UWI,
                   CAST(a.dttm AS date) AS Curr_Prod_Date,
                   a.durdown * 24 AS Downtime_Hours,
                   a.durop * 24 AS Operating_Hours,
                   a.wihcliq * 100 AS WI,
                   CASE WHEN m.flowdirection = 'production' THEN a.volprodgathwater
                        WHEN m.flowdirection = 'injection'  THEN a.volinjectwater
                        ELSE a.volprodgathwater
                         END AS Gath_Water_M3,
                   a.volprodgathhcliq AS Gath_Oil_M3,
                   a.volprodgathgas / 1000 AS Gath_Gas_E3M3,
                   a.volprodgathhcliq * 6.29 AS Gath_Oil_BOE,
                   a.volprodgathgas / 1000 * 5.88 AS Gath_Gas_BOE,
                   (a.volprodgathhcliq * 6.29) + (a.volprodgathgas / 1000 * 5.88) AS Gath_BOE,
                   av.Gath_Avg_Oil,
                   av.Gath_Avg_Water,
                   av.Gath_Avg_Gas,
                   av.Gath_Avg_Oil_BOE,
                   av.Gath_Avg_Gas_BOE,
                   av.Gath_Avg_BOE,
                   av.Alloc_Avg_Oil,
                   av.Alloc_Avg_Water,
                   av.Alloc_Avg_Gas,
                   av.Alloc_Avg_Oil_BOE,
                   av.Alloc_Avg_Gas_BOE,
                   av.Alloc_Avg_BOE,
                   fl.jointstofluid AS JTF,
                   fl.jointsinhole AS JIH
              FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY') }} a
             INNER JOIN {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITCOMP') }} c
                ON c.idrec = a.idreccomp
               AND c.DSS_CURRENT_FLAG='Y'
               AND c.DSS_DELETE_FLAG!='Y'
             INNER JOIN {{ ref('TARGET','ODS_PVIEW_PVT_PVUNIT') }} u
                ON u.idrec = a.idrecunit
               AND u.DSS_CURRENT_FLAG='Y'
               AND u.DSS_DELETE_FLAG!='Y'
             INNER JOIN {{ ref('TARGET','ODS_PVIEW_PVT_PVROUTESETROUTE') }} r
                ON r.idrec = u.idrecroutesetroutecalc
               AND r.DSS_CURRENT_FLAG='Y'
               AND r.DSS_DELETE_FLAG!='Y'
             INNER JOIN {{ ref('TARGET','ODS_PVIEW_PVT_PVFACILITY') }} f
                ON f.idrec = a.idrecfacility
               AND f.DSS_CURRENT_FLAG='Y'
               AND f.DSS_DELETE_FLAG!='Y'
             INNER JOIN {{ ref('TARGET','ODS_PVIEW_PVT_PVFLOWNETHEADER') }} h
                ON h.idflownet = u.idflownet
               AND h.DSS_CURRENT_FLAG='Y'
               AND h.DSS_DELETE_FLAG!='Y'
             INNER JOIN {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITCOMPMEASMETH') }} m
                ON m.idrec = a.idrecmeasmeth
               AND m.DSS_CURRENT_FLAG='Y'
               AND m.DSS_DELETE_FLAG!='Y'
              LEFT JOIN last_prod lp
                ON lp.idrec = u.idrec
              LEFT JOIN {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITCOMPFLUIDLEVEL') }} fl
                ON fl.idrec = a.idrecfluidlevel
               AND fl.DSS_CURRENT_FLAG='Y'
               AND fl.DSS_DELETE_FLAG!='Y'
             INNER JOIN AVGS av
                ON av.avgidrec = a.idrecunit
             WHERE a.dttm >= DATEADD(DAY, -31, CAST(getdate() AS date))
               AND a.dttm <= DATEADD(DAY, -2, CAST(getdate() AS date))
               AND h.usertxt2 = 'SOUTHEAST SASKATCHEWAN'
               AND a.DSS_CURRENT_FLAG = 'Y'
               AND a.DSS_DELETE_FLAG != 'Y'
        dependencies:
          - locationName: TARGET
            nodeName: VIEW_JOYN_PRODVIEW_VOLINFO
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNIT
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVFLOWNETHEADER
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITCOMPMEASMETH
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITCOMP
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVROUTESETROUTE
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVFACILITY
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITCOMPFLUIDLEVEL
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','VIEW_JOYN_PRODVIEW_VOLINFO') }}
            {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY') }}
            {{ ref('TARGET','ODS_PVIEW_PVT_PVUNIT') }}
            {{ ref('TARGET','ODS_PVIEW_PVT_PVFLOWNETHEADER') }}
            {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITCOMPMEASMETH') }}
            {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITCOMP') }}
            {{ ref('TARGET','ODS_PVIEW_PVT_PVROUTESETROUTE') }}
            {{ ref('TARGET','ODS_PVIEW_PVT_PVFACILITY') }}
            {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITCOMPFLUIDLEVEL') }}
        name: VIEW_JOYN_PRODVIEW_VOLINFO
        noLinkRefs: []
  name: VIEW_JOYN_PRODVIEW_VOLINFO
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
