fileVersion: 1
id: 5d38085d-4278-4e81-a23d-d8b2267e46df
name: S_LKP_INSTITUTION_CARD_MROC_CURRENT
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DATAVAULT_BUSINESS_VAULT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c74884a-e8fa-407f-92e5-15f004759d69
          stepCounter: 5d38085d-4278-4e81-a23d-d8b2267e46df
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: ""
        name: HK_H_LKP_INSTITUTION_CARD
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91d2de4f-30a2-44b1-998d-3d5c92634663
                stepCounter: 787c8bc4-9d29-4142-bc7b-1902deee5fc9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4888d9fa-67c2-4d19-831d-c1c9f453b889
          stepCounter: 5d38085d-4278-4e81-a23d-d8b2267e46df
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: CRD_TYP_CDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8af23fe-ca88-4429-8a15-a5bc4c213c81
                stepCounter: 787c8bc4-9d29-4142-bc7b-1902deee5fc9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd40c6fa-38ac-4f8d-b33e-bd73f42604a5
          stepCounter: 5d38085d-4278-4e81-a23d-d8b2267e46df
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: FILLER_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fbce5c7d-847c-4f60-bbab-205190c9acfc
                stepCounter: 787c8bc4-9d29-4142-bc7b-1902deee5fc9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1bd6baf2-eb16-4c44-9a9c-a1bf675f93e4
          stepCounter: 5d38085d-4278-4e81-a23d-d8b2267e46df
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: ITN_IDN_CDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0483e15e-4813-43a5-a6b5-c8386f3bd1e6
                stepCounter: 787c8bc4-9d29-4142-bc7b-1902deee5fc9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d189748-4118-4c6e-b03a-81770f861994
          stepCounter: 5d38085d-4278-4e81-a23d-d8b2267e46df
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CRD_TYP_TXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: be84bf2a-bbde-46e9-93ef-df3fca0df8cd
                stepCounter: 787c8bc4-9d29-4142-bc7b-1902deee5fc9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 376af3a4-75b8-4fdc-bde5-623eb49ffb88
          stepCounter: 5d38085d-4278-4e81-a23d-d8b2267e46df
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: LST_UPD_DTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4f257f94-cb41-49c8-a0e7-818dd4235443
                stepCounter: 787c8bc4-9d29-4142-bc7b-1902deee5fc9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5eaa883d-f3f8-48a1-b152-32b20da33f60
          stepCounter: 5d38085d-4278-4e81-a23d-d8b2267e46df
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: LST_UPD_TME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b401719d-52e6-4811-9bec-c3396264d78c
                stepCounter: 787c8bc4-9d29-4142-bc7b-1902deee5fc9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09087335-52b3-4330-a535-cc3a426bd6fb
          stepCounter: 5d38085d-4278-4e81-a23d-d8b2267e46df
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: LST_UPD_UID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2fc991c8-08a1-4a7c-b468-a6210adab995
                stepCounter: 787c8bc4-9d29-4142-bc7b-1902deee5fc9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8330b46-b755-48d1-a0d5-fb7572758ac2
          stepCounter: 5d38085d-4278-4e81-a23d-d8b2267e46df
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: LST_UPD_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 93d9988b-c475-433a-8fad-f5b637db7a8b
                stepCounter: 787c8bc4-9d29-4142-bc7b-1902deee5fc9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8786a825-df31-471f-9d26-e9a2e5ec585d
          stepCounter: 5d38085d-4278-4e81-a23d-d8b2267e46df
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CREATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e8c07d6-d43b-48a6-9f81-1c1303277f4f
                stepCounter: 787c8bc4-9d29-4142-bc7b-1902deee5fc9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 61653386-e83d-45ca-8e9a-6719cc940d61
          stepCounter: 5d38085d-4278-4e81-a23d-d8b2267e46df
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: CREATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bcd1b243-e539-4fc8-b230-157ab7486cd6
                stepCounter: 787c8bc4-9d29-4142-bc7b-1902deee5fc9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81df242f-c055-4e57-9971-25860ca32603
          stepCounter: 5d38085d-4278-4e81-a23d-d8b2267e46df
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: UPDATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91ce62f5-eccf-42b1-ad4a-da501c7746df
                stepCounter: 787c8bc4-9d29-4142-bc7b-1902deee5fc9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: efb4bb78-0add-431a-98a7-5c15819a56b2
          stepCounter: 5d38085d-4278-4e81-a23d-d8b2267e46df
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: UPDATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e4c271e3-6f90-4a64-a7d3-9a2dc74eec82
                stepCounter: 787c8bc4-9d29-4142-bc7b-1902deee5fc9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0311c52e-e2f9-4b32-8b51-4f91257cd8e5
          stepCounter: 5d38085d-4278-4e81-a23d-d8b2267e46df
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: RUN_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1d49a49-fbdc-47f3-8909-8a72ef6e5e1f
                stepCounter: 787c8bc4-9d29-4142-bc7b-1902deee5fc9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 85fb6413-38c9-43c8-9365-8fde91769b22
          stepCounter: 5d38085d-4278-4e81-a23d-d8b2267e46df
        config: {}
        dataType: TIMESTAMP_NTZ(3)
        defaultValue: ""
        description: ""
        name: FILE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d754e461-a43f-46cf-ae3f-de42c3b96213
                stepCounter: 787c8bc4-9d29-4142-bc7b-1902deee5fc9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74e3c0ef-d4fd-4a5a-834d-c8cf7c275297
          stepCounter: 5d38085d-4278-4e81-a23d-d8b2267e46df
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: The changing hash
        name: DSS_CHANGE_HASH
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1960a31b-d0c4-40ca-85b3-0db296a62e36
                stepCounter: 787c8bc4-9d29-4142-bc7b-1902deee5fc9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6aa9c426-f508-4936-926b-988c52b64796
          stepCounter: 5d38085d-4278-4e81-a23d-d8b2267e46df
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Record source
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 415e1a18-f378-4d4b-8561-8c7f07dacf8f
                stepCounter: 787c8bc4-9d29-4142-bc7b-1902deee5fc9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6795455c-c8ff-457b-b5ca-8252cf15950c
          stepCounter: 5d38085d-4278-4e81-a23d-d8b2267e46df
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was loaded in the data vault
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c1d15ec9-d2d7-474b-bff6-0eed27ad4801
                stepCounter: 787c8bc4-9d29-4142-bc7b-1902deee5fc9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c71e2431-0190-4b0c-bd07-f719b1892905
          stepCounter: 5d38085d-4278-4e81-a23d-d8b2267e46df
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row started in the data vault
        isSystemStartDate: true
        name: DSS_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddd37408-f02e-4a4e-ba2e-90b7a2132eb3
                stepCounter: 787c8bc4-9d29-4142-bc7b-1902deee5fc9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4cfa00c8-b27a-4452-97b2-9b922a6d85f5
          stepCounter: 5d38085d-4278-4e81-a23d-d8b2267e46df
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: Version number of a business key in the data vault
        isSurrogateKey: true
        isSystemVersion: true
        name: DSS_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e41ea7a3-5069-4442-9ae4-688dc7fdaeff
                stepCounter: 787c8bc4-9d29-4142-bc7b-1902deee5fc9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97e3282d-d627-46ca-bc50-3dff1fc8bfc2
          stepCounter: 5d38085d-4278-4e81-a23d-d8b2267e46df
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was inserted in the data vault
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c04a4b2-0807-48d7-887b-1b5969a60705
                stepCounter: 787c8bc4-9d29-4142-bc7b-1902deee5fc9
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_LKP_INSTITUTION_CARD_MROC: 787c8bc4-9d29-4142-bc7b-1902deee5fc9
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATAVAULT_RAW_VAULT
            nodeName: S_LKP_INSTITUTION_CARD_MROC
        join:
          joinCondition: |-
            FROM {{ ref('DATAVAULT_RAW_VAULT','S_LKP_INSTITUTION_CARD_MROC') }} s_lkp_institution_card_mroc
             INNER JOIN (
                    SELECT hk_h_lkp_institution_card,
                           MAX(dss_start_date) AS dss_start_date
                      FROM {{ ref('DATAVAULT_RAW_VAULT','S_LKP_INSTITUTION_CARD_MROC') }}
                     GROUP BY hk_h_lkp_institution_card
                   ) curr
                ON curr.hk_h_lkp_institution_card = s_lkp_institution_card_mroc.hk_h_lkp_institution_card
               AND curr.dss_start_date = s_lkp_institution_card_mroc.dss_start_date
        name: S_LKP_INSTITUTION_CARD_MROC_CURRENT
        noLinkRefs: []
  name: S_LKP_INSTITUTION_CARD_MROC_CURRENT
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
