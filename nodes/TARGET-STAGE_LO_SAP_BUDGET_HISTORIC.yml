fileVersion: 1
id: a2717b37-6a98-4725-b7f9-3fbbb82ea148
name: STAGE_LO_SAP_BUDGET_HISTORIC
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3cda2f0-5655-4ea6-98e8-fad8d24203f9
          stepCounter: a2717b37-6a98-4725-b7f9-3fbbb82ea148
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEDGER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a95e2d1c-75ca-40be-9561-3a563b611557
                stepCounter: e8524c23-d9e0-4d83-86ae-428803327912
            transform: TARGET.DIM_LEDGER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6715947e-6d05-49df-8347-ddda82ce4c82
          stepCounter: a2717b37-6a98-4725-b7f9-3fbbb82ea148
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACTVY_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5e7d210-78fe-4ce0-90cc-1b081cdc0b0b
                stepCounter: 2dd43a82-d1cd-4faa-9896-f735a52c38e7
            transform: TARGET.DIM_ACTVY_PER_DATE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c6d182e-04a8-4aef-aed4-37ba007cb64b
          stepCounter: a2717b37-6a98-4725-b7f9-3fbbb82ea148
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACCT_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 25381cf9-3703-41d6-b9ba-0b0525bb8912
                stepCounter: 16046caa-0e21-4501-abd9-fc6a817b0803
            transform: TARGET.DIM_ACCT_PER_DATE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be51a1bd-57ba-4df0-bef0-5f3920329cbe
          stepCounter: a2717b37-6a98-4725-b7f9-3fbbb82ea148
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_COST_CENTER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b116dc36-a893-4aee-bac6-660b69b80fe7
                stepCounter: f601baef-839f-49ab-b102-ee3fad93f21c
            transform: TARGET.DIM_COST_CENTER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b210f35b-ae24-4b56-a1d0-dbf1465fa8b6
          stepCounter: a2717b37-6a98-4725-b7f9-3fbbb82ea148
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: TARGET.DIM_AFE_TYPE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05eec97e-3bdb-4cc3-87ac-a0d28a133d31
          stepCounter: a2717b37-6a98-4725-b7f9-3fbbb82ea148
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_DEST_ORGANIZATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: TARGET.DIM_DEST_ORGANIZATION_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9bb2c4c-78f4-4156-b2f6-e11ccb731eca
          stepCounter: a2717b37-6a98-4725-b7f9-3fbbb82ea148
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GL_ACCOUNT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: TARGET.DIM_GL_ACCOUNT_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fdf181c4-bdd7-4108-b01a-bc7cf5c8301f
          stepCounter: a2717b37-6a98-4725-b7f9-3fbbb82ea148
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eb169a24-d282-43b6-ade8-2177eeff938e
                stepCounter: 38bc0451-df93-413f-b149-93d0fd46c572
            transform: TARGET.DIM_GROSS_NET_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8e50a0a-1d2c-43e7-91f1-a7b836d01951
          stepCounter: a2717b37-6a98-4725-b7f9-3fbbb82ea148
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_HIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21fac97a-151e-4cc2-8783-56a1148d309b
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: TARGET.DIM_LEASE_OPS_HIER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2de2ab2b-74bb-4da5-8c64-2fd062332141
          stepCounter: a2717b37-6a98-4725-b7f9-3fbbb82ea148
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_VERSION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 229d76c5-e976-46d2-84ce-8623a3e8d9c3
                stepCounter: e575d1a1-f47c-47ec-b457-d837fc9a6b39
            transform: TARGET.DIM_LEASE_OPS_VERSION_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82ef86d9-24d9-491a-93b5-645652f2846f
          stepCounter: a2717b37-6a98-4725-b7f9-3fbbb82ea148
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LINE_ITEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: TARGET.DIM_LINE_ITEM_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ecbfbd03-bf53-4ac3-bc26-06cb903b08e4
          stepCounter: a2717b37-6a98-4725-b7f9-3fbbb82ea148
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_VOUCHER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: TARGET.DIM_VOUCHER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64e71b89-7b75-44ff-abf6-4b5892b8669e
          stepCounter: a2717b37-6a98-4725-b7f9-3fbbb82ea148
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: TARGET.DIM_AFE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b9da8aeb-e213-42f1-aab3-3acddd26ef67
          stepCounter: a2717b37-6a98-4725-b7f9-3fbbb82ea148
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_INVOICE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: TARGET.DIM_INVOICE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa68b6ff-9d7c-49b4-8343-f7eb2804e794
          stepCounter: a2717b37-6a98-4725-b7f9-3fbbb82ea148
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_PRODUCT_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: TARGET.DIM_PRODUCT_TYPE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07d6c51c-f09f-4c04-9579-e1db65203d02
          stepCounter: a2717b37-6a98-4725-b7f9-3fbbb82ea148
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e9bc873-e45b-4060-872b-5054423801e6
                stepCounter: 8905fca2-c8f3-43cc-a747-955c8df8f791
            transform: TARGET.LINE_NO
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5b412f6-53c0-4553-ba92-d7280f9146e8
          stepCounter: a2717b37-6a98-4725-b7f9-3fbbb82ea148
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e434276f-b251-4053-b347-68c21a16fdf7
                stepCounter: 8905fca2-c8f3-43cc-a747-955c8df8f791
            transform: TARGET.OP_AMT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 981cf8d0-23f4-447a-8043-ab4f43b25a94
          stepCounter: a2717b37-6a98-4725-b7f9-3fbbb82ea148
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b7f36770-e8d8-4f26-a0f2-eb9d25b13ba9
                stepCounter: 8905fca2-c8f3-43cc-a747-955c8df8f791
            transform: TARGET.CAD_AMT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd09261e-3db4-468f-808c-be3d1acfb21f
          stepCounter: a2717b37-6a98-4725-b7f9-3fbbb82ea148
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: DENOM_OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b3522bf8-cd47-425d-833f-f53ed2cc1d06
                stepCounter: 8905fca2-c8f3-43cc-a747-955c8df8f791
            transform: TARGET.DENOM_OP_AMT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dd86ac09-a5e8-444b-af4b-e663a8cf7e2c
          stepCounter: a2717b37-6a98-4725-b7f9-3fbbb82ea148
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: DENOM_CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5175a0c2-65cc-4d55-8a0e-af84191d6478
                stepCounter: 8905fca2-c8f3-43cc-a747-955c8df8f791
            transform: TARGET.DENOM_CAD_AMT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4c28736-ce04-464f-97d3-141937c39f34
          stepCounter: a2717b37-6a98-4725-b7f9-3fbbb82ea148
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: Gross Line Item Net Op Amount
        name: NET_OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 002cc0c4-f796-47be-a252-411aa43556ec
                stepCounter: 8905fca2-c8f3-43cc-a747-955c8df8f791
            transform: TARGET.NET_OP_AMT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 351e0fa9-a7ee-4b47-92bf-6d061b9ada29
          stepCounter: a2717b37-6a98-4725-b7f9-3fbbb82ea148
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: LI_VOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TARGET.LI_VOL
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 409ec713-e9a7-4216-ac59-f33ce624487d
          stepCounter: a2717b37-6a98-4725-b7f9-3fbbb82ea148
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in cubic meters (m3)
        name: LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00fcf7dc-ca91-4bbc-a894-fad8913a2290
                stepCounter: 8905fca2-c8f3-43cc-a747-955c8df8f791
            transform: TARGET.LI_VOL_M3
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a0dd2efd-535e-4b0d-9b6c-eab5bf024089
          stepCounter: a2717b37-6a98-4725-b7f9-3fbbb82ea148
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in imperial measurement
        name: LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2cff9204-790d-42d9-aacc-2dc186379631
                stepCounter: 8905fca2-c8f3-43cc-a747-955c8df8f791
            transform: TARGET.LI_VOL_IMPERIAL
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e4144692-0710-44b7-bf23-549170dbf31f
          stepCounter: a2717b37-6a98-4725-b7f9-3fbbb82ea148
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in BOE (Barrel of Oil Equivalent)
        name: LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 69e79e09-1f06-47f7-9bcf-e649ec066f75
                stepCounter: 8905fca2-c8f3-43cc-a747-955c8df8f791
            transform: TARGET.LI_VOL_BOE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 117ad8c9-0ace-46db-b629-42e95f94af32
          stepCounter: a2717b37-6a98-4725-b7f9-3fbbb82ea148
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in normalized cubic meters (nm3)
        name: LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e1b8db9-b1ab-4955-8412-09fbe42ba6ad
                stepCounter: 8905fca2-c8f3-43cc-a747-955c8df8f791
            transform: TARGET.LI_VOL_NM3
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5bbf699-d009-42f6-bbca-5e941e7b5c26
          stepCounter: a2717b37-6a98-4725-b7f9-3fbbb82ea148
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: DENOM_LI_VOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TARGET.DENOM_LI_VOL
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94f1e13d-4a05-410a-b363-8d9886de6a02
          stepCounter: a2717b37-6a98-4725-b7f9-3fbbb82ea148
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Calculation Denominator Line item Volume in cubic meters (m3)
        name: DENOM_LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f253e0f1-9982-4e3a-95bc-350079f746f8
                stepCounter: 8905fca2-c8f3-43cc-a747-955c8df8f791
            transform: TARGET.DENOM_LI_VOL_M3
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a4fb596-2480-4354-8f97-626ffad6f0ea
          stepCounter: a2717b37-6a98-4725-b7f9-3fbbb82ea148
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Calculation Denominator Line item Volume in imperial measurement
        name: DENOM_LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e197bab-a647-4e41-8645-89b7cbb5b5a1
                stepCounter: 8905fca2-c8f3-43cc-a747-955c8df8f791
            transform: TARGET.DENOM_LI_VOL_IMPERIAL
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05d9e493-3804-4813-8702-65ecaa5feef4
          stepCounter: a2717b37-6a98-4725-b7f9-3fbbb82ea148
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Calculation Denominator Line item Volume in BOE (Barrel of Oil Equivalent)
        name: DENOM_LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2349571e-680a-41a0-8b2f-9194e775ae91
                stepCounter: 8905fca2-c8f3-43cc-a747-955c8df8f791
            transform: TARGET.DENOM_LI_VOL_BOE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1971129-21ad-495f-9d55-134ef9e95c94
          stepCounter: a2717b37-6a98-4725-b7f9-3fbbb82ea148
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Calculation Denominator Line item Volume in normalized cubic meters (nm3)
        name: DENOM_LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 66a9409a-fb0b-43df-9c89-330e0ad95a96
                stepCounter: 8905fca2-c8f3-43cc-a747-955c8df8f791
            transform: TARGET.DENOM_LI_VOL_NM3
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55cb658b-e743-478e-8992-6ffa5c8b5785
          stepCounter: a2717b37-6a98-4725-b7f9-3fbbb82ea148
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: ""
        name: EXCHANGE_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b799b327-a3a0-4d17-8985-6a5e96ff721d
                stepCounter: 8905fca2-c8f3-43cc-a747-955c8df8f791
            transform: TARGET.EXCHANGE_RATE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 62155da3-722f-4b1c-9341-9f7531db3fb8
          stepCounter: a2717b37-6a98-4725-b7f9-3fbbb82ea148
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cf9cdd56-e60b-4014-9d77-386136a73fbc
                stepCounter: 8905fca2-c8f3-43cc-a747-955c8df8f791
            transform: TARGET.OP_CURR_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c5fa0e0-c4df-40fc-b1ee-f276f283c166
          stepCounter: a2717b37-6a98-4725-b7f9-3fbbb82ea148
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Indicates amounts are gross or net.
        name: GROSS_OR_NET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2b5882dd-5660-46ed-8a46-b370350b216a
                stepCounter: 8905fca2-c8f3-43cc-a747-955c8df8f791
            transform: TARGET.GROSS_OR_NET_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53d7d15e-6d83-4202-8144-22154edc8c4a
          stepCounter: a2717b37-6a98-4725-b7f9-3fbbb82ea148
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: LINE_NO_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TARGET.LINE_NO_GROUP
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72531c53-e40f-4939-8eb0-39485a297058
          stepCounter: a2717b37-6a98-4725-b7f9-3fbbb82ea148
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: OP_NONOP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8af17c36-6475-451f-8ff3-f198d3300e55
                stepCounter: 8905fca2-c8f3-43cc-a747-955c8df8f791
            transform: TARGET.OP_NONOP
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd2968eb-5667-4e51-b356-721eaea20fb5
          stepCounter: a2717b37-6a98-4725-b7f9-3fbbb82ea148
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PROD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TARGET.PROD_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 046d2707-8c90-46bf-98b1-d98cff7a2cee
          stepCounter: a2717b37-6a98-4725-b7f9-3fbbb82ea148
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 440b3451-b2bb-4398-9ffd-f6b1859dc209
                stepCounter: 8905fca2-c8f3-43cc-a747-955c8df8f791
            transform: TARGET.DSS_CREATE_TIME
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5556ca4d-0977-4439-aec5-4ee939772f02
          stepCounter: a2717b37-6a98-4725-b7f9-3fbbb82ea148
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00c94c1b-a495-49f5-aff2-9c753867d445
                stepCounter: 8905fca2-c8f3-43cc-a747-955c8df8f791
            transform: TARGET.DSS_UPDATE_TIME
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          FACT_LO_QB_LEASE_OPS: 8905fca2-c8f3-43cc-a747-955c8df8f791
          DIM_LO_QB_LEASE_OPS_VERSION: 1d3eb131-f9ed-46ee-87da-94a5021e200f
          DIM_LO_QB_GROSS_NET: 7ead3cae-6bd3-47d2-904a-84fbe38946f3
          DIM_LO_SAP_GROSS_NET: 38bc0451-df93-413f-b149-93d0fd46c572
          DIM_LO_QB_LEASE_OPS_HIER: 8945c1c9-54c8-4d63-8bfb-2b2c9e967582
          DIM_LO_SAP_LEASE_OPS_HIER: 82938641-7c51-4aff-ad3a-c7a56af30c01
          DIM_LO_QB_DEST_ORGANIZATION: 51ca57c2-61eb-48f1-9838-ddafecb307e8
          DIM_LO_SAP_DEST_ORGANIZATION: c39a02ca-a012-4752-ac49-7f679c9ff6e4
          DIM_LO_QB_COST_CENTER: 6ba8d0f3-52cc-4aa4-91d8-3fb4acaadf77
          DIM_LO_SAP_COST_CENTER: f601baef-839f-49ab-b102-ee3fad93f21c
          DIM_LO_SAP_LEDGER: e8524c23-d9e0-4d83-86ae-428803327912
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEDGER
          - locationName: TARGET
            nodeName: FACT_LO_QB_LEASE_OPS
          - locationName: TARGET
            nodeName: DIM_LO_QB_LEASE_OPS_VERSION
          - locationName: TARGET
            nodeName: DIM_LO_QB_GROSS_NET
          - locationName: TARGET
            nodeName: DIM_LO_SAP_GROSS_NET
          - locationName: TARGET
            nodeName: DIM_LO_QB_LEASE_OPS_HIER
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_HIER
          - locationName: TARGET
            nodeName: DIM_LO_QB_DEST_ORGANIZATION
          - locationName: TARGET
            nodeName: DIM_LO_SAP_DEST_ORGANIZATION
          - locationName: TARGET
            nodeName: DIM_LO_QB_COST_CENTER
          - locationName: TARGET
            nodeName: DIM_LO_SAP_COST_CENTER
        join:
          joinCondition: |-
            FROM (
                    SELECT DIM_LO_SAP_LEDGER.DIM_LEDGER_KEY AS DIM_LEDGER_KEY ,
                           FACT_LO_QB_LEASE_OPS.DIM_ACTVY_PER_DATE_KEY ,
                           FACT_LO_QB_LEASE_OPS.DIM_ACCT_PER_DATE_KEY ,
                           NVL(DIM_LO_SAP_COST_CENTER.DIM_COST_CENTER_KEY,0) AS DIM_COST_CENTER_KEY ,
                           0 AS DIM_AFE_TYPE_KEY ,
                           NVL(DIM_LO_SAP_DEST_ORGANIZATION.DIM_DEST_ORGANIZATION_KEY,0) AS DIM_DEST_ORGANIZATION_KEY ,
                           0 AS DIM_GL_ACCOUNT_KEY ,
                           NVL(DIM_LO_SAP_GROSS_NET.DIM_GROSS_NET_KEY,0) AS DIM_GROSS_NET_KEY ,
                           NVL(DIM_LO_SAP_LEASE_OPS_HIER.DIM_LEASE_OPS_HIER_KEY,0) AS DIM_LEASE_OPS_HIER_KEY ,-(10 + FACT_LO_QB_LEASE_OPS.DIM_LEASE_OPS_VERSION_KEY) AS DIM_LEASE_OPS_VERSION_KEY ,
                           0 AS DIM_LINE_ITEM_KEY ,
                           0 AS DIM_VOUCHER_KEY ,
                           0 AS DIM_AFE_KEY ,
                           0 AS DIM_INVOICE_KEY ,
                           0 AS DIM_PRODUCT_TYPE_KEY ,
                           FACT_LO_QB_LEASE_OPS.LINE_NO ,
                           FACT_LO_QB_LEASE_OPS.OP_AMT ,
                           FACT_LO_QB_LEASE_OPS.CAD_AMT ,
                           FACT_LO_QB_LEASE_OPS.DENOM_OP_AMT ,
                           FACT_LO_QB_LEASE_OPS.DENOM_CAD_AMT ,
                           FACT_LO_QB_LEASE_OPS.NET_OP_AMT ,
                           FACT_LO_QB_LEASE_OPS.LI_VOL_IMPERIAL AS LI_VOL ,
                           FACT_LO_QB_LEASE_OPS.LI_VOL_M3 ,
                           FACT_LO_QB_LEASE_OPS.LI_VOL_IMPERIAL ,
                           FACT_LO_QB_LEASE_OPS.LI_VOL_BOE ,
                           FACT_LO_QB_LEASE_OPS.LI_VOL_NM3 ,
                           FACT_LO_QB_LEASE_OPS.DENOM_LI_VOL_IMPERIAL AS DENOM_LI_VOL ,
                           FACT_LO_QB_LEASE_OPS.DENOM_LI_VOL_M3 ,
                           FACT_LO_QB_LEASE_OPS.DENOM_LI_VOL_IMPERIAL ,
                           FACT_LO_QB_LEASE_OPS.DENOM_LI_VOL_BOE ,
                           FACT_LO_QB_LEASE_OPS.DENOM_LI_VOL_NM3 ,
                           FACT_LO_QB_LEASE_OPS.EXCHANGE_RATE ,
                           FACT_LO_QB_LEASE_OPS.OP_CURR_CODE ,
                           FACT_LO_QB_LEASE_OPS.GROSS_OR_NET_CODE ,
                           DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO_GROUP ,
                           FACT_LO_QB_LEASE_OPS.OP_NONOP ,
                           NULL AS PROD_CODE ,
                           DIM_LO_QB_LEASE_OPS_VERSION.EFFECTIVE_DATE LEASE_OPS_VERSION_EFFECTIVE_DATE ,
                           FACT_LO_QB_LEASE_OPS.DSS_CREATE_TIME ,
                           FACT_LO_QB_LEASE_OPS.DSS_UPDATE_TIME
                      FROM {{ ref('TARGET','FACT_LO_QB_LEASE_OPS') }} FACT_LO_QB_LEASE_OPS
                     INNER JOIN (
                            SELECT *
                              FROM {{ ref('TARGET','DIM_LO_QB_LEASE_OPS_VERSION') }}
                             WHERE VERSION_TYPE = 'BUDGET'
                           ) AS DIM_LO_QB_LEASE_OPS_VERSION
                        ON (FACT_LO_QB_LEASE_OPS.DIM_LEASE_OPS_VERSION_KEY = DIM_LO_QB_LEASE_OPS_VERSION.DIM_LEASE_OPS_VERSION_KEY)
                     INNER JOIN {{ ref('TARGET','DIM_LO_QB_GROSS_NET') }} AS DIM_LO_QB_GROSS_NET
                        ON (FACT_LO_QB_LEASE_OPS.DIM_GROSS_NET_KEY = DIM_LO_QB_GROSS_NET.DIM_GROSS_NET_KEY)
                      LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_GROSS_NET') }} AS DIM_LO_SAP_GROSS_NET
                        ON (DIM_LO_QB_GROSS_NET.GROSS_OR_NET_CODE = DIM_LO_SAP_GROSS_NET.GROSS_OR_NET_CODE)
                     INNER JOIN {{ ref('TARGET','DIM_LO_QB_LEASE_OPS_HIER') }} AS DIM_LO_QB_LEASE_OPS_HIER
                        ON (FACT_LO_QB_LEASE_OPS.DIM_LEASE_OPS_HIER_KEY = DIM_LO_QB_LEASE_OPS_HIER.DIM_LEASE_OPS_HIER_KEY)
                      LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_HIER') }} AS DIM_LO_SAP_LEASE_OPS_HIER
                        ON (DIM_LO_QB_LEASE_OPS_HIER.LINE_NO = DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO)
                     INNER JOIN (
                            SELECT *
                              FROM {{ ref('TARGET','DIM_LO_QB_DEST_ORGANIZATION') }}
                             WHERE IS_OPERATIONAL = 'Y'
                           ) AS DIM_LO_QB_DEST_ORGANIZATION
                        ON (FACT_LO_QB_LEASE_OPS.DIM_DEST_ORGANIZATION_KEY = DIM_LO_QB_DEST_ORGANIZATION.DIM_DEST_ORGANIZATION_KEY)
                      LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_DEST_ORGANIZATION') }} AS DIM_LO_SAP_DEST_ORGANIZATION
                        ON (TRIM(TO_CHAR(1000+DIM_LO_QB_DEST_ORGANIZATION.ORG_ID)) = DIM_LO_SAP_DEST_ORGANIZATION.ORG_ID)
                     INNER JOIN {{ ref('TARGET','DIM_LO_QB_COST_CENTER') }} AS DIM_LO_QB_COST_CENTER
                        ON (FACT_LO_QB_LEASE_OPS.DIM_COST_CENTER_KEY = DIM_LO_QB_COST_CENTER.DIM_COST_CENTER_KEY)
                      LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_COST_CENTER') }} AS DIM_LO_SAP_COST_CENTER
                        ON (DIM_LO_QB_COST_CENTER.CC_NUM = DIM_LO_SAP_COST_CENTER.CC_NUM)
                     CROSS JOIN (
                            SELECT *
                              FROM {{ ref('TARGET','DIM_LO_SAP_LEDGER') }}
                             WHERE LEADING_LEDGER_FLAG = 'Y'
                           ) AS DIM_LO_SAP_LEDGER
                   ) AS TARGET
             WHERE TARGET.LEASE_OPS_VERSION_EFFECTIVE_DATE IN (TO_DATE('20230101','YYYYMMDD'))
        name: STAGE_LO_SAP_BUDGET_HISTORIC
        noLinkRefs: []
  name: STAGE_LO_SAP_BUDGET_HISTORIC
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
