fileVersion: 1
id: e59f31f7-3219-4d81-afe9-568589b96823
name: STAGE_PRODVIEW_ALLOCATED_VOLUMES
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "Prodview allocated volumes"
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 768898cf-0575-4b1d-b562-3c4bf1445971
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: IDRECUNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52601fc0-68e1-4e5f-876a-00645d2f467e
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac6dabed-eace-4678-b763-4f14fc6ab6a9
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: IDFLOWNET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e63ff1c0-dd08-4f41-8d3f-2e5a1b550560
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a484a3e-577d-41cc-bee0-f6cfa1d9d201
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ENTITY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 66fb5299-e0ba-46ea-9fd9-f602d14f76c8
                stepCounter: e3f3cfdf-bda2-498e-bd55-26e7262626ae
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 081a7f5e-044d-4bf7-ac39-5247f8252354
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SCENARIO_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: "'pv_allocated'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98d39821-368a-4017-801e-3c315758155d
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ACTIVITY_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e23862e-5f1c-4ceb-9ed3-26e0c07e30fc
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: TO_VARCHAR(ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DTTM, 'YYYYMMDD')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ef21abd-43b1-4aa9-843f-819ca331973e
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: ACTIVITY_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e23862e-5f1c-4ceb-9ed3-26e0c07e30fc
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0db5803f-d267-4a4b-8218-d0a22bce1b6b
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: NORMALIZED_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d0a1178d-0a76-4a6d-987d-882feb580e1c
                stepCounter: e3f3cfdf-bda2-498e-bd55-26e7262626ae
            transform: |-
              CASE WHEN STAGE_PRODVIEW_WELLS.ON_PROD_DATE IS NULL                                  THEN '-1'
                          WHEN STAGE_PRODVIEW_WELLS.ON_PROD_DATE > ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DTTM THEN '-1'
                          ELSE DATEDIFF(DAY, STAGE_PRODVIEW_WELLS.ON_PROD_DATE, ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DTTM) + 1
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: abb5c650-0181-4858-b91f-8903dea30ccb
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PRODUCING_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 477a8f27-c80d-40b8-b48a-9b4140bdeaad
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ON_PROD_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: COALESCE(TO_VARCHAR(STAGE_PRODVIEW_WELLS.ON_PROD_DATE, 'YYYYMMDD'), '-1')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a08dcc3-ccc7-422f-95b3-f557e3d8853d
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: The cost centre which the reporting entity is representing.
        name: CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cdb42138-383e-4153-8935-35b2b72dc8fe
                stepCounter: e3f3cfdf-bda2-498e-bd55-26e7262626ae
            transform: COALESCE(STAGE_PRODVIEW_WELLS.CC_NUM, '-1')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c7f8d3ec-f505-44c0-9248-c5495e238bed
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: HOURS_ON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 81e344fc-8e1c-48b6-b2a3-4528e7962c25
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DUROP * 24
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dfef45a0-3ffe-42a3-8e51-dfe77540297c
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: HOURS_DOWN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 849b0441-aadd-4df8-aa0c-bef157b937d0
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DURDOWN * 24
      - appliedColumnTests: {}
        columnReference:
          columnCounter: efe03ed9-50c1-4fc9-90c3-5778eda22655
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: HCLIQ_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dac26252-e9d5-4ac8-995d-04e038fcf25b
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 28ab29db-7021-4715-ba92-104263719d84
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: OIL_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02e92701-932c-44a3-8a80-84585564dcb2
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8754b770-83b3-4626-8a26-8e5eb174c8b3
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: CONDENSATE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5839b94-93f3-48a5-80b9-9758740db524
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c35579a-22a2-4c82-a2c2-b46a66f9a722
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: NGL_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8fdfffed-e6ec-4c8d-806e-5228b53b4ba7
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ecf2291e-e655-4ce5-9c68-37787c5cd64d
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed079b9e-40b2-4ef1-a22a-2af799344a29
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.VOLNEWPRODALLOCGAS/1000
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5411c851-3b90-4327-95ec-f1a57b6ad6a2
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d150863-195c-46f9-b422-962623c38c57
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e3f5f82-4bd9-4817-9f08-cfe7998046f1
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: SAND_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39ed43e7-d3df-47d9-b880-aade1e918595
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d98bc242-3214-4bad-a944-e740953b9d30
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bdb6415a-5401-4be1-a750-7dc668fa02b5
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.VOLINJECTGAS/1000
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6df5576a-a071-461b-98bb-a8411f727e30
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_HCLIQ_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a023fa13-1817-4634-af61-6d98694392fd
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c55d6a7c-76ba-460a-a265-2e00d7bf74c2
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_SAND_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 29854860-fe14-4cda-97a0-5483be341131
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea04d133-b0f0-4eb7-a028-8da1ad5a95dd
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7984656-93a2-45f4-8fc0-3e4f11df74e8
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b5facdd6-d871-4574-8ede-5f0c43e2d848
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: RECOVERED_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef77f574-47d5-4f15-8db6-c89138db81ff
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.VOLRECOVGAS/1000
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4136b8b7-d82f-41b7-96a9-1eae1d5971de
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: RECOVERED_HCLIQ_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f2ca6ac-6e3e-4294-b1ad-16c416934c41
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5497cc21-fc5b-4b6f-be30-cf78d42f0e44
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: RECOVERED_SAND_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b23f6646-acec-405b-a61e-a2c057d6a62c
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d03e401-0fb1-4d30-9e99-2145f03594ba
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: RECOVERED_WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d41c00eb-e23d-4ce8-b357-f711e8a2822a
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 787e12e3-986a-4cd8-922f-89341637dc91
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: REMAINING_LIFT_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78487121-0a5b-4781-b76a-0f42d3e6ce1e
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.VOLREMAINRECOVGAS/1000
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8072ac4-2a0e-4f03-83ea-5139b404e4f6
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: REMAINING_LOAD_HCLIQ_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 783591f3-5bd2-4764-8ee1-98483bd9d582
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66022455-5562-4357-a8ee-f2bf68a60696
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: REMAINING_LOAD_WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4671bc9b-fbbe-4132-bdc9-58ad4cec5fab
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6ab33a6-4cf8-4c0c-8534-bfb2b52f3078
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: REMAINING_LOAD_SAND_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 86e0250f-1763-42b3-a702-5363892b35d7
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2529f949-d336-4475-9d03-85114e74289b
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: METHANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6925715a-9486-48a6-bac7-8f103e9ed10c
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: ETHANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de31233c-a5ad-446a-bce1-4b63b4608f7f
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: PROPANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 290afb94-032b-40c7-a558-69e75decc489
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: BUTANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4bca569-6edb-4051-bda6-6b2260ef0fec
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: PENTANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 469b7d52-2e38-4b06-85fa-0676280ff522
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WIGAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef135fd3-29ca-4192-ae3c-b84d4a82b57c
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6692284f-686d-4aff-8aad-26675a33c107
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WIHCLIQ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1025f801-aa3b-4996-9bb3-4e2358493c31
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d390d2f-c4b9-4d4b-9c78-c3173213d886
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WISAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e04651b-53ca-49bb-82ef-835c27428375
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d06bf78d-527d-4f97-a9a0-ab477bcdc28d
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WIWATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c2fb5b3-ff9c-4ae0-995e-e6dc900f95ec
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 139f95d6-6769-44e6-92b1-6f6ea15515b8
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: FLAREGAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d0b9d088-e51c-4c96-96bc-ae48fb24f98f
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.VOLDISPFLAREGAS/1000
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a855488-9983-4ead-8151-70f5ae17b086
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: VENTGAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ce505dc-25e3-4eca-bd2d-ae970575ce99
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.VOLDISPVENTGAS/1000
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 449ccf59-bb8c-47ca-98a0-e4bd172a601a
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: FUELGAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 664a90f2-f990-4f5d-86a6-f1ae3f70da24
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.VOLDISPFUELGAS/1000
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e03499aa-8311-4e4a-a538-e0d929d2892f
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: BAT_PRO_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a43c8ba4-51ca-4b25-8956-d16425dc28c3
          stepCounter: e59f31f7-3219-4d81-afe9-568589b96823
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_LIFT_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 13201972-914e-4ae8-92f5-f770d52c2ce8
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.VOLINJECTRECOVGAS/1000
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY: d08539ff-37af-4c21-9836-963dca56c39d
          STAGE_PRODVIEW_WELLS: e3f3cfdf-bda2-498e-bd55-26e7262626ae
          ODS_PVIEW_PVT_PVUNITDISPMONTHDAY: e1eaab03-46d0-47c5-afef-a1e386773c58
          ODS_PVIEW_PVT_PVUNITNODE: 0cc17ffa-ae19-4239-8958-77363f7b8a14
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY
          - locationName: TARGET
            nodeName: STAGE_PRODVIEW_WELLS
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITDISPMONTHDAY
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITNODE
        join:
          joinCondition: |-
            FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY') }} ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY
              JOIN {{ ref('TARGET','STAGE_PRODVIEW_WELLS') }} STAGE_PRODVIEW_WELLS
                ON ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.IDFLOWNET = STAGE_PRODVIEW_WELLS.IDFLOWNET
               AND ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.IDRECUNIT = STAGE_PRODVIEW_WELLS.ENTITY_KEY
              LEFT JOIN (
                    SELECT ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDFLOWNET,
                           ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDRECUNIT,
                           ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.DTTM AS ACTIVITY_DATE,
                           SUM(NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLC1LIQ, 0)) AS METHANE_METRIC,
                           SUM(NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLC2LIQ, 0)) AS ETHANE_METRIC,
                           SUM(NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLC3LIQ, 0)) AS PROPANE_METRIC,
                           SUM(NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLIC4LIQ, 0) + NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLNC4LIQ, 0)) AS BUTANE_METRIC,
                           SUM(NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLIC5LIQ, 0) + NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLNC5LIQ, 0) + NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLC6LIQ, 0) + NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLC7LIQ, 0)) AS PENTANE_METRIC
                      FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITDISPMONTHDAY') }} ODS_PVIEW_PVT_PVUNITDISPMONTHDAY
                      LEFT JOIN {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITNODE') }} ODS_PVIEW_PVT_PVUNITNODE
                        ON ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDRECDISPUNITNODE = ODS_PVIEW_PVT_PVUNITNODE.IDREC
                       AND ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDFLOWNET = ODS_PVIEW_PVT_PVUNITNODE.IDFLOWNET
                       AND ODS_PVIEW_PVT_PVUNITNODE.DSS_CURRENT_FLAG = 'Y'
                       AND ODS_PVIEW_PVT_PVUNITNODE.DSS_DELETE_FLAG != 'Y'
                     WHERE ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.DSS_CURRENT_FLAG = 'Y'
                       AND ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.DSS_DELETE_FLAG != 'Y'
                       AND ODS_PVIEW_PVT_PVUNITNODE.TYPDISPHCLIQ = 'ngl'
                     GROUP BY ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDFLOWNET,
                              ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDRECUNIT,
                              ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.DTTM
                   ) ODS_PVIEW_PVT_PVUNITDISPMONTHDAY
                ON ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.IDRECUNIT = ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDRECUNIT
               AND ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DTTM = ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.ACTIVITY_DATE
               AND ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.IDFLOWNET = ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDFLOWNET
             WHERE ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DSS_CURRENT_FLAG = 'Y'
               AND ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DSS_DELETE_FLAG != 'Y'
        name: STAGE_PRODVIEW_ALLOCATED_VOLUMES
        noLinkRefs: []
  name: STAGE_PRODVIEW_ALLOCATED_VOLUMES
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
