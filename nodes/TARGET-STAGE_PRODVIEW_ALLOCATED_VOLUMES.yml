fileVersion: 1
id: c476c01f-a342-4f8d-b103-d20b70e92f56
name: STAGE_PRODVIEW_ALLOCATED_VOLUMES
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "Prodview allocated volumes"
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c1f7247-0e93-455e-bd77-5d3eb3a2472c
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: IDRECUNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 850244b2-cf63-447e-9a9e-2898428215e9
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97c37254-df25-47e4-aa26-334c5535cdae
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: IDFLOWNET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e1da49e-8182-4861-8905-81254314693e
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: befd0152-458e-4db4-bd2b-1a5a455d94a7
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ENTITY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 772019ac-3ca7-4166-bac9-02765e1433aa
                stepCounter: a3aef473-15c0-437b-be53-6abfe8efbd45
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d83cacba-5696-4845-a96b-4490f4cd3faa
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SCENARIO_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: "'pv_allocated'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c635e84-bcfd-4f9c-bcf3-761a71ffc5e0
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ACTIVITY_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f12a712-52a9-49bc-b9b3-9f6c776cada1
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: TO_VARCHAR(ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DTTM, 'YYYYMMDD')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1368b02-2d55-4306-9a23-cef5d5a257f3
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: ACTIVITY_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f12a712-52a9-49bc-b9b3-9f6c776cada1
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c0e304f-4569-4747-bb03-1e5409e38476
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: NORMALIZED_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1ad647c-d9d9-4a5e-a6cb-9b1d6b6dd6ec
                stepCounter: a3aef473-15c0-437b-be53-6abfe8efbd45
            transform: |-
              CASE WHEN STAGE_PRODVIEW_WELLS.ON_PROD_DATE IS NULL                                  THEN '-1'
                          WHEN STAGE_PRODVIEW_WELLS.ON_PROD_DATE > ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DTTM THEN '-1'
                          ELSE DATEDIFF(DAY, STAGE_PRODVIEW_WELLS.ON_PROD_DATE, ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DTTM) + 1
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ef51d16-17bc-471f-bf9e-7559094b5177
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PRODUCING_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32e7ab67-023c-4b1f-b539-fab6f2c592cb
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ON_PROD_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: COALESCE(TO_VARCHAR(STAGE_PRODVIEW_WELLS.ON_PROD_DATE, 'YYYYMMDD'), '-1')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 822c3254-f9df-4571-9bc2-faaffc14cf20
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: The cost centre which the reporting entity is representing.
        name: CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3499517-4f35-4f0e-b240-2c09ebb060a0
                stepCounter: a3aef473-15c0-437b-be53-6abfe8efbd45
            transform: COALESCE(STAGE_PRODVIEW_WELLS.CC_NUM, '-1')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2c8334e-e371-4472-a01b-f0f8bb88ce5d
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: HOURS_ON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 565c3190-bc88-4ecf-8f99-070028fb908c
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DUROP * 24
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de84fb3d-17f1-4b19-a541-52ae4ec66768
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: HOURS_DOWN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b51b4b24-93e1-450a-abda-190776b9def9
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DURDOWN * 24
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 36e71be6-c0bc-459f-a1e2-32eb006c63e0
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: HCLIQ_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07b15b03-23c0-4b55-b2de-ce0997f6d260
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3afa7efa-a840-4f2e-99a6-84b241ba9c3f
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: OIL_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84c2e90c-25c5-4b2c-a586-411562b4131d
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa753ca3-daf8-424d-81b7-db0df4441577
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: CONDENSATE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ccd7cb6f-3240-43b7-8466-e1f54574e4db
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e18a41d0-10ba-4ea1-b7b8-a1a7943845db
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: NGL_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 962ca092-8160-49e1-bd11-5560781451af
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5bedffd-de6e-46d1-9788-0413de04b201
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f342daf-352b-4bba-8d23-2cb8e4272900
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.VOLNEWPRODALLOCGAS/1000
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20527c25-90de-40c9-ae92-cb125aa88f72
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1a8bf3e0-4605-42d8-952d-e12b80f99266
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b836ca5-c03d-49f6-94b0-92e931797046
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: SAND_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 04480156-6e75-432b-8d56-7ea513f7b123
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79986bc0-07ac-4b1c-bc24-64d3001a9571
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90040229-c62c-42c9-bb07-2139dea4c0cc
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.VOLINJECTGAS/1000
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40d3aac9-1db1-4436-871b-a7ca83c53c4c
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_HCLIQ_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 34116b5d-1330-4ec3-b490-d09dd28cecb0
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af85b12d-91e9-416a-b795-572341148053
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_SAND_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c6d30d4-f340-47fe-a4a2-6e5cd2454c28
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca528ac8-041b-4fd2-affb-62f9258b37d6
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce8f6ae1-15cb-4bad-b309-5020a5336519
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc81e7e3-8a6a-4d97-b72f-b7d5a0cd38e4
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: RECOVERED_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dd33f6d1-2157-4ed6-a092-118da79149f6
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.VOLRECOVGAS/1000
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4804c666-c85d-407d-ba58-37446c0fd83b
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: RECOVERED_HCLIQ_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1ec5c6f-8d66-49f8-8623-abce9642c5be
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f41d57ff-00b8-4918-b7a3-3cf87c4e02f1
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: RECOVERED_SAND_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 279634bf-cda5-473c-883b-eef6222d7b18
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd7687b1-e147-4142-85f9-6271cd65e13e
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: RECOVERED_WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa874acd-4dde-48fc-97a7-7ad5feb4a1ae
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a67b10d-5793-4d8b-adbc-7e93b1e67b60
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: REMAINING_LIFT_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5da7e4e9-94b8-405f-833a-f6b400c2b553
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.VOLREMAINRECOVGAS/1000
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 471606bb-b821-4ea4-9ca7-605d75d7c1a2
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: REMAINING_LOAD_HCLIQ_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f3695d77-a7ab-4bb0-a7e6-b02f8e5a856d
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b40ce222-a1d4-4393-a6fb-d95e39cfdbe2
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: REMAINING_LOAD_WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 36ccb9b3-b958-4dad-9663-c4aa76c0124a
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7ccbc48-4c7a-48b0-b723-6e49dc9a52da
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: REMAINING_LOAD_SAND_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: baeb581d-0e76-4af3-95ec-9fd0d745483d
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc838eb0-274f-4d92-9907-480ce5bce23d
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: METHANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e648a1d-7fa6-4864-856c-73ddffcd672a
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: ETHANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 953fff06-e278-4f8a-83c2-00995fd10a06
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: PROPANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2253f595-0486-4dba-8bec-20c3ae38360e
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: BUTANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 51deaafc-d594-48fd-934d-f2c52b65c0db
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: PENTANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6892d7fc-ef5a-4612-9803-5f303fc0b829
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WIGAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c20e0f47-3157-4ac3-b43f-71f5fe1a075d
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a0a623d8-d6a4-4442-90cd-a0cd9b93327b
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WIHCLIQ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56af0ab0-f80f-4382-9236-5939ab19ee61
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48238da2-ce5e-401e-9607-865d370690d7
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WISAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc98fd8d-12e4-4909-875b-d54734241f4a
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba4bf793-6438-49df-bb97-c5cba2ece5a6
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WIWATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60f030ec-4d2a-43f6-ab43-1b5e3ad5523b
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 172e426e-7feb-4dac-b5de-79979318c431
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: FLAREGAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bffe90e0-6fc0-43cf-a395-a3e9d7164881
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.VOLDISPFLAREGAS/1000
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0c9c1b5-2b1a-4745-adcf-de026706f43c
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: VENTGAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 61d4a818-4b9a-4202-bb5d-a0a3bc8f2248
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.VOLDISPVENTGAS/1000
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2309ba63-08e8-410e-8533-088d6f87e03b
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: FUELGAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 42222f1f-b2db-4445-a83e-09824bf693e6
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.VOLDISPFUELGAS/1000
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 13f076fb-be2a-4427-84e8-a6daa1b69668
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: BAT_PRO_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6b904c6-8477-4767-bcad-6f242cb05d0a
          stepCounter: c476c01f-a342-4f8d-b103-d20b70e92f56
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_LIFT_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d9ad3a2d-08e8-4dd6-bf6c-8d17850c46c9
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.VOLINJECTRECOVGAS/1000
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY: b78e68df-21f7-427c-9ce7-426d1d304567
          STAGE_PRODVIEW_WELLS: a3aef473-15c0-437b-be53-6abfe8efbd45
          ODS_PVIEW_PVT_PVUNITDISPMONTHDAY: 1daa6538-d61f-42cb-8ade-361a2b4e661e
          ODS_PVIEW_PVT_PVUNITNODE: 41be665a-471a-4369-9504-43fe682f5f4f
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY
          - locationName: TARGET
            nodeName: STAGE_PRODVIEW_WELLS
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITDISPMONTHDAY
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITNODE
        join:
          joinCondition: |-
            FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY') }} ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY
              JOIN {{ ref('TARGET','STAGE_PRODVIEW_WELLS') }} STAGE_PRODVIEW_WELLS
                ON ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.IDFLOWNET = STAGE_PRODVIEW_WELLS.IDFLOWNET
               AND ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.IDRECUNIT = STAGE_PRODVIEW_WELLS.ENTITY_KEY
              LEFT JOIN (
                    SELECT ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDFLOWNET,
                           ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDRECUNIT,
                           ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.DTTM AS ACTIVITY_DATE,
                           SUM(NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLC1LIQ, 0)) AS METHANE_METRIC,
                           SUM(NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLC2LIQ, 0)) AS ETHANE_METRIC,
                           SUM(NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLC3LIQ, 0)) AS PROPANE_METRIC,
                           SUM(NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLIC4LIQ, 0) + NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLNC4LIQ, 0)) AS BUTANE_METRIC,
                           SUM(NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLIC5LIQ, 0) + NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLNC5LIQ, 0) + NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLC6LIQ, 0) + NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLC7LIQ, 0)) AS PENTANE_METRIC
                      FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITDISPMONTHDAY') }} ODS_PVIEW_PVT_PVUNITDISPMONTHDAY
                      LEFT JOIN {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITNODE') }} ODS_PVIEW_PVT_PVUNITNODE
                        ON ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDRECDISPUNITNODE = ODS_PVIEW_PVT_PVUNITNODE.IDREC
                       AND ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDFLOWNET = ODS_PVIEW_PVT_PVUNITNODE.IDFLOWNET
                       AND ODS_PVIEW_PVT_PVUNITNODE.DSS_CURRENT_FLAG = 'Y'
                       AND ODS_PVIEW_PVT_PVUNITNODE.DSS_DELETE_FLAG != 'Y'
                     WHERE ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.DSS_CURRENT_FLAG = 'Y'
                       AND ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.DSS_DELETE_FLAG != 'Y'
                       AND ODS_PVIEW_PVT_PVUNITNODE.TYPDISPHCLIQ = 'ngl'
                     GROUP BY ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDFLOWNET,
                              ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDRECUNIT,
                              ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.DTTM
                   ) ODS_PVIEW_PVT_PVUNITDISPMONTHDAY
                ON ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.IDRECUNIT = ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDRECUNIT
               AND ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DTTM = ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.ACTIVITY_DATE
               AND ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.IDFLOWNET = ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDFLOWNET
             WHERE ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DSS_CURRENT_FLAG = 'Y'
               AND ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DSS_DELETE_FLAG != 'Y'
        name: STAGE_PRODVIEW_ALLOCATED_VOLUMES
        noLinkRefs: []
  name: STAGE_PRODVIEW_ALLOCATED_VOLUMES
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
