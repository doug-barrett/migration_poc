fileVersion: 1
id: dad6120a-5d64-47f8-9003-4e9c7144cfa8
name: OPC_OMNIA_SCORE_HISTORY_LTM
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: "WHERE DATEADD(month,12,DsOMNIA_Score.MaxReceiptDate) > (SELECT MAXRECEIPTDATE FROM [TABLEOWNER].[OPC_LoadDate])"
  isMultisource: false
  locationName: OMNIA_CONNECT_OPC
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dd3fd965-43cc-44d0-b681-0b5b00eb0ebb
          stepCounter: dad6120a-5d64-47f8-9003-4e9c7144cfa8
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9231c7b4-ff9e-49bd-b574-ce99bb74e77b
                stepCounter: 2ab51ac8-36da-4fef-97dd-8e24de3c688f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 644a205f-9988-493f-b034-84f1663fd781
          stepCounter: dad6120a-5d64-47f8-9003-4e9c7144cfa8
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OMNIA_SCORE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0d1ed26e-08df-473e-8921-fc9813e71622
                stepCounter: 2ab51ac8-36da-4fef-97dd-8e24de3c688f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f1af78ee-eda9-4950-8a6a-6724d8d73f41
          stepCounter: dad6120a-5d64-47f8-9003-4e9c7144cfa8
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: MAXRECEIPTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: df22228a-69b0-408b-8c24-db50ea8f5ad1
                stepCounter: 2ab51ac8-36da-4fef-97dd-8e24de3c688f
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DSOMNIA_SCORE: 2ab51ac8-36da-4fef-97dd-8e24de3c688f
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: ODS
            nodeName: DSOMNIA_SCORE
        join:
          joinCondition: |-
            FROM {{ ref('ODS','DSOMNIA_SCORE') }}
             WHERE DATEADD(MONTH,12,DsOMNIA_Score.MaxReceiptDate) > DATE_TRUNC('MONTH',CURRENT_DATE())
        name: OPC_OMNIA_SCORE_HISTORY_LTM
        noLinkRefs: []
  name: OPC_OMNIA_SCORE_HISTORY_LTM
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
