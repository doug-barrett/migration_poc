fileVersion: 1
id: 802a310c-7ec6-47e4-b87a-b5c1e0c8b60e
name: S_THEATRE_PRODUCTION_PLAN
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 61218ba8-97b8-428a-b1ef-b67c415b3e69
          stepCounter: 802a310c-7ec6-47e4-b87a-b5c1e0c8b60e
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TPP_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 08ad93e7-21fa-4740-90ac-6ee3fb4fe537
                stepCounter: b4e3fdac-99c2-4f0e-b981-42147b5af4c5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2eefacd4-5093-4e41-8ffc-3660686699e0
          stepCounter: 802a310c-7ec6-47e4-b87a-b5c1e0c8b60e
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: HOSPITAL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e99ec5d1-51a8-48dc-9256-65260c696175
                stepCounter: b4e3fdac-99c2-4f0e-b981-42147b5af4c5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8bc50c92-6115-4d06-b682-1727a542f792
          stepCounter: 802a310c-7ec6-47e4-b87a-b5c1e0c8b60e
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_theatre_production_plan.hospital_id=dim_hospital.health_org_reference_no
        name: DIM_HOSPITAL_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c1eff0c-fd0d-4a47-ad0f-2fd4a80c00a7
                stepCounter: ce5e5ba3-482d-46a9-a8ae-9f160067f51d
            transform: IFNULL(dim_hospital_key,1)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98f6e75a-bc07-447d-af98-c15a28572700
          stepCounter: 802a310c-7ec6-47e4-b87a-b5c1e0c8b60e
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SPECIALTY_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 80e9f58c-2493-4600-9e20-2451c0d4a5ff
                stepCounter: b4e3fdac-99c2-4f0e-b981-42147b5af4c5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 396a03de-2e2a-414c-b20b-8e8da0377b80
          stepCounter: 802a310c-7ec6-47e4-b87a-b5c1e0c8b60e
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 792b7d98-2387-4063-a7ee-91197a4993ab
                stepCounter: b4e3fdac-99c2-4f0e-b981-42147b5af4c5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be416cd0-6753-43ef-8309-8cf15db74a41
          stepCounter: 802a310c-7ec6-47e4-b87a-b5c1e0c8b60e
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: ""
        name: DIM_SPECIALTY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79aee918-ff6f-4b0a-a656-000827899f3e
                stepCounter: 4182a75e-d07b-4637-97fa-4c01e2878360
            transform: IFNULL(dim_specialty.dim_specialty_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c00e09b0-9dcf-4002-b655-34d7c05d8c22
          stepCounter: 802a310c-7ec6-47e4-b87a-b5c1e0c8b60e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FISCAL_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8df5d714-7680-40a4-85d9-78c9f7da5323
                stepCounter: b4e3fdac-99c2-4f0e-b981-42147b5af4c5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fdb7aa6a-4249-45e8-8672-980a5ac3ae7d
          stepCounter: 802a310c-7ec6-47e4-b87a-b5c1e0c8b60e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WEEK_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed253baa-3e1c-4e0c-9ccc-65ea8231543b
                stepCounter: b4e3fdac-99c2-4f0e-b981-42147b5af4c5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9833ee0-77bf-4da9-a1fc-e824183adb86
          stepCounter: 802a310c-7ec6-47e4-b87a-b5c1e0c8b60e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: IPM_THEATRE_WEEK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5cfa6089-0c89-43cb-945e-533074b95849
                stepCounter: b4e3fdac-99c2-4f0e-b981-42147b5af4c5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9fcae77-1b51-409a-8897-9f6d4cf26d66
          stepCounter: 802a310c-7ec6-47e4-b87a-b5c1e0c8b60e
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SURGICAL_THEATRE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7dc533a2-9f4d-4bcd-8727-82953a24a7f1
                stepCounter: b4e3fdac-99c2-4f0e-b981-42147b5af4c5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bff556bf-1875-428d-9103-b0be702fa235
          stepCounter: 802a310c-7ec6-47e4-b87a-b5c1e0c8b60e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CAL_WEEK_IN_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 833e18e3-ab10-42aa-88ed-05ccc9fd7a5a
                stepCounter: b4e3fdac-99c2-4f0e-b981-42147b5af4c5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f877e45-0076-4b60-b1be-c5e6ae70e1eb
          stepCounter: 802a310c-7ec6-47e4-b87a-b5c1e0c8b60e
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PLAN_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: adb88a17-8f98-4ebd-b4be-75a88cbb6559
                stepCounter: b4e3fdac-99c2-4f0e-b981-42147b5af4c5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e27c6d9-754a-47c6-a99a-f307a0a36ab8
          stepCounter: 802a310c-7ec6-47e4-b87a-b5c1e0c8b60e
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: PLAN_OUTPUT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d8a6025-9bed-4943-a0a7-b422c4a66d2e
                stepCounter: b4e3fdac-99c2-4f0e-b981-42147b5af4c5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96d2cec0-b77b-4546-b3da-b08d518843d3
          stepCounter: 802a310c-7ec6-47e4-b87a-b5c1e0c8b60e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PLAN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa51689c-bb85-4941-84ca-6ed59b669184
                stepCounter: b4e3fdac-99c2-4f0e-b981-42147b5af4c5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ffa336ef-2f45-4f9c-9cfd-c2e7e4b61fc8
          stepCounter: 802a310c-7ec6-47e4-b87a-b5c1e0c8b60e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_theatre_production_plan.CONVERT(date,l_Datastore_Theatre_Production_Plan.datevalue)=dim_start_date.start_calendar_date
        name: DIM_START_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4e465c3-6432-4578-b9e4-7938382edf1c
                stepCounter: b5d2a386-b1bd-4a43-9c5e-529fea37aabc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 138de6f6-d305-431b-97a1-9d0e914084a6
          stepCounter: 802a310c-7ec6-47e4-b87a-b5c1e0c8b60e
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PLAN_VALUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2b00604e-b07e-4581-9863-58076021e55f
                stepCounter: b4e3fdac-99c2-4f0e-b981-42147b5af4c5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b37d8f2f-fc5d-4aa1-8bd9-956332de9f5d
          stepCounter: 802a310c-7ec6-47e4-b87a-b5c1e0c8b60e
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: SESSION_OWNER_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 10149f71-a470-453e-9699-b5e6a7cde06c
                stepCounter: b4e3fdac-99c2-4f0e-b981-42147b5af4c5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db9cba10-12bf-4940-9049-401b8d5dfe97
          stepCounter: 802a310c-7ec6-47e4-b87a-b5c1e0c8b60e
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SESSION_OWNER_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 381f24b8-6d4b-410f-9a41-c52d5239a2ce
                stepCounter: b4e3fdac-99c2-4f0e-b981-42147b5af4c5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 259d41b7-45e4-4deb-a7a3-f454178b00df
          stepCounter: 802a310c-7ec6-47e4-b87a-b5c1e0c8b60e
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: ADJUSTMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b17a1c28-d316-434c-8eac-4cc468b1fffd
                stepCounter: b4e3fdac-99c2-4f0e-b981-42147b5af4c5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7c82de8-e39e-47a4-84c8-25016b76b210
          stepCounter: 802a310c-7ec6-47e4-b87a-b5c1e0c8b60e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: L_DATASTORE_THEATRE_PRODUCTION_PLAN
        join:
          joinCondition: |-
            FROM l_Datastore_Theatre_Production_Plan
              LEFT OUTER JOIN dim.dim_specialty
                ON dim_specialty.specialty_code = l_Datastore_Theatre_Production_Plan.specialty_localcode
               AND l_Datastore_Theatre_Production_Plan.datevalue BETWEEN dim_specialty.dss_start_date AND dim_specialty.dss_end_date
              LEFT JOIN dim.dim_hospital
                ON dim.dim_hospital.hospital_id = l_Datastore_Theatre_Production_Plan.location
               AND l_Datastore_Theatre_Production_Plan.datevalue BETWEEN dim_hospital.dss_start_date AND dim_hospital.dss_end_date
        name: S_THEATRE_PRODUCTION_PLAN
        noLinkRefs: []
  name: S_THEATRE_PRODUCTION_PLAN
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
