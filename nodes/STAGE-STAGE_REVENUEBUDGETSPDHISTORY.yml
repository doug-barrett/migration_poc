fileVersion: 1
id: e45a9974-42f6-49f4-98fb-e3a445811686
name: STAGE_REVENUEBUDGETSPDHISTORY
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "SEE NOTES"
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fdf7efd8-9d7f-43d3-9c05-011a60e7f647
          stepCounter: e45a9974-42f6-49f4-98fb-e3a445811686
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: SUPPLIERPDHISTORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e421382-eba5-4469-a745-ab666e6d1e3e
                stepCounter: 43a8bf08-0ae0-4693-b9c7-ea44652c761a
            transform: IFNULL(SUPPLIERPDHISTORY.SUPPLIERPDHISTORYKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 120c6315-e0a6-4dfe-a843-d6e4ea7649ee
          stepCounter: e45a9974-42f6-49f4-98fb-e3a445811686
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGECONTRACT_ADDKEYS.SUPPLIERID=SUPPLIER.SUPPLIERID
        name: SUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cc0cef1f-3af8-4dd2-8564-4bec2c8984e2
                stepCounter: 84116e71-ebf6-4262-b818-71628fbd5079
            transform: IFNULL(CONTRACT.SUPPLIERKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f7a428b-f3ab-40d2-8325-78da1bd9a21b
          stepCounter: e45a9974-42f6-49f4-98fb-e3a445811686
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4d27859-6cd1-4793-942b-715cf6d8b934
                stepCounter: 84116e71-ebf6-4262-b818-71628fbd5079
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53789297-6663-4d2d-8bde-4734a1442b6f
          stepCounter: e45a9974-42f6-49f4-98fb-e3a445811686
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SUPPLIERNAMESFDC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 980c1733-9ec5-4b1b-810e-bd31a3cae0b0
                stepCounter: 43a8bf08-0ae0-4693-b9c7-ea44652c761a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0fce0cf4-e83d-4be5-8724-3060f1683f58
          stepCounter: e45a9974-42f6-49f4-98fb-e3a445811686
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE NAME OF A SUPPLIER WHO OWNS A CONTRACT, AS IT EXISTS FROM THE SOURCE SYSTEM. YOU PROBABLY WANT TO USE REPORTINGSUPPLIERNAME INSTEAD.
        name: SUPPLIERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e6f38c5-d235-4b26-83db-2c1cda291ad1
                stepCounter: d1900eab-6bfb-4275-9540-868877d9163b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 820727ce-a08e-489b-8e75-260d41c628bc
          stepCounter: e45a9974-42f6-49f4-98fb-e3a445811686
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE PREFERRED, CLEANED UP NAME OF THE SUPPLIER. THIS IS THE ONE YOU WANT TO USE FOR REPORTS
        name: REPORTINGSUPPLIERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 449504aa-a0f1-42c1-be72-360173e6a0bd
                stepCounter: d1900eab-6bfb-4275-9540-868877d9163b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b5bbea09-d7b6-45ba-bcf1-f83a0f4d08d7
          stepCounter: e45a9974-42f6-49f4-98fb-e3a445811686
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PD_VP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ae4d648-f82a-4e5e-bba6-207cadb537dc
                stepCounter: 43a8bf08-0ae0-4693-b9c7-ea44652c761a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d52f5a3-dfbb-4c71-89af-9e0e33ddd434
          stepCounter: e45a9974-42f6-49f4-98fb-e3a445811686
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PD_DIRECTOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6da26b8-3f53-4477-a87a-e2909cd2b9f8
                stepCounter: 43a8bf08-0ae0-4693-b9c7-ea44652c761a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab24d0ce-463b-43be-8a3c-c3d0cafc63b3
          stepCounter: e45a9974-42f6-49f4-98fb-e3a445811686
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: CONTRACTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2695753d-6f1a-4e8d-9172-3bccc50d7c6a
                stepCounter: 84116e71-ebf6-4262-b818-71628fbd5079
            transform: IFNULL(CONTRACT.CONTRACTKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6a4219d-bc00-445f-9764-127204661099
          stepCounter: e45a9974-42f6-49f4-98fb-e3a445811686
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CONTRACTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 430d2444-c79b-4c99-afce-98f0adfc915e
                stepCounter: 2991ec3a-121c-47b9-97b3-f0edcdf6518a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5d75f84-4ff8-4c54-96e6-4c55e735052b
          stepCounter: e45a9974-42f6-49f4-98fb-e3a445811686
        config: {}
        dataType: INT
        defaultValue: ""
        description: STAGEREVENUEBUDGETSPDHISTORY.BUDGETDATE=DIMBUDGETDATE.BUDGETDATE
        name: BUDGETDATEKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a917df9-58e8-4356-9420-64035f12ade4
                stepCounter: 8a34b157-a453-4238-a82a-c2e8e5b4131c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06501de0-03a7-42ff-ac21-09f977504db8
          stepCounter: e45a9974-42f6-49f4-98fb-e3a445811686
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: BUDGETDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90641112-7835-4722-b613-e06860156699
                stepCounter: 2991ec3a-121c-47b9-97b3-f0edcdf6518a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c75f8f4-7402-42b7-b7f0-9f936132e1f7
          stepCounter: e45a9974-42f6-49f4-98fb-e3a445811686
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BUDGETSALESAMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2df2c411-74c1-43e7-97ce-fc35849307e9
                stepCounter: 2991ec3a-121c-47b9-97b3-f0edcdf6518a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d666bc72-b605-48c3-8b86-bcbe52dd0207
          stepCounter: e45a9974-42f6-49f4-98fb-e3a445811686
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BUDGETREVENUEAMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ec744a6-aeb7-4c45-8bb5-397f246e2d3a
                stepCounter: 2991ec3a-121c-47b9-97b3-f0edcdf6518a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8183a6e-5cdd-49a0-977b-076324a181dd
          stepCounter: e45a9974-42f6-49f4-98fb-e3a445811686
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f5d586a0-7d7e-41ba-9984-c843ebbfa57d
                stepCounter: 2991ec3a-121c-47b9-97b3-f0edcdf6518a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 298f1f0e-00cc-4e20-9f65-358b5d16bcda
          stepCounter: e45a9974-42f6-49f4-98fb-e3a445811686
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2b4e145-bda1-418f-851c-012f9a13d0a2
                stepCounter: 2991ec3a-121c-47b9-97b3-f0edcdf6518a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5dce0af-815f-406c-9e8d-b87670adaaa6
          stepCounter: e45a9974-42f6-49f4-98fb-e3a445811686
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 175395f3-e722-4425-94ba-e17c613b3691
          stepCounter: e45a9974-42f6-49f4-98fb-e3a445811686
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOAD_REVENUEBUDGETSPD: 2991ec3a-121c-47b9-97b3-f0edcdf6518a
          CONTRACT: 84116e71-ebf6-4262-b818-71628fbd5079
          SUPPLIER: d1900eab-6bfb-4275-9540-868877d9163b
          SUPPLIERPDHISTORY: 43a8bf08-0ae0-4693-b9c7-ea44652c761a
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: CONTRACT
          - locationName: DIM
            nodeName: DIM_BUDGETDATE
          - locationName: DIM
            nodeName: SUPPLIER
          - locationName: DIM
            nodeName: SUPPLIERPDHISTORY
          - locationName: LOAD
            nodeName: LOAD_REVENUEBUDGETSPD
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOAD_REVENUEBUDGETSPD') }} LOAD_REVENUEBUDGETSPD
              LEFT JOIN {{ ref('DIM','CONTRACT') }} CONTRACT
                ON LOAD_REVENUEBUDGETSPD.CONTRACTID = CONTRACT.CONTRACTID
              LEFT JOIN {{ ref('DIM','SUPPLIER') }} SUPPLIER
                ON CONTRACT.SUPPLIERKEY = SUPPLIER.SUPPLIERKEY
              LEFT JOIN {{ ref('DIM','SUPPLIERPDHISTORY') }} SUPPLIERPDHISTORY
                ON CONTRACT.SUPPLIERKEY = SUPPLIERPDHISTORY.SUPPLIERKEY
               AND LOAD_REVENUEBUDGETSPD.BUDGETDATE BETWEEN SUPPLIERPDHISTORY.STARTDATE AND SUPPLIERPDHISTORY.ENDDATE
        name: STAGEREVENUEBUDGETSPDHISTORY
        noLinkRefs: []
  name: STAGE_REVENUEBUDGETSPDHISTORY
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
