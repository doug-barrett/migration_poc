fileVersion: 1
id: 4b50d1f0-f3c3-43dd-b595-564f86ef0857
name: STAGE_REVENUEBUDGETSPDHISTORY
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "SEE NOTES"
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40ef18e8-3495-4f69-89fe-53c7d68adafa
          stepCounter: 4b50d1f0-f3c3-43dd-b595-564f86ef0857
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: SUPPLIERPDHISTORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e5e8c3e-3dd9-43e8-a2b0-deff0d2f6789
                stepCounter: 3c8647e1-dbf3-44d7-af9f-af331293e16c
            transform: IFNULL(SUPPLIERPDHISTORY.SUPPLIERPDHISTORYKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 676e6500-47f3-4f66-95bc-eed20a852fe3
          stepCounter: 4b50d1f0-f3c3-43dd-b595-564f86ef0857
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGECONTRACT_ADDKEYS.SUPPLIERID=SUPPLIER.SUPPLIERID
        name: SUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2aa55bd1-f8be-4d08-ade3-2ff2c3000b9a
                stepCounter: a550c43a-4d5a-4a69-aa48-4cefa3de4b21
            transform: IFNULL(CONTRACT.SUPPLIERKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9f7270d-b0a3-42dd-b984-506e3bc32b1b
          stepCounter: 4b50d1f0-f3c3-43dd-b595-564f86ef0857
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 954f9e39-0303-4296-a455-952b26551b60
                stepCounter: a550c43a-4d5a-4a69-aa48-4cefa3de4b21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e2127b8-8aa4-4d28-9183-8eaf28e3af2b
          stepCounter: 4b50d1f0-f3c3-43dd-b595-564f86ef0857
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SUPPLIERNAMESFDC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f772a32-2304-4c7e-adb2-895514f5d08c
                stepCounter: 3c8647e1-dbf3-44d7-af9f-af331293e16c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b3033da-a856-4c73-88b8-439a1dc7257d
          stepCounter: 4b50d1f0-f3c3-43dd-b595-564f86ef0857
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE NAME OF A SUPPLIER WHO OWNS A CONTRACT, AS IT EXISTS FROM THE SOURCE SYSTEM. YOU PROBABLY WANT TO USE REPORTINGSUPPLIERNAME INSTEAD.
        name: SUPPLIERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5320743a-1acf-448a-829f-b6d77d9fa171
                stepCounter: 470235be-2b1f-4c18-8481-f03bb4bed667
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec2f4132-506d-4c31-ad6e-8b20c9cc3558
          stepCounter: 4b50d1f0-f3c3-43dd-b595-564f86ef0857
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE PREFERRED, CLEANED UP NAME OF THE SUPPLIER. THIS IS THE ONE YOU WANT TO USE FOR REPORTS
        name: REPORTINGSUPPLIERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d540aa96-a25c-45d3-b97c-86a23d48d564
                stepCounter: 470235be-2b1f-4c18-8481-f03bb4bed667
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4fb54461-a92e-49c0-be8c-7bbb59438187
          stepCounter: 4b50d1f0-f3c3-43dd-b595-564f86ef0857
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PD_VP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 890abe76-231d-4a5f-8983-c617ae27bb36
                stepCounter: 3c8647e1-dbf3-44d7-af9f-af331293e16c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f398114e-5d34-4043-a650-9bfa5b761d26
          stepCounter: 4b50d1f0-f3c3-43dd-b595-564f86ef0857
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PD_DIRECTOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: faf528d2-b912-4404-b3a9-b2efc4601814
                stepCounter: 3c8647e1-dbf3-44d7-af9f-af331293e16c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 307f70f6-08de-4787-963e-5bd9728cb8e9
          stepCounter: 4b50d1f0-f3c3-43dd-b595-564f86ef0857
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: CONTRACTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dd104e19-ca47-41af-94d4-cca1548f548e
                stepCounter: a550c43a-4d5a-4a69-aa48-4cefa3de4b21
            transform: IFNULL(CONTRACT.CONTRACTKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 90205a87-479c-4bf5-85e6-c6de56586f81
          stepCounter: 4b50d1f0-f3c3-43dd-b595-564f86ef0857
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CONTRACTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea7d752d-526d-4ea6-8a22-8b235f747dab
                stepCounter: da67d458-8859-4d79-a253-6acd954cf1e2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2a2d0f2-9db8-4abe-987f-eabd48b7dc11
          stepCounter: 4b50d1f0-f3c3-43dd-b595-564f86ef0857
        config: {}
        dataType: INT
        defaultValue: ""
        description: STAGEREVENUEBUDGETSPDHISTORY.BUDGETDATE=DIMBUDGETDATE.BUDGETDATE
        name: BUDGETDATEKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c44e398-1413-4060-9f9e-0716da9c3ba0
                stepCounter: bbadb7c4-d0be-4b54-9433-eddd7cf4a5be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dcd575fb-3aa9-4d41-b782-eb2364d82b70
          stepCounter: 4b50d1f0-f3c3-43dd-b595-564f86ef0857
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: BUDGETDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd0888df-8c2a-4540-a99a-e7fc605900e2
                stepCounter: da67d458-8859-4d79-a253-6acd954cf1e2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 755123d8-63a2-46a9-88af-9e4fb59b7246
          stepCounter: 4b50d1f0-f3c3-43dd-b595-564f86ef0857
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BUDGETSALESAMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76f5f8cc-ae67-4c08-81ec-d6a6a3d868c1
                stepCounter: da67d458-8859-4d79-a253-6acd954cf1e2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6304d9d-f154-4600-ab90-8a16c7587f26
          stepCounter: 4b50d1f0-f3c3-43dd-b595-564f86ef0857
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BUDGETREVENUEAMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0868feb8-fe7b-4b46-bdb1-9464e0483580
                stepCounter: da67d458-8859-4d79-a253-6acd954cf1e2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1cd89777-5f63-4823-b950-0a435017d0d6
          stepCounter: 4b50d1f0-f3c3-43dd-b595-564f86ef0857
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce5cae7a-1e9d-4c48-ae4a-6a02f9590e52
                stepCounter: da67d458-8859-4d79-a253-6acd954cf1e2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f6bca49-ff3f-407d-a648-6a9cd734f4a0
          stepCounter: 4b50d1f0-f3c3-43dd-b595-564f86ef0857
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2738c4ea-2a33-42fb-adcc-24ed8e514878
                stepCounter: da67d458-8859-4d79-a253-6acd954cf1e2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8534767-e58e-4fb5-bd46-29aa0fec181c
          stepCounter: 4b50d1f0-f3c3-43dd-b595-564f86ef0857
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e60cd35-3afc-4b67-bb20-385e03fe32da
          stepCounter: 4b50d1f0-f3c3-43dd-b595-564f86ef0857
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          CONTRACT: a550c43a-4d5a-4a69-aa48-4cefa3de4b21
          SUPPLIER: 470235be-2b1f-4c18-8481-f03bb4bed667
          SUPPLIERPDHISTORY: 3c8647e1-dbf3-44d7-af9f-af331293e16c
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: CONTRACT
          - locationName: DIM
            nodeName: DIM_BUDGETDATE
          - locationName: DIM
            nodeName: SUPPLIER
          - locationName: DIM
            nodeName: SUPPLIERPDHISTORY
          - locationName: LOAD
            nodeName: LOAD_REVENUEBUDGETSPD
          - locationName: UNKNOWN
            nodeName: LOADREVENUEBUDGETSPD
        join:
          joinCondition: |-
            FROM {{ ref('UNKNOWN','LOADREVENUEBUDGETSPD') }} LOADREVENUEBUDGETSPD
              LEFT JOIN {{ ref('DIM','CONTRACT') }} CONTRACT
                ON LOADREVENUEBUDGETSPD.CONTRACTID = CONTRACT.CONTRACTID
              LEFT JOIN {{ ref('DIM','SUPPLIER') }} SUPPLIER
                ON CONTRACT.SUPPLIERKEY = SUPPLIER.SUPPLIERKEY
              LEFT JOIN {{ ref('DIM','SUPPLIERPDHISTORY') }} SUPPLIERPDHISTORY
                ON CONTRACT.SUPPLIERKEY = SUPPLIERPDHISTORY.SUPPLIERKEY
               AND LOADREVENUEBUDGETSPD.BUDGETDATE BETWEEN SUPPLIERPDHISTORY.STARTDATE AND SUPPLIERPDHISTORY.ENDDATE
        name: STAGEREVENUEBUDGETSPDHISTORY
        noLinkRefs: []
  name: STAGE_REVENUEBUDGETSPDHISTORY
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
