fileVersion: 1
id: f2613330-516f-4432-bc15-a9f67367ae0c
name: S_IN_PATIENT_SEEN_BY_PREV_NEXT_V
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b568ea7f-b74f-43c0-94ff-e88af4d9505d
          stepCounter: f2613330-516f-4432-bc15-a9f67367ae0c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cc4555de-c69a-4e9f-b86c-af8d7dc1379b
                stepCounter: 96a66481-190e-4450-96f4-1892a89ee272
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e964098-549e-4a30-9f2b-4e8cb781f9e2
          stepCounter: f2613330-516f-4432-bc15-a9f67367ae0c
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 408dde5e-24cd-434d-b12f-e8b6be51730e
                stepCounter: 96a66481-190e-4450-96f4-1892a89ee272
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ae1d530-100b-4cb5-8cf8-a2ea1548bcc8
          stepCounter: f2613330-516f-4432-bc15-a9f67367ae0c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_SEEN_BY_SEQ_NUM
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f0bb946-7924-426d-b7f0-efdb36b15a50
                stepCounter: 96a66481-190e-4450-96f4-1892a89ee272
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 107b7bbd-d28f-4c47-b33a-463ad75c50b7
          stepCounter: f2613330-516f-4432-bc15-a9f67367ae0c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 074d16d6-f5fc-431a-b7ad-63f4936c3da4
          stepCounter: f2613330-516f-4432-bc15-a9f67367ae0c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: baae6fdc-695a-4e01-882f-00e3a0fe30da
          stepCounter: f2613330-516f-4432-bc15-a9f67367ae0c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SEEN_BY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc2adf98-0062-4778-b140-a8fa6a61dfac
                stepCounter: 96a66481-190e-4450-96f4-1892a89ee272
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b43cfeae-a610-4193-886e-189fb65de9f1
          stepCounter: f2613330-516f-4432-bc15-a9f67367ae0c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SEEN_BY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 97990cc7-e300-4e2b-8e49-245d79bf00bb
                stepCounter: 96a66481-190e-4450-96f4-1892a89ee272
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 211691f6-0024-4523-944c-0d9cc3b6cc06
          stepCounter: f2613330-516f-4432-bc15-a9f67367ae0c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: HEALTHCARE_PROFESSIONAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d21ba57a-9305-44e2-a789-b8d2f79c3ed6
          stepCounter: f2613330-516f-4432-bc15-a9f67367ae0c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SERVICE_POINT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 784d86cd-869b-4b77-aac2-7c09bfba5c44
          stepCounter: f2613330-516f-4432-bc15-a9f67367ae0c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c946a30-2f18-4b83-976e-36fe268b5a05
          stepCounter: f2613330-516f-4432-bc15-a9f67367ae0c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREVIOUS_SEEN_BY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 968f5eb3-9f05-419f-8709-7b7156063d27
          stepCounter: f2613330-516f-4432-bc15-a9f67367ae0c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PREVIOUS_SEEN_BY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b9cdca91-f3f7-47e8-83d2-4eeffa4a2182
          stepCounter: f2613330-516f-4432-bc15-a9f67367ae0c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PREVIOUS_SEEN_BY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd4ff2af-9dc8-46ca-b12d-64c67a001a7e
          stepCounter: f2613330-516f-4432-bc15-a9f67367ae0c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREVIOUS_HEALTHCARE_PROFESSIONAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0636fef8-bc4a-45ce-8ce9-fd32f182c6b6
          stepCounter: f2613330-516f-4432-bc15-a9f67367ae0c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREVIOUS_SERVICE_POINT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18944230-4930-4bac-a94f-57db19509709
          stepCounter: f2613330-516f-4432-bc15-a9f67367ae0c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREVIOUS_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c39f447-2e05-4757-a8e1-78360ca6a768
          stepCounter: f2613330-516f-4432-bc15-a9f67367ae0c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NEXT_SEEN_BY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd5fd495-07dd-4bad-b70a-9fab8a80eeef
          stepCounter: f2613330-516f-4432-bc15-a9f67367ae0c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NEXT_SEEN_BY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fbac5001-e8b5-4138-8676-6625d9aa5746
          stepCounter: f2613330-516f-4432-bc15-a9f67367ae0c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NEXT_SEEN_BY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d0c49cd2-9e07-459b-97c8-3c59a746e184
          stepCounter: f2613330-516f-4432-bc15-a9f67367ae0c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NEXT_HEALTHCARE_PROFESSIONAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 373ec2e4-2206-497b-9011-24bc8eea93cb
          stepCounter: f2613330-516f-4432-bc15-a9f67367ae0c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NEXT_SERVICE_POINT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4da39285-6992-4f44-b7f6-9864b7143af2
          stepCounter: f2613330-516f-4432-bc15-a9f67367ae0c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NEXT_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e847a9f-c61b-4b79-8377-5bf8fbf67c32
          stepCounter: f2613330-516f-4432-bc15-a9f67367ae0c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FIRST_SEEN_BY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 595915fe-eb6d-4e9b-87d5-8133e829e69d
          stepCounter: f2613330-516f-4432-bc15-a9f67367ae0c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_SEEN_BY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be52038a-47a7-4c3c-b5b6-0d793286db98
          stepCounter: f2613330-516f-4432-bc15-a9f67367ae0c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_SEEN_BY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a50196b4-0329-45da-baee-dedfa4ecaa7f
          stepCounter: f2613330-516f-4432-bc15-a9f67367ae0c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FIRST_HEALTHCARE_PROFESSIONAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 468d00b1-d4ac-4208-818f-61340a76fdc1
          stepCounter: f2613330-516f-4432-bc15-a9f67367ae0c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FIRST_SERVICE_POINT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca85637c-7f4e-44b3-8476-6696efcc5dbb
          stepCounter: f2613330-516f-4432-bc15-a9f67367ae0c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FIRST_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 248d2c52-eb6d-4324-8baf-24a41a72b68f
          stepCounter: f2613330-516f-4432-bc15-a9f67367ae0c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LAST_SEEN_BY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38836a92-c42c-4b22-9f21-2e0f5397efd6
          stepCounter: f2613330-516f-4432-bc15-a9f67367ae0c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_SEEN_BY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 614ec75b-a16c-4ae4-aac2-93e4627c29fc
          stepCounter: f2613330-516f-4432-bc15-a9f67367ae0c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_SEEN_BY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2415131-355a-4b7f-9ad2-58b426b5757c
          stepCounter: f2613330-516f-4432-bc15-a9f67367ae0c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LAST_HEALTHCARE_PROFESSIONAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f69e4af-bee6-46c7-bab1-ddc6d96454fb
          stepCounter: f2613330-516f-4432-bc15-a9f67367ae0c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LAST_SERVICE_POINT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e807fc6-8410-40d4-a77c-59805c511d0d
          stepCounter: f2613330-516f-4432-bc15-a9f67367ae0c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LAST_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            SELECT cur.event_refno,
                   cur.event_encounter_id event_encounter_id,
                   cur.event_seen_by_seq_num event_seen_by_seq_num,
                   cur.event_patnt_refno patient_reference_no,
                   cur.seen_by_refno seen_by_reference_no,
                   cur.seen_by_start_date seen_by_start_date,
                   cur.seen_by_end_date seen_by_end_date,
                   cur.seen_by_proca_refno healthcare_professional_reference_no,
                   cur.seen_by_spont_refno service_point_reference_no,
                   cur.seen_by_spect_refno specialty_reference_no,
                   prv.seen_by_refno previous_seen_by_reference_no,
                   prv.seen_by_start_date previous_seen_by_start_date,
                   prv.seen_by_end_date previous_seen_by_end_date,
                   prv.seen_by_proca_refno previous_healthcare_professional_reference_no,
                   prv.seen_by_spont_refno previous_service_point_reference_no,
                   prv.seen_by_spect_refno previous_specialty_reference_no,
                   nxt.seen_by_refno next_seen_by_reference_no,
                   nxt.seen_by_start_date next_seen_by_start_date,
                   nxt.seen_by_end_date next_seen_by_end_date,
                   nxt.seen_by_proca_refno next_healthcare_professional_reference_no,
                   nxt.seen_by_spont_refno next_service_point_reference_no,
                   nxt.seen_by_spect_refno next_specialty_reference_no,
                   first.seen_by_refno first_seen_by_reference_no,
                   first.seen_by_start_date first_seen_by_start_date,
                   first.seen_by_end_date first_seen_by_end_date,
                   first.seen_by_proca_refno first_healthcare_professional_reference_no,
                   first.seen_by_spont_refno first_service_point_reference_no,
                   first.seen_by_spect_refno first_specialty_reference_no,
                   last.seen_by_refno last_seen_by_reference_no,
                   last.seen_by_start_date last_seen_by_start_date,
                   last.seen_by_end_date last_seen_by_end_date,
                   last.seen_by_proca_refno last_healthcare_professional_reference_no,
                   last.seen_by_spont_refno last_service_point_reference_no,
                   last.seen_by_spect_refno last_specialty_reference_no
              FROM s_in_patient_seen_by_05 cur
              LEFT OUTER JOIN s_in_patient_seen_by_05 prv
                ON (prv.event_encounter_id = cur.event_encounter_id AND prv.event_seen_by_seq_num = cur.event_seen_by_seq_num - 1)
              LEFT OUTER JOIN s_in_patient_seen_by_05 nxt
                ON (nxt.event_encounter_id = cur.event_encounter_id AND nxt.event_seen_by_seq_num = cur.event_seen_by_seq_num + 1)
              LEFT OUTER JOIN s_in_patient_seen_by_05 FIRST
                ON (first.event_encounter_id = cur.event_encounter_id AND first.event_seen_by_seq_num = 1)
              LEFT OUTER JOIN s_in_patient_seen_by_05 LAST
                ON (last.event_encounter_id = cur.event_encounter_id AND last.event_seen_by_seq_num = last.event_seen_by_count);
        dependencies:
          - locationName: TGT
            nodeName: S_IN_PATIENT_SEEN_BY_05
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TGT','S_IN_PATIENT_SEEN_BY_05') }}
        name: S_IN_PATIENT_SEEN_BY_PREV_NEXT_V
        noLinkRefs: []
  name: S_IN_PATIENT_SEEN_BY_PREV_NEXT_V
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
