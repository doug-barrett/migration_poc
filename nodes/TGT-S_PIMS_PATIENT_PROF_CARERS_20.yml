fileVersion: 1
id: 63b7671c-c695-4bf4-8e18-738a57a9767b
name: S_PIMS_PATIENT_PROF_CARERS_20
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f3d92c06-adca-4e11-a5d5-4abf7975df18
          stepCounter: 63b7671c-c695-4bf4-8e18-738a57a9767b
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: PATNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bb464fb9-cb2f-46bd-8d77-c537af0e3c42
                stepCounter: 657b685c-07a2-47a9-baab-b110ee2c4594
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 730cc7df-6941-4535-85c1-ef889f96fa18
          stepCounter: 63b7671c-c695-4bf4-8e18-738a57a9767b
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f5ce5ba0-be78-43ef-8ebe-b6370e05d5d7
                stepCounter: 657b685c-07a2-47a9-baab-b110ee2c4594
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75dcb965-8884-4cee-88ab-d494dea4af90
          stepCounter: 63b7671c-c695-4bf4-8e18-738a57a9767b
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: HEORG_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ba6a4e25-daf8-48d5-9083-d788bd5c7803
                stepCounter: 657b685c-07a2-47a9-baab-b110ee2c4594
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2bd13255-5429-42b1-ae58-0ab73f32e2bf
          stepCounter: 63b7671c-c695-4bf4-8e18-738a57a9767b
        config: {}
        dataType: DATETIME2
        defaultValue: ""
        description: ""
        name: START_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0864a192-6b2c-4b13-8ff3-11f1a278b4ce
                stepCounter: 657b685c-07a2-47a9-baab-b110ee2c4594
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6c639e0-64b2-424c-afe4-8d4c1e78d7b0
          stepCounter: 63b7671c-c695-4bf4-8e18-738a57a9767b
        config: {}
        dataType: DATETIME2
        defaultValue: ""
        description: ""
        name: END_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e71c056f-e29d-4d71-8469-cf44e14fffd5
                stepCounter: 657b685c-07a2-47a9-baab-b110ee2c4594
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a86bff5e-90b8-4936-86ab-649affb52a73
          stepCounter: 63b7671c-c695-4bf4-8e18-738a57a9767b
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: PRTYP_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e68dcfe-b1c1-4a26-9fc8-89b282ac512e
                stepCounter: 657b685c-07a2-47a9-baab-b110ee2c4594
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd767623-9b32-471a-8c04-09cfde36ccbb
          stepCounter: 63b7671c-c695-4bf4-8e18-738a57a9767b
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: PROF_CARER_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b4c1c6f-a37e-4554-9eec-485cb3dd2cbb
                stepCounter: 657b685c-07a2-47a9-baab-b110ee2c4594
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 163f79cd-279f-491c-8ec7-c4d2d68ae5b5
          stepCounter: 63b7671c-c695-4bf4-8e18-738a57a9767b
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: HEORG_REFNO2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 63fcc9cf-1828-4d90-a1c3-3b7197968d33
                stepCounter: 649b6eb6-539d-42fd-9bfb-93555246341c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66fac526-ba9f-4cac-ac84-6b78b27e5eed
          stepCounter: 63b7671c-c695-4bf4-8e18-738a57a9767b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: HEORG_START_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 705ed3a7-e878-4632-ad71-a9fb297ffbcd
                stepCounter: 649b6eb6-539d-42fd-9bfb-93555246341c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab2dbc80-9f82-488f-a62c-c29fc04ceb1e
          stepCounter: 63b7671c-c695-4bf4-8e18-738a57a9767b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: HEORG_END_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9761e7e2-1590-4442-9014-89568879ac1a
                stepCounter: 649b6eb6-539d-42fd-9bfb-93555246341c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a0c529a-b6d3-47b3-87f4-d54b2a9e5851
          stepCounter: 63b7671c-c695-4bf4-8e18-738a57a9767b
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef81ada1-6c63-4c28-97ef-a555ebe6bd97
                stepCounter: 2bfd0d27-2ec4-44b6-8cb3-4535246b36d7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8f5f856-f0ba-4f42-9377-757fdece3fbc
          stepCounter: 63b7671c-c695-4bf4-8e18-738a57a9767b
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: LINE1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77ac4d23-904e-4722-8c85-b8601b2032b1
                stepCounter: eab2966a-ecca-4216-8448-50bff4ac8448
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1841a108-0025-430a-8f80-a6a3b73a53c8
          stepCounter: 63b7671c-c695-4bf4-8e18-738a57a9767b
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: LINE2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4faff0b2-80fd-4262-a296-a7a2c33d8921
                stepCounter: eab2966a-ecca-4216-8448-50bff4ac8448
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e1fec17-82f3-4683-84ae-d5e7771f881a
          stepCounter: 63b7671c-c695-4bf4-8e18-738a57a9767b
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: LINE3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8437e06b-b820-4ca2-85e8-99c6df35732b
                stepCounter: eab2966a-ecca-4216-8448-50bff4ac8448
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 442e0646-cbfe-449a-87e0-fe4d7d9b7385
          stepCounter: 63b7671c-c695-4bf4-8e18-738a57a9767b
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: LINE4
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4d7d795d-569e-43e2-bf0d-e240b2a31faf
                stepCounter: eab2966a-ecca-4216-8448-50bff4ac8448
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f428f453-77c5-4289-8f64-2312f2b35afd
          stepCounter: 63b7671c-c695-4bf4-8e18-738a57a9767b
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PHONE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9865e955-7ff1-4f1f-a324-9524b1bfe3d4
                stepCounter: 46e38d59-f2b3-442a-b66d-77cc64a7186e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3453bb75-096c-48d6-9f35-0235c71f8a08
          stepCounter: 63b7671c-c695-4bf4-8e18-738a57a9767b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_PIMS_PATIENT_PROF_CARERS_10
        join:
          joinCondition: |-
            FROM s_pims_patient_prof_carers_10
              LEFT JOIN [dbo].[l_pims_prof_carer_health_orgs]
                ON s_pims_patient_prof_carers_10.PROCA_REFNO = l_pims_prof_carer_health_orgs.proca_refno
               AND s_pims_patient_prof_carers_10.HEORG_REFNO = l_pims_prof_carer_health_orgs.heorg_refno
               AND s_pims_patient_prof_carers_10.START_DTTM BETWEEN l_pims_prof_carer_health_orgs.start_dttm AND IFNULL(l_pims_prof_carer_health_orgs.end_dttm,getdate())
               AND [l_pims_prof_carer_health_orgs].archv_flag = 'N'
              LEFT JOIN [dbo].[l_pims_health_organisations]
                ON l_pims_prof_carer_health_orgs.heorg_refno = l_pims_health_organisations.heorg_refno
               AND [l_pims_health_organisations].archv_flag = 'N'
              LEFT JOIN [dbo].[s_pims_heorg_address_Postal_v]
                ON l_pims_health_organisations.heorg_refno = s_pims_heorg_address_Postal_v.heorg_refno
               AND [s_pims_heorg_address_Postal_v].end_dttm IS NULL
              LEFT JOIN [dbo].[s_pims_heorg_address_Phone]
                ON l_pims_health_organisations.heorg_refno = s_pims_heorg_address_Phone.heorg_refno
               AND [s_pims_heorg_address_Phone].end_dttm IS NULL
             WHERE 1 = 1
        name: S_PIMS_PATIENT_PROF_CARERS_20
        noLinkRefs: []
  name: S_PIMS_PATIENT_PROF_CARERS_20
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
