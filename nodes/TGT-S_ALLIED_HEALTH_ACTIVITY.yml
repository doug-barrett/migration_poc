fileVersion: 1
id: 9c06ca24-7562-490a-86bf-fbe1b7dd192a
name: S_ALLIED_HEALTH_ACTIVITY
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Dimension key look up. Source table for fact_allied_health_activity."
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6c3869e-f8c8-448d-90d4-5d37859ad33a
          stepCounter: 9c06ca24-7562-490a-86bf-fbe1b7dd192a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Unique key that identifies an Activity row.
        name: FACT_ALLIED_HEALTH_ACTIVITY_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: efca56f3-38f7-408b-8425-eae7bec79f1e
                stepCounter: db4588de-fb3d-4698-b5c4-abb8fc2424cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f16a06e-7ddc-481c-9bd0-420c20b52a7c
          stepCounter: 9c06ca24-7562-490a-86bf-fbe1b7dd192a
        config: {}
        dataType: VARCHAR(9)
        defaultValue: ""
        description: Id that uniquely identifies the encounter in Allied Health.
        name: ALLIED_HEALTH_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3dbe5e49-8121-4b62-94cb-702e4715183b
                stepCounter: db4588de-fb3d-4698-b5c4-abb8fc2424cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bff18fde-d151-461c-a38c-2e5cf6d9b1af
          stepCounter: 9c06ca24-7562-490a-86bf-fbe1b7dd192a
        config: {}
        dataType: VARCHAR(12)
        defaultValue: ""
        description: Unique business identifier for inpatient event.
        name: EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 25164fb2-d7bc-4750-a9c3-e26d72d03cd0
                stepCounter: db4588de-fb3d-4698-b5c4-abb8fc2424cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c39ab68-e6b4-4e49-a973-81e7502dbe22
          stepCounter: 9c06ca24-7562-490a-86bf-fbe1b7dd192a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient NHI number.
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d0912cd-0134-4428-b53d-c9e70189906d
                stepCounter: db4588de-fb3d-4698-b5c4-abb8fc2424cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b06b01c-f0ea-437c-bdfd-594d5e184a2e
          stepCounter: 9c06ca24-7562-490a-86bf-fbe1b7dd192a
        config: {}
        dataType: DATE
        defaultValue: ""
        description: Date when the Allied Health shift occurred.
        name: SHIFT_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5b28888a-fc52-4b48-be5e-5f12421c568b
                stepCounter: db4588de-fb3d-4698-b5c4-abb8fc2424cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad5220ab-500a-43f0-a944-a74518cc1fb1
          stepCounter: 9c06ca24-7562-490a-86bf-fbe1b7dd192a
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Alphanumeric value that uniquely identifies a discipline e.g. DTN (Dietitian)
        name: DISCIPLINE_CODE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a812bc1d-873f-4f92-bdf4-2e0c123c6a76
                stepCounter: db4588de-fb3d-4698-b5c4-abb8fc2424cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d0a5ef3-10b3-48b6-b90f-d611af62fd78
          stepCounter: 9c06ca24-7562-490a-86bf-fbe1b7dd192a
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Numbers rows for each encounter ordered by shift date, discipline code and activity desc.
        name: ENCOUNTER_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60fa33f5-9c7e-4e50-9500-cbc7c925c04d
                stepCounter: db4588de-fb3d-4698-b5c4-abb8fc2424cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af16f912-aaca-4fe7-8ffc-990fa5da2c40
          stepCounter: 9c06ca24-7562-490a-86bf-fbe1b7dd192a
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Numbers rows for each encounter in descending shift date, discipline code, activity desc order.
        name: ENCOUNTER_SEQ_NUM_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 633e9b06-a832-465b-b9f4-37d6b4901d8e
                stepCounter: db4588de-fb3d-4698-b5c4-abb8fc2424cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af34f291-9eea-49a1-856d-6d9c9388cc98
          stepCounter: 9c06ca24-7562-490a-86bf-fbe1b7dd192a
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Numbers rows for each encounter and discipline ordered by shift date and activity desc.
        name: DISCIPLINE_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d23782fa-56f4-4941-9156-879b262accc4
                stepCounter: db4588de-fb3d-4698-b5c4-abb8fc2424cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9bc6d3e7-2f20-40a0-8372-6929a735439d
          stepCounter: 9c06ca24-7562-490a-86bf-fbe1b7dd192a
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Numbers rows for each encounter and discipline in descending shift date and activity desc order.
        name: DISCIPLINE_SEQ_NUM_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0fcffbbe-9435-4728-91c7-2365e0d594b5
                stepCounter: db4588de-fb3d-4698-b5c4-abb8fc2424cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05e5e2b0-f18f-4154-9437-7fc45787cccc
          stepCounter: 9c06ca24-7562-490a-86bf-fbe1b7dd192a
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Alphanumeric code that uniquely identifies a user in Allied Health.
        name: USER_CODE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 995c6174-28bd-4121-9e15-0dae93e18598
                stepCounter: db4588de-fb3d-4698-b5c4-abb8fc2424cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd4197d7-7c8d-48dc-b09e-485a46acfb2f
          stepCounter: 9c06ca24-7562-490a-86bf-fbe1b7dd192a
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Alphanumeric code that, together with activity_revision, uniquely identifies an activity in Allied Health.
        name: ACTIVITY_CODE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48325998-db70-4486-99d1-c0e04dc06df8
                stepCounter: db4588de-fb3d-4698-b5c4-abb8fc2424cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6e9e1a6-d845-4d00-b6dd-1c0c60bbb511
          stepCounter: 9c06ca24-7562-490a-86bf-fbe1b7dd192a
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Alphanumeric code that uniquely identifies an activity rating.
        name: ACTIVITY_RATING_CODE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8051b901-6aad-4177-b30b-f11778c35820
                stepCounter: db4588de-fb3d-4698-b5c4-abb8fc2424cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa1502db-7128-471e-a8ff-2723bf57ee8a
          stepCounter: 9c06ca24-7562-490a-86bf-fbe1b7dd192a
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Set to 1 for most activities. May be set to a higher number to uniquely identify an activity
        name: ACTIVITY_NUMBER
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f60e2061-ffd4-4cce-9e6c-13a106483991
                stepCounter: db4588de-fb3d-4698-b5c4-abb8fc2424cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06f2a868-ae71-4968-b036-0010d3bc3203
          stepCounter: 9c06ca24-7562-490a-86bf-fbe1b7dd192a
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Value extracted from the activity description when that field contains the word 'Priority'. Range currently used is 1-4.
        name: ACTIVITY_PRIORITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5196395e-2023-4fea-b0f2-1458516109f4
                stepCounter: 1b4d59d7-adff-4a49-8071-1f23e741fc5d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5ce0b0b-6a76-461c-b565-21dcc96ff7c5
          stepCounter: 9c06ca24-7562-490a-86bf-fbe1b7dd192a
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Together with activity_code uniquely identifies an activity in a similar vein to changing dims.
        name: ACTIVITY_REVISION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4c8819e-99a3-49bd-9c0e-f077dbd702b3
                stepCounter: db4588de-fb3d-4698-b5c4-abb8fc2424cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 23d25d2b-b9e0-491b-ac4b-208e30bea9fc
          stepCounter: 9c06ca24-7562-490a-86bf-fbe1b7dd192a
        config: {}
        dataType: NUMERIC(9,5)
        defaultValue: ""
        description: Actual activity time on the shift in hours e.g. 1.25 = 75 minutes.
        name: ACTUAL_ACTIVITY_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a44bd44-ad88-4031-bb49-f9e1dedbe57d
                stepCounter: db4588de-fb3d-4698-b5c4-abb8fc2424cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5376ac1-ad5a-4e17-b5a4-08efb048c653
          stepCounter: 9c06ca24-7562-490a-86bf-fbe1b7dd192a
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Actual activity time on the shift converted to minutes.
        name: ACTUAL_ACTIVITY_MINS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e482c817-fdcf-481d-88ee-19a56a85f08b
                stepCounter: db4588de-fb3d-4698-b5c4-abb8fc2424cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 63337796-00b9-41bf-b42e-653895762721
          stepCounter: 9c06ca24-7562-490a-86bf-fbe1b7dd192a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Set to 1 if the activity is flagged as completed in Allied Health.
        name: ACTIVITY_COMPLETED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 20e160fe-069e-42c7-b114-e85aae36c9cf
                stepCounter: db4588de-fb3d-4698-b5c4-abb8fc2424cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b8e9566-4397-43fe-a315-7076c0469505
          stepCounter: 9c06ca24-7562-490a-86bf-fbe1b7dd192a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Set to 1 if the activity description contains the word 'declined'.
        name: ACTIVITY_DECLINED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1a1224d-5b00-4208-a469-59bb178b65b2
                stepCounter: db4588de-fb3d-4698-b5c4-abb8fc2424cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f81d6073-a03c-4324-8c45-1f8dcb799aec
          stepCounter: 9c06ca24-7562-490a-86bf-fbe1b7dd192a
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Alphanumeric code that uniquely identifies an activity's status.
        name: ACTIVITY_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a082a729-f91f-4113-a2ee-d0aab28e9c72
                stepCounter: db4588de-fb3d-4698-b5c4-abb8fc2424cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 192f93c2-df8f-4d3d-ac3a-74fd7d727699
          stepCounter: 9c06ca24-7562-490a-86bf-fbe1b7dd192a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: PiMS ward code.
        name: DISCHARGE_WARD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dca6b9fa-62df-446b-8c9c-b680fe885c6b
                stepCounter: db4588de-fb3d-4698-b5c4-abb8fc2424cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1f4d32e-dde9-4790-ba24-84c231e43459
          stepCounter: 9c06ca24-7562-490a-86bf-fbe1b7dd192a
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Numbers rows for each encounter and discipline ordered by shift date and activity desc.
        name: ACTIVITY_WITH_VISITNO_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72728e30-d001-4832-b930-425ad1da9992
                stepCounter: db4588de-fb3d-4698-b5c4-abb8fc2424cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d38c1f48-8c1d-4009-aadb-50c3c55bf3a6
          stepCounter: 9c06ca24-7562-490a-86bf-fbe1b7dd192a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Service_Point_Reference_Number
        name: WARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eb2953d1-7af3-417c-b495-96f74f2d5547
                stepCounter: db4588de-fb3d-4698-b5c4-abb8fc2424cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21ad5165-f254-4ea2-80a3-0e659d9b733b
          stepCounter: 9c06ca24-7562-490a-86bf-fbe1b7dd192a
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: VISIT_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c28ebef-af58-4ea9-999f-e502ff9d33f9
                stepCounter: db4588de-fb3d-4698-b5c4-abb8fc2424cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ebc95bd-ab83-4913-92b0-0d415c25cb2a
          stepCounter: 9c06ca24-7562-490a-86bf-fbe1b7dd192a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: 'Internal unique identifier for a patient from the Patient Management System '
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 648fe5ef-a604-4013-93a5-baeb44bc1285
                stepCounter: db4588de-fb3d-4698-b5c4-abb8fc2424cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f349e5b7-4345-4395-9731-14e93cd75109
          stepCounter: 9c06ca24-7562-490a-86bf-fbe1b7dd192a
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: General counter always set to 1.
        name: ACTIVITY_COUNT
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: '1'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7edafb8d-e5f2-4afa-96a2-ef0e19b06034
          stepCounter: 9c06ca24-7562-490a-86bf-fbe1b7dd192a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_allied_health_activity.activity_code=dim_allied_health_activity.activity_code  s_allied_health_activity.activity_revision=dim_allied_health_activity.activity_revision  s_allied_health_activity.activity_rating_code=dim_allied_health_activity.activity_rating_code
        name: DIM_ALLIED_HEALTH_ACTIVITY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a79ffcf-1156-430b-a309-98e8e98d9036
                stepCounter: 3a25dbcb-ff16-48d8-9de1-a1d3696d30ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c88e818-dd58-48d7-8221-c70242d99c0a
          stepCounter: 9c06ca24-7562-490a-86bf-fbe1b7dd192a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_allied_health_activity.discipline_code=dim_allied_health_discipline.discipline_code
        name: DIM_ALLIED_HEALTH_DISCIPLINE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 665743fa-cad2-4d4a-90d4-2dd1f1119713
                stepCounter: 3326b8b2-6f82-45a8-922e-8a92158ade59
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d64fa566-5821-4ba2-b329-9629e11c5002
          stepCounter: 9c06ca24-7562-490a-86bf-fbe1b7dd192a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_allied_health_activity.activity_priority=dim_allied_health_priority.activity_priority
        name: DIM_ALLIED_HEALTH_PRIORITY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 85a361b8-101f-4bcf-8d89-f60d3d105926
                stepCounter: 11c821d8-72a5-4034-a389-82f58623290b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4db07588-8b88-4101-98b4-b45019170b71
          stepCounter: 9c06ca24-7562-490a-86bf-fbe1b7dd192a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_allied_health_activity.activity_status_code=dim_allied_health_status.activity_status_code
        name: DIM_ALLIED_HEALTH_STATUS_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 81b8ec8e-6dde-4494-a1c7-445994f3a920
                stepCounter: 3db89361-e7e8-4585-ad0b-9b4add0a81c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75c76537-76e2-4e58-90b4-45cfff437b8e
          stepCounter: 9c06ca24-7562-490a-86bf-fbe1b7dd192a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_allied_health_activity.user_code=dim_allied_health_user.user_code
        name: DIM_ALLIED_HEALTH_USER_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e2a41f6-1f93-4b55-9bbf-9b0fa68c98d2
                stepCounter: c1c4225e-84e6-4424-84e6-a6fc9337746a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3703f8a-57c8-4c7a-9e29-e797895b9ba7
          stepCounter: 9c06ca24-7562-490a-86bf-fbe1b7dd192a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_allied_health_activity.patient_reference_no=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9962a01b-5f3d-4c1a-b371-997edef38d0f
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9f4353f-0ec7-4b24-a4bf-a908a5281c37
          stepCounter: 9c06ca24-7562-490a-86bf-fbe1b7dd192a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_allied_health_activity.shift_date=dim_shift_date.shift_date
        name: DIM_SHIFT_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb31e2af-1aa3-4fca-9c4c-bf46baf49ccc
                stepCounter: 0de1de98-baa4-467a-bd1f-b588439ad5c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aaf6ba41-7aaa-4cd3-91dd-02cfcff6a369
          stepCounter: 9c06ca24-7562-490a-86bf-fbe1b7dd192a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_allied_health_activity.ward_reference_no=dim_discharge_ward.discharge_ward_reference_no
        name: DIM_DISCHARGE_WARD_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a25735e-86ed-4c2f-a186-3de54d64cd3b
                stepCounter: eb6e873e-8280-46c0-88b0-99a491465182
            transform: IFNULL(dim_discharge_ward.dim_discharge_ward_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9a1a1dc-d2ad-461b-89e7-678f4e9ff44c
          stepCounter: 9c06ca24-7562-490a-86bf-fbe1b7dd192a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_allied_health_activity.ward_reference_no=dim_ward.ward_code
        name: DIM_WARD_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6aa5e7b8-4dc5-4b87-a4c2-5013db0e1dfc
                stepCounter: 50c31151-9204-4154-9caf-5d28244bde1a
            transform: IFNULL(dim_ward.dim_ward_key, 0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 35901710-93df-4ab5-a33d-4f1f3c354298
          stepCounter: 9c06ca24-7562-490a-86bf-fbe1b7dd192a
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_ALLIED_HEALTH_ACTIVITY_10
        join:
          joinCondition: |-
            FROM s_allied_health_activity_10
              LEFT OUTER JOIN s_allied_health_activity_20
                ON s_allied_health_activity_20.allied_health_id = s_allied_health_activity_10.allied_health_id
               AND s_allied_health_activity_20.shift_date = s_allied_health_activity_10.shift_date
               AND s_allied_health_activity_20.discipline_code = s_allied_health_activity_10.discipline_code
               AND s_allied_health_activity_20.user_code = s_allied_health_activity_10.user_code
               AND s_allied_health_activity_20.row_num = 1 -- Prevents joins to multiple rows    LEFT OUTER JOIN dim.dim_ward  ON  dim_ward.ward_reference_no = s_allied_health_activity_10.ward_reference_no  AND dim_ward.dss_current_flag  = 'Y'  LEFT OUTER JOIN (select dim_allied_health_user.user_code,dim_allied_health_user_key,    row_number() over (partition by user_code order by dss_update_time desc)rn   from dim.[dim_allied_health_user]) dim_allied_health_user     ON s_allied_health_activity_10.user_code = dim_allied_health_user.user_code  and rn=1    WHERE s_allied_health_activity_10.activity_priority IS NULL  --AND activity_seq_num = 1--15.04.2024   and activity_with_visitno_seq_num = 1
        name: S_ALLIED_HEALTH_ACTIVITY
        noLinkRefs: []
  name: S_ALLIED_HEALTH_ACTIVITY
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
