fileVersion: 1
id: 3645c977-fab7-44ac-9630-9d92b91845f8
name: S_IN_PATIENT_CLINICAL_CODING_05_OLD
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57d8fe7c-b173-413d-854f-3a24f930f133
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRVSP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59d3088d-97f2-4c53-9ebc-ae021c7b49e2
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 28892de2-b524-4215-b61a-fcfa6a6c5144
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: VARCHAR(16)
        defaultValue: ""
        description: ""
        name: ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 379b5279-002f-46d6-a2b5-0a41fb41ec24
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ed45d3c-5ddd-448c-87e0-eef6722ea20d
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: VARCHAR(16)
        defaultValue: ""
        description: ""
        name: ORIGINAL_ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d2dceba-6f6f-4591-8ef1-969b12713f7b
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8fb205ad-e846-45c2-a851-bff7f5fe0cee
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_CODING_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ebc723dc-706a-42dd-b32c-62e278d1ca07
                stepCounter: 0fd69960-e880-45e3-89e4-e0a0d5a6afad
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94c01398-94f9-4eaa-8f23-0bb38ae87a6b
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_CODING_NEW_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 73832b7f-74d8-49f5-8535-30a123bf2fbc
                stepCounter: 0fd69960-e880-45e3-89e4-e0a0d5a6afad
            transform: row_number() over(PARTITION BY ds_plato_coding_details.pimsencounter,codetype ORDER BY sequencenumber)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d647c558-ee25-4db5-b005-e38e7710d4c2
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_CODING_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59d3088d-97f2-4c53-9ebc-ae021c7b49e2
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: COUNT(1) OVER (PARTITION BY ds_pims_provider_spells.prvsp_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d31eee4e-abfa-41bc-9f34-1ddcab6f475b
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_CODING_RANK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59d3088d-97f2-4c53-9ebc-ae021c7b49e2
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ROW_NUMBER() OVER (PARTITION BY ds_pims_provider_spells.prvsp_refno ORDER BY ds_plato_coding_details.sequencenumber, ds_plato_coding_details.codetype)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b9183a95-3dd4-4ffb-bc92-dfec61370a5a
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: CONDITION_ONSET_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea289ac0-8f9f-44c9-956b-41d38eec7e63
                stepCounter: 0fd69960-e880-45e3-89e4-e0a0d5a6afad
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a6768e9-8444-44df-9496-80e5ca9676c0
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b126124e-f57a-4ada-a1f7-b38b61b70a02
                stepCounter: 0fd69960-e880-45e3-89e4-e0a0d5a6afad
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96f75f68-6901-4ba0-b11c-2d2df03d3212
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: ""
        name: HEALTH_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2e3c022e-e6ed-4c76-9c21-9f3014a9bc40
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0147d5d4-ec02-4d15-a199-01ed664a2f17
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d76ddaab-4850-4d65-b6f4-4174efabc36d
                stepCounter: 0fd69960-e880-45e3-89e4-e0a0d5a6afad
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9981348-fe15-4842-89d5-e96929db0d49
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: VARCHAR(200)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b212a94c-1ad3-498b-9f33-916ee4673918
                stepCounter: 0fd69960-e880-45e3-89e4-e0a0d5a6afad
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c55dfd9-582b-4cd8-892c-d61df3be2532
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a674762-e24f-40dd-9a67-ce4ffe570fbe
                stepCounter: 0fd69960-e880-45e3-89e4-e0a0d5a6afad
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27eeab9f-73c6-4d13-90bc-82b3a5e85927
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: DRG_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a888a138-9840-4736-912c-e9bbecc170b1
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d6a6571-d3ed-4bdb-9cc7-530031c90b4a
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: MDC_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bbfff9b7-6cdd-477d-aa95-451e49e98293
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79461a27-2fa3-447a-b5ea-7e7e425c16fd
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: VARCHAR(7)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 93bba8bb-b885-4e4a-8e6b-47099a0b58f2
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a54c786-ba93-401b-b021-b3308c5f6550
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DATE_OF_BIRTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7724627c-e5d3-4a96-9818-1840a26ca165
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1635feb-3b89-458d-b5cf-3d903d7ea867
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: HOSPITAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3995ed0-b4c2-4f6c-8da7-8dee8a0adaee
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba6c5b11-6a5c-4549-8d9f-2a88fc674f60
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11ba3682-5d1a-4a53-bfaf-b4b646e6c99f
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb542a97-a43b-4be1-8934-cee0c7ef257b
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a06254d-d86c-4cf5-ab17-b37af0d69b0a
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 215b57fa-51db-4498-bf49-8713d451275a
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72c532b7-79a7-49aa-8bc0-c737daef331d
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f02e3fe-a017-4a73-bf80-007e879fa203
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f7b850f-ce72-4e87-b4f3-6e2838f4dd0a
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02c68e97-0e3f-4807-bb85-91d06678389c
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: EVENT_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dbd0c0df-350d-40ec-9506-fb0f852f6485
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e0746bf-2ab1-47d3-9a45-4b8b3de27db3
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: EVENT_END_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1680bbcb-e60e-472b-b849-4ccba897be60
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 370039a5-a509-43c5-83c6-00434f7b9484
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: ADMISSION_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 360166f9-e4f3-4f78-9781-e99f72567955
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e63cd5a5-7073-4972-baeb-83ebaf88f98d
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: ADMISSION_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7faa02eb-9704-41e3-8d68-c7aa1796e5cc
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f52f0ccd-0194-4bbc-892f-d14016384781
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1125cf7f-7027-45ac-acc8-b3a92505c4da
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: |-
              CASE WHEN ds_pims_provider_spells.admit_dttm IS NULL OR ds_pims_provider_spells.admit_dttm <= '1990-01-01' OR ds_pims_provider_spells.admit_dttm > GETDATE() THEN ds_pims_provider_spells.disch_dttm
                          ELSE ds_pims_provider_spells.admit_dttm
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31481e80-b03d-45eb-bbc2-cc67ed072a23
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMIT_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1125cf7f-7027-45ac-acc8-b3a92505c4da
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0667ea94-e205-42b5-af1d-0f03a126d5df
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MOH_ADMISSION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1fe7ef84-1dca-487e-affa-fe3c1e92e15a
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f3078af2-a39f-4951-bd7e-12c9bb1758ac
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCH_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee3a67e8-1a53-44ab-aa64-cafc588de09c
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: |-
              CASE WHEN ds_pims_provider_spells.disch_dttm IS NULL OR ds_pims_provider_spells.disch_dttm <= '1990-01-01' OR ds_pims_provider_spells.disch_dttm > GETDATE() THEN ds_pims_provider_spells.admit_dttm
                          ELSE ds_pims_provider_spells.disch_dttm
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9491b081-d306-4edb-b23d-89fe99c10219
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCH_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee3a67e8-1a53-44ab-aa64-cafc588de09c
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: edaec909-6f9f-4c31-a673-672c487aa9ad
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MOH_DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f6e8c6a-b20c-4b30-9522-15c66332156b
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2fcc1bae-e00c-43b6-b882-a4b70b78d9b0
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d251445f-9071-45c8-9852-33801fbc8496
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54f45839-d4f5-4408-8385-349bca3afbb0
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: EXCLUDED_PURCHASE_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 153c73dc-f731-43e8-9540-7e2a583b3d4d
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c479e7e2-a116-478b-a7a2-c9ee468b652d
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: VARCHAR(12)
        defaultValue: ""
        description: ""
        name: ACC_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a37c63bf-18da-4412-9ee6-1eb2b05e9263
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff18a0a6-8439-4e0c-8c94-cc0fc1238493
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: NZ_RESIDENCY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c6e37f29-fec0-47a8-99a2-5ffc3295a70e
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c9435d8-ebb5-4393-b931-3d269deac672
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: DOMICILE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 747ff924-490d-42ec-b788-8ebab0bcc174
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6cadbd29-76ca-49f8-a6bd-3f9565a93ef1
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: WIES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b45e174c-eb7a-42b6-99e1-0f5aab799629
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2043e5e9-053b-4cf1-890e-34a658106040
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: VENTILATOR_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8088abce-bf8f-41de-a734-1c7b754d1931
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5683bbe3-9cf9-45f6-88a6-2f80c2972f2c
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CODING_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de6a7f94-2e9f-4ef2-97eb-88a7041af0da
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8464e72b-bb6b-46a6-af56-19d308f0c41a
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 825a0fbe-d2ca-442e-8e51-3d2c9ff9b8da
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50176db0-a78f-477c-9bc8-f33e7485e394
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: USER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fcb6f041-322d-4070-a547-ceb7ac76a16c
                stepCounter: 0fd69960-e880-45e3-89e4-e0a0d5a6afad
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d31993a1-527c-410a-9b6a-c0546462f8de
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 160a9eb4-9ea2-4c5e-8907-5c5d2cb567bc
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ceb276bc-5228-4ec8-8d3d-9d7f51eac1dd
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: RECORD_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: faa838f8-d258-4b73-917a-d9c0bd6550bf
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32fe2edd-3122-48d7-a867-38a2f311c9e8
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DSS_DATA_QUALITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'NONE'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: edaa99a0-9bc8-498a-87e0-fbbfa730e14a
          stepCounter: 3645c977-fab7-44ac-9630-9d92b91845f8
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_PIMS_PROVIDER_SPELLS
        join:
          joinCondition: |-
            FROM ds_plato_coding_details
              JOIN ds_plato_event_details
                ON ds_plato_event_details.pimsencounter = ds_plato_coding_details.pimsencounter
              JOIN ds_pims_provider_spells
                ON ds_pims_provider_spells.prvsp_refno = CASE WHEN ISNUMERIC(SUBSTRING(ds_plato_coding_details.pimsencounter,LEN(ds_plato_coding_details.pimsencounter)-9,10)) = 1 THEN CONVERT(decimal(10,0),SUBSTRING(ds_plato_coding_details.pimsencounter,LEN(ds_plato_coding_details.pimsencounter)-9,10))
                        ELSE NULL
                         END
             WHERE IFNULL(ds_pims_provider_spells.inmgt_refno,0) <> 1410021940 -- exclude OP intended management
        name: S_IN_PATIENT_CLINICAL_CODING_05_OLD
        noLinkRefs: []
  name: S_IN_PATIENT_CLINICAL_CODING_05_OLD
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
