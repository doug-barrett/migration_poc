fileVersion: 1
id: 71c36059-4753-4e93-a1f6-c043ab63dd08
name: S_CONTACT_NASC_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca1c336b-4614-48b4-9e8a-2983cd82744c
          stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: CONTACT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cfee6812-da7d-4aea-a386-10bfc40f8436
                stepCounter: d4a22a0b-786e-4106-aa07-f295fc7ed871
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96e0a090-540a-45fe-8e64-44edbf81f265
          stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: CONTACT_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'NA'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4dd79007-0423-414d-8fba-a8c65d9b3f1c
          stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: TASK_REQUEST_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f0db8913-ab57-4e35-a72c-40b372863f20
                stepCounter: d4a22a0b-786e-4106-aa07-f295fc7ed871
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca16ff5b-ef38-4c83-b0ca-d210d74284ea
          stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f65e0d45-4599-4ed2-8eec-ae39fb8fdc69
                stepCounter: d4a22a0b-786e-4106-aa07-f295fc7ed871
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed12a7d2-ec0c-41bc-88e9-6a4a66589ee8
          stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: patient_programme id
        name: PROGRAMME_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8fa45120-ad09-4982-ae7d-28a8865b9df4
                stepCounter: d4a22a0b-786e-4106-aa07-f295fc7ed871
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: deaca730-b073-455c-bebd-717afac763b9
          stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: patient_programme_status
        name: PROGRAMME_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e3c082be-995a-4142-8040-0d8579b99674
                stepCounter: d4a22a0b-786e-4106-aa07-f295fc7ed871
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7efa1cc-f2e7-4b40-9ac3-33187a1390ea
          stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: TASK_TYPE_DESC
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3afe3921-a022-4b03-9691-5cc3644f57b4
                stepCounter: d4a22a0b-786e-4106-aa07-f295fc7ed871
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f4ee1f6c-6917-4164-a367-caa0a25a6480
          stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: HEALTH_ORG_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2c80c85-c6c4-48a5-8446-83325e3a7c27
                stepCounter: d4a22a0b-786e-4106-aa07-f295fc7ed871
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39fd3f62-5bf4-428e-ae56-1956e96ac61f
          stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a226e4e-4bcf-4dff-b127-671a6c3e4546
                stepCounter: d4a22a0b-786e-4106-aa07-f295fc7ed871
            transform: |-
              CASE WHEN ISNUMERIC(s_contact_NASC_v.seen_by_clinician_id) = 1 AND LEN(s_contact_NASC_v.seen_by_clinician_id) <= 10 THEN s_contact_NASC_v.seen_by_clinician_id
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 44d1b2fc-58bc-4a23-ae57-dee6e751c3e9
          stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SEEN_BY_CLINICIAN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a226e4e-4bcf-4dff-b127-671a6c3e4546
                stepCounter: d4a22a0b-786e-4106-aa07-f295fc7ed871
            transform: |-
              CASE WHEN ISNUMERIC(s_contact_NASC_v.seen_by_clinician_id) = 0 THEN s_contact_NASC_v.seen_by_clinician_id
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a0243254-9d01-4ecd-82b9-519976714e24
          stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2934a24-4ffa-439d-b1f3-8dd8b6667626
                stepCounter: d4a22a0b-786e-4106-aa07-f295fc7ed871
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1edcecd2-30cc-4702-87f7-69cd615ef958
          stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: HOSPITAL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d77d841d-c5a8-428e-88fd-3449f65703c2
                stepCounter: d4a22a0b-786e-4106-aa07-f295fc7ed871
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 147ff71d-7ed4-4e9f-9a15-fde056a21039
          stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PROVIDER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 46c120e4-e947-401d-a044-5ab4e1c04434
                stepCounter: d4a22a0b-786e-4106-aa07-f295fc7ed871
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb5b8d1e-bb3b-45cc-b8f2-1b67a3d466ca
          stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PROVIDER_ROLE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 63081a2e-e215-4456-8efe-8e927e15822f
                stepCounter: d4a22a0b-786e-4106-aa07-f295fc7ed871
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e5d9a49-4548-49e8-bad7-5e76aa7b4c60
          stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PROGRAMME_ROLE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2172284c-b110-4d54-a8c4-e1a92d7dc5d9
                stepCounter: d4a22a0b-786e-4106-aa07-f295fc7ed871
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c27d0af4-98b6-4979-a5e7-c21ab2a2a8db
          stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: DEPARTMENT_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 838c75fc-c707-4a99-bdf8-247313f1b01f
                stepCounter: d4a22a0b-786e-4106-aa07-f295fc7ed871
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c61fde5-61fe-43a1-9dbc-93fbbe47943b
          stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SERVICE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d63ab329-ade7-4cd5-8aa9-caf5a903fe66
                stepCounter: d4a22a0b-786e-4106-aa07-f295fc7ed871
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ceb111a0-5458-4d15-ba97-01db61c690e1
          stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: TASK_REQUEST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5bc6ca3-f93b-4315-b490-d88cb1767760
                stepCounter: d4a22a0b-786e-4106-aa07-f295fc7ed871
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 62193a03-1293-46f1-a579-1bd61a1b6f57
          stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: EPISODE_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: deea5b51-907d-4cb4-94cf-1a9975a05eab
                stepCounter: d4a22a0b-786e-4106-aa07-f295fc7ed871
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6efbd9bd-ee3a-4ef8-a2dc-32270049ff57
          stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: OBSERVATION_REPORT_DUE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ad4b56bb-1176-47e2-a1c3-11e9a4e9bf01
                stepCounter: d4a22a0b-786e-4106-aa07-f295fc7ed871
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 46bc6e92-af6c-471e-ad86-3a7087096164
          stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: OBSERVATION_REPORT_COMPLETION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 632f612b-f150-4801-87ac-a5c1357a9f3d
                stepCounter: d4a22a0b-786e-4106-aa07-f295fc7ed871
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bc97620f-a2c0-45b0-8b9e-1e2e11ebabb1
          stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: OBSERVATION_REPORT_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7951fb9-e196-459d-a23a-217662154627
                stepCounter: d4a22a0b-786e-4106-aa07-f295fc7ed871
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8cc7b927-174a-49df-a299-828adf17dcb7
          stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_CONTACT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5bc6ca3-f93b-4315-b490-d88cb1767760
                stepCounter: d4a22a0b-786e-4106-aa07-f295fc7ed871
            transform: ROW_NUMBER() OVER (PARTITION BY s_contact_NASC_v.patient_NHI ORDER BY s_contact_NASC_v.task_request_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b507160a-e6a7-4f81-853f-5b8d7d3d135b
          stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_CONTACT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f65e0d45-4599-4ed2-8eec-ae39fb8fdc69
                stepCounter: d4a22a0b-786e-4106-aa07-f295fc7ed871
            transform: COUNT(1) OVER (PARTITION BY s_contact_NASC_v.patient_NHI)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 280a46e4-6875-4b9d-9c43-0b6167cf58e9
          stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_CONTACT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5bc6ca3-f93b-4315-b490-d88cb1767760
                stepCounter: d4a22a0b-786e-4106-aa07-f295fc7ed871
            transform: ROW_NUMBER() OVER (PARTITION BY s_contact_NASC_v.referral_encounter_id ORDER BY s_contact_NASC_v.task_request_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5e017a5-8eed-49a1-a76e-fad5068d1cbb
          stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_CONTACT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f65e0d45-4599-4ed2-8eec-ae39fb8fdc69
                stepCounter: d4a22a0b-786e-4106-aa07-f295fc7ed871
            transform: COUNT(1) OVER (PARTITION BY s_contact_NASC_v.referral_encounter_id)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80fa566e-9aaa-4b1c-8cdb-83bd67f48e06
          stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 770045cc-594f-4173-b421-40279256c697
                stepCounter: d4a22a0b-786e-4106-aa07-f295fc7ed871
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a3050a6-1152-4674-95d7-c8e415dafe49
          stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 42c2e00c-b39e-42f0-b623-96fdb8a587ef
                stepCounter: d4a22a0b-786e-4106-aa07-f295fc7ed871
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bbda39c8-8f43-4938-b96c-c24b3cec1aaa
          stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PUCMAP_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47b2a132-634d-4728-a864-6cdb618e6e97
                stepCounter: d4a22a0b-786e-4106-aa07-f295fc7ed871
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee713d32-5c27-4ecc-80e2-14461f3cbd3e
          stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce4903fd-df31-4ffa-bb14-8bb38394d2f3
                stepCounter: d4a22a0b-786e-4106-aa07-f295fc7ed871
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e722663-977c-4574-b0ae-130d9c6494dd
          stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: RESPONSIBILITY_CENTRE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c95d3075-4a44-434e-8bf7-4c5fb70936d2
                stepCounter: d4a22a0b-786e-4106-aa07-f295fc7ed871
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15c5c3c5-bd22-4afa-8f31-2c37a89556c1
          stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DEFAULT_PURCHASE_UNIT_VOLUME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa56b29e-1d00-4112-ac90-54d1ed75f5be
                stepCounter: d4a22a0b-786e-4106-aa07-f295fc7ed871
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16be9bc9-2d75-4be6-8e3f-b8c8e502f410
          stepCounter: 71c36059-4753-4e93-a1f6-c043ab63dd08
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_CONTACT_NASC_V
        join:
          joinCondition: FROM s_contact_NASC_v
        name: S_CONTACT_NASC_10
        noLinkRefs: []
  name: S_CONTACT_NASC_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
