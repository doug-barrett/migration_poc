fileVersion: 1
id: 0c1359cb-afc4-4583-a133-60e98ab7e39e
name: VIEW_CSLAND_CONTRACT_DOI_DETAIL
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 128cdee0-60fd-4231-8938-8f277715f047
          stepCounter: 0c1359cb-afc4-4583-a133-60e98ab7e39e
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: CONTRACT_FILE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 585c07e4-ed6f-418f-99fd-78da0bf5f926
                stepCounter: cfa98a45-88c3-4476-81e7-459489f66767
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0812b059-89c7-4695-8b83-e5cba72f2633
          stepCounter: 0c1359cb-afc4-4583-a133-60e98ab7e39e
        config: {}
        dataType: DECIMAL(7)
        defaultValue: ""
        description: ""
        name: DOI_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84ad3ac6-6986-4681-8c33-4a9b339d8cae
                stepCounter: 4c591dae-8cae-4462-b16e-495c5989ebb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d02c6566-0bdd-4c97-9c93-24887f432da8
          stepCounter: 0c1359cb-afc4-4583-a133-60e98ab7e39e
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DOI_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60964802-6912-4016-81d2-f68db88ca9e5
                stepCounter: 2666f026-1171-4402-99af-47c5ee6092ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11dd00b1-5b4d-4464-b3b7-ff3d8e22ac5d
          stepCounter: 0c1359cb-afc4-4583-a133-60e98ab7e39e
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: DOI_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21679f94-12c3-464c-90ef-4897b957cf97
                stepCounter: d2bd2d6f-5926-4bb8-9642-b5aaafb48852
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05311af8-9a5f-4324-a355-a652262fcf89
          stepCounter: 0c1359cb-afc4-4583-a133-60e98ab7e39e
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: DOI_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: efe834e0-3e15-48b3-83f5-fe18e69b0a28
                stepCounter: 2666f026-1171-4402-99af-47c5ee6092ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0dc32a82-a854-4965-96fb-2bc397b27eb8
          stepCounter: 0c1359cb-afc4-4583-a133-60e98ab7e39e
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CHANGED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 92a8b1ce-37ff-4860-892e-53a905e5faf4
                stepCounter: 2666f026-1171-4402-99af-47c5ee6092ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1cc1cdfa-c82b-4d01-9f39-aa542743c77f
          stepCounter: 0c1359cb-afc4-4583-a133-60e98ab7e39e
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: ACCOUNT_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c90932ab-182d-43ee-b8d4-a0da56ab3f47
                stepCounter: 2666f026-1171-4402-99af-47c5ee6092ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b994e043-20a7-45b3-af83-de18f7ad68fe
          stepCounter: 0c1359cb-afc4-4583-a133-60e98ab7e39e
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: EFFECTIVE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8660bb6e-e159-45b6-8fc0-cd6924ef6efe
                stepCounter: 2666f026-1171-4402-99af-47c5ee6092ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 30a6792b-e5d1-448f-a66c-a7beae36dafe
          stepCounter: 0c1359cb-afc4-4583-a133-60e98ab7e39e
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: EXPIRY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de877534-23cf-4838-b856-3b01941db1fe
                stepCounter: 2666f026-1171-4402-99af-47c5ee6092ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f40bae63-a270-44ff-b814-f4344f6e45f6
          stepCounter: 0c1359cb-afc4-4583-a133-60e98ab7e39e
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: OWNER_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5c38b63-f893-42fc-8def-b57710c6de20
                stepCounter: 2666f026-1171-4402-99af-47c5ee6092ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32639d38-1ba5-4855-9c0c-193a3539f56d
          stepCounter: 0c1359cb-afc4-4583-a133-60e98ab7e39e
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: OWNER_IN_PENALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3970f27c-9b05-4aeb-a7a6-f07bcbb37a33
                stepCounter: 4c591dae-8cae-4462-b16e-495c5989ebb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18d04a4d-9f5f-47aa-af07-28ee66c44234
          stepCounter: 0c1359cb-afc4-4583-a133-60e98ab7e39e
        config: {}
        dataType: VARCHAR(60)
        defaultValue: ""
        description: ""
        name: COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d9756c30-edae-44bc-a581-49cc8f3a6003
                stepCounter: 2666f026-1171-4402-99af-47c5ee6092ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0bdc8f94-4501-46a3-9ae3-d4becfd8b6fb
          stepCounter: 0c1359cb-afc4-4583-a133-60e98ab7e39e
        config: {}
        dataType: DECIMAL(6)
        defaultValue: ""
        description: ""
        name: PARTNER_OCCURRENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c40a795c-fd97-4c63-b7da-b198386529cc
                stepCounter: 4c591dae-8cae-4462-b16e-495c5989ebb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a02ce673-f0e9-48b3-af35-719c93adeaf0
          stepCounter: 0c1359cb-afc4-4583-a133-60e98ab7e39e
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PARTNER_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05f2ec9a-e62a-42cc-aa20-5ba476d5cd21
                stepCounter: 4c591dae-8cae-4462-b16e-495c5989ebb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29c11863-1979-4fe5-87ac-be3c7d59f840
          stepCounter: 0c1359cb-afc4-4583-a133-60e98ab7e39e
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: PARTNER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7cdfc49f-aa22-4a4a-ad06-6a087f45b67d
                stepCounter: 195380c1-f588-4c27-9c13-2d48662dc985
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22adbf90-760d-4a80-a660-837065cdc988
          stepCounter: 0c1359cb-afc4-4583-a133-60e98ab7e39e
        config: {}
        dataType: DECIMAL(11,8)
        defaultValue: ""
        description: ""
        name: PARTNER_PERCENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f0286f0e-21c4-426a-8cee-a0d0b6882ac4
                stepCounter: 4c591dae-8cae-4462-b16e-495c5989ebb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e55e5378-ea39-4bc9-98a8-b7393395c2a6
          stepCounter: 0c1359cb-afc4-4583-a133-60e98ab7e39e
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: OWNING_PARTNER_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00b031bb-27e5-42ed-ae99-c37a1446a25e
                stepCounter: 001fcc0c-faa3-492e-990b-29437efcbbc0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f1784d80-0cd0-46c5-b407-ef1efcc2742c
          stepCounter: 0c1359cb-afc4-4583-a133-60e98ab7e39e
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: SILENT_PARTNER_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c8576b2-31e8-4733-b87d-15c8d262a64e
                stepCounter: 4c591dae-8cae-4462-b16e-495c5989ebb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1976bf5-2cdd-47a2-be69-ced530c73043
          stepCounter: 0c1359cb-afc4-4583-a133-60e98ab7e39e
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PARTNER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2b7896c-d3ee-452b-97f0-fc91c72bba7a
                stepCounter: 4c591dae-8cae-4462-b16e-495c5989ebb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 52873916-f5d6-4789-867a-df0a8ace43e2
          stepCounter: 0c1359cb-afc4-4583-a133-60e98ab7e39e
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: PARTNER_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c6fc463-d6b2-47af-a01c-0bccfc785465
                stepCounter: 61f17e1f-2d1c-4948-960a-7d2c86b563a2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4d5a52c-99f3-49b7-9e30-0c31f0933674
          stepCounter: 0c1359cb-afc4-4583-a133-60e98ab7e39e
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: PENALTY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3970f27c-9b05-4aeb-a7a6-f07bcbb37a33
                stepCounter: 4c591dae-8cae-4462-b16e-495c5989ebb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 12279b5e-dfaa-4830-9d31-dbbb93414702
          stepCounter: 0c1359cb-afc4-4583-a133-60e98ab7e39e
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: SILENT_OWNER_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ccb9643-cdba-4b1c-877e-8d169c9a68ef
                stepCounter: 4c591dae-8cae-4462-b16e-495c5989ebb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4183251-643f-4a90-9d30-cfd894c154a3
          stepCounter: 0c1359cb-afc4-4583-a133-60e98ab7e39e
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: SILENT_OWNER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7cdfc49f-aa22-4a4a-ad06-6a087f45b67d
                stepCounter: 195380c1-f588-4c27-9c13-2d48662dc985
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 46a96240-a803-4782-a832-a700f3ada69f
          stepCounter: 0c1359cb-afc4-4583-a133-60e98ab7e39e
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: TIK_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64766cc5-2fc8-4771-97dd-d60a5c2da1cf
                stepCounter: 4c591dae-8cae-4462-b16e-495c5989ebb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe1cb46a-26e5-4473-9168-e7a9014ec041
          stepCounter: 0c1359cb-afc4-4583-a133-60e98ab7e39e
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: GST_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7fdbb24a-a903-46b5-80e1-2e3ab52546c2
                stepCounter: 4c591dae-8cae-4462-b16e-495c5989ebb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6ce6759-44a7-41b8-8d4e-1ca06d552af7
          stepCounter: 0c1359cb-afc4-4583-a133-60e98ab7e39e
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: SUSPENDED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dbc0ef55-1f69-4df7-9e70-c9b9388699df
                stepCounter: 4c591dae-8cae-4462-b16e-495c5989ebb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f03d8007-9f62-410b-a04d-e4e03e54eede
          stepCounter: 0c1359cb-afc4-4583-a133-60e98ab7e39e
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PARTNER_SUMMARY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05f2ec9a-e62a-42cc-aa20-5ba476d5cd21
                stepCounter: 4c591dae-8cae-4462-b16e-495c5989ebb0
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_CSLAND_CONTRACT_DOI_DETAIL: 0c1359cb-afc4-4583-a133-60e98ab7e39e
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_CSLAND_CONTRACT_DOI_DETAIL') }} AS SELECT TRIM(DX.FILE_NUMBER)||TRIM(DX.FILE_SUB) "CONTRACT_FILE_KEY",
                   DD.DOI_ID,
                   DX.DOI_TYPE "DOI_TYPE_CODE",
                   TD.DESCRIPTION "DOI_TYPE",
                   DX.DOI_STATUS,
                   DX.CHANGED_DATE,
                   DX.ACCOUNT_GROUP,
                   DX.EFFECTIVE_DATE,
                   DX.EXPIRY_DATE,
                   DX.OWNER "OWNER_FLAG",
                   DECODE(MAX(DECODE(DECODE(TOW.OWNER,NULL,'N','Y')||NVL(DD.PENALTY,'N'),'YY',1,0)) OVER (PARTITION BY DD.DOI_ID, DD.PARTNER),1,'Y','N') "OWNER_IN_PENALTY",
                   DX.COMMENTS,
                   DD.OCCURRENCE "PARTNER_OCCURRENCE",
                   DD.PARTNER "PARTNER_CODE",
                   BA1.NAME "PARTNER",
                   DD.PARTNER_PERCENT,
                   DECODE(TOW.OWNER,NULL,'N','Y') "OWNING_PARTNER_FLAG",
                   DD.SILENT_PARTNER "SILENT_PARTNER_FLAG",
                   DD.PARTNER_TYPE "PARTNER_TYPE_CODE",
                   TP.DESCRIPTION "PARTNER_TYPE",
                   DD.PENALTY "PENALTY_FLAG",
                   DD.SILENT_OWNER "SILENT_OWNER_CODE",
                   BA2.NAME "SILENT_OWNER",
                   DD.TIK "TIK_FLAG",
                   DD.GST "GST_FLAG",
                   DD.SUSPENDED "SUSPENDED_FLAG",
                   RPAD(BA1.NAME||'  ('||TRIM(DD.PARTNER)||')', 50, ' ') || LPAD(TO_CHAR(NVL(DD.PARTNER_PERCENT,0),'990.0000000'),12,' ') || '   ' || RPAD(NVL(DD.PARTNER_TYPE,' '),10,' ') || '   ' || 'Owner: '||DECODE(TOW.OWNER,NULL,'N','Y') || '   ' || 'Silent Partner: '||DECODE(DD.SILENT_PARTNER,'*','S',' ') || '   ' || 'Penalty: '||NVL(DD.PENALTY,'N') || '   ' || 'Silent Owner: '||RPAD(BA2.NAME||'  ('||TRIM(DD.SILENT_OWNER)||')', 50, ' ') "PARTNER_SUMMARY"
              FROM DS_CSLAND.D_XREF DX,
                   DS_CSLAND.D_DETAIL DD,
                   DS_CSLAND.T_OWNERS TOW,
                   DS_CSLAND.BA_TABLE BA1,
                   DS_CSLAND.BA_TABLE BA2,
                   DS_CSLAND.T_DOI TD,
                   DS_CSLAND.T_PTYPE TP
             WHERE DX.DOI_ID = DD.DOI_ID
               AND DD.PARTNER = TOW.OWNER(+)
               AND DX.EFFECTIVE_DATE <= CURRENT_TIMESTAMP
               AND DX.EXPIRY_DATE > CURRENT_TIMESTAMP
               AND DD.PARTNER = BA1.PRIMARY_KEY(+)
               AND DD.SILENT_OWNER = BA2.PRIMARY_KEY(+)
               AND DX.DOI_TYPE = TD.CODE(+)
               AND DD.PARTNER_TYPE = TP.CODE(+)
               AND DX.SUBSYSTEM = 'C'
        dependencies:
          - locationName: TARGET
            nodeName: VIEW_CSLAND_CONTRACT_DETAIL
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','VIEW_CSLAND_CONTRACT_DETAIL') }}
        name: VIEW_CSLAND_CONTRACT_DOI_DETAIL
        noLinkRefs: []
  name: VIEW_CSLAND_CONTRACT_DOI_DETAIL
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
