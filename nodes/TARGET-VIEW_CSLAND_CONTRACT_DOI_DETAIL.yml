fileVersion: 1
id: 5c4848c2-5a8c-463f-8767-d68b49533fa8
name: VIEW_CSLAND_CONTRACT_DOI_DETAIL
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8007d754-8e1e-4b70-9457-b74212c522c5
          stepCounter: 5c4848c2-5a8c-463f-8767-d68b49533fa8
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: CONTRACT_FILE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5bd53338-b0e3-4df1-9469-50c0ad5d5418
                stepCounter: 822ebf76-d209-41fd-a20c-1d8c1e3773f3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6453c048-2d11-492c-a8e2-f93608e0c8c1
          stepCounter: 5c4848c2-5a8c-463f-8767-d68b49533fa8
        config: {}
        dataType: DECIMAL(7)
        defaultValue: ""
        description: ""
        name: DOI_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f841507-16ce-4612-80ff-8261367e7396
                stepCounter: 5d401374-6e3b-4e5f-b27a-ab979c40cb21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f1e7303-bb76-4971-aba7-d787453c0a7a
          stepCounter: 5c4848c2-5a8c-463f-8767-d68b49533fa8
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DOI_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 353fb880-be91-4706-8ff0-4c9fc93a1a3f
                stepCounter: 8a1aebb0-1dcf-4f1e-be95-93508ea7ab7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ecb73000-10e4-4d12-8869-bff4a7b8490e
          stepCounter: 5c4848c2-5a8c-463f-8767-d68b49533fa8
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: DOI_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 469c271a-3b3f-43c4-99c1-c621b8c1d32a
                stepCounter: fc08e86c-5254-4f5e-97fc-e83555aefe1e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c7625b5-18f8-4c94-9c25-4c714a2478f9
          stepCounter: 5c4848c2-5a8c-463f-8767-d68b49533fa8
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: DOI_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 739336c2-7514-48c7-a582-79f9a8720b53
                stepCounter: 8a1aebb0-1dcf-4f1e-be95-93508ea7ab7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47e77307-3925-4424-a6f1-7d50175b278d
          stepCounter: 5c4848c2-5a8c-463f-8767-d68b49533fa8
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CHANGED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc8fc0bb-41fd-4169-a46f-03db0ed56c7f
                stepCounter: 8a1aebb0-1dcf-4f1e-be95-93508ea7ab7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a982139b-6498-470c-98f1-953794fb5133
          stepCounter: 5c4848c2-5a8c-463f-8767-d68b49533fa8
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: ACCOUNT_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0abf96c0-1750-4523-a439-2a9c97feeaba
                stepCounter: 8a1aebb0-1dcf-4f1e-be95-93508ea7ab7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77b76d3d-0b86-432f-b5c3-5990155c1857
          stepCounter: 5c4848c2-5a8c-463f-8767-d68b49533fa8
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: EFFECTIVE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dbba7f4f-8c90-4747-bbce-8099b28ea271
                stepCounter: 8a1aebb0-1dcf-4f1e-be95-93508ea7ab7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3b06e9e-d327-405b-9135-a80251c60cf4
          stepCounter: 5c4848c2-5a8c-463f-8767-d68b49533fa8
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: EXPIRY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6510da05-a4fa-41d5-ba0f-2e995a04bf86
                stepCounter: 8a1aebb0-1dcf-4f1e-be95-93508ea7ab7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bee97ec8-d41d-415b-9d89-d081c03f927b
          stepCounter: 5c4848c2-5a8c-463f-8767-d68b49533fa8
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: OWNER_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b19904c-a62a-4040-971d-0bdb22e62c05
                stepCounter: 8a1aebb0-1dcf-4f1e-be95-93508ea7ab7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6a82474-55b2-4731-868e-cab7f945b664
          stepCounter: 5c4848c2-5a8c-463f-8767-d68b49533fa8
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: OWNER_IN_PENALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa838ebf-6c6f-4617-9d3b-7a71ef98a87a
                stepCounter: 5d401374-6e3b-4e5f-b27a-ab979c40cb21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 377a3f8e-129d-4e68-ac84-4802aa360f7f
          stepCounter: 5c4848c2-5a8c-463f-8767-d68b49533fa8
        config: {}
        dataType: VARCHAR(60)
        defaultValue: ""
        description: ""
        name: COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d469ab2-0795-4db4-ac98-b9cfd3a6af1f
                stepCounter: 8a1aebb0-1dcf-4f1e-be95-93508ea7ab7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01f1b2a8-a33d-4ab5-a941-560e9b822ebb
          stepCounter: 5c4848c2-5a8c-463f-8767-d68b49533fa8
        config: {}
        dataType: DECIMAL(6)
        defaultValue: ""
        description: ""
        name: PARTNER_OCCURRENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3943edef-ae37-48bc-b3bf-f803a5e29470
                stepCounter: 5d401374-6e3b-4e5f-b27a-ab979c40cb21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 270ae5ab-5779-4e86-bf7a-992f5a9d1920
          stepCounter: 5c4848c2-5a8c-463f-8767-d68b49533fa8
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PARTNER_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8953a1e0-0998-4339-acdc-88c81059d248
                stepCounter: 5d401374-6e3b-4e5f-b27a-ab979c40cb21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1de2b1b-d304-4ee5-8c3b-da13ce0557d5
          stepCounter: 5c4848c2-5a8c-463f-8767-d68b49533fa8
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: PARTNER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e973675-26ea-41fb-9f8f-450a5924d092
                stepCounter: 17e8c098-2969-4300-91b0-b858f6d02add
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 65d0916a-4501-4284-876f-63c680da7593
          stepCounter: 5c4848c2-5a8c-463f-8767-d68b49533fa8
        config: {}
        dataType: DECIMAL(11,8)
        defaultValue: ""
        description: ""
        name: PARTNER_PERCENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4390719f-f647-4285-96c0-635bec86b40c
                stepCounter: 5d401374-6e3b-4e5f-b27a-ab979c40cb21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff7b1044-6294-40a2-b562-4b49c68dbde3
          stepCounter: 5c4848c2-5a8c-463f-8767-d68b49533fa8
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: OWNING_PARTNER_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 44d0ab4a-fac5-4653-9b8e-cec8e672afb9
                stepCounter: 7d1c0def-cbcd-49c8-bb14-0ee1ccba7672
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18c406ab-17ff-4540-9258-caa32f6015f1
          stepCounter: 5c4848c2-5a8c-463f-8767-d68b49533fa8
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: SILENT_PARTNER_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77e72a62-cac0-40a8-81ba-90e06dd1591b
                stepCounter: 5d401374-6e3b-4e5f-b27a-ab979c40cb21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eaba2f1f-b93f-4f8e-94fd-de0bc0b8ad96
          stepCounter: 5c4848c2-5a8c-463f-8767-d68b49533fa8
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PARTNER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a944f58a-7836-4f13-9526-46953ba1623a
                stepCounter: 5d401374-6e3b-4e5f-b27a-ab979c40cb21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2265590-58a3-4025-80f5-7158cb3586de
          stepCounter: 5c4848c2-5a8c-463f-8767-d68b49533fa8
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: PARTNER_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1aedf7e7-d423-495f-8d9b-278728e3db5b
                stepCounter: 8257f393-4593-4b10-b20d-11d5bf639afd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c8a739e-58bc-4f79-a64f-9bde491a6919
          stepCounter: 5c4848c2-5a8c-463f-8767-d68b49533fa8
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: PENALTY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa838ebf-6c6f-4617-9d3b-7a71ef98a87a
                stepCounter: 5d401374-6e3b-4e5f-b27a-ab979c40cb21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c78020f5-458e-48f2-b04c-ee66c7d8c6e9
          stepCounter: 5c4848c2-5a8c-463f-8767-d68b49533fa8
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: SILENT_OWNER_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de841b6a-76f6-4c20-9d40-c64fc14a99c1
                stepCounter: 5d401374-6e3b-4e5f-b27a-ab979c40cb21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f84bbb15-eaa4-4e82-a3d9-b7e360083a68
          stepCounter: 5c4848c2-5a8c-463f-8767-d68b49533fa8
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: SILENT_OWNER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e973675-26ea-41fb-9f8f-450a5924d092
                stepCounter: 17e8c098-2969-4300-91b0-b858f6d02add
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b118803a-e530-4305-8c69-f81674d2e31a
          stepCounter: 5c4848c2-5a8c-463f-8767-d68b49533fa8
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: TIK_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 902cb371-ca1f-4ea2-85df-b2803fe2bacd
                stepCounter: 5d401374-6e3b-4e5f-b27a-ab979c40cb21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8eb21ee3-f73c-4051-93ea-d62ec1bca89b
          stepCounter: 5c4848c2-5a8c-463f-8767-d68b49533fa8
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: GST_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: af9075ca-8773-456c-b7a3-c4a58531a957
                stepCounter: 5d401374-6e3b-4e5f-b27a-ab979c40cb21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e0d7e99-348e-41b5-a7d5-e1a913d1263f
          stepCounter: 5c4848c2-5a8c-463f-8767-d68b49533fa8
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: SUSPENDED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2a28e0cb-d08b-46ef-8a27-36af7c7199ca
                stepCounter: 5d401374-6e3b-4e5f-b27a-ab979c40cb21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67fa23d9-4446-40d7-b9f5-c9c3e6a74f72
          stepCounter: 5c4848c2-5a8c-463f-8767-d68b49533fa8
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PARTNER_SUMMARY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8953a1e0-0998-4339-acdc-88c81059d248
                stepCounter: 5d401374-6e3b-4e5f-b27a-ab979c40cb21
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_CSLAND_CONTRACT_DOI_DETAIL: 5c4848c2-5a8c-463f-8767-d68b49533fa8
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_CSLAND_CONTRACT_DOI_DETAIL') }} AS SELECT TRIM(DX.FILE_NUMBER)||TRIM(DX.FILE_SUB) "CONTRACT_FILE_KEY",
                   DD.DOI_ID,
                   DX.DOI_TYPE "DOI_TYPE_CODE",
                   TD.DESCRIPTION "DOI_TYPE",
                   DX.DOI_STATUS,
                   DX.CHANGED_DATE,
                   DX.ACCOUNT_GROUP,
                   DX.EFFECTIVE_DATE,
                   DX.EXPIRY_DATE,
                   DX.OWNER "OWNER_FLAG",
                   DECODE(MAX(DECODE(DECODE(TOW.OWNER,NULL,'N','Y')||NVL(DD.PENALTY,'N'),'YY',1,0)) OVER (PARTITION BY DD.DOI_ID, DD.PARTNER),1,'Y','N') "OWNER_IN_PENALTY",
                   DX.COMMENTS,
                   DD.OCCURRENCE "PARTNER_OCCURRENCE",
                   DD.PARTNER "PARTNER_CODE",
                   BA1.NAME "PARTNER",
                   DD.PARTNER_PERCENT,
                   DECODE(TOW.OWNER,NULL,'N','Y') "OWNING_PARTNER_FLAG",
                   DD.SILENT_PARTNER "SILENT_PARTNER_FLAG",
                   DD.PARTNER_TYPE "PARTNER_TYPE_CODE",
                   TP.DESCRIPTION "PARTNER_TYPE",
                   DD.PENALTY "PENALTY_FLAG",
                   DD.SILENT_OWNER "SILENT_OWNER_CODE",
                   BA2.NAME "SILENT_OWNER",
                   DD.TIK "TIK_FLAG",
                   DD.GST "GST_FLAG",
                   DD.SUSPENDED "SUSPENDED_FLAG",
                   RPAD(BA1.NAME||'  ('||TRIM(DD.PARTNER)||')', 50, ' ') || LPAD(TO_CHAR(NVL(DD.PARTNER_PERCENT,0),'990.0000000'),12,' ') || '   ' || RPAD(NVL(DD.PARTNER_TYPE,' '),10,' ') || '   ' || 'Owner: '||DECODE(TOW.OWNER,NULL,'N','Y') || '   ' || 'Silent Partner: '||DECODE(DD.SILENT_PARTNER,'*','S',' ') || '   ' || 'Penalty: '||NVL(DD.PENALTY,'N') || '   ' || 'Silent Owner: '||RPAD(BA2.NAME||'  ('||TRIM(DD.SILENT_OWNER)||')', 50, ' ') "PARTNER_SUMMARY"
              FROM DS_CSLAND.D_XREF DX,
                   DS_CSLAND.D_DETAIL DD,
                   DS_CSLAND.T_OWNERS TOW,
                   DS_CSLAND.BA_TABLE BA1,
                   DS_CSLAND.BA_TABLE BA2,
                   DS_CSLAND.T_DOI TD,
                   DS_CSLAND.T_PTYPE TP
             WHERE DX.DOI_ID = DD.DOI_ID
               AND DD.PARTNER = TOW.OWNER(+)
               AND DX.EFFECTIVE_DATE <= CURRENT_TIMESTAMP
               AND DX.EXPIRY_DATE > CURRENT_TIMESTAMP
               AND DD.PARTNER = BA1.PRIMARY_KEY(+)
               AND DD.SILENT_OWNER = BA2.PRIMARY_KEY(+)
               AND DX.DOI_TYPE = TD.CODE(+)
               AND DD.PARTNER_TYPE = TP.CODE(+)
               AND DX.SUBSYSTEM = 'C'
        dependencies:
          - locationName: TARGET
            nodeName: VIEW_CSLAND_CONTRACT_DETAIL
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','VIEW_CSLAND_CONTRACT_DETAIL') }}
        name: VIEW_CSLAND_CONTRACT_DOI_DETAIL
        noLinkRefs: []
  name: VIEW_CSLAND_CONTRACT_DOI_DETAIL
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
