fileVersion: 1
id: 88b6549c-7850-4aa3-b71f-df7e0476dbc4
name: VIEW_PVIEW_VRL_DOWNTIME_VW
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7850d27-c6e1-45db-93f9-7e622d5d1ae1
          stepCounter: 88b6549c-7850-4aa3-b71f-df7e0476dbc4
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: FLOWNET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4afdb120-c68e-4ee6-b4f3-0ed91fcef143
          stepCounter: 88b6549c-7850-4aa3-b71f-df7e0476dbc4
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: COMPLETIONNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8b96ba6-fa62-4c0f-b013-fdbeffce9ce2
                stepCounter: 81e6b0b1-1728-45bf-932d-6356544cf13a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c1fa701-d1d9-4606-8999-6a949bfe7e4d
          stepCounter: 88b6549c-7850-4aa3-b71f-df7e0476dbc4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: TYPDOWNTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2e606926-c0cc-467c-869c-21b81f342633
                stepCounter: 74f44647-9ca6-45b0-bbe0-7eba25f1476b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8443921c-8ba9-45ca-bc2d-60e25e9c878d
          stepCounter: 88b6549c-7850-4aa3-b71f-df7e0476dbc4
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: PERIOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e23862e-5f1c-4ceb-9ed3-26e0c07e30fc
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8daf0679-07b0-4814-bd9e-0f59d0082127
          stepCounter: 88b6549c-7850-4aa3-b71f-df7e0476dbc4
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: HRS_DOWN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 849b0441-aadd-4df8-aa0c-bef157b937d0
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 568930f8-181a-463f-b6bf-eead874d42c3
          stepCounter: 88b6549c-7850-4aa3-b71f-df7e0476dbc4
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: DURDOWN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 849b0441-aadd-4df8-aa0c-bef157b937d0
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96d4fd14-367b-42b9-a9db-01b871f0e622
          stepCounter: 88b6549c-7850-4aa3-b71f-df7e0476dbc4
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: DUROP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 81e344fc-8e1c-48b6-b2a3-4528e7962c25
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 52e6ccd0-bf8c-4956-ba60-b5d0243a7695
          stepCounter: 88b6549c-7850-4aa3-b71f-df7e0476dbc4
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: LOST_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c1e5519f-a1c4-4e34-9bd0-bd55eb9a088a
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b081d65-2474-4209-ae11-a36b03b5089f
          stepCounter: 88b6549c-7850-4aa3-b71f-df7e0476dbc4
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: LOST_HCLIQ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ca00b48c-f996-4ad5-b756-422f43f3f2f7
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6c12aa8-f510-4dfa-8c88-075b67edbee0
          stepCounter: 88b6549c-7850-4aa3-b71f-df7e0476dbc4
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODEDOWNTM1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 269aae4c-9084-45b4-97ed-b3ae64414ec6
                stepCounter: 74f44647-9ca6-45b0-bbe0-7eba25f1476b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 277b467d-cccd-47c7-853c-63dc8687a5e5
          stepCounter: 88b6549c-7850-4aa3-b71f-df7e0476dbc4
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODEDOWNTM2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2344ad5-2de3-46d0-a994-6066b4da01c3
                stepCounter: 74f44647-9ca6-45b0-bbe0-7eba25f1476b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db3950da-5154-4611-b3c5-c33d45ab9517
          stepCounter: 88b6549c-7850-4aa3-b71f-df7e0476dbc4
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODEDOWNTM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 87418533-315d-45d4-9a5b-86c249519bb9
                stepCounter: 74f44647-9ca6-45b0-bbe0-7eba25f1476b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1382c9ca-64c4-4743-8b6e-6512289b307c
          stepCounter: 88b6549c-7850-4aa3-b71f-df7e0476dbc4
        config: {}
        dataType: VARCHAR(2000)
        defaultValue: ""
        description: ""
        name: NOTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7fbb07b-eae0-461b-91dd-71b4fa3a3054
                stepCounter: 74f44647-9ca6-45b0-bbe0-7eba25f1476b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 023bb99e-d976-40ae-b6cd-38d32a580387
          stepCounter: 88b6549c-7850-4aa3-b71f-df7e0476dbc4
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: BU_SF_ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2461b3f-8900-4460-9da7-dc1b4d0593bc
                stepCounter: a23239e4-617a-4ab9-a42c-1fd9220b7fb3
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_PVIEW_VRL_DOWNTIME_VW: 88b6549c-7850-4aa3-b71f-df7e0476dbc4
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_PVIEW_VRL_DOWNTIME_VW') }} AS SELECT f.name AS flownet,
                   c.wellname AS completionname,
                   d.typdowntm,
                   p.dttm AS period,
                   p.durdown * 24 AS hrs_down,
                   p.durdown,
                   p.durop,
                   p.vollostgas AS lost_gas,
                   p.vollosthcliq AS lost_hcliq,
                   d.codedowntm1,
                   d.codedowntm2,
                   d.codedowntm3,
                   d.com AS note,
                   WS_EDW.PVIEW_SYSSECURITYTYP_VET_BU_ROLE(f.SYSSECURITYTYP) AS BU_SF_ROLE
              FROM DS_PRODVIEW.PVT_pvunitallocmonthday p
             INNER JOIN DS_PRODVIEW.PVT_pvflownetheader f
                ON p.idflownet = f.idflownet
             INNER JOIN DS_PRODVIEW.PVT_pvunitcompdowntm d
                ON p.idrecdowntime = d.idrec
             INNER JOIN DS_PRODVIEW.PVT_pvunitcomp c
                ON p.idreccomp = c.idrec
        dependencies:
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVFLOWNETHEADER
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_PVIEW_PVT_PVFLOWNETHEADER') }}
        name: VIEW_PVIEW_VRL_DOWNTIME_VW
        noLinkRefs: []
  name: VIEW_PVIEW_VRL_DOWNTIME_VW
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
