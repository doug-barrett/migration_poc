fileVersion: 1
id: 8a30b619-cc72-4c8c-86fb-0fcfb4b7f9cf
name: VIEW_PVIEW_VRL_DOWNTIME_VW
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0039afc0-7e8e-44c5-bbaa-38810acfa728
          stepCounter: 8a30b619-cc72-4c8c-86fb-0fcfb4b7f9cf
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: FLOWNET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d42a1662-cecf-4bea-b197-43a7dd28da15
          stepCounter: 8a30b619-cc72-4c8c-86fb-0fcfb4b7f9cf
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: COMPLETIONNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47f8a18b-1555-41b2-9a09-2de136944f7f
                stepCounter: b2609f15-a93c-4c5d-b86e-0898ad7558d0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e69cc7c-b28a-4471-8b34-210ef0a1a187
          stepCounter: 8a30b619-cc72-4c8c-86fb-0fcfb4b7f9cf
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: TYPDOWNTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c9244a5-1ea7-4780-9b32-a2765aee987c
                stepCounter: 1cfae906-aa80-4fdd-86b2-b1b3da4133d3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 732e3527-6f61-4f89-aa58-c5a2594c1a74
          stepCounter: 8a30b619-cc72-4c8c-86fb-0fcfb4b7f9cf
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: PERIOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f12a712-52a9-49bc-b9b3-9f6c776cada1
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6960abd3-0304-4146-93c1-7f3d6b4255a9
          stepCounter: 8a30b619-cc72-4c8c-86fb-0fcfb4b7f9cf
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: HRS_DOWN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b51b4b24-93e1-450a-abda-190776b9def9
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ed054c7-3ea6-488f-8bdd-8617ec2115d6
          stepCounter: 8a30b619-cc72-4c8c-86fb-0fcfb4b7f9cf
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: DURDOWN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b51b4b24-93e1-450a-abda-190776b9def9
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e09f628c-81f0-4ea8-b247-788f0c6de8c2
          stepCounter: 8a30b619-cc72-4c8c-86fb-0fcfb4b7f9cf
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: DUROP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 565c3190-bc88-4ecf-8f99-070028fb908c
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2c83cad-754d-4a38-bc60-1a4bd7f4ff6b
          stepCounter: 8a30b619-cc72-4c8c-86fb-0fcfb4b7f9cf
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: LOST_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6bb8994c-e7a9-44a0-aecc-c85460eeec83
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 00ef7a20-006d-4461-8b06-652bfe3934b2
          stepCounter: 8a30b619-cc72-4c8c-86fb-0fcfb4b7f9cf
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: LOST_HCLIQ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 410e1a18-7545-4f60-ab98-abe421bccda2
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ee9271c-fe31-4d37-b9a0-048d4daf09a9
          stepCounter: 8a30b619-cc72-4c8c-86fb-0fcfb4b7f9cf
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODEDOWNTM1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9f3c7124-cf15-45ac-b345-58434a1ea591
                stepCounter: 1cfae906-aa80-4fdd-86b2-b1b3da4133d3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2243abf4-93c9-4061-a2f6-2ea3b404832a
          stepCounter: 8a30b619-cc72-4c8c-86fb-0fcfb4b7f9cf
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODEDOWNTM2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f62b7e5-2a9d-423a-950f-4106c2b28111
                stepCounter: 1cfae906-aa80-4fdd-86b2-b1b3da4133d3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 682d1146-885d-46c4-aa6d-7fc5186c633b
          stepCounter: 8a30b619-cc72-4c8c-86fb-0fcfb4b7f9cf
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODEDOWNTM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b5d45b8b-cc48-45f6-9ca4-fd0ce63ce6fd
                stepCounter: 1cfae906-aa80-4fdd-86b2-b1b3da4133d3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 399126be-6ddb-4fd4-bdd2-52a6a3fbdb4c
          stepCounter: 8a30b619-cc72-4c8c-86fb-0fcfb4b7f9cf
        config: {}
        dataType: VARCHAR(2000)
        defaultValue: ""
        description: ""
        name: NOTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 523c8ba2-6769-46bc-93e3-3db7a6045009
                stepCounter: 1cfae906-aa80-4fdd-86b2-b1b3da4133d3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66ca51ad-c6ec-4f2c-bf49-e8e5b510633d
          stepCounter: 8a30b619-cc72-4c8c-86fb-0fcfb4b7f9cf
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: BU_SF_ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 748cdf05-5750-44bd-bb7a-77b0769f897d
                stepCounter: bd388a52-3d72-4c70-833d-7de7c6a8abd1
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_PVIEW_VRL_DOWNTIME_VW: 8a30b619-cc72-4c8c-86fb-0fcfb4b7f9cf
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_PVIEW_VRL_DOWNTIME_VW') }} AS SELECT f.name AS flownet,
                   c.wellname AS completionname,
                   d.typdowntm,
                   p.dttm AS period,
                   p.durdown * 24 AS hrs_down,
                   p.durdown,
                   p.durop,
                   p.vollostgas AS lost_gas,
                   p.vollosthcliq AS lost_hcliq,
                   d.codedowntm1,
                   d.codedowntm2,
                   d.codedowntm3,
                   d.com AS note,
                   WS_EDW.PVIEW_SYSSECURITYTYP_VET_BU_ROLE(f.SYSSECURITYTYP) AS BU_SF_ROLE
              FROM DS_PRODVIEW.PVT_pvunitallocmonthday p
             INNER JOIN DS_PRODVIEW.PVT_pvflownetheader f
                ON p.idflownet = f.idflownet
             INNER JOIN DS_PRODVIEW.PVT_pvunitcompdowntm d
                ON p.idrecdowntime = d.idrec
             INNER JOIN DS_PRODVIEW.PVT_pvunitcomp c
                ON p.idreccomp = c.idrec
        dependencies:
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVFLOWNETHEADER
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_PVIEW_PVT_PVFLOWNETHEADER') }}
        name: VIEW_PVIEW_VRL_DOWNTIME_VW
        noLinkRefs: []
  name: VIEW_PVIEW_VRL_DOWNTIME_VW
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
