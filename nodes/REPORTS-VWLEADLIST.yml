fileVersion: 1
id: 10c91419-271f-4b6f-8ce1-2dbbee6767ec
name: VWLEADLIST
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: REPORTS
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b104e538-201a-4db8-97b1-7f8aa3291df8
          stepCounter: 10c91419-271f-4b6f-8ce1-2dbbee6767ec
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEFACTSALESMERGE_1.REPORTINGCUSTOMERID=ACCOUNT.FORCEID
        name: ACCOUNTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64e275ef-c45d-4146-9a29-eeec593d1764
                stepCounter: b616ec63-e21c-400a-948a-218a9fc3f509
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 60896549-b310-4c57-a16b-438c05a3a3af
          stepCounter: 10c91419-271f-4b6f-8ce1-2dbbee6767ec
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEFACTSALESMERGE_1.REPORTINGCUSTOMERID=ACCOUNTGEOGRAPHY.FORCEID
        name: ACCOUNTGEOGRAPHYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eafbf13d-e75c-4388-b9b2-42c4edf4ba88
                stepCounter: b616ec63-e21c-400a-948a-218a9fc3f509
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d08e1398-72cb-434f-9999-8f2a9e77f3b4
          stepCounter: 10c91419-271f-4b6f-8ce1-2dbbee6767ec
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEFACTSALESMERGE_1.ACCOUNT.ACCOUNTTERRITORY=SALESTERRITORY.TERRITORYNAME
        name: SALESTERRITORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aeafa00e-c8e9-45cb-b2ad-ab2dc7af657e
                stepCounter: b616ec63-e21c-400a-948a-218a9fc3f509
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 65609880-1c8b-4836-b780-c7c04b1c1d28
          stepCounter: 10c91419-271f-4b6f-8ce1-2dbbee6767ec
        config: {}
        dataType: INT
        defaultValue: ""
        description: UNIQUE IDENTIFIER FOR AN ACCOUNT. COMMONLY CALLED THE "FORCE ID"
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 349c7dc1-e387-4400-9038-4c5b022f35f8
                stepCounter: e6f00723-a598-4272-b25a-ed544e4c0a06
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0da6a80d-e5f6-434a-bfd4-ba035f57ec34
          stepCounter: 10c91419-271f-4b6f-8ce1-2dbbee6767ec
        config: {}
        dataType: INT
        defaultValue: ""
        description: PARENT ID FOR AN ACCOUNT. WILL BE THE SAME AS FORCEID IF THERE IS NO PARENT OR IF THIS IS THE TOP-MOST ACCOUNT IN A HIERARCHY
        name: FORCEPARENTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 58e046c7-1b5b-4502-8cb0-f80357f76c8b
                stepCounter: e6f00723-a598-4272-b25a-ed544e4c0a06
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd6f783c-b587-4cba-9948-38764328c227
          stepCounter: 10c91419-271f-4b6f-8ce1-2dbbee6767ec
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "STAGEFACTSALESMERGE_1.SUPPLIERID=SUPPLIER.SUPPLIERID\nSTAGEFACTSALESMERGE_1.SUPPLIERNAME=SUPPLIER.SUPPLIERNAME\nSTAGEFACTSALESMERGE_1.CONTRACTNUMBER=SUPPLIER.CONTRACTNUMBER"
        name: NUMOFSUPPLIERSUSED
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4de3a3ee-0b8e-4b84-82ea-867c052ad66a
                stepCounter: b616ec63-e21c-400a-948a-218a9fc3f509
            transform: COUNT (DISTINCT SALESANDREVENUE.SUPPLIERKEY)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1422833-cc27-4cee-a7cd-1367fcf3673a
          stepCounter: 10c91419-271f-4b6f-8ce1-2dbbee6767ec
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ""
        name: ROLLING12MONTHSALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e102484-a481-43c7-a074-4ea04cea341d
                stepCounter: b616ec63-e21c-400a-948a-218a9fc3f509
            transform: SUM(SALESANDREVENUE.SALES)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 68e56cae-2f5b-4c4c-b392-5809a85cbef2
          stepCounter: 10c91419-271f-4b6f-8ce1-2dbbee6767ec
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ""
        name: ROLLING12MONTHREVENUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78149a3a-b5c8-4438-bec1-c2c9155b2a27
                stepCounter: b616ec63-e21c-400a-948a-218a9fc3f509
            transform: SUM(SALESANDREVENUE.REVENUE)
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE VIEW {{ this }}(\NACCOUNTKEY, \NACCOUNTGEOGRAPHYKEY,\NSALESTERRITORYKEY, \NFORCEID, \NFORCEPARENTID, \NNUMOFSUPPLIERSUSED, \NROLLING12MONTHSALES, \NROLLING12MONTHREVENUE) \NAS \NSELECT \NSALESANDREVENUE.ACCOUNTKEY, \NSALESANDREVENUE.ACCOUNTGEOGRAPHYKEY, \N--SALESANDREVENUE.ACCOUNTEXTERNALIDKEY,
            \NSALESANDREVENUE.SALESTERRITORYKEY, \NACCOUNT.FORCEID, \NACCOUNT.FORCEPARENTID,\NCOUNT (DISTINCT SALESANDREVENUE.SUPPLIERKEY), \NSUM(SALESANDREVENUE.SALES), \NSUM(SALESANDREVENUE.REVENUE) \NFROM FACT.SALESANDREVENUE SALESANDREVENUE \N
             INNER JOIN DIM.ACCOUNT ACCOUNT
                ON \N ACCOUNT.ACCOUNTKEY = SALESANDREVENUE.ACCOUNTKEY\NWHERE DATEDIFF(MONTH,SALESANDREVENUE.TRANSACTIONDATE,SALESANDREVENUE.MAXRECEIPTDATE) <= 12\NGROUP BY \N SALESANDREVENUE.ACCOUNTKEY \N , SALESANDREVENUE.ACCOUNTGEOGRAPHYKEY \N--  , SALESANDREVENUE.ACCOUNTEXTERNALIDKEY
            \N , SALESANDREVENUE.SALESTERRITORYKEY \N , ACCOUNT.FORCEID \N , ACCOUNT.FORCEPARENTID
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: FACT
            nodeName: SALESANDREVENUE
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('DIM','ACCOUNT') }}
            {{ ref('FACT','SALESANDREVENUE') }}
        name: VWLEADLIST
        noLinkRefs: []
  name: VWLEADLIST
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
