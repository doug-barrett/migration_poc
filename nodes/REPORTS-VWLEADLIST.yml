fileVersion: 1
id: 2644d663-faf8-4594-9cc2-6b24f3f65b51
name: VWLEADLIST
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: REPORTS
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87465c14-7b8c-4bc0-b45d-c96e70103522
          stepCounter: 2644d663-faf8-4594-9cc2-6b24f3f65b51
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEFACTSALESMERGE_1.REPORTINGCUSTOMERID=ACCOUNT.FORCEID
        name: ACCOUNTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00668cf3-97ca-4447-bbb6-19389f4f20ce
                stepCounter: 35498798-8753-42e9-bc58-c54bc0c65138
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db9cb21a-5963-4d8c-b501-1d0d88ddd7f5
          stepCounter: 2644d663-faf8-4594-9cc2-6b24f3f65b51
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEFACTSALESMERGE_1.REPORTINGCUSTOMERID=ACCOUNTGEOGRAPHY.FORCEID
        name: ACCOUNTGEOGRAPHYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a685ba04-c738-4939-9c42-6d26c5dd4562
                stepCounter: 35498798-8753-42e9-bc58-c54bc0c65138
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4821abe7-f17d-463d-ab28-c9f2bfabe514
          stepCounter: 2644d663-faf8-4594-9cc2-6b24f3f65b51
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEFACTSALESMERGE_1.ACCOUNT.ACCOUNTTERRITORY=SALESTERRITORY.TERRITORYNAME
        name: SALESTERRITORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea6cb513-d4a4-4cea-9915-ffe3b750a61d
                stepCounter: 35498798-8753-42e9-bc58-c54bc0c65138
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 62774d73-06cc-4613-b639-c0c717f42a4a
          stepCounter: 2644d663-faf8-4594-9cc2-6b24f3f65b51
        config: {}
        dataType: INT
        defaultValue: ""
        description: UNIQUE IDENTIFIER FOR AN ACCOUNT. COMMONLY CALLED THE "FORCE ID"
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5618162-63a1-4114-905f-185fd2a82e5e
                stepCounter: d5234d5a-eb19-45e2-9c42-47221579f347
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 76bc22c2-b728-43c1-b55e-7ed983f7a7bc
          stepCounter: 2644d663-faf8-4594-9cc2-6b24f3f65b51
        config: {}
        dataType: INT
        defaultValue: ""
        description: PARENT ID FOR AN ACCOUNT. WILL BE THE SAME AS FORCEID IF THERE IS NO PARENT OR IF THIS IS THE TOP-MOST ACCOUNT IN A HIERARCHY
        name: FORCEPARENTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 12b3c01d-bc79-4e6b-98fe-d31f39d845c7
                stepCounter: d5234d5a-eb19-45e2-9c42-47221579f347
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53327fec-a284-411a-b795-4b8980ffcf78
          stepCounter: 2644d663-faf8-4594-9cc2-6b24f3f65b51
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "STAGEFACTSALESMERGE_1.SUPPLIERID=SUPPLIER.SUPPLIERID\nSTAGEFACTSALESMERGE_1.SUPPLIERNAME=SUPPLIER.SUPPLIERNAME\nSTAGEFACTSALESMERGE_1.CONTRACTNUMBER=SUPPLIER.CONTRACTNUMBER"
        name: NUMOFSUPPLIERSUSED
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50589f20-953c-48de-b6e4-7edb8f0a888d
                stepCounter: 35498798-8753-42e9-bc58-c54bc0c65138
            transform: COUNT (DISTINCT SALESANDREVENUE.SUPPLIERKEY)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6bb1f59c-385f-4c80-aa4f-98e888190da8
          stepCounter: 2644d663-faf8-4594-9cc2-6b24f3f65b51
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ""
        name: ROLLING12MONTHSALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a2458c7-c0c6-4612-8ab1-2a23e7ee2bd8
                stepCounter: 35498798-8753-42e9-bc58-c54bc0c65138
            transform: SUM(SALESANDREVENUE.SALES)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d0476f80-e61f-4d89-a073-1bffa4cffe4e
          stepCounter: 2644d663-faf8-4594-9cc2-6b24f3f65b51
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ""
        name: ROLLING12MONTHREVENUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d80644e6-6eac-4b2a-a4b4-8ae1175d334b
                stepCounter: 35498798-8753-42e9-bc58-c54bc0c65138
            transform: SUM(SALESANDREVENUE.REVENUE)
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE VIEW {{ this }}(\NACCOUNTKEY, \NACCOUNTGEOGRAPHYKEY,\NSALESTERRITORYKEY, \NFORCEID, \NFORCEPARENTID, \NNUMOFSUPPLIERSUSED, \NROLLING12MONTHSALES, \NROLLING12MONTHREVENUE) \NAS \NSELECT \NSALESANDREVENUE.ACCOUNTKEY, \NSALESANDREVENUE.ACCOUNTGEOGRAPHYKEY, \N--SALESANDREVENUE.ACCOUNTEXTERNALIDKEY,
            \NSALESANDREVENUE.SALESTERRITORYKEY, \NACCOUNT.FORCEID, \NACCOUNT.FORCEPARENTID,\NCOUNT (DISTINCT SALESANDREVENUE.SUPPLIERKEY), \NSUM(SALESANDREVENUE.SALES), \NSUM(SALESANDREVENUE.REVENUE) \NFROM FACT.SALESANDREVENUE SALESANDREVENUE \N
             INNER JOIN DIM.ACCOUNT ACCOUNT
                ON \N ACCOUNT.ACCOUNTKEY = SALESANDREVENUE.ACCOUNTKEY\NWHERE DATEDIFF(MONTH,SALESANDREVENUE.TRANSACTIONDATE,SALESANDREVENUE.MAXRECEIPTDATE) <= 12\NGROUP BY \N SALESANDREVENUE.ACCOUNTKEY \N , SALESANDREVENUE.ACCOUNTGEOGRAPHYKEY \N--  , SALESANDREVENUE.ACCOUNTEXTERNALIDKEY
            \N , SALESANDREVENUE.SALESTERRITORYKEY \N , ACCOUNT.FORCEID \N , ACCOUNT.FORCEPARENTID
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: FACT
            nodeName: SALESANDREVENUE
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('DIM','ACCOUNT') }}
            {{ ref('FACT','SALESANDREVENUE') }}
        name: VWLEADLIST
        noLinkRefs: []
  name: VWLEADLIST
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
