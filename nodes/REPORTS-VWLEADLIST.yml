fileVersion: 1
id: 662e1bf4-76f1-4a0a-b949-d3270e125614
name: VWLEADLIST
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: REPORTS
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8bf8db16-7d5d-4de0-9988-08f91d4c7116
          stepCounter: 662e1bf4-76f1-4a0a-b949-d3270e125614
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEFACTSALESMERGE_1.REPORTINGCUSTOMERID=ACCOUNT.FORCEID
        name: ACCOUNTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 964d17ac-ca6e-4b18-9467-ac078864cd92
                stepCounter: a45c4c17-99cc-493a-8410-a4e188c9c3a2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f67ac3d4-66b1-4b28-8d46-49366394bb09
          stepCounter: 662e1bf4-76f1-4a0a-b949-d3270e125614
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEFACTSALESMERGE_1.REPORTINGCUSTOMERID=ACCOUNTGEOGRAPHY.FORCEID
        name: ACCOUNTGEOGRAPHYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9237c5a1-e9bf-4e67-8199-e3a130d887ef
                stepCounter: a45c4c17-99cc-493a-8410-a4e188c9c3a2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dfc81625-f801-4355-876d-dba119ce2e70
          stepCounter: 662e1bf4-76f1-4a0a-b949-d3270e125614
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEFACTSALESMERGE_1.ACCOUNT.ACCOUNTTERRITORY=SALESTERRITORY.TERRITORYNAME
        name: SALESTERRITORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 29bdee0d-5f7f-4876-aaea-8f14e456bd68
                stepCounter: a45c4c17-99cc-493a-8410-a4e188c9c3a2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20ac4266-d88d-48ae-af96-0b81c6519e1c
          stepCounter: 662e1bf4-76f1-4a0a-b949-d3270e125614
        config: {}
        dataType: INT
        defaultValue: ""
        description: UNIQUE IDENTIFIER FOR AN ACCOUNT. COMMONLY CALLED THE "FORCE ID"
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: be2b5606-0fe8-444f-867f-5c3e46361714
                stepCounter: 96e8695b-6733-4729-8797-91b12c74cb7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0973b450-f90a-46db-9a7e-c5780a3ead62
          stepCounter: 662e1bf4-76f1-4a0a-b949-d3270e125614
        config: {}
        dataType: INT
        defaultValue: ""
        description: PARENT ID FOR AN ACCOUNT. WILL BE THE SAME AS FORCEID IF THERE IS NO PARENT OR IF THIS IS THE TOP-MOST ACCOUNT IN A HIERARCHY
        name: FORCEPARENTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 444d8157-9685-4ebd-987c-36f88770bb63
                stepCounter: 96e8695b-6733-4729-8797-91b12c74cb7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc60ed6e-0c47-4ba7-b39c-f85b30a5e3ee
          stepCounter: 662e1bf4-76f1-4a0a-b949-d3270e125614
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "STAGEFACTSALESMERGE_1.SUPPLIERID=SUPPLIER.SUPPLIERID\nSTAGEFACTSALESMERGE_1.SUPPLIERNAME=SUPPLIER.SUPPLIERNAME\nSTAGEFACTSALESMERGE_1.CONTRACTNUMBER=SUPPLIER.CONTRACTNUMBER"
        name: NUMOFSUPPLIERSUSED
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3be588f3-62b2-4f59-9b71-705c86ab2937
                stepCounter: a45c4c17-99cc-493a-8410-a4e188c9c3a2
            transform: COUNT (DISTINCT SALESANDREVENUE.SUPPLIERKEY)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a9a4014-ca2f-41fd-8fa3-b0b18cc30214
          stepCounter: 662e1bf4-76f1-4a0a-b949-d3270e125614
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ""
        name: ROLLING12MONTHSALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4129155a-6d88-4334-8076-297a018bdd12
                stepCounter: a45c4c17-99cc-493a-8410-a4e188c9c3a2
            transform: SUM(SALESANDREVENUE.SALES)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50a52326-4ede-4231-b49a-69941f86bcfd
          stepCounter: 662e1bf4-76f1-4a0a-b949-d3270e125614
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ""
        name: ROLLING12MONTHREVENUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed76dbed-8dd4-4d3b-a417-bc4aec76a744
                stepCounter: a45c4c17-99cc-493a-8410-a4e188c9c3a2
            transform: SUM(SALESANDREVENUE.REVENUE)
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE VIEW {{ this }}(\NACCOUNTKEY, \NACCOUNTGEOGRAPHYKEY,\NSALESTERRITORYKEY, \NFORCEID, \NFORCEPARENTID, \NNUMOFSUPPLIERSUSED, \NROLLING12MONTHSALES, \NROLLING12MONTHREVENUE) \NAS \NSELECT \NSALESANDREVENUE.ACCOUNTKEY, \NSALESANDREVENUE.ACCOUNTGEOGRAPHYKEY, \N--SALESANDREVENUE.ACCOUNTEXTERNALIDKEY,
            \NSALESANDREVENUE.SALESTERRITORYKEY, \NACCOUNT.FORCEID, \NACCOUNT.FORCEPARENTID,\NCOUNT (DISTINCT SALESANDREVENUE.SUPPLIERKEY), \NSUM(SALESANDREVENUE.SALES), \NSUM(SALESANDREVENUE.REVENUE) \NFROM FACT.SALESANDREVENUE SALESANDREVENUE \N
             INNER JOIN DIM.ACCOUNT ACCOUNT
                ON \N ACCOUNT.ACCOUNTKEY = SALESANDREVENUE.ACCOUNTKEY\NWHERE DATEDIFF(MONTH,SALESANDREVENUE.TRANSACTIONDATE,SALESANDREVENUE.MAXRECEIPTDATE) <= 12\NGROUP BY \N SALESANDREVENUE.ACCOUNTKEY \N , SALESANDREVENUE.ACCOUNTGEOGRAPHYKEY \N--  , SALESANDREVENUE.ACCOUNTEXTERNALIDKEY
            \N , SALESANDREVENUE.SALESTERRITORYKEY \N , ACCOUNT.FORCEID \N , ACCOUNT.FORCEPARENTID
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: FACT
            nodeName: SALESANDREVENUE
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('DIM','ACCOUNT') }}
            {{ ref('FACT','SALESANDREVENUE') }}
        name: VWLEADLIST
        noLinkRefs: []
  name: VWLEADLIST
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
