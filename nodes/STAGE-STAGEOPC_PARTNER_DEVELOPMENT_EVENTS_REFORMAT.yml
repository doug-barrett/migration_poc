fileVersion: 1
id: e21e7163-77d5-4f44-9f17-45aee921348f
name: STAGEOPC_PARTNER_DEVELOPMENT_EVENTS_REFORMAT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91e1d8bd-687c-4d1a-8634-9f2eede2fd98
          stepCounter: e21e7163-77d5-4f44-9f17-45aee921348f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ACCOUNT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 203ba900-bb65-4c0c-95ab-053f66db0abc
          stepCounter: e21e7163-77d5-4f44-9f17-45aee921348f
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d3aee8b-3068-4bd7-84a2-ca79bcaab50a
                stepCounter: 94289ad3-cfb9-457d-99a9-9e3ee4e26dba
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_PD_EVENTS_GA4.DATE),'YYYYMMDD') \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc158049-fc31-4ad2-b437-294e8b2d7fdb
          stepCounter: e21e7163-77d5-4f44-9f17-45aee921348f
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: GA_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d3aee8b-3068-4bd7-84a2-ca79bcaab50a
                stepCounter: 94289ad3-cfb9-457d-99a9-9e3ee4e26dba
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_PD_EVENTS_GA4.DATE),'YYYYMMDD')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 432343c1-94aa-4d9a-8430-c81ff4476e23
          stepCounter: e21e7163-77d5-4f44-9f17-45aee921348f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: USER ID
        name: GA_DIMENSION10
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d9f2482-38f8-4916-b744-e09a7f8806bf
                stepCounter: 94289ad3-cfb9-457d-99a9-9e3ee4e26dba
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6362e11a-5441-4c00-a6ad-939f73e6fffe
          stepCounter: e21e7163-77d5-4f44-9f17-45aee921348f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: USER NAME
        name: GA_DIMENSION11
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a0c04455-fe2f-418d-b5dc-5ab39910eebe
                stepCounter: 08571f1f-4edf-4c3d-b7a0-d9134984c33e
            transform: INITCAP(CONCAT(LOADOPCUSERS.FIRSTNAME,' ',LOADOPCUSERS.LASTNAME))
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: INITCAP(CONCAT(LOADOPCUSERS.FIRSTNAME,' ',LOADOPCUSERS.LASTNAME))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7be1299-a1e9-4a7c-8e19-875033563abd
          stepCounter: e21e7163-77d5-4f44-9f17-45aee921348f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER ID - SUPPLIER NAME
        name: GA_DIMENSION12
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52f79498-6f67-4c21-b567-c5d3dc162a25
                stepCounter: 94289ad3-cfb9-457d-99a9-9e3ee4e26dba
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ae6b752-9ed9-49bd-9c81-4e63c019b60f
          stepCounter: e21e7163-77d5-4f44-9f17-45aee921348f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER ID
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52f79498-6f67-4c21-b567-c5d3dc162a25
                stepCounter: 94289ad3-cfb9-457d-99a9-9e3ee4e26dba
            transform: SPLIT_PART(LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA.USER_SUPPLIER,'-',1) \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: SPLIT_PART(LOADGA_OPC_PD_EVENTS_GA4.USER_SUPPLIER,'-',1)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aaccee0a-cb72-4c07-86a1-d19822d741d6
          stepCounter: e21e7163-77d5-4f44-9f17-45aee921348f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER NAME
        name: SUPPLIER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52f79498-6f67-4c21-b567-c5d3dc162a25
                stepCounter: 94289ad3-cfb9-457d-99a9-9e3ee4e26dba
            transform: INITCAP(SPLIT_PART(LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA.USER_SUPPLIER,'-',2)) \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: INITCAP(SPLIT_PART(LOADGA_OPC_PD_EVENTS_GA4.USER_SUPPLIER,'-',2)) \N \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e7ca55e-ff65-46bb-8153-b372fcecfa45
          stepCounter: e21e7163-77d5-4f44-9f17-45aee921348f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: GA_EVENTCATEGORY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f4096d1f-abdb-486b-9bde-13b7f5f65bb7
                stepCounter: 94289ad3-cfb9-457d-99a9-9e3ee4e26dba
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6bd44a85-ecb3-42be-b5be-54e48be50e75
          stepCounter: e21e7163-77d5-4f44-9f17-45aee921348f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: GA_EVENTACTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 451b907a-5e44-4669-9ccc-a80a7d4c4b84
                stepCounter: 94289ad3-cfb9-457d-99a9-9e3ee4e26dba
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f15dde9-57ee-4c55-b988-ec6c1c06e71c
          stepCounter: e21e7163-77d5-4f44-9f17-45aee921348f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: GA_EVENTLABEL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 63a5ed48-3be8-4a5e-820a-b56fc1bc4054
                stepCounter: 94289ad3-cfb9-457d-99a9-9e3ee4e26dba
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 90aa0720-460f-453d-a931-3abfe50ca386
          stepCounter: e21e7163-77d5-4f44-9f17-45aee921348f
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: GA_TOTALEVENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21d283a6-adf5-4598-a974-758664ba2fbb
                stepCounter: 94289ad3-cfb9-457d-99a9-9e3ee4e26dba
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c9ffa64-3c11-4d69-b1af-4c09a1e887fc
          stepCounter: e21e7163-77d5-4f44-9f17-45aee921348f
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: GA_UNIQUEEVENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 45048656-6d00-4f81-b8f0-b173804df3de
                stepCounter: 94289ad3-cfb9-457d-99a9-9e3ee4e26dba
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e8a633d-0276-4615-a7f7-72312a5b7f88
          stepCounter: e21e7163-77d5-4f44-9f17-45aee921348f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PROFILE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72ba20d7-6510-4d84-b3f4-cde90ddbc63a
          stepCounter: e21e7163-77d5-4f44-9f17-45aee921348f
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d3aee8b-3068-4bd7-84a2-ca79bcaab50a
                stepCounter: 94289ad3-cfb9-457d-99a9-9e3ee4e26dba
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_PD_EVENTS_GA4.DATE),'YYYYMMDD')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: caed3b0d-e756-4a47-8c18-f58e12d0380d
          stepCounter: e21e7163-77d5-4f44-9f17-45aee921348f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: WEB_PROPERTY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80b67630-5880-42f2-9ed1-5b17bce0b90b
          stepCounter: e21e7163-77d5-4f44-9f17-45aee921348f
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_BATCHED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4588f78-0b03-485a-998f-e884d3839e75
                stepCounter: 94289ad3-cfb9-457d-99a9-9e3ee4e26dba
            transform: TO_TIMESTAMP(LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA.__HEVO__LOADED_AT,3) \N \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_PD_EVENTS_GA4.__HEVO__LOADED_AT,3) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 312a5ddf-c39a-4f90-8462-14c2eaa3cec4
          stepCounter: e21e7163-77d5-4f44-9f17-45aee921348f
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_EXTRACTED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ece058a-1de4-4ad4-9ceb-752e9ab211fb
                stepCounter: 94289ad3-cfb9-457d-99a9-9e3ee4e26dba
            transform: TO_TIMESTAMP(LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA.__HEVO__INGESTED_AT,3)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_PD_EVENTS_GA4.__HEVO__INGESTED_AT,3) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b0a68ed-4162-4e8e-a3d0-de43e0d5e977
          stepCounter: e21e7163-77d5-4f44-9f17-45aee921348f
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_RECEIVED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4588f78-0b03-485a-998f-e884d3839e75
                stepCounter: 94289ad3-cfb9-457d-99a9-9e3ee4e26dba
            transform: TO_TIMESTAMP(LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA.__HEVO__LOADED_AT,3) \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_PD_EVENTS_GA4.__HEVO__LOADED_AT,3)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cfa4143d-9331-40a9-a1c4-8ee9e72bc021
          stepCounter: e21e7163-77d5-4f44-9f17-45aee921348f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: _SDC_RECORD_HASH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2206cef-311b-42ed-a84a-1443f8750618
                stepCounter: 94289ad3-cfb9-457d-99a9-9e3ee4e26dba
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3aef4c2-cdb0-4790-a350-0f016e06707a
          stepCounter: e21e7163-77d5-4f44-9f17-45aee921348f
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: _SDC_SEQUENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f36ed671-3b38-42a2-adab-d9f3ea3eb677
          stepCounter: e21e7163-77d5-4f44-9f17-45aee921348f
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: _SDC_TABLE_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e375334e-1c05-4227-a2b1-66ce8960f708
          stepCounter: e21e7163-77d5-4f44-9f17-45aee921348f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: GA_HOSTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9061a4e0-b899-4c91-9ca1-c50efb4b7d4e
                stepCounter: 94289ad3-cfb9-457d-99a9-9e3ee4e26dba
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f21894c-f1c3-45d6-9a59-cd02e416dd3d
          stepCounter: e21e7163-77d5-4f44-9f17-45aee921348f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: THIS FIELD WILL BE USED TO FILTER WHICH OPC ENVIRONMENT THIS GA RECORD WILL BE SHOWN.
        name: FILTER_DATABASE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9061a4e0-b899-4c91-9ca1-c50efb4b7d4e
                stepCounter: 94289ad3-cfb9-457d-99a9-9e3ee4e26dba
            transform: CASE HOSTNAME \N WHEN 'OPC-SCUS-SVC-WEB-DEV.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_DEV' \N WHEN 'LOCALHOST' \N THEN 'OMNIACONNECT_DEV' \N WHEN'OPC-SCUS-SVC-WEB-QA.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA' \N WHEN 'OPC-SCUS-SVC-WEB-PROD-STAGING.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA' \N WHEN 'OPC-SCUS-SVC-WEB-UAT.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_UAT' \N WHEN 'OMNIACONNECT.OMNIAPARTNERS.COM' \N THEN 'OMNIACONNECT' \N ELSE NULL \NEND \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: CASE HOSTNAME \N WHEN 'OPC-SCUS-SVC-WEB-DEV.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_DEV' \N WHEN 'LOCALHOST' \N THEN 'OMNIACONNECT_DEV' \N WHEN'OPC-SCUS-SVC-WEB-QA.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA' \N WHEN 'OPC-SCUS-SVC-WEB-PROD-STAGING.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA' \N WHEN 'OPC-SCUS-SVC-WEB-UAT.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_UAT' \N WHEN 'OMNIACONNECT.OMNIAPARTNERS.COM' \N THEN 'OMNIACONNECT' \N ELSE NULL \NEND \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ae86e68-3a8f-426b-a77b-0bd5754725e9
          stepCounter: e21e7163-77d5-4f44-9f17-45aee921348f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5900f156-77ab-48c6-a715-0362a6607877
                stepCounter: 94289ad3-cfb9-457d-99a9-9e3ee4e26dba
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f1d74262-ad5e-4f1f-a074-18490db53f30
          stepCounter: e21e7163-77d5-4f44-9f17-45aee921348f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 53320aab-cea7-43a1-80c3-478625598445
                stepCounter: 94289ad3-cfb9-457d-99a9-9e3ee4e26dba
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a49f2017-5607-4e39-bdeb-12dc68884b2e
          stepCounter: e21e7163-77d5-4f44-9f17-45aee921348f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f1627e7-4665-4d5c-9e40-44891fd91e00
          stepCounter: e21e7163-77d5-4f44-9f17-45aee921348f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA: 94289ad3-cfb9-457d-99a9-9e3ee4e26dba
          LOADOPCUSERS: 08571f1f-4edf-4c3d-b7a0-d9134984c33e
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOADOPCUSERS
          - locationName: LOAD
            nodeName: LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA') }} LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA
              LEFT JOIN {{ ref('LOAD','LOADOPCUSERS') }} LOADOPCUSERS
                ON LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA.USER_ID = LOADOPCUSERS.IDENTITYUSERID
        name: SRC_STAGEOPC_PARTNER_DEVELOPMENT_EVENTS_GA3
        noLinkRefs: []
  name: STAGEOPC_PARTNER_DEVELOPMENT_EVENTS_REFORMAT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
