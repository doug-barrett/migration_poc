fileVersion: 1
id: d9a1bcc0-512d-4c42-ad5d-88894cf3e402
name: STAGEOPC_PARTNER_DEVELOPMENT_EVENTS_REFORMAT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cbde878b-1df3-4a8d-85fd-bd0adb58cf14
          stepCounter: d9a1bcc0-512d-4c42-ad5d-88894cf3e402
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ACCOUNT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9124180c-8567-4e5c-b77d-987a3c450276
          stepCounter: d9a1bcc0-512d-4c42-ad5d-88894cf3e402
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ee15480-eb4b-4d86-8800-b501900ae465
                stepCounter: dd5f8c75-44cb-4cf5-81b5-8c66f9aed54b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_PD_EVENTS_GA4.DATE),'YYYYMMDD') \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 30a02f03-0afd-4797-a11b-d73646cd3f76
          stepCounter: d9a1bcc0-512d-4c42-ad5d-88894cf3e402
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: GA_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ee15480-eb4b-4d86-8800-b501900ae465
                stepCounter: dd5f8c75-44cb-4cf5-81b5-8c66f9aed54b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_PD_EVENTS_GA4.DATE),'YYYYMMDD')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8285edde-2714-4829-b212-c131e5845e1d
          stepCounter: d9a1bcc0-512d-4c42-ad5d-88894cf3e402
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: USER ID
        name: GA_DIMENSION10
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b82208b5-ba1e-4a6d-90f2-7a6e8e7e0c4c
                stepCounter: dd5f8c75-44cb-4cf5-81b5-8c66f9aed54b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b865466f-a677-4a2d-8a04-ceeaa759a78d
          stepCounter: d9a1bcc0-512d-4c42-ad5d-88894cf3e402
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: USER NAME
        name: GA_DIMENSION11
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21f68dd2-1aa1-4538-a3ec-d6bdc4a25783
                stepCounter: 7ff10df4-fea2-4cfc-bb85-2391fa82b725
            transform: INITCAP(CONCAT(LOADOPCUSERS.FIRSTNAME,' ',LOADOPCUSERS.LASTNAME))
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: INITCAP(CONCAT(LOADOPCUSERS.FIRSTNAME,' ',LOADOPCUSERS.LASTNAME))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 717bc92d-0ff2-4722-9fc7-d56b9eeb9efd
          stepCounter: d9a1bcc0-512d-4c42-ad5d-88894cf3e402
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER ID - SUPPLIER NAME
        name: GA_DIMENSION12
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e1a36df-2583-4f87-b7da-a38da9f5e9f8
                stepCounter: dd5f8c75-44cb-4cf5-81b5-8c66f9aed54b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d91cc47-cd34-4378-9e25-6617ba8342e4
          stepCounter: d9a1bcc0-512d-4c42-ad5d-88894cf3e402
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER ID
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e1a36df-2583-4f87-b7da-a38da9f5e9f8
                stepCounter: dd5f8c75-44cb-4cf5-81b5-8c66f9aed54b
            transform: SPLIT_PART(LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA.USER_SUPPLIER,'-',1) \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: SPLIT_PART(LOADGA_OPC_PD_EVENTS_GA4.USER_SUPPLIER,'-',1)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 23c01e16-a96b-4aa3-b64d-83612d72c0b3
          stepCounter: d9a1bcc0-512d-4c42-ad5d-88894cf3e402
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER NAME
        name: SUPPLIER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e1a36df-2583-4f87-b7da-a38da9f5e9f8
                stepCounter: dd5f8c75-44cb-4cf5-81b5-8c66f9aed54b
            transform: INITCAP(SPLIT_PART(LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA.USER_SUPPLIER,'-',2)) \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: INITCAP(SPLIT_PART(LOADGA_OPC_PD_EVENTS_GA4.USER_SUPPLIER,'-',2)) \N \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a3669f0-5e0e-43e8-8b4f-a8fed3e62292
          stepCounter: d9a1bcc0-512d-4c42-ad5d-88894cf3e402
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: GA_EVENTCATEGORY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c515ff1-70d7-499a-abe9-42dc5f51222f
                stepCounter: dd5f8c75-44cb-4cf5-81b5-8c66f9aed54b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a0d6cf08-e599-4ba0-a7b8-5e47a7574eeb
          stepCounter: d9a1bcc0-512d-4c42-ad5d-88894cf3e402
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: GA_EVENTACTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e9b42b11-57bb-4325-9576-56c138ac93f5
                stepCounter: dd5f8c75-44cb-4cf5-81b5-8c66f9aed54b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f526fb6e-183f-4483-8c3f-72eed94c35d2
          stepCounter: d9a1bcc0-512d-4c42-ad5d-88894cf3e402
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: GA_EVENTLABEL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5e60962-d7d2-4b8f-965c-c7409d37edd3
                stepCounter: dd5f8c75-44cb-4cf5-81b5-8c66f9aed54b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 668a2986-6606-41a1-bd3f-4bc7763aabe6
          stepCounter: d9a1bcc0-512d-4c42-ad5d-88894cf3e402
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: GA_TOTALEVENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b16a3d4d-f971-4dc6-b701-3ff1b10e8044
                stepCounter: dd5f8c75-44cb-4cf5-81b5-8c66f9aed54b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0025de71-ccdf-48ad-9d9a-76b24ed8c432
          stepCounter: d9a1bcc0-512d-4c42-ad5d-88894cf3e402
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: GA_UNIQUEEVENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9ce9770e-f766-42ee-a41b-5cb3cdee8a44
                stepCounter: dd5f8c75-44cb-4cf5-81b5-8c66f9aed54b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4871175a-9325-44fa-9156-d95f41b0f0bb
          stepCounter: d9a1bcc0-512d-4c42-ad5d-88894cf3e402
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PROFILE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 10106a7a-c5ae-477b-9d47-67938c1435a0
          stepCounter: d9a1bcc0-512d-4c42-ad5d-88894cf3e402
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ee15480-eb4b-4d86-8800-b501900ae465
                stepCounter: dd5f8c75-44cb-4cf5-81b5-8c66f9aed54b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_PD_EVENTS_GA4.DATE),'YYYYMMDD')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c51cc08d-74db-4ea2-87ff-c714479c64b5
          stepCounter: d9a1bcc0-512d-4c42-ad5d-88894cf3e402
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: WEB_PROPERTY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 073e4354-0371-4220-9caf-eb58e885f8f0
          stepCounter: d9a1bcc0-512d-4c42-ad5d-88894cf3e402
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_BATCHED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9adf317d-637c-4894-bb1b-3dcc636d7b2d
                stepCounter: dd5f8c75-44cb-4cf5-81b5-8c66f9aed54b
            transform: TO_TIMESTAMP(LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA.__HEVO__LOADED_AT,3) \N \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_PD_EVENTS_GA4.__HEVO__LOADED_AT,3) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5158feda-bee8-4091-a95e-0a04824c6c73
          stepCounter: d9a1bcc0-512d-4c42-ad5d-88894cf3e402
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_EXTRACTED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0fc68746-0150-44e8-ac75-1e9ac7a598b5
                stepCounter: dd5f8c75-44cb-4cf5-81b5-8c66f9aed54b
            transform: TO_TIMESTAMP(LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA.__HEVO__INGESTED_AT,3)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_PD_EVENTS_GA4.__HEVO__INGESTED_AT,3) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 247ce7ed-d4c0-48ba-a4b5-4274402f37d6
          stepCounter: d9a1bcc0-512d-4c42-ad5d-88894cf3e402
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_RECEIVED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9adf317d-637c-4894-bb1b-3dcc636d7b2d
                stepCounter: dd5f8c75-44cb-4cf5-81b5-8c66f9aed54b
            transform: TO_TIMESTAMP(LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA.__HEVO__LOADED_AT,3) \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_PD_EVENTS_GA4.__HEVO__LOADED_AT,3)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6c02aaf-866b-4456-bbec-cc7c5cb4fc65
          stepCounter: d9a1bcc0-512d-4c42-ad5d-88894cf3e402
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: _SDC_RECORD_HASH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2be18f90-9706-41c5-9d41-3933db3cb69d
                stepCounter: dd5f8c75-44cb-4cf5-81b5-8c66f9aed54b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71c14d3f-f9c5-4447-a78c-90d29ede9249
          stepCounter: d9a1bcc0-512d-4c42-ad5d-88894cf3e402
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: _SDC_SEQUENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 232e3cd5-f021-4478-bb7b-0412ba1b541a
          stepCounter: d9a1bcc0-512d-4c42-ad5d-88894cf3e402
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: _SDC_TABLE_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aff01ef5-28f2-401d-8628-99f0e1307b9b
          stepCounter: d9a1bcc0-512d-4c42-ad5d-88894cf3e402
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: GA_HOSTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eb049998-7ee0-49a3-8fb7-732f521dde7d
                stepCounter: dd5f8c75-44cb-4cf5-81b5-8c66f9aed54b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf6ded7b-9094-45d3-ba60-c3f50cb3b513
          stepCounter: d9a1bcc0-512d-4c42-ad5d-88894cf3e402
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: THIS FIELD WILL BE USED TO FILTER WHICH OPC ENVIRONMENT THIS GA RECORD WILL BE SHOWN.
        name: FILTER_DATABASE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eb049998-7ee0-49a3-8fb7-732f521dde7d
                stepCounter: dd5f8c75-44cb-4cf5-81b5-8c66f9aed54b
            transform: CASE HOSTNAME \N WHEN 'OPC-SCUS-SVC-WEB-DEV.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_DEV' \N WHEN 'LOCALHOST' \N THEN 'OMNIACONNECT_DEV' \N WHEN'OPC-SCUS-SVC-WEB-QA.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA' \N WHEN 'OPC-SCUS-SVC-WEB-PROD-STAGING.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA' \N WHEN 'OPC-SCUS-SVC-WEB-UAT.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_UAT' \N WHEN 'OMNIACONNECT.OMNIAPARTNERS.COM' \N THEN 'OMNIACONNECT' \N ELSE NULL \NEND \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: CASE HOSTNAME \N WHEN 'OPC-SCUS-SVC-WEB-DEV.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_DEV' \N WHEN 'LOCALHOST' \N THEN 'OMNIACONNECT_DEV' \N WHEN'OPC-SCUS-SVC-WEB-QA.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA' \N WHEN 'OPC-SCUS-SVC-WEB-PROD-STAGING.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA' \N WHEN 'OPC-SCUS-SVC-WEB-UAT.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_UAT' \N WHEN 'OMNIACONNECT.OMNIAPARTNERS.COM' \N THEN 'OMNIACONNECT' \N ELSE NULL \NEND \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87ed41e3-bd4d-45f7-9b69-6ee9a050298a
          stepCounter: d9a1bcc0-512d-4c42-ad5d-88894cf3e402
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79c7bbdb-1fd5-4eda-a42a-220a5d390fef
                stepCounter: dd5f8c75-44cb-4cf5-81b5-8c66f9aed54b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9bed7f5c-00c9-4801-909e-1e3a04ec8751
          stepCounter: d9a1bcc0-512d-4c42-ad5d-88894cf3e402
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 428c44a2-096c-4cdc-bf50-420adc980fb2
                stepCounter: dd5f8c75-44cb-4cf5-81b5-8c66f9aed54b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6331e13e-6975-4aaa-825c-e4267391054d
          stepCounter: d9a1bcc0-512d-4c42-ad5d-88894cf3e402
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04fed5ad-9894-49a4-b476-4c164fb73c27
          stepCounter: d9a1bcc0-512d-4c42-ad5d-88894cf3e402
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA: dd5f8c75-44cb-4cf5-81b5-8c66f9aed54b
          LOADOPCUSERS: 7ff10df4-fea2-4cfc-bb85-2391fa82b725
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOADOPCUSERS
          - locationName: LOAD
            nodeName: LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA') }} LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA
              LEFT JOIN {{ ref('LOAD','LOADOPCUSERS') }} LOADOPCUSERS
                ON LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA.USER_ID = LOADOPCUSERS.IDENTITYUSERID
        name: SRC_STAGEOPC_PARTNER_DEVELOPMENT_EVENTS_GA3
        noLinkRefs: []
  name: STAGEOPC_PARTNER_DEVELOPMENT_EVENTS_REFORMAT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
