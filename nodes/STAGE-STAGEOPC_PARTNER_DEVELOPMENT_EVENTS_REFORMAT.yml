fileVersion: 1
id: e15f6fcb-3203-4aae-a04f-1a5940dfb24a
name: STAGEOPC_PARTNER_DEVELOPMENT_EVENTS_REFORMAT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a359424-9272-4afd-80f5-61f3c732fe4e
          stepCounter: e15f6fcb-3203-4aae-a04f-1a5940dfb24a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ACCOUNT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e93aa74e-dffd-4e24-8509-729c269974ae
          stepCounter: e15f6fcb-3203-4aae-a04f-1a5940dfb24a
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: af620e23-2e6a-4cd5-86ea-92fd391197d6
                stepCounter: daa10a88-9f56-4857-b883-b2e374844850
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_PD_EVENTS_GA4.DATE),'YYYYMMDD') \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc17de6b-1d38-4049-a3df-a4432b7e5564
          stepCounter: e15f6fcb-3203-4aae-a04f-1a5940dfb24a
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: GA_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: af620e23-2e6a-4cd5-86ea-92fd391197d6
                stepCounter: daa10a88-9f56-4857-b883-b2e374844850
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_PD_EVENTS_GA4.DATE),'YYYYMMDD')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db8c58fb-1933-42ca-95da-1ae388b4f609
          stepCounter: e15f6fcb-3203-4aae-a04f-1a5940dfb24a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: USER ID
        name: GA_DIMENSION10
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db6cf0d1-7222-4b91-89d1-496199f7f589
                stepCounter: daa10a88-9f56-4857-b883-b2e374844850
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1003ecc-0d3b-42a7-85be-f1fbbd40551c
          stepCounter: e15f6fcb-3203-4aae-a04f-1a5940dfb24a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: USER NAME
        name: GA_DIMENSION11
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 69a1ff9c-e85c-47f1-9907-758bf09d3550
                stepCounter: 49f597cd-01c4-4b23-b4e3-5dc2bc13c14c
            transform: INITCAP(CONCAT(LOADOPCUSERS.FIRSTNAME,' ',LOADOPCUSERS.LASTNAME))
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: INITCAP(CONCAT(LOADOPCUSERS.FIRSTNAME,' ',LOADOPCUSERS.LASTNAME))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fcfb2899-b30e-474c-ba2d-c3d552c24634
          stepCounter: e15f6fcb-3203-4aae-a04f-1a5940dfb24a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER ID - SUPPLIER NAME
        name: GA_DIMENSION12
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 348e1339-c119-4fec-8248-b434b641002d
                stepCounter: daa10a88-9f56-4857-b883-b2e374844850
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae767a13-88a1-42be-b84e-8a74fcdef455
          stepCounter: e15f6fcb-3203-4aae-a04f-1a5940dfb24a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER ID
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 348e1339-c119-4fec-8248-b434b641002d
                stepCounter: daa10a88-9f56-4857-b883-b2e374844850
            transform: SPLIT_PART(LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA.USER_SUPPLIER,'-',1) \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: SPLIT_PART(LOADGA_OPC_PD_EVENTS_GA4.USER_SUPPLIER,'-',1)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0d4b0ed-fee0-448e-b119-0466629d95ef
          stepCounter: e15f6fcb-3203-4aae-a04f-1a5940dfb24a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER NAME
        name: SUPPLIER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 348e1339-c119-4fec-8248-b434b641002d
                stepCounter: daa10a88-9f56-4857-b883-b2e374844850
            transform: INITCAP(SPLIT_PART(LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA.USER_SUPPLIER,'-',2)) \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: INITCAP(SPLIT_PART(LOADGA_OPC_PD_EVENTS_GA4.USER_SUPPLIER,'-',2)) \N \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88b0b7b6-9a9d-4ae0-b12d-9c885584b333
          stepCounter: e15f6fcb-3203-4aae-a04f-1a5940dfb24a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: GA_EVENTCATEGORY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 828a756b-5617-451a-a821-4ba0c20252ee
                stepCounter: daa10a88-9f56-4857-b883-b2e374844850
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a046a862-4802-48d7-9e7f-603161e7f15d
          stepCounter: e15f6fcb-3203-4aae-a04f-1a5940dfb24a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: GA_EVENTACTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0cdf95a3-c5ae-4a99-bf1b-458e6ed9bfaa
                stepCounter: daa10a88-9f56-4857-b883-b2e374844850
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 483c49a6-dfa2-471e-a61a-5db83d498f20
          stepCounter: e15f6fcb-3203-4aae-a04f-1a5940dfb24a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: GA_EVENTLABEL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea9f7d3d-df7d-4c9e-a1a1-4e4a4c206260
                stepCounter: daa10a88-9f56-4857-b883-b2e374844850
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4cb32a24-623d-410a-968c-7479e7b23cea
          stepCounter: e15f6fcb-3203-4aae-a04f-1a5940dfb24a
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: GA_TOTALEVENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c8acc62e-93f9-406b-9374-db7ed9691d79
                stepCounter: daa10a88-9f56-4857-b883-b2e374844850
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 095da2bb-e0b2-42fc-9681-bd7bfbe1ed27
          stepCounter: e15f6fcb-3203-4aae-a04f-1a5940dfb24a
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: GA_UNIQUEEVENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 04fa20d9-a222-438c-8b15-4b1ee94c1476
                stepCounter: daa10a88-9f56-4857-b883-b2e374844850
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af226321-910d-4635-b3e8-32090dcbea10
          stepCounter: e15f6fcb-3203-4aae-a04f-1a5940dfb24a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PROFILE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ccfdd40-e810-435d-932a-2232ef94dae9
          stepCounter: e15f6fcb-3203-4aae-a04f-1a5940dfb24a
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: af620e23-2e6a-4cd5-86ea-92fd391197d6
                stepCounter: daa10a88-9f56-4857-b883-b2e374844850
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_PD_EVENTS_GA4.DATE),'YYYYMMDD')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e01bf62-3fd2-444a-900e-572f24ea2bfe
          stepCounter: e15f6fcb-3203-4aae-a04f-1a5940dfb24a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: WEB_PROPERTY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fea8cd7e-9bf4-4cf2-9f06-fb92d6268d0e
          stepCounter: e15f6fcb-3203-4aae-a04f-1a5940dfb24a
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_BATCHED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce4b3fe9-f4ce-49ec-8719-467e7275a223
                stepCounter: daa10a88-9f56-4857-b883-b2e374844850
            transform: TO_TIMESTAMP(LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA.__HEVO__LOADED_AT,3) \N \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_PD_EVENTS_GA4.__HEVO__LOADED_AT,3) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8236c9c-fc44-480b-bff1-ab9cc78be7a6
          stepCounter: e15f6fcb-3203-4aae-a04f-1a5940dfb24a
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_EXTRACTED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c639dac-cb1a-4668-8fca-d7fe808536fe
                stepCounter: daa10a88-9f56-4857-b883-b2e374844850
            transform: TO_TIMESTAMP(LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA.__HEVO__INGESTED_AT,3)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_PD_EVENTS_GA4.__HEVO__INGESTED_AT,3) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b8f34a9-178c-4ef3-9793-5523c44ea019
          stepCounter: e15f6fcb-3203-4aae-a04f-1a5940dfb24a
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_RECEIVED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce4b3fe9-f4ce-49ec-8719-467e7275a223
                stepCounter: daa10a88-9f56-4857-b883-b2e374844850
            transform: TO_TIMESTAMP(LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA.__HEVO__LOADED_AT,3) \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_PD_EVENTS_GA4.__HEVO__LOADED_AT,3)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a98ff9b5-7bb6-4a39-a828-65ae7450d922
          stepCounter: e15f6fcb-3203-4aae-a04f-1a5940dfb24a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: _SDC_RECORD_HASH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd132ed4-0fee-4d31-ad17-0796a64af009
                stepCounter: daa10a88-9f56-4857-b883-b2e374844850
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5429548-9ce0-4e65-873b-ecac353ca607
          stepCounter: e15f6fcb-3203-4aae-a04f-1a5940dfb24a
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: _SDC_SEQUENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 58ab5b86-10d8-4bc5-ad09-05ec0ecb415a
          stepCounter: e15f6fcb-3203-4aae-a04f-1a5940dfb24a
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: _SDC_TABLE_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a0e6789-3831-42cf-b5dd-fc4bcdbcdc87
          stepCounter: e15f6fcb-3203-4aae-a04f-1a5940dfb24a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: GA_HOSTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7dd27003-50c1-40d1-87fb-0c8d15836917
                stepCounter: daa10a88-9f56-4857-b883-b2e374844850
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9da9894f-faea-4259-8852-c44a264687b8
          stepCounter: e15f6fcb-3203-4aae-a04f-1a5940dfb24a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: THIS FIELD WILL BE USED TO FILTER WHICH OPC ENVIRONMENT THIS GA RECORD WILL BE SHOWN.
        name: FILTER_DATABASE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7dd27003-50c1-40d1-87fb-0c8d15836917
                stepCounter: daa10a88-9f56-4857-b883-b2e374844850
            transform: CASE HOSTNAME \N WHEN 'OPC-SCUS-SVC-WEB-DEV.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_DEV' \N WHEN 'LOCALHOST' \N THEN 'OMNIACONNECT_DEV' \N WHEN'OPC-SCUS-SVC-WEB-QA.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA' \N WHEN 'OPC-SCUS-SVC-WEB-PROD-STAGING.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA' \N WHEN 'OPC-SCUS-SVC-WEB-UAT.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_UAT' \N WHEN 'OMNIACONNECT.OMNIAPARTNERS.COM' \N THEN 'OMNIACONNECT' \N ELSE NULL \NEND \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: CASE HOSTNAME \N WHEN 'OPC-SCUS-SVC-WEB-DEV.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_DEV' \N WHEN 'LOCALHOST' \N THEN 'OMNIACONNECT_DEV' \N WHEN'OPC-SCUS-SVC-WEB-QA.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA' \N WHEN 'OPC-SCUS-SVC-WEB-PROD-STAGING.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA' \N WHEN 'OPC-SCUS-SVC-WEB-UAT.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_UAT' \N WHEN 'OMNIACONNECT.OMNIAPARTNERS.COM' \N THEN 'OMNIACONNECT' \N ELSE NULL \NEND \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9db409ee-9542-48f2-8724-c4c9a2c24639
          stepCounter: e15f6fcb-3203-4aae-a04f-1a5940dfb24a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b7ab7ca-fae3-4f45-8f80-9f5cd6d60334
                stepCounter: daa10a88-9f56-4857-b883-b2e374844850
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fbe5890c-7d96-406d-8481-a76a07ace1f3
          stepCounter: e15f6fcb-3203-4aae-a04f-1a5940dfb24a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 99e58fbd-7671-4740-9704-a66a1bc5ee19
                stepCounter: daa10a88-9f56-4857-b883-b2e374844850
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 887aeeb5-3fdc-42c9-a338-0e8e08995529
          stepCounter: e15f6fcb-3203-4aae-a04f-1a5940dfb24a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ccd3bc90-85a5-42cc-ba84-d3757cc9f276
          stepCounter: e15f6fcb-3203-4aae-a04f-1a5940dfb24a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA: daa10a88-9f56-4857-b883-b2e374844850
          LOADOPCUSERS: 49f597cd-01c4-4b23-b4e3-5dc2bc13c14c
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOADOPCUSERS
          - locationName: LOAD
            nodeName: LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA') }} LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA
              LEFT JOIN {{ ref('LOAD','LOADOPCUSERS') }} LOADOPCUSERS
                ON LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA.USER_ID = LOADOPCUSERS.IDENTITYUSERID
        name: SRC_STAGEOPC_PARTNER_DEVELOPMENT_EVENTS_GA3
        noLinkRefs: []
  name: STAGEOPC_PARTNER_DEVELOPMENT_EVENTS_REFORMAT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
