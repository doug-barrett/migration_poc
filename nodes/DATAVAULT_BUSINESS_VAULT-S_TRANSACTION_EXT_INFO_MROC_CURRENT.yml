fileVersion: 1
id: 409b3894-6a31-4ef6-82ba-b469d0d760b9
name: S_TRANSACTION_EXT_INFO_MROC_CURRENT
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DATAVAULT_BUSINESS_VAULT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f429d577-394c-495a-96fb-ae1a5380a09f
          stepCounter: 409b3894-6a31-4ef6-82ba-b469d0d760b9
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: ""
        name: HK_H_TRANSACTION_INFO
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c3fba964-10da-49ba-90c1-a3b2012e294d
                stepCounter: c592eb3f-55b3-4732-b100-a07debae68cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2dd5c5ac-6434-4eaf-bb65-c11af19c91d1
          stepCounter: 409b3894-6a31-4ef6-82ba-b469d0d760b9
        config: {}
        dataType: VARCHAR(18)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: STORE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b71aa81-17a1-4898-9121-1b5a35901b65
                stepCounter: c592eb3f-55b3-4732-b100-a07debae68cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f96439ac-1463-4a3c-bd42-6ac6e3124442
          stepCounter: 409b3894-6a31-4ef6-82ba-b469d0d760b9
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: ORDER_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9526e5b3-e178-40e7-825e-cd1b365af653
                stepCounter: c592eb3f-55b3-4732-b100-a07debae68cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ed71c75-31e3-4ed2-8cf7-83ced10b03c0
          stepCounter: 409b3894-6a31-4ef6-82ba-b469d0d760b9
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: This field holds credit_info.ext_id and ext_info.id to allow easy joining.
        isBusinessKey: true
        name: INFO_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 95eca313-ba7e-4cc2-ab9a-15db515ca5f2
                stepCounter: c592eb3f-55b3-4732-b100-a07debae68cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7cfe3e42-8f8c-4f45-9e6d-110877eaa340
          stepCounter: 409b3894-6a31-4ef6-82ba-b469d0d760b9
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39ba4b60-3ceb-445c-8d35-b714bd435101
                stepCounter: c592eb3f-55b3-4732-b100-a07debae68cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c03441a2-59ae-41b1-a3d1-668faebfbd99
          stepCounter: 409b3894-6a31-4ef6-82ba-b469d0d760b9
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: TRANSACTION_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eb6e150c-5d3e-426b-9d4b-79de55e98ff1
                stepCounter: c592eb3f-55b3-4732-b100-a07debae68cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f4ba99fb-0bd5-4be9-850d-3fac6547b41f
          stepCounter: 409b3894-6a31-4ef6-82ba-b469d0d760b9
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: INTERVAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 992304bb-0bbc-4110-b548-a0468c6207a5
                stepCounter: c592eb3f-55b3-4732-b100-a07debae68cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7bdab974-4c2c-4e5e-ba71-0320ec5b6fb6
          stepCounter: 409b3894-6a31-4ef6-82ba-b469d0d760b9
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: TXN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3f6b503c-830f-417d-b267-36aab6711ce5
                stepCounter: c592eb3f-55b3-4732-b100-a07debae68cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0252c212-d934-45e0-bc89-d0bef1df89f2
          stepCounter: 409b3894-6a31-4ef6-82ba-b469d0d760b9
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: PAN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9135e16f-2adc-4b33-b9c7-6d7092d2ef51
                stepCounter: c592eb3f-55b3-4732-b100-a07debae68cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb1d95e7-c22e-4474-b3ca-d2fc59a0d912
          stepCounter: 409b3894-6a31-4ef6-82ba-b469d0d760b9
        config: {}
        dataType: DECIMAL(19,2)
        defaultValue: ""
        description: ""
        name: AMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 460e4638-db2c-4528-8927-3648b2236098
                stepCounter: c592eb3f-55b3-4732-b100-a07debae68cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 790ebcd5-4c13-40d0-9022-716c8bfce787
          stepCounter: 409b3894-6a31-4ef6-82ba-b469d0d760b9
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: USER_AGENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 68b4245e-5308-4e1a-a5f7-8a163d6e1d35
                stepCounter: c592eb3f-55b3-4732-b100-a07debae68cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 44992dd6-32a5-441c-8d89-3f479be0e816
          stepCounter: 409b3894-6a31-4ef6-82ba-b469d0d760b9
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: MERCH_IP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 98ed4b79-d206-4de6-8861-7fc030c0f88f
                stepCounter: c592eb3f-55b3-4732-b100-a07debae68cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91d1d9a6-50f0-49ab-bd5c-17d4f62d1daa
          stepCounter: 409b3894-6a31-4ef6-82ba-b469d0d760b9
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: CLIENT_IP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 71cfbc9a-b247-4d2c-bd7b-be28198d162c
                stepCounter: c592eb3f-55b3-4732-b100-a07debae68cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce3982fb-952a-4b27-b724-1977a22b3e5d
          stepCounter: 409b3894-6a31-4ef6-82ba-b469d0d760b9
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f4d71ca-679d-4a6f-b447-f3261b11f3a5
                stepCounter: c592eb3f-55b3-4732-b100-a07debae68cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4b3ed3c-5c0d-41d5-b16d-9abb1f65583e
          stepCounter: 409b3894-6a31-4ef6-82ba-b469d0d760b9
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: IN_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 914bfd0f-ca32-4e05-8cf0-7932e5e6292d
                stepCounter: c592eb3f-55b3-4732-b100-a07debae68cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b806a52-9275-47f0-b4ce-c9c27bc48502
          stepCounter: 409b3894-6a31-4ef6-82ba-b469d0d760b9
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: OUT_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e699bfd8-5c35-42c1-bb01-2e3150c20c14
                stepCounter: c592eb3f-55b3-4732-b100-a07debae68cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2293cd61-b791-4cef-8609-230058df99ba
          stepCounter: 409b3894-6a31-4ef6-82ba-b469d0d760b9
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: TIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 97665e90-d167-44b5-99d7-e10b1b782a3f
                stepCounter: c592eb3f-55b3-4732-b100-a07debae68cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4910377-a575-4297-ba25-2a8601dde591
          stepCounter: 409b3894-6a31-4ef6-82ba-b469d0d760b9
        config: {}
        dataType: VARCHAR(4096)
        defaultValue: ""
        description: ""
        name: SIG_COORDINATES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bbf0ab67-b950-47dc-829f-c9906e079f50
                stepCounter: c592eb3f-55b3-4732-b100-a07debae68cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 884d46f5-6ec9-4ce5-acbc-4ebb6125ec4d
          stepCounter: 409b3894-6a31-4ef6-82ba-b469d0d760b9
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: IS_LOOKEDUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d7e9472-46b0-4636-b670-dc3b1c27edd7
                stepCounter: c592eb3f-55b3-4732-b100-a07debae68cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f0031a1-56d9-43f9-9c9b-37c4ca5d2b54
          stepCounter: 409b3894-6a31-4ef6-82ba-b469d0d760b9
        config: {}
        dataType: VARCHAR(256)
        defaultValue: ""
        description: ""
        name: REF_URL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b614755-ddba-4181-952e-7671789556ac
                stepCounter: c592eb3f-55b3-4732-b100-a07debae68cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa5852f2-a779-4447-991e-d19412012f1e
          stepCounter: 409b3894-6a31-4ef6-82ba-b469d0d760b9
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: LOCATION_LATITUDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 407eb530-4886-4433-aea5-7d72a6722f97
                stepCounter: c592eb3f-55b3-4732-b100-a07debae68cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06cd9094-54d7-4f4c-9375-ca13199afddc
          stepCounter: 409b3894-6a31-4ef6-82ba-b469d0d760b9
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: LOCATION_LONGITUDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b150ba42-9bb8-4acf-a06a-dcac745164bf
                stepCounter: c592eb3f-55b3-4732-b100-a07debae68cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59230cbd-5500-4196-91eb-a927a54e36ca
          stepCounter: 409b3894-6a31-4ef6-82ba-b469d0d760b9
        config: {}
        dataType: NUMBER(19,4)
        defaultValue: ""
        description: The amount of tip from the transaction expressed in the original currency
        name: TIP_AMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02aa3966-9bbb-4866-86ed-36e14ced40a2
                stepCounter: c592eb3f-55b3-4732-b100-a07debae68cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: adad5425-5227-4a22-b2bc-fed6aab5cb29
          stepCounter: 409b3894-6a31-4ef6-82ba-b469d0d760b9
        config: {}
        dataType: DECIMAL(19,2)
        defaultValue: ""
        description: ""
        name: TAX_AMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e88e72c9-8e8d-4b09-a6ac-93397bffde33
                stepCounter: c592eb3f-55b3-4732-b100-a07debae68cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 111135fd-cde3-4239-9475-2448f9fe32cc
          stepCounter: 409b3894-6a31-4ef6-82ba-b469d0d760b9
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: CLERK_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e6c42dac-1937-4e9c-8b11-c9440e381525
                stepCounter: c592eb3f-55b3-4732-b100-a07debae68cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3598912b-6e7f-4c0c-8db4-911454d2d926
          stepCounter: 409b3894-6a31-4ef6-82ba-b469d0d760b9
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: CLERK_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91289b0a-7d1f-4213-a076-edeac4b433c6
                stepCounter: c592eb3f-55b3-4732-b100-a07debae68cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 181fca06-6bdb-4137-ad21-c305089c19da
          stepCounter: 409b3894-6a31-4ef6-82ba-b469d0d760b9
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: TAX_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: deee5855-3576-41be-b0e3-1f56e6898bfc
                stepCounter: c592eb3f-55b3-4732-b100-a07debae68cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9645420-cfd6-495d-885c-178267b87ce7
          stepCounter: 409b3894-6a31-4ef6-82ba-b469d0d760b9
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: APP_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 287b29ef-7d23-4730-9931-dc757c8293a2
                stepCounter: c592eb3f-55b3-4732-b100-a07debae68cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ebddd7e7-c1fb-4a65-a969-f8fb5c5dc20d
          stepCounter: 409b3894-6a31-4ef6-82ba-b469d0d760b9
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: CUSTOMER_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 992f3717-32fa-41b4-bffc-adeafdc6dfb3
                stepCounter: c592eb3f-55b3-4732-b100-a07debae68cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fbdccbaf-5ed3-45ca-b81d-4e18a0fa28e3
          stepCounter: 409b3894-6a31-4ef6-82ba-b469d0d760b9
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Unique Invoice Number
        name: INVOICE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1806ed5-9136-4d19-81b3-d6a05d06df9a
                stepCounter: c592eb3f-55b3-4732-b100-a07debae68cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8f8f919-5a17-485b-b6a2-9c8fa2f02fa5
          stepCounter: 409b3894-6a31-4ef6-82ba-b469d0d760b9
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: FILE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 606e9b1d-0fb8-4472-be80-946c4ee84bc4
                stepCounter: c592eb3f-55b3-4732-b100-a07debae68cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3cff4c40-8717-416b-bbf0-be4ea19f3798
          stepCounter: 409b3894-6a31-4ef6-82ba-b469d0d760b9
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: HOST_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78930d1f-fe51-4d43-9fbe-03ed0386c656
                stepCounter: c592eb3f-55b3-4732-b100-a07debae68cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81ff8aac-94a2-42f5-969a-131e04701608
          stepCounter: 409b3894-6a31-4ef6-82ba-b469d0d760b9
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: The changing hash
        name: DSS_CHANGE_HASH
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d0bd2329-8c04-48d5-b25d-4018edfb1fac
                stepCounter: c592eb3f-55b3-4732-b100-a07debae68cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a541882d-ef53-458d-b1d8-cac24732098b
          stepCounter: 409b3894-6a31-4ef6-82ba-b469d0d760b9
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Record source
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 496ae275-2771-4afb-a0f4-f5c2b29001cc
                stepCounter: c592eb3f-55b3-4732-b100-a07debae68cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d3f9194-bd8e-4f0b-b586-af03a10d0987
          stepCounter: 409b3894-6a31-4ef6-82ba-b469d0d760b9
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was loaded in the data vault
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 997aae35-7b29-48d0-88bc-07d4a042402c
                stepCounter: c592eb3f-55b3-4732-b100-a07debae68cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 30de8dcc-7f78-43b0-b223-17aae5894700
          stepCounter: 409b3894-6a31-4ef6-82ba-b469d0d760b9
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row started in the data vault
        isSystemStartDate: true
        name: DSS_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1fbe22eb-1d2c-4176-9e32-8bb0a247429e
                stepCounter: c592eb3f-55b3-4732-b100-a07debae68cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a797ec64-e5ca-4647-811c-b90e925db96c
          stepCounter: 409b3894-6a31-4ef6-82ba-b469d0d760b9
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: Version number of a business key in the data vault
        isSurrogateKey: true
        isSystemVersion: true
        name: DSS_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 06b03b0e-4afa-4026-a862-455d97f12837
                stepCounter: c592eb3f-55b3-4732-b100-a07debae68cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 356a59e3-8770-4844-ae7d-f2dd5de37efe
          stepCounter: 409b3894-6a31-4ef6-82ba-b469d0d760b9
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was inserted in the data vault
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa8eaee5-3746-44ff-992a-6c370073c428
                stepCounter: c592eb3f-55b3-4732-b100-a07debae68cb
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_TRANSACTION_EXT_INFO_MROC: c592eb3f-55b3-4732-b100-a07debae68cb
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATAVAULT_RAW_VAULT
            nodeName: S_TRANSACTION_EXT_INFO_MROC
        join:
          joinCondition: |-
            FROM {{ ref('DATAVAULT_RAW_VAULT','S_TRANSACTION_EXT_INFO_MROC') }} s_transaction_ext_info_mroc
             INNER JOIN (
                    SELECT hk_h_transaction_info,
                           MAX(dss_start_date) AS dss_start_date
                      FROM {{ ref('DATAVAULT_RAW_VAULT','S_TRANSACTION_EXT_INFO_MROC') }}
                     GROUP BY hk_h_transaction_info
                   ) curr
                ON curr.hk_h_transaction_info = s_transaction_ext_info_mroc.hk_h_transaction_info
               AND curr.dss_start_date = s_transaction_ext_info_mroc.dss_start_date
        name: S_TRANSACTION_EXT_INFO_MROC_CURRENT
        noLinkRefs: []
  name: S_TRANSACTION_EXT_INFO_MROC_CURRENT
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
