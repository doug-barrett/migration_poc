fileVersion: 1
id: f584a610-5628-456a-a45f-eac66678a76e
name: S_NEEDS_ASSESSMENT_NASC_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5a5bca8-5b53-48e5-9a5d-43330397db67
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: CONTACT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8a149b5d-d737-46c9-b129-229c5b8c76c6
                stepCounter: f41782da-6bde-4dc1-b387-af0a584341ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 743442aa-a5a5-484e-bc0d-a1bb73b97078
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: CONTACT_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'NA'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b56e376-8504-4ef2-bd9c-96035e0e8eb9
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: TASK_REQUEST_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05b14e6d-26f3-4989-b72e-e48907ba86e7
                stepCounter: f41782da-6bde-4dc1-b387-af0a584341ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1fa1901-710e-4b3e-8c96-559f6cb28cd9
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: patient_programme id
        name: PROGRAMME_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75cc0136-6a2c-4dd6-b205-b957e8316762
                stepCounter: f41782da-6bde-4dc1-b387-af0a584341ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 865d01c5-a819-44e5-adae-016332b0c111
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: patient_programme_status
        name: PROGRAMME_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6cde09f1-6c33-4e0b-9d23-6cc5da60e86d
                stepCounter: f41782da-6bde-4dc1-b387-af0a584341ab
            transform: IFNULL(s_needs_assessment_NASC_v.programme_status,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b83539f9-858b-450a-9cc0-f5f046995825
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24058c0a-638c-4246-bc0d-451016425831
                stepCounter: f41782da-6bde-4dc1-b387-af0a584341ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b7fefe7-5283-4090-912d-bad78ceee80b
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: TASK_TYPE_DESC
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f4ab537b-ea2b-46be-bf9d-f3ba961b7c6c
                stepCounter: f41782da-6bde-4dc1-b387-af0a584341ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6df705c5-bce4-4aa5-9ef1-2a85fc39289d
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: HEALTH_ORG_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f25bb093-4bfc-41f7-b25c-6809e6e2acae
                stepCounter: f41782da-6bde-4dc1-b387-af0a584341ab
            transform: |-
              --CASE WHEN ISNUMERIC(s_needs_assessment_NASC_v.health_org_id) = 1
               --     AND LEN(s_needs_assessment_NASC_v.health_org_id) <= 10
               --     THEN s_needs_assessment_NASC_v.health_org_id ELSE NULL END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27fe06ea-e657-43a5-a88b-262d9cb5b3ce
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SEEN_BY_CLINICIAN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 612b6a04-74f4-4049-84b9-d60a6d82db50
                stepCounter: f41782da-6bde-4dc1-b387-af0a584341ab
            transform: |-
              CASE WHEN ISNUMERIC(s_needs_assessment_NASC_v.seen_by_clinician_id) = 0 THEN s_needs_assessment_NASC_v.seen_by_clinician_id
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f93cf72c-5ae3-45ce-8645-39da33b020c0
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 612b6a04-74f4-4049-84b9-d60a6d82db50
                stepCounter: f41782da-6bde-4dc1-b387-af0a584341ab
            transform: |-
              CASE WHEN ISNUMERIC(s_needs_assessment_NASC_v.seen_by_clinician_id) = 1 THEN s_needs_assessment_NASC_v.seen_by_clinician_id
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa708a27-f6c0-42fc-b15c-e72d715067eb
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b8759433-bf02-45aa-b26c-47ad563607ce
                stepCounter: f41782da-6bde-4dc1-b387-af0a584341ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc623566-1691-4f77-a604-7f14ea11d481
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: HOSPITAL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a3bbb39-a719-4543-9ba5-dee5d1399447
                stepCounter: f41782da-6bde-4dc1-b387-af0a584341ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 139d5753-dbab-4e53-8e81-4a7eaef94af8
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PROVIDER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2b9154fb-733b-4f41-8166-108792023234
                stepCounter: f41782da-6bde-4dc1-b387-af0a584341ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8ad8577-fa52-4a93-832e-052ad4b7e16b
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PROGRAMME_ROLE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 25050fee-46ce-4305-b450-7d1daff4bf65
                stepCounter: f41782da-6bde-4dc1-b387-af0a584341ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b4f2d5e-bb4a-4e13-b92d-de2cecfe8560
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PROVIDER_ROLE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2a9af181-3dbb-4dca-95b0-561644d90393
                stepCounter: f41782da-6bde-4dc1-b387-af0a584341ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b17ea66a-cfc5-4a03-a815-9c14396cfcb9
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: DEPARTMENT_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6832bc7f-17b1-43bb-b663-6e83c97cff56
                stepCounter: f41782da-6bde-4dc1-b387-af0a584341ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2cdcae8c-79ee-4ab7-9fde-0824c5e87227
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SERVICE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e51b415-8b4a-48ec-91ff-18cfe3df6836
                stepCounter: f41782da-6bde-4dc1-b387-af0a584341ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9065bedf-9b21-49ad-9889-a49bbf625088
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: TASK_REQUEST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 54108c29-a5a9-4889-99e2-b3ff042f4b65
                stepCounter: f41782da-6bde-4dc1-b387-af0a584341ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dd739ffd-6732-4fe7-a492-a6e9c7d12bde
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: EPISODE_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 73d58f03-2872-49bf-8ce4-1db16a7b52b1
                stepCounter: f41782da-6bde-4dc1-b387-af0a584341ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8fa18f47-0bd2-454b-9910-38d736a4347e
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: CSC_CARD_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 363704cf-f4d7-467e-b462-0e993f7d6992
                stepCounter: f41782da-6bde-4dc1-b387-af0a584341ab
            transform: |-
              CASE s_needs_assessment_NASC_v.csc_card
                          WHEN 'Yes'                         THEN 'Y'
                          WHEN 'No'                          THEN 'N'
                          ELSE ''
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32c8da2a-1a84-46f9-82bf-6067bd6bfad4
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: LIVING_SITUATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e028a1b-fac2-42db-9ebd-e013ed1ee4e5
                stepCounter: f41782da-6bde-4dc1-b387-af0a584341ab
            transform: IFNULL(s_needs_assessment_NASC_v.living_situation,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d41db2a0-1164-40d6-95c2-aac38ef50872
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: WHERE_THEY_LIVE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f313bcf1-66e3-486c-92a0-7dc440d3f300
                stepCounter: f41782da-6bde-4dc1-b387-af0a584341ab
            transform: IFNULL(s_needs_assessment_NASC_v.where_they_live,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da4f7da4-b076-417d-97a3-efeadbb779c4
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SPA_BAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76976e19-2b4d-4e12-8b23-fa20ef6787a9
                stepCounter: f41782da-6bde-4dc1-b387-af0a584341ab
            transform: IFNULL(s_needs_assessment_NASC_v.SPA_band,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7690f420-0667-424b-aa24-c354462689dd
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ASSESSMENT_LOCATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc64ac9a-edda-49d1-8616-775572481ea4
                stepCounter: f41782da-6bde-4dc1-b387-af0a584341ab
            transform: IFNULL(s_needs_assessment_NASC_v.assessment_location,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d624fd8-8a52-4e06-9aef-cf353f89c830
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: OUTCOME_ACTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1462ca76-777c-4c27-ae1e-d37fa94ecab2
                stepCounter: f41782da-6bde-4dc1-b387-af0a584341ab
            transform: IFNULL(s_needs_assessment_NASC_v.outcome_action,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 00197cf2-ec84-43e4-b38c-be913df6842a
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: EXIT_REASON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 26c3f2ec-9e45-4db6-be72-de2f085cf854
                stepCounter: f41782da-6bde-4dc1-b387-af0a584341ab
            transform: IFNULL(s_needs_assessment_NASC_v.exit_reason,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f87ffd72-0be4-41d6-b890-34c3978f74d0
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: EXIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb0123e1-80d4-4ae3-8ae6-2c5fbce00f72
                stepCounter: f41782da-6bde-4dc1-b387-af0a584341ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b71529f3-b1e3-42ed-a49c-7e2c2d19682e
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SCID_MIGRATED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e9a4da46-7158-4157-8e8d-2e6b57a6b356
                stepCounter: f41782da-6bde-4dc1-b387-af0a584341ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a6197b1-e926-47ce-9518-ce6b04bf8316
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ASSESSMENT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1288ad67-1e5f-4101-a115-5662452a6859
                stepCounter: f41782da-6bde-4dc1-b387-af0a584341ab
            transform: IFNULL(s_needs_assessment_NASC_v.assessment_type,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe358716-3bbe-4528-95c6-bdef18655fb5
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ASSESSMENT_COMPLETED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4cc82399-70d7-446f-b535-5c9bb00af94e
                stepCounter: f41782da-6bde-4dc1-b387-af0a584341ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f5a5406-3316-426c-bd08-adc076d23f50
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: TRANSFER_NASC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a99752f-42c5-461f-a295-aa67be9da974
                stepCounter: f41782da-6bde-4dc1-b387-af0a584341ab
            transform: IFNULL(s_needs_assessment_NASC_v.transfer_NASC,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42e01970-f0c7-4ef0-9a3a-b1654f4511b4
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: TRANSFER_DHB
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c3a71e83-b765-4f34-981e-3bb950a1db9a
                stepCounter: f41782da-6bde-4dc1-b387-af0a584341ab
            transform: IFNULL(s_needs_assessment_NASC_v.transfer_DHB,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c03c554-7636-4dfc-a15c-d904cccb0331
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: TRANSFER_REASON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ac25e05-93ec-49ff-b3a0-f7cacdbd5efd
                stepCounter: f41782da-6bde-4dc1-b387-af0a584341ab
            transform: IFNULL(s_needs_assessment_NASC_v.transfer_reason,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a99019b1-6ed8-4c7a-8d44-35ebfe4ebe1f
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: TRANSFER_OUT_RESIDENTIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c6edd55-f2ff-46a1-9f3e-dfcb41150c72
                stepCounter: f41782da-6bde-4dc1-b387-af0a584341ab
            transform: IFNULL(s_needs_assessment_NASC_v.transfer_out_residential,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd25267b-712f-4017-9f6b-e2c236c23556
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: TRANSFER_OUT_DHB
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 70873ce4-64af-4992-bad7-846b7f5fcd82
                stepCounter: f41782da-6bde-4dc1-b387-af0a584341ab
            transform: IFNULL(s_needs_assessment_NASC_v.transfer_out_DHB,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d174b09f-7860-489d-8ce3-6976934be6a9
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: OBSERVATION_REPORT_DUE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 946b0735-da07-435f-9fb3-29a77cf7f68f
                stepCounter: f41782da-6bde-4dc1-b387-af0a584341ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 363469b0-543e-47e3-92d0-b3d72f39392e
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: COMPLETION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d7bf9946-625b-4b72-ab07-66e0e72b22a7
                stepCounter: f41782da-6bde-4dc1-b387-af0a584341ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81500a58-4e65-41c2-8b58-d32853606a48
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: OBSERVATION_REPORT_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ccf1cec-d6cf-45e4-8a02-6d8eaa6385eb
                stepCounter: f41782da-6bde-4dc1-b387-af0a584341ab
            transform: IFNULL(s_needs_assessment_NASC_v.observation_report_status,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6b32733-2c01-4d5c-a4d9-080eeab7f011
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_ASSESSMENT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 54108c29-a5a9-4889-99e2-b3ff042f4b65
                stepCounter: f41782da-6bde-4dc1-b387-af0a584341ab
            transform: ROW_NUMBER() OVER (PARTITION BY s_needs_assessment_NASC_v.patient_NHI ORDER BY s_needs_assessment_NASC_v.task_request_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bea2b352-cc1d-4010-a874-ea71a99da4bb
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_ASSESSMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24058c0a-638c-4246-bc0d-451016425831
                stepCounter: f41782da-6bde-4dc1-b387-af0a584341ab
            transform: COUNT(1) OVER (PARTITION BY s_needs_assessment_NASC_v.patient_NHI)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cadcdd43-1035-441b-887c-76a310e43837
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_ASSESSMENT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 54108c29-a5a9-4889-99e2-b3ff042f4b65
                stepCounter: f41782da-6bde-4dc1-b387-af0a584341ab
            transform: ROW_NUMBER() OVER (PARTITION BY s_needs_assessment_NASC_v.referral_encounter_id ORDER BY s_needs_assessment_NASC_v.task_request_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 777f7d7d-48d9-4a23-9b4b-81cb0bf55c30
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_ASSESSMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b8759433-bf02-45aa-b26c-47ad563607ce
                stepCounter: f41782da-6bde-4dc1-b387-af0a584341ab
            transform: COUNT(1) OVER (PARTITION BY s_needs_assessment_NASC_v.referral_encounter_id)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a82f238f-3be3-432c-afdc-1c9924ea0a05
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7eea13ea-8666-4784-90ef-69c512515bd2
                stepCounter: f41782da-6bde-4dc1-b387-af0a584341ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 313a6926-2269-45ab-82c0-59b371aef3de
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9aef3f8-241b-4874-bd41-18f019452bee
                stepCounter: f41782da-6bde-4dc1-b387-af0a584341ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 62f6640f-2f03-41a1-81d9-943fa8ead361
          stepCounter: f584a610-5628-456a-a45f-eac66678a76e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_NEEDS_ASSESSMENT_NASC_V
        join:
          joinCondition: FROM s_needs_assessment_NASC_v
        name: S_NEEDS_ASSESSMENT_NASC_10
        noLinkRefs: []
  name: S_NEEDS_ASSESSMENT_NASC_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
