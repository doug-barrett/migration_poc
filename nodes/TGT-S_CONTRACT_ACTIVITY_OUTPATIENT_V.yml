fileVersion: 1
id: 449a0e36-76ac-4997-9179-3e0c0278dc81
name: S_CONTRACT_ACTIVITY_OUTPATIENT_V
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a33f8b59-f4f7-4510-878f-7e88983e06e0
          stepCounter: 449a0e36-76ac-4997-9179-3e0c0278dc81
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Generated Column for join to correct contract line in the Price Volume Schedule
        name: PROVIDER_FUNDER_SPLIT
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: "'Provider'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5fee4caa-18d0-4522-bb3d-4333d8b93e58
          stepCounter: 449a0e36-76ac-4997-9179-3e0c0278dc81
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PUC_MAP_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed6224f6-6c65-430d-9881-1959549c7f2a
                stepCounter: 93c63ba9-752b-4aed-8129-37fe9d2a3fea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2be47c1f-acf6-4c71-9962-ef3626824900
          stepCounter: 449a0e36-76ac-4997-9179-3e0c0278dc81
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: RESPONSIBILITY_CENTRE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b02e76f3-d5b4-4a68-a6f0-b3e59c28b150
                stepCounter: 93c63ba9-752b-4aed-8129-37fe9d2a3fea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7fcba7ff-8403-4e71-8122-6f9d8408f785
          stepCounter: 449a0e36-76ac-4997-9179-3e0c0278dc81
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: health_specialty_code
        name: HEALTH_SPECIALTY_CODE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2112a3ad-b545-44a5-9b11-d7c8124d6706
                stepCounter: 93c63ba9-752b-4aed-8129-37fe9d2a3fea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8463d7d-b0ef-4cb5-820f-8beb08cf227c
          stepCounter: 449a0e36-76ac-4997-9179-3e0c0278dc81
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: facility_code
        name: FACILITY_CODE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d5ed324f-abd8-4c62-b2d5-a219bc16ef76
                stepCounter: 93c63ba9-752b-4aed-8129-37fe9d2a3fea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69b9af2f-4c9e-40a3-a466-d506ce8e1084
          stepCounter: 449a0e36-76ac-4997-9179-3e0c0278dc81
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REPORTING_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27087aa5-db4a-4a7b-9423-13b00acb608f
                stepCounter: 93c63ba9-752b-4aed-8129-37fe9d2a3fea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1abfe951-dc5c-4686-ad5d-f1c7439b224b
          stepCounter: 449a0e36-76ac-4997-9179-3e0c0278dc81
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SOURCE_ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d44fb55-a2fa-4710-aad4-2d1d932b2ebf
                stepCounter: 93c63ba9-752b-4aed-8129-37fe9d2a3fea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bec60697-224d-406e-8f85-46d1eb3c73b9
          stepCounter: 449a0e36-76ac-4997-9179-3e0c0278dc81
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FUNDED_EVENT_ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d44fb55-a2fa-4710-aad4-2d1d932b2ebf
                stepCounter: 93c63ba9-752b-4aed-8129-37fe9d2a3fea
            transform: IFNULL(ds_outpatient_appointment_30.IP_event_encounter_id, ds_outpatient_appointment_30.outpatient_appointment_encounter_id)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb5ff797-408e-4a77-b712-2ef2d005a274
          stepCounter: 449a0e36-76ac-4997-9179-3e0c0278dc81
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c3fa587f-a0bd-412a-8d5e-5ae6947a6220
                stepCounter: 93c63ba9-752b-4aed-8129-37fe9d2a3fea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee16b6a6-2804-4a27-b2de-d7d9f5b6e697
          stepCounter: 449a0e36-76ac-4997-9179-3e0c0278dc81
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 81684bd0-b3cb-4067-af3c-101f6e4d67a7
                stepCounter: 93c63ba9-752b-4aed-8129-37fe9d2a3fea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5364e23-9938-42b9-b76d-8c14c7153f5b
          stepCounter: 449a0e36-76ac-4997-9179-3e0c0278dc81
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_outpatient_appointment_30.patient_reference_no=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 220685d2-ff9c-414e-9c4b-a84358a89478
                stepCounter: 93c63ba9-752b-4aed-8129-37fe9d2a3fea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 546cf575-8dde-4e4f-814e-9a16374d075b
          stepCounter: 449a0e36-76ac-4997-9179-3e0c0278dc81
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMIN_CATEGORY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c277e7c1-3385-4da1-bc7d-07fd1676eac7
                stepCounter: 93c63ba9-752b-4aed-8129-37fe9d2a3fea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c757957-97ae-4c3f-9ca6-45715cfd8364
          stepCounter: 449a0e36-76ac-4997-9179-3e0c0278dc81
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: CONTRACT_ADMIT_TYPE
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN IFNULL(purchase_unit_code,'N') = 'OT05001' THEN CASE WHEN primary_procedure_code = 'HB01' THEN 'ELECTIVE' WHEN IFNULL(primary_procedure_code,'N') = 'N' THEN 'ACUTE' ELSE 'OTHER' END
                          ELSE 'OTHER'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c3c60eb-6b9e-4f6e-86fb-c1201cb5c200
          stepCounter: 449a0e36-76ac-4997-9179-3e0c0278dc81
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: ADMISSION_TYPE_CODE
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ba2e9c5-2c51-4a7f-b4a4-3f11f942dfa3
          stepCounter: 449a0e36-76ac-4997-9179-3e0c0278dc81
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: IDF_CLASS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b013aae2-00f1-4e2e-89ce-cac5b973a1bd
                stepCounter: 330ad0aa-b8b1-4da9-ab37-b4fe8f889452
            transform: |-
              CASE WHEN dim_domicile.IDF_class = 'Unknown' THEN 'Non-IDF'
                          ELSE dim_domicile.IDF_class
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aeff05eb-990a-47a2-a260-1ff6f88d717b
          stepCounter: 449a0e36-76ac-4997-9179-3e0c0278dc81
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DOMICILE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 35a2b1db-32ff-4e26-bea6-867b11ef9c78
                stepCounter: 330ad0aa-b8b1-4da9-ab37-b4fe8f889452
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9090039-4bad-4234-878c-1175c405df75
          stepCounter: 449a0e36-76ac-4997-9179-3e0c0278dc81
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 57803281-d7d5-4c93-8b3b-2918a1fc1ca1
                stepCounter: 93c63ba9-752b-4aed-8129-37fe9d2a3fea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17c5583e-eaeb-42c3-a94a-462af2242931
          stepCounter: 449a0e36-76ac-4997-9179-3e0c0278dc81
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Excludes any DNAs and multiplies appointments by any RVU to give the purchase unit volume submitted to NNPAC
        name: PURCHASE_UNIT_VOLUME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 447f939a-a2aa-42af-b331-4cf925bfb371
                stepCounter: 93c63ba9-752b-4aed-8129-37fe9d2a3fea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 83c7deee-3bdc-414f-af03-cef1c3ef53d1
          stepCounter: 449a0e36-76ac-4997-9179-3e0c0278dc81
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ESTIMATED_PURCHASE_UNIT_VOLUME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 447f939a-a2aa-42af-b331-4cf925bfb371
                stepCounter: 93c63ba9-752b-4aed-8129-37fe9d2a3fea
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 778ea9b1-7344-448f-a086-1aebf128dcc1
          stepCounter: 449a0e36-76ac-4997-9179-3e0c0278dc81
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AGE_GROUP_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72e2a3f0-e1c4-47aa-8b2b-56e09a7c6953
                stepCounter: 93c63ba9-752b-4aed-8129-37fe9d2a3fea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4cb4a114-11ab-4445-8307-fc1090926f39
          stepCounter: 449a0e36-76ac-4997-9179-3e0c0278dc81
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_PLANNED_CARE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 98cbf775-e6b4-4da8-bb92-bc7c0927488f
                stepCounter: 93c63ba9-752b-4aed-8129-37fe9d2a3fea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce5d61c3-905b-413c-b4c1-b8517514b715
          stepCounter: 449a0e36-76ac-4997-9179-3e0c0278dc81
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: DRG_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2231a633-fc54-42b4-8bcd-5997570486dc
          stepCounter: 449a0e36-76ac-4997-9179-3e0c0278dc81
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: outpatient appointment clinician reference no from iPM
        name: CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b5d195e4-d36b-4a4a-9f73-90627446c6e1
                stepCounter: 93c63ba9-752b-4aed-8129-37fe9d2a3fea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 299ab47f-a358-4ae0-98c7-7c4dd3a1a12d
          stepCounter: 449a0e36-76ac-4997-9179-3e0c0278dc81
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: SOURCE_SYSTEM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "'iPM-OP'"
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DS_OUTPATIENT_APPOINTMENT_30: 93c63ba9-752b-4aed-8129-37fe9d2a3fea
          DIM_DOMICILE: 330ad0aa-b8b1-4da9-ab37-b4fe8f889452
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_OUTPATIENT_APPOINTMENT_30
          - locationName: TGT
            nodeName: DIM_DOMICILE
        join:
          joinCondition: |-
            FROM {{ ref('TGT','DS_OUTPATIENT_APPOINTMENT_30') }}
              JOIN {{ ref('TGT','DIM_DOMICILE') }}
                ON ds_outpatient_appointment_30.dim_domicile_key = dim_domicile.dim_domicile_key
             WHERE 1=1
               AND appointment_start_date <=cast(getdate() AS date)
               AND appointment_status_type_code ='A'
        name: S_CONTRACT_ACTIVITY_OUTPATIENT_V
        noLinkRefs: []
  name: S_CONTRACT_ACTIVITY_OUTPATIENT_V
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
