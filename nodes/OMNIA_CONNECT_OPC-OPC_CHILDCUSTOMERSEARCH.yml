fileVersion: 1
id: 0764d929-2cf8-43a9-bcbd-42b231d7fecd
name: OPC_CHILDCUSTOMERSEARCH
operation:
  config:
    distinct: true
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: OMNIA_CONNECT_OPC
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a82d991-c14f-42a3-b2ed-8f55fdb7fc92
          stepCounter: 0764d929-2cf8-43a9-bcbd-42b231d7fecd
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE HIGHEST-LEVEL OF HIERARCHY FOR AN ACCOUNT
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 45b1e391-1f57-4616-bfb8-5a95e8fa0bf7
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d52e9d5-fb2a-44b6-897c-956a60d3d72b
          stepCounter: 0764d929-2cf8-43a9-bcbd-42b231d7fecd
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE UNIQUE IDENTIFIER FOR AN ACCOUNT
        isBusinessKey: true
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 45b8ca31-a3c4-4854-84ab-6dce26144004
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24c38552-be71-40d0-b006-22775c65e677
          stepCounter: 0764d929-2cf8-43a9-bcbd-42b231d7fecd
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE SAME VALUE AS THE ACCOUNTNAME COLUMN, BUT HAS BEEN RUN THROUGH A PROPERCASE FUNCTION
        name: DISPLAYACCOUNTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09d28d69-519f-447f-8b65-4727420cafdf
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 35f34720-2679-4102-b6b9-012ed9446553
          stepCounter: 0764d929-2cf8-43a9-bcbd-42b231d7fecd
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE TYPE, OR CLASSIFICATION, OF THE ACCOUNT
        name: ACCOUNTTYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22d869e0-abeb-4bbe-bca9-75515b13b847
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e76f9b37-0729-4410-bebe-80eddbe14164
          stepCounter: 0764d929-2cf8-43a9-bcbd-42b231d7fecd
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: STREET ADDRESS LINE 1 MATCHED WITH USPS.
        name: ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 34dd0325-bdf8-464c-8a59-b5271d3577f5
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77b5877d-ddd4-4359-b182-f7707ab9150f
          stepCounter: 0764d929-2cf8-43a9-bcbd-42b231d7fecd
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: STREET ADDRESS LINE 2 MATCHED WITH USPS.
        name: ADDRESS2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0523e6b9-4784-4ede-b143-736ccd7b4582
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88ae3670-e324-40c6-9d4e-3645555d9a34
          stepCounter: 0764d929-2cf8-43a9-bcbd-42b231d7fecd
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ADDRESS CITY MATCHED WITH USPS.
        name: CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 813084ef-8c40-446d-a99e-4e1363c6c4c6
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0865f784-6198-426d-99fc-9479f589e976
          stepCounter: 0764d929-2cf8-43a9-bcbd-42b231d7fecd
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ADDRESS COUNTY MATCHED WITH USPS.
        name: COUNTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb6c2e78-61ef-40d8-91c0-59f55c815a00
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d478f44-3e93-4fff-8452-e45b2edf7157
          stepCounter: 0764d929-2cf8-43a9-bcbd-42b231d7fecd
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ADDRESS STATE MATCHED WITH USPS.
        name: STATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 06ea2b65-4762-4098-a147-c6a7b2712887
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd30a37d-ab40-4877-901b-b8788d835b75
          stepCounter: 0764d929-2cf8-43a9-bcbd-42b231d7fecd
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ADDRESS POSTALCODE MATCHED WITH USPS.
        name: ZIPCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 85d681a7-0d4c-4f6d-bec9-29971837b8f5
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 73f4565a-b8f7-4dab-b102-372e7bf3cc36
          stepCounter: 0764d929-2cf8-43a9-bcbd-42b231d7fecd
        config: {}
        dataType: DATE
        defaultValue: ""
        description: IS THE DATE THAT THE ACCOUNT EITHER REGISTERED OR, IN THE EVENT WE DO NOT HAVE A REGISTRATION, WILL BE THE DATE OF FIRST PURCHASE
        name: STARTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 274e66f2-2cd0-415f-8e4f-e516950eaec3
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70b0edc2-1d9b-436e-813f-ab33197e198c
          stepCounter: 0764d929-2cf8-43a9-bcbd-42b231d7fecd
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: STRATEGIC ACCOUNT REASON
        name: TIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 15ff087f-90cc-4dad-bdaa-eb6d3d7f8ac0
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: COALESCE(OPC_ACCOUNT.STRATEGICACCOUNTREASON,OPC_ACCOUNT.MEMBERSEGMENT)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 120b7a13-b209-4938-9e01-70865b8cecda
          stepCounter: 0764d929-2cf8-43a9-bcbd-42b231d7fecd
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE 9-DIGIT EIN (EMPLOYER IDENTIFICATION NUMBER) FOR THE ACCOUNT
        name: FEDERALTAXID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ac658b1-7ee0-4ab7-bf38-4a245f5e0a90
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ae9d975-d5d8-4e31-84ac-bd6afbdf6d9c
          stepCounter: 0764d929-2cf8-43a9-bcbd-42b231d7fecd
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE PRIMARY URL FOR THE ACCOUNT
        name: WEBSITE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d1c6f580-97a8-447a-83a3-cabcd6c439ff
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b0cf307-1547-44fa-8088-897b79692b17
          stepCounter: 0764d929-2cf8-43a9-bcbd-42b231d7fecd
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: LONGITUDE
        name: LON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 399c45c4-cb76-4b4b-a85d-02f692004d53
                stepCounter: d0f4be43-15dd-4e34-9b37-62ad9deca642
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 177fe9b0-b270-429f-9321-4eedd633d5ac
          stepCounter: 0764d929-2cf8-43a9-bcbd-42b231d7fecd
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: LATITUDE
        name: LAT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 193d3c29-ca5e-4e3b-8ebb-29e1b2489015
                stepCounter: d0f4be43-15dd-4e34-9b37-62ad9deca642
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b4602e2-e6f9-43ea-802a-fc62ba64b8b8
          stepCounter: 0764d929-2cf8-43a9-bcbd-42b231d7fecd
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: METROAREANAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b58e99f3-cb2d-4476-bed9-6c3eec7faf4f
                stepCounter: d0f4be43-15dd-4e34-9b37-62ad9deca642
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac3e9b0b-8419-4c94-891d-1c3d7831cddf
          stepCounter: 0764d929-2cf8-43a9-bcbd-42b231d7fecd
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CUSTOMER_SIZE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7208171-d75f-4fab-bace-2ec38fa672b8
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 30f1f1de-60d1-45eb-a2ed-fe9626afd3ed
          stepCounter: 0764d929-2cf8-43a9-bcbd-42b231d7fecd
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CUSTOMER_SIZE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c307adac-b53a-4806-8372-085884d8172b
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f246bbca-e5da-4418-b6c6-8e10b1ea428e
          stepCounter: 0764d929-2cf8-43a9-bcbd-42b231d7fecd
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: CUSTOMERSIZEBAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 600bb171-27fc-4f2f-86b6-a88ddfd468b3
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: IFNULL(OPC_ACCOUNT.CUSTOMER_SIZE_BAND,'UNKNOWN')
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5329f10-84d8-4407-ba6d-4fb3975a344d
          stepCounter: 0764d929-2cf8-43a9-bcbd-42b231d7fecd
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SECTOR
        name: SECTOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e65f138e-d202-4a0f-9582-c19139f64000
                stepCounter: a087658c-732e-4983-8055-10c77da80366
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc3b363d-90b5-4d2c-823f-4127e767af7a
          stepCounter: 0764d929-2cf8-43a9-bcbd-42b231d7fecd
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER ID
        isBusinessKey: true
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 595b877c-1fca-4cd0-9d17-a93ef28b114f
                stepCounter: b4a6de0a-db8e-49e8-92e6-84beb0d6c89f
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d09424e-b748-432f-9feb-3f7bec40e519
          stepCounter: 0764d929-2cf8-43a9-bcbd-42b231d7fecd
        config: {}
        dataType: INT
        defaultValue: ""
        description: NUMBER OF CONTACTS FOR GIVEN FORCEID
        name: NUMBEROFCONTACTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f602ce6e-ca10-4df0-a6d6-318748841097
                stepCounter: c9744949-b951-4549-adaf-f5e0bafaf072
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a30b7fa0-6a6e-436a-ad62-263f2f866c8a
          stepCounter: 0764d929-2cf8-43a9-bcbd-42b231d7fecd
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: PREVIOUS 12 MONTHS SUM OF SALES
        name: PREVIOUS12MONTHS_SUMOFSALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51d1e5f3-6a53-4936-8ba3-012c7787cec9
                stepCounter: b4a6de0a-db8e-49e8-92e6-84beb0d6c89f
            transform: ZEROIFNULL(OPC_VWAGGFORCEIDUSAGESTATS_ALL.PREVIOUS12MONTHS_SUMOFSALES)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 106a086a-62c3-4a97-9d8a-2a60821c7006
          stepCounter: 0764d929-2cf8-43a9-bcbd-42b231d7fecd
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: CURRENT 12 MONTHS SUM OF SALES
        name: CURRENT12MONTHS_SUMOFSALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1d481ab-cdc5-4f8a-af6d-5e911da06c6c
                stepCounter: b4a6de0a-db8e-49e8-92e6-84beb0d6c89f
            transform: ZEROIFNULL(OPC_VWAGGFORCEIDUSAGESTATS_ALL.CURRENT12MONTHS_SUMOFSALES)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1f93379-2afd-458a-80f4-25bb2ca254b0
          stepCounter: 0764d929-2cf8-43a9-bcbd-42b231d7fecd
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: (CURRENT 12 MONTHS SALES) - (PREVIOUS 12 MONTHS SALES)
        name: CURRENT12MONTHS_SALESDIFF
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1d481ab-cdc5-4f8a-af6d-5e911da06c6c
                stepCounter: b4a6de0a-db8e-49e8-92e6-84beb0d6c89f
            transform: ZEROIFNULL(CURRENT12MONTHS_SUMOFSALES - PREVIOUS12MONTHS_SUMOFSALES)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2acf1b1a-649b-42e1-8d81-bdefddc49e58
          stepCounter: 0764d929-2cf8-43a9-bcbd-42b231d7fecd
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ((CURRENT 12 MONTHS SALES) - (PREVIOUS 12 MONTHS SALES)) / (PREVIOUS 12 MONTHS SALES)
        name: CURRENT12MONTHS_SALESDIFFPERC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1d481ab-cdc5-4f8a-af6d-5e911da06c6c
                stepCounter: b4a6de0a-db8e-49e8-92e6-84beb0d6c89f
            transform: IFNULL((CURRENT12MONTHS_SUMOFSALES - PREVIOUS12MONTHS_SUMOFSALES)/NULLIF(PREVIOUS12MONTHS_SUMOFSALES,0),0)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e12c7084-9b7b-487a-a3cc-adf2a2628315
          stepCounter: 0764d929-2cf8-43a9-bcbd-42b231d7fecd
        config: {}
        dataType: INT
        defaultValue: ""
        description: PREVIOUS 12 MONTHS NUMBER OF SUPPLIERS USED
        name: PREVIOUS12MONTHS_NUMOFSUPPLIERSUSED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d0e02694-1a5b-4559-9e14-8f5adf247d3b
                stepCounter: 2b7c09d5-f8c0-4b05-a4b1-fd5516d39057
            transform: ZEROIFNULL(OPC_AGGFORCEID_PY_LTM.FORCEID_PY_LTM_NUMOFSUPPLIERSUSED)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa8eee2b-1eb1-4046-b147-6abc5ea48cb4
          stepCounter: 0764d929-2cf8-43a9-bcbd-42b231d7fecd
        config: {}
        dataType: INT
        defaultValue: ""
        description: CURRENT 12 MONTHS NUMBER OF SUPPLIERS USED
        name: CURRENT12MONTHS_NUMOFSUPPLIERSUSED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1aadcac1-eb88-4cae-bbc7-39be4cfeb866
                stepCounter: 3dcbcab6-e24b-403a-87d8-52ee34d79b06
            transform: ZEROIFNULL(OPC_AGGFORCEID_LTM.FORCEID_LTM_NUMOFSUPPLIERSUSED)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a3842e7-4f49-43df-a3c9-75cc293db7fe
          stepCounter: 0764d929-2cf8-43a9-bcbd-42b231d7fecd
        config: {}
        dataType: INT
        defaultValue: ""
        description: (CURRENT 12 MONTHS NUMBER OF SUPPLIERS USED) - (PREVIOUS 12 MONTHS NUMBER OF SUPPLIERS USED)
        name: CURRENT12MONTHS_NUMOFSUPPLIERSUSEDDIFF
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1aadcac1-eb88-4cae-bbc7-39be4cfeb866
                stepCounter: 3dcbcab6-e24b-403a-87d8-52ee34d79b06
            transform: ZEROIFNULL(OPC_AGGFORCEID_LTM.FORCEID_LTM_NUMOFSUPPLIERSUSED) - ZEROIFNULL(OPC_AGGFORCEID_PY_LTM.FORCEID_PY_LTM_NUMOFSUPPLIERSUSED)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6bf876d-f0c3-4219-b35d-403874147b27
          stepCounter: 0764d929-2cf8-43a9-bcbd-42b231d7fecd
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ((CURRENT 12 MONTHS NUMBER OF SUPPLIERS USED) - (PREVIOUS 12 MONTHS NUMBER OF SUPPLIERS USED)) / (PREVIOUS 12 MONTHS NUMBER OF SUPPLIERS USED)
        name: CURRENT12MONTHS_NUMOFSUPPLIERSUSEDDIFFPERC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1aadcac1-eb88-4cae-bbc7-39be4cfeb866
                stepCounter: 3dcbcab6-e24b-403a-87d8-52ee34d79b06
            transform: IFNULL((ZEROIFNULL(OPC_AGGFORCEID_LTM.FORCEID_LTM_NUMOFSUPPLIERSUSED) - ZEROIFNULL(OPC_AGGFORCEID_PY_LTM.FORCEID_PY_LTM_NUMOFSUPPLIERSUSED) \N)/NULLIF(OPC_AGGFORCEID_PY_LTM.FORCEID_PY_LTM_NUMOFSUPPLIERSUSED, 0),0)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 46f83045-02f2-488d-85d6-a8341ab75ca7
          stepCounter: 0764d929-2cf8-43a9-bcbd-42b231d7fecd
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PARTICIPATING_PROGRAM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 865dad22-4118-4060-851f-9c80e828b3f7
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 99bb7455-7982-48eb-bb26-20dfff667028
          stepCounter: 0764d929-2cf8-43a9-bcbd-42b231d7fecd
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        name: WESHARE_PARTICIPANT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1956570d-899f-43fb-8561-a63d8f1de0a8
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4bef18cb-4674-4d54-ba03-c260b06d7b00
          stepCounter: 0764d929-2cf8-43a9-bcbd-42b231d7fecd
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: DENOTES WHETHER THE ROW IS AN ACCOUNT, CHILD ACCOUNT, DUPLICATE, OR DELIVERY LOCATION.
        name: RECORDDESIGNATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ff3ea4e-a612-47e0-a706-f43a6caee5d3
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          OPC_ACCOUNT: 3353bc4b-96a5-43e1-9c39-6e2080820932
          ACCOUNTGEOGRAPHY: d0f4be43-15dd-4e34-9b37-62ad9deca642
          SECTOR: a087658c-732e-4983-8055-10c77da80366
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNTGEOGRAPHY
          - locationName: DIM
            nodeName: SECTOR
          - locationName: OMNIA_CONNECT_OPC
            nodeName: OPC_ACCOUNT
          - locationName: OMNIA_PARTNERS_CONNECT
            nodeName: OPC_AGG_FORCEID_LTM
          - locationName: OMNIA_PARTNERS_CONNECT
            nodeName: OPC_AGG_FORCEID_PY_LTM
          - locationName: OMNIA_PARTNERS_CONNECT
            nodeName: OPC_VW_AGG_FORCEIDUSAGESTATS_ALL
          - locationName: OMNIA_PARTNERS_CONNECT
            nodeName: OPC_VW_AGG_LEVEL1FORCEIDUSAGESTATS_LIFETIME_CONTACTS
          - locationName: UNKNOWN
            nodeName: OPC_VWAGGFORCEIDUSAGESTATS_ALL
          - locationName: UNKNOWN
            nodeName: OPC_VWAGGLEVEL1FORCEIDUSAGESTATS_LIFETIME_CONTACTS
          - locationName: UNKNOWN
            nodeName: OPC_AGGFORCEID_LTM
          - locationName: UNKNOWN
            nodeName: OPC_AGGFORCEID_PY_LTM
        join:
          joinCondition: |-
            FROM {{ ref('OMNIA_CONNECT_OPC','OPC_ACCOUNT') }} OPC_ACCOUNT
              LEFT JOIN {{ ref('DIM','ACCOUNTGEOGRAPHY') }} ACCOUNTGEOGRAPHY
                ON OPC_ACCOUNT.FORCEID = ACCOUNTGEOGRAPHY.FORCEID
              LEFT JOIN {{ ref('DIM','SECTOR') }} SECTOR
                ON OPC_ACCOUNT.SECTORKEY = SECTOR.SECTORKEY
              LEFT JOIN {{ ref('UNKNOWN','OPC_VWAGGFORCEIDUSAGESTATS_ALL') }} OPC_VWAGGFORCEIDUSAGESTATS_ALL
                ON OPC_ACCOUNT.FORCEID = OPC_VWAGGFORCEIDUSAGESTATS_ALL.FORCEID
              LEFT JOIN {{ ref('UNKNOWN','OPC_VWAGGLEVEL1FORCEIDUSAGESTATS_LIFETIME_CONTACTS') }} OPC_VWAGGLEVEL1FORCEIDUSAGESTATS_LIFETIME_CONTACTS
                ON OPC_ACCOUNT.FORCEID = OPC_VWAGGLEVEL1FORCEIDUSAGESTATS_LIFETIME_CONTACTS.FORCEID
              LEFT JOIN {{ ref('UNKNOWN','OPC_AGGFORCEID_LTM') }} OPC_AGGFORCEID_LTM
                ON OPC_ACCOUNT.FORCEID = OPC_AGGFORCEID_LTM.FORCEID
              LEFT JOIN {{ ref('UNKNOWN','OPC_AGGFORCEID_PY_LTM') }} OPC_AGGFORCEID_PY_LTM
                ON OPC_ACCOUNT.FORCEID = OPC_AGGFORCEID_PY_LTM.FORCEID
        name: SRC_OPC_CHILDCUSTOMERSEARCH_1_SUPPLIERID
        noLinkRefs: []
  name: OPC_CHILDCUSTOMERSEARCH
  overrideSQL: false
  schema: ""
  sqlType: Agreggate
  type: sql
  version: 1
type: Node
