fileVersion: 1
id: caa1d92b-1249-4091-8f68-613b7d5813f8
name: STAGEAUTORENTALLOCATIONS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c02eee33-1df6-48f7-8cd1-b9598f9e480a
          stepCounter: caa1d92b-1249-4091-8f68-613b7d5813f8
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: RENTALSTATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d28ba8cf-af3a-4f36-8f13-435e19596ec9
                stepCounter: e5cddc66-bf27-4e05-abdb-1f440b78912b
            transform: UPPER(TRIM(LoadAutoRentalUsageData.RENTALSTATION))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9755d313-af0a-4559-9bb4-6ac605bc8795
          stepCounter: caa1d92b-1249-4091-8f68-613b7d5813f8
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: BRANDDESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cc528bc0-55c0-42ea-8af0-c406bf5fa78b
                stepCounter: e5cddc66-bf27-4e05-abdb-1f440b78912b
            transform: UPPER(TRIM(LoadAutoRentalUsageData.BRANDDESCRIPTION))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0153f7c3-ecc8-4e29-abe4-a877315aa588
          stepCounter: caa1d92b-1249-4091-8f68-613b7d5813f8
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: RENTALSTATIONNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 66e1c835-1681-4093-9da8-1e9d14cbf3e9
                stepCounter: e5cddc66-bf27-4e05-abdb-1f440b78912b
            transform: MIN(UPPER(LoadAutoRentalUsageData.RENTALSTATIONNAME))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a40a9f6c-a388-4194-92b0-194ec7efaa37
          stepCounter: caa1d92b-1249-4091-8f68-613b7d5813f8
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: RENTALCITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 14dc49f6-8c93-494e-b76f-1f84ad3d5642
                stepCounter: e5cddc66-bf27-4e05-abdb-1f440b78912b
            transform: UPPER(TRIM(LoadAutoRentalUsageData.RENTALCITY))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e4bf2db8-ca36-4b3a-afd0-5dfb0de02d6c
          stepCounter: caa1d92b-1249-4091-8f68-613b7d5813f8
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: RENTALSTATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e75429a3-23b8-4eae-baa4-3f004d992ce3
                stepCounter: e5cddc66-bf27-4e05-abdb-1f440b78912b
            transform: UPPER(TRIM(LoadAutoRentalUsageData.RENTALSTATE))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c63dd879-d232-4f97-8642-64c8628d5dbe
          stepCounter: caa1d92b-1249-4091-8f68-613b7d5813f8
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DATEADDED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e068f81d-4e43-4a6d-b8f1-fa9743df0554
                stepCounter: e5cddc66-bf27-4e05-abdb-1f440b78912b
            transform: MIN(LoadAutoRentalUsageData.RENTALDATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9776b62a-6f3a-419c-a5c9-3fcb873024b2
          stepCounter: caa1d92b-1249-4091-8f68-613b7d5813f8
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: RENTALCOUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50799929-3b19-403d-8345-b1fe10095fce
                stepCounter: e5cddc66-bf27-4e05-abdb-1f440b78912b
            transform: MIN(LoadAutoRentalUsageData.CHECKOUTSTATIONCOUNTRYCODE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1117fe5d-192c-4afb-9446-d4f44467074d
          stepCounter: caa1d92b-1249-4091-8f68-613b7d5813f8
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: NORMALIZEDCITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 14dc49f6-8c93-494e-b76f-1f84ad3d5642
                stepCounter: e5cddc66-bf27-4e05-abdb-1f440b78912b
            transform: INITCAP(MIN(LoadAutoRentalUsageData.RENTALCITY))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5c86dbb-52a7-4cdd-8f3c-72563e5440c7
          stepCounter: caa1d92b-1249-4091-8f68-613b7d5813f8
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ISGNORMALIZEDCITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 14dc49f6-8c93-494e-b76f-1f84ad3d5642
                stepCounter: e5cddc66-bf27-4e05-abdb-1f440b78912b
            transform: INITCAP(MIN(LoadAutoRentalUsageData.RENTALCITY))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5b44324-db15-44b1-a030-0cd8f346e8f9
          stepCounter: caa1d92b-1249-4091-8f68-613b7d5813f8
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Notes
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: NOTES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e068f81d-4e43-4a6d-b8f1-fa9743df0554
                stepCounter: e5cddc66-bf27-4e05-abdb-1f440b78912b
            transform: MIN(LoadAutoRentalUsageData.RENTALDATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6bd6d7a6-c02b-47c5-9114-c66482586f9a
          stepCounter: caa1d92b-1249-4091-8f68-613b7d5813f8
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: Record source.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 927daf4f-c1fe-466f-941c-1e12030d1cff
                stepCounter: e5cddc66-bf27-4e05-abdb-1f440b78912b
            transform: MIN(LoadAutoRentalUsageData.DSS_RECORD_SOURCE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f16d0c1-01ca-49a3-8139-f1a18edca70f
          stepCounter: caa1d92b-1249-4091-8f68-613b7d5813f8
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Load date.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 478a906b-3e1e-4dde-9fb1-d4fe4c84dede
                stepCounter: e5cddc66-bf27-4e05-abdb-1f440b78912b
            transform: MIN(LoadAutoRentalUsageData.DSS_LOAD_DATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ddc02ce-86d1-42a0-b23d-3af2b426f94f
          stepCounter: caa1d92b-1249-4091-8f68-613b7d5813f8
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dbf47820-e4f6-4895-a2d5-61b61b61361f
          stepCounter: caa1d92b-1249-4091-8f68-613b7d5813f8
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOADAUTORENTALUSAGEDATA: e5cddc66-bf27-4e05-abdb-1f440b78912b
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOADAUTORENTALUSAGEDATA
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOADAUTORENTALUSAGEDATA') }} LoadAutoRentalUsageData
             GROUP BY UPPER(TRIM(LoadAutoRentalUsageData.RENTALSTATION)) ,
                      UPPER(TRIM(LoadAutoRentalUsageData.BRANDDESCRIPTION)) ,
                      UPPER(TRIM(LoadAutoRentalUsageData.RENTALCITY)) ,
                      UPPER(TRIM(LoadAutoRentalUsageData.RENTALSTATE))
        name: STAGEAUTORENTALLOCATIONS
        noLinkRefs: []
  name: STAGEAUTORENTALLOCATIONS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
