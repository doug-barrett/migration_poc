fileVersion: 1
id: 9e6e6a7d-eb51-4cc5-b85f-7bee47578a3e
name: STAGEAUTORENTALLOCATIONS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cdbc92fb-ca07-4305-a3d0-3f85c2b7f09a
          stepCounter: 9e6e6a7d-eb51-4cc5-b85f-7bee47578a3e
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: RENTALSTATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4f58280-26b7-46d6-a9f4-59d3bd10eb2d
                stepCounter: e63a896e-d386-4b56-8313-3957675ad95a
            transform: UPPER(TRIM(LoadAutoRentalUsageData.RENTALSTATION))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64884d36-403a-416c-bcc5-52d2e0fa2713
          stepCounter: 9e6e6a7d-eb51-4cc5-b85f-7bee47578a3e
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: BRANDDESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 224c99bb-cefb-48b0-b4f6-e99f0ac13f6c
                stepCounter: e63a896e-d386-4b56-8313-3957675ad95a
            transform: UPPER(TRIM(LoadAutoRentalUsageData.BRANDDESCRIPTION))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f243818b-2431-4819-9b71-2ae604e2f6c7
          stepCounter: 9e6e6a7d-eb51-4cc5-b85f-7bee47578a3e
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: RENTALSTATIONNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fcae480e-a3a0-4f2b-b1c5-5e58c70eec74
                stepCounter: e63a896e-d386-4b56-8313-3957675ad95a
            transform: MIN(UPPER(LoadAutoRentalUsageData.RENTALSTATIONNAME))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71eccce4-e18a-49af-9611-1b792628bdd7
          stepCounter: 9e6e6a7d-eb51-4cc5-b85f-7bee47578a3e
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: RENTALCITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 974e0542-8065-4b74-a7c8-70a5ea8034fc
                stepCounter: e63a896e-d386-4b56-8313-3957675ad95a
            transform: UPPER(TRIM(LoadAutoRentalUsageData.RENTALCITY))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 716e0921-32a9-4c54-9868-2722e624103f
          stepCounter: 9e6e6a7d-eb51-4cc5-b85f-7bee47578a3e
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: RENTALSTATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f17202db-f53a-438f-8cb1-63c9d1ec94dd
                stepCounter: e63a896e-d386-4b56-8313-3957675ad95a
            transform: UPPER(TRIM(LoadAutoRentalUsageData.RENTALSTATE))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15e7617d-d4db-4be7-af71-58597759f671
          stepCounter: 9e6e6a7d-eb51-4cc5-b85f-7bee47578a3e
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DATEADDED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4dc00564-438e-4cf1-be1d-08cfefda88aa
                stepCounter: e63a896e-d386-4b56-8313-3957675ad95a
            transform: MIN(LoadAutoRentalUsageData.RENTALDATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7264aa35-45a6-464e-a883-e4171eb856e9
          stepCounter: 9e6e6a7d-eb51-4cc5-b85f-7bee47578a3e
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: RENTALCOUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b080cc83-d3c7-4cdb-a7c5-d2870c2a874c
                stepCounter: e63a896e-d386-4b56-8313-3957675ad95a
            transform: MIN(LoadAutoRentalUsageData.CHECKOUTSTATIONCOUNTRYCODE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 00ea9708-007b-4abf-a79f-929de369ffe9
          stepCounter: 9e6e6a7d-eb51-4cc5-b85f-7bee47578a3e
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: NORMALIZEDCITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 974e0542-8065-4b74-a7c8-70a5ea8034fc
                stepCounter: e63a896e-d386-4b56-8313-3957675ad95a
            transform: INITCAP(MIN(LoadAutoRentalUsageData.RENTALCITY))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9bcbce8d-a881-4d31-82c4-fd0300cb862c
          stepCounter: 9e6e6a7d-eb51-4cc5-b85f-7bee47578a3e
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ISGNORMALIZEDCITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 974e0542-8065-4b74-a7c8-70a5ea8034fc
                stepCounter: e63a896e-d386-4b56-8313-3957675ad95a
            transform: INITCAP(MIN(LoadAutoRentalUsageData.RENTALCITY))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e649cc49-93a9-4258-9319-9efda5cc2af1
          stepCounter: 9e6e6a7d-eb51-4cc5-b85f-7bee47578a3e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Notes
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: NOTES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4dc00564-438e-4cf1-be1d-08cfefda88aa
                stepCounter: e63a896e-d386-4b56-8313-3957675ad95a
            transform: MIN(LoadAutoRentalUsageData.RENTALDATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b2acfad6-0303-4ad0-817f-b1134d68309b
          stepCounter: 9e6e6a7d-eb51-4cc5-b85f-7bee47578a3e
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: Record source.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 133d9d65-0169-42ac-80d5-a83ef3b0955c
                stepCounter: e63a896e-d386-4b56-8313-3957675ad95a
            transform: MIN(LoadAutoRentalUsageData.DSS_RECORD_SOURCE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de888479-0cd0-4a5b-b72c-00993595842d
          stepCounter: 9e6e6a7d-eb51-4cc5-b85f-7bee47578a3e
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Load date.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 96c1ea30-8794-426e-ab6f-4b053d865263
                stepCounter: e63a896e-d386-4b56-8313-3957675ad95a
            transform: MIN(LoadAutoRentalUsageData.DSS_LOAD_DATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f8d78d7-d730-40d2-8556-39db5e89d9fb
          stepCounter: 9e6e6a7d-eb51-4cc5-b85f-7bee47578a3e
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff5ea116-600a-4519-aaa6-6ae73108983b
          stepCounter: 9e6e6a7d-eb51-4cc5-b85f-7bee47578a3e
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOADAUTORENTALUSAGEDATA: e63a896e-d386-4b56-8313-3957675ad95a
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOADAUTORENTALUSAGEDATA
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOADAUTORENTALUSAGEDATA') }} LoadAutoRentalUsageData
             GROUP BY UPPER(TRIM(LoadAutoRentalUsageData.RENTALSTATION)) ,
                      UPPER(TRIM(LoadAutoRentalUsageData.BRANDDESCRIPTION)) ,
                      UPPER(TRIM(LoadAutoRentalUsageData.RENTALCITY)) ,
                      UPPER(TRIM(LoadAutoRentalUsageData.RENTALSTATE))
        name: STAGEAUTORENTALLOCATIONS
        noLinkRefs: []
  name: STAGEAUTORENTALLOCATIONS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
