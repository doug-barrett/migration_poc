fileVersion: 1
id: 8069c950-2569-4ead-9e3a-19ee1aa0000b
name: STAGEAUTORENTALLOCATIONS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa78752f-8079-4e1d-b3e0-c7468abc3936
          stepCounter: 8069c950-2569-4ead-9e3a-19ee1aa0000b
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: RENTALSTATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b95cd39-034c-4b3e-bd94-daa430788545
                stepCounter: c125b97f-5364-4b8b-bc12-2be6fc150a43
            transform: UPPER(TRIM(LOADAUTORENTALUSAGEDATA.RENTALSTATION))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aee718e0-0481-4307-be47-f8acefb75f7b
          stepCounter: 8069c950-2569-4ead-9e3a-19ee1aa0000b
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: BRANDDESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f6e4292d-d31a-4a05-94c7-26586726312b
                stepCounter: c125b97f-5364-4b8b-bc12-2be6fc150a43
            transform: UPPER(TRIM(LOADAUTORENTALUSAGEDATA.BRANDDESCRIPTION))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1a2e8df-05df-4fda-9f34-c8f7fd88c27a
          stepCounter: 8069c950-2569-4ead-9e3a-19ee1aa0000b
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: RENTALSTATIONNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ae79d602-65fa-408c-8590-ee5a85408945
                stepCounter: c125b97f-5364-4b8b-bc12-2be6fc150a43
            transform: MIN(UPPER(LOADAUTORENTALUSAGEDATA.RENTALSTATIONNAME))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2bc30d1e-32c7-41b9-8d3b-a2b0d1ab6029
          stepCounter: 8069c950-2569-4ead-9e3a-19ee1aa0000b
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: RENTALCITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1822d9dc-1505-4f56-9e0d-fd5baacc0c54
                stepCounter: c125b97f-5364-4b8b-bc12-2be6fc150a43
            transform: UPPER(TRIM(LOADAUTORENTALUSAGEDATA.RENTALCITY))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db8db550-5e34-4c0e-a922-24133f0e1d3e
          stepCounter: 8069c950-2569-4ead-9e3a-19ee1aa0000b
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: RENTALSTATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5cb345a9-260e-4a30-b116-affba89af83d
                stepCounter: c125b97f-5364-4b8b-bc12-2be6fc150a43
            transform: UPPER(TRIM(LOADAUTORENTALUSAGEDATA.RENTALSTATE))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9d525ee-c0e1-4eb2-9328-074ab4e6d4ec
          stepCounter: 8069c950-2569-4ead-9e3a-19ee1aa0000b
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: DATEADDED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 63faad81-234e-4c88-b8c2-b1beee68d4cf
                stepCounter: c125b97f-5364-4b8b-bc12-2be6fc150a43
            transform: MIN(LOADAUTORENTALUSAGEDATA.RENTALDATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d1d5151-f79d-4559-8788-66274a42d912
          stepCounter: 8069c950-2569-4ead-9e3a-19ee1aa0000b
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: RENTALCOUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09d69c89-da56-4501-9eca-1b471bceff67
                stepCounter: c125b97f-5364-4b8b-bc12-2be6fc150a43
            transform: MIN(LOADAUTORENTALUSAGEDATA.CHECKOUTSTATIONCOUNTRYCODE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e290665-71d3-4722-82b8-6d1fae5a5f07
          stepCounter: 8069c950-2569-4ead-9e3a-19ee1aa0000b
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: NORMALIZEDCITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1822d9dc-1505-4f56-9e0d-fd5baacc0c54
                stepCounter: c125b97f-5364-4b8b-bc12-2be6fc150a43
            transform: INITCAP(MIN(LOADAUTORENTALUSAGEDATA.RENTALCITY))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6eb15cb5-d5ab-49bc-9c52-a94f9b119e42
          stepCounter: 8069c950-2569-4ead-9e3a-19ee1aa0000b
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: ISGNORMALIZEDCITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1822d9dc-1505-4f56-9e0d-fd5baacc0c54
                stepCounter: c125b97f-5364-4b8b-bc12-2be6fc150a43
            transform: INITCAP(MIN(LOADAUTORENTALUSAGEDATA.RENTALCITY))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ae0a034-07d1-4013-ab98-91fd07e6ce68
          stepCounter: 8069c950-2569-4ead-9e3a-19ee1aa0000b
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: NOTES
        name: NOTES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 63faad81-234e-4c88-b8c2-b1beee68d4cf
                stepCounter: c125b97f-5364-4b8b-bc12-2be6fc150a43
            transform: MIN(LOADAUTORENTALUSAGEDATA.RENTALDATE) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 51342bf7-543a-4889-8495-6b8ef74c1585
          stepCounter: 8069c950-2569-4ead-9e3a-19ee1aa0000b
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ad50cf9-5739-410a-b967-c8836f614b48
                stepCounter: c125b97f-5364-4b8b-bc12-2be6fc150a43
            transform: MIN(LOADAUTORENTALUSAGEDATA.DSS_RECORD_SOURCE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bc080c49-2b58-4584-bf69-125b2f338610
          stepCounter: 8069c950-2569-4ead-9e3a-19ee1aa0000b
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a16d52b-e527-4930-8610-9e78ef00edd3
                stepCounter: c125b97f-5364-4b8b-bc12-2be6fc150a43
            transform: MIN(LOADAUTORENTALUSAGEDATA.DSS_LOAD_DATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14dfa22c-9895-4e61-865b-b0398a266fe8
          stepCounter: 8069c950-2569-4ead-9e3a-19ee1aa0000b
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ea326f7-96c5-4b87-83e5-8f157a8416e5
          stepCounter: 8069c950-2569-4ead-9e3a-19ee1aa0000b
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOADAUTORENTALUSAGEDATA: c125b97f-5364-4b8b-bc12-2be6fc150a43
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOADAUTORENTALUSAGEDATA
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOADAUTORENTALUSAGEDATA') }} LOADAUTORENTALUSAGEDATA
             GROUP BY UPPER(TRIM(LOADAUTORENTALUSAGEDATA.RENTALSTATION)) ,
                      UPPER(TRIM(LOADAUTORENTALUSAGEDATA.BRANDDESCRIPTION)) ,
                      UPPER(TRIM(LOADAUTORENTALUSAGEDATA.RENTALCITY)) ,
                      UPPER(TRIM(LOADAUTORENTALUSAGEDATA.RENTALSTATE))
        name: STAGEAUTORENTALLOCATIONS
        noLinkRefs: []
  name: STAGEAUTORENTALLOCATIONS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
