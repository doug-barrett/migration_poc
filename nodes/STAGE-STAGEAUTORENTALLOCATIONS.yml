fileVersion: 1
id: 1791ed94-6e80-4b7d-bb4f-ef32d647656b
name: STAGEAUTORENTALLOCATIONS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba1ac8ab-6a83-4e93-bb76-c6c639f58e6b
          stepCounter: 1791ed94-6e80-4b7d-bb4f-ef32d647656b
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: RENTALSTATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c1193a17-812e-4a68-9c5d-42192428b0f5
                stepCounter: 55343106-0558-4855-8ad1-c2066e23ca1a
            transform: UPPER(TRIM(LOADAUTORENTALUSAGEDATA.RENTALSTATION))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5060c2e8-4afd-44e0-a703-5055c8cde914
          stepCounter: 1791ed94-6e80-4b7d-bb4f-ef32d647656b
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: BRANDDESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50799755-8abf-48d1-8ec5-6778dd9ff801
                stepCounter: 55343106-0558-4855-8ad1-c2066e23ca1a
            transform: UPPER(TRIM(LOADAUTORENTALUSAGEDATA.BRANDDESCRIPTION))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb7c2223-fe1e-42c8-97c7-146a0cf0680a
          stepCounter: 1791ed94-6e80-4b7d-bb4f-ef32d647656b
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: RENTALSTATIONNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f92c432b-ad49-47f7-b65e-80178a3e2136
                stepCounter: 55343106-0558-4855-8ad1-c2066e23ca1a
            transform: MIN(UPPER(LOADAUTORENTALUSAGEDATA.RENTALSTATIONNAME))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b923901-e96b-4be4-b820-711f05731d48
          stepCounter: 1791ed94-6e80-4b7d-bb4f-ef32d647656b
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: RENTALCITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84d70f3b-0c21-4140-a558-ea6f62d5a29f
                stepCounter: 55343106-0558-4855-8ad1-c2066e23ca1a
            transform: UPPER(TRIM(LOADAUTORENTALUSAGEDATA.RENTALCITY))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9194cd80-889c-4163-b9cb-9ef92df62cb4
          stepCounter: 1791ed94-6e80-4b7d-bb4f-ef32d647656b
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: RENTALSTATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9840938f-019b-41b0-9ba0-c5d4c80bb251
                stepCounter: 55343106-0558-4855-8ad1-c2066e23ca1a
            transform: UPPER(TRIM(LOADAUTORENTALUSAGEDATA.RENTALSTATE))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c4e9ab9-77f6-4d10-a9ae-d455667a8e1c
          stepCounter: 1791ed94-6e80-4b7d-bb4f-ef32d647656b
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: DATEADDED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: af92b1b5-9b40-4213-9d6c-17687785c3d0
                stepCounter: 55343106-0558-4855-8ad1-c2066e23ca1a
            transform: MIN(LOADAUTORENTALUSAGEDATA.RENTALDATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92b87470-3b5c-4eed-ae47-3d56d198dc13
          stepCounter: 1791ed94-6e80-4b7d-bb4f-ef32d647656b
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: RENTALCOUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e56c015a-c2e3-4769-b3ae-21c4cc668af2
                stepCounter: 55343106-0558-4855-8ad1-c2066e23ca1a
            transform: MIN(LOADAUTORENTALUSAGEDATA.CHECKOUTSTATIONCOUNTRYCODE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b5981b9-03c7-4295-857e-c6752cb29895
          stepCounter: 1791ed94-6e80-4b7d-bb4f-ef32d647656b
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: NORMALIZEDCITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84d70f3b-0c21-4140-a558-ea6f62d5a29f
                stepCounter: 55343106-0558-4855-8ad1-c2066e23ca1a
            transform: INITCAP(MIN(LOADAUTORENTALUSAGEDATA.RENTALCITY))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ecf77c1f-7c8b-444c-9f84-17d96d9a621c
          stepCounter: 1791ed94-6e80-4b7d-bb4f-ef32d647656b
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: ISGNORMALIZEDCITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84d70f3b-0c21-4140-a558-ea6f62d5a29f
                stepCounter: 55343106-0558-4855-8ad1-c2066e23ca1a
            transform: INITCAP(MIN(LOADAUTORENTALUSAGEDATA.RENTALCITY))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 793b0eb9-7051-4db7-8506-0b7548a8d8a5
          stepCounter: 1791ed94-6e80-4b7d-bb4f-ef32d647656b
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: NOTES
        name: NOTES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: af92b1b5-9b40-4213-9d6c-17687785c3d0
                stepCounter: 55343106-0558-4855-8ad1-c2066e23ca1a
            transform: MIN(LOADAUTORENTALUSAGEDATA.RENTALDATE) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 051b9997-5d93-4e32-9c0c-1b0e2771e245
          stepCounter: 1791ed94-6e80-4b7d-bb4f-ef32d647656b
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 029bb85e-37bc-4d4e-8a68-8879148b8f67
                stepCounter: 55343106-0558-4855-8ad1-c2066e23ca1a
            transform: MIN(LOADAUTORENTALUSAGEDATA.DSS_RECORD_SOURCE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dd5d3fb1-ee21-4b24-a626-2fe534be9884
          stepCounter: 1791ed94-6e80-4b7d-bb4f-ef32d647656b
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c1865bcd-2f74-452b-88f4-0b199eb620be
                stepCounter: 55343106-0558-4855-8ad1-c2066e23ca1a
            transform: MIN(LOADAUTORENTALUSAGEDATA.DSS_LOAD_DATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17df87ea-5775-4725-a903-52a54aff93ea
          stepCounter: 1791ed94-6e80-4b7d-bb4f-ef32d647656b
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c634ca9-ae00-49c9-9ab2-8527167494d8
          stepCounter: 1791ed94-6e80-4b7d-bb4f-ef32d647656b
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOADAUTORENTALUSAGEDATA: 55343106-0558-4855-8ad1-c2066e23ca1a
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOADAUTORENTALUSAGEDATA
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOADAUTORENTALUSAGEDATA') }} LOADAUTORENTALUSAGEDATA
             GROUP BY UPPER(TRIM(LOADAUTORENTALUSAGEDATA.RENTALSTATION)) ,
                      UPPER(TRIM(LOADAUTORENTALUSAGEDATA.BRANDDESCRIPTION)) ,
                      UPPER(TRIM(LOADAUTORENTALUSAGEDATA.RENTALCITY)) ,
                      UPPER(TRIM(LOADAUTORENTALUSAGEDATA.RENTALSTATE))
        name: STAGEAUTORENTALLOCATIONS
        noLinkRefs: []
  name: STAGEAUTORENTALLOCATIONS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
