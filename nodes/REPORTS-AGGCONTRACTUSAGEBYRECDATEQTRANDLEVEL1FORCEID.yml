fileVersion: 1
id: 09eca03e-06dd-4231-80d6-6e95c6834e1f
name: AGGCONTRACTUSAGEBYRECDATEQTRANDLEVEL1FORCEID
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: REPORTS
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d327dc5b-0952-49e3-8d01-bf5f3ca00c5c
          stepCounter: 09eca03e-06dd-4231-80d6-6e95c6834e1f
        config: {}
        dataType: INT
        defaultValue: ""
        description: Parent Id for an account. Will be the same as ForceId if there is no parent or if this is the top-most account in a hierarchy
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52c93b64-c3ed-47ba-b2a5-369296bab49c
                stepCounter: c278473c-12f0-41e1-b65b-faa4b3c2a978
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cea63dbb-45f2-4f88-a012-159f3d431d48
          stepCounter: 09eca03e-06dd-4231-80d6-6e95c6834e1f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: The very first instance of a contract. If a contract was re-bid & received a new contract number, InitialContractId remains the same.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: INITIALCONTRACTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c1e65424-e1c5-44cd-81d6-a294f621747d
                stepCounter: 60b39932-2692-4360-ae42-25e43379d6f6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ecc3fb8-9017-4389-af7f-b478625d18b8
          stepCounter: 09eca03e-06dd-4231-80d6-6e95c6834e1f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The receipt date calendar quarter representation. Format YYYYQQ. Example 200204.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: RECEIPTDATECALQUARTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a2704d7-df86-4c10-a2c8-818281ea1d23
                stepCounter: ba0a4b83-bafb-422d-8c0a-4c417e7afd41
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 51d45061-ee78-4217-a413-25d5be5308e7
          stepCounter: 09eca03e-06dd-4231-80d6-6e95c6834e1f
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2410812-846e-49a6-8cf0-938dc4d0de17
                stepCounter: a48d4109-5650-474d-a2f0-c43a0593bcac
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9d5b06d-3960-47ea-a008-70def68fa79b
          stepCounter: 09eca03e-06dd-4231-80d6-6e95c6834e1f
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: REVENUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c15a6239-54bc-439b-be0c-970122f29022
                stepCounter: a48d4109-5650-474d-a2f0-c43a0593bcac
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bcdd8afc-7a8c-4824-9c35-222825c1d4af
          stepCounter: 09eca03e-06dd-4231-80d6-6e95c6834e1f
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ISFIRSTTIMEUSINGCONTRACT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11a5b723-8d5d-40a3-8231-3ac56bce1b59
                stepCounter: a48d4109-5650-474d-a2f0-c43a0593bcac
            transform: IIF(LAG(DimReceiptDate.ReceiptDate, 1) OVER (PARTITION BY ForceId, PPAContractNumber ORDER BY ForceId, PPAContractNumber, DimReceiptDate.ReceiptDate) IS NULL,1,0) AS IsFirstTimeUsingContract
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf592f2f-574d-4a65-a5f5-4a0e619cf52f
          stepCounter: 09eca03e-06dd-4231-80d6-6e95c6834e1f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ISCONTRACTUSENEWORRECURRINGINTRAILING12MONTHS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11a5b723-8d5d-40a3-8231-3ac56bce1b59
                stepCounter: a48d4109-5650-474d-a2f0-c43a0593bcac
            transform: IIF(DATEDIFF(QUARTER, LAG(DimReceiptDate.ReceiptDate, 1) OVER (PARTITION BY ForceId, PPAContractNumber ORDER BY ForceId, PPAContractNumber, ReceiptDateCalQuarter), DimReceiptDate.ReceiptDate) BETWEEN 1 AND 4, 'Recurring', 'New')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db117f7b-7ed4-4cb1-8620-c433797b7448
          stepCounter: 09eca03e-06dd-4231-80d6-6e95c6834e1f
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: QUARTERSSINCECONTRACTUSE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11a5b723-8d5d-40a3-8231-3ac56bce1b59
                stepCounter: a48d4109-5650-474d-a2f0-c43a0593bcac
            transform: DATEDIFF(QUARTER, LAG(DimReceiptDate.ReceiptDate, 1) OVER (PARTITION BY ForceId, PPAContractNumber ORDER BY ForceId, PPAContractNumber, DimReceiptDate.ReceiptDateCalQuarter), DimReceiptDate.ReceiptDate)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d369752-b227-42b3-b2fe-f0c6c79cd508
          stepCounter: 09eca03e-06dd-4231-80d6-6e95c6834e1f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f29176d7-9750-406e-8b44-626bb3d72d69
          stepCounter: 09eca03e-06dd-4231-80d6-6e95c6834e1f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ACCOUNT: c278473c-12f0-41e1-b65b-faa4b3c2a978
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: DIM
            nodeName: CONTRACT
          - locationName: DIM
            nodeName: DIMRECEIPTDATE
          - locationName: FACT
            nodeName: SALESANDREVENUE
        join:
          joinCondition: FROM {{ ref('DIM','ACCOUNT') }}
        name: AGGCONTRACTUSAGEBYRECDATEQTRANDLEVEL1FORCEID
        noLinkRefs: []
  name: AGGCONTRACTUSAGEBYRECDATEQTRANDLEVEL1FORCEID
  overrideSQL: false
  schema: ""
  sqlType: Fact
  type: sql
  version: 1
type: Node
