fileVersion: 1
id: b6b38c76-76d6-4ce7-8a3d-9dcbe0f6dddc
name: AGGCONTRACTUSAGEBYRECDATEQTRANDLEVEL1FORCEID
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: REPORTS
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e16a73cf-14d6-4af4-a1ee-191a16c830b1
          stepCounter: b6b38c76-76d6-4ce7-8a3d-9dcbe0f6dddc
        config: {}
        dataType: INT
        defaultValue: ""
        description: Parent Id for an account. Will be the same as ForceId if there is no parent or if this is the top-most account in a hierarchy
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ff29182e-d8f0-4d8e-a2f8-742db9ddce39
                stepCounter: a594f58e-2240-453f-a570-12719830e3d0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b9031e5-c2d9-4953-bed5-907f93f345e3
          stepCounter: b6b38c76-76d6-4ce7-8a3d-9dcbe0f6dddc
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: The very first instance of a contract. If a contract was re-bid & received a new contract number, InitialContractId remains the same.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: INITIALCONTRACTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de0c75fe-0f50-484d-aca4-e6468d485e51
                stepCounter: c745f44c-5c71-4400-897b-ff90a502a9cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b2b8b49c-3d84-4f3b-a56e-2af993b3e6e9
          stepCounter: b6b38c76-76d6-4ce7-8a3d-9dcbe0f6dddc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The receipt date calendar quarter representation. Format YYYYQQ. Example 200204.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: RECEIPTDATECALQUARTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce5388f4-a6c1-4f68-b172-ee92e500fb8d
                stepCounter: 5b2d5c58-31de-4b87-b6c8-d601fc33ff03
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78b1de5b-111b-4350-af9d-fb5b1fa5a7b7
          stepCounter: b6b38c76-76d6-4ce7-8a3d-9dcbe0f6dddc
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f4a71e14-54d2-4ee3-88da-c8c95b56c2c7
                stepCounter: 79e76231-b280-4362-a8fa-68215a84f788
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b123bdc3-b37d-44fd-b1ff-96dbf2a4f581
          stepCounter: b6b38c76-76d6-4ce7-8a3d-9dcbe0f6dddc
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: REVENUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2098b7a3-a5c3-4180-b722-2fa84cd3e787
                stepCounter: 79e76231-b280-4362-a8fa-68215a84f788
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4889ca18-ce43-43c9-b7be-452b072a5c99
          stepCounter: b6b38c76-76d6-4ce7-8a3d-9dcbe0f6dddc
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ISFIRSTTIMEUSINGCONTRACT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9f0957af-16aa-40fe-a225-3f515a7496a8
                stepCounter: 79e76231-b280-4362-a8fa-68215a84f788
            transform: IIF(LAG(DimReceiptDate.ReceiptDate, 1) OVER (PARTITION BY ForceId, PPAContractNumber ORDER BY ForceId, PPAContractNumber, DimReceiptDate.ReceiptDate) IS NULL,1,0) AS IsFirstTimeUsingContract
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59e0979e-fbf6-4a80-8953-d17bb9e3286d
          stepCounter: b6b38c76-76d6-4ce7-8a3d-9dcbe0f6dddc
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ISCONTRACTUSENEWORRECURRINGINTRAILING12MONTHS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9f0957af-16aa-40fe-a225-3f515a7496a8
                stepCounter: 79e76231-b280-4362-a8fa-68215a84f788
            transform: IIF(DATEDIFF(QUARTER, LAG(DimReceiptDate.ReceiptDate, 1) OVER (PARTITION BY ForceId, PPAContractNumber ORDER BY ForceId, PPAContractNumber, ReceiptDateCalQuarter), DimReceiptDate.ReceiptDate) BETWEEN 1 AND 4, 'Recurring', 'New')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49dd728c-b932-4639-b4e0-4fc6bb839de8
          stepCounter: b6b38c76-76d6-4ce7-8a3d-9dcbe0f6dddc
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: QUARTERSSINCECONTRACTUSE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9f0957af-16aa-40fe-a225-3f515a7496a8
                stepCounter: 79e76231-b280-4362-a8fa-68215a84f788
            transform: DATEDIFF(QUARTER, LAG(DimReceiptDate.ReceiptDate, 1) OVER (PARTITION BY ForceId, PPAContractNumber ORDER BY ForceId, PPAContractNumber, DimReceiptDate.ReceiptDateCalQuarter), DimReceiptDate.ReceiptDate)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a0ba186-960f-448f-8f46-7a96c8690fba
          stepCounter: b6b38c76-76d6-4ce7-8a3d-9dcbe0f6dddc
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91b1c16e-1673-42fb-a67d-f953db97509d
          stepCounter: b6b38c76-76d6-4ce7-8a3d-9dcbe0f6dddc
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ACCOUNT: a594f58e-2240-453f-a570-12719830e3d0
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: DIM
            nodeName: CONTRACT
          - locationName: DIM
            nodeName: DIMRECEIPTDATE
          - locationName: FACT
            nodeName: SALESANDREVENUE
        join:
          joinCondition: FROM {{ ref('DIM','ACCOUNT') }}
        name: AGGCONTRACTUSAGEBYRECDATEQTRANDLEVEL1FORCEID
        noLinkRefs: []
  name: AGGCONTRACTUSAGEBYRECDATEQTRANDLEVEL1FORCEID
  overrideSQL: false
  schema: ""
  sqlType: Fact
  type: sql
  version: 1
type: Node
