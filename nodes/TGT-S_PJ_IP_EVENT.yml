fileVersion: 1
id: 04791d95-8803-45a7-84f5-7fe19c6545ae
name: S_PJ_IP_EVENT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Get all the IP data required from fact_inpatient_event."
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 44bca1a6-e316-4993-8d82-b41e82e756e7
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Unique business identifier for inpatient event.
        name: IP_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 296d9698-586e-402a-b834-80fa2e5751bd
                stepCounter: ec00abea-1825-4ce7-9891-cf8f5b2f9379
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 757a6e1a-6198-4ca1-ad5b-895079eb8c45
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f183e76a-83fe-43fc-8432-6de68fbac3bd
                stepCounter: ec00abea-1825-4ce7-9891-cf8f5b2f9379
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 876a8c0e-d848-4768-b23e-69b685d65f10
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: WAITLIST_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05df2920-506b-4349-bc11-feb168e72b5c
                stepCounter: ec00abea-1825-4ce7-9891-cf8f5b2f9379
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 76b038bd-7e26-45bd-be4c-886c217906d4
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: The NHI is a unique 7-character identification number assigned to a healthcare user by the National Health Index (NHI) database.   There is a verification algorithm which ensures that the NHI number is in the correct format and is valid.     Also known as National Health Index, HCU identifier, NHI, HCU, HCU Number, Healthcare User identifier,   HCU identification number, NMPI number, Hospital Number, Patient Number.
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d650eeea-93ba-4d29-930b-a44c6bb2ce1a
                stepCounter: ec00abea-1825-4ce7-9891-cf8f5b2f9379
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ffd4485d-f7b9-48fd-9be5-f6a8c370ad1e
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The consecutive sequence number for inpatient events for a given patient
        name: PATIENT_EVENT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94494bfd-a115-45fc-aa59-c40b4b9f2821
                stepCounter: ec00abea-1825-4ce7-9891-cf8f5b2f9379
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b9997d58-6840-4b9b-aafb-b208b9b7dbbb
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The total number of inpatient events that a patient currently had.
        name: PATIENT_EVENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe937341-a832-48d7-b810-a9e8eaed04d7
                stepCounter: ec00abea-1825-4ce7-9891-cf8f5b2f9379
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11af6689-dba5-41ea-94fe-45f10fe38d88
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: patient age on arrival years
        name: PATIENT_AGE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5421e86e-1b78-4415-8efb-1638bed59752
                stepCounter: ec00abea-1825-4ce7-9891-cf8f5b2f9379
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e7a5d46-f366-42d8-a63a-6c780399eaa7
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: ADMISSION_SOURCE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9265c267-2cab-47ae-ac73-3153ec0a95ca
                stepCounter: 03e13fac-da9d-4222-8e2c-95b3d7218199
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c40f446-a188-40a4-bf55-32280b2d95ae
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: DISCHARGE_DESTINATION_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd1e2093-af53-430f-9415-7cdc97855d61
                stepCounter: a05a4266-44b7-4574-abee-00c3094cf764
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 551b55ac-8205-44e5-a8b5-3e1763700a51
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: DISCHARGE_METHOD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa9aae31-f7f7-49d4-9617-78164feef740
                stepCounter: 1bd29797-d2cb-4604-b84b-82897e347c39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d2a4190-a356-4ab5-b0ba-9829698b62b3
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EVENT_END_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 63829b4b-cb50-47c5-b8fc-df3a7548d9af
                stepCounter: 1bd29797-d2cb-4604-b84b-82897e347c39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14a6d4a6-0e3d-478a-afc1-0b315c78ee35
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NEXT_EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94072761-09b4-4bcb-9f18-6ee15184acb0
                stepCounter: ec00abea-1825-4ce7-9891-cf8f5b2f9379
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0739267-8093-49e0-aa81-8e65d2d40b9a
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NEXT_EVENT_ADMIT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d98142f0-f261-4055-ad8c-581c6636e853
                stepCounter: 04c42cb2-f015-4d9e-ae6d-9feed9f13b97
            transform: d2.admission_type_code
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 84a515c8-a022-476b-8bab-cd7d82c8128e
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DAYS_TO_NEXT_EVENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8dc7939f-193f-4750-9abd-50ec83958294
                stepCounter: ec00abea-1825-4ce7-9891-cf8f5b2f9379
            transform: fact_inpatient_event.present_to_next_event_duration / 1440
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ac81f4d-5011-424b-9139-4f6c7d36d034
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: IP_ADMIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 61d295bc-8396-46a6-b1ff-31d8290f3c25
                stepCounter: ec00abea-1825-4ce7-9891-cf8f5b2f9379
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22b1ef25-f90e-4eaf-9897-edb2588d8daf
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: IP_DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7026bcd6-e15b-4041-b7da-ab187db6c55f
                stepCounter: ec00abea-1825-4ce7-9891-cf8f5b2f9379
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 35b9dab9-c1ce-4c8c-9ce7-e45808584515
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: IP event_total_duration
        name: IP_EVENT_TOTAL_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0e3896ec-1bdf-4289-8c0c-ee5e1ca1a8b1
                stepCounter: ec00abea-1825-4ce7-9891-cf8f5b2f9379
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25b572c8-2a09-4cbb-9414-fd42ecc17ab3
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: 'ip event_length_of_stay '
        name: IP_EVENT_LENGTH_OF_STAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a09e13ea-e0d9-4c69-b494-8ab6919dc0ef
                stepCounter: ec00abea-1825-4ce7-9891-cf8f5b2f9379
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b4f601a-1d4e-4954-af85-b1c17ce3fdb2
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: 'Set to 1 if discharge destination is not WTH, NSH, MASON or TEATA, discharge method is not DT or TA, and the next admittance is acute and within 28 days '
        name: ACUTE_READMIT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1765f56b-0d35-4ff5-8f25-a6b8b77e4f4f
                stepCounter: ec00abea-1825-4ce7-9891-cf8f5b2f9379
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 577f5e3a-d0fe-408c-9f49-e57a47dbbf05
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: IP_ADMIT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d98142f0-f261-4055-ad8c-581c6636e853
                stepCounter: 04c42cb2-f015-4d9e-ae6d-9feed9f13b97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a59994e-d549-4da4-8a58-b5885d51ace4
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Service_Point_Code
        name: IP_ADMIT_WARD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1280e451-eee5-4077-9a68-99dfa6db80b6
                stepCounter: 0b4f315f-51cb-4593-8623-b32f3fc664aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d062d85-8cbe-4058-af07-3c5785a2f39b
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Service_Point_Code
        name: IP_DISCHARGE_WARD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a560db27-6701-464b-9baf-e87dbf4c39bd
                stepCounter: eb6e873e-8280-46c0-88b0-99a491465182
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72e3a973-31b6-4160-b09b-947c7f1434a0
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Specialty Code
        name: IP_ADMIT_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d380dd71-9395-4195-beec-653d2db096e6
                stepCounter: 653bb678-9e6b-4b04-9b51-5cbba170a526
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17b7adce-f817-40b9-949c-6a7802729941
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Specialty Code
        name: IP_DISCHARGE_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 68c40bf8-bf84-4e64-9a6f-ad5a370a8f24
                stepCounter: 0a4357f3-ec96-4b4a-843e-aee2051c1131
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 744fc24d-fd72-4bcf-b04a-70101f507a40
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: NUMERIC(38,4)
        defaultValue: ""
        description: ""
        name: IP_ACTUAL_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f6dc497-fa78-4b5c-ab33-99df11f011b9
                stepCounter: ec00abea-1825-4ce7-9891-cf8f5b2f9379
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94675c8e-232b-47be-ab5d-07c201b4d16f
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: Planned price x purchase unit volume
        name: IP_REVENUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e6d82e8-597d-4e09-bd26-905c599c9800
                stepCounter: 6bba0578-7ad6-41df-94c4-5d25f4782845
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ee53694-ec5e-4d43-8574-bcc4d86daf7d
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: INT
        defaultValue: ""
        description: Early warning score
        name: IP_EWS
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9541f5e-7d2a-4be2-b0b5-52dbb649b5a0
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Early warning score date
        name: IP_EWS_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc92df44-2b60-4e68-b9e4-770e56964766
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: DRG_FAMILY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d813e8ea-4028-4791-826e-42fcbc8a87ba
                stepCounter: c9ea96b1-10f0-4480-aff0-b535fb105991
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de19bfb9-130a-4cbc-a980-1e95c68aa939
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Set to 1 if the event has been clinically coded to a DRG.
        name: CODED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 169ff7d1-02b8-4a92-80af-1af74b19be26
                stepCounter: ec00abea-1825-4ce7-9891-cf8f5b2f9379
            transform: |-
              CASE WHEN fact_inpatient_event.coded_flag = 'Y' THEN 1
                          ELSE 0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d15989e2-b155-49c5-a238-13a210cf45e1
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.patient_age_on_arrival_years=dim_age_group.age_years
        name: DIM_AGE_GROUP_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5928abbc-3ae6-4018-8ae6-bcca85cb7d50
                stepCounter: ec00abea-1825-4ce7-9891-cf8f5b2f9379
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8891a34e-f31d-46af-a236-590c09e0abf0
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: This is the domicile code from DIM_PATIENT. This is the domicile code current for the patient at admission.
        name: DIM_DOMICILE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09ce8239-3cb4-496c-9506-1d380814b3bf
                stepCounter: ec00abea-1825-4ce7-9891-cf8f5b2f9379
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b1c0eb5-433e-4b69-b491-5f89b9e73f46
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.patient_reference_no=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4862d46c-0e00-4315-a8f0-fe60846aa0ac
                stepCounter: ec00abea-1825-4ce7-9891-cf8f5b2f9379
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87708f20-9aba-454a-924c-ba1b86f0eda5
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.admission_specialty_reference_no=dim_admission_specialty.admission_specialty_reference_no
        name: DIM_ADMISSION_SPECIALTY_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 32aee58e-46c6-44eb-a8b1-ee82af2da0b1
                stepCounter: ec00abea-1825-4ce7-9891-cf8f5b2f9379
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bfa8f49c-ea0c-468d-a242-dd1bd80c195c
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.admission_method_reference_no=dim_admission_type.admission_method_reference_no
        name: DIM_ADMISSION_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2e60128-b077-486c-b90e-18022d25b932
                stepCounter: 04c42cb2-f015-4d9e-ae6d-9feed9f13b97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8650d4d6-eb4f-4e60-8670-341f8e4fd778
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.admission_ward_reference_no=dim_admission_ward.admission_ward_reference_no
        name: DIM_ADMISSION_WARD_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e9257e15-b41f-4333-94d4-4d738d4e501a
                stepCounter: ec00abea-1825-4ce7-9891-cf8f5b2f9379
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 221acce7-7d23-4f28-a07b-d1c2aad957b3
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.discharge_destination_reference_no=dim_discharge_destination.discharge_destination_reference_no
        name: DIM_DISCHARGE_DESTINATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 01b488ff-c41f-4b95-a631-f7081c6c2d65
                stepCounter: ec00abea-1825-4ce7-9891-cf8f5b2f9379
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f05018b6-e361-4dd3-a06a-d895630b5f8a
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.discharge_method_reference_no=dim_discharge_method.discharge_method_reference_no
        name: DIM_DISCHARGE_METHOD_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91ddf02a-dadb-47da-95f8-63ca9ce0a198
                stepCounter: ec00abea-1825-4ce7-9891-cf8f5b2f9379
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: abf7bd0e-d691-4727-b471-d5dc73380622
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.discharge_clinician_reference_no=dim_discharge_clinician.discharge_clinician_reference_no
        name: DIM_DISCHARGE_CLINICIAN_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fca89af1-38b1-4bbb-b64d-7e8aec90bc6e
                stepCounter: ec00abea-1825-4ce7-9891-cf8f5b2f9379
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be40bbce-8ed4-4560-946b-6359d397d7ca
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.discharge_specialty_reference_no=dim_discharge_specialty.discharge_specialty_reference_no
        name: DIM_DISCHARGE_SPECIALTY_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6fa3ae4b-6a1e-4aa8-ae2b-a8c78e5a866b
                stepCounter: ec00abea-1825-4ce7-9891-cf8f5b2f9379
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 19bc67d5-2b80-48e1-ab59-c4323f325782
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.discharge_ward_reference_no=dim_discharge_ward.discharge_ward_reference_no
        name: DIM_DISCHARGE_WARD_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a00f89d-6b24-4daf-8674-216c3f0e3c80
                stepCounter: ec00abea-1825-4ce7-9891-cf8f5b2f9379
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c5ffd8b-737e-4dad-a215-a0f072b7e360
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.DRG_code=dim_DRG_code.DRG_code  s_in_patient_event_30.CONVERT(varchar(4),dim_discharge_date.discharge_fin_year)=dim_DRG_code.financial_year
        name: DIM_DRG_CODE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd4d89ad-421e-464d-bf5c-77ce3c0f5af7
                stepCounter: ec00abea-1825-4ce7-9891-cf8f5b2f9379
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca52b1ce-6dff-4010-b31c-3d36b5df3a9b
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.hospital_code=dim_hospital.hospital_code
        name: DIM_HOSPITAL_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e744af6-784f-473f-8e35-a82f48cb08b1
                stepCounter: ec00abea-1825-4ce7-9891-cf8f5b2f9379
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a065af3-fc38-452d-ad7c-f48820c083e4
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.diagnosis_code_01=dim_ICD_diagnosis_primary.ICD_code
        name: DIM_ICD_DIAGNOSIS_PRIMARY_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0105225e-6d84-46ed-bec9-160a2e9bbb18
                stepCounter: ec00abea-1825-4ce7-9891-cf8f5b2f9379
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 23a3543f-ecea-4e66-89ef-63a3af1680a2
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.diagnosis_code_02=dim_ICD_diagnosis_secondary.ICD_code
        name: DIM_ICD_DIAGNOSIS_SECONDARY_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7513c64c-1529-4093-b0df-a59a3d91f467
                stepCounter: ec00abea-1825-4ce7-9891-cf8f5b2f9379
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d48a5c2-51e3-4d14-b07c-ff65f151d06b
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.procedure_code_01=dim_ICD_procedure_primary.ICD_code
        name: DIM_ICD_PROCEDURE_PRIMARY_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 54c332f2-2bfa-48f9-b0cb-484a5c858ecd
                stepCounter: ec00abea-1825-4ce7-9891-cf8f5b2f9379
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1fa1aa77-4cf7-45b7-984e-99a36dd5cf14
          stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: FACT_INPATIENT_EVENT
        join:
          joinCondition: |-
            FROM fact.fact_inpatient_event
              JOIN dim.dim_admission_source
                ON fact_inpatient_event.dim_admission_source_key = dim_admission_source.dim_admission_source_key
              JOIN dim.dim_admission_type
                ON fact_inpatient_event.dim_admission_type_key = dim_admission_type.dim_admission_type_key
              JOIN dim.dim_admission_specialty
                ON fact_inpatient_event.dim_admission_specialty_key = dim_admission_specialty.dim_admission_specialty_key
              JOIN dim.dim_discharge_specialty
                ON fact_inpatient_event.dim_discharge_specialty_key = dim_discharge_specialty.dim_discharge_specialty_key
              JOIN dim.dim_admission_ward
                ON fact_inpatient_event.dim_admission_ward_key = dim_admission_ward.dim_admission_ward_key
              JOIN dim.dim_discharge_ward
                ON fact_inpatient_event.dim_discharge_ward_key = dim_discharge_ward.dim_discharge_ward_key
              JOIN dim.dim_discharge_destination
                ON fact_inpatient_event.dim_discharge_destination_key = dim_discharge_destination.dim_discharge_destination_key
              JOIN dim.dim_discharge_method
                ON fact_inpatient_event.dim_discharge_method_key = dim_discharge_method.dim_discharge_method_key
              JOIN dim.dim_DRG_code
                ON fact_inpatient_event.dim_DRG_code_key = dim_DRG_code.dim_DRG_code_key
              JOIN dim.dim_patient
                ON fact_inpatient_event.dim_patient_key = dim_patient.dim_patient_key -- Join back to fact_inpatient_event to get admit type of next event  LEFT OUTER JOIN fact.fact_inpatient_event f2  ON f2.event_encounter_id = fact_inpatient_event.next_event_encounter_id    LEFT OUTER JOIN dim.dim_admission_type d2  ON f2.dim_admission_type_key = d2.dim_admission_type_key    LEFT OUTER JOIN s_PJ_revenue  ON fact_inpatient_event.event_encounter_id = s_PJ_revenue.source_encounter    WHERE fact_inpatient_event.patient_nhi IS NOT NULL
        name: S_PJ_IP_EVENT
        noLinkRefs: []
  name: S_PJ_IP_EVENT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
