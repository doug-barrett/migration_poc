fileVersion: 1
id: be04d7a2-5b30-449c-8b64-8b1becf4d0ba
name: S_IN_PATIENT_WARD_OCCUPANCY_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc4704ee-8ae2-4739-b860-0291f0d7c086
          stepCounter: be04d7a2-5b30-449c-8b64-8b1becf4d0ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_WARD_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cde1ffd1-81c3-4ea2-93d2-18a473e39ac0
                stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 766ee56c-bf36-4483-a021-bba158708517
          stepCounter: be04d7a2-5b30-449c-8b64-8b1becf4d0ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c2d7b3c5-63f0-4222-a0d2-b6f316e7d513
                stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e46d5c2c-7537-4a89-97af-52ef611b3440
          stepCounter: be04d7a2-5b30-449c-8b64-8b1becf4d0ba
        config: {}
        dataType: INT
        defaultValue: ""
        description: ActualBedNumber
        name: ACTUALBEDNUMBER
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a12003bd-1b96-44a6-8f9e-8972c4a1f9f7
                stepCounter: 55c5008b-73cd-4eb2-bc30-a6c466c6ab62
            transform: IFNULL(s_inpatient_bednumbers.ActualBedNumber,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94f33a27-bd31-450b-88e3-014f00199982
          stepCounter: be04d7a2-5b30-449c-8b64-8b1becf4d0ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_00
        name: OCCUPANCY_TIME_SLOT_00
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 26049080-be56-47cf-a911-790975d8b8a9
                stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b218b0aa-1017-4a8f-832d-112cb59bf82c
          stepCounter: be04d7a2-5b30-449c-8b64-8b1becf4d0ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_01
        name: OCCUPANCY_TIME_SLOT_01
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1a569a73-316b-4ebb-b2b2-e3df19d639eb
                stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4aa9bb85-eb59-420f-868c-54d37b080ebc
          stepCounter: be04d7a2-5b30-449c-8b64-8b1becf4d0ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_02
        name: OCCUPANCY_TIME_SLOT_02
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f91c9cd-33a3-430e-a16b-d2c4ddc565dd
                stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f3f76a0-abcc-4ea1-8e2d-d504b7df5ff6
          stepCounter: be04d7a2-5b30-449c-8b64-8b1becf4d0ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_03
        name: OCCUPANCY_TIME_SLOT_03
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f4fc6f6-8f6e-407a-8db8-b590660187d1
                stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b88677f-5983-4ec2-8e9b-a43df4f30c6d
          stepCounter: be04d7a2-5b30-449c-8b64-8b1becf4d0ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_04
        name: OCCUPANCY_TIME_SLOT_04
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5917d817-cc8b-40e7-aad8-5b10bd34f1dd
                stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f0d13ab-5cc8-4b5b-9542-68e7013e63ab
          stepCounter: be04d7a2-5b30-449c-8b64-8b1becf4d0ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_05
        name: OCCUPANCY_TIME_SLOT_05
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d762547-c899-4a48-b4aa-fd946f388df0
                stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb3b6158-d589-4a1d-ba2a-820c9a812bb5
          stepCounter: be04d7a2-5b30-449c-8b64-8b1becf4d0ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_06
        name: OCCUPANCY_TIME_SLOT_06
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0932013a-9eaa-4c5b-91c2-ba052836dbc8
                stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2ee9551-efb7-4325-b455-de6078c3218b
          stepCounter: be04d7a2-5b30-449c-8b64-8b1becf4d0ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_07
        name: OCCUPANCY_TIME_SLOT_07
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3d57c22-cc32-4b58-a95a-8efd84a59ac1
                stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: facd3791-bdce-4c95-8f81-6d57644283aa
          stepCounter: be04d7a2-5b30-449c-8b64-8b1becf4d0ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_08
        name: OCCUPANCY_TIME_SLOT_08
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16c6c01f-ba57-4a29-b777-509ac5c7c555
                stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aec1fa74-cfe5-43c7-a581-f98103d8f8fc
          stepCounter: be04d7a2-5b30-449c-8b64-8b1becf4d0ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_09
        name: OCCUPANCY_TIME_SLOT_09
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1e1a76d-3df2-48d4-832d-f2dc88b15ae6
                stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 122d95fd-50b6-4460-9530-3002ee924d40
          stepCounter: be04d7a2-5b30-449c-8b64-8b1becf4d0ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_10
        name: OCCUPANCY_TIME_SLOT_10
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f3aa0aa-5774-4140-ae21-572ef9b4717a
                stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8f9759e-2c97-45c4-8c71-751d9ee98768
          stepCounter: be04d7a2-5b30-449c-8b64-8b1becf4d0ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_11
        name: OCCUPANCY_TIME_SLOT_11
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f13574c9-9b20-4dc0-a34b-01f292bedb41
                stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6cbd6966-4e5f-4c8f-98c5-3e4b6447f3cd
          stepCounter: be04d7a2-5b30-449c-8b64-8b1becf4d0ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_12
        name: OCCUPANCY_TIME_SLOT_12
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2160b95a-74f2-41ea-953d-976bb4e18829
                stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f70a67d7-7ab3-4d77-959f-d49b7cd291cb
          stepCounter: be04d7a2-5b30-449c-8b64-8b1becf4d0ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_13
        name: OCCUPANCY_TIME_SLOT_13
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a9ddeb1b-9c71-4d42-8ac1-989c80a50763
                stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5226ad9-4e53-434e-874d-0e774fdbbddd
          stepCounter: be04d7a2-5b30-449c-8b64-8b1becf4d0ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_14
        name: OCCUPANCY_TIME_SLOT_14
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02cda9b1-42a7-4a47-ad8f-ea05345113b0
                stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2cdb8d24-2e57-43b1-b354-50b28cd53033
          stepCounter: be04d7a2-5b30-449c-8b64-8b1becf4d0ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_15
        name: OCCUPANCY_TIME_SLOT_15
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 98600e03-4a28-45f8-9d19-90b94918021f
                stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8836086-6a6b-4fd0-bd42-a85a6774836d
          stepCounter: be04d7a2-5b30-449c-8b64-8b1becf4d0ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_16
        name: OCCUPANCY_TIME_SLOT_16
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 96aebfc0-02cd-492b-84af-41fa7a6e458e
                stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5a8564b-7c35-4cc9-b471-2cb2730615cf
          stepCounter: be04d7a2-5b30-449c-8b64-8b1becf4d0ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_17
        name: OCCUPANCY_TIME_SLOT_17
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67742463-5978-46e4-bd28-818a2177367e
                stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98fb7dec-51d7-4732-81eb-0f76cea40928
          stepCounter: be04d7a2-5b30-449c-8b64-8b1becf4d0ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_18
        name: OCCUPANCY_TIME_SLOT_18
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4deba310-fcdc-4aa1-b073-7df773497af0
                stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f4b26d37-4337-44f6-93c3-c7544d54797e
          stepCounter: be04d7a2-5b30-449c-8b64-8b1becf4d0ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_19
        name: OCCUPANCY_TIME_SLOT_19
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6630305a-0a15-4f0c-8306-42f3faf7a971
                stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5463220-305e-4041-a23d-007a4e764a84
          stepCounter: be04d7a2-5b30-449c-8b64-8b1becf4d0ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_20
        name: OCCUPANCY_TIME_SLOT_20
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c16067e-cd92-4dc2-aaf1-470aad1299c0
                stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 224f1267-ac37-4380-82a9-1a757a36055c
          stepCounter: be04d7a2-5b30-449c-8b64-8b1becf4d0ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_21
        name: OCCUPANCY_TIME_SLOT_21
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6cbfbfdc-1f98-445e-a92c-fa0b524c2464
                stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 23c714aa-aafb-4cf1-a29b-2bf6e6357755
          stepCounter: be04d7a2-5b30-449c-8b64-8b1becf4d0ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_22
        name: OCCUPANCY_TIME_SLOT_22
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c8829f8f-8c1e-4a29-adde-b68206845b6a
                stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33d48851-4d60-45d6-9219-e4511654c097
          stepCounter: be04d7a2-5b30-449c-8b64-8b1becf4d0ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_23
        name: OCCUPANCY_TIME_SLOT_23
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f5a7282e-5d3e-44b3-b376-fcd97fd0d9f2
                stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a11b88ff-407d-45fb-bccb-a82c5f487e35
          stepCounter: be04d7a2-5b30-449c-8b64-8b1becf4d0ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_sum
        name: OCCUPANCY_SUM
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 92889cd0-5fe0-4486-92d0-0b39e75c51a3
                stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb57e16d-ff99-425e-b127-ec7be0d1a2f9
          stepCounter: be04d7a2-5b30-449c-8b64-8b1becf4d0ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_avg
        name: OCCUPANCY_AVG
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 08ee0762-c108-4cca-9f00-34cd4b1183c9
                stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5fc94013-8504-4dd9-a159-8dffc26468b0
          stepCounter: be04d7a2-5b30-449c-8b64-8b1becf4d0ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_min
        name: OCCUPANCY_MIN
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2ee8172-35cd-46e4-947e-4c9bfd6d1016
                stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c63e147-1e94-4d0b-82ae-0f9a98a7ae71
          stepCounter: be04d7a2-5b30-449c-8b64-8b1becf4d0ba
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: occupancy_min_time_slots
        name: OCCUPANCY_MIN_TIME_SLOTS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f34fdcc-2226-4cfa-808c-4ba6274b81af
                stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bcd660f3-cd89-4c7c-a78d-adf3fbe3aa8e
          stepCounter: be04d7a2-5b30-449c-8b64-8b1becf4d0ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_max
        name: OCCUPANCY_MAX
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eea43024-5f60-44a1-b157-e1f227e74e05
                stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc19ccd2-ef32-41f4-a70e-6e14fcc34404
          stepCounter: be04d7a2-5b30-449c-8b64-8b1becf4d0ba
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: occupancy_max_time_slots
        name: OCCUPANCY_MAX_TIME_SLOTS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f1f1b9ae-889d-495c-8281-5773dcddd900
                stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0dd2c337-d3d2-40c8-bfd0-d9807fe47bfe
          stepCounter: be04d7a2-5b30-449c-8b64-8b1becf4d0ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: admission_transfer_in
        name: ADMISSION_TRANSFER_IN
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d5d10759-7f4c-41cc-bf67-b8734078f584
                stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d348a129-4a56-4fe4-af19-7b9462fc3e99
          stepCounter: be04d7a2-5b30-449c-8b64-8b1becf4d0ba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: discharge_transfer_out
        name: DISCHARGE_TRANSFER_OUT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e94a1293-43ca-4427-8a54-4d99bc7f6c26
                stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95e0698e-33cd-47ad-bb1f-39db268f35cc
          stepCounter: be04d7a2-5b30-449c-8b64-8b1becf4d0ba
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_IN_PATIENT_WARD_OCCUPANCY: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
          S_INPATIENT_BEDNUMBERS: 55c5008b-73cd-4eb2-bc30-a6c466c6ab62
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_IN_PATIENT_WARD_OCCUPANCY
          - locationName: TGT
            nodeName: S_INPATIENT_BEDNUMBERS
        join:
          joinCondition: |-
            FROM {{ ref('TGT','S_IN_PATIENT_WARD_OCCUPANCY') }}
              LEFT JOIN (
                    SELECT dim_date_key,
                           dim_Ward_key,
                           Sum(ActualBedNumber) actualBedNumber
                      FROM {{ ref('TGT','S_INPATIENT_BEDNUMBERS') }}
                     GROUP BY dim_date_key,
                              dim_Ward_key
                   ) s_inpatient_bednumbers
                ON s_in_patient_ward_Occupancy.dim_date_key = s_inpatient_bednumbers.dim_date_key
               AND s_in_patient_ward_Occupancy.dim_ward_key = s_inpatient_bednumbers.dim_ward_key
        name: S_IN_PATIENT_WARD_OCCUPANCY_10
        noLinkRefs: []
  name: S_IN_PATIENT_WARD_OCCUPANCY_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
