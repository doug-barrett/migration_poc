fileVersion: 1
id: 2c28a593-5ca6-4a14-a594-8ce519810e2b
name: S_ED_PURCHASE_UNIT_MAP
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ec9e546-0cd1-455a-a408-36bde5643888
          stepCounter: 2c28a593-5ca6-4a14-a594-8ce519810e2b
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ROW_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9b47349f-2774-4a17-b68b-3aa8512e311d
                stepCounter: c4c1b06c-f7e8-4f51-8298-efe01b1d01d3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b40dbb9-5196-462b-81e7-2baa0bc9cc3b
          stepCounter: 2c28a593-5ca6-4a14-a594-8ce519810e2b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: HEALTH_ORG_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 637caab7-2d5e-4e1e-ab28-0a4ac2de1981
                stepCounter: c4c1b06c-f7e8-4f51-8298-efe01b1d01d3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92089467-5c35-4de0-b426-7d79021a93e2
          stepCounter: 2c28a593-5ca6-4a14-a594-8ce519810e2b
        config: {}
        dataType: NUMERIC(10)
        defaultValue: ""
        description: ""
        name: SERVICE_POINT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0de2a92b-ed18-472b-b1fe-eabf74536018
                stepCounter: c4c1b06c-f7e8-4f51-8298-efe01b1d01d3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e1bec16-6386-4e2a-8d36-d7c5861ab529
          stepCounter: 2c28a593-5ca6-4a14-a594-8ce519810e2b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 021b21e2-d605-47e5-8926-351aa7864291
                stepCounter: c4c1b06c-f7e8-4f51-8298-efe01b1d01d3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f916f312-c3e4-476b-b77f-44b1e995eff1
          stepCounter: 2c28a593-5ca6-4a14-a594-8ce519810e2b
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: INPATIENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 237ab61d-8f74-41ba-96b7-2d50dca4ea34
                stepCounter: c4c1b06c-f7e8-4f51-8298-efe01b1d01d3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5cb99e65-e050-4d71-a046-b8fbdcedbce1
          stepCounter: 2c28a593-5ca6-4a14-a594-8ce519810e2b
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: patient is triaged in ED and moves straight to ADU
        name: ADU_DIRECT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 63ca6b27-323a-4059-b868-aa8d27d045d5
                stepCounter: c4c1b06c-f7e8-4f51-8298-efe01b1d01d3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ca451e0-a280-4523-87e1-b44d8801a2f0
          stepCounter: 2c28a593-5ca6-4a14-a594-8ce519810e2b
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ADU_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b7af824f-3eb2-4cb3-a03a-9519e686edde
                stepCounter: c4c1b06c-f7e8-4f51-8298-efe01b1d01d3
            transform: |-
              CASE l_mappings_PurchaseUnit_ED.adu
                          WHEN 'Y'                       THEN 'Y'
                          WHEN 'N'                       THEN 'N'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8bacbfba-0472-449b-beb1-d7307fe90d78
          stepCounter: 2c28a593-5ca6-4a14-a594-8ce519810e2b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DEPARTURE_FROM_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8511cdac-9641-4534-b8fd-2e2a9060a0d2
                stepCounter: c4c1b06c-f7e8-4f51-8298-efe01b1d01d3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88b1f0e4-ead4-4c97-b935-f7ce100e1a36
          stepCounter: 2c28a593-5ca6-4a14-a594-8ce519810e2b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DEPARTURE_TO_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c6337cf-5441-41ed-95fc-a944eaca35d5
                stepCounter: c4c1b06c-f7e8-4f51-8298-efe01b1d01d3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b246d5af-e192-4551-bf28-531fd4bac430
          stepCounter: 2c28a593-5ca6-4a14-a594-8ce519810e2b
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: MAPPED_IND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6492993e-8a3d-48d9-9fe1-74828b1be68e
                stepCounter: c4c1b06c-f7e8-4f51-8298-efe01b1d01d3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e64b8c8b-0491-4a6f-8cb3-4d2bffca6c94
          stepCounter: 2c28a593-5ca6-4a14-a594-8ce519810e2b
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: DISCHARGE_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa874cb0-983e-4110-bfcf-25224ee5ba72
                stepCounter: c4c1b06c-f7e8-4f51-8298-efe01b1d01d3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ceb8ead2-f677-4b09-83ff-7e1a124a6c9f
          stepCounter: 2c28a593-5ca6-4a14-a594-8ce519810e2b
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: DISCHARGE_REASON_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67d01b32-4b42-4d46-9a98-045194b30bac
                stepCounter: c4c1b06c-f7e8-4f51-8298-efe01b1d01d3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c6afe2c-d2f7-4ee1-8e89-f68a2d49a025
          stepCounter: 2c28a593-5ca6-4a14-a594-8ce519810e2b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DATE_ADDED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 15492106-e263-4ba9-8fe2-323d9365dbae
                stepCounter: c4c1b06c-f7e8-4f51-8298-efe01b1d01d3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 163f31ef-002f-4bf9-93ff-d32dc6b1ec22
          stepCounter: 2c28a593-5ca6-4a14-a594-8ce519810e2b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: L_MAPPINGS_PURCHASEUNIT_ED
        join:
          joinCondition: |-
            FROM l_mappings_PurchaseUnit_ED
              LEFT OUTER JOIN dim.dim_health_facility dim_health_facility
                ON l_mappings_PurchaseUnit_ED.hospital = dim_health_facility.health_facility_code
               AND l_mappings_PurchaseUnit_ED.start_date BETWEEN dim_health_facility.dss_start_date AND dim_health_facility.dss_end_date
        name: S_ED_PURCHASE_UNIT_MAP
        noLinkRefs: []
  name: S_ED_PURCHASE_UNIT_MAP
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
