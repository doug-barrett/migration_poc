fileVersion: 1
id: 8fcbab2a-5651-4c83-a5a4-0d995af68072
name: S_NEXUS_VISIT_20
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4bc32e82-651f-443d-925e-73c677095c72
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: IP_EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 62e4217d-0c51-4314-97f7-cbc01f78c17d
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75939db3-2acc-4ab9-9fea-48c051b9b750
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: scheduled_operation_duration
        name: SCHEDULED_OPERATION_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: datediff(MINUTE,s_nexus_visit_10.surgery_start_date,s_nexus_visit_10.surgery_completion_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91024741-80f3-416a-8209-914087f56365
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: 'The sequence number of the operation within a single session. '
        name: SESSION_THEATRE_VISIT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN s_nexus_visit_10.status <> 'CANC' AND s_nexus_visit_10.into_theatre_date IS NOT NULL THEN ROW_NUMBER() OVER (PARTITION BY (CASE WHEN s_nexus_visit_10.status <> 'CANC' AND s_nexus_visit_10.into_theatre_date IS NOT NULL THEN s_nexus_visit_10.theatre_session_reference_no ELSE NULL END) ORDER BY IFNULL(s_nexus_visit_10.into_theatre_date,s_nexus_visit_10.sent_for_date))
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3edfce47-9919-4feb-abc2-aa82263bbae7
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_THEATRE_VISIT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN s_nexus_visit_10.status <> 'CANC' AND s_nexus_visit_10.into_theatre_date IS NOT NULL THEN COUNT(1) OVER (PARTITION BY (CASE WHEN s_nexus_visit_10.status <> 'CANC' AND s_nexus_visit_10.into_theatre_date IS NOT NULL THEN s_nexus_visit_10.theatre_session_reference_no ELSE NULL END))
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 345ec80b-191d-4550-8ca9-3e4bf8a4c455
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(12)
        defaultValue: ""
        description: ""
        name: THEATRE_VISIT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 778b3cd8-0ec5-4c1d-8000-3e68a6cf01d0
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a50f6a14-691d-49a9-a96d-f147395d393a
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(11)
        defaultValue: ""
        description: ""
        name: THEATRE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4a2ab85-0d71-4497-8b89-354e03dc2eb6
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32001d98-fb74-4d23-9732-43f2bac42c56
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: OPSEQUENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22657467-08c0-4738-8fe7-052195b4756b
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: baf9600d-f19d-43d1-98fb-ea98a39db72e
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: OPNUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de732850-e908-458c-845c-5887ae8fcd7e
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6c1a1d5-1c34-41bf-bb4e-2103c33894db
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: ""
        name: THEATRE_SESSION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 66d9a2cc-a1a3-46e8-8b78-60474a91cf4f
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1cfbefc1-62e9-4c24-b0dd-6b60e436a07a
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b5250082-1dd1-4179-8cae-66d2d61d9b6a
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae1ab3ff-84cd-479a-ad38-ccfcdea9c628
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: NVARCHAR(20)
        defaultValue: ""
        description: ""
        name: REFERRAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 462a8519-8ed8-4978-9df5-d758e6e21e22
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: |-
              CASE WHEN s_in_patient_event_05.refrl_refno IS NULL THEN NULL
                          ELSE cast(s_in_patient_event_05.refrl_refno AS varchar)
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d487e9b-0f89-4e97-9b03-e0ec20ee70cb
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 70da2c74-40e3-4185-a872-150229ea1749
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ddfe61c-6ab7-438d-b9ff-1d3fb13c9f00
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: SESSION_SPEC_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f3b165d7-a933-4dd0-a532-6283f044c591
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 291d2d13-a411-4c36-8973-d8a8d70f2c36
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CANCELLED_BY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c49dd07a-f56c-4b5e-a627-5e04b02c6137
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2df8f621-272c-4815-add6-14e8d2954433
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CANCELCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c56b6a54-b51f-4239-8eba-a72bd35029c4
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a794fbe3-b15d-42d4-af74-28449f0fba89
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CANCELDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0dbd16f4-048c-4c2a-9df6-6d3f9e639072
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d4e7ca0-4807-4de5-9316-0df555f55d1e
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PATIENTOWNER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f69e462f-1f2c-4f67-bbaa-3f4a2d9cc3ed
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c200f5b6-8419-4619-b483-974d22c6675c
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: theatre_clinician_reference_no
        name: THEATRE_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f668e181-c210-4b5b-9973-2e44951785d7
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47a748a6-1273-44d9-b109-c3be4b883426
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PRIMARYSURGEON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5b7a3db8-af20-4a0a-be33-23f86ef37695
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c431df7-75f5-4144-a1e6-9c2757fea0f7
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: SCHEDULE_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c0b0a53b-b789-44ac-9b05-99a3577486fd
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: LEFT(s_nexus_visit_10.schedule_status_code,1)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 122110a5-d178-4f4b-a748-0e21419467c0
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PRIMARYANAESTHETIST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8a14a088-5819-4d34-85d1-d75e37d40264
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 93ffeaf3-a0ed-43d7-b5d1-0468c9b5ce5d
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: INTHEATRECOMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 788a30f4-d597-49bc-a3f2-a9a24e524442
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3c4a25e-8a24-4e40-8e42-2ffd69165b2d
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: ASSISTANTSURGEON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e3fd4b61-8bcf-407e-b2d6-d1755692baca
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d12ba533-b914-4fb6-ad69-36f9207c94e5
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: SECONDARYSURGEON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8d13c2b9-e8e6-4487-a2b8-7977fd7aa890
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 518aab7d-edf6-442f-84a5-a86af1d0a180
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: THEATRE_COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4088eaef-012d-438f-9a03-76bd6ba67612
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2bee3e05-6f54-4b70-b168-b5539c86ff54
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: CANCELLED_SESSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa8ea814-e168-4a8c-b42d-0ae03b08f693
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8d66299-c7ec-4c57-84ac-a8e557014dcf
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: PRIMARY_PROCEDURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ba24c194-824e-4a76-bbe1-b3d031eed119
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d32c4dff-fa29-4b79-ad39-506d50af4984
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: SECONDARY_PROCEDURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0e776540-4764-4937-a8ac-6a8c287a929b
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a5769dc-6b23-47c2-91f3-d897140ae1f9
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: THIRD_PROCEDURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f26e3d51-ee34-4188-87e5-5037dd69b611
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a2a4c1e-86f7-467f-83b2-f90617d99480
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: FOURTH_PROCEDURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: be15af8d-b042-48d3-a837-7e2e2d9cf7a1
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e6c276d-4d00-40c9-9426-6c9e9c02c6e1
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: FIFTH_PROCEDURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f2c41cf-e820-448c-b8f8-e5b59c5eef37
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: beef7225-1e4a-4ff1-b42b-776b254368ad
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: SIXTH_PROCEDURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 30b31cb9-599d-4183-b539-0ff56032add5
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22cf28a6-b223-488a-ad19-36cc3c0d4f5f
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: SEVENTH_PROCEDURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 86499e93-5898-4d7b-9cc8-5e03ec197a3d
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86e61c45-4029-48e6-8271-5746efbf3eda
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: EIGHTH_PROCEDURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 966778d4-d130-4204-a1cd-4101098694de
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 828280d8-e5d8-4045-88fe-4dcbb5184f57
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: NINTH_PROCEDURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 478fafb7-cf9c-4c6a-9db8-ec525f01f4d2
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa266d38-d7de-4974-ab6d-d13f89021e2b
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: WARD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fcd45c8c-3e99-45b8-90df-e27d744fc425
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d17841a-6f09-4be8-826d-e3c78bfbeca1
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: transferred_to_Ward_reference_no
        name: TRANSFERRED_TO_WARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4101644d-b568-42e7-b623-ccd8881fbfeb
                stepCounter: 6770796c-83a0-41f1-ad11-ff4993964d33
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82c7e121-9134-4dd4-aff7-6b524579022a
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(60)
        defaultValue: ""
        description: ""
        name: SCHEDULE_CANCELLED_REASON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e043a0d4-45ba-4dbf-ba2e-a860fe4fa88a
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a21f26b-e2a2-45a3-bfa3-2b673e6a9eb4
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: VISITDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: coalesce(s_nexus_visit_10.arrived_date,s_nexus_visit_10.sent_for_date,cast(s_nexus_visit_10.session_start_date AS date))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f0f6c39-5fd6-4861-9b78-b789b7dd0b0c
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SENT_FOR_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: abb85c66-5ea2-4c2b-bbc1-ae080bd4a7f1
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1bc01add-81f1-4a28-951c-585d817a85f2
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ARRIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f932e21-c2aa-485d-b01a-b9261a1a12b8
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ade5c483-4794-4c62-bdda-a4b8d839992e
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: BOOKED_START
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4aa139a-fab5-4d23-9627-43f961f44298
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf64ca5e-0f3b-4e46-a90f-00ca50120285
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PATIENT_READY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 25a6b28c-a492-47c7-9686-90abe37487c5
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1bc01d54-e252-42e9-baea-9f29be6b51f2
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: INTO_THEATRE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3f549256-975b-46da-bc48-f13d19921664
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: |-
              CASE WHEN anaesthetic_start_date IS NULL THEN s_nexus_visit_10.into_theatre_date
                          ELSE CASE WHEN anaesthetic_start_date < s_nexus_visit_10.into_theatre_date THEN anaesthetic_start_date ELSE s_nexus_visit_10.into_theatre_date END
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7d5f3a7-0c32-4464-93c7-6c77462765f9
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ANAESTHETIC_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de1ca5c5-50dd-4a8b-ba52-f60db028247a
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4aecc681-a701-401b-a948-a8e4a4346d7c
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SURGERY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8453d136-bc51-467d-a579-96d26b4dcdf6
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5591eaa7-3268-4e12-987a-06ddabb9dc02
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SURGERY_COMPLETION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d3063e5-e0c8-4f5a-aa71-c65cc503be50
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b21e012-e0c0-4cbc-834b-f891c72f6716
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: OUTOF_THEATRE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1414077-38a4-48f3-b8d4-440ac31c8144
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49ced345-59f6-49f3-9452-52c38201ec52
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: INTO_POSTOP_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8aa82cb8-6d22-40e2-9a9c-471bf873194c
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d4a5f2e-e048-4a56-b30c-b4cd836ae82a
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SECOND_RECOVERY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e67509e7-fc0f-48c3-9aab-455873c39583
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8dba6f3-3886-49f7-8f11-e2159ca1131c
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: OUTOF_RECOVERY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 08650836-2d86-49aa-a5c5-a21b9fae2deb
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f897746a-5dc7-48c3-a58a-94f6a91c2aab
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WARD_PHONED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 540e1cda-ff00-4373-bd4e-5d1a0c961da6
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: accb9250-7a5b-49b4-a26c-8e86860f52c1
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: URGENCY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 948fd801-0956-478a-869b-1d756a0c18c3
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fdf76b0c-3dfa-4291-9e99-0e31288497d8
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: AN_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d25f4867-c33f-433e-a62e-cd4148699a20
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a262ed9-4e73-4873-a4e5-3573cb266b39
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: ASA_RATING
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea6b23b1-3963-4b1b-b380-8308c88196df
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7dfb6a43-2da5-46bf-a509-bfac8dee0245
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: OP_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 49295549-0d71-4482-90c0-60780c797586
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 823979c5-b8b4-4d07-8951-e13216f5c74b
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: OUTCOME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18d97857-2dc9-47be-9b17-3a87e0031683
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9741228-375e-4aa7-94c6-040349a3ac13
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: OUTCOME_REASON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9cef2a69-87e9-4905-8bb0-451e009be070
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8185bb7-9750-4d77-8431-c827964b9840
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8145d92f-bb13-4e2c-a944-89ecb0979ec5
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0796a9fe-8c71-4106-b679-1fe3d44c38bc
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78702f08-2ff7-4e1f-ae80-6e29bab8c917
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5edd3a6f-4f62-4f97-bd1f-63fc747de806
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6452bdc9-a9d0-4ba5-b6d1-0b4342ce9b75
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7f2f8d3-d7ce-49b6-8f2f-88453cd38eb6
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIFY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f76970c-00cc-40b4-b47f-b71fcdaab69f
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01dd51b7-bb3e-45dd-9bc8-d83f553fe7ce
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: MODIFY_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: feba32d0-38b6-4b96-bdb2-586aa498f325
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec8246e8-6e15-4206-811e-4912807bbabe
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: ""
        name: TOPA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a64ba902-0bb2-46c9-aac1-8699bfcfd096
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b833b6d-811f-4ea7-92b7-f7bae5c15bd1
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: Generated artificial key
        name: DIM_SECONDARY_SURGEON_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c804dedf-d7f4-4f61-aa06-e7dcdb830cf5
                stepCounter: fedaecf2-27f1-40c5-b9f1-455da2cd1a31
            transform: IFNULL(dim_secondary_surgeon.dim_secondary_surgeon_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 999562fe-34de-4ce6-9a72-2090525b8963
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: Generated artificial key
        name: DIM_THEATRE_OUTCOME_REASON_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: df90a97d-0bac-4788-b114-3566f244fe56
                stepCounter: 758cdf8c-f697-4c4d-8f70-a8c4f0544cd5
            transform: IFNULL(dim_theatre_outcome_reason.dim_theatre_outcome_reason_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cee5e455-6104-48e3-b40c-92b6fbbfd746
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: Generated artificial key
        name: DIM_ASSISTANT_SURGEON_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ca427f4-493a-4644-b407-6bcaa6e365da
                stepCounter: 3463df56-df3e-4352-a034-ff319d1bd67e
            transform: IFNULL(dim_assistant_surgeon.dim_assistant_surgeon_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dbb0bb0b-a5ce-4c6a-97cd-1fbc73e3a5ce
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: Generated artificial key
        name: DIM_TOPA_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d7a0733c-2305-49ed-b405-b160f378298f
                stepCounter: 6905366c-b398-4f33-89a4-4f009323cef8
            transform: IFNULL(dim_TOPA.dim_TOPA_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81fcf72f-be1d-49f3-be15-6028177e39c6
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: Generated artificial key
        name: DIM_PRIMARY_ANAESTHETIST_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78ee8786-43e1-4e88-93c1-ec1c69fd8b19
                stepCounter: 6eb6705c-4746-482c-9832-9b9219afdbf0
            transform: IFNULL(dim_primary_anaesthetist.dim_primary_anaesthetist_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05091a93-9ae6-47d1-95e1-3d0a827143dd
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: Generated artificial key
        name: DIM_PRIMARY_SURGEON_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f6ab2957-a519-47f8-a879-654b61051ba3
                stepCounter: 8c462b09-f478-4ea0-81f8-b6dbe3fab303
            transform: IFNULL(dim_primary_surgeon.dim_primary_surgeon_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 545373ca-4ed0-49ad-a838-54db305483c1
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: Generated artificial key
        name: DIM_THEATRE_OUTCOME_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9da74729-f292-4b8a-b8cc-637a1fe58c6d
                stepCounter: 31986792-e4e5-492f-9f0c-71b21c803c24
            transform: IFNULL(dim_theatre_outcome.dim_theatre_outcome_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af8503fc-67e7-41bd-bd6c-04e2b5765d6f
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: Generated artificial key
        name: DIM_REFERRED_BY_SPECIALTY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5828d4e8-80d5-452a-9532-dff1103e8323
                stepCounter: e415e3de-b985-40b9-ba95-2461cc5e63b4
            transform: IFNULL(dim_referred_by_specialty.dim_referred_by_specialty_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a2eb03a-9ea7-461b-bbc2-c18868be2fb9
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: Generated artificial key
        name: DIM_SESSION_SPECIALTY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 36145fe6-b8a5-4622-989d-3aa6a94e82b6
                stepCounter: a0af56c4-d96c-4a0c-a112-b4ca3e6b911c
            transform: IFNULL(dim_session_specialty.dim_session_specialty_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67af5cc5-290b-40df-89c2-9200950b2731
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: Generated artificial key
        name: DIM_ENCOUNTER_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3ba8df3-db2e-40a1-97dc-d5ad6a5186a7
                stepCounter: 1d0ea6a1-9563-4fb3-a1fa-9d43dbdf296e
            transform: IFNULL(dim_encounter_type.dim_encounter_type_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0020da0b-32ff-4803-afad-d7ec2e30eafd
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9962a01b-5f3d-4c1a-b371-997edef38d0f
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: IFNULL(dim_patient.dim_patient_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1108edd-50fa-477c-9b9e-fcb0c4a865ef
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: Generated artificial key
        name: DIM_THEATRE_SPECIALTY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 324435a4-4cf2-436b-8c5c-95202b4af42b
                stepCounter: 2df2f1e3-81fa-48e7-8567-e35a38c06290
            transform: IFNULL(dim_theatre_specialty.dim_theatre_specialty_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9a89dac-bd53-4dcc-82a2-2c8ed8b09fd7
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: Generated artificial key
        name: DIM_NEXUS_THEATRE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1cbf222e-510d-4327-a62b-31e08af8cb07
                stepCounter: c95281ba-51a7-4ef0-a734-ded537a93ec1
            transform: IFNULL(dim_nexus_THEATRE.dim_nexus_THEATRE_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80824f9d-787d-43bf-b10a-8dbf38fbf3e8
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_nexus_visit_20.an_type=dim_anaes_type.anaesthetic_type_code
        name: DIM_ANAES_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6232bcb3-08a4-493f-8773-33030e01219b
                stepCounter: 3890dfb8-ef60-4e28-b7d9-a10d5b1109ef
            transform: IFNULL(dim_anaes_type.dim_anaes_type_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf600cc7-5d35-47c0-ad15-9facaed73157
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SESSION_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1421f78b-72d0-4a02-a19a-8ba360f6767c
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eda5fc8a-faa4-458f-84f1-3b2fbe813900
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: OPSESSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 32aab115-b138-423a-bb40-9c9bfaa3e6cd
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea28d6ff-670c-48ea-ae82-a8d84ffa49ed
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: REFERRAL_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 86b4dad7-0c18-4dc3-84e6-a649d3c24550
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d280a69-5b4a-4794-a308-dac2f6b1b27c
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: SESSIONOWNER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bce6be80-8892-44c8-834f-521a5d427bb7
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f1619a1-5610-4edc-87f1-003a11c79bfe
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: session_clinician_reference_no
        name: SESSION_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51aaf50b-1017-4be0-a910-bdfe49fb04fe
                stepCounter: 12af29c3-d08b-4bd2-8c36-eb5080bd9bd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7db61fbe-2c80-4436-8daf-227c71b41095
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: SESSION_CANCELLED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d9398b9-82e9-4e9d-9a51-386cf422748c
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 935aeadf-f64a-485f-b11e-e80c41bf11db
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SESSION_CANCELLED_REASON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1382a0cb-2fb2-4d5f-aac5-2791700e8081
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8e7db89-4f30-4312-b924-9d3b5ff220a0
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: OPDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47d84dbe-497d-40bb-8278-8e597814d629
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 12fa89cf-64c0-4fee-a5b3-f1371d0267cc
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: THEATRE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 04b04bfc-dd77-4ad3-8774-4da85df4e532
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 36a76345-435b-43d8-9d29-39240386e833
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: OPTYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 14b0132b-9fdd-468c-8191-9b1e97d702f2
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 775f1bf8-c9f0-41ba-99ef-89c36732c87c
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: IN_THEATRE_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: DATEDIFF(mi,s_nexus_visit_10.into_theatre_date,IFNULL(s_nexus_visit_10.into_postop_date,s_nexus_visit_10.outof_theatre_date))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b8426fb-def0-47da-97c6-32ac603eb804
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: scheduled_anaesthetic_duration
        name: SCHEDULED_ANAESTHETIC_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: DATEDIFF(mi,s_nexus_visit_10.anaesthetic_start_date,COALESCE(s_nexus_visit_10.surgery_completion_date,s_nexus_visit_10.into_postop_date))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c7903f8-2129-4dad-ab13-14ec7acd9b6c
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: KNIFE_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: DATEDIFF(mi,IFNULL(s_nexus_visit_10.surgery_start_date,s_nexus_visit_10.anaesthetic_start_date),COALESCE(s_nexus_visit_10.surgery_completion_date,s_nexus_visit_10.into_postop_date))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e58625e0-5445-4dbb-bc84-ca3fd239b117
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: IN_HOURS_CASE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN CONVERT(TIME,coalesce(s_nexus_visit_10.into_theatre_date,s_nexus_visit_10.surgery_start_date)) BETWEEN '08:00:00' AND '16:59:00' AND DATEPART(dw,coalesce(s_nexus_visit_10.into_theatre_date,s_nexus_visit_10.surgery_start_date)) BETWEEN 2 AND 6 THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2cec2715-3507-4f71-9530-0d9f54eed54e
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: OVERRUN_CASE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN DATEDIFF(mi,s_nexus_visit_10.session_end_date,s_nexus_visit_10.outof_theatre_date) > 30 THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b9a61dca-cefe-4153-8971-88a1b3370a3e
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_THEATRE_VISIT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ROW_NUMBER() OVER (PARTITION BY s_nexus_visit_10.IP_Event_encounter_ID ORDER BY s_nexus_visit_10.session_start_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d083e945-471b-4f95-b147-501e2ddff397
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SESSION_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f384447b-4b5a-4bf0-92a7-19ee56c41260
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40e71107-05a9-49ca-ac40-56cb0d09638f
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_THEATRE_VISIT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: COUNT(1) OVER (PARTITION BY s_nexus_visit_10.patient_NHI)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 518ef717-f976-4148-8fe1-fee9c7631450
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PATIENT_AGE_ON_ARRIVAL_YEARS
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: FLOOR(DATEDIFF(dd,dim_patient.patient_date_of_birth, CASE WHEN IFNULL(dim_patient.patient_date_of_death,s_nexus_visit_10.session_start_date) < s_nexus_visit_10.session_start_date THEN IFNULL(dim_patient.patient_date_of_death,s_nexus_visit_10.session_start_date) ELSE s_nexus_visit_10.session_start_date END) / 365.25)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bec715df-810c-44fc-8924-982b10728fec
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PATIENT_AGE_ON_ARRIVAL_MONTHS
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: FLOOR(DATEDIFF(mm,dim_patient.patient_date_of_birth, CASE WHEN IFNULL(dim_patient.patient_date_of_death,s_nexus_visit_10.session_start_date) < s_nexus_visit_10.session_start_date THEN IFNULL(dim_patient.patient_date_of_death,s_nexus_visit_10.session_start_date) ELSE s_nexus_visit_10.session_start_date END) % 12)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 68eee116-f29f-4e62-ad67-5e5f12417f0c
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: THEATRE_VISIT_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: DATEDIFF(mi,s_nexus_visit_10.into_theatre_date,s_nexus_visit_10.outof_theatre_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f93b51fc-430a-49c9-92b1-2fb07ec13619
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: IP_ADMISSION_METHOD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ded936c1-df5f-4112-846e-cee85f48a62d
                stepCounter: 4eab76ba-7ed8-4976-a2a8-b2f9d2ba3cd5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8bf942d0-7696-49a4-ab34-c638f2c795c8
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: TRANSFERRED_FROM_WARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 545bf5a0-5457-47af-b805-ed1e4ae530f9
                stepCounter: 4eab76ba-7ed8-4976-a2a8-b2f9d2ba3cd5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42a0359d-95bf-43c1-a6fa-69143d1a3ab7
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Acute_flag
        name: ACUTE_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN s_theatre_IP_encounter.IP_admission_method_reference_no = 200598 THEN 'Y'
                          WHEN s_theatre_IP_encounter.IP_admission_method_reference_no = 200599 THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef895654-0941-4a7c-9acf-dfb994f671e5
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: support_anaesthetist
        name: SUPPORT_ANAESTHETIST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5661bc0c-1254-495e-88e4-6c72cc8028fb
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b49adde-df90-4611-ac05-c7d7e638709b
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Booked_end
        name: BOOKED_END
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f5f264c-6b30-450d-b01a-2e2e653591c4
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ac8e25b-3ad6-427b-a643-067a72bbd0e3
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: technician_anaesthetist
        name: TECHNICIAN_ANAESTHETIST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23dd7678-a0f1-4c83-8a13-df8a714837c0
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f021df86-5f0c-44b0-a3ad-6e3944336f61
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: CHAR
        defaultValue: ""
        description: ""
        name: SESSION_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e647358b-bbf3-48f1-a9f2-6a538696ad32
                stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0740b262-7aec-4568-8e42-04a90d96725a
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: theatre_recovery_acuity_reference_no
        name: THEATRE_RECOVERY_ACUITY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 99ff71b1-adc3-43ef-a81f-35807f0c3f95
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_nexus_visit_20.theatre_recovery_acuity_reference_no=dim_theatre_recovery_acuity.theatre_recovery_acuity_reference_no
        name: DIM_THEATRE_RECOVERY_ACUITY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2a611fb2-9d02-4054-a01e-ba0772362a39
                stepCounter: d929564a-f15e-4c59-82f7-b9dcc52c6a9e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f777804-54ff-4ce7-be1d-a42667f2a1bb
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: WAITLIST_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59e0947f-cea2-4eab-949c-3d4307c3c7c7
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: |-
              CASE WHEN s_in_patient_event_05.wlist_refno IS NULL THEN NULL
                          ELSE 'W'+cast(s_in_patient_event_05.wlist_refno AS varchar)
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b767bec-f3cf-446d-b494-0eeeb5feb40c
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ACC_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27284a5d-c222-400a-8cc6-8701fe0abbb1
                stepCounter: 4eab76ba-7ed8-4976-a2a8-b2f9d2ba3cd5
            transform: |-
              CASE WHEN s_theatre_IP_encounter.ACC_claim_no IS NOT NULL THEN 'ACC'
                          ELSE ''
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b85c9d8b-ffd3-4220-9fce-69dcc89b66b6
          stepCounter: 8fcbab2a-5651-4c83-a5a4-0d995af68072
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_THEATRE_IP_ENCOUNTER: 4eab76ba-7ed8-4976-a2a8-b2f9d2ba3cd5
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_NEXUS_VISIT_10
          - locationName: TGT
            nodeName: S_THEATRE_IP_ENCOUNTER
        join:
          joinCondition: |-
            EXTENDED
              FROM s_nexus_visit_10
              LEFT OUTER JOIN dim.dim_patient
                ON dim_patient.patient_NHI = s_nexus_visit_10.patient_NHI
               AND dim_patient.NHI_sequence = 1
              LEFT OUTER JOIN dim.dim_encounter_type
                ON dim_encounter_type.encounter_type_code = left(s_nexus_visit_10.theatre_visit_encounter_id,2)
              LEFT OUTER JOIN dim.dim_theatre_specialty
                ON s_nexus_visit_10.Specialty = dim_theatre_specialty.theatre_specialty_code
               AND coalesce(s_nexus_visit_10.arrived_date,s_nexus_visit_10.sent_for_date,cast(s_nexus_visit_10.session_start_date AS date)) BETWEEN dim_theatre_specialty.dss_start_date AND dim_theatre_specialty.dss_end_date
              LEFT OUTER JOIN dim.dim_referred_by_specialty
                ON s_nexus_visit_10.referral_specialty = dim_referred_by_specialty.referred_by_specialty_code
               AND coalesce(s_nexus_visit_10.arrived_date,s_nexus_visit_10.sent_for_date,cast(s_nexus_visit_10.session_start_date AS date)) BETWEEN dim_referred_by_specialty.dss_start_date AND dim_referred_by_specialty.dss_end_date
              LEFT OUTER JOIN dim.dim_session_specialty
                ON s_nexus_visit_10.Session_spec_code = dim_session_specialty.session_specialty_code
               AND coalesce(s_nexus_visit_10.arrived_date,s_nexus_visit_10.sent_for_date,cast(s_nexus_visit_10.session_start_date AS date)) BETWEEN dim_session_specialty.dss_start_date AND dim_session_specialty.dss_end_date
              LEFT OUTER JOIN dim.dim_theatre_outcome_reason
                ON s_nexus_visit_10.Outcome_reason = dim_theatre_outcome_reason.theatre_outcome_reason_code
               AND coalesce(s_nexus_visit_10.arrived_date,s_nexus_visit_10.sent_for_date,cast(s_nexus_visit_10.session_start_date AS date)) BETWEEN dim_theatre_outcome_reason.dss_start_date AND dim_theatre_outcome_reason.dss_end_date
               AND coalesce(s_nexus_visit_10.arrived_date,s_nexus_visit_10.sent_for_date,cast(s_nexus_visit_10.session_start_date AS date)) BETWEEN dim_theatre_outcome_reason.[theatre_outcome_reason_validity_start_date] AND IFNULL(dim_theatre_outcome_reason.[theatre_outcome_reason_validity_end_date],getdate())
              LEFT OUTER JOIN dim.dim_TOPA
                ON s_nexus_visit_10.topa = dim_TOPA.TOPA_ind
               AND coalesce(s_nexus_visit_10.arrived_date,s_nexus_visit_10.sent_for_date,cast(s_nexus_visit_10.session_start_date AS date)) BETWEEN dim_TOPA.dss_start_date AND dim_TOPA.dss_end_date
              LEFT OUTER JOIN dim.dim_primary_surgeon
                ON s_nexus_visit_10.PrimarySurgeon = dim_primary_surgeon.primary_surgeon_code
               AND coalesce(s_nexus_visit_10.arrived_date,s_nexus_visit_10.sent_for_date,cast(s_nexus_visit_10.session_start_date AS date)) BETWEEN dim_primary_surgeon.primary_surgeon_validity_start_date AND IFNULL(dim_primary_surgeon.primary_surgeon_validity_end_date,getdate())
               AND dim_primary_surgeon.dss_current_Flag = 'Y'
              LEFT OUTER JOIN dim.dim_primary_anaesthetist
                ON s_nexus_visit_10.PrimaryAnaesthetist = dim_primary_anaesthetist.primary_anaesthetist_code
               AND coalesce(s_nexus_visit_10.arrived_date,s_nexus_visit_10.sent_for_date,cast(s_nexus_visit_10.session_start_date AS date)) BETWEEN dim_primary_anaesthetist.primary_anaesthetist_validity_start_date AND IFNULL(dim_primary_anaesthetist.primary_anaesthetist_validity_end_date,getdate())
               AND dim_primary_anaesthetist.dss_current_flag = 'Y'
              LEFT OUTER JOIN dim.dim_assistant_surgeon
                ON s_nexus_visit_10.AssistantSurgeon = dim_assistant_surgeon.assistant_surgeon_code
               AND coalesce(s_nexus_visit_10.arrived_date,s_nexus_visit_10.sent_for_date,cast(s_nexus_visit_10.session_start_date AS date)) BETWEEN dim_assistant_surgeon.dss_start_date AND dim_assistant_surgeon.dss_end_date
              LEFT OUTER JOIN dim.dim_secondary_surgeon
                ON s_nexus_visit_10.SecondarySurgeon = dim_secondary_surgeon.secondary_surgeon_code
               AND coalesce(s_nexus_visit_10.arrived_date,s_nexus_visit_10.sent_for_date,cast(s_nexus_visit_10.session_start_date AS date)) BETWEEN dim_secondary_surgeon.dss_start_date AND dim_secondary_surgeon.dss_end_date
              LEFT OUTER JOIN {{ ref('TGT','S_THEATRE_IP_ENCOUNTER') }}
                ON s_nexus_visit_10.opnumber = s_theatre_IP_encounter.theatre_visit_referen
        name: S_NEXUS_VISIT_20
        noLinkRefs: []
  name: S_NEXUS_VISIT_20
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
