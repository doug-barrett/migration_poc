fileVersion: 1
id: 31d735d9-62b3-430e-b30b-41f9b80f4355
name: AGG_UCSPEND
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: REPORTS
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 30e66e41-8f09-4060-83bd-ba33e16d182b
          stepCounter: 31d735d9-62b3-430e-b30b-41f9b80f4355
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.CAMPUS=UCCAMPUS.UCCAMPUS
        isBusinessKey: true
        name: UCCAMPUSKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7722bd27-0ddd-47ca-8457-679fbe1ff81c
                stepCounter: 68f18dd6-8aa2-44b9-9662-176fea6ef561
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88ef84c0-4a54-4269-8360-a2a191c7c686
          stepCounter: 31d735d9-62b3-430e-b30b-41f9b80f4355
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.CATEGORY_LEVEL_1=UCCATEGORYLEVEL1.UCCATEGORY_LEVEL_1
        isBusinessKey: true
        name: UCCATEGORYLEVEL1KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a8995b6c-4520-4b80-a058-32263f03d229
                stepCounter: 0b884d5a-5198-40b9-bef7-ad0186f46785
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47e995ab-4924-4107-bc3c-0f53f3463ec1
          stepCounter: 31d735d9-62b3-430e-b30b-41f9b80f4355
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.CATEGORY_LEVEL_2=UCCATEGORYLEVEL2.UCCATEGORY_LEVEL_2
        isBusinessKey: true
        name: UCCATEGORYLEVEL2KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a317c715-ffac-4037-98a4-ae3e2a8dc2e3
                stepCounter: 4beb8f7d-a2cf-4676-91c7-4b5900be542f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd00e858-4094-41b2-966f-177d7f27ab2c
          stepCounter: 31d735d9-62b3-430e-b30b-41f9b80f4355
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.CATEGORY_LEVEL_3=UCCATEGORYLEVEL3.UCCATEGORY_LEVEL_3
        isBusinessKey: true
        name: UCCATEGORYLEVEL3KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c9b2968-bbff-411f-a8d6-f3cdfa651fc9
                stepCounter: a05792e7-f417-4e83-b645-62edd8ac8ae8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f958446-417d-44a6-acfb-cde03b35844b
          stepCounter: 31d735d9-62b3-430e-b30b-41f9b80f4355
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.CATEGORY_LEVEL_4=UCCATEGORYLEVEL4.UCCATEGORY_LEVEL_4
        isBusinessKey: true
        name: UCCATEGORYLEVEL4KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c6b7e9d3-9d76-4e0a-b981-b72a0deaaaf8
                stepCounter: 79ac037f-4b68-45ad-9dfc-a1a57d78c7f5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02b106e4-3219-4f9f-8e30-34bfc9db8d53
          stepCounter: 31d735d9-62b3-430e-b30b-41f9b80f4355
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.SUPPLIER=UCSUPPLIER.UCSUPPLIERNAME
        isBusinessKey: true
        name: UCSUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22f8da6b-8786-48cd-8093-a10cb21209c4
                stepCounter: 7820a0c8-94d8-469b-906b-9c4abcdd2e1a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f3939a3-fae3-463a-a705-0d15fcee59c6
          stepCounter: 31d735d9-62b3-430e-b30b-41f9b80f4355
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.UC_TIER_1=UCTIER1.UC_TIER_1
        isBusinessKey: true
        name: UCTIER1KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c46d9a1b-c439-4db7-9e2e-8ef903568845
                stepCounter: 9f9e6c80-b303-4111-b22c-21be4e130fcd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e52dd22d-5f0a-427b-805a-fa6285e6ed4c
          stepCounter: 31d735d9-62b3-430e-b30b-41f9b80f4355
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.UC_TIER_2=UCTIER2.UC_TIER_2
        isBusinessKey: true
        name: UCTIER2KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ed4de24-f073-427f-951d-f21da3a8d8d1
                stepCounter: 8b0973eb-633b-4510-ac11-03a895df54de
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a51d847-a45f-47d4-8844-6e30b04116d9
          stepCounter: 31d735d9-62b3-430e-b30b-41f9b80f4355
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.UC_TIER_3=UCTIER3.UC_TIER_3
        isBusinessKey: true
        name: UCTIER3KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23f2c87f-972a-4201-b4d4-2766ec131948
                stepCounter: c2778636-5dbf-4841-b473-99e12fb6889f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4597e448-82f1-4a64-b84f-0d980962b0e3
          stepCounter: 31d735d9-62b3-430e-b30b-41f9b80f4355
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: UCCOMPONENTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e350cbc-fb51-402d-a8ab-26135e34db96
                stepCounter: 17a9f5fb-68f3-495b-89f7-08af65373c4f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0224dcab-2ff2-47e6-a7df-150acad0430e
          stepCounter: 31d735d9-62b3-430e-b30b-41f9b80f4355
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        isBusinessKey: true
        name: OPSUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7112789a-89d8-490e-8ce4-ab18595fd0c9
                stepCounter: 17a9f5fb-68f3-495b-89f7-08af65373c4f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa098726-e80d-4c5f-aae5-a03dbacc8b9e
          stepCounter: 31d735d9-62b3-430e-b30b-41f9b80f4355
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: OPSUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d54ad55b-c0b6-4499-97b7-ad63c6e40481
                stepCounter: 17a9f5fb-68f3-495b-89f7-08af65373c4f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db98d86f-0f08-47d7-bdce-9e327456b815
          stepCounter: 31d735d9-62b3-430e-b30b-41f9b80f4355
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        isBusinessKey: true
        name: OPCONTRACTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc1ef5c2-e36d-43b5-8408-db598384334f
                stepCounter: 17a9f5fb-68f3-495b-89f7-08af65373c4f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a18a1ab-8f11-4562-9d0b-357df1328b8f
          stepCounter: 31d735d9-62b3-430e-b30b-41f9b80f4355
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: OPCONTRACTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b7001bf7-b470-4110-9ebb-70067e038cf2
                stepCounter: 17a9f5fb-68f3-495b-89f7-08af65373c4f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba12d4dc-760a-48e9-b576-b8213e49669f
          stepCounter: 31d735d9-62b3-430e-b30b-41f9b80f4355
        config: {}
        dataType: INT
        defaultValue: ""
        description: OPCONTRACTMAPPINGSTATUSID
        isBusinessKey: true
        name: OPCONTRACTMAPPINGSTATUSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02b40a12-3f2b-4cc6-ba93-55dfa5234f0b
                stepCounter: 17a9f5fb-68f3-495b-89f7-08af65373c4f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b4f08d8-322b-46d1-bc1b-b0e1764ee010
          stepCounter: 31d735d9-62b3-430e-b30b-41f9b80f4355
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: UCSPEND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d867c822-7cc1-4f17-a83e-7da1ce26e784
                stepCounter: 17a9f5fb-68f3-495b-89f7-08af65373c4f
            transform: SUM(UCSPEND.UCSPEND)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 602a7aee-0a7a-4ae5-8518-8b02fb617d24
          stepCounter: 31d735d9-62b3-430e-b30b-41f9b80f4355
        config: {}
        dataType: INT
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.TRANSACTIONDATE=DIMTRANSACTIONDATE.TRANSACTIONDATE
        isBusinessKey: true
        name: TRANSACTIONDATEKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9633bd23-ea38-4260-9f7e-a79e3214fd0a
                stepCounter: 388d963b-7c6b-4464-a76a-4027878a166d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fccd6866-e87a-47ef-bb81-cd7de8941b01
          stepCounter: 31d735d9-62b3-430e-b30b-41f9b80f4355
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: TRANSACTIONDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8287a576-ae8f-40c7-b344-c5a86048812a
                stepCounter: 17a9f5fb-68f3-495b-89f7-08af65373c4f
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          UCSPEND: 17a9f5fb-68f3-495b-89f7-08af65373c4f
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: DIM_TRANSACTIONDATE
          - locationName: DIM
            nodeName: UCCAMPUS
          - locationName: DIM
            nodeName: UCCATEGORYLEVEL1
          - locationName: DIM
            nodeName: UCCATEGORYLEVEL2
          - locationName: DIM
            nodeName: UCCATEGORYLEVEL3
          - locationName: DIM
            nodeName: UCCATEGORYLEVEL4
          - locationName: DIM
            nodeName: UCSUPPLIER
          - locationName: DIM
            nodeName: UCTIER1
          - locationName: DIM
            nodeName: UCTIER2
          - locationName: DIM
            nodeName: UCTIER3
          - locationName: FACT
            nodeName: UCSPEND
        join:
          joinCondition: |-
            FROM {{ ref('FACT','UCSPEND') }} UCSPEND
             GROUP BY UCSPEND.UCCAMPUSKEY ,
                      UCSPEND.UCCATEGORYLEVEL1KEY ,
                      UCSPEND.UCCATEGORYLEVEL2KEY ,
                      UCSPEND.UCCATEGORYLEVEL3KEY ,
                      UCSPEND.UCCATEGORYLEVEL4KEY ,
                      UCSPEND.UCSUPPLIERKEY ,
                      UCSPEND.UCTIER1KEY ,
                      UCSPEND.UCTIER2KEY ,
                      UCSPEND.UCTIER3KEY ,
                      UCSPEND.UCCOMPONENTKEY ,
                      UCSPEND.OPSUPPLIERKEY ,
                      UCSPEND.OPSUPPLIERID ,
                      UCSPEND.OPCONTRACTKEY ,
                      UCSPEND.OPCONTRACTID ,
                      UCSPEND.OPCONTRACTMAPPINGSTATUSID ,
                      UCSPEND.TRANSACTIONDATEKEY ,
                      UCSPEND.TRANSACTIONDATE
        name: AGGUCSPEND
        noLinkRefs: []
  name: AGG_UCSPEND
  overrideSQL: false
  schema: ""
  sqlType: Agreggate
  type: sql
  version: 1
type: Node
