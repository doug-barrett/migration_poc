fileVersion: 1
id: 06771ebd-97b5-47d3-ba9e-e0b86bf08a26
name: AGG_UCSPEND
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: REPORTS
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5848d10-02b7-4c04-80a4-a1e9cf9dc307
          stepCounter: 06771ebd-97b5-47d3-ba9e-e0b86bf08a26
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.CAMPUS=UCCAMPUS.UCCAMPUS
        isBusinessKey: true
        name: UCCAMPUSKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03272029-1989-49d8-960d-2c8a50596959
                stepCounter: f40ae327-6f80-42a9-8c61-95ea4e2660a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf1218f9-5c61-4687-a5ed-10f5b4c58742
          stepCounter: 06771ebd-97b5-47d3-ba9e-e0b86bf08a26
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.CATEGORY_LEVEL_1=UCCATEGORYLEVEL1.UCCATEGORY_LEVEL_1
        isBusinessKey: true
        name: UCCATEGORYLEVEL1KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 397d805e-0de9-4941-91a1-ba01ec0d884c
                stepCounter: 8e57d829-7ea9-4164-b49f-914f70fbe1d2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b5065e21-2c31-4eef-9eef-ec550c8eceaa
          stepCounter: 06771ebd-97b5-47d3-ba9e-e0b86bf08a26
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.CATEGORY_LEVEL_2=UCCATEGORYLEVEL2.UCCATEGORY_LEVEL_2
        isBusinessKey: true
        name: UCCATEGORYLEVEL2KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 191ee78e-6713-4e81-a5fe-f267dccdbd9b
                stepCounter: 352bb26b-8263-4734-8829-7de040e6083f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e562a39a-adfc-468e-94b1-c72d3e8f21cb
          stepCounter: 06771ebd-97b5-47d3-ba9e-e0b86bf08a26
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.CATEGORY_LEVEL_3=UCCATEGORYLEVEL3.UCCATEGORY_LEVEL_3
        isBusinessKey: true
        name: UCCATEGORYLEVEL3KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 020993a4-6c13-4950-b502-04ba2b2d6513
                stepCounter: 51cce742-430d-4c5f-b3aa-ea9afb67026b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7fa8414-a91a-4f8a-8c60-a865fc7eea70
          stepCounter: 06771ebd-97b5-47d3-ba9e-e0b86bf08a26
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.CATEGORY_LEVEL_4=UCCATEGORYLEVEL4.UCCATEGORY_LEVEL_4
        isBusinessKey: true
        name: UCCATEGORYLEVEL4KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bd2395f1-f207-47b4-8f12-77b342e93add
                stepCounter: 68886680-3108-4330-8e20-0a2d8c6e59d3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c90dd701-53c7-48a0-8547-11c8b2705a04
          stepCounter: 06771ebd-97b5-47d3-ba9e-e0b86bf08a26
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.SUPPLIER=UCSUPPLIER.UCSUPPLIERNAME
        isBusinessKey: true
        name: UCSUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d7a8a752-e58d-40e8-a42e-76f58dc64e6e
                stepCounter: 22e170be-6188-4ed9-853c-516a16b6bc05
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 141f4122-413c-4b47-b861-9b089b59ec54
          stepCounter: 06771ebd-97b5-47d3-ba9e-e0b86bf08a26
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.UC_TIER_1=UCTIER1.UC_TIER_1
        isBusinessKey: true
        name: UCTIER1KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b746d0b8-6a13-467b-b1a5-f6a3e7675ef4
                stepCounter: b0223e8d-5ba0-4917-9c93-55d44da94e2d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a32c7639-9ac7-4705-98bf-0211df42728c
          stepCounter: 06771ebd-97b5-47d3-ba9e-e0b86bf08a26
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.UC_TIER_2=UCTIER2.UC_TIER_2
        isBusinessKey: true
        name: UCTIER2KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5830a42c-d0df-4867-9d0b-1c608a01f3a0
                stepCounter: 2268727b-e354-4105-8a90-15836dd6e4a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 99d79281-535c-45bc-8941-8d7f7acfd09f
          stepCounter: 06771ebd-97b5-47d3-ba9e-e0b86bf08a26
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.UC_TIER_3=UCTIER3.UC_TIER_3
        isBusinessKey: true
        name: UCTIER3KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 928ae745-47fc-4a2f-8ec7-315ad690abe0
                stepCounter: fb248a8b-bbaf-41d1-94fd-40607f2d455d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81016921-f0f0-45bc-92f0-e046e1c33a64
          stepCounter: 06771ebd-97b5-47d3-ba9e-e0b86bf08a26
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: UCCOMPONENTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ccf32072-9bd2-4b30-bdf3-7b7cb48fff8b
                stepCounter: dfbb6ed3-a250-4e1a-a152-2eab11072ba1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b61d17c6-9afa-4f34-a3ff-89caa414d9d5
          stepCounter: 06771ebd-97b5-47d3-ba9e-e0b86bf08a26
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        isBusinessKey: true
        name: OPSUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c975d055-857a-4b7e-9238-eed82677fbe3
                stepCounter: dfbb6ed3-a250-4e1a-a152-2eab11072ba1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4ada938-f65e-4552-81b8-1975f3df23f3
          stepCounter: 06771ebd-97b5-47d3-ba9e-e0b86bf08a26
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: OPSUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1fa779e3-3bd8-4201-b575-fb3ed43e4b03
                stepCounter: dfbb6ed3-a250-4e1a-a152-2eab11072ba1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9f45af8-a91e-4d2c-9191-30f2d7e156bd
          stepCounter: 06771ebd-97b5-47d3-ba9e-e0b86bf08a26
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        isBusinessKey: true
        name: OPCONTRACTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 094b0a0c-e452-43ff-82d8-c0c449631a71
                stepCounter: dfbb6ed3-a250-4e1a-a152-2eab11072ba1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 819b504b-e9ed-45ee-946a-39c640ebc761
          stepCounter: 06771ebd-97b5-47d3-ba9e-e0b86bf08a26
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: OPCONTRACTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ec638f2-a3de-46ed-9b2d-ce5317c88f56
                stepCounter: dfbb6ed3-a250-4e1a-a152-2eab11072ba1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5bb68baa-bc7e-4909-9ccd-6a0529861a63
          stepCounter: 06771ebd-97b5-47d3-ba9e-e0b86bf08a26
        config: {}
        dataType: INT
        defaultValue: ""
        description: OPCONTRACTMAPPINGSTATUSID
        isBusinessKey: true
        name: OPCONTRACTMAPPINGSTATUSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 14c33afd-bdcc-4d85-860f-edf98f0cdae5
                stepCounter: dfbb6ed3-a250-4e1a-a152-2eab11072ba1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77c3debd-762e-4a0f-b5fb-96e9b52ad1e5
          stepCounter: 06771ebd-97b5-47d3-ba9e-e0b86bf08a26
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: UCSPEND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19ad4c00-0164-4c5c-b1ec-304ee5e6a3bc
                stepCounter: dfbb6ed3-a250-4e1a-a152-2eab11072ba1
            transform: SUM(UCSPEND.UCSPEND)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f7869ed-3f53-4972-8360-b24db308ee53
          stepCounter: 06771ebd-97b5-47d3-ba9e-e0b86bf08a26
        config: {}
        dataType: INT
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.TRANSACTIONDATE=DIMTRANSACTIONDATE.TRANSACTIONDATE
        isBusinessKey: true
        name: TRANSACTIONDATEKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1492500-69f4-459a-b955-6b361cafce6b
                stepCounter: 3e31c3d9-a69e-4432-b045-bd91575d1cbf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 276b68b3-a147-414d-87f0-34907e188d24
          stepCounter: 06771ebd-97b5-47d3-ba9e-e0b86bf08a26
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: TRANSACTIONDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 115faa07-7763-45f3-82fc-8355d469b1a3
                stepCounter: dfbb6ed3-a250-4e1a-a152-2eab11072ba1
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          UCSPEND: dfbb6ed3-a250-4e1a-a152-2eab11072ba1
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: DIM_TRANSACTIONDATE
          - locationName: DIM
            nodeName: UCCAMPUS
          - locationName: DIM
            nodeName: UCCATEGORYLEVEL1
          - locationName: DIM
            nodeName: UCCATEGORYLEVEL2
          - locationName: DIM
            nodeName: UCCATEGORYLEVEL3
          - locationName: DIM
            nodeName: UCCATEGORYLEVEL4
          - locationName: DIM
            nodeName: UCSUPPLIER
          - locationName: DIM
            nodeName: UCTIER1
          - locationName: DIM
            nodeName: UCTIER2
          - locationName: DIM
            nodeName: UCTIER3
          - locationName: FACT
            nodeName: UCSPEND
        join:
          joinCondition: |-
            FROM {{ ref('FACT','UCSPEND') }} UCSPEND
             GROUP BY UCSPEND.UCCAMPUSKEY ,
                      UCSPEND.UCCATEGORYLEVEL1KEY ,
                      UCSPEND.UCCATEGORYLEVEL2KEY ,
                      UCSPEND.UCCATEGORYLEVEL3KEY ,
                      UCSPEND.UCCATEGORYLEVEL4KEY ,
                      UCSPEND.UCSUPPLIERKEY ,
                      UCSPEND.UCTIER1KEY ,
                      UCSPEND.UCTIER2KEY ,
                      UCSPEND.UCTIER3KEY ,
                      UCSPEND.UCCOMPONENTKEY ,
                      UCSPEND.OPSUPPLIERKEY ,
                      UCSPEND.OPSUPPLIERID ,
                      UCSPEND.OPCONTRACTKEY ,
                      UCSPEND.OPCONTRACTID ,
                      UCSPEND.OPCONTRACTMAPPINGSTATUSID ,
                      UCSPEND.TRANSACTIONDATEKEY ,
                      UCSPEND.TRANSACTIONDATE
        name: AGGUCSPEND
        noLinkRefs: []
  name: AGG_UCSPEND
  overrideSQL: false
  schema: ""
  sqlType: Agreggate
  type: sql
  version: 1
type: Node
