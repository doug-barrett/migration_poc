fileVersion: 1
id: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
name: S_PJ_JOURNEY
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "All the journey's events that are used to source fact columns have been identified so get the data for these columns from the appropriate source table e.g. s_PJ_ip_event, s_PJ_ed_event etc.  Source table for fact_patient_journey."
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03be379b-2efc-4a43-a50d-0bdfff9a73bf
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Unique ID for a patient journey
        name: JOURNEY_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 15dbefba-904b-4b84-a2a2-ed523a968a08
                stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2bd64fd3-5840-481c-903a-d31e6df19115
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 70753ad4-7f17-4546-b6bd-6a75dc7dd862
                stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df81c12e-69b9-4a55-a0b5-4a4f3168ba12
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Journey number for the patient.
        name: JOURNEY_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 934ad6d9-4efb-465b-8d76-42bd4c3a3d72
                stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72ac2b49-ca87-44f7-bc95-42dc9a819956
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Total number of events for each journey.
        name: JOURNEY_EVENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0015874f-384a-4378-88d6-e2ad0688645d
                stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0201b54c-8b54-4136-82c3-f3970b128b2d
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Total number of ED events for the journey.
        name: ED_EVENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc3e247b-d5f1-40fd-b968-eab653687d38
                stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a58e0cd8-a7f9-4030-bf25-0798d188dd32
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Total number of Inpatient events for the journey.
        name: IP_EVENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 273951e7-4a2b-4f85-b500-f869b308fde1
                stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88f3a5f2-6c3a-4474-b7df-599185d0f8c0
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Total number of theatre events for the journey.
        name: THEATRE_EVENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f9620d51-d0eb-4b83-9b77-2c70c3c1aa99
                stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5565454-dc51-4d48-9783-67c99c2febfe
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: ""
        name: THEATRE_CANCELLED_EVENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47925292-1f3b-423d-97fd-15602ee857ad
                stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f27f2b5a-b6a0-411f-b4b8-ceb6ff1600ce
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: patient age on arrival years
        name: PATIENT_AGE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11af6689-dba5-41ea-94fe-45f10fe38d88
                stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
            transform: ip1.patient_age
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d107fd09-022d-4d81-951a-06e2be155262
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.patient_reference_no=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b1c0eb5-433e-4b69-b491-5f89b9e73f46
                stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
            transform: ip1.dim_patient_key
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 536d754d-9744-41bf-a576-15cd526d7958
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.patient_age_on_arrival_years=dim_age_group.age_years
        name: DIM_AGE_GROUP_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d15989e2-b155-49c5-a238-13a210cf45e1
                stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
            transform: ip1.dim_age_group_key
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b809fa88-01c6-4e26-b87d-5f87a118f357
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: First ED Encounter unique identifier
        name: FIRST_ED_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c73605e7-92c8-4073-846c-772d3f1f718e
                stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9472e82a-ba16-4c79-a575-10848e12656b
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Visit date and time.
        name: ED_PRESENTATION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 88b62899-92f0-432a-8c82-46196fe8a356
                stepCounter: 1f888c0c-c0bc-4225-aebf-0a0cae18c7f0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b99951e-da08-4c33-9d19-317e1ba3f9eb
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time when patient first seen by a clinician.
        name: ED_FIRST_SEEN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed128777-40a1-4afd-a5dd-3b7c3944d789
                stepCounter: 1f888c0c-c0bc-4225-aebf-0a0cae18c7f0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e6cfe26-4a89-4444-aa7a-460adffd46b3
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time patient discharged.
        name: ED_DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2626ea97-6352-4014-8a16-034610c667bf
                stepCounter: 1f888c0c-c0bc-4225-aebf-0a0cae18c7f0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11c40507-9735-47d1-b0bb-df3d6ca8c992
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_attendance_30.hospital_code=dim_hospital.hospital_code
        name: DIM_ED_HOSPITAL_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f6d2a05a-e455-4d4a-82fd-56dae8899238
                stepCounter: 1f888c0c-c0bc-4225-aebf-0a0cae18c7f0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: faf6ca8c-ec04-437c-9d92-923990712178
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_attendance_30.treatmentprotocolid=dim_ED_treatment_protocol.treatment_protocol_no
        name: DIM_ED_TREATMENT_PROTOCOL_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c2c9e0b-2e50-4f6c-85e5-f9f686e9733d
                stepCounter: 1f888c0c-c0bc-4225-aebf-0a0cae18c7f0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d19eb6f-23f1-40d0-aadc-de580a905de6
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Triage code
        name: DIM_ED_TRIAGE_CATEGORY_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e6f878f3-584b-4707-b7d2-4ccf9b41b114
                stepCounter: 1f888c0c-c0bc-4225-aebf-0a0cae18c7f0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 910045a6-3452-4aae-9878-16634a8e0c01
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: First IP Encounter unique identifier
        name: FIRST_IP_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f6b90f61-81e4-451e-b774-c85369327df0
                stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b96366f1-26a6-45af-91a0-1af87dad6d9c
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FIRST_IP_ADMIT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 577f5e3a-d0fe-408c-9f49-e57a47dbbf05
                stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
            transform: ip1.ip_admit_type
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f3df1b50-db4a-4278-af3c-0bc1217f1e1d
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_IP_ADMIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ac81f4d-5011-424b-9139-4f6c7d36d034
                stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
            transform: ip1.ip_admit_date
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77174950-c507-42e1-addd-42a042973245
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_IP_DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22b1ef25-f90e-4eaf-9897-edb2588d8daf
                stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
            transform: ip1.ip_discharge_date
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3578d9b7-f89c-43e5-b56b-c1aeadf08bc8
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.admission_specialty_reference_no=dim_admission_specialty.admission_specialty_reference_no
        name: DIM_FIRST_ADMISSION_SPECIALTY_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 87708f20-9aba-454a-924c-ba1b86f0eda5
                stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
            transform: ip1.dim_admission_specialty_key
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9820b16-1f1d-4dd6-8a02-1e962eb4bbb7
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.admission_method_reference_no=dim_admission_type.admission_method_reference_no
        name: DIM_FIRST_ADMISSION_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bfa8f49c-ea0c-468d-a242-dd1bd80c195c
                stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
            transform: ip1.dim_admission_type_key
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d6c559b-d338-4efd-b6a9-5506ff7138f3
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.discharge_clinician_reference_no=dim_discharge_clinician.discharge_clinician_reference_no
        name: DIM_FIRST_DISCHARGE_CLINICIAN_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: abf7bd0e-d691-4727-b471-d5dc73380622
                stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
            transform: ip1.dim_discharge_clinician_key
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e71e3b9-5b47-4cbc-9fe9-1e2097f9cc9e
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.discharge_specialty_reference_no=dim_discharge_specialty.discharge_specialty_reference_no
        name: DIM_FIRST_DISCHARGE_SPECIALTY_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: be40bbce-8ed4-4560-946b-6359d397d7ca
                stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
            transform: ip1.dim_discharge_specialty_key
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05cd6510-7099-44fa-876b-12944b13a3ca
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: index IP Encounter unique identifier
        name: INDEX_IP_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb909e00-06cb-47e3-b511-660b88308035
                stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8722b28a-0627-4e8c-8e94-e8a06f1f08a3
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Early warning score
        name: IP_EWS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ee53694-ec5e-4d43-8574-bcc4d86daf7d
                stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
            transform: ip2.ip_EWS
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c2b1c8f-d0cd-4ddd-9d25-6d4594029910
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Early warning score date
        name: IP_EWS_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c9541f5e-7d2a-4be2-b0b5-52dbb649b5a0
                stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
            transform: ip2.ip_EWS_date
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32a402c4-8482-4ba4-acc3-8eaa2f9cacb8
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.hospital_code=dim_hospital.hospital_code
        name: DIM_HOSPITAL_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ca52b1ce-6dff-4010-b31c-3d36b5df3a9b
                stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
            transform: ip2.dim_hospital_key
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5fed19b0-dd60-4989-9dd0-90ed1ffb13ff
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.discharge_destination_reference_no=dim_discharge_destination.discharge_destination_reference_no
        name: DIM_DISCHARGE_DESTINATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 221acce7-7d23-4f28-a07b-d1c2aad957b3
                stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
            transform: ip2.dim_discharge_destination_key
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 83d1e5a5-4575-4e72-b93a-83ecd692f84a
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.DRG_code=dim_DRG_code.DRG_code  s_in_patient_event_30.CONVERT(varchar(4),dim_discharge_date.discharge_fin_year)=dim_DRG_code.financial_year
        name: DIM_DRG_CODE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c5ffd8b-737e-4dad-a215-a0f072b7e360
                stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
            transform: ip2.dim_DRG_code_key
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d415684b-62eb-4594-8b9a-a01a982a8b72
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.diagnosis_code_01=dim_ICD_diagnosis_primary.ICD_code
        name: DIM_ICD_DIAGNOSIS_PRIMARY_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a065af3-fc38-452d-ad7c-f48820c083e4
                stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
            transform: ip2.dim_ICD_diagnosis_primary_key
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ff06ec4-50a1-4c6b-82de-0d13b47a8ff2
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.diagnosis_code_02=dim_ICD_diagnosis_secondary.ICD_code
        name: DIM_ICD_DIAGNOSIS_SECONDARY_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23a3543f-ecea-4e66-89ef-63a3af1680a2
                stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
            transform: ip2.dim_ICD_diagnosis_secondary_key
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce532c0f-1b44-4221-b9e8-26f2f3b3beda
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.procedure_code_01=dim_ICD_procedure_primary.ICD_code
        name: DIM_ICD_PROCEDURE_PRIMARY_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4d48a5c2-51e3-4d14-b07c-ff65f151d06b
                stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
            transform: ip2.dim_ICD_procedure_primary_key
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47aecddc-1963-473a-af2a-5b17b3df6a94
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Final IP Encounter unique identifier
        name: FINAL_IP_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a26dc51-08d9-4a70-91e2-d6ea70e4e386
                stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 067ca723-8be3-4554-9ac5-32f47aac3dc2
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FINAL_IP_DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22b1ef25-f90e-4eaf-9897-edb2588d8daf
                stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
            transform: ip3.ip_discharge_date
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8b828ed-61d5-4564-aaae-a450aff7715a
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Number of days between the first admit date and the final discharge date.
        name: TOTAL_LENGTH_OF_STAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22b1ef25-f90e-4eaf-9897-edb2588d8daf
                stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
            transform: DATEDIFF(DD, ip1.ip_admit_date, ip3.ip_discharge_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e246b43-1d83-48a2-965e-38ffc9d10cd4
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.discharge_method_reference_no=dim_discharge_method.discharge_method_reference_no
        name: DIM_FINAL_DISCHARGE_METHOD_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f05018b6-e361-4dd3-a06a-d895630b5f8a
                stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
            transform: ip3.dim_discharge_method_key
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f617b335-1283-4973-adf2-28e3240a77b7
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.discharge_destination_reference_no=dim_discharge_destination.discharge_destination_reference_no
        name: DIM_FINAL_DISCHARGE_DESTINATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 221acce7-7d23-4f28-a07b-d1c2aad957b3
                stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
            transform: ip3.dim_discharge_destination_key
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e08f70fb-77a9-4adf-99b2-6cc71a3c8df6
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.discharge_specialty_reference_no=dim_discharge_specialty.discharge_specialty_reference_no
        name: DIM_FINAL_DISCHARGE_SPECIALTY_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: be40bbce-8ed4-4560-946b-6359d397d7ca
                stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
            transform: ip3.dim_discharge_specialty_key
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a31aa58a-36c4-4655-acea-bf875f3a5d09
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Set to 1 if the includes an IP event where there was a stay at a ward flagged as Interim Care.
        name: INTERIM_CARE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4d269c37-b187-437f-89e3-c1bc1a0f92b9
                stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92333460-60c2-4326-a19c-7ba06a1162af
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Flag indicating whether patient was readmitted within 28 days of final discharge.
        name: ACUTE_READMIT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c21ed81f-d5d0-42ff-96ed-9a1a86338ff7
                stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c402649-4c39-4b76-8cde-7eac2b8b3845
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Set to the encounter ID which caused acute_readmit_flag to be set.
        name: READMIT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ebae34f-1a31-43d2-8afa-fdadffd2e1a7
                stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c22fb384-1c23-4685-b6fd-7df9a0a86253
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: First community referral ID for the journey. If EDARS related will be set to the parent ID.
        name: COMMUNITY_REFERRAL_ENCOUNTER_FIRST_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9afff980-3b1a-4d04-ae35-b76db72184ac
                stepCounter: 9b6e7cca-28b7-4ee0-8acf-dc85e02a24eb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 76d76ec6-5a8e-41b1-8a18-a6a0a8ec2ba3
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: COMMUNITY_DN_FIRST_COMPLETION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ef55056-f202-451f-adab-1ce3eda24352
                stepCounter: 9b6e7cca-28b7-4ee0-8acf-dc85e02a24eb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a08c283-4786-44b9-bb8c-c480c0b81304
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: COMMUNITY_DT_FIRST_COMPLETION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc94910d-9e45-47ac-a6af-4649367e4e1e
                stepCounter: 9b6e7cca-28b7-4ee0-8acf-dc85e02a24eb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6689f1e0-3c2a-4950-aaa4-dab27899e33d
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: COMMUNITY_OT_FIRST_COMPLETION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 55f98599-c679-4b77-bde7-dcd24dd34ef8
                stepCounter: 9b6e7cca-28b7-4ee0-8acf-dc85e02a24eb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc405a30-fc45-4b16-ab55-e61152af66da
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: COMMUNITY_PT_FIRST_COMPLETION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f5193beb-69a5-4c2e-a64f-7a9218bc70dc
                stepCounter: 9b6e7cca-28b7-4ee0-8acf-dc85e02a24eb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01d424ad-ec04-49c1-86cb-6f2b249574e7
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: COMMUNITY_SLT_FIRST_COMPLETION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cf4334d9-6e4b-442f-892c-92cb14d6fd29
                stepCounter: 9b6e7cca-28b7-4ee0-8acf-dc85e02a24eb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 333a1e91-7af7-4c7c-aeb8-3f354c20bc02
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: COMMUNITY_SW_FIRST_COMPLETION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90c4bf57-d1c0-4556-99d8-1bd21f9f36a1
                stepCounter: 9b6e7cca-28b7-4ee0-8acf-dc85e02a24eb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 181feb9a-fe42-4437-9fa1-3dcabe513c2c
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: PT_ACTIVITY_START
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07451ca3-59d7-451e-853d-4d20bcf9f7d8
                stepCounter: 4f02523c-75d6-4223-9e76-75c379bfc667
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dfbb1c02-84f3-48a9-9587-d51acb94e005
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: OT_ACTIVITY_START
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea6e0328-72ea-4ecb-893a-96d7474474e9
                stepCounter: 4f02523c-75d6-4223-9e76-75c379bfc667
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69913ba5-fc28-4ca6-8b37-5a3f0fea29ed
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: SLT_ACTIVITY_START
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ad201126-e7f8-4f60-be78-5bbb59982dc5
                stepCounter: 4f02523c-75d6-4223-9e76-75c379bfc667
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 690ce850-977d-428e-83cd-20373999db26
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: DT_ACTIVITY_START
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ba86011-a3b6-44a8-baf2-b6b44b97ff08
                stepCounter: 4f02523c-75d6-4223-9e76-75c379bfc667
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf4005cb-eb5d-4984-bee8-f66bfa6abb81
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: SW_ACTIVITY_START
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db398de9-58eb-4e78-844a-9ad5ad92c09b
                stepCounter: 4f02523c-75d6-4223-9e76-75c379bfc667
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3b27968-2c15-4310-91c7-c98b8acd3136
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: NUMERIC(9,5)
        defaultValue: ""
        description: ""
        name: PT_ACTIVITY_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a5091f5f-4cbc-4f0a-a7e7-7f066a2e16a4
                stepCounter: 4f02523c-75d6-4223-9e76-75c379bfc667
            transform: ROUND(s_PJ_journey_50.PT_activity_mins / 60.00, 2)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba3f2b0e-5020-4150-9ded-954461be4b8b
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: NUMERIC(9,5)
        defaultValue: ""
        description: ""
        name: OT_ACTIVITY_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a46e0636-ac1b-4f4e-8ede-c56a26029f33
                stepCounter: 4f02523c-75d6-4223-9e76-75c379bfc667
            transform: ROUND(s_PJ_journey_50.OT_activity_mins / 60.00, 2)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1865f0c9-85cb-490d-b04d-3e2fce7316f9
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: NUMERIC(9,5)
        defaultValue: ""
        description: ""
        name: SLT_ACTIVITY_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 503ea600-c664-4348-b595-91faa2576d40
                stepCounter: 4f02523c-75d6-4223-9e76-75c379bfc667
            transform: ROUND(s_PJ_journey_50.SLT_activity_mins / 60.00, 2)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8bf1a02-bc03-45f0-8e20-ec12287dd030
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: NUMERIC(9,5)
        defaultValue: ""
        description: ""
        name: DT_ACTIVITY_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc3057ce-7fae-4395-be8e-c4b873f4eefc
                stepCounter: 4f02523c-75d6-4223-9e76-75c379bfc667
            transform: ROUND(s_PJ_journey_50.DT_activity_mins / 60.00, 2)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8ca8058-1c5e-41af-b195-5379d2f06441
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: NUMERIC(9,5)
        defaultValue: ""
        description: ""
        name: SW_ACTIVITY_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e0e6c42c-c42d-4694-b554-baa46646d25c
                stepCounter: 4f02523c-75d6-4223-9e76-75c379bfc667
            transform: ROUND(s_PJ_journey_50.SW_activity_mins / 60.00, 2)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 19b0c935-ccca-4290-8c7a-cb4ed934013f
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PT_ACTIVITY_FIRST_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 53bca311-27a9-41f6-9a19-d8361d22cc3e
                stepCounter: 4f02523c-75d6-4223-9e76-75c379bfc667
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06ac22f1-510b-46c0-81a6-06de524727c9
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: OT_ACTIVITY_FIRST_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc0dc699-a3b7-46e2-ace9-901a0ae498fd
                stepCounter: 4f02523c-75d6-4223-9e76-75c379bfc667
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b3fcf620-d2ac-4010-9b69-4baba0ea3cae
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SLT_ACTIVITY_FIRST_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83826582-0cd0-4335-b978-89dfc12c8d6f
                stepCounter: 4f02523c-75d6-4223-9e76-75c379bfc667
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4aa37e1b-39a0-4652-a9a5-fc6c4744e649
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DT_ACTIVITY_FIRST_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59e1f23f-68e0-4dc5-9b06-a217ee700bd3
                stepCounter: 4f02523c-75d6-4223-9e76-75c379bfc667
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 51426b92-0944-414e-bfa7-a9374e10573d
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SW_ACTIVITY_FIRST_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: be70caba-33ab-4476-9c54-cc744ccaa8de
                stepCounter: 4f02523c-75d6-4223-9e76-75c379bfc667
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ec53fed-9d1e-4f7d-ad90-ab3fb6ab03e8
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: First theatre Encounter unique identifier
        name: FIRST_THEATRE_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 54b94b27-d205-47c7-a5f3-12d289185159
                stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a5a9639-16bf-4609-8088-0b1e33f10366
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_THEATRE_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8218ab5d-bc11-46e6-81e4-c15aa738c78b
                stepCounter: 5e652275-92c8-4da6-85d0-b9f43a68cf7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 615c331e-86b7-4a05-bbcf-8640025ac6c0
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Flag indicating whether this is an IP rehab event i.e. admission_specialty_level2_code = 'MHSSE'
        name: MH_EVENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2dfc12df-9c2e-411b-a175-b5e1f8ea06f4
                stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d264d21-c04b-43cb-a676-136e8320e080
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: FIRST_THEATRE_ASA_RATING
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec2be92d-edd3-4d64-8125-d86183166201
                stepCounter: 5e652275-92c8-4da6-85d0-b9f43a68cf7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b5f9450d-971e-43b4-ade4-2ccea41202fa
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: acute_onlist_date
        name: ACUTE_ONLIST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90035fc5-5ee4-4d27-904c-7bc5742de730
                stepCounter: 5e652275-92c8-4da6-85d0-b9f43a68cf7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f21cba1-f54f-4373-8255-2e4e7189d57c
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: MINS_ADMIT_TO_THEATRE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8218ab5d-bc11-46e6-81e4-c15aa738c78b
                stepCounter: 5e652275-92c8-4da6-85d0-b9f43a68cf7a
            transform: DATEDIFF(MI, ip1.ip_admit_date, s_PJ_theatre_event.into_theatre_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31688092-e0a0-44a9-8a8d-4e0003b5ea7c
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: MINS_ACUTELIST_TO_THEATRE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90035fc5-5ee4-4d27-904c-7bc5742de730
                stepCounter: 5e652275-92c8-4da6-85d0-b9f43a68cf7a
            transform: DATEDIFF(MI, s_PJ_theatre_event.acute_onlist_date, s_PJ_theatre_event.into_theatre_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7cd51dd4-22d7-4b4a-83b9-6be42fe8ee76
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_THEATRE_PRIMARY_PROCEDURE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb65f367-d2cb-4a0e-99ee-7bd5bbe02f58
                stepCounter: 5e652275-92c8-4da6-85d0-b9f43a68cf7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec393147-3c7d-43ae-adb8-e1d63e1005ab
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Return theatre Encounter unique identifier
        name: RETURN_THEATRE_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72171acb-4f3d-4c07-b947-2273b0047824
                stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02a5b946-0bd5-433e-a8cd-b983607f5aaa
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ID of the first IP event where discharge specialty = AT&R.
        name: FIRST_REHAB_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5af0c582-d1af-4006-896c-61842a6098e1
                stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: adeb544c-8ac2-443d-b668-c6c818f6815d
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ID of the final IP event where discharge specialty = AT&R.
        name: FINAL_REHAB_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4496b03b-2b23-4f96-bbda-e430834f6337
                stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6d01ca2-c8dc-4aeb-b305-31e3d31f3d52
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Admission date of the first IP event where discharge specialty = AT&R.
        name: REHAB_ADMIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ac81f4d-5011-424b-9139-4f6c7d36d034
                stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
            transform: rehab1.ip_admit_date
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32699443-6cea-4400-be74-ac45b7465793
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Discharge date of the final IP event where discharge specialty = AT&R.
        name: REHAB_DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22b1ef25-f90e-4eaf-9897-edb2588d8daf
                stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
            transform: rehab2.ip_discharge_date
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26b0d993-190d-49fa-bcb6-48ae3b915522
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Length of stay of all IP events where discharge specialty = AT&R.
        name: REHAB_LENGTH_OF_STAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0099526f-ad07-40b8-be94-0a9e946b0371
                stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
            transform: DATEDIFF (DAY, rehab1.ip_admit_date, IFNULL(rehab2.ip_discharge_date,getdate()-1))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8664922c-d425-4f5c-99e9-4b0cf58ba458
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Length of stay of all IP events where discharge specialty = D55
        name: INTERIM_CARE_LENGTH_OF_STAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3d0f0199-c532-4ac3-8702-7c81dcf461a8
                stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 51f960cb-527b-442f-aaf9-561b16d22d7d
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Length of stay of all IP events where discharge specialty in 'AAMHIP', 'ACMHICU', 'ACRMHCOM', 'AMHCOM', 'CHI&YMH', 'FOCOM', 'FOMAX', 'FOMED', 'PSGCO', 'PSGIP', 'RADS', 'SAAMHIP'
        name: MH_LENGTH_OF_STAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 58814696-d025-4007-a6eb-4132996ccf29
                stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9cfecdc3-7968-4cfc-8062-5ad1ca270f5f
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_30.hospital_code=dim_hospital.hospital_code
        name: DIM_REHAB_HOSPITAL_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ca52b1ce-6dff-4010-b31c-3d36b5df3a9b
                stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
            transform: rehab1.dim_hospital_key
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac012d1e-5a4a-4e66-9e3d-82f5e0ec789b
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACUTE_BOOKING_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8a8bad93-3e7d-45fe-a8f6-de5fed97f09a
                stepCounter: 3a8ae152-e098-4a59-a2af-4c3d88a06592
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07862b92-2b9d-44b9-bcc3-41e32db9490f
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ACUTE_BOOKING_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90035fc5-5ee4-4d27-904c-7bc5742de730
                stepCounter: 5e652275-92c8-4da6-85d0-b9f43a68cf7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1835591d-903d-4b5f-8b0b-7cec5c7c8c8c
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_theatre_booking.booking_id=dim_theatre_booking.booking_id
        name: DIM_THEATRE_BOOKING_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60cacb39-771c-4d6d-88f6-e592f2b51e63
                stepCounter: 3a8ae152-e098-4a59-a2af-4c3d88a06592
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 911f102c-6ba1-40da-8e00-dcfef5141e82
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_theatre_booking.booking_specialty=dim_theatre_booking_procedure.booking_specialty  s_theatre_booking.booking_procedure=dim_theatre_booking_procedure.booking_procedure
        name: DIM_THEATRE_BOOKING_PROCEDURE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1bda0e2a-2ef1-4da7-bc97-859607b2e8d4
                stepCounter: 3a8ae152-e098-4a59-a2af-4c3d88a06592
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e8bdafe-4500-40da-855b-cba3f4ea3187
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: NUMERIC(38,4)
        defaultValue: ""
        description: 'Total cost of all ED events.  '
        name: COST_ED_EVENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6de05f56-8c7a-4ef4-92ac-b5594913789c
                stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd653c9c-326f-4d93-8f01-b9499c57dccf
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: NUMERIC(38,4)
        defaultValue: ""
        description: Cost of all IP events.
        name: COST_IP_EVENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0e277f78-b8b9-466a-b952-c0785f4fa5b6
                stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9089b7f9-1a33-41fe-b11f-ac7ec4011c3f
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: NUMERIC(38,4)
        defaultValue: ""
        description: Cost of the IP index event.
        name: COST_INDEX_EVENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d9790560-db42-4078-bbff-a71692906976
                stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ed5be2d-8324-406b-be30-e8a1e2bd943f
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: NUMERIC(38,4)
        defaultValue: ""
        description: Cost of IP rehab events.
        name: COST_REHAB_EVENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83cd603a-2c1d-410c-99fc-0b7a7d2a1567
                stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32960e82-8ab2-449c-acb9-a4e97b00e3aa
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: NUMERIC(38,4)
        defaultValue: ""
        description: Cost of IP non-rehab events.
        name: COST_OTHER_IP_EVENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 43f8bae9-2381-4389-9a87-d70eacd758df
                stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d27993d-bac1-41ae-9a9a-eed8598d9bb4
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: NUMERIC(38,4)
        defaultValue: ""
        description: Cost of FSA (First Specialist Appointment).
        name: COST_FSA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d06b7abb-5ea9-42a7-a27b-b654994092fc
                stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06647399-b963-4b0a-8d37-e2004fc29283
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: NUMERIC(38,4)
        defaultValue: ""
        description: Cost of outpatient Follow Up appointment.
        name: COST_OP_FUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e43c27b0-7768-4d7c-8e0c-18dc5be0a87f
                stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f62b0bc7-5339-4607-8a93-41db4701bccd
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: 'Revenue from ED events.  '
        name: REVENUE_ED_EVENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d496bfca-59a0-4b87-937e-4a14f97d9780
                stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9beb8bf-9130-4b9c-a1de-f29a28547923
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: Revenue from the IP index event.
        name: REVENUE_INDEX_EVENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 41009bb6-670a-4d17-be3d-0a6289d68645
                stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2a466db-966f-4d00-b95e-bdf0d7cffb6e
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: Revenue from IP rehab events.
        name: REVENUE_REHAB_EVENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ac31d30a-6839-4be7-9070-7cdf51ea4b13
                stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4fe50f5b-2dd7-4779-8dcd-ae0fe0bc2fc6
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: Revenue from IP non-rehab events.
        name: REVENUE_OTHER_IP_EVENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a65b01f1-067f-4d0d-bd1b-4f3366ee7a22
                stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75a81fb0-1f9f-437b-a0d9-cadf9e1bb4fc
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: 'Revenue from the OP FSA event.  '
        name: REVENUE_FSA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 69702223-2ae7-46e2-871e-f932b44d1ad5
                stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 951e76ea-2c75-4242-b187-92596f32483b
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: Revenue from the outpatient Follow Up appointment.
        name: REVENUE_OP_FUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1192250c-310b-4049-92c1-b9ed3653606d
                stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80e036f7-605c-4ae9-b0da-a58df317c7af
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Encounter ID related to the first radiology order for the journey.
        name: RADIOLOGY_FIRST_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1a7667d9-9c0d-4217-a34d-838049197c36
                stepCounter: 65406a91-1e62-40d9-b704-adedd419eeff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c0a76df-32cf-4a77-87ef-ff51c8f212ca
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: RADIOLOGY_FIRST_ACCESSION_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c999f068-5f38-4cdf-8c4c-d40a043325c3
                stepCounter: 65406a91-1e62-40d9-b704-adedd419eeff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11aa8d55-c7be-4d2c-a9f3-47bc38921a8c
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time of the first radiology order for the journey.
        name: RADIOLOGY_FIRST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b355ce7f-fcd2-4cff-91d3-4a78f01e8682
                stepCounter: 65406a91-1e62-40d9-b704-adedd419eeff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd45fa19-9798-4a6e-a572-641099a46c15
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time of the first radiology eOrder for the journey.
        name: RADIOLOGY_FIRST_EORDER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c6894a69-590d-4a65-9f0e-2a1a8238bed0
                stepCounter: 65406a91-1e62-40d9-b704-adedd419eeff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 135f00e8-a4a7-4626-acbf-5f00c91cf865
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Set to 1 if the first radiology order was before the first theatre event for the journey.
        name: RADIOLOGY_PRE_OP_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE WHEN s_PJ_journey_30.radiology_first_date < s_PJ_theatre_event.into_theatre_date THEN 1
                          ELSE 0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3585e4b-4012-4146-8a2c-59eebf743f5a
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_RIS_procedures_completed.perf_department=dim_radiology_exam_performed.performing_department  s_RIS_procedures_completed.procedure_exam_code=dim_radiology_exam_performed.performed_exam_code
        name: DIM_RADIOLOGY_EXAM_PERFORMED_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f2293921-4c5f-4bdc-9d86-8e47e3afed3f
                stepCounter: 65406a91-1e62-40d9-b704-adedd419eeff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a65120c8-e867-4657-88a5-dd65ce0989ef
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ID of the FSA event for the journey.
        name: FSA_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cfff5477-7676-48ff-a2f5-fa27ec9227d4
                stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dce09919-dd87-4cce-b781-04f96666d428
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date of the FSA event for the journey.
        name: FSA_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d48ae3b-5172-4cc2-88c3-0966dbaba496
                stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b4ea964-7616-419f-a2e8-393b6740bfac
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ID of the next FUP event for the journey.
        name: FUP_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3228440c-2ad3-4874-ad3a-2cbb25edbfc9
                stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 653fe5a9-6ea7-4cc1-a319-5c89ec0726c2
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date of the next FUP event for the journey.
        name: FUP_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39eef1ca-24f5-4a50-bf90-e1cceee20723
                stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9cf73844-28f5-44c3-9f07-e59857904809
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ID of non WDHB encounter if it ends within a day of the first journey event start.
        name: PRIOR_NON_WDHB_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 37d1d702-9a2b-4a74-8a15-965dda51a40c
                stepCounter: e7e3fe27-6dbc-455a-9407-3392fa586d21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ef59c1e-29c6-44a9-9958-2d0196d437a6
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ID of non WDHB encounter if it starts within a day of the final journey event end.
        name: SUBSEQUENT_NON_WDHB_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 73304e1c-af39-4f55-bcb4-c2de54d45ee9
                stepCounter: e7e3fe27-6dbc-455a-9407-3392fa586d21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5238532d-3f56-4218-8ad9-98592d54f4c5
          stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_PJ_JOURNEY_10
        join:
          joinCondition: |-
            FROM s_PJ_journey_10
              LEFT OUTER JOIN s_PJ_journey_30 -- Radiology  ON s_PJ_journey_30.journey_id = s_PJ_journey_10.journey_id    LEFT OUTER JOIN s_PJ_journey_40 -- Theatre booking  ON  s_PJ_journey_40.journey_id      = s_PJ_journey_10.journey_id  AND s_PJ_journey_40.journey_row_num = 1    LEFT OUTER JOIN s_PJ_journey_50 -- Allied Health  ON s_PJ_journey_50.journey_id = s_PJ_journey_10.journey_id    LEFT OUTER JOIN s_PJ_journey_70 -- Referrals related to Community contacts  ON s_PJ_journey_70.journey_id = s_PJ_journey_10.journey_id    LEFT OUTER JOIN s_PJ_ed_event  ON s_PJ_journey_10.first_ed_encounter_id = s_PJ_ed_event.ed_encounter_id    LEFT OUTER JOIN s_PJ_ip_event ip1 -- First IP event  ON s_PJ_journey_10.first_ip_encounter_id = ip1.ip_encounter_id    LEFT OUTER JOIN s_PJ_ip_event ip2 -- Index IP event  ON s_PJ_journey_10.index_ip_encounter_id = ip2.ip_encounter_id    LEFT OUTER JOIN s_PJ_ip_event ip3 -- Final IP event  ON s_PJ_journey_10.final_ip_encounter_id = ip3.ip_encounter_id    LEFT OUTER JOIN s_PJ_ip_event rehab1 -- First rehab IP event  ON s_PJ_journey_10.first_rehab_encounter_id = rehab1.ip_encounter_id    LEFT OUTER JOIN s_PJ_ip_event rehab2 -- Final rehab IP event  ON s_PJ_journey_10.final_rehab_encounter_id = rehab2.ip_encounter_id    LEFT OUTER JOIN s_PJ_theatre_event  ON  s_PJ_theatre_event.theatre_encounter_ID = s_PJ_journey_10.first_theatre_encounter_id  AND s_PJ_theatre_event.row_num = 1    LEFT OUTER JOIN s_PJ_non_WDHB_event  ON s_PJ_journey_10.journey_id = s_PJ_non_WDHB_event.journey_id
        name: S_PJ_JOURNEY
        noLinkRefs: []
  name: S_PJ_JOURNEY
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
