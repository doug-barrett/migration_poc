fileVersion: 1
id: e39c8476-3939-499e-99b9-9ac0b8f64626
name: VIEW_PVIEW_OFM_DAILY
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 00113dc3-fbb3-476c-b534-d2f23a8876e6
          stepCounter: e39c8476-3939-499e-99b9-9ac0b8f64626
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: IDFLOWNET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f00e8fc-6c61-4ba7-8bae-f81179d23da4
                stepCounter: bd388a52-3d72-4c70-833d-7de7c6a8abd1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 23fe7c18-5594-413f-8a26-079355fe230c
          stepCounter: e39c8476-3939-499e-99b9-9ac0b8f64626
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: IDREC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9cf6aa8f-2e96-43a3-8472-6ee102299445
                stepCounter: b2609f15-a93c-4c5d-b86e-0898ad7558d0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6745af7-598f-4b16-a584-0c1188b1baf0
          stepCounter: e39c8476-3939-499e-99b9-9ac0b8f64626
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: FLOW_NETWORK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 38d1ccfc-acd0-4965-af6a-d6dcf7be7f39
                stepCounter: bd388a52-3d72-4c70-833d-7de7c6a8abd1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8e12f64-d5c8-4e95-8fe5-1ab4b2271584
          stepCounter: e39c8476-3939-499e-99b9-9ac0b8f64626
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: WELL_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47f8a18b-1555-41b2-9a09-2de136944f7f
                stepCounter: b2609f15-a93c-4c5d-b86e-0898ad7558d0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06306d2b-b62e-4aff-b0e3-b08a3fb26c0c
          stepCounter: e39c8476-3939-499e-99b9-9ac0b8f64626
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7014a46b-a09f-4d32-ae9a-66b516c1d8d6
                stepCounter: b2609f15-a93c-4c5d-b86e-0898ad7558d0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4439d25f-9749-46b9-bbb8-84dee177456e
          stepCounter: e39c8476-3939-499e-99b9-9ac0b8f64626
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: PERIOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f12a712-52a9-49bc-b9b3-9f6c776cada1
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98f1427f-6963-4cd6-b8aa-93dd2e270fb9
          stepCounter: e39c8476-3939-499e-99b9-9ac0b8f64626
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: HOURS_ON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 565c3190-bc88-4ecf-8f99-070028fb908c
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6544393-61c3-41df-8f30-9d8f691a565b
          stepCounter: e39c8476-3939-499e-99b9-9ac0b8f64626
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: HOURS_DOWN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b51b4b24-93e1-450a-abda-190776b9def9
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 315c6a79-215d-4cb3-ae94-f8f441699bcd
          stepCounter: e39c8476-3939-499e-99b9-9ac0b8f64626
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PRESTUB
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c10af379-bdbe-42bc-b41b-1fb7bb49e843
                stepCounter: 3c6f5981-3218-423d-b012-74039f0258fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3075dfb8-92cf-4109-843c-7ceaea454d2b
          stepCounter: e39c8476-3939-499e-99b9-9ac0b8f64626
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PRESCAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f47f5cce-108b-472c-a43a-5bc2d2562aa3
                stepCounter: 3c6f5981-3218-423d-b012-74039f0258fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d67e4e4-cf25-4ca2-a112-a07ac99ec461
          stepCounter: e39c8476-3939-499e-99b9-9ac0b8f64626
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PRESLINE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce930dfe-6b7d-4b90-9462-803e255a4b1c
                stepCounter: 3c6f5981-3218-423d-b012-74039f0258fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b0ab3f9-9ea4-4501-b798-4e32d99028c2
          stepCounter: e39c8476-3939-499e-99b9-9ac0b8f64626
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: TEMPWH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa908fa1-56f0-4d76-b4bf-b22cfcb1edba
                stepCounter: 3c6f5981-3218-423d-b012-74039f0258fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc9c8040-b3ac-4eeb-84af-c1d46ce99de6
          stepCounter: e39c8476-3939-499e-99b9-9ac0b8f64626
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: SZCHOKE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83ea1ca3-6335-41e7-a9ea-5d9d9f134217
                stepCounter: 3c6f5981-3218-423d-b012-74039f0258fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b7a31a9-d875-4ad5-9d15-953f0bbb1894
          stepCounter: e39c8476-3939-499e-99b9-9ac0b8f64626
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PROD_OIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07879864-dd64-4dd3-9078-207412088249
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69d374b2-7cd7-4c0f-a7ed-8961024f29ba
          stepCounter: e39c8476-3939-499e-99b9-9ac0b8f64626
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PROD_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d7c85df0-7a75-48a6-9048-9a258c49d57e
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 047337c7-c9b6-4785-9ba5-6326c051b5d8
          stepCounter: e39c8476-3939-499e-99b9-9ac0b8f64626
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PROD_WATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a8c7bedd-86bc-41b4-9c08-619bb6ae4f53
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e87f39b7-854f-4833-bdbd-3a0d1f6dd5ee
          stepCounter: e39c8476-3939-499e-99b9-9ac0b8f64626
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: ALLOC_OIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07b15b03-23c0-4b55-b2de-ce0997f6d260
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24871f7b-e660-4987-aca4-61cae50cce65
          stepCounter: e39c8476-3939-499e-99b9-9ac0b8f64626
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: ALLOC_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f342daf-352b-4bba-8d23-2cb8e4272900
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb7527ae-2a43-4c10-8b53-eea3cd8f6116
          stepCounter: e39c8476-3939-499e-99b9-9ac0b8f64626
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: ALLOC_WATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1a8bf3e0-4605-42d8-952d-e12b80f99266
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 44ec00f2-ab71-49b4-bcd5-9954072a4d4f
          stepCounter: e39c8476-3939-499e-99b9-9ac0b8f64626
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: GOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07879864-dd64-4dd3-9078-207412088249
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 44496b49-6bfc-40f1-926f-975b35b9dc0d
          stepCounter: e39c8476-3939-499e-99b9-9ac0b8f64626
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: RATECHGHCLIQ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 97928548-383f-4d2a-8980-5591ae8be50a
                stepCounter: f54c6027-52b0-4153-a894-f2a8e7f9c94c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 93f2332d-2755-48b6-a485-de239f82be3a
          stepCounter: e39c8476-3939-499e-99b9-9ac0b8f64626
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: RATECHGGAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe849d3b-22f3-41d5-b3bc-efe056a6a2af
                stepCounter: f54c6027-52b0-4153-a894-f2a8e7f9c94c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 23fa266e-66a8-4ebc-a8c3-b0c82ea564c2
          stepCounter: e39c8476-3939-499e-99b9-9ac0b8f64626
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: RATECHGWATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e146eb4-94c9-4ec4-815e-da1b335301ed
                stepCounter: f54c6027-52b0-4153-a894-f2a8e7f9c94c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 411373f8-3987-4e22-b67e-ac2ff18be77b
          stepCounter: e39c8476-3939-499e-99b9-9ac0b8f64626
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PCTCHGHCLIQ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f68e4e47-c510-433a-aaa7-e5d4c5c164b3
                stepCounter: f54c6027-52b0-4153-a894-f2a8e7f9c94c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 989ca18e-f327-40db-a5f2-1b4e63a416c1
          stepCounter: e39c8476-3939-499e-99b9-9ac0b8f64626
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PCTCHGGAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0da9039a-308e-4049-968a-003688da8c4f
                stepCounter: f54c6027-52b0-4153-a894-f2a8e7f9c94c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d637429e-4466-4789-8e22-6e0578578ef2
          stepCounter: e39c8476-3939-499e-99b9-9ac0b8f64626
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PCTCHGWATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3dffe448-494e-487f-a4ca-38865c48a42f
                stepCounter: f54c6027-52b0-4153-a894-f2a8e7f9c94c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aad7ef5d-a6f2-40f9-9696-ddc9ea3a8bd6
          stepCounter: e39c8476-3939-499e-99b9-9ac0b8f64626
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: FACILITY_NAME
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1456f33-be1e-49f0-a5e9-90613111a1c7
          stepCounter: e39c8476-3939-499e-99b9-9ac0b8f64626
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: TONS_OIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07879864-dd64-4dd3-9078-207412088249
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d72b77aa-8456-40d0-889a-10b1917d4408
          stepCounter: e39c8476-3939-499e-99b9-9ac0b8f64626
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: WCUT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a8c7bedd-86bc-41b4-9c08-619bb6ae4f53
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 420c416e-89ae-4c3d-a6fa-79414f0013f0
          stepCounter: e39c8476-3939-499e-99b9-9ac0b8f64626
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: BU_SF_ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 748cdf05-5750-44bd-bb7a-77b0769f897d
                stepCounter: bd388a52-3d72-4c70-833d-7de7c6a8abd1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86ac710e-20e8-46c5-9647-45ef4b024cdf
          stepCounter: e39c8476-3939-499e-99b9-9ac0b8f64626
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f9f4997-d0a7-425e-97e1-0e015385db8f
                stepCounter: bd388a52-3d72-4c70-833d-7de7c6a8abd1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4003e3c6-92d2-492b-9d1d-2cc7586a52d9
          stepCounter: e39c8476-3939-499e-99b9-9ac0b8f64626
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09e0bb5b-5e26-42fa-a0a4-c293c6f802d3
                stepCounter: bd388a52-3d72-4c70-833d-7de7c6a8abd1
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_PVIEW_OFM_DAILY: e39c8476-3939-499e-99b9-9ac0b8f64626
          ODS_PVIEW_PVT_PVFLOWNETHEADER: bd388a52-3d72-4c70-833d-7de7c6a8abd1
          ODS_PVIEW_PVT_PVUNITCOMP: b2609f15-a93c-4c5d-b86e-0898ad7558d0
          ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY: b78e68df-21f7-427c-9ce7-426d1d304567
          ODS_PVIEW_PVT_PVUNITCOMPPARAM: 3c6f5981-3218-423d-b012-74039f0258fc
          ODS_PVIEW_PVT_PVUNITCOMPGATHMONTHDAYCALC: f54c6027-52b0-4153-a894-f2a8e7f9c94c
          ODS_PVIEW_PVT_PVUNITCOMPGATHMONTHCALC: 3a18a7bf-e744-402b-af2e-1d056a565195
          ODS_PVIEW_PVT_PVUNITLIQUIDDENSITY: 4f2511c5-ac6c-46f1-86c8-eebf5d9b4e75
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_PVIEW_OFM_DAILY') }} (IDFLOWNET, IDREC, FLOW_NETWORK, WELL_NAME, UWI, PERIOD, HOURS_ON, HOURS_DOWN, PRESTUB, PRESCAS, PRESLINE, TEMPWH, SZCHOKE, PROD_OIL, PROD_GAS, PROD_WATER, ALLOC_OIL, ALLOC_GAS, ALLOC_WATER, GOR, RATECHGHCLIQ, RATECHGGAS, RATECHGWATER, PCTCHGHCLIQ, PCTCHGGAS, PCTCHGWATER, FACILITY_NAME, TONS_OIL, WCUT, BU_SF_ROLE, DSS_CREATE_TIME, DSS_UPDATE_TIME) AS SELECT F.IDFLOWNET ,
                   C.IDREC ,
                   F.NAME FLOW_NETWORK ,
                   C.COMPLETIONNAME WELL_NAME ,
                   C.WELLIDREGULATORY UWI ,
                   P.DTTM AS PERIOD ,
                   P.DUROP *24 AS HOURS_ON ,
                   P.DURDOWN* 24 AS HOURS_DOWN ,
                   PA.PRESTUB ,
                   PA.PRESCAS ,
                   PA.PRESLINE ,
                   PA.TEMPWH ,
                   PA.SZCHOKE ,
                   P.VOLPRODGATHHCLIQ AS PROD_OIL ,
                   P.VOLPRODGATHGAS AS PROD_GAS ,
                   P.VOLPRODGATHWATER AS PROD_WATER ,
                   P.VOLNEWPRODALLOCHCLIQ ALLOC_OIL ,
                   P.VOLNEWPRODALLOCGAS ALLOC_GAS ,
                   P.VOLNEWPRODALLOCWATER ALLOC_WATER ,
                   CASE WHEN (P.VOLPRODGATHHCLIQ > 0) THEN ((P.VOLPRODGATHGAS / 1000) / P.VOLPRODGATHHCLIQ)
                        ELSE 0
                         END AS GOR ,
                   GATH_CALCS.RATECHGHCLIQ ,
                   GATH_CALCS.RATECHGGAS ,
                   GATH_CALCS.RATECHGWATER ,
                   GATH_CALCS.PCTCHGHCLIQ ,
                   GATH_CALCS.PCTCHGGAS ,
                   GATH_CALCS.PCTCHGWATER ,
                   NULL AS FACILITY_NAME ,
                   ROUND(P.VOLPRODGATHHCLIQ * D.DENSITYHCLIQ / 1000,2) TONS_OIL ,
                   CASE WHEN (P.VOLPRODGATHWATER + P.VOLPRODGATHHCLIQ) > 0 THEN P.VOLPRODGATHWATER / (P.VOLPRODGATHWATER + P.VOLPRODGATHHCLIQ)
                        ELSE 0
                         END WCUT ,
                   'BI_BU_'|| DECODE (UPPER(F.SYSSECURITYTYP) ,'FRANCE','FBU' ,'CANADA','CBU' ,'NETHERLANDS','NBU' ,'GERMANY','GBU' ,'IRELAND','IBU' ,'AUSTRALIA','ABU' ,'UNITED_STATES','USBU' ,'CENTRAL AND EASTERN EUROPE','CEEBU' ,'USBU','USBU' ,'SOUTHERN PLAINS', 'CBU' ,'SOUTHERN FOOTHILLS', 'CBU' ,'SOUTHEAST SASKATCHEWAN', 'CBU' ,'NORTHERN', 'CBU') || DECODE(CURRENT_DATABASE() ,'EDW_TST', '_TEST' ,'EDW_DEV', '_DEV' ,'EDW', '') AS BU_SF_ROLE ,
                   F.DSS_CREATE_TIME ,
                   F.DSS_UPDATE_TIME
              FROM (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVFLOWNETHEADER') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) F
             INNER JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITCOMP') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) C
                ON C.IDFLOWNET = F.IDFLOWNET
             INNER JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) P
                ON P.IDRECCOMP = C.IDREC
               AND P.DTTM < DATEADD(D,-2, GETDATE())
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITCOMPPARAM') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) PA
                ON PA.IDREC = P.IDRECPARAM
              LEFT JOIN (
                    SELECT C.IDREC ,
                           C.COMPLETIONNAME ,
                           CO.DTTM ,
                           CO.RATECHGHCLIQ ,
                           CO.RATECHGGAS ,
                           CO.RATECHGWATER ,
                           CO.PCTCHGHCLIQ ,
                           CO.PCTCHGGAS ,
                           CO.PCTCHGWATER
                      FROM (
                            SELECT *
                              FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITCOMPGATHMONTHDAYCALC') }}
                             WHERE DSS_CURRENT_FLAG = 'Y'
                               AND DSS_DELETE_FLAG != 'Y'
                           ) CO
                     INNER JOIN (
                            SELECT *
                              FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITCOMPGATHMONTHCALC') }}
                             WHERE DSS_CURRENT_FLAG = 'Y'
                               AND DSS_DELETE_FLAG != 'Y'
                           ) MO
                        ON CO.IDRECPARENT = MO.IDREC
                     INNER JOIN (
                            SELECT *
                              FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITCOMP') }}
                             WHERE DSS_CURRENT_FLAG = 'Y'
                               AND DSS_DELETE_FLAG != 'Y'
                           ) C
                        ON MO.IDRECPARENT = C.IDREC
                   )GATH_CALCS
                ON GATH_CALCS.IDREC = P.IDRECCOMP
               AND GATH_CALCS.DTTM = P.DTTM
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITLIQUIDDENSITY') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) D
                ON C.IDRECPARENT = D.IDRECPARENT
               AND D.DTTM = (
                    SELECT MAX(DTTM)
                      FROM (
                            SELECT *
                              FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITLIQUIDDENSITY') }}
                             WHERE DSS_CURRENT_FLAG = 'Y'
                               AND DSS_DELETE_FLAG != 'Y'
                           )
                     WHERE IDRECPARENT = C.IDRECPARENT
                       AND DTTM <= P.DTTM
                   )
        dependencies:
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVFLOWNETHEADER
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITCOMP
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITCOMPPARAM
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITCOMPGATHMONTHDAYCALC
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITCOMPGATHMONTHCALC
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITLIQUIDDENSITY
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_PVIEW_PVT_PVFLOWNETHEADER') }}
            {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITCOMP') }}
            {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY') }}
            {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITCOMPPARAM') }}
            {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITCOMPGATHMONTHDAYCALC') }}
            {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITCOMPGATHMONTHCALC') }}
            {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITLIQUIDDENSITY') }}
        name: VIEW_PVIEW_OFM_DAILY
        noLinkRefs: []
  name: VIEW_PVIEW_OFM_DAILY
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
