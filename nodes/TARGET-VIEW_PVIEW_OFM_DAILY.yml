fileVersion: 1
id: a9926548-72cb-4d33-9042-561d54c53669
name: VIEW_PVIEW_OFM_DAILY
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd725789-6167-474b-bd66-73e9869dd1d6
          stepCounter: a9926548-72cb-4d33-9042-561d54c53669
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: IDFLOWNET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 85d6f749-a3a9-40f6-8bc0-862e4297d5ee
                stepCounter: a23239e4-617a-4ab9-a42c-1fd9220b7fb3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53460db8-8227-42eb-a7a7-174391b0e632
          stepCounter: a9926548-72cb-4d33-9042-561d54c53669
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: IDREC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f76be576-f021-42f1-a5bc-c6dfa35d25fb
                stepCounter: 81e6b0b1-1728-45bf-932d-6356544cf13a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b83c6ca6-c4ee-47a0-8f35-31a1fcdcf36e
          stepCounter: a9926548-72cb-4d33-9042-561d54c53669
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: FLOW_NETWORK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 045a9301-baae-4abc-82d5-5c73167f2797
                stepCounter: a23239e4-617a-4ab9-a42c-1fd9220b7fb3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf3207a4-9c24-4c7b-8697-516edb5c73f0
          stepCounter: a9926548-72cb-4d33-9042-561d54c53669
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: WELL_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8b96ba6-fa62-4c0f-b013-fdbeffce9ce2
                stepCounter: 81e6b0b1-1728-45bf-932d-6356544cf13a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c7253ff1-9197-406f-9e44-c421ef24052d
          stepCounter: a9926548-72cb-4d33-9042-561d54c53669
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 295d169a-8764-40e9-9347-7e6746bb1d69
                stepCounter: 81e6b0b1-1728-45bf-932d-6356544cf13a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ab11d89-fc65-4943-806a-f90b34fa0629
          stepCounter: a9926548-72cb-4d33-9042-561d54c53669
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: PERIOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e23862e-5f1c-4ceb-9ed3-26e0c07e30fc
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 90ef4b04-5b5c-45a3-8df7-a33f553bd550
          stepCounter: a9926548-72cb-4d33-9042-561d54c53669
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: HOURS_ON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 81e344fc-8e1c-48b6-b2a3-4528e7962c25
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ad01a74-fc84-4ae3-9d3e-32f4457b126b
          stepCounter: a9926548-72cb-4d33-9042-561d54c53669
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: HOURS_DOWN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 849b0441-aadd-4df8-aa0c-bef157b937d0
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f84eaed5-971a-43ce-871c-f4010e49aeb6
          stepCounter: a9926548-72cb-4d33-9042-561d54c53669
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PRESTUB
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ee6f2c1-12c9-4465-b37b-154bba143d3c
                stepCounter: 9108fb02-8d09-48b3-ba27-88a8ce494c39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dbba1f20-9a26-47d5-a1b1-cc48b26d3523
          stepCounter: a9926548-72cb-4d33-9042-561d54c53669
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PRESCAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1cc4c5c0-41bd-4baf-9231-65a7b10166d3
                stepCounter: 9108fb02-8d09-48b3-ba27-88a8ce494c39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f97b92fd-f0c9-4606-a942-6f1d31288765
          stepCounter: a9926548-72cb-4d33-9042-561d54c53669
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PRESLINE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e8a8a322-d205-40f9-8a30-6c67d8cf8295
                stepCounter: 9108fb02-8d09-48b3-ba27-88a8ce494c39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6b12003-4b27-4aa4-8091-6128c1934cab
          stepCounter: a9926548-72cb-4d33-9042-561d54c53669
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: TEMPWH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7367603d-5cef-4b08-94a3-cf6e7cb8699a
                stepCounter: 9108fb02-8d09-48b3-ba27-88a8ce494c39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c37fc3b4-56ca-4cd1-9408-7f5200cb0e09
          stepCounter: a9926548-72cb-4d33-9042-561d54c53669
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: SZCHOKE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e0cf42e-9f0f-4201-b634-280b4b6f36fa
                stepCounter: 9108fb02-8d09-48b3-ba27-88a8ce494c39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e142f64-83d6-447e-aadb-0e98ad9bc724
          stepCounter: a9926548-72cb-4d33-9042-561d54c53669
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PROD_OIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 599e1f45-137f-45bf-bbd3-f62c4e7a5fb4
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c00904d6-a368-4d8a-bcc5-159dcbf4845d
          stepCounter: a9926548-72cb-4d33-9042-561d54c53669
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PROD_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a811960-9867-4997-a902-a6ccd59de92c
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15fdfbd7-638c-41d2-90b5-64d6f7b6bc60
          stepCounter: a9926548-72cb-4d33-9042-561d54c53669
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PROD_WATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22fdfa05-0414-4c22-a94d-1290c2cfb76e
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac2399f4-4943-40c8-8153-5fc379b1c42d
          stepCounter: a9926548-72cb-4d33-9042-561d54c53669
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: ALLOC_OIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dac26252-e9d5-4ac8-995d-04e038fcf25b
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 752786d1-7be6-44c8-bd74-54fad58432d2
          stepCounter: a9926548-72cb-4d33-9042-561d54c53669
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: ALLOC_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed079b9e-40b2-4ef1-a22a-2af799344a29
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5525c8f-3d3c-4e9f-b937-dcf41df4a5f8
          stepCounter: a9926548-72cb-4d33-9042-561d54c53669
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: ALLOC_WATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d150863-195c-46f9-b422-962623c38c57
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a5d87bb-13ef-426e-9d86-f19ccf4633bd
          stepCounter: a9926548-72cb-4d33-9042-561d54c53669
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: GOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 599e1f45-137f-45bf-bbd3-f62c4e7a5fb4
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4657baca-5560-4077-9c94-e48e6ef054d0
          stepCounter: a9926548-72cb-4d33-9042-561d54c53669
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: RATECHGHCLIQ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8edccd0e-b56d-47ed-9524-243120fb6242
                stepCounter: 0f4cbe5a-209f-47f4-8dda-ada44dae38cf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 65bc3077-2123-4bcd-a790-a7ac416db451
          stepCounter: a9926548-72cb-4d33-9042-561d54c53669
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: RATECHGGAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16e2d5cc-ce19-4ac4-b8ac-4cdddb60333c
                stepCounter: 0f4cbe5a-209f-47f4-8dda-ada44dae38cf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: defa80fc-5a43-4ad0-9bb4-daab0d14b796
          stepCounter: a9926548-72cb-4d33-9042-561d54c53669
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: RATECHGWATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d57894f-9aae-4c39-8110-291d428e84c1
                stepCounter: 0f4cbe5a-209f-47f4-8dda-ada44dae38cf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f482851b-a564-4b90-a2aa-21b371a833f9
          stepCounter: a9926548-72cb-4d33-9042-561d54c53669
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PCTCHGHCLIQ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 682012ea-1c43-4145-a756-c5300f82c1f2
                stepCounter: 0f4cbe5a-209f-47f4-8dda-ada44dae38cf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b440c3a-14a3-4577-979e-5081c20b20b1
          stepCounter: a9926548-72cb-4d33-9042-561d54c53669
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PCTCHGGAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b67319a9-8ea2-4a94-bbe5-80fca5dfbaee
                stepCounter: 0f4cbe5a-209f-47f4-8dda-ada44dae38cf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79e40ba1-773e-47a3-b3b3-a86203713609
          stepCounter: a9926548-72cb-4d33-9042-561d54c53669
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PCTCHGWATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b0f56fad-2bfc-43e4-aeb1-42ac3ad54e83
                stepCounter: 0f4cbe5a-209f-47f4-8dda-ada44dae38cf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24e57690-399a-4d65-a609-7230eb2a6ce3
          stepCounter: a9926548-72cb-4d33-9042-561d54c53669
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: FACILITY_NAME
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc7ba83c-99cc-4e87-bd8b-99a35d891f01
          stepCounter: a9926548-72cb-4d33-9042-561d54c53669
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: TONS_OIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 599e1f45-137f-45bf-bbd3-f62c4e7a5fb4
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15bbbc9b-2edf-4173-be6c-4ddfd2aba83a
          stepCounter: a9926548-72cb-4d33-9042-561d54c53669
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: WCUT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22fdfa05-0414-4c22-a94d-1290c2cfb76e
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5ce61fc-609d-48a5-a162-091c37b31da5
          stepCounter: a9926548-72cb-4d33-9042-561d54c53669
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: BU_SF_ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2461b3f-8900-4460-9da7-dc1b4d0593bc
                stepCounter: a23239e4-617a-4ab9-a42c-1fd9220b7fb3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25a2cfd7-e515-4361-95b5-77b09bc11f16
          stepCounter: a9926548-72cb-4d33-9042-561d54c53669
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 225158ef-323f-4052-a5f5-8eec320d50ed
                stepCounter: a23239e4-617a-4ab9-a42c-1fd9220b7fb3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24aa3680-6364-4c59-8e94-14030befae52
          stepCounter: a9926548-72cb-4d33-9042-561d54c53669
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6224e306-c453-4e0c-b1bf-b5af6bdcf306
                stepCounter: a23239e4-617a-4ab9-a42c-1fd9220b7fb3
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_PVIEW_OFM_DAILY: a9926548-72cb-4d33-9042-561d54c53669
          ODS_PVIEW_PVT_PVFLOWNETHEADER: a23239e4-617a-4ab9-a42c-1fd9220b7fb3
          ODS_PVIEW_PVT_PVUNITCOMP: 81e6b0b1-1728-45bf-932d-6356544cf13a
          ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY: d08539ff-37af-4c21-9836-963dca56c39d
          ODS_PVIEW_PVT_PVUNITCOMPPARAM: 9108fb02-8d09-48b3-ba27-88a8ce494c39
          ODS_PVIEW_PVT_PVUNITCOMPGATHMONTHDAYCALC: 0f4cbe5a-209f-47f4-8dda-ada44dae38cf
          ODS_PVIEW_PVT_PVUNITCOMPGATHMONTHCALC: 525b1ab5-7feb-4baf-bc1c-20049135fbac
          ODS_PVIEW_PVT_PVUNITLIQUIDDENSITY: 5a4c5ce9-0301-4bda-8283-5d58a3ca2351
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_PVIEW_OFM_DAILY') }} (IDFLOWNET, IDREC, FLOW_NETWORK, WELL_NAME, UWI, PERIOD, HOURS_ON, HOURS_DOWN, PRESTUB, PRESCAS, PRESLINE, TEMPWH, SZCHOKE, PROD_OIL, PROD_GAS, PROD_WATER, ALLOC_OIL, ALLOC_GAS, ALLOC_WATER, GOR, RATECHGHCLIQ, RATECHGGAS, RATECHGWATER, PCTCHGHCLIQ, PCTCHGGAS, PCTCHGWATER, FACILITY_NAME, TONS_OIL, WCUT, BU_SF_ROLE, DSS_CREATE_TIME, DSS_UPDATE_TIME) AS SELECT F.IDFLOWNET ,
                   C.IDREC ,
                   F.NAME FLOW_NETWORK ,
                   C.COMPLETIONNAME WELL_NAME ,
                   C.WELLIDREGULATORY UWI ,
                   P.DTTM AS PERIOD ,
                   P.DUROP *24 AS HOURS_ON ,
                   P.DURDOWN* 24 AS HOURS_DOWN ,
                   PA.PRESTUB ,
                   PA.PRESCAS ,
                   PA.PRESLINE ,
                   PA.TEMPWH ,
                   PA.SZCHOKE ,
                   P.VOLPRODGATHHCLIQ AS PROD_OIL ,
                   P.VOLPRODGATHGAS AS PROD_GAS ,
                   P.VOLPRODGATHWATER AS PROD_WATER ,
                   P.VOLNEWPRODALLOCHCLIQ ALLOC_OIL ,
                   P.VOLNEWPRODALLOCGAS ALLOC_GAS ,
                   P.VOLNEWPRODALLOCWATER ALLOC_WATER ,
                   CASE WHEN (P.VOLPRODGATHHCLIQ > 0) THEN ((P.VOLPRODGATHGAS / 1000) / P.VOLPRODGATHHCLIQ)
                        ELSE 0
                         END AS GOR ,
                   GATH_CALCS.RATECHGHCLIQ ,
                   GATH_CALCS.RATECHGGAS ,
                   GATH_CALCS.RATECHGWATER ,
                   GATH_CALCS.PCTCHGHCLIQ ,
                   GATH_CALCS.PCTCHGGAS ,
                   GATH_CALCS.PCTCHGWATER ,
                   NULL AS FACILITY_NAME ,
                   ROUND(P.VOLPRODGATHHCLIQ * D.DENSITYHCLIQ / 1000,2) TONS_OIL ,
                   CASE WHEN (P.VOLPRODGATHWATER + P.VOLPRODGATHHCLIQ) > 0 THEN P.VOLPRODGATHWATER / (P.VOLPRODGATHWATER + P.VOLPRODGATHHCLIQ)
                        ELSE 0
                         END WCUT ,
                   'BI_BU_'|| DECODE (UPPER(F.SYSSECURITYTYP) ,'FRANCE','FBU' ,'CANADA','CBU' ,'NETHERLANDS','NBU' ,'GERMANY','GBU' ,'IRELAND','IBU' ,'AUSTRALIA','ABU' ,'UNITED_STATES','USBU' ,'CENTRAL AND EASTERN EUROPE','CEEBU' ,'USBU','USBU' ,'SOUTHERN PLAINS', 'CBU' ,'SOUTHERN FOOTHILLS', 'CBU' ,'SOUTHEAST SASKATCHEWAN', 'CBU' ,'NORTHERN', 'CBU') || DECODE(CURRENT_DATABASE() ,'EDW_TST', '_TEST' ,'EDW_DEV', '_DEV' ,'EDW', '') AS BU_SF_ROLE ,
                   F.DSS_CREATE_TIME ,
                   F.DSS_UPDATE_TIME
              FROM (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVFLOWNETHEADER') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) F
             INNER JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITCOMP') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) C
                ON C.IDFLOWNET = F.IDFLOWNET
             INNER JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) P
                ON P.IDRECCOMP = C.IDREC
               AND P.DTTM < DATEADD(D,-2, GETDATE())
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITCOMPPARAM') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) PA
                ON PA.IDREC = P.IDRECPARAM
              LEFT JOIN (
                    SELECT C.IDREC ,
                           C.COMPLETIONNAME ,
                           CO.DTTM ,
                           CO.RATECHGHCLIQ ,
                           CO.RATECHGGAS ,
                           CO.RATECHGWATER ,
                           CO.PCTCHGHCLIQ ,
                           CO.PCTCHGGAS ,
                           CO.PCTCHGWATER
                      FROM (
                            SELECT *
                              FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITCOMPGATHMONTHDAYCALC') }}
                             WHERE DSS_CURRENT_FLAG = 'Y'
                               AND DSS_DELETE_FLAG != 'Y'
                           ) CO
                     INNER JOIN (
                            SELECT *
                              FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITCOMPGATHMONTHCALC') }}
                             WHERE DSS_CURRENT_FLAG = 'Y'
                               AND DSS_DELETE_FLAG != 'Y'
                           ) MO
                        ON CO.IDRECPARENT = MO.IDREC
                     INNER JOIN (
                            SELECT *
                              FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITCOMP') }}
                             WHERE DSS_CURRENT_FLAG = 'Y'
                               AND DSS_DELETE_FLAG != 'Y'
                           ) C
                        ON MO.IDRECPARENT = C.IDREC
                   )GATH_CALCS
                ON GATH_CALCS.IDREC = P.IDRECCOMP
               AND GATH_CALCS.DTTM = P.DTTM
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITLIQUIDDENSITY') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) D
                ON C.IDRECPARENT = D.IDRECPARENT
               AND D.DTTM = (
                    SELECT MAX(DTTM)
                      FROM (
                            SELECT *
                              FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITLIQUIDDENSITY') }}
                             WHERE DSS_CURRENT_FLAG = 'Y'
                               AND DSS_DELETE_FLAG != 'Y'
                           )
                     WHERE IDRECPARENT = C.IDRECPARENT
                       AND DTTM <= P.DTTM
                   )
        dependencies:
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVFLOWNETHEADER
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITCOMP
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITCOMPPARAM
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITCOMPGATHMONTHDAYCALC
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITCOMPGATHMONTHCALC
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITLIQUIDDENSITY
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_PVIEW_PVT_PVFLOWNETHEADER') }}
            {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITCOMP') }}
            {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY') }}
            {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITCOMPPARAM') }}
            {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITCOMPGATHMONTHDAYCALC') }}
            {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITCOMPGATHMONTHCALC') }}
            {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITLIQUIDDENSITY') }}
        name: VIEW_PVIEW_OFM_DAILY
        noLinkRefs: []
  name: VIEW_PVIEW_OFM_DAILY
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
