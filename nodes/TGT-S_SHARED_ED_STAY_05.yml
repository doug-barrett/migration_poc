fileVersion: 1
id: 30da0594-b30e-42cb-b51a-1077fa6a4767
name: S_SHARED_ED_STAY_05
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Initial Stage Table for common use of ED Stays data"
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: afe9a5bc-7651-49b7-97a4-065671dff153
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: AEATT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90278006-085a-412c-b7a3-41a56a0153fc
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca7be2ab-fc1a-4dca-9ff4-43cd57ad1d56
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3490906-6f48-4084-913d-5535ca85a478
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8944b4c-def2-4ebd-9498-e0868564dd13
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFRL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d4546568-c664-4b6e-9234-cf6684196b10
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3fc009e5-e810-48ce-b00f-43e1d53ec363
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ARRIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d1d761e5-2a79-4e24-8644-333c311598eb
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: |-
              CASE WHEN ds_pims_ae_attendances.arrived_dttm IS NULL OR ds_pims_ae_attendances.arrived_dttm <= '1990-01-01' OR ds_pims_ae_attendances.arrived_dttm > GETDATE() THEN ds_pims_ae_attendances.departed_dttm
                          ELSE ds_pims_ae_attendances.arrived_dttm
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3b8bca7-723f-465d-bd3d-da0f1cba9cf4
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ON_MEDICATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f1155c68-da0e-44d2-9b25-b75d7728635a
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 60bec706-3ef7-4912-800f-c88f89ce4647
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ALLERGIES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4850447d-73a8-4f3d-8696-06deb9f319d3
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a65ac8da-aea2-4a39-b9d2-b7041b524ecf
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ALLGY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eef1fe96-3187-4040-8535-b8519b1d160a
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 46d5d355-d3cd-466c-9800-c491351eda1a
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ATTENDANCE_SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b1ed2cd-9eed-4d07-bf9c-05c4958ce7d9
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ba8f87e-08a3-4f5e-8ed3-423a12352bb1
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5575a982-f3a4-441e-be84-490232d53b24
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9206e0b-e934-4853-ac2a-b33f007f08b6
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CONCL_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 656d1167-d11f-4509-b22d-50239eafe13e
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 758a6fb9-2d55-4456-b0f4-190e3964906b
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DEPARTED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6cfdbc61-95a7-4bf6-b56e-cb882fd0daee
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: |-
              CASE WHEN ds_pims_ae_attendances.departed_dttm <= '1990-01-01' OR ds_pims_ae_attendances.departed_dttm > GETDATE() THEN ds_pims_ae_attendances.arrived_dttm
                          ELSE ds_pims_ae_attendances.departed_dttm
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5469358a-3cf4-4514-a596-308ed8534686
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MED_DISCH_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16a63032-3f00-40bb-ad05-c545bbb88f61
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de06c7e7-7bb4-43a1-a0dd-5111e288700a
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DISDE_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c343d736-18b8-4916-a2c3-e1d69547cc8a
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a143fe4-52e8-46cb-bdbb-0e3f369b2cc5
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: HEORG_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 089d34fd-031f-458a-96f3-a58591547a3b
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5f90023-ba97-4b45-af19-58344f66f9a6
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: CHILD_INDICATOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 372d5930-90b9-42f0-a1fe-1d8800a2d4fc
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9fd4a97d-e7d5-402a-96e6-d462f38cacf0
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ACCOMPANIED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dbf8b88a-db81-4d27-8860-be3aad88f027
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b4e46a8-1273-44c0-affe-4ba9a17788d1
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: AETRA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 201ba7fd-d3dd-4db9-ac65-258f8d4f41d2
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b2f72e35-27a6-45b5-b88e-1becda05d08a
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: RESTRAINT_WORN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84cafdd7-c693-42a2-a51b-f9beafbc2958
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aacbbb7a-dac6-4cb1-a07f-cd2941ed3aca
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ARMOD_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03582478-04df-49db-b89e-9002aa6286ea
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a43026a8-33da-4710-8b2a-20f70a424bb5
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ATCAT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f35ab7e2-0e96-41a0-80c2-95b0e564a430
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd0ca9bf-ebbf-4cd5-be85-65645ebf39a4
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ATDIS_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 62983923-810a-4b4f-88ea-43aba04ee0b0
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59d70cdd-e7e5-440c-9046-ecff7094014a
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LOTYP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9001145a-03c7-45d1-98ab-df232d5c91a9
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a09cc7ec-00f6-4824-9a90-3284c0a3ddce
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: RESP_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ceb725b-bde5-4c9c-8ee0-402133a04596
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26d39598-2439-41b2-ab22-f637cd7f0296
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: EXPECTED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f0be90e-54f2-4de1-b3f4-676b6c533bb2
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04d63bd3-bde7-4368-b171-a10a498e32e5
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: LODGED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 452a8bc3-75c0-45bf-a984-161b917fa141
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49d58e02-beaf-4263-a262-c96884ae0bcb
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LODGED_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2dd458f-3911-45de-891a-c03386ac7f3d
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca1ad681-312c-40af-b5ef-ab19b5569373
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ATTENDED_BY_DOCTOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 088ca0f0-d804-4502-a588-5b6ec8f6e980
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b9fd4f1-200b-48f5-bc91-50c2de4cce4c
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ATTENDANCE_SEEN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3ae45cc-8fc6-4b53-b7f6-6bcd7488c6a2
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: abe88c9b-5edc-46ae-9b41-89afd66f8ae4
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: AEPGR_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18a694f8-cceb-46d4-92c0-da04316bcd11
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2479d071-7877-42db-bfec-5eb1469ea51c
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PURCH_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b41a1313-b1f6-4fd4-adb2-fadf131908ff
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 43536097-67f1-4bc2-9549-b16bc2d88eb7
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CONTR_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91634e78-ffc0-4eda-bdaf-37b3f888e6c2
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c3d54ab-496a-4471-b131-c45ea4fca2ca
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PROVD_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 30959a6f-8931-4558-aa9e-75e906b4039f
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e4af3d4e-70cf-4245-b2f4-48bdfc262e5c
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DISCH_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a7aa1f5-fca7-4bab-aad6-e91dddfdd8bb
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 648f6b65-94bd-4907-9eda-fa10e2e1e148
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: INCIDENT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 01b655a1-3f3d-479e-8f64-b241a93b8b1c
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e51cd703-d582-462f-aafa-0f3cae0aaedb
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: IDPAP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c3179f14-7399-4ad3-ae53-5d05d3476fe5
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d2c635a-39ab-4118-b145-97be659775fa
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: RESERVED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 889850c6-266f-49dc-9b07-371814d4f4f3
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 123e90a6-deab-4cab-a898-eae70a9b03de
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREV_AEATT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b0447b7c-e788-479c-b097-3e8851e47040
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1699d6c1-1066-47fd-a8e4-6761949c7362
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CSTAT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c43804e-4e46-4c0a-b544-43bea4fca3e9
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9d93fe4-c3be-4043-a077-ab1cf581678f
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: TREATED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 73226e9d-0875-4c03-9ea6-f4db1aa78327
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c60c2cb-c1f9-440c-bf99-16eb522aaecc
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRVSP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a6b4955-b174-4295-9d6d-c7f118bbc046
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ac9f5ff-8a9a-4084-ac72-54c0b7b130e9
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b12eb2ec-6237-4d6c-b1df-0e3c607c88c5
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 184b7dfa-f14e-48bf-86c6-f0ffbe6b24fa
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIF_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b8b2cd15-bade-49fe-93e1-3dd4f2d07cb0
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d535cdee-c324-4334-b4ed-6b5b315baff0
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: ARCHV_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d035f562-3044-4048-a2ee-8c614ce65be1
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 471a66c1-68a4-473d-ad2b-c05f771d36ee
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STRAN_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c203abf1-ae91-43a9-bdd2-abec180de91e
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 093a36b8-fbec-4d25-a486-e4d95845f5bd
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EXTERNAL_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f9b24c3b-168e-4820-912d-52f57b649bdd
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d035b72-3706-4b4d-97c4-94a938db52e2
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: AEPPS_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b97da40e-b65a-4278-9f8a-a0496afbeac2
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c72edef-2ece-4f48-a80f-eb93b9bfb7b8
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SCHOOL_HEORG_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7273704-ed7f-4d6d-ba2e-82dbcddf6f85
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fce37a19-03a7-425e-b961-f2222f3f4317
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: INTEND_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 693d896c-836f-4e5a-82e1-28ceab0d560d
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 52c776b9-97b6-431f-945b-81e75da59d4e
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: INTEND_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94774b5f-b417-4a66-83dc-520b353cfdaf
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6fad0489-02e0-4d53-bc52-2f2ccd65d2a3
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: INTEND_SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18a8c835-b085-45a2-9da1-1e0be06cf719
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 377321b3-d501-4d10-8422-c55d6af6a62b
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: INTEND_BEDDS_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e85a239-bf0f-455b-821d-17821620b9ec
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4892cdf6-d584-4edb-a5a5-5baba5b838ed
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: INTEND_BDCAT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 98c9a756-1812-43bf-84a9-5d67cdb170d3
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07b0c6fe-c00d-4083-bb3f-797232fec6a9
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LSTAT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4928bd56-0ace-49fa-97cf-fd2bb33b54f3
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: afe627f8-2879-422f-8dbe-30c57ecbe77b
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OWNER_HEORG_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b3c85cc-1d20-4aed-9807-bd6938205fdb
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd826711-60fd-4670-8287-69a79623c1ad
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: TRCAT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ba3c443-513c-443b-8950-34e4ac5e7fc5
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6c5b6a4-d77b-4435-adc8-f64d85dd0800
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: TRIAG_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b47866b-8ced-4523-8c82-af56ca7233d3
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 492fa5f0-1d74-47de-8f6b-68a9bdefc83d
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: TRIAG_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3543db04-2f98-4ab4-a24a-ec7c580ca03a
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa9fd543-52dd-4f5c-9372-7ec2b757c147
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: TRIAG_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67294910-baaa-49f6-a807-3af8e746b315
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 111b5ab0-0404-45c2-abf8-f110e178807f
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: HARP_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 73d6fb6c-f57d-44fa-8988-f171af46d96e
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53bbbbc5-3b92-4725-8e9f-fbc0ce186b2d
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: AE_CASE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1616e44b-7c5f-43c3-a324-f05e3e6912a2
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bc0c33d0-21f9-4e22-8e51-9136ccebbda2
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEC_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f75cdda-80a1-4ac1-9da7-beb0c665675f
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3698aff4-7e14-48cb-8b58-30ef8c35feb3
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEC_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e2eca57-d3be-468b-b851-6dd337f20e7d
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39f356b6-2566-42f4-8ed3-4af41090d6cf
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATST_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d01b672e-7bed-4df4-a68e-9295ca953e19
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82935885-6dbb-46a0-9086-c37f26c76e2b
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EDBED_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 167512d3-e3d6-47ca-8012-133538be1540
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82a0b8fb-06e3-4f88-9e3b-2be2c30554c1
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: AESTY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: faabc9a1-51df-4a0f-9748-1d65ad59bb6f
                stepCounter: 78dfd6c8-5156-4b25-9ccd-9e9fe9148639
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6eb4bc95-919d-43d8-a755-02656f543622
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d73815d8-a3b8-4fd4-bf22-021cb9a1a00f
                stepCounter: 78dfd6c8-5156-4b25-9ccd-9e9fe9148639
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c233d8ca-4d33-4a0b-861e-ee4d2eb941f7
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 88879178-a75d-44c4-b6c0-4f85fd72cfd2
                stepCounter: 78dfd6c8-5156-4b25-9ccd-9e9fe9148639
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e28ebe01-bcf2-400c-9d69-c8dd59ce10e7
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de7f22da-f502-437d-a842-a886ebda790c
                stepCounter: 78dfd6c8-5156-4b25-9ccd-9e9fe9148639
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70d9e8a6-7a92-4595-a526-e8a504d75923
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 816d9443-7f50-4351-ac89-311ff5e2620d
                stepCounter: 78dfd6c8-5156-4b25-9ccd-9e9fe9148639
            transform: |-
              CASE WHEN ds_pims_ae_stays.start_dttm IS NULL OR ds_pims_ae_stays.start_dttm <= '1990-01-01' OR ds_pims_ae_stays.start_dttm > GETDATE() OR ds_pims_ae_stays.start_dttm < CASE WHEN ds_pims_ae_attendances.arrived_dttm IS NULL OR ds_pims_ae_attendances.arrived_dttm <= '1990-01-01' OR ds_pims_ae_attendances.arrived_dttm > GETDATE() THEN ds_pims_ae_attendances.departed_dttm ELSE ds_pims_ae_attendances.arrived_dttm END THEN CASE WHEN ds_pims_ae_attendances.arrived_dttm IS NULL OR ds_pims_ae_attendances.arrived_dttm <= '1990-01-01' OR ds_pims_ae_attendances.arrived_dttm > GETDATE() THEN ds_pims_ae_attendances.departed_dttm ELSE ds_pims_ae_attendances.arrived_dttm END
                          ELSE ds_pims_ae_stays.start_dttm
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d083c7b-4d1b-4011-936f-a11cf214ab2c
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed5bee94-4fad-438d-b202-f999609366b6
                stepCounter: 78dfd6c8-5156-4b25-9ccd-9e9fe9148639
            transform: |-
              CASE WHEN ds_pims_ae_stays.end_dttm IS NULL OR ds_pims_ae_stays.end_dttm <= '1990-01-01' OR ds_pims_ae_stays.end_dttm > GETDATE() OR ds_pims_ae_stays.end_dttm > CASE WHEN ds_pims_ae_attendances.departed_dttm <= '1990-01-01' OR ds_pims_ae_attendances.departed_dttm > GETDATE() THEN ds_pims_ae_attendances.arrived_dttm ELSE ds_pims_ae_attendances.departed_dttm END THEN CASE WHEN ds_pims_ae_attendances.departed_dttm <= '1990-01-01' OR ds_pims_ae_attendances.departed_dttm > GETDATE() THEN ds_pims_ae_attendances.arrived_dttm ELSE ds_pims_ae_attendances.departed_dttm END
                          ELSE ds_pims_ae_stays.end_dttm
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f11e1fd8-8bc3-43fb-b1b4-b1bc711e7cdd
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SEEN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4150855c-62b9-4d3c-9ea4-7f46fc4189bc
                stepCounter: 78dfd6c8-5156-4b25-9ccd-9e9fe9148639
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3042fde2-4160-491f-b12b-62c8aa8759e4
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SPECT_XFER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94f990ee-7427-428a-8b0d-c5d488c601af
                stepCounter: 78dfd6c8-5156-4b25-9ccd-9e9fe9148639
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 51d3a329-5a11-4489-bfc1-8e9c5a93fd6b
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: TEMP_SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d11044d9-54f9-4be6-93f7-185392d9ed1f
                stepCounter: 78dfd6c8-5156-4b25-9ccd-9e9fe9148639
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec5753f6-5988-4539-b024-9a5ae4c55d3c
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: TEMPORARY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa6ff0c2-e05f-4e5b-aa01-0a6d153aa58f
                stepCounter: 78dfd6c8-5156-4b25-9ccd-9e9fe9148639
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 542c1e96-3ccc-4601-a5e3-f10b6238579c
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: STAY_USER_CREATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 17de4288-1a76-4914-b19f-4f7f9630dd58
                stepCounter: 78dfd6c8-5156-4b25-9ccd-9e9fe9148639
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8345f119-8e0e-4065-a869-fd4292cbeec2
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: STAY_USER_MODIF
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e73792f1-d697-4307-b7d2-428899012533
                stepCounter: 78dfd6c8-5156-4b25-9ccd-9e9fe9148639
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79cfcd56-62c3-448a-b228-2efa191de2ba
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: STAY_CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe6511ef-81c7-4d50-9e38-863a69bc88da
                stepCounter: 78dfd6c8-5156-4b25-9ccd-9e9fe9148639
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7cc0c86c-3466-4353-a204-c1960cc6e7b4
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: STAY_MODIF_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 45a111a5-1b30-4133-8a69-52b5c1cc4ccc
                stepCounter: 78dfd6c8-5156-4b25-9ccd-9e9fe9148639
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75bd4971-781c-410c-b186-2ca312a11c6f
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAY_STRAN_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a0544fb-c149-4872-a27d-b9bfc0a37362
                stepCounter: 78dfd6c8-5156-4b25-9ccd-9e9fe9148639
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96446b39-d8ee-42fb-ac5e-c985757cf138
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: STAY_EXTERNAL_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c3d0b926-9386-4e8c-a825-89ff38da4ea7
                stepCounter: 78dfd6c8-5156-4b25-9ccd-9e9fe9148639
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a772b5ad-ea80-49fa-a1ab-b996b211f281
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRIOR_POINTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: adf2d0c9-dea3-42ac-a365-77542279a367
                stepCounter: 78dfd6c8-5156-4b25-9ccd-9e9fe9148639
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f5ade55-8a7d-4b8f-9926-f6233a67f563
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: STAY_ARCHV_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 687b3e29-110d-498f-8398-cf03248de327
                stepCounter: 78dfd6c8-5156-4b25-9ccd-9e9fe9148639
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2dd153ec-a20e-468f-98a9-258a07b4e577
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAY_OWNER_HEORG_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 81ab148a-10c0-4630-96ed-a0dd48e9d721
                stepCounter: 78dfd6c8-5156-4b25-9ccd-9e9fe9148639
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6bd100c5-19b4-4b20-93e3-53cf5d4b9113
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAY_PATST_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5c05c4b-a548-4bba-97b3-46b565189b6c
                stepCounter: 78dfd6c8-5156-4b25-9ccd-9e9fe9148639
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0c36345-1c9d-46eb-aea9-68fce16f686c
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: attendance_stay_seq_num
        name: ATTENDANCE_STAY_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: faabc9a1-51df-4a0f-9748-1d65ad59bb6f
                stepCounter: 78dfd6c8-5156-4b25-9ccd-9e9fe9148639
            transform: ROW_NUMBER() OVER (PARTITION BY ds_pims_ae_attendances.identifier ORDER BY ds_pims_ae_stays.aesty_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dea047d8-b09a-42d0-9d1e-31fcd8943915
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: attendance_stay_seen_seq_num
        name: ATTENDANCE_STAY_SEEN_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: faabc9a1-51df-4a0f-9748-1d65ad59bb6f
                stepCounter: 78dfd6c8-5156-4b25-9ccd-9e9fe9148639
            transform: ROW_NUMBER() over(PARTITION BY ds_pims_ae_attendances.aeatt_refno ,ds_pims_ae_stays.spect_refno ORDER BY ds_pims_ae_attendances.aeatt_refno,ds_pims_ae_stays.seen_dttm,aesty_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a3e815b-7f41-4c18-b03c-cfe47b97bc53
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: attendance_stay_count
        name: ATTENDANCE_STAY_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3490906-6f48-4084-913d-5535ca85a478
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: COUNT(1) OVER (PARTITION BY ds_pims_ae_attendances.identifier)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f2dffbb-d31a-4589-84d4-9837c50e31b4
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DSS_DATA_QUALITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc01c6d6-c752-4f87-ad68-3303ce573f37
          stepCounter: 30da0594-b30e-42cb-b51a-1077fa6a4767
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_PIMS_AE_ATTENDANCES
        join:
          joinCondition: |-
            FROM ds_pims_ae_attendances
              JOIN ds_pims_ae_stays
                ON ds_pims_ae_attendances.aeatt_refno = ds_pims_ae_stays.aeatt_refno
             WHERE ds_pims_ae_attendances.aeatt_refno IN (SELECT aeatt_refno
              FROM ds_pims_ae_attendances
             WHERE modif_dttm > @v_pa_shared_incremental
                OR dss_update_time > @v_pa_shared_incremental
             UNION SELECT aeatt_refno
              FROM ds_pims_ae_stays
             WHERE modif_dttm > @v_pa_shared_incremental
                OR dss_update_time > @v_pa_shared_incremental
             UNION SELECT aeatt_refno
              FROM ds_Shared_ED_Stay --where encounter='A1412541055'   group by aeatt_refno   having MAX(attendance_stay_count) <> count(*)  )
        name: S_SHARED_ED_STAY_05
        noLinkRefs: []
  name: S_SHARED_ED_STAY_05
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
