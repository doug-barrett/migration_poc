fileVersion: 1
id: b0c2689d-bbd5-432f-af9c-ee121a14475f
name: STAGE_MOSAIC_CDM_ENTITY_LIST
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 115862cf-6796-4563-96a0-039a2dbf87b5
          stepCounter: b0c2689d-bbd5-432f-af9c-ee121a14475f
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: ENTITY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 185cb670-1b85-4082-80cc-e949937c6255
                stepCounter: 1b91b8e1-e721-4063-b3bc-6783fb52f054
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 226b4b52-0496-475a-b3cd-9d916f3e5e05
          stepCounter: b0c2689d-bbd5-432f-af9c-ee121a14475f
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: ENTITY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee69c1e7-e738-42d2-b1d1-d164c982ce82
                stepCounter: 755738d6-ad6b-4176-a949-e4a774069772
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5df7c9b5-6f9d-422b-9c65-c0eedb65cf9b
          stepCounter: b0c2689d-bbd5-432f-af9c-ee121a14475f
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee69c1e7-e738-42d2-b1d1-d164c982ce82
                stepCounter: 755738d6-ad6b-4176-a949-e4a774069772
            transform: upper(left('1' || replace(replace(left(entity_name, 17) || replace(SUBSTRING(entity_name, 18, len(entity_name)), '/', '0'), '/', ''), '-', ''), 16))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd90c4b0-5a2d-4457-9e0f-229aad954684
          stepCounter: b0c2689d-bbd5-432f-af9c-ee121a14475f
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: CASE_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f64c290-e199-47f9-b1c1-c0ccd12ed02c
                stepCounter: 20ea955a-4934-48d4-a216-1583c2f32ef8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c94f64c-f165-45aa-9076-b173de525993
          stepCounter: b0c2689d-bbd5-432f-af9c-ee121a14475f
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: CASE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8d23d52-db18-4ad3-879d-1f85b5554951
                stepCounter: 20ea955a-4934-48d4-a216-1583c2f32ef8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0ef2f95-5b81-402b-b709-db918c210dc0
          stepCounter: b0c2689d-bbd5-432f-af9c-ee121a14475f
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: ENTITY_STATE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ec1f294-6b98-4a64-8b3c-729edd133485
                stepCounter: 755738d6-ad6b-4176-a949-e4a774069772
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d869db66-5d90-47cb-9dc8-4057f68af409
          stepCounter: b0c2689d-bbd5-432f-af9c-ee121a14475f
        config: {}
        dataType: NUMBER(18)
        defaultValue: ""
        description: ""
        name: RESULT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d6b0e9d8-0d4d-491c-8b35-38c9dc730a45
                stepCounter: 1b91b8e1-e721-4063-b3bc-6783fb52f054
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6202115-eda6-4633-95d6-df56f19ca51c
          stepCounter: b0c2689d-bbd5-432f-af9c-ee121a14475f
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: COMPANY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 304b6f11-1b1b-48a3-9359-44ec69d9741d
                stepCounter: 1b91b8e1-e721-4063-b3bc-6783fb52f054
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d0a8f82-c470-4be3-b00f-0ef22683766b
          stepCounter: b0c2689d-bbd5-432f-af9c-ee121a14475f
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: COMPANY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7cf5729-4006-48e2-bc47-711acee45abd
                stepCounter: 1aa61b68-0500-450b-8770-70812362bf0b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94aac5c2-5895-4259-afe2-33689a0f8c04
          stepCounter: b0c2689d-bbd5-432f-af9c-ee121a14475f
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: RISK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1dc69d02-a1f4-4aaf-8451-41d84502fb85
                stepCounter: 1b91b8e1-e721-4063-b3bc-6783fb52f054
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27d5f455-b100-4bae-b9ea-eede08e7a98d
          stepCounter: b0c2689d-bbd5-432f-af9c-ee121a14475f
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: RESERVE_CATEGORY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f2eef1c-ef32-4581-b38a-331d1ad25679
                stepCounter: 1b91b8e1-e721-4063-b3bc-6783fb52f054
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 177516eb-c0f2-420e-bbcf-3a9d7a9e141e
          stepCounter: b0c2689d-bbd5-432f-af9c-ee121a14475f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: CATEGORY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eeac047b-ead3-4f81-97d3-f343bfa16842
                stepCounter: 4d7bbd43-bf3f-4e97-8038-0812fb7fd0e1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b0971ab-732c-4b22-b473-f886a6ab9a64
          stepCounter: b0c2689d-bbd5-432f-af9c-ee121a14475f
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CASE_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5acadd2-5d86-453d-87a6-0057a8a8d5cb
                stepCounter: 20ea955a-4934-48d4-a216-1583c2f32ef8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb50b080-5a85-4f96-97e9-713995d81619
          stepCounter: b0c2689d-bbd5-432f-af9c-ee121a14475f
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db5cad67-499d-4f52-aac0-89a9f07d935a
                stepCounter: 68080d98-a776-4871-b27f-997df48633a6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ebb4ec59-c525-49c9-8008-540568ddbc15
          stepCounter: b0c2689d-bbd5-432f-af9c-ee121a14475f
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: SORTABLE_ENTITY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eb9d041e-87de-4686-b1fd-77b695955ae9
                stepCounter: 755738d6-ad6b-4176-a949-e4a774069772
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4fe82add-92b3-4b55-9e51-53233fde012b
          stepCounter: b0c2689d-bbd5-432f-af9c-ee121a14475f
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: CGU
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6833485c-94f2-442c-bbd4-fe1094d0e106
                stepCounter: 755738d6-ad6b-4176-a949-e4a774069772
            transform: |-
              CASE WHEN upper(TRIM(ODS_MOSAIC_CDM_ECONOMIC_ENTITY.USER_DEFINED_1)) = 'AB BC' THEN 'OTHERAB'
                          ELSE upper(TRIM(ODS_MOSAIC_CDM_ECONOMIC_ENTITY.USER_DEFINED_1))
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 68f4781e-780a-49ed-aa43-d7558700cee4
          stepCounter: b0c2689d-bbd5-432f-af9c-ee121a14475f
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 36fc997f-451a-4a25-979d-fe73e3cdd2e1
                stepCounter: 755738d6-ad6b-4176-a949-e4a774069772
            transform: |-
              CASE WHEN upper(TRIM(ODS_MOSAIC_CDM_ECONOMIC_ENTITY.USER_DEFINED_2)) = 'CORPORATE' AND upper(TRIM(ODS_MOSAIC_CDM_ECONOMIC_ENTITY.USER_DEFINED_1)) <> 'CORPORATE' THEN CONCAT(upper(TRIM(ODS_MOSAIC_CDM_ECONOMIC_ENTITY.USER_DEFINED_1)), '_CORP')
                          WHEN upper(TRIM(ODS_MOSAIC_CDM_ECONOMIC_ENTITY.USER_DEFINED_2)) = 'CONVENTIONAL'                                                                            THEN 'CONVENTIONAL AREA'
                          ELSE upper(TRIM(ODS_MOSAIC_CDM_ECONOMIC_ENTITY.USER_DEFINED_2))
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f49f474a-b3e8-4b35-a1eb-d8427124da56
          stepCounter: b0c2689d-bbd5-432f-af9c-ee121a14475f
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: CGU_AREA_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c3e5468a-16e9-4e50-b010-ea2f660e804e
                stepCounter: 755738d6-ad6b-4176-a949-e4a774069772
            transform: |-
              CASE WHEN upper(TRIM(ODS_MOSAIC_CDM_ECONOMIC_ENTITY.USER_DEFINED_2)) = 'CORPORATE' AND upper(TRIM(ODS_MOSAIC_CDM_ECONOMIC_ENTITY.USER_DEFINED_1)) <> 'CORPORATE' THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e03fed07-9670-42b4-ac4f-2b1310158b2a
          stepCounter: b0c2689d-bbd5-432f-af9c-ee121a14475f
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: PROPERTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 330e37ce-566f-42cb-8682-98baf31534c0
                stepCounter: 755738d6-ad6b-4176-a949-e4a774069772
            transform: upper(TRIM(ODS_MOSAIC_CDM_ECONOMIC_ENTITY.PROPERTY))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31bc9172-4259-4919-b8c2-1a3a1b77007f
          stepCounter: b0c2689d-bbd5-432f-af9c-ee121a14475f
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: PROVINCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 522703fb-ecc8-4abf-b028-e27618af3510
                stepCounter: 755738d6-ad6b-4176-a949-e4a774069772
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92cfd14d-f648-42e3-882e-c275195ceee0
          stepCounter: b0c2689d-bbd5-432f-af9c-ee121a14475f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7514eb58-2d7a-48fb-90d3-830ae221c4d0
                stepCounter: 755738d6-ad6b-4176-a949-e4a774069772
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed29c177-e613-4247-8416-fa31b0b92d08
          stepCounter: b0c2689d-bbd5-432f-af9c-ee121a14475f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: ON_PRODUCTION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c214dcbf-019b-42d1-b4c4-9c68e7a7c683
                stepCounter: 755738d6-ad6b-4176-a949-e4a774069772
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b72ba0ee-25ea-4f6a-b238-4e8bc87345a9
          stepCounter: b0c2689d-bbd5-432f-af9c-ee121a14475f
        config: {}
        dataType: VARCHAR(200)
        defaultValue: ""
        description: ""
        name: PROJECT_IDENTIFIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef1e5413-4d79-41e2-a84f-a7c26bf0da07
                stepCounter: 755738d6-ad6b-4176-a949-e4a774069772
            transform: |-
              CASE WHEN upper(ODS_MOSAIC_CDM_ECONOMIC_ENTITY.PROJECT_IDENTIFIER) = 'NA' THEN NULL
                          ELSE ODS_MOSAIC_CDM_ECONOMIC_ENTITY.PROJECT_IDENTIFIER
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 261b5098-ec08-428f-a551-1e99608c43b2
          stepCounter: b0c2689d-bbd5-432f-af9c-ee121a14475f
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: BUDGET_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee6789a2-dd0f-4250-a9bf-cb5c9074d179
                stepCounter: 755738d6-ad6b-4176-a949-e4a774069772
            transform: TRIM(ODS_MOSAIC_CDM_ECONOMIC_ENTITY.USER_DEFINED_5)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a2c4d6f-6170-446e-a03e-10d3dd3e6569
          stepCounter: b0c2689d-bbd5-432f-af9c-ee121a14475f
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: GEOLOGICAL_PERIOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c3e5468a-16e9-4e50-b010-ea2f660e804e
                stepCounter: 755738d6-ad6b-4176-a949-e4a774069772
            transform: upper(TRIM(ODS_MOSAIC_CDM_ECONOMIC_ENTITY.USER_DEFINED_3))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b2700f4c-5ccb-42d2-bbe9-5f302152e81c
          stepCounter: b0c2689d-bbd5-432f-af9c-ee121a14475f
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: BUDGET_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc4c79eb-3bc9-46b2-ad0b-baf84ccaaabd
                stepCounter: 755738d6-ad6b-4176-a949-e4a774069772
            transform: upper(TRIM(ODS_MOSAIC_CDM_ECONOMIC_ENTITY.USER_DEFINED_9))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a283f9c-308e-4178-afc6-6c242fc8d363
          stepCounter: b0c2689d-bbd5-432f-af9c-ee121a14475f
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: DEVIATION_INDICATOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f45da436-3bb9-4e9f-b278-f70b5e52a794
                stepCounter: 755738d6-ad6b-4176-a949-e4a774069772
            transform: upper(TRIM(ODS_MOSAIC_CDM_ECONOMIC_ENTITY.USER_DEFINED_4))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8001a9d3-bae0-41aa-bf92-7902178f8aaf
          stepCounter: b0c2689d-bbd5-432f-af9c-ee121a14475f
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: FORMATION_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc649ecd-8f3a-46de-94b7-bfef9b871356
                stepCounter: 755738d6-ad6b-4176-a949-e4a774069772
            transform: upper(TRIM(ODS_MOSAIC_CDM_ECONOMIC_ENTITY.FORMATION_NAME))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cded8377-d2c8-41c8-8ee5-c2b4bef8a6cf
          stepCounter: b0c2689d-bbd5-432f-af9c-ee121a14475f
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: PRESENTATION_LAYOUT_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1ee39f9-e754-41fc-8394-7c45beb736c9
                stepCounter: 8e9450b1-b1c3-4d03-bc6a-1c71ebea00b5
            transform: upper(TRIM(replace(ODS_MOSAIC_CDM_PRESENTATION_LAYOUT.PRESENTATION_LAYOUT_NAME, 'Default', '')))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc2ff0b1-0885-4e97-8f27-b8c3c0e93f1f
          stepCounter: b0c2689d-bbd5-432f-af9c-ee121a14475f
        config: {}
        dataType: NUMBER(8,4)
        defaultValue: ""
        description: ""
        name: POS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2bc60342-f8eb-404f-b9ca-3a2bfb562b35
                stepCounter: 1b91b8e1-e721-4063-b3bc-6783fb52f054
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ODS_MOSAIC_CDM_ECONOMIC_RESULT: 1b91b8e1-e721-4063-b3bc-6783fb52f054
          ODS_MOSAIC_CDM_ECONOMIC_ENTITY: 755738d6-ad6b-4176-a949-e4a774069772
          ODS_MOSAIC_CDM_ECONOMIC_CASE: 20ea955a-4934-48d4-a216-1583c2f32ef8
          ODS_MOSAIC_CDM_COMPANY: 1aa61b68-0500-450b-8770-70812362bf0b
          ODS_MOSAIC_CDM_RESERVE_CATEGORY: 4d7bbd43-bf3f-4e97-8038-0812fb7fd0e1
          ODS_MOSAIC_CDM_RESERVE_CAT_GROUP: 68080d98-a776-4871-b27f-997df48633a6
          ODS_MOSAIC_CDM_PRESENTATION_LAYOUT: 8e9450b1-b1c3-4d03-bc6a-1c71ebea00b5
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: ODS_MOSAIC_CDM_ECONOMIC_RESULT
          - locationName: TARGET
            nodeName: ODS_MOSAIC_CDM_ECONOMIC_ENTITY
          - locationName: TARGET
            nodeName: ODS_MOSAIC_CDM_ECONOMIC_CASE
          - locationName: TARGET
            nodeName: ODS_MOSAIC_CDM_COMPANY
          - locationName: TARGET
            nodeName: ODS_MOSAIC_CDM_RESERVE_CATEGORY
          - locationName: TARGET
            nodeName: ODS_MOSAIC_CDM_RESERVE_CAT_GROUP
          - locationName: TARGET
            nodeName: ODS_MOSAIC_CDM_PRESENTATION_LAYOUT
        join:
          joinCondition: |-
            FROM {{ ref('TARGET','ODS_MOSAIC_CDM_ECONOMIC_RESULT') }} ODS_MOSAIC_CDM_ECONOMIC_RESULT
              JOIN {{ ref('TARGET','ODS_MOSAIC_CDM_ECONOMIC_ENTITY') }} ODS_MOSAIC_CDM_ECONOMIC_ENTITY
                ON ODS_MOSAIC_CDM_ECONOMIC_RESULT.ENTITY_ID = ODS_MOSAIC_CDM_ECONOMIC_ENTITY.ENTITY_ID
              JOIN {{ ref('TARGET','ODS_MOSAIC_CDM_ECONOMIC_CASE') }} ODS_MOSAIC_CDM_ECONOMIC_CASE
                ON ODS_MOSAIC_CDM_ECONOMIC_RESULT.CASE_ID = ODS_MOSAIC_CDM_ECONOMIC_CASE.CASE_ID
              JOIN {{ ref('TARGET','ODS_MOSAIC_CDM_COMPANY') }} ODS_MOSAIC_CDM_COMPANY
                ON ODS_MOSAIC_CDM_ECONOMIC_RESULT.COMPANY_ID = ODS_MOSAIC_CDM_COMPANY.COMPANY_ID
              JOIN {{ ref('TARGET','ODS_MOSAIC_CDM_RESERVE_CATEGORY') }} ODS_MOSAIC_CDM_RESERVE_CATEGORY
                ON ODS_MOSAIC_CDM_ECONOMIC_RESULT.RESERVE_CATEGORY_ID = ODS_MOSAIC_CDM_RESERVE_CATEGORY.RESERVE_CATEGORY_ID
              JOIN {{ ref('TARGET','ODS_MOSAIC_CDM_RESERVE_CAT_GROUP') }} ODS_MOSAIC_CDM_RESERVE_CAT_GROUP
                ON ODS_MOSAIC_CDM_ECONOMIC_RESULT.RESERVE_CAT_GROUP_ID = ODS_MOSAIC_CDM_RESERVE_CAT_GROUP.RESERVE_CAT_GROUP_ID
              JOIN {{ ref('TARGET','ODS_MOSAIC_CDM_PRESENTATION_LAYOUT') }} ODS_MOSAIC_CDM_PRESENTATION_LAYOUT
                ON ODS_MOSAIC_CDM_ECONOMIC_ENTITY.ENTITY_TYPE = ODS_MOSAIC_CDM_PRESENTATION_LAYOUT.ENTITY_TYPE
             WHERE 1 = 1
               AND upper(ODS_MOSAIC_CDM_ECONOMIC_RESULT.RISK) IN ('B', 'Y')
               AND ODS_MOSAIC_CDM_ECONOMIC_RESULT.POS <> 0
               AND ODS_MOSAIC_CDM_ECONOMIC_ENTITY.ENTITY_STATE_ID IN (0,4) -- 0 = Approved, 4 = Vintage and upper(ODS_MOSAIC_CDM_COMPANY.COMPANY_NAME) = 'VERMILION' and ODS_MOSAIC_CDM_ECONOMIC_RESULT.DSS_CURRENT_FLAG = 'Y' and ODS_MOSAIC_CDM_COMPANY.DSS_CURRENT_FLAG = 'Y' and ODS_MOSAIC_CDM_RESERVE_CATEGORY.DSS_CURRENT_FLAG = 'Y' and ODS_MOSAIC_CDM_ECONOMIC_CASE.DSS_CURRENT_FLAG = 'Y' and ODS_MOSAIC_CDM_RESERVE_CAT_GROUP.DSS_CURRENT_FLAG = 'Y' and ODS_MOSAIC_CDM_ECONOMIC_ENTITY.DSS_CURRENT_FLAG = 'Y' and ODS_MOSAIC_CDM_PRESENTATION_LAYOUT.DSS_CURRENT_FLAG = 'Y' and ODS_MOSAIC_CDM_ECONOMIC_RESULT.CASE_ID = 289449
        name: STAGE_MOSAIC_CDM_ENTITY_LIST
        noLinkRefs: []
  name: STAGE_MOSAIC_CDM_ENTITY_LIST
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
