fileVersion: 1
id: 2d1b64c0-5ec9-4155-ada8-23b5ee4c942a
name: STAGE_MOSAIC_CDM_ENTITY_LIST
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d20b537c-1f87-47c5-8cdc-e72b10e62603
          stepCounter: 2d1b64c0-5ec9-4155-ada8-23b5ee4c942a
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: ENTITY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d10fd715-8870-49c7-9ece-70a000d97930
                stepCounter: 9b34a482-c7b2-4d49-a98f-5f7bfe3f73d1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bcfdcd73-d888-41e9-b002-81e49a562e18
          stepCounter: 2d1b64c0-5ec9-4155-ada8-23b5ee4c942a
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: ENTITY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a537ac6-f3ae-43d4-9f74-1bc43b9ee7d4
                stepCounter: ef3efcb2-55b3-489f-bb14-2165705cec86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64c8acbc-17c7-4e96-a282-a790b6fa7b15
          stepCounter: 2d1b64c0-5ec9-4155-ada8-23b5ee4c942a
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a537ac6-f3ae-43d4-9f74-1bc43b9ee7d4
                stepCounter: ef3efcb2-55b3-489f-bb14-2165705cec86
            transform: upper(left('1' || replace(replace(left(entity_name, 17) || replace(SUBSTRING(entity_name, 18, len(entity_name)), '/', '0'), '/', ''), '-', ''), 16))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1bd04b50-0b81-4170-91cb-78cdecd57680
          stepCounter: 2d1b64c0-5ec9-4155-ada8-23b5ee4c942a
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: CASE_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc69aa62-2547-479c-8e9e-f3f166ac75fc
                stepCounter: 397e8678-298f-43a1-9349-b65b9e1d1863
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 930afdd7-9d4e-4f96-9bca-655ec01335b9
          stepCounter: 2d1b64c0-5ec9-4155-ada8-23b5ee4c942a
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: CASE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cc96ad66-3c30-4fd8-8fbd-bdb7529a2d51
                stepCounter: 397e8678-298f-43a1-9349-b65b9e1d1863
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1895122d-f8ad-408e-90d6-a21456a3f305
          stepCounter: 2d1b64c0-5ec9-4155-ada8-23b5ee4c942a
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: ENTITY_STATE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8156dabc-f2d8-4ee3-bf44-d0a77681b760
                stepCounter: ef3efcb2-55b3-489f-bb14-2165705cec86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b331d90-17c2-42c8-ba6e-3ebcad700244
          stepCounter: 2d1b64c0-5ec9-4155-ada8-23b5ee4c942a
        config: {}
        dataType: NUMBER(18)
        defaultValue: ""
        description: ""
        name: RESULT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f014800c-027c-448f-a71c-62bf21695a05
                stepCounter: 9b34a482-c7b2-4d49-a98f-5f7bfe3f73d1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02bc1648-61f9-42f0-985d-2581c9cdfb27
          stepCounter: 2d1b64c0-5ec9-4155-ada8-23b5ee4c942a
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: COMPANY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9ef870f8-3ab9-423e-a33b-c1d52ebaefd6
                stepCounter: 9b34a482-c7b2-4d49-a98f-5f7bfe3f73d1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b96aa9f4-f547-4b2e-9ba3-a0ff9dc52e0d
          stepCounter: 2d1b64c0-5ec9-4155-ada8-23b5ee4c942a
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: COMPANY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 692031a3-293b-4320-8e4a-6ad3c1d1af61
                stepCounter: 0ae17d91-8d7f-4791-97fc-47e85617f274
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59d65a48-7835-4831-bd1e-90aaf5fe151a
          stepCounter: 2d1b64c0-5ec9-4155-ada8-23b5ee4c942a
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: RISK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9cf95367-fc85-406a-b289-c220fb6c4ad7
                stepCounter: 9b34a482-c7b2-4d49-a98f-5f7bfe3f73d1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d41a5cc-08c6-4e99-87dd-86c42e6c8f58
          stepCounter: 2d1b64c0-5ec9-4155-ada8-23b5ee4c942a
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: RESERVE_CATEGORY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b16fca8c-d10a-490d-bf44-00235b0c363e
                stepCounter: 9b34a482-c7b2-4d49-a98f-5f7bfe3f73d1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 162b92ec-6d75-4af9-a940-a7f809e8fd0d
          stepCounter: 2d1b64c0-5ec9-4155-ada8-23b5ee4c942a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: CATEGORY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7eeeadf7-5186-4476-b76e-39d50e413fda
                stepCounter: a2a90ad7-71ad-47e4-b9c1-f9b115ff4d0a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 63c38cc2-c95b-4692-b2d7-405a94a0647f
          stepCounter: 2d1b64c0-5ec9-4155-ada8-23b5ee4c942a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CASE_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9172e7ca-94ac-4f72-abce-9dfa378831e9
                stepCounter: 397e8678-298f-43a1-9349-b65b9e1d1863
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33667f90-5ac7-4757-9c50-9a39160a5862
          stepCounter: 2d1b64c0-5ec9-4155-ada8-23b5ee4c942a
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 537cf001-c7d9-4471-bb81-9c94cb8af02a
                stepCounter: f6673290-4503-47d3-bb0d-7a53ee8883e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34641268-eab5-4500-8276-21003b81567b
          stepCounter: 2d1b64c0-5ec9-4155-ada8-23b5ee4c942a
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: SORTABLE_ENTITY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e6653371-051e-4b53-bc80-8cda8c89ffcf
                stepCounter: ef3efcb2-55b3-489f-bb14-2165705cec86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b9163c0-2cf1-47fb-889f-3bac6f762b81
          stepCounter: 2d1b64c0-5ec9-4155-ada8-23b5ee4c942a
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: CGU
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 57f8fee7-8a23-44eb-8045-2d9fe487fa3e
                stepCounter: ef3efcb2-55b3-489f-bb14-2165705cec86
            transform: |-
              CASE WHEN upper(TRIM(ODS_MOSAIC_CDM_ECONOMIC_ENTITY.USER_DEFINED_1)) = 'AB BC' THEN 'OTHERAB'
                          ELSE upper(TRIM(ODS_MOSAIC_CDM_ECONOMIC_ENTITY.USER_DEFINED_1))
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 08fb0a49-8cbc-46f6-904f-4203ff8dda18
          stepCounter: 2d1b64c0-5ec9-4155-ada8-23b5ee4c942a
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a45528ab-6a86-4aa4-8d78-8198441b8b12
                stepCounter: ef3efcb2-55b3-489f-bb14-2165705cec86
            transform: |-
              CASE WHEN upper(TRIM(ODS_MOSAIC_CDM_ECONOMIC_ENTITY.USER_DEFINED_2)) = 'CORPORATE' AND upper(TRIM(ODS_MOSAIC_CDM_ECONOMIC_ENTITY.USER_DEFINED_1)) <> 'CORPORATE' THEN CONCAT(upper(TRIM(ODS_MOSAIC_CDM_ECONOMIC_ENTITY.USER_DEFINED_1)), '_CORP')
                          WHEN upper(TRIM(ODS_MOSAIC_CDM_ECONOMIC_ENTITY.USER_DEFINED_2)) = 'CONVENTIONAL'                                                                            THEN 'CONVENTIONAL AREA'
                          ELSE upper(TRIM(ODS_MOSAIC_CDM_ECONOMIC_ENTITY.USER_DEFINED_2))
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1967c4e0-aacb-4c0b-b2b5-ff63d1c164c5
          stepCounter: 2d1b64c0-5ec9-4155-ada8-23b5ee4c942a
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: CGU_AREA_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 391bb774-d8ec-4db9-9cbf-f848340b09a2
                stepCounter: ef3efcb2-55b3-489f-bb14-2165705cec86
            transform: |-
              CASE WHEN upper(TRIM(ODS_MOSAIC_CDM_ECONOMIC_ENTITY.USER_DEFINED_2)) = 'CORPORATE' AND upper(TRIM(ODS_MOSAIC_CDM_ECONOMIC_ENTITY.USER_DEFINED_1)) <> 'CORPORATE' THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ace0239-e84c-4f0a-9ea1-08a0e05ff96f
          stepCounter: 2d1b64c0-5ec9-4155-ada8-23b5ee4c942a
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: PROPERTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1876b0f5-d06a-442c-8619-19f2d0fec4c7
                stepCounter: ef3efcb2-55b3-489f-bb14-2165705cec86
            transform: upper(TRIM(ODS_MOSAIC_CDM_ECONOMIC_ENTITY.PROPERTY))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b2f25ee1-7b3e-4003-9e94-02cff2ebc48c
          stepCounter: 2d1b64c0-5ec9-4155-ada8-23b5ee4c942a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: PROVINCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a7e155c1-ba8f-4512-976b-df3e774e4973
                stepCounter: ef3efcb2-55b3-489f-bb14-2165705cec86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54f7116c-413f-47db-8647-50637a5ce4e3
          stepCounter: 2d1b64c0-5ec9-4155-ada8-23b5ee4c942a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ad02a101-17c2-430c-b0dd-c9c6d4cc962a
                stepCounter: ef3efcb2-55b3-489f-bb14-2165705cec86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b549011-b145-43f9-9269-39a2d25eba21
          stepCounter: 2d1b64c0-5ec9-4155-ada8-23b5ee4c942a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: ON_PRODUCTION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9ca6be9a-0ab6-4eec-8697-cbe0c77c7553
                stepCounter: ef3efcb2-55b3-489f-bb14-2165705cec86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3ee15d8-4dec-4316-93c0-16797d1d080f
          stepCounter: 2d1b64c0-5ec9-4155-ada8-23b5ee4c942a
        config: {}
        dataType: VARCHAR(200)
        defaultValue: ""
        description: ""
        name: PROJECT_IDENTIFIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6cd7ab36-6954-401e-ae57-a9399362b6b2
                stepCounter: ef3efcb2-55b3-489f-bb14-2165705cec86
            transform: |-
              CASE WHEN upper(ODS_MOSAIC_CDM_ECONOMIC_ENTITY.PROJECT_IDENTIFIER) = 'NA' THEN NULL
                          ELSE ODS_MOSAIC_CDM_ECONOMIC_ENTITY.PROJECT_IDENTIFIER
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 303fdaa2-9450-4f6a-9358-298d80a26c1c
          stepCounter: 2d1b64c0-5ec9-4155-ada8-23b5ee4c942a
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: BUDGET_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: daf1affe-41f5-45ff-b4f2-4e269032617a
                stepCounter: ef3efcb2-55b3-489f-bb14-2165705cec86
            transform: TRIM(ODS_MOSAIC_CDM_ECONOMIC_ENTITY.USER_DEFINED_5)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9cee3a6-b367-409a-964f-7894d3ac2a76
          stepCounter: 2d1b64c0-5ec9-4155-ada8-23b5ee4c942a
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: GEOLOGICAL_PERIOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 391bb774-d8ec-4db9-9cbf-f848340b09a2
                stepCounter: ef3efcb2-55b3-489f-bb14-2165705cec86
            transform: upper(TRIM(ODS_MOSAIC_CDM_ECONOMIC_ENTITY.USER_DEFINED_3))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7cb2968f-13af-4688-acb8-b77c2c65d9bd
          stepCounter: 2d1b64c0-5ec9-4155-ada8-23b5ee4c942a
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: BUDGET_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24007490-83f6-4cac-8bf3-80324acbf429
                stepCounter: ef3efcb2-55b3-489f-bb14-2165705cec86
            transform: upper(TRIM(ODS_MOSAIC_CDM_ECONOMIC_ENTITY.USER_DEFINED_9))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac8ad069-2a7b-4181-a9df-39aca75665cf
          stepCounter: 2d1b64c0-5ec9-4155-ada8-23b5ee4c942a
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: DEVIATION_INDICATOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3c0c0c6e-ec86-44f7-8711-3895bcaefefa
                stepCounter: ef3efcb2-55b3-489f-bb14-2165705cec86
            transform: upper(TRIM(ODS_MOSAIC_CDM_ECONOMIC_ENTITY.USER_DEFINED_4))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 58d11dd1-65bb-4433-ae9a-286eda01280e
          stepCounter: 2d1b64c0-5ec9-4155-ada8-23b5ee4c942a
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: FORMATION_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b7454d95-db8f-439c-a700-66357523768e
                stepCounter: ef3efcb2-55b3-489f-bb14-2165705cec86
            transform: upper(TRIM(ODS_MOSAIC_CDM_ECONOMIC_ENTITY.FORMATION_NAME))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77a254c6-458c-4a8a-8d4c-e24f71e9ac49
          stepCounter: 2d1b64c0-5ec9-4155-ada8-23b5ee4c942a
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: PRESENTATION_LAYOUT_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eef931e6-545e-42b4-bec9-e2ed2c473c55
                stepCounter: 685bfc79-8bc1-4887-a80c-980b7d658918
            transform: upper(TRIM(replace(ODS_MOSAIC_CDM_PRESENTATION_LAYOUT.PRESENTATION_LAYOUT_NAME, 'Default', '')))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8b3f11b-345c-4cdf-b5d8-ca064c9b323c
          stepCounter: 2d1b64c0-5ec9-4155-ada8-23b5ee4c942a
        config: {}
        dataType: NUMBER(8,4)
        defaultValue: ""
        description: ""
        name: POS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 453fa4b4-3068-4834-81d3-d6266f26289b
                stepCounter: 9b34a482-c7b2-4d49-a98f-5f7bfe3f73d1
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ODS_MOSAIC_CDM_ECONOMIC_RESULT: 9b34a482-c7b2-4d49-a98f-5f7bfe3f73d1
          ODS_MOSAIC_CDM_ECONOMIC_ENTITY: ef3efcb2-55b3-489f-bb14-2165705cec86
          ODS_MOSAIC_CDM_ECONOMIC_CASE: 397e8678-298f-43a1-9349-b65b9e1d1863
          ODS_MOSAIC_CDM_COMPANY: 0ae17d91-8d7f-4791-97fc-47e85617f274
          ODS_MOSAIC_CDM_RESERVE_CATEGORY: a2a90ad7-71ad-47e4-b9c1-f9b115ff4d0a
          ODS_MOSAIC_CDM_RESERVE_CAT_GROUP: f6673290-4503-47d3-bb0d-7a53ee8883e9
          ODS_MOSAIC_CDM_PRESENTATION_LAYOUT: 685bfc79-8bc1-4887-a80c-980b7d658918
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: ODS_MOSAIC_CDM_ECONOMIC_RESULT
          - locationName: TARGET
            nodeName: ODS_MOSAIC_CDM_ECONOMIC_ENTITY
          - locationName: TARGET
            nodeName: ODS_MOSAIC_CDM_ECONOMIC_CASE
          - locationName: TARGET
            nodeName: ODS_MOSAIC_CDM_COMPANY
          - locationName: TARGET
            nodeName: ODS_MOSAIC_CDM_RESERVE_CATEGORY
          - locationName: TARGET
            nodeName: ODS_MOSAIC_CDM_RESERVE_CAT_GROUP
          - locationName: TARGET
            nodeName: ODS_MOSAIC_CDM_PRESENTATION_LAYOUT
        join:
          joinCondition: |-
            FROM {{ ref('TARGET','ODS_MOSAIC_CDM_ECONOMIC_RESULT') }} ODS_MOSAIC_CDM_ECONOMIC_RESULT
              JOIN {{ ref('TARGET','ODS_MOSAIC_CDM_ECONOMIC_ENTITY') }} ODS_MOSAIC_CDM_ECONOMIC_ENTITY
                ON ODS_MOSAIC_CDM_ECONOMIC_RESULT.ENTITY_ID = ODS_MOSAIC_CDM_ECONOMIC_ENTITY.ENTITY_ID
              JOIN {{ ref('TARGET','ODS_MOSAIC_CDM_ECONOMIC_CASE') }} ODS_MOSAIC_CDM_ECONOMIC_CASE
                ON ODS_MOSAIC_CDM_ECONOMIC_RESULT.CASE_ID = ODS_MOSAIC_CDM_ECONOMIC_CASE.CASE_ID
              JOIN {{ ref('TARGET','ODS_MOSAIC_CDM_COMPANY') }} ODS_MOSAIC_CDM_COMPANY
                ON ODS_MOSAIC_CDM_ECONOMIC_RESULT.COMPANY_ID = ODS_MOSAIC_CDM_COMPANY.COMPANY_ID
              JOIN {{ ref('TARGET','ODS_MOSAIC_CDM_RESERVE_CATEGORY') }} ODS_MOSAIC_CDM_RESERVE_CATEGORY
                ON ODS_MOSAIC_CDM_ECONOMIC_RESULT.RESERVE_CATEGORY_ID = ODS_MOSAIC_CDM_RESERVE_CATEGORY.RESERVE_CATEGORY_ID
              JOIN {{ ref('TARGET','ODS_MOSAIC_CDM_RESERVE_CAT_GROUP') }} ODS_MOSAIC_CDM_RESERVE_CAT_GROUP
                ON ODS_MOSAIC_CDM_ECONOMIC_RESULT.RESERVE_CAT_GROUP_ID = ODS_MOSAIC_CDM_RESERVE_CAT_GROUP.RESERVE_CAT_GROUP_ID
              JOIN {{ ref('TARGET','ODS_MOSAIC_CDM_PRESENTATION_LAYOUT') }} ODS_MOSAIC_CDM_PRESENTATION_LAYOUT
                ON ODS_MOSAIC_CDM_ECONOMIC_ENTITY.ENTITY_TYPE = ODS_MOSAIC_CDM_PRESENTATION_LAYOUT.ENTITY_TYPE
             WHERE 1 = 1
               AND upper(ODS_MOSAIC_CDM_ECONOMIC_RESULT.RISK) IN ('B', 'Y')
               AND ODS_MOSAIC_CDM_ECONOMIC_RESULT.POS <> 0
               AND ODS_MOSAIC_CDM_ECONOMIC_ENTITY.ENTITY_STATE_ID IN (0,4) -- 0 = Approved, 4 = Vintage and upper(ODS_MOSAIC_CDM_COMPANY.COMPANY_NAME) = 'VERMILION' and ODS_MOSAIC_CDM_ECONOMIC_RESULT.DSS_CURRENT_FLAG = 'Y' and ODS_MOSAIC_CDM_COMPANY.DSS_CURRENT_FLAG = 'Y' and ODS_MOSAIC_CDM_RESERVE_CATEGORY.DSS_CURRENT_FLAG = 'Y' and ODS_MOSAIC_CDM_ECONOMIC_CASE.DSS_CURRENT_FLAG = 'Y' and ODS_MOSAIC_CDM_RESERVE_CAT_GROUP.DSS_CURRENT_FLAG = 'Y' and ODS_MOSAIC_CDM_ECONOMIC_ENTITY.DSS_CURRENT_FLAG = 'Y' and ODS_MOSAIC_CDM_PRESENTATION_LAYOUT.DSS_CURRENT_FLAG = 'Y' and ODS_MOSAIC_CDM_ECONOMIC_RESULT.CASE_ID = 289449
        name: STAGE_MOSAIC_CDM_ENTITY_LIST
        noLinkRefs: []
  name: STAGE_MOSAIC_CDM_ENTITY_LIST
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
