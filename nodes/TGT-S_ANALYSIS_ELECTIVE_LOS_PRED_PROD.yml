fileVersion: 1
id: 3add539c-d7c8-470f-b431-7bc7deb65fcc
name: S_ANALYSIS_ELECTIVE_LOS_PRED_PROD
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3546b2e8-1b77-44e1-ad74-d2b76ec76b91
          stepCounter: 3add539c-d7c8-470f-b431-7bc7deb65fcc
        config: {}
        dataType: INTEGER IDENTITY (1,1)
        defaultValue: ""
        description: elective_length_of_stay_prediction_id
        isSurrogateKey: true
        name: ELECTIVE_LENGTH_OF_STAY_PREDICTION_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 325179b5-2e64-49d7-aa7b-5ca627e16c20
          stepCounter: 3add539c-d7c8-470f-b431-7bc7deb65fcc
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: ROWNAMES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 749d58e7-89ac-4214-9d9b-9aac0b00be4c
                stepCounter: 2550d4f4-1b08-47c1-8d05-b50a39b6f8b1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c7780a5-1e2b-451c-b5f9-1adf8011028e
          stepCounter: 3add539c-d7c8-470f-b431-7bc7deb65fcc
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: WAITLIST_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52b01a0c-9ab4-43fc-abef-b0086e687767
                stepCounter: 2550d4f4-1b08-47c1-8d05-b50a39b6f8b1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21bc44ab-d696-4a1c-865d-7c11c3d4b798
          stepCounter: 3add539c-d7c8-470f-b431-7bc7deb65fcc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: patient_prediction_id
        name: PATIENT_PREDICTION_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52b01a0c-9ab4-43fc-abef-b0086e687767
                stepCounter: 2550d4f4-1b08-47c1-8d05-b50a39b6f8b1
            transform: row_number() OVER (PARTITION BY waitlist_encounter_id ORDER BY pred_made)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5fcb771-8047-4ba0-9f64-600edc7bc388
          stepCounter: 3add539c-d7c8-470f-b431-7bc7deb65fcc
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: SURGICAL_THEATRE_BOOKING_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07ed528b-51a7-4c76-a5c0-10a0e1713f1b
                stepCounter: 2550d4f4-1b08-47c1-8d05-b50a39b6f8b1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 83256c23-2286-47e1-8f96-21523a38e0de
          stepCounter: 3add539c-d7c8-470f-b431-7bc7deb65fcc
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PREDICTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b8ff3131-e6ff-4846-8bf2-b32b34227785
                stepCounter: 2550d4f4-1b08-47c1-8d05-b50a39b6f8b1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a06d07a8-f264-4e09-8ee6-4b6e14bc59d4
          stepCounter: 3add539c-d7c8-470f-b431-7bc7deb65fcc
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: PREDICTION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2aa6efe-5980-407e-8687-3e44364eba78
                stepCounter: 2550d4f4-1b08-47c1-8d05-b50a39b6f8b1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 077af766-90e9-4184-b732-6bd41518ba1c
          stepCounter: 3add539c-d7c8-470f-b431-7bc7deb65fcc
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PREDICTION_MADE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e16c40c8-6fe4-49ad-a490-6cbd57ef3f18
                stepCounter: 2550d4f4-1b08-47c1-8d05-b50a39b6f8b1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 342cfce0-06ff-4438-a366-d3d3bc7014c7
          stepCounter: 3add539c-d7c8-470f-b431-7bc7deb65fcc
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: MODEL_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a124bac-40d3-43c3-b635-6e3310f95ecd
                stepCounter: 2550d4f4-1b08-47c1-8d05-b50a39b6f8b1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f49a615-27c2-4fd4-86ba-062c307456be
          stepCounter: 3add539c-d7c8-470f-b431-7bc7deb65fcc
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: PREDICTED_LENGTH_OF_STAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b8ff3131-e6ff-4846-8bf2-b32b34227785
                stepCounter: 2550d4f4-1b08-47c1-8d05-b50a39b6f8b1
            transform: cast(cast(prediction AS int) AS varchar(5))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64fbf078-5a9c-46d3-baac-207286f88387
          stepCounter: 3add539c-d7c8-470f-b431-7bc7deb65fcc
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59ed44d3-a456-41b5-91d3-57c521140dbd
                stepCounter: 2550d4f4-1b08-47c1-8d05-b50a39b6f8b1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 90efa1c5-74e5-4ed9-8234-149df84d64eb
          stepCounter: 3add539c-d7c8-470f-b431-7bc7deb65fcc
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: current_flag
        name: CURRENT_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52b01a0c-9ab4-43fc-abef-b0086e687767
                stepCounter: 2550d4f4-1b08-47c1-8d05-b50a39b6f8b1
            transform: |-
              CASE WHEN row_number() OVER (PARTITION BY waitlist_encounter_id ORDER BY pred_made DESC) = 1 THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c9c7bcd-9b5f-4ab1-8544-36b5a2f629ae
          stepCounter: 3add539c-d7c8-470f-b431-7bc7deb65fcc
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Record source.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ce754f8-5003-45c7-bfbd-650280b2a52e
                stepCounter: 2550d4f4-1b08-47c1-8d05-b50a39b6f8b1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9c318b7-099e-4903-b53d-db13556c23dd
          stepCounter: 3add539c-d7c8-470f-b431-7bc7deb65fcc
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Load date.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b31f2687-74d9-4515-9d82-64733948d93e
                stepCounter: 2550d4f4-1b08-47c1-8d05-b50a39b6f8b1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4b076a0-29fa-4494-a1a7-a3c59d048bf8
          stepCounter: 3add539c-d7c8-470f-b431-7bc7deb65fcc
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          L_ANALYSIS_ELECTIVE_LOS_PRED_PROD: 2550d4f4-1b08-47c1-8d05-b50a39b6f8b1
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: L_ANALYSIS_ELECTIVE_LOS_PRED_PROD
        join:
          joinCondition: FROM {{ ref('TGT','L_ANALYSIS_ELECTIVE_LOS_PRED_PROD') }}
        name: S_ANALYSIS_ELECTIVE_LOS_PRED_PROD
        noLinkRefs: []
  name: S_ANALYSIS_ELECTIVE_LOS_PRED_PROD
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
