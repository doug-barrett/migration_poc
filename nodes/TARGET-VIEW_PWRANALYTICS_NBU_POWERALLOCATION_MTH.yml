fileVersion: 1
id: 658a2322-098f-457a-a726-9912dea0c6ca
name: VIEW_PWRANALYTICS_NBU_POWERALLOCATION_MTH
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 146997e7-b39a-4741-ae7c-f10df97fe80a
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: VARCHAR(13)
        defaultValue: ""
        description: ""
        name: COUNTRY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 551f9a67-3d0a-4308-8da6-2c872317607b
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 191d065f-c3ca-4941-a570-7c7d1d9c244b
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: PROVINCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d34a6f6-0a3e-4ca5-b097-b36f860c667a
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d983a1a-78b9-457c-9827-d4305a792923
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: VARCHAR(14)
        defaultValue: ""
        description: ""
        name: LANGUAGE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d9ff86e3-9b52-456f-8d68-728597308eb3
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d655dfa8-77ba-4838-a5f6-ed5b9ec913c8
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: CURRENCY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 43c724ed-fff6-48c7-ae2c-3b5ddee88deb
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae7b8173-f9d2-4b18-aa3e-4ce1fec4f5d8
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: VARCHAR(24)
        defaultValue: ""
        description: ""
        name: UTILITY_PROVIDER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ebe2ef39-6f47-46f3-81b2-74c57ad76e3a
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 054f14ef-3c4a-4b30-b0db-31bc22bdddc2
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: NUMBER(38,0)
        defaultValue: ""
        description: ""
        name: INVOICE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a902f4d7-62cd-473d-bbe3-8931852772d4
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 017d9c9a-29d6-4e08-8f08-860fa969c255
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: ACCOUNT_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3e91efb-6ec0-4569-b119-033fb4e4721a
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eaaf1839-2e55-4ee1-9951-20214a32b0e6
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: DELIVERY_POINT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51e8d3ad-9d54-4599-a4f9-99a75e33923b
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c92621f-3b46-40b4-87f1-24445bca56e0
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: CONSUMPTION_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3df7eb8-8e35-4b14-81ca-1be68ec9404b
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 51ddd1eb-6bb9-4b48-b1bc-5c409c924d53
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: METER_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33c8515b-de83-4168-ad80-c2fc9c50172a
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 618ea5fd-7ce4-4b3f-bfdb-df10b3748abc
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: COST_CENTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ab53299-259b-4928-b0c2-dab7fb86f9a7
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1c40102-36ef-4822-86f5-9be759b87592
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CC_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47b82123-1d9d-4332-84e5-51dd7333882b
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CORE_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2208ae2-3096-4410-bfdb-8c478b0bf5ef
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5c74d3a-d7d9-4960-983e-db91fb538068
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9a05105-15a2-42d9-b53f-1f5cfccc107a
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: TOTAL_CONSUMPTION_KWH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5f28d0f-a40a-44fc-a596-6181b3950041
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d92cdd9a-bd28-484d-b5db-24be4d285d0a
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PEAK_CONSUMPTION_KWH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2fbee53c-3df1-45ea-ac33-7d167009271a
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48882ced-2217-418b-9b74-a5d53644f123
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OFF_PEAK_CONSUMPTION_KWH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50ab3767-a40c-45b0-b64c-8b10f24c65df
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ace11e02-830d-411c-b952-df190f23fef1
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: REGISTERED_DEMAND_KVA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e4ad9561-afaf-4f35-b2f5-d791d2aea243
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b2743b30-885d-4f78-b446-e5c7d5ff43bb
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BILLED_DEMAND_KVA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2b416c4b-2762-432d-bbc8-e3d7f5d29446
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1a07bd0-8ab3-41ec-a301-9397a36903f3
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CURRENT_METER_READ_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 57159ea2-95bc-4567-a6af-f8d8e3901cdc
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3fbc0a03-b6a4-4b72-9603-e662280aac3f
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: CURRENT_METER_READ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9ebb5afe-e9e6-4322-b028-cb62db41a8df
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b220fc8-54e7-4c8c-b955-f188a6df8476
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: PREVIOUS_METER_READ_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eea745f5-fedf-46e2-b5bf-c70c86e62e60
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 214a80c9-5ed8-47c9-8190-23424d8f37be
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PREVIOUS_METER_READ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc5d994d-bdf2-4740-a17b-786534bd35cf
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 19ea0686-40b3-405c-b5f9-edb63de59a79
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: TOTAL_AMOUNT_DUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 10f9a403-baf1-40e6-84d8-ff0972bee74a
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7a34fa8-98a1-48a6-9ac9-69e68384ee48
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: SUBTOTAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b12196d2-2e5a-49a9-836f-936508f2b3a2
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8c9c1aa-507c-4240-9ca8-eb0d2e118d3a
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: ENERGY_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47e97593-b106-4d8a-8196-b85b365245a4
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9f6f06d-7139-48b4-af23-3aa520e34fc9
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PEAK_ENERGY_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ea5b4eb-1d80-404e-b698-1ea010245a80
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca29feac-4917-4848-aab2-066c2cdb697b
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OFF_PEAK_ENERGY_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 73c890a4-2f50-4c2b-948e-a34b5627393e
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c81b937-c44f-4a42-b635-f87b5b4b8ccc
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BASIC_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d0b46c7b-4c29-46f6-a9dd-506c0990b0b4
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03c8f485-a115-46c2-82ee-b72919e29431
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: DEMAND_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 308df3ee-a506-4fef-a6eb-b268045802b4
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be9dd092-5d3c-4ab8-baca-8a13cea89bb9
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: REACTIVE_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b24f9e44-d123-4115-af96-0ddb3e0aa6ab
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 033054df-c88e-4221-80a8-cd3224b6fe7b
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: TRANSMISSION_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f35e291-cba0-4245-a0a6-e70f74bdf89d
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b61f820-4467-44c7-a9f6-4f91913654f5
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OTHER_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 31faba84-0aae-4753-9d49-2d33c2c2dc56
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24bc8350-e1c3-45fc-9fea-aacb8f2507af
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: SERVICE_ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 968a0c92-58fa-4dc2-b08e-34733ca91cea
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24cf4ba9-5ed1-47eb-a91c-8aafa20e751f
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: CARBON_TAX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ecad125-b597-4621-b72d-d824fa8e2124
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bae52f14-8df8-4e55-81b6-d1621d27b780
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: CARBON_TAX_GST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02769d7f-4192-46e6-90a2-154b3bc98685
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 108a32ea-3c1a-4ffd-9712-d3fccab9a8a5
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: FEDERAL_TAX_GST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7753a641-41cb-4b3b-953b-4a1315f9d7cf
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6c1c304-10e9-4c74-86ce-f88424faa54e
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5041cae6-8c60-4efe-b768-10038d99fad5
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 89c0de25-3ed9-4dc1-a5ce-4e96e92e143c
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: MST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9bf96de8-be78-45fb-bbc5-54516b9edc10
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6128311-46b2-4ebb-9434-55c97987e765
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: VAT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2eb6d102-7f58-4704-bdc9-1b85f6a974ed
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5323d546-6580-4e0d-bacb-ab0c93da1b17
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: METER_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 021a816a-7e41-4b8e-b675-5748aaba72fe
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d66b6f7-4fa8-4103-88ef-9ba10ca4b141
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BILL_MULTIPLIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 778179fe-76e2-4483-bb9e-b17b8fc5d6b7
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da67e97a-941a-4a51-be55-c048d2bfca0a
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8165284a-362e-49e1-8f03-856a3bd31cea
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72a4cee0-0be4-4e1d-a395-34dfbb8aba28
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: POWER_FACTOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7977c21-7309-4841-8a55-a7de137c4f09
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0dbfb3fc-ae80-420b-90bc-e74e5858f2c6
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PEAK_DEMAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 952e6ba9-dc92-4704-815b-8c6afb059cb1
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5769a323-b9ca-495c-ad2f-5b4edc20ff4f
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BILL_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33da730e-1876-4932-b6b7-c5a972caed42
                stepCounter: e3c8419f-8dde-4fec-b0f5-9b6a2323e8a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f556a87-d33d-4cc4-8b80-f1b3b288a369
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae6f0a93-3ff7-480d-a860-75de1a36f171
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PROD_YEARMONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a851de8-6ed5-48df-b09f-b1d1db1d778c
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: WELL_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88d1964b-6dde-41c9-a7c1-86ae0da4535c
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: FOREMAN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f1f42a7-0af5-45f2-8f0e-b33c7698e43f
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: BATTERY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db102353-76e9-493b-8647-bb8d1e3b9a87
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9231fea-1291-4ce1-9e0b-cad8a231d4cb
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: WELL_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d0b547db-3b89-4992-a0a6-7533e137cf58
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: RUN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53f60fda-1d03-4ef5-b97b-1621527681eb
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: SURFACE_LOCATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 35ffc55e-608f-4723-b810-80fddfc28eb7
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: SURFACE_LATITUDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82c959f4-29d1-48b0-9fd9-321c28f4ab8c
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: SURFACE_LONGITUDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 707e925c-0b1b-4d48-956b-d934265c0f78
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OPERATING_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca33c11a-6fe8-4cdd-8deb-3bf2154ca869
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: DOWNTIME_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e127d664-e8db-4549-b69e-18cd5ee8726e
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OIL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d08d4d36-a29d-4971-8c35-2e782a9bc7ad
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: WATER_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8efb1de8-942c-417e-9793-80513b62a6d0
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: GAS_E3M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 869e8a1f-e5cd-4a19-a1b9-5918779cd57b
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OIL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb5a651d-ef5b-48d1-b450-74b6cc8b21ce
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: GAS_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e216642e-1c51-43b6-a5b4-8249453bcf6f
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e057eb9-0586-4a9b-980e-659a87e72cf6
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: FACILITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 52fb1db2-5595-4dcc-9b9e-581467298c17
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: WORKING_INTEREST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0dc4f73c-b6e0-4696-9412-f106a92ebf23
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: PUMP_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb3cec45-a67d-432a-a74e-899a953d46f2
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8956c01e-966f-4b2a-842a-5c8f9d0069a9
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: TOTAL_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd9ae1e9-534a-4de4-9baf-ccc178870460
          stepCounter: 658a2322-098f-457a-a726-9912dea0c6ca
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: NORM_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_PWRANALYTICS_NBU_POWERALLOCATION_MTH: 658a2322-098f-457a-a726-9912dea0c6ca
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_PWRANALYTICS_NBU_POWERALLOCATION_MTH') }} AS WITH MJ AS (
                    SELECT distinct(WELL_NAME),
                           CHILD_ACCOUNT_NUMBER ,
                           METER_NUMBER,
                           IFNULL(PV.CC_NUM,T.CC_NUM) AS CC_NUM ,
                           IFNULL(CC_NAME,T.CC_NAME_L2) AS CC_NAME ,
                           AREA,
                           CORE_AREA ,
                           PROVINCE,
                           IFNULL(FACILITY,T.FAC_L3) AS FACILITY ,
                           FOREMAN,
                           T.METER_TYPE AS TYPE ,
                           'ProdView' AS SOURCE
                      FROM WS_EDW.VIEW_FDC_PWRANALYTICS PV
                      LEFT JOIN (
                            SELECT *
                              FROM DS_POWER.NBU_MAPPING
                           ) T
                        ON PV.WELL_NAME=T.WELL_NAME_L1
                     WHERE COUNTRY = 'NETHERLANDS'
                       AND PROD_YEARMONTH>='202201'
                   ),
                   MJ1 AS (
                    SELECT *
                      FROM MJ
                     CROSS JOIN DS_POWER.VET_DIMDATE M
                     WHERE Year(Date) >= 2022
                       AND Year(Date) <= Year(GetDate())
                   ),
                   PV_AGG_A AS ((SELECT MJ1.WELL_NAME ,Max(MJ1.CHILD_ACCOUNT_NUMBER) AS CHILD_ACCOUNT_NUMBER ,max(MJ1.Facility) AS FACILITY ,MJ1.DATE ,Max(MJ1.Type) AS TYPE ,Sum(IFNULL(BOE,0)) AS BOE ,count(*) AS WELL_COUNT ,1.00/Count(*) AS WELLCOUNT_PRORATION FROM MJ1 LEFT OUTER JOIN WS_EDW.VIEW_FDC_PWRANALYTICS PV ON MJ1.WELL_NAME = PV.WELL_NAME AND MJ1.Date = LAST_DAY(DATE(concat(SUBSTRING(cast(Prod_YEARMONTH AS varchar),1,4), '-', SUBSTRING(cast(Prod_YEARMONTH AS varchar),5,2), '-01'))) GROUP BY MJ1.WELL_NAME, MJ1.Date)),
                   PV_AGG_NONPV AS ((SELECT 0 AS CHILD_ACCOUNT_NUMBER ,MJ1.Facility AS FACILITY ,MJ1.DATE ,MJ1.Type AS TYPE ,Sum(IFNULL(BOE,0)) AS BOE ,count(*)-1 AS WELL_COUNT ,1.00/Count(*) AS WELLCOUNT_PRORATION FROM MJ1 LEFT OUTER JOIN WS_EDW.VIEW_FDC_PWRANALYTICS PV ON MJ1.WELL_NAME = PV.WELL_NAME AND MJ1.Date = LAST_DAY(DATE(concat(SUBSTRING(cast(Prod_YEARMONTH AS varchar),1,4), '-', SUBSTRING(cast(Prod_YEARMONTH AS varchar),5,2), '-01'))) GROUP BY MJ1.FACILITY, MJ1.DATE,MJ1.TYPE)),
                   NONPV AS (
                    SELECT T.EANCODE AS EAN ,
                           FACILITY ,
                           (DATEFROMPARTS(year(Date), MONTH (Date), 01)) AS FOM ,
                           T.CC_NUM AS CC_NUM ,
                           T.CC_NAME_L2 AS CC_NAME ,
                           BOE ,
                           WELL_COUNT ,
                           WELLCOUNT_PRORATION ,
                           T.METER_TYPE AS TYPE ,
                           'NONPV' AS SOURCE
                      FROM PV_AGG_NONPV
                      LEFT JOIN DS_POWER.NBU_MAPPING T
                        ON Facility =FAC_L3
                     WHERE METER_TYPE = 'FAC'
                   ),
                   PV AS (
                    SELECT MJ1.WELL_NAME,
                           PV_W.UWI ,
                           MJ1.CC_NUM,
                           MJ1.CC_NAME ,
                           PV_W.PROVINCE AS PROVINCE,
                           PV_W.CORE_AREA AS CORE_AREA ,
                           PV_W.AREA AS AREA,
                           PV_W.FOREMAN AS FOREMAN ,
                           PV_W.RUN_NAME,
                           MJ1.FACILITY AS FACILITY ,
                           PV_W.BATTERY,
                           PV_W.WELL_TYPE ,
                           PV_W.Surface_Location,
                           PV_W.SURFACE_LATITUDE ,
                           PV_W.SURFACE_LONGITUDE,
                           PV_W.OPERATING_HOURS ,
                           PV_W.DOWNTIME_HOURS,
                           PV_W.PROD_YEARMONTH ,
                           PV_W.WORKING_INTEREST,
                           PV_W.PUMP_TYPE ,
                           MJ1.METER_NUMBER,
                           PV_AGG_A.CHILD_ACCOUNT_NUMBER AS CHILD_ACCOUNT_NUMBER ,
                           MJ1.Date AS EOPRODMONTH,
                           (DATEFROMPARTS(year(MJ1.Date), MONTH (MJ1.Date), 01)) AS FOM ,
                           IFNULL(PV_W.WATER_M3,0) AS WATER_M3,
                           IFNULL(PV_W.OIL_M3,0) AS OIL_M3 ,
                           PV_W.GAS_E3M3,
                           PV_W.OIL_BOE ,
                           PV_W.GAS_BOE,
                           IFNULL(PV_AGG_A.BOE,0)AS BOE ,
                           IFNULL(PV_AGG_A.BOE,0) AS TOTALBOE,
                           PV_AGG_A.WELL_COUNT AS PV_WELL_COUNT ,
                           PV_AGG_A.WELL_COUNT AS MJ_WELL_COUNT,
                           PV_AGG_A.WELLCOUNT_PRORATION ,
                           SOURCE,
                           MJ1.TYPE ,
                           CASE WHEN PV_AGG_A.BOE = 0                                          THEN 1.00/PV_AGG_A.WELL_COUNT
                                WHEN PV_AGG_A.BOE IS NULL AND 1.00/PV_AGG_A.WELL_COUNT IS NULL THEN 1.00
                                ELSE (PV_W.WATER_M3+PV_W.OIL_M3)/PV_AGG_A.BOE
                                 END AS PRORATION_BOE ,
                           CASE WHEN (PV_AGG_A.BOE = 0 AND PV_AGG_A.WELL_COUNT >= 1) OR ((PV_W.WATER_M3+PV_W.OIL_M3) = 0 AND PV_AGG_A.BOE = 0 AND PV_AGG_A.WELL_COUNT > 1) THEN 1.00/PV_AGG_A.WELL_COUNT
                                ELSE (PV_W.WATER_M3+PV_W.OIL_M3)/PV_AGG_A.BOE
                                 END AS WELL_PRORATION
                      FROM MJ1
                      LEFT JOIN WS_EDW.VIEW_FDC_PWRANALYTICS PV_W
                        ON MJ1.Well_Name = PV_W.WELL_NAME
                       AND MJ1.Date = LAST_DAY(DATE(concat(SUBSTRING(cast(PV_W.Prod_YEARMONTH AS varchar),1,4), '-', SUBSTRING(cast(PV_W.Prod_YEARMONTH AS varchar),5,2), '-01')))
                      LEFT JOIN PV_AGG_A
                        ON MJ1.CHILD_ACCOUNT_NUMBER = PV_AGG_A.CHILD_ACCOUNT_NUMBER
                       AND MJ1.Date = PV_AGG_A.Date
                   ) SELECT PB.COUNTRY ,
                   PV.PROVINCE ,
                   PB.LANGUAGE ,
                   PB.CURRENCY ,
                   PB.UTILITY_PROVIDER ,
                   PB.INVOICE_NUMBER ,
                   PB.ACCOUNT_NUMBER ,
                   PB.DELIVERY_POINT ,
                   CAST(CONSUMPTION_MONTH AS DATE) AS CONSUMPTION_MONTH ,
                   PB.METER_NUMBER ,
                   PB.COST_CENTER ,
                   IFNULL(PV.CC_NAME,NONPV.CC_NAME) AS CC_NAME ,
                   PV.CORE_AREA AS CORE_AREA ,
                   PV.AREA AS AREA ,
                   CASE WHEN PV.TYPE='WELL' THEN WELL_PRORATION* TOTAL_CONSUMPTION_KWH
                        ELSE TOTAL_CONSUMPTION_KWH
                         END AS TOTAL_CONSUMPTION_KWH ,
                   CASE WHEN PV.TYPE='WELL' THEN IFNULL(WELL_PRORATION,0)*PEAK_CONSUMPTION_KWH
                        ELSE PEAK_CONSUMPTION_KWH
                         END AS PEAK_CONSUMPTION_KWH ,
                   CASE WHEN PV.TYPE='WELL' THEN IFNULL(WELL_PRORATION,0)*OFF_PEAK_CONSUMPTION_KWH
                        ELSE OFF_PEAK_CONSUMPTION_KWH
                         END AS OFF_PEAK_CONSUMPTION_KWH ,
                   CASE WHEN PV.TYPE='WELL' THEN IFNULL(WELL_PRORATION,0)*REGISTERED_DEMAND_KVA
                        ELSE REGISTERED_DEMAND_KVA
                         END AS REGISTERED_DEMAND_KVA ,
                   CASE WHEN PV.TYPE='WELL' THEN IFNULL(WELL_PRORATION,0)*BILLED_DEMAND_KVA
                        ELSE BILLED_DEMAND_KVA
                         END AS BILLED_DEMAND_KVA ,
                   CURRENT_METER_READ_DATE ,
                   CURRENT_METER_READ ,
                   PREVIOUS_METER_READ_DATE ,
                   PREVIOUS_METER_READ ,
                   CASE WHEN PV.TYPE='WELL' THEN IFNULL(WELL_PRORATION,0) * TOTAL_AMOUNT_DUE
                        ELSE TOTAL_AMOUNT_DUE
                         END AS TOTAL_AMOUNT_DUE ,
                   CASE WHEN PV.TYPE='WELL' THEN IFNULL(WELL_PRORATION,0) *SUBTOTAL
                        ELSE SUBTOTAL
                         END AS SUBTOTAL ,
                   CASE WHEN PV.TYPE = 'WELL' THEN IFNULL(WELL_PRORATION,0) *ENERGY_COST
                        ELSE ENERGY_COST
                         END AS ENERGY_COST ,
                   CASE WHEN PV.TYPE='WELL' THEN IFNULL(WELL_PRORATION,0) *PEAK_ENERGY_COST
                        ELSE PEAK_ENERGY_COST
                         END AS PEAK_ENERGY_COST ,
                   CASE WHEN PV.TYPE='WELL' THEN IFNULL(WELL_PRORATION,0) *OFF_PEAK_ENERGY_COST
                        ELSE OFF_PEAK_ENERGY_COST
                         END AS OFF_PEAK_ENERGY_COST ,
                   CASE WHEN PV.TYPE ='WELL' THEN BASIC_COST/PV.MJ_WELL_COUNT
                        ELSE BASIC_COST
                         END AS BASIC_COST ,
                   CASE WHEN PV.TYPE = 'WELL' THEN IFNULL(WELL_PRORATION,0) *DEMAND_COST
                        ELSE DEMAND_COST
                         END AS DEMAND_COST ,
                   REACTIVE_COST ,
                   CASE WHEN PV.TYPE = 'WELL' THEN IFNULL(WELL_PRORATION,0) * TRANSMISSION_COST
                        ELSE TRANSMISSION_COST
                         END AS TRANSMISSION_COST ,
                   CASE WHEN PV.TYPE = 'WELL' THEN IFNULL(WELL_PRORATION,0) * OTHER_COST
                        ELSE OTHER_COST
                         END AS OTHER_COST ,
                   PB.SERVICE_ADDRESS --Taxes---
            ,
                   CARBON_TAX ,
                   CARBON_TAX_GST ,
                   FEDERAL_TAX_GST ,
                   PST ,
                   MST ,
                   VAT ,
                   CAST(METER_TYPE AS VARCHAR) AS METER_TYPE ,
                   BILL_MULTIPLIER ,
                   RATE ,
                   POWER_FACTOR ,
                   PEAK_DEMAND ,
                   BILL_DAYS ---PV Cols ---
            ,
                   IFNULL(PV.CC_NUM,NONPV.CC_NUM) AS CC_NUM ,
                   PV.PROD_YEARMONTH ,
                   PV.WELL_NAME ,
                   PV.FOREMAN AS FOREMAN ,
                   BATTERY ,
                   UWI ,
                   IFNULL(PV.Type,NONPV.TYPE) AS WELL_TYPE ,
                   RUN_NAME ,
                   SURFACE_LOCATION ,
                   SURFACE_LATITUDE ,
                   SURFACE_LONGITUDE ,
                   PV.OPERATING_HOURS ,
                   PV.DOWNTIME_HOURS ,
                   PV.OIL_M3 ,
                   PV.WATER_M3 ,
                   PV.GAS_E3M3 ,
                   PV.OIL_BOE ,
                   PV.GAS_BOE ,
                   IFNULL(PV.BOE,NONPV.BOE) AS BOE ,
                   IFNULL(PV.FACILITY,NONPV.Facility) AS FACILITY ,
                   WORKING_INTEREST ,
                   PV.PUMP_TYPE ,
                   IFNULL(PV.Source,NONPV.Source) AS SOURCE ----   calculated columns below provide by the business to include in view -----------
            ,
                   (WELL_PRORATION*(ENERGY_COST + DEMAND_COST + VAT + PST))+ (PV.WELLCOUNT_PRORATION*BASIC_COST) AS TOTAL_COST ,
                   CASE WHEN WELL_TYPE = 'WELL' THEN 'WELL'
                        ELSE 'FAC'
                         END AS NORM_TYPE
              FROM WS_EDW.VIEW_PWRANALYTICS_VET_POWER_MTH_UNION PB
              LEFT JOIN NONPV
                ON NONPV.EAN = PB.Delivery_Point
               AND NONPV.FOM = (PB.Consumption_Month)
              LEFT JOIN PV
                ON PV.CHILD_ACCOUNT_NUMBER=PB.Account_Number
               AND PV.FOM = (PB.Consumption_Month)
             WHERE PB.COUNTRY = 'NETHERLANDS'
        dependencies:
          - locationName: TARGET
            nodeName: VIEW_PWRANALYTICS_VET_POWER_MTH_UNION
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','VIEW_PWRANALYTICS_VET_POWER_MTH_UNION') }}
        name: VIEW_PWRANALYTICS_NBU_POWERALLOCATION_MTH
        noLinkRefs: []
  name: VIEW_PWRANALYTICS_NBU_POWERALLOCATION_MTH
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
