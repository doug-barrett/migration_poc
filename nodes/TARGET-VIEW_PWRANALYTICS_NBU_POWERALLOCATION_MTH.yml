fileVersion: 1
id: fc08f113-3f49-408b-9095-923c711a4597
name: VIEW_PWRANALYTICS_NBU_POWERALLOCATION_MTH
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2571e7a8-8d32-4ee0-9ed9-22e63c268ef7
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: VARCHAR(13)
        defaultValue: ""
        description: ""
        name: COUNTRY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa554cce-aa4e-4c5e-bed7-4dd950e90af0
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f332459f-c305-40aa-97a7-9b5e6cea105a
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: PROVINCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9bdbfeb3-13e8-442d-9aed-8d56112464b2
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f6a6122-f4d6-41c1-8e10-2c99d4c22285
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: VARCHAR(14)
        defaultValue: ""
        description: ""
        name: LANGUAGE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 449144c9-0612-47a3-aa8d-4d5a5839c450
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3fb41c7-224f-45d5-bac5-ab02dcfc058f
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: CURRENCY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 290506b2-3b5c-43c9-adec-0c26685119a4
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 793f7000-1590-4f4c-ac3d-a3648124aef7
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: VARCHAR(24)
        defaultValue: ""
        description: ""
        name: UTILITY_PROVIDER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b55f17c-eaf7-41be-81e8-1511ca98facd
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fbc1ccd5-d021-43ff-a70b-4e4b22d3a631
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: NUMBER(38,0)
        defaultValue: ""
        description: ""
        name: INVOICE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 96e616e8-f0da-466d-b452-9b2a4d91c15c
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f6c9696-f412-4c79-9175-9523eeb5ace8
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: ACCOUNT_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 28354c2e-d1a2-4efc-bb1a-b5f6a4b27b9f
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 44eae2d9-bfd2-498c-b2ee-6a53ab1b278b
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: DELIVERY_POINT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8474c817-ed24-4714-9682-d81badbb4351
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 145cef9c-b088-4492-b822-537c96044d5b
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: CONSUMPTION_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 093df048-a345-4bba-8eea-252aa09a0aca
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df3efa0e-3fab-49e7-a932-f3afbd06e2fd
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: METER_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fee92307-11b5-4d28-8771-4ecdf5e7db4a
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 520443f5-5ef9-43aa-ae1d-d12878d44334
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: COST_CENTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c790732c-e794-40bb-8e30-4b67cbe4f242
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ac14a3d-7775-4030-9c01-4ac21dc8e1cd
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CC_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a975a6d0-ee9a-4bdf-9372-d08e4986e9d3
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CORE_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 13403e1c-5d17-4898-b08f-5618aa0bfa4a
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d54199f7-d275-4649-9560-3be3621d9a72
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87052831-2aca-46b8-b60d-bcd1a59943f8
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: TOTAL_CONSUMPTION_KWH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c5c3f56-211b-42ec-8d06-95d79e12c0e5
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01db8fb4-5044-4659-a954-615fec85e4d1
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PEAK_CONSUMPTION_KWH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 62cb0094-e7da-452e-8f75-9ff9d8b3de66
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c7c443a-ba4a-4ac7-b4f2-316dbd0c89a0
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OFF_PEAK_CONSUMPTION_KWH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6b01c50a-ac04-425e-b21f-e5c8179e2f83
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bdbfe127-56c7-4977-9511-236693adcebc
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: REGISTERED_DEMAND_KVA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8a7d28dc-0b23-4e35-96ff-b25bc6829d8d
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1351b2a0-6a55-493f-afdd-2979b61a21f2
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BILLED_DEMAND_KVA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f959cc5-3ea3-4513-a384-3f6a12348b17
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 93745344-8c5e-4cef-8003-fc8e7735e4b7
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CURRENT_METER_READ_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f9ba970b-ac96-4b7c-8370-2096939dfc22
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d1702935-493d-40ad-a4d9-645ee6f1c7fe
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: CURRENT_METER_READ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 29f5dd18-09b5-4487-ad3a-6817a2503576
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98067e2a-2571-41f6-acfe-7d72bc9ea10a
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: PREVIOUS_METER_READ_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 804440e4-1482-42db-bac9-b71d959cd343
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8878983b-c3f1-42db-8265-6990e5d32704
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PREVIOUS_METER_READ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ff57042-ec29-40a6-911a-4381194ed0d3
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e7a3cbc-1299-49bb-9cb3-3b78ddfd0920
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: TOTAL_AMOUNT_DUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 57ac190f-0b4d-4c4b-bd49-e555a1aabaf2
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e03d1b5-8905-425d-938e-852a4bca5961
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: SUBTOTAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e6078465-1781-44f6-adc4-1e934e936b7c
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 620c32ad-eb6f-4e3b-b9fb-f80c6c56133e
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: ENERGY_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1be3a8bb-76c8-4664-b9d4-19eb4713fbfc
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7cd25ac2-e9a6-4f76-8d5b-efbecd3b7423
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PEAK_ENERGY_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0674dc6e-63b4-4d3a-8131-bc3907e705a3
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2327d8ea-428a-42d5-9f92-4e7040a7fa29
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OFF_PEAK_ENERGY_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c62ff5f-a58f-4d28-8075-704b1093047d
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f14a552f-6b6b-404e-91b7-7a0b1b649e28
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BASIC_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 65702267-8925-410a-9454-e0bf59cbbf7a
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e60d48da-ba01-4034-a8d0-c44e2939b52b
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: DEMAND_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e0b273ac-e043-4ee0-aa97-c4abedf67933
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0493f409-78c5-41e3-8583-fb2c08094430
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: REACTIVE_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67c8011f-ba45-4a70-966f-00d4e76e0b8b
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 65e5c64e-6baf-40a4-9a36-24f62578c676
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: TRANSMISSION_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 40fafa9f-a8b7-4bcc-8e13-66a7f61019b0
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3cb80b01-e6b4-44df-8a0a-cff837f73eaf
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OTHER_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2f86f4da-6d89-462a-89fc-75cde9da0921
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67be80d3-b8da-49a1-b228-0e24b74d9580
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: SERVICE_ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 851c7eae-5096-4b15-8011-3db81829235e
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0338fe6-7ac8-47ce-9637-321886f0efe8
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: CARBON_TAX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d43bd47c-5d87-4e09-b17a-73883c60b1ba
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b6dafa1-0588-4039-acc8-2793337b66f1
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: CARBON_TAX_GST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a9954d46-2cb8-4670-aaec-6163edd515ed
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f81c3d00-6da4-4a33-b86e-bcf670f7c96e
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: FEDERAL_TAX_GST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3c4bd01c-bb7d-4ff6-a254-24450d42d1ce
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 165d5e06-8323-4569-a625-e30dccb7389e
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f4ad04f-8d11-4d64-ab29-d1cde0606cd3
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f3d06ab6-2589-458c-a343-a80b602fce34
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: MST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67837649-9af0-4f7c-bb1d-6e00a8b067ef
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0d2eedb-fa54-4216-8227-72e728867bda
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: VAT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b859f894-9247-4f45-9f3c-900bce2298af
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b33f315-9491-49ce-8bae-550b01a96b27
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: METER_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72693e63-7f83-4aa6-86c9-0029bae791a1
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e707c7dd-2f45-484a-81f1-e34f2a9c7ef7
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BILL_MULTIPLIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39aed6e2-9a56-469c-ad39-c62968146169
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26e0a667-5619-4f8b-8e91-4fde5c569553
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5aab0e90-27b2-47c7-9f2a-ad083e3b5605
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78e9fa1b-6144-49e4-8881-2b1ceae902be
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: POWER_FACTOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 55f4c84d-d4db-4498-9e72-6db8265679e8
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e16182f5-106e-4d69-b0a9-e2242f4cbb32
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PEAK_DEMAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2fb3f2f1-11c6-421b-b4ce-fcbe13d35f4b
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 35723bea-9a5c-47c9-91a3-82cf46dc3bfc
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BILL_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 40861f14-a125-4d5b-b8cd-c28365b8f583
                stepCounter: 1219194f-2e69-4511-8c03-744d7776c476
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad087985-7048-4636-b83f-59ad65088c4c
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e84c4da-eeb2-4cd2-8da2-0d60df459448
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PROD_YEARMONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 601d5bac-d1a4-4a32-b092-39849ca7f909
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: WELL_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e2fa0e4-2cce-47e7-9dde-5ef353bcd550
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: FOREMAN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3127ae76-21f3-4ccd-a7cb-2253ed8e1247
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: BATTERY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc394fef-48d9-4681-80fa-a0496ff63bfd
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4240eaad-fa8d-4db5-94a4-7c5c1b19934c
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: WELL_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be6d04bd-632c-48ef-95bf-959e75539972
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: RUN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 35effeda-93d5-41de-9f1a-a5be2124820f
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: SURFACE_LOCATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 46be8c8e-386d-447d-9126-7fa5c8bed5c0
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: SURFACE_LATITUDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86e0acd9-6e67-460d-90fa-9205031b89fc
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: SURFACE_LONGITUDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49457f03-a0b2-4b05-9072-0297d43df0a2
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OPERATING_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27f303ca-a7b2-4b49-94fa-08923a859b1f
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: DOWNTIME_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3eea650f-e086-4325-be02-095482855474
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OIL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a8f19fa-1747-441e-96bc-4beff54a1381
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: WATER_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 83c983aa-e64d-4c7b-91d1-287c76e85246
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: GAS_E3M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33f21363-3aa2-4ace-b0aa-be40e061f3ae
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OIL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1f5fb59-07bd-4849-8766-877fa62fab9e
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: GAS_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6f874d3-e087-47cb-b48c-3f53ba48bce4
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 28c84385-a76d-41b5-b90f-fe9093f6feee
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: FACILITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5762b615-af40-4422-928d-dfac81878bcd
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: WORKING_INTEREST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3cfe5614-6abf-4cfa-bbb4-83e708d309d9
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: PUMP_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b2c8aca5-af8e-4bd8-96ac-b2c9fba73945
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6134351-2238-4167-b3cd-32920b6c66db
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: TOTAL_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40e5ec63-300c-42b9-93ba-a05ecf42aa5b
          stepCounter: fc08f113-3f49-408b-9095-923c711a4597
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: NORM_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_PWRANALYTICS_NBU_POWERALLOCATION_MTH: fc08f113-3f49-408b-9095-923c711a4597
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_PWRANALYTICS_NBU_POWERALLOCATION_MTH') }} AS WITH MJ AS (
                    SELECT distinct(WELL_NAME),
                           CHILD_ACCOUNT_NUMBER ,
                           METER_NUMBER,
                           IFNULL(PV.CC_NUM,T.CC_NUM) AS CC_NUM ,
                           IFNULL(CC_NAME,T.CC_NAME_L2) AS CC_NAME ,
                           AREA,
                           CORE_AREA ,
                           PROVINCE,
                           IFNULL(FACILITY,T.FAC_L3) AS FACILITY ,
                           FOREMAN,
                           T.METER_TYPE AS TYPE ,
                           'ProdView' AS SOURCE
                      FROM WS_EDW.VIEW_FDC_PWRANALYTICS PV
                      LEFT JOIN (
                            SELECT *
                              FROM DS_POWER.NBU_MAPPING
                           ) T
                        ON PV.WELL_NAME=T.WELL_NAME_L1
                     WHERE COUNTRY = 'NETHERLANDS'
                       AND PROD_YEARMONTH>='202201'
                   ),
                   MJ1 AS (
                    SELECT *
                      FROM MJ
                     CROSS JOIN DS_POWER.VET_DIMDATE M
                     WHERE Year(Date) >= 2022
                       AND Year(Date) <= Year(GetDate())
                   ),
                   PV_AGG_A AS ((SELECT MJ1.WELL_NAME ,Max(MJ1.CHILD_ACCOUNT_NUMBER) AS CHILD_ACCOUNT_NUMBER ,max(MJ1.Facility) AS FACILITY ,MJ1.DATE ,Max(MJ1.Type) AS TYPE ,Sum(IFNULL(BOE,0)) AS BOE ,count(*) AS WELL_COUNT ,1.00/Count(*) AS WELLCOUNT_PRORATION FROM MJ1 LEFT OUTER JOIN WS_EDW.VIEW_FDC_PWRANALYTICS PV ON MJ1.WELL_NAME = PV.WELL_NAME AND MJ1.Date = LAST_DAY(DATE(concat(SUBSTRING(cast(Prod_YEARMONTH AS varchar),1,4), '-', SUBSTRING(cast(Prod_YEARMONTH AS varchar),5,2), '-01'))) GROUP BY MJ1.WELL_NAME, MJ1.Date)),
                   PV_AGG_NONPV AS ((SELECT 0 AS CHILD_ACCOUNT_NUMBER ,MJ1.Facility AS FACILITY ,MJ1.DATE ,MJ1.Type AS TYPE ,Sum(IFNULL(BOE,0)) AS BOE ,count(*)-1 AS WELL_COUNT ,1.00/Count(*) AS WELLCOUNT_PRORATION FROM MJ1 LEFT OUTER JOIN WS_EDW.VIEW_FDC_PWRANALYTICS PV ON MJ1.WELL_NAME = PV.WELL_NAME AND MJ1.Date = LAST_DAY(DATE(concat(SUBSTRING(cast(Prod_YEARMONTH AS varchar),1,4), '-', SUBSTRING(cast(Prod_YEARMONTH AS varchar),5,2), '-01'))) GROUP BY MJ1.FACILITY, MJ1.DATE,MJ1.TYPE)),
                   NONPV AS (
                    SELECT T.EANCODE AS EAN ,
                           FACILITY ,
                           (DATEFROMPARTS(year(Date), MONTH (Date), 01)) AS FOM ,
                           T.CC_NUM AS CC_NUM ,
                           T.CC_NAME_L2 AS CC_NAME ,
                           BOE ,
                           WELL_COUNT ,
                           WELLCOUNT_PRORATION ,
                           T.METER_TYPE AS TYPE ,
                           'NONPV' AS SOURCE
                      FROM PV_AGG_NONPV
                      LEFT JOIN DS_POWER.NBU_MAPPING T
                        ON Facility =FAC_L3
                     WHERE METER_TYPE = 'FAC'
                   ),
                   PV AS (
                    SELECT MJ1.WELL_NAME,
                           PV_W.UWI ,
                           MJ1.CC_NUM,
                           MJ1.CC_NAME ,
                           PV_W.PROVINCE AS PROVINCE,
                           PV_W.CORE_AREA AS CORE_AREA ,
                           PV_W.AREA AS AREA,
                           PV_W.FOREMAN AS FOREMAN ,
                           PV_W.RUN_NAME,
                           MJ1.FACILITY AS FACILITY ,
                           PV_W.BATTERY,
                           PV_W.WELL_TYPE ,
                           PV_W.Surface_Location,
                           PV_W.SURFACE_LATITUDE ,
                           PV_W.SURFACE_LONGITUDE,
                           PV_W.OPERATING_HOURS ,
                           PV_W.DOWNTIME_HOURS,
                           PV_W.PROD_YEARMONTH ,
                           PV_W.WORKING_INTEREST,
                           PV_W.PUMP_TYPE ,
                           MJ1.METER_NUMBER,
                           PV_AGG_A.CHILD_ACCOUNT_NUMBER AS CHILD_ACCOUNT_NUMBER ,
                           MJ1.Date AS EOPRODMONTH,
                           (DATEFROMPARTS(year(MJ1.Date), MONTH (MJ1.Date), 01)) AS FOM ,
                           IFNULL(PV_W.WATER_M3,0) AS WATER_M3,
                           IFNULL(PV_W.OIL_M3,0) AS OIL_M3 ,
                           PV_W.GAS_E3M3,
                           PV_W.OIL_BOE ,
                           PV_W.GAS_BOE,
                           IFNULL(PV_AGG_A.BOE,0)AS BOE ,
                           IFNULL(PV_AGG_A.BOE,0) AS TOTALBOE,
                           PV_AGG_A.WELL_COUNT AS PV_WELL_COUNT ,
                           PV_AGG_A.WELL_COUNT AS MJ_WELL_COUNT,
                           PV_AGG_A.WELLCOUNT_PRORATION ,
                           SOURCE,
                           MJ1.TYPE ,
                           CASE WHEN PV_AGG_A.BOE = 0                                          THEN 1.00/PV_AGG_A.WELL_COUNT
                                WHEN PV_AGG_A.BOE IS NULL AND 1.00/PV_AGG_A.WELL_COUNT IS NULL THEN 1.00
                                ELSE (PV_W.WATER_M3+PV_W.OIL_M3)/PV_AGG_A.BOE
                                 END AS PRORATION_BOE ,
                           CASE WHEN (PV_AGG_A.BOE = 0 AND PV_AGG_A.WELL_COUNT >= 1) OR ((PV_W.WATER_M3+PV_W.OIL_M3) = 0 AND PV_AGG_A.BOE = 0 AND PV_AGG_A.WELL_COUNT > 1) THEN 1.00/PV_AGG_A.WELL_COUNT
                                ELSE (PV_W.WATER_M3+PV_W.OIL_M3)/PV_AGG_A.BOE
                                 END AS WELL_PRORATION
                      FROM MJ1
                      LEFT JOIN WS_EDW.VIEW_FDC_PWRANALYTICS PV_W
                        ON MJ1.Well_Name = PV_W.WELL_NAME
                       AND MJ1.Date = LAST_DAY(DATE(concat(SUBSTRING(cast(PV_W.Prod_YEARMONTH AS varchar),1,4), '-', SUBSTRING(cast(PV_W.Prod_YEARMONTH AS varchar),5,2), '-01')))
                      LEFT JOIN PV_AGG_A
                        ON MJ1.CHILD_ACCOUNT_NUMBER = PV_AGG_A.CHILD_ACCOUNT_NUMBER
                       AND MJ1.Date = PV_AGG_A.Date
                   ) SELECT PB.COUNTRY ,
                   PV.PROVINCE ,
                   PB.LANGUAGE ,
                   PB.CURRENCY ,
                   PB.UTILITY_PROVIDER ,
                   PB.INVOICE_NUMBER ,
                   PB.ACCOUNT_NUMBER ,
                   PB.DELIVERY_POINT ,
                   CAST(CONSUMPTION_MONTH AS DATE) AS CONSUMPTION_MONTH ,
                   PB.METER_NUMBER ,
                   PB.COST_CENTER ,
                   IFNULL(PV.CC_NAME,NONPV.CC_NAME) AS CC_NAME ,
                   PV.CORE_AREA AS CORE_AREA ,
                   PV.AREA AS AREA ,
                   CASE WHEN PV.TYPE='WELL' THEN WELL_PRORATION* TOTAL_CONSUMPTION_KWH
                        ELSE TOTAL_CONSUMPTION_KWH
                         END AS TOTAL_CONSUMPTION_KWH ,
                   CASE WHEN PV.TYPE='WELL' THEN IFNULL(WELL_PRORATION,0)*PEAK_CONSUMPTION_KWH
                        ELSE PEAK_CONSUMPTION_KWH
                         END AS PEAK_CONSUMPTION_KWH ,
                   CASE WHEN PV.TYPE='WELL' THEN IFNULL(WELL_PRORATION,0)*OFF_PEAK_CONSUMPTION_KWH
                        ELSE OFF_PEAK_CONSUMPTION_KWH
                         END AS OFF_PEAK_CONSUMPTION_KWH ,
                   CASE WHEN PV.TYPE='WELL' THEN IFNULL(WELL_PRORATION,0)*REGISTERED_DEMAND_KVA
                        ELSE REGISTERED_DEMAND_KVA
                         END AS REGISTERED_DEMAND_KVA ,
                   CASE WHEN PV.TYPE='WELL' THEN IFNULL(WELL_PRORATION,0)*BILLED_DEMAND_KVA
                        ELSE BILLED_DEMAND_KVA
                         END AS BILLED_DEMAND_KVA ,
                   CURRENT_METER_READ_DATE ,
                   CURRENT_METER_READ ,
                   PREVIOUS_METER_READ_DATE ,
                   PREVIOUS_METER_READ ,
                   CASE WHEN PV.TYPE='WELL' THEN IFNULL(WELL_PRORATION,0) * TOTAL_AMOUNT_DUE
                        ELSE TOTAL_AMOUNT_DUE
                         END AS TOTAL_AMOUNT_DUE ,
                   CASE WHEN PV.TYPE='WELL' THEN IFNULL(WELL_PRORATION,0) *SUBTOTAL
                        ELSE SUBTOTAL
                         END AS SUBTOTAL ,
                   CASE WHEN PV.TYPE = 'WELL' THEN IFNULL(WELL_PRORATION,0) *ENERGY_COST
                        ELSE ENERGY_COST
                         END AS ENERGY_COST ,
                   CASE WHEN PV.TYPE='WELL' THEN IFNULL(WELL_PRORATION,0) *PEAK_ENERGY_COST
                        ELSE PEAK_ENERGY_COST
                         END AS PEAK_ENERGY_COST ,
                   CASE WHEN PV.TYPE='WELL' THEN IFNULL(WELL_PRORATION,0) *OFF_PEAK_ENERGY_COST
                        ELSE OFF_PEAK_ENERGY_COST
                         END AS OFF_PEAK_ENERGY_COST ,
                   CASE WHEN PV.TYPE ='WELL' THEN BASIC_COST/PV.MJ_WELL_COUNT
                        ELSE BASIC_COST
                         END AS BASIC_COST ,
                   CASE WHEN PV.TYPE = 'WELL' THEN IFNULL(WELL_PRORATION,0) *DEMAND_COST
                        ELSE DEMAND_COST
                         END AS DEMAND_COST ,
                   REACTIVE_COST ,
                   CASE WHEN PV.TYPE = 'WELL' THEN IFNULL(WELL_PRORATION,0) * TRANSMISSION_COST
                        ELSE TRANSMISSION_COST
                         END AS TRANSMISSION_COST ,
                   CASE WHEN PV.TYPE = 'WELL' THEN IFNULL(WELL_PRORATION,0) * OTHER_COST
                        ELSE OTHER_COST
                         END AS OTHER_COST ,
                   PB.SERVICE_ADDRESS --Taxes---
            ,
                   CARBON_TAX ,
                   CARBON_TAX_GST ,
                   FEDERAL_TAX_GST ,
                   PST ,
                   MST ,
                   VAT ,
                   CAST(METER_TYPE AS VARCHAR) AS METER_TYPE ,
                   BILL_MULTIPLIER ,
                   RATE ,
                   POWER_FACTOR ,
                   PEAK_DEMAND ,
                   BILL_DAYS ---PV Cols ---
            ,
                   IFNULL(PV.CC_NUM,NONPV.CC_NUM) AS CC_NUM ,
                   PV.PROD_YEARMONTH ,
                   PV.WELL_NAME ,
                   PV.FOREMAN AS FOREMAN ,
                   BATTERY ,
                   UWI ,
                   IFNULL(PV.Type,NONPV.TYPE) AS WELL_TYPE ,
                   RUN_NAME ,
                   SURFACE_LOCATION ,
                   SURFACE_LATITUDE ,
                   SURFACE_LONGITUDE ,
                   PV.OPERATING_HOURS ,
                   PV.DOWNTIME_HOURS ,
                   PV.OIL_M3 ,
                   PV.WATER_M3 ,
                   PV.GAS_E3M3 ,
                   PV.OIL_BOE ,
                   PV.GAS_BOE ,
                   IFNULL(PV.BOE,NONPV.BOE) AS BOE ,
                   IFNULL(PV.FACILITY,NONPV.Facility) AS FACILITY ,
                   WORKING_INTEREST ,
                   PV.PUMP_TYPE ,
                   IFNULL(PV.Source,NONPV.Source) AS SOURCE ----   calculated columns below provide by the business to include in view -----------
            ,
                   (WELL_PRORATION*(ENERGY_COST + DEMAND_COST + VAT + PST))+ (PV.WELLCOUNT_PRORATION*BASIC_COST) AS TOTAL_COST ,
                   CASE WHEN WELL_TYPE = 'WELL' THEN 'WELL'
                        ELSE 'FAC'
                         END AS NORM_TYPE
              FROM WS_EDW.VIEW_PWRANALYTICS_VET_POWER_MTH_UNION PB
              LEFT JOIN NONPV
                ON NONPV.EAN = PB.Delivery_Point
               AND NONPV.FOM = (PB.Consumption_Month)
              LEFT JOIN PV
                ON PV.CHILD_ACCOUNT_NUMBER=PB.Account_Number
               AND PV.FOM = (PB.Consumption_Month)
             WHERE PB.COUNTRY = 'NETHERLANDS'
        dependencies:
          - locationName: TARGET
            nodeName: VIEW_PWRANALYTICS_VET_POWER_MTH_UNION
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','VIEW_PWRANALYTICS_VET_POWER_MTH_UNION') }}
        name: VIEW_PWRANALYTICS_NBU_POWERALLOCATION_MTH
        noLinkRefs: []
  name: VIEW_PWRANALYTICS_NBU_POWERALLOCATION_MTH
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
