fileVersion: 1
id: 10dda8e2-688e-4a23-9ca2-06986ffe7647
name: S_EREFERRAL_40
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c072d235-0666-4ece-87ef-27ddbf575826
          stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: EREFUID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2459512d-273c-4561-9b09-93ba59d4e453
                stepCounter: 92d836c6-1170-4779-ad5c-dcfb57d04db0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 211867f6-fe2f-4044-85fe-fc142af1bd57
          stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
        config: {}
        dataType: NVARCHAR(15)
        defaultValue: ""
        description: ""
        name: NHI
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09a0b479-a425-4c9d-a94e-5c5089cd1c63
                stepCounter: 92d836c6-1170-4779-ad5c-dcfb57d04db0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e10253f-9db1-4001-982a-8b88bc2fe85e
          stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: EXTERNAL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b63d7a3c-27ec-4322-b455-c190e7492c56
                stepCounter: 92d836c6-1170-4779-ad5c-dcfb57d04db0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b714c92b-021d-400a-94f4-e8598c7da80b
          stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18568b8d-f4ea-47b6-8789-b2d69e7c43ea
                stepCounter: 92d836c6-1170-4779-ad5c-dcfb57d04db0
            transform: "'R'+ s_ereferral_30.referral_encounter_id"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 684bdfe3-76ec-4ff7-8d0b-ec1d86167e8a
          stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
        config: {}
        dataType: NVARCHAR(200)
        defaultValue: ""
        description: ""
        name: CURRENT_SERVICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1b058c4-2e07-4c5c-825c-58c545e037c9
                stepCounter: 92d836c6-1170-4779-ad5c-dcfb57d04db0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf2184cc-00a2-4989-98ab-0d1d56ed0df5
          stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: CURRENT_SERVICE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f6703dc-6cad-4f22-b606-b9ad404504f5
                stepCounter: 92d836c6-1170-4779-ad5c-dcfb57d04db0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b99cef9a-8bc5-4b4d-8ff0-12a0d9c6049d
          stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: EREFNHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f3e4325b-c186-432e-87f4-90cad5e7e62c
                stepCounter: 92d836c6-1170-4779-ad5c-dcfb57d04db0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c5177e8-2145-4117-95e6-12441980e2e4
          stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
        config: {}
        dataType: INT
        defaultValue: ""
        description: PIMS Speciality Reference Number
        name: SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 638ee1e9-b3f6-4e25-82a9-85dc713e4698
                stepCounter: 4182a75e-d07b-4637-97fa-4c01e2878360
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87dbcaac-30bc-4abe-9eff-4fd66e6302de
          stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SUBMISSION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a03b4023-0502-41c2-a577-e2f0e58ab990
                stepCounter: 92d836c6-1170-4779-ad5c-dcfb57d04db0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e918f302-ee08-418c-bac3-0eaa3a7f631b
          stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9151bdbe-6e17-4e2a-af88-5fbe0f5ec03e
                stepCounter: 92d836c6-1170-4779-ad5c-dcfb57d04db0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9aad4909-fa54-4ca6-a29a-58c6848a1de3
          stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
        config: {}
        dataType: NVARCHAR(200)
        defaultValue: ""
        description: ""
        name: STATUS_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c3d1e6e-5b76-4a7b-91e9-6c46bd87980b
                stepCounter: 92d836c6-1170-4779-ad5c-dcfb57d04db0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e26b3c84-52e4-4b92-9629-dff70637fabd
          stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: RFA_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef69212a-4493-4d20-a26b-882d69cb5680
                stepCounter: 92d836c6-1170-4779-ad5c-dcfb57d04db0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce1b6b5a-7c0d-4b8e-b92a-946e718ece3e
          stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
        config: {}
        dataType: NVARCHAR(200)
        defaultValue: ""
        description: ""
        name: RFA_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 369a9010-d1d6-4993-a4b8-398ef2bb9a28
                stepCounter: 92d836c6-1170-4779-ad5c-dcfb57d04db0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 101c1020-0656-4ebf-a926-cfd0059e95aa
          stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: MATCH_REFERENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1a464818-0b8d-404d-bd55-16b8f371cf00
                stepCounter: 92d836c6-1170-4779-ad5c-dcfb57d04db0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3847ccbd-59c6-4c3f-9c45-aa8863e27146
          stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: MATCH_CERTAINTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1179a2b7-caa2-4eed-bca4-b9c952fe06da
                stepCounter: 92d836c6-1170-4779-ad5c-dcfb57d04db0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22e84832-3213-4c48-855d-ee40a7c03c14
          stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
        config: {}
        dataType: NVARCHAR(5)
        defaultValue: ""
        description: ""
        name: MERGED_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 66ae2955-c719-4b55-a899-f7787a28f46d
                stepCounter: 92d836c6-1170-4779-ad5c-dcfb57d04db0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3deae3ce-b584-4f54-b78e-578568233150
          stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
        config: {}
        dataType: VARCHAR(200)
        defaultValue: ""
        description: ""
        name: MATCH_REASON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ae2143c-42c9-4201-8986-2f73b5217e04
                stepCounter: 92d836c6-1170-4779-ad5c-dcfb57d04db0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 76217a61-422a-4359-9d1f-b5f0d61afdd9
          stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PIMS_PATIENT_REFERENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ceeee4ac-eaac-4eae-826a-7c7b648bb5ec
                stepCounter: 92d836c6-1170-4779-ad5c-dcfb57d04db0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea2edee7-7cbd-4061-b5f1-0c78c3ca303a
          stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PIMS_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 266a63c5-8c7f-4f40-9c77-11d6c29f718b
                stepCounter: 92d836c6-1170-4779-ad5c-dcfb57d04db0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1770b5be-4293-400c-9938-f988e68dc139
          stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PIMS_REFERRAL_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77c3fd1a-4f2d-4cb8-ac26-e12a120b37d9
                stepCounter: 92d836c6-1170-4779-ad5c-dcfb57d04db0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 650aeff2-5b90-452a-a7ed-cf39640b0ca6
          stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: DAYS_BETWEEN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9490a687-0d98-44de-98a4-cf59af56113e
                stepCounter: 92d836c6-1170-4779-ad5c-dcfb57d04db0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71302a4e-d4a6-4bad-9de7-ea5ad6d352ec
          stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: STATUS_CHANGED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5145c363-110c-491f-9f04-7831fa5fade9
                stepCounter: 92d836c6-1170-4779-ad5c-dcfb57d04db0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c01bb7ad-a6c9-4cd0-bab6-d9338afef4d5
          stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REGISTERED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4bb5e5a-e64a-42c3-9f6d-5a042265bc30
                stepCounter: 92d836c6-1170-4779-ad5c-dcfb57d04db0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6328f6a-6313-4ca0-b3d8-273876e6690b
          stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_EREFERRAL_30: 92d836c6-1170-4779-ad5c-dcfb57d04db0
          DIM_SPECIALTY: 4182a75e-d07b-4637-97fa-4c01e2878360
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_EREFERRAL_30
          - locationName: TGT
            nodeName: DIM_SPECIALTY
        join:
          joinCondition: |-
            FROM {{ ref('TGT','S_EREFERRAL_30') }} s_eReferral_30
              LEFT JOIN {{ ref('TGT','DIM_SPECIALTY') }} dim_specialty
                ON s_eReferral_30.PiMS_Specialty = dim_specialty.specialty_desc
        name: S_EREFERRAL_40
        noLinkRefs: []
  name: S_EREFERRAL_40
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
