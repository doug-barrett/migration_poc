fileVersion: 1
id: 09991c53-b3e2-450a-84e1-9722b55776ab
name: S_IN_PATIENT_STAY_DETAIL_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "InPatient Ward Stays expanded by Day, with Specialty and Clinician details."
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41b5bca2-fbfc-4df6-b42d-d48b403d9aef
          stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a141ff8-6c07-4ac7-8343-0e0a64072272
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9631bdb0-583d-45ba-a6d9-580e9cee1d91
          stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 790fc1a5-cfd0-4779-9476-2dc5995c43f6
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c14443e0-1bdd-4c76-b977-9643a6dfbe2e
          stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dff4644f-7ff3-4176-9a75-c9cd1d5155ec
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee08d4ce-8bb7-4555-8321-7fdc54ab026a
          stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6426dede-f127-4ca6-af16-1a952173a2c3
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 83c59575-719b-4cfb-ac53-ebb11a903589
          stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: stay_Patient National Health Index (NMPI)
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 06104c8a-ad68-456b-8970-94455fc50362
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92bae77f-3748-4428-a77c-1bf365f90ccf
          stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: STAY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e87bb797-4278-46bb-9a33-3d3888a1e992
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: |-
              CASE WHEN DATEDIFF(DAY,calendar_date,stay_start_date) = 0 THEN stay_start_date
                          ELSE cast(calendar_date AS date)
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce964ded-3592-4f6f-8e35-c711a39e3696
          stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: STAY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fed9bff9-76e1-4d14-9309-dce9b7999c68
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: |-
              CASE WHEN DATEDIFF(DAY,calendar_date,stay_end_date) <> 0 AND calendar_date <> stay_end_date THEN calendar_date + 0.99998845
                          ELSE stay_end_date
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9367e1de-7459-4795-9214-3b881b5a0f72
          stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: DIM_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e325898-55b4-4da5-b829-888e5823e2fc
                stepCounter: bc3fcb77-c0c4-477a-92d8-4db14f153b73
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aaf7d8f7-5039-4164-b4b0-593266f28149
          stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: a specific calendar date of all dates covered  this stay
        name: STAY_CALENDAR_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39c5c98c-7ee6-4303-a013-b78bfececaea
                stepCounter: bc3fcb77-c0c4-477a-92d8-4db14f153b73
            transform: |-
              CASE WHEN dim_date.calendar_date IS NOT NULL THEN dim_date.calendar_date + 0.99998845
                          ELSE IFNULL(s_in_patient_stay_10.stay_start_date,s_in_patient_stay_10.stay_end_date)
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a88257ff-1058-48b1-a249-d7f2319850f9
          stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMISSION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 08ef6c7f-2951-4571-a55c-227c3cda7c2d
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fed5694d-0e3c-4f62-a895-43343124f743
          stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d6b85ce-79d9-4886-a4f6-f7fb0c2c72da
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d05b0f5-fa53-4265-bf4d-b6be43619b09
          stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAY_WARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3f336f5b-01f0-43ee-a885-795c0ab59fe4
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b882827-c188-4f0c-b8ab-940dcfd95d03
          stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: stay_ward_code
        name: STAY_WARD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2b57ffd7-44dc-4374-a500-3c4ebf465c7f
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9890381-b2ef-4a80-af37-8f8fadc5a730
          stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e3d43a0a-9f92-4b81-955e-e1aa5227685e
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 56891a28-46a8-488f-b16b-c470b09c20bf
          stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Stay_Healthcare_Professional_Code
        name: STAY_CLINICIAN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 46aabcf6-679b-4a4e-a496-40a9fd62e24b
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3baffb64-9cc4-44c5-91e6-c7893a7c72da
          stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd526170-660a-4278-8b89-2799cf1d8253
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7cb3f210-ca32-45e9-b41a-9af93829fa29
          stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Event_Health_Specialty_Code
        name: EVENT_HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 82445afa-28c0-4bcd-aaa1-ecfcf3972b29
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 144c3b8d-8230-4ab3-84f5-dd74e459b0f7
          stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: stay_current_leave_reference_no
        name: STAY_CURRENT_LEAVE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b00a5f95-efe7-4da9-a899-ef93537f6386
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6e1df0f-425f-44ee-92ba-2e52d5bfd8c0
          stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: STAY_CURRENT_LEAVE_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cc9c9c5b-5dd4-4eed-9989-864610f17949
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af316983-c031-4f39-9757-33035bdc8294
          stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: STAY_CURRENT_LEAVE_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 268468b6-9458-458e-af33-c75645ef76c7
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 664412ac-c947-4f04-a783-253057dcd4f0
          stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ED_ATTENDANCE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b0aa178d-06e4-4205-9492-609746c96b77
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5dcf6435-805c-494f-ab4f-f7bfc3618ecf
          stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c19198d-7cdd-4dd1-8263-e1c97a643348
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: "'R'+CONVERT(varchar,s_in_patient_stay_10.refrl_refno)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 89dc8f4d-57be-4179-b73d-ef4b56f16069
          stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_STAY_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b9c25fc-09f3-46a4-a3e1-f128ac730ffb
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd838134-2d6b-4490-9515-f7e321ceea8f
          stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_STAY_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3dd82dd7-e7e4-4250-99b4-63720d2149c4
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 197078e5-9519-49b5-82f5-33796068ea33
          stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_STAY_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6148561c-5949-40c8-87f8-fd3f782ca106
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb91d3d1-749e-4a41-8fdb-77e530b438b9
          stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_STAY_TOTAL_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0a33331d-ac36-4fde-85d5-98c42b054de8
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 924c9c53-e009-4257-aa82-12c194a14c25
          stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: dss_data_quality_code
        name: DSS_DATA_QUALITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d5613572-b5df-40c2-b577-8bb481b2f201
                stepCounter: 57ae67b1-a27a-46a8-af2e-ca6e51ee7461
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cca26250-bdc4-445a-be22-f546e0a3b16f
          stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: RNSTAY
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: row_number() over(PARTITION BY s_in_patient_stay_10.stay_reference_no ORDER BY dim_date.dim_date_key)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba429d7a-a4f9-4882-a518-2da0a41d67b0
          stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_IN_PATIENT_STAY_10
        join:
          joinCondition: |-
            FROM s_in_patient_stay_10
              LEFT OUTER JOIN dim.dim_date
                ON dim_date.calendar_date BETWEEN CONVERT(date,IFNULL(s_in_patient_stay_10.stay_start_date,s_in_patient_stay_10.stay_end_date)) AND CONVERT(date,IFNULL(s_in_patient_stay_10.stay_end_date,s_in_patient_stay_10.stay_start_date))
        name: S_IN_PATIENT_STAY_DETAIL_10
        noLinkRefs: []
  name: S_IN_PATIENT_STAY_DETAIL_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
