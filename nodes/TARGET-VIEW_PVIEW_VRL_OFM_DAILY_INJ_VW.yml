fileVersion: 1
id: 3492430f-59a0-4e11-8896-d90752ff1917
name: VIEW_PVIEW_VRL_OFM_DAILY_INJ_VW
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be5c245a-c75a-4cc9-840d-71c50f2f8fb2
          stepCounter: 3492430f-59a0-4e11-8896-d90752ff1917
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 295d169a-8764-40e9-9347-7e6746bb1d69
                stepCounter: 81e6b0b1-1728-45bf-932d-6356544cf13a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b63b821-7b3e-41a9-872f-22398f86fc92
          stepCounter: 3492430f-59a0-4e11-8896-d90752ff1917
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: WELL_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8b96ba6-fa62-4c0f-b013-fdbeffce9ce2
                stepCounter: 81e6b0b1-1728-45bf-932d-6356544cf13a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 665e5525-55b8-4a43-8095-99e882be2e6e
          stepCounter: 3492430f-59a0-4e11-8896-d90752ff1917
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: PERIOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e23862e-5f1c-4ceb-9ed3-26e0c07e30fc
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0643f3d-5944-433e-8665-3b3db572c349
          stepCounter: 3492430f-59a0-4e11-8896-d90752ff1917
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: HOURS_DOWN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 849b0441-aadd-4df8-aa0c-bef157b937d0
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e2c1be5-5bdb-4d9e-b087-0cc2bdf21b2f
          stepCounter: 3492430f-59a0-4e11-8896-d90752ff1917
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: HOURS_ON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 81e344fc-8e1c-48b6-b2a3-4528e7962c25
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7ed3c23-9b12-4a8a-94c5-aa8e5347ca3d
          stepCounter: 3492430f-59a0-4e11-8896-d90752ff1917
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: INJ_OIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a023fa13-1817-4634-af61-6d98694392fd
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e354a2ef-9691-46ce-9842-6c2057ca6111
          stepCounter: 3492430f-59a0-4e11-8896-d90752ff1917
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: INJ_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bdb6415a-5401-4be1-a750-7dc668fa02b5
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b9a0df58-0d5f-417f-b1b5-432841115e3b
          stepCounter: 3492430f-59a0-4e11-8896-d90752ff1917
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: INJ_WATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7984656-93a2-45f4-8fc0-3e4f11df74e8
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 348650c8-1d9b-43f5-bcc8-1720ca70ca1b
          stepCounter: 3492430f-59a0-4e11-8896-d90752ff1917
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: BU_SF_ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2461b3f-8900-4460-9da7-dc1b4d0593bc
                stepCounter: a23239e4-617a-4ab9-a42c-1fd9220b7fb3
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_PVIEW_VRL_OFM_DAILY_INJ_VW: 3492430f-59a0-4e11-8896-d90752ff1917
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_PVIEW_VRL_OFM_DAILY_INJ_VW') }} AS SELECT c.wellidregulatory AS uwi,
                   c.completionname well_name,
                   i.dttm AS period,
                   i.durdown * 24 AS hours_down,
                   i.durop * 24 AS hours_on,
                   i.volinjecthcliq AS inj_oil,
                   i.volinjectgas AS inj_gas,
                   i.volinjectwater AS inj_water,
                   WS_EDW.PVIEW_SYSSECURITYTYP_VET_BU_ROLE(h.SYSSECURITYTYP) AS BU_SF_ROLE
              FROM DS_PRODVIEW.pvt_pvunitallocmonthday i
             INNER JOIN DS_PRODVIEW.pvt_pvunitcomp c
                ON i.idreccomp = c.idrec
             INNER JOIN DS_PRODVIEW.PVT_pvflownetheader h
                ON h.idflownet = i.idflownet
        dependencies:
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITCOMP
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITCOMP') }}
        name: VIEW_PVIEW_VRL_OFM_DAILY_INJ_VW
        noLinkRefs: []
  name: VIEW_PVIEW_VRL_OFM_DAILY_INJ_VW
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
