fileVersion: 1
id: 25d0136c-552a-456b-a9b6-5231d2e5144c
name: VIEW_PVIEW_VRL_OFM_DAILY_INJ_VW
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d044d43-adb3-42c4-bbc9-3108e5a3b31b
          stepCounter: 25d0136c-552a-456b-a9b6-5231d2e5144c
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7014a46b-a09f-4d32-ae9a-66b516c1d8d6
                stepCounter: b2609f15-a93c-4c5d-b86e-0898ad7558d0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f06b9a0a-c774-4ebb-bfab-fa6315092658
          stepCounter: 25d0136c-552a-456b-a9b6-5231d2e5144c
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: WELL_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47f8a18b-1555-41b2-9a09-2de136944f7f
                stepCounter: b2609f15-a93c-4c5d-b86e-0898ad7558d0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5d57d76-bd01-4a56-9255-144f70974ae4
          stepCounter: 25d0136c-552a-456b-a9b6-5231d2e5144c
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: PERIOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f12a712-52a9-49bc-b9b3-9f6c776cada1
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91da1a91-9e54-40cd-b1e7-e0aac3af13ea
          stepCounter: 25d0136c-552a-456b-a9b6-5231d2e5144c
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: HOURS_DOWN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b51b4b24-93e1-450a-abda-190776b9def9
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f9b69f4-b1d1-44fe-a745-905ab89c1187
          stepCounter: 25d0136c-552a-456b-a9b6-5231d2e5144c
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: HOURS_ON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 565c3190-bc88-4ecf-8f99-070028fb908c
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4105e250-c109-4a29-a5c3-bc3f980dc11d
          stepCounter: 25d0136c-552a-456b-a9b6-5231d2e5144c
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: INJ_OIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 34116b5d-1330-4ec3-b490-d09dd28cecb0
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8cc837b-1291-4556-a4db-f637bd835287
          stepCounter: 25d0136c-552a-456b-a9b6-5231d2e5144c
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: INJ_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90040229-c62c-42c9-bb07-2139dea4c0cc
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd28b394-28b0-4724-a137-46d59477aef9
          stepCounter: 25d0136c-552a-456b-a9b6-5231d2e5144c
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: INJ_WATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce8f6ae1-15cb-4bad-b309-5020a5336519
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41b938ce-e079-41a6-b5d3-95a3d5c00f96
          stepCounter: 25d0136c-552a-456b-a9b6-5231d2e5144c
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: BU_SF_ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 748cdf05-5750-44bd-bb7a-77b0769f897d
                stepCounter: bd388a52-3d72-4c70-833d-7de7c6a8abd1
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_PVIEW_VRL_OFM_DAILY_INJ_VW: 25d0136c-552a-456b-a9b6-5231d2e5144c
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_PVIEW_VRL_OFM_DAILY_INJ_VW') }} AS SELECT c.wellidregulatory AS uwi,
                   c.completionname well_name,
                   i.dttm AS period,
                   i.durdown * 24 AS hours_down,
                   i.durop * 24 AS hours_on,
                   i.volinjecthcliq AS inj_oil,
                   i.volinjectgas AS inj_gas,
                   i.volinjectwater AS inj_water,
                   WS_EDW.PVIEW_SYSSECURITYTYP_VET_BU_ROLE(h.SYSSECURITYTYP) AS BU_SF_ROLE
              FROM DS_PRODVIEW.pvt_pvunitallocmonthday i
             INNER JOIN DS_PRODVIEW.pvt_pvunitcomp c
                ON i.idreccomp = c.idrec
             INNER JOIN DS_PRODVIEW.PVT_pvflownetheader h
                ON h.idflownet = i.idflownet
        dependencies:
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITCOMP
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITCOMP') }}
        name: VIEW_PVIEW_VRL_OFM_DAILY_INJ_VW
        noLinkRefs: []
  name: VIEW_PVIEW_VRL_OFM_DAILY_INJ_VW
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
