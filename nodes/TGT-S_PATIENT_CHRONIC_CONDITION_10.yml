fileVersion: 1
id: 1afe5dcb-05e7-4a51-af84-1035f0d823a5
name: S_PATIENT_CHRONIC_CONDITION_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Find all the inpatient coding records relating to codes that are including in pathways flagged as chronic conditions."
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3528a07d-f663-4534-8dec-f79ec13caaf8
          stepCounter: 1afe5dcb-05e7-4a51-af84-1035f0d823a5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FACT_INPATIENT_CLINICAL_CODING_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b5b75e1-9ce6-4cf3-b6ab-1900fa236d03
                stepCounter: d65ecd15-3433-489d-a0c0-81d8d3ac4642
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a48c6db-5aa4-4b3b-8662-2d171d952c0d
          stepCounter: 1afe5dcb-05e7-4a51-af84-1035f0d823a5
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4124743-8c9d-458d-8552-8a787e337915
                stepCounter: d65ecd15-3433-489d-a0c0-81d8d3ac4642
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e61cfb8-e904-4117-91d9-c7b28041514e
          stepCounter: 1afe5dcb-05e7-4a51-af84-1035f0d823a5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_clinical_coding_20.patient_reference_no=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 44a088df-e0e2-46b7-8f97-22d840071fd1
                stepCounter: d65ecd15-3433-489d-a0c0-81d8d3ac4642
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 73570a15-17a5-411e-9f00-10a17471af47
          stepCounter: 1afe5dcb-05e7-4a51-af84-1035f0d823a5
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8a32f147-1736-478d-aa64-ddf2684f094e
                stepCounter: d65ecd15-3433-489d-a0c0-81d8d3ac4642
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab352db0-f203-4ede-a65e-196de4a5aa4b
          stepCounter: 1afe5dcb-05e7-4a51-af84-1035f0d823a5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_clinical_coding_20.diagnosis_procedure_code=dim_ICD_code.ICD_code
        name: DIM_ICD_CODE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 742afc4e-7cee-4e2d-8d86-e3bc88184d91
                stepCounter: d65ecd15-3433-489d-a0c0-81d8d3ac4642
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ddec4934-d81e-4a3c-a682-25b86582f4d7
          stepCounter: 1afe5dcb-05e7-4a51-af84-1035f0d823a5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMISSION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83e1f5b2-0706-44f2-988f-e4c4703c4b91
                stepCounter: d65ecd15-3433-489d-a0c0-81d8d3ac4642
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ebad9d02-0d59-4753-9b12-317812c2df62
          stepCounter: 1afe5dcb-05e7-4a51-af84-1035f0d823a5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_clinical_coding_20.CONVERT(date,admission_date)=dim_admission_date.admission_calendar_date
        name: DIM_ADMISSION_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 44ba6316-9717-4e95-b4dd-de5826eb4ec0
                stepCounter: d65ecd15-3433-489d-a0c0-81d8d3ac4642
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fafa20bf-038d-41d8-b159-67fc2cbe85b3
          stepCounter: 1afe5dcb-05e7-4a51-af84-1035f0d823a5
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: CHRONIC_CONDITION_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eeb7b32b-8f2a-437f-8a26-00aa90fc341e
                stepCounter: 298d8144-7a9f-4d48-a62f-419b6da64625
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f56a9dff-12fb-451d-91f1-4e4d98390630
          stepCounter: 1afe5dcb-05e7-4a51-af84-1035f0d823a5
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CHRONIC_CONDITION_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 822a56ac-8b7d-465d-a60d-afe98e705c59
                stepCounter: 298d8144-7a9f-4d48-a62f-419b6da64625
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7871201-0ed0-408f-9c92-e7dc2d0cdfe0
          stepCounter: 1afe5dcb-05e7-4a51-af84-1035f0d823a5
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Numbers rows for each NHI so that the earliest admission date for a pathway has row_num = 1.
        name: ROW_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4124743-8c9d-458d-8552-8a787e337915
                stepCounter: d65ecd15-3433-489d-a0c0-81d8d3ac4642
            transform: ROW_NUMBER() OVER(PARTITION BY patient_NHI, pathway_code ORDER BY admission_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 887f0628-db48-413b-81f3-bb62f192353f
          stepCounter: 1afe5dcb-05e7-4a51-af84-1035f0d823a5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          FACT_INPATIENT_CLINICAL_CODING: d65ecd15-3433-489d-a0c0-81d8d3ac4642
          S_PJ_PATHWAY_CODE_XREF: 298d8144-7a9f-4d48-a62f-419b6da64625
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: FACT_INPATIENT_CLINICAL_CODING
          - locationName: TGT
            nodeName: S_PJ_PATHWAY_CODE_XREF
        join:
          joinCondition: |-
            FROM {{ ref('TGT','FACT_INPATIENT_CLINICAL_CODING') }} fact_inpatient_clinical_coding
              JOIN {{ ref('TGT','S_PJ_PATHWAY_CODE_XREF') }} s_PJ_pathway_code_xref
                ON s_PJ_pathway_code_xref.ICD_Code = fact_inpatient_clinical_coding.diagnosis_procedure_code
               AND s_PJ_pathway_code_xref.chronic_condition = 1
        name: S_PATIENT_CHRONIC_CONDITION_10
        noLinkRefs: []
  name: S_PATIENT_CHRONIC_CONDITION_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
