fileVersion: 1
id: 6608a667-c773-417a-add1-6383009300a8
name: S_IN_PATIENT_EVENT_20
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e205a3b-7abd-4028-8b43-ee7c75788093
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMET_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9437b947-083f-4a8a-8ae3-57a302c17d39
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 631a72a5-f0da-428c-a031-2641dbcabffc
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: ADMISSION_METHOD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00df2ab2-272a-419c-b20f-ebb4bbd5039e
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ca1689f-5d13-4de8-824d-39f8c745817a
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: ADMISSION_METHOD_NZNHI_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9bbe98a6-18e1-4bf4-b0ef-6b88d3a01552
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2e426c1-ec3b-49a9-955f-b740e0796c3a
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADCAT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6cf27f55-7d8f-4314-b12e-a2eeec361628
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a4cf2cc0-7649-4845-adc5-19443ec99587
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: ADCAT_PURCHASER_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cddd67b4-99e5-48d5-8fce-2177d4cead9f
                stepCounter: 74f3aa94-9c0a-45fa-82b0-85d01b14d1ec
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: efcb39e5-b2f9-4f0a-9e2a-a0dc81437743
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACAST_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8bfe8bd5-32f3-4e3a-8317-2dbb37c30830
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae5ceaf9-c2ec-4b9f-870b-0415dac1da9d
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMISSION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3cc03a5a-0fc7-48d7-bb66-ed5a45f3508e
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 560c578f-c3de-48f5-9a9b-46bca52516e4
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: string of wards that patient stayed-in during the encounter
        name: EVENT_STAYS_SPECIALTY_PATH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c8880c3-eae0-4c00-aa0c-4ff19441a0ee
                stepCounter: 367f4e98-fdec-49c2-b686-18e94768a072
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5351abed-388f-419e-ac2a-3ea5841ffb58
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ACC_EXPIRY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7e94618-3be4-4955-b0fa-012712934b20
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef796997-c2d4-4073-a269-48316a45ab45
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CONTACT_HEALTHCARE_PROFESSIONAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 041d803a-d267-4a13-84c1-428a9fcee1f6
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2fb68133-9731-4dae-92bc-ffc8def7a24a
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: CURRENT_EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ed89bd9-1050-44fc-8d3c-fbecfa56af3d
                stepCounter: 005d10cc-09f1-4b9f-b118-9f278d6a3f7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2718118d-5311-42f6-a57b-ba3bd7280844
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_CODE_01
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4033b119-b79b-4913-acd4-023b1630de67
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_CODE_03
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b224bc33-5313-41f2-849d-9f9bf1cf62ae
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_CODE_02
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bdc27dde-41a2-4d2a-bdd2-c4b1ffef04e3
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_CODE_04
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c7feca5a-4586-4a40-955a-eb11df10136a
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_CODE_05
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ebbfcb4-4a7d-4591-b3e3-27d7102afe85
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(MAX)
        defaultValue: ""
        description: A concatenation of all ICD diagnosis code pipe delimited with asterisck denoting the first and last codes
        name: DIAGNOSIS_CODE_ALL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: replace(replace('|^' + CASE WHEN s_in_patient_clinical_coding_summary_d.[diagnosis_procedure_code_01] IS NULL THEN ''ELSE s_in_patient_clinical_coding_summary_d.[diagnosis_procedure_code_01] + ' | ' END + CASE WHEN s_in_patient_clinical_coding_summary_d.[diagnosis_procedure_code_02] IS NULL THEN ''ELSE s_in_patient_clinical_coding_summary_d.[diagnosis_procedure_code_02] + ' | ' END + CASE WHEN s_in_patient_clinical_coding_summary_d.[diagnosis_procedure_code_03] IS NULL THEN ''ELSE s_in_patient_clinical_coding_summary_d.[diagnosis_procedure_code_03] + ' | ' END + CASE WHEN s_in_patient_clinical_coding_summary_d.[diagnosis_procedure_code_04] IS NULL THEN ''ELSE s_in_patient_clinical_coding_summary_d.[diagnosis_procedure_code_04] + ' | ' END + CASE WHEN s_in_patient_clinical_coding_summary_d.[diagnosis_procedure_code_05] IS NULL THEN ''ELSE s_in_patient_clinical_coding_summary_d.[diagnosis_procedure_code_05] + ' | ' END + CASE WHEN s_in_patient_clinical_coding_summary_d.[diagnosis_procedure_code_06] IS NULL THEN ''ELSE s_in_patient_clinical_coding_summary_d.[diagnosis_procedure_code_06] + ' | ' END + CASE WHEN s_in_patient_clinical_coding_summary_d.[diagnosis_procedure_code_07] IS NULL THEN ''ELSE s_in_patient_clinical_coding_summary_d.[diagnosis_procedure_code_07] + ' | ' END + CASE WHEN s_in_patient_clinical_coding_summary_d.[diagnosis_procedure_code_08] IS NULL THEN ''ELSE s_in_patient_clinical_coding_summary_d.[diagnosis_procedure_code_08] + ' | ' END + CASE WHEN s_in_patient_clinical_coding_summary_d.[diagnosis_procedure_code_09] IS NULL THEN ''ELSE s_in_patient_clinical_coding_summary_d.[diagnosis_procedure_code_09] + ' | ' END + CASE WHEN s_in_patient_clinical_coding_summary_d.[diagnosis_procedure_code_10] IS NULL THEN ''ELSE s_in_patient_clinical_coding_summary_d.[diagnosis_procedure_code_10] + ' | ' END + CASE WHEN s_in_patient_clinical_coding_summary_d.[diagnosis_procedure_code_11] IS NULL THEN ''ELSE s_in_patient_clinical_coding_summary_d.[diagnosis_procedure_code_11] + ' | ' END + CASE WHEN s_in_patient_clinical_coding_summary_d.[diagnosis_procedure_code_12] IS NULL THEN ''ELSE s_in_patient_clinical_coding_summary_d.[diagnosis_procedure_code_12] + ' | ' END + CASE WHEN s_in_patient_clinical_coding_summary_d.[diagnosis_procedure_code_13] IS NULL THEN ''ELSE s_in_patient_clinical_coding_summary_d.[diagnosis_procedure_code_13] + ' | ' END + CASE WHEN s_in_patient_clinical_coding_summary_d.[diagnosis_procedure_code_14] IS NULL THEN ''ELSE s_in_patient_clinical_coding_summary_d.[diagnosis_procedure_code_14] + ' | ' END + CASE WHEN s_in_patient_clinical_coding_summary_d.[diagnosis_procedure_code_15] IS NULL THEN ''ELSE s_in_patient_clinical_coding_summary_d.[diagnosis_procedure_code_15] + ' | ' END + CASE WHEN s_in_patient_clinical_coding_summary_d.[diagnosis_procedure_code_16] IS NULL THEN ''ELSE s_in_patient_clinical_coding_summary_d.[diagnosis_procedure_code_16] + ' | ' END + CASE WHEN s_in_patient_clinical_coding_summary_d.[diagnosis_procedure_code_17] IS NULL THEN ''ELSE s_in_patient_clinical_coding_summary_d.[diagnosis_procedure_code_17] + ' | ' END + CASE WHEN s_in_patient_clinical_coding_summary_d.[diagnosis_procedure_code_18] IS NULL THEN ''ELSE s_in_patient_clinical_coding_summary_d.[diagnosis_procedure_code_18] + ' | ' END + CASE WHEN s_in_patient_clinical_coding_summary_d.[diagnosis_procedure_code_19] IS NULL THEN ''ELSE s_in_patient_clinical_coding_summary_d.[diagnosis_procedure_code_19] END + '^|',' | ^|','^|') ,'|^^|','')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c35b6168-30f1-4fd6-922f-b82f113e0d3e
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_event_10.dismt_refno=dim_discharge_method.discharge_method_reference_no
        name: DIM_DISCHARGE_METHOD_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cc86e373-13b5-4ff8-99a5-ee6fd4e41304
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac468aa4-e852-4790-980d-d2bedfb8ba9f
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 223a335a-f5cc-4fc7-9f25-7e8fc9803980
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c31caaa1-b87e-4e22-ba82-16fade1a99d6
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: DISCHARGE_METHOD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c2253459-f0c6-4838-8d1c-2de66d9ff53a
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ae84e89-d293-4dca-a958-94185d5aa3e5
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DISDE_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 25bb084e-5087-4487-a5cb-a54a40aa63aa
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e9f52e5-a560-4500-9541-6c5922b66f68
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DISMT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2952ab3f-3060-46ee-b8f8-b8c6384ba496
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c9e892e-b84a-4de1-97d3-8f6461b7b9de
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PROF_CARER_EPISODE_OUTCOME_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9fc6e4eb-3c46-429d-aabf-7fcc7d51e1d9
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d45ae76-45f1-47a6-8d93-a6893e71735a
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: NVARCHAR(30)
        defaultValue: ""
        description: ""
        name: DOMICILE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c07d8de-483b-446b-a36c-c34f42dcffa7
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6aab23b3-9435-4f05-bc7b-2df1327cf924
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: DRG_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d93b2937-11d9-4c62-830e-93d1bd615268
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb0f37c4-0c9d-4afb-8ca6-0bd8fa236980
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: CODED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d93b2937-11d9-4c62-830e-93d1bd615268
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: |-
              CASE WHEN s_in_patient_event_10.DRG_code IS NULL THEN 'N'
                          ELSE 'Y'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d187042e-b061-48d2-9cc0-8a39a29e70aa
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CODEDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 30df8e89-da37-4186-b8b2-135210fdc882
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 106388aa-f929-41a3-93b6-a1ead51c585d
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f461eae-fb4c-4efc-87f9-8db35785d92d
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a4a9f16-13bd-48e1-86fd-0b162c15c8b0
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DSINF_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52a89df9-703f-4162-9116-370761847c8f
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d687f2ac-eaaf-447b-b09d-2649d52460fb
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ED_ADMISSION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e513d868-ff48-42f9-96c1-7476cab15a09
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1dcff920-7866-4419-ae42-95b70a04c9e1
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ED_ATTENDANCE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 57e5270d-240c-4885-a53b-7f3b3cc4acde
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2881274-9522-4d03-8ed3-e3e8ffda19e3
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ED_DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d54e3b82-b480-4864-b087-999153073f8e
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a23da2de-aefb-46c7-b595-7f061608ad3d
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ED_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bd0950f2-999b-483e-a928-ad51430e4ff0
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4cc321c8-f429-4ee7-9760-370644fd7e9a
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ED_FIRST_STAY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 97dd07fb-88fd-40df-9532-b221c9d1b9ac
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee01c182-1319-4db0-b562-a1868f7ca5d8
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ED_MEDICAL_DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f49d4e6a-9579-4c84-b025-fe6c38cb5ca9
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: abada4e0-bfcb-4409-9a53-4ef3a8a8c54b
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ED_PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea8ed4d5-b8d6-454f-8fb8-fc564798b41c
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 498da220-0991-4f4f-af09-ed2addc314dc
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bfdff60a-94eb-48ee-a17e-17a5d29b33e6
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07a1e033-9d59-4f18-b428-35316d9fb6b4
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 61fcaf1e-5758-41ab-8a69-803d32d7a5e0
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79b9c8b7-452e-484d-a66c-db39b8215209
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_TYPE_CODE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 099445b6-89ce-45e8-a2f6-d67791230080
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5593a8d0-5ece-4115-99b1-e2475246bdc7
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47d9a746-30c8-41f8-af7d-7ccfec8f3536
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d7cfcf2-2be7-4fe9-a949-f305088f45da
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d270edf8-50ad-41d8-a51b-d674079f00de
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5542c4ed-5744-4530-b8ce-3d0efc958831
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EVENT_END_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 692dc925-9dce-47ef-918b-4d443b029c59
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b65158c-3c05-4ab0-8850-104bedfe681a
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_LEAVE_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1fa0b6f4-7aac-4da4-aa7d-9ed3b5adb12e
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 51ea0010-1bae-4f00-b037-55b1e81c37b8
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_LEAVE_TOTAL_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a302556-c72a-4718-b06a-001d7196a0af
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 679cb2a8-adae-48fd-a611-40b202a1f3f7
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: event_length_of_stay
        name: EVENT_LENGTH_OF_STAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 223a335a-f5cc-4fc7-9f25-7e8fc9803980
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: DATEDIFF(dd,s_in_patient_event_10.admit_date,s_in_patient_event_10.disch_date) - IFNULL(s_in_patient_event_10.event_leave_total_duration,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 61584803-cb75-4b55-9ec4-0d0b858e6f8c
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EVENT_LENGTH_OF_STAY_DDHHMM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 223a335a-f5cc-4fc7-9f25-7e8fc9803980
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: CONVERT(varchar, (DATEDIFF(mi,s_in_patient_event_10.admit_date,s_in_patient_event_10.disch_date) - IFNULL(s_in_patient_event_10.event_leave_total_duration_minutes,0)) / 1440) + ':' + REPLICATE('0', 2 - DATALENGTH(CONVERT(varchar(2), ((DATEDIFF(mi,s_in_patient_event_10.admit_date,s_in_patient_event_10.disch_date) - IFNULL(s_in_patient_event_10.event_leave_total_duration_minutes,0)) % 1440) / 60))) + CONVERT(varchar(2), ((DATEDIFF(mi,s_in_patient_event_10.admit_date,s_in_patient_event_10.disch_date) - IFNULL(s_in_patient_event_10.event_leave_total_duration_minutes,0)) % 1440) / 60) + ':' + REPLICATE('0', 2 - DATALENGTH(CONVERT(varchar(2), ((DATEDIFF(mi,s_in_patient_event_10.admit_date,s_in_patient_event_10.disch_date) - IFNULL(s_in_patient_event_10.event_leave_total_duration_minutes,0)) % 60)))) + CONVERT(varchar(2), ((DATEDIFF(mi,s_in_patient_event_10.admit_date,s_in_patient_event_10.disch_date) - IFNULL(s_in_patient_event_10.event_leave_total_duration_minutes,0)) % 60))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5dfa4102-421b-4829-b282-ec46e6666552
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: event_length_of_stay_minutes
        name: EVENT_LENGTH_OF_STAY_MINUTES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 223a335a-f5cc-4fc7-9f25-7e8fc9803980
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: DATEDIFF(mi,s_in_patient_event_10.admit_date,s_in_patient_event_10.disch_date) - IFNULL(s_in_patient_event_10.event_leave_total_duration_minutes,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27f0f80e-1c1f-4f85-b287-933af381e6be
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9936460e-5402-4227-b126-c13a0fc4a57b
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7546e35b-c798-4001-a601-c2ca5a8d8a99
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_STAYS_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1038d837-54ef-4fbb-95f2-b969113efd2c
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 213ff1ac-1467-43e0-b556-ec574ef14b0b
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_STAYS_TOTAL_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f6815dd9-cc2f-43dd-8c42-1c016fff88b2
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b23eccd5-22bb-4544-a25e-35764e898b60
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(2000)
        defaultValue: ""
        description: ""
        name: EVENT_STAYS_WARD_PATH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c1297ad4-ffa7-419c-a884-4e1fd70f5ed5
                stepCounter: deb38ad0-9bce-46f0-99ca-6f1799390b82
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c89d5a16-7c97-4655-b52a-c0ac808a810a
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: event_total_duration
        name: EVENT_TOTAL_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 223a335a-f5cc-4fc7-9f25-7e8fc9803980
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: DATEDIFF(dd,s_in_patient_event_10.admit_date,s_in_patient_event_10.disch_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab5c72a4-49b4-46ff-8504-ec6c0484f358
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EVENT_TOTAL_DURATION_DDHHMM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 223a335a-f5cc-4fc7-9f25-7e8fc9803980
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: CONVERT(varchar, DATEDIFF(mi,s_in_patient_event_10.admit_date,s_in_patient_event_10.disch_date) / 1440) + ':' + REPLICATE('0', 2 - DATALENGTH(CONVERT(varchar(2), (DATEDIFF(mi,s_in_patient_event_10.admit_date,s_in_patient_event_10.disch_date) % 1440) / 60))) + CONVERT(varchar(2), (DATEDIFF(mi,s_in_patient_event_10.admit_date,s_in_patient_event_10.disch_date) % 1440) / 60) + ':' + REPLICATE('0', 2 - DATALENGTH(CONVERT(varchar(2), (DATEDIFF(mi,s_in_patient_event_10.admit_date,s_in_patient_event_10.disch_date) % 60)))) + CONVERT(varchar(2), (DATEDIFF(mi,s_in_patient_event_10.admit_date,s_in_patient_event_10.disch_date)% 60))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 28c9be2c-57d4-4ae7-a823-3e5c97e0c0dc
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: EXPDS_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2dc4499-9f03-4e46-b53f-3a5f136c2620
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d03b67f-7a08-4ede-86e7-4bb0f86d9add
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_LEAVE_TOTAL_DURATION_MINUTES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 280f8782-a481-4aa2-80f0-1999e1c94fe9
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e720c938-9951-4b45-9441-f5df31d0d5d8
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: first_actual_theatre_date
        name: FIRST_ACTUAL_THEATRE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e0a2a4c9-ef87-4310-9e4c-97a82a988f1d
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a6bc33b-4faf-4747-9def-1f1deabc827e
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FIRST_HEALTHCARE_PROFESSIONAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee015be3-7fc3-4fd6-932a-4265ddf6a21e
                stepCounter: 45d0351a-9eda-469c-8f1f-3acb0ce438c7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e5ae9fb-b1fa-4782-b2a0-ce70ac07d0a5
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FIRST_SERVICE_POINT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ef3405a-da46-4461-a082-00acf9549158
                stepCounter: 45d0351a-9eda-469c-8f1f-3acb0ce438c7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04b901f9-66b7-4928-8230-b5f226dc10b3
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FIRST_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1fceef05-d5a3-414b-ace5-d939e5b010e8
                stepCounter: 45d0351a-9eda-469c-8f1f-3acb0ce438c7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fafe30f0-db9c-40ba-9560-a95ec6df1031
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_STAY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0e473eae-1c66-4f4c-b4e7-e05a09225276
                stepCounter: 45d0351a-9eda-469c-8f1f-3acb0ce438c7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d792453-e245-4cf6-b5bf-9a8fd9fb599f
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FIRST_STAY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed9d71a0-bda5-4a4b-95aa-07825f83ac67
                stepCounter: 45d0351a-9eda-469c-8f1f-3acb0ce438c7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ee16e59-32a0-44a6-a5c5-08d0c2b3a4d6
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_STAY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cdcd4a59-d8ff-4c81-bc0d-a0519d98cc54
                stepCounter: 45d0351a-9eda-469c-8f1f-3acb0ce438c7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9f978d0-d90b-4231-bc59-ba43da1cc5e8
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b8e06324-f9df-4568-8432-51db24b9ddf1
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 73bfb61b-cc9b-4f34-ba0f-a65bd1e13652
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: HEALTHCARE_PROFESSIONAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cf1991b0-3487-42a1-beb5-5ecc4b5d7114
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2369f3a3-f341-4941-ae66-1aeb10e48ae6
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: HEALTHCARE_PROFESSIONAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e8e599f4-8309-4d1b-b4d0-1ed0bb6904e1
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 442590b7-2435-48e2-a73b-051486fd2940
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: HOSPITAL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b1db80c-6611-4f5b-bbef-0cd334ed414a
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aaa883bb-b128-4d3f-83ca-79b40e52d39f
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: IDPAP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b34bf60e-043e-4948-8228-29671d5ea15b
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 116e99d4-ddd2-4588-9fd5-e5e31f3fa98e
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: INMGT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6cbefc88-ce92-4128-aec6-c2f68addf57f
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c209d53-c32e-4991-84aa-dcee626f6b1d
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR (1)
        defaultValue: ""
        description: into_theatre_flag
        name: INTO_THEATRE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2be9d50f-e87c-42f5-9e1f-a24fe2b5b85a
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7b9166e-a153-41d0-a185-3c62d60ee364
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LAST_HEALTHCARE_PROFESSIONAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d5a9f85-f0ae-4e1b-b769-3606774166da
                stepCounter: 45d0351a-9eda-469c-8f1f-3acb0ce438c7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4cf7d7d4-409e-4e78-91a0-b9b88da4aab4
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LAST_SERVICE_POINT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90e45c8b-f524-4c98-bacd-473050199311
                stepCounter: 45d0351a-9eda-469c-8f1f-3acb0ce438c7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c9fe145-eda2-49fa-8bd4-67c39b3b26f1
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LAST_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c645d150-81b6-4c15-bc64-b9c28029e329
                stepCounter: 45d0351a-9eda-469c-8f1f-3acb0ce438c7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 841434fc-443c-4512-a621-a5570efb951f
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_STAY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 81e514de-2591-47ae-8ac4-a852d89d056c
                stepCounter: 45d0351a-9eda-469c-8f1f-3acb0ce438c7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2e3c746-df98-4705-b88e-92dd7b4edbb4
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LAST_STAY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 32dc6c89-821b-4f8f-ad2e-5e8434e8b6d8
                stepCounter: 45d0351a-9eda-469c-8f1f-3acb0ce438c7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a146b09-6dcb-4d1b-be42-08b72b4b9341
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_STAY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91ddf566-21f5-4c67-a2df-06c352efb772
                stepCounter: 45d0351a-9eda-469c-8f1f-3acb0ce438c7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 661f2c89-32de-4bdb-8925-3479bce540f1
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: LOS_category_no
        name: LOS_CATEGORY_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 223a335a-f5cc-4fc7-9f25-7e8fc9803980
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: |-
              CASE IFNULL(DATEDIFF(dd,s_in_patient_event_10.admit_date,s_in_patient_event_10.disch_date) - IFNULL(s_in_patient_event_10.event_leave_total_duration,0),0)
                          WHEN 0                                                                                                                                                THEN 0
                          WHEN 1                                                                                                                                                THEN 1
                          ELSE 2
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be85d258-062c-4abc-b1fd-b698db736b2c
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: MDC_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 932359c7-5f56-487c-b0c4-d9a490011eac
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb12c2ca-91a1-4877-93e8-637b94682806
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MEDICAL_DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b7af34b7-c83a-4e87-8944-073f7db2aa5e
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2c25c9d-1979-4097-b540-16f2db93b88e
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIFY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c1b024af-bf82-4ca1-b120-7c2776119aca
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69f46cd6-e19a-42e5-abcc-6b719bffd847
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MODIFY_USER_LOGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e524c59d-aac6-463e-9765-085b9e9c19cf
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8657f44c-009f-44e0-b564-388a27da137c
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: ""
        name: NPF_ATTENDANCE_OUTCOME_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7c8ed43-6c6f-406b-9454-b7e9fe44a83c
                stepCounter: 76e0efa7-bc1c-430c-9d7b-406e7ddca7de
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ebb04604-adfd-4e92-95d8-2394a07511fe
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: NPF_DESTINATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 200b4f3a-5b3a-427d-b654-ea2076438b8c
                stepCounter: 76e0efa7-bc1c-430c-9d7b-406e7ddca7de
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21025256-b73c-4d7c-8115-fca308180d4d
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: NPF_ENCOUNTER_OUTCOME_DECISION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ef9dbb8-b862-4675-873a-c09554dd63ea
                stepCounter: 76e0efa7-bc1c-430c-9d7b-406e7ddca7de
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c36aeef-81ba-498f-be49-86d14d588d2f
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: NPF_ENCOUNTER_OUTCOME_REASON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aff4cb81-7e45-499d-b7d4-25da67b2a980
                stepCounter: 76e0efa7-bc1c-430c-9d7b-406e7ddca7de
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 023c2c06-dbb7-4679-9bb8-e0b56968d153
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Is this record sent to NPF as an exception
        name: NPF_EXCEPTION_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN exception_outcome_reason IS NOT NULL THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 597db3b8-811f-4e84-9d55-06c5541c9cdd
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: NPF_EXCEPTION_OUTCOME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 31a5d044-7a82-4616-b44b-8adeb702b8fa
                stepCounter: 76e0efa7-bc1c-430c-9d7b-406e7ddca7de
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a43f443d-2dcf-4fec-82e4-cfee732c0530
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: NUMERIC(38,4)
        defaultValue: ""
        description: ""
        name: ACTUAL_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a50663a-df1e-4a1a-96a3-42f2a1b6c8ee
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: ""
        name: BUDGET_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d8d93be-aaf8-454c-ba53-138906f3a76e
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: NPF_EXCEPTION_OUTCOME_REASON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7056581a-45a9-4ddb-9723-bfd642cbbb7a
                stepCounter: 76e0efa7-bc1c-430c-9d7b-406e7ddca7de
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a45ef3c6-f9f2-495c-bb3e-e748a44a5849
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: NPF_REFERRED_TO_ORGANISATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 247b993e-983d-4305-bc66-641da7f1d332
                stepCounter: 76e0efa7-bc1c-430c-9d7b-406e7ddca7de
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e41046dd-d3b0-4ba1-a25b-7e3f8ac81765
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NXT_EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d19299f-efc2-4364-b418-356fa3712486
                stepCounter: 005d10cc-09f1-4b9f-b118-9f278d6a3f7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f40dafc5-5b56-4c9d-828b-7cfee946fbba
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: NXT_ADMISSION_METHOD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ae8dabc4-6466-4167-b241-8633a571b591
                stepCounter: 005d10cc-09f1-4b9f-b118-9f278d6a3f7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 218df89f-9b11-4069-9758-2987d7235b44
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: 'Event LOS in 30 minute units for the MoH OS3 ALOS measure that connects across events.  '
        name: OS3_LENGTH_OF_STAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 65dcb38f-043b-4130-a627-60daa497782f
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d201460b-0253-4efe-9673-f764faa9636c
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Event identifier for the MoH OS3 ALOS measure that connects across events.  The event use is the last event in the sequence.
        name: OS3_MASTER_ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 344c94fe-2fde-4e46-ba61-1e2ab92275b0
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b09aa6a9-706c-47a9-a20e-f56f74292b57
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INT
        defaultValue: ""
        description: Sequence of the OS3 events
        name: OS3_SEQUENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a5a2005e-f2de-4275-a54c-f659cb5ec8f3
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: def4a2e1-9399-49c5-af7a-4e9b5ab1701d
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: package_of_care_flag
        name: PACKAGE_OF_CARE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e853462-9cfc-461a-81d1-9fe211fee293
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 60336580-3224-44c2-9135-0d36457cd014
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_AGE_ON_ARRIVAL_MONTHS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a7531fc0-ed03-4b72-8581-b910afb1e7be
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 73609387-383d-43ba-aa84-c1f991c57934
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_AGE_ON_ARRIVAL_YEARS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 310b4518-459e-4054-b765-ae1916cf5e8f
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3381f37e-bb1d-4626-a1db-ada63c200d7d
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PATIENT_DATE_OF_BIRTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e09b7878-ecb8-481f-8356-90d6270fc289
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 37580a07-e17e-43f0-8517-e163812a7e1d
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21abc728-6580-4219-828e-4a03174e69d1
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 642a4760-bec4-478f-9a23-8f19e8b8f7d3
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c81ac44-945a-47a3-ac6d-09fb55092df1
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e27c45bd-c8ed-4474-a218-97391eb59823
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_VISIT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 432a737d-bf28-4c90-83ca-ac9fc07ee482
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 335b7be7-a1ed-485e-93d6-a82980b9f728
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_VISIT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c1518fe-067d-4dc1-84d2-0e834d5ff53a
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b2a4e40-4542-418e-9f58-8f939bbd1557
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PMETD_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cbd31b40-cdfb-4c9a-8157-92df073839a8
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b61de2f6-5515-4ccc-ad6d-47dce49c5a46
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PRE_ADMIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5582895-debb-4752-b9d7-fb6ff2350792
                stepCounter: 272e0314-c604-41ca-a707-8dd7461e69ea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd3c7458-6404-4a78-a384-eff12449f466
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRESENT_TO_NEXT_EVENT_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 223a335a-f5cc-4fc7-9f25-7e8fc9803980
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: DATEDIFF(mi,s_in_patient_event_10.disch_date,s_in_patient_event_prev_next.nxt_event_admission_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5567aca7-6fcc-4c5c-ad7b-a954f222518f
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREVIOUS_TO_CURRENT_EVENT_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3cc03a5a-0fc7-48d7-bb66-ed5a45f3508e
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: DATEDIFF(mi,s_in_patient_event_prev_next.prv_event_discharge_date,s_in_patient_event_10.admit_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02f9fb25-9d39-49e6-9a35-6ca61581aae2
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PROCEDURE_CODE_01
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb468662-eab5-400f-a928-8a1e5147af53
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PROCEDURE_CODE_02
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64c05a48-6da5-446f-80a0-75085c1b1cfc
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PROCEDURE_CODE_03
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b7127db-a014-488d-99f0-f5c00c8f9dc5
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PROCEDURE_CODE_04
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1ae4268-68fa-449f-99a2-0f8f1004f4b0
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PROCEDURE_CODE_05
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ae8799e-eeaa-4707-8060-81108d3d21d8
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(MAX)
        defaultValue: ""
        description: A concatenation of all ICD procedure code pipe delimited with asterisck denoting the first and last codes
        name: PROCEDURE_CODE_ALL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: replace(replace('|^' + CASE WHEN s_in_patient_clinical_coding_summary_p.[diagnosis_procedure_code_01] IS NULL THEN ''ELSE s_in_patient_clinical_coding_summary_p.[diagnosis_procedure_code_01] + ' | ' END + CASE WHEN s_in_patient_clinical_coding_summary_p.[diagnosis_procedure_code_02] IS NULL THEN ''ELSE s_in_patient_clinical_coding_summary_p.[diagnosis_procedure_code_02] + ' | ' END + CASE WHEN s_in_patient_clinical_coding_summary_p.[diagnosis_procedure_code_03] IS NULL THEN ''ELSE s_in_patient_clinical_coding_summary_p.[diagnosis_procedure_code_03] + ' | ' END + CASE WHEN s_in_patient_clinical_coding_summary_p.[diagnosis_procedure_code_04] IS NULL THEN ''ELSE s_in_patient_clinical_coding_summary_p.[diagnosis_procedure_code_04] + ' | ' END + CASE WHEN s_in_patient_clinical_coding_summary_p.[diagnosis_procedure_code_05] IS NULL THEN ''ELSE s_in_patient_clinical_coding_summary_p.[diagnosis_procedure_code_05] + ' | ' END + CASE WHEN s_in_patient_clinical_coding_summary_p.[diagnosis_procedure_code_06] IS NULL THEN ''ELSE s_in_patient_clinical_coding_summary_p.[diagnosis_procedure_code_06] + ' | ' END + CASE WHEN s_in_patient_clinical_coding_summary_p.[diagnosis_procedure_code_07] IS NULL THEN ''ELSE s_in_patient_clinical_coding_summary_p.[diagnosis_procedure_code_07] + ' | ' END + CASE WHEN s_in_patient_clinical_coding_summary_p.[diagnosis_procedure_code_08] IS NULL THEN ''ELSE s_in_patient_clinical_coding_summary_p.[diagnosis_procedure_code_08] + ' | ' END + CASE WHEN s_in_patient_clinical_coding_summary_p.[diagnosis_procedure_code_09] IS NULL THEN ''ELSE s_in_patient_clinical_coding_summary_p.[diagnosis_procedure_code_09] + ' | ' END + CASE WHEN s_in_patient_clinical_coding_summary_p.[diagnosis_procedure_code_10] IS NULL THEN ''ELSE s_in_patient_clinical_coding_summary_p.[diagnosis_procedure_code_10] + ' | ' END + CASE WHEN s_in_patient_clinical_coding_summary_p.[diagnosis_procedure_code_11] IS NULL THEN ''ELSE s_in_patient_clinical_coding_summary_p.[diagnosis_procedure_code_11] + ' | ' END + CASE WHEN s_in_patient_clinical_coding_summary_p.[diagnosis_procedure_code_12] IS NULL THEN ''ELSE s_in_patient_clinical_coding_summary_p.[diagnosis_procedure_code_12] + ' | ' END + CASE WHEN s_in_patient_clinical_coding_summary_p.[diagnosis_procedure_code_13] IS NULL THEN ''ELSE s_in_patient_clinical_coding_summary_p.[diagnosis_procedure_code_13] + ' | ' END + CASE WHEN s_in_patient_clinical_coding_summary_p.[diagnosis_procedure_code_14] IS NULL THEN ''ELSE s_in_patient_clinical_coding_summary_p.[diagnosis_procedure_code_14] + ' | ' END + CASE WHEN s_in_patient_clinical_coding_summary_p.[diagnosis_procedure_code_15] IS NULL THEN ''ELSE s_in_patient_clinical_coding_summary_p.[diagnosis_procedure_code_15] + ' | ' END + CASE WHEN s_in_patient_clinical_coding_summary_p.[diagnosis_procedure_code_16] IS NULL THEN ''ELSE s_in_patient_clinical_coding_summary_p.[diagnosis_procedure_code_16] + ' | ' END + CASE WHEN s_in_patient_clinical_coding_summary_p.[diagnosis_procedure_code_17] IS NULL THEN ''ELSE s_in_patient_clinical_coding_summary_p.[diagnosis_procedure_code_17] + ' | ' END + CASE WHEN s_in_patient_clinical_coding_summary_p.[diagnosis_procedure_code_18] IS NULL THEN ''ELSE s_in_patient_clinical_coding_summary_p.[diagnosis_procedure_code_18] + ' | ' END + CASE WHEN s_in_patient_clinical_coding_summary_p.[diagnosis_procedure_code_19] IS NULL THEN ''ELSE s_in_patient_clinical_coding_summary_p.[diagnosis_procedure_code_19] + ' | ' END + CASE WHEN s_in_patient_clinical_coding_summary_p.[diagnosis_procedure_code_20] IS NULL THEN ''ELSE s_in_patient_clinical_coding_summary_p.[diagnosis_procedure_code_20] END + '^|',' | ^|','^|') ,'|^^|','')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c40fcf5-0971-4263-9d8e-85f43b02f2be
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PRV_EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4a6382f-21bf-437e-970d-770727683fa0
                stepCounter: 005d10cc-09f1-4b9f-b118-9f278d6a3f7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: baa0ff4d-d739-4c28-a439-40629da6e9b4
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Uncoded and coded versions of the purchase unit code are merged at this step
        name: PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79b60fee-3208-4e0e-821a-595c5aa7af77
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: IFNULL(s_in_patient_event_10.purchase_unit_code, s_in_patient_event_10.default_purchase_unit)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4485ce0e-3c13-47ba-a086-27ecc18ce122
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: READMISSION_INSTRUCTION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f3bb1f13-021d-4e0d-90a5-5ba1740b3440
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ffdcef1b-92da-422f-b48d-0517cf81e1d9
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: READMISSION_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91f6381a-f792-4478-8004-dab41231e6ca
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf1c6d78-cbd5-46cb-a95e-215a73efc675
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: READMISSION_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 138fbc99-5677-4afd-99d1-c80c82ba942a
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3fb3cf2-14c4-4336-8360-ea92d3d56e70
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: READMITTED_28_DAYS_ADMISSION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab221117-c904-4f9d-8c76-979cd6894aa3
                stepCounter: 005d10cc-09f1-4b9f-b118-9f278d6a3f7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d307d598-b6cd-487d-b25a-f7c9de4f8648
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: READMITTED_28_DAYS_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a01b3a19-724a-4466-a459-8c4c638a77f9
                stepCounter: 005d10cc-09f1-4b9f-b118-9f278d6a3f7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e2d6201-a4f4-4424-b70f-dbda2dae4256
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: READMITTED_28_DAYS_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a01b3a19-724a-4466-a459-8c4c638a77f9
                stepCounter: 005d10cc-09f1-4b9f-b118-9f278d6a3f7a
            transform: |-
              CASE WHEN s_in_patient_event_prev_next.readmission_event_encounter_id IS NOT NULL THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47e88be1-5bf2-42bd-b7b5-454468f13976
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REFERRAL_RECEIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 933b2282-b9b8-4117-9bd3-56dce1d4eee0
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ffb601f-a8ce-4804-b24c-0411c3e5767c
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b820416-07dd-40f6-bf40-b709178c9b29
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 758ee22d-e88a-45bd-8e85-a6017a08e7bc
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRED_TO_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6bcb0406-0ba5-4ac7-ad55-12b5d3cabe8b
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70345d7c-3860-4553-95d7-dde13421752c
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REHAB_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a2651d1-60a9-4f13-8a78-8f5e01ca667d
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f33d40f-590c-44bf-af1a-a4923b02f185
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: RESPONSIBILITY_CENTRE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b217983d-440d-4de8-a4e6-c8904077144e
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eddcca1c-f885-439b-8d1d-f016192bf424
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SERVICE_POINT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8882df74-5465-4917-9970-62e8e4d93f44
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1c9fcd5-a011-47ed-b9d8-f72c68bb7d74
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SERVICE_POINT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e0320580-fa5f-45c0-aef2-24aec85780aa
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d248b94a-c0e9-4e6d-ba56-8341350623ea
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SMOKER_IDENTIFIED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 89d9349c-7666-4155-a5df-9e49c2cdb9ab
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SMOKING_ADVICE_GIVEN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aaa09c4c-6492-432f-b711-9f921a354c1e
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CCL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd4b33d2-c40e-4fc4-b4a5-22effab07235
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8d8a523-1080-4b28-86d8-227c9721d65e
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83b5e08b-0065-4efd-8945-e1e294fc8441
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25622f67-7ee0-4a4f-8c47-392f5848f111
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SRTPC_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c82de99-954c-4ae0-98c4-55fadabac357
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f3108edc-572a-4963-a7a7-4719e88b4697
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITING_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dbda8ddb-0785-4665-9469-a053d7e2b4fd
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 587b4851-0550-4fea-9b83-88b6c7145a3e
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITLIST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ca119d9-7f7b-4050-9f38-768df9f7f176
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 515ac8f0-5bd7-46c8-a0f5-6eceecdcf19d
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: WAITLIST_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 371d4146-583e-4a29-a299-516b8e56c05b
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 381d1eac-e932-49dc-b4fa-2544f4a0da6c
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: WIES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ac5c57f1-f417-470d-ae1d-593e3e85a2b2
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b580f70-5758-482a-ba66-65eb4289857a
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: NVARCHAR(255)
        defaultValue: ""
        description: ""
        name: WIES_GROUPING
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a86ce2f-a82f-48b7-8a1c-a73dcf4b02dc
                stepCounter: 14621552-1d60-4a3f-9189-d97042f50728
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed1aa6ee-e27f-4e74-a543-836dfa5151bf
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Hospital Code
        name: HOSPITAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 115c14ce-e2f2-482a-a9b2-df1d2f15f74b
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b193a8b-6ba9-43f7-ab07-fa9617045c33
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADSOR_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5425c16a-9b29-48b1-91b4-8324c8230d1f
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34b0bc36-c9e5-4482-a78a-eaaeeb09bdb6
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(2000)
        defaultValue: ""
        description: Clinician notes for the encounter.
        name: ADMISSION_NOTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 70439a3f-bb0c-4ebc-9874-f4e3ef7b0bb7
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ccba167-041a-4371-9cf4-8c805d113e00
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: dss_data_quality_code
        name: DSS_DATA_QUALITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: edc6c7d7-d854-45bc-8aea-b0d3f2055c68
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 823c1366-3c38-4fc1-85be-a12855ac7d59
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: INT
        defaultValue: ""
        description: Updated by custom procedure.
        name: PUC_MAP_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7924ec2e-2f80-4935-97d5-f6a83e8b1a68
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ef5620b-32d4-4541-ac0e-75abb8a38bcd
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: 'Uncoded purchase unit code retained in this field '
        name: DEFAULT_PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9cd92ce5-5c43-46c7-9761-1dc8b74d5a5f
                stepCounter: 3785c411-0818-4b5e-9d42-9d553d84ebd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3a8859c-c23a-4a37-835e-e34801e6ada4
          stepCounter: 6608a667-c773-417a-add1-6383009300a8
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          L_MAPPINGS_INPATIENT_WAITLIST_CLOSURES: 76e0efa7-bc1c-430c-9d7b-406e7ddca7de
          S_ADMIN_CATEGORY: 74f3aa94-9c0a-45fa-82b0-85d01b14d1ec
          L_REFERENCE_LOS_GROUPING: 14621552-1d60-4a3f-9189-d97042f50728
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_IN_PATIENT_EVENT_10
          - locationName: TGT
            nodeName: L_MAPPINGS_INPATIENT_WAITLIST_CLOSURES
          - locationName: TGT
            nodeName: S_ADMIN_CATEGORY
          - locationName: TGT
            nodeName: L_REFERENCE_LOS_GROUPING
        join:
          joinCondition: |-
            FROM s_in_patient_event_10
              JOIN s_in_patient_event_stays_specialty_path_10_v
                ON s_in_patient_event_10.event_encounter_id=s_in_patient_event_stays_specialty_path_10_v.event_encounter_id
              LEFT OUTER JOIN s_in_patient_event_prev_next s_in_patient_event_prev_next
                ON s_in_patient_event_10.event_encounter_id = s_in_patient_event_prev_next.cur_event_encounter_id
              LEFT OUTER JOIN s_in_patient_event_ward_path
                ON s_in_patient_event_10.event_encounter_id = s_in_patient_event_ward_path.event_encounter_id
              LEFT OUTER JOIN ds_inpatient_stay_prev_next
                ON ds_inpatient_stay_prev_next.event_encounter_id = s_in_patient_event_10.event_encounter_id
               AND ds_inpatient_stay_prev_next.event_stay_seq_num = 1 -- 27-Feb-2023 Now done in s_in_patient_event_05  --LEFT OUTER JOIN  -- (SELECT patient_reference_no, MIN(into_theatre_date) into_theatre_date  --  FROM ds_shared_schedule   --  WHERE ds_shared_schedule.schedule_theatre_status_code = 'A' -- 'Actual'  --  GROUP BY patient_reference_no) ds_shared_schedule  --ON  ds_shared_schedule.patient_reference_no = s_in_patient_event_10.event_patnt_refno    --AND ds_shared_schedule.into_theatre_date BETWEEN s_in_patient_event_10.admit_date AND s_in_patient_event_10.disch_date    LEFT OUTER JOIN   (SELECT patnt_refno, MAX(to_come_in_date) to_come_in_date    FROM s_admission_offer_05    WHERE s_admission_offer_05.cancel_date IS NULL AND s_admission_offer_05.defer_flag = 'N'     AND s_admission_offer_05.patient_confirmation_status_code IN ('NSP', 'ACCEPT','INIRES')     AND s_admission_offer_05.offer_outcome_code IN ('CANCD','PATDC', 'DEATH', 'C', 'RMNWL', 'RFWL', 'NCONT', 'REJCT', 'P')    GROUP BY patnt_refno) s_admission_offer_05  ON s_in_patient_event_10.event_patnt_refno = s_admission_offer_05.patnt_refno  AND s_admission_offer_05.to_come_in_date BETWEEN s_in_patient_event_10.admit_date AND s_in_patient_event_10.disch_date     LEFT OUTER JOIN s_in_patient_clinical_coding_summary s_in_patient_clinical_coding_summary_d   ON s_in_patient_event_10.event_encounter_id = s_in_patient_clinical_coding_summary_d.event_encounter_id   AND s_in_patient_clinical_coding_summary_d.diagnosis_procedure_type = 'D'     LEFT OUTER JOIN s_in_patient_clinical_coding_summary s_in_patient_clinical_coding_summary_p   ON s_in_patient_event_10.event_encounter_id = s_in_patient_clinical_coding_summary_p.event_encounter_id   AND s_in_patient_clinical_coding_summary_p.diagnosis_procedure_type = 'P'     LEFT OUTER JOIN fact.fact_cost_encounter  ON s_in_patient_event_10.event_encounter_id = fact.fact_cost_encounter.encounter_id    LEFT OUTER JOIN {{ ref('TGT','L_MAPPINGS_INPATIENT_WAITLIST_CLOSURES') }}  ON s_in_patient_event_10.remvl_refno = l_mappings_Inpatient_Waitlist_closures.remvl_refno  and l_mappings_Inpatient_Waitlist_closures.disde_refno = s_in_patient_event_10.disde_refno  AND l_mappings_Inpatient_Waitlist_closures.dismt_refno = s_in_patient_event_10.dismt_refno  AND l_mappings_Inpatient_Waitlist_closures.ceocm_refno = s_in_patient_event_10.ceocm_refno    LEFT OUTER JOIN {{ ref('TGT','S_ADMIN_CATEGORY') }}  ON s_in_patient_event_10.adcat_refno = s_admin_category.admin_category_reference_no    LEFT OUTER JOIN {{ ref('TGT','L_REFERENCE_LOS_GROUPING') }}  ON DATEDIFF(dd,s_in_patient_event_10.admit_date,s_in_patient_event_10.disch_date) - IFNULL(s_in_patient_event_10.event_leave_total_duration,0)   = l_reference_LOS_Grouping.Day
        name: S_IN_PATIENT_EVENT_20
        noLinkRefs: []
  name: S_IN_PATIENT_EVENT_20
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
