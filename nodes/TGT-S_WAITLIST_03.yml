fileVersion: 1
id: 490360cc-267e-4048-972d-1f2a54951aa0
name: S_WAITLIST_03
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Staging of Elective Services Waitlist"
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96c5ad27-12ba-44fb-9676-0ec4e34af8e9
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: WAITLIST_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72ac5d31-0410-466a-83cf-88855b88368c
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: "'W' + CONVERT(varchar,ds_pims_waiting_list_entries.wlist_refno)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74c12906-28ae-49e9-bcda-ba812d9e1c77
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: WAITLIST_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'W'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b88fb451-a928-4915-b9f4-3312211b2282
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WLIST_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72ac5d31-0410-466a-83cf-88855b88368c
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4836655a-d48a-4f08-a31d-e254b8ea8739
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e16ad8e0-4912-482e-9888-176f95f3db3e
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9064a440-96fc-4bd6-8d3a-01d880cb8a49
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFRL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 45024991-df53-4c1c-81be-8ac36a442528
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a08198b0-13b9-458f-abbf-05f2f0bd5ee7
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REFERRAL_RECEIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d559d91-e33e-47a7-a819-1f7cce3c6112
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f98fd65a-a9f3-405d-aa1a-a9259cb96118
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRED_BY_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2eb59e4d-ed8c-4413-895c-2f62daabf8bf
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6635d126-3fd1-4f26-9e55-154295426611
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRED_TO_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9ad4814-be66-4584-a9de-289a9e5a8644
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 920a3d47-925c-43d9-8cad-6f8220129b15
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRED_BY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee463a13-670e-474e-909b-796ab470f0d7
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42cc3861-269d-40ac-81f9-0f46e976e293
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRED_TO_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 53c236fa-c554-49c8-b648-f11ff0f4c5f9
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9f8e6db-ba40-4d32-9bfb-866d2b79953b
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WLRUL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 01cb5bb0-9430-4c98-92be-c6da843e88c5
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d0e18c1-e364-4cb9-97e3-8a46b86a03d0
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LOCAL_WLRUL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0735eef9-6f57-4376-9604-d6947f38cf7f
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 809b4ec5-2837-4b46-b285-d04f2dbdd445
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4d42d46-5377-48ed-9814-b6bb7ab8361a
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 726dc1f0-45a7-4ac9-9dc2-b302120a813c
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c8f88627-3352-4bc7-889f-bad783763b6b
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e5fa2f4-7e30-4d60-b62a-80a5fcbf880b
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMET_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19618be1-f741-41a1-b6fb-ee329f9b2918
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ec231fd-551c-4c23-90a2-32c0dd994726
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADCAT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02a41e52-ad77-4a59-8c5c-9e1bc2bd3d03
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c32c672d-01c4-4127-8bff-0d7349d43749
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: BKTYP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1e6f333-0d47-4aa1-bf1c-d19e43292266
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3acfafcc-be0a-4e47-ba59-2e70a8e4ed73
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: INMGT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0317d84b-48fe-4268-8e47-2f0f1a212fe3
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a13a84f-0fd4-4d3b-85db-852968cd784a
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRITY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9da45f82-e5c3-4715-9fa6-a2079ba27739
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06c74869-7db9-4dbc-8943-6b829e81c0df
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SVTYP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4cbea798-da47-488f-911c-1c3131e6152e
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 805137d7-d897-4a30-ac66-ddffa6f34a98
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: def499da-ec76-4985-9111-f1ed579df909
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80687eb7-dcfa-4c07-aa2d-539ecf0bf085
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: XFER_SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4145fb35-c397-4b3a-8c36-c7f8bf156bf1
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5517f639-8d44-46ec-a817-84a62e3cc0e2
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WHOCO_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90a80ba1-9472-4097-a082-22b198dc5167
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa5172d6-c12c-4896-a288-61230faccd04
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REMVL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ce446ad-7b4b-4094-a0d7-9b84fd634bc6
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 555ed4df-a258-40d4-b9bb-b9edfc946a77
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CSTAT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cf926383-a873-4d2e-8516-ed65887b30b7
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 038d8d52-8995-4f92-8db2-0f945bd90260
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ANTYP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 49ae38f4-1c86-4de8-aba5-2c1733aff0d3
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71a81365-f372-4489-a97e-f0d2e107498d
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACBKS_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 35f54fbe-6970-408a-ada1-b8b2c6dd561e
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 58922cfb-0708-464d-9e97-c1b4ae37ccb1
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMDC_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c7c579c-9d37-47d1-bd42-8cf831b868b2
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dd9c3830-9dd1-4297-888d-d40f66a3aaa8
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACPRT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 913b9f72-87cd-4c6a-9a69-70a3e1593a69
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: coalesce(lldv3.ussob_value_6,ACPRT_REFNO,lldv2.ussob_value_4)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74b090e6-c4a9-4529-b6d0-01e7c665e112
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: PLANNED_PROC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a18db8a-0b70-4e2e-b537-0f04e3eea350
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 074d697a-85e2-43e2-b84f-30042bc11b5e
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EXTERNAL_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7eb1a77c-b53e-464e-88e4-ca10f0567964
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a855da36-1c92-4093-aadd-8c650a34b4b6
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WLIST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 065ea057-d4a2-4882-bbf6-86cfbb25bd6b
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: IFNULL(ds_pims_waiting_list_entries.wlist_dttm, ds_pims_waiting_list_entries.remvl_dttm)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 63ebb037-e7b4-43ed-839e-ac13b083a558
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f32e18e2-22d9-4b54-be37-6860250fb42b
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54008986-1274-494e-a927-3de163322cd6
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REMVL_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 36a3fdff-30f8-45fe-b227-f477953b83cc
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c41dd8d-b41b-4aa8-b829-f22865032632
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITING_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a977f9e-b766-4b63-9fad-8ebc40710eab
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: COALESCE(ds_pims_waiting_list_entries.waiting_start_dttm,ds_pims_waiting_list_entries.wlist_dttm,ds_pims_waiting_list_entries.remvl_dttm)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47f3ac6b-7842-448c-98f5-117549b40b4e
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITLIST_SUSPENSION_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9b8c7fd0-fd04-426f-9a03-37fb8b8bb0e2
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9af5e98-226c-47b9-bf7a-2bce56faf12a
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ACKNW_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a53052a-770e-4aa6-ad4e-854493227a19
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b823c4c-9b7f-49f1-8ef0-1cf1be509bc6
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADM_CARE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d77ce402-cc2e-40f1-8fb2-a6a9efd88e32
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d7dae53-68ca-4e46-8c36-4181214232c7
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: BOOK_STATUS_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4083150f-31cf-4e40-bfff-2932be8d3320
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eda7f6d5-7557-482a-8cac-1a8ceae55d09
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CERTAINTY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 97f5140c-14e3-4f78-a330-2be2ffc6592f
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7059a36b-ad4a-42de-b907-83edefee102c
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FSA_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75d1dd7f-d27d-4e04-a2ac-8779e738b0a0
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a3a23d5-2dec-4da0-99b8-827a179eb87b
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ADMIT_READY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5da1380-a7f3-4bad-af1b-81f9c753063b
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d470e38-d52e-41d9-8a30-391c2e1ace71
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: SHORT_NOTICE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 70db9b8f-8296-4824-9ec9-cc00ecdf66cb
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a39d8d2e-ac7c-4664-bb23-f1d53a6341f9
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACTIVE_INDICATOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9f39335b-2dc3-4307-8c5c-21078dba94f8
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2eac926a-0055-497b-928b-a99ab4235277
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: THEAT_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b7c0990-620d-42e7-ac31-61a9476707be
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8dc2e6e3-180c-46d9-9532-d4538d660be0
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LENGTH_STAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48471857-31e0-4286-b861-6df30576524a
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ade5ccb-755a-46c4-a4c5-656419ef0e25
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITING_SUSP_TOTAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f8de371-5509-492f-a1c1-fd2258f5a888
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c462f08-47da-4f63-aff7-6672108a5648
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_WAITLIST_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e16ad8e0-4912-482e-9888-176f95f3db3e
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ROW_NUMBER() OVER (PARTITION BY ds_pims_waiting_list_entries.patnt_refno ORDER BY COALESCE(ds_pims_waiting_list_entries.waiting_start_dttm,ds_pims_waiting_list_entries.wlist_dttm,ds_pims_waiting_list_entries.remvl_dttm))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f11d7d30-074e-4ba0-bd48-ddd9dcf191ed
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Sequence of the waitlist withing a referral
        name: PATIENT_REFERRAL_WAITLIST_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e16ad8e0-4912-482e-9888-176f95f3db3e
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ROW_NUMBER() OVER (PARTITION BY ds_pims_waiting_list_entries.refrl_refno,ds_pims_waiting_list_entries.patnt_refno ORDER BY COALESCE(ds_pims_waiting_list_entries.waiting_start_dttm,ds_pims_waiting_list_entries.wlist_dttm ,ds_pims_waiting_list_entries.remvl_dttm) ,ds_pims_waiting_list_entries.svtyp_refno DESC ,ds_pims_waiting_list_entries.wlist_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45bfe1ca-8a3b-4950-b671-36cbf0cb886a
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_WAITLIST_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e16ad8e0-4912-482e-9888-176f95f3db3e
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: COUNT(1) OVER (PARTITION BY ds_pims_waiting_list_entries.patnt_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6341459e-c365-44b7-b06b-ebdd018efc82
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: WAITLIST_APPOINTMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddac70c1-37bd-44f2-b5cd-f0049f80872b
                stepCounter: 4663c21b-e6e2-4d6b-83d0-40e35b0266f3
            transform: IFNULL(s_waitlist_activity_05.waitlist_appointment_count,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94d19ef9-953f-4db3-aa58-0dcb4bae0557
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: WAITLIST_ADMISSION_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d5ac55c7-81ef-40df-b518-b5f538f74228
                stepCounter: 4663c21b-e6e2-4d6b-83d0-40e35b0266f3
            transform: IFNULL(s_waitlist_activity_05.waitlist_admission_count,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d451518a-7d98-439b-8b5b-1ec2c73a5acb
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: WAITLIST_ATTENDED_APPOINTMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 62d5db15-4e76-406f-81b6-1c009821f5c6
                stepCounter: 4663c21b-e6e2-4d6b-83d0-40e35b0266f3
            transform: IFNULL(s_waitlist_activity_05.waitlist_attended_appointment_count,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 934249fc-afc9-4f34-a638-cfb271f14654
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: WAITLIST_ACTIVITY_OCCURED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 183fd0dc-e30c-481d-b352-0c43421e7602
                stepCounter: 4663c21b-e6e2-4d6b-83d0-40e35b0266f3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a832011-6159-4957-b1ad-0c99a7fa89b0
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 54a36e8f-ba7f-4068-9df0-6b9e6a8452a9
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8779b07b-f3ee-41b1-b5b2-343abb7c6eec
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77765bc2-2220-40a4-9edb-66cffdb194d1
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22e66a3d-f90e-481f-a605-d8f2b72f765e
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIFY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05447b97-8577-4a77-ab7d-0e51aed83253
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c9cc193-8c77-447b-a4b1-cffdfc04ad2b
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MODIFY_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0820e519-7ede-45ae-a61d-b2004b3bd538
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01a6db89-4027-4278-a73a-d191850ba556
          stepCounter: 490360cc-267e-4048-972d-1f2a54951aa0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_WAITLIST_ACTIVITY_05: 4663c21b-e6e2-4d6b-83d0-40e35b0266f3
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_PIMS_WAITING_LIST_ENTRIES
          - locationName: TGT
            nodeName: S_WAITLIST_ACTIVITY_05
        join:
          joinCondition: |-
            FROM ds_pims_waiting_list_entries
              LEFT OUTER JOIN ds_pims_referrals
                ON ds_pims_waiting_list_entries.refrl_refno = ds_pims_referrals.refrl_refno
              LEFT OUTER JOIN {{ ref('TGT','S_WAITLIST_ACTIVITY_05') }}
                ON ds_pims_waiting_list_entries.wlist_refno = s_waitlist_activity_05.wlist_refno
              LEFT OUTER JOIN (
                    SELECT *
                      FROM ds_pims_ldd_local_datavalues
                     WHERE USSCR_REFNO = 1000020060
                   ) lldv2
                ON ds_pims_waiting_list_entries.patnt_refno = lldv2.patnt_refno
               AND ds_pims_waiting_list_entries.wlist_refno = lldv2.sorce_refno
              LEFT OUTER JOIN (
                    SELECT *
                      FROM ds_pims_ldd_local_datavalues
                     WHERE USSCR_REFNO = 2000020300
                   ) lldv3
                ON ds_pims_waiting_list_entries.patnt_refno = lldv3.patnt_refno
               AND ds_pims_waiting_list_entries.wlist_refno = lldv3.sorce_refno
        name: S_WAITLIST_03
        noLinkRefs: []
  name: S_WAITLIST_03
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
