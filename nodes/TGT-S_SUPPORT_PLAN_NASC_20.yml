fileVersion: 1
id: e6749599-cb6a-4aa9-bd65-13e7848e8c22
name: S_SUPPORT_PLAN_NASC_20
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da3c4868-514e-4c33-8892-93455bbc052f
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: CONTACT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7fe032a2-d903-4b33-91b2-1d158ace1fad
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20347b15-6b21-4983-96c1-4c273c02cf23
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: CONTACT_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 86259dde-31d1-4d88-9af6-bdccba658e68
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f435b81b-b8d5-4b1f-be2a-f43673361d16
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_support_plan_NASC_20.contact_encounter_type_code=dim_encounter_type.encounter_type_code
        name: DIM_ENCOUNTER_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3ba8df3-db2e-40a1-97dc-d5ad6a5186a7
                stepCounter: 1d0ea6a1-9563-4fb3-a1fa-9d43dbdf296e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57b13d83-81e1-493a-b9f0-ec47ae2276ff
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: TASK_REQUEST_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cbce6bdb-a1e5-4bb0-ac18-679c5f70cf37
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06258f13-6c73-4ef3-9be3-8915d3293039
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: ""
        name: PROGRAMME_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 96891edf-c9a1-460f-9677-300eb05e2f0f
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e272158-a828-4d4d-ba0a-a445f30839f0
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: patient_programme status
        name: PROGRAMME_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 26d041bd-48d2-4db2-b9f8-c829f2cae79d
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2af4d0d-3c1e-43ea-a6b2-f8a9e54a468c
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 10a240c1-ffae-406e-8dfa-a838834c41b2
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bda3c91f-365f-4b0a-92d0-a1f23a3efcb9
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_support_plan_NASC_20.patient_NHI=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9962a01b-5f3d-4c1a-b371-997edef38d0f
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: IFNULL(dim_patient.dim_patient_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54992223-0cf4-4822-b2c4-c17d01858de9
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_AGE_AT_CONTACT_YEARS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f201416-ac35-4870-a0c1-0836d1b9e5b7
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: FLOOR(DATEDIFF(dd,dim_patient.patient_date_of_birth, CASE WHEN IFNULL(dim_patient.patient_date_of_death,s_support_plan_NASC_10.task_request_date) < s_support_plan_NASC_10.task_request_date THEN IFNULL(dim_patient.patient_date_of_death,s_support_plan_NASC_10.task_request_date) ELSE s_support_plan_NASC_10.task_request_date END) / 365.25)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3fdcb768-92ce-40b5-a15f-d3bd28adb139
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_support_plan_NASC_20.patient_age_at_contact_years=dim_age_group.age_years
        name: DIM_AGE_GROUP_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18bfabd7-19aa-4de0-9ce7-aa560645bce6
                stepCounter: 3d5ba8a8-80ec-4848-b58a-d31b34cc53ed
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a0e4cab1-6b03-4366-a608-ac4d19af4569
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: DOMICILE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 13e3f44a-7125-438f-b00f-42c54a307c05
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a891c752-1d6e-4315-9ed0-036c532aeaec
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_support_plan_NASC_20.domicile_code=dim_domicile.domicile_code
        name: DIM_DOMICILE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e049fc8-a2a3-4bad-9b91-11b9d158b35e
                stepCounter: 330ad0aa-b8b1-4da9-ab37-b4fe8f889452
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c261c85-870f-4016-84eb-dbcf3fd9c542
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: TASK_DESC
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3d2c8e60-2bb8-49e5-8884-56361e9ad59f
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f76e627f-f0f8-470b-b34b-7485055dc869
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: HEALTH_ORG_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f4d0042d-63bd-4fd5-9aef-e32e86e360c2
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e225003-66b0-4364-977c-c7484ea8462d
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_support_plan_NASC_20.health_org_reference_no=dim_health_organisation.health_org_reference_no
        name: DIM_HEALTH_ORG_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78290bb6-3cd5-4503-8179-d1f65525ba15
                stepCounter: 0790fdf4-e815-4587-a9cd-954ea13f53c6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f05fdcd9-e513-4ecc-90b7-dbd9d0b3ff8d
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SEEN_BY_CLINICIAN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ad06faf-b6db-4684-ad03-1c78f6a7a508
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96c27064-1eb1-4199-a52e-6e168813cc1d
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SEEN_BY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 442ebaf1-f4f1-4fd0-9c7f-be3d7af3e307
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9fbbde85-374c-4961-916c-88e1bfeb572a
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_support_plan_NASC_20.seen_by_clinician_reference_no=dim_seen_by_clinician.seen_by_clinician_reference_no
        name: DIM_SEEN_BY_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6980c5e-497d-45d3-854e-f5d17228ad86
                stepCounter: 293e84bb-0ad7-4a27-96ab-0a0cb38c50c5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8855c718-3465-40e8-8e9f-7692db99b13d
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d17958f8-12fb-487c-856b-e475a2c5dbe8
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c07aada0-3067-42ed-92f5-f26bdd5291b8
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: HOSPITAL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc774361-7fe4-40a0-8592-28658741401a
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 551234ef-68cb-4730-88c5-b557b0db2f85
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PROVIDER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 225a7675-b6f7-4922-b2ee-e5d5660ac919
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 397df3a7-a2c4-4158-8751-1388dea3d708
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_support_plan_NASC_20.provider_id=dim_provider_community.provider_id
        name: DIM_PROVIDER_COMMUNITY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 81b90d7a-0e1c-4ff6-a2e5-e32763dfcbcd
                stepCounter: fe333361-f763-4fd4-b86e-f42e95e81344
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 379e912a-dd69-477d-bbf3-784dd9676685
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PROVIDER_ROLE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eabfac0b-7385-4962-ad23-c983efe87967
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 746cc5af-13d8-4aa1-963d-ebd030b2d211
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PROGRAMME_ROLE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7414e82b-0e79-44a3-85d5-78f7f05cedbb
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75a09b37-3f7e-4c62-9a03-215dc4b327a7
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_support_plan_NASC_20.programme_role_code=dim_role_community.role_code
        name: DIM_ROLE_COMMUNITY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: acff4fff-07f1-43da-966d-53a96d429471
                stepCounter: ab48ab83-7613-4d28-acbd-ba81b413fe84
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67a8838d-51db-47fb-a355-c5c24323612b
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: DEPARTMENT_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f02296ea-b0d4-44bf-bc32-318eda0b3e8a
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f134e283-f0ce-43f3-b601-cce2304a3276
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SERVICE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b7b75f08-cba0-47ea-bcb9-0883679be938
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72a6b3b1-d9ec-4cf4-a13d-82dd94f47e22
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: TASK_REQUEST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1288de86-07dc-4c66-947a-54740d89408a
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af2d99de-84c4-4c93-8aa4-60c4c4762308
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_support_plan_NASC_20.CONVERT(date,s_support_plan_NASC_10.task_request_date)=dim_request_date.request_calendar_date
        name: DIM_REQUEST_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 776fe4b8-0bb6-494d-a530-7fae3de7a539
                stepCounter: d1b797ef-4926-45af-a745-f75c3ed18b1f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ec5b2d7-3e76-4621-9664-6f2a0fa63bbf
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: EPISODE_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d7c0a45a-a210-40cb-ab50-a6d8c58a45f4
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79d88367-ffc8-42c6-8fc4-2d0cc54f9454
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: NASC_SERVICE_ATO_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1a6f443a-fa17-4972-9e25-0f0c3c0e7dd0
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d48e9f94-d07f-4d03-89cc-32050efccc69
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SERVICE_GAPS_ATO_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d13cb4b-309d-47c0-85f5-ac8248161179
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 68f27188-7b0c-4683-a700-5a3a26c2e06e
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: RESIDENTIAL_PLACEMENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc684df6-2057-469c-966e-697037550d81
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2386c9ba-4baf-4f26-9447-7a850266d429
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: RESIDENTIAL_PLACEMENT_REASON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 49a75fca-4605-42f6-839f-aec3ec7900ce
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0cdab0a7-9aa1-4865-9181-b0937c4b1fc8
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PLACEMENT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d8f25e1e-27a2-4d8a-8eab-2be8ffb110c1
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed52b6d4-b94a-49cc-86af-c53761861ae4
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PLACEMENT_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9d92395-3e11-41dc-abd7-c8dd826608dc
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 235e52cd-070e-4830-8ee1-332ceb16b978
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: OUTCOME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ae45db2-32ba-41ae-8934-2aa163d701fe
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 342e4960-16ec-458d-a9c8-c408167f608d
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PLAN_COMPLETED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 41e0f32c-ec5e-49c3-bb55-15981b6ab5a4
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d57eff8-0f7d-4403-8e7e-48a7d11d4862
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REVIEW_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90396630-e7da-4d6e-9b70-4251d57af233
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09bd8771-e2b7-4ed3-b45a-5064b807e463
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: REVIEW_DATE_CHAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f88c177-bdf5-44db-9c0e-1825e37b6acc
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 299ea519-f531-4321-be01-87078a572408
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: REVIEW_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27b84bee-3113-446c-aa1d-e249bd134d05
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50f42f35-b541-47e3-89ba-164ae0ec4637
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: EXIT_REASON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4f2b130-2b51-458a-9d44-bf4990eea178
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87bd57d6-5ded-45c2-a7ca-b6407c1476d7
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: EXIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 200f712e-7a64-4564-b140-9b4a1fbbf5ee
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b622b795-d5df-4529-bf5a-a84ea443f59f
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SCID_MIGRATED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3cd48719-3d8b-4b0a-9f04-a1677632d149
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 688ed8fa-5d25-41eb-b2a9-48b061363d8c
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: TRANSFER_OUT_RESIDENTIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 327f4dad-7dcc-4307-a93c-8e467f386796
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7cbce1c-2ba1-47ca-9233-83d6f9ee8a75
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: TRANSFER_OUT_DHB
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75066c58-c22a-4c83-8216-a3d38ed20eef
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b054596-9c88-41e2-bc03-0e9780201f85
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: TRANSFER_INTERNAL_NASC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39995dfc-2472-4c0f-a5b2-3bc3fbe5be05
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: deb56930-f9d1-4836-b474-63c580769681
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_support_plan_NASC_20.transfer_internal_NASC=dim_NASC_support_plan.transfer_internal_NASC  s_support_plan_NASC_20.transfer_out_DHB=dim_NASC_support_plan.transfer_out_DHB  s_support_plan_NASC_20.transfer_out_residential=dim_NASC_support_plan.transfer_out_residential  s_support_plan_NASC_20.exit_reason=dim_NASC_support_plan.exit_reason  s_support_plan_NASC_20.review_type=dim_NASC_support_plan.review_type  s_support_plan_NASC_20.outcome=dim_NASC_support_plan.outcome  s_support_plan_NASC_20.placement_source=dim_NASC_support_plan.placement_source  s_support_plan_NASC_20.placement_type=dim_NASC_support_plan.placement_type  s_support_plan_NASC_20.residential_placement_reason=dim_NASC_support_plan.residential_placement_reason  s_support_plan_NASC_20.residential_placement_flag=dim_NASC_support_plan.residential_placement_flag  s_support_plan_NASC_20.service_gaps_ATO_id=dim_NASC_support_plan.service_gaps_ATO_id  s_support_plan_NASC_20.NASC_service_ATO_id=dim_NASC_support_plan.NASC_service_ATO_id  s_support_plan_NASC_20.programme_status=dim_NASC_support_plan.patient_programme_status  s_support_plan_NASC_20.observation_report_status=dim_NASC_support_plan.observation_report_status
        name: DIM_NASC_SUPPORT_PLAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9dc3c85a-7a1c-4c99-b7bd-71aae1bc10b4
                stepCounter: 9e8631b2-0aaa-4aa6-b085-c2eec8e3e685
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e892f928-7e6b-49da-ab3a-620943f742f9
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: FIRST_SUPPORT_PLAN_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 512d7a6d-5246-40c4-9a7a-3791bbb60480
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: |-
              CASE WHEN s_support_plan_NASC_10.referral_support_plan_seq_num = 1 THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 90d18f4a-4c8d-4ea3-b46f-b742af313801
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: CURRENT_SUPPORT_PLAN_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 512d7a6d-5246-40c4-9a7a-3791bbb60480
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: |-
              CASE WHEN s_support_plan_NASC_10.referral_support_plan_seq_num = s_support_plan_NASC_10.referral_support_plan_count THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c407ccd1-bf7f-40c7-904d-34aed3740998
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: OBSERVATION_REPORT_DUE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03edab92-e714-48d0-b2a2-54e2bfe94b87
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 671434b3-9743-435d-98e3-9c39dde21147
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: OBSERVATION_REPORT_COMPLETION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eddb0e1f-659d-48b6-be00-6f3a161ad166
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d2280f2-4ae6-40cb-b45d-4059a4e32dd1
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: OBSERVATION_REPORT_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bb440e8b-52d6-45e2-90c3-06756314aabc
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6dd57ee4-68d1-4c2d-9563-1a60c66899ef
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_SUPPORT_PLAN_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 512d7a6d-5246-40c4-9a7a-3791bbb60480
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce6cc968-c7f8-40c0-b254-d5ae4d5881e2
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_SUPPORT_PLAN_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f0fb5d7-72ba-40d2-93bf-090a6e5ac4c6
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f530d8ee-3fae-4098-a86e-1431db351b09
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_SUPPORT_PLAN_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 40582cfe-f829-43b8-bb31-50ee83fab7b1
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d68d3e2b-b9e3-4e71-95cd-1408e88e98ae
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_SUPPORT_PLAN_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 08b307a6-7862-4a8e-aaff-7225bebed522
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81c4e962-7785-4545-b5dc-0d80284143e1
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SUPPORT_PLAN_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '1'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f3343dc5-6bc8-43bd-ab21-fe000ac5f0a1
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 467e0986-85e3-4b01-a5f3-6598b82f2f13
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 464172d7-14fe-47bc-bcb9-19438229c8bb
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ba1c38f1-af4e-4844-8e8c-ec221a63f1b8
                stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b63d1177-7ac1-45f5-8950-f22ed4bff26b
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_support_plan_NASC_20.create_user_login_name=dim_user_login_concerto.user_name
        name: DIM_USER_LOGIN_CONCERTO_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16f2ac98-6185-439c-9a15-757698e43d58
                stepCounter: 4bf64241-1d0b-4a30-8919-350bb5d33ed1
            transform: IFNULL(dim_user_login_concerto.dim_user_login_concerto_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31853b16-3a7e-42cf-bd1b-6790cb8abcf5
          stepCounter: e6749599-cb6a-4aa9-bd65-13e7848e8c22
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DIM_USER_LOGIN_CONCERTO: 4bf64241-1d0b-4a30-8919-350bb5d33ed1
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_SUPPORT_PLAN_NASC_10
          - locationName: TGT
            nodeName: DIM_USER_LOGIN_CONCERTO
        join:
          joinCondition: |-
            FROM s_support_plan_NASC_10
              LEFT OUTER JOIN dim.dim_patient
                ON dim_patient.patient_NHI = s_support_plan_NASC_10.patient_NHI
               AND dim_patient.NHI_sequence = 1
              LEFT OUTER JOIN {{ ref('TGT','DIM_USER_LOGIN_CONCERTO') }}
                ON s_support_plan_NASC_10.create_user_login_name = dim_user_login_concerto.user_name
               AND IFNULL(dim_user_login_concerto.validity_start_date, GETDATE()-10000) <= s_support_plan_NASC_10.task_request_date
               AND IFNULL(dim_user_login_concerto.validity_end_date, GETDATE()+10000) >= s_support_plan_NASC_10.task_request_date
        name: S_SUPPORT_PLAN_NASC_20
        noLinkRefs: []
  name: S_SUPPORT_PLAN_NASC_20
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
