fileVersion: 1
id: 539492a4-6a50-4f2f-ba48-9442028423eb
name: S_SERVICE_POINT_PROFILES_20
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 512a9ad4-678f-46d0-957d-d24f5705bbdd
          stepCounter: 539492a4-6a50-4f2f-ba48-9442028423eb
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: The calendar date for this row.
        name: CALENDAR_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39c5c98c-7ee6-4303-a013-b78bfececaea
                stepCounter: bc3fcb77-c0c4-477a-92d8-4db14f153b73
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf975f1e-a43d-4963-9258-5c4a817cb0d5
          stepCounter: 539492a4-6a50-4f2f-ba48-9442028423eb
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TRENDCARE_WARD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 164f476c-1277-4c10-aadb-2e383a249d72
                stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92cc43bb-1f7c-46d2-8cb2-afb269538b45
          stepCounter: 539492a4-6a50-4f2f-ba48-9442028423eb
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: SERVICE_POINT_PROFILE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a8074d3-f3aa-4dea-a6d1-433f1f44224d
                stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 61847772-b099-432c-b171-aee338c8cf78
          stepCounter: 539492a4-6a50-4f2f-ba48-9442028423eb
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: SERVICE_POINT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4d18d542-aa7a-4f21-8b2e-2dfecc8a5865
                stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2f064f6-a0dd-430a-a6ae-9f5955251725
          stepCounter: 539492a4-6a50-4f2f-ba48-9442028423eb
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: SERVICE_POINT_BAY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cdbc00c1-2798-480c-94e0-a1400c2e9ab6
                stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7bc7217-7239-4fc1-a97b-cd092adcc07e
          stepCounter: 539492a4-6a50-4f2f-ba48-9442028423eb
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: SERVICE_POINT_BED_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 626f90ac-041c-417f-9527-1929cb824bcf
                stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a2b79c7-3b65-47e1-9685-b4fb5d177631
          stepCounter: 539492a4-6a50-4f2f-ba48-9442028423eb
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6fa64817-2531-40bc-b718-2a70fdff18be
                stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab470f31-e875-44e1-b3bb-c944d10941ce
          stepCounter: 539492a4-6a50-4f2f-ba48-9442028423eb
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: REFERENCE_VALUE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b0f670f-63e3-438c-8fce-580ff1ba8527
                stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cdf946cd-91b0-4447-bcfd-008adf4fe8b5
          stepCounter: 539492a4-6a50-4f2f-ba48-9442028423eb
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: RULES_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 945f7981-bc62-4529-87ae-87a08f122267
                stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09f93f3c-d7f0-41e0-a135-3f7350fb34ff
          stepCounter: 539492a4-6a50-4f2f-ba48-9442028423eb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SERVICE_POINT_PROFILE_VALUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc759f21-32e4-4590-9224-429ee421dc5d
                stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2df01883-4ec4-491b-884b-3d99f07267f0
          stepCounter: 539492a4-6a50-4f2f-ba48-9442028423eb
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: BED_CATEGORY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd16ed9e-77d8-450d-8ba2-44c704ee56d7
                stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1121fe31-8cb3-415d-b87c-c8267274c456
          stepCounter: 539492a4-6a50-4f2f-ba48-9442028423eb
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SERVICE_POINT_PROFILE_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e0e86b5-e6a7-4466-ae5d-086fa611c8ab
                stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67dc254e-3d78-4f33-937f-11111c9d831e
          stepCounter: 539492a4-6a50-4f2f-ba48-9442028423eb
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SERVICE_POINT_PROFILE_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 12dd13c2-66fc-44bf-af73-d44041205bae
                stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 685095f9-fab9-46ca-be1c-582bffb31ee0
          stepCounter: 539492a4-6a50-4f2f-ba48-9442028423eb
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SERVICE_POINT_PROFILE_CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b7bd0f47-05ae-4b58-beaa-4bf4dfefe0aa
                stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb9182aa-1bcc-4adc-9d6d-b8109fc2222b
          stepCounter: 539492a4-6a50-4f2f-ba48-9442028423eb
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SERVICE_POINT_PROFILE_MODIFIED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e72c5d0-d000-4d60-bf2e-c6e0ef34b699
                stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66d5de16-7043-4c3b-9c72-52c9df1beada
          stepCounter: 539492a4-6a50-4f2f-ba48-9442028423eb
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SERVICE_POINT_PROFILE_USER_CREATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d776e239-4de8-4b68-835f-44184dfc603c
                stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32cb1820-7336-4ba0-80dc-5c28f2f2e67c
          stepCounter: 539492a4-6a50-4f2f-ba48-9442028423eb
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SERVICE_POINT_PROFILE_USER_MODIFIED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee2b8341-56e6-4379-af02-8da71d7e0f99
                stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4dec4d60-e65d-4ecc-982e-bca06adc976c
          stepCounter: 539492a4-6a50-4f2f-ba48-9442028423eb
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: ARCHIVE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 940cf415-3686-4724-ae72-27c88d7d747c
                stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed432cf0-fa5a-472d-b7d0-272b632a8629
          stepCounter: 539492a4-6a50-4f2f-ba48-9442028423eb
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: Surrogate Key of last session transaction affecting this row.
        name: SESSION_TRANSACTION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c9b8dadf-38c6-4807-9635-8f9646687cb4
                stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 722b59f1-cec1-43f9-bd6a-acdb46737027
          stepCounter: 539492a4-6a50-4f2f-ba48-9442028423eb
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EXTERNAL_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1dc635f-7adc-4e62-b713-1f7263fddca2
                stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c1a64dd-9bf0-42e0-8529-6f8ac84e6098
          stepCounter: 539492a4-6a50-4f2f-ba48-9442028423eb
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: SERVICE_POINT_CHANGE_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea12a9fd-6c55-4c53-88ca-3253c0d43b06
                stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2e912bf-349a-4b7a-9580-b927f4092a3c
          stepCounter: 539492a4-6a50-4f2f-ba48-9442028423eb
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: WARD_PROFILE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2731d1d8-e1ae-4d70-ba9d-1a90e532966a
                stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7ee703a-12e2-4013-a13e-97074cb7dd48
          stepCounter: 539492a4-6a50-4f2f-ba48-9442028423eb
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SERVICE_POINT_PROFILE_PLANNED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3ea96ec1-68f5-404d-99b2-97c3f708c5c5
                stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: deaa4f13-a82b-431c-bfe7-dde9a3869f06
          stepCounter: 539492a4-6a50-4f2f-ba48-9442028423eb
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: OWNER_HEALTH_ORGANISATION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f938b0b-10d0-44e1-bfd7-33541f99c6e6
                stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 793f3d2d-a164-445c-8d63-9fa48f721f4c
          stepCounter: 539492a4-6a50-4f2f-ba48-9442028423eb
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: OPERATOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c2cfdb70-6760-4f81-a24d-46a64fa8c7bc
                stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d84b59bb-a0e0-4d31-b3b5-b71ecd489650
          stepCounter: 539492a4-6a50-4f2f-ba48-9442028423eb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_service_point_profiles_10.service_point_reference_no=dim_service_point.service_point_reference_no
        name: DIM_SERVICE_POINT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8d12830e-4f4b-4b6c-b8bc-af67afacf585
                stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59e4af07-ecc9-49fd-a22a-ca3c6afca7c0
          stepCounter: 539492a4-6a50-4f2f-ba48-9442028423eb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_service_point_profiles_20.Trendcare_ward_code=dim_ward_trendcare.ward_code_trendcare
        name: DIM_WARD_TRENDCARE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 17dede82-d4b5-4d73-843e-d9a24dbec0a2
                stepCounter: 7cf2c591-4306-485b-a3da-931cd7460e13
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7591078f-06e0-4ce6-932e-cc6a6fff6b9c
          stepCounter: 539492a4-6a50-4f2f-ba48-9442028423eb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_WARD_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6aa5e7b8-4dc5-4b87-a4c2-5013db0e1dfc
                stepCounter: 50c31151-9204-4154-9caf-5d28244bde1a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9db1cbb-e760-4ada-a6b3-01379eb96e46
          stepCounter: 539492a4-6a50-4f2f-ba48-9442028423eb
        config: {}
        dataType: INT
        defaultValue: ""
        description: s_service_point_profiles_10.specialty_reference_no=dim_specialty.specialty_reference_no
        name: DIM_SPECIALTY_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0be9ccfa-ceca-47f1-89ab-e114bfd58e68
                stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 10ce0068-9ab9-4322-90ee-d6c6d43d72e9
          stepCounter: 539492a4-6a50-4f2f-ba48-9442028423eb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_service_point_profiles_10.professional_carer_reference_no=dim_healthcare_professional.healthcare_professional_reference_no
        name: DIM_HEALTHCARE_PROFESSIONAL_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ecf6a71d-3a7d-437a-8cdc-fbbfe7b3669b
                stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79cf77e1-7236-4b69-89a3-2beb433d2f7f
          stepCounter: 539492a4-6a50-4f2f-ba48-9442028423eb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Operator in service_point_profile is '-' (minus) indicating the total number of closed beds
        name: IPM_CLOSED_BEDS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 302b23a1-4c97-42e6-98ea-efe8908f05c3
                stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42674967-d96e-4e54-b231-a3aa367fc752
          stepCounter: 539492a4-6a50-4f2f-ba48-9442028423eb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Operator in service_point_profile is = indicating the total number of physical beds
        name: IPM_PHYSICAL_BEDS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7baf2f43-2444-4af6-9751-eaaab7a384fe
                stepCounter: b57c78e5-df93-479d-bfee-e98396c879fe
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 727ab9ba-f90b-458d-ac07-77bc315fabed
          stepCounter: 539492a4-6a50-4f2f-ba48-9442028423eb
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DIM_DATE: bc3fcb77-c0c4-477a-92d8-4db14f153b73
          S_SERVICE_POINT_PROFILES_10: b57c78e5-df93-479d-bfee-e98396c879fe
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DIM_DATE
          - locationName: TGT
            nodeName: S_SERVICE_POINT_PROFILES_10
        join:
          joinCondition: |-
            FROM {{ ref('TGT','DIM_DATE') }}
              JOIN {{ ref('TGT','S_SERVICE_POINT_PROFILES_10') }} s_service_point_profiles_10
                ON calendar_date BETWEEN s_service_point_profiles_10.service_point_profile_start_date AND IFNULL(s_service_point_profiles_10.service_point_profile_end_date, getdate()+1000)
              JOIN [dim].dim_ward
                ON s_service_point_profiles_10.dim_service_point_key = dim_ward.dim_ward_key
        name: S_SERVICE_POINT_PROFILES_20
        noLinkRefs: []
  name: S_SERVICE_POINT_PROFILES_20
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
