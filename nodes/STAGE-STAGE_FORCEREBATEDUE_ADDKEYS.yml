fileVersion: 1
id: 4921e58e-474b-4c0c-b05e-0b9d99600c0c
name: STAGE_FORCEREBATEDUE_ADDKEYS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 385e8fc9-9325-415d-914c-c5bf9fb3e7c1
          stepCounter: 4921e58e-474b-4c0c-b05e-0b9d99600c0c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEFORCEREBATEDUE_ADDKEYS.FORCEREBATEDUEID=FORCEREBATEDUEDETAIL.FORCEREBATEDUEID
        name: FORCEREBATEDUEDETAILKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f22f3a7-241a-4c02-a4a4-9dada838df59
                stepCounter: f82001c9-4ee4-4647-9e2a-2b12f5212d85
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64d9733c-5916-4263-8781-3ed53e6e6427
          stepCounter: 4921e58e-474b-4c0c-b05e-0b9d99600c0c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: AUTOGENERATED ID
        isBusinessKey: true
        name: FORCEREBATEDUEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60f3ece9-0ced-4979-9b82-d5950bcb4f9d
                stepCounter: 79c07c7c-dc53-48fc-b9f7-d76df49d089a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 08601415-4b8d-4be7-ab24-f8539c1a3c77
          stepCounter: 4921e58e-474b-4c0c-b05e-0b9d99600c0c
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER ID
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 42d623bc-06ea-41ec-bc57-6537d2932e8d
                stepCounter: 79c07c7c-dc53-48fc-b9f7-d76df49d089a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ebd4501-ea3b-4d0a-b030-c616326bcd08
          stepCounter: 4921e58e-474b-4c0c-b05e-0b9d99600c0c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEFORCEREBATEDUE_ADDKEYS.SUPPLIERID=SUPPLIER.SUPPLIERID
        name: SUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a40ebd06-9c3a-4233-866a-175d204e1e97
                stepCounter: d1900eab-6bfb-4275-9540-868877d9163b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c10340c-0ac0-421d-a56e-5d844ed04af4
          stepCounter: 4921e58e-474b-4c0c-b05e-0b9d99600c0c
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: CONTRACT ID
        name: CONTRACTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 46bb0a78-50a8-4de8-9690-90124184c8d0
                stepCounter: 79c07c7c-dc53-48fc-b9f7-d76df49d089a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 161dd68d-6499-485d-822f-327eb1bf1a91
          stepCounter: 4921e58e-474b-4c0c-b05e-0b9d99600c0c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEFORCEREBATEDUE_ADDKEYS.CONTRACTSALESFORCEID=CONTRACT.CONTRACTSALESFORCEID
        name: CONTRACTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2695753d-6f1a-4e8d-9172-3bccc50d7c6a
                stepCounter: 84116e71-ebf6-4262-b818-71628fbd5079
            transform: COALESCE(CONTRACT.CONTRACTKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48b980ec-09a1-4f2c-a4a6-8694269438f7
          stepCounter: 4921e58e-474b-4c0c-b05e-0b9d99600c0c
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: FORCE ID
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3635ea8d-a29e-4b8c-9e1c-ba8fc39f1f9d
                stepCounter: 79c07c7c-dc53-48fc-b9f7-d76df49d089a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e4cc0fe4-87db-400b-b4e8-a9035cc1e85e
          stepCounter: 4921e58e-474b-4c0c-b05e-0b9d99600c0c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEFORCEREBATEDUE_ADDKEYS.FORCEID=ACCOUNT.FORCEID
        name: ACCOUNTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b17fba0-9db5-4ba8-9eeb-d24027f151eb
                stepCounter: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5e20eb0-56d6-44b9-bb89-d289bea037c2
          stepCounter: 4921e58e-474b-4c0c-b05e-0b9d99600c0c
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: CHECK ID
        name: CHECK_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cde297be-1bc0-4bb2-9a0c-2015d2edd8ed
                stepCounter: 79c07c7c-dc53-48fc-b9f7-d76df49d089a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af636f0e-07d1-400b-a162-5a4bccec515a
          stepCounter: 4921e58e-474b-4c0c-b05e-0b9d99600c0c
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: MEMBER CODE
        name: MEMBER_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0413e009-4f6f-44e3-a20c-05a710836801
                stepCounter: 79c07c7c-dc53-48fc-b9f7-d76df49d089a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97655632-19ea-4a45-bfc6-f108f89bd6d3
          stepCounter: 4921e58e-474b-4c0c-b05e-0b9d99600c0c
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: CYCLE START DATE
        name: CYCLE_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2d8df0f-f2d9-4b06-b520-93f1465ef23d
                stepCounter: 79c07c7c-dc53-48fc-b9f7-d76df49d089a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b906bfc3-2c39-4295-80f3-4aa6ea9918dc
          stepCounter: 4921e58e-474b-4c0c-b05e-0b9d99600c0c
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: CYCLE END DATE
        name: CYCLE_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e0b7d23c-e5f2-4278-857e-7ae6c5225173
                stepCounter: 79c07c7c-dc53-48fc-b9f7-d76df49d089a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 094d0777-6452-4e42-82ea-d6a451e3cd3a
          stepCounter: 4921e58e-474b-4c0c-b05e-0b9d99600c0c
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: CYCLE
        name: CYCLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d97b750-78ad-4557-8d61-65a230f4075c
                stepCounter: 79c07c7c-dc53-48fc-b9f7-d76df49d089a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 883ef692-9c43-4078-8076-9556c21982f7
          stepCounter: 4921e58e-474b-4c0c-b05e-0b9d99600c0c
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: TOTAL SALES
        name: TOTAL_SALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f8aa2f8-4f07-4991-bda8-9ac98c3309d3
                stepCounter: 79c07c7c-dc53-48fc-b9f7-d76df49d089a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a08bb370-fc60-47d6-8943-59222131e0ac
          stepCounter: 4921e58e-474b-4c0c-b05e-0b9d99600c0c
        config: {}
        dataType: NUMBER(18,4)
        defaultValue: ""
        description: BASELINE ALLOCATION
        name: BASELINE_ALLOCATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b0947e79-31b1-4139-a4ab-5c4c56f4cdd3
                stepCounter: 79c07c7c-dc53-48fc-b9f7-d76df49d089a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39f78b80-ef9f-4747-9912-a93cfbc84497
          stepCounter: 4921e58e-474b-4c0c-b05e-0b9d99600c0c
        config: {}
        dataType: NUMBER(18,4)
        defaultValue: ""
        description: ELIGIBLE SPEND
        name: ELIGIBLE_SPEND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5de2aa46-a62e-4053-9cd5-9152484d7b2a
                stepCounter: 79c07c7c-dc53-48fc-b9f7-d76df49d089a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 93454134-1394-4a2a-84c5-d7c039da5da3
          stepCounter: 4921e58e-474b-4c0c-b05e-0b9d99600c0c
        config: {}
        dataType: NUMBER(18,4)
        defaultValue: ""
        description: REBATE TIER
        name: REBATE_TIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07699c26-2ed0-4eec-80e9-4f4193c01d18
                stepCounter: 79c07c7c-dc53-48fc-b9f7-d76df49d089a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 913672d9-e17f-4179-9083-199233042aff
          stepCounter: 4921e58e-474b-4c0c-b05e-0b9d99600c0c
        config: {}
        dataType: NUMBER(38,4)
        defaultValue: ""
        description: REBATE DUE
        name: REBATE_DUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f40aa94a-c7ad-40dd-87fb-12fbcaa05aa4
                stepCounter: 79c07c7c-dc53-48fc-b9f7-d76df49d089a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a2193c8-bddd-4c76-bd45-a8d7606de611
          stepCounter: 4921e58e-474b-4c0c-b05e-0b9d99600c0c
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: PAYOUT YEAR
        name: PAYOUT_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eab9c452-26b2-4eb6-af43-320b111b8a65
                stepCounter: 79c07c7c-dc53-48fc-b9f7-d76df49d089a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b9c000b2-6fb5-4c5d-88e4-2acfb0b45123
          stepCounter: 4921e58e-474b-4c0c-b05e-0b9d99600c0c
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: PAYOUT PERIOD
        name: PAYOUT_PERIOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 25c8e003-3a4f-4ca6-ba39-ef0c3bf569e9
                stepCounter: 79c07c7c-dc53-48fc-b9f7-d76df49d089a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2323708-6282-4f89-aed4-135f1ee3e6f0
          stepCounter: 4921e58e-474b-4c0c-b05e-0b9d99600c0c
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: IS POSTPONE
        name: IS_POSTPONE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 63cabe29-83fd-4944-bf7a-3ae7d35c0e4b
                stepCounter: 79c07c7c-dc53-48fc-b9f7-d76df49d089a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77c9abac-8cd4-4a0c-b7bf-b47b3214b7ac
          stepCounter: 4921e58e-474b-4c0c-b05e-0b9d99600c0c
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: IS ARCHIVED
        name: IS_ARCHIVED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c396a3c2-38a8-468a-a698-bdf82042cf6d
                stepCounter: 79c07c7c-dc53-48fc-b9f7-d76df49d089a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 395776ba-6051-477e-b319-6a23a2fcdfab
          stepCounter: 4921e58e-474b-4c0c-b05e-0b9d99600c0c
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 74676446-2103-493f-b048-4461019da890
                stepCounter: 79c07c7c-dc53-48fc-b9f7-d76df49d089a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c44dd025-c422-4e9a-ac44-ca2f9fa9add8
          stepCounter: 4921e58e-474b-4c0c-b05e-0b9d99600c0c
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DSS LOAD DATE
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c0c0a39e-47a2-42fa-b144-c3eec50a29d7
                stepCounter: 79c07c7c-dc53-48fc-b9f7-d76df49d089a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0bf643d2-b77f-4e8d-b3f0-96d42e2da89a
          stepCounter: 4921e58e-474b-4c0c-b05e-0b9d99600c0c
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2161f60b-ada2-49ef-a3e1-acd2fe2eb736
          stepCounter: 4921e58e-474b-4c0c-b05e-0b9d99600c0c
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_FORCEREBATEDUE_1: 79c07c7c-dc53-48fc-b9f7-d76df49d089a
          CONTRACT: 84116e71-ebf6-4262-b818-71628fbd5079
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: DIM
            nodeName: CONTRACT
          - locationName: DIM
            nodeName: FORCEREBATEDUEDETAIL
          - locationName: DIM
            nodeName: SUPPLIER
          - locationName: STAGE
            nodeName: STAGE_FORCEREBATEDUE_1
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','STAGE_FORCEREBATEDUE_1') }} STAGE_FORCEREBATEDUE_1
              LEFT JOIN {{ ref('DIM','CONTRACT') }} CONTRACT
                ON STAGE_FORCEREBATEDUE_1.CONTRACTID = CONTRACT.CONTRACTID
        name: STAGEFORCEREBATEDUE_ADDKEYS
        noLinkRefs: []
  name: STAGE_FORCEREBATEDUE_ADDKEYS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
