fileVersion: 1
id: 45adfa7e-ab93-4e9c-94bd-97dd26237978
name: S_LKP_MERCHANT_TYPE_MROC_HISTORY
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DATAVAULT_BUSINESS_VAULT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 10e4a521-6ac4-44c8-8348-875c5a4fbfaa
          stepCounter: 45adfa7e-ab93-4e9c-94bd-97dd26237978
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: ""
        name: HK_H_LKP_MERCHANT_TYPE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27965cc1-fc59-47ac-b9fc-dafa09a33b8d
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ff466fa-0c24-4f81-a15c-3e7a449ea7fa
          stepCounter: 45adfa7e-ab93-4e9c-94bd-97dd26237978
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: MHT_TYP_CDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 319cada3-4e6a-4c8c-99fa-6c87acc6455a
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d10cf05-4450-42f1-ab5e-e4469edecaf9
          stepCounter: 45adfa7e-ab93-4e9c-94bd-97dd26237978
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: FILLER_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b149f1ed-6865-4402-ac54-4ca05be8045b
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2af4b27e-c800-4486-92a9-45cfff3d0b79
          stepCounter: 45adfa7e-ab93-4e9c-94bd-97dd26237978
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: ITN_IDN_CDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7bb0ef5c-d8b0-4636-a246-bda4453e2d1b
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27997f16-7e86-4081-8a15-918bb98145ba
          stepCounter: 45adfa7e-ab93-4e9c-94bd-97dd26237978
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MHT_TYP_TXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 874d13be-8ed0-4879-99d1-ec3882a7746e
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2b16e3e-96d6-402d-ade9-551c2d459e0c
          stepCounter: 45adfa7e-ab93-4e9c-94bd-97dd26237978
        config: {}
        dataType: DECIMAL(38,5)
        defaultValue: ""
        description: ""
        name: MHT_TYP_PCT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 078a7edd-785d-43d6-9257-80b53a724225
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f8211cc-1a06-4e42-a48c-9fa1e466fee5
          stepCounter: 45adfa7e-ab93-4e9c-94bd-97dd26237978
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: LST_UPD_DTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2a3cf49-3a6a-41dd-b329-a758ea7a269d
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07bc132b-3fee-443b-ac01-77e8e83b26d1
          stepCounter: 45adfa7e-ab93-4e9c-94bd-97dd26237978
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: LST_UPD_TME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1efc8e5b-91f0-4451-9c30-94027e46c87b
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f05fb53f-f6ea-4340-9824-15229ef959ac
          stepCounter: 45adfa7e-ab93-4e9c-94bd-97dd26237978
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: LST_UPD_UID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75775e43-c75d-4653-9192-16cb9a69d3f1
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1f06194-27fc-4923-8625-d88333ec6d73
          stepCounter: 45adfa7e-ab93-4e9c-94bd-97dd26237978
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: LST_UPD_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8fc4698-4532-421a-a94a-b63a10e91b15
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0a5a560-fa5e-436d-9e7f-7c6f4e8756d3
          stepCounter: 45adfa7e-ab93-4e9c-94bd-97dd26237978
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CREATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 26f9eff9-5d94-46a6-a498-2ea5c3dcf2a5
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f87b9cc-fbcd-4668-b9d2-b5c4dca8919c
          stepCounter: 45adfa7e-ab93-4e9c-94bd-97dd26237978
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: CREATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 31f54668-5532-4745-b691-218f44952699
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 850f37df-d198-4ee7-ba48-b269cfab3d14
          stepCounter: 45adfa7e-ab93-4e9c-94bd-97dd26237978
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: UPDATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24e41c45-2035-437c-9ffc-82c64126657c
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 90db80b5-6539-4684-ab1f-ebb533d7d1b8
          stepCounter: 45adfa7e-ab93-4e9c-94bd-97dd26237978
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: UPDATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f3b357c9-33ca-47c9-a47e-44222d2d4e99
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f3f5895f-f49b-4b47-a611-80c1c7824fd8
          stepCounter: 45adfa7e-ab93-4e9c-94bd-97dd26237978
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: RUN_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fee38e08-96b7-4169-a227-9428f2bd721b
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 308d329e-8916-4928-9f1d-5d39378c51c4
          stepCounter: 45adfa7e-ab93-4e9c-94bd-97dd26237978
        config: {}
        dataType: TIMESTAMP_NTZ(3)
        defaultValue: ""
        description: ""
        name: FILE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8bc8ca58-60dd-403b-8765-221943ad48f1
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 783826ea-f2b1-4afa-b56b-0584d702ba35
          stepCounter: 45adfa7e-ab93-4e9c-94bd-97dd26237978
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: The changing hash
        name: DSS_CHANGE_HASH
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 633226d4-289b-4816-87c1-e2522def8724
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc75c29d-973b-443b-9dfa-f8ece9c813b7
          stepCounter: 45adfa7e-ab93-4e9c-94bd-97dd26237978
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Record source
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d1f9a7c-07f5-48b3-885f-e280e3008ed3
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 63e927b6-98c7-4a18-9e15-fb6787539b68
          stepCounter: 45adfa7e-ab93-4e9c-94bd-97dd26237978
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was loaded in the data vault
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91e3e287-b0ef-4ad1-9b0f-c4a9b4ca67c6
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34c4816b-e26a-49dd-a69c-81c0faedafa7
          stepCounter: 45adfa7e-ab93-4e9c-94bd-97dd26237978
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row started in the data vault
        isSystemStartDate: true
        name: DSS_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b555310f-a945-48f6-8b86-6b1f7b1019a5
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39af50c2-f58d-40a4-8cd2-c387b12aa02c
          stepCounter: 45adfa7e-ab93-4e9c-94bd-97dd26237978
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: Version number of a business key in the data vault
        isSurrogateKey: true
        isSystemVersion: true
        name: DSS_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00d585e5-dd13-44d0-b724-47c9f461a09d
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96586080-b910-45f5-a7e3-a2e078ab92c9
          stepCounter: 45adfa7e-ab93-4e9c-94bd-97dd26237978
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was inserted in the data vault
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b942857-e662-42f1-ae84-20c0b8d78f06
                stepCounter: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f0ee094-8d34-4da7-8f14-f0ad2ecdd162
          stepCounter: 45adfa7e-ab93-4e9c-94bd-97dd26237978
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: End date determined by the next Satellite change record dss_start_date
        isSystemEndDate: true
        name: DSS_END_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: LEAD(dss_start_date, 1, '9999-12-31') OVER(PARTITION BY hk_h_lkp_merchant_type ORDER BY dss_start_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5339917-1878-4240-be0e-f883962808a7
          stepCounter: 45adfa7e-ab93-4e9c-94bd-97dd26237978
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: CurrentFlag 'N' unless next Satellite change record dss_start_date is null, indicating this is the most current record.
        isSurrogateKey: true
        isSystemCurrentFlag: true
        name: DSS_CURRENT_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN LEAD(dss_start_date, 1, NULL) OVER(PARTITION BY hk_h_lkp_merchant_type ORDER BY dss_start_date) IS NULL THEN 'Y'
                          ELSE 'N'
                           END
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_LKP_MERCHANT_TYPE_MROC: ddf4feb1-e5eb-4b3b-b2e8-6ba0371442fb
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATAVAULT_RAW_VAULT
            nodeName: S_LKP_MERCHANT_TYPE_MROC
        join:
          joinCondition: FROM {{ ref('DATAVAULT_RAW_VAULT','S_LKP_MERCHANT_TYPE_MROC') }} s_lkp_merchant_type_mroc
        name: S_LKP_MERCHANT_TYPE_MROC_HISTORY
        noLinkRefs: []
  name: S_LKP_MERCHANT_TYPE_MROC_HISTORY
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
