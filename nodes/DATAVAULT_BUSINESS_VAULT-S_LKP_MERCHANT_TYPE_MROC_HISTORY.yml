fileVersion: 1
id: fbac73ce-98e4-4a1e-a9c3-03bba1340308
name: S_LKP_MERCHANT_TYPE_MROC_HISTORY
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DATAVAULT_BUSINESS_VAULT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14fdab39-733f-4fac-9d59-a734efd74b74
          stepCounter: fbac73ce-98e4-4a1e-a9c3-03bba1340308
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: ""
        name: HK_H_LKP_MERCHANT_TYPE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9437e4e3-c236-4a3d-bc78-d1bbb2020cc3
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a272b2e6-bee6-4bfa-88c2-12b383cb4c73
          stepCounter: fbac73ce-98e4-4a1e-a9c3-03bba1340308
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: MHT_TYP_CDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fbc80e68-aaa5-4b0a-b3fc-0f6acaba8e14
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d307092d-983f-450f-8ef0-167ec03c12b2
          stepCounter: fbac73ce-98e4-4a1e-a9c3-03bba1340308
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: FILLER_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e26e3a6-59cc-417a-8bc0-79b1ac22b652
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0422b3b6-b38d-4830-8181-ed5502739c12
          stepCounter: fbac73ce-98e4-4a1e-a9c3-03bba1340308
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: ITN_IDN_CDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 06aeb87d-ac4b-4098-a24d-cb1f3e1f264f
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c00d913d-f8d0-4c84-a977-b0d8719a7f08
          stepCounter: fbac73ce-98e4-4a1e-a9c3-03bba1340308
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MHT_TYP_TXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0efa7430-3a90-4636-9870-eddf21a883e6
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f169549-854b-47d8-872d-a542e14b42ab
          stepCounter: fbac73ce-98e4-4a1e-a9c3-03bba1340308
        config: {}
        dataType: DECIMAL(38,5)
        defaultValue: ""
        description: ""
        name: MHT_TYP_PCT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 815bf2f4-82ea-4229-aefe-1adf3749d538
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 997c3b39-41cd-42ee-a758-9f8057aa7bd8
          stepCounter: fbac73ce-98e4-4a1e-a9c3-03bba1340308
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: LST_UPD_DTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe4598c7-a10f-4207-b2b2-f42c05cc1229
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c96fd3e-0d1f-4ea8-b166-40678600a117
          stepCounter: fbac73ce-98e4-4a1e-a9c3-03bba1340308
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: LST_UPD_TME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2abb6230-ce9a-4431-a580-1bdf726825c3
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 52cf8a2b-6592-4235-b653-a8bff2421428
          stepCounter: fbac73ce-98e4-4a1e-a9c3-03bba1340308
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: LST_UPD_UID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2fde18a-d9fb-4050-8197-6ffcc6003934
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cab3bdfd-f1e3-45fe-8c7d-7c9fb1969470
          stepCounter: fbac73ce-98e4-4a1e-a9c3-03bba1340308
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: LST_UPD_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2185a5e9-ae8e-4d12-a605-e78fb887d30c
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 905832c5-37c5-4b23-bdc3-ff773d811679
          stepCounter: fbac73ce-98e4-4a1e-a9c3-03bba1340308
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CREATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8153b267-1813-412b-a1e0-9be409931e77
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 08ca8e4e-42d8-45b7-b21f-db791c1951e9
          stepCounter: fbac73ce-98e4-4a1e-a9c3-03bba1340308
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: CREATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e393b6f6-22da-4194-8eb9-bb339817b63d
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e13c9605-8fd1-457f-a7f4-261a8ed72474
          stepCounter: fbac73ce-98e4-4a1e-a9c3-03bba1340308
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: UPDATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7589fdd-ccc9-4d52-86c7-c3a6ba51b057
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92e2a83e-b791-4505-924c-ca896a58e252
          stepCounter: fbac73ce-98e4-4a1e-a9c3-03bba1340308
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: UPDATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d3f5e77-dd45-4efc-8d1c-7159db7c219d
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 042af654-5480-496a-bb87-79aedbbfcc97
          stepCounter: fbac73ce-98e4-4a1e-a9c3-03bba1340308
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: RUN_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d250fe0-08fa-41a9-a52a-8a9f1b398fcc
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad63d1b9-62e6-4cf4-853d-39bcf37d5acb
          stepCounter: fbac73ce-98e4-4a1e-a9c3-03bba1340308
        config: {}
        dataType: TIMESTAMP_NTZ(3)
        defaultValue: ""
        description: ""
        name: FILE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0527d016-459e-4f4d-b367-3c559def04e6
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50bd80f2-6e6a-43a0-ae00-d361ade59fc9
          stepCounter: fbac73ce-98e4-4a1e-a9c3-03bba1340308
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: The changing hash
        name: DSS_CHANGE_HASH
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 54436a45-56ce-4cb4-a732-08f9fb6a4032
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 775752b4-4bf5-4150-a528-0afba0189068
          stepCounter: fbac73ce-98e4-4a1e-a9c3-03bba1340308
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Record source
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed77a035-4897-4936-af34-d1b604d007c9
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 739d2be1-0835-41aa-b4a9-f8075b1cbb09
          stepCounter: fbac73ce-98e4-4a1e-a9c3-03bba1340308
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was loaded in the data vault
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7eb92407-5a5c-419d-b9c9-dd0b2721dc0c
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0be8ad4-9cfd-48f8-af5b-7d2291b75b6a
          stepCounter: fbac73ce-98e4-4a1e-a9c3-03bba1340308
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row started in the data vault
        isSystemStartDate: true
        name: DSS_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 709b25d4-b463-4703-8294-7674116dcd24
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c3787f6-9f9e-46dc-8cb3-a3d21b482220
          stepCounter: fbac73ce-98e4-4a1e-a9c3-03bba1340308
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: Version number of a business key in the data vault
        isSurrogateKey: true
        isSystemVersion: true
        name: DSS_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5bb82f94-0cd0-44a0-bbba-d839d811bf21
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 76bfd4a8-c384-459f-b697-e9cec4dced87
          stepCounter: fbac73ce-98e4-4a1e-a9c3-03bba1340308
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was inserted in the data vault
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a69abeca-8fb9-496d-9315-6e1eb03ada7d
                stepCounter: 82c4ea10-525f-488c-8e17-c95a9da869c3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53ac6b8c-28b0-4efb-bbc7-96e283a42881
          stepCounter: fbac73ce-98e4-4a1e-a9c3-03bba1340308
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: End date determined by the next Satellite change record dss_start_date
        isSystemEndDate: true
        name: DSS_END_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: LEAD(dss_start_date, 1, '9999-12-31') OVER(PARTITION BY hk_h_lkp_merchant_type ORDER BY dss_start_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df4ac0d3-5b06-4933-a612-efba11f4a274
          stepCounter: fbac73ce-98e4-4a1e-a9c3-03bba1340308
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: CurrentFlag 'N' unless next Satellite change record dss_start_date is null, indicating this is the most current record.
        isSurrogateKey: true
        isSystemCurrentFlag: true
        name: DSS_CURRENT_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN LEAD(dss_start_date, 1, NULL) OVER(PARTITION BY hk_h_lkp_merchant_type ORDER BY dss_start_date) IS NULL THEN 'Y'
                          ELSE 'N'
                           END
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_LKP_MERCHANT_TYPE_MROC: 82c4ea10-525f-488c-8e17-c95a9da869c3
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATAVAULT_RAW_VAULT
            nodeName: S_LKP_MERCHANT_TYPE_MROC
        join:
          joinCondition: FROM {{ ref('DATAVAULT_RAW_VAULT','S_LKP_MERCHANT_TYPE_MROC') }} s_lkp_merchant_type_mroc
        name: S_LKP_MERCHANT_TYPE_MROC_HISTORY
        noLinkRefs: []
  name: S_LKP_MERCHANT_TYPE_MROC_HISTORY
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
