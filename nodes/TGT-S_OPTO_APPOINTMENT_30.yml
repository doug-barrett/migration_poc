fileVersion: 1
id: 7bec7ba6-28a1-4518-939f-77e871a44661
name: S_OPTO_APPOINTMENT_30
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c6bfbe4-ac55-428d-9a6a-82fe055ed563
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: APPOINTMENT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a18b53f4-20b7-4de6-a38e-eeb7a389cd7c
                stepCounter: 94cbbab6-97f8-450d-96bd-f542553b35e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b5f6f5ac-08cf-4942-bec9-29c11225db26
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CLINIC_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2e48d20e-2eef-4c59-bd50-36b8784436c4
                stepCounter: 94cbbab6-97f8-450d-96bd-f542553b35e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 592483c6-b62d-4ecf-86cc-f448d1bcc49f
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: CLINICAL_LOCATION_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9852555b-455a-4870-96d5-cbacb6d66fdd
                stepCounter: 94cbbab6-97f8-450d-96bd-f542553b35e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0951ecbf-25dd-4676-917e-99b935ee8791
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: NVARCHAR(25)
        defaultValue: ""
        description: ""
        name: CLINICAL_LOCATION_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ef8e548-cac7-45cf-95dd-6e2247818f3d
                stepCounter: 94cbbab6-97f8-450d-96bd-f542553b35e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f1cd8ffc-fa14-4e08-bf9b-95f8ac95f0d6
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CLINIC_PLAN_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18d45b6e-3752-4a07-9534-1071403fdd59
                stepCounter: 94cbbab6-97f8-450d-96bd-f542553b35e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cfa476b2-5211-40f2-9f03-f8f50ad5d429
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: CLINIC_PLAN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 44c679d3-7435-4b07-aded-b61176cc6a38
                stepCounter: 94cbbab6-97f8-450d-96bd-f542553b35e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f670d9f-02ee-4ef8-bbcb-1ab6dcb9a90c
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: NVARCHAR(25)
        defaultValue: ""
        description: ""
        name: CLINIC_PLAN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 63cd5fd8-f2c5-4bbf-b41e-05b48d90f85e
                stepCounter: 94cbbab6-97f8-450d-96bd-f542553b35e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f1c6927-1e9f-42f9-9b48-1a54b2816179
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: NVARCHAR(250)
        defaultValue: ""
        description: ""
        name: CLINIC_PLAN_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de2cb8ab-cb90-4f08-9a2f-e29fa69e3bf2
                stepCounter: 94cbbab6-97f8-450d-96bd-f542553b35e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8a5b166-3485-4f21-a295-02771a4debf1
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f028e5bb-6816-4bb0-8c83-55063c95e830
                stepCounter: 94cbbab6-97f8-450d-96bd-f542553b35e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18ec3bf2-b3c7-4735-a1ab-8359753f166c
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: VARCHAR(14)
        defaultValue: ""
        description: ""
        name: SOURCE_ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3f245ba0-94ef-41e6-9cd0-49ad56642006
                stepCounter: 94cbbab6-97f8-450d-96bd-f542553b35e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d95225e7-911e-43fc-83a6-71927552a04e
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PATIENT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc7a1203-fb41-450c-aa6e-5ee6becb302e
                stepCounter: 94cbbab6-97f8-450d-96bd-f542553b35e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eee820a6-39c2-4b0d-8437-e32cb699081c
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: NVARCHAR(40)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c2ff906-6421-43d0-836b-ba68f734f95d
                stepCounter: 94cbbab6-97f8-450d-96bd-f542553b35e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 356c93ea-f7ab-4f64-af81-9f53fc405778
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: BIT
        defaultValue: ""
        description: ""
        name: DROP_IN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e256f995-528e-4410-8936-81ffe225f228
                stepCounter: 94cbbab6-97f8-450d-96bd-f542553b35e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d17b56d-df02-4c3f-80f6-2266421cb971
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 36cf1c36-2d90-4fbf-9373-d65ffdaf8dfe
                stepCounter: 94cbbab6-97f8-450d-96bd-f542553b35e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b80f852a-31dd-408c-9d60-248ad51f36dc
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: NVARCHAR(100)
        defaultValue: ""
        description: ""
        name: DOMICILE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ea91f10-9ff2-4711-8c4d-bf419998a872
                stepCounter: 94cbbab6-97f8-450d-96bd-f542553b35e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: baf895ac-adff-49c1-a927-bc38405f1b88
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8783f6c2-417b-4fe7-8e67-7deb004c55bb
                stepCounter: 94cbbab6-97f8-450d-96bd-f542553b35e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c1f3adb-c536-44e5-bd26-c7034db8f1fc
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: NVARCHAR(MAX)
        defaultValue: ""
        description: ""
        name: NOTES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 69984a61-abac-4ab7-b103-9754e41327d2
                stepCounter: 94cbbab6-97f8-450d-96bd-f542553b35e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e7ef5d2-b493-40cc-932a-cfd7670cb75a
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CLINICAL_LOCATION_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c83ec62-33af-4887-91eb-709893b6c326
                stepCounter: 94cbbab6-97f8-450d-96bd-f542553b35e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 51e07b5e-7f3c-409e-bf0e-666c295e4c57
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: VALID_FROM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84a7215c-f0c2-4a6d-934c-4c932fb99a96
                stepCounter: 94cbbab6-97f8-450d-96bd-f542553b35e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05747fc9-b155-411d-847f-a66002a92812
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: ENCOUNTER_PROCEDURE_DESCR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 95d26b49-cacc-4ce3-b3da-8fa83ac5562a
                stepCounter: 94cbbab6-97f8-450d-96bd-f542553b35e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64808340-d39d-4ec6-8993-9875e52f8a34
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ENCOUNTER_PROCEDURE_CODES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7fa78727-556b-4cc9-a8e9-4b93d17dfa99
                stepCounter: 94cbbab6-97f8-450d-96bd-f542553b35e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 36cd4cd2-c05b-447e-bb7e-f1892569f65d
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: RETINAL_SCREENING_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4220be6-c8a1-4bf1-9d47-1bc2e68b98f7
                stepCounter: 94cbbab6-97f8-450d-96bd-f542553b35e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4fae08d4-3c06-4e90-892a-3602806e820c
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: ""
        name: HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c8cd5fa7-fd97-4fbe-814a-b3ca76ad05a0
                stepCounter: 94cbbab6-97f8-450d-96bd-f542553b35e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed11dd7f-3933-47d2-9891-f6e9b6d5c8f1
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9ca64052-e775-4886-bcaf-209a71bdf0f6
                stepCounter: 94cbbab6-97f8-450d-96bd-f542553b35e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c2f33a3-90bf-4e22-95d4-0c0288795190
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: VALID_TO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3137ce21-ef97-4cdb-b59f-96f5872b38d6
                stepCounter: 94cbbab6-97f8-450d-96bd-f542553b35e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c3cdcc0-1798-40c9-80db-443cdf1382bb
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CANCELATION_REASON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9b0dab1d-751e-4b42-a602-2b66e0f61de1
                stepCounter: 94cbbab6-97f8-450d-96bd-f542553b35e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5e0bdd9-b18f-4a26-ad3f-82689b0c42ee
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: CANCELATION_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9b0dab1d-751e-4b42-a602-2b66e0f61de1
                stepCounter: 94cbbab6-97f8-450d-96bd-f542553b35e9
            transform: |-
              CASE WHEN s_opto_appointment_20.cancelation_reason = 0 THEN 'N'
                          ELSE 'Y'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee2fbfe8-c676-4e5c-ada7-3c5b0de4d92b
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: CANCELATION_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9b0dab1d-751e-4b42-a602-2b66e0f61de1
                stepCounter: 94cbbab6-97f8-450d-96bd-f542553b35e9
            transform: |-
              CASE WHEN s_opto_appointment_20.cancelation_reason = 0 THEN 0
                          ELSE 1
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39354de6-019f-4015-b4f4-0eecee2e172d
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: APPOINTMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '1'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 10d35527-7ee7-4664-832c-3f814e4ef30f
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CANCELATION_CLINICIAN_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de535d84-907b-4fe9-8c4f-aa819f1bbe1b
                stepCounter: 94cbbab6-97f8-450d-96bd-f542553b35e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f44aded-96af-4768-8826-211b90e27e16
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: CHAR(36)
        defaultValue: ""
        description: ""
        name: UNIQUE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91777542-51c7-425e-b792-a62d314c97f4
                stepCounter: 94cbbab6-97f8-450d-96bd-f542553b35e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80e5f7af-f3a8-4f72-9427-c72e9e4901f6
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CLINIC_LOG_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b964a608-61e5-44df-83ac-80dac91759dd
                stepCounter: 94cbbab6-97f8-450d-96bd-f542553b35e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20e32381-a7c3-41b4-94dd-27a20c8b0763
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CLINICIAN_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f2449e31-a26a-4073-9771-f3bf84127e77
                stepCounter: 94cbbab6-97f8-450d-96bd-f542553b35e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de2bf0a3-22ed-4562-959c-ef74acbca066
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_VOLUME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 63277c17-8e35-4c89-be05-4bffb54ee20d
                stepCounter: 94cbbab6-97f8-450d-96bd-f542553b35e9
            transform: |-
              CASE WHEN dim_opto_clinic.Waitemata_DHB_funded_flag = 'Y' THEN s_opto_appointment_20.purchase_unit_volume
                          ELSE 0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d08b1ef-a618-4963-b69c-0af089a7c21b
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: BIT
        defaultValue: ""
        description: ""
        name: DID_NOT_ATTEND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef297d0b-9390-4636-af39-47830f16c6de
                stepCounter: 94cbbab6-97f8-450d-96bd-f542553b35e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 354e0272-b277-410a-9806-147d9f985015
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: VISIT_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 258b2365-d204-4f99-a0fa-87b052d1a0a6
                stepCounter: 94cbbab6-97f8-450d-96bd-f542553b35e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b802c05-55fe-4cf8-9965-f8041727b78f
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ENCOUNTER_TYPE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 54d5fe6d-6575-4705-894c-36527eb3b30a
                stepCounter: 94cbbab6-97f8-450d-96bd-f542553b35e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72a61ab2-559c-4148-9784-abeb3aae2108
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_opto_appointment_30.purchase_unit_code=dim_purchase_unit.purchase_unit_code
        name: DIM_PURCHASE_UNIT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d9c041f-76d6-44c7-8d88-936673dfd7a0
                stepCounter: d198650d-0f77-489d-92ec-0c0257cd5a43
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c33ac178-a12c-4e05-a34a-11fbd4c0987c
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated key for the date dimension. Nominal format is YYYYMMDD, but DD equal to 0 and greater than 31 permited for special date handling.
        name: DIM_APPOINTMENT_START_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7cb7c9c4-768a-46a1-a11a-29d725817353
                stepCounter: ad7d8a1b-35cc-4bd6-82bd-746d2f756dd1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69bc2352-4313-4291-8ec6-bf93f440c410
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated key for the date dimension. Nominal format is YYYYMMDD, but DD equal to 0 and greater than 31 permited for special date handling.
        name: DIM_APPOINTMENT_END_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1990e766-fffc-4709-b61a-0f4fe9935e7f
                stepCounter: c2006bac-85b8-4e18-8bba-5e00f958739e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e4354ff4-0052-49bd-a0be-04b15543cf9d
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_opto_appointment_30.clinician_id=dim_opto_clinician.clinician_id
        name: DIM_OPTO_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 96907c23-a9b3-4cf6-8fff-68341bcf5e5a
                stepCounter: 12ae5165-0f59-4c57-97bb-2fcaaf94baa8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 045fbfb7-f7bf-4b25-85e0-9f149e7987b6
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_opto_appointment_30.patient_id=dim_opto_patient.patient_id
        name: DIM_OPTO_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eb17b158-9495-46e9-bead-d77e96e21d26
                stepCounter: 7c7954d2-24cc-478d-99e0-03985ea2a42e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a5fbcea-daba-43c7-a13b-0f20ab3d8eb4
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_opto_appointment_30.clinic_id=dim_opto_clinic.clinic_id
        name: DIM_OPTO_CLINIC_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 99d24768-fc1a-4168-b1c9-6ecf7a6e60b3
                stepCounter: 0af63ff1-036b-4dbe-8e87-2b229977de3e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a42fea21-0909-4dae-ab5d-6b43f419683c
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_opto_appointment_30.clinic_plan_id=dim_opto_clinic_plan.clinic_plan_id
        name: DIM_OPTO_CLINIC_PLAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e496fc9-3d55-4d95-8e0a-7fb4c3a6079d
                stepCounter: 5e95e590-ca93-4cca-98ae-d613f99fc6f3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b2f9b5c6-6104-47ff-a16c-ee3fe9200f83
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_opto_appointment_30.domicile_code=dim_domicile.domicile_code
        name: DIM_DOMICILE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e049fc8-a2a3-4bad-9b91-11b9d158b35e
                stepCounter: 330ad0aa-b8b1-4da9-ab37-b4fe8f889452
            transform: IFNULL(dim_domicile.dim_domicile_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d384d339-a510-4322-b9e8-852e1154d63c
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: START_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9ee3fe7c-764b-4cce-ae46-ce74bc5ae1a4
                stepCounter: 94cbbab6-97f8-450d-96bd-f542553b35e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 613df01e-d595-42a8-b1e1-773dc2cc8697
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: END_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7ff84ed-ea3b-4cdf-8b4f-3ed65010b684
                stepCounter: 94cbbab6-97f8-450d-96bd-f542553b35e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5bd3f1c-ba94-4e00-91cf-bfe61471e279
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Record source.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05a7723a-124e-409a-9756-69e5ea451e62
                stepCounter: 94cbbab6-97f8-450d-96bd-f542553b35e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f04af26-cceb-4481-9536-611098c00ffb
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Load date.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 182c5b5a-9aef-4145-93bf-dccce9b670f2
                stepCounter: 94cbbab6-97f8-450d-96bd-f542553b35e9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47a18d24-4e78-459c-ac74-b2adeee6d675
          stepCounter: 7bec7ba6-28a1-4518-939f-77e871a44661
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_OPTO_APPOINTMENT_20: 94cbbab6-97f8-450d-96bd-f542553b35e9
          DIM_APPOINTMENT_START_DATE: ad7d8a1b-35cc-4bd6-82bd-746d2f756dd1
          DIM_APPOINTMENT_END_DATE: c2006bac-85b8-4e18-8bba-5e00f958739e
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_OPTO_APPOINTMENT_20
          - locationName: TGT
            nodeName: DIM_APPOINTMENT_START_DATE
          - locationName: TGT
            nodeName: DIM_APPOINTMENT_END_DATE
        join:
          joinCondition: |-
            FROM {{ ref('TGT','S_OPTO_APPOINTMENT_20') }} s_opto_appointment_20
              JOIN {{ ref('TGT','DIM_APPOINTMENT_START_DATE') }} dim_appointment_start_date
                ON cast(s_opto_appointment_20.start_time AS date) = dim_appointment_start_date.appointment_start_calendar_date
              JOIN {{ ref('TGT','DIM_APPOINTMENT_END_DATE') }} dim_appointment_end_date
                ON cast(s_opto_appointment_20.end_time AS date) = dim_appointment_end_date.appointment_end_calendar_date
        name: S_OPTO_APPOINTMENT_30
        noLinkRefs: []
  name: S_OPTO_APPOINTMENT_30
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
