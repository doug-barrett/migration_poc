fileVersion: 1
id: 6104fd09-e188-4650-aa1d-6147c28270af
name: S_OUTPATIENT_APPOINTMENT_30
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9dad94fc-1516-4888-b7d9-0b6999a1eb0c
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.outpatient_appointment_encounter_type_code=dim_encounter_type.encounter_type_code
        name: DIM_ENCOUNTER_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3ba8df3-db2e-40a1-97dc-d5ad6a5186a7
                stepCounter: 1d0ea6a1-9563-4fb3-a1fa-9d43dbdf296e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 839e7200-cd24-49c3-8564-a200c8e195c9
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.outpatient_clinic_reference_no=dim_outpatient_clinic.outpatient_clinic_reference_no
        name: DIM_OUTPATIENT_CLINIC_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 176fadfa-c91d-4de5-aab1-58cd30d5fa75
                stepCounter: 1b585f63-ec9f-4d7a-8eb1-03d74ede9200
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8f4b078-bae9-425a-b577-f6a3a4217a26
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: s_outpatient_appointment_30.outpatient_clinic_reference_no=dim_outpatient_clinic.outpatient_clinic_reference_no
        name: HOSPITAL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6dfc40b6-360c-4c04-b758-459f834f6460
                stepCounter: 1b585f63-ec9f-4d7a-8eb1-03d74ede9200
            transform: IFNULL(dim_outpatient_clinic.hospital_id,'1021')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 070d7883-12c3-4858-b36a-6f4b0126f8d0
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.outpatient_specialty_reference_no=dim_outpatient_specialty.outpatient_specialty_reference_no
        name: DIM_OUTPATIENT_SPECIALTY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de18ed27-b847-40b2-94b7-65d955244c46
                stepCounter: 076e340e-a7f4-4e99-900a-1223b8b9207b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 076c4d79-9960-435d-b5d6-fbe6733b0bb5
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTED_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6b4e8f0-af74-4d30-8447-d7fe2fac6736
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 061e14e4-f214-43c1-a30a-b94762df85cb
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.appointed_clinician_reference_no=dim_outpatient_clinician.outpatient_clinician_reference_no
        name: DIM_OUTPATIENT_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 864eacfd-8c2b-4b0d-8e4d-786080c362ca
                stepCounter: 86786504-bb42-4fb6-92f8-1b44903ceeab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aba6fb41-e646-4b75-acb8-4a9258219130
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4d67e67f-313c-40fe-be79-ea7ed39b105e
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b292149e-188f-4d65-8add-e122fbca737b
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.appointment_type_reference_no=dim_appointment_type.appointment_type_reference_no
        name: DIM_APPOINTMENT_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f814ecf-1426-4ce7-8bd3-bde6268a30c2
                stepCounter: 87332c85-0fe3-40f0-9f8c-3f4e3e4d7848
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b666d062-3e98-4603-a44d-8134c5c44370
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: APPOINTMENT_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b86fcee3-4d4c-4b86-a11a-f93252d68711
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dcef3162-4c60-4093-8c4f-327b667eb1ad
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9cbd498f-df14-404d-9224-6c9d13b938f7
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 62f34257-7600-4b42-895d-2addd125ec05
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: BOOKING_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cea30b27-117e-4a6e-88c6-3fd37ab915c4
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 44fa7534-7696-4c41-92d5-75f4459d4134
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_outpatient_appointment_30.booking_type_reference_no=dim_booking_type.booking_type_reference_no
        name: DIM_BOOKING_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed886d28-bd11-4c7d-a5fb-24beb3577eb5
                stepCounter: c5a2afef-0f79-4679-806a-4e561137467f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8bf3bd1-74da-4bb6-8a28-54d00f5c43a6
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.appointment_status_reference_no=dim_appointment_status.appointment_status_reference_no
        name: DIM_APPOINTMENT_STATUS_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ecb3cc5-60e2-4b31-a089-315c89441f2d
                stepCounter: 778b686c-1598-48ff-868e-b8fe6c396d26
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c838d7c5-aeeb-4ee8-bfb4-a06223275b9f
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: APPOINTMENT_REQUEST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ebb831a-590f-48e1-a6b0-ecba5dbd0e3b
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5e2ec05-a77c-44fd-83bf-19831e46a8ba
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ONLINE_BOOKING_REQUESTED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5638fce8-175d-434c-921b-fd0538998ae7
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 63028837-dacb-456d-8398-12656a1a644f
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: APPOINTMENT_CALLED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c36a36f0-4d0e-42b3-8df6-39771c13da5e
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc36e3d4-9c70-4195-96f3-73c9aab409c4
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: APPOINTMENT_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 96103c89-cd3d-4476-8727-b6a02af93a4f
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d22a3213-e114-4859-a315-231dc98a25fd
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_outpatient_appointment_30.CONVERT(date,s_outpatient_appointment_20.appointment_start_date)=dim_appointment_start_date.appointment_start_calendar_date
        name: DIM_APPOINTMENT_START_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7cb7c9c4-768a-46a1-a11a-29d725817353
                stepCounter: ad7d8a1b-35cc-4bd6-82bd-746d2f756dd1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0517376e-30b9-45eb-8a79-a9b4c6e26d9a
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_PLANNED_CARE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef1f72de-9847-4770-8eda-48e40fdb696b
                stepCounter: 2c51f4f9-57b5-4407-b99a-a74174e84fac
            transform: IFNULL(dim_planned_care.dim_planned_care_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e97ba31b-77a7-4015-931d-5b270ea13362
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: APPOINTMENT_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: abe38741-115f-43bd-bee6-b28da9fa9728
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4bc6d5c3-f828-482f-8d6a-e619ddcc77d7
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: FIRST_REFERRAL_APPOINTMENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a0a4f544-dd72-41c2-9d93-87ae7fd01789
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8bd1e118-acec-4efa-bf54-6854bf17f5da
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_outpatient_appointment_30.CONVERT(date,s_outpatient_appointment_20.appointment_end_date)=dim_appointment_end_date.appointment_end_calendar_date
        name: DIM_APPOINTMENT_END_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1990e766-fffc-4709-b61a-0f4fe9935e7f
                stepCounter: c2006bac-85b8-4e18-8bba-5e00f958739e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0038653b-d77d-478a-93ea-b890bf2ee6e0
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: APPOINTMENT_MOVEMENT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bdf4ca99-a099-4236-b30a-9c71dea9d79f
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 60dd7e1d-fcae-457a-9e3b-8efa8093bd21
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_MOVEMENT_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dbbb7ec8-ea14-4ef8-9045-9597ab52beed
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a756a70c-d0e6-4b25-8175-1b3fddf3521f
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_outpatient_appointment_30.appointment_movement_reason_reference_no=dim_appointment_movement_reason.appointment_movement_reason_reference_no
        name: DIM_APPOINTMENT_MOVEMENT_REASON_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 635fe132-f2d1-4893-8c15-ad0cf10d7ad4
                stepCounter: b0fd8735-7930-476f-a368-ae8745fe3a9f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6dec70c9-91b1-404b-9e71-158c2969bac6
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INT
        defaultValue: ""
        description: Number of times this appointment has been moved
        name: APPOINTMENT_RESCHEDULE_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e5a2ff0-a71b-4111-b25e-482fd8bb33b1
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48c8fb9e-efaf-4504-8f75-f0966f84461b
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INT
        defaultValue: ""
        description: staging field only to help identify mapping issues
        name: PUC_MAP_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 87b06b55-4860-4cf8-ae9a-c14a92c47272
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7469353-04ba-4e7a-aa5a-bd28bec2ce19
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.patient_reference_no=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9962a01b-5f3d-4c1a-b371-997edef38d0f
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd9bbb21-8793-4318-95c1-6b14823a56b6
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: Domilce code as at visit date
        name: DOMICILE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c37b2d68-606f-4c4a-862f-65eb918510ac
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5182950b-2f2e-42a3-8596-c7ae1edc0817
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_outpatient_appointment_30.domicile_code=dim_domicile.domicile_code
        name: DIM_DOMICILE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e049fc8-a2a3-4bad-9b91-11b9d158b35e
                stepCounter: 330ad0aa-b8b1-4da9-ab37-b4fe8f889452
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fccf19e7-5fd1-4022-8a77-65b394cc89c6
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.patient_age_on_arrival_years=dim_age_group.age_years
        name: DIM_AGE_GROUP_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18bfabd7-19aa-4de0-9ce7-aa560645bce6
                stepCounter: 3d5ba8a8-80ec-4848-b58a-d31b34cc53ed
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c603552-e56a-4a72-a382-635431c13472
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_outpatient_appointment_30.CONVERT(date,s_outpatient_appointment_20.patient_seen_by_date)=dim_seen_by_date.seen_by_calendar_date
        name: DIM_SEEN_BY_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 083b97e3-9e75-4d0c-b01a-311619a5d8a6
                stepCounter: 959a8424-358c-43e3-83ba-4de45f80a77d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed8a18bc-7dc3-4678-9861-758e27a9b58c
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: The aggregated encounter id that corresponds to the funded event. When outpatient events are captured during and inpatient event they are rolled up to the inpatient encounter ID
        name: FUNDED_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 97bfe012-0850-4bb0-9175-5ab613955e7a
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: IFNULL(s_outpatient_appointment_20.IP_event_encounter_id ,s_outpatient_appointment_20.outpatient_appointment_encounter_id)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e395aaf6-020a-4678-bd58-bdc728209266
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: IP_EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 97bfe012-0850-4bb0-9175-5ab613955e7a
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fbbfc151-5115-4e6d-8d03-4efcf657ead7
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.principal_diagnosis_reference_no=dim_principal_diagnosis.principal_diagnosis_code
        name: DIM_PRINCIPAL_DIAGNOSIS_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1a7261f-2942-445d-88b4-fe34e5a3929f
                stepCounter: 6a64703e-9924-4948-986a-0578fe6b91b7
            transform: IFNULL(dim_principal_diagnosis.dim_principal_diagnosis_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d798ba6-c60e-4d3b-96a3-65a3be3ae3fe
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.secondary_diagnosis_reference_no=dim_secondary_diagnosis.secondary_diagnosis_reference_no
        name: DIM_SECONDARY_DIAGNOSIS_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed90de64-64f5-4ddc-ab6e-14cc5e9b4533
                stepCounter: 31a9a8f9-23f2-4f6b-bbc7-e2690a085ae1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7bd166a-2647-4b65-aea7-9bd7b7f70fc6
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.primary_procedure_reference_no=dim_primary_procedure.primary_procedure_reference_no
        name: DIM_PRIMARY_PROCEDURE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5756eb56-6a5c-4b03-b00f-6e53804eefe3
                stepCounter: 638765c4-cd16-4698-94ab-d783623142c0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3adb69b3-9fd9-4dfd-9dfe-3237d0820509
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.secondary_procedure_reference_no=dim_secondary_procedure.secondary_procedure_reference_no
        name: DIM_SECONDARY_PROCEDURE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d615297-e4e3-4e49-9441-381382901dd6
                stepCounter: 62d35430-1000-41cb-8978-c7201741c5ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9ac3586-720f-4958-9972-03eaa19d0c95
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_OUTCOME_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 703b4e18-a3c1-4622-88ee-6384de87b3a5
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 62724d4e-2693-452e-8ec4-8a7fe65c2fe5
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.appointment_outcome_reference_no=dim_appointment_outcome.appointment_outcome_reference_no
        name: DIM_APPOINTMENT_OUTCOME_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f2ed12a-a7dd-443f-9f12-1d172c666f27
                stepCounter: e9327b80-105c-4386-ad85-a52a7ccf58f5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6342e9df-bcbf-4b8a-9613-d2c4c76035b0
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: appointment_status_type_code, "A=Actual", "P=Planned", "C=Cancelled"
        name: APPOINTMENT_STATUS_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d31d6957-10c0-4012-87a8-57aac0072ba3
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f5f2f67-b0d0-4129-b1d2-d33e692456c5
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: appointment_contact_status_code, "A=Actual", "P=Planned", "C=Cancelled"
        name: APPOINTMENT_CONTACT_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9209a2f3-cfef-4238-8b0e-b788f2e977b0
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 666f926e-fde2-468d-b80f-c294a46b0033
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: appointment_theatre_status_code, "A=Actual", "P=Planned", "C=Cancelled"
        name: APPOINTMENT_THEATRE_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6811f9d0-fc78-4f71-a6ca-597234e735c8
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 83c1b4d6-4d47-4683-9cce-c13bf525ed28
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CANCELLATION_REASON_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d8a215d3-3999-4dc5-8bb8-f38969fae925
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e7e0ef5-ea5b-4668-ac94-0cd862a396cc
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CANCELLATION_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bb988749-d029-4735-b67c-e34ddf2eb2e4
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0c67ed4-8289-4e84-b157-a148c39e6581
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: cancellation_Reason_Code
        name: CANCELLATION_REASON_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5b805415-a87d-45f8-8873-edf9b43e87c1
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da37d64a-1fe1-4e67-a09f-72c671b10550
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.cancellation_reason_reference_no=dim_cancellation_reason.cancellation_reason_reference_no
        name: DIM_CANCELLATION_REASON_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 69a2ff8a-cc50-4233-984e-4f4c208531b4
                stepCounter: e6db19e7-9566-4508-9ae8-f175115d0f7b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 771be004-b6fe-4083-b388-bedf881123dd
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CANCELLATION_BY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c31b3198-a2fc-4312-b576-5b46c997ed1f
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c7734e9-13b9-45a3-a97d-09a7f1b70958
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.cancellation_by_reference_no=dim_cancellation_by.cancellation_by_reference_no
        name: DIM_CANCELLATION_BY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 42e73d68-a806-48c2-9b0b-1f03c1023dea
                stepCounter: 6681725b-d7e8-4928-b02b-b31ebefd2a77
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e46a461-e2a6-4f37-8bcb-d949352ee4cc
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.treatment_delay_reason_reference_no=dim_treatment_delay_reason.treatment_delay_reason_reference_no
        name: DIM_TREATMENT_DELAY_REASON_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c326f36-a874-4639-a931-3f69925e3e6c
                stepCounter: fdfedb75-628d-4de7-bfab-11dcae96a76f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3180cf30-9829-4c5b-a492-b5b584b0ec6b
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: FUP_ATTEND_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56e08530-0618-4510-9e69-ce32f4453c0e
                stepCounter: 327b4088-60cd-4d51-8c08-44cdba9885d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b9a5d1b1-84d7-44d0-a331-de929a63ddb8
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.visit_type_reference_no=dim_visit_type.visit_type_reference_no
        name: DIM_VISIT_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d98534e-8cae-4f10-8264-a4c4223d7fa3
                stepCounter: 327b4088-60cd-4d51-8c08-44cdba9885d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2cb8ec97-435b-47ff-99fb-69885364b37a
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_URGENCY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3110de1-4967-498a-9cbd-5127103c2ce6
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 10c42298-294c-4601-b162-168f4903add6
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.appointment_urgency_reference_no=dim_appointment_urgency.appointment_urgency_reference_no
        name: DIM_APPOINTMENT_URGENCY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: efb3395d-2e3d-47af-802b-6da5488a049c
                stepCounter: ee1a316f-4102-47c2-8634-e0afd854924c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b9b4a1e8-7abe-4299-9c75-6b61f788e0c4
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_PRIORITY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16509d3d-6a87-4bd7-b0b1-5b5fe7cfec97
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad4df082-6e73-44e1-b0d8-5c285d0e16cc
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.appointment_priority_reference_no=dim_appointment_priority.appointment_priority_reference_no
        name: DIM_APPOINTMENT_PRIORITY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 675089ee-2827-497a-9cd6-4f6bf234d93f
                stepCounter: 017631a9-c464-44dc-89d7-4c0db20d26ee
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 606de4c7-45cd-4371-9345-4d627bde4ee6
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.transport_type_reference_no=dim_transport_type.transport_type_reference_no
        name: DIM_TRANSPORT_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f41f9a0-6a67-4378-b406-e79f41813e18
                stepCounter: 746ce62d-5725-4896-907b-fdaac7bfc158
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86de2497-3c4b-4b00-923d-58b856856072
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ATTENDANCE_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3fe3b466-3d15-491d-9f72-070ed96a6c75
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8cfbf28d-fcb0-43ed-aa53-2e373ac83719
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: ATTENDANCE_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa6a63dc-1041-4c99-8e41-29bdbb726761
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92fff37e-e795-4034-af1c-12a680476284
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: DNA_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 491be8ba-5a1a-4fdf-a97a-46899257e2c4
                stepCounter: efd1bff2-2909-4fc7-8a55-d0f4f8a062eb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a68a5a1-c3be-4782-8266-72cc6b28d2f3
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INT
        defaultValue: ""
        description: Count of appointments where the patient Did Not Attend
        name: DNA_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 491be8ba-5a1a-4fdf-a97a-46899257e2c4
                stepCounter: efd1bff2-2909-4fc7-8a55-d0f4f8a062eb
            transform: |-
              CASE WHEN DNA_flag = 'Y' THEN 1
                          ELSE 0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 079e471e-b74c-48e6-97c4-facb5cab265a
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: first and subsequent specialist appointments  where the patient Did Not Attend. USed in the Hospital Advisory Committe KPI reporting.
        name: HAC_DNA_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 41c9e9e9-c94c-4280-8aa9-c2c02b87b784
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e6098c8-b94e-42fa-9485-a6f078c98bf1
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INT
        defaultValue: ""
        description: Count of first and subsequent specialist appointments  where the patient Did Not Attend. USed in the Hospital Advisory Committe KPI reporting.
        name: HAC_DNA_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 41c9e9e9-c94c-4280-8aa9-c2c02b87b784
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: |-
              CASE WHEN s_outpatient_appointment_20.HAC_DNA_Flag = 'Y' AND DNA_flag = 'Y' THEN 1
                          ELSE 0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bfe5e7ac-bdeb-4370-979d-94a81a19ba80
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.attendance_status_reference_no=dim_attendance_status.attendance_status_reference_no
        name: DIM_ATTENDANCE_STATUS_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 97258f2b-7762-4860-93cd-36adc51060f6
                stepCounter: efd1bff2-2909-4fc7-8a55-d0f4f8a062eb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cbb2feda-e33e-4dba-9c86-b358db9b3016
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DID_NOT_ATTEND_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4e0f5b2-cb7d-496b-81ad-2c969d840bad
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2edad27e-6ac1-40fe-ace5-67b79a587e6b
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INT
        defaultValue: ""
        description: s_outpatient_appointment_30.did_not_attend_reason_reference_no=dim_DNA_reason.DNA_reason_reference_no
        name: DIM_DNA_REASON_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d6271301-0fe7-4137-b2b8-725a62c5d84b
                stepCounter: c524bec2-79fe-44cb-aed4-757e300df3a6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0533fa69-3a3d-42d4-b515-f6dadc0aee76
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMIN_CATEGORY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e8393566-f54f-44dd-9fc9-60a319344307
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c04f40d6-63da-41f5-9ee6-056838b960fc
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.admin_category_reference_no=dim_outpatient_admin_category.outpatient_admin_category_reference_no
        name: DIM_OUTPATIENT_ADMIN_CATEGORY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9f5e5de5-c369-458d-b714-ae210a7f6cca
                stepCounter: deb8b5f6-a102-496d-8e21-9f46938a609d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34b69c1c-5303-4eaa-b77d-1843b8210d06
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_CHANGE_REQUEST_BY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 238b11cf-22c9-4f6f-bd2d-dbddce0862d6
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e58e59b-1347-4d75-b58a-da63e246923c
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.appointment_change_request_by_reference_no=dim_appointment_change_request_by.appointment_change_request_by_reference_no
        name: DIM_APPOINTMENT_CHANGE_REQUEST_BY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5b978df-2ef1-48d3-906e-666830c85247
                stepCounter: 7692bb99-7135-4eb3-b583-109b7863096b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a873594-e8e9-45e2-8d0c-0a74219af9e3
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CODING_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ffb6e88-262c-487d-a611-792ba4cbf400
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 662dc783-0f35-4cf7-8132-1cc4b6cc41b1
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.coding_status_reference_no=dim_coding_status.coding_status_reference_no
        name: DIM_CODING_STATUS_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9089824e-f49d-4697-a2e0-404bc19dcff0
                stepCounter: 69e20bc5-eff0-4faf-9218-a539c3304716
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 90280beb-7260-4848-ba17-430b22825778
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.patient_confirmation_status_reference_no=dim_patient_confirmation_status.patient_confirmation_status_reference_no
        name: DIM_PATIENT_CONFIRMATION_STATUS_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d77ce846-9eee-4807-bf06-db1f89741b1a
                stepCounter: cf793df8-98ec-45d7-b550-96d26f94d31a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3bafdb9b-f96b-45ab-9678-a775c59dfa78
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.replace(s_outpatient_appointment_20.responsibility_centre_code,'-','')=dim_responsibility_centre.responsibility_centre_code  s_outpatient_appointment_30.'120'=dim_responsibility_centre.company_code
        name: DIM_RESPONSIBILITY_CENTRE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c9a966f-0750-4c8b-a92a-a034376ca161
                stepCounter: a84cf165-8cc6-4510-8bae-53366e2d4ff7
            transform: IFNULL(dim_responsibility_centre_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1e01a70-de7d-4b0f-8efa-8db3398a602d
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.purchase_unit_code=dim_purchase_unit.purchase_unit_code
        name: DIM_PURCHASE_UNIT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d9c041f-76d6-44c7-8d88-936673dfd7a0
                stepCounter: d198650d-0f77-489d-92ec-0c0257cd5a43
            transform: IFNULL(dim_purchase_unit_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5d7a0e1-b40f-4686-8220-f617ba5ecf28
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ACC_FUNDED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 01026408-0678-4d18-8b55-55770f6e93d3
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05f416fd-c298-4101-a823-b9735d8ffec9
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: APPROXIMATE_SCHEDULE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: da183d75-5ba0-462a-9caa-5111cf90ab26
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57a15fce-eb51-4c6b-b72c-f1b4717d90a6
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FIRST_OUTPATIENT_APPOINTMENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f9a30daf-fad7-4339-93d9-62493df50d23
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 802f1d1b-4b8f-4ead-bde7-1dcf7a010dca
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_APPOINTMENT_ARRIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8d4a2896-d553-4cdb-83d7-0e6f5f5c0e93
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ac42d94-1bc3-46eb-aecb-99b1d2f1bba9
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_APPOINTMENT_SEEN_BY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9108d606-cb74-4f7c-95fb-6e5883cf5b61
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9d5b788-6077-4253-9f62-3f38a16f37f1
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LAST_OUTPATIENT_APPOINTMENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 674cc1c5-ad85-4932-821b-d711e21522ff
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 903bb598-2a32-4e1e-a7c3-c8a990d629af
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_APPOINTMENT_SEEN_BY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2a79f3ce-6515-44cf-9720-d2e3535b400d
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4837bc72-cf12-45e7-88c5-b29fd5889663
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_APPOINTMENT_DEPARTED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5fe5beba-1683-4b59-a712-13ffc4c8797e
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5da3e9e6-7174-42e6-9749-349fa1742d8f
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: NUMERIC(15,2)
        defaultValue: ""
        description: ""
        name: ACTUAL_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a0fed561-efb8-44e8-9471-69f1bdb9645d
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66be088d-9c9a-4daf-80ad-9ddfb41f1734
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: NUMERIC(15,2)
        defaultValue: ""
        description: ""
        name: BUDGET_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11bc5796-f453-40f7-86b7-319bc31ce89c
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c55646d-5821-4223-93c7-4a8a7fc24e69
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DURATION_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 617f5093-af97-4b6e-a019-be9b854175dd
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 56cd28de-027d-4f46-95e7-a21d55b898f8
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f4e95685-1885-45fd-ae2c-69766f50dbb0
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39aa78bc-18f8-4aa2-b58e-d29af2a89917
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_DURATION_ARRIVED_TO_DEPARTED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7cc35cae-3989-43e9-9167-c1c0be573058
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ef63c78-4fac-4e4f-8515-838bbc3e1f95
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CURRENT_TO_NEXT_APPOINTMENT_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ac221626-9586-46f7-aecb-6e716ed788d7
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fcaab3e0-55e4-4dc0-b99d-c90bbeb9a14d
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FOLLOWUP_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a8837b4-e231-47c1-b846-f373f3aff3fd
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 992fe89d-d1b8-4e71-83ff-22a21a900059
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ATTENDED_APPOINTMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN s_outpatient_appointment_20.attendance_status_code IN ('5','6','W') THEN 1
                          ELSE 0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f032979-36e7-4f39-a754-eba2de779294
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CANCELLED_APPOINTMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN s_outpatient_appointment_20.cancellation_reason_date IS NOT NULL THEN 1
                          ELSE 0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 13ca38f0-8d07-41ed-92da-0562744cca8a
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '1'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6f13b9e-85e7-4464-803a-b9609105aee6
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: afb4460b-3d54-4f38-add1-92a8940c17e3
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 260a3903-7dbe-4af5-9f1b-cea8064e0c95
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 863dc3e6-5336-4586-94a0-9b1a13452282
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f57a361f-67cd-47f9-8592-7cfc50a01c20
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.create_user_login_code=dim_create_user_login.create_user_login_code
        name: DIM_CREATE_USER_LOGIN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2dfe5e14-cc2f-4748-8352-a6d1621289af
                stepCounter: 70bd6ed5-e21b-440f-9079-7fe305bc4f30
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b109e149-7e03-43f1-9d7d-f8387c37e44d
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIFY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ad0df87-dad6-46f7-a5ee-9a5c20faea40
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: feb775ab-6f79-4872-817e-007a379e7fd4
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: NEW_ATTEND_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 43238357-2152-417c-a015-88b2495babe7
                stepCounter: 327b4088-60cd-4d51-8c08-44cdba9885d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0bf9888c-abb6-4b5f-a75b-580f41c43773
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.modify_user_login_code=dim_modify_user_login.modify_user_login_code
        name: DIM_MODIFY_USER_LOGIN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ceaa34a6-dd0b-40fb-bc61-9df93cc05e7b
                stepCounter: bef0768d-dddb-4d02-af8d-03160de42b62
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bcff5a0e-b019-4681-85fd-b22c4a096d02
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NEXT_OUTPATIENT_APPOINTMENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 49bd9674-0505-4dbd-a1fe-b08cf97a64d5
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b03d250-5b6b-405c-ad5f-06a3040c5f23
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DSS_DATA_QUALITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1efe6b8c-3615-44c8-a51c-23f0c50cc21f
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ff50184-74db-4b72-8f45-d80b837b9491
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: is the appointment outcome qualified as an NPF exception
        name: NPF_EXCEPTION_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c8a1d06-b5ff-491a-80d9-68fb6f6b03aa
                stepCounter: e9327b80-105c-4386-ad85-a52a7ccf58f5
            transform: |-
              CASE WHEN dim_appointment_outcome.exception_outcome_code IS NOT NULL AND appointment_start_date > '01-Jul-2014' THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87d979af-be1a-4127-8762-2cff96328d9d
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: OUTPATIENT_APPOINTMENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48b707dc-4c45-43f0-a314-9c50d80f105e
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6eb7edb8-dad9-424e-a624-1a9565912d9a
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: OUTPATIENT_APPOINTMENT_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7478d16-24ac-4d6b-b3e4-1d09e1f7a6c5
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9aca69a6-d1a3-44cd-a2b7-865c1b6c6d12
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OUTPATIENT_APPOINTMENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 01af9aa2-a2a9-4ce9-81be-63866e47ce4f
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cef812b9-44d4-48dd-840e-0f05eb89eafc
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OUTPATIENT_CLINIC_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 187f82dc-bde5-48d3-8dc5-530c8a9630f8
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea0073b1-cf96-42b7-8267-24e4769cd3b6
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Health Specialty Code
        name: OUTPATIENT_HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d52f0dab-407a-418d-9301-aa20ffa72173
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea116847-9754-43a6-a920-fb082b7840e3
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OUTPATIENT_SESSION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 54a2759d-5dce-4cf6-aec8-fcb52bebd369
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a0d274f-2482-4d7e-9688-31c814d4871a
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Session from which a planned appointment was booked.  This is not populated once booked.
        name: PLANNED_FROM_OUTPATIENT_SESSION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa351e69-0d78-411b-8106-1bc3a2287db4
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18ef1e03-90e0-4178-9aa8-9f19d1319ead
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OUTPATIENT_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 548069af-2f4a-49ce-bf84-d2d29e1ce10d
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc25e32f-47ce-4956-b8e8-86a6403a3e98
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: OVERBOOKED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dea9df4e-31c0-4dcb-af1a-6403d85c0709
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e3eed30-c779-4824-a159-8c9b7fa355a1
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PARENT_OUTPATIENT_APPOINTMENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc83e06a-0ed3-4c0f-b6c5-aa90b15e92ad
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 402eece9-9358-45b3-b3a1-36d35a629130
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_AGE_ON_ARRIVAL_YEARS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 89488409-e62e-4d6e-8f3b-028253066905
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 662323d1-a08e-4e0b-b390-2666ecad3810
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_APPOINTMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ca0991b-e813-4364-8543-8ef23bab286b
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7a94d18-db73-4769-8c18-4977d6ae589b
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_APPOINTMENT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d4b225f4-ab09-4619-9f13-fe6331096f11
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e2da0ab-783f-45d8-8d00-ece967abfbe1
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PATIENT_ARRIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 86404ff4-1899-4246-ab33-ab94a4a6c8c1
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f4cc785-fa6a-4ab2-963b-50932bc54502
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_CONFIRMATION_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 543ff86a-b7f2-4852-8537-4d4596cb037d
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd350ad0-7607-4165-af42-fab181166c3d
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PATIENT_DEPARTED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5b902a1d-5918-4b7a-b33c-c947843e0fe9
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 069cf220-6103-4fcc-b486-9d9a0f8e47c2
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a7bc0c12-f669-4b1a-95ee-7f81774f2402
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c8c6cc7-ce00-42cd-947e-b1077112efc3
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: efb476e0-2b6c-4a90-b3a4-4faa5b257f99
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86f511f6-0b41-4aaf-8844-9f4cfce87ad3
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PATIENT_SEEN_BY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d8b2f8e5-9c85-4a61-9cbc-a1dbc371d818
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 488ee1bd-53f2-4f4c-a8b5-a67f901c76c5
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PREV_OUTPATIENT_APPOINTMENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 04eb80b9-8668-4510-b01a-88c9d8edcb25
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 502a5bec-f177-486b-a048-8ec2e2e71427
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREVIOUS_TO_CURRENT_APPOINTMENT_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de9e676d-9f99-4bd9-93b4-8e3c035e4578
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e05e44e6-3af3-47f0-bc9a-bad5b96ddf89
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PRIMARY_PROCEDURE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c7dba21-e1ca-40f3-b029-b4baba81b614
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72465ed7-2319-4681-a65e-bdb0a7cb384f
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRIMARY_PROCEDURE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1eef6b5d-fe3b-4473-a948-425d00231d54
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9ff2256-ceec-43e2-8122-a0dc2636f9c8
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PRINCIPAL_DIAGNOSIS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 899fb995-5b56-4994-a122-8d27fb00b9aa
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e8ccecc-03bd-40a8-9d7d-c19e42b0fb31
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRINCIPAL_DIAGNOSIS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5b67dc01-a866-4ca4-9536-018f87e93123
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c182b23f-55d1-418f-8860-6928bff7502c
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa5f32ea-2bc5-4e60-b2c3-3196b5e2d2d6
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: IFNULL(CASE WHEN len(s_outpatient_appointment_20.purchase_unit_code_pre_01_07_2014)=0 THEN NULL ELSE s_outpatient_appointment_20.purchase_unit_code_pre_01_07_2014 END , purchase_unit_code_post_01_07_2014)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e4ace2c-6f30-4609-bdd8-ca3dcbb144e5
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Excludes any DNAs and multiplies appointments by any RVU to give the purchase unit volume submitted to NNPAC
        name: PURCHASE_UNIT_VOLUME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ca0991b-e813-4364-8543-8ef23bab286b
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: |-
              CASE WHEN appointment_start_date >= dateadd(DAY,1,cast(getdate() AS date)) OR DNA_Flag = 'Y' OR s_outpatient_appointment_20.attendance_status_reference_no IN (11301, -- DNA
              11540, -- Not Specified
              1000010399, --cancelled
              1000010400, --Cancelled or Postponed
              1000010402, -- Patient Arrived Late and Could not be Seen
              1000010403, -- Unable to Attend
              1000010404, -- Did Not Attend
              1400017621 -- Did Not Wait
              ) OR s_outpatient_appointment_20.IP_event_encounter_id IS NOT NULL OR s_outpatient_appointment_20.cancellation_reason_date IS NOT NULL OR s_outpatient_appointment_20.ACC_funded_flag = 'Y' THEN 0
                          WHEN IFNULL(s_outpatient_appointment_20.purchase_unit_code_pre_01_07_2014, s_outpatient_appointment_20.purchase_unit_code_post_01_07_2014) like 'OT05001%'                                                                                                                                                                                                                                                                                                                                                                                                                                                           THEN cast(s_outpatient_appointment_20.appointment_duration_arrived_to_departed AS MONEY)/60
                          ELSE 1
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02af9491-172e-4219-902b-d4cde98ba5ce
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9753d978-a65b-4d20-bd99-3277d20f6ff4
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: "'R'+CONVERT(varchar,s_outpatient_appointment_20.referral_reference_no)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8163ee82-dfed-404c-8db4-d89f5fc5bf41
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: RESPONSIBILITY_CENTRE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9544a9b2-1975-40c7-96d7-13e1db388d74
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a43d735b-d96a-4c7d-ae80-1ef7503efab7
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SECONDARY_DIAGNOSIS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 41c2eaa2-a42c-4b9c-9d00-ccd11191f64d
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 36873a27-cb23-446d-a3d1-d1681ac9cc32
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SECONDARY_DIAGNOSIS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 058f7f4c-b77c-4dea-97fe-f2fe5d7a27d9
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ccc0c747-a7d9-4466-a8ed-98fd3a6ee367
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SECONDARY_PROCEDURE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cf9d52cd-63e0-4035-b876-d26c35a591da
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07a86fc3-e5c1-48d7-88a7-ecec0ea99aa7
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SECONDARY_PROCEDURE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60a2fc88-ef01-46fb-8406-d37828989f2c
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18a12198-2c17-4bcd-a2bd-732c621036a1
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dcf14305-2840-45eb-8ada-8eeeabf2a1ac
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7f8505b-fc06-472b-a9bf-0c8b4073d888
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_APPOINTMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 943297e8-b3a2-4f64-b3fc-67fd96711da0
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8d8d47b-1928-45eb-b379-2761ba77a4f3
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_APPOINTMENT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0fd20499-3fce-4e3e-a46c-e3276d5c2579
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b1b06e8-ff96-4b26-8619-fa4a7f6dd534
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: TRANSPORT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d1202718-b7c8-4007-b2fa-f51b1f39d083
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05b54643-3c26-4216-a2b4-2a9766a32787
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: TREATMENT_DECISION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4d424928-e32a-42d3-a374-2315df7643aa
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33122a6f-2817-4524-ab58-4fc9857091b3
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: TREATMENT_DELAY_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0edd2048-646d-49d6-b4a2-edb2032f948f
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eaa4c368-8839-4a30-b043-c51be33d1c50
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: UNPLANNED_RETURN_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67355a7d-320f-484b-8500-e07697f95506
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6ae8d1f-71c1-4279-ade1-569a07ab088a
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: VIRTUAL_APPT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fffb65be-864e-474e-99d0-b65112dc3a4d
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5184d5fa-3443-4d3d-96cf-f69972077cda
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: VISIT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 01b2048c-0bb4-4557-a3c2-f76f617c1154
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 445b115c-90d4-4970-aa0a-e5f9bba2147b
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: WAITLIST_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ae4de60b-c8c7-4917-a80f-aa00f833e966
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: "'W'+CONVERT(varchar,s_outpatient_appointment_20.waitlist_reference_no)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd89c1d9-3560-40cf-8466-93f0fa5d90f1
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Sequence for appointment within waitlist ordered from most recent to oldest
        name: WAITLIST_SCHEDULE_REV_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84ee41a1-435e-4966-ae22-b305891c1ad1
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38772ec4-9183-4f07-ae93-f9b0ffe0fcd3
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_APPOINTMENT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 604ecbb7-54df-4046-a900-4c071b7792b2
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f6e7178-1c61-48b4-a943-2eb98ba9c160
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_SCHEDULE_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0590f476-03c3-4fc9-86b1-4022ceaa765e
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b0ba591-d1af-4340-aafa-a1f09ca21b4a
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INT
        defaultValue: ""
        description: Sequence for appointment within waitlist ordered from oldest to most recent
        name: WAITLIST_SCHEDULE_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 34a963bb-267e-46c1-9447-2ad561520889
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32b0b67a-a618-4376-994e-aecae11ff881
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MODIFY_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b50c0b0a-30d9-48f5-8ab9-7b0f8ba69c59
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c15d477-da3e-4fb0-88a5-b0fc9f29ab1d
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Is this referral an National patient flow referral, Note this rule is the ESPI1 rule plus Surveillance
        name: NPF_PRESENTING_REFERRAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 99e223e0-6665-4f02-b257-bdebfb85c6ef
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0fc367c-0e99-4f3c-aacc-00765e840ba0
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: 'Is this appointment on a National patient flow referral but not associated with a waitlist?  If so we send it as an activity and activity outcome  '
        name: NPF_NON_WAITLIST_ACTIVITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 99e223e0-6665-4f02-b257-bdebfb85c6ef
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: |-
              CASE WHEN s_outpatient_appointment_20.NPF_presenting_referral = 'Y' AND s_outpatient_appointment_20.waitlist_reference_no IS NULL THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5f70a4e-cfdd-4204-9e05-026d1fe290b0
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: VARCHAR(MAX)
        defaultValue: ""
        description: ""
        name: COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c9adfa37-5bfb-46a1-bbf6-f81fa61baee5
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c01cd655-c419-47fc-aa24-d3205ee83472
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: SCHDL_COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d44d64c0-4122-41b1-8e8a-7ff1f26d5a31
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87d971d3-621a-4f63-8fd4-4e217d767048
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: REASN_COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c7c7328-2113-4de7-8314-b7eaf2e413fb
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d7c1052-8e85-42c1-9a66-3196ff7f10d3
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ACCINDICATORID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 57c3ad6d-ee09-4c25-8d4c-c01888f3cfc8
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 119a73f4-c696-41dc-aa83-dc337b80bd7c
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_outpatient_appointment_30.ACCIndicatorID=dim_Outpatient_ACCIndicators.LocalCode
        name: DIM_OUTPATIENT_ACCINDICATORS_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed84902e-1b29-445d-b90a-66630f85223c
                stepCounter: 411ce900-f472-404a-bc80-5c048a291121
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8c6f739-7de1-4783-a41b-a58772edf7e9
          stepCounter: 6104fd09-e188-4650-aa1d-6147c28270af
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 890a9aaf-a992-400a-8754-c810dfaf3a31
                stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_OUTPATIENT_APPOINTMENT_20: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
          DIM_PRINCIPAL_DIAGNOSIS: 6a64703e-9924-4948-986a-0578fe6b91b7
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DIM_ENCOUNTER_TYPE
          - locationName: TGT
            nodeName: S_OUTPATIENT_APPOINTMENT_20
          - locationName: TGT
            nodeName: DIM_PRINCIPAL_DIAGNOSIS
        join:
          joinCondition: |-
            FROM {{ ref('TGT','S_OUTPATIENT_APPOINTMENT_20') }} s_outpatient_appointment_20
              LEFT JOIN {{ ref('TGT','DIM_PRINCIPAL_DIAGNOSIS') }} dim_principal_diagnosis
                ON s_outpatient_appointment_20.principal_diagnosis_reference_no = dim_principal_diagnosis.principal_diagnosis_reference_no
               AND IFNULL(dim_principal_diagnosis.dss_start_date, GETDATE()-10000) <= s_outpatient_appointment_20.appointment_start_date
               AND IFNULL(dim_principal_diagnosis.dss_end_date, GETDATE()+10000) >= s_outpatient_appointment_20.appointment_start_date
              LEFT OUTER JOIN [dim].[dim_purchase_unit]
                ON IFNULL(CASE WHEN len(s_outpatient_appointment_20.purchase_unit_code_pre_01_07_2014)=0 THEN NULL ELSE s_outpatient_appointment_20.purchase_unit_code_pre_01_07_2014 END , purchase_unit_code_post_01_07_2014) = dim_purchase_unit.purchase_unit_code
               AND IFNULL(dim_purchase_unit.validity_start_date, GETDATE()-10000) <= s_outpatient_appointment_20.appointment_start_date
               AND IFNULL(dim_purchase_unit.validity_end_date, GETDATE()+10000) >= s_outpatient_appointment_20.appointment_start_date
              LEFT JOIN l_mappings_planned_care_OP
                ON l_mappings_planned_care_OP.purchase_unit_code = IFNULL(CASE WHEN len(s_outpatient_appointment_20.purchase_unit_code_pre_01_07_2014)=0 THEN NULL ELSE s_outpatient_appointment_20.purchase_unit_code_pre_01_07_2014 END , purchase_unit_code_post_01_07_2014)
              LEFT JOIN dim.dim_planned_care
                ON dim_planned_care.planned_care_intervention_component = [l_mappings_planned_care_OP].planned_care_intervention_component
        name: S_OUTPATIENT_APPOINTMENT_30
        noLinkRefs: []
  name: S_OUTPATIENT_APPOINTMENT_30
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
