fileVersion: 1
id: 2b5460f8-336b-4f85-881d-3795f07d3515
name: STAGE_EDW_PVIEW_MSTR_DATA_WELL_ATTR
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: "Staging view for ProdView Master Data Integration"
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 263a16ad-a972-41bc-830b-3bf912120e48
          stepCounter: 2b5460f8-336b-4f85-881d-3795f07d3515
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: PVT_PVUNIT_IDREC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dfe22de8-f6e2-429b-90aa-91f793353b62
                stepCounter: d554b1ad-15ef-40f5-8fff-8a730cc8b68e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0bcf4b8e-228b-41aa-acbc-295ddd2525e5
          stepCounter: 2b5460f8-336b-4f85-881d-3795f07d3515
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: PVT_PVUNITCOMP_IDREC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9cf6aa8f-2e96-43a3-8472-6ee102299445
                stepCounter: b2609f15-a93c-4c5d-b86e-0898ad7558d0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef8f374c-b06f-4514-9c9e-d94b6e637e20
          stepCounter: 2b5460f8-336b-4f85-881d-3795f07d3515
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PVT_PVUNIT_LEGALSURFLOC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52f08fa2-2635-4d5f-821e-b71a9ed9ef33
                stepCounter: c45680ca-dc9f-4105-bcb5-19a9ccb375ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 13193fa2-b6ce-4abb-8520-772eaf328a87
          stepCounter: 2b5460f8-336b-4f85-881d-3795f07d3515
        config: {}
        dataType: DECIMAL(12,7)
        defaultValue: ""
        description: ""
        name: PVT_PVUNIT_LATITUDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c90f21dd-5d0a-44a5-92b8-9b954dadf6fb
                stepCounter: ecabdfec-e170-47e5-b71e-87f12cb624a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a85cde1-74d3-49de-abb6-63556706989d
          stepCounter: 2b5460f8-336b-4f85-881d-3795f07d3515
        config: {}
        dataType: DECIMAL(12,7)
        defaultValue: ""
        description: ""
        name: PVT_PVUNIT_LONGITUDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1a05bf2c-2d30-40a6-a0ae-fd20219e597c
                stepCounter: ecabdfec-e170-47e5-b71e-87f12cb624a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc44b86c-c006-4b70-91c9-9490b7128cba
          stepCounter: 2b5460f8-336b-4f85-881d-3795f07d3515
        config: {}
        dataType: DECIMAL(10,5)
        defaultValue: ""
        description: ""
        name: PVT_PVUNIT_ELEVATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d43a4b4d-f7be-458e-9d99-28deffd181f7
                stepCounter: ecabdfec-e170-47e5-b71e-87f12cb624a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c79b2999-4e3e-4818-8cb5-3e237c967ad6
          stepCounter: 2b5460f8-336b-4f85-881d-3795f07d3515
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: ""
        name: PVT_PVUNIT_OPERATOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aba1fd9a-270e-4b28-b30e-3015403e9c27
                stepCounter: ee208fad-242f-468e-badf-834213d7891e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1bdc2b59-ce19-4038-9c08-2149b5e0a0ea
          stepCounter: 2b5460f8-336b-4f85-881d-3795f07d3515
        config: {}
        dataType: VARCHAR(60)
        defaultValue: ""
        description: ""
        name: PVT_PVUNIT_FIELDCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ce14875-eaaa-49a1-b6d7-7f11569ae8a0
                stepCounter: 42c7140d-56cc-4a8a-a10d-18d732911a40
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 348eabc6-96c3-42e0-b108-062391b97310
          stepCounter: 2b5460f8-336b-4f85-881d-3795f07d3515
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: PVT_PVUNIT_OPERATED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aba1fd9a-270e-4b28-b30e-3015403e9c27
                stepCounter: ee208fad-242f-468e-badf-834213d7891e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e40a9d1-a503-4adb-9247-7cf6e24d7ffe
          stepCounter: 2b5460f8-336b-4f85-881d-3795f07d3515
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PVT_PVUNIT_UNITIDREGULATORY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33329344-9e29-439b-b66c-9c05b91570ed
                stepCounter: 474a3a13-b0cc-4f39-a1a4-72278594fd2e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4beea5fa-6dd9-4df2-ad59-53f092ec9dbc
          stepCounter: 2b5460f8-336b-4f85-881d-3795f07d3515
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PVT_PVUNITCOMP_COMPIDREGULATORY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4bda8988-e110-479d-9668-10c644afe24f
                stepCounter: 867c6d5f-0d6a-4675-9439-1c662c706bf3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25a2c2cb-debd-4afe-bd95-dc1084417cb0
          stepCounter: 2b5460f8-336b-4f85-881d-3795f07d3515
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PVT_PVUNITCOMP_COMPIDB
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf70d7e9-0d7c-4471-9546-489aee7315a0
                stepCounter: 867c6d5f-0d6a-4675-9439-1c662c706bf3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e33a569-02f9-4509-a5b0-f0f9f7fb9f21
          stepCounter: 2b5460f8-336b-4f85-881d-3795f07d3515
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PVT_PVUNITCOMP_COMPIDC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4bda8988-e110-479d-9668-10c644afe24f
                stepCounter: 867c6d5f-0d6a-4675-9439-1c662c706bf3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1026134b-c6f3-4502-bca0-01c3757af490
          stepCounter: 2b5460f8-336b-4f85-881d-3795f07d3515
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PVT_PVUNITCOMP_COMPIDD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf70d7e9-0d7c-4471-9546-489aee7315a0
                stepCounter: 867c6d5f-0d6a-4675-9439-1c662c706bf3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee4ea651-bb78-4d0e-a343-b2f5d406fe08
          stepCounter: 2b5460f8-336b-4f85-881d-3795f07d3515
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PVT_PVUNITCOMP_DTTMONPROD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56e1fda9-a279-41dd-bc99-29b097bfe89b
                stepCounter: d27be746-23c1-4f20-a761-36e53f02bd5a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34fb8643-2e19-4d7f-91a6-18f0888f780b
          stepCounter: 2b5460f8-336b-4f85-881d-3795f07d3515
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PVT_PVUNITCOMP_DTTMABANDON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f0182a6f-c1de-48ff-bae5-e3b8767c4152
                stepCounter: ecabdfec-e170-47e5-b71e-87f12cb624a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49e23d53-dfd5-4f8a-847c-ef70c0501670
          stepCounter: 2b5460f8-336b-4f85-881d-3795f07d3515
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: ""
        name: PVT_PVUNITCOMP_COMPLETIONLICENSEE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aba1fd9a-270e-4b28-b30e-3015403e9c27
                stepCounter: ee208fad-242f-468e-badf-834213d7891e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b883f5fe-44bb-483e-8f81-044eef24ef34
          stepCounter: 2b5460f8-336b-4f85-881d-3795f07d3515
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PVT_PVUNITCOMP_COMPLETIONLICENSENO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc3b2463-2df2-4e74-b5d7-e49aad6a2622
                stepCounter: 38b5facd-a536-47d3-b185-b2e367e08de6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 60ec989a-665d-47cf-bb81-28afbf0dcd9f
          stepCounter: 2b5460f8-336b-4f85-881d-3795f07d3515
        config: {}
        dataType: VARCHAR(26)
        defaultValue: ""
        description: ""
        name: PVT_PVUNITCOMP_WELLNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1cf25043-1cb2-4c08-bbc0-659f0e56d10f
                stepCounter: ecabdfec-e170-47e5-b71e-87f12cb624a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de628865-4154-4f28-b27a-d6dd5ad4e51f
          stepCounter: 2b5460f8-336b-4f85-881d-3795f07d3515
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PVT_PVUNITCOMP_DTTMLICENSE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 88c52895-4f86-4be6-88d1-bea5694b9fcd
                stepCounter: 38b5facd-a536-47d3-b185-b2e367e08de6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59dcd379-318a-4077-92cb-6dfe2538eaba
          stepCounter: 2b5460f8-336b-4f85-881d-3795f07d3515
        config: {}
        dataType: DECIMAL(12,7)
        defaultValue: ""
        description: ""
        name: PVT_PVUNITCOMP_LATITUDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9410c80a-9397-4d3e-b2cb-7ef299b26e36
                stepCounter: ecabdfec-e170-47e5-b71e-87f12cb624a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71ac298c-a9d3-412e-8779-a75669ba96e8
          stepCounter: 2b5460f8-336b-4f85-881d-3795f07d3515
        config: {}
        dataType: DECIMAL(12,7)
        defaultValue: ""
        description: ""
        name: PVT_PVUNITCOMP_LONGITUDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5fdeb647-2a2d-4e1b-b61e-ca7c43852b16
                stepCounter: ecabdfec-e170-47e5-b71e-87f12cb624a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6976ec95-aa4e-447c-a2b1-b3056da72bc0
          stepCounter: 2b5460f8-336b-4f85-881d-3795f07d3515
        config: {}
        dataType: DECIMAL(10,5)
        defaultValue: ""
        description: ""
        name: PVT_PVUNITCOMP_USERNUM1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4fb613f-da1e-45fd-88d5-65baa9d72ddc
                stepCounter: ecabdfec-e170-47e5-b71e-87f12cb624a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5fa9ef1-8041-4a51-9d1d-0819a5dbdb9e
          stepCounter: 2b5460f8-336b-4f85-881d-3795f07d3515
        config: {}
        dataType: DECIMAL(10,5)
        defaultValue: ""
        description: ""
        name: PVT_PVUNITCOMP_USERNUM2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cc94064d-eb67-42a6-8e0c-4a99baef82ed
                stepCounter: ecabdfec-e170-47e5-b71e-87f12cb624a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c42ee6ac-0019-4e3b-a585-89af4349e1ac
          stepCounter: 2b5460f8-336b-4f85-881d-3795f07d3515
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PVT_PVUNITCOMP_USERTXT1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1198ac3-c61d-45ee-ad14-15e1adc9ba39
                stepCounter: 1af0480c-5981-48ef-af39-6ad39f5e71cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a03c0cef-6d64-442a-87bd-4f003d8b6529
          stepCounter: 2b5460f8-336b-4f85-881d-3795f07d3515
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: PVT_PVUNITCOMP_USERTXT2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1198ac3-c61d-45ee-ad14-15e1adc9ba39
                stepCounter: 1af0480c-5981-48ef-af39-6ad39f5e71cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cbbcb98e-c8c2-4bd1-b769-bb3fcf536719
          stepCounter: 2b5460f8-336b-4f85-881d-3795f07d3515
        config: {}
        dataType: VARCHAR(9)
        defaultValue: ""
        description: ""
        name: PVT_PVUNITCOMPSTATUS_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 40ec6e5b-e17f-46a9-900b-b5281cc6f9eb
                stepCounter: c334910b-79b2-46a0-979e-635bc88c279d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf50202d-4187-4531-a70b-cbcaeeac40d6
          stepCounter: 2b5460f8-336b-4f85-881d-3795f07d3515
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PVT_PVUNITCOMPSTATUS_USERTXT1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c19919c-2cda-4c27-8118-8501bc007c3b
                stepCounter: ecabdfec-e170-47e5-b71e-87f12cb624a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e88b62a8-8f34-43b6-8d91-29f00cc749dc
          stepCounter: 2b5460f8-336b-4f85-881d-3795f07d3515
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PVT_PVUNITCOMPSTATUS_COMMINGLED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33eaec3f-1b4b-4938-8dc3-e64225d39ef3
                stepCounter: ecabdfec-e170-47e5-b71e-87f12cb624a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0226d215-2bb6-44ab-8642-eda0644d9809
          stepCounter: 2b5460f8-336b-4f85-881d-3795f07d3515
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: ""
        name: PVT_PVUNIT_DIVISION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 34f21eb2-2aac-4baf-8b65-fbfb11a87c41
                stepCounter: 067903b4-15b6-458b-abc2-85946f5a3432
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b22dd4b4-9d68-4f91-9457-1d29f1a7ea8b
          stepCounter: 2b5460f8-336b-4f85-881d-3795f07d3515
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: ""
        name: PVT_PVUNIT_DISTRICT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 569e12e0-57e2-4ab0-b1e9-fada992660c6
                stepCounter: 067903b4-15b6-458b-abc2-85946f5a3432
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 13c24c17-f7b9-45ff-8927-9ef228cd1fc3
          stepCounter: 2b5460f8-336b-4f85-881d-3795f07d3515
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: ""
        name: PVT_PVUNIT_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c8d8af15-264c-40af-8b0b-4dce3b18ed31
                stepCounter: 067903b4-15b6-458b-abc2-85946f5a3432
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 096a9e36-e05d-4def-9349-9584faa55229
          stepCounter: 2b5460f8-336b-4f85-881d-3795f07d3515
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: ""
        name: PVT_PVUNIT_FIELD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a489a103-50e2-4347-8d34-6965b140eea8
                stepCounter: 067903b4-15b6-458b-abc2-85946f5a3432
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0ff617d-f19d-4fd3-ae7a-93a07c6c2964
          stepCounter: 2b5460f8-336b-4f85-881d-3795f07d3515
        config: {}
        dataType: VARCHAR(53)
        defaultValue: ""
        description: ""
        name: PVT_PVUNIT_UNITIDPA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c15405c6-ad65-4525-9a28-c675167e0664
                stepCounter: f601baef-839f-49ab-b102-ee3fad93f21c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 341fca63-389a-4226-b188-aae9f7ccba85
          stepCounter: 2b5460f8-336b-4f85-881d-3795f07d3515
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: ""
        name: PVT_PVUNIT_TYPPA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a24d5f1c-3376-4a4e-81d5-0f0aa6b868ad
                stepCounter: f601baef-839f-49ab-b102-ee3fad93f21c
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_EDW_PVIEW_MSTR_DATA_WELL_ATTR: 2b5460f8-336b-4f85-881d-3795f07d3515
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','STAGE_EDW_PVIEW_MSTR_DATA_WELL_ATTR') }} AS WITH GDC_WELL AS (
                    SELECT DISTINCT WELL.GSL_UWI,
                           '1' || LEGAL_DLS_LOC.dls_loc_exception || LPAD(LEGAL_DLS_LOC.dls_legal_subdivision,2,'0') || LPAD(LEGAL_DLS_LOC.dls_section,2,'0') || LPAD(LEGAL_DLS_LOC.dls_township,3,'0') || LPAD(LEGAL_DLS_LOC.dls_range,2,'0') || 'W' || LEGAL_DLS_LOC.dls_meridian || LPAD(LEGAL_DLS_LOC.dls_event_sequence,2,'0') "SURFACE_LOCATION",
                           WELL.SURFACE_LATITUDE,
                           WELL.SURFACE_LONGITUDE,
                           WELL.GSL_GRND_ELEV,
                           BA_OPERATOR.BA_NAME "OPERATOR_BA_NAME",
                           FIELD.FIELD_NAME,
                           WELL_FACILITY.FACILITY_ID,
                           WELL_UNITS.UNIT_CODE,
                           WELL_UNITS.UNIT_NAME,
                           WELL_PROJECTS.UNIT_CODE "PROJECT_UNIT_CODE",
                           WELL_PROJECTS.UNIT_NAME "PROJECT_UNIT_NAME",
                           PDEN.ON_PRODUCTION_DATE,
                           WELL.ABANDONMENT_DATE,
                           BA_LICENSEE.BA_NAME "LICENSEE_BA_NAME",
                           WELL_LICENSE.LICENSE_NUM,
                           WELL.GSL_UWID,
                           WELL_LICENSE.LICENSE_DATE,
                           WELL.BOTTOM_HOLE_LATITUDE,
                           WELL.BOTTOM_HOLE_LONGITUDE,
                           WELL.DRILL_TD,
                           WELL.MAX_TVD,
                           PDEN_ZONES.ZONE,
                           STRAT_UNIT.SHORT_NAME "TD_SHORT_NAME",
                           R_WELL_STATUS.SHORT_NAME "CURRENT_STATUS",
                           WELL.CURRENT_STATUS_DATE,
                           COMMINGLED.WELL_BORE
                      FROM DS_GDC.WELL WELL
                      LEFT JOIN DS_GDC.WELL_LICENSE WELL_LICENSE
                        ON WELL.GSL_UWI = WELL_LICENSE.GSL_UWI
                      LEFT JOIN DS_GDC.LEGAL_DLS_LOC LEGAL_DLS_LOC
                        ON WELL.UWI = LEGAL_DLS_LOC.UWI
                       AND LEGAL_DLS_LOC.LOCATION_TYPE = 'SH'
                      LEFT JOIN DS_GDC.BUSINESS_ASSOCIATE BA_OPERATOR
                        ON WELL.OPERATOR = BA_OPERATOR.BUSINESS_ASSOCIATE
                      LEFT JOIN DS_GDC.FIELD FIELD
                        ON WELL.ASSIGNED_FIELD = FIELD.FIELD_ID
                      LEFT JOIN (
                            SELECT *,
                                   ROW_CREATED_DATE = MAX(ROW_CREATED_DATE) OVER (PARTITION BY GSL_UWI) "INCLUDE"
                              FROM DS_GDC.WELL_FACILITY
                           ) WELL_FACILITY
                        ON WELL.GSL_UWI = WELL_FACILITY.GSL_UWI
                       AND WELL_FACILITY.INCLUDE
                      LEFT JOIN (
                            SELECT GSL_UWI,
                                   LISTAGG(UNIT_CODE, ', ') WITHIN GROUP(ORDER BY UNIT_NAME) AS UNIT_CODE,
                                   LISTAGG(UNIT_NAME, ', ') WITHIN GROUP(ORDER BY UNIT_NAME) AS UNIT_NAME
                              FROM DS_GDC.WELL_UNIT
                             WHERE LOWER(REMARK) LIKE '%unit%'
                             GROUP BY GSL_UWI
                           ) WELL_UNITS
                        ON WELL.GSL_UWI = WELL_UNITS.GSL_UWI
                      LEFT JOIN (
                            SELECT GSL_UWI,
                                   LISTAGG(UNIT_CODE, ', ') WITHIN GROUP(ORDER BY UNIT_NAME) AS UNIT_CODE,
                                   LISTAGG(UNIT_NAME, ', ') WITHIN GROUP(ORDER BY UNIT_NAME) AS UNIT_NAME
                              FROM DS_GDC.WELL_UNIT
                             WHERE LOWER(REMARK) LIKE '%project%'
                             GROUP BY GSL_UWI
                           ) WELL_PROJECTS
                        ON WELL.GSL_UWI = WELL_PROJECTS.GSL_UWI
                      LEFT JOIN DS_GDC.PDEN PDEN
                        ON WELL.GSL_UWI = PDEN.GSL_UWI
                      LEFT JOIN DS_GDC.BUSINESS_ASSOCIATE BA_LICENSEE
                        ON WELL_LICENSE.LICENSEE = BA_LICENSEE.BUSINESS_ASSOCIATE
                      LEFT JOIN (
                            SELECT PDEN_ZONE.GSL_UWI,
                                   LISTAGG(STRAT_UNIT.SHORT_NAME, ', ') WITHIN GROUP(ORDER BY STRAT_UNIT.SHORT_NAME) AS
                              ZONE
                              FROM DS_GDC.PDEN_ZONE PDEN_ZONE
                             INNER JOIN DS_GDC.STRAT_UNIT STRAT_UNIT
                                ON PDEN_ZONE.STRAT_UNIT_ID = STRAT_UNIT.STRAT_UNIT_ID
                             GROUP BY PDEN_ZONE.GSL_UWI
                           ) PDEN_ZONES
                        ON WELL.GSL_UWI = PDEN_ZONES.GSL_UWI
                      LEFT JOIN DS_GDC.STRAT_UNIT STRAT_UNIT
                        ON WELL.TD_STRAT_UNIT_ID = STRAT_UNIT.STRAT_UNIT_ID
                      LEFT JOIN DS_GDC.R_WELL_STATUS R_WELL_STATUS
                        ON WELL.CURRENT_STATUS = R_WELL_STATUS.STATUS
                      LEFT JOIN (
                            SELECT DISTINCT SUBSTR(GSL_UWI,1,14) WELL_BORE
                              FROM DS_GDC.WELL
                             INNER JOIN DS_GDC.R_WELL_STATUS
                                ON CURRENT_STATUS = STATUS
                             WHERE SHORT_NAME LIKE '%COMM%'
                           ) COMMINGLED
                        ON SUBSTR(WELL.GSL_UWI,1,14) = COMMINGLED.WELL_BORE
                   ),
                   FIN_CC AS (
                    SELECT DIM_LO_SAP_COST_CENTER.CC_NUM,
                           DIM_LO_SAP_CC_CORP_HIER_CURRENT.COUNTRY_NAME,
                           DIM_LO_SAP_CC_CORP_HIER_CURRENT.PROV_NAME,
                           DIM_LO_SAP_CC_CORP_HIER_CURRENT.COREAREA_NAME,
                           DIM_LO_SAP_CC_CORP_HIER_CURRENT.AREA_NAME,
                           DIM_LO_SAP_COST_CENTER.CC_NAME,
                           DIM_LO_SAP_COST_CENTER.CC_TYPE_CODE
                      FROM WS_EDW.DIM_LO_SAP_COST_CENTER DIM_LO_SAP_COST_CENTER
                     INNER JOIN WS_EDW.DIM_LO_SAP_CC_CORP_HIER_CURRENT DIM_LO_SAP_CC_CORP_HIER_CURRENT
                        ON DIM_LO_SAP_COST_CENTER.DIM_CC_CORP_HIER_CURRENT_KEY = DIM_LO_SAP_CC_CORP_HIER_CURRENT.DIM_CC_CORP_HIER_CURRENT_KEY
                   ) (
                    SELECT PVT_PVUNIT.IDREC "PVT_PVUNIT_idrec",
                           PVT_PVUNITCOMP.IDREC "PVT_PVUNITCOMP_idrec",
                           GDC_WELL.SURFACE_LOCATION "PVT_PVUNIT_legalsurfloc",
                           GDC_WELL.SURFACE_LATITUDE "PVT_PVUNIT_latitude",
                           GDC_WELL.SURFACE_LONGITUDE "PVT_PVUNIT_longitude",
                           GDC_WELL.GSL_GRND_ELEV "PVT_PVUNIT_elevation",
                           SUBSTR(GDC_WELL.OPERATOR_BA_NAME,1,50) "PVT_PVUNIT_operator",
                           SUBSTR(GDC_WELL.FIELD_NAME,1,50) "PVT_PVUNIT_fieldcode",
                           DECODE(SUBSTR(GDC_WELL.OPERATOR_BA_NAME, 1, 9),'VERMILION','True','False') "PVT_PVUNIT_operated",
                           GDC_WELL.FACILITY_ID "PVT_PVUNIT_unitidregulatory",
                           SUBSTR(GDC_WELL.UNIT_CODE,1,50) "PVT_PVUNITCOMP_compidregulatory",
                           SUBSTR(GDC_WELL.UNIT_NAME,1,50) "PVT_PVUNITCOMP_compidb",
                           SUBSTR(GDC_WELL.PROJECT_UNIT_CODE,1,50) "PVT_PVUNITCOMP_compidc",
                           SUBSTR(GDC_WELL.PROJECT_UNIT_NAME,1,50) "PVT_PVUNITCOMP_compidd",
                           TO_CHAR(GDC_WELL.ON_PRODUCTION_DATE,'YYYYMMDD') "PVT_PVUNITCOMP_dttmonprod",
                           TO_CHAR(GDC_WELL.ABANDONMENT_DATE,'YYYYMMDD') "PVT_PVUNITCOMP_dttmabandon",
                           SUBSTR(GDC_WELL.LICENSEE_BA_NAME,1,50) "PVT_PVUNITCOMP_completionlicensee",
                           SUBSTR(LPAD(GDC_WELL.LICENSE_NUM,7,'0'),1,50) "PVT_PVUNITCOMP_completionlicenseno",
                           SUBSTR(GDC_WELL.GSL_UWID,1,100) "PVT_PVUNITCOMP_wellname",
                           TO_CHAR(GDC_WELL.LICENSE_DATE,'YYYYMMDD') "PVT_PVUNITCOMP_dttmlicense",
                           GDC_WELL.BOTTOM_HOLE_LATITUDE "PVT_PVUNITCOMP_latitude",
                           GDC_WELL.BOTTOM_HOLE_LONGITUDE "PVT_PVUNITCOMP_longitude",
                           GDC_WELL.DRILL_TD "PVT_PVUNITCOMP_usernum1",
                           GDC_WELL.MAX_TVD "PVT_PVUNITCOMP_usernum2",
                           SUBSTR(GDC_WELL.ZONE,1,50) "PVT_PVUNITCOMP_usertxt1",
                           SUBSTR(GDC_WELL.TD_SHORT_NAME,1,50) "PVT_PVUNITCOMP_usertxt2",
                           CASE WHEN CHARINDEX('SUSP', UPPER(GDC_WELL.CURRENT_STATUS)) > 0         THEN 'Suspended'
                                WHEN CHARINDEX('ABD', UPPER(GDC_WELL.CURRENT_STATUS)) > 0          THEN 'Abandoned'
                                WHEN CHARINDEX('ABAND', UPPER(GDC_WELL.CURRENT_STATUS)) > 0        THEN 'Abandoned'
                                WHEN CHARINDEX('INJ', UPPER(GDC_WELL.CURRENT_STATUS)) > 0          THEN 'Inj'
                                WHEN CHARINDEX('DISP', UPPER(GDC_WELL.CURRENT_STATUS)) > 0         THEN 'Inj'
                                WHEN CHARINDEX('PUMP', UPPER(GDC_WELL.CURRENT_STATUS)) > 0         THEN 'Producing'
                                WHEN CHARINDEX('PMP', UPPER(GDC_WELL.CURRENT_STATUS)) > 0          THEN 'Producing'
                                WHEN CHARINDEX('FLOW', UPPER(GDC_WELL.CURRENT_STATUS)) > 0         THEN 'Producing'
                                WHEN CHARINDEX('CMPL OIL', UPPER(GDC_WELL.CURRENT_STATUS)) > 0     THEN 'Producing'
                                WHEN CHARINDEX('GAS WELL', UPPER(GDC_WELL.CURRENT_STATUS)) > 0     THEN 'Producing'
                                WHEN CHARINDEX('OIL PRODUCER', UPPER(GDC_WELL.CURRENT_STATUS)) > 0 THEN 'Producing'
                                WHEN CHARINDEX('PRODUCING', UPPER(GDC_WELL.CURRENT_STATUS)) > 0    THEN 'Producing'
                                WHEN CHARINDEX('COMM', UPPER(GDC_WELL.CURRENT_STATUS)) > 0         THEN 'Producing'
                                WHEN CHARINDEX('ACT OIL', UPPER(GDC_WELL.CURRENT_STATUS)) > 0      THEN 'Producing'
                                WHEN CHARINDEX('GASLIFT OIL', UPPER(GDC_WELL.CURRENT_STATUS)) > 0  THEN 'Producing'
                                WHEN CHARINDEX('Capable', UPPER(GDC_WELL.CURRENT_STATUS)) > 0      THEN 'Producing'
                                ELSE 'Unknown'
                                 END "PVT_PVUNITCOMPSTATUS_status",
                           GDC_WELL.CURRENT_STATUS || '-' || TO_CHAR(GDC_WELL.CURRENT_STATUS_DATE,'DD/MM/YYYY') "PVT_PVUNITCOMPSTATUS_usertxt1",
                           IFF(GDC_WELL.WELL_BORE IS NULL,NULL,'commingled') "PVT_PVUNITCOMPSTATUS_commingled",
                           SUBSTR(FIN_CC.COUNTRY_NAME,1,100) "PVT_PVUNIT_division",
                           SUBSTR(FIN_CC.PROV_NAME,1,100) "PVT_PVUNIT_district",
                           SUBSTR(FIN_CC.COREAREA_NAME,1,50) "PVT_PVUNIT_area",
                           SUBSTR(FIN_CC.AREA_NAME,1,50) "PVT_PVUNIT_field",
                           SUBSTR(FIN_CC.CC_NAME || ' (' || FIN_CC.CC_NUM || ')',1,50) "PVT_PVUNIT_unitidpa",
                           DECODE(SUBSTR(FIN_CC.CC_TYPE_CODE,1,1),'C','Yes','No') "PVT_PVUNIT_typpa"
                      FROM DS_PRODVIEW.PVT_PVUNIT PVT_PVUNIT
                     INNER JOIN DS_PRODVIEW.PVT_PVUNITCOMP PVT_PVUNITCOMP
                        ON PVT_PVUNIT.IDREC = PVT_PVUNITCOMP.IDRECPARENT
                      LEFT JOIN FIN_CC
                        ON PVT_PVUNIT.COSTCENTERIDA = FIN_CC.CC_NUM
                      LEFT JOIN GDC_WELL
                        ON PVT_PVUNITCOMP.WELLIDREGULATORY = GDC_WELL.GSL_UWI
                   )
             UNION (
                    SELECT 'Master Data' "PVT_PVUNIT_idrec" ,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL
                   )
             ORDER BY DECODE("PVT_PVUNIT_idrec",'Master Data',0,1) ASC
        dependencies:
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNIT
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_PVIEW_PVT_PVUNIT') }}
        name: STAGE_EDW_PVIEW_MSTR_DATA_WELL_ATTR
        noLinkRefs: []
  name: STAGE_EDW_PVIEW_MSTR_DATA_WELL_ATTR
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
