fileVersion: 1
id: 7820dafb-64b3-4e44-aca6-241369e0fcc5
name: STAGE_EDW_PVIEW_MSTR_DATA_WELL_ATTR
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: "Staging view for ProdView Master Data Integration"
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5836617a-5d6f-453a-a7e1-483087546884
          stepCounter: 7820dafb-64b3-4e44-aca6-241369e0fcc5
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: PVT_PVUNIT_IDREC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6b6e1d74-6828-42ae-b9d7-69ba4615f389
                stepCounter: e5728334-2b6e-40fb-ae5e-e78da1de0994
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 13803956-8203-48d7-8eca-8a2eaad6c0f4
          stepCounter: 7820dafb-64b3-4e44-aca6-241369e0fcc5
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: PVT_PVUNITCOMP_IDREC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f76be576-f021-42f1-a5bc-c6dfa35d25fb
                stepCounter: 81e6b0b1-1728-45bf-932d-6356544cf13a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e2e6b46-2138-42d0-8725-8a62e1fbe514
          stepCounter: 7820dafb-64b3-4e44-aca6-241369e0fcc5
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PVT_PVUNIT_LEGALSURFLOC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5fea8ae-0e23-4f55-ab72-fdb3869a7cda
                stepCounter: 927bbf78-1a92-4589-88be-7d60b02ab52e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 789f9b9b-09ea-4a26-b88c-2846e9590040
          stepCounter: 7820dafb-64b3-4e44-aca6-241369e0fcc5
        config: {}
        dataType: DECIMAL(12,7)
        defaultValue: ""
        description: ""
        name: PVT_PVUNIT_LATITUDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eed3a024-eef1-4197-bfc0-f0e181953ebe
                stepCounter: 7521139f-dede-4d11-9b32-e99f542eeea1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6366b5cc-57cc-4e20-ac2f-da3eeceb7f8a
          stepCounter: 7820dafb-64b3-4e44-aca6-241369e0fcc5
        config: {}
        dataType: DECIMAL(12,7)
        defaultValue: ""
        description: ""
        name: PVT_PVUNIT_LONGITUDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47ef8b3c-c192-4b6e-adc5-e06df4f15767
                stepCounter: 7521139f-dede-4d11-9b32-e99f542eeea1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a425f42-4827-4238-9319-ddcdf28ebdbf
          stepCounter: 7820dafb-64b3-4e44-aca6-241369e0fcc5
        config: {}
        dataType: DECIMAL(10,5)
        defaultValue: ""
        description: ""
        name: PVT_PVUNIT_ELEVATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27044d76-074f-4cef-93ba-9ae2ed1e6323
                stepCounter: 7521139f-dede-4d11-9b32-e99f542eeea1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47cda02f-57ab-4ede-9061-2b4d57f65b32
          stepCounter: 7820dafb-64b3-4e44-aca6-241369e0fcc5
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: ""
        name: PVT_PVUNIT_OPERATOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0adb84e8-ec83-484a-989e-4fba02baadf9
                stepCounter: fe6ec0f0-ac0c-4049-9a73-0cd704b7e7e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6958c41-b0e3-44e1-9715-4851c731717c
          stepCounter: 7820dafb-64b3-4e44-aca6-241369e0fcc5
        config: {}
        dataType: VARCHAR(60)
        defaultValue: ""
        description: ""
        name: PVT_PVUNIT_FIELDCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fefc93e8-2942-4ec8-9c27-c3b6c2cc6054
                stepCounter: 7b5b3048-e530-4913-aa74-9ad3ca5f6fd3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87574ab7-699c-4180-83ae-7763c8966141
          stepCounter: 7820dafb-64b3-4e44-aca6-241369e0fcc5
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: PVT_PVUNIT_OPERATED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0adb84e8-ec83-484a-989e-4fba02baadf9
                stepCounter: fe6ec0f0-ac0c-4049-9a73-0cd704b7e7e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: acea812c-fc27-48c3-a384-9fc2ba5e9665
          stepCounter: 7820dafb-64b3-4e44-aca6-241369e0fcc5
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PVT_PVUNIT_UNITIDREGULATORY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7170b2f5-0ff6-4d7e-a865-fbe0c91cd360
                stepCounter: fc874a0b-374d-4e70-9672-81217c4be7f2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 155a7ebd-7dc8-4457-bca8-d812400bfa28
          stepCounter: 7820dafb-64b3-4e44-aca6-241369e0fcc5
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PVT_PVUNITCOMP_COMPIDREGULATORY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eae317ce-d5fb-4a37-b316-200ea12303f4
                stepCounter: d9b5445e-8e5e-4c6c-a765-95f021d97b72
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4854ad76-ef62-49f1-9634-083a6d36d94f
          stepCounter: 7820dafb-64b3-4e44-aca6-241369e0fcc5
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PVT_PVUNITCOMP_COMPIDB
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b35c06c3-e1b0-4ce8-8725-358f1e5ae86c
                stepCounter: d9b5445e-8e5e-4c6c-a765-95f021d97b72
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a092debc-7721-4aad-9a4f-aebf7ea04137
          stepCounter: 7820dafb-64b3-4e44-aca6-241369e0fcc5
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PVT_PVUNITCOMP_COMPIDC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eae317ce-d5fb-4a37-b316-200ea12303f4
                stepCounter: d9b5445e-8e5e-4c6c-a765-95f021d97b72
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 079ea99c-32a9-4e13-a4bf-fc7f97f2ce24
          stepCounter: 7820dafb-64b3-4e44-aca6-241369e0fcc5
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PVT_PVUNITCOMP_COMPIDD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b35c06c3-e1b0-4ce8-8725-358f1e5ae86c
                stepCounter: d9b5445e-8e5e-4c6c-a765-95f021d97b72
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c0240f7-3f5b-4574-8958-c71e6389992a
          stepCounter: 7820dafb-64b3-4e44-aca6-241369e0fcc5
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PVT_PVUNITCOMP_DTTMONPROD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1386bd27-725f-48eb-b7df-6576e81dfa45
                stepCounter: 9d6a8c07-3ee1-41f8-ba98-a70449ad23a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2725ef84-5d03-431e-9c46-0abab7b572d9
          stepCounter: 7820dafb-64b3-4e44-aca6-241369e0fcc5
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PVT_PVUNITCOMP_DTTMABANDON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 993c6e25-3455-4cad-a285-57dafc9ce520
                stepCounter: 7521139f-dede-4d11-9b32-e99f542eeea1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2443908-08fa-4dcc-aec7-5c2df6e641fa
          stepCounter: 7820dafb-64b3-4e44-aca6-241369e0fcc5
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: ""
        name: PVT_PVUNITCOMP_COMPLETIONLICENSEE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0adb84e8-ec83-484a-989e-4fba02baadf9
                stepCounter: fe6ec0f0-ac0c-4049-9a73-0cd704b7e7e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9bc5be84-14ad-4423-8eba-479978e0dfb8
          stepCounter: 7820dafb-64b3-4e44-aca6-241369e0fcc5
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PVT_PVUNITCOMP_COMPLETIONLICENSENO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4715b8af-bce5-4b6a-9d3a-bb2b011990a6
                stepCounter: cecf952d-acd4-42f6-bcc9-c7d19284f92e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f559521e-0c2e-4eb4-9643-8208933cdaff
          stepCounter: 7820dafb-64b3-4e44-aca6-241369e0fcc5
        config: {}
        dataType: VARCHAR(26)
        defaultValue: ""
        description: ""
        name: PVT_PVUNITCOMP_WELLNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5587f8d6-b303-45ea-8da7-5398dbd3e3de
                stepCounter: 7521139f-dede-4d11-9b32-e99f542eeea1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7211ef2b-b0bd-4705-8ea4-457daa502bf0
          stepCounter: 7820dafb-64b3-4e44-aca6-241369e0fcc5
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PVT_PVUNITCOMP_DTTMLICENSE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 14eed9ab-06c5-4cb6-bfb5-cfb7f53c9a40
                stepCounter: cecf952d-acd4-42f6-bcc9-c7d19284f92e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9b87e0f-7f0b-4955-baa3-5fe86e8cbdc2
          stepCounter: 7820dafb-64b3-4e44-aca6-241369e0fcc5
        config: {}
        dataType: DECIMAL(12,7)
        defaultValue: ""
        description: ""
        name: PVT_PVUNITCOMP_LATITUDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d4ebeff-c29c-4eb2-ac07-a8111ff07bd9
                stepCounter: 7521139f-dede-4d11-9b32-e99f542eeea1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: effe570b-f4ee-40c8-9309-f46eafe66949
          stepCounter: 7820dafb-64b3-4e44-aca6-241369e0fcc5
        config: {}
        dataType: DECIMAL(12,7)
        defaultValue: ""
        description: ""
        name: PVT_PVUNITCOMP_LONGITUDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 49c70927-9124-4194-b789-c2a50344d2f6
                stepCounter: 7521139f-dede-4d11-9b32-e99f542eeea1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6bf94e8-d060-418a-afe1-87eff5844aa1
          stepCounter: 7820dafb-64b3-4e44-aca6-241369e0fcc5
        config: {}
        dataType: DECIMAL(10,5)
        defaultValue: ""
        description: ""
        name: PVT_PVUNITCOMP_USERNUM1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79b94f38-b7fc-41a3-9518-ad21c57c6a94
                stepCounter: 7521139f-dede-4d11-9b32-e99f542eeea1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9046936e-1987-43ff-be51-140b7bd60162
          stepCounter: 7820dafb-64b3-4e44-aca6-241369e0fcc5
        config: {}
        dataType: DECIMAL(10,5)
        defaultValue: ""
        description: ""
        name: PVT_PVUNITCOMP_USERNUM2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7eca65c8-1c2e-45d9-abe7-5943e71b63ac
                stepCounter: 7521139f-dede-4d11-9b32-e99f542eeea1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d6ce14d-4a6e-4213-b207-a60b4ef3f067
          stepCounter: 7820dafb-64b3-4e44-aca6-241369e0fcc5
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PVT_PVUNITCOMP_USERTXT1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8abdffcd-5cf4-43e2-9e7a-ee249212cd01
                stepCounter: 08b338af-e9a5-4a08-89e3-dfa92b72ae8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7d6c4db-6b52-4e4e-929c-64b54552b621
          stepCounter: 7820dafb-64b3-4e44-aca6-241369e0fcc5
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: PVT_PVUNITCOMP_USERTXT2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8abdffcd-5cf4-43e2-9e7a-ee249212cd01
                stepCounter: 08b338af-e9a5-4a08-89e3-dfa92b72ae8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4987ee71-5c7b-4fe8-895f-148d8b032458
          stepCounter: 7820dafb-64b3-4e44-aca6-241369e0fcc5
        config: {}
        dataType: VARCHAR(9)
        defaultValue: ""
        description: ""
        name: PVT_PVUNITCOMPSTATUS_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48b675ab-3b66-419c-b7a2-3563df90389d
                stepCounter: bf2691cf-db63-444b-835e-fe94dcdce0e2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04f63749-7f82-4272-ac26-f023f7de4280
          stepCounter: 7820dafb-64b3-4e44-aca6-241369e0fcc5
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PVT_PVUNITCOMPSTATUS_USERTXT1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fab3fa07-7c3d-4bff-821c-2784c249f04d
                stepCounter: 7521139f-dede-4d11-9b32-e99f542eeea1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e944412a-39a7-4fd9-a77c-38305449f0cb
          stepCounter: 7820dafb-64b3-4e44-aca6-241369e0fcc5
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PVT_PVUNITCOMPSTATUS_COMMINGLED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea91aca9-43ef-4d12-a31d-eb89c10f5c48
                stepCounter: 7521139f-dede-4d11-9b32-e99f542eeea1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0a2b2d9-5e48-4796-81f8-62aed279d8d1
          stepCounter: 7820dafb-64b3-4e44-aca6-241369e0fcc5
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: ""
        name: PVT_PVUNIT_DIVISION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 056a7ce0-cfc1-48b9-a5fc-02a0fe107682
                stepCounter: 2cca214d-2f7a-400c-a483-58b288ed6097
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2ce76b3-c75f-4252-8946-26c5c9286213
          stepCounter: 7820dafb-64b3-4e44-aca6-241369e0fcc5
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: ""
        name: PVT_PVUNIT_DISTRICT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7c08b94-a01d-4313-a313-3f96d8c0798f
                stepCounter: 2cca214d-2f7a-400c-a483-58b288ed6097
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 951615e8-da61-4378-ad87-3a4681891896
          stepCounter: 7820dafb-64b3-4e44-aca6-241369e0fcc5
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: ""
        name: PVT_PVUNIT_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 619126d9-0cd3-45df-bfbd-2f5dca6da0bd
                stepCounter: 2cca214d-2f7a-400c-a483-58b288ed6097
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 37d4c090-d8c8-4438-a0f9-d753dc6d0632
          stepCounter: 7820dafb-64b3-4e44-aca6-241369e0fcc5
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: ""
        name: PVT_PVUNIT_FIELD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec8da7e4-2ee4-4296-8f0a-7c334356d71e
                stepCounter: 2cca214d-2f7a-400c-a483-58b288ed6097
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06adf1b5-2716-4e11-97ee-797f1760f518
          stepCounter: 7820dafb-64b3-4e44-aca6-241369e0fcc5
        config: {}
        dataType: VARCHAR(53)
        defaultValue: ""
        description: ""
        name: PVT_PVUNIT_UNITIDPA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f423b95-97ef-4fa8-b931-4afdbec33830
                stepCounter: 99b4a618-454e-46de-874d-ad30b4d42108
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db7c8dd4-9c0f-41a1-8b76-88ba369ee35f
          stepCounter: 7820dafb-64b3-4e44-aca6-241369e0fcc5
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: ""
        name: PVT_PVUNIT_TYPPA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d8a49a2-8399-4422-8f4d-adc0d3daa07c
                stepCounter: 99b4a618-454e-46de-874d-ad30b4d42108
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_EDW_PVIEW_MSTR_DATA_WELL_ATTR: 7820dafb-64b3-4e44-aca6-241369e0fcc5
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','STAGE_EDW_PVIEW_MSTR_DATA_WELL_ATTR') }} AS WITH GDC_WELL AS (
                    SELECT DISTINCT WELL.GSL_UWI,
                           '1' || LEGAL_DLS_LOC.dls_loc_exception || LPAD(LEGAL_DLS_LOC.dls_legal_subdivision,2,'0') || LPAD(LEGAL_DLS_LOC.dls_section,2,'0') || LPAD(LEGAL_DLS_LOC.dls_township,3,'0') || LPAD(LEGAL_DLS_LOC.dls_range,2,'0') || 'W' || LEGAL_DLS_LOC.dls_meridian || LPAD(LEGAL_DLS_LOC.dls_event_sequence,2,'0') "SURFACE_LOCATION",
                           WELL.SURFACE_LATITUDE,
                           WELL.SURFACE_LONGITUDE,
                           WELL.GSL_GRND_ELEV,
                           BA_OPERATOR.BA_NAME "OPERATOR_BA_NAME",
                           FIELD.FIELD_NAME,
                           WELL_FACILITY.FACILITY_ID,
                           WELL_UNITS.UNIT_CODE,
                           WELL_UNITS.UNIT_NAME,
                           WELL_PROJECTS.UNIT_CODE "PROJECT_UNIT_CODE",
                           WELL_PROJECTS.UNIT_NAME "PROJECT_UNIT_NAME",
                           PDEN.ON_PRODUCTION_DATE,
                           WELL.ABANDONMENT_DATE,
                           BA_LICENSEE.BA_NAME "LICENSEE_BA_NAME",
                           WELL_LICENSE.LICENSE_NUM,
                           WELL.GSL_UWID,
                           WELL_LICENSE.LICENSE_DATE,
                           WELL.BOTTOM_HOLE_LATITUDE,
                           WELL.BOTTOM_HOLE_LONGITUDE,
                           WELL.DRILL_TD,
                           WELL.MAX_TVD,
                           PDEN_ZONES.ZONE,
                           STRAT_UNIT.SHORT_NAME "TD_SHORT_NAME",
                           R_WELL_STATUS.SHORT_NAME "CURRENT_STATUS",
                           WELL.CURRENT_STATUS_DATE,
                           COMMINGLED.WELL_BORE
                      FROM DS_GDC.WELL WELL
                      LEFT JOIN DS_GDC.WELL_LICENSE WELL_LICENSE
                        ON WELL.GSL_UWI = WELL_LICENSE.GSL_UWI
                      LEFT JOIN DS_GDC.LEGAL_DLS_LOC LEGAL_DLS_LOC
                        ON WELL.UWI = LEGAL_DLS_LOC.UWI
                       AND LEGAL_DLS_LOC.LOCATION_TYPE = 'SH'
                      LEFT JOIN DS_GDC.BUSINESS_ASSOCIATE BA_OPERATOR
                        ON WELL.OPERATOR = BA_OPERATOR.BUSINESS_ASSOCIATE
                      LEFT JOIN DS_GDC.FIELD FIELD
                        ON WELL.ASSIGNED_FIELD = FIELD.FIELD_ID
                      LEFT JOIN (
                            SELECT *,
                                   ROW_CREATED_DATE = MAX(ROW_CREATED_DATE) OVER (PARTITION BY GSL_UWI) "INCLUDE"
                              FROM DS_GDC.WELL_FACILITY
                           ) WELL_FACILITY
                        ON WELL.GSL_UWI = WELL_FACILITY.GSL_UWI
                       AND WELL_FACILITY.INCLUDE
                      LEFT JOIN (
                            SELECT GSL_UWI,
                                   LISTAGG(UNIT_CODE, ', ') WITHIN GROUP(ORDER BY UNIT_NAME) AS UNIT_CODE,
                                   LISTAGG(UNIT_NAME, ', ') WITHIN GROUP(ORDER BY UNIT_NAME) AS UNIT_NAME
                              FROM DS_GDC.WELL_UNIT
                             WHERE LOWER(REMARK) LIKE '%unit%'
                             GROUP BY GSL_UWI
                           ) WELL_UNITS
                        ON WELL.GSL_UWI = WELL_UNITS.GSL_UWI
                      LEFT JOIN (
                            SELECT GSL_UWI,
                                   LISTAGG(UNIT_CODE, ', ') WITHIN GROUP(ORDER BY UNIT_NAME) AS UNIT_CODE,
                                   LISTAGG(UNIT_NAME, ', ') WITHIN GROUP(ORDER BY UNIT_NAME) AS UNIT_NAME
                              FROM DS_GDC.WELL_UNIT
                             WHERE LOWER(REMARK) LIKE '%project%'
                             GROUP BY GSL_UWI
                           ) WELL_PROJECTS
                        ON WELL.GSL_UWI = WELL_PROJECTS.GSL_UWI
                      LEFT JOIN DS_GDC.PDEN PDEN
                        ON WELL.GSL_UWI = PDEN.GSL_UWI
                      LEFT JOIN DS_GDC.BUSINESS_ASSOCIATE BA_LICENSEE
                        ON WELL_LICENSE.LICENSEE = BA_LICENSEE.BUSINESS_ASSOCIATE
                      LEFT JOIN (
                            SELECT PDEN_ZONE.GSL_UWI,
                                   LISTAGG(STRAT_UNIT.SHORT_NAME, ', ') WITHIN GROUP(ORDER BY STRAT_UNIT.SHORT_NAME) AS
                              ZONE
                              FROM DS_GDC.PDEN_ZONE PDEN_ZONE
                             INNER JOIN DS_GDC.STRAT_UNIT STRAT_UNIT
                                ON PDEN_ZONE.STRAT_UNIT_ID = STRAT_UNIT.STRAT_UNIT_ID
                             GROUP BY PDEN_ZONE.GSL_UWI
                           ) PDEN_ZONES
                        ON WELL.GSL_UWI = PDEN_ZONES.GSL_UWI
                      LEFT JOIN DS_GDC.STRAT_UNIT STRAT_UNIT
                        ON WELL.TD_STRAT_UNIT_ID = STRAT_UNIT.STRAT_UNIT_ID
                      LEFT JOIN DS_GDC.R_WELL_STATUS R_WELL_STATUS
                        ON WELL.CURRENT_STATUS = R_WELL_STATUS.STATUS
                      LEFT JOIN (
                            SELECT DISTINCT SUBSTR(GSL_UWI,1,14) WELL_BORE
                              FROM DS_GDC.WELL
                             INNER JOIN DS_GDC.R_WELL_STATUS
                                ON CURRENT_STATUS = STATUS
                             WHERE SHORT_NAME LIKE '%COMM%'
                           ) COMMINGLED
                        ON SUBSTR(WELL.GSL_UWI,1,14) = COMMINGLED.WELL_BORE
                   ),
                   FIN_CC AS (
                    SELECT DIM_LO_SAP_COST_CENTER.CC_NUM,
                           DIM_LO_SAP_CC_CORP_HIER_CURRENT.COUNTRY_NAME,
                           DIM_LO_SAP_CC_CORP_HIER_CURRENT.PROV_NAME,
                           DIM_LO_SAP_CC_CORP_HIER_CURRENT.COREAREA_NAME,
                           DIM_LO_SAP_CC_CORP_HIER_CURRENT.AREA_NAME,
                           DIM_LO_SAP_COST_CENTER.CC_NAME,
                           DIM_LO_SAP_COST_CENTER.CC_TYPE_CODE
                      FROM WS_EDW.DIM_LO_SAP_COST_CENTER DIM_LO_SAP_COST_CENTER
                     INNER JOIN WS_EDW.DIM_LO_SAP_CC_CORP_HIER_CURRENT DIM_LO_SAP_CC_CORP_HIER_CURRENT
                        ON DIM_LO_SAP_COST_CENTER.DIM_CC_CORP_HIER_CURRENT_KEY = DIM_LO_SAP_CC_CORP_HIER_CURRENT.DIM_CC_CORP_HIER_CURRENT_KEY
                   ) (
                    SELECT PVT_PVUNIT.IDREC "PVT_PVUNIT_idrec",
                           PVT_PVUNITCOMP.IDREC "PVT_PVUNITCOMP_idrec",
                           GDC_WELL.SURFACE_LOCATION "PVT_PVUNIT_legalsurfloc",
                           GDC_WELL.SURFACE_LATITUDE "PVT_PVUNIT_latitude",
                           GDC_WELL.SURFACE_LONGITUDE "PVT_PVUNIT_longitude",
                           GDC_WELL.GSL_GRND_ELEV "PVT_PVUNIT_elevation",
                           SUBSTR(GDC_WELL.OPERATOR_BA_NAME,1,50) "PVT_PVUNIT_operator",
                           SUBSTR(GDC_WELL.FIELD_NAME,1,50) "PVT_PVUNIT_fieldcode",
                           DECODE(SUBSTR(GDC_WELL.OPERATOR_BA_NAME, 1, 9),'VERMILION','True','False') "PVT_PVUNIT_operated",
                           GDC_WELL.FACILITY_ID "PVT_PVUNIT_unitidregulatory",
                           SUBSTR(GDC_WELL.UNIT_CODE,1,50) "PVT_PVUNITCOMP_compidregulatory",
                           SUBSTR(GDC_WELL.UNIT_NAME,1,50) "PVT_PVUNITCOMP_compidb",
                           SUBSTR(GDC_WELL.PROJECT_UNIT_CODE,1,50) "PVT_PVUNITCOMP_compidc",
                           SUBSTR(GDC_WELL.PROJECT_UNIT_NAME,1,50) "PVT_PVUNITCOMP_compidd",
                           TO_CHAR(GDC_WELL.ON_PRODUCTION_DATE,'YYYYMMDD') "PVT_PVUNITCOMP_dttmonprod",
                           TO_CHAR(GDC_WELL.ABANDONMENT_DATE,'YYYYMMDD') "PVT_PVUNITCOMP_dttmabandon",
                           SUBSTR(GDC_WELL.LICENSEE_BA_NAME,1,50) "PVT_PVUNITCOMP_completionlicensee",
                           SUBSTR(LPAD(GDC_WELL.LICENSE_NUM,7,'0'),1,50) "PVT_PVUNITCOMP_completionlicenseno",
                           SUBSTR(GDC_WELL.GSL_UWID,1,100) "PVT_PVUNITCOMP_wellname",
                           TO_CHAR(GDC_WELL.LICENSE_DATE,'YYYYMMDD') "PVT_PVUNITCOMP_dttmlicense",
                           GDC_WELL.BOTTOM_HOLE_LATITUDE "PVT_PVUNITCOMP_latitude",
                           GDC_WELL.BOTTOM_HOLE_LONGITUDE "PVT_PVUNITCOMP_longitude",
                           GDC_WELL.DRILL_TD "PVT_PVUNITCOMP_usernum1",
                           GDC_WELL.MAX_TVD "PVT_PVUNITCOMP_usernum2",
                           SUBSTR(GDC_WELL.ZONE,1,50) "PVT_PVUNITCOMP_usertxt1",
                           SUBSTR(GDC_WELL.TD_SHORT_NAME,1,50) "PVT_PVUNITCOMP_usertxt2",
                           CASE WHEN CHARINDEX('SUSP', UPPER(GDC_WELL.CURRENT_STATUS)) > 0         THEN 'Suspended'
                                WHEN CHARINDEX('ABD', UPPER(GDC_WELL.CURRENT_STATUS)) > 0          THEN 'Abandoned'
                                WHEN CHARINDEX('ABAND', UPPER(GDC_WELL.CURRENT_STATUS)) > 0        THEN 'Abandoned'
                                WHEN CHARINDEX('INJ', UPPER(GDC_WELL.CURRENT_STATUS)) > 0          THEN 'Inj'
                                WHEN CHARINDEX('DISP', UPPER(GDC_WELL.CURRENT_STATUS)) > 0         THEN 'Inj'
                                WHEN CHARINDEX('PUMP', UPPER(GDC_WELL.CURRENT_STATUS)) > 0         THEN 'Producing'
                                WHEN CHARINDEX('PMP', UPPER(GDC_WELL.CURRENT_STATUS)) > 0          THEN 'Producing'
                                WHEN CHARINDEX('FLOW', UPPER(GDC_WELL.CURRENT_STATUS)) > 0         THEN 'Producing'
                                WHEN CHARINDEX('CMPL OIL', UPPER(GDC_WELL.CURRENT_STATUS)) > 0     THEN 'Producing'
                                WHEN CHARINDEX('GAS WELL', UPPER(GDC_WELL.CURRENT_STATUS)) > 0     THEN 'Producing'
                                WHEN CHARINDEX('OIL PRODUCER', UPPER(GDC_WELL.CURRENT_STATUS)) > 0 THEN 'Producing'
                                WHEN CHARINDEX('PRODUCING', UPPER(GDC_WELL.CURRENT_STATUS)) > 0    THEN 'Producing'
                                WHEN CHARINDEX('COMM', UPPER(GDC_WELL.CURRENT_STATUS)) > 0         THEN 'Producing'
                                WHEN CHARINDEX('ACT OIL', UPPER(GDC_WELL.CURRENT_STATUS)) > 0      THEN 'Producing'
                                WHEN CHARINDEX('GASLIFT OIL', UPPER(GDC_WELL.CURRENT_STATUS)) > 0  THEN 'Producing'
                                WHEN CHARINDEX('Capable', UPPER(GDC_WELL.CURRENT_STATUS)) > 0      THEN 'Producing'
                                ELSE 'Unknown'
                                 END "PVT_PVUNITCOMPSTATUS_status",
                           GDC_WELL.CURRENT_STATUS || '-' || TO_CHAR(GDC_WELL.CURRENT_STATUS_DATE,'DD/MM/YYYY') "PVT_PVUNITCOMPSTATUS_usertxt1",
                           IFF(GDC_WELL.WELL_BORE IS NULL,NULL,'commingled') "PVT_PVUNITCOMPSTATUS_commingled",
                           SUBSTR(FIN_CC.COUNTRY_NAME,1,100) "PVT_PVUNIT_division",
                           SUBSTR(FIN_CC.PROV_NAME,1,100) "PVT_PVUNIT_district",
                           SUBSTR(FIN_CC.COREAREA_NAME,1,50) "PVT_PVUNIT_area",
                           SUBSTR(FIN_CC.AREA_NAME,1,50) "PVT_PVUNIT_field",
                           SUBSTR(FIN_CC.CC_NAME || ' (' || FIN_CC.CC_NUM || ')',1,50) "PVT_PVUNIT_unitidpa",
                           DECODE(SUBSTR(FIN_CC.CC_TYPE_CODE,1,1),'C','Yes','No') "PVT_PVUNIT_typpa"
                      FROM DS_PRODVIEW.PVT_PVUNIT PVT_PVUNIT
                     INNER JOIN DS_PRODVIEW.PVT_PVUNITCOMP PVT_PVUNITCOMP
                        ON PVT_PVUNIT.IDREC = PVT_PVUNITCOMP.IDRECPARENT
                      LEFT JOIN FIN_CC
                        ON PVT_PVUNIT.COSTCENTERIDA = FIN_CC.CC_NUM
                      LEFT JOIN GDC_WELL
                        ON PVT_PVUNITCOMP.WELLIDREGULATORY = GDC_WELL.GSL_UWI
                   )
             UNION (
                    SELECT 'Master Data' "PVT_PVUNIT_idrec" ,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL
                   )
             ORDER BY DECODE("PVT_PVUNIT_idrec",'Master Data',0,1) ASC
        dependencies:
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNIT
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_PVIEW_PVT_PVUNIT') }}
        name: STAGE_EDW_PVIEW_MSTR_DATA_WELL_ATTR
        noLinkRefs: []
  name: STAGE_EDW_PVIEW_MSTR_DATA_WELL_ATTR
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
