fileVersion: 1
id: e1b7eaeb-3242-42eb-9523-ec40900490be
name: S_LKP_CURRENCY_RATE_MROC_CURRENT
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DATAVAULT_BUSINESS_VAULT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e90e193-4631-4361-bb2a-bbdcf2158d3f
          stepCounter: e1b7eaeb-3242-42eb-9523-ec40900490be
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: ""
        name: HK_H_LKP_CURRENCY_RATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 66474127-d198-40e0-80bd-2f6e2d963d85
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98379f7a-d03e-43c7-a237-ce6f88cf6d6f
          stepCounter: e1b7eaeb-3242-42eb-9523-ec40900490be
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: CRY_CDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fde63a89-bd51-45c8-8e95-f9dd771d3e0f
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42ad7e61-1c2f-4f97-b4bc-c2777a684839
          stepCounter: e1b7eaeb-3242-42eb-9523-ec40900490be
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: ITN_IDN_CDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fba1abda-51b1-4ab4-a7cc-22fc45611dc9
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 013d26ce-79ac-4532-913c-a27f4e8a63a3
          stepCounter: e1b7eaeb-3242-42eb-9523-ec40900490be
        config: {}
        dataType: TIMESTAMP_NTZ(3)
        defaultValue: ""
        description: ""
        name: RTE_DTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b22d2d32-082a-4242-b691-c4f794992d33
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df2c793d-9c56-4684-9a7f-d10370f97ae4
          stepCounter: e1b7eaeb-3242-42eb-9523-ec40900490be
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: ""
        name: CVT_CRY_CDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b309241-883f-4b79-b090-97fd9c578219
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 771a376d-e376-4af1-8adc-06fcecfc5faa
          stepCounter: e1b7eaeb-3242-42eb-9523-ec40900490be
        config: {}
        dataType: NUMBER(19,0)
        defaultValue: ""
        description: ""
        name: CRY_RTE_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b79b74ac-8a7e-45a2-ae8a-8e16242f736b
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6622118-7e90-451d-85a2-6e4fc8d178ae
          stepCounter: e1b7eaeb-3242-42eb-9523-ec40900490be
        config: {}
        dataType: NUMBER(38,0)
        defaultValue: ""
        description: ""
        name: RTE_ENT_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c60ec6c3-1083-4a20-80ae-1d72efd7c686
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3fb2cab-2829-4f73-beb3-6885611f53f5
          stepCounter: e1b7eaeb-3242-42eb-9523-ec40900490be
        config: {}
        dataType: TIMESTAMP_NTZ(3)
        defaultValue: ""
        description: ""
        name: LST_UPD_DTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 66c421cb-7264-417f-a0b6-6a48580e21d0
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 262bd0b6-96d2-428f-908b-65fc5f7f133f
          stepCounter: e1b7eaeb-3242-42eb-9523-ec40900490be
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: LST_UPD_TME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60c97486-3c3d-49d3-8e3b-f511483ae9b8
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f68fbc5-d8d7-4d92-8729-92162f3aa66a
          stepCounter: e1b7eaeb-3242-42eb-9523-ec40900490be
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: LST_UPD_UID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1fb41ca-b1ce-4887-aa33-730eb4fc2a50
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 942b0cf6-5b3a-4ddd-b95e-9f3f7fd3a52a
          stepCounter: e1b7eaeb-3242-42eb-9523-ec40900490be
        config: {}
        dataType: NUMBER(38,0)
        defaultValue: ""
        description: ""
        name: LST_UPD_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e3b58e6e-cc29-4aad-8466-046a127cfdc1
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae071b04-6fc8-42f6-81b4-dbffba0f1ec5
          stepCounter: e1b7eaeb-3242-42eb-9523-ec40900490be
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CREATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ee11e99-7d68-4e54-83c5-51a7c78f8a26
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ecaf3098-1c36-416c-95f9-da29b47c4167
          stepCounter: e1b7eaeb-3242-42eb-9523-ec40900490be
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: CREATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe479cfe-faee-4c24-a66e-312ca914180f
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6617e2fe-0b0a-4420-b10d-ffb826ad0f31
          stepCounter: e1b7eaeb-3242-42eb-9523-ec40900490be
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: UPDATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: df734a72-bdec-4541-a72b-0cdd7ee34703
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 005bf702-5fb2-4456-958b-a0ae79b651a1
          stepCounter: e1b7eaeb-3242-42eb-9523-ec40900490be
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: UPDATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 695befde-80d2-4231-b9e4-ed36b47feee8
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6922c0b9-b081-4915-8660-836ebb0d72c6
          stepCounter: e1b7eaeb-3242-42eb-9523-ec40900490be
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: RUN_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 326559fd-d281-4af9-a4d6-6ca783591ae6
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4de1940-8fe0-4d44-bd83-8520aa2aca0f
          stepCounter: e1b7eaeb-3242-42eb-9523-ec40900490be
        config: {}
        dataType: TIMESTAMP_NTZ(3)
        defaultValue: ""
        description: ""
        name: FILE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4db56eb-8a9b-4442-8229-4061dd858149
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a00b0e1-f87b-4d01-a587-ff621a95560a
          stepCounter: e1b7eaeb-3242-42eb-9523-ec40900490be
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: The changing hash
        name: DSS_CHANGE_HASH
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1b413c1-db89-4e02-8073-45eeb048bceb
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6b290e4-ebf1-4482-b540-045b38a25480
          stepCounter: e1b7eaeb-3242-42eb-9523-ec40900490be
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Record source
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 525bec70-c24b-4f5c-940d-c278d708b059
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 65857ef3-bbd4-49b1-ad69-79ccb9e50975
          stepCounter: e1b7eaeb-3242-42eb-9523-ec40900490be
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was loaded in the data vault
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bcde4bf1-8d46-4817-9d6e-06005e4dd436
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7646548f-0012-4795-a505-92b550299f01
          stepCounter: e1b7eaeb-3242-42eb-9523-ec40900490be
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row started in the data vault
        isSystemStartDate: true
        name: DSS_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11a7c6a2-2e4e-47b5-89ac-f3727167c5ea
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f94073a8-f1d8-41fb-9795-cf2355fb72a2
          stepCounter: e1b7eaeb-3242-42eb-9523-ec40900490be
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: Version number of a business key in the data vault
        isSurrogateKey: true
        isSystemVersion: true
        name: DSS_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9f3a4824-fbfa-4bb4-9396-9532eabf1319
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6dcd321f-7606-44f5-91ef-6b22a4d06eba
          stepCounter: e1b7eaeb-3242-42eb-9523-ec40900490be
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was inserted in the data vault
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f5635a7-8f27-4a8f-91c7-67d291ccf914
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_LKP_CURRENCY_RATE_MROC: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATAVAULT_RAW_VAULT
            nodeName: S_LKP_CURRENCY_RATE_MROC
        join:
          joinCondition: |-
            FROM {{ ref('DATAVAULT_RAW_VAULT','S_LKP_CURRENCY_RATE_MROC') }} s_lkp_currency_rate_mroc
             INNER JOIN (
                    SELECT hk_h_lkp_currency_rate,
                           MAX(dss_start_date) AS dss_start_date
                      FROM {{ ref('DATAVAULT_RAW_VAULT','S_LKP_CURRENCY_RATE_MROC') }}
                     GROUP BY hk_h_lkp_currency_rate
                   ) curr
                ON curr.hk_h_lkp_currency_rate = s_lkp_currency_rate_mroc.hk_h_lkp_currency_rate
               AND curr.dss_start_date = s_lkp_currency_rate_mroc.dss_start_date
        name: S_LKP_CURRENCY_RATE_MROC_CURRENT
        noLinkRefs: []
  name: S_LKP_CURRENCY_RATE_MROC_CURRENT
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
