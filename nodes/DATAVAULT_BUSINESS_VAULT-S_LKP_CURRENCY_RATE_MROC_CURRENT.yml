fileVersion: 1
id: e3324d81-d924-4e97-8101-a80f4661d934
name: S_LKP_CURRENCY_RATE_MROC_CURRENT
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DATAVAULT_BUSINESS_VAULT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4379e1f1-3087-4c71-a29b-f0b3f2e5df4c
          stepCounter: e3324d81-d924-4e97-8101-a80f4661d934
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: ""
        name: HK_H_LKP_CURRENCY_RATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a5122c6f-56fc-4b79-acb9-ba70a39573b3
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f1fb54b2-b8cc-4d47-aa60-ed3ae1385d33
          stepCounter: e3324d81-d924-4e97-8101-a80f4661d934
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: CRY_CDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3152089-653d-44a8-a87d-daa37776db8f
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c90d4637-0a8d-480f-bced-4ec6d25bfb01
          stepCounter: e3324d81-d924-4e97-8101-a80f4661d934
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: ITN_IDN_CDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 45532583-af86-405f-9333-ca206940f70a
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 840756f5-eecb-41e0-87d4-302a5c38d54a
          stepCounter: e3324d81-d924-4e97-8101-a80f4661d934
        config: {}
        dataType: TIMESTAMP_NTZ(3)
        defaultValue: ""
        description: ""
        name: RTE_DTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 701a2483-f932-462c-b58c-763363ce879d
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dbc2f754-13ae-4547-946a-1e4881290f94
          stepCounter: e3324d81-d924-4e97-8101-a80f4661d934
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: ""
        name: CVT_CRY_CDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84896e62-9431-4afc-b480-685a590fdd84
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a14a5c45-bcea-4155-93f3-e539841ed0d1
          stepCounter: e3324d81-d924-4e97-8101-a80f4661d934
        config: {}
        dataType: NUMBER(19,0)
        defaultValue: ""
        description: ""
        name: CRY_RTE_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a03a4bf-9f0e-4939-818c-1271eecaadd9
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 58995485-dd45-4e94-a64f-e44225ac2dca
          stepCounter: e3324d81-d924-4e97-8101-a80f4661d934
        config: {}
        dataType: NUMBER(38,0)
        defaultValue: ""
        description: ""
        name: RTE_ENT_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9f5825b2-53fd-45c9-b51a-49e7002b1615
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07d3f1a3-58ec-4f44-bdea-d1c39cbccd57
          stepCounter: e3324d81-d924-4e97-8101-a80f4661d934
        config: {}
        dataType: TIMESTAMP_NTZ(3)
        defaultValue: ""
        description: ""
        name: LST_UPD_DTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1246b4cd-777c-4e46-988a-bd5dc8d41492
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dca301f9-abb5-467c-b1cd-daa4186b898e
          stepCounter: e3324d81-d924-4e97-8101-a80f4661d934
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: LST_UPD_TME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1509eb8d-99b9-4e51-8e15-5cb2aa2a893f
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ead76c3-4f44-4c85-9b7b-d44bf0d9cff4
          stepCounter: e3324d81-d924-4e97-8101-a80f4661d934
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: LST_UPD_UID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b36aca6a-e61a-4f46-96f9-4de66f6ac018
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69332ab7-008d-4e1d-9f83-db7dd315eeb2
          stepCounter: e3324d81-d924-4e97-8101-a80f4661d934
        config: {}
        dataType: NUMBER(38,0)
        defaultValue: ""
        description: ""
        name: LST_UPD_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 70feba70-829e-4e67-9c34-ef39aec13338
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3059b229-831d-40f4-bca6-2b38e2ae8136
          stepCounter: e3324d81-d924-4e97-8101-a80f4661d934
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CREATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6575d1cd-6542-4d66-bd99-d5269151c1c9
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40cd3826-b163-42ac-a666-90b5fee6f659
          stepCounter: e3324d81-d924-4e97-8101-a80f4661d934
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: CREATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 125ca91b-3e75-48f0-9357-001330529f69
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc729cf7-6678-4fa5-b6d7-0a977c700001
          stepCounter: e3324d81-d924-4e97-8101-a80f4661d934
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: UPDATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de78d8e9-0f8d-4efd-8bd0-f2ab1101259b
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d07c8ffa-539f-4041-96b2-0a97aa12e3f2
          stepCounter: e3324d81-d924-4e97-8101-a80f4661d934
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: UPDATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ec5acc4-2516-44de-b6a0-5e36b334a00d
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0df8d38-deb4-4316-b79d-5c1bd993f05a
          stepCounter: e3324d81-d924-4e97-8101-a80f4661d934
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: RUN_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 61805f78-08ad-4c89-945a-bf29fa895a87
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39f47053-2604-4e00-987c-f36c226b84ad
          stepCounter: e3324d81-d924-4e97-8101-a80f4661d934
        config: {}
        dataType: TIMESTAMP_NTZ(3)
        defaultValue: ""
        description: ""
        name: FILE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 95f07f91-1a07-45f5-bb0f-4bd0c2df0928
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86bd3a2c-3022-4c29-a90a-0fab2adfa1de
          stepCounter: e3324d81-d924-4e97-8101-a80f4661d934
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: The changing hash
        name: DSS_CHANGE_HASH
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 830bc1de-ba79-4220-9056-63e0392bc49a
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d933cec4-f69f-40e9-8dd1-68f9258e93ea
          stepCounter: e3324d81-d924-4e97-8101-a80f4661d934
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Record source
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 605c6caa-72a3-47d7-9fca-268ed6041321
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af09fc60-dedc-4a16-b8b8-6b3ebc226a76
          stepCounter: e3324d81-d924-4e97-8101-a80f4661d934
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was loaded in the data vault
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c2161da2-8e68-4113-83e4-581baab058a9
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0813fcc6-2c7c-4dc5-afa2-b42b9a7b5696
          stepCounter: e3324d81-d924-4e97-8101-a80f4661d934
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row started in the data vault
        isSystemStartDate: true
        name: DSS_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4dc5cf49-c753-478f-a9d3-596cab7d08b8
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b4dbc90-c8a5-4daa-a480-336568124272
          stepCounter: e3324d81-d924-4e97-8101-a80f4661d934
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: Version number of a business key in the data vault
        isSurrogateKey: true
        isSystemVersion: true
        name: DSS_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f603733-941a-4c74-a6b7-adcacfcdf5d3
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67203176-5d84-4c50-b1c7-5a70f0bd3478
          stepCounter: e3324d81-d924-4e97-8101-a80f4661d934
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was inserted in the data vault
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48e6fc11-386e-4640-a52c-6bb51e8e1214
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_LKP_CURRENCY_RATE_MROC: 1e5d6798-74eb-43c0-a254-8af6407928e6
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATAVAULT_RAW_VAULT
            nodeName: S_LKP_CURRENCY_RATE_MROC
        join:
          joinCondition: |-
            FROM {{ ref('DATAVAULT_RAW_VAULT','S_LKP_CURRENCY_RATE_MROC') }} s_lkp_currency_rate_mroc
             INNER JOIN (
                    SELECT hk_h_lkp_currency_rate,
                           MAX(dss_start_date) AS dss_start_date
                      FROM {{ ref('DATAVAULT_RAW_VAULT','S_LKP_CURRENCY_RATE_MROC') }}
                     GROUP BY hk_h_lkp_currency_rate
                   ) curr
                ON curr.hk_h_lkp_currency_rate = s_lkp_currency_rate_mroc.hk_h_lkp_currency_rate
               AND curr.dss_start_date = s_lkp_currency_rate_mroc.dss_start_date
        name: S_LKP_CURRENCY_RATE_MROC_CURRENT
        noLinkRefs: []
  name: S_LKP_CURRENCY_RATE_MROC_CURRENT
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
