fileVersion: 1
id: 7e136990-107e-4b51-8d67-b9a6c85f7a12
name: S_LKP_CURRENCY_CODE_MROC_HISTORY
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DATAVAULT_BUSINESS_VAULT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f07bd12b-e32b-499d-9c44-7ee43ee25d16
          stepCounter: 7e136990-107e-4b51-8d67-b9a6c85f7a12
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: ""
        name: HK_H_LKP_CURRENCY_CODE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07efda92-c0d8-4830-9465-a58a5110d9a2
                stepCounter: 7b5c15aa-2af4-4a53-8ed1-e1b98e5fe5af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da199dc9-c378-419c-8037-8b37498cc786
          stepCounter: 7e136990-107e-4b51-8d67-b9a6c85f7a12
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: CRY_CDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e8842de3-40e3-446f-93da-cff110c9e505
                stepCounter: 7b5c15aa-2af4-4a53-8ed1-e1b98e5fe5af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b319846-6513-4c7c-b7b8-2ed215d83dfe
          stepCounter: 7e136990-107e-4b51-8d67-b9a6c85f7a12
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CRY_DES_TXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6aa5c789-c924-4b36-a301-6a0745cc315e
                stepCounter: 7b5c15aa-2af4-4a53-8ed1-e1b98e5fe5af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e540733-c78b-4233-8171-e060353d7c73
          stepCounter: 7e136990-107e-4b51-8d67-b9a6c85f7a12
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: DCL_PLS_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c738c2fa-47ab-4c1d-a29d-0a9a6e458e86
                stepCounter: 7b5c15aa-2af4-4a53-8ed1-e1b98e5fe5af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66de1ae1-c454-48ef-b3fb-803327b2e983
          stepCounter: 7e136990-107e-4b51-8d67-b9a6c85f7a12
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: SYM_TXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b75fa801-cf9b-4339-8a65-4807b3dc5e20
                stepCounter: 7b5c15aa-2af4-4a53-8ed1-e1b98e5fe5af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 83cd4af2-f462-4375-82d9-ce25d5332a38
          stepCounter: 7e136990-107e-4b51-8d67-b9a6c85f7a12
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: NULLIF_SYM_DES_TXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a6685fbb-dc6c-4349-8351-bf9277101666
                stepCounter: 7b5c15aa-2af4-4a53-8ed1-e1b98e5fe5af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c53c2023-964c-4dfb-8a25-3fbfffae4aae
          stepCounter: 7e136990-107e-4b51-8d67-b9a6c85f7a12
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: SYM_DES_TXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07407b8a-a785-4383-b8b0-34f130076cd5
                stepCounter: 7b5c15aa-2af4-4a53-8ed1-e1b98e5fe5af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8575722-6812-4c2b-b083-b17ec2059fce
          stepCounter: 7e136990-107e-4b51-8d67-b9a6c85f7a12
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: NULLIF_SYM_PSN_CDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e6dacfc-0db5-4212-b6ae-51cdeb9963de
                stepCounter: 7b5c15aa-2af4-4a53-8ed1-e1b98e5fe5af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e0fb945-7dec-4576-b0ed-d32e22972328
          stepCounter: 7e136990-107e-4b51-8d67-b9a6c85f7a12
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: SYM_PSN_CDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b52972e7-f31e-473b-8e52-4e572eba2faf
                stepCounter: 7b5c15aa-2af4-4a53-8ed1-e1b98e5fe5af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf47b7a8-9883-4a1d-a28c-afeee645e2d8
          stepCounter: 7e136990-107e-4b51-8d67-b9a6c85f7a12
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: DCL_SPR_TXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3fa6763-4664-4f15-ad6c-698e2e4c500b
                stepCounter: 7b5c15aa-2af4-4a53-8ed1-e1b98e5fe5af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b06c64c9-f3e1-4b48-8fa3-4168a30ad13a
          stepCounter: 7e136990-107e-4b51-8d67-b9a6c85f7a12
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: TSS_SPR_TXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b7904f4-cad1-450f-9072-aa80ff2ebfa0
                stepCounter: 7b5c15aa-2af4-4a53-8ed1-e1b98e5fe5af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 509d6f13-0191-4749-90d9-92b9e26af186
          stepCounter: 7e136990-107e-4b51-8d67-b9a6c85f7a12
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: IPT_DCL_SPR_TXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4d65b0b7-f355-4533-b9b4-d99fb41dbe3c
                stepCounter: 7b5c15aa-2af4-4a53-8ed1-e1b98e5fe5af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9151d434-f247-4286-9026-4ab3bfda9346
          stepCounter: 7e136990-107e-4b51-8d67-b9a6c85f7a12
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: SGN_SYM_TXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ffbb95c8-2455-4db6-b95d-054b169305c0
                stepCounter: 7b5c15aa-2af4-4a53-8ed1-e1b98e5fe5af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aedff44e-52eb-4f81-8106-6998d3f38dc7
          stepCounter: 7e136990-107e-4b51-8d67-b9a6c85f7a12
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: NULLIF_SGN_POS_TXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f00cfc9-8ee4-48fe-878f-574ec757abf3
                stepCounter: 7b5c15aa-2af4-4a53-8ed1-e1b98e5fe5af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df6720f9-f963-4c19-bc5d-46c4ebc23e12
          stepCounter: 7e136990-107e-4b51-8d67-b9a6c85f7a12
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: SGN_POS_TXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2237af3c-742a-4bb8-999b-921e2760992d
                stepCounter: 7b5c15aa-2af4-4a53-8ed1-e1b98e5fe5af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f3777ad2-56b2-4055-b6e8-35277be47438
          stepCounter: 7e136990-107e-4b51-8d67-b9a6c85f7a12
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: NULLIF_SGN_NEG_TXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f8d35a9-0100-4bf9-90f5-8486dc25cfdf
                stepCounter: 7b5c15aa-2af4-4a53-8ed1-e1b98e5fe5af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e4f87dc7-884d-4983-a023-56b0f2935af8
          stepCounter: 7e136990-107e-4b51-8d67-b9a6c85f7a12
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: SGN_NEG_TXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 732316bb-9c89-48a7-b591-cf7c21b7867f
                stepCounter: 7b5c15aa-2af4-4a53-8ed1-e1b98e5fe5af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 657a72a9-1e9c-4d13-a097-9882b5d43423
          stepCounter: 7e136990-107e-4b51-8d67-b9a6c85f7a12
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: SGN_PSN_CDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ee6e350-13ba-402f-ac04-95a122bc708b
                stepCounter: 7b5c15aa-2af4-4a53-8ed1-e1b98e5fe5af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2062871-cbb4-4903-869e-6c910104fec9
          stepCounter: 7e136990-107e-4b51-8d67-b9a6c85f7a12
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: LST_UPD_DTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0faee27d-89d2-4a04-a63c-8ec02eb8492c
                stepCounter: 7b5c15aa-2af4-4a53-8ed1-e1b98e5fe5af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e76bfb0-5d4a-4fa0-9acd-6849845809a3
          stepCounter: 7e136990-107e-4b51-8d67-b9a6c85f7a12
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: LST_UPD_TME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ad354769-7e5e-4683-82b4-e218513f8dbc
                stepCounter: 7b5c15aa-2af4-4a53-8ed1-e1b98e5fe5af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4411d6f2-3cb6-4458-9ab1-59e365611484
          stepCounter: 7e136990-107e-4b51-8d67-b9a6c85f7a12
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: LST_UPD_UID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d4498dd5-fd33-4642-a2d5-da83691d5c80
                stepCounter: 7b5c15aa-2af4-4a53-8ed1-e1b98e5fe5af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06e37891-5840-4c6c-9e37-ed3009252c52
          stepCounter: 7e136990-107e-4b51-8d67-b9a6c85f7a12
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: LST_UPD_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a873fec-e2e2-4f94-842e-f95a3c971b45
                stepCounter: 7b5c15aa-2af4-4a53-8ed1-e1b98e5fe5af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6e66adc-4b72-466c-ab4e-03b8edd55f2a
          stepCounter: 7e136990-107e-4b51-8d67-b9a6c85f7a12
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CREATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f979dd08-2080-4c2b-826d-7124428e9978
                stepCounter: 7b5c15aa-2af4-4a53-8ed1-e1b98e5fe5af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0fb72c1f-a769-47be-b95b-2f40120d86d0
          stepCounter: 7e136990-107e-4b51-8d67-b9a6c85f7a12
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: CREATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f7a7ccb-510d-4be3-ad39-2d8a65dbe71c
                stepCounter: 7b5c15aa-2af4-4a53-8ed1-e1b98e5fe5af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ea9e121-8342-4d67-a507-d239a33b7df4
          stepCounter: 7e136990-107e-4b51-8d67-b9a6c85f7a12
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: UPDATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 745859e0-e790-443f-bdea-b70b9d541c2c
                stepCounter: 7b5c15aa-2af4-4a53-8ed1-e1b98e5fe5af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d0bea096-5192-4dd4-ad5b-e4cd16d8d4ff
          stepCounter: 7e136990-107e-4b51-8d67-b9a6c85f7a12
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: UPDATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0a9e746e-f017-4312-a4dd-18d5b607ad9e
                stepCounter: 7b5c15aa-2af4-4a53-8ed1-e1b98e5fe5af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b287889f-3298-48d0-b5b7-0b8d4d298c9d
          stepCounter: 7e136990-107e-4b51-8d67-b9a6c85f7a12
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: RUN_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 789ea24d-1c48-4ad1-9d2a-4b0789d176b0
                stepCounter: 7b5c15aa-2af4-4a53-8ed1-e1b98e5fe5af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f89ea2c2-36df-44db-82a9-2e56b1f7c95d
          stepCounter: 7e136990-107e-4b51-8d67-b9a6c85f7a12
        config: {}
        dataType: TIMESTAMP_NTZ(3)
        defaultValue: ""
        description: ""
        name: FILE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d7cdc051-c329-4e08-a0a6-a56fd00e6ea4
                stepCounter: 7b5c15aa-2af4-4a53-8ed1-e1b98e5fe5af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2a8c672-2886-420a-94d4-905ff8ac67e9
          stepCounter: 7e136990-107e-4b51-8d67-b9a6c85f7a12
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: The changing hash
        name: DSS_CHANGE_HASH
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bbecc86d-468c-4667-ad13-0c9e77b8955b
                stepCounter: 7b5c15aa-2af4-4a53-8ed1-e1b98e5fe5af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa66a8be-cb44-46f0-8fa6-cb350640a484
          stepCounter: 7e136990-107e-4b51-8d67-b9a6c85f7a12
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Record source
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dd7d2aaf-23bf-4f24-a31c-ea99b53be5a4
                stepCounter: 7b5c15aa-2af4-4a53-8ed1-e1b98e5fe5af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 731343d0-401c-4369-9762-284caa1e666c
          stepCounter: 7e136990-107e-4b51-8d67-b9a6c85f7a12
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was loaded in the data vault
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d3a1f99-b16a-40bc-ad11-5291f622bd71
                stepCounter: 7b5c15aa-2af4-4a53-8ed1-e1b98e5fe5af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94f3ff01-e8d3-4823-8445-a53e8b01abb3
          stepCounter: 7e136990-107e-4b51-8d67-b9a6c85f7a12
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row started in the data vault
        isSystemStartDate: true
        name: DSS_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48e45874-4a2d-4e9b-9b8d-9f6077b1dc96
                stepCounter: 7b5c15aa-2af4-4a53-8ed1-e1b98e5fe5af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3546690-92d1-4ae3-b88c-89bb450d8372
          stepCounter: 7e136990-107e-4b51-8d67-b9a6c85f7a12
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: Version number of a business key in the data vault
        isSurrogateKey: true
        isSystemVersion: true
        name: DSS_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 928433b9-6710-4415-9015-7c2294b9bddf
                stepCounter: 7b5c15aa-2af4-4a53-8ed1-e1b98e5fe5af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dba91814-cfdc-40ae-a337-45a5b0b1e53b
          stepCounter: 7e136990-107e-4b51-8d67-b9a6c85f7a12
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was inserted in the data vault
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 10af0323-1ddd-4ed6-aad4-c4b77eba7eda
                stepCounter: 7b5c15aa-2af4-4a53-8ed1-e1b98e5fe5af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05868ef3-c9da-4815-8f7d-64b4bc1e3b58
          stepCounter: 7e136990-107e-4b51-8d67-b9a6c85f7a12
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: End date determined by the next Satellite change record dss_start_date
        isSystemEndDate: true
        name: DSS_END_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: LEAD(dss_start_date, 1, '9999-12-31') OVER(PARTITION BY hk_h_lkp_currency_code ORDER BY dss_start_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b05eddb-38e1-4079-9a47-6388852e93ec
          stepCounter: 7e136990-107e-4b51-8d67-b9a6c85f7a12
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: CurrentFlag 'N' unless next Satellite change record dss_start_date is null, indicating this is the most current record.
        isSurrogateKey: true
        isSystemCurrentFlag: true
        name: DSS_CURRENT_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN LEAD(dss_start_date, 1, NULL) OVER(PARTITION BY hk_h_lkp_currency_code ORDER BY dss_start_date) IS NULL THEN 'Y'
                          ELSE 'N'
                           END
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_LKP_CURRENCY_CODE_MROC: 7b5c15aa-2af4-4a53-8ed1-e1b98e5fe5af
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATAVAULT_RAW_VAULT
            nodeName: S_LKP_CURRENCY_CODE_MROC
        join:
          joinCondition: FROM {{ ref('DATAVAULT_RAW_VAULT','S_LKP_CURRENCY_CODE_MROC') }} s_lkp_currency_code_mroc
        name: S_LKP_CURRENCY_CODE_MROC_HISTORY
        noLinkRefs: []
  name: S_LKP_CURRENCY_CODE_MROC_HISTORY
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
