fileVersion: 1
id: 64883f2a-1a3e-4ef9-8406-7bef1dbb55f2
name: S_LKP_CURRENCY_CODE_MROC_HISTORY
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DATAVAULT_BUSINESS_VAULT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ed0d83f-fb27-4d90-93b0-a91276941044
          stepCounter: 64883f2a-1a3e-4ef9-8406-7bef1dbb55f2
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: ""
        name: HK_H_LKP_CURRENCY_CODE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1bf621c7-15fe-486d-9955-ae201a5057bf
                stepCounter: b791dd62-a342-4ba6-a201-9d503675fff8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71eb9084-254a-425d-a7cc-b2469235fe2e
          stepCounter: 64883f2a-1a3e-4ef9-8406-7bef1dbb55f2
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: CRY_CDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5192090-9b91-4da4-8034-2985ce267cb9
                stepCounter: b791dd62-a342-4ba6-a201-9d503675fff8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5dd2e0d7-7feb-47a9-9d2b-4cd6003f0e6b
          stepCounter: 64883f2a-1a3e-4ef9-8406-7bef1dbb55f2
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CRY_DES_TXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 566551e1-e894-472e-9df4-f0814484b3a4
                stepCounter: b791dd62-a342-4ba6-a201-9d503675fff8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 43ac7420-39eb-4c2e-91c8-86fb8f5999be
          stepCounter: 64883f2a-1a3e-4ef9-8406-7bef1dbb55f2
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: DCL_PLS_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4602e5eb-f624-49f5-8eb6-602eb7ee2956
                stepCounter: b791dd62-a342-4ba6-a201-9d503675fff8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5f69fde-d982-4161-8ab2-f37f4346ef34
          stepCounter: 64883f2a-1a3e-4ef9-8406-7bef1dbb55f2
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: SYM_TXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0265f8db-7d5b-4313-b30f-08e61a7b2762
                stepCounter: b791dd62-a342-4ba6-a201-9d503675fff8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 808d9c2c-e72d-4af9-8401-13df9eb46815
          stepCounter: 64883f2a-1a3e-4ef9-8406-7bef1dbb55f2
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: NULLIF_SYM_DES_TXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03ba2bcc-d199-4510-a621-27758ad5f05c
                stepCounter: b791dd62-a342-4ba6-a201-9d503675fff8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69df8ec1-9881-415b-a055-0f01433a6c77
          stepCounter: 64883f2a-1a3e-4ef9-8406-7bef1dbb55f2
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: SYM_DES_TXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4615a7f2-f28d-4d08-a46f-326e3305daaf
                stepCounter: b791dd62-a342-4ba6-a201-9d503675fff8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3077edaa-220e-4e16-bc68-b9cb7f40c5e1
          stepCounter: 64883f2a-1a3e-4ef9-8406-7bef1dbb55f2
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: NULLIF_SYM_PSN_CDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1a94adf-ddb7-45e4-a5b0-5792578d9553
                stepCounter: b791dd62-a342-4ba6-a201-9d503675fff8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97c8eb69-e715-4cc7-b438-deb895a15419
          stepCounter: 64883f2a-1a3e-4ef9-8406-7bef1dbb55f2
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: SYM_PSN_CDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7bd60a16-b6a4-4519-b331-9238d65a67f1
                stepCounter: b791dd62-a342-4ba6-a201-9d503675fff8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6780068e-d894-4c45-afbd-baa7240979ce
          stepCounter: 64883f2a-1a3e-4ef9-8406-7bef1dbb55f2
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: DCL_SPR_TXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a17f7bfd-facf-4407-96e9-d980464e898a
                stepCounter: b791dd62-a342-4ba6-a201-9d503675fff8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f55abfb-8a16-4958-b8f9-171d9fcea3f8
          stepCounter: 64883f2a-1a3e-4ef9-8406-7bef1dbb55f2
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: TSS_SPR_TXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 697a95cf-197f-482d-b1bc-3e791a548a43
                stepCounter: b791dd62-a342-4ba6-a201-9d503675fff8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 597247b5-cfae-4add-a9e5-0cfab20bebf7
          stepCounter: 64883f2a-1a3e-4ef9-8406-7bef1dbb55f2
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: IPT_DCL_SPR_TXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3eedd3b5-3fb1-4d37-b10e-de0800bb24c1
                stepCounter: b791dd62-a342-4ba6-a201-9d503675fff8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb7fe08f-a240-4dae-862b-4e58a53c63af
          stepCounter: 64883f2a-1a3e-4ef9-8406-7bef1dbb55f2
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: SGN_SYM_TXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a66118ce-5861-43e2-9b7b-52c1d40b4526
                stepCounter: b791dd62-a342-4ba6-a201-9d503675fff8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5807297b-557a-45f4-aa9b-105693705ee4
          stepCounter: 64883f2a-1a3e-4ef9-8406-7bef1dbb55f2
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: NULLIF_SGN_POS_TXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 356685e1-80a8-4bc4-981c-733a39a87313
                stepCounter: b791dd62-a342-4ba6-a201-9d503675fff8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b71360f0-d3b4-41b3-b0d2-6ceedeb1e0db
          stepCounter: 64883f2a-1a3e-4ef9-8406-7bef1dbb55f2
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: SGN_POS_TXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7201c649-9a36-4043-b5f5-e825148d370e
                stepCounter: b791dd62-a342-4ba6-a201-9d503675fff8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c67f06f9-a250-4808-a35a-1dda46d6fcd1
          stepCounter: 64883f2a-1a3e-4ef9-8406-7bef1dbb55f2
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: NULLIF_SGN_NEG_TXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2b3ca695-f18a-4e79-8215-dc505deac642
                stepCounter: b791dd62-a342-4ba6-a201-9d503675fff8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f4e10534-6a14-4f3f-890f-487ca47d98ba
          stepCounter: 64883f2a-1a3e-4ef9-8406-7bef1dbb55f2
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: SGN_NEG_TXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b13c386-8258-4432-af86-01c7dc144b8e
                stepCounter: b791dd62-a342-4ba6-a201-9d503675fff8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3451669d-6d0f-4b69-9c17-a44711f5e3fd
          stepCounter: 64883f2a-1a3e-4ef9-8406-7bef1dbb55f2
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: SGN_PSN_CDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee2974d9-ba19-4d0b-a79f-57126a532e82
                stepCounter: b791dd62-a342-4ba6-a201-9d503675fff8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dfd6b11f-3154-4c61-96e7-2c99aa94d59d
          stepCounter: 64883f2a-1a3e-4ef9-8406-7bef1dbb55f2
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: LST_UPD_DTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 53bdd1c6-2a80-4343-9b78-92750cf074e2
                stepCounter: b791dd62-a342-4ba6-a201-9d503675fff8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ab0b2d9-7f54-42eb-b010-ac732aebbf72
          stepCounter: 64883f2a-1a3e-4ef9-8406-7bef1dbb55f2
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: LST_UPD_TME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9b6ca1c-407d-4fa4-8d6d-93e85ebc9753
                stepCounter: b791dd62-a342-4ba6-a201-9d503675fff8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6925d35c-e88c-480e-ba59-acbbc2ca5705
          stepCounter: 64883f2a-1a3e-4ef9-8406-7bef1dbb55f2
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: LST_UPD_UID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4710d84c-f199-4e77-a049-1ead7fb9d3ef
                stepCounter: b791dd62-a342-4ba6-a201-9d503675fff8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97c295b9-0e48-4aea-ac69-ba3367d7ac96
          stepCounter: 64883f2a-1a3e-4ef9-8406-7bef1dbb55f2
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: LST_UPD_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 007d3629-83b1-44a2-a34c-2eebfde9302c
                stepCounter: b791dd62-a342-4ba6-a201-9d503675fff8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7171e3ab-55df-4267-be6d-d69cb635f9c9
          stepCounter: 64883f2a-1a3e-4ef9-8406-7bef1dbb55f2
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CREATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 269cf514-b454-40b4-8b88-ce9f723bd1ba
                stepCounter: b791dd62-a342-4ba6-a201-9d503675fff8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6551bbc7-af38-4d81-9f6d-7450fee8ee68
          stepCounter: 64883f2a-1a3e-4ef9-8406-7bef1dbb55f2
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: CREATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ede7a218-8299-401f-b0cd-df2a51675ccc
                stepCounter: b791dd62-a342-4ba6-a201-9d503675fff8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1fa7a5af-b860-46bd-a75b-668fafc845e2
          stepCounter: 64883f2a-1a3e-4ef9-8406-7bef1dbb55f2
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: UPDATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f793a44-9b81-488d-8027-64fd77b0b507
                stepCounter: b791dd62-a342-4ba6-a201-9d503675fff8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5cfda535-a95c-4d54-a3ac-0f1490f93d9f
          stepCounter: 64883f2a-1a3e-4ef9-8406-7bef1dbb55f2
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: UPDATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cbbd110d-aae8-4696-a010-b5eb4c6a17b6
                stepCounter: b791dd62-a342-4ba6-a201-9d503675fff8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c982e844-29ea-4cb9-b3e7-ec35095bdc3b
          stepCounter: 64883f2a-1a3e-4ef9-8406-7bef1dbb55f2
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: RUN_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ffa04026-a08a-4473-90df-50fe431ec1a7
                stepCounter: b791dd62-a342-4ba6-a201-9d503675fff8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0e07139-c536-4714-8b89-3784b947c637
          stepCounter: 64883f2a-1a3e-4ef9-8406-7bef1dbb55f2
        config: {}
        dataType: TIMESTAMP_NTZ(3)
        defaultValue: ""
        description: ""
        name: FILE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 96b38e09-8c1a-4dc4-99cb-74e3e5df5e9d
                stepCounter: b791dd62-a342-4ba6-a201-9d503675fff8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b3163ea-96f2-4a7a-96fb-d6f7caa4db2d
          stepCounter: 64883f2a-1a3e-4ef9-8406-7bef1dbb55f2
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: The changing hash
        name: DSS_CHANGE_HASH
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a92c520f-6dd1-47b3-b8d9-84caf6cdb948
                stepCounter: b791dd62-a342-4ba6-a201-9d503675fff8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92b5d5eb-5f88-439c-8414-6e3846fcc260
          stepCounter: 64883f2a-1a3e-4ef9-8406-7bef1dbb55f2
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Record source
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b523564d-3195-4652-ba4c-4c42ee78e307
                stepCounter: b791dd62-a342-4ba6-a201-9d503675fff8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fdb8a46c-ca92-4e78-8e7c-337ec41420b1
          stepCounter: 64883f2a-1a3e-4ef9-8406-7bef1dbb55f2
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was loaded in the data vault
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bd446236-ad0b-4d68-a4f5-1cd33e07aa5e
                stepCounter: b791dd62-a342-4ba6-a201-9d503675fff8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f0e70c8-f0f5-4d9c-84aa-a4a5e8f56c30
          stepCounter: 64883f2a-1a3e-4ef9-8406-7bef1dbb55f2
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row started in the data vault
        isSystemStartDate: true
        name: DSS_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c6d65ddb-3a6b-44f9-a853-8fd7ab771072
                stepCounter: b791dd62-a342-4ba6-a201-9d503675fff8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7238b5b-bd6f-432b-852e-d4d99c81a724
          stepCounter: 64883f2a-1a3e-4ef9-8406-7bef1dbb55f2
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: Version number of a business key in the data vault
        isSurrogateKey: true
        isSystemVersion: true
        name: DSS_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b8fd7798-197c-428a-b5fc-a73a4667cbd5
                stepCounter: b791dd62-a342-4ba6-a201-9d503675fff8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b56b4c1-9abb-47e7-bb3d-dc827bdb2994
          stepCounter: 64883f2a-1a3e-4ef9-8406-7bef1dbb55f2
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was inserted in the data vault
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb968e3f-4000-494f-ac9e-fe1383abd4c0
                stepCounter: b791dd62-a342-4ba6-a201-9d503675fff8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 542f25a6-c6be-4b18-bd36-426f1924944a
          stepCounter: 64883f2a-1a3e-4ef9-8406-7bef1dbb55f2
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: End date determined by the next Satellite change record dss_start_date
        isSystemEndDate: true
        name: DSS_END_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: LEAD(dss_start_date, 1, '9999-12-31') OVER(PARTITION BY hk_h_lkp_currency_code ORDER BY dss_start_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d07ce1e-c604-4491-8efa-b32b454e1aa8
          stepCounter: 64883f2a-1a3e-4ef9-8406-7bef1dbb55f2
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: CurrentFlag 'N' unless next Satellite change record dss_start_date is null, indicating this is the most current record.
        isSurrogateKey: true
        isSystemCurrentFlag: true
        name: DSS_CURRENT_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN LEAD(dss_start_date, 1, NULL) OVER(PARTITION BY hk_h_lkp_currency_code ORDER BY dss_start_date) IS NULL THEN 'Y'
                          ELSE 'N'
                           END
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_LKP_CURRENCY_CODE_MROC: b791dd62-a342-4ba6-a201-9d503675fff8
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATAVAULT_RAW_VAULT
            nodeName: S_LKP_CURRENCY_CODE_MROC
        join:
          joinCondition: FROM {{ ref('DATAVAULT_RAW_VAULT','S_LKP_CURRENCY_CODE_MROC') }} s_lkp_currency_code_mroc
        name: S_LKP_CURRENCY_CODE_MROC_HISTORY
        noLinkRefs: []
  name: S_LKP_CURRENCY_CODE_MROC_HISTORY
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
