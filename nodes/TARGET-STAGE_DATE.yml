fileVersion: 1
id: 893768c0-a146-4a3d-b378-4c77bb2c900a
name: STAGE_DATE
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aafcacbe-0298-4ee3-a8ef-50241de3976d
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: stage_date_rs.calendar_date=dim_date.calendar_date
        name: DIM_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aafcacbe-0298-4ee3-a8ef-50241de3976d
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: TO_NUMBER(TO_CHAR(calendar_date, 'YYYYMMDD'), '99999999')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e9a23f8-a434-471a-86fd-2b8c1396ce6f
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: The calendar date for this row.
        isBusinessKey: true
        name: CALENDAR_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e9a23f8-a434-471a-86fd-2b8c1396ce6f
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: calendar_date
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eece6f6d-7899-41cd-9402-5fc421805e2f
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: 'The day in the week. Format DDD. Example: mon, tue, wed.'
        name: CAL_DAY_IN_WEEK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eece6f6d-7899-41cd-9402-5fc421805e2f
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: TO_CHAR(calendar_date, 'Dy')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7fd69b5-a10c-4cac-8c05-0dcd4320a27b
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The day number in the week. 1-7 where Sunday is day 1.
        name: CAL_DAY_IN_WEEK_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b7fd69b5-a10c-4cac-8c05-0dcd4320a27b
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: TO_NUMBER(TO_CHAR(DATE_PART('dw', calendar_date)), '9')+1
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f4181781-f07c-4ac1-80ca-e4db98aff4cf
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The day in the month 1-31.
        name: CAL_DAY_IN_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f4181781-f07c-4ac1-80ca-e4db98aff4cf
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: TO_NUMBER(TO_CHAR(calendar_date, 'DD'), '99')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 12b5e1b1-a7e8-4c83-bdf0-a0ac76cbce37
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The day in the year 1-366.
        name: CAL_DAY_IN_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 12b5e1b1-a7e8-4c83-bdf0-a0ac76cbce37
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: TO_NUMBER(TO_CHAR(DATE_PART('DOY',calendar_date)), '999')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 30387235-3fdd-4b64-98b2-eabeac198344
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The week in the year 0-53.
        name: CAL_WEEK_IN_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 30387235-3fdd-4b64-98b2-eabeac198344
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: TO_NUMBER(TO_CHAR(DATE_PART('WK', calendar_date)), '99')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6fb7589c-84e0-4034-849f-47081b060225
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The calendar month number 1-12.
        name: CAL_MONTH_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6fb7589c-84e0-4034-849f-47081b060225
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: TO_NUMBER(TO_CHAR(calendar_date, 'MM'), '99')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d97e3f98-18eb-4cbd-8e8e-59fd081ef20c
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: 'The calendar month representation. Format YYYYMM. Example: 200206.'
        name: CAL_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d97e3f98-18eb-4cbd-8e8e-59fd081ef20c
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: TO_NUMBER(TO_CHAR(calendar_date, 'YYYYMM'), '999999')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95f2a45a-c0d3-4499-b6e4-4280551d8f71
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: VARCHAR(7)
        defaultValue: ""
        description: 'The calendar month name. Format MON. Examples: jan, feb, mar.'
        name: CAL_MONTH_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 95f2a45a-c0d3-4499-b6e4-4280551d8f71
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: TO_CHAR(calendar_date, 'Mon')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 73d64c03-c4a1-4810-8b17-61531c689e3b
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The calendar quarter number 1-4.
        name: CAL_QUARTER_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 73d64c03-c4a1-4810-8b17-61531c689e3b
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: TO_NUMBER(TO_CHAR(DATE_PART('Q',calendar_date)), '9')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78a9569b-3bfc-4118-8088-2fa828c1ad8c
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The calendar quarter representation. Format YYYYQQ. Example 200204.
        name: CAL_QUARTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78a9569b-3bfc-4118-8088-2fa828c1ad8c
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: TO_NUMBER(TO_CHAR(calendar_date, 'YYYY') || '0' || TO_CHAR(DATE_PART('Q',calendar_date)), '999999')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aea8373d-88a2-4838-a00f-2d6faeb2a705
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The calendar year. Format YYYY
        name: CAL_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aea8373d-88a2-4838-a00f-2d6faeb2a705
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: TO_NUMBER(TO_CHAR(calendar_date, 'YYYY'), '9999')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55389394-afa6-4bed-9a13-c8d12de5c2ce
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: The financial date. Same as calendar date.
        name: FINANCIAL_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 55389394-afa6-4bed-9a13-c8d12de5c2ce
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: financial_date
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 804e929c-ee1d-4569-b45f-35cc351997ff
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: 'The financial day in the week. Format DDD. Example: mon,tue,wed.'
        name: FIN_DAY_IN_WEEK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 804e929c-ee1d-4569-b45f-35cc351997ff
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: TO_CHAR(financial_date, 'Dy')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b2d7de18-27b8-4cbc-bb1b-4e121a594b34
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Day number in the current financial week.
        name: FIN_DAY_IN_WEEK_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2d7de18-27b8-4cbc-bb1b-4e121a594b34
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: TO_NUMBER(TO_CHAR(DATE_PART('dw', financial_date)), '9')+1
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e8c8fd2-ebd7-4032-862a-7beabafa2434
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Financial day in the month. Normally the same as calendar day in the month, unless the financial period starts mid calendar month.
        name: FIN_DAY_IN_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2e8c8fd2-ebd7-4032-862a-7beabafa2434
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: TO_NUMBER(TO_CHAR(financial_date, 'DD'), '99')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9823d48f-68dc-437b-8406-e97f7e9b61a8
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Financial day in the year. Number of days since the start of the financial year.
        name: FIN_DAY_IN_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9823d48f-68dc-437b-8406-e97f7e9b61a8
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: TO_NUMBER(TO_CHAR(DATE_PART('DOY',financial_date)), '999')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4ed358a-7acb-4afb-9a58-12f4ab8201ac
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Financial week in the financial month.
        name: FIN_WEEK_IN_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4ed358a-7acb-4afb-9a58-12f4ab8201ac
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: ROW_NUMBER() OVER (PARTITION BY TO_NUMBER(TO_CHAR(financial_date, 'YYYYMM'), '999999') ORDER BY TO_NUMBER(TO_CHAR(DATE_PART('WK', financial_date)), '99'))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0ea628f-5900-424d-ad3a-0b137cd6575b
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Financial week in the financial year. Number of weeks since the start of the financial year
        name: FIN_WEEK_IN_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f0ea628f-5900-424d-ad3a-0b137cd6575b
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: TO_NUMBER(TO_CHAR(DATE_PART('WK', financial_date)), '99')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b73f628f-2607-4e4b-b0c3-9e7adc7f8f97
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: 'Financial month number. Format MM. Examples: 1,2,3.'
        name: FIN_MONTH_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b73f628f-2607-4e4b-b0c3-9e7adc7f8f97
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: TO_NUMBER(TO_CHAR(financial_date, 'MM'), '99')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 37ff7faa-162e-4ddc-b8d2-ff60d72037bb
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: 'Financial month representation. Fromat YYYYMM. Examples: 200101, 200102.'
        name: FIN_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 37ff7faa-162e-4ddc-b8d2-ff60d72037bb
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: TO_NUMBER(TO_CHAR(financial_date, 'YYYYMM'), '999999')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6ca7531-fc59-4f9b-aa07-37361db18277
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: VARCHAR(7)
        defaultValue: ""
        description: 'Financial month. Format MON. Examples: jan, feb, mar.'
        name: FIN_MONTH_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a6ca7531-fc59-4f9b-aa07-37361db18277
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: TO_CHAR(calendar_date, 'Mon')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7680c0c8-b858-4b7f-aebf-6b285380a2d5
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: 'Financial period. Format (YYYY-MM) MON-YYYY. Example: (2001-02) Feb-2002.'
        name: FIN_PERIOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7680c0c8-b858-4b7f-aebf-6b285380a2d5
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: "'(' || TRIM(TO_CHAR(financial_date, 'YYYY')) || '-' || TRIM(CAST(TO_NUMBER(TO_CHAR(financial_date, 'MM'),'99') AS VARCHAR(2))) || ')' || TO_CHAR(calendar_date, 'Mon') || '-' || TRIM(TO_CHAR(calendar_date, 'YYYY'))"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d460e9c-cc3f-4acc-9f3d-827483be5819
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Financial quarter number (1-4).
        name: FIN_QUARTER_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8d460e9c-cc3f-4acc-9f3d-827483be5819
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: TO_NUMBER(TO_CHAR(DATE_PART('Q',financial_date)), '9')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d1566428-5174-41f2-ac67-12638aa1f8ef
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: 'Financial quarter representation. Format YYYYQQ. Example: 198901.'
        name: FIN_QUARTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d1566428-5174-41f2-ac67-12638aa1f8ef
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: TO_NUMBER(TO_CHAR(financial_date, 'YYYY') || '0' || TO_CHAR(DATE_PART('Q',financial_date)), '999999')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b13130fd-fec2-4101-853d-2a41144e2899
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Financial year. Format YYYY.
        name: FIN_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b13130fd-fec2-4101-853d-2a41144e2899
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: TO_NUMBER(TO_CHAR(financial_date, 'YYYY'), '9999')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49808119-f2bb-4eed-b5d3-7201ace181ed
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate the current day. Normally set to the last day information was updated in the data warehouse.
        name: CURRENT_CAL_DAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 49808119-f2bb-4eed-b5d3-7201ace181ed
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: "'No'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3602b8fe-0ac4-4be9-97af-09debc1bcdd8
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate the current week. Set as per current_cal_day.
        name: CURRENT_CAL_WEEK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3602b8fe-0ac4-4be9-97af-09debc1bcdd8
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: "'No'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd7723e5-a9c1-40af-8c7e-e2651120bfb1
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate the current year. Set as per current_cal_day.
        name: CURRENT_CAL_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bd7723e5-a9c1-40af-8c7e-e2651120bfb1
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: "'No'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9578f9ba-4e02-4782-84f3-affd654e1030
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate the current month. Set as per current_cal_day.
        name: CURRENT_CAL_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9578f9ba-4e02-4782-84f3-affd654e1030
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: "'No'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9bf3733-d657-4b76-a06f-eb6791f12ce8
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate days in the current month to date. Set as per current_cal_day.
        name: CURRENT_CAL_MTD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f9bf3733-d657-4b76-a06f-eb6791f12ce8
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: "'No'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a16de276-738a-45de-a756-f1f61fb8a5f9
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate days in the current year to date. Set as per current_cal_day.
        name: CURRENT_CAL_YTD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a16de276-738a-45de-a756-f1f61fb8a5f9
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: "'No'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf4d6f04-59f5-4e2f-b163-f47f4e581e3b
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate days that constitute a full year counting back from the current day. Set as per current_cal_day.
        name: MOVING_CAL_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf4d6f04-59f5-4e2f-b163-f47f4e581e3b
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: "'No'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9254f585-88a9-43bb-ba58-709a71ab712b
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate the current financial day. Normally set to the last financial day information was updated in the data warehouse.
        name: CURRENT_FIN_DAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9254f585-88a9-43bb-ba58-709a71ab712b
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: "'No'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ef7c3da-e1fe-4399-9ceb-6d3f4498888e
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate the current financial week. Set as per current_fin_day.
        name: CURRENT_FIN_WEEK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ef7c3da-e1fe-4399-9ceb-6d3f4498888e
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: "'No'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb9dfc9f-a543-4bde-980f-a48fa54172ed
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate the current financial month. Set as per current_fin_day.
        name: CURRENT_FIN_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb9dfc9f-a543-4bde-980f-a48fa54172ed
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: "'No'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 311b2135-2e60-4952-973a-4ea938dace95
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate the current financial quarter. Set as per current_fin_day.
        name: CURRENT_FIN_QUARTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 311b2135-2e60-4952-973a-4ea938dace95
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: "'No'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c40359e7-9d5c-44a1-890c-b95bfd6f2ad7
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate the current financial year. Set as per current_fin_day.
        name: CURRENT_FIN_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c40359e7-9d5c-44a1-890c-b95bfd6f2ad7
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: "'No'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: defb487e-0013-4733-ac9a-42bf3decbebe
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate days in the current financial month to date. Set as per current_fin_day.
        name: CURRENT_FIN_MTD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: defb487e-0013-4733-ac9a-42bf3decbebe
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: "'No'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80d6e642-f036-4dc2-aa65-acf3b28f1ff6
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate days in the current financial year to date. Set as per current_fin_day.
        name: CURRENT_FIN_YTD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 80d6e642-f036-4dc2-aa65-acf3b28f1ff6
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: "'No'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db66577e-fef6-43e7-9fca-7b746b9bfbb0
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate days that constitute a quarter counting back from the current financial day. Set as per current_fin_day.
        name: MOVING_FIN_QUARTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db66577e-fef6-43e7-9fca-7b746b9bfbb0
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: "'No'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 84f406e0-860c-4f51-8f62-b6ca28c35fd1
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate days that constitute a financial year counting back from the current financial day. Set as per current_fin_day.
        name: MOVING_FIN_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84f406e0-860c-4f51-8f62-b6ca28c35fd1
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: "'No'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7bf97619-f1f8-4ef1-a9e6-bf7e4f048f46
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Flag to indicate if a week day Y=week day N=week end.
        name: WEEK_DAY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7bf97619-f1f8-4ef1-a9e6-bf7e4f048f46
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: |-
              CASE WHEN TO_CHAR(calendar_date, 'Dy') IN ('Sat','Sun') THEN 'N'
                          ELSE 'Y'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ace28556-685d-4b5d-9c78-fe871b79c68f
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Flag to indicate a week end day. Y=week end, N=week day.
        name: WEEK_END_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ace28556-685d-4b5d-9c78-fe871b79c68f
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: |-
              CASE WHEN TO_CHAR(calendar_date, 'Dy') IN ('Sat','Sun') THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3121166-31a2-45f7-a906-90c140add2c9
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Flag to indicate that the day in question is a holiday. Y=holiday, N=normal.
        name: HOLIDAY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e3121166-31a2-45f7-a906-90c140add2c9
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: CAST('' AS VARCHAR(64))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 28c95991-b965-4d97-9f43-2faa443944d4
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: Description of the holiday when a holiday.
        name: HOLIDAY_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 28c95991-b965-4d97-9f43-2faa443944d4
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: CAST('N' AS CHAR(1))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b940d07-e083-4f5f-b71a-19babe6cd295
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Flag to indicate a trading day. Y=trading, N=non trading.
        name: TRADING_DAY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b940d07-e083-4f5f-b71a-19babe6cd295
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: |-
              CASE WHEN TO_CHAR(calendar_date, 'Dy') NOT IN ('Sat','Sun') AND 'N' = 'N' THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f252e1b-0436-4f4e-aa6a-b915769d5ca1
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Number of trading days in this calendar month.
        name: TRADING_DAYS_IN_MTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f252e1b-0436-4f4e-aa6a-b915769d5ca1
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e3cf9d4-5209-430f-8591-17abe5f3a358
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Number of trading days in the month so far.
        name: TRADING_DAYS_SO_FAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e3cf9d4-5209-430f-8591-17abe5f3a358
                stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee7494ae-b90a-4be3-8388-4dcb9c6ca6a6
          stepCounter: 893768c0-a146-4a3d-b378-4c77bb2c900a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE TABLE {{ this }} (DIM_DATE_KEY integer NOT NULL, CALENDAR_DATE timestamp , CAL_DAY_IN_WEEK varchar(3), CAL_DAY_IN_WEEK_NO integer , CAL_DAY_IN_MONTH integer , CAL_DAY_IN_YEAR integer , CAL_WEEK_IN_YEAR integer , CAL_MONTH_NO integer , CAL_MONTH integer , CAL_MONTH_NAME varchar(7), CAL_QUARTER_NO integer , CAL_QUARTER integer , CAL_YEAR integer , FINANCIAL_DATE timestamp , FIN_DAY_IN_WEEK varchar(3), FIN_DAY_IN_WEEK_NO integer , FIN_DAY_IN_MONTH integer , FIN_DAY_IN_YEAR integer , FIN_WEEK_IN_MONTH integer , FIN_WEEK_IN_YEAR integer , FIN_MONTH_NO integer , FIN_MONTH integer , FIN_MONTH_NAME varchar(7), FIN_PERIOD varchar(20), FIN_QUARTER_NO integer , FIN_QUARTER integer , FIN_YEAR integer , CURRENT_CAL_DAY varchar(8), CURRENT_CAL_WEEK varchar(8), CURRENT_CAL_YEAR varchar(8), CURRENT_CAL_MONTH varchar(8), CURRENT_CAL_MTD varchar(8), CURRENT_CAL_YTD varchar(8), MOVING_CAL_YEAR varchar(8), CURRENT_FIN_DAY varchar(8), CURRENT_FIN_WEEK varchar(8), CURRENT_FIN_MONTH varchar(8), CURRENT_FIN_QUARTER varchar(8), CURRENT_FIN_YEAR varchar(8), CURRENT_FIN_MTD varchar(8), CURRENT_FIN_YTD varchar(8), MOVING_FIN_QUARTER varchar(8), MOVING_FIN_YEAR varchar(8), WEEK_DAY_FLAG varchar(1), WEEK_END_FLAG varchar(1), HOLIDAY_FLAG varchar(1), HOLIDAY_DESC varchar(64), TRADING_DAY_FLAG varchar(1), TRADING_DAYS_IN_MTH integer , TRADING_DAYS_SO_FAR integer , DSS_UPDATE_TIME timestamp) ;COMMENT
                ON COLUMN {{ this }}.DIM_DATE_KEY IS 'stage_date_rs.calendar_date=dim_date.calendar_date';COMMENT
                ON COLUMN {{ this }}.CALENDAR_DATE IS 'The calendar date for this row.';COMMENT
                ON COLUMN {{ this }}.CAL_DAY_IN_WEEK IS 'The day in the week. Format DDD. Example: mon, tue, wed.';COMMENT
                ON COLUMN {{ this }}.CAL_DAY_IN_WEEK_NO IS 'The day number in the week. 1-7 where Sunday is day 1.';COMMENT
                ON COLUMN {{ this }}.CAL_DAY_IN_MONTH IS 'The day in the month 1-31.';COMMENT
                ON COLUMN {{ this }}.CAL_DAY_IN_YEAR IS 'The day in the year 1-366.';COMMENT
                ON COLUMN {{ this }}.CAL_WEEK_IN_YEAR IS 'The week in the year 0-53.';COMMENT
                ON COLUMN {{ this }}.CAL_MONTH_NO IS 'The calendar month number 1-12.';COMMENT
                ON COLUMN {{ this }}.CAL_MONTH IS 'The calendar month representation. Format YYYYMM. Example: 200206.';COMMENT
                ON COLUMN {{ this }}.CAL_MONTH_NAME IS 'The calendar month name. Format MON. Examples: jan, feb, mar.';COMMENT
                ON COLUMN {{ this }}.CAL_QUARTER_NO IS 'The calendar quarter number 1-4.';COMMENT
                ON COLUMN {{ this }}.CAL_QUARTER IS 'The calendar quarter representation. Format YYYYQQ. Example 200204.';COMMENT
                ON COLUMN {{ this }}.CAL_YEAR IS 'The calendar year. Format YYYY';COMMENT
                ON COLUMN {{ this }}.FINANCIAL_DATE IS 'The financial date. Same as calendar date.';COMMENT
                ON COLUMN {{ this }}.FIN_DAY_IN_WEEK IS 'The financial day in the week. Format DDD. Example: mon,tue,wed.';COMMENT
                ON COLUMN {{ this }}.FIN_DAY_IN_WEEK_NO IS 'Day number in the current financial week.';COMMENT
                ON COLUMN {{ this }}.FIN_DAY_IN_MONTH IS 'Financial day in the month. Normally the same as calendar day in the month, unless the financial period starts mid calendar month.';COMMENT
                ON COLUMN {{ this }}.FIN_DAY_IN_YEAR IS 'Financial day in the year. Number of days since the start of the financial year.';COMMENT
                ON COLUMN {{ this }}.FIN_WEEK_IN_MONTH IS 'Financial week in the financial month.';COMMENT
                ON COLUMN {{ this }}.FIN_WEEK_IN_YEAR IS 'Financial week in the financial year. Number of weeks since the start of the financial year';COMMENT
                ON COLUMN {{ this }}.FIN_MONTH_NO IS 'Financial month number. Format MM. Examples: 1,2,3.';COMMENT
                ON COLUMN {{ this }}.FIN_MONTH IS 'Financial month representation. Fromat YYYYMM. Examples: 200101, 200102.';COMMENT
                ON COLUMN {{ this }}.FIN_MONTH_NAME IS 'Financial month. Format MON. Examples: jan, feb, mar.';COMMENT
                ON COLUMN {{ this }}.FIN_PERIOD IS 'Financial period. Format (YYYY-MM) MON-YYYY. Example: (2001-02) Feb-2002.';COMMENT
                ON COLUMN {{ this }}.FIN_QUARTER_NO IS 'Financial quarter number (1-4).';COMMENT
                ON COLUMN {{ this }}.FIN_QUARTER IS
        dependencies: []
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref_no_link('TARGET', 'STAGE_DATE') }}
        name: STAGE_DATE
        noLinkRefs: []
  name: STAGE_DATE
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
