fileVersion: 1
id: f88a5ddf-e757-4713-809a-be3520001ed2
name: STAGE_DATE
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20d700a1-297f-4d03-8541-61aad576a36a
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: stage_date_rs.calendar_date=dim_date.calendar_date
        name: DIM_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 20d700a1-297f-4d03-8541-61aad576a36a
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: TO_NUMBER(TO_CHAR(calendar_date, 'YYYYMMDD'), '99999999')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d518b34-3364-4ce4-9d4a-41ff8756eaf6
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: The calendar date for this row.
        isBusinessKey: true
        name: CALENDAR_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d518b34-3364-4ce4-9d4a-41ff8756eaf6
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: calendar_date
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c9e47fa-bae6-4d6f-b157-ea76f64c8abb
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: 'The day in the week. Format DDD. Example: mon, tue, wed.'
        name: CAL_DAY_IN_WEEK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3c9e47fa-bae6-4d6f-b157-ea76f64c8abb
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: TO_CHAR(calendar_date, 'Dy')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88c8aadb-a762-4e03-90d4-e68ac7403c2f
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The day number in the week. 1-7 where Sunday is day 1.
        name: CAL_DAY_IN_WEEK_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 88c8aadb-a762-4e03-90d4-e68ac7403c2f
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: TO_NUMBER(TO_CHAR(DATE_PART('dw', calendar_date)), '9')+1
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1c7f248-b80e-4865-bd5d-643539635479
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The day in the month 1-31.
        name: CAL_DAY_IN_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c1c7f248-b80e-4865-bd5d-643539635479
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: TO_NUMBER(TO_CHAR(calendar_date, 'DD'), '99')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8305b09-57d7-4769-98af-f9cbbb942ba9
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The day in the year 1-366.
        name: CAL_DAY_IN_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d8305b09-57d7-4769-98af-f9cbbb942ba9
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: TO_NUMBER(TO_CHAR(DATE_PART('DOY',calendar_date)), '999')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 647777a6-6198-4dea-9e28-7078f3d7a873
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The week in the year 0-53.
        name: CAL_WEEK_IN_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 647777a6-6198-4dea-9e28-7078f3d7a873
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: TO_NUMBER(TO_CHAR(DATE_PART('WK', calendar_date)), '99')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05864b23-6c6e-4982-992b-4a6416bdfbe2
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The calendar month number 1-12.
        name: CAL_MONTH_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05864b23-6c6e-4982-992b-4a6416bdfbe2
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: TO_NUMBER(TO_CHAR(calendar_date, 'MM'), '99')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be2182dc-ac71-4c9c-a937-2ef2f3496dc6
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: 'The calendar month representation. Format YYYYMM. Example: 200206.'
        name: CAL_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: be2182dc-ac71-4c9c-a937-2ef2f3496dc6
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: TO_NUMBER(TO_CHAR(calendar_date, 'YYYYMM'), '999999')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5248855d-590f-4131-ae34-521af12cb25a
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: VARCHAR(7)
        defaultValue: ""
        description: 'The calendar month name. Format MON. Examples: jan, feb, mar.'
        name: CAL_MONTH_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5248855d-590f-4131-ae34-521af12cb25a
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: TO_CHAR(calendar_date, 'Mon')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b603a7d-85ce-4f77-849e-81d557b71de7
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The calendar quarter number 1-4.
        name: CAL_QUARTER_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b603a7d-85ce-4f77-849e-81d557b71de7
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: TO_NUMBER(TO_CHAR(DATE_PART('Q',calendar_date)), '9')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ecd0d8d-d61d-4840-88b1-e1729305564f
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The calendar quarter representation. Format YYYYQQ. Example 200204.
        name: CAL_QUARTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ecd0d8d-d61d-4840-88b1-e1729305564f
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: TO_NUMBER(TO_CHAR(calendar_date, 'YYYY') || '0' || TO_CHAR(DATE_PART('Q',calendar_date)), '999999')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d595ad1-d404-420c-acfc-56834cd9a2c3
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The calendar year. Format YYYY
        name: CAL_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3d595ad1-d404-420c-acfc-56834cd9a2c3
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: TO_NUMBER(TO_CHAR(calendar_date, 'YYYY'), '9999')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de59d774-f51b-46a4-a7be-a4a1cbeca773
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: The financial date. Same as calendar date.
        name: FINANCIAL_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de59d774-f51b-46a4-a7be-a4a1cbeca773
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: financial_date
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c296e9ff-a962-40be-b624-8ff6b74ae439
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: 'The financial day in the week. Format DDD. Example: mon,tue,wed.'
        name: FIN_DAY_IN_WEEK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c296e9ff-a962-40be-b624-8ff6b74ae439
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: TO_CHAR(financial_date, 'Dy')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57c5f308-b740-47ea-b3fa-29975d26454d
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Day number in the current financial week.
        name: FIN_DAY_IN_WEEK_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 57c5f308-b740-47ea-b3fa-29975d26454d
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: TO_NUMBER(TO_CHAR(DATE_PART('dw', financial_date)), '9')+1
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a201f9e-f852-43d1-944e-2eb2f58c64ba
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Financial day in the month. Normally the same as calendar day in the month, unless the financial period starts mid calendar month.
        name: FIN_DAY_IN_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a201f9e-f852-43d1-944e-2eb2f58c64ba
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: TO_NUMBER(TO_CHAR(financial_date, 'DD'), '99')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4979b7ec-b378-4ecb-a148-fdc24eeac4ff
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Financial day in the year. Number of days since the start of the financial year.
        name: FIN_DAY_IN_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4979b7ec-b378-4ecb-a148-fdc24eeac4ff
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: TO_NUMBER(TO_CHAR(DATE_PART('DOY',financial_date)), '999')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c902bf3-df75-472f-b0a7-583452afca08
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Financial week in the financial month.
        name: FIN_WEEK_IN_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c902bf3-df75-472f-b0a7-583452afca08
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: ROW_NUMBER() OVER (PARTITION BY TO_NUMBER(TO_CHAR(financial_date, 'YYYYMM'), '999999') ORDER BY TO_NUMBER(TO_CHAR(DATE_PART('WK', financial_date)), '99'))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3d0f36f-846f-44d2-9faf-f4e8bd9eefce
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Financial week in the financial year. Number of weeks since the start of the financial year
        name: FIN_WEEK_IN_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3d0f36f-846f-44d2-9faf-f4e8bd9eefce
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: TO_NUMBER(TO_CHAR(DATE_PART('WK', financial_date)), '99')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2350e828-0c49-4b76-a820-5c2e0cb3efda
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: 'Financial month number. Format MM. Examples: 1,2,3.'
        name: FIN_MONTH_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2350e828-0c49-4b76-a820-5c2e0cb3efda
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: TO_NUMBER(TO_CHAR(financial_date, 'MM'), '99')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c86598fb-1abd-4323-94a8-234aadf0b3de
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: 'Financial month representation. Fromat YYYYMM. Examples: 200101, 200102.'
        name: FIN_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c86598fb-1abd-4323-94a8-234aadf0b3de
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: TO_NUMBER(TO_CHAR(financial_date, 'YYYYMM'), '999999')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3104b14b-fb06-485f-96e2-1a78b67c424e
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: VARCHAR(7)
        defaultValue: ""
        description: 'Financial month. Format MON. Examples: jan, feb, mar.'
        name: FIN_MONTH_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3104b14b-fb06-485f-96e2-1a78b67c424e
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: TO_CHAR(calendar_date, 'Mon')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18a05df4-4ccc-4316-92cd-d457d0a13321
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: 'Financial period. Format (YYYY-MM) MON-YYYY. Example: (2001-02) Feb-2002.'
        name: FIN_PERIOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18a05df4-4ccc-4316-92cd-d457d0a13321
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: "'(' || TRIM(TO_CHAR(financial_date, 'YYYY')) || '-' || TRIM(CAST(TO_NUMBER(TO_CHAR(financial_date, 'MM'),'99') AS VARCHAR(2))) || ')' || TO_CHAR(calendar_date, 'Mon') || '-' || TRIM(TO_CHAR(calendar_date, 'YYYY'))"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 99e8e099-02ea-493b-b5bb-6c49deb10180
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Financial quarter number (1-4).
        name: FIN_QUARTER_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 99e8e099-02ea-493b-b5bb-6c49deb10180
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: TO_NUMBER(TO_CHAR(DATE_PART('Q',financial_date)), '9')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e373e734-703b-4e82-98d6-b118dce7f8e2
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: 'Financial quarter representation. Format YYYYQQ. Example: 198901.'
        name: FIN_QUARTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e373e734-703b-4e82-98d6-b118dce7f8e2
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: TO_NUMBER(TO_CHAR(financial_date, 'YYYY') || '0' || TO_CHAR(DATE_PART('Q',financial_date)), '999999')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 452cb578-9664-4ad6-a012-860b5fbbccfb
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Financial year. Format YYYY.
        name: FIN_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 452cb578-9664-4ad6-a012-860b5fbbccfb
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: TO_NUMBER(TO_CHAR(financial_date, 'YYYY'), '9999')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32dedb38-366f-4d48-b050-ba498503393b
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate the current day. Normally set to the last day information was updated in the data warehouse.
        name: CURRENT_CAL_DAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 32dedb38-366f-4d48-b050-ba498503393b
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: "'No'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69e4d06e-05bd-42a5-9088-108bece57ec4
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate the current week. Set as per current_cal_day.
        name: CURRENT_CAL_WEEK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 69e4d06e-05bd-42a5-9088-108bece57ec4
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: "'No'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 404d7a97-1165-4aa5-91f7-fcbba930c360
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate the current year. Set as per current_cal_day.
        name: CURRENT_CAL_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 404d7a97-1165-4aa5-91f7-fcbba930c360
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: "'No'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6664505-089f-4f1e-ba79-931dd14674ca
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate the current month. Set as per current_cal_day.
        name: CURRENT_CAL_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f6664505-089f-4f1e-ba79-931dd14674ca
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: "'No'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1ec7649-8481-4b70-b505-99bbc6d64527
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate days in the current month to date. Set as per current_cal_day.
        name: CURRENT_CAL_MTD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1ec7649-8481-4b70-b505-99bbc6d64527
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: "'No'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07141622-5419-485d-b714-40c9f6dfcdcc
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate days in the current year to date. Set as per current_cal_day.
        name: CURRENT_CAL_YTD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07141622-5419-485d-b714-40c9f6dfcdcc
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: "'No'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77dee3d4-e8fd-4535-84e1-68e79194de70
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate days that constitute a full year counting back from the current day. Set as per current_cal_day.
        name: MOVING_CAL_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77dee3d4-e8fd-4535-84e1-68e79194de70
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: "'No'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e180d450-d609-4795-b77f-93631d1021ba
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate the current financial day. Normally set to the last financial day information was updated in the data warehouse.
        name: CURRENT_FIN_DAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e180d450-d609-4795-b77f-93631d1021ba
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: "'No'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b898173-7b81-45a3-b969-2951bcb1d970
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate the current financial week. Set as per current_fin_day.
        name: CURRENT_FIN_WEEK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2b898173-7b81-45a3-b969-2951bcb1d970
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: "'No'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 112b7af7-5b92-437e-8dba-66d7a78068b1
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate the current financial month. Set as per current_fin_day.
        name: CURRENT_FIN_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 112b7af7-5b92-437e-8dba-66d7a78068b1
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: "'No'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e24b4f1-67e5-41b5-a783-313b778619bf
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate the current financial quarter. Set as per current_fin_day.
        name: CURRENT_FIN_QUARTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0e24b4f1-67e5-41b5-a783-313b778619bf
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: "'No'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54b055f7-c453-469b-abed-8077ffb0ac1b
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate the current financial year. Set as per current_fin_day.
        name: CURRENT_FIN_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 54b055f7-c453-469b-abed-8077ffb0ac1b
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: "'No'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7be2500-bf36-43f7-9ee4-43ed73f5eda8
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate days in the current financial month to date. Set as per current_fin_day.
        name: CURRENT_FIN_MTD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d7be2500-bf36-43f7-9ee4-43ed73f5eda8
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: "'No'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29fa4810-6a2a-47dd-9743-398232245ac9
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate days in the current financial year to date. Set as per current_fin_day.
        name: CURRENT_FIN_YTD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 29fa4810-6a2a-47dd-9743-398232245ac9
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: "'No'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7324683-336b-474d-9139-5e853a61bac8
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate days that constitute a quarter counting back from the current financial day. Set as per current_fin_day.
        name: MOVING_FIN_QUARTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7324683-336b-474d-9139-5e853a61bac8
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: "'No'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 381344e0-07b7-4b27-8653-80292ac516b4
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate days that constitute a financial year counting back from the current financial day. Set as per current_fin_day.
        name: MOVING_FIN_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 381344e0-07b7-4b27-8653-80292ac516b4
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: "'No'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed960911-13f6-4823-8a23-17bc52030ac0
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Flag to indicate if a week day Y=week day N=week end.
        name: WEEK_DAY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed960911-13f6-4823-8a23-17bc52030ac0
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: |-
              CASE WHEN TO_CHAR(calendar_date, 'Dy') IN ('Sat','Sun') THEN 'N'
                          ELSE 'Y'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2bc369d7-83ca-4477-86c4-f1aa91e4c3a4
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Flag to indicate a week end day. Y=week end, N=week day.
        name: WEEK_END_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2bc369d7-83ca-4477-86c4-f1aa91e4c3a4
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: |-
              CASE WHEN TO_CHAR(calendar_date, 'Dy') IN ('Sat','Sun') THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c3fb2eb-f3ae-4867-aedb-01f3612da87c
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Flag to indicate that the day in question is a holiday. Y=holiday, N=normal.
        name: HOLIDAY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c3fb2eb-f3ae-4867-aedb-01f3612da87c
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: CAST('' AS VARCHAR(64))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09887897-d718-47a5-ab6a-899c0d373cec
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: Description of the holiday when a holiday.
        name: HOLIDAY_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09887897-d718-47a5-ab6a-899c0d373cec
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: CAST('N' AS CHAR(1))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 10aa1abc-72b8-46d3-8e84-78aaeb02e695
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Flag to indicate a trading day. Y=trading, N=non trading.
        name: TRADING_DAY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 10aa1abc-72b8-46d3-8e84-78aaeb02e695
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: |-
              CASE WHEN TO_CHAR(calendar_date, 'Dy') NOT IN ('Sat','Sun') AND 'N' = 'N' THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a0accf1-6e4c-47dd-8a55-bcf8219ebd5a
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Number of trading days in this calendar month.
        name: TRADING_DAYS_IN_MTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a0accf1-6e4c-47dd-8a55-bcf8219ebd5a
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1a04c8b-3e7c-4efd-b516-9420e2638ea8
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Number of trading days in the month so far.
        name: TRADING_DAYS_SO_FAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1a04c8b-3e7c-4efd-b516-9420e2638ea8
                stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9507b934-6556-4d66-8ebc-065b544feae8
          stepCounter: f88a5ddf-e757-4713-809a-be3520001ed2
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE TABLE {{ this }} (DIM_DATE_KEY integer NOT NULL, CALENDAR_DATE timestamp , CAL_DAY_IN_WEEK varchar(3), CAL_DAY_IN_WEEK_NO integer , CAL_DAY_IN_MONTH integer , CAL_DAY_IN_YEAR integer , CAL_WEEK_IN_YEAR integer , CAL_MONTH_NO integer , CAL_MONTH integer , CAL_MONTH_NAME varchar(7), CAL_QUARTER_NO integer , CAL_QUARTER integer , CAL_YEAR integer , FINANCIAL_DATE timestamp , FIN_DAY_IN_WEEK varchar(3), FIN_DAY_IN_WEEK_NO integer , FIN_DAY_IN_MONTH integer , FIN_DAY_IN_YEAR integer , FIN_WEEK_IN_MONTH integer , FIN_WEEK_IN_YEAR integer , FIN_MONTH_NO integer , FIN_MONTH integer , FIN_MONTH_NAME varchar(7), FIN_PERIOD varchar(20), FIN_QUARTER_NO integer , FIN_QUARTER integer , FIN_YEAR integer , CURRENT_CAL_DAY varchar(8), CURRENT_CAL_WEEK varchar(8), CURRENT_CAL_YEAR varchar(8), CURRENT_CAL_MONTH varchar(8), CURRENT_CAL_MTD varchar(8), CURRENT_CAL_YTD varchar(8), MOVING_CAL_YEAR varchar(8), CURRENT_FIN_DAY varchar(8), CURRENT_FIN_WEEK varchar(8), CURRENT_FIN_MONTH varchar(8), CURRENT_FIN_QUARTER varchar(8), CURRENT_FIN_YEAR varchar(8), CURRENT_FIN_MTD varchar(8), CURRENT_FIN_YTD varchar(8), MOVING_FIN_QUARTER varchar(8), MOVING_FIN_YEAR varchar(8), WEEK_DAY_FLAG varchar(1), WEEK_END_FLAG varchar(1), HOLIDAY_FLAG varchar(1), HOLIDAY_DESC varchar(64), TRADING_DAY_FLAG varchar(1), TRADING_DAYS_IN_MTH integer , TRADING_DAYS_SO_FAR integer , DSS_UPDATE_TIME timestamp) ;COMMENT
                ON COLUMN {{ this }}.DIM_DATE_KEY IS 'stage_date_rs.calendar_date=dim_date.calendar_date';COMMENT
                ON COLUMN {{ this }}.CALENDAR_DATE IS 'The calendar date for this row.';COMMENT
                ON COLUMN {{ this }}.CAL_DAY_IN_WEEK IS 'The day in the week. Format DDD. Example: mon, tue, wed.';COMMENT
                ON COLUMN {{ this }}.CAL_DAY_IN_WEEK_NO IS 'The day number in the week. 1-7 where Sunday is day 1.';COMMENT
                ON COLUMN {{ this }}.CAL_DAY_IN_MONTH IS 'The day in the month 1-31.';COMMENT
                ON COLUMN {{ this }}.CAL_DAY_IN_YEAR IS 'The day in the year 1-366.';COMMENT
                ON COLUMN {{ this }}.CAL_WEEK_IN_YEAR IS 'The week in the year 0-53.';COMMENT
                ON COLUMN {{ this }}.CAL_MONTH_NO IS 'The calendar month number 1-12.';COMMENT
                ON COLUMN {{ this }}.CAL_MONTH IS 'The calendar month representation. Format YYYYMM. Example: 200206.';COMMENT
                ON COLUMN {{ this }}.CAL_MONTH_NAME IS 'The calendar month name. Format MON. Examples: jan, feb, mar.';COMMENT
                ON COLUMN {{ this }}.CAL_QUARTER_NO IS 'The calendar quarter number 1-4.';COMMENT
                ON COLUMN {{ this }}.CAL_QUARTER IS 'The calendar quarter representation. Format YYYYQQ. Example 200204.';COMMENT
                ON COLUMN {{ this }}.CAL_YEAR IS 'The calendar year. Format YYYY';COMMENT
                ON COLUMN {{ this }}.FINANCIAL_DATE IS 'The financial date. Same as calendar date.';COMMENT
                ON COLUMN {{ this }}.FIN_DAY_IN_WEEK IS 'The financial day in the week. Format DDD. Example: mon,tue,wed.';COMMENT
                ON COLUMN {{ this }}.FIN_DAY_IN_WEEK_NO IS 'Day number in the current financial week.';COMMENT
                ON COLUMN {{ this }}.FIN_DAY_IN_MONTH IS 'Financial day in the month. Normally the same as calendar day in the month, unless the financial period starts mid calendar month.';COMMENT
                ON COLUMN {{ this }}.FIN_DAY_IN_YEAR IS 'Financial day in the year. Number of days since the start of the financial year.';COMMENT
                ON COLUMN {{ this }}.FIN_WEEK_IN_MONTH IS 'Financial week in the financial month.';COMMENT
                ON COLUMN {{ this }}.FIN_WEEK_IN_YEAR IS 'Financial week in the financial year. Number of weeks since the start of the financial year';COMMENT
                ON COLUMN {{ this }}.FIN_MONTH_NO IS 'Financial month number. Format MM. Examples: 1,2,3.';COMMENT
                ON COLUMN {{ this }}.FIN_MONTH IS 'Financial month representation. Fromat YYYYMM. Examples: 200101, 200102.';COMMENT
                ON COLUMN {{ this }}.FIN_MONTH_NAME IS 'Financial month. Format MON. Examples: jan, feb, mar.';COMMENT
                ON COLUMN {{ this }}.FIN_PERIOD IS 'Financial period. Format (YYYY-MM) MON-YYYY. Example: (2001-02) Feb-2002.';COMMENT
                ON COLUMN {{ this }}.FIN_QUARTER_NO IS 'Financial quarter number (1-4).';COMMENT
                ON COLUMN {{ this }}.FIN_QUARTER IS
        dependencies: []
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref_no_link('TARGET', 'STAGE_DATE') }}
        name: STAGE_DATE
        noLinkRefs: []
  name: STAGE_DATE
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
