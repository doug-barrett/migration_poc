fileVersion: 1
id: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
name: S_OUTPATIENT_APPOINTMENT_PREV_NEXT_V
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 44790ca5-3015-4d2a-ad98-febbff66c49c
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CURR_PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d9ffe493-f986-4786-bf44-069b4ad5dff2
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5fb59f5-8362-4658-808f-4c4d5c8621ba
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: CURR_PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 108064b1-1a63-4ba9-8426-1b5529cec42d
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7a4a1d4-cb9d-4f50-80a1-a317a7236654
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CURR_OUTPATIENT_SESSION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a7aba77-6473-499c-a987-7087af601008
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 355e414d-363f-427e-ba44-1fd0b856fea8
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CURR_OUTPATIENT_APPOINTMENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5b57b418-4592-4522-9f90-c67ba8e5ebeb
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 568f03b4-239b-4f5f-9999-b39ea35a073c
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: CURR_OUTPATIENT_APPOINTMENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 986676d1-b588-42be-9e20-86e201ffe160
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9d2f146-57ba-47f0-8ed8-48a2a46e0174
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CURR_OUTPATIENT_CLINIC_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4866898-5862-4ceb-b82d-b4f0df7b8948
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31d37209-3d61-4a09-9050-818dc0c7f071
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CURR_OUTPATIENT_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24f85e66-f719-4971-be6f-aee66dc624d4
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6de309a-628d-48ae-b9be-2b04e45b70a1
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: CURR_OUTPATIENT_HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab97b5f1-e9ff-4b81-bad4-aab9a49a0a3d
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2590e792-a79c-41f3-bc0b-8c3aceaba612
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CURR_APPOINTED_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c0974fe-2cfd-427a-a593-d767ba5e4ae8
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 73ef46f6-0a33-419d-b69b-5000a67f1f52
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CURR_SEEN_BY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75b1c79f-25f2-447b-82ab-e1d8bcf9a6e1
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae908d1e-54e8-4ce2-ba20-62a8dc5dc4f0
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CURR_APPOINTMENT_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2f0f54ec-4442-4129-abe8-690d77d774e8
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 760f7ec9-d53c-47fc-bf90-9cc2657f62c2
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CURR_APPOINTMENT_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e252c6ba-ed9e-404b-939e-4960342eb303
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8907ec24-b6ff-4d7e-878a-0ae68cff1dc5
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PREV_OUTPATIENT_APPOINTMENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5b57b418-4592-4522-9f90-c67ba8e5ebeb
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 10e1e520-846c-432c-9883-13ebef441329
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PREV_OUTPATIENT_APPOINTMENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 986676d1-b588-42be-9e20-86e201ffe160
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 35db1056-6705-4de8-ab54-7213a32dd205
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PREV_OUTPATIENT_CLINIC_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4866898-5862-4ceb-b82d-b4f0df7b8948
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef4ba349-9f1d-46a3-96db-15e5e2159477
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PREV_OUTPATIENT_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24f85e66-f719-4971-be6f-aee66dc624d4
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa675ba0-9e6e-454f-bd34-43e94c05b40d
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PREV_OUTPATIENT_HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab97b5f1-e9ff-4b81-bad4-aab9a49a0a3d
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8485724e-9f4b-4c95-ac31-e2a2b5c62ac7
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PREV_APPOINTED_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c0974fe-2cfd-427a-a593-d767ba5e4ae8
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee0467db-2620-40b1-abf5-4cdda8e123a9
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PREV_SEEN_BY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75b1c79f-25f2-447b-82ab-e1d8bcf9a6e1
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c84cba2c-10e2-41cf-b7d5-80ce5f4cbf1e
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PREV_APPOINTMENT_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2f0f54ec-4442-4129-abe8-690d77d774e8
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4eb2f3ac-784c-4bd5-8393-5e8e23cc8ac6
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PREV_APPOINTMENT_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e252c6ba-ed9e-404b-939e-4960342eb303
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5154cd6f-daeb-4e0f-966c-62b1741f1236
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: NEXT_OUTPATIENT_APPOINTMENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5b57b418-4592-4522-9f90-c67ba8e5ebeb
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 108ad18a-c885-4698-a936-e8031bdd565a
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NEXT_OUTPATIENT_APPOINTMENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 986676d1-b588-42be-9e20-86e201ffe160
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5935bcb4-950f-4f70-8572-49cc71000885
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: NEXT_OUTPATIENT_CLINIC_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4866898-5862-4ceb-b82d-b4f0df7b8948
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4cba170-1c97-4c3a-9b4f-206dc003778c
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: NEXT_OUTPATIENT_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24f85e66-f719-4971-be6f-aee66dc624d4
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb125ca5-f49d-4d9f-bca1-169255af7ccc
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NEXT_OUTPATIENT_HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab97b5f1-e9ff-4b81-bad4-aab9a49a0a3d
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 705e5962-dbbf-4603-850f-bb8ae432d5bd
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: NEXT_APPOINTED_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c0974fe-2cfd-427a-a593-d767ba5e4ae8
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 225315e3-255b-41c8-a3c4-76f3033186f8
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: NEXT_SEEN_BY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75b1c79f-25f2-447b-82ab-e1d8bcf9a6e1
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd548434-a3a2-46e7-845b-df9a43185e57
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NEXT_APPOINTMENT_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2f0f54ec-4442-4129-abe8-690d77d774e8
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95f65814-8388-476d-ac23-154de12bfa3c
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NEXT_APPOINTMENT_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e252c6ba-ed9e-404b-939e-4960342eb303
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f88aa6a3-17ed-4beb-8ea1-91dac3fed1f1
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: FIRST_OUTPATIENT_APPOINTMENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5b57b418-4592-4522-9f90-c67ba8e5ebeb
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: faca4dae-4d79-418f-b3ff-6e3cda6ba921
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FIRST_OUTPATIENT_APPOINTMENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 986676d1-b588-42be-9e20-86e201ffe160
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d6b1ec0-08dd-4251-bd42-6c11f487c8de
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: FIRST_OUTPATIENT_CLINIC_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4866898-5862-4ceb-b82d-b4f0df7b8948
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8cc4277-de48-486c-9462-f1de8d6f485c
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: FIRST_OUTPATIENT_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24f85e66-f719-4971-be6f-aee66dc624d4
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d0547138-7ecb-4cc9-a47d-292023a5ca1c
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FIRST_OUTPATIENT_HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab97b5f1-e9ff-4b81-bad4-aab9a49a0a3d
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: addd5d86-ed74-49cb-aea9-3d042a75ad02
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: FIRST_APPOINTED_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c0974fe-2cfd-427a-a593-d767ba5e4ae8
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b5ce988-8f7b-45a5-9673-605a9531b54d
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: FIRST_SEEN_BY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75b1c79f-25f2-447b-82ab-e1d8bcf9a6e1
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31963528-fd9d-454e-98f2-1f33dace9b60
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_APPOINTMENT_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2f0f54ec-4442-4129-abe8-690d77d774e8
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92637b07-281d-4fa0-b3d0-6ed03c472242
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_APPOINTMENT_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e252c6ba-ed9e-404b-939e-4960342eb303
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a110bea3-c35a-421e-82a3-eaff16cbbae0
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_APPOINTMENT_ARRIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0a566422-0c54-49b9-b366-d0106d4ee16d
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b6b038c-6c3d-464f-8363-d41f60551fea
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_APPOINTMENT_SEEN_BY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b546e427-aa7e-45e9-b2ba-3d887df55087
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c32d337-6c8b-49f0-ac23-5577b43e0f30
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_APPOINTMENT_DEPARTED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc5a1562-fedb-4c61-9088-6ec158a7d61b
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2daf72d8-0d3e-4915-b362-b74e011d5ad9
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LAST_OUTPATIENT_APPOINTMENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5b57b418-4592-4522-9f90-c67ba8e5ebeb
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0fe2561-1bee-4ccb-a848-17ddc9636a97
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LAST_OUTPATIENT_APPOINTMENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 986676d1-b588-42be-9e20-86e201ffe160
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c78ebc5a-e9e6-42f7-9e27-71b03bc7db0d
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LAST_OUTPATIENT_CLINIC_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4866898-5862-4ceb-b82d-b4f0df7b8948
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 36a917eb-42f8-4a95-8966-0963cb8e58f0
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LAST_OUTPATIENT_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24f85e66-f719-4971-be6f-aee66dc624d4
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d2ae5c7-fd4c-4001-8eed-3444b702274f
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LAST_OUTPATIENT_HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab97b5f1-e9ff-4b81-bad4-aab9a49a0a3d
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab5c66ef-4dbb-465a-8046-273ef2218687
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LAST_APPOINTED_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c0974fe-2cfd-427a-a593-d767ba5e4ae8
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d40e0e09-8778-40a6-8c5c-8c2ac3823bee
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LAST_SEEN_BY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75b1c79f-25f2-447b-82ab-e1d8bcf9a6e1
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d17f4df-abef-4482-b08d-de08e938f76f
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_APPOINTMENT_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2f0f54ec-4442-4129-abe8-690d77d774e8
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5897f2d-4b81-43d9-b471-4652129629c8
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_APPOINTMENT_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e252c6ba-ed9e-404b-939e-4960342eb303
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9219a4f8-9341-415d-b046-2edd06bc6ff6
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_APPOINTMENT_ARRIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0a566422-0c54-49b9-b366-d0106d4ee16d
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1b5551f-d79f-44dd-8d4f-f4d6a59979ae
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_APPOINTMENT_SEEN_BY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b546e427-aa7e-45e9-b2ba-3d887df55087
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ac9f6fa-6e89-4a27-8a68-0911a4404fa9
          stepCounter: 913aa053-7ff7-4c82-8fae-6bfc0410d0d4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_APPOINTMENT_DEPARTED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc5a1562-fedb-4c61-9088-6ec158a7d61b
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            SELECT curr.patient_reference_no curr_patient_reference_no ,
                   curr.patient_NHI curr_patient_NHI ,
                   curr.outpatient_session_reference_no curr_outpatient_session_reference_no ,
                   curr.outpatient_appointment_reference_no curr_outpatient_appointment_reference_no ,
                   curr.outpatient_appointment_encounter_id curr_outpatient_appointment_encounter_id ,
                   curr.outpatient_clinic_reference_no curr_outpatient_clinic_reference_no ,
                   curr.outpatient_specialty_reference_no curr_outpatient_specialty_reference_no ,
                   curr.outpatient_health_specialty_code curr_outpatient_health_specialty_code ,
                   curr.appointed_clinician_reference_no curr_appointed_clinician_reference_no ,
                   curr.seen_by_clinician_reference_no curr_seen_by_clinician_reference_no ,
                   curr.appointment_start_date curr_appointment_start_date ,
                   curr.appointment_end_date curr_appointment_end_date ,
                   prev.outpatient_appointment_reference_no prev_outpatient_appointment_reference_no ,
                   prev.outpatient_appointment_encounter_id prev_outpatient_appointment_encounter_id ,
                   prev.outpatient_clinic_reference_no prev_outpatient_clinic_reference_no ,
                   prev.outpatient_specialty_reference_no prev_outpatient_specialty_reference_no ,
                   prev.outpatient_health_specialty_code prev_outpatient_health_specialty_code ,
                   prev.appointed_clinician_reference_no prev_appointed_clinician_reference_no ,
                   prev.seen_by_clinician_reference_no prev_seen_by_clinician_reference_no ,
                   prev.appointment_start_date prev_appointment_start_date ,
                   prev.appointment_end_date prev_appointment_end_date ,
                   next.outpatient_appointment_reference_no next_outpatient_appointment_reference_no ,
                   next.outpatient_appointment_encounter_id next_outpatient_appointment_encounter_id ,
                   next.outpatient_clinic_reference_no next_outpatient_clinic_reference_no ,
                   next.outpatient_specialty_reference_no next_outpatient_specialty_reference_no ,
                   next.outpatient_health_specialty_code next_outpatient_health_specialty_code ,
                   next.appointed_clinician_reference_no next_appointed_clinician_reference_no ,
                   next.seen_by_clinician_reference_no next_seen_by_clinician_reference_no ,
                   next.appointment_start_date next_appointment_start_date ,
                   next.appointment_end_date next_appointment_end_date ,
                   first.outpatient_appointment_reference_no first_outpatient_appointment_reference_no ,
                   first.outpatient_appointment_encounter_id first_outpatient_appointment_encounter_id ,
                   first.outpatient_clinic_reference_no first_outpatient_clinic_reference_no ,
                   first.outpatient_specialty_reference_no first_outpatient_specialty_reference_no ,
                   first.outpatient_health_specialty_code first_outpatient_health_specialty_code ,
                   first.appointed_clinician_reference_no first_appointed_clinician_reference_no ,
                   first.seen_by_clinician_reference_no first_seen_by_clinician_reference_no ,
                   first.appointment_start_date first_appointment_start_date ,
                   first.appointment_end_date first_appointment_end_date ,
                   first.patient_arrived_date last_appointment_arrived_date ,
                   first.patient_seen_by_date last_appointment_seen_by_date ,
                   first.patient_departed_date last_appointment_departed_date ,
                   last.outpatient_appointment_reference_no last_outpatient_appointment_reference_no ,
                   last.outpatient_appointment_encounter_id last_outpatient_appointment_encounter_id ,
                   last.outpatient_clinic_reference_no last_outpatient_clinic_reference_no ,
                   last.outpatient_specialty_reference_no last_outpatient_specialty_reference_no ,
                   last.outpatient_health_specialty_code last_outpatient_health_specialty_code ,
                   last.appointed_clinician_reference_no last_appointed_clinician_reference_no ,
                   last.seen_by_clinician_reference_no last_seen_by_clinician_reference_no ,
                   last.appointment_start_date last_appointment_start_date ,
                   last.appointment_end_date last_appointment_end_date ,
                   last.patient_arrived_date last_appointment_arrived_date ,
                   last.patient_seen_by_date last_appointment_seen_by_date ,
                   last.patient_departed_date last_appointment_departed_date
              FROM s_outpatient_appointment_10 curr
              LEFT OUTER JOIN s_outpatient_appointment_10 prev
                ON prev.patient_reference_no = curr.patient_reference_no
               AND prev.patient_appointment_seq_num = curr.patient_appointment_seq_num - 1
              LEFT OUTER JOIN s_outpatient_appointment_10 NEXT
                ON next.patient_reference_no = curr.patient_reference_no
               AND next.patient_appointment_seq_num = curr.patient_appointment_seq_num + 1
              LEFT OUTER JOIN s_outpatient_appointment_10 FIRST
                ON first.patient_reference_no = curr.patient_reference_no
               AND first.patient_appointment_seq_num = 1
              LEFT OUTER JOIN s_outpatient_appointment_10 LAST
                ON last.patient_reference_no = curr.patient_reference_no
               AND last.patient_appointment_seq_num = curr.patient_appointment_count
        dependencies:
          - locationName: STAGE
            nodeName: S_OUTPATIENT_APPOINTMENT_10
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('STAGE','S_OUTPATIENT_APPOINTMENT_10') }}
        name: S_OUTPATIENT_APPOINTMENT_PREV_NEXT_V
        noLinkRefs: []
  name: S_OUTPATIENT_APPOINTMENT_PREV_NEXT_V
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
