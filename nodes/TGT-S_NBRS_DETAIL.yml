fileVersion: 1
id: 7eeb535e-2058-4cb0-951f-2a4671be90a0
name: S_NBRS_DETAIL
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 76a39d55-6499-48c4-a487-dcdb6eefb060
          stepCounter: 7eeb535e-2058-4cb0-951f-2a4671be90a0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NBRS_DETAIL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 534dcb6d-ba05-4a32-a8ff-400dfc1f005a
                stepCounter: a8ccd3ce-bdde-45ab-a629-1589552ba494
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 638e8dcf-f9aa-4d68-b16d-729a37d49ee4
          stepCounter: 7eeb535e-2058-4cb0-951f-2a4671be90a0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c1afcde-8fc2-4471-b3ae-4c94d6064aec
                stepCounter: 27157083-4019-40ef-b39f-a70b955092ef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92b2d0a3-74a4-47e4-b1be-e247032c210c
          stepCounter: 7eeb535e-2058-4cb0-951f-2a4671be90a0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CPAC_SCORING_CATEGORY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d6d58482-6e20-4e2e-b820-0dca415e04a6
                stepCounter: a8ccd3ce-bdde-45ab-a629-1589552ba494
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f708eb8-a1ea-4663-9d22-f579f9ebde64
          stepCounter: 7eeb535e-2058-4cb0-951f-2a4671be90a0
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: CPAC_SCORING_CATEGORY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b2d64ce-cc8e-41fc-ae9a-58697b97266a
                stepCounter: f8933f2c-0b6e-4df8-ba37-ef15c338a6ef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 76107fcb-934b-483f-aaae-d58ec2a4e7ef
          stepCounter: 7eeb535e-2058-4cb0-951f-2a4671be90a0
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: CPAC_SCORING_CATEGORY_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c79b6dda-6c5f-4b49-8467-d6aeafbb77e0
                stepCounter: f8933f2c-0b6e-4df8-ba37-ef15c338a6ef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a44d0fd5-d8ef-4ea1-853c-5f902843572a
          stepCounter: 7eeb535e-2058-4cb0-951f-2a4671be90a0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e152d303-0370-4971-ab85-a5407b636878
                stepCounter: a8ccd3ce-bdde-45ab-a629-1589552ba494
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 114548c1-4544-45cd-a5e4-d20384a8c86e
          stepCounter: 7eeb535e-2058-4cb0-951f-2a4671be90a0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ASSESSMENT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 463e5bf3-3404-4054-8c0c-4ac95e62659b
                stepCounter: a8ccd3ce-bdde-45ab-a629-1589552ba494
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c450b079-9e0c-44eb-b515-6f3a522ebc0d
          stepCounter: 7eeb535e-2058-4cb0-951f-2a4671be90a0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CPAC_SCORE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c1a0e4c-013c-477b-a7a8-07664c10bbb0
                stepCounter: a8ccd3ce-bdde-45ab-a629-1589552ba494
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94d32f26-fc99-49d3-9e6d-4b301bf9f5a8
          stepCounter: 7eeb535e-2058-4cb0-951f-2a4671be90a0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_ASSESSMENT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 534dcb6d-ba05-4a32-a8ff-400dfc1f005a
                stepCounter: a8ccd3ce-bdde-45ab-a629-1589552ba494
            transform: ROW_NUMBER() OVER (PARTITION BY ds_pims_nbrs_details.wlist_refno ORDER BY assess_dttm DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d02c9da-0d71-4e0c-8402-8c92d18d3195
          stepCounter: 7eeb535e-2058-4cb0-951f-2a4671be90a0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_PIMS_NBRS_DETAILS
        join:
          joinCondition: |-
            FROM ds_pims_nbrs_details
             INNER JOIN ds_shared_waitlist
                ON ds_shared_waitlist.wlist_refno = ds_pims_nbrs_details.wlist_refno
              LEFT OUTER JOIN dim.dim_CPAC_scoring_category
                ON ds_pims_nbrs_details.accpt_refno = dim_CPAC_scoring_category.CPAC_scoring_category_reference_no
               AND IFNULL(dim_CPAC_scoring_category.dss_start_date, GETDATE()-10000) <= ds_pims_nbrs_details.assess_dttm
               AND IFNULL(dim_CPAC_scoring_category.dss_end_date, GETDATE()+10000) >= ds_pims_nbrs_details.assess_dttm
             WHERE ds_shared_waitlist.dss_update_time > @v_pa_main_incremental
        name: S_NBRS_DETAIL
        noLinkRefs: []
  name: S_NBRS_DETAIL
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
