fileVersion: 1
id: 741f0f92-29c2-403f-b62f-c119050c2375
name: S_PIMS_PROVIDER_SPELLS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55657448-be2f-4a2b-8320-a7b85d67d592
          stepCounter: 741f0f92-29c2-403f-b62f-c119050c2375
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: PRVSP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59d3088d-97f2-4c53-9ebc-ae021c7b49e2
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1bc9f1b-8a67-4ba7-8c95-f1d1f22766d4
          stepCounter: 741f0f92-29c2-403f-b62f-c119050c2375
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: PATNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f7b850f-ce72-4e87-b4f3-6e2838f4dd0a
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be6c2a18-3864-4312-8a21-a2349740a38e
          stepCounter: 741f0f92-29c2-403f-b62f-c119050c2375
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMIT_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1125cf7f-7027-45ac-acc8-b3a92505c4da
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7886c371-e8a9-4cf6-adce-99d270245cfe
          stepCounter: 741f0f92-29c2-403f-b62f-c119050c2375
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCH_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee3a67e8-1a53-44ab-aa64-cafc588de09c
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c053c3e2-5b61-4faf-b95f-75531a912133
          stepCounter: 741f0f92-29c2-403f-b62f-c119050c2375
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: health_org_level2_code
        name: HOSPITAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 85c28e49-2482-4b2e-9f43-66ed53f59423
                stepCounter: 4dbeb7b4-8557-4965-a256-fab03c67ecf4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98b3dcd0-b527-4eb5-a047-58510eb65f4b
          stepCounter: 741f0f92-29c2-403f-b62f-c119050c2375
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: hospital_id (e.g. 3215, 3216)
        name: HOSPITAL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 531d5813-2cdf-4344-a681-ec78f26388da
                stepCounter: 4dbeb7b4-8557-4965-a256-fab03c67ecf4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a4b7c97a-2634-4b46-ba9c-683b13dc5ae1
          stepCounter: 741f0f92-29c2-403f-b62f-c119050c2375
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DS_PIMS_PROVIDER_SPELLS: 1206df94-8ac6-4021-a171-232e071d9dc2
          DS_PIMS_SERVICE_POINTS: 00ad68b8-b3a1-4406-bae4-ef41c7c67d56
          S_HEALTH_ORG_2: 4dbeb7b4-8557-4965-a256-fab03c67ecf4
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_PIMS_PROVIDER_SPELLS
          - locationName: TGT
            nodeName: DS_PIMS_SERVICE_POINTS
          - locationName: TGT
            nodeName: S_HEALTH_ORG_2
        join:
          joinCondition: |-
            FROM {{ ref('TGT','DS_PIMS_PROVIDER_SPELLS') }}
              LEFT OUTER JOIN {{ ref('TGT','DS_PIMS_SERVICE_POINTS') }}
                ON ds_pims_provider_spells.spont_refno = ds_pims_service_points.spont_refno
              LEFT OUTER JOIN {{ ref('TGT','S_HEALTH_ORG_2') }}
                ON ds_pims_service_points.heorg_refno = s_health_org_2.health_org_reference_no
             WHERE ds_pims_provider_spells.Archv_flag = 'N'
        name: S_PIMS_PROVIDER_SPELLS
        noLinkRefs: []
  name: S_PIMS_PROVIDER_SPELLS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
