fileVersion: 1
id: a21d1ead-f234-445a-9637-b66949901878
name: S_CONSOLIDATE_WHITEBOARD_ACTION
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06a3f6f1-2282-4931-88fb-46eb98927d37
          stepCounter: a21d1ead-f234-445a-9637-b66949901878
        config: {}
        dataType: INT
        defaultValue: ""
        description: whiteboard unique id from WB cacheAudit table
        isBusinessKey: true
        name: WHITEBOARD_ACTION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7bed104e-3fe2-45b9-aaa5-e29c5438dc11
                stepCounter: 914a2284-f7d4-4f19-84c2-3be76fa221a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2abb8940-954c-4811-8888-fdd2b167dd82
          stepCounter: a21d1ead-f234-445a-9637-b66949901878
        config: {}
        dataType: INT
        defaultValue: ""
        description: stay_reference_no
        name: STAY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6906e55b-0104-4c09-9476-a2019e0f821f
                stepCounter: 914a2284-f7d4-4f19-84c2-3be76fa221a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 241eb07e-75ee-495d-ae55-ee82df5720a1
          stepCounter: a21d1ead-f234-445a-9637-b66949901878
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 946b8512-6c6b-4f06-8b3b-2cd341729516
                stepCounter: 914a2284-f7d4-4f19-84c2-3be76fa221a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc81555f-9005-4784-ba73-e324bed333af
          stepCounter: a21d1ead-f234-445a-9637-b66949901878
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: datetime at which the action was performed
        name: WB_ACTION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b0f777e-4cfd-476c-a22b-3bfc0b203dc8
                stepCounter: 914a2284-f7d4-4f19-84c2-3be76fa221a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 715ff9b9-998a-4442-ab94-d30e29ea31e6
          stepCounter: a21d1ead-f234-445a-9637-b66949901878
        config: {}
        dataType: INT
        defaultValue: ""
        description: Sequence of seen by action within encounter
        name: SEEN_BY_ACTION_SEQUENCE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 85b6e40a-427b-41fc-bb9e-65cbf722c6fb
                stepCounter: 914a2284-f7d4-4f19-84c2-3be76fa221a4
            transform: |-
              CASE WHEN seen_by_action = 1 THEN ROW_NUMBER() OVER(PARTITION BY attendance_encounter_id, seen_by_action ORDER BY WB_action_date ,whiteboard_action_key)
                          ELSE 0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1998a90-de69-46b8-b61b-90e1c2b4765e
          stepCounter: a21d1ead-f234-445a-9637-b66949901878
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SEEN_BY_ACTION_DR
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b35eca1-d496-4218-b57b-84294a187a28
                stepCounter: 914a2284-f7d4-4f19-84c2-3be76fa221a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79c1a43d-ac4a-404b-9e8b-fbf930c32725
          stepCounter: a21d1ead-f234-445a-9637-b66949901878
        config: {}
        dataType: INT
        defaultValue: ""
        description: Is the action deleted by a removal action
        name: REMOVED_ACTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d1397a1e-399e-40a2-b9aa-a4785962bdd9
                stepCounter: 914a2284-f7d4-4f19-84c2-3be76fa221a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57f35294-b607-487d-a203-0dbd5c14e71e
          stepCounter: a21d1ead-f234-445a-9637-b66949901878
        config: {}
        dataType: INT
        defaultValue: ""
        description: Was the action performed a seenby action? 1 = yes
        name: SEEN_BY_ACTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7803174d-04fc-45e8-bb25-7b74eeada454
                stepCounter: 914a2284-f7d4-4f19-84c2-3be76fa221a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8809181-3e06-48d9-9497-cdf2274b42cf
          stepCounter: a21d1ead-f234-445a-9637-b66949901878
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: WB_ACTION_PERFORMED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e65ec44-7190-4f39-8fd3-60eaff243d5d
                stepCounter: 914a2284-f7d4-4f19-84c2-3be76fa221a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f1e9eacf-5c98-4485-a810-dbc6432ce455
          stepCounter: a21d1ead-f234-445a-9637-b66949901878
        config: {}
        dataType: INT
        defaultValue: ""
        description: Action type sequence within an event
        name: EVENT_ACTION_TYPE_SEQUENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd15cbc1-1654-4c96-9089-0e581ec8e791
                stepCounter: 914a2284-f7d4-4f19-84c2-3be76fa221a4
            transform: ROW_NUMBER() OVER(PARTITION BY attendance_encounter_id, WB_action_performed ORDER BY WB_action_date,whiteboard_action_key)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 63fca3b7-9f4b-49df-bcda-da51ea6ffd1b
          stepCounter: a21d1ead-f234-445a-9637-b66949901878
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: iPM specialty under which the action was performed
        name: WB_ACTION_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4711eb63-ca23-475f-bbf8-92cf7d3ded9a
                stepCounter: 914a2284-f7d4-4f19-84c2-3be76fa221a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a537c86-4191-4d16-a4a3-f505e7b72deb
          stepCounter: a21d1ead-f234-445a-9637-b66949901878
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: iPM specialty group EMMED or other as they are managed independently
        name: SPECIALTY_CODE_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0865da1a-d141-4486-b563-52b7c4067cca
                stepCounter: 914a2284-f7d4-4f19-84c2-3be76fa221a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3669ed5a-fc7a-4583-b038-cb6387e187b8
          stepCounter: a21d1ead-f234-445a-9637-b66949901878
        config: {}
        dataType: INT
        defaultValue: ""
        description: Sequence or seen bys within an specialty grouping
        name: SPECIALTY_GROUP_SEQUENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ROW_NUMBER() OVER(PARTITION BY attendance_encounter_id, seen_by_action, removed_action, specialty_code_group ORDER BY WB_action_date,whiteboard_action_key)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb348728-1d99-4000-a1f4-7da3346abedf
          stepCounter: a21d1ead-f234-445a-9637-b66949901878
        config: {}
        dataType: INT
        defaultValue: ""
        description: Reverse Sequence for seen bys within an specialty grouping
        name: SPECIALTY_GROUP_SEQUENCE_REV
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ROW_NUMBER() OVER(PARTITION BY attendance_encounter_id, seen_by_action, removed_action, specialty_code_group ORDER BY WB_action_date DESC,whiteboard_action_key DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd338cee-27c7-4724-a49d-265c261a4245
          stepCounter: a21d1ead-f234-445a-9637-b66949901878
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_CENTRIC_SEENBY_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09b9eadb-cbda-4dcc-8fe3-80536915afb8
                stepCounter: 914a2284-f7d4-4f19-84c2-3be76fa221a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e4716d1-63b6-474f-b38e-8b7d1db06d22
          stepCounter: a21d1ead-f234-445a-9637-b66949901878
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e278038c-e4f9-4a9e-b239-7ec8356cd2a7
                stepCounter: 914a2284-f7d4-4f19-84c2-3be76fa221a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 44e0928a-c8cd-4387-9bf0-256ba163c736
          stepCounter: a21d1ead-f234-445a-9637-b66949901878
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_WB_ACTION_ASSIGNED_CONSULTANT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dd09d7f5-dc09-4637-9cc7-b7c2fdc3d3b2
                stepCounter: 914a2284-f7d4-4f19-84c2-3be76fa221a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 61257569-d63b-4481-b5e7-1bb1485a58c5
          stepCounter: a21d1ead-f234-445a-9637-b66949901878
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_whiteboard_action.WB_action_specialty_code=dim_ED_WB_action_specialty.ED_WB_action_specialty_code
        name: DIM_ED_WB_ACTION_SPECIALTY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 893d1da4-b89e-4871-a540-13aa5e2cde0f
                stepCounter: 914a2284-f7d4-4f19-84c2-3be76fa221a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9eb4757-83dd-43e9-83e6-a9ace615f6df
          stepCounter: a21d1ead-f234-445a-9637-b66949901878
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_whiteboard_action.WB_action_seenby_doctor=dim_ED_WB_action_seenby_clinician.WB_action_seenby_clinician_user_code
        name: DIM_ED_WB_ACTION_SEENBY_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3420aaa4-4404-49af-b199-954f35d22bb8
                stepCounter: 914a2284-f7d4-4f19-84c2-3be76fa221a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9bf3e84-e23b-4d9b-b6cd-b1e37ec1caa3
          stepCounter: a21d1ead-f234-445a-9637-b66949901878
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_whiteboard_action.WB_action_performed=dim_ED_WB_action.WB_action_performed
        name: DIM_ED_WB_ACTION_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64676f56-4f07-45bc-9221-8971d4b409e3
                stepCounter: 914a2284-f7d4-4f19-84c2-3be76fa221a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e952c5bd-f444-4021-80a5-57ac1d213794
          stepCounter: a21d1ead-f234-445a-9637-b66949901878
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_whiteboard_action.service_point_code=dim_ED_location.ED_location_reference_no
        name: DIM_ED_LOCATION_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f383c14d-bf63-4eee-9a9a-ecf849348064
                stepCounter: 914a2284-f7d4-4f19-84c2-3be76fa221a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 096d5015-c834-4e83-ae54-e83d9bd96ced
          stepCounter: a21d1ead-f234-445a-9637-b66949901878
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: datetime the record was crated
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 04c83fdf-11c3-4dd3-b368-b56d338bbbca
                stepCounter: 914a2284-f7d4-4f19-84c2-3be76fa221a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5aa4eb6e-b2f8-40b6-839d-50a00c2fae70
          stepCounter: a21d1ead-f234-445a-9637-b66949901878
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: iPM encounter number
        name: ATTENDANCE_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9ad362bb-6f1e-40d8-9aa1-b1bb46fb2d6e
                stepCounter: 914a2284-f7d4-4f19-84c2-3be76fa221a4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88ce068d-f243-4915-908c-d15d39b47d3e
          stepCounter: a21d1ead-f234-445a-9637-b66949901878
        config: {}
        dataType: INT
        defaultValue: ""
        description: Sequence tof action within encounter
        name: ACTION_SEQUENCE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e983aa4-4f15-4f93-a6fd-a14bf3ed7b30
                stepCounter: 914a2284-f7d4-4f19-84c2-3be76fa221a4
            transform: ROW_NUMBER() OVER(PARTITION BY attendance_encounter_id ORDER BY WB_action_date,whiteboard_action_key)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8866c29-8b79-4148-ba7d-8db1c05b1be2
          stepCounter: a21d1ead-f234-445a-9637-b66949901878
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_CONSOLIDATE_WHITEBOARD_ACTION_10
        join:
          joinCondition: |-
            FROM ds_consolidate_whiteboard_action_10
              JOIN s_centric_encounter_changes
                ON ds_consolidate_whiteboard_action_10.attendance_encounter_id = s_centric_encounter_changes.encounter --where dss_update_time >@v_pa_ed_incremental
        name: S_CONSOLIDATE_WHITEBOARD_ACTION
        noLinkRefs: []
  name: S_CONSOLIDATE_WHITEBOARD_ACTION
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
