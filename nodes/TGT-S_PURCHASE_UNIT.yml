fileVersion: 1
id: bb1754b1-60b8-4775-8768-a255cb21189a
name: S_PURCHASE_UNIT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b36afed8-b8e8-4c33-9c36-54bf775fa9e2
          stepCounter: bb1754b1-60b8-4775-8768-a255cb21189a
        config: {}
        dataType: INTEGER IDENTITY(1,1)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74792c59-8c03-4135-80a0-f73a6d044e3f
          stepCounter: bb1754b1-60b8-4775-8768-a255cb21189a
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_LEVEL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 992a482c-e9ad-438d-b138-c24bfd58e8c5
                stepCounter: 26aecadb-8bd8-4589-86f8-6b7fecbe96ec
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: afb8481d-a7ca-4630-950a-182c2e43684f
          stepCounter: bb1754b1-60b8-4775-8768-a255cb21189a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: MAJOR_SERVICE_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 34b79108-fa96-435a-87da-62b1acd2f992
                stepCounter: 26aecadb-8bd8-4589-86f8-6b7fecbe96ec
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d680d0bf-e642-43d2-a22b-e2b6e97f6aa8
          stepCounter: bb1754b1-60b8-4775-8768-a255cb21189a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_CATEGORY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 108d77bb-807e-454a-8f6c-47142f4a9d60
                stepCounter: 26aecadb-8bd8-4589-86f8-6b7fecbe96ec
            transform: |-
              CASE WHEN l_reference_All_PurchaseUnits.category IS NULL THEN (SELECT MAX(PU.category) FROM l_reference_All_PurchaseUnits PU WHERE PU.purchaseunitcode = l_reference_All_PurchaseUnits.purchaseunitcode)
                          ELSE l_reference_All_PurchaseUnits.category
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db064535-d6d5-4913-9743-fb3515c10a28
          stepCounter: bb1754b1-60b8-4775-8768-a255cb21189a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_SUB_CATEGORY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7175d25a-8625-4218-8447-6e93cc411105
                stepCounter: 26aecadb-8bd8-4589-86f8-6b7fecbe96ec
            transform: |-
              CASE WHEN l_reference_All_PurchaseUnits.subcat IS NULL THEN (SELECT MAX(PU.subcat) FROM l_reference_All_PurchaseUnits PU WHERE PU.purchaseunitcode = l_reference_All_PurchaseUnits.purchaseunitcode)
                          ELSE l_reference_All_PurchaseUnits.subcat
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8310e62b-37cb-4ad3-911c-fea4d27ba86c
          stepCounter: bb1754b1-60b8-4775-8768-a255cb21189a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b3aac36f-5380-4fca-8f68-5e6252253141
                stepCounter: 26aecadb-8bd8-4589-86f8-6b7fecbe96ec
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d40e0efa-294f-4310-92f6-cd4310d33221
          stepCounter: bb1754b1-60b8-4775-8768-a255cb21189a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 58db03ae-4b19-40f9-9872-8882c161b901
                stepCounter: 26aecadb-8bd8-4589-86f8-6b7fecbe96ec
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e81ed2f-d2fe-410c-8887-72ea6521990e
          stepCounter: bb1754b1-60b8-4775-8768-a255cb21189a
        config: {}
        dataType: VARCHAR(2000)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_DEFINITION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 771caf50-6be9-4fe0-8a3d-1855b3fdb532
                stepCounter: 26aecadb-8bd8-4589-86f8-6b7fecbe96ec
            transform: SUBSTRING(l_reference_All_PurchaseUnits.purchaseunitdefinition,1,2000)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5c1338a-3bcf-474a-94a3-f7258df28dad
          stepCounter: bb1754b1-60b8-4775-8768-a255cb21189a
        config: {}
        dataType: VARCHAR(300)
        defaultValue: ""
        description: ""
        name: SERVICE_SPECIFICATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18275efd-c931-4475-90cc-986f8b6d5340
                stepCounter: 26aecadb-8bd8-4589-86f8-6b7fecbe96ec
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d05b6df-3f3f-4124-81ab-e224137b0093
          stepCounter: bb1754b1-60b8-4775-8768-a255cb21189a
        config: {}
        dataType: VARCHAR(60)
        defaultValue: ""
        description: ""
        name: OUTPUT_CLASS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1e9b916-7b65-474f-84aa-266029dffba4
                stepCounter: 26aecadb-8bd8-4589-86f8-6b7fecbe96ec
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee04ec75-bb9b-4496-b20c-492cb4f5c7ae
          stepCounter: bb1754b1-60b8-4775-8768-a255cb21189a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: UNIT_OF_MEASURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e6ad573-4f0c-4b38-b36d-ea1de181135d
                stepCounter: 26aecadb-8bd8-4589-86f8-6b7fecbe96ec
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c758519-7cee-4c07-be56-daa48387769b
          stepCounter: bb1754b1-60b8-4775-8768-a255cb21189a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: UNIT_OF_MEASURE_DEFINITION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 341256a3-a21f-4072-91e6-dc9194020265
                stepCounter: 26aecadb-8bd8-4589-86f8-6b7fecbe96ec
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 37f2b125-9744-4a4f-ba8f-5eb12dc43e60
          stepCounter: bb1754b1-60b8-4775-8768-a255cb21189a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: GENERAL_LEDGER_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aaaad614-d562-4896-b3e4-823c2a364990
                stepCounter: 26aecadb-8bd8-4589-86f8-6b7fecbe96ec
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ed9fe2b-d65d-4863-9728-9b93909224d2
          stepCounter: bb1754b1-60b8-4775-8768-a255cb21189a
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: FINANCIAL_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b0723cbc-20a0-419f-b36f-753fc105c053
                stepCounter: 26aecadb-8bd8-4589-86f8-6b7fecbe96ec
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11d61720-734a-4b90-9156-2d547c4719ea
          stepCounter: bb1754b1-60b8-4775-8768-a255cb21189a
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: ""
        name: NATIONAL_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa1347c1-0dfa-45e4-bd65-b69933ebfc8c
                stepCounter: 26aecadb-8bd8-4589-86f8-6b7fecbe96ec
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c5fcad0-eb1d-4a7e-8bd2-99dfdf1b5dd8
          stepCounter: bb1754b1-60b8-4775-8768-a255cb21189a
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: ""
        name: LOCAL_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8d5aa66c-4a2b-4037-8bb7-0fc2eed5e927
                stepCounter: 26aecadb-8bd8-4589-86f8-6b7fecbe96ec
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc055f0a-d94a-4cc3-904b-fdbec42885be
          stepCounter: bb1754b1-60b8-4775-8768-a255cb21189a
        config: {}
        dataType: CHAR(50)
        defaultValue: ""
        description: ""
        name: NATIONAL_COLLECTIONS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 92616965-d08e-4826-86d3-1d5f48efe4fc
                stepCounter: 26aecadb-8bd8-4589-86f8-6b7fecbe96ec
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a795b547-8a7e-42d1-afab-4b67a21c4079
          stepCounter: bb1754b1-60b8-4775-8768-a255cb21189a
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: VERSION_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 505a2ee7-de15-407e-8308-12d328cc8125
                stepCounter: 26aecadb-8bd8-4589-86f8-6b7fecbe96ec
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dd59f835-dc7f-4253-b63a-0f4b6a8d21f0
          stepCounter: bb1754b1-60b8-4775-8768-a255cb21189a
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: VALIDITY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a5fe8fd5-28b7-4e62-b44d-6804bb604b47
                stepCounter: 26aecadb-8bd8-4589-86f8-6b7fecbe96ec
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fbf20da7-8ddb-40f8-acad-f6586c1d2768
          stepCounter: bb1754b1-60b8-4775-8768-a255cb21189a
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: VALIDITY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 13e2ff61-86c5-4705-8810-64be6cad1115
                stepCounter: 26aecadb-8bd8-4589-86f8-6b7fecbe96ec
            transform: dateadd(ss,59,dateadd(mi,59,dateadd(hh,23,l_reference_All_PurchaseUnits.enddate)))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 739fa00f-ddab-47f2-b96e-9d6e307b9f7e
          stepCounter: bb1754b1-60b8-4775-8768-a255cb21189a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: REMAP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 13963078-511a-45ed-8f1f-2ebdef067a47
                stepCounter: 26aecadb-8bd8-4589-86f8-6b7fecbe96ec
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c67b2439-374f-4215-b013-ca9888021687
          stepCounter: bb1754b1-60b8-4775-8768-a255cb21189a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 428f83ec-a913-4650-9c56-36188e300ba6
                stepCounter: 26aecadb-8bd8-4589-86f8-6b7fecbe96ec
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea003c57-630d-41a8-8083-9a54f2566645
          stepCounter: bb1754b1-60b8-4775-8768-a255cb21189a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: UPDATE_INFO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cc25d71c-2d30-4637-9f7c-6fa9c34c1a3d
                stepCounter: 26aecadb-8bd8-4589-86f8-6b7fecbe96ec
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2182eb0e-1ef0-4933-80e1-c8cc0435f36a
          stepCounter: bb1754b1-60b8-4775-8768-a255cb21189a
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: NPF_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e4dbcb4-5dc4-4773-8295-72eb59127691
                stepCounter: 26aecadb-8bd8-4589-86f8-6b7fecbe96ec
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 99a6321c-d02a-4c52-a6ab-d309ffd847e7
          stepCounter: bb1754b1-60b8-4775-8768-a255cb21189a
        config: {}
        dataType: NVARCHAR(255)
        defaultValue: ""
        description: ""
        name: NPF_ENCOUNTER_TYPE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dfdcae81-79e6-4a35-b6f9-3d8b8fa37ead
                stepCounter: 11fd84c1-cbb1-4e78-8214-d7798ae8e52f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71d89b3b-680e-42e8-a71a-3def7de2b469
          stepCounter: bb1754b1-60b8-4775-8768-a255cb21189a
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: NPF_SERVICE_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d118e34-168b-4a74-b7d4-936533ee0ecf
                stepCounter: 26aecadb-8bd8-4589-86f8-6b7fecbe96ec
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6da5f39-92c5-461f-b72f-c41796ccbab8
          stepCounter: bb1754b1-60b8-4775-8768-a255cb21189a
        config: {}
        dataType: NVARCHAR(255)
        defaultValue: ""
        description: ""
        name: NPF_SERVICE_TYPE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0249b4c7-6dee-450d-ab2b-076cbd7e37dc
                stepCounter: a895f432-40f9-4d01-acb8-8055c5c131ea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aaa1d926-6ded-49bf-adc4-2b3175cccee7
          stepCounter: bb1754b1-60b8-4775-8768-a255cb21189a
        config: {}
        dataType: CHAR(4)
        defaultValue: ""
        description: ""
        name: NPF_SERVICE_SUB_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ca4ab3e0-4e17-4908-8948-ac6555b7df97
                stepCounter: 26aecadb-8bd8-4589-86f8-6b7fecbe96ec
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 73d2a376-fdde-4d0a-9d6f-704502689972
          stepCounter: bb1754b1-60b8-4775-8768-a255cb21189a
        config: {}
        dataType: NVARCHAR(255)
        defaultValue: ""
        description: ""
        name: NPF_SERVICE_SUB_TYPE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d8f14866-aa63-4039-a0cb-82a7bfadaa37
                stepCounter: 10a6392d-ed2a-4032-a298-1771dce6c5af
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e277fab-3aa0-4b6e-aed2-277b6727399f
          stepCounter: bb1754b1-60b8-4775-8768-a255cb21189a
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_REFERENCE_ENCOUNTER_TYPE: 11fd84c1-cbb1-4e78-8214-d7798ae8e52f
          S_REFERENCE_SERVICE_TYPE: a895f432-40f9-4d01-acb8-8055c5c131ea
          S_REFERENCE_SERVICE_SUB_TYPE: 10a6392d-ed2a-4032-a298-1771dce6c5af
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_REFERENCE_ENCOUNTER_TYPE
          - locationName: TGT
            nodeName: S_REFERENCE_SERVICE_TYPE
          - locationName: TGT
            nodeName: S_REFERENCE_SERVICE_SUB_TYPE
        join:
          joinCondition: |-
            FROM l_reference_All_PurchaseUnits
              LEFT OUTER JOIN {{ ref('TGT','S_REFERENCE_ENCOUNTER_TYPE') }}
                ON l_reference_All_PurchaseUnits.NPF_encounter_type = s_reference_encounter_type.NPF_encounter_type_code
              LEFT OUTER JOIN {{ ref('TGT','S_REFERENCE_SERVICE_TYPE') }}
                ON l_reference_All_PurchaseUnits.NPF_service_type = s_reference_service_type.NPF_service_type_code
              LEFT OUTER JOIN {{ ref('TGT','S_REFERENCE_SERVICE_SUB_TYPE') }}
                ON l_reference_All_PurchaseUnits.NPF_service_sub_type = s_reference_service_sub_type.NPF_service_sub_type_code
        name: S_PURCHASE_UNIT
        noLinkRefs: []
  name: S_PURCHASE_UNIT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
