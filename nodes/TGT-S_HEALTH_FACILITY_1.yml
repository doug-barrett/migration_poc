fileVersion: 1
id: 663dc4b6-24b5-411d-90ac-473eeb8995f9
name: S_HEALTH_FACILITY_1
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Health Facilities defined by the MOH"
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c8eb172-6140-427e-9e5f-749ec367c220
          stepCounter: 663dc4b6-24b5-411d-90ac-473eeb8995f9
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: HEALTH_FACILITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a04ee8f7-8f5e-4b1c-b5f7-397f3d2721c0
                stepCounter: 4cb1ea3b-9be6-4245-a251-a1a15a980ddc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 548878ea-621c-41f8-bb49-7bcfe99080b7
          stepCounter: 663dc4b6-24b5-411d-90ac-473eeb8995f9
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: HEALTH_FACILITY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f513d8b8-b348-4b07-bed4-e275b7a4c8ed
                stepCounter: 4cb1ea3b-9be6-4245-a251-a1a15a980ddc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7e05e89-efe4-465c-a199-f42cf9bf9968
          stepCounter: 663dc4b6-24b5-411d-90ac-473eeb8995f9
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: HEALTH_FACILITY_ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d58215f-6696-4894-84e3-dc9a8a5d1fab
                stepCounter: 4cb1ea3b-9be6-4245-a251-a1a15a980ddc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d0185bf6-6ec4-4b9b-a72c-6c21b099fcee
          stepCounter: 663dc4b6-24b5-411d-90ac-473eeb8995f9
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FACILITY_OPENING_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 212af72d-fccc-4f68-9884-a54fcefcabd4
                stepCounter: 4cb1ea3b-9be6-4245-a251-a1a15a980ddc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f756bc3a-4fe2-47c6-887c-bfdc00f494fe
          stepCounter: 663dc4b6-24b5-411d-90ac-473eeb8995f9
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FACILITY_CLOSING_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c5e8bbf-3dcc-44d5-bcde-cc1643692ec1
                stepCounter: 4cb1ea3b-9be6-4245-a251-a1a15a980ddc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f8d1e16-8827-4f85-a059-042d2bfbd7bb
          stepCounter: 663dc4b6-24b5-411d-90ac-473eeb8995f9
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: CASEMIX_FACILITY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 037cdd03-f405-4135-a2d3-d9ef5ef88b0b
                stepCounter: 4cb1ea3b-9be6-4245-a251-a1a15a980ddc
            transform: |-
              CASE WHEN l_reference_MOH_Facility.casemix_facility = 1 THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1333d97b-9aaa-4a1b-abc0-a41b3cfec203
          stepCounter: 663dc4b6-24b5-411d-90ac-473eeb8995f9
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: MATERNITY_SECONDARY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 329f7282-6baf-47a2-8816-20f36445f04c
                stepCounter: 4cb1ea3b-9be6-4245-a251-a1a15a980ddc
            transform: |-
              CASE WHEN l_reference_MOH_Facility.maternity_secondary = 1 THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 804e8bf9-6a4f-4561-b884-d60f83a3c81b
          stepCounter: 663dc4b6-24b5-411d-90ac-473eeb8995f9
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: MATERNITY_TERTIARY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3a9d418-b2c2-430a-80fd-c09dde7d6624
                stepCounter: 4cb1ea3b-9be6-4245-a251-a1a15a980ddc
            transform: |-
              CASE WHEN l_reference_MOH_Facility.maternity_tertiary = 1 THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8053775-b2cd-49eb-8892-394dcb35c79c
          stepCounter: 663dc4b6-24b5-411d-90ac-473eeb8995f9
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: HPI_FACILITY_ID_CHECKDIGIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 970ce39f-3deb-452d-a6fd-409576c00f52
                stepCounter: 4cb1ea3b-9be6-4245-a251-a1a15a980ddc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cead536f-a02d-4a71-9b7d-a5e1b89f4bf9
          stepCounter: 663dc4b6-24b5-411d-90ac-473eeb8995f9
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: HPI_FACILITY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1677580b-f30d-45c4-a19e-8cc84627d504
                stepCounter: 4cb1ea3b-9be6-4245-a251-a1a15a980ddc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81d2e019-5a9a-49c2-bcda-d72571305547
          stepCounter: 663dc4b6-24b5-411d-90ac-473eeb8995f9
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: VERSION_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e493a304-49ec-4847-989a-5ba43e80d4ba
                stepCounter: 4cb1ea3b-9be6-4245-a251-a1a15a980ddc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c95523dd-69fd-4a68-8b9f-c7a558d23dce
          stepCounter: 663dc4b6-24b5-411d-90ac-473eeb8995f9
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: VERSION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e73a7ef-d61b-4ebf-9c17-8fb79600807e
                stepCounter: 4cb1ea3b-9be6-4245-a251-a1a15a980ddc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 038fd995-df5a-4228-bdae-560ae33d3cb4
          stepCounter: 663dc4b6-24b5-411d-90ac-473eeb8995f9
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: L_REFERENCE_MOH_FACILITY
        join:
          joinCondition: |-
            FROM l_reference_MOH_Facility
             WHERE currentversion = 0
               AND facilityclosingdate IS NULL
               AND NULLIF(healthfacilitycode,'Nil') IS NOT NULL
        name: S_HEALTH_FACILITY_1
        noLinkRefs: []
  name: S_HEALTH_FACILITY_1
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
