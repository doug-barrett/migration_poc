fileVersion: 1
id: 5d126a28-e17c-423e-ac1f-067404fe7aac
name: S_ED_ATTENDANCE_05_OLD
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Combine all source data required to build the ED Attendance Fact"
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 623801e9-0e41-479f-9d8f-069340d33f10
          stepCounter: 5d126a28-e17c-423e-ac1f-067404fe7aac
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Encounter unique identifier
        name: IDENTIFIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 98e7bbf9-19d9-4ad3-9762-fc48190944fa
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fef9588f-e40c-492c-848e-19d9ab6412f8
          stepCounter: 5d126a28-e17c-423e-ac1f-067404fe7aac
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Attendance ref no.
        isBusinessKey: true
        name: AEATT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f105f398-1042-471d-ba39-935c000ef834
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4531652-d075-4981-8576-67432b4f54c2
          stepCounter: 5d126a28-e17c-423e-ac1f-067404fe7aac
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: PIMS health organisation ref no
        name: HEORG_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 607e1d92-8895-4962-a382-8f9bf18d0d79
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2dd94670-1bb9-444a-bdcd-31ccc1f360e5
          stepCounter: 5d126a28-e17c-423e-ac1f-067404fe7aac
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: PIMS service point ref no
        name: SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d738d0ff-4a44-4a6f-8113-fe1750dbf3df
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da24ee7d-7f32-4a10-95f9-b9e5a4c84905
          stepCounter: 5d126a28-e17c-423e-ac1f-067404fe7aac
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Service_Point_Code
        name: SERVICE_POINT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7e926bf-5c30-4064-a2df-9b2fd69159e4
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a537e74-c126-4ed6-8e61-6a9b59213687
          stepCounter: 5d126a28-e17c-423e-ac1f-067404fe7aac
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: health_org_code
        name: HEALTH_ORG_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91ffbce1-63b0-4fc6-accb-79ec28037c7b
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3cd5a96-7983-4403-80e6-397331670ac9
          stepCounter: 5d126a28-e17c-423e-ac1f-067404fe7aac
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Intended specialty ref no.
        name: INTEND_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0193af51-0c9d-40d9-9fa5-472f8d2e60f8
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be5c6a59-8948-472a-9f66-defa27c1bb5e
          stepCounter: 5d126a28-e17c-423e-ac1f-067404fe7aac
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Referral ref no.
        name: REFRL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 662697ec-c773-4224-a540-21a14bd62d2b
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d509776c-91f6-4227-8741-b57a41ebb958
          stepCounter: 5d126a28-e17c-423e-ac1f-067404fe7aac
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Referral date and time.
        name: REFERRAL_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a89deb48-364c-4f53-bdc5-442e98eea59d
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a7b4665-a7b4-49c3-9637-a258710d6853
          stepCounter: 5d126a28-e17c-423e-ac1f-067404fe7aac
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Visit date and time.
        name: ARRIVED_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50f8e45e-6bbe-4ab4-b10f-c2c21a2fabfb
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c428cfaf-bfe6-48f3-88f2-f342a2c524bb
          stepCounter: 5d126a28-e17c-423e-ac1f-067404fe7aac
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time patient discharged.
        name: DEPARTED_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7336d1a4-8c0b-4d69-aea3-ab2ed99d57ba
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9246176-2dda-4cbb-8c18-17abf145f75b
          stepCounter: 5d126a28-e17c-423e-ac1f-067404fe7aac
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Medical discharge date.
        name: MED_DISCH_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e9e2a84-16db-47bb-a1bb-92e7d30ebd75
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3544aa31-0798-4c3c-aee9-473d5072abcc
          stepCounter: 5d126a28-e17c-423e-ac1f-067404fe7aac
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: discharge_destination_reference_no
        name: DISDE_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 32018e16-9ee3-494b-b6ab-38dc3895bd62
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a211a460-48e0-48ac-bb9c-6139f9af0d1f
          stepCounter: 5d126a28-e17c-423e-ac1f-067404fe7aac
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: Discharge destination.
        name: DISCHARGE_DESTINATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2c7c6bf-5e4a-4ec9-b130-7a472baaa347
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a26f95a8-ed49-4c3f-8b6b-327c434e4a9e
          stepCounter: 5d126a28-e17c-423e-ac1f-067404fe7aac
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: discharge_reason_reference_no
        name: ATDIS_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91000b7b-f068-46df-b7be-2c4a334d77ee
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8e3a6df-26b9-4743-a61c-beeb2860944c
          stepCounter: 5d126a28-e17c-423e-ac1f-067404fe7aac
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: Reason for discharge code
        name: DISCHARGE_REASON_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b156df08-0e30-4854-bba4-931d0fc0cff8
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a38cac49-eb55-4e25-958e-f69d0871b313
          stepCounter: 5d126a28-e17c-423e-ac1f-067404fe7aac
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: YN flag indicating whether patient self-discharged.
        name: SELF_DISCHARGE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a3deb8f-3a25-4751-8212-95b137edb182
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eddb3545-bcc1-44c6-baae-4557ef76b243
          stepCounter: 5d126a28-e17c-423e-ac1f-067404fe7aac
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: ARMOD_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2beab26-6243-4755-a444-086415723d37
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b47434bf-cc2a-4397-b103-217c3c6b6afc
          stepCounter: 5d126a28-e17c-423e-ac1f-067404fe7aac
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Attendance category ref no
        name: ATCAT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 31987dac-3d20-4035-a638-3bd5fd234123
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88a627ba-7788-431b-ab87-4c248c36a28e
          stepCounter: 5d126a28-e17c-423e-ac1f-067404fe7aac
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: attendance_category code.
        name: ATTENDANCE_CATEGORY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8d7a970-eb27-4711-8daf-ad9ac97a9c2b
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b22ce66c-4b58-488f-82a0-c45c28ab8266
          stepCounter: 5d126a28-e17c-423e-ac1f-067404fe7aac
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Y/N flag indicating whether this is a planned return visit.
        name: PLANNED_RETURN_VISIT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: adfdd7f9-db8a-4012-bd5e-53d8bf74dcd9
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb2d3f8a-baa4-414d-b096-580c6928e449
          stepCounter: 5d126a28-e17c-423e-ac1f-067404fe7aac
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Patient ref no.
        name: PATNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ccc5b70b-93b2-4083-8a6a-640bcf63f44e
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96d2e5b1-ea1c-4fe9-8574-d0c151a71851
          stepCounter: 5d126a28-e17c-423e-ac1f-067404fe7aac
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2a4df437-3fd4-444d-9f8a-48fd0fe237e7
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d73a42c7-e8c2-4916-9fc8-95cc7aa02e65
          stepCounter: 5d126a28-e17c-423e-ac1f-067404fe7aac
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Patient_Date_Of_Birth
        name: PATIENT_DATE_OF_BIRTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27f35118-9dcf-4971-8a3e-92c55c31efab
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c32bad44-7e49-446f-9683-9781998e9558
          stepCounter: 5d126a28-e17c-423e-ac1f-067404fe7aac
        config: {}
        dataType: NVARCHAR(30)
        defaultValue: ""
        description: ""
        name: DOMICILE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9953158b-3969-40a6-aaba-022c192d5ce7
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d76e17af-5b07-411b-bcc0-3dc9c9d4e3ef
          stepCounter: 5d126a28-e17c-423e-ac1f-067404fe7aac
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: patient_age_on_arrival_years
        name: PATIENT_AGE_ON_ARRIVAL_YEARS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6894a960-4b85-4ac3-8b77-c4bd4dcb2031
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70f8bba8-73e9-4653-9db5-c1b9dbff388c
          stepCounter: 5d126a28-e17c-423e-ac1f-067404fe7aac
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: patient_age_on_arrival_months
        name: PATIENT_AGE_ON_ARRIVAL_MONTHS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec05f7c5-f602-4bf4-b814-e6b5bb95b71f
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fde257c2-96d5-4ba0-8a10-ec16f53ea7f5
          stepCounter: 5d126a28-e17c-423e-ac1f-067404fe7aac
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: patient_visit_num
        name: PATIENT_VISIT_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84c63b0a-4b04-4cbd-88d1-fd5535971698
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 196f864e-6f5b-4a5a-a9db-ea785357099e
          stepCounter: 5d126a28-e17c-423e-ac1f-067404fe7aac
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: patient_visit_count
        name: PATIENT_VISIT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4626c56b-2c1b-4ac2-8b22-646265b31c6d
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 518bb9bf-ad79-41f2-8367-056832d1ec6a
          stepCounter: 5d126a28-e17c-423e-ac1f-067404fe7aac
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2040732b-30a6-4967-9684-d0565f6f4b79
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 288a5580-2120-423c-8e48-c2c3ccc1809e
          stepCounter: 5d126a28-e17c-423e-ac1f-067404fe7aac
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: USER_CREATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 550d8577-9040-4bdb-b6fd-5386704a08b0
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 138a799a-6c2a-4956-9da6-b1c660baffdb
          stepCounter: 5d126a28-e17c-423e-ac1f-067404fe7aac
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIF_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0af3e531-c057-445b-9e6a-87a64f3b4547
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49be42b0-53ce-46ac-a620-c4c821065c3f
          stepCounter: 5d126a28-e17c-423e-ac1f-067404fe7aac
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: USER_MODIF
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 899d6141-3a92-4863-9440-2bbfdacea541
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: efdf3cd9-6ef1-47db-a018-0c9e4f0da529
          stepCounter: 5d126a28-e17c-423e-ac1f-067404fe7aac
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: NURSE_SEEN_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c2ef785c-5d49-4249-80f2-fd340593073b
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b2a6178d-669b-4fcc-b9ec-bf587a1ddb7a
          stepCounter: 5d126a28-e17c-423e-ac1f-067404fe7aac
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NURSE_SEEN_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a89ce6d-3364-4983-8aee-4f640fe6733c
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a4a404e5-552b-48db-9956-fd9d7596b703
          stepCounter: 5d126a28-e17c-423e-ac1f-067404fe7aac
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: NEREF_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19db2258-194b-49e3-b2a6-c5c14d37a95c
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c6ea3db-f804-4f5c-9965-31356473a7d9
          stepCounter: 5d126a28-e17c-423e-ac1f-067404fe7aac
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DS_SHARED_ED_ATTENDANCE: 94527cff-ab41-440e-8de3-e7da6726bc81
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_SHARED_ED_ATTENDANCE
        join:
          joinCondition: |-
            FROM {{ ref('TGT','DS_SHARED_ED_ATTENDANCE') }} ds_shared_ed_Attendance
             WHERE ds_shared_ed_attendance.dss_update_time > CONVERT(datetime,'{{ parameters.pa_ED_Incremental }}',120)
        name: S_ED_ATTENDANCE_05_OLD
        noLinkRefs: []
  name: S_ED_ATTENDANCE_05_OLD
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
