fileVersion: 1
id: 2424662e-e061-4db9-9525-ad803a8a12e6
name: S_IN_PATIENT_EVENT_05_OLD
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Stage in-patient events"
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b21121f-644f-4d2b-83d2-ec223c976105
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 182159ee-bf3e-4f7c-8dc3-b90598d0bf9e
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e94e1d2-cb95-424a-bb46-398f20ce17df
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'H'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f4457d69-3428-4b5e-a4a3-b01f7362a098
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRVSP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22187ab1-b74c-4c3b-94b9-a7f532b72302
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7950cf82-1f1d-4218-a4e9-c17111c12456
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Specailty of the first inapteitn professional carer episode
        name: ADMIT_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab7da21b-0cf8-4f8a-9be6-e830b657681b
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16314ba4-d1b3-4e65-a829-6a3ad36067db
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e2ebdb9-4ed2-4e3c-89b2-ae0a65620a04
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ef39fa3-fda0-4985-9755-97af2e2547ec
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: event_service_point_code
        name: EVENT_SERVICE_POINT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0d9d7832-586e-4eaa-a4d4-717fb8f796cc
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20c862a3-aa87-422f-99bd-134a2cc4b7ae
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: hospital_code
        name: HOSPITAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b69ccb67-7336-47fa-87e3-a7f539b3ee79
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b758aafe-81e8-4bce-963f-51513ae268de
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: HOSPITAL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94eca5d8-1004-4305-b485-5776c21dd8fd
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0c96a5d-3f0e-44a0-b4f7-1b897f7a840e
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMET_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2c7f9bd-4133-427f-8d41-2a3b301a1f57
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c8478cd-3dec-4de3-bb1a-33735bc086b1
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: ADMISSION_METHOD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 31bac07b-21bc-4a59-b46a-5490981541d9
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dbdda8b6-9b87-4bc1-bf49-762a926c17c3
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ADMISSION_METHOD_NZNHI_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddbe2e02-2865-4ffc-9641-dbcf3b57c5a7
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef59eca2-5130-427b-8027-b4c9680dfd7e
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: ADMISSION_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddbe2e02-2865-4ffc-9641-dbcf3b57c5a7
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b4f7c2d-03a8-4c12-ab9d-35b10a06496b
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADSOR_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e8fb2d54-1f40-4281-b045-68470a13a512
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9bef1ce-2725-4ec3-80c3-327c6a29c697
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: READM_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eadcfb7c-a4f7-4c1e-a7df-8807f11d237c
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0f0a408-0e0c-49d3-8580-3485f1234c64
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: READMISSION_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9686351d-558c-45b5-878b-35d28c320882
                stepCounter: 9b060604-ca06-4eef-aaf1-8957f2377d3a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f50761a-da6d-4c14-817e-3715ba8ae8f1
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CLEVL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6858bf93-7d0a-4834-a200-cc2898000772
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55adc686-b422-40cb-981d-cc6baa499e38
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 70eca12f-7c56-4890-b153-0f267f048e0b
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6741f650-e2c3-443c-9dae-35701ad7452f
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Healthcare_Professional_Code
        name: EVENT_HEALTHCARE_PROFESSIONAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e393c87d-2bfd-47b3-a557-82745248467a
                stepCounter: 2b7fcd6a-6a5f-4454-9d5e-f87e946f60fa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9bed8ee5-dee8-42c9-aaf1-475d35f68078
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DISDE_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05e29e0a-36b3-4079-a023-3735b939613d
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57261e68-9171-4919-bdfa-c833231f2d9e
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADCAT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9bb68d7f-a11a-45bb-aa36-31a824ca66bf
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 172e4619-08e9-4809-bdb5-3b0c5fef0e39
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DISMT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e86363b1-a018-4e0e-b48f-a1b26d5a7b9c
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e2912f1-f4a4-4186-aca3-a3fdb4a2fd64
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EVENT_END_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 63829b4b-cb50-47c5-b8fc-df3a7548d9af
                stepCounter: 1bd29797-d2cb-4604-b84b-82897e347c39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e53eabbd-cd67-4717-a512-99fe4b343e12
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d7117a6-7eaf-4bd4-bf46-3cbcc7394133
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 23f86693-53ff-4483-878c-720fb2ef8a4b
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: DIM_PATIENT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9962a01b-5f3d-4c1a-b371-997edef38d0f
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: IFNULL(dim_patient.dim_patient_key, 0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8982296d-1df7-475d-ab3c-e5946c71a58f
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 985f0ba0-97cf-4152-a49b-7e86cb71409e
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a378de4-609f-4b88-a1ea-773308b5b535
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: DOMICILE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 13e3f44a-7125-438f-b00f-42c54a307c05
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6779f926-2f04-4b0f-895d-533820032224
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: The date the patient was born
        name: PATIENT_DATE_OF_BIRTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f201416-ac35-4870-a0c1-0836d1b9e5b7
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 571cc463-b24c-4dca-a593-71da7bd64142
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_AGE_ON_ARRIVAL_YEARS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f201416-ac35-4870-a0c1-0836d1b9e5b7
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: FLOOR(DATEDIFF(dd, dim_patient.patient_date_of_birth, CASE WHEN IFNULL(dim_patient.patient_date_of_death, s_in_patient_event_01.admit_date) < s_in_patient_event_01.admit_date THEN IFNULL(dim_patient.patient_date_of_death, s_in_patient_event_01.admit_date) ELSE s_in_patient_event_01.admit_date END) / 365.25)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8bcaf5b4-fd1e-4abc-9b79-2993e3f169b9
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_AGE_ON_ARRIVAL_MONTHS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f201416-ac35-4870-a0c1-0836d1b9e5b7
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: FLOOR(DATEDIFF(mm, dim_patient.patient_date_of_birth, CASE WHEN IFNULL(dim_patient.patient_date_of_death, s_in_patient_event_01.admit_date) < s_in_patient_event_01.admit_date THEN IFNULL(dim_patient.patient_date_of_death, s_in_patient_event_01.admit_date) ELSE s_in_patient_event_01.admit_date END) % 12)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c52276af-024d-42bd-a47c-77ab13d17882
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 98e936be-d525-41ab-9adb-589089b6c168
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 321096b0-b5df-4d7c-9ba4-f7898c8c53bb
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMIT_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d165fd3-991a-4c51-857a-7cbee8826792
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd46fd69-5d28-437a-bc0d-a1048e579d3e
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCH_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7787e3c3-fc64-42d2-9a2b-9bc505cc3c21
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f41e0a52-1464-4126-972b-0c4fe46a0e33
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCH_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dad5c612-b8b1-48df-a2ae-12ba0fbf4136
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3793dd64-64f9-4a38-a147-97bafbc88774
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: INT
        defaultValue: ""
        description: event_length_of_stay
        name: EVENT_LENGTH_OF_STAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7787e3c3-fc64-42d2-9a2b-9bc505cc3c21
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: DATEDIFF(dd, s_in_patient_event_01.admit_date, s_in_patient_event_01.disch_date) - IFNULL(s_in_patient_leave_05.event_leave_total_duration, 0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c7fe60c-da3e-40e4-8902-5a5cfffaa9de
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFRL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 040a4bab-7c05-4373-839f-b1532c59f3c0
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3e81c4c-49df-489c-aa8e-cf4d2ca37c52
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 040a4bab-7c05-4373-839f-b1532c59f3c0
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: "'R' + CONVERT(varchar, s_in_patient_event_01.refrl_refno)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5103eac-95b4-4a85-8d57-6bba63359baf
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: AEATT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d54a472-2674-41aa-89d6-51bd9da04e71
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1daf5440-7619-41b0-a2ef-c115c5103099
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ATTENDANCE_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d54a472-2674-41aa-89d6-51bd9da04e71
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: "'A' + CONVERT(varchar, s_in_patient_event_01.aeatt_refno)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dfd39ec7-aff6-42bc-962b-fe833cddab6b
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: FIRST_REGULAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0a932e43-08a8-4b2d-8892-9848799ff040
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 770b3e02-a550-499b-b165-2c7831d6b130
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: INMGT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 099d55a7-196a-4c91-a93c-181fe9ef5dba
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 938125d4-273f-411f-aa5f-d1a22d60b0c0
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: EVENT_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bef5ae2c-aedb-4e25-babf-3fd1e9a8e6c9
                stepCounter: 3fdf4180-c40e-4f94-9cbb-852501d299b3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee34a3f9-7b61-42da-92b1-d186e96a4bb5
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: EXPDS_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 25a0caf8-4787-4aee-bd57-69ca0fd12608
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: accba5a6-0175-46db-909e-42287b42e091
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: DISABLED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 173a74bb-6d31-47bc-be7c-a23f11564a69
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ca05ce4-72b5-4ff2-9c6d-0377c0c31d4d
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: CONFIDENTIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a8a44177-7076-4626-bf7d-9ecf944772c9
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba664155-92a9-4e34-837a-344c12206f80
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: IDENTIFIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52875546-e9a8-4aaa-9c62-986e0c12cd5e
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d76cce9f-22bb-483a-9251-0a8e5942197f
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WLIST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9470d659-c8a2-4474-bfd8-110ea8e63eb0
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 820ec373-681e-49e8-9eaa-1e5b9c885b7b
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: FAST_TRACK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c6beed65-0d9d-458d-b325-815bdc0e3e90
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45a00761-7ee3-4dab-8f13-8a082abea7c0
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: AGEBD_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eb8d86c8-631b-45b3-9798-9309be76f831
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 119195d1-a07f-4cf5-988b-4e3a7665943b
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: NO_FUNDS_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3f0ec995-005e-4851-8778-174e4cf58541
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a38326d-e570-4beb-80ca-6b02f6aebc41
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: PRVSN_START_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2a5f75a-69f1-4695-ae4f-e63b2c3e8f62
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 933598db-8410-41ce-9076-c3706759823e
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: PRVSN_END_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eed8db8c-1fe6-42b6-bbc8-a2fa6d737308
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 93e2df16-53ac-4533-bf14-3e0abdc3db5d
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CNTCT_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a754a3cc-80b0-472d-aa27-ad03ee4f04d7
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b5cad0c-d56b-47a0-82ce-848c5ab564a9
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MED_DISCH_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cec7153a-c5b3-4601-9ac1-bfc81e0895f7
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ce6aca0-7418-4882-808d-c18dba7f7411
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MED_DISCH_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a54f2cc-6358-4aad-bf53-53df3ae2ffd4
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a8112cf-8a10-42ab-a276-d2f5ab21974f
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PMETD_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 390ad4b8-f847-41fc-a9c1-351b8e0d16c2
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 293c6e22-1283-4a28-b1e1-39a7e181fb93
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DSINF_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d43eaf90-0817-429e-a4ce-56805f843ed3
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1bdcee7e-16a6-44be-909e-d485e8fca434
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: IDPAP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 551db9bf-0e4b-470b-b165-eff32aad47c0
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2079e8fc-7a3a-4b43-a0f1-fe967c70bda7
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: CONSENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f2f37668-a529-4db8-9b35-88beca0aa919
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 618cf132-f155-4816-9355-e2ddc648d698
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: GP_ADVISE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a26aaff4-3467-413a-9d66-a73c651d6498
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e28f7792-5ee6-406b-831c-661c23f88d20
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: IRADM_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16d937bf-05b5-4c05-a66d-49ad162e0a31
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b71c259d-b880-4c63-add0-cf31052fb30f
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: MECH_VENT_HRS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9fc18ea7-cfa5-4187-8e58-415231fcc470
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d74fa4c6-dd2f-4b18-83e2-bae2add94aad
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: AMBULANCE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 30a28d69-9457-4b17-a096-bb9133844ce9
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 458b0e82-1fb9-4695-af03-b5ac31f7e341
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRIOR_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7dfb0e2-06ed-45f2-ac40-a408c9947af5
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53b27079-50af-4e45-ac60-17c26fcc950c
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: RELATED_ADMISSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c408fd3-553b-4d4b-b04a-89b788cadeab
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb06fdef-7afa-4508-ba1b-031aebfcfcc9
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: READM_REHAB_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d9f92648-4d0d-4c91-9c08-10d05bfd4f7c
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 468ef338-88af-4e09-b7af-65ca6b058619
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SRTPC_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7bb7f2c-a3dd-4668-b3ff-9877d294fc17
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25612be7-d1e9-4eab-bb96-57fbc5cf2c33
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACAST_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 834ed93b-3708-4b9c-a7ec-5f7b8098d19b
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c1603ab-eecd-42da-84d8-8d6566a61ab5
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ACC_EXPIRY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b8d8bdbc-42f1-4392-a7ab-56280bef077e
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72ab19f7-e890-428e-9808-1d9065b58f77
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REHAB_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3f9b4f3f-0001-4042-8173-a9122e87c544
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 553192fa-790a-453c-91b8-760be989a666
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CODING_ADMIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dff44a25-f545-4d6d-8cfa-28c7f473d149
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5bc6794-ada0-42f1-b4ab-025db0a7540b
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CODING_DISCH_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e87a2927-9449-4214-8b7c-af667b9d7163
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a590d771-be3a-4224-9d29-faacf4254d58
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: DRG_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 45361dd4-e574-4460-9454-575ac3d19cbe
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fab98af6-a52f-4171-989c-1ba329a8337c
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: NMDS_EVENT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ef280f9-2347-4dc6-a4be-429ec9576056
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5185d221-5f18-4a53-ba0e-01b84a14cb23
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: CODED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 15da2239-4e8f-4def-81f3-1f623e48c2df
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c324d8a-9134-45af-9b2f-477ae2ecb450
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: WLIST_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9ef01f2-c010-42c9-acff-46c48fd22ef7
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 024f61e6-ebd8-4d20-abff-30fb8b264f66
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: WAITLIST_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9ef01f2-c010-42c9-acff-46c48fd22ef7
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: "'W' + CONVERT(varchar, s_in_patient_event_01.wlist_refno)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c38107ec-ced0-474a-b067-11277e66b3a1
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: Carer Episode Outcome
        name: CEOCM_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0605adfa-bc92-48ee-a3d7-08d06a54a951
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 155f8852-694b-4d20-9beb-0dde4b394056
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: MDC_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b471764d-9a5f-4da9-a502-91057cf4e146
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42e2dd0e-4c62-4ea9-acf9-2e5b61a41e86
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Specialty of the last inpatient stay episode. Dsicharge Specialty
        name: SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a6880864-9d23-445a-b248-2e2c4ac2141b
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d12dc2f0-4d4d-4117-a228-21e26fbac15a
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab525339-3f36-4625-ba0c-d207897f094b
                stepCounter: 4182a75e-d07b-4637-97fa-4c01e2878360
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff640f3d-767f-40ac-a73e-d984fb33fa9f
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DISCHARGE_HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dadf0902-63f9-41c4-9cd3-ffe5c45be9ea
                stepCounter: b4b3d899-7318-4c9b-8bc6-1c7c93dcacf2
            transform: IFNULL(s_in_patient_event_02.discharge_health_specialty_code, dim_specialty.health_specialty_code)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01a5236f-d812-499f-8bc0-9580cfa0f69c
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(9)
        defaultValue: ""
        description: 'Flags used to join IP events to s_inpatient_purchase_unit_RC. Updated by custom proc.  '
        name: PURCHASE_UNIT_FLAGS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00513809-5d97-4eba-b834-da166d4b4991
                stepCounter: 0ebc37a1-c3d2-4bfc-877b-4f11d3b17d44
            transform: IFNULL(s_in_patient_event_03.bronchoscopy_flag, 'N') + IFNULL(s_in_patient_event_03.colonoscopy_flag, 'N') + IFNULL(s_in_patient_event_03.colposcopy_flag, 'N') + IFNULL(s_in_patient_event_03.cystoscopy_flag, 'N') + IFNULL(s_in_patient_event_03.gastroscopy_flag, 'N') + IFNULL(s_in_patient_event_03.hysteroscopy_flag, 'N') + IFNULL(s_in_patient_event_01.package_of_care_flag, 'N') + IFNULL(s_in_patient_event_01.SCBU_flag, 'N') + IFNULL(s_in_patient_event_03.skin_lesion_flag, 'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2eaa4e2-d2db-45dd-8acf-0643b8d8019f
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: flags a list of theatre of procedures to indicate a bronchoscopy
        name: BRONCHOSCOPY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4c5b5a1-9ecf-4bb0-bce0-bb3ae215a94a
                stepCounter: 5860ff0d-39d6-48ed-879f-ac8ed660bbea
            transform: IFNULL(s_in_patient_event_03.bronchoscopy_flag,'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8d9a13a-1a35-4a57-9574-822c13676393
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: COLONOSCOPY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d029a9b6-9dd5-46ec-91e4-4f9c8d88fdf4
                stepCounter: 5860ff0d-39d6-48ed-879f-ac8ed660bbea
            transform: IFNULL(s_in_patient_event_03.colonoscopy_flag,'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b19ca92-97de-4b9b-a776-91e89410f1b9
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: flags a list of theatre of procedures to indicate a colposcopy
        name: COLPOSCOPY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 57cd7701-269f-4c1b-b6dc-b31473721b28
                stepCounter: 5860ff0d-39d6-48ed-879f-ac8ed660bbea
            transform: IFNULL(s_in_patient_event_03.colposcopy_Flag,'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 018bdc75-427e-421e-8168-2d3f3d84b018
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: CYSTOSCOPY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f95291e-3118-471b-a6c3-38ea7afb5282
                stepCounter: 5860ff0d-39d6-48ed-879f-ac8ed660bbea
            transform: IFNULL(s_in_patient_event_03.cystoscopy_Flag,'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7da9fa4d-f21c-4c53-8ad4-324fc81b3d64
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: GASTROSCOPY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2ccf116-e54f-4fbf-9089-00d7be428388
                stepCounter: 5860ff0d-39d6-48ed-879f-ac8ed660bbea
            transform: IFNULL(s_in_patient_event_03.gastroscopy_flag,'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 120fe7db-ba5f-4532-8d91-8a75973d307b
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: flags a list of theatre of procedures to indicate a hysteroscopy
        name: HYSTEROSCOPY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: df2947be-cfa5-41f8-8d49-5a4c81d63372
                stepCounter: 5860ff0d-39d6-48ed-879f-ac8ed660bbea
            transform: IFNULL(s_in_patient_event_03.hysteroscopy_flag,'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04d2baf6-c059-4616-b8de-15b54e8386e3
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: flags a list of theatre of procedures to indicate a uncoded skin lesion
        name: SKIN_LESION_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6b163d14-a216-46d7-a96b-e9ed262d0c80
                stepCounter: 5860ff0d-39d6-48ed-879f-ac8ed660bbea
            transform: IFNULL(s_in_patient_event_03.skin_lesion_flag,'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4179484d-a056-4bec-b7a5-5f12628b3efa
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Sets up the SCBU flag based on DRG. Flag is adjusted depending on whether a patient passes through SCBU too.
        name: SCBU_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 49855d8c-f672-4e20-9434-ebcc3bffa1b6
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14ecf206-bf7f-4208-9e75-802308f54589
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Set to 1 if one of the ward stays for the event is SCBU. This column not currently used. Only here for debuggint purposes.
        name: SCBU_WARD_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a068cd5b-23d9-43ca-9289-76ac902ba0f1
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bfba0c23-9e7f-41df-995e-3a1c4017d0f5
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa6b51ea-fce9-4f89-8f4c-37d6d0da5627
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: IFNULL(NULLIF(s_in_patient_event_01.purchase_unit_code, 'EXCLU'), s_in_patient_event_01.excluded_purchase_unit_code)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6fcc45d8-e0af-44e8-ad11-069298694772
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: 'This update of purchase_unit_code previously done in s_in_patient_event_10. Now done here so that non IP objects can use the 05 table for required data.  '
        name: PURCHASE_UNIT_CODE_FIXED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 86c9bbc2-e920-4c06-9991-8efe01c90ae6
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d193e9b-065d-463e-b4f4-ca0755d19976
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: EXCLUDED_PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0331ddc5-5e73-4505-8ba1-dfb763151992
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88688d13-7186-44c5-9ca8-97ba4d03a332
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: WIES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a9d66ed-7176-418d-8601-2b836c6b80a0
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f47958e-c9fe-4fcc-9b22-1d65b29e1508
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LAST_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9575db12-31f5-447b-8ad1-f5021db268e5
                stepCounter: b4b3d899-7318-4c9b-8bc6-1c7c93dcacf2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b4ecaa4-708f-4cff-8288-d9f4e41427c5
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: EVENT_STAYS_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fedfcd92-58c5-4bd2-82cd-41c5840ad774
                stepCounter: b4b3d899-7318-4c9b-8bc6-1c7c93dcacf2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7cc59c9-2ddf-4820-94c2-02385cbe4a5e
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: EVENT_STAYS_TOTAL_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50a36581-95b1-4fb1-84f9-c0f53ad9b1c6
                stepCounter: b4b3d899-7318-4c9b-8bc6-1c7c93dcacf2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0448236e-b4fc-4099-aab7-831e5e94a669
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_VISIT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d7117a6-7eaf-4bd4-bf46-3cbcc7394133
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ROW_NUMBER() OVER (PARTITION BY s_in_patient_event_01.patnt_refno ORDER BY s_in_patient_event_01.admit_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39cacc7d-18ac-4ae1-8354-2acb9bc0254d
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_VISIT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d7117a6-7eaf-4bd4-bf46-3cbcc7394133
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: COUNT(1) OVER (PARTITION BY s_in_patient_event_01.patnt_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d057dd73-34ea-4f61-a448-11b7cd608e9b
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 819098d9-0911-46eb-b367-45fede5d4e9c
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f8aa25a-5a77-43c1-a124-9f190418758a
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8634f377-c6cb-445e-aee1-cb497d5720db
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb7d47df-fb56-4eb4-b83e-b41abe94e36d
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIFY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: df197b7e-307f-4027-b82b-b50f825b00a1
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 230a0f56-6204-4ba6-9dbe-d9ddea680a22
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MODIFY_USER_LOGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d9d849a3-e3e0-4aed-9977-af7828c93f82
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c34419e-9ec9-4d4f-8855-069146459e91
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CODEDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18368986-5ffc-4a99-9355-cf86fcbae7e6
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 582dc84b-452d-462a-bb28-7a6fb376a287
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91431e27-8386-496a-8595-71f59e171d71
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9717c06b-3269-4aa8-969a-d6bfdcac8795
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CCL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b07fff47-69cf-46f1-9bf8-48c7e9604c67
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6aa3e77-f879-45ec-8f7b-5801a3fc0fbe
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: INTO_THEATRE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94f1bef3-23d3-4719-9909-9fe059faed43
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: afadc7d2-066f-406f-b4a4-e819313c7d70
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: INTO_THEATRE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94f1bef3-23d3-4719-9909-9fe059faed43
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: IIF(ds_shared_schedule.into_theatre_date IS NULL, 'N', 'Y')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d6f32f9-05b6-488e-8074-60da033bf7e1
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: surgical_theatre_group
        name: SURGICAL_THEATRE_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: af8e01d9-4a42-4ced-a633-800324fcc46f
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd1407b5-077e-4790-9b42-27170ccc28ea
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: PACKAGE_OF_CARE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ed03acc-5793-4fb3-a2dd-3f3ac8737114
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2a3728b-d61c-4f95-b25c-ea65d522666d
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: INT
        defaultValue: ""
        description: Updated by custom procedure.
        name: PUC_MAP_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a992596-6399-44c2-9194-32ae1dc11e46
                stepCounter: 01af7fb6-3395-4ab4-ad76-3ac109622eec
            transform: NULL -- Updated by custom procedure
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98f5d47a-51b5-441b-8ec0-738842956cd1
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Updated by custom procedure.
        name: DEFAULT_PURCHASE_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5887f844-89b7-4f56-860b-ab41d97e71d4
                stepCounter: 01af7fb6-3395-4ab4-ad76-3ac109622eec
            transform: NULL -- Updated by custom procedure
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1602ce0d-a8b4-4c8e-aa52-a5c8bcc3bc0e
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Updated by custom procedure.
        name: RESPONSIBILITY_CENTRE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fcae700b-87c1-4c12-abe3-607356a73660
                stepCounter: 01af7fb6-3395-4ab4-ad76-3ac109622eec
            transform: NULL -- Updated by custom procedure
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f94a69d-1921-4467-9e84-3c7f5b275b05
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Flag indicating event can be the initial one in an OS3 sequence.
        name: OS3_ADMIT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 248d93bc-2b05-48ab-ae0a-b744d9c04d39
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e57c99fd-5dda-484e-bef1-2568b36162ce
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Flag indicating event can be the final one in an OS3 sequence.
        name: OS3_DISCHARGE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 915406d9-0f38-476a-86d4-3034355de560
                stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b828c0db-dce9-4686-ace8-661e9099d491
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Event identifier for the MoH OS3 ALOS measure that connects across events.  The event use is the last event in the sequence.
        name: OS3_MASTER_ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IIF(s_in_patient_event_01.OS3_discharge_flag = 1, s_in_patient_event_01.event_encounter_id, NULL)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d225da8e-5901-4fca-8b9f-09688cee2d00
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: INT
        defaultValue: ""
        description: OS3 Event sequence 1= the first event in the series
        name: OS3_SEQUENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              -- Will be updated by custom proc if more than 1 event for the master encounter
              IIF(s_in_patient_event_01.OS3_discharge_flag = 1, 1, NULL)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 054ce04e-cd25-463b-ae95-f26c2f5b7a05
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: 'Event LOS in 30 minute units for the MoH OS3 ALOS measure that connects across events.  '
        name: OS3_LENGTH_OF_STAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: NULL -- Updated by custom procedure
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b07c1d62-ace8-4f6c-a615-71ff823951ce
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DSS_DATA_QUALITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1606d46a-4dc9-4025-bab9-f7d9d5e96c9a
          stepCounter: 2424662e-e061-4db9-9525-ad803a8a12e6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_IN_PATIENT_EVENT_01
        join:
          joinCondition: |-
            FROM s_in_patient_event_01
              LEFT OUTER JOIN s_in_patient_event_02
                ON s_in_patient_event_01.prvsp_refno = s_in_patient_event_02.prvsp_refno
              LEFT OUTER JOIN s_in_patient_event_03
                ON s_in_patient_event_01.prvsp_refno = s_in_patient_event_03.prvsp_refno
              LEFT OUTER JOIN s_in_patient_leave_05
                ON s_in_patient_event_01.prvsp_refno = s_in_patient_leave_05.prvsp_refno
               AND s_in_patient_leave_05.event_leave_seq_num = 1
              LEFT OUTER JOIN dim.dim_admission_method
                ON s_in_patient_event_01.admet_refno = dim_admission_method.admission_method_reference_no
               AND dim_admission_method.dss_current_flag = 'Y'
              LEFT OUTER JOIN dim.dim_discharge_method
                ON s_in_patient_event_01.dismt_refno = dim_discharge_method.discharge_method_reference_no
              LEFT OUTER JOIN dim.dim_event_type
                ON s_in_patient_event_01.inmgt_refno = dim_event_type.intended_management_type_reference_no
              LEFT OUTER JOIN dim.dim_healthcare_professional
                ON s_in_patient_event_01.proca_refno = dim_healthcare_professional.healthcare_professional_reference_no
               AND dim_healthcare_professional.dss_current_flag = 'Y'
              LEFT OUTER JOIN dim.dim_patient
                ON s_in_patient_event_01.patnt_refno = dim_patient.patient_reference_no
              LEFT OUTER JOIN dim.dim_readmission_type
                ON s_in_patient_event_01.readm_refno = dim_readmission_type.readmission_type_reference_no
               AND dim_readmission_type.dss_current_flag = 'Y'
              LEFT OUTER JOIN dim.dim_specialty
                ON s_in_patient_event_01.spect_refno = dim_specialty.specialty_reference_no
               AND dim_specialty.dss_current_flag = 'Y'
              LEFT OUTER JOIN (SELECT patient_reference_no,
                   MIN(into_theatre_date) into_theatre_date
              FROM ds_shared_schedule
             WHERE schedule_theatre_status_code = 'A' -- 'Actual'    GROUP BY patient_reference_no) ds_shared_schedule  ON  ds_shared_schedule.patient_reference_no = s_in_patient_event_01.patnt_refno    AND ds_shared_schedule.into_theatre_date BETWEEN s_in_patient_event_01.admit_date AND IFNULL(s_in_patient_event_01.disch_date, '2999-12-31')    WHERE s_in_patient_event_01.event_seq_num = 1 -- Check for duplicated event_encounter_id values
        name: S_IN_PATIENT_EVENT_05_OLD
        noLinkRefs: []
  name: S_IN_PATIENT_EVENT_05_OLD
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
