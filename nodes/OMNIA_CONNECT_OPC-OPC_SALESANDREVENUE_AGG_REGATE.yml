fileVersion: 1
id: bee55b7e-4ff2-4d2b-a70a-519650d56005
name: OPC_SALESANDREVENUE_AGG_REGATE
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: OMNIA_CONNECT_OPC
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04fa94e1-1c91-41c4-8b84-b02e5c8378cd
          stepCounter: bee55b7e-4ff2-4d2b-a70a-519650d56005
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 447650bf-e89a-4bd0-8560-214d2f569d20
                stepCounter: fff65975-c873-46a5-8700-5c6a9a74f8d8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d4926ec-29c5-43f5-99f1-0a88d2930c5c
          stepCounter: bee55b7e-4ff2-4d2b-a70a-519650d56005
        config: {}
        dataType: INT
        defaultValue: ""
        description: UNIQUE IDENTIFIER FOR AN ACCOUNT. COMMONLY CALLED THE "FORCE ID"
        isBusinessKey: true
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ffc7650-10f2-4c8c-bb1b-6b3221e259b5
                stepCounter: fff65975-c873-46a5-8700-5c6a9a74f8d8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a9c04f1-7ba6-4ad2-b629-8026215d9f12
          stepCounter: bee55b7e-4ff2-4d2b-a70a-519650d56005
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ba4b9074-573c-48da-a22a-0d27366ea482
                stepCounter: fff65975-c873-46a5-8700-5c6a9a74f8d8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cfb536bc-5a3c-4548-b824-c76330e56be3
          stepCounter: bee55b7e-4ff2-4d2b-a70a-519650d56005
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: TRANSACTIONDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77d4fca9-e493-493b-b043-cb93ff1e0928
                stepCounter: fff65975-c873-46a5-8700-5c6a9a74f8d8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c98f49a5-30a6-4506-bd5c-b3c42bc67640
          stepCounter: bee55b7e-4ff2-4d2b-a70a-519650d56005
        config: {}
        dataType: INT
        defaultValue: ""
        description: TRANSACTION YEAR
        name: TRANSACTION_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77d4fca9-e493-493b-b043-cb93ff1e0928
                stepCounter: fff65975-c873-46a5-8700-5c6a9a74f8d8
            transform: YEAR(OPC_SALESANDREVENUE.TRANSACTIONDATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 445fec4e-e0a6-45f8-b9b2-4c31709a7508
          stepCounter: bee55b7e-4ff2-4d2b-a70a-519650d56005
        config: {}
        dataType: INT
        defaultValue: ""
        description: TRANSACTION MONTH
        name: TRANSACTION_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77d4fca9-e493-493b-b043-cb93ff1e0928
                stepCounter: fff65975-c873-46a5-8700-5c6a9a74f8d8
            transform: MONTH(OPC_SALESANDREVENUE.TRANSACTIONDATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50e74847-270c-4591-b850-6f52035e984f
          stepCounter: bee55b7e-4ff2-4d2b-a70a-519650d56005
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ""
        name: SALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ae63d3fb-1961-48ea-9072-bfa5dc86f327
                stepCounter: fff65975-c873-46a5-8700-5c6a9a74f8d8
            transform: SUM(OPC_SALESANDREVENUE.SALES)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f11e0c59-4341-424a-9453-e31ca3ba2d38
          stepCounter: bee55b7e-4ff2-4d2b-a70a-519650d56005
        config: {}
        dataType: INT
        defaultValue: ""
        description: SUPPLIER COUNT
        name: SUPPLIER_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ba4b9074-573c-48da-a22a-0d27366ea482
                stepCounter: fff65975-c873-46a5-8700-5c6a9a74f8d8
            transform: COUNT(OPC_SALESANDREVENUE.SUPPLIERID)
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          OPC_SALESANDREVENUE: fff65975-c873-46a5-8700-5c6a9a74f8d8
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: OMNIA_CONNECT_OPC
            nodeName: OPC_SALESANDREVENUE
        join:
          joinCondition: |-
            FROM {{ ref('OMNIA_CONNECT_OPC','OPC_SALESANDREVENUE') }} OPC_SALESANDREVENUE
             GROUP BY OPC_SALESANDREVENUE.LEVEL1FORCEID,
                      OPC_SALESANDREVENUE.FORCEID,
                      OPC_SALESANDREVENUE.SUPPLIERID,
                      OPC_SALESANDREVENUE.TRANSACTIONDATE
        name: OPC_SALESANDREVENUE_AGGREGATE
        noLinkRefs: []
  name: OPC_SALESANDREVENUE_AGG_REGATE
  overrideSQL: false
  schema: ""
  sqlType: Agreggate
  type: sql
  version: 1
type: Node
