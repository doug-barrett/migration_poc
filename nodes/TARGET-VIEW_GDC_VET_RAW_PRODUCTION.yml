fileVersion: 1
id: e11dddcc-e54e-4646-bb65-5f7ef02db6d6
name: VIEW_GDC_VET_RAW_PRODUCTION
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5780af3e-ab5a-4f18-946e-96cf17ede4cc
          stepCounter: e11dddcc-e54e-4646-bb65-5f7ef02db6d6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 896bed41-54ab-497d-9f52-97cab1addbb2
                stepCounter: 5fa5d712-cd84-49a2-a874-44ec8128404f
            transform: TARGET.UWI
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5bb8d513-50ef-457e-8099-efe44da1440e
          stepCounter: e11dddcc-e54e-4646-bb65-5f7ef02db6d6
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: ACTVY_PER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2588e04-cba6-4bc0-8b88-068ca6c6de91
                stepCounter: 5fa5d712-cd84-49a2-a874-44ec8128404f
            transform: LAST_DAY(TARGET.ACTIVITY_PERIOD)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a79a1df-6851-4a9a-ada5-38f95875ad3e
          stepCounter: e11dddcc-e54e-4646-bb65-5f7ef02db6d6
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ACTVY_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2588e04-cba6-4bc0-8b88-068ca6c6de91
                stepCounter: 5fa5d712-cd84-49a2-a874-44ec8128404f
            transform: |-
              CASE WHEN TARGET.ACTIVITY_PERIOD IS NULL THEN - 1
                          ELSE CAST(TO_CHAR(LAST_DAY(TARGET.ACTIVITY_PERIOD), 'YYYYMMDD') AS INT)
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16187752-abde-4839-8ae7-273e1f5d9901
          stepCounter: e11dddcc-e54e-4646-bb65-5f7ef02db6d6
        config: {}
        dataType: NUMBER(26,4)
        defaultValue: ""
        description: ""
        name: WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 37328110-4626-44d7-a0f9-6238cc7eaa32
                stepCounter: 5fa5d712-cd84-49a2-a874-44ec8128404f
            transform: TARGET.WATER
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ad981ad-2695-4e45-8551-386dc55e48d2
          stepCounter: e11dddcc-e54e-4646-bb65-5f7ef02db6d6
        config: {}
        dataType: NUMBER(26,4)
        defaultValue: ""
        description: ""
        name: WATER_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 37328110-4626-44d7-a0f9-6238cc7eaa32
                stepCounter: 5fa5d712-cd84-49a2-a874-44ec8128404f
            transform: TARGET.WATER * NVL(TARGET.LIQUID_BOE_THERMAL, 1)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48d6743a-b499-46c9-b037-eca1673817ea
          stepCounter: e11dddcc-e54e-4646-bb65-5f7ef02db6d6
        config: {}
        dataType: NUMBER(26,4)
        defaultValue: ""
        description: ""
        name: WATER_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 37328110-4626-44d7-a0f9-6238cc7eaa32
                stepCounter: 5fa5d712-cd84-49a2-a874-44ec8128404f
            transform: TARGET.WATER * NVL(TARGET.LIQUID_BOE_THERMAL, 1)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27889d53-a911-4ad7-a47e-719e6c9492ec
          stepCounter: e11dddcc-e54e-4646-bb65-5f7ef02db6d6
        config: {}
        dataType: NUMBER(26,4)
        defaultValue: ""
        description: ""
        name: GAS_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f9747e02-510e-4b9c-bc6f-473a8fcc4871
                stepCounter: 5fa5d712-cd84-49a2-a874-44ec8128404f
            transform: TARGET.GAS*NVL(TARGET.GAS_SI_TO_IMP_CONV_FACTOR,1)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4442d571-7439-428e-baca-209a2f145c90
          stepCounter: e11dddcc-e54e-4646-bb65-5f7ef02db6d6
        config: {}
        dataType: NUMBER(26,4)
        defaultValue: ""
        description: ""
        name: GAS_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f9747e02-510e-4b9c-bc6f-473a8fcc4871
                stepCounter: 5fa5d712-cd84-49a2-a874-44ec8128404f
            transform: TARGET.GAS*NVL(TARGET.GAS_BOE_THERMAL,1)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e969c61-d91a-4114-b0ca-072f058eb5f8
          stepCounter: e11dddcc-e54e-4646-bb65-5f7ef02db6d6
        config: {}
        dataType: NUMBER(26,4)
        defaultValue: ""
        description: ""
        name: GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f9747e02-510e-4b9c-bc6f-473a8fcc4871
                stepCounter: 5fa5d712-cd84-49a2-a874-44ec8128404f
            transform: TARGET.GAS
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4190af0d-1dc4-4d19-ac6b-a0cdef79d111
          stepCounter: e11dddcc-e54e-4646-bb65-5f7ef02db6d6
        config: {}
        dataType: NUMBER(26,4)
        defaultValue: ""
        description: ""
        name: OIL_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64cdcff4-f98e-4a8d-96f5-d880a4477e12
                stepCounter: 5fa5d712-cd84-49a2-a874-44ec8128404f
            transform: TARGET.OIL
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3cbe864a-b2e4-4077-9321-71cc1d8ceb7d
          stepCounter: e11dddcc-e54e-4646-bb65-5f7ef02db6d6
        config: {}
        dataType: NUMBER(26,4)
        defaultValue: ""
        description: ""
        name: OIL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64cdcff4-f98e-4a8d-96f5-d880a4477e12
                stepCounter: 5fa5d712-cd84-49a2-a874-44ec8128404f
            transform: TARGET.OIL*NVL(TARGET.LIQUID_BOE_THERMAL,1)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64672cab-0945-4e62-830a-585d313ae52e
          stepCounter: e11dddcc-e54e-4646-bb65-5f7ef02db6d6
        config: {}
        dataType: NUMBER(26,4)
        defaultValue: ""
        description: ""
        name: OIL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64cdcff4-f98e-4a8d-96f5-d880a4477e12
                stepCounter: 5fa5d712-cd84-49a2-a874-44ec8128404f
            transform: TARGET.OIL*NVL(TARGET.LIQUID_BOE_THERMAL,1)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82581d14-c294-4dbd-b203-ba86f750673d
          stepCounter: e11dddcc-e54e-4646-bb65-5f7ef02db6d6
        config: {}
        dataType: NUMBER(26,4)
        defaultValue: ""
        description: ""
        name: CONDENSATE_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 93454fbe-3088-43ac-83ea-ceed997d90d5
                stepCounter: 5fa5d712-cd84-49a2-a874-44ec8128404f
            transform: TARGET.COND*NVL(TARGET.LIQUID_BOE_THERMAL,1)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dac6c5ae-314a-4f7c-a411-78f9c7e69649
          stepCounter: e11dddcc-e54e-4646-bb65-5f7ef02db6d6
        config: {}
        dataType: NUMBER(26,4)
        defaultValue: ""
        description: ""
        name: CONDENSATE_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 93454fbe-3088-43ac-83ea-ceed997d90d5
                stepCounter: 5fa5d712-cd84-49a2-a874-44ec8128404f
            transform: TARGET.COND*NVL(TARGET.LIQUID_BOE_THERMAL,1)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7de9a4ab-1d70-49e5-9034-a42199996a8d
          stepCounter: e11dddcc-e54e-4646-bb65-5f7ef02db6d6
        config: {}
        dataType: NUMBER(26,4)
        defaultValue: ""
        description: ""
        name: CONDENSATE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 93454fbe-3088-43ac-83ea-ceed997d90d5
                stepCounter: 5fa5d712-cd84-49a2-a874-44ec8128404f
            transform: TARGET.COND
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f1017705-928c-4fb8-959a-4900313bf100
          stepCounter: e11dddcc-e54e-4646-bb65-5f7ef02db6d6
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 937ab178-f703-463d-98a9-cef60d884893
                stepCounter: f5d6146b-7042-4b8a-b29d-05b61de7beb0
            transform: TARGET.CC_NUM
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb6e3dda-71ab-4d3b-9b45-5ce7632dee6f
          stepCounter: e11dddcc-e54e-4646-bb65-5f7ef02db6d6
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: CC_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09586ad6-0d99-4a90-8628-35fcdab73819
                stepCounter: f5d6146b-7042-4b8a-b29d-05b61de7beb0
            transform: TARGET.CC_NAME
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55c8c96f-1b2d-4df3-a011-3c49f76bfc63
          stepCounter: e11dddcc-e54e-4646-bb65-5f7ef02db6d6
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: CC_NUM_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64e973d9-d200-4779-bdc1-3e1aa1fc1bf8
                stepCounter: f5d6146b-7042-4b8a-b29d-05b61de7beb0
            transform: TARGET.CC_NUM_NAME
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53e7ceb5-63c1-4986-bb76-521314cf9059
          stepCounter: e11dddcc-e54e-4646-bb65-5f7ef02db6d6
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: Formatted UWI of the Cost Centre
        name: FORMATTED_UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 645d3870-adad-4e80-8b65-fd19ab1c038f
                stepCounter: f5d6146b-7042-4b8a-b29d-05b61de7beb0
            transform: TARGET.FORMATTED_UWI
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6edfda6-261e-4859-b14b-9e1b83b2d3bc
          stepCounter: e11dddcc-e54e-4646-bb65-5f7ef02db6d6
        config: {}
        dataType: NUMBER(14,11)
        defaultValue: ""
        description: The Land Percent.
        name: WORKING_INTEREST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0bdaa486-d12f-4308-9669-a738eaea7810
                stepCounter: f5d6146b-7042-4b8a-b29d-05b61de7beb0
            transform: TARGET.WORKING_INTEREST
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c54ae55-a8ba-4cf8-8e9b-98f508942b94
          stepCounter: e11dddcc-e54e-4646-bb65-5f7ef02db6d6
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: The name or description of the entity.
        name: AREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d0e5ef3f-c12c-45b2-a249-c410978a8ae3
                stepCounter: f5d6146b-7042-4b8a-b29d-05b61de7beb0
            transform: TARGET.AREA_NAME
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef210930-e32a-45a7-a9f5-747c9278fa34
          stepCounter: e11dddcc-e54e-4646-bb65-5f7ef02db6d6
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: The name or description of the entity.
        name: COREAREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00e96ad4-791c-4356-8040-2cf1964ebf2f
                stepCounter: f5d6146b-7042-4b8a-b29d-05b61de7beb0
            transform: TARGET.COREAREA_NAME
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b86c5cea-dd9d-4662-8be8-dc3a25208573
          stepCounter: e11dddcc-e54e-4646-bb65-5f7ef02db6d6
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: The name or description of the entity.
        name: PROV_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4add7d48-d187-402d-8141-2ffc7dc340d7
                stepCounter: f5d6146b-7042-4b8a-b29d-05b61de7beb0
            transform: TARGET.PROV_NAME
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_GDC_RAW_PRODUCTION: 5fa5d712-cd84-49a2-a874-44ec8128404f
          DIM_LO_SAP_COST_CENTER_HIER: f5d6146b-7042-4b8a-b29d-05b61de7beb0
          VIEW_CSLAND_WELL_DETAIL: 2393d61c-a07b-428f-ad0e-948208327c38
          DIM_LO_SAP_PRODUCT_TYPE: af796a63-3184-4858-86cc-362cb792e537
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: VIEW_GDC_RAW_PRODUCTION
          - locationName: TARGET
            nodeName: DIM_LO_SAP_COST_CENTER_HIER
          - locationName: TARGET
            nodeName: VIEW_CSLAND_WELL_DETAIL
          - locationName: TARGET
            nodeName: DIM_LO_SAP_PRODUCT_TYPE
        join:
          joinCondition: |-
            FROM (
                    SELECT VIEW_GDC_RAW_PRODUCTION.BA_NAME ,
                           VIEW_GDC_RAW_PRODUCTION.UWI ,
                           VIEW_GDC_RAW_PRODUCTION.ACTIVITY_PERIOD ,
                           VIEW_GDC_RAW_PRODUCTION.WATER ,
                           VIEW_GDC_RAW_PRODUCTION.GAS ,
                           VIEW_GDC_RAW_PRODUCTION.OIL ,
                           VIEW_GDC_RAW_PRODUCTION.COND ,
                           DIM_LO_SAP_COST_CENTER_HIER.CC_NUM ,
                           DIM_LO_SAP_COST_CENTER_HIER.CC_NAME ,
                           DIM_LO_SAP_COST_CENTER_HIER.CC_NUM_NAME ,
                           DIM_LO_SAP_COST_CENTER_HIER.FORMATTED_UWI ,
                           VIEW_CSLAND_WELL_DETAIL.WI AS WORKING_INTEREST ,
                           DIM_LO_SAP_COST_CENTER_HIER.AREA_NAME ,
                           DIM_LO_SAP_COST_CENTER_HIER.COREAREA_NAME ,
                           DIM_LO_SAP_COST_CENTER_HIER.COUNTRY_NAME ,
                           DIM_LO_SAP_COST_CENTER_HIER.PROV_NAME ,
                           DIM_LO_SAP_PRODUCT_TYPE.LIQUID_BOE_THERMAL ,
                           DIM_LO_SAP_PRODUCT_TYPE.GAS_SI_TO_IMP_CONV_FACTOR ,
                           DIM_LO_SAP_PRODUCT_TYPE.GAS_BOE_THERMAL
                      FROM {{ ref('TARGET','VIEW_GDC_RAW_PRODUCTION') }} VIEW_GDC_RAW_PRODUCTION
                      LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_COST_CENTER_HIER') }} DIM_LO_SAP_COST_CENTER_HIER
                        ON VIEW_GDC_RAW_PRODUCTION.UWI = DIM_LO_SAP_COST_CENTER_HIER.UWI
                      LEFT JOIN {{ ref('TARGET','VIEW_CSLAND_WELL_DETAIL') }} VIEW_CSLAND_WELL_DETAIL
                        ON VIEW_GDC_RAW_PRODUCTION.UWI = VIEW_CSLAND_WELL_DETAIL.RAW_UWI
                      JOIN (
                            SELECT DISTINCT MAX(CASE WHEN PROD_CODE IN ('GAS', 'GCOMP', 'GGATH', 'GPROC') THEN SI_TO_IMP_CONV_FACTOR END) AS GAS_SI_TO_IMP_CONV_FACTOR ,
                                   MAX(CASE WHEN PROD_CODE IN ('GAS', 'GCOMP', 'GGATH', 'GPROC') THEN BOE_THERMAL END) AS GAS_BOE_THERMAL ,
                                   MAX(CASE WHEN PROD_CODE NOT IN ('GAS', 'GCOMP', 'GGATH', 'GPROC') THEN BOE_THERMAL END) AS LIQUID_BOE_THERMAL
                              FROM {{ ref('TARGET','DIM_LO_SAP_PRODUCT_TYPE') }}
                           ) AS DIM_LO_SAP_PRODUCT_TYPE
                        ON 1 = 1
                     GROUP BY VIEW_GDC_RAW_PRODUCTION.BA_NAME ,
                              VIEW_GDC_RAW_PRODUCTION.UWI ,
                              VIEW_GDC_RAW_PRODUCTION.ACTIVITY_PERIOD ,
                              VIEW_GDC_RAW_PRODUCTION.WATER ,
                              VIEW_GDC_RAW_PRODUCTION.GAS ,
                              VIEW_GDC_RAW_PRODUCTION.OIL ,
                              VIEW_GDC_RAW_PRODUCTION.COND ,
                              DIM_LO_SAP_COST_CENTER_HIER.CC_NUM ,
                              DIM_LO_SAP_COST_CENTER_HIER.CC_NAME ,
                              DIM_LO_SAP_COST_CENTER_HIER.CC_NUM_NAME ,
                              DIM_LO_SAP_COST_CENTER_HIER.FORMATTED_UWI ,
                              VIEW_CSLAND_WELL_DETAIL.WI ,
                              DIM_LO_SAP_COST_CENTER_HIER.AREA_NAME ,
                              DIM_LO_SAP_COST_CENTER_HIER.COREAREA_NAME ,
                              DIM_LO_SAP_COST_CENTER_HIER.COUNTRY_NAME ,
                              DIM_LO_SAP_COST_CENTER_HIER.PROV_NAME ,
                              DIM_LO_SAP_PRODUCT_TYPE.LIQUID_BOE_THERMAL ,
                              DIM_LO_SAP_PRODUCT_TYPE.GAS_SI_TO_IMP_CONV_FACTOR ,
                              DIM_LO_SAP_PRODUCT_TYPE.GAS_BOE_THERMAL
                   ) AS TARGET
             WHERE TARGET.BA_NAME LIKE '%VERMILION%'
        name: VIEW_GDC_VET_RAW_PRODUCTION
        noLinkRefs: []
  name: VIEW_GDC_VET_RAW_PRODUCTION
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
