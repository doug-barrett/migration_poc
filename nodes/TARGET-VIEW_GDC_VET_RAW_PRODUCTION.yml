fileVersion: 1
id: 07dd0b2c-cf30-4a3f-b8e8-fe060f84f9dd
name: VIEW_GDC_VET_RAW_PRODUCTION
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75d43e78-db94-4de3-9ecb-34ceffbcc0e2
          stepCounter: 07dd0b2c-cf30-4a3f-b8e8-fe060f84f9dd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72a8a493-9662-4ca7-b67f-881245b720a4
                stepCounter: ec48f19e-bef0-470c-9e0d-1c4720148b73
            transform: TARGET.UWI
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15fc0b54-4ee0-458a-b208-4a93672641d9
          stepCounter: 07dd0b2c-cf30-4a3f-b8e8-fe060f84f9dd
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: ACTVY_PER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d49fb3f9-fa18-41b6-91e4-edb0e44b46a7
                stepCounter: ec48f19e-bef0-470c-9e0d-1c4720148b73
            transform: LAST_DAY(TARGET.ACTIVITY_PERIOD)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6dc94a73-c2ee-4cbc-b110-d9e56db1bd2d
          stepCounter: 07dd0b2c-cf30-4a3f-b8e8-fe060f84f9dd
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ACTVY_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d49fb3f9-fa18-41b6-91e4-edb0e44b46a7
                stepCounter: ec48f19e-bef0-470c-9e0d-1c4720148b73
            transform: |-
              CASE WHEN TARGET.ACTIVITY_PERIOD IS NULL THEN - 1
                          ELSE CAST(TO_CHAR(LAST_DAY(TARGET.ACTIVITY_PERIOD), 'YYYYMMDD') AS INT)
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4861d36-57bb-43f1-bc8e-37885004dfd9
          stepCounter: 07dd0b2c-cf30-4a3f-b8e8-fe060f84f9dd
        config: {}
        dataType: NUMBER(26,4)
        defaultValue: ""
        description: ""
        name: WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0d82dea2-80ad-433b-952c-de7fb00ad135
                stepCounter: ec48f19e-bef0-470c-9e0d-1c4720148b73
            transform: TARGET.WATER
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b9eb4744-2cfb-4ac0-93e3-e66fe46950b3
          stepCounter: 07dd0b2c-cf30-4a3f-b8e8-fe060f84f9dd
        config: {}
        dataType: NUMBER(26,4)
        defaultValue: ""
        description: ""
        name: WATER_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0d82dea2-80ad-433b-952c-de7fb00ad135
                stepCounter: ec48f19e-bef0-470c-9e0d-1c4720148b73
            transform: TARGET.WATER * NVL(TARGET.LIQUID_BOE_THERMAL, 1)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f4f2dafe-b78b-4ffb-86cd-c9816d03008f
          stepCounter: 07dd0b2c-cf30-4a3f-b8e8-fe060f84f9dd
        config: {}
        dataType: NUMBER(26,4)
        defaultValue: ""
        description: ""
        name: WATER_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0d82dea2-80ad-433b-952c-de7fb00ad135
                stepCounter: ec48f19e-bef0-470c-9e0d-1c4720148b73
            transform: TARGET.WATER * NVL(TARGET.LIQUID_BOE_THERMAL, 1)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e433af8b-5843-4929-be14-d9c7340b387b
          stepCounter: 07dd0b2c-cf30-4a3f-b8e8-fe060f84f9dd
        config: {}
        dataType: NUMBER(26,4)
        defaultValue: ""
        description: ""
        name: GAS_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09295e12-3808-4677-84b3-8259e673c879
                stepCounter: ec48f19e-bef0-470c-9e0d-1c4720148b73
            transform: TARGET.GAS*NVL(TARGET.GAS_SI_TO_IMP_CONV_FACTOR,1)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 115e1f89-19ba-4f3f-973c-d0172583a4ac
          stepCounter: 07dd0b2c-cf30-4a3f-b8e8-fe060f84f9dd
        config: {}
        dataType: NUMBER(26,4)
        defaultValue: ""
        description: ""
        name: GAS_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09295e12-3808-4677-84b3-8259e673c879
                stepCounter: ec48f19e-bef0-470c-9e0d-1c4720148b73
            transform: TARGET.GAS*NVL(TARGET.GAS_BOE_THERMAL,1)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed11d20d-2693-4b93-b476-8790871a312a
          stepCounter: 07dd0b2c-cf30-4a3f-b8e8-fe060f84f9dd
        config: {}
        dataType: NUMBER(26,4)
        defaultValue: ""
        description: ""
        name: GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09295e12-3808-4677-84b3-8259e673c879
                stepCounter: ec48f19e-bef0-470c-9e0d-1c4720148b73
            transform: TARGET.GAS
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 571b993e-51eb-4887-9e62-013aff3fec71
          stepCounter: 07dd0b2c-cf30-4a3f-b8e8-fe060f84f9dd
        config: {}
        dataType: NUMBER(26,4)
        defaultValue: ""
        description: ""
        name: OIL_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11bff052-84aa-4c41-a859-d4f79b30ab62
                stepCounter: ec48f19e-bef0-470c-9e0d-1c4720148b73
            transform: TARGET.OIL
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92101ee6-89ae-4ee4-8e97-7a43b2e61f56
          stepCounter: 07dd0b2c-cf30-4a3f-b8e8-fe060f84f9dd
        config: {}
        dataType: NUMBER(26,4)
        defaultValue: ""
        description: ""
        name: OIL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11bff052-84aa-4c41-a859-d4f79b30ab62
                stepCounter: ec48f19e-bef0-470c-9e0d-1c4720148b73
            transform: TARGET.OIL*NVL(TARGET.LIQUID_BOE_THERMAL,1)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e82e533-b858-47bf-96b2-e82ec21e7c5e
          stepCounter: 07dd0b2c-cf30-4a3f-b8e8-fe060f84f9dd
        config: {}
        dataType: NUMBER(26,4)
        defaultValue: ""
        description: ""
        name: OIL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11bff052-84aa-4c41-a859-d4f79b30ab62
                stepCounter: ec48f19e-bef0-470c-9e0d-1c4720148b73
            transform: TARGET.OIL*NVL(TARGET.LIQUID_BOE_THERMAL,1)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 838e0f14-c622-4530-9deb-3f931c3a8ad8
          stepCounter: 07dd0b2c-cf30-4a3f-b8e8-fe060f84f9dd
        config: {}
        dataType: NUMBER(26,4)
        defaultValue: ""
        description: ""
        name: CONDENSATE_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1aa071df-04ad-4ea4-8653-3bb48816ed44
                stepCounter: ec48f19e-bef0-470c-9e0d-1c4720148b73
            transform: TARGET.COND*NVL(TARGET.LIQUID_BOE_THERMAL,1)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d41d161-0cd7-4bbd-a8b4-38b07b52055e
          stepCounter: 07dd0b2c-cf30-4a3f-b8e8-fe060f84f9dd
        config: {}
        dataType: NUMBER(26,4)
        defaultValue: ""
        description: ""
        name: CONDENSATE_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1aa071df-04ad-4ea4-8653-3bb48816ed44
                stepCounter: ec48f19e-bef0-470c-9e0d-1c4720148b73
            transform: TARGET.COND*NVL(TARGET.LIQUID_BOE_THERMAL,1)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ccdf0dbc-281b-417a-9391-f0aaf75cf3d9
          stepCounter: 07dd0b2c-cf30-4a3f-b8e8-fe060f84f9dd
        config: {}
        dataType: NUMBER(26,4)
        defaultValue: ""
        description: ""
        name: CONDENSATE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1aa071df-04ad-4ea4-8653-3bb48816ed44
                stepCounter: ec48f19e-bef0-470c-9e0d-1c4720148b73
            transform: TARGET.COND
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f193601-0875-4043-a5ab-a2234c27b265
          stepCounter: 07dd0b2c-cf30-4a3f-b8e8-fe060f84f9dd
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c071d19-749a-475a-b15c-e944e46de5b6
                stepCounter: 9dfef1fa-b086-4d68-9049-2499c9f4c250
            transform: TARGET.CC_NUM
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 410251c6-7097-4372-a836-2785a5b4a73d
          stepCounter: 07dd0b2c-cf30-4a3f-b8e8-fe060f84f9dd
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: CC_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 44af4916-491f-424f-888d-eadb23238e28
                stepCounter: 9dfef1fa-b086-4d68-9049-2499c9f4c250
            transform: TARGET.CC_NAME
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8239ce7e-4d73-412a-850b-63f4480869f5
          stepCounter: 07dd0b2c-cf30-4a3f-b8e8-fe060f84f9dd
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: CC_NUM_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1f518bf-5d8b-4ded-922b-1218c0811033
                stepCounter: 9dfef1fa-b086-4d68-9049-2499c9f4c250
            transform: TARGET.CC_NUM_NAME
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ac426d0-7912-4cca-bba8-504522952667
          stepCounter: 07dd0b2c-cf30-4a3f-b8e8-fe060f84f9dd
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: Formatted UWI of the Cost Centre
        name: FORMATTED_UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50f2ca4d-52fe-40c4-ab0b-03f17004df6d
                stepCounter: 9dfef1fa-b086-4d68-9049-2499c9f4c250
            transform: TARGET.FORMATTED_UWI
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3145b9a-217d-450d-afdc-127c13308794
          stepCounter: 07dd0b2c-cf30-4a3f-b8e8-fe060f84f9dd
        config: {}
        dataType: NUMBER(14,11)
        defaultValue: ""
        description: The Land Percent.
        name: WORKING_INTEREST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b284a214-3721-44ab-92d6-65cb9abe5c19
                stepCounter: 9dfef1fa-b086-4d68-9049-2499c9f4c250
            transform: TARGET.WORKING_INTEREST
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 816eb5b9-b7b1-4a3d-8fc1-8ca4dc1c20e5
          stepCounter: 07dd0b2c-cf30-4a3f-b8e8-fe060f84f9dd
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: The name or description of the entity.
        name: AREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 40da0e99-788d-482a-a061-34350f9924a6
                stepCounter: 9dfef1fa-b086-4d68-9049-2499c9f4c250
            transform: TARGET.AREA_NAME
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 30760c21-2a06-4a51-9c37-bb62a158aa70
          stepCounter: 07dd0b2c-cf30-4a3f-b8e8-fe060f84f9dd
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: The name or description of the entity.
        name: COREAREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c59b4345-2fdc-4bee-93c3-179c61bc7e6a
                stepCounter: 9dfef1fa-b086-4d68-9049-2499c9f4c250
            transform: TARGET.COREAREA_NAME
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c1c43d5-418e-41d8-84a9-43be7e68edbe
          stepCounter: 07dd0b2c-cf30-4a3f-b8e8-fe060f84f9dd
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: The name or description of the entity.
        name: PROV_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e6eab54-c359-42ec-a999-e2041f0b073f
                stepCounter: 9dfef1fa-b086-4d68-9049-2499c9f4c250
            transform: TARGET.PROV_NAME
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_GDC_RAW_PRODUCTION: ec48f19e-bef0-470c-9e0d-1c4720148b73
          DIM_LO_SAP_COST_CENTER_HIER: 9dfef1fa-b086-4d68-9049-2499c9f4c250
          VIEW_CSLAND_WELL_DETAIL: b1d1f06e-f672-4111-8570-9ab68d4ef792
          DIM_LO_SAP_PRODUCT_TYPE: e14ab72e-3f25-44f0-b70c-6a0192afcc50
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: VIEW_GDC_RAW_PRODUCTION
          - locationName: TARGET
            nodeName: DIM_LO_SAP_COST_CENTER_HIER
          - locationName: TARGET
            nodeName: VIEW_CSLAND_WELL_DETAIL
          - locationName: TARGET
            nodeName: DIM_LO_SAP_PRODUCT_TYPE
        join:
          joinCondition: |-
            FROM (
                    SELECT VIEW_GDC_RAW_PRODUCTION.BA_NAME ,
                           VIEW_GDC_RAW_PRODUCTION.UWI ,
                           VIEW_GDC_RAW_PRODUCTION.ACTIVITY_PERIOD ,
                           VIEW_GDC_RAW_PRODUCTION.WATER ,
                           VIEW_GDC_RAW_PRODUCTION.GAS ,
                           VIEW_GDC_RAW_PRODUCTION.OIL ,
                           VIEW_GDC_RAW_PRODUCTION.COND ,
                           DIM_LO_SAP_COST_CENTER_HIER.CC_NUM ,
                           DIM_LO_SAP_COST_CENTER_HIER.CC_NAME ,
                           DIM_LO_SAP_COST_CENTER_HIER.CC_NUM_NAME ,
                           DIM_LO_SAP_COST_CENTER_HIER.FORMATTED_UWI ,
                           VIEW_CSLAND_WELL_DETAIL.WI AS WORKING_INTEREST ,
                           DIM_LO_SAP_COST_CENTER_HIER.AREA_NAME ,
                           DIM_LO_SAP_COST_CENTER_HIER.COREAREA_NAME ,
                           DIM_LO_SAP_COST_CENTER_HIER.COUNTRY_NAME ,
                           DIM_LO_SAP_COST_CENTER_HIER.PROV_NAME ,
                           DIM_LO_SAP_PRODUCT_TYPE.LIQUID_BOE_THERMAL ,
                           DIM_LO_SAP_PRODUCT_TYPE.GAS_SI_TO_IMP_CONV_FACTOR ,
                           DIM_LO_SAP_PRODUCT_TYPE.GAS_BOE_THERMAL
                      FROM {{ ref('TARGET','VIEW_GDC_RAW_PRODUCTION') }} VIEW_GDC_RAW_PRODUCTION
                      LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_COST_CENTER_HIER') }} DIM_LO_SAP_COST_CENTER_HIER
                        ON VIEW_GDC_RAW_PRODUCTION.UWI = DIM_LO_SAP_COST_CENTER_HIER.UWI
                      LEFT JOIN {{ ref('TARGET','VIEW_CSLAND_WELL_DETAIL') }} VIEW_CSLAND_WELL_DETAIL
                        ON VIEW_GDC_RAW_PRODUCTION.UWI = VIEW_CSLAND_WELL_DETAIL.RAW_UWI
                      JOIN (
                            SELECT DISTINCT MAX(CASE WHEN PROD_CODE IN ('GAS', 'GCOMP', 'GGATH', 'GPROC') THEN SI_TO_IMP_CONV_FACTOR END) AS GAS_SI_TO_IMP_CONV_FACTOR ,
                                   MAX(CASE WHEN PROD_CODE IN ('GAS', 'GCOMP', 'GGATH', 'GPROC') THEN BOE_THERMAL END) AS GAS_BOE_THERMAL ,
                                   MAX(CASE WHEN PROD_CODE NOT IN ('GAS', 'GCOMP', 'GGATH', 'GPROC') THEN BOE_THERMAL END) AS LIQUID_BOE_THERMAL
                              FROM {{ ref('TARGET','DIM_LO_SAP_PRODUCT_TYPE') }}
                           ) AS DIM_LO_SAP_PRODUCT_TYPE
                        ON 1 = 1
                     GROUP BY VIEW_GDC_RAW_PRODUCTION.BA_NAME ,
                              VIEW_GDC_RAW_PRODUCTION.UWI ,
                              VIEW_GDC_RAW_PRODUCTION.ACTIVITY_PERIOD ,
                              VIEW_GDC_RAW_PRODUCTION.WATER ,
                              VIEW_GDC_RAW_PRODUCTION.GAS ,
                              VIEW_GDC_RAW_PRODUCTION.OIL ,
                              VIEW_GDC_RAW_PRODUCTION.COND ,
                              DIM_LO_SAP_COST_CENTER_HIER.CC_NUM ,
                              DIM_LO_SAP_COST_CENTER_HIER.CC_NAME ,
                              DIM_LO_SAP_COST_CENTER_HIER.CC_NUM_NAME ,
                              DIM_LO_SAP_COST_CENTER_HIER.FORMATTED_UWI ,
                              VIEW_CSLAND_WELL_DETAIL.WI ,
                              DIM_LO_SAP_COST_CENTER_HIER.AREA_NAME ,
                              DIM_LO_SAP_COST_CENTER_HIER.COREAREA_NAME ,
                              DIM_LO_SAP_COST_CENTER_HIER.COUNTRY_NAME ,
                              DIM_LO_SAP_COST_CENTER_HIER.PROV_NAME ,
                              DIM_LO_SAP_PRODUCT_TYPE.LIQUID_BOE_THERMAL ,
                              DIM_LO_SAP_PRODUCT_TYPE.GAS_SI_TO_IMP_CONV_FACTOR ,
                              DIM_LO_SAP_PRODUCT_TYPE.GAS_BOE_THERMAL
                   ) AS TARGET
             WHERE TARGET.BA_NAME LIKE '%VERMILION%'
        name: VIEW_GDC_VET_RAW_PRODUCTION
        noLinkRefs: []
  name: VIEW_GDC_VET_RAW_PRODUCTION
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
