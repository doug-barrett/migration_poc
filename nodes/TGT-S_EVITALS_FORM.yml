fileVersion: 1
id: dafc323d-7f5d-468c-a2be-28e2a2dda2a3
name: S_EVITALS_FORM
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Dimension key look up."
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8621eb11-e841-47a2-abd2-da6dab8ee56f
          stepCounter: dafc323d-7f5d-468c-a2be-28e2a2dda2a3
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: ""
        name: FORM_INSTANCE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4ce36f6-f8b6-4614-929b-f80b9edbde0d
                stepCounter: 6576cfcf-ac9d-47d9-8205-54c4adb43d3a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f40d7a92-3b24-4f03-8ccf-a5c6e59671db
          stepCounter: dafc323d-7f5d-468c-a2be-28e2a2dda2a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_eVitals_form.form_definition_id=dim_eVitals_form.form_definition_id
        name: DIM_EVITALS_FORM_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 87547d20-aed0-478f-941b-314359cdb75e
                stepCounter: e80c53d8-6caa-491d-be7a-428dc8e68f53
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 711cc89a-0ffd-4735-a537-a3bc318dea8a
          stepCounter: dafc323d-7f5d-468c-a2be-28e2a2dda2a3
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64218bca-710e-4f63-89c9-5fc44bf6d146
                stepCounter: 6576cfcf-ac9d-47d9-8205-54c4adb43d3a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7de3c586-68f8-440b-aef5-eb6e2e8cb986
          stepCounter: dafc323d-7f5d-468c-a2be-28e2a2dda2a3
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ADMISSION_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f678cb8-8467-4b60-8da2-4c9733ad9962
                stepCounter: 6576cfcf-ac9d-47d9-8205-54c4adb43d3a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad8a539d-8ed5-4341-91f0-c34ed7f8effb
          stepCounter: dafc323d-7f5d-468c-a2be-28e2a2dda2a3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMISSION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e380ff5-0c29-4b3d-b703-7c01f64a8949
                stepCounter: 6576cfcf-ac9d-47d9-8205-54c4adb43d3a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f388141-4c32-47b5-9b90-b9b893071894
          stepCounter: dafc323d-7f5d-468c-a2be-28e2a2dda2a3
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 73953156-ca3f-49a1-9ec7-d47e053c806f
                stepCounter: 6576cfcf-ac9d-47d9-8205-54c4adb43d3a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 456284ec-a6a2-4dbb-95b2-ad6a904f4489
          stepCounter: dafc323d-7f5d-468c-a2be-28e2a2dda2a3
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MATCHED_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 55c2bf04-4e42-46c7-baca-4de4fc98fd3d
                stepCounter: 6576cfcf-ac9d-47d9-8205-54c4adb43d3a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f936fdf2-01fa-4dd8-be36-b42eb579dd6b
          stepCounter: dafc323d-7f5d-468c-a2be-28e2a2dda2a3
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: ""
        name: FORM_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f678cb8-8467-4b60-8da2-4c9733ad9962
                stepCounter: 6576cfcf-ac9d-47d9-8205-54c4adb43d3a
            transform: COUNT(1) OVER(PARTITION BY admission_id)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2d86a70-c0df-47d6-8df8-8476a5fb3048
          stepCounter: dafc323d-7f5d-468c-a2be-28e2a2dda2a3
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: ""
        name: FORM_SEQ_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f678cb8-8467-4b60-8da2-4c9733ad9962
                stepCounter: 6576cfcf-ac9d-47d9-8205-54c4adb43d3a
            transform: ROW_NUMBER() OVER(PARTITION BY admission_id ORDER BY form_instance_id)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a74bd33-fca6-47db-bbaa-dbd84523e731
          stepCounter: dafc323d-7f5d-468c-a2be-28e2a2dda2a3
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: ""
        name: FORM_DEFINITION_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 49e9791b-4217-43f0-bc90-cb4307847771
                stepCounter: 6576cfcf-ac9d-47d9-8205-54c4adb43d3a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7eba4b5a-a9c7-40f9-bd9d-243887392dea
          stepCounter: dafc323d-7f5d-468c-a2be-28e2a2dda2a3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FORM_CREATED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16335a30-5abe-4e33-8d9e-5a0de2e767ce
                stepCounter: 6576cfcf-ac9d-47d9-8205-54c4adb43d3a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2563d735-38f2-4337-94c5-2263974e1a30
          stepCounter: dafc323d-7f5d-468c-a2be-28e2a2dda2a3
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: FORM_CREATED_USER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd73f6f5-2aa7-40f8-827d-cd89839cc7d8
                stepCounter: 6576cfcf-ac9d-47d9-8205-54c4adb43d3a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a780d70f-5543-41a4-b79b-58af6a6fbf19
          stepCounter: dafc323d-7f5d-468c-a2be-28e2a2dda2a3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FORM_MODIFIED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3f8b08f-0158-4086-89a3-509b88ed7a11
                stepCounter: 6576cfcf-ac9d-47d9-8205-54c4adb43d3a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f78cd03-8e61-4e9d-bd33-86746925108e
          stepCounter: dafc323d-7f5d-468c-a2be-28e2a2dda2a3
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: FORM_MODIFIED_USER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 764f471c-9a9d-4088-9838-bba47526a031
                stepCounter: 6576cfcf-ac9d-47d9-8205-54c4adb43d3a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7cbe116-d267-4db4-86aa-528ca20b347d
          stepCounter: dafc323d-7f5d-468c-a2be-28e2a2dda2a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Internal unique identifier for a patient from the Patient Management System
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09bae0e1-ad72-4c1a-bf58-b702e10bdd02
                stepCounter: 6576cfcf-ac9d-47d9-8205-54c4adb43d3a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e19aa742-190d-4faa-916b-e903751d26b7
          stepCounter: dafc323d-7f5d-468c-a2be-28e2a2dda2a3
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Alphanumeric code that uniquely identifies a ward in Patientrack.
        name: WARD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 53cfaf5c-7f7c-422f-822e-274697f77ed1
                stepCounter: 6576cfcf-ac9d-47d9-8205-54c4adb43d3a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ec511da-e517-4af1-8d01-ddc7829c4513
          stepCounter: dafc323d-7f5d-468c-a2be-28e2a2dda2a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_eVitals_form.form_modified_user=dim_eVitals_modify_by_user_account.dim_eVitals_modify_by_user_id
        name: DIM_EVITALS_MODIFY_BY_USER_ACCOUNT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4fba0d3a-c265-4c3e-8d42-e3696c3b2fa4
                stepCounter: 009dee47-7039-430f-8120-2d2073624197
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 071ad35a-4e2d-4cb6-8fa3-0e233a2dc743
          stepCounter: dafc323d-7f5d-468c-a2be-28e2a2dda2a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_eVitals_form.form_created_user=dim_eVitals_create_by_user_account.user_id
        name: DIM_EVITALS_CREATE_BY_USER_ACCOUNT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f59cecc-1de4-4e16-891c-25f1b8c737a2
                stepCounter: 4d94293f-2427-4b33-af9d-359b0d870d05
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8209e96a-1034-4376-8b85-2e8089bb85c9
          stepCounter: dafc323d-7f5d-468c-a2be-28e2a2dda2a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_eVitals_form.ward_code=dim_eVitals_ward.ward_code
        name: DIM_EVITALS_WARD_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea32cb49-2e3e-4f47-afae-b61696d7cd7a
                stepCounter: 3713fb07-8558-460e-866c-807865add548
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e0c4866-18b2-4b4c-9411-aee63ca868d5
          stepCounter: dafc323d-7f5d-468c-a2be-28e2a2dda2a3
        config: {}
        dataType: INT
        defaultValue: ""
        description: s_eVitals_form.form_created_date=dim_form_created_date.form_created_date
        name: DIM_FORM_CREATED_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bd136cdd-6586-451d-83c3-5df58be748ad
                stepCounter: 27045cf6-6114-4c3e-a1b0-9a7f21a58935
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd00e1a1-9102-491b-ada2-47ec6a63ef96
          stepCounter: dafc323d-7f5d-468c-a2be-28e2a2dda2a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_eVitals_form.patient_reference_no=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9962a01b-5f3d-4c1a-b371-997edef38d0f
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a4dc4c8-171a-4473-9050-48fd49a69772
          stepCounter: dafc323d-7f5d-468c-a2be-28e2a2dda2a3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_EVITALS_FORM_20: 6576cfcf-ac9d-47d9-8205-54c4adb43d3a
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_EVITALS_FORM_20
        join:
          joinCondition: FROM {{ ref('TGT','S_EVITALS_FORM_20') }} -- Only return 1 row per form_instance_id  WHERE row_num = 1
        name: S_EVITALS_FORM
        noLinkRefs: []
  name: S_EVITALS_FORM
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
