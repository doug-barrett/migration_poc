fileVersion: 1
id: a0d6d5e5-b00e-4b8c-8156-b76442073209
name: S_EREFERRAL_PATIENT_20
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae0a4969-99f1-4249-9aca-a9dcb49e67da
          stepCounter: a0d6d5e5-b00e-4b8c-8156-b76442073209
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: FIRST_VERSION
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: row_number() over(PARTITION BY patient_id ORDER BY patient_id)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f228522a-bb91-425d-8033-77512c709ee5
          stepCounter: a0d6d5e5-b00e-4b8c-8156-b76442073209
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: EXTERNAL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 433b4a58-a8e0-4a86-8d25-9a085f015921
                stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ecac9a3-086e-433a-ae74-7c8d5c92ebba
          stepCounter: a0d6d5e5-b00e-4b8c-8156-b76442073209
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: DHB_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6341b242-2d3f-4685-8aa7-d7c46886396f
                stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e8c4aaa-2cbf-4a8c-a701-a6b3216c1d0c
          stepCounter: a0d6d5e5-b00e-4b8c-8156-b76442073209
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SERVICE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e411a84-835a-462d-b632-7ed5291190fb
                stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c54f266-5ff8-4298-89dd-e40a1dca9195
          stepCounter: a0d6d5e5-b00e-4b8c-8156-b76442073209
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: REFERRED_FOR_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee97d93a-f052-461a-ade5-7409e11e0fa1
                stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b5cba45-675d-48be-aac2-2c3b48c1f289
          stepCounter: a0d6d5e5-b00e-4b8c-8156-b76442073209
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 984582b2-b687-4459-a35c-1f3d9c497b1b
                stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 291b029d-8b1d-4b37-b4a9-7fa839e69d4a
          stepCounter: a0d6d5e5-b00e-4b8c-8156-b76442073209
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: 'Internal unique identifier for a patient from the Patient Management System '
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 702dfc9d-df5e-42d8-86f8-9e68f29c462c
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3db2df5f-5ade-4d40-95cd-c88ed2283490
          stepCounter: a0d6d5e5-b00e-4b8c-8156-b76442073209
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SUBMISSION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dfffd6fc-eabe-4543-8d66-059d895aa375
                stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f3ad722-b99a-4193-9eff-02a05378fb24
          stepCounter: a0d6d5e5-b00e-4b8c-8156-b76442073209
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: PATIENT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91135cd8-e62d-4475-9e12-3a70c25a04bd
                stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: badd0cb5-6043-45ad-bcf8-89116ff740af
          stepCounter: a0d6d5e5-b00e-4b8c-8156-b76442073209
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: PATIENT_GIVEN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c02540d9-da54-4892-aa7c-64cdafe7b8ba
                stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77a9df44-c6ce-434a-a034-fb29b22890ac
          stepCounter: a0d6d5e5-b00e-4b8c-8156-b76442073209
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: PATIENT_FAMILY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4bb43e93-b094-4796-8a3b-278ea658d524
                stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1192e24f-5d77-4d68-a7eb-81f227bbad1e
          stepCounter: a0d6d5e5-b00e-4b8c-8156-b76442073209
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PATIENT_DOB
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ae2465b3-319c-41f8-b803-b91e11d44355
                stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e2eb2c2-8c6d-4544-9d3d-8368cfaef91d
          stepCounter: a0d6d5e5-b00e-4b8c-8156-b76442073209
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: 'Biological Sex of the patient '
        name: PATIENT_GENDER_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e90b8c91-0f3d-484a-bc28-b5373313fb17
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f90d823f-e2a1-406d-b6a6-573da3699e51
          stepCounter: a0d6d5e5-b00e-4b8c-8156-b76442073209
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: REFERRER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ae285710-40d1-40f4-bf9e-3f824c0dbd63
                stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f89868b-acbe-4c1d-ba18-efa27cd69a5e
          stepCounter: a0d6d5e5-b00e-4b8c-8156-b76442073209
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: REFERRER_ID_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50bbbb7a-7eee-46d3-a024-0027081cf4e5
                stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fdf62519-3ef7-4537-a781-c6ceeb9aac6e
          stepCounter: a0d6d5e5-b00e-4b8c-8156-b76442073209
        config: {}
        dataType: VARCHAR(60)
        defaultValue: ""
        description: The surname and preferred forename of the patient in the format (SURNAME, PREFERRED_NAME)
        name: PATIENT_FULLNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 271e4fae-c1a4-4ebf-8ba4-75dfe9c95440
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 735d141f-1fcf-43b8-8173-79acdb86e796
          stepCounter: a0d6d5e5-b00e-4b8c-8156-b76442073209
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_UPDATED_DATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24beb36e-cfbc-4bc7-9ea9-c525f3d973a9
                stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50788fdc-a468-46e5-ac52-654270ad2a03
          stepCounter: a0d6d5e5-b00e-4b8c-8156-b76442073209
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: LAST_UPDATED_USER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0468c085-d3dd-4db3-ae00-44de034d95cc
                stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38907483-01ea-4823-a6fb-d4b319e46f11
          stepCounter: a0d6d5e5-b00e-4b8c-8156-b76442073209
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: The date that the patient died
        name: PATIENT_DATE_OF_DEATH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b5c2ff38-a66e-4814-80ba-d041584351af
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd28a819-f51f-4141-8e72-53282a53766b
          stepCounter: a0d6d5e5-b00e-4b8c-8156-b76442073209
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: ACC_ELIGIBLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 492a1021-e32e-41cc-8e7a-42301aa2b427
                stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd607792-1f1b-4814-af24-d163370c8cbf
          stepCounter: a0d6d5e5-b00e-4b8c-8156-b76442073209
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: ELIGIBILITY_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 603c8048-8d76-434e-a74b-a548ea2eb8fc
                stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c396bd8-becf-4a7a-85d1-d668700da286
          stepCounter: a0d6d5e5-b00e-4b8c-8156-b76442073209
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: RESIDENTIAL_DHB
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 670c0481-bc8c-40a9-9648-955a403838f7
                stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c00632a3-8dd7-413e-a8c6-6384250f568a
          stepCounter: a0d6d5e5-b00e-4b8c-8156-b76442073209
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: PMS_APPLICATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d968f484-6f61-4e34-976d-93f0c9ce13a0
                stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: abf3dce3-219e-48ec-8d57-0b358c323cda
          stepCounter: a0d6d5e5-b00e-4b8c-8156-b76442073209
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LATEST_HISTORY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0344639b-5f5c-4229-a0ed-f096ac06541c
                stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd5b65a3-b5eb-4231-bf73-2c1cf5c99c73
          stepCounter: a0d6d5e5-b00e-4b8c-8156-b76442073209
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: REFERRER_MESSAGING_ENABLED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 80577e5c-a294-4eb1-aec0-89f297740443
                stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5c415e8-b5d5-4bc8-8f33-2b8d520b125f
          stepCounter: a0d6d5e5-b00e-4b8c-8156-b76442073209
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: spoken language
        name: SPOKEN_LANGUAGE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b46da256-881f-4f43-b6bb-7123649d02de
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd15a64e-334f-47ca-afb6-ced26156fac0
          stepCounter: a0d6d5e5-b00e-4b8c-8156-b76442073209
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: URGENCY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d80c6972-4a56-48f1-b79d-34c25c568379
                stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2962695-0cac-4455-9e67-afe7e3383e5e
          stepCounter: a0d6d5e5-b00e-4b8c-8156-b76442073209
        config: {}
        dataType: NVARCHAR(250)
        defaultValue: ""
        description: ""
        name: PATIENT_ADDRESS_STREET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78bcb455-9135-4063-8941-293a1064673b
                stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0832dd2d-b356-453c-9518-60f70f08799c
          stepCounter: a0d6d5e5-b00e-4b8c-8156-b76442073209
        config: {}
        dataType: NVARCHAR(250)
        defaultValue: ""
        description: ""
        name: PATIENT_ADDRESS_SUBURB
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e0692633-b962-410c-af08-e36e700d1ecb
                stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8bc62d9c-2684-4aa3-9399-84fdfd36a5f0
          stepCounter: a0d6d5e5-b00e-4b8c-8156-b76442073209
        config: {}
        dataType: NVARCHAR(250)
        defaultValue: ""
        description: ""
        name: PATIENT_ADDRESS_CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d08d706-d220-42cd-97ac-1837658f8e20
                stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81928854-cb29-4d61-ac03-aa5759f3d59a
          stepCounter: a0d6d5e5-b00e-4b8c-8156-b76442073209
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: PATIENT_ADDRESS_POSTCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 866aae88-db9e-4d95-96b5-1256a536c130
                stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab558536-844d-494c-a749-7f2eb3254293
          stepCounter: a0d6d5e5-b00e-4b8c-8156-b76442073209
        config: {}
        dataType: NVARCHAR(250)
        defaultValue: ""
        description: ""
        name: PATIENT_ADDRESS_COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0a7a50f0-8ee3-4074-873a-9cb884062f04
                stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 296ac104-7e39-4e12-b7d5-82e3a6aef3eb
          stepCounter: a0d6d5e5-b00e-4b8c-8156-b76442073209
        config: {}
        dataType: CHAR(3)
        defaultValue: ""
        description: ""
        name: PATIENT_ADDRESS_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23b58ff4-56df-4b56-92a8-4150a0b9548b
                stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1dcde69-4280-496d-a6b8-2ead94874d18
          stepCounter: a0d6d5e5-b00e-4b8c-8156-b76442073209
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: Resident flag Y/N/U Yes, No or Unknown
        name: RESIDENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52d74c4d-6451-4934-bf1c-ef715949306f
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87232a96-9abd-4157-9c55-5373ec64467a
          stepCounter: a0d6d5e5-b00e-4b8c-8156-b76442073209
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: REFERRAL_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a28518a4-8e58-46be-98cf-bf85e74c0dd2
                stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4aef43a-3a16-4687-99b1-e8b7a9fddac9
          stepCounter: a0d6d5e5-b00e-4b8c-8156-b76442073209
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: REFERRER_FACILITY_HPI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d06d9e84-0ed3-4b85-b5ee-6f035a23f4d8
                stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97f57c0b-457e-458d-89e9-7fbbc7df1119
          stepCounter: a0d6d5e5-b00e-4b8c-8156-b76442073209
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: COMPLETION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 515526a8-0d5b-4040-b59d-8985e96dc21b
                stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f36e191-9e36-41e3-8fe8-11a9469e1576
          stepCounter: a0d6d5e5-b00e-4b8c-8156-b76442073209
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_EREFERRAL_PATIENT_10: 846dc711-2463-4d0d-95fe-190d9c92250d
          DIM_PATIENT: d52dd438-7899-4242-9e38-539d2a1447df
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_EREFERRAL_PATIENT_10
          - locationName: TGT
            nodeName: DIM_PATIENT
        join:
          joinCondition: |-
            FROM {{ ref('TGT','S_EREFERRAL_PATIENT_10') }} s_ereferral_patient_10
              LEFT JOIN {{ ref('TGT','DIM_PATIENT') }} dim_patient
                ON s_ereferral_patient_10.patient_Id = dim_patient.patient_NHI
               AND dim_patient.NHI_sequence = 1
             WHERE first_version=1
        name: S_EREFERRAL_PATIENT_20
        noLinkRefs: []
  name: S_EREFERRAL_PATIENT_20
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
