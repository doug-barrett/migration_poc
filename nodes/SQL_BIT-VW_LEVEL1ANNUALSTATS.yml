fileVersion: 1
id: 2a258c47-ceb6-48e7-90c8-2e225f63b002
name: VW_LEVEL1ANNUALSTATS
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: SQL_BIT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f306a3c6-4579-49f1-a7e0-dddcee49cedf
          stepCounter: 2a258c47-ceb6-48e7-90c8-2e225f63b002
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e71a59b-662f-4270-bd67-ace9aba9589b
                stepCounter: cd36f532-f0d8-47ba-b9d6-84ea35d998c4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef9f14aa-a94e-4365-9042-f1510f30d601
          stepCounter: 2a258c47-ceb6-48e7-90c8-2e225f63b002
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE FINANCIAL PERIOD FOR WHICH OMNIA PARTNERS RECORDED REVENUE ON A TRANSACTION.
        name: YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3097ca9-a4fa-47b0-988e-e502e3f86508
                stepCounter: cd36f532-f0d8-47ba-b9d6-84ea35d998c4
            transform: YEAR(SALESANDREVENUE.RECEIPTDATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2801f7ef-b930-4f45-a8da-39eff5cd8f59
          stepCounter: 2a258c47-ceb6-48e7-90c8-2e225f63b002
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER NAME TO BE USED ON FINANCIAL REPORTS
        name: NUMOFSUPPLIERSUSEDFORYEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e53da9de-6215-4dd0-8cdd-a657ac1e6204
                stepCounter: 84116e71-ebf6-4262-b818-71628fbd5079
            transform: COUNT (DISTINCT FINANCIALREPORTINGSUPPLIERNAME)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b49d7cc2-4eb9-4aca-9aa8-9db9bca3d82a
          stepCounter: 2a258c47-ceb6-48e7-90c8-2e225f63b002
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: IS THE SALES AMOUNT, OR GROSS TRANSACTION VOLUME (GTV), ASSOCIATED WITH A TRANSACTION IN US DOLLARS. A SALES AMOUNT IS TYPICALLY NOT AN INDIVIDUAL SALE, BUT A MONTHLY AGGREGATE OF ALL SALES FOR A CUSTOMER IN A GIVEN MONTH.
        name: SUMOFGTVFORYEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3593ab52-5241-4ba6-9c64-87170e135296
                stepCounter: cd36f532-f0d8-47ba-b9d6-84ea35d998c4
            transform: SUM(SALESANDREVENUE.SALES)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a76f6df0-f0b4-4851-b545-7b0209fd8aca
          stepCounter: 2a258c47-ceb6-48e7-90c8-2e225f63b002
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: IS THE AMOUNT OF GROSS REVENUE, ALWAYS IN US DOLLARS, OMNIA PARTNERS RECIEVED FOR THE ROW.
        name: SUMOFREVENUEFORYEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19b36c8d-6f61-4475-beeb-42cf99c19490
                stepCounter: cd36f532-f0d8-47ba-b9d6-84ea35d998c4
            transform: SUM(SALESANDREVENUE.REVENUE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b72f3c1e-37e5-451b-b103-492dd3be0e97
          stepCounter: 2a258c47-ceb6-48e7-90c8-2e225f63b002
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: IS THE SALES AMOUNT, OR GROSS TRANSACTION VOLUME (GTV), ASSOCIATED WITH A TRANSACTION IN US DOLLARS. A SALES AMOUNT IS TYPICALLY NOT AN INDIVIDUAL SALE, BUT A MONTHLY AGGREGATE OF ALL SALES FOR A CUSTOMER IN A GIVEN MONTH.
        name: AVGANNUALGTV
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3593ab52-5241-4ba6-9c64-87170e135296
                stepCounter: cd36f532-f0d8-47ba-b9d6-84ea35d998c4
            transform: AVG(SUM(SALESANDREVENUE.SALES)) OVER (PARTITION BY LEVEL1FORCEID)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05e75588-a703-44b2-9d15-43af4e140606
          stepCounter: 2a258c47-ceb6-48e7-90c8-2e225f63b002
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: IS THE AMOUNT OF GROSS REVENUE, ALWAYS IN US DOLLARS, OMNIA PARTNERS RECIEVED FOR THE ROW.
        name: AVGANNUALREVENUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19b36c8d-6f61-4475-beeb-42cf99c19490
                stepCounter: cd36f532-f0d8-47ba-b9d6-84ea35d998c4
            transform: AVG(SUM(SALESANDREVENUE.REVENUE)) OVER (PARTITION BY LEVEL1FORCEID)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 436e2658-e2a1-4cdf-8d28-176b6b976d43
          stepCounter: 2a258c47-ceb6-48e7-90c8-2e225f63b002
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER NAME TO BE USED ON FINANCIAL REPORTS
        name: AVGNUMOFANNUALSUPPLIERS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e53da9de-6215-4dd0-8cdd-a657ac1e6204
                stepCounter: 84116e71-ebf6-4262-b818-71628fbd5079
            transform: AVG(COUNT (DISTINCT FINANCIALREPORTINGSUPPLIERNAME)) OVER (PARTITION BY LEVEL1FORCEID)
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: CONTRACT
          - locationName: FACT
            nodeName: SALESANDREVENUE
        join:
          joinCondition: |-
            FROM FACT.SALESANDREVENUE
             INNER JOIN DIM.CONTRACT
                ON CONTRACT.CONTRACTKEY = SALESANDREVENUE.CONTRACTKEY
             WHERE YEAR(RECEIPTDATE) IS NOT NULL
               AND SALES IS NOT NULL
               AND REVENUE IS NOT NULL
             GROUP BY LEVEL1FORCEID,
                      YEAR(RECEIPTDATE)
             ORDER BY LEVEL1FORCEID,
                      YEAR(RECEIPTDATE)
        name: VWLEVEL1ANNUALSTATS
        noLinkRefs: []
  name: VW_LEVEL1ANNUALSTATS
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
