fileVersion: 1
id: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
name: STAGE_PRODVIEW_SALES_VOLUMES
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "Prodview sales volumes"
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f459e438-ed8e-4684-9337-9d00d2a60909
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: IDRECUNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 850244b2-cf63-447e-9a9e-2898428215e9
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 375a1b21-d3c7-45fb-adb5-580f06f5d77f
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: IDFLOWNET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e1da49e-8182-4861-8905-81254314693e
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66a70df6-4376-483d-82d3-9a199b3b7d1e
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ENTITY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 772019ac-3ca7-4166-bac9-02765e1433aa
                stepCounter: a3aef473-15c0-437b-be53-6abfe8efbd45
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 176aed8e-ad0c-4fe0-a2e6-2c8903dee62d
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SCENARIO_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: "'pv_sales'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f8f60a3-1248-4bd1-a038-4cc0d07abd10
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ACTIVITY_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f12a712-52a9-49bc-b9b3-9f6c776cada1
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: TO_VARCHAR(ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DTTM, 'YYYYMMDD')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88a3f714-25fb-48f8-ba05-679fd2dad4ca
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: ACTIVITY_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f12a712-52a9-49bc-b9b3-9f6c776cada1
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea0e1adc-98ee-4b36-aac4-f19bff403d0e
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: NORMALIZED_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1ad647c-d9d9-4a5e-a6cb-9b1d6b6dd6ec
                stepCounter: a3aef473-15c0-437b-be53-6abfe8efbd45
            transform: |-
              CASE WHEN STAGE_PRODVIEW_WELLS.ON_PROD_DATE IS NULL                                  THEN '-1'
                          WHEN STAGE_PRODVIEW_WELLS.ON_PROD_DATE > ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DTTM THEN '-1'
                          ELSE DATEDIFF(DAY, STAGE_PRODVIEW_WELLS.ON_PROD_DATE, ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DTTM) + 1
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a308519a-6496-4e5b-87f5-02685cf423cd
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PRODUCING_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9124642d-d709-4ad5-b2ce-b2c6219cfc7f
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ON_PROD_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: COALESCE(TO_VARCHAR(STAGE_PRODVIEW_WELLS.ON_PROD_DATE, 'YYYYMMDD'), '-1')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e1ac81b-bc29-4a4f-a920-3848051bce3f
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: The cost centre which the reporting entity is representing.
        name: CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3499517-4f35-4f0e-b240-2c09ebb060a0
                stepCounter: a3aef473-15c0-437b-be53-6abfe8efbd45
            transform: COALESCE(STAGE_PRODVIEW_WELLS.CC_NUM, '-1')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55462506-2408-4e57-b322-a5123523fa60
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: HOURS_ON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 565c3190-bc88-4ecf-8f99-070028fb908c
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DUROP * 24
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c3b3b31-ebc3-4d5a-bc93-b628364c4654
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: HOURS_DOWN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b51b4b24-93e1-450a-abda-190776b9def9
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DURDOWN * 24
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d232d99a-150d-4666-96e4-a24d39218fad
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: HCLIQ_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b6b20f3-9f73-47b5-a4df-f8b9057701a4
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e4048a2-1aa1-4faa-b095-2de94f267329
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: OIL_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: df8227d7-e4da-48dc-bbbb-a78efd7d5222
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69efbf5a-1276-4f50-bb95-636666a718ad
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: CONDENSATE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c5fca28-94ef-448e-b2e0-838077a34aed
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2169ee54-6a44-4e8d-a490-e0006edad837
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: NGL_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: df70d956-fdfb-4dba-b4c2-65a18edbad0d
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eeab01ae-6673-408a-b759-12345dc4bb77
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f96f380d-7eb3-47f2-975c-41a32d8492bb
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: |-
              CASE WHEN STAGE_PRODVIEW_WELLS.QBYTE_PROVINCE_DISTRICT = 'BRITISH COLUMBIA' THEN (ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.VOLDISPSALEGAS * COALESCE((ODS_PVIEW_PVT_PVUNITMETERRATEENTRY.RATE/100), 1))/1000
                          ELSE ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.VOLDISPSALEGAS/1000
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 085ef23f-67da-4045-8b55-ae805ecab31c
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2646e70d-b224-47d9-9163-9947b02a22d5
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: SAND_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ae9af6c-1d70-4d45-bff6-91b2754313ae
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 582fb4b6-5d5d-4a60-9a06-cfee4424049c
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_HCLIQ_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d4fcdfd-12da-451a-aa2f-95a0b72a0c48
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_SAND_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 58bd9e52-50a9-413b-a604-3cef5ad3718a
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae28cf6c-851b-4e87-b76c-4021a29dc8ee
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: RECOVERED_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2426da9b-195f-4257-99f9-7637692bccdf
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: RECOVERED_HCLIQ_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f58b0de-c164-47db-929a-ce6582fa9215
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: RECOVERED_SAND_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ebc8f12-72c7-436a-9fcf-5094c61f1c3f
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: RECOVERED_WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be6b55d4-7396-430d-97c9-7cdb031d4995
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: REMAINING_LIFT_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c28ac24e-8d87-425b-ac68-b9734762a951
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: REMAINING_LOAD_HCLIQ_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e917eb14-bbd3-4f08-9fae-0373160eb6ab
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: REMAINING_LOAD_WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c980545-172f-4048-89a5-c4e9dfeec6f2
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: REMAINING_LOAD_SAND_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff531b79-8025-4260-abca-360632c55a79
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: METHANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94aa6087-ae76-4a76-bf24-a5dff9fdbd54
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: ETHANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b871d6c-7126-4af2-85d7-e6cefd99801c
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: PROPANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b80a30d-c4cd-435f-bfc3-3b1ed4e78971
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: BUTANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f556b4fd-6ca0-4416-9576-f297591f52f0
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: PENTANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ddc91177-a586-43b2-93dd-87bc66f3189b
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WIGAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c20e0f47-3157-4ac3-b43f-71f5fe1a075d
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6d5d468-18c4-495e-a09f-d0d622f0c09e
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WIHCLIQ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56af0ab0-f80f-4382-9236-5939ab19ee61
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 918180e6-2aa8-49a6-bf42-ef65c4e696f3
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WISAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc98fd8d-12e4-4909-875b-d54734241f4a
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0738bd55-a5d2-46f7-a69d-ea4794c4381f
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WIWATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60f030ec-4d2a-43f6-ab43-1b5e3ad5523b
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6906af5-e15e-49ed-b83f-8c79add731f2
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: FLAREGAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 46b0cc6c-451b-4993-a395-a430a1e5c639
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: VENTGAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72e95757-3d99-442c-b983-e86107ae6163
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: FUELGAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2676f8c3-b561-4300-add2-d77c570410d2
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: BAT_PRO_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ea09be9-23f2-4136-a371-66cddca2ae1a
          stepCounter: ea0cbd5e-a2b4-4668-85a4-b858eee90e42
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_LIFT_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY: b78e68df-21f7-427c-9ce7-426d1d304567
          STAGE_PRODVIEW_WELLS: a3aef473-15c0-437b-be53-6abfe8efbd45
          ODS_PVIEW_PVT_PVUNITDISPMONTHDAY: 1daa6538-d61f-42cb-8ade-361a2b4e661e
          ODS_PVIEW_PVT_PVUNITNODE: 41be665a-471a-4369-9504-43fe682f5f4f
          ODS_PVIEW_PVT_PVUNITMETERRATEENTRY: e0f8bbf5-fbc2-4469-8dab-6c0f0e6dd206
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY
          - locationName: TARGET
            nodeName: STAGE_PRODVIEW_WELLS
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITDISPMONTHDAY
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITNODE
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITMETERRATEENTRY
        join:
          joinCondition: |-
            FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY') }} ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY
              JOIN {{ ref('TARGET','STAGE_PRODVIEW_WELLS') }} STAGE_PRODVIEW_WELLS
                ON ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.IDFLOWNET = STAGE_PRODVIEW_WELLS.IDFLOWNET
               AND ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.IDRECUNIT = STAGE_PRODVIEW_WELLS.ENTITY_KEY
              LEFT JOIN (
                    SELECT ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDFLOWNET,
                           ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDRECUNIT,
                           ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.DTTM AS ACTIVITY_DATE,
                           SUM(NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLC1LIQ, 0)) AS METHANE_METRIC,
                           SUM(NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLC2LIQ, 0)) AS ETHANE_METRIC,
                           SUM(NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLC3LIQ, 0)) AS PROPANE_METRIC,
                           SUM(NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLIC4LIQ, 0) + NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLNC4LIQ, 0)) AS BUTANE_METRIC,
                           SUM(NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLIC5LIQ, 0) + NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLNC5LIQ, 0) + NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLC6LIQ, 0) + NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLC7LIQ, 0)) AS PENTANE_METRIC
                      FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITDISPMONTHDAY') }} ODS_PVIEW_PVT_PVUNITDISPMONTHDAY
                      LEFT JOIN {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITNODE') }} ODS_PVIEW_PVT_PVUNITNODE
                        ON ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDRECDISPUNITNODE = ODS_PVIEW_PVT_PVUNITNODE.IDREC
                       AND ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDFLOWNET = ODS_PVIEW_PVT_PVUNITNODE.IDFLOWNET
                       AND ODS_PVIEW_PVT_PVUNITNODE.DSS_CURRENT_FLAG = 'Y'
                       AND ODS_PVIEW_PVT_PVUNITNODE.DSS_DELETE_FLAG != 'Y'
                     WHERE ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.DSS_CURRENT_FLAG = 'Y'
                       AND ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.DSS_DELETE_FLAG != 'Y'
                       AND ODS_PVIEW_PVT_PVUNITNODE.TYPDISPHCLIQ = 'ngl'
                     GROUP BY ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDFLOWNET,
                              ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDRECUNIT,
                              ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.DTTM
                   ) ODS_PVIEW_PVT_PVUNITDISPMONTHDAY
                ON ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.IDRECUNIT = ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDRECUNIT
               AND ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DTTM = ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.ACTIVITY_DATE
               AND ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.IDFLOWNET = ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDFLOWNET
              LEFT JOIN (
                    SELECT DTTM AS START_DATE,
                           COALESCE(DATEADD(DAY, -1, LEAD(DTTM) OVER (ORDER BY DTTM)), '2999-12-31') AS END_DATE,
                           RATE
                      FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITMETERRATEENTRY') }} ODS_PVIEW_PVT_PVUNITMETERRATEENTRY
                     WHERE ODS_PVIEW_PVT_PVUNITMETERRATEENTRY.IDRECPARENT = 'B4E41CDA995F4FD0BDEF2233B7D9D8B8'
                       AND ODS_PVIEW_PVT_PVUNITMETERRATEENTRY.DSS_CURRENT_FLAG = 'Y'
                       AND ODS_PVIEW_PVT_PVUNITMETERRATEENTRY.DSS_DELETE_FLAG != 'Y'
                   ) ODS_PVIEW_PVT_PVUNITMETERRATEENTRY
                ON ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DTTM BETWEEN ODS_PVIEW_PVT_PVUNITMETERRATEENTRY.START_DATE AND ODS_PVIEW_PVT_PVUNITMETERRATEENTRY.END_DATE
             WHERE ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DSS_CURRENT_FLAG = 'Y'
               AND ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DSS_DELETE_FLAG != 'Y'
        name: STAGE_PRODVIEW_SALES_VOLUMES
        noLinkRefs: []
  name: STAGE_PRODVIEW_SALES_VOLUMES
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
