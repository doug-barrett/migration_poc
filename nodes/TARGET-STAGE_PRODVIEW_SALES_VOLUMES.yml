fileVersion: 1
id: a258c640-2ef1-4faf-a7a3-956d9509f1e5
name: STAGE_PRODVIEW_SALES_VOLUMES
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "Prodview sales volumes"
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95f7e162-f9dc-42af-8cad-9fa5246e89a8
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: IDRECUNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52601fc0-68e1-4e5f-876a-00645d2f467e
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6520e5a8-bfa2-4ab5-9707-3fc9313b07b0
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: IDFLOWNET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e63ff1c0-dd08-4f41-8d3f-2e5a1b550560
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef1e2d39-b91f-48d7-aa2c-ce821aa90bcb
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ENTITY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 66fb5299-e0ba-46ea-9fd9-f602d14f76c8
                stepCounter: e3f3cfdf-bda2-498e-bd55-26e7262626ae
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f5a093b-aa8a-4691-a89d-fa385cc2d86c
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SCENARIO_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: "'pv_sales'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7cb6814c-2893-4ea2-a6e6-2b86969edc2a
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ACTIVITY_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e23862e-5f1c-4ceb-9ed3-26e0c07e30fc
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: TO_VARCHAR(ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DTTM, 'YYYYMMDD')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9c3cd03-e952-4390-bfaf-2f590e54c405
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: ACTIVITY_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e23862e-5f1c-4ceb-9ed3-26e0c07e30fc
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f3ef3d5-b939-459f-9428-7474093a0faa
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: NORMALIZED_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d0a1178d-0a76-4a6d-987d-882feb580e1c
                stepCounter: e3f3cfdf-bda2-498e-bd55-26e7262626ae
            transform: |-
              CASE WHEN STAGE_PRODVIEW_WELLS.ON_PROD_DATE IS NULL                                  THEN '-1'
                          WHEN STAGE_PRODVIEW_WELLS.ON_PROD_DATE > ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DTTM THEN '-1'
                          ELSE DATEDIFF(DAY, STAGE_PRODVIEW_WELLS.ON_PROD_DATE, ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DTTM) + 1
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f8c13722-5055-4e20-a720-d9d6f7f16f4b
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PRODUCING_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 910d8cf8-b5ec-4dc0-b26f-155d02691884
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ON_PROD_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: COALESCE(TO_VARCHAR(STAGE_PRODVIEW_WELLS.ON_PROD_DATE, 'YYYYMMDD'), '-1')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20cc9c82-a0b4-42a6-b267-8771ad4ef9d0
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: The cost centre which the reporting entity is representing.
        name: CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cdb42138-383e-4153-8935-35b2b72dc8fe
                stepCounter: e3f3cfdf-bda2-498e-bd55-26e7262626ae
            transform: COALESCE(STAGE_PRODVIEW_WELLS.CC_NUM, '-1')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b03bb62b-ba75-4725-8e24-9f1144428f32
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: HOURS_ON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 81e344fc-8e1c-48b6-b2a3-4528e7962c25
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DUROP * 24
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7bfff807-fa4c-4c20-a06e-5eb3bb188702
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: HOURS_DOWN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 849b0441-aadd-4df8-aa0c-bef157b937d0
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DURDOWN * 24
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7de1a51e-3d7c-4e2a-848b-55a5e7ec4d86
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: HCLIQ_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1404312c-191a-47dd-9a05-c4d1fc03bbfe
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e3667f9-4aa1-447a-a8ac-88b4fd6570c8
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: OIL_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a5bc6af6-14d2-4725-8967-627facbf6d90
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5ad0344-07f8-4752-a4de-ca5b476779c0
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: CONDENSATE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 667109dd-dffe-482b-976b-cc575864659c
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ddf5643-fe70-4c5c-9a72-a4f9ecf451a7
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: NGL_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 53ec82b5-c47f-48d4-9bc6-38d805db3540
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b6469c2-0678-4565-8679-e5ee2f03c48e
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d45c7338-2024-4d1a-8b92-7f44ab79633b
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: |-
              CASE WHEN STAGE_PRODVIEW_WELLS.QBYTE_PROVINCE_DISTRICT = 'BRITISH COLUMBIA' THEN (ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.VOLDISPSALEGAS * COALESCE((ODS_PVIEW_PVT_PVUNITMETERRATEENTRY.RATE/100), 1))/1000
                          ELSE ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.VOLDISPSALEGAS/1000
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a427c1f-a4f3-41f6-b86b-d887b7fc4deb
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a4dc77d-c7a2-4c69-b538-09520a2b0457
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: SAND_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e2f51df-b1f5-413f-a913-223374e112b4
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ea53186-aa9e-44ad-ac82-43d85af441f3
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_HCLIQ_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e341231-e003-4744-960d-000ba0835d21
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_SAND_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29ba3ebe-3ae8-4395-8874-69229566d2ed
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 46accd27-dc6e-45ef-8a6a-12f21845070f
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: RECOVERED_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee184b52-c191-4b35-81a6-883e49fbeb66
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: RECOVERED_HCLIQ_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ae6afd9-cb43-40cd-92db-af53825cffd6
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: RECOVERED_SAND_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e00ac699-6f42-4f8b-b47b-5a76c743bf78
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: RECOVERED_WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a356c457-3a25-44eb-83ef-75d0fa28e3fd
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: REMAINING_LIFT_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f3a852b-1470-4af1-9957-566d07c049d4
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: REMAINING_LOAD_HCLIQ_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 58e3c568-38bb-4848-ae6c-77e139efe692
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: REMAINING_LOAD_WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e76dfa31-461e-4b9c-8bb6-015a93e1981e
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: REMAINING_LOAD_SAND_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 645e08db-fdc8-4c8f-86a9-5c4bdcdfffa7
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: METHANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c7ac5dfe-0bd1-477e-87a4-e2618cd5cc03
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: ETHANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a68bbba9-c659-4890-81ca-8433dd8d3226
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: PROPANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80d44444-9218-4009-af8b-649afb0b9772
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: BUTANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: afd3a603-df67-4ca4-9482-806b7f7e611b
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: PENTANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba2141a6-3e97-4faa-83c5-f1f19fd4b163
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WIGAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef135fd3-29ca-4192-ae3c-b84d4a82b57c
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3aecb85a-fb39-49c2-9c02-0111a7b10df3
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WIHCLIQ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1025f801-aa3b-4996-9bb3-4e2358493c31
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d7a625b-e2b3-4c70-8732-1728b56659c3
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WISAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e04651b-53ca-49bb-82ef-835c27428375
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3307ee1-f326-44e0-b270-d96f5a29b144
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WIWATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c2fb5b3-ff9c-4ae0-995e-e6dc900f95ec
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9cd3fdee-1dd1-4c84-ba9e-3ff961b70a2d
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: FLAREGAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2db3a385-6369-49b5-b470-dadd287e0b60
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: VENTGAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c596a93d-75ba-48dc-a716-88fae711f8c0
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: FUELGAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e353eea5-8287-4f30-9bcf-09cf006f1c9c
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: BAT_PRO_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 089e5c81-cd64-4b76-b796-8961403078e7
          stepCounter: a258c640-2ef1-4faf-a7a3-956d9509f1e5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_LIFT_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY: d08539ff-37af-4c21-9836-963dca56c39d
          STAGE_PRODVIEW_WELLS: e3f3cfdf-bda2-498e-bd55-26e7262626ae
          ODS_PVIEW_PVT_PVUNITDISPMONTHDAY: e1eaab03-46d0-47c5-afef-a1e386773c58
          ODS_PVIEW_PVT_PVUNITNODE: 0cc17ffa-ae19-4239-8958-77363f7b8a14
          ODS_PVIEW_PVT_PVUNITMETERRATEENTRY: ee560145-11c8-45e0-a0b4-b9b7c78225d6
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY
          - locationName: TARGET
            nodeName: STAGE_PRODVIEW_WELLS
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITDISPMONTHDAY
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITNODE
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITMETERRATEENTRY
        join:
          joinCondition: |-
            FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY') }} ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY
              JOIN {{ ref('TARGET','STAGE_PRODVIEW_WELLS') }} STAGE_PRODVIEW_WELLS
                ON ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.IDFLOWNET = STAGE_PRODVIEW_WELLS.IDFLOWNET
               AND ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.IDRECUNIT = STAGE_PRODVIEW_WELLS.ENTITY_KEY
              LEFT JOIN (
                    SELECT ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDFLOWNET,
                           ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDRECUNIT,
                           ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.DTTM AS ACTIVITY_DATE,
                           SUM(NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLC1LIQ, 0)) AS METHANE_METRIC,
                           SUM(NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLC2LIQ, 0)) AS ETHANE_METRIC,
                           SUM(NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLC3LIQ, 0)) AS PROPANE_METRIC,
                           SUM(NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLIC4LIQ, 0) + NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLNC4LIQ, 0)) AS BUTANE_METRIC,
                           SUM(NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLIC5LIQ, 0) + NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLNC5LIQ, 0) + NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLC6LIQ, 0) + NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLC7LIQ, 0)) AS PENTANE_METRIC
                      FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITDISPMONTHDAY') }} ODS_PVIEW_PVT_PVUNITDISPMONTHDAY
                      LEFT JOIN {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITNODE') }} ODS_PVIEW_PVT_PVUNITNODE
                        ON ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDRECDISPUNITNODE = ODS_PVIEW_PVT_PVUNITNODE.IDREC
                       AND ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDFLOWNET = ODS_PVIEW_PVT_PVUNITNODE.IDFLOWNET
                       AND ODS_PVIEW_PVT_PVUNITNODE.DSS_CURRENT_FLAG = 'Y'
                       AND ODS_PVIEW_PVT_PVUNITNODE.DSS_DELETE_FLAG != 'Y'
                     WHERE ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.DSS_CURRENT_FLAG = 'Y'
                       AND ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.DSS_DELETE_FLAG != 'Y'
                       AND ODS_PVIEW_PVT_PVUNITNODE.TYPDISPHCLIQ = 'ngl'
                     GROUP BY ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDFLOWNET,
                              ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDRECUNIT,
                              ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.DTTM
                   ) ODS_PVIEW_PVT_PVUNITDISPMONTHDAY
                ON ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.IDRECUNIT = ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDRECUNIT
               AND ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DTTM = ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.ACTIVITY_DATE
               AND ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.IDFLOWNET = ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDFLOWNET
              LEFT JOIN (
                    SELECT DTTM AS START_DATE,
                           COALESCE(DATEADD(DAY, -1, LEAD(DTTM) OVER (ORDER BY DTTM)), '2999-12-31') AS END_DATE,
                           RATE
                      FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITMETERRATEENTRY') }} ODS_PVIEW_PVT_PVUNITMETERRATEENTRY
                     WHERE ODS_PVIEW_PVT_PVUNITMETERRATEENTRY.IDRECPARENT = 'B4E41CDA995F4FD0BDEF2233B7D9D8B8'
                       AND ODS_PVIEW_PVT_PVUNITMETERRATEENTRY.DSS_CURRENT_FLAG = 'Y'
                       AND ODS_PVIEW_PVT_PVUNITMETERRATEENTRY.DSS_DELETE_FLAG != 'Y'
                   ) ODS_PVIEW_PVT_PVUNITMETERRATEENTRY
                ON ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DTTM BETWEEN ODS_PVIEW_PVT_PVUNITMETERRATEENTRY.START_DATE AND ODS_PVIEW_PVT_PVUNITMETERRATEENTRY.END_DATE
             WHERE ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DSS_CURRENT_FLAG = 'Y'
               AND ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DSS_DELETE_FLAG != 'Y'
        name: STAGE_PRODVIEW_SALES_VOLUMES
        noLinkRefs: []
  name: STAGE_PRODVIEW_SALES_VOLUMES
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
