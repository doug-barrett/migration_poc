fileVersion: 1
id: 30d1df32-0342-4022-8fe4-a2b8cbf6629d
name: STAGE_BUDGET_EXP_GLOP_BUDGET_FVW
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "Budget Export Staging table for direct load into BI_REPORT.GLOP_BUDGET_FVW@BIPR"
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74c1cfcc-8da8-4bd2-9d33-a5cdc3a289e2
          stepCounter: 30d1df32-0342-4022-8fe4-a2b8cbf6629d
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: VERSION_NAME
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b412e829-c643-4d0f-b852-d3e4a09ea6fa
          stepCounter: 30d1df32-0342-4022-8fe4-a2b8cbf6629d
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ACCT_DATE
        name: ACCT_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_CHAR(FACT_LO_BUDGET.DIM_ACCT_PER_DATE,'YYYY-MM-DD')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 900cd11c-c6ff-465d-9920-a6a556bc7525
          stepCounter: 30d1df32-0342-4022-8fe4-a2b8cbf6629d
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ACTVY_DATE
        name: ACTVY_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_CHAR(FACT_LO_BUDGET.DIM_ACTVY_PER_DATE,'YYYY-MM-DD')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86e634df-d0be-4bb0-86f8-df3d912d83d3
          stepCounter: 30d1df32-0342-4022-8fe4-a2b8cbf6629d
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ACCOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: DECODE(DIM_LO_GL_ACCOUNT.DIM_GL_ACCOUNT_KEY,0,NULL,DIM_LO_GL_ACCOUNT.ACCOUNT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4821955a-4df9-494a-85fa-688f179c064e
          stepCounter: 30d1df32-0342-4022-8fe4-a2b8cbf6629d
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: MAJOR_ACCOUNT
        name: MAJOR_ACCOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: DECODE(DIM_LO_GL_ACCOUNT.DIM_GL_ACCOUNT_KEY,0,NULL,DIM_LO_GL_ACCOUNT.MAJOR_ACCT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a48ee74-dd1d-4329-9ef0-9fcc4cc0abf3
          stepCounter: 30d1df32-0342-4022-8fe4-a2b8cbf6629d
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: MINOR ACCOUNT
        name: MINOR_ACCOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: DECODE(DIM_LO_GL_ACCOUNT.DIM_GL_ACCOUNT_KEY,0,NULL,DIM_LO_GL_ACCOUNT.MINOR_ACCT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9958636-32ee-43f8-90f2-7484675423fa
          stepCounter: 30d1df32-0342-4022-8fe4-a2b8cbf6629d
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: AFE_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: DECODE(DIM_LO_AFE_TYPE.DIM_AFE_TYPE_KEY,0,NULL,DIM_LO_AFE_TYPE.AFE_TYPE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a17d747-d200-4773-82eb-cbcff32ef5da
          stepCounter: 30d1df32-0342-4022-8fe4-a2b8cbf6629d
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: VARIABLE_NAME
        name: VARIABLE_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: INITCAP(DECODE(DIM_LO_AFE_TYPE.DIM_AFE_TYPE_KEY,0,DECODE(DIM_LO_GL_ACCOUNT.DIM_GL_ACCOUNT_KEY,0,NULL,DIM_LO_GL_ACCOUNT.ACCT_DESC), DIM_LO_AFE_TYPE.AFE_TYPE_DESC))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39b1327b-6432-4ac3-bdb2-4f52c76c128a
          stepCounter: 30d1df32-0342-4022-8fe4-a2b8cbf6629d
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: VAR_MATCH_NAME
        name: VAR_MATCH_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: DECODE(DIM_LO_AFE_TYPE.DIM_AFE_TYPE_KEY,0,DECODE(DIM_LO_GL_ACCOUNT.DIM_GL_ACCOUNT_KEY,0,NULL,DIM_LO_GL_ACCOUNT.ACCT_DESC), DIM_LO_AFE_TYPE.AFE_TYPE_DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a476bd56-d6fb-4057-9a16-92ff91287a47
          stepCounter: 30d1df32-0342-4022-8fe4-a2b8cbf6629d
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Indicates amounts are gross or net.
        name: GROSS_OR_NET_CODE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: DECODE(DIM_LO_GROSS_NET.DIM_GROSS_NET_KEY,0,NULL,DIM_LO_GROSS_NET.GROSS_OR_NET_CODE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d9d4d11-24a6-4857-96f3-26f14bed4e2b
          stepCounter: 30d1df32-0342-4022-8fe4-a2b8cbf6629d
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: COST_CENTRE
        name: COST_CENTRE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: DECODE(DIM_LO_COST_CENTER.DIM_COST_CENTER_KEY,0,NULL,DIM_LO_COST_CENTER.CC_NUM)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ed05487-8e89-497f-9a10-a35b691538e5
          stepCounter: 30d1df32-0342-4022-8fe4-a2b8cbf6629d
        config: {}
        dataType: NUMBER(4)
        defaultValue: ""
        description: ""
        name: ORG_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6cf519a-519c-4800-9c12-00fb82d27dc2
          stepCounter: 30d1df32-0342-4022-8fe4-a2b8cbf6629d
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: Organization Country
        name: COUNTRY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1154ab96-709c-43c7-96f6-5152f025f6aa
          stepCounter: 30d1df32-0342-4022-8fe4-a2b8cbf6629d
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: CAD_AMOUNT
        name: CAD_AMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: SUM(NVL(FACT_LO_BUDGET.CAD_AMT,0))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 245ca27b-dbd9-431f-96fc-7c3bfc93c387
          stepCounter: 30d1df32-0342-4022-8fe4-a2b8cbf6629d
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ACCT_GROUP_CODE
        name: ACCT_GROUP_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: DECODE(DIM_LO_GL_ACCOUNT.DIM_GL_ACCOUNT_KEY,0,'x',DIM_LO_GL_ACCOUNT.ACCT_GROUP_CODE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ffeaab47-479a-4928-bc03-8e45b17280c9
          stepCounter: 30d1df32-0342-4022-8fe4-a2b8cbf6629d
        config: {}
        dataType: NUMBER(1)
        defaultValue: ""
        description: 'FACT_LEASE_OPS FLIPSIGN '
        name: FLIPSIGN
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: NVL(DECODE(NVL(DIM_LO_LEASE_OPS_HIER_AFE.DIM_LEASE_OPS_HIER_KEY,0),0,DIM_LO_LEASE_OPS_HIER_GL.FLIPSIGN,DIM_LO_LEASE_OPS_HIER_AFE.FLIPSIGN),1)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc4ebcb8-eefa-43c7-8f75-de7304304b56
          stepCounter: 30d1df32-0342-4022-8fe4-a2b8cbf6629d
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: OPERATING_AMOUNT
        name: OPERATING_AMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: SUM(NVL(FACT_LO_BUDGET.OP_AMT,0))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04ab9ea4-3c9c-46a3-b3dd-da4d071748ee
          stepCounter: 30d1df32-0342-4022-8fe4-a2b8cbf6629d
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: METRIC_VOLUME
        name: METRIC_VOLUME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: SUM(NVL(FACT_LO_BUDGET.LI_VOL_M3,0)*NVL(DECODE(NVL(DIM_LO_LEASE_OPS_HIER_AFE.DIM_LEASE_OPS_HIER_KEY,0),0,DIM_LO_LEASE_OPS_HIER_GL.FLIPSIGN,DIM_LO_LEASE_OPS_HIER_AFE.FLIPSIGN),1))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b59d681-6a1f-4226-a246-b7bace444ae6
          stepCounter: 30d1df32-0342-4022-8fe4-a2b8cbf6629d
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: METRIC_NORMALIZED_VOLUME
        name: METRIC_NORMALIZED_VOLUME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: SUM(NVL(FACT_LO_BUDGET.LI_VOL_NM3,0)*NVL(DECODE(NVL(DIM_LO_LEASE_OPS_HIER_AFE.DIM_LEASE_OPS_HIER_KEY,0),0,DIM_LO_LEASE_OPS_HIER_GL.FLIPSIGN,DIM_LO_LEASE_OPS_HIER_AFE.FLIPSIGN),1))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b129418-e1b3-4741-a308-782e1435747e
          stepCounter: 30d1df32-0342-4022-8fe4-a2b8cbf6629d
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: IMPERIAL_VOLUME
        name: IMPERIAL_VOLUME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: SUM(NVL(FACT_LO_BUDGET.LI_VOL_IMPERIAL,0)*NVL(DECODE(NVL(DIM_LO_LEASE_OPS_HIER_AFE.DIM_LEASE_OPS_HIER_KEY,0),0,DIM_LO_LEASE_OPS_HIER_GL.FLIPSIGN,DIM_LO_LEASE_OPS_HIER_AFE.FLIPSIGN),1))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0cf5c45-be2c-49e4-b3e1-1400723da78b
          stepCounter: 30d1df32-0342-4022-8fe4-a2b8cbf6629d
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: BOE_VOLUME
        name: BOE_VOLUME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: SUM(NVL(FACT_LO_BUDGET.LI_VOL_BOE,0)*NVL(DECODE(NVL(DIM_LO_LEASE_OPS_HIER_AFE.DIM_LEASE_OPS_HIER_KEY,0),0,DIM_LO_LEASE_OPS_HIER_GL.FLIPSIGN,DIM_LO_LEASE_OPS_HIER_AFE.FLIPSIGN),1))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 52b007f9-cc1f-4f03-b91b-26ae175c8af1
          stepCounter: 30d1df32-0342-4022-8fe4-a2b8cbf6629d
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: OPERATING_CURRENCY
        name: OPERATING_CURRENCY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: DIM_LO_BUDGET_VERSION
          - locationName: UNKNOWN
            nodeName: FACT_LO_BUDGET
          - locationName: UNKNOWN
            nodeName: DIM_LO_BUDGET_VERSION
          - locationName: UNKNOWN
            nodeName: DIM_LO_AFE_TYPE
          - locationName: UNKNOWN
            nodeName: DIM_LO_COST_CENTER
          - locationName: UNKNOWN
            nodeName: DIM_LO_DEST_ORGANIZATION
          - locationName: UNKNOWN
            nodeName: DIM_LO_GL_ACCOUNT
          - locationName: UNKNOWN
            nodeName: DIM_LO_GROSS_NET
          - locationName: UNKNOWN
            nodeName: DIM_LO_LEASE_OPS_HIER
        join:
          joinCondition: |-
            FROM {{ ref('UNKNOWN','FACT_LO_BUDGET') }} FACT_LO_BUDGET
              JOIN {{ ref('UNKNOWN','DIM_LO_BUDGET_VERSION') }} DIM_LO_BUDGET_VERSION
                ON FACT_LO_BUDGET.DIM_BUDGET_VERSION_KEY = DIM_LO_BUDGET_VERSION.DIM_BUDGET_VERSION_KEY
              JOIN {{ ref('UNKNOWN','DIM_LO_AFE_TYPE') }} DIM_LO_AFE_TYPE
                ON FACT_LO_BUDGET.DIM_AFE_TYPE_KEY = DIM_LO_AFE_TYPE.DIM_AFE_TYPE_KEY
              JOIN {{ ref('UNKNOWN','DIM_LO_COST_CENTER') }} DIM_LO_COST_CENTER
                ON FACT_LO_BUDGET.DIM_COST_CENTER_KEY = DIM_LO_COST_CENTER.DIM_COST_CENTER_KEY
              JOIN {{ ref('UNKNOWN','DIM_LO_DEST_ORGANIZATION') }} DIM_LO_DEST_ORGANIZATION
                ON FACT_LO_BUDGET.DIM_DEST_ORGANIZATION_KEY = DIM_LO_DEST_ORGANIZATION.DIM_DEST_ORGANIZATION_KEY
              JOIN {{ ref('UNKNOWN','DIM_LO_GL_ACCOUNT') }} DIM_LO_GL_ACCOUNT
                ON FACT_LO_BUDGET.DIM_GL_ACCOUNT_KEY = DIM_LO_GL_ACCOUNT.DIM_GL_ACCOUNT_KEY
              JOIN {{ ref('UNKNOWN','DIM_LO_GROSS_NET') }} DIM_LO_GROSS_NET
                ON FACT_LO_BUDGET.DIM_GROSS_NET_KEY = DIM_LO_GROSS_NET.DIM_GROSS_NET_KEY
              LEFT JOIN {{ ref('UNKNOWN','DIM_LO_LEASE_OPS_HIER') }} DIM_LO_LEASE_OPS_HIER_GL
                ON DIM_LO_GL_ACCOUNT.LINE_NO = DIM_LO_LEASE_OPS_HIER_GL.LINE_NO
              LEFT JOIN {{ ref('UNKNOWN','DIM_LO_LEASE_OPS_HIER') }} DIM_LO_LEASE_OPS_HIER_AFE
                ON DIM_LO_AFE_TYPE.LINE_NO = DIM_LO_LEASE_OPS_HIER_AFE.LINE_NO
             WHERE FACT_LO_BUDGET.DIM_COST_CENTER_KEY <> 0
               AND (NVL(FACT_LO_BUDGET.CAD_AMT,0)+NVL(FACT_LO_BUDGET.LI_VOL,0) <> 0)
             GROUP BY DIM_LO_BUDGET_VERSION.VERSION_NAME ,
                      FACT_LO_BUDGET.DIM_ACCT_PER_DATE ,
                      FACT_LO_BUDGET.DIM_ACTVY_PER_DATE ,
                      DIM_LO_GL_ACCOUNT.ACCOUNT ,
                      DIM_LO_GL_ACCOUNT.MAJOR_ACCT ,
                      DIM_LO_GL_ACCOUNT.MINOR_ACCT ,
                      DIM_LO_AFE_TYPE.AFE_TYPE ,
                      DIM_LO_GL_ACCOUNT.ACCT_DESC ,
                      DIM_LO_AFE_TYPE.AFE_TYPE_DESC ,
                      DIM_LO_COST_CENTER.CC_NUM ,
                      DIM_LO_DEST_ORGANIZATION.ORG_ID ,
                      DIM_LO_DEST_ORGANIZATION.COUNTRY ,
                      DIM_LO_GL_ACCOUNT.ACCT_GROUP_CODE ,
                      DIM_LO_GL_ACCOUNT.DIM_GL_ACCOUNT_KEY ,
                      DIM_LO_GROSS_NET.GROSS_OR_NET_CODE ,
                      DIM_LO_GROSS_NET.DIM_GROSS_NET_KEY ,
                      DIM_LO_AFE_TYPE.DIM_AFE_TYPE_KEY ,
                      DIM_LO_COST_CENTER.DIM_COST_CENTER_KEY ,
                      DIM_LO_LEASE_OPS_HIER_AFE.DIM_LEASE_OPS_HIER_KEY ,
                      DIM_LO_LEASE_OPS_HIER_GL.FLIPSIGN ,
                      DIM_LO_LEASE_OPS_HIER_AFE.FLIPSIGN ,
                      FACT_LO_BUDGET.OP_CURR_CODE
        name: STAGE_BUDGET_EXP_GLOP_BUDGET_FVW
        noLinkRefs: []
  name: STAGE_BUDGET_EXP_GLOP_BUDGET_FVW
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
