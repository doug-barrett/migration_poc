fileVersion: 1
id: cc2cad72-944d-49ba-9ced-d91986548e7c
name: DS_REFERRAL
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4221bebd-453f-438d-951c-50152ec4f7d9
          stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e47bccbb-14d6-4b95-85b6-1eb2631bbf04
                stepCounter: f97f8e5e-0ae0-4c06-a387-0eca3d61bd7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: deb8da7a-8449-4fae-b16b-37c9059e8782
          stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: EXTERNALID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a532532-a7fd-42fb-8557-78a0d73e8678
                stepCounter: f97f8e5e-0ae0-4c06-a387-0eca3d61bd7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e99d8a1-3154-4e2a-be74-c573892807f9
          stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: DHBID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bb010615-cdd6-4fe2-b1f5-a0d1ee56d39e
                stepCounter: f97f8e5e-0ae0-4c06-a387-0eca3d61bd7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91dda4f8-69e8-48e1-b5be-b5dcc883518b
          stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SERVICEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 052a0e07-69cb-47af-b3b2-6545486d57fd
                stepCounter: f97f8e5e-0ae0-4c06-a387-0eca3d61bd7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a53ebf80-19a9-4ea4-a49c-af778374a0dd
          stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: REFERREDFORID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ff44cbcd-7ecb-4c1e-9faf-d19fd421bc5c
                stepCounter: f97f8e5e-0ae0-4c06-a387-0eca3d61bd7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39e1a043-42ad-4abe-be1c-cc06334d9f74
          stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATIONDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b714cee0-7ea6-4945-a8cb-23348d539ede
                stepCounter: f97f8e5e-0ae0-4c06-a387-0eca3d61bd7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf48fd98-6990-4b30-8df0-1e1a275eae00
          stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SUBMISSIONDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 084e013d-46e9-4f4b-9d3a-1f95505e5ce2
                stepCounter: f97f8e5e-0ae0-4c06-a387-0eca3d61bd7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e7f8750-6cb8-4701-830d-098d4bddc9ad
          stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: PATIENTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b63cc410-5b8a-470c-b99c-74bd5dca92a1
                stepCounter: f97f8e5e-0ae0-4c06-a387-0eca3d61bd7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07db3478-2d2f-4bc3-9d7b-c7cc158ab660
          stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: PATIENTGIVENNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 41c61c46-a6af-40c2-ac06-063f3fc5b230
                stepCounter: f97f8e5e-0ae0-4c06-a387-0eca3d61bd7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a95315ca-13fd-4c08-ab5b-96a21ff01c12
          stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: PATIENTFAMILYNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e88f7e52-c38e-4647-b064-e53b230e1970
                stepCounter: f97f8e5e-0ae0-4c06-a387-0eca3d61bd7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b268a8d-5d3e-4cce-ba17-7639a6ead761
          stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PATIENTDOB
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: be7a9b3e-5d19-47c2-955c-c8e6eb14239a
                stepCounter: f97f8e5e-0ae0-4c06-a387-0eca3d61bd7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2427c57e-7562-4027-be74-32864a418d65
          stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: REFERRERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8747abfb-66b5-42a2-a06f-c33562483450
                stepCounter: f97f8e5e-0ae0-4c06-a387-0eca3d61bd7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 58cee981-61a3-4a4f-94fa-0b2336c53389
          stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: REFERRERIDTYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3edc0292-28e6-41de-8d7e-761983067413
                stepCounter: f97f8e5e-0ae0-4c06-a387-0eca3d61bd7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bdbbaae2-8987-43e0-998a-a06a2bd98af4
          stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: REFERRERGIVENNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d360bb39-f115-4141-805b-28a94d4fa38a
                stepCounter: f97f8e5e-0ae0-4c06-a387-0eca3d61bd7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 080722b2-6aa1-41fd-abbd-8a4f65083227
          stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: REFERRERFAMILYNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 87269604-ecff-4b33-83f0-3ce56acfa155
                stepCounter: f97f8e5e-0ae0-4c06-a387-0eca3d61bd7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e02f12e-8e53-4357-8bc0-825ec5d84ba6
          stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LASTUPDATEDDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddc3fc91-0bf6-4c6d-b1d3-51e47178d5e6
                stepCounter: f97f8e5e-0ae0-4c06-a387-0eca3d61bd7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ddda03f2-8654-4773-babe-a938e4c9e881
          stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: LASTUPDATEDUSER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d7bc67de-3ea9-4265-b1a7-ef1328f3f73d
                stepCounter: f97f8e5e-0ae0-4c06-a387-0eca3d61bd7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c55b0572-c36d-41da-afbb-b964e51afe2e
          stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: ACCELIGIBLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5bfbbcaf-79b8-4750-b4b7-2bb309d040bd
                stepCounter: f97f8e5e-0ae0-4c06-a387-0eca3d61bd7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34f39919-92d9-4ac4-8f7e-c3d175a365dc
          stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: ELIGIBILITYSTATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 216b8c75-cebb-4073-a77c-a6440379672e
                stepCounter: f97f8e5e-0ae0-4c06-a387-0eca3d61bd7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6936a89e-efb3-4afd-b7b4-ac2fd91a417a
          stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: RESIDENTIALDHB
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d4fa6f13-8196-4d65-a719-6755ce27bd8b
                stepCounter: f97f8e5e-0ae0-4c06-a387-0eca3d61bd7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0bc3eeaf-98e5-4a8b-a557-70c602a7caa3
          stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: PMSAPPLICATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d61c73ba-2f13-45d6-9085-21084a915477
                stepCounter: f97f8e5e-0ae0-4c06-a387-0eca3d61bd7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41c7c736-fb21-4874-8cff-1ad2bf318482
          stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LATESTHISTORYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8945b2cd-e8f7-4539-8f7b-5dd8cb61c6ff
                stepCounter: f97f8e5e-0ae0-4c06-a387-0eca3d61bd7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 63ca2900-5159-42e5-aa56-1ee2bdee6352
          stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: REFERRERMESSAGINGENABLED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc4ea253-0d78-4ea7-ac60-98d5aba994af
                stepCounter: f97f8e5e-0ae0-4c06-a387-0eca3d61bd7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f8a4107-b31e-4bfd-bd0f-546f8a85db5c
          stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: URGENCYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf7b1140-f328-44d4-adda-e8f61097dadf
                stepCounter: f97f8e5e-0ae0-4c06-a387-0eca3d61bd7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ffd4d8bb-82a3-445c-abcc-4a6a4c04ae34
          stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
        config: {}
        dataType: NVARCHAR(250)
        defaultValue: ""
        description: ""
        name: PATIENTADDRESSSTREET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4f85befc-ee37-493b-b1e6-3607233fd705
                stepCounter: f97f8e5e-0ae0-4c06-a387-0eca3d61bd7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9bb107b-5251-4343-83d3-34a88531461b
          stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
        config: {}
        dataType: NVARCHAR(250)
        defaultValue: ""
        description: ""
        name: PATIENTADDRESSSUBURB
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ea5c63e-9b83-40de-b414-14ac017e376d
                stepCounter: f97f8e5e-0ae0-4c06-a387-0eca3d61bd7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 832e977b-ca06-47db-bfeb-7ae4469ce9be
          stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
        config: {}
        dataType: NVARCHAR(250)
        defaultValue: ""
        description: ""
        name: PATIENTADDRESSCITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 40e7543f-eb78-485d-a0e5-bb57a33a7dbf
                stepCounter: f97f8e5e-0ae0-4c06-a387-0eca3d61bd7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb97214a-847e-48cf-9a17-27aea6f8dd71
          stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: PATIENTADDRESSPOSTCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0561f9ae-c0dc-4813-aac9-194e87aa31ac
                stepCounter: f97f8e5e-0ae0-4c06-a387-0eca3d61bd7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15f5bfae-43fe-4492-b198-eb4c1d01f581
          stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
        config: {}
        dataType: NVARCHAR(250)
        defaultValue: ""
        description: ""
        name: PATIENTADDRESSCOUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8d6c56f8-f533-478e-b4b4-d2cfd4619364
                stepCounter: f97f8e5e-0ae0-4c06-a387-0eca3d61bd7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59767766-e3be-44c2-9034-3df6f3a51174
          stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
        config: {}
        dataType: CHAR(3)
        defaultValue: ""
        description: ""
        name: PATIENTADDRESSTYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1b43a73-8b8f-4607-8d69-2d7556304697
                stepCounter: f97f8e5e-0ae0-4c06-a387-0eca3d61bd7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 167b6659-7224-4232-9e88-d8676098bbd7
          stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: REFERRALNUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fef0fe06-f251-452c-a69f-79f65a984e73
                stepCounter: f97f8e5e-0ae0-4c06-a387-0eca3d61bd7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 603f671c-e92b-4af7-a05c-7b5cd5367dba
          stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: REFERRERFACILITYHPI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a6fc491c-c33a-4fbf-a02e-afec37cf0440
                stepCounter: f97f8e5e-0ae0-4c06-a387-0eca3d61bd7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b98ac4e5-2575-43fb-ad58-c80f4c1471c8
          stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: COMPLETIONDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 452c61e5-b862-4e04-b427-cef876f7c920
                stepCounter: f97f8e5e-0ae0-4c06-a387-0eca3d61bd7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e02e7759-b3c8-41c7-aa4a-63b55b495407
          stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          L_REFERRAL: f97f8e5e-0ae0-4c06-a387-0eca3d61bd7e
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: L_REFERRAL
        join:
          joinCondition: FROM {{ ref('TGT','L_REFERRAL') }} l_Referral
        name: DS_REFERRAL
        noLinkRefs: []
  name: DS_REFERRAL
  overrideSQL: false
  schema: ""
  sqlType: '38'
  type: sql
  version: 1
type: Node
