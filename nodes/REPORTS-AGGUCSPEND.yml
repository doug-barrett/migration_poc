fileVersion: 1
id: b0bde1c0-2b67-49d3-a8f1-c4c80d36ad6e
name: AGGUCSPEND
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: REPORTS
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf26403b-38ce-4e2a-9da0-8f60b64259ea
          stepCounter: b0bde1c0-2b67-49d3-a8f1-c4c80d36ad6e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.CAMPUS=UCCAMPUS.UCCAMPUS
        isBusinessKey: true
        name: UCCAMPUSKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d1f6493-0d18-42c1-949c-58883c1697b7
                stepCounter: 98a60354-5e68-47cb-92c8-afd3b94a93be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb93d577-9a17-461a-b9c8-07fa65618eeb
          stepCounter: b0bde1c0-2b67-49d3-a8f1-c4c80d36ad6e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.CATEGORY_LEVEL_1=UCCATEGORYLEVEL1.UCCATEGORY_LEVEL_1
        isBusinessKey: true
        name: UCCATEGORYLEVEL1KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59050221-8243-4b0c-8ab9-53e15408e630
                stepCounter: 15fcb3a7-6ad4-461c-b52a-ed4323a75995
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 339d6530-7bfa-4fa3-8d3b-452b5417a224
          stepCounter: b0bde1c0-2b67-49d3-a8f1-c4c80d36ad6e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.CATEGORY_LEVEL_2=UCCATEGORYLEVEL2.UCCATEGORY_LEVEL_2
        isBusinessKey: true
        name: UCCATEGORYLEVEL2KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a9dbd2c1-8d2c-4c41-93b1-a7d0786cbe96
                stepCounter: 52316990-541b-4857-8695-a778480c8b5f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c851b71c-0751-4b64-a737-53e2a2d28eeb
          stepCounter: b0bde1c0-2b67-49d3-a8f1-c4c80d36ad6e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.CATEGORY_LEVEL_3=UCCATEGORYLEVEL3.UCCATEGORY_LEVEL_3
        isBusinessKey: true
        name: UCCATEGORYLEVEL3KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d979a75e-48fb-4ec9-9df2-5cdcd9d9ac23
                stepCounter: 2ff63a87-cfbe-4127-ab9c-0906c06a7ca6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e9abcaf-8a6e-4daf-ba24-16feb0211c22
          stepCounter: b0bde1c0-2b67-49d3-a8f1-c4c80d36ad6e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.CATEGORY_LEVEL_4=UCCATEGORYLEVEL4.UCCATEGORY_LEVEL_4
        isBusinessKey: true
        name: UCCATEGORYLEVEL4KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f2f113e-64bc-49b9-a84b-2d9a7f608a6f
                stepCounter: 8a9f7ffb-b1ba-46ae-832b-75a7aec27b4c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb0c845f-0fcd-4d37-b003-bb9456e0671d
          stepCounter: b0bde1c0-2b67-49d3-a8f1-c4c80d36ad6e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.SUPPLIER=UCSUPPLIER.UCSUPPLIERNAME
        isBusinessKey: true
        name: UCSUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d72e3477-bc7e-47a9-b2de-65e83c9da1b3
                stepCounter: 5a8281dc-a0dc-4cfa-bb50-773e232806b4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02a63cb3-a340-4da0-8a30-20de951caeef
          stepCounter: b0bde1c0-2b67-49d3-a8f1-c4c80d36ad6e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.UC_TIER_1=UCTIER1.UC_TIER_1
        isBusinessKey: true
        name: UCTIER1KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 54d255d0-6acf-4920-b691-c0063657dec1
                stepCounter: 0891b0b4-8390-4e12-80d2-e609ca301cd8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c860eae5-3cd2-4a3f-b331-65b3ed040f99
          stepCounter: b0bde1c0-2b67-49d3-a8f1-c4c80d36ad6e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.UC_TIER_2=UCTIER2.UC_TIER_2
        isBusinessKey: true
        name: UCTIER2KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 58776a01-6e71-48a5-b6e9-bd0d26d302ff
                stepCounter: 1bb2cb8c-fef2-4e55-8a89-33254d21de0b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 302b73d4-1b49-4ead-9bc8-2382698e4095
          stepCounter: b0bde1c0-2b67-49d3-a8f1-c4c80d36ad6e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.UC_TIER_3=UCTIER3.UC_TIER_3
        isBusinessKey: true
        name: UCTIER3KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 444d834c-67ff-4861-971d-69a4b4f49be4
                stepCounter: 8c77dedd-5efd-49ad-b0aa-6fa33acc5284
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c627da10-7883-417c-964d-7d0c8614966c
          stepCounter: b0bde1c0-2b67-49d3-a8f1-c4c80d36ad6e
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: UCCOMPONENTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7094f891-d332-40a4-b210-365136001a68
                stepCounter: 8d0f90cf-b656-46b5-bc66-46d9cb49697c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e82ad349-d082-4234-91bc-b3ead4e83526
          stepCounter: b0bde1c0-2b67-49d3-a8f1-c4c80d36ad6e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        isBusinessKey: true
        name: OPSUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2df8d79a-e6ce-4848-9628-69052ad359a7
                stepCounter: 8d0f90cf-b656-46b5-bc66-46d9cb49697c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bfa21c90-6b7a-48a5-9c68-95fd99130101
          stepCounter: b0bde1c0-2b67-49d3-a8f1-c4c80d36ad6e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: OPSUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 686bec91-d8b3-42b2-9611-0db171f8e4d0
                stepCounter: 8d0f90cf-b656-46b5-bc66-46d9cb49697c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 670ba192-4118-4170-965e-33fdebc7cf59
          stepCounter: b0bde1c0-2b67-49d3-a8f1-c4c80d36ad6e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        isBusinessKey: true
        name: OPCONTRACTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d8045165-958d-47ab-8d74-3439978378a4
                stepCounter: 8d0f90cf-b656-46b5-bc66-46d9cb49697c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b6c0303-5cf1-4e72-b274-ab22ec5f3ebb
          stepCounter: b0bde1c0-2b67-49d3-a8f1-c4c80d36ad6e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: OPCONTRACTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c05fbb37-c76a-43a5-bfad-3674aac334c2
                stepCounter: 8d0f90cf-b656-46b5-bc66-46d9cb49697c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e924828-b5d8-4810-9895-864e152b9edb
          stepCounter: b0bde1c0-2b67-49d3-a8f1-c4c80d36ad6e
        config: {}
        dataType: INT
        defaultValue: ""
        description: OPCONTRACTMAPPINGSTATUSID
        isBusinessKey: true
        name: OPCONTRACTMAPPINGSTATUSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe02b853-69b4-40a4-ad1a-d6eeb051be2d
                stepCounter: 8d0f90cf-b656-46b5-bc66-46d9cb49697c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2cd6d094-9bac-43b8-b9ea-b53b288718b1
          stepCounter: b0bde1c0-2b67-49d3-a8f1-c4c80d36ad6e
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: UCSPEND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 17581675-3768-454c-a4d3-28e6d99a10c1
                stepCounter: 8d0f90cf-b656-46b5-bc66-46d9cb49697c
            transform: SUM(UCSPEND.UCSPEND)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c64a131a-7d58-4e56-9bf7-4f96071191ea
          stepCounter: b0bde1c0-2b67-49d3-a8f1-c4c80d36ad6e
        config: {}
        dataType: INT
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.TRANSACTIONDATE=DIMTRANSACTIONDATE.TRANSACTIONDATE
        isBusinessKey: true
        name: TRANSACTIONDATEKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 293bd495-4ce6-4d0f-8596-c5d75fc6eda2
                stepCounter: f559ddb9-6dc3-4412-9aa2-81bbce93de47
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0334d045-b41a-4eb0-a19a-89d144a7039c
          stepCounter: b0bde1c0-2b67-49d3-a8f1-c4c80d36ad6e
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: TRANSACTIONDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a710e879-ce6f-4b07-92f3-83d10bc81967
                stepCounter: 8d0f90cf-b656-46b5-bc66-46d9cb49697c
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          UCSPEND: 8d0f90cf-b656-46b5-bc66-46d9cb49697c
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: DIMTRANSACTIONDATE
          - locationName: DIM
            nodeName: UCCAMPUS
          - locationName: DIM
            nodeName: UCCATEGORYLEVEL1
          - locationName: DIM
            nodeName: UCCATEGORYLEVEL2
          - locationName: DIM
            nodeName: UCCATEGORYLEVEL3
          - locationName: DIM
            nodeName: UCCATEGORYLEVEL4
          - locationName: DIM
            nodeName: UCSUPPLIER
          - locationName: DIM
            nodeName: UCTIER1
          - locationName: DIM
            nodeName: UCTIER2
          - locationName: DIM
            nodeName: UCTIER3
          - locationName: FACT
            nodeName: UCSPEND
        join:
          joinCondition: |-
            FROM {{ ref('FACT','UCSPEND') }} UCSPEND
             GROUP BY UCSPEND.UCCAMPUSKEY ,
                      UCSPEND.UCCATEGORYLEVEL1KEY ,
                      UCSPEND.UCCATEGORYLEVEL2KEY ,
                      UCSPEND.UCCATEGORYLEVEL3KEY ,
                      UCSPEND.UCCATEGORYLEVEL4KEY ,
                      UCSPEND.UCSUPPLIERKEY ,
                      UCSPEND.UCTIER1KEY ,
                      UCSPEND.UCTIER2KEY ,
                      UCSPEND.UCTIER3KEY ,
                      UCSPEND.UCCOMPONENTKEY ,
                      UCSPEND.OPSUPPLIERKEY ,
                      UCSPEND.OPSUPPLIERID ,
                      UCSPEND.OPCONTRACTKEY ,
                      UCSPEND.OPCONTRACTID ,
                      UCSPEND.OPCONTRACTMAPPINGSTATUSID ,
                      UCSPEND.TRANSACTIONDATEKEY ,
                      UCSPEND.TRANSACTIONDATE
        name: AGGUCSPEND
        noLinkRefs: []
  name: AGGUCSPEND
  overrideSQL: false
  schema: ""
  sqlType: Fact
  type: sql
  version: 1
type: Node
