fileVersion: 1
id: 7219669f-db8a-4c6e-9d76-e4f80cbf096e
name: AGGUCSPEND
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: REPORTS
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 287f714a-162b-4330-a32e-8df3e20495b2
          stepCounter: 7219669f-db8a-4c6e-9d76-e4f80cbf096e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.CAMPUS=UCCAMPUS.UCCAMPUS
        isBusinessKey: true
        name: UCCAMPUSKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f8e14fa-ef7d-4d2a-8a43-136c3d1f556d
                stepCounter: 02002e76-c472-42b5-8c80-ff22fa1598d9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fda3f283-0270-40c2-b5e9-ca57bbf756e2
          stepCounter: 7219669f-db8a-4c6e-9d76-e4f80cbf096e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.CATEGORY_LEVEL_1=UCCATEGORYLEVEL1.UCCATEGORY_LEVEL_1
        isBusinessKey: true
        name: UCCATEGORYLEVEL1KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 714daed4-3656-4c5d-92a1-8605cb0c6e4f
                stepCounter: f469bc7a-d150-4839-932d-d4201ccd3f10
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5476b2b3-48ae-446e-9838-81fbdd05f41a
          stepCounter: 7219669f-db8a-4c6e-9d76-e4f80cbf096e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.CATEGORY_LEVEL_2=UCCATEGORYLEVEL2.UCCATEGORY_LEVEL_2
        isBusinessKey: true
        name: UCCATEGORYLEVEL2KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d076417-c91f-4dbd-879e-fe4f3d752ec5
                stepCounter: 6116649f-1c85-4fdd-8092-ce291d77a228
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 176def1b-a90c-4379-bb35-415debddbdcf
          stepCounter: 7219669f-db8a-4c6e-9d76-e4f80cbf096e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.CATEGORY_LEVEL_3=UCCATEGORYLEVEL3.UCCATEGORY_LEVEL_3
        isBusinessKey: true
        name: UCCATEGORYLEVEL3KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 960d988c-bef8-47d6-af63-1a9571ac5e7d
                stepCounter: b662ce9e-1697-454c-a450-6235a1a40ed1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc857369-f7c4-4ee9-8ea0-420339f7b997
          stepCounter: 7219669f-db8a-4c6e-9d76-e4f80cbf096e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.CATEGORY_LEVEL_4=UCCATEGORYLEVEL4.UCCATEGORY_LEVEL_4
        isBusinessKey: true
        name: UCCATEGORYLEVEL4KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a29cff2d-c310-4599-b9e2-b29aac16dcf0
                stepCounter: f4fdb50e-bd8c-4e2e-9133-b33b3a53cdf1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f4578e6f-77fa-4fdb-a40f-5c4d5bda6c9f
          stepCounter: 7219669f-db8a-4c6e-9d76-e4f80cbf096e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.SUPPLIER=UCSUPPLIER.UCSUPPLIERNAME
        isBusinessKey: true
        name: UCSUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: df60f52d-14b7-4793-828e-0c144a64566f
                stepCounter: a8579c52-6024-495a-93eb-5437f21aeb13
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 908d5682-8664-46fb-8e7e-5dd3c47cc31a
          stepCounter: 7219669f-db8a-4c6e-9d76-e4f80cbf096e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.UC_TIER_1=UCTIER1.UC_TIER_1
        isBusinessKey: true
        name: UCTIER1KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d43a7f7-e1e2-418b-af88-ae47158fa08d
                stepCounter: c6e8809e-6ff3-41aa-8734-8bc818003e54
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1e062a6-9b3d-4464-962d-f456f529794e
          stepCounter: 7219669f-db8a-4c6e-9d76-e4f80cbf096e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.UC_TIER_2=UCTIER2.UC_TIER_2
        isBusinessKey: true
        name: UCTIER2KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 45a23731-6c54-4fa3-8996-949dc075d149
                stepCounter: 179087f7-464b-4607-aeb5-103ae81c03f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b5e41a86-590c-49ed-a9b5-0b7139112b9c
          stepCounter: 7219669f-db8a-4c6e-9d76-e4f80cbf096e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.UC_TIER_3=UCTIER3.UC_TIER_3
        isBusinessKey: true
        name: UCTIER3KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1528aab7-0109-4e5e-9359-366abcb4f90f
                stepCounter: c42a5ccc-b2cf-4eba-9e42-3c0c0647995d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e445a65f-7807-4952-b91f-0bdfdf5f584e
          stepCounter: 7219669f-db8a-4c6e-9d76-e4f80cbf096e
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: UCCOMPONENTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b92d6a5-9644-4252-977d-be9757dcafe0
                stepCounter: 0175f64c-9de7-4ba1-bc08-fc111e79c7a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d16cb262-4a4e-4b08-9385-2eb378b74524
          stepCounter: 7219669f-db8a-4c6e-9d76-e4f80cbf096e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        isBusinessKey: true
        name: OPSUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8c21ff4-469b-4911-becc-24910944b4e1
                stepCounter: 0175f64c-9de7-4ba1-bc08-fc111e79c7a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d1cd8d92-f4a9-453e-8d79-6f91c97bfc3a
          stepCounter: 7219669f-db8a-4c6e-9d76-e4f80cbf096e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: OPSUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2423d04c-2ca1-4c3d-9515-737f532f243d
                stepCounter: 0175f64c-9de7-4ba1-bc08-fc111e79c7a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54fad846-53f6-4b8b-a5a6-76aae7a786de
          stepCounter: 7219669f-db8a-4c6e-9d76-e4f80cbf096e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        isBusinessKey: true
        name: OPCONTRACTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 58500989-8308-481f-803b-5bbbbccd3643
                stepCounter: 0175f64c-9de7-4ba1-bc08-fc111e79c7a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9203c87-6074-4f53-807c-20a05cd7ad95
          stepCounter: 7219669f-db8a-4c6e-9d76-e4f80cbf096e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: OPCONTRACTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2796b477-4563-4c7b-b905-c63ca08679a7
                stepCounter: 0175f64c-9de7-4ba1-bc08-fc111e79c7a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f83e38ce-8257-427b-8af2-d550d2e3bd5b
          stepCounter: 7219669f-db8a-4c6e-9d76-e4f80cbf096e
        config: {}
        dataType: INT
        defaultValue: ""
        description: OPCONTRACTMAPPINGSTATUSID
        isBusinessKey: true
        name: OPCONTRACTMAPPINGSTATUSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e05c94b1-eab8-43bc-87d5-7c8a8d154065
                stepCounter: 0175f64c-9de7-4ba1-bc08-fc111e79c7a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7e0eb96-fb90-4072-8dd7-0b1dcd6d278a
          stepCounter: 7219669f-db8a-4c6e-9d76-e4f80cbf096e
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: UCSPEND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cfea26e0-f8b1-469d-ae36-1a2dbbb3ee24
                stepCounter: 0175f64c-9de7-4ba1-bc08-fc111e79c7a9
            transform: SUM(UCSPEND.UCSPEND)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8c8a895-c03c-452b-8e2b-d1c9ffa376c2
          stepCounter: 7219669f-db8a-4c6e-9d76-e4f80cbf096e
        config: {}
        dataType: INT
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.TRANSACTIONDATE=DIMTRANSACTIONDATE.TRANSACTIONDATE
        isBusinessKey: true
        name: TRANSACTIONDATEKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 45f6717b-4c95-4512-8089-77ccef5c106c
                stepCounter: b43141ad-1f70-41dc-81ac-ec349cfdff08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6e32598-d143-4f4c-8bef-d6e12b61523e
          stepCounter: 7219669f-db8a-4c6e-9d76-e4f80cbf096e
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: TRANSACTIONDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a6f6c674-3b9e-4ebf-902d-5ff22924d6b7
                stepCounter: 0175f64c-9de7-4ba1-bc08-fc111e79c7a9
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          UCSPEND: 0175f64c-9de7-4ba1-bc08-fc111e79c7a9
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: DIMTRANSACTIONDATE
          - locationName: DIM
            nodeName: UCCAMPUS
          - locationName: DIM
            nodeName: UCCATEGORYLEVEL1
          - locationName: DIM
            nodeName: UCCATEGORYLEVEL2
          - locationName: DIM
            nodeName: UCCATEGORYLEVEL3
          - locationName: DIM
            nodeName: UCCATEGORYLEVEL4
          - locationName: DIM
            nodeName: UCSUPPLIER
          - locationName: DIM
            nodeName: UCTIER1
          - locationName: DIM
            nodeName: UCTIER2
          - locationName: DIM
            nodeName: UCTIER3
          - locationName: FACT
            nodeName: UCSPEND
        join:
          joinCondition: |-
            FROM {{ ref('FACT','UCSPEND') }} UCSPEND
             GROUP BY UCSPEND.UCCAMPUSKEY ,
                      UCSPEND.UCCATEGORYLEVEL1KEY ,
                      UCSPEND.UCCATEGORYLEVEL2KEY ,
                      UCSPEND.UCCATEGORYLEVEL3KEY ,
                      UCSPEND.UCCATEGORYLEVEL4KEY ,
                      UCSPEND.UCSUPPLIERKEY ,
                      UCSPEND.UCTIER1KEY ,
                      UCSPEND.UCTIER2KEY ,
                      UCSPEND.UCTIER3KEY ,
                      UCSPEND.UCCOMPONENTKEY ,
                      UCSPEND.OPSUPPLIERKEY ,
                      UCSPEND.OPSUPPLIERID ,
                      UCSPEND.OPCONTRACTKEY ,
                      UCSPEND.OPCONTRACTID ,
                      UCSPEND.OPCONTRACTMAPPINGSTATUSID ,
                      UCSPEND.TRANSACTIONDATEKEY ,
                      UCSPEND.TRANSACTIONDATE
        name: AGGUCSPEND
        noLinkRefs: []
  name: AGGUCSPEND
  overrideSQL: false
  schema: ""
  sqlType: Fact
  type: sql
  version: 1
type: Node
