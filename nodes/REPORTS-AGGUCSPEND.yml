fileVersion: 1
id: 677f7c31-590f-4d3c-8f7f-a46c8e699c71
name: AGGUCSPEND
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: REPORTS
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 953b406e-1004-42f8-ab98-70f2c3cbdcc5
          stepCounter: 677f7c31-590f-4d3c-8f7f-a46c8e699c71
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: StageUCSpendReportingLineItems_AddKeys.Campus=UCCampus.UCCampus
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: UCCAMPUSKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1fdb991f-194b-4ca4-be6a-48d0639878d4
                stepCounter: 2b3ad18b-05b2-417d-aa60-27bbb9a839ca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b995379-8b0b-4a7d-9495-ccd1c2d5ecf9
          stepCounter: 677f7c31-590f-4d3c-8f7f-a46c8e699c71
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: StageUCSpendReportingLineItems_AddKeys.Category_Level_1=UCCategoryLevel1.UCCategory_Level_1
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: UCCATEGORYLEVEL1KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b95c9012-07f0-4ae7-9ebe-f469f6755478
                stepCounter: 0301686a-33a1-41aa-8d32-ec6ce91ca776
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c48d845f-f80a-41f9-8691-ef302459bc59
          stepCounter: 677f7c31-590f-4d3c-8f7f-a46c8e699c71
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: StageUCSpendReportingLineItems_AddKeys.Category_Level_2=UCCategoryLevel2.UCCategory_Level_2
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: UCCATEGORYLEVEL2KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 654f4585-43cf-4f55-a959-2ba83c6f3696
                stepCounter: c9867a54-039b-45ac-9a1c-5f6c66625c23
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3583ad2-a7fd-4a81-bd6b-799f1553f535
          stepCounter: 677f7c31-590f-4d3c-8f7f-a46c8e699c71
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: StageUCSpendReportingLineItems_AddKeys.Category_Level_3=UCCategoryLevel3.UCCategory_Level_3
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: UCCATEGORYLEVEL3KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5acb9440-bb1f-4a75-930b-c853fd761552
                stepCounter: d680b183-2cdd-4379-ac2b-747addbe1bb3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f638e0a-d34e-4cc7-9f62-d62fd1a762d5
          stepCounter: 677f7c31-590f-4d3c-8f7f-a46c8e699c71
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: StageUCSpendReportingLineItems_AddKeys.Category_Level_4=UCCategoryLevel4.UCCategory_Level_4
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: UCCATEGORYLEVEL4KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 62ff0e75-299c-4b82-b90c-e017d68213e9
                stepCounter: d7957376-9264-4e3e-b08f-2fc14237314e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1a98c4d-8bc1-4018-95ff-661060e4e2bf
          stepCounter: 677f7c31-590f-4d3c-8f7f-a46c8e699c71
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: StageUCSpendReportingLineItems_AddKeys.Supplier=UCSupplier.UCSupplierName
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: UCSUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47b2a054-f061-410a-b198-0e5d37f8b8f1
                stepCounter: 2ac748b1-061d-4a75-87fc-74b979edaf80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9464dd4-2287-42d8-a83b-d5f4545d907a
          stepCounter: 677f7c31-590f-4d3c-8f7f-a46c8e699c71
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: StageUCSpendReportingLineItems_AddKeys.UC_Tier_1=UCTier1.UC_Tier_1
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: UCTIER1KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f80c1b58-6320-4a86-a2f5-a081e11fca59
                stepCounter: 41af098c-1ef1-4f55-ae2a-5d994b56f0d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a9baca5-8617-44af-a3c9-4a9e09aef817
          stepCounter: 677f7c31-590f-4d3c-8f7f-a46c8e699c71
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: StageUCSpendReportingLineItems_AddKeys.UC_Tier_2=UCTier2.UC_Tier_2
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: UCTIER2KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f6eaac0-4bb2-4116-aef2-463501761651
                stepCounter: 76deb199-e0c3-4adb-9541-cee345963241
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2630437-c7ac-4e0b-9544-6c4fdbbf5be3
          stepCounter: 677f7c31-590f-4d3c-8f7f-a46c8e699c71
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: StageUCSpendReportingLineItems_AddKeys.UC_Tier_3=UCTier3.UC_Tier_3
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: UCTIER3KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b3163d9-5ad5-4087-a75a-95d3b5fb145c
                stepCounter: da6a50a1-d0cd-40c8-86a2-aa4bdd8b616e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b89cb751-6b0e-4c66-9456-c7218836e0fa
          stepCounter: 677f7c31-590f-4d3c-8f7f-a46c8e699c71
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: UCCOMPONENTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 078caf03-5873-4886-8644-cd2f3fa740f5
                stepCounter: 808f5233-63d4-41fd-8604-0730a47f2ee2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47cba7f4-55ef-4e27-ae28-bea74a695b92
          stepCounter: 677f7c31-590f-4d3c-8f7f-a46c8e699c71
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: OPSUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc27c02d-f9a7-476b-8081-af911a415e9c
                stepCounter: 808f5233-63d4-41fd-8604-0730a47f2ee2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a71dded2-76f2-4ba5-bd56-1175d67698f2
          stepCounter: 677f7c31-590f-4d3c-8f7f-a46c8e699c71
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: OPSUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b679f970-7d37-4d8c-896c-a6fbcfec95ab
                stepCounter: 808f5233-63d4-41fd-8604-0730a47f2ee2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3798069-b23b-4fc2-b3f3-74bab214af9f
          stepCounter: 677f7c31-590f-4d3c-8f7f-a46c8e699c71
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: OPCONTRACTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f9037b1-23ba-4551-8e1d-269e3a136c62
                stepCounter: 808f5233-63d4-41fd-8604-0730a47f2ee2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ecd6829-d8cc-4be2-9473-0d6606444004
          stepCounter: 677f7c31-590f-4d3c-8f7f-a46c8e699c71
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: OPCONTRACTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 578e6e3f-4025-4e49-b536-01b39153390c
                stepCounter: 808f5233-63d4-41fd-8604-0730a47f2ee2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6e15c04-1334-40be-afe1-6a3baba8d521
          stepCounter: 677f7c31-590f-4d3c-8f7f-a46c8e699c71
        config: {}
        dataType: INT
        defaultValue: ""
        description: OPContractMappingStatusId
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: OPCONTRACTMAPPINGSTATUSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de33642d-dab5-4492-b846-1859e0092d0e
                stepCounter: 808f5233-63d4-41fd-8604-0730a47f2ee2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14eecfbb-e308-42a8-9833-39140d70b720
          stepCounter: 677f7c31-590f-4d3c-8f7f-a46c8e699c71
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: UCSPEND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9504c039-81ea-4b1a-88a8-ee46fb01d39b
                stepCounter: 808f5233-63d4-41fd-8604-0730a47f2ee2
            transform: SUM(UCSpend.UCSpend)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02b059d8-1371-4cba-ab9c-a763ea748d11
          stepCounter: 677f7c31-590f-4d3c-8f7f-a46c8e699c71
        config: {}
        dataType: INT
        defaultValue: ""
        description: StageUCSpendReportingLineItems_AddKeys.TransactionDate=DimTransactionDate.TransactionDate
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: TRANSACTIONDATEKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ab19437-e0be-4080-b347-d01d42ff2c7d
                stepCounter: b6e4db47-031e-4b7e-9203-ae244b9a23e5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16e890b5-5300-4667-98ca-05e415f94bad
          stepCounter: 677f7c31-590f-4d3c-8f7f-a46c8e699c71
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: TRANSACTIONDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 666eb42b-4b11-4b1a-89c3-f38623f0d4f2
                stepCounter: 808f5233-63d4-41fd-8604-0730a47f2ee2
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          UCSPEND: 808f5233-63d4-41fd-8604-0730a47f2ee2
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: DIMTRANSACTIONDATE
          - locationName: DIM
            nodeName: UCCAMPUS
          - locationName: DIM
            nodeName: UCCATEGORYLEVEL1
          - locationName: DIM
            nodeName: UCCATEGORYLEVEL2
          - locationName: DIM
            nodeName: UCCATEGORYLEVEL3
          - locationName: DIM
            nodeName: UCCATEGORYLEVEL4
          - locationName: DIM
            nodeName: UCSUPPLIER
          - locationName: DIM
            nodeName: UCTIER1
          - locationName: DIM
            nodeName: UCTIER2
          - locationName: DIM
            nodeName: UCTIER3
          - locationName: FACT
            nodeName: UCSPEND
        join:
          joinCondition: |-
            FROM {{ ref('FACT','UCSPEND') }} UCSpend
             GROUP BY UCSpend.UCCampusKey ,
                      UCSpend.UCCategoryLevel1Key ,
                      UCSpend.UCCategoryLevel2Key ,
                      UCSpend.UCCategoryLevel3Key ,
                      UCSpend.UCCategoryLevel4Key ,
                      UCSpend.UCSupplierKey ,
                      UCSpend.UCTier1Key ,
                      UCSpend.UCTier2Key ,
                      UCSpend.UCTier3Key ,
                      UCSpend.UCComponentKey ,
                      UCSpend.OPSupplierKey ,
                      UCSpend.OPSupplierId ,
                      UCSpend.OPContractKey ,
                      UCSpend.OPContractId ,
                      UCSpend.OPContractMappingStatusId ,
                      UCSpend.TransactionDateKey ,
                      UCSpend.TransactionDate
        name: AGGUCSPEND
        noLinkRefs: []
  name: AGGUCSPEND
  overrideSQL: false
  schema: ""
  sqlType: Fact
  type: sql
  version: 1
type: Node
