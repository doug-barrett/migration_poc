fileVersion: 1
id: af092158-e3f1-41fa-8161-a5166038b69e
name: AGGUCSPEND
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: REPORTS
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 168fe7a1-9144-47c8-b6fa-349681b446b5
          stepCounter: af092158-e3f1-41fa-8161-a5166038b69e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: StageUCSpendReportingLineItems_AddKeys.Campus=UCCampus.UCCampus
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: UCCAMPUSKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 176e8461-009b-481a-8790-852674440d8b
                stepCounter: ff8e6c8c-a21d-4105-b135-1e58792d1cdf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 463968fa-834b-48b5-8e24-067bc2864636
          stepCounter: af092158-e3f1-41fa-8161-a5166038b69e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: StageUCSpendReportingLineItems_AddKeys.Category_Level_1=UCCategoryLevel1.UCCategory_Level_1
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: UCCATEGORYLEVEL1KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b00bca43-5a6e-45d9-8f29-8526013c05b8
                stepCounter: ef24335d-a4a3-4272-9e40-bad92140e225
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bc28a3be-a7bb-45ed-9712-815d4ac40473
          stepCounter: af092158-e3f1-41fa-8161-a5166038b69e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: StageUCSpendReportingLineItems_AddKeys.Category_Level_2=UCCategoryLevel2.UCCategory_Level_2
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: UCCATEGORYLEVEL2KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ceda4cb-bdd1-4e97-a7e5-1b7a25d442e2
                stepCounter: 5f3e4e7f-6fb1-42a9-9b18-afe5f8ae40ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f6ecacc-5b16-4a1b-94d0-fb74fe901ab3
          stepCounter: af092158-e3f1-41fa-8161-a5166038b69e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: StageUCSpendReportingLineItems_AddKeys.Category_Level_3=UCCategoryLevel3.UCCategory_Level_3
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: UCCATEGORYLEVEL3KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d082279-254b-47dd-8c46-85c5e1141284
                stepCounter: 32875ff6-faf4-4ee0-b662-37097de08219
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a308862-3580-4d54-bac1-e21bdfcfb20d
          stepCounter: af092158-e3f1-41fa-8161-a5166038b69e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: StageUCSpendReportingLineItems_AddKeys.Category_Level_4=UCCategoryLevel4.UCCategory_Level_4
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: UCCATEGORYLEVEL4KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0bd4acfd-01fa-49f1-b2e1-7ce59a712273
                stepCounter: f6422ee6-ef2e-4a34-a718-eedffcbc5d82
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b588c598-984f-4825-940b-6624d222b9dd
          stepCounter: af092158-e3f1-41fa-8161-a5166038b69e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: StageUCSpendReportingLineItems_AddKeys.Supplier=UCSupplier.UCSupplierName
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: UCSUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 038951e2-cdb5-4076-9d23-5b709b37d086
                stepCounter: d5f7e83e-bfbe-4a62-b997-193ff2eb5e46
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c873735f-804c-4846-a759-0393bf699226
          stepCounter: af092158-e3f1-41fa-8161-a5166038b69e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: StageUCSpendReportingLineItems_AddKeys.UC_Tier_1=UCTier1.UC_Tier_1
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: UCTIER1KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 768433f9-edcc-47d3-b02b-84559c1ba754
                stepCounter: 181d159c-70f8-4c54-aa7b-5473017ed12c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6bb23761-7500-42af-a56a-e0b28e53a6c1
          stepCounter: af092158-e3f1-41fa-8161-a5166038b69e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: StageUCSpendReportingLineItems_AddKeys.UC_Tier_2=UCTier2.UC_Tier_2
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: UCTIER2KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f78386bb-e2c1-4e5f-a006-4c8ef2918af0
                stepCounter: 946037df-fc37-481b-ae73-cbfcaf2ec07e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6709dc67-3f5b-43aa-89d3-ed9fbb6fe69a
          stepCounter: af092158-e3f1-41fa-8161-a5166038b69e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: StageUCSpendReportingLineItems_AddKeys.UC_Tier_3=UCTier3.UC_Tier_3
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: UCTIER3KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d9f1119c-73b8-447f-ac7c-c2e10386b2b0
                stepCounter: 55ccf630-eab7-47b5-a7b5-d9ad8a838d46
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c70c1c9-a755-4516-8f2b-60b9cf524a04
          stepCounter: af092158-e3f1-41fa-8161-a5166038b69e
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: UCCOMPONENTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 17b70707-962f-416d-9d20-7e24ac5ce433
                stepCounter: 1bb85338-e88f-43e8-ad61-d4f8353c5f21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9db7063-e9cd-4dc3-af2a-c2fcea21605f
          stepCounter: af092158-e3f1-41fa-8161-a5166038b69e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: OPSUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9934f77c-3080-4d33-a3de-eb45a8098e37
                stepCounter: 1bb85338-e88f-43e8-ad61-d4f8353c5f21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 44fd9b17-bea3-4c13-8b9b-a81f508972bd
          stepCounter: af092158-e3f1-41fa-8161-a5166038b69e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: OPSUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce869dff-7c73-4474-ac8e-618e2e5419c5
                stepCounter: 1bb85338-e88f-43e8-ad61-d4f8353c5f21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0010197b-b4ab-4a74-9d87-95f6e82142d6
          stepCounter: af092158-e3f1-41fa-8161-a5166038b69e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: OPCONTRACTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ffe15d2b-057e-4232-9c73-cb3617039d31
                stepCounter: 1bb85338-e88f-43e8-ad61-d4f8353c5f21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39e6d046-ac47-4006-acb9-bf49389e02f9
          stepCounter: af092158-e3f1-41fa-8161-a5166038b69e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: OPCONTRACTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67655f56-e9b2-4412-a6c4-e6cda7173c54
                stepCounter: 1bb85338-e88f-43e8-ad61-d4f8353c5f21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7904a618-be50-4600-8401-7782ee4169c2
          stepCounter: af092158-e3f1-41fa-8161-a5166038b69e
        config: {}
        dataType: INT
        defaultValue: ""
        description: OPContractMappingStatusId
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: OPCONTRACTMAPPINGSTATUSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b708c585-4e66-4878-9ca1-26a23c53f7b8
                stepCounter: 1bb85338-e88f-43e8-ad61-d4f8353c5f21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 65c0f878-aaa8-40d8-afd2-9d46af83b860
          stepCounter: af092158-e3f1-41fa-8161-a5166038b69e
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: UCSPEND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2383529-ac91-498d-9e70-12dff936778a
                stepCounter: 1bb85338-e88f-43e8-ad61-d4f8353c5f21
            transform: SUM(UCSpend.UCSpend)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8de6f88-0739-4abc-8d90-02263ab2a6b3
          stepCounter: af092158-e3f1-41fa-8161-a5166038b69e
        config: {}
        dataType: INT
        defaultValue: ""
        description: StageUCSpendReportingLineItems_AddKeys.TransactionDate=DimTransactionDate.TransactionDate
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: TRANSACTIONDATEKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9869384a-a9e2-482e-975c-dfd52224d138
                stepCounter: 7cce1b6d-aeb7-48ba-bc34-41858737db13
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8420ef3-a11f-4587-b51f-57a9bd908ed4
          stepCounter: af092158-e3f1-41fa-8161-a5166038b69e
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: TRANSACTIONDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 26cfb064-b63b-48c0-b164-211b4a8dde8e
                stepCounter: 1bb85338-e88f-43e8-ad61-d4f8353c5f21
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          UCSPEND: 1bb85338-e88f-43e8-ad61-d4f8353c5f21
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: DIMTRANSACTIONDATE
          - locationName: DIM
            nodeName: UCCAMPUS
          - locationName: DIM
            nodeName: UCCATEGORYLEVEL1
          - locationName: DIM
            nodeName: UCCATEGORYLEVEL2
          - locationName: DIM
            nodeName: UCCATEGORYLEVEL3
          - locationName: DIM
            nodeName: UCCATEGORYLEVEL4
          - locationName: DIM
            nodeName: UCSUPPLIER
          - locationName: DIM
            nodeName: UCTIER1
          - locationName: DIM
            nodeName: UCTIER2
          - locationName: DIM
            nodeName: UCTIER3
          - locationName: FACT
            nodeName: UCSPEND
        join:
          joinCondition: |-
            FROM {{ ref('FACT','UCSPEND') }} UCSpend
             GROUP BY UCSpend.UCCampusKey ,
                      UCSpend.UCCategoryLevel1Key ,
                      UCSpend.UCCategoryLevel2Key ,
                      UCSpend.UCCategoryLevel3Key ,
                      UCSpend.UCCategoryLevel4Key ,
                      UCSpend.UCSupplierKey ,
                      UCSpend.UCTier1Key ,
                      UCSpend.UCTier2Key ,
                      UCSpend.UCTier3Key ,
                      UCSpend.UCComponentKey ,
                      UCSpend.OPSupplierKey ,
                      UCSpend.OPSupplierId ,
                      UCSpend.OPContractKey ,
                      UCSpend.OPContractId ,
                      UCSpend.OPContractMappingStatusId ,
                      UCSpend.TransactionDateKey ,
                      UCSpend.TransactionDate
        name: AGGUCSPEND
        noLinkRefs: []
  name: AGGUCSPEND
  overrideSQL: false
  schema: ""
  sqlType: Fact
  type: sql
  version: 1
type: Node
