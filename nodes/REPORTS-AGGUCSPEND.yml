fileVersion: 1
id: 94680f47-580a-42b9-b5db-5b4d7f1e212f
name: AGGUCSPEND
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: REPORTS
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c7881ec-7ab6-4ef6-9ad2-66e56e986b17
          stepCounter: 94680f47-580a-42b9-b5db-5b4d7f1e212f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.CAMPUS=UCCAMPUS.UCCAMPUS
        isBusinessKey: true
        name: UCCAMPUSKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa12c653-88c9-480d-8975-5d217427513f
                stepCounter: f4ed674a-1d0d-49f4-ad77-49e296514204
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 079704b6-d977-47be-9581-0f3349296fb6
          stepCounter: 94680f47-580a-42b9-b5db-5b4d7f1e212f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.CATEGORY_LEVEL_1=UCCATEGORYLEVEL1.UCCATEGORY_LEVEL_1
        isBusinessKey: true
        name: UCCATEGORYLEVEL1KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 517f00b2-b7c2-4605-b36e-94121ec2932b
                stepCounter: e2486bdd-5797-4b88-89a6-cbbfa6557405
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: badea74f-8507-4bec-bac6-df696dc04b98
          stepCounter: 94680f47-580a-42b9-b5db-5b4d7f1e212f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.CATEGORY_LEVEL_2=UCCATEGORYLEVEL2.UCCATEGORY_LEVEL_2
        isBusinessKey: true
        name: UCCATEGORYLEVEL2KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3328cc32-a309-48c9-9c1c-21eb56a6a5bf
                stepCounter: 8bf97098-ed67-4ca8-b9fa-0f16692b0723
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e785372e-d4c8-446d-9f39-db0827ea090a
          stepCounter: 94680f47-580a-42b9-b5db-5b4d7f1e212f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.CATEGORY_LEVEL_3=UCCATEGORYLEVEL3.UCCATEGORY_LEVEL_3
        isBusinessKey: true
        name: UCCATEGORYLEVEL3KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 015daa5e-397a-43f2-9297-a557301ff4cd
                stepCounter: d45099bb-c8db-4bf8-b0af-2693e3944ab7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5cef450-584b-4076-a589-01daab8f71ab
          stepCounter: 94680f47-580a-42b9-b5db-5b4d7f1e212f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.CATEGORY_LEVEL_4=UCCATEGORYLEVEL4.UCCATEGORY_LEVEL_4
        isBusinessKey: true
        name: UCCATEGORYLEVEL4KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 32f232be-dac5-4538-8dc7-27018b5666a0
                stepCounter: b7373e4e-c4c6-4f14-8aac-2191ea2ecb80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59230733-a5c5-42b9-a51a-1d9479c34b69
          stepCounter: 94680f47-580a-42b9-b5db-5b4d7f1e212f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.SUPPLIER=UCSUPPLIER.UCSUPPLIERNAME
        isBusinessKey: true
        name: UCSUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cbe935cf-01c5-4097-915c-6fc476878f51
                stepCounter: 4aa6ca4c-72bf-48bc-94b5-654b6ced8e1a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c5331f6-0973-45dd-97b0-288f5a4b4e64
          stepCounter: 94680f47-580a-42b9-b5db-5b4d7f1e212f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.UC_TIER_1=UCTIER1.UC_TIER_1
        isBusinessKey: true
        name: UCTIER1KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7b4863b-efaa-4783-a8c7-f87ab9cb1596
                stepCounter: 1339ac9d-b30d-4d0d-89de-06e791c65aab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64e208c8-120a-4856-b8a2-51713f4d3a87
          stepCounter: 94680f47-580a-42b9-b5db-5b4d7f1e212f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.UC_TIER_2=UCTIER2.UC_TIER_2
        isBusinessKey: true
        name: UCTIER2KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 759b89c8-c6f9-45cd-b3da-fc5b380f51a8
                stepCounter: 131f0a14-e74f-428b-948c-46956cce4797
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 65ef5046-6ffc-4cb5-8af3-962ac4007b24
          stepCounter: 94680f47-580a-42b9-b5db-5b4d7f1e212f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.UC_TIER_3=UCTIER3.UC_TIER_3
        isBusinessKey: true
        name: UCTIER3KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a0ace0a2-afd8-405c-9749-5d6ebc957652
                stepCounter: 96ddf916-8884-4d8d-9a34-f042f923791b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 736264bc-27c5-4d73-9866-7533e5e0522b
          stepCounter: 94680f47-580a-42b9-b5db-5b4d7f1e212f
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: UCCOMPONENTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a888696-fc41-4d49-92c4-50e82a1c46c3
                stepCounter: 74ab58c4-87f4-4446-a7f5-f80cb280a971
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8059b52-7e21-4ea2-87b9-1baff7de1d94
          stepCounter: 94680f47-580a-42b9-b5db-5b4d7f1e212f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        isBusinessKey: true
        name: OPSUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 43a395e9-71da-443f-abdd-9d14e9ef9bb8
                stepCounter: 74ab58c4-87f4-4446-a7f5-f80cb280a971
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 346a1543-3248-4805-b667-4018c9fc4f39
          stepCounter: 94680f47-580a-42b9-b5db-5b4d7f1e212f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: OPSUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3816a7ec-e744-4d85-abd9-e3b166ecf8c5
                stepCounter: 74ab58c4-87f4-4446-a7f5-f80cb280a971
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78717194-4e31-4e89-8ffe-5b0447ce1a91
          stepCounter: 94680f47-580a-42b9-b5db-5b4d7f1e212f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        isBusinessKey: true
        name: OPCONTRACTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b080142-468f-45f2-8ab1-cf7943f90ef9
                stepCounter: 74ab58c4-87f4-4446-a7f5-f80cb280a971
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bce6370d-cc66-4230-b7d6-adb6e2cfda7a
          stepCounter: 94680f47-580a-42b9-b5db-5b4d7f1e212f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: OPCONTRACTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a60d1334-0adc-4af8-8621-0d8f25289b9a
                stepCounter: 74ab58c4-87f4-4446-a7f5-f80cb280a971
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd070ba9-f025-466c-bd21-4b9e8c561b26
          stepCounter: 94680f47-580a-42b9-b5db-5b4d7f1e212f
        config: {}
        dataType: INT
        defaultValue: ""
        description: OPCONTRACTMAPPINGSTATUSID
        isBusinessKey: true
        name: OPCONTRACTMAPPINGSTATUSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7fb473c-cacd-4dba-8fef-aefb91986df1
                stepCounter: 74ab58c4-87f4-4446-a7f5-f80cb280a971
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6bed501-3caf-4946-bc20-1ebc3426bd8a
          stepCounter: 94680f47-580a-42b9-b5db-5b4d7f1e212f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: UCSPEND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f0af35d9-950d-44c9-abea-d9d1f13283d4
                stepCounter: 74ab58c4-87f4-4446-a7f5-f80cb280a971
            transform: SUM(UCSPEND.UCSPEND)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e924cde-9d00-45e9-af1e-10e3af0afa16
          stepCounter: 94680f47-580a-42b9-b5db-5b4d7f1e212f
        config: {}
        dataType: INT
        defaultValue: ""
        description: STAGEUCSPENDREPORTINGLINEITEMS_ADDKEYS.TRANSACTIONDATE=DIMTRANSACTIONDATE.TRANSACTIONDATE
        isBusinessKey: true
        name: TRANSACTIONDATEKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 584d4a5f-e047-4ffd-84cc-67159046ebe2
                stepCounter: 04420abb-9d56-4991-8545-87b244f17df0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b570d47c-408b-42d6-a23b-9d7eb2c439cb
          stepCounter: 94680f47-580a-42b9-b5db-5b4d7f1e212f
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: TRANSACTIONDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7e12c1a-a9ea-4ec7-9db6-87f5521704aa
                stepCounter: 74ab58c4-87f4-4446-a7f5-f80cb280a971
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          UCSPEND: 74ab58c4-87f4-4446-a7f5-f80cb280a971
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: DIMTRANSACTIONDATE
          - locationName: DIM
            nodeName: UCCAMPUS
          - locationName: DIM
            nodeName: UCCATEGORYLEVEL1
          - locationName: DIM
            nodeName: UCCATEGORYLEVEL2
          - locationName: DIM
            nodeName: UCCATEGORYLEVEL3
          - locationName: DIM
            nodeName: UCCATEGORYLEVEL4
          - locationName: DIM
            nodeName: UCSUPPLIER
          - locationName: DIM
            nodeName: UCTIER1
          - locationName: DIM
            nodeName: UCTIER2
          - locationName: DIM
            nodeName: UCTIER3
          - locationName: FACT
            nodeName: UCSPEND
        join:
          joinCondition: |-
            FROM {{ ref('FACT','UCSPEND') }} UCSPEND
             GROUP BY UCSPEND.UCCAMPUSKEY ,
                      UCSPEND.UCCATEGORYLEVEL1KEY ,
                      UCSPEND.UCCATEGORYLEVEL2KEY ,
                      UCSPEND.UCCATEGORYLEVEL3KEY ,
                      UCSPEND.UCCATEGORYLEVEL4KEY ,
                      UCSPEND.UCSUPPLIERKEY ,
                      UCSPEND.UCTIER1KEY ,
                      UCSPEND.UCTIER2KEY ,
                      UCSPEND.UCTIER3KEY ,
                      UCSPEND.UCCOMPONENTKEY ,
                      UCSPEND.OPSUPPLIERKEY ,
                      UCSPEND.OPSUPPLIERID ,
                      UCSPEND.OPCONTRACTKEY ,
                      UCSPEND.OPCONTRACTID ,
                      UCSPEND.OPCONTRACTMAPPINGSTATUSID ,
                      UCSPEND.TRANSACTIONDATEKEY ,
                      UCSPEND.TRANSACTIONDATE
        name: AGGUCSPEND
        noLinkRefs: []
  name: AGGUCSPEND
  overrideSQL: false
  schema: ""
  sqlType: Agreggate
  type: sql
  version: 1
type: Node
