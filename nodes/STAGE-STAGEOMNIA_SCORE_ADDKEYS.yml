fileVersion: 1
id: eab170be-7cc2-4efc-9ecc-6d37c73c0e6d
name: STAGEOMNIA_SCORE_ADDKEYS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "THIS STAGE FILTERS OUT THE INACTIVE OMNIA SCORE RECORDS USING CONDITION BELOW.\n\nWHERE DSOMNIA_SCORE.MAXRECEIPTDATE = '$ACTIVEDATEFOROMNIASCORE'\n"
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c437b91-8a3e-42f8-a887-7fc6a3e78709
          stepCounter: eab170be-7cc2-4efc-9ecc-6d37c73c0e6d
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 55254940-c6c0-4f41-80da-e3481365f74e
                stepCounter: c4397d2e-da5c-4dcf-86f1-1f763a91cbc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55a0f456-d51f-4f8a-99eb-bd5796eb0594
          stepCounter: eab170be-7cc2-4efc-9ecc-6d37c73c0e6d
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: OMNIA_SCORE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 788eaac1-afa6-4b90-bd77-25c8213a49e8
                stepCounter: c4397d2e-da5c-4dcf-86f1-1f763a91cbc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d7912bd-a8a6-4a4c-aa95-7e3fbd88443a
          stepCounter: eab170be-7cc2-4efc-9ecc-6d37c73c0e6d
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: MAXRECEIPTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f0065d0b-fc30-44ec-bcd4-364718c588bf
                stepCounter: c4397d2e-da5c-4dcf-86f1-1f763a91cbc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9348e2ce-7d2c-49a8-af98-ad068a7019f8
          stepCounter: eab170be-7cc2-4efc-9ecc-6d37c73c0e6d
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 73ef37cb-fc08-4d22-8ee1-c59f3cb92741
                stepCounter: c4397d2e-da5c-4dcf-86f1-1f763a91cbc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f35e6a7-0384-43b3-b8f4-3318b20b72ae
          stepCounter: eab170be-7cc2-4efc-9ecc-6d37c73c0e6d
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8859fbd1-7c2f-404e-b6e6-b913c788ba92
                stepCounter: c4397d2e-da5c-4dcf-86f1-1f763a91cbc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da90506f-b9d3-460d-80bb-3a71e1be8e0b
          stepCounter: eab170be-7cc2-4efc-9ecc-6d37c73c0e6d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEOMNIA_SCORE_ADDKEYS.LEVEL1FORCEID=ACCOUNT.FORCEID
        name: ACCOUNTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bae9c318-63c2-4058-8e74-f5509f5b4522
                stepCounter: d5234d5a-eb19-45e2-9c42-47221579f347
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f299d8e-89ff-4571-b58f-43088470c1a5
          stepCounter: eab170be-7cc2-4efc-9ecc-6d37c73c0e6d
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4cad082-986c-446b-889d-870a8acbef08
          stepCounter: eab170be-7cc2-4efc-9ecc-6d37c73c0e6d
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DSOMNIA_SCORE: c4397d2e-da5c-4dcf-86f1-1f763a91cbc2
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: ODS
            nodeName: DSOMNIA_SCORE
        join:
          joinCondition: |-
            FROM {{ ref('ODS','DSOMNIA_SCORE') }} DSOMNIA_SCORE
             WHERE DSOMNIA_SCORE.MAXRECEIPTDATE = '$ACTIVEDATEFOROMNIASCORE'
        name: STAGEOMNIA_SCORE_ADDKEYS
        noLinkRefs: []
  name: STAGEOMNIA_SCORE_ADDKEYS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
