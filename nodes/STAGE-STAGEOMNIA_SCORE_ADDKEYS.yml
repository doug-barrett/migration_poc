fileVersion: 1
id: c00d0016-84f1-49db-a23f-a8c23262429d
name: STAGEOMNIA_SCORE_ADDKEYS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "THIS STAGE FILTERS OUT THE INACTIVE OMNIA SCORE RECORDS USING CONDITION BELOW.\n\nWHERE DSOMNIA_SCORE.MAXRECEIPTDATE = '$ACTIVEDATEFOROMNIASCORE'\n"
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 245854ba-221f-470d-84ce-ed33ce2ddd3c
          stepCounter: c00d0016-84f1-49db-a23f-a8c23262429d
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 58f6328a-7e02-4c75-ad9a-b41b73140142
                stepCounter: 80dcb0e4-e89c-4fc1-9a5b-4c27a1f710ac
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d287fa15-3196-4f55-bd9d-18ad17639531
          stepCounter: c00d0016-84f1-49db-a23f-a8c23262429d
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: OMNIA_SCORE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 549b2078-640c-416f-838c-49a4cffff128
                stepCounter: 80dcb0e4-e89c-4fc1-9a5b-4c27a1f710ac
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d559d009-1261-4de2-a31e-3622ce1e8fb8
          stepCounter: c00d0016-84f1-49db-a23f-a8c23262429d
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: MAXRECEIPTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9bc475df-b639-4f4f-9ce5-d7e0385d4de7
                stepCounter: 80dcb0e4-e89c-4fc1-9a5b-4c27a1f710ac
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5b3abbf-2b27-4c0e-8a33-3398f50e3c51
          stepCounter: c00d0016-84f1-49db-a23f-a8c23262429d
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 74ee4d83-11c2-44d6-bbc3-1ee87eeadb6f
                stepCounter: 80dcb0e4-e89c-4fc1-9a5b-4c27a1f710ac
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab455e46-780a-49c4-9aed-b11a0e995ea8
          stepCounter: c00d0016-84f1-49db-a23f-a8c23262429d
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9fb98d21-ec51-435e-b2c5-c58c4da9fbe9
                stepCounter: 80dcb0e4-e89c-4fc1-9a5b-4c27a1f710ac
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7363d92a-09bf-42c9-9389-2440dfd89696
          stepCounter: c00d0016-84f1-49db-a23f-a8c23262429d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEOMNIA_SCORE_ADDKEYS.LEVEL1FORCEID=ACCOUNT.FORCEID
        name: ACCOUNTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51242f2b-12a0-45ea-bdfb-000fdb4c550a
                stepCounter: 96e8695b-6733-4729-8797-91b12c74cb7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 306da07c-843b-4e95-ab09-b643567c8010
          stepCounter: c00d0016-84f1-49db-a23f-a8c23262429d
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd860026-39f5-4d31-8615-f30ab3308c4b
          stepCounter: c00d0016-84f1-49db-a23f-a8c23262429d
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DSOMNIA_SCORE: 80dcb0e4-e89c-4fc1-9a5b-4c27a1f710ac
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: ODS
            nodeName: DSOMNIA_SCORE
        join:
          joinCondition: |-
            FROM {{ ref('ODS','DSOMNIA_SCORE') }} DSOMNIA_SCORE
             WHERE DSOMNIA_SCORE.MAXRECEIPTDATE = '$ACTIVEDATEFOROMNIASCORE'
        name: STAGEOMNIA_SCORE_ADDKEYS
        noLinkRefs: []
  name: STAGEOMNIA_SCORE_ADDKEYS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
