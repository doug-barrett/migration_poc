fileVersion: 1
id: 8772cc87-ac8f-4730-963f-fea0f01d4ac7
name: STAGE_FIN_SAP_CC_CORP_HIER
operation:
  config:
    distinct: true
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 261fd35e-fb42-4ca7-8aa1-a95ac067f352
          stepCounter: 8772cc87-ac8f-4730-963f-fea0f01d4ac7
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: The user-defined code to identify the hierarchy.
        isBusinessKey: true
        name: HIERARCHY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dbc113a4-6fe4-4bf6-a5e2-c9ee20c3f025
                stepCounter: d2a87675-2043-44ed-828e-73f3eda32e04
            transform: ODS_SAP_HRRP_NODE_CC.HRYID || '.' || ODS_SAP_HRRP_NODE_CC.HRYVER
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 37558917-0654-4100-a9dc-3425f1d8cfe9
          stepCounter: 8772cc87-ac8f-4730-963f-fea0f01d4ac7
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: The cost centre which the reporting entity is representing.
        isBusinessKey: true
        name: CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b28fee6-b107-44b4-9115-38fcb7ca6e44
                stepCounter: 9b3a977a-eef0-47b3-a40e-a27ab9656405
            transform: LTRIM(ODS_SAP_CSKS.KOSTL,'0')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1179a55-90bc-458b-a9cc-a09755e0494f
          stepCounter: 8772cc87-ac8f-4730-963f-fea0f01d4ac7
        config: {}
        dataType: VARCHAR(400)
        defaultValue: ""
        description: The cost centre which the reporting entity is representing.
        name: CC_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c30bb64-2aca-48c3-ae82-3cf1cd928dab
                stepCounter: 5269b0f1-3982-431e-a886-768117055ef1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f4faeec3-d4dc-4581-a3a2-88eb7edbd972
          stepCounter: 8772cc87-ac8f-4730-963f-fea0f01d4ac7
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: The name or description of the entity.
        name: AREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d6b59a9-750b-4306-9e88-0da463abed6b
                stepCounter: 4246f7de-3060-4b03-a92c-fa843d18bb32
            transform: ODS_SAP_HRRP_NODET_AREA.NODETXT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 58d89017-a49e-4a68-aaab-6c41131debd8
          stepCounter: 8772cc87-ac8f-4730-963f-fea0f01d4ac7
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: The user-defined code for the reporting entity.
        name: AREA_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf4c3307-3453-4118-85b9-bf87830129a4
                stepCounter: d2a87675-2043-44ed-828e-73f3eda32e04
            transform: ODS_SAP_HRRP_NODE_AREA.NODEVALUE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c981e3f6-8671-47a7-be0a-9bd13515bc34
          stepCounter: 8772cc87-ac8f-4730-963f-fea0f01d4ac7
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: The name or description of the entity.
        name: COREAREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d6b59a9-750b-4306-9e88-0da463abed6b
                stepCounter: 4246f7de-3060-4b03-a92c-fa843d18bb32
            transform: ODS_SAP_HRRP_NODET_CORE_AREA.NODETXT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea980738-f39f-4dbd-b42b-e5c3ff68f722
          stepCounter: 8772cc87-ac8f-4730-963f-fea0f01d4ac7
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: The user-defined code for the reporting entity.
        name: COREAREA_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf4c3307-3453-4118-85b9-bf87830129a4
                stepCounter: d2a87675-2043-44ed-828e-73f3eda32e04
            transform: ODS_SAP_HRRP_NODE_CORE_AREA.NODEVALUE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e425f38-1b3f-48d6-856a-5d24e21de449
          stepCounter: 8772cc87-ac8f-4730-963f-fea0f01d4ac7
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: The name or description of the entity.
        name: PROV_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d6b59a9-750b-4306-9e88-0da463abed6b
                stepCounter: 4246f7de-3060-4b03-a92c-fa843d18bb32
            transform: ODS_SAP_HRRP_NODET_PROV.NODETXT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c907cd5b-f4d7-4863-98ad-86154bae9d21
          stepCounter: 8772cc87-ac8f-4730-963f-fea0f01d4ac7
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: The user-defined code for the reporting entity.
        name: PROV_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf4c3307-3453-4118-85b9-bf87830129a4
                stepCounter: d2a87675-2043-44ed-828e-73f3eda32e04
            transform: ODS_SAP_HRRP_NODE_PROV.NODEVALUE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e4e8b00d-8ec4-4d37-ae6a-d0322ce85b13
          stepCounter: 8772cc87-ac8f-4730-963f-fea0f01d4ac7
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: The name or description of the entity.
        name: COUNTRY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d6b59a9-750b-4306-9e88-0da463abed6b
                stepCounter: 4246f7de-3060-4b03-a92c-fa843d18bb32
            transform: ODS_SAP_HRRP_NODET_COUNTRY.NODETXT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c81a40e-f410-4071-88d3-49f5c9186f8f
          stepCounter: 8772cc87-ac8f-4730-963f-fea0f01d4ac7
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: The user-defined code for the reporting entity.
        name: COUNTRY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf4c3307-3453-4118-85b9-bf87830129a4
                stepCounter: d2a87675-2043-44ed-828e-73f3eda32e04
            transform: ODS_SAP_HRRP_NODE_COUNTRY.NODEVALUE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2ede32d-9e78-4d32-89b6-1f6286a4f409
          stepCounter: 8772cc87-ac8f-4730-963f-fea0f01d4ac7
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: The name or description of the entity.
        name: CC_CORP
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'Corporate Totals'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f637b0fa-4daf-492b-be6e-242ef1a280c8
          stepCounter: 8772cc87-ac8f-4730-963f-fea0f01d4ac7
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Operator Run Corporate Hierarchy Attribute
        name: ROUTE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 08696ff5-4575-4c13-ac5e-c39f6aa41578
          stepCounter: 8772cc87-ac8f-4730-963f-fea0f01d4ac7
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: Play  - Mosaic CDM
        name: PLAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8358a8c1-fca3-465e-b7d2-b69d888aa73a
                stepCounter: 4862a13d-6a3e-4e2c-a822-ee9a20721bbf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 68d71e56-b26f-4771-99b4-01da022c59b5
          stepCounter: 8772cc87-ac8f-4730-963f-fea0f01d4ac7
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: Flow Network Name - ProdView
        name: NETWORK_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5db27d66-388e-46a7-9263-a7bf50858c77
                stepCounter: b6918f54-b245-4c9d-b0be-2d7031a80bf7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81dcaeea-a1cd-4cf7-a63b-1c376dc93272
          stepCounter: 8772cc87-ac8f-4730-963f-fea0f01d4ac7
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Facility Name - ProdView
        name: FACILITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6423062a-99ed-40cc-80e4-d67670a29fd0
                stepCounter: b6918f54-b245-4c9d-b0be-2d7031a80bf7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f3193ff9-0b5c-4298-a1a0-4c2a788c04cc
          stepCounter: 8772cc87-ac8f-4730-963f-fea0f01d4ac7
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: BATTERY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a99739b9-5bcf-4b1f-bb29-d33e842fd23a
                stepCounter: b6918f54-b245-4c9d-b0be-2d7031a80bf7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5951993-7e37-47dd-b35c-79d6407416df
          stepCounter: 8772cc87-ac8f-4730-963f-fea0f01d4ac7
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: Corporate Hierarchy Foreman
        name: FOREMAN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed0dfa23-c70b-42c7-a384-c4196d13d231
                stepCounter: b882f5bb-e227-4b54-9698-7619ffc190ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5159d45-9286-45ec-9d74-0ed2bcde6582
          stepCounter: 8772cc87-ac8f-4730-963f-fea0f01d4ac7
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: Foreman Name manually assigned to Cost Center
        name: MANUAL_FOREMAN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fbf610ad-4ff0-4809-81fd-78399f075883
                stepCounter: b6918f54-b245-4c9d-b0be-2d7031a80bf7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 634e5ccd-4d2a-47b2-810a-24c0b8bcecd2
          stepCounter: 8772cc87-ac8f-4730-963f-fea0f01d4ac7
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Sales Point Corporate Hierarchy Attribute
        name: SALES_POINT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f84ef153-20a8-452a-99c9-7eb967bd8309
          stepCounter: 8772cc87-ac8f-4730-963f-fea0f01d4ac7
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: Production Engineer  - Mosaic CDM
        name: PRODUCTION_ENGINEER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ecce4c3-3d0e-4c26-94f2-d69576c525ca
                stepCounter: 4862a13d-6a3e-4e2c-a822-ee9a20721bbf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 488acc25-9c37-4b10-8b45-de06c520883b
          stepCounter: 8772cc87-ac8f-4730-963f-fea0f01d4ac7
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: Exploitation Engineer  - Mosaic CDM
        name: EXPLOITATION_ENGINEER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9f55c389-8624-4c8f-8481-8f641b75e3aa
                stepCounter: 4862a13d-6a3e-4e2c-a822-ee9a20721bbf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b52945bc-bcf8-428f-9925-562863407e93
          stepCounter: 8772cc87-ac8f-4730-963f-fea0f01d4ac7
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Meter Station Corporate Hierarchy Attribute
        name: METER_STATION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8601e83c-abc3-4f95-b40d-23970ac79306
          stepCounter: 8772cc87-ac8f-4730-963f-fea0f01d4ac7
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: Budget Year  - Mosaic CDM
        name: BUDGET_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f53775e-de2e-4a56-a638-b56f370f0c04
                stepCounter: 4862a13d-6a3e-4e2c-a822-ee9a20721bbf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b2e064a8-7d76-477c-a924-e3b3af06eb6b
          stepCounter: 8772cc87-ac8f-4730-963f-fea0f01d4ac7
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: Capital Year  - Mosaic CDM
        name: CAPITAL_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 17813c13-3dcb-4a90-8814-b87a6a9b3c42
                stepCounter: 4862a13d-6a3e-4e2c-a822-ee9a20721bbf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 148da342-1794-498e-94d7-5382a218d8ed
          stepCounter: 8772cc87-ac8f-4730-963f-fea0f01d4ac7
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: Volume Year  - Mosaic CDM
        name: VOLUME_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 08aa4b17-6731-4e4a-bb01-9816682c7671
                stepCounter: 4862a13d-6a3e-4e2c-a822-ee9a20721bbf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5dcd885d-b112-4cbd-8738-60958c2d8751
          stepCounter: 8772cc87-ac8f-4730-963f-fea0f01d4ac7
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: WELL_COUNT_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2f8d93d5-171b-490e-b17a-140e86932e16
                stepCounter: 4862a13d-6a3e-4e2c-a822-ee9a20721bbf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bcb94899-35ce-4175-814b-117b5a0e4b6b
          stepCounter: 8772cc87-ac8f-4730-963f-fea0f01d4ac7
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CDM_RIG_RELEASE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1db59e4-9152-4444-b03a-5f3bf9dd6fe5
                stepCounter: 4862a13d-6a3e-4e2c-a822-ee9a20721bbf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 89f61a9d-5952-4da0-876f-b9238d85d43e
          stepCounter: 8772cc87-ac8f-4730-963f-fea0f01d4ac7
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: License Operator Corporate Hierarchy Attribute
        name: LICENSE_OPERATOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2ab53b9-b354-4b5b-bfee-b86970c68876
                stepCounter: 9b3a977a-eef0-47b3-a40e-a27ab9656405
            transform: DECODE(ODS_SAP_CSKS.ZZNONOP_FLAG,'X','NONOP','OP')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f81cc2e-e29b-41ca-9747-018ed5cff57f
          stepCounter: 8772cc87-ac8f-4730-963f-fea0f01d4ac7
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Physical Operator Corporate Hierarchy Attribute
        name: PHYSICAL_OPERATOR
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a65a0340-d23f-448c-aaba-701ed4c0f882
          stepCounter: 8772cc87-ac8f-4730-963f-fea0f01d4ac7
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Acquisition Corporate Hierarchy Attribute
        name: ACQUISITION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1da552f-e389-4bbb-afc7-0993f04638b4
          stepCounter: 8772cc87-ac8f-4730-963f-fea0f01d4ac7
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: Business Unit Code
        name: BU_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf4c3307-3453-4118-85b9-bf87830129a4
                stepCounter: d2a87675-2043-44ed-828e-73f3eda32e04
            transform: WS_EDW.SAP_COUNTRY_NODEVALUE_VET_BU_CODE(ODS_SAP_HRRP_NODE_COUNTRY.NODEVALUE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6dd145e-8ada-41e1-9a17-e650ce4bfab4
          stepCounter: 8772cc87-ac8f-4730-963f-fea0f01d4ac7
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: Business Unit Description
        name: BU_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d6b59a9-750b-4306-9e88-0da463abed6b
                stepCounter: 4246f7de-3060-4b03-a92c-fa843d18bb32
            transform: WS_EDW.SAP_COUNTRY_NODE_VET_BU_DESC(ODS_SAP_HRRP_NODET_COUNTRY.NODETXT,ODS_SAP_HRRP_NODE_COUNTRY.NODEVALUE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9e4bbd2-e1eb-429c-a95e-da11d948bcb1
          stepCounter: 8772cc87-ac8f-4730-963f-fea0f01d4ac7
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: Row Level Security Role
        name: BU_SF_ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf4c3307-3453-4118-85b9-bf87830129a4
                stepCounter: d2a87675-2043-44ed-828e-73f3eda32e04
            transform: WS_EDW.SAP_COUNTRY_NODEVALUE_VET_BU_ROLE(ODS_SAP_HRRP_NODE_COUNTRY.NODEVALUE)
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ODS_SAP_CSKS: 9b3a977a-eef0-47b3-a40e-a27ab9656405
          ODS_SAP_CSKT: 5269b0f1-3982-431e-a886-768117055ef1
          ODS_SAP_HRRP_NODE: d2a87675-2043-44ed-828e-73f3eda32e04
          ODS_SAP_HRRP_NODET: 4246f7de-3060-4b03-a92c-fa843d18bb32
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: ODS_SAP_HRRP_NODE
          - locationName: TARGET
            nodeName: ODS_SAP_CSKS
          - locationName: TARGET
            nodeName: ODS_SAP_CSKT
          - locationName: TARGET
            nodeName: ODS_SAP_HRRP_NODET
        join:
          joinCondition: |-
            EXTENDED
              FROM (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_CSKS') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) ODS_SAP_CSKS
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_CSKT') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                       AND SPRAS = 'E'
                   ) ODS_SAP_CSKT
                ON ODS_SAP_CSKS.KOSTL = ODS_SAP_CSKT.KOSTL
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_HRRP_NODE') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                       AND HRYID = '{{ parameters.SAP_CORP_HIER_HRYID }}'
                       AND NODETYPE= 'L'
                       AND HRYLEVEL = 5
                   ) ODS_SAP_HRRP_NODE_CC
                ON ODS_SAP_CSKS.KOSTL = ODS_SAP_HRRP_NODE_CC.LEAFVALUE
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_HRRP_NODE') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                       AND HRYID = '{{ parameters.SAP_CORP_HIER_HRYID }}'
                       AND NODETYPE= 'N'
                       AND HRYLEVEL = 4
                   ) ODS_SAP_HRRP_NODE_AREA
                ON ODS_SAP_HRRP_NODE_CC.PARNODE = ODS_SAP_HRRP_NODE_AREA.HRYNODE
               AND ODS_SAP_HRRP_NODE_CC.HRYID = ODS_SAP_HRRP_NODE_AREA.HRYID
               AND ODS_SAP_HRRP_NODE_CC.HRYVER = ODS_SAP_HRRP_NODE_AREA.HRYVER
               AND ODS_SAP_HRRP_NODE_CC.NODECLS = ODS_SAP_HRRP_NODE_AREA.NODECLS
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_HRRP_NODET') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                       AND HRYID = '{{ parameters.SAP_CORP_HIER_HRYID }}'
                       AND SPRAS = 'E'
                   ) ODS_SAP_HRRP_NODET_AREA
                ON ODS_SAP_HRRP_NODE_AREA.HRYNODE = ODS_SAP_HRRP_NODET_AREA.HRYNODE
               AND ODS_SAP_HRRP_NODE_AREA.PARNODE = ODS_SAP_HRRP_NODET_AREA.PARNODE
               AND ODS_SAP_HRRP_NODE_AREA.HRYID = ODS_SAP_HRRP_NODET_AREA.HRYID
               AND ODS_SAP_HRRP_NODE_AREA.HRYVER = ODS_SAP_HRRP_NODET_AREA.HRYVER
               AND ODS_SAP_HRRP_NODE_AREA.NODECLS = ODS_SAP_HRRP_NODET_AREA.NODECLS
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_HRRP_NODE') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                       AND HRYID = '{{ parameters.SAP_CORP_HIER_HRYID }}'
                       AND NODETYPE= 'N'
                       AND HRYLEVEL = 3
                   ) ODS_SAP_HRRP_NODE_CORE_AREA
                ON ODS_SAP_HRRP_NODE_AREA.PARNODE = ODS_SAP_HRRP_NODE_CORE_AREA.HRYNODE
               AND ODS_SAP_HRRP_NODE_AREA.HRYID = ODS_SAP_HRRP_NODE_CORE_AREA.HRYID
               AND ODS_SAP_HRRP_NODE_AREA.HRYVER = ODS_SAP_HRRP_NODE_CORE_AREA.HRYVER
               AND ODS_SAP_HRRP_NODE_AREA.NODECLS = ODS_SAP_HRRP_NODE_CORE_AREA.NODECLS
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_HRRP_NODET') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                       AND HRYID = '{{ parameters.SAP_CORP_HIER_HRYID }}'
                       AND SPRAS = 'E'
                   ) ODS_SAP_HRRP_NODET_CORE_AREA
                ON ODS_SAP_HRRP_NODE_CORE_AREA.HRYNODE = ODS_SAP_HRRP_NODET_CORE_AREA.HRYNODE
               AND ODS_SAP_HRRP_NODE_CORE_AREA.PARNODE = ODS_SAP_HRRP_NODET_CORE_AREA.PARNODE
               AND ODS_SAP_HRRP_NODE_CORE_AREA.HRYID = ODS_SAP_HRRP_NODET_CORE_AREA.HRYID
               AND ODS_SAP_HRRP_NODE_CORE_AREA.HRYVER = ODS_SAP_HRRP_NODET_CORE_AREA.HRYVER
               AND ODS_SAP_HRRP_NODE_CORE_AREA.NODECLS = ODS_SAP_HRRP_NODET_CORE_AREA.NODECLS
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_HRRP_NODE') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                       AND HRYID = '{{ parameters.SAP_CORP_HIER_HRYID }}'
                       AND NODETYPE= 'N'
                       AND HRYLEVEL = 2
                   ) ODS_SAP_HRRP_NODE_PROV
                ON ODS_SAP_HRRP_NODE_CORE_AREA.PARNODE = ODS_SAP_HRRP_NODE_PROV.HRYNODE
               AND ODS_SAP_HRRP_NODE_CORE_AREA.HRYID = ODS_SAP_HRRP_NODE_PROV.HRYID
               AND ODS_SAP_HRRP_NODE_CORE_AREA.HRYVER = ODS_SAP_HRRP_NODE_PROV.HRYVER
               AND ODS_SAP_HRRP_NODE_CORE_AREA.NODECLS = ODS_SAP_HRRP_NODE_PROV.NODECLS
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_HRRP_NODET') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                       AND HRYID = '{{ parameters.SAP_CORP_HIER_HRYID }}'
                       AND SPRAS = 'E'
                   ) ODS_SAP_HRRP_NODET_PROV
                ON ODS_SAP_HRRP_NODE_PROV.HRYNODE = ODS_SAP_HRRP_NODET_PROV.HRYNODE
               AND ODS_SAP_HRRP_NODE_PROV.PARNODE = ODS_SAP_HRRP_NODET_PROV.PARNODE
               AND ODS_SAP_HRRP_NODE_PROV.HRYID = ODS_SAP_HRRP_NODET_PROV.HRYID
               AND ODS_SAP_HRRP_NODE_PROV.HRYV
        name: STAGE_FIN_SAP_CC_CORP_HIER
        noLinkRefs: []
  name: STAGE_FIN_SAP_CC_CORP_HIER
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
