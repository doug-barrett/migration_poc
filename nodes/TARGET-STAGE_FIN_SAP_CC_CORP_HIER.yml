fileVersion: 1
id: 995e1a16-be71-4b9f-ab7a-2bb49304e196
name: STAGE_FIN_SAP_CC_CORP_HIER
operation:
  config:
    distinct: true
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 36c16593-41b2-4dd1-b6aa-89afffcbddcd
          stepCounter: 995e1a16-be71-4b9f-ab7a-2bb49304e196
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: The user-defined code to identify the hierarchy.
        isBusinessKey: true
        name: HIERARCHY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bb9980c5-cea7-4700-80d8-e05a50872c92
                stepCounter: b3d900fd-9a93-4cdd-bc7a-28bb59260ad8
            transform: ODS_SAP_HRRP_NODE_CC.HRYID || '.' || ODS_SAP_HRRP_NODE_CC.HRYVER
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0915450-a0ef-4801-84e6-a7e5294f75a5
          stepCounter: 995e1a16-be71-4b9f-ab7a-2bb49304e196
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: The cost centre which the reporting entity is representing.
        isBusinessKey: true
        name: CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: be491f70-5b6f-4d69-a7ee-1b5962bd80d5
                stepCounter: aa27980f-cc7c-4789-a145-f840ecccef05
            transform: LTRIM(ODS_SAP_CSKS.KOSTL,'0')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a24bde27-2774-4d8f-beca-a5fe51819425
          stepCounter: 995e1a16-be71-4b9f-ab7a-2bb49304e196
        config: {}
        dataType: VARCHAR(400)
        defaultValue: ""
        description: The cost centre which the reporting entity is representing.
        name: CC_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7fa21ccf-3c3e-4443-96a9-2fd31626dd24
                stepCounter: 42fb1903-01e2-4ed6-b472-c551a2d86b97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72d659b4-3021-435a-a769-40a46b4e7ac0
          stepCounter: 995e1a16-be71-4b9f-ab7a-2bb49304e196
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: The name or description of the entity.
        name: AREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe5762a6-a0d3-4039-b29e-82d024940177
                stepCounter: 142d1196-5f9a-4f07-a28a-43d43f678f01
            transform: ODS_SAP_HRRP_NODET_AREA.NODETXT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 814132f5-4459-4925-a555-7c07488c267a
          stepCounter: 995e1a16-be71-4b9f-ab7a-2bb49304e196
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: The user-defined code for the reporting entity.
        name: AREA_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c8f2f01-31e2-48b1-8067-b0fc488c9733
                stepCounter: b3d900fd-9a93-4cdd-bc7a-28bb59260ad8
            transform: ODS_SAP_HRRP_NODE_AREA.NODEVALUE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc3f2a38-8744-492a-a934-edd8419ab309
          stepCounter: 995e1a16-be71-4b9f-ab7a-2bb49304e196
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: The name or description of the entity.
        name: COREAREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe5762a6-a0d3-4039-b29e-82d024940177
                stepCounter: 142d1196-5f9a-4f07-a28a-43d43f678f01
            transform: ODS_SAP_HRRP_NODET_CORE_AREA.NODETXT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc6165d8-3002-41ff-9300-b72d36037a08
          stepCounter: 995e1a16-be71-4b9f-ab7a-2bb49304e196
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: The user-defined code for the reporting entity.
        name: COREAREA_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c8f2f01-31e2-48b1-8067-b0fc488c9733
                stepCounter: b3d900fd-9a93-4cdd-bc7a-28bb59260ad8
            transform: ODS_SAP_HRRP_NODE_CORE_AREA.NODEVALUE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 63fcfe91-fa16-427e-8046-b11d3628c07c
          stepCounter: 995e1a16-be71-4b9f-ab7a-2bb49304e196
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: The name or description of the entity.
        name: PROV_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe5762a6-a0d3-4039-b29e-82d024940177
                stepCounter: 142d1196-5f9a-4f07-a28a-43d43f678f01
            transform: ODS_SAP_HRRP_NODET_PROV.NODETXT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80691eaa-b142-491c-8be1-bf0fb6a8808f
          stepCounter: 995e1a16-be71-4b9f-ab7a-2bb49304e196
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: The user-defined code for the reporting entity.
        name: PROV_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c8f2f01-31e2-48b1-8067-b0fc488c9733
                stepCounter: b3d900fd-9a93-4cdd-bc7a-28bb59260ad8
            transform: ODS_SAP_HRRP_NODE_PROV.NODEVALUE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34763c71-ac3c-46d7-8f72-0beac02cc6e3
          stepCounter: 995e1a16-be71-4b9f-ab7a-2bb49304e196
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: The name or description of the entity.
        name: COUNTRY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe5762a6-a0d3-4039-b29e-82d024940177
                stepCounter: 142d1196-5f9a-4f07-a28a-43d43f678f01
            transform: ODS_SAP_HRRP_NODET_COUNTRY.NODETXT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 014abbe5-bf67-426a-ac87-205a797a5227
          stepCounter: 995e1a16-be71-4b9f-ab7a-2bb49304e196
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: The user-defined code for the reporting entity.
        name: COUNTRY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c8f2f01-31e2-48b1-8067-b0fc488c9733
                stepCounter: b3d900fd-9a93-4cdd-bc7a-28bb59260ad8
            transform: ODS_SAP_HRRP_NODE_COUNTRY.NODEVALUE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1bdf94a-1f94-4dd8-8984-28ee2b314345
          stepCounter: 995e1a16-be71-4b9f-ab7a-2bb49304e196
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: The name or description of the entity.
        name: CC_CORP
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'Corporate Totals'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb08857e-2923-4564-b0e9-8d07a11b08ad
          stepCounter: 995e1a16-be71-4b9f-ab7a-2bb49304e196
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Operator Run Corporate Hierarchy Attribute
        name: ROUTE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 10abf65a-4633-4897-91f2-53aacef1b05a
          stepCounter: 995e1a16-be71-4b9f-ab7a-2bb49304e196
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: Play  - Mosaic CDM
        name: PLAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1b57f6c-5099-4c05-b199-50d3642547e7
                stepCounter: d3bb075f-6876-4033-9918-0cb6a950552c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 676caf9f-d3a4-4a23-82d9-b84c8a082faa
          stepCounter: 995e1a16-be71-4b9f-ab7a-2bb49304e196
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: Flow Network Name - ProdView
        name: NETWORK_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a32a156a-c4f5-4232-a4e0-6bcd64ba91bc
                stepCounter: 12f38148-3b96-4f0c-b614-36440c497173
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3deb07d9-865c-42b6-9171-c3469683f81b
          stepCounter: 995e1a16-be71-4b9f-ab7a-2bb49304e196
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Facility Name - ProdView
        name: FACILITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c1013352-be5c-4218-bec0-0eb64b7d30c8
                stepCounter: 12f38148-3b96-4f0c-b614-36440c497173
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22883b68-6187-4a81-b44f-3e5e1f8f73a6
          stepCounter: 995e1a16-be71-4b9f-ab7a-2bb49304e196
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: BATTERY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a53cbc7f-a6cd-46a8-8efc-16a761b0bd12
                stepCounter: 12f38148-3b96-4f0c-b614-36440c497173
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31c7ac12-c241-4699-b072-930f97d5a429
          stepCounter: 995e1a16-be71-4b9f-ab7a-2bb49304e196
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: Corporate Hierarchy Foreman
        name: FOREMAN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47d18fc6-f8af-4624-8d67-d8a1d589fae4
                stepCounter: 1016240c-0e61-47ca-9368-8310c1cb9dc5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af76ea0e-4074-40c6-9239-b21334b3b64d
          stepCounter: 995e1a16-be71-4b9f-ab7a-2bb49304e196
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: Foreman Name manually assigned to Cost Center
        name: MANUAL_FOREMAN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f4217b18-8d59-48bf-84e8-2d1f586e8f15
                stepCounter: 12f38148-3b96-4f0c-b614-36440c497173
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e782b89-718e-4153-a455-d6b72fd23225
          stepCounter: 995e1a16-be71-4b9f-ab7a-2bb49304e196
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Sales Point Corporate Hierarchy Attribute
        name: SALES_POINT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17c222f0-5b7b-4277-93e4-9522ddaf0337
          stepCounter: 995e1a16-be71-4b9f-ab7a-2bb49304e196
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: Production Engineer  - Mosaic CDM
        name: PRODUCTION_ENGINEER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e315c793-5589-4f76-91c1-c2e87270f2c5
                stepCounter: d3bb075f-6876-4033-9918-0cb6a950552c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1837a7fa-e4d9-4e03-89e3-db91be4bbfd2
          stepCounter: 995e1a16-be71-4b9f-ab7a-2bb49304e196
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: Exploitation Engineer  - Mosaic CDM
        name: EXPLOITATION_ENGINEER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 98fc03f4-3544-46e6-b20a-8c039938a8b0
                stepCounter: d3bb075f-6876-4033-9918-0cb6a950552c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba1c4f6e-3542-4464-9012-f1a4f0829c10
          stepCounter: 995e1a16-be71-4b9f-ab7a-2bb49304e196
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Meter Station Corporate Hierarchy Attribute
        name: METER_STATION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 851ce1c8-b3b2-47e5-8d77-ce317c888817
          stepCounter: 995e1a16-be71-4b9f-ab7a-2bb49304e196
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: Budget Year  - Mosaic CDM
        name: BUDGET_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e534d4ef-42f0-424c-beb1-2c5481a45902
                stepCounter: d3bb075f-6876-4033-9918-0cb6a950552c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c41e0e5-ca38-4536-a7af-3937a0f115e6
          stepCounter: 995e1a16-be71-4b9f-ab7a-2bb49304e196
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: Capital Year  - Mosaic CDM
        name: CAPITAL_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76f4c031-bf51-4f09-8d81-082c8c7a4453
                stepCounter: d3bb075f-6876-4033-9918-0cb6a950552c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 10025ab4-bc69-4102-8753-58d495a6b78f
          stepCounter: 995e1a16-be71-4b9f-ab7a-2bb49304e196
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: Volume Year  - Mosaic CDM
        name: VOLUME_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a897687-842a-4f6d-a807-e0e94cfd5e18
                stepCounter: d3bb075f-6876-4033-9918-0cb6a950552c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9dec0c1a-6255-4387-b9a2-4dcb350eb603
          stepCounter: 995e1a16-be71-4b9f-ab7a-2bb49304e196
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: WELL_COUNT_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ff5d0f4-9ab7-495a-a6ac-5896602ec40e
                stepCounter: d3bb075f-6876-4033-9918-0cb6a950552c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1abb2e74-5576-45a8-bdde-88a4ddb7030f
          stepCounter: 995e1a16-be71-4b9f-ab7a-2bb49304e196
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CDM_RIG_RELEASE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ea31901-3ca5-4d45-856f-3714a0f89461
                stepCounter: d3bb075f-6876-4033-9918-0cb6a950552c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e43fe2ad-0e16-4d5c-9c8a-e247fdb23231
          stepCounter: 995e1a16-be71-4b9f-ab7a-2bb49304e196
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: License Operator Corporate Hierarchy Attribute
        name: LICENSE_OPERATOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 12f31cab-d8bc-44f8-97ac-5a92ea906ff7
                stepCounter: aa27980f-cc7c-4789-a145-f840ecccef05
            transform: DECODE(ODS_SAP_CSKS.ZZNONOP_FLAG,'X','NONOP','OP')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f8184687-400c-44fa-a58f-848796b922ac
          stepCounter: 995e1a16-be71-4b9f-ab7a-2bb49304e196
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Physical Operator Corporate Hierarchy Attribute
        name: PHYSICAL_OPERATOR
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7999405-53c4-453b-913e-96be58a68bed
          stepCounter: 995e1a16-be71-4b9f-ab7a-2bb49304e196
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Acquisition Corporate Hierarchy Attribute
        name: ACQUISITION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26d826e0-46b8-464e-887d-55b9db5f3e6b
          stepCounter: 995e1a16-be71-4b9f-ab7a-2bb49304e196
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: Business Unit Code
        name: BU_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c8f2f01-31e2-48b1-8067-b0fc488c9733
                stepCounter: b3d900fd-9a93-4cdd-bc7a-28bb59260ad8
            transform: WS_EDW.SAP_COUNTRY_NODEVALUE_VET_BU_CODE(ODS_SAP_HRRP_NODE_COUNTRY.NODEVALUE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 817b8093-29de-43be-9b02-3b0efada3ad5
          stepCounter: 995e1a16-be71-4b9f-ab7a-2bb49304e196
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: Business Unit Description
        name: BU_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe5762a6-a0d3-4039-b29e-82d024940177
                stepCounter: 142d1196-5f9a-4f07-a28a-43d43f678f01
            transform: WS_EDW.SAP_COUNTRY_NODE_VET_BU_DESC(ODS_SAP_HRRP_NODET_COUNTRY.NODETXT,ODS_SAP_HRRP_NODE_COUNTRY.NODEVALUE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1bac627-995d-47b2-8dfc-0beef3d807f8
          stepCounter: 995e1a16-be71-4b9f-ab7a-2bb49304e196
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: Row Level Security Role
        name: BU_SF_ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c8f2f01-31e2-48b1-8067-b0fc488c9733
                stepCounter: b3d900fd-9a93-4cdd-bc7a-28bb59260ad8
            transform: WS_EDW.SAP_COUNTRY_NODEVALUE_VET_BU_ROLE(ODS_SAP_HRRP_NODE_COUNTRY.NODEVALUE)
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ODS_SAP_CSKS: aa27980f-cc7c-4789-a145-f840ecccef05
          ODS_SAP_CSKT: 42fb1903-01e2-4ed6-b472-c551a2d86b97
          ODS_SAP_HRRP_NODE: b3d900fd-9a93-4cdd-bc7a-28bb59260ad8
          ODS_SAP_HRRP_NODET: 142d1196-5f9a-4f07-a28a-43d43f678f01
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: ODS_SAP_HRRP_NODE
          - locationName: TARGET
            nodeName: ODS_SAP_CSKS
          - locationName: TARGET
            nodeName: ODS_SAP_CSKT
          - locationName: TARGET
            nodeName: ODS_SAP_HRRP_NODET
        join:
          joinCondition: |-
            EXTENDED
              FROM (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_CSKS') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) ODS_SAP_CSKS
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_CSKT') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                       AND SPRAS = 'E'
                   ) ODS_SAP_CSKT
                ON ODS_SAP_CSKS.KOSTL = ODS_SAP_CSKT.KOSTL
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_HRRP_NODE') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                       AND HRYID = '{{ parameters.SAP_CORP_HIER_HRYID }}'
                       AND NODETYPE= 'L'
                       AND HRYLEVEL = 5
                   ) ODS_SAP_HRRP_NODE_CC
                ON ODS_SAP_CSKS.KOSTL = ODS_SAP_HRRP_NODE_CC.LEAFVALUE
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_HRRP_NODE') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                       AND HRYID = '{{ parameters.SAP_CORP_HIER_HRYID }}'
                       AND NODETYPE= 'N'
                       AND HRYLEVEL = 4
                   ) ODS_SAP_HRRP_NODE_AREA
                ON ODS_SAP_HRRP_NODE_CC.PARNODE = ODS_SAP_HRRP_NODE_AREA.HRYNODE
               AND ODS_SAP_HRRP_NODE_CC.HRYID = ODS_SAP_HRRP_NODE_AREA.HRYID
               AND ODS_SAP_HRRP_NODE_CC.HRYVER = ODS_SAP_HRRP_NODE_AREA.HRYVER
               AND ODS_SAP_HRRP_NODE_CC.NODECLS = ODS_SAP_HRRP_NODE_AREA.NODECLS
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_HRRP_NODET') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                       AND HRYID = '{{ parameters.SAP_CORP_HIER_HRYID }}'
                       AND SPRAS = 'E'
                   ) ODS_SAP_HRRP_NODET_AREA
                ON ODS_SAP_HRRP_NODE_AREA.HRYNODE = ODS_SAP_HRRP_NODET_AREA.HRYNODE
               AND ODS_SAP_HRRP_NODE_AREA.PARNODE = ODS_SAP_HRRP_NODET_AREA.PARNODE
               AND ODS_SAP_HRRP_NODE_AREA.HRYID = ODS_SAP_HRRP_NODET_AREA.HRYID
               AND ODS_SAP_HRRP_NODE_AREA.HRYVER = ODS_SAP_HRRP_NODET_AREA.HRYVER
               AND ODS_SAP_HRRP_NODE_AREA.NODECLS = ODS_SAP_HRRP_NODET_AREA.NODECLS
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_HRRP_NODE') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                       AND HRYID = '{{ parameters.SAP_CORP_HIER_HRYID }}'
                       AND NODETYPE= 'N'
                       AND HRYLEVEL = 3
                   ) ODS_SAP_HRRP_NODE_CORE_AREA
                ON ODS_SAP_HRRP_NODE_AREA.PARNODE = ODS_SAP_HRRP_NODE_CORE_AREA.HRYNODE
               AND ODS_SAP_HRRP_NODE_AREA.HRYID = ODS_SAP_HRRP_NODE_CORE_AREA.HRYID
               AND ODS_SAP_HRRP_NODE_AREA.HRYVER = ODS_SAP_HRRP_NODE_CORE_AREA.HRYVER
               AND ODS_SAP_HRRP_NODE_AREA.NODECLS = ODS_SAP_HRRP_NODE_CORE_AREA.NODECLS
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_HRRP_NODET') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                       AND HRYID = '{{ parameters.SAP_CORP_HIER_HRYID }}'
                       AND SPRAS = 'E'
                   ) ODS_SAP_HRRP_NODET_CORE_AREA
                ON ODS_SAP_HRRP_NODE_CORE_AREA.HRYNODE = ODS_SAP_HRRP_NODET_CORE_AREA.HRYNODE
               AND ODS_SAP_HRRP_NODE_CORE_AREA.PARNODE = ODS_SAP_HRRP_NODET_CORE_AREA.PARNODE
               AND ODS_SAP_HRRP_NODE_CORE_AREA.HRYID = ODS_SAP_HRRP_NODET_CORE_AREA.HRYID
               AND ODS_SAP_HRRP_NODE_CORE_AREA.HRYVER = ODS_SAP_HRRP_NODET_CORE_AREA.HRYVER
               AND ODS_SAP_HRRP_NODE_CORE_AREA.NODECLS = ODS_SAP_HRRP_NODET_CORE_AREA.NODECLS
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_HRRP_NODE') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                       AND HRYID = '{{ parameters.SAP_CORP_HIER_HRYID }}'
                       AND NODETYPE= 'N'
                       AND HRYLEVEL = 2
                   ) ODS_SAP_HRRP_NODE_PROV
                ON ODS_SAP_HRRP_NODE_CORE_AREA.PARNODE = ODS_SAP_HRRP_NODE_PROV.HRYNODE
               AND ODS_SAP_HRRP_NODE_CORE_AREA.HRYID = ODS_SAP_HRRP_NODE_PROV.HRYID
               AND ODS_SAP_HRRP_NODE_CORE_AREA.HRYVER = ODS_SAP_HRRP_NODE_PROV.HRYVER
               AND ODS_SAP_HRRP_NODE_CORE_AREA.NODECLS = ODS_SAP_HRRP_NODE_PROV.NODECLS
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_HRRP_NODET') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                       AND HRYID = '{{ parameters.SAP_CORP_HIER_HRYID }}'
                       AND SPRAS = 'E'
                   ) ODS_SAP_HRRP_NODET_PROV
                ON ODS_SAP_HRRP_NODE_PROV.HRYNODE = ODS_SAP_HRRP_NODET_PROV.HRYNODE
               AND ODS_SAP_HRRP_NODE_PROV.PARNODE = ODS_SAP_HRRP_NODET_PROV.PARNODE
               AND ODS_SAP_HRRP_NODE_PROV.HRYID = ODS_SAP_HRRP_NODET_PROV.HRYID
               AND ODS_SAP_HRRP_NODE_PROV.HRYV
        name: STAGE_FIN_SAP_CC_CORP_HIER
        noLinkRefs: []
  name: STAGE_FIN_SAP_CC_CORP_HIER
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
