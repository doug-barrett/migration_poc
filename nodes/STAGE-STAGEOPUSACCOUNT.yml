fileVersion: 1
id: 8604b635-f4a4-402c-80ab-3b33f3f13b04
name: STAGEOPUSACCOUNT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 36891915-eb71-4f7f-95f1-972e52af6645
          stepCounter: 8604b635-f4a4-402c-80ab-3b33f3f13b04
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1aebfdb7-d5f7-4335-a659-7cd441ad9e48
                stepCounter: c49fee82-63c4-4138-9e14-3fdab8a0e20e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3def2a6b-a6f0-4788-8e27-1864d3c6b13c
          stepCounter: 8604b635-f4a4-402c-80ab-3b33f3f13b04
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ACCOUNT_RANK_BY_CREATED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ROW_NUMBER() OVER(PARTITION BY LOADOPUSACCOUNT.FORCEID ORDER BY LOADOPUSACCOUNT.CREATEDDATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2829b4a-5f19-47eb-b5c3-5a1266b02558
          stepCounter: 8604b635-f4a4-402c-80ab-3b33f3f13b04
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78499783-93a1-4da0-ba1b-f1cb0f3e3b1a
                stepCounter: c49fee82-63c4-4138-9e14-3fdab8a0e20e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de432eec-22a1-47b3-8c6c-f30f9140181e
          stepCounter: 8604b635-f4a4-402c-80ab-3b33f3f13b04
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f2c4dc1-ecfa-4776-86da-33356173d823
                stepCounter: c49fee82-63c4-4138-9e14-3fdab8a0e20e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6dc1df3-6cb3-44d4-a5a3-a40c234ef0f7
          stepCounter: 8604b635-f4a4-402c-80ab-3b33f3f13b04
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 32d16773-7e96-48b9-9974-0d68e8841da8
                stepCounter: c49fee82-63c4-4138-9e14-3fdab8a0e20e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1f99190-3745-446f-ad5d-c128c665c809
          stepCounter: 8604b635-f4a4-402c-80ab-3b33f3f13b04
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CREATEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5f9aa98-6c07-4487-b553-78186cd64105
                stepCounter: c49fee82-63c4-4138-9e14-3fdab8a0e20e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c708bde-7bb2-45ca-93b1-de81b1826b87
          stepCounter: 8604b635-f4a4-402c-80ab-3b33f3f13b04
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: MODIFIEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 61251e96-1c6a-4f19-b74f-44346a05fd5a
                stepCounter: c49fee82-63c4-4138-9e14-3fdab8a0e20e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 10e307c3-2f5b-495a-8540-e6bfde02dba1
          stepCounter: 8604b635-f4a4-402c-80ab-3b33f3f13b04
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: APPROVEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7eea6d59-fbd0-45f0-a94a-7ac4a1136a61
                stepCounter: c49fee82-63c4-4138-9e14-3fdab8a0e20e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ab479e0-573d-4c40-a30c-839714eb7525
          stepCounter: 8604b635-f4a4-402c-80ab-3b33f3f13b04
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b743d08-47e8-404c-94e0-125ce99793c7
                stepCounter: c49fee82-63c4-4138-9e14-3fdab8a0e20e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 843d4fa5-9edf-4248-a924-73de4c46235d
          stepCounter: 8604b635-f4a4-402c-80ab-3b33f3f13b04
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TAXEXEMPT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c9d7157b-ad4b-46cb-8ef3-dade0b792043
                stepCounter: c49fee82-63c4-4138-9e14-3fdab8a0e20e
            transform: CASE LOADOPUSACCOUNT.TAXEXEMPT \N WHEN 0 \N THEN 'FALSE' \N WHEN 1 \N THEN 'TRUE' \NELSE NULL \NEND
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1fb6c35c-a6ca-483d-9c1a-ffd0a600a6cc
          stepCounter: 8604b635-f4a4-402c-80ab-3b33f3f13b04
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d618972b-dc17-4a63-b54c-a970fca01a82
                stepCounter: c49fee82-63c4-4138-9e14-3fdab8a0e20e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef7c0ae1-f252-45d2-92b5-fe775d987e78
          stepCounter: 8604b635-f4a4-402c-80ab-3b33f3f13b04
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64a5f385-d593-45ac-af30-c1ab311c2893
          stepCounter: 8604b635-f4a4-402c-80ab-3b33f3f13b04
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOADOPUSACCOUNT: c49fee82-63c4-4138-9e14-3fdab8a0e20e
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOADOPUSACCOUNT
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOADOPUSACCOUNT') }} LOADOPUSACCOUNT
             WHERE TRY_TO_NUMBER(LOADOPUSACCOUNT.FORCEID) IS NOT NULL
        name: STAGEOPUSACCOUNT
        noLinkRefs: []
  name: STAGEOPUSACCOUNT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
