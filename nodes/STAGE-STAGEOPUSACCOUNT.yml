fileVersion: 1
id: 85e1ab57-8049-4aa0-8327-024fed35cf07
name: STAGEOPUSACCOUNT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88bed9d8-f3b0-4596-a1e6-dd1f1b9693da
          stepCounter: 85e1ab57-8049-4aa0-8327-024fed35cf07
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2cb20ac-d6ef-4aa9-8487-ac052ff5c721
                stepCounter: b7201e9e-d5ff-4ee1-8d74-a3cc96044135
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1beff70-e3e6-4edf-8fe9-42efda815fe0
          stepCounter: 85e1ab57-8049-4aa0-8327-024fed35cf07
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ACCOUNT_RANK_BY_CREATED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ROW_NUMBER() OVER(PARTITION BY LOADOPUSACCOUNT.FORCEID ORDER BY LOADOPUSACCOUNT.CREATEDDATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f883ed46-cefd-47d2-9f7c-b6defec5efc5
          stepCounter: 85e1ab57-8049-4aa0-8327-024fed35cf07
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3045554f-51ee-47b6-b0fa-6c4cad27973c
                stepCounter: b7201e9e-d5ff-4ee1-8d74-a3cc96044135
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 738bd26d-49c8-419f-8b27-a02a7e255061
          stepCounter: 85e1ab57-8049-4aa0-8327-024fed35cf07
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ba2951d3-d27d-44e6-9eb8-c7ff9030d281
                stepCounter: b7201e9e-d5ff-4ee1-8d74-a3cc96044135
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cfa4a7b9-bfd1-4a03-b9cd-b5df74cf3041
          stepCounter: 85e1ab57-8049-4aa0-8327-024fed35cf07
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51216395-5269-44f1-ab7f-cf03dfa5fa23
                stepCounter: b7201e9e-d5ff-4ee1-8d74-a3cc96044135
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 60fb0480-ebb5-48e8-be05-94c16e5821b7
          stepCounter: 85e1ab57-8049-4aa0-8327-024fed35cf07
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CREATEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e75f3dcd-232b-4329-ac91-86f77aa139e2
                stepCounter: b7201e9e-d5ff-4ee1-8d74-a3cc96044135
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c87f8f2-4b2d-4d16-be17-4cdcbed2c005
          stepCounter: 85e1ab57-8049-4aa0-8327-024fed35cf07
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: MODIFIEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f38d7ab5-7959-4fdf-b3dc-8f1a110e541d
                stepCounter: b7201e9e-d5ff-4ee1-8d74-a3cc96044135
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a928f27-08b7-4389-b610-e250cc7de22b
          stepCounter: 85e1ab57-8049-4aa0-8327-024fed35cf07
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: APPROVEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d030aab-a45e-4a70-9025-0c54085cbcbf
                stepCounter: b7201e9e-d5ff-4ee1-8d74-a3cc96044135
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d8c386e-bc60-4fa4-830c-ab8dd434d009
          stepCounter: 85e1ab57-8049-4aa0-8327-024fed35cf07
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b595aedc-248e-4e06-b590-ac44d8c237f9
                stepCounter: b7201e9e-d5ff-4ee1-8d74-a3cc96044135
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d675d10-446d-43c0-94d0-2f9d26e1da0f
          stepCounter: 85e1ab57-8049-4aa0-8327-024fed35cf07
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TAXEXEMPT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e045b218-3155-434f-8088-2d2e80d8caff
                stepCounter: b7201e9e-d5ff-4ee1-8d74-a3cc96044135
            transform: CASE LOADOPUSACCOUNT.TAXEXEMPT \N WHEN 0 \N THEN 'FALSE' \N WHEN 1 \N THEN 'TRUE' \NELSE NULL \NEND
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82ce73cf-cc5c-4f70-835b-16dd3cd61a85
          stepCounter: 85e1ab57-8049-4aa0-8327-024fed35cf07
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc6c1e66-6b99-4a24-9939-a80ad55bfa29
                stepCounter: b7201e9e-d5ff-4ee1-8d74-a3cc96044135
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2fe9261-c4ef-4361-83af-7db6fb23ff28
          stepCounter: 85e1ab57-8049-4aa0-8327-024fed35cf07
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 395f5165-3596-447b-8ee6-4a542e7bb139
          stepCounter: 85e1ab57-8049-4aa0-8327-024fed35cf07
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOADOPUSACCOUNT: b7201e9e-d5ff-4ee1-8d74-a3cc96044135
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOADOPUSACCOUNT
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOADOPUSACCOUNT') }} LOADOPUSACCOUNT
             WHERE TRY_TO_NUMBER(LOADOPUSACCOUNT.FORCEID) IS NOT NULL
        name: STAGEOPUSACCOUNT
        noLinkRefs: []
  name: STAGEOPUSACCOUNT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
