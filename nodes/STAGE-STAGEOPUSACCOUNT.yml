fileVersion: 1
id: 09e3633e-fb33-43cc-955d-8699b680a11e
name: STAGEOPUSACCOUNT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e4d7dcca-f058-4e78-b9f7-c855bd912415
          stepCounter: 09e3633e-fb33-43cc-955d-8699b680a11e
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2beb1f40-512d-4601-97fc-4b24259feba6
                stepCounter: d00c31bc-1da0-4e65-b2b6-3aa4b57a27e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a55a3589-e680-4464-afad-241039691294
          stepCounter: 09e3633e-fb33-43cc-955d-8699b680a11e
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ACCOUNT_RANK_BY_CREATED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ROW_NUMBER() OVER(PARTITION BY LoadOPUSACCOUNT.FORCEID ORDER BY LoadOPUSACCOUNT.CREATEDDATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9cd8c5f-868a-4085-adda-9eaff9950197
          stepCounter: 09e3633e-fb33-43cc-955d-8699b680a11e
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a455b7a-a5bb-41cc-af49-cfa4db8b88e3
                stepCounter: d00c31bc-1da0-4e65-b2b6-3aa4b57a27e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ebce0b85-460c-409c-b7ef-fc83e8d7ef57
          stepCounter: 09e3633e-fb33-43cc-955d-8699b680a11e
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e12ab8f-5a36-4741-ae92-e70b256c785d
                stepCounter: d00c31bc-1da0-4e65-b2b6-3aa4b57a27e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3c2eb23-1866-40fe-82f2-179d55fb1126
          stepCounter: 09e3633e-fb33-43cc-955d-8699b680a11e
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 219653b3-102e-4987-bc00-e5f479753673
                stepCounter: d00c31bc-1da0-4e65-b2b6-3aa4b57a27e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb93c273-d106-4223-a707-76a7aecf84c5
          stepCounter: 09e3633e-fb33-43cc-955d-8699b680a11e
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CREATEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: efcba480-9311-4341-9122-c951ce5383cd
                stepCounter: d00c31bc-1da0-4e65-b2b6-3aa4b57a27e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3d57622-4455-4fe5-b422-5c507a24d4c6
          stepCounter: 09e3633e-fb33-43cc-955d-8699b680a11e
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: MODIFIEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 96474a77-8d9b-433a-b148-b7a97c8e9f51
                stepCounter: d00c31bc-1da0-4e65-b2b6-3aa4b57a27e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0a6a721-704d-4825-b6af-c4830d98e65d
          stepCounter: 09e3633e-fb33-43cc-955d-8699b680a11e
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: APPROVEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d8dfa3e-ffe1-4114-9683-4eb1de7de288
                stepCounter: d00c31bc-1da0-4e65-b2b6-3aa4b57a27e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53c93050-0628-4859-8313-7b8a280be2ed
          stepCounter: 09e3633e-fb33-43cc-955d-8699b680a11e
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: Record source.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0455b3a0-ea1f-4c81-bec4-1351c7a704bc
                stepCounter: d00c31bc-1da0-4e65-b2b6-3aa4b57a27e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a2ab745-cba3-4877-a49a-c718b18a16db
          stepCounter: 09e3633e-fb33-43cc-955d-8699b680a11e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TAXEXEMPT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f820d90b-8c13-4d43-93b6-e570cc3d988e
                stepCounter: d00c31bc-1da0-4e65-b2b6-3aa4b57a27e7
            transform: |-
              CASE LoadOPUSACCOUNT.TAXEXEMPT
                          WHEN 0                    THEN 'FALSE'
                          WHEN 1                    THEN 'TRUE'
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6ba3cb4-b43b-4b9d-a1d4-c82d4b1dca1e
          stepCounter: 09e3633e-fb33-43cc-955d-8699b680a11e
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Load date.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 803ff0f6-158a-4fc1-a5e0-acfabf9b7a01
                stepCounter: d00c31bc-1da0-4e65-b2b6-3aa4b57a27e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d61c32c-c975-4070-99ba-959834a95140
          stepCounter: 09e3633e-fb33-43cc-955d-8699b680a11e
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb65fe56-2ebc-46d5-929e-1ed61ada9971
          stepCounter: 09e3633e-fb33-43cc-955d-8699b680a11e
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOADOPUSACCOUNT: d00c31bc-1da0-4e65-b2b6-3aa4b57a27e7
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOADOPUSACCOUNT
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOADOPUSACCOUNT') }} LoadOPUSACCOUNT
             WHERE TRY_TO_NUMBER(LoadOPUSACCOUNT.FORCEID) IS NOT NULL
        name: STAGEOPUSACCOUNT
        noLinkRefs: []
  name: STAGEOPUSACCOUNT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
