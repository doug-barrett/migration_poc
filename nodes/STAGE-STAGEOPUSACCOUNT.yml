fileVersion: 1
id: d94982b8-5095-49c8-84c9-3a46d89f0a1c
name: STAGEOPUSACCOUNT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8441d6b4-f6a2-4276-a24d-ccb058b4c526
          stepCounter: d94982b8-5095-49c8-84c9-3a46d89f0a1c
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 14c5b643-8a13-4e3e-b270-0aa3595ec8e4
                stepCounter: 37db83a5-1d14-4fed-ad4d-e248bcc1fb37
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 421f0497-c261-41f5-b04e-917a9d40b9cd
          stepCounter: d94982b8-5095-49c8-84c9-3a46d89f0a1c
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ACCOUNT_RANK_BY_CREATED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ROW_NUMBER() OVER(PARTITION BY LoadOPUSACCOUNT.FORCEID ORDER BY LoadOPUSACCOUNT.CREATEDDATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5838e74d-b8af-40ea-8e1f-239da0762440
          stepCounter: d94982b8-5095-49c8-84c9-3a46d89f0a1c
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 470bdc38-1c42-4c42-9318-e466cba80044
                stepCounter: 37db83a5-1d14-4fed-ad4d-e248bcc1fb37
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1fd15f04-ba5f-4b49-936c-c09ffd418ccd
          stepCounter: d94982b8-5095-49c8-84c9-3a46d89f0a1c
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a34b38c3-7dfe-40f6-b7d4-ff4f39bbfbff
                stepCounter: 37db83a5-1d14-4fed-ad4d-e248bcc1fb37
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87b24686-a04c-4264-934d-c3dcbec74be1
          stepCounter: d94982b8-5095-49c8-84c9-3a46d89f0a1c
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 022e2370-cf66-4fda-a81d-87a02a8d0eb7
                stepCounter: 37db83a5-1d14-4fed-ad4d-e248bcc1fb37
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c64e41a2-2bd0-4509-8872-64df601d47ca
          stepCounter: d94982b8-5095-49c8-84c9-3a46d89f0a1c
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CREATEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f980f83b-ff07-4212-90b8-a6bc134200c1
                stepCounter: 37db83a5-1d14-4fed-ad4d-e248bcc1fb37
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ae64cc1-f05a-4083-9096-17351980868e
          stepCounter: d94982b8-5095-49c8-84c9-3a46d89f0a1c
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: MODIFIEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 561e821c-bd34-4f6b-86ff-32cf10beca30
                stepCounter: 37db83a5-1d14-4fed-ad4d-e248bcc1fb37
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31472b6b-441b-449c-b469-be3e10d43cdc
          stepCounter: d94982b8-5095-49c8-84c9-3a46d89f0a1c
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: APPROVEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f45cdd00-8203-4b4f-8a3c-1cf8fddd9619
                stepCounter: 37db83a5-1d14-4fed-ad4d-e248bcc1fb37
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 356606b5-1e9b-4d7d-804f-758d74ac6fab
          stepCounter: d94982b8-5095-49c8-84c9-3a46d89f0a1c
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: Record source.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a8d26ea-6d91-4897-a553-ddd111f614c3
                stepCounter: 37db83a5-1d14-4fed-ad4d-e248bcc1fb37
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17976578-d304-42e5-8cc6-ca3a4cdfc6e1
          stepCounter: d94982b8-5095-49c8-84c9-3a46d89f0a1c
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TAXEXEMPT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c8a2832-cfc3-434b-be66-0fb71e7ccba7
                stepCounter: 37db83a5-1d14-4fed-ad4d-e248bcc1fb37
            transform: |-
              CASE LoadOPUSACCOUNT.TAXEXEMPT
                          WHEN 0                    THEN 'FALSE'
                          WHEN 1                    THEN 'TRUE'
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fdc01807-34aa-4585-b5d7-b204dfbb7ab3
          stepCounter: d94982b8-5095-49c8-84c9-3a46d89f0a1c
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Load date.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 97d48552-ab6d-4fa3-82f0-2192ec6a6eb7
                stepCounter: 37db83a5-1d14-4fed-ad4d-e248bcc1fb37
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 12248618-643d-4589-ad55-70e2142eb817
          stepCounter: d94982b8-5095-49c8-84c9-3a46d89f0a1c
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d08fba76-2b06-48a7-936e-93fe30d87edf
          stepCounter: d94982b8-5095-49c8-84c9-3a46d89f0a1c
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOADOPUSACCOUNT: 37db83a5-1d14-4fed-ad4d-e248bcc1fb37
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOADOPUSACCOUNT
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOADOPUSACCOUNT') }} LoadOPUSACCOUNT
             WHERE TRY_TO_NUMBER(LoadOPUSACCOUNT.FORCEID) IS NOT NULL
        name: STAGEOPUSACCOUNT
        noLinkRefs: []
  name: STAGEOPUSACCOUNT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
