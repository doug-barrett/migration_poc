fileVersion: 1
id: 42336738-7ae5-4bac-9ccb-1574dbc5d49f
name: VIEW_FACT_FDC_MOSAIC_CDM_DOWNTIME
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3aff14ee-4b04-4c75-a686-996eefd05eb5
          stepCounter: 42336738-7ae5-4bac-9ccb-1574dbc5d49f
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ENTITY_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67f73041-fdb8-495f-9c84-f3335a8480a0
          stepCounter: 42336738-7ae5-4bac-9ccb-1574dbc5d49f
        config: {}
        dataType: VARCHAR(753)
        defaultValue: ""
        description: ""
        name: SCENARIO_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04887035-dc98-4cbf-aa75-c9134a26c3e9
          stepCounter: 42336738-7ae5-4bac-9ccb-1574dbc5d49f
        config: {}
        dataType: NUMBER(1)
        defaultValue: ""
        description: ""
        name: GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f90f031-8a57-4cac-b825-71fc1a5d6847
          stepCounter: 42336738-7ae5-4bac-9ccb-1574dbc5d49f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ACTIVITY_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 041d3a1c-5e46-462b-acb5-6965aa02b928
          stepCounter: 42336738-7ae5-4bac-9ccb-1574dbc5d49f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: ACTIVITY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b95836f-607a-4b90-945a-a80537b9eac6
          stepCounter: 42336738-7ae5-4bac-9ccb-1574dbc5d49f
        config: {}
        dataType: NUMBER(10)
        defaultValue: ""
        description: ""
        name: NORMALIZED_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 28e30c81-b8d0-4778-a3d4-5e76a6aab827
          stepCounter: 42336738-7ae5-4bac-9ccb-1574dbc5d49f
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: PRODUCING_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95add3d4-cf39-48bf-8d17-7ff20d128e1f
          stepCounter: 42336738-7ae5-4bac-9ccb-1574dbc5d49f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ON_PROD_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0e59c09-065c-4607-b742-c83dcc236753
          stepCounter: 42336738-7ae5-4bac-9ccb-1574dbc5d49f
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e58c0da0-4624-4ca5-b149-ddeea330a7b6
          stepCounter: 42336738-7ae5-4bac-9ccb-1574dbc5d49f
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: HOURS_ON
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e527b00a-fa8b-4924-b799-e4ad61b3b56a
          stepCounter: 42336738-7ae5-4bac-9ccb-1574dbc5d49f
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: HOURS_DOWN
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4735506-80d3-456b-888a-0b5fd641c53c
          stepCounter: 42336738-7ae5-4bac-9ccb-1574dbc5d49f
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: CODE1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5e2fbec-233e-4945-9610-15ae853809cb
                stepCounter: b59b006c-3d31-41c3-8c6d-7591c259f6e2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3325694a-1fe9-4019-aaac-86950c153828
          stepCounter: 42336738-7ae5-4bac-9ccb-1574dbc5d49f
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODE2
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 28cd60d5-75d5-4304-8331-7392d0fd12c0
          stepCounter: 42336738-7ae5-4bac-9ccb-1574dbc5d49f
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODE3
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2c13773-d3d4-4d85-9310-4d188008d93a
          stepCounter: 42336738-7ae5-4bac-9ccb-1574dbc5d49f
        config: {}
        dataType: VARCHAR(2000)
        defaultValue: ""
        description: ""
        name: DT_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8d263ff-19cc-4d0a-af39-46998ef3afc6
          stepCounter: 42336738-7ae5-4bac-9ccb-1574dbc5d49f
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: SYSCREATEUSER
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed32544e-fd99-44cd-80a9-9a039c7dc44c
          stepCounter: 42336738-7ae5-4bac-9ccb-1574dbc5d49f
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: SYSMODUSER
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f3f4514-4572-4e6e-8099-5ea605277383
          stepCounter: 42336738-7ae5-4bac-9ccb-1574dbc5d49f
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: LOST_OIL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 924611f9-621b-4c80-be34-ab106d434468
          stepCounter: 42336738-7ae5-4bac-9ccb-1574dbc5d49f
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: LOST_GAS_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c777a880-23c5-4ab2-8009-d2076f52801b
          stepCounter: 42336738-7ae5-4bac-9ccb-1574dbc5d49f
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: LOST_COND_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67f001f6-1c03-4997-ad26-15fd6bfdc89f
          stepCounter: 42336738-7ae5-4bac-9ccb-1574dbc5d49f
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: LOST_NGL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49855fe3-811b-43bb-8499-06234c8b43a0
          stepCounter: 42336738-7ae5-4bac-9ccb-1574dbc5d49f
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: LOST_TOTAL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c944763-682d-40a3-a363-32222b4a6c21
          stepCounter: 42336738-7ae5-4bac-9ccb-1574dbc5d49f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: AVG_OIL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2f6645e-3fb9-4c96-bc18-73887721ef63
          stepCounter: 42336738-7ae5-4bac-9ccb-1574dbc5d49f
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: AVG_GAS_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc05e692-8334-4f13-b513-ee370d18f7b5
          stepCounter: 42336738-7ae5-4bac-9ccb-1574dbc5d49f
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: AVG_COND_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 150d76cf-cfa5-4999-b2d5-633645d7dcef
          stepCounter: 42336738-7ae5-4bac-9ccb-1574dbc5d49f
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: AVG_NGL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8331f27f-f537-4c62-b47a-c6a3f9609629
          stepCounter: 42336738-7ae5-4bac-9ccb-1574dbc5d49f
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: AVG_HOURS_ON
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f3700ee-04b8-42b5-905d-18c05dc87bc1
          stepCounter: 42336738-7ae5-4bac-9ccb-1574dbc5d49f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: DAYS_SINCE_PROD
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_FACT_FDC_MOSAIC_CDM_DOWNTIME: 42336738-7ae5-4bac-9ccb-1574dbc5d49f
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_FACT_FDC_MOSAIC_CDM_DOWNTIME') }} AS WITH PROD_PATTERN AS (
                    SELECT EE.ENTITY_ID ,
                           EE.VINTAGE_ID ,
                           EE.ENTITY_NAME ,
                           ER.RESERVE_ID ,
                           RC.CATEGORY_NAME ,
                           RD.DETAIL_TYPE ,
                           RDT.ALTERNATE_KEY ,
                           RD.DETAIL_DATE ,
                           YEAR(RD.DETAIL_DATE) AS YEAR ,
                           MONTH(RD.DETAIL_DATE) AS
                     MONTH ,
                           RD.VALUE
                      FROM DS_MOSAIC_CDM.ECONOMIC_ENTITY EE ,
                           DS_MOSAIC_CDM.ENTITY_RESERVE ER ,
                           DS_MOSAIC_CDM.RESERVE_DETAIL RD ,
                           DS_MOSAIC_CDM.RESERVE_DETAIL_TYPE RDT ,
                           DS_MOSAIC_CDM.RESERVE_CATEGORY RC ,
                           DS_MOSAIC_CDM.RESERVE R
                     WHERE EE.ENTITY_ID = ER.ENTITY_ID
                       AND ER.RESERVE_ID = RD.RESERVE_ID
                       AND R.RESERVE_ID = ER.RESERVE_ID
                       AND R.RESERVE_CATEGORY_ID = RC.RESERVE_CATEGORY_ID
                       AND RD.DETAIL_TYPE = RDT.RESERVE_DETAIL_TYPE_ID
                       AND RDT.RESERVE_DETAIL_TYPE_ID IN (2001, 2003, 2002)
                       AND EE.ENTITY_STATE_ID = 4
                       AND RC.RESERVE_CATEGORY_ID IN (101, 102, 104, 106, 108)--AND EE.VINTAGE_ID = 15809

                   ) SELECT CAST(V.ENTITY_ID AS VARCHAR(100)) AS ENTITY_KEY ,
                   PP.ALTERNATE_KEY || '_' || V.CASE_ID AS SCENARIO_KEY ,
                   '2' AS GROSS_NET_KEY ,
                   CAST(V.YEAR || RIGHT('00' || V.MONTH, 2) || '01' AS INT) AS ACTIVITY_DATE_KEY ,
                   CAST(V.YEAR || '-' || V.MONTH || '-01' AS DATE) AS ACTIVITY_DATE ,
                   '-1' AS NORMLIZED_DATE_KEY ,
                   '-1' AS PRODUCING_DATE_KEY ,
                   '-1' AS ON_PROD_DATE_KEY ,
                   V.CC AS CC_NUM ,
                   NULL AS HOURS_ON ,
                   NULL AS HOURS_DOWN ,
                   PP.ALTERNATE_KEY AS CODE1 ,
                   NULL AS CODE2 ,
                   NULL AS CODE3 ,
                   NULL AS DT_COMMENT ,
                   NULL AS SYSCREATEUSER ,
                   NULL AS SYSMODUSER ,
                   V.COSHARE_OIL_VOLUME * (1 - PP.VALUE) AS LOST_OIL_BOE ,
                   V.COSHARE_GAS_VOLUME * (1 - PP.VALUE) AS LOST_GAS_BOE ,
                   V.COSHARE_COND_VOLUME * (1 - PP.VALUE) AS LOST_COND_BOE ,
                   V.COSHARE_NGL_VOLUME * (1 - PP.VALUE) AS LOST_NGL_BOE ,
                   V.COSHARE_BOE_VOLUME * (1 - PP.VALUE) AS LOST_TOTAL_BOE ,
                   NULL AS AVG_OIL_BOE ,
                   NULL AS AVG_GAS_BOE ,
                   NULL AS AVG_COND_BOE ,
                   NULL AS AVG_NGL_BOE ,
                   NULL AS AVG_TOTAL_BOE ,
                   NULL AS AVG_HOURS_ON ,
                   NULL AS DAYS_SINCE_PROD
              FROM WS_EDW.VIEW_MOSAIC_CDM_VOLUMES V
              JOIN PROD_PATTERN PP
                ON V.ENTITY_ID = PP.ENTITY_ID
               AND V.YEAR = PP.YEAR
               AND V.MONTH = PP.MONTH
             WHERE V.CASE_ID IN ({{ parameters.MOSAIC_CDM_FORECAST_CASE_IDS }})
               AND V.COSHARE_BOE_VOLUME > 0
        dependencies:
          - locationName: TARGET
            nodeName: VIEW_MOSAIC_CDM_VOLUMES
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','VIEW_MOSAIC_CDM_VOLUMES') }}
        name: VIEW_FACT_FDC_MOSAIC_CDM_DOWNTIME
        noLinkRefs: []
  name: VIEW_FACT_FDC_MOSAIC_CDM_DOWNTIME
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
