fileVersion: 1
id: 10e38128-89bf-48df-b866-2a1349b3658e
name: VIEW_FACT_FDC_MOSAIC_CDM_DOWNTIME
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d1191028-83cf-4b03-9c3a-53c9bac7db6e
          stepCounter: 10e38128-89bf-48df-b866-2a1349b3658e
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ENTITY_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de1cfe29-6d2f-42cc-9f74-d1a28d92a523
          stepCounter: 10e38128-89bf-48df-b866-2a1349b3658e
        config: {}
        dataType: VARCHAR(753)
        defaultValue: ""
        description: ""
        name: SCENARIO_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ef82fbf-1027-49de-82eb-30fd9157f656
          stepCounter: 10e38128-89bf-48df-b866-2a1349b3658e
        config: {}
        dataType: NUMBER(1)
        defaultValue: ""
        description: ""
        name: GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 13572eec-045d-4a9d-ae37-9fba7688852d
          stepCounter: 10e38128-89bf-48df-b866-2a1349b3658e
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ACTIVITY_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 024097b7-46c6-4e0c-94be-33185ba1f20e
          stepCounter: 10e38128-89bf-48df-b866-2a1349b3658e
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: ACTIVITY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b364e90-fe7c-4252-a7a1-1b29b16a908f
          stepCounter: 10e38128-89bf-48df-b866-2a1349b3658e
        config: {}
        dataType: NUMBER(10)
        defaultValue: ""
        description: ""
        name: NORMALIZED_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c85055a-4597-4d8c-a623-c7a697f23025
          stepCounter: 10e38128-89bf-48df-b866-2a1349b3658e
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: PRODUCING_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9324df14-d229-4a1d-a865-30ae3ad3ea02
          stepCounter: 10e38128-89bf-48df-b866-2a1349b3658e
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ON_PROD_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 802bbafe-ea16-4209-9252-618bf7b72d72
          stepCounter: 10e38128-89bf-48df-b866-2a1349b3658e
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: abf22896-27a1-45b9-b398-655d3117a671
          stepCounter: 10e38128-89bf-48df-b866-2a1349b3658e
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: HOURS_ON
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 76b30557-252a-4002-94a5-a3a6a8c1542a
          stepCounter: 10e38128-89bf-48df-b866-2a1349b3658e
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: HOURS_DOWN
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 00edf8dd-4be9-45ab-9231-5800c632cc7e
          stepCounter: 10e38128-89bf-48df-b866-2a1349b3658e
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: CODE1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79370755-2c7d-467c-9199-d77ef93740ce
                stepCounter: b90817be-03f4-4759-8a4a-5cd7feeeb38b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b1e2e3d-2ac5-4d06-9906-54315e0479a5
          stepCounter: 10e38128-89bf-48df-b866-2a1349b3658e
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODE2
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d05f44e-00ab-4e66-acab-950cbd6dd670
          stepCounter: 10e38128-89bf-48df-b866-2a1349b3658e
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODE3
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74225ed9-31e7-479d-92d3-5161a47c9208
          stepCounter: 10e38128-89bf-48df-b866-2a1349b3658e
        config: {}
        dataType: VARCHAR(2000)
        defaultValue: ""
        description: ""
        name: DT_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5acac1c2-f4d7-4e56-ae31-720bde93823f
          stepCounter: 10e38128-89bf-48df-b866-2a1349b3658e
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: SYSCREATEUSER
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 112b77a0-a22d-4b88-866a-c9a1106c50c8
          stepCounter: 10e38128-89bf-48df-b866-2a1349b3658e
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: SYSMODUSER
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f58812ae-1575-4f47-bb86-ebf6fe6fcbaa
          stepCounter: 10e38128-89bf-48df-b866-2a1349b3658e
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: LOST_OIL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa267f61-36f3-4a8f-8131-d6a8e4f3e6bb
          stepCounter: 10e38128-89bf-48df-b866-2a1349b3658e
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: LOST_GAS_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2fb75a4b-80e1-46dd-8051-1bbca023e2a4
          stepCounter: 10e38128-89bf-48df-b866-2a1349b3658e
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: LOST_COND_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a0d2dd6d-ea50-47b6-a7cc-47e819be8a9b
          stepCounter: 10e38128-89bf-48df-b866-2a1349b3658e
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: LOST_NGL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77d08d20-2ea5-4598-b809-b9ce446576e6
          stepCounter: 10e38128-89bf-48df-b866-2a1349b3658e
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: LOST_TOTAL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1778ddd1-2835-43c1-983b-e81043b97c9d
          stepCounter: 10e38128-89bf-48df-b866-2a1349b3658e
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: AVG_OIL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50ce0de7-e6d9-40ee-994e-85483a8204b2
          stepCounter: 10e38128-89bf-48df-b866-2a1349b3658e
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: AVG_GAS_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3308317-b503-441b-bf01-628319a9950b
          stepCounter: 10e38128-89bf-48df-b866-2a1349b3658e
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: AVG_COND_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd07fb1f-2fcb-43d5-8cf7-a7723166bd38
          stepCounter: 10e38128-89bf-48df-b866-2a1349b3658e
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: AVG_NGL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0db3c50a-3e59-44b2-99b6-e4718bcd4f00
          stepCounter: 10e38128-89bf-48df-b866-2a1349b3658e
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: AVG_HOURS_ON
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bef5ca5f-20fb-4a5e-9483-1b784c13062a
          stepCounter: 10e38128-89bf-48df-b866-2a1349b3658e
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: DAYS_SINCE_PROD
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_FACT_FDC_MOSAIC_CDM_DOWNTIME: 10e38128-89bf-48df-b866-2a1349b3658e
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_FACT_FDC_MOSAIC_CDM_DOWNTIME') }} AS WITH PROD_PATTERN AS (
                    SELECT EE.ENTITY_ID ,
                           EE.VINTAGE_ID ,
                           EE.ENTITY_NAME ,
                           ER.RESERVE_ID ,
                           RC.CATEGORY_NAME ,
                           RD.DETAIL_TYPE ,
                           RDT.ALTERNATE_KEY ,
                           RD.DETAIL_DATE ,
                           YEAR(RD.DETAIL_DATE) AS YEAR ,
                           MONTH(RD.DETAIL_DATE) AS
                     MONTH ,
                           RD.VALUE
                      FROM DS_MOSAIC_CDM.ECONOMIC_ENTITY EE ,
                           DS_MOSAIC_CDM.ENTITY_RESERVE ER ,
                           DS_MOSAIC_CDM.RESERVE_DETAIL RD ,
                           DS_MOSAIC_CDM.RESERVE_DETAIL_TYPE RDT ,
                           DS_MOSAIC_CDM.RESERVE_CATEGORY RC ,
                           DS_MOSAIC_CDM.RESERVE R
                     WHERE EE.ENTITY_ID = ER.ENTITY_ID
                       AND ER.RESERVE_ID = RD.RESERVE_ID
                       AND R.RESERVE_ID = ER.RESERVE_ID
                       AND R.RESERVE_CATEGORY_ID = RC.RESERVE_CATEGORY_ID
                       AND RD.DETAIL_TYPE = RDT.RESERVE_DETAIL_TYPE_ID
                       AND RDT.RESERVE_DETAIL_TYPE_ID IN (2001, 2003, 2002)
                       AND EE.ENTITY_STATE_ID = 4
                       AND RC.RESERVE_CATEGORY_ID IN (101, 102, 104, 106, 108)--AND EE.VINTAGE_ID = 15809

                   ) SELECT CAST(V.ENTITY_ID AS VARCHAR(100)) AS ENTITY_KEY ,
                   PP.ALTERNATE_KEY || '_' || V.CASE_ID AS SCENARIO_KEY ,
                   '2' AS GROSS_NET_KEY ,
                   CAST(V.YEAR || RIGHT('00' || V.MONTH, 2) || '01' AS INT) AS ACTIVITY_DATE_KEY ,
                   CAST(V.YEAR || '-' || V.MONTH || '-01' AS DATE) AS ACTIVITY_DATE ,
                   '-1' AS NORMLIZED_DATE_KEY ,
                   '-1' AS PRODUCING_DATE_KEY ,
                   '-1' AS ON_PROD_DATE_KEY ,
                   V.CC AS CC_NUM ,
                   NULL AS HOURS_ON ,
                   NULL AS HOURS_DOWN ,
                   PP.ALTERNATE_KEY AS CODE1 ,
                   NULL AS CODE2 ,
                   NULL AS CODE3 ,
                   NULL AS DT_COMMENT ,
                   NULL AS SYSCREATEUSER ,
                   NULL AS SYSMODUSER ,
                   V.COSHARE_OIL_VOLUME * (1 - PP.VALUE) AS LOST_OIL_BOE ,
                   V.COSHARE_GAS_VOLUME * (1 - PP.VALUE) AS LOST_GAS_BOE ,
                   V.COSHARE_COND_VOLUME * (1 - PP.VALUE) AS LOST_COND_BOE ,
                   V.COSHARE_NGL_VOLUME * (1 - PP.VALUE) AS LOST_NGL_BOE ,
                   V.COSHARE_BOE_VOLUME * (1 - PP.VALUE) AS LOST_TOTAL_BOE ,
                   NULL AS AVG_OIL_BOE ,
                   NULL AS AVG_GAS_BOE ,
                   NULL AS AVG_COND_BOE ,
                   NULL AS AVG_NGL_BOE ,
                   NULL AS AVG_TOTAL_BOE ,
                   NULL AS AVG_HOURS_ON ,
                   NULL AS DAYS_SINCE_PROD
              FROM WS_EDW.VIEW_MOSAIC_CDM_VOLUMES V
              JOIN PROD_PATTERN PP
                ON V.ENTITY_ID = PP.ENTITY_ID
               AND V.YEAR = PP.YEAR
               AND V.MONTH = PP.MONTH
             WHERE V.CASE_ID IN ({{ parameters.MOSAIC_CDM_FORECAST_CASE_IDS }})
               AND V.COSHARE_BOE_VOLUME > 0
        dependencies:
          - locationName: TARGET
            nodeName: VIEW_MOSAIC_CDM_VOLUMES
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','VIEW_MOSAIC_CDM_VOLUMES') }}
        name: VIEW_FACT_FDC_MOSAIC_CDM_DOWNTIME
        noLinkRefs: []
  name: VIEW_FACT_FDC_MOSAIC_CDM_DOWNTIME
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
