fileVersion: 1
id: b0041b55-3291-4159-81e2-d207d4c3b299
name: S_CDSSWE_PATIENT_PROGRAMME_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0faec6d0-dc03-46ec-8241-177265422fcb
          stepCounter: b0041b55-3291-4159-81e2-d207d4c3b299
        config: {}
        dataType: NUMERIC(18)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: PATIENT_PROGRAMME_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1dc01ac2-a10c-49ca-90eb-ed32df22cd74
                stepCounter: 2ecdd3a6-b52d-4166-90dd-2155a6b785ca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 473281c3-851d-43ee-b968-07676a44e529
          stepCounter: b0041b55-3291-4159-81e2-d207d4c3b299
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9bc6297d-00ed-48bb-952b-24c3544e139e
                stepCounter: 289da868-88f5-4e61-a975-de3b30517956
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 580b2670-4efd-465e-a23b-89cc6e065168
          stepCounter: b0041b55-3291-4159-81e2-d207d4c3b299
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 702dfc9d-df5e-42d8-86f8-9e68f29c462c
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d443faea-df3b-4a3c-8a76-f3bf2c489180
          stepCounter: b0041b55-3291-4159-81e2-d207d4c3b299
        config: {}
        dataType: NUMERIC(18)
        defaultValue: ""
        description: ""
        name: PROGRAMME_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b91ef87-beb6-45b7-8ae3-d8d41ee24fae
                stepCounter: 2ecdd3a6-b52d-4166-90dd-2155a6b785ca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d34fccb3-cf80-4e87-a135-984bed997ed4
          stepCounter: b0041b55-3291-4159-81e2-d207d4c3b299
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: PATIENT_PROGRAMME_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 68ae7343-6636-410f-8f54-d96cc55f2e09
                stepCounter: 2ecdd3a6-b52d-4166-90dd-2155a6b785ca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ca61ceb-4f48-4813-9ab5-d0a09811fa28
          stepCounter: b0041b55-3291-4159-81e2-d207d4c3b299
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_UPDATED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56be1a30-be80-476f-950e-5af61acfdbc5
                stepCounter: 2ecdd3a6-b52d-4166-90dd-2155a6b785ca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c859334-0a45-4077-8937-5c2489fd3a0f
          stepCounter: b0041b55-3291-4159-81e2-d207d4c3b299
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: LAST_UPDATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d7ed212e-13f2-4b38-a8e2-14ccd597bc5a
                stepCounter: 2ecdd3a6-b52d-4166-90dd-2155a6b785ca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8607111-ef73-4ada-ae96-fd97c67e9611
          stepCounter: b0041b55-3291-4159-81e2-d207d4c3b299
        config: {}
        dataType: VARCHAR(200)
        defaultValue: ""
        description: ""
        name: NOTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77fd0c99-68ab-47b3-8496-f4968ed14ef7
                stepCounter: 2ecdd3a6-b52d-4166-90dd-2155a6b785ca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 895bce44-988e-449e-ab1a-1fd06c859bfa
          stepCounter: b0041b55-3291-4159-81e2-d207d4c3b299
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ENCOUNTER_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 58a21d8b-0ed5-4390-a69b-3fe073e0897c
                stepCounter: 2ecdd3a6-b52d-4166-90dd-2155a6b785ca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8599d2c5-0f3c-42c2-ad0f-7444a34334cb
          stepCounter: b0041b55-3291-4159-81e2-d207d4c3b299
        config: {}
        dataType: NUMERIC(18)
        defaultValue: ""
        description: ""
        name: ENROLMENT_STATUS_CHANGE_REASON_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9f6d484a-c9dc-4629-8267-1ddf9318362a
                stepCounter: 2ecdd3a6-b52d-4166-90dd-2155a6b785ca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d64a4616-38df-4c82-a681-3f6c088b4273
          stepCounter: b0041b55-3291-4159-81e2-d207d4c3b299
        config: {}
        dataType: NVARCHAR(1500)
        defaultValue: ""
        description: ""
        name: ADDITIONAL_REASON_FOR_STATUS_CHANGE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: faa50e78-c651-47eb-98a3-4a6b8e4f5a60
                stepCounter: 2ecdd3a6-b52d-4166-90dd-2155a6b785ca
            transform: substring(ltrim(rtrim(ds_cdsswe_patient_programme.additional_reason_for_status_change)),1,1499)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 504366a3-6f3a-41a5-8ea1-fb0b0a676257
          stepCounter: b0041b55-3291-4159-81e2-d207d4c3b299
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: HOSPITALNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f9cd30e7-9361-4e71-8bae-7e3ea87a81fa
                stepCounter: 2ecdd3a6-b52d-4166-90dd-2155a6b785ca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8deda55d-f96c-479f-b886-14970753d5e0
          stepCounter: b0041b55-3291-4159-81e2-d207d4c3b299
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: EPISODETYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 41bf1d97-94b6-4b44-9578-eaeea985ee9f
                stepCounter: 2ecdd3a6-b52d-4166-90dd-2155a6b785ca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 361a3af2-df12-4318-a2e3-2af6e77917d2
          stepCounter: b0041b55-3291-4159-81e2-d207d4c3b299
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: STREAM_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c5f8fe0-9b2f-47d5-a492-fd2bba650bb8
                stepCounter: 2ecdd3a6-b52d-4166-90dd-2155a6b785ca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d461776-0b72-4e80-9868-234a484f03ec
          stepCounter: b0041b55-3291-4159-81e2-d207d4c3b299
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: STREAM_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16991d8f-e34e-4125-9391-9a476bbca229
                stepCounter: 2ecdd3a6-b52d-4166-90dd-2155a6b785ca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eefca3c4-f71f-4dc3-8a4c-6ed5748be79f
          stepCounter: b0041b55-3291-4159-81e2-d207d4c3b299
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: EPISODE_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a61b1e4e-250d-4353-8a0b-699237cac645
                stepCounter: 2ecdd3a6-b52d-4166-90dd-2155a6b785ca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a76b379c-e166-48a2-b25d-df609d13f574
          stepCounter: b0041b55-3291-4159-81e2-d207d4c3b299
        config: {}
        dataType: NUMERIC(18)
        defaultValue: ""
        description: ""
        name: PARENT_PATIENT_PROGRAMME_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e8c35fc6-d9d7-403d-a8cb-af6293bf60c2
                stepCounter: 2ecdd3a6-b52d-4166-90dd-2155a6b785ca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c6274c2-1465-49d7-be56-9851270455b2
          stepCounter: b0041b55-3291-4159-81e2-d207d4c3b299
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: AREA_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1bb97703-8ae2-4a8e-a6e9-5c9912b8d1b5
                stepCounter: 2ecdd3a6-b52d-4166-90dd-2155a6b785ca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f9f41ee-cdae-4f99-8a29-889cdd00798c
          stepCounter: b0041b55-3291-4159-81e2-d207d4c3b299
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: REASON_FOR_REFERRAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50d9708c-67e7-4fe6-8ba2-10299597be57
                stepCounter: 2ecdd3a6-b52d-4166-90dd-2155a6b785ca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aafeb3de-a4c6-42d5-ada1-8a8cbf173a7c
          stepCounter: b0041b55-3291-4159-81e2-d207d4c3b299
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: CLIENT_CONSENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8a5d3c5f-31d6-41f7-811f-20467a6b5807
                stepCounter: 2ecdd3a6-b52d-4166-90dd-2155a6b785ca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74d0fd85-9dde-4570-9635-d52242e1951c
          stepCounter: b0041b55-3291-4159-81e2-d207d4c3b299
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DS_CDSSWE_PATIENT_PROGRAMME: 2ecdd3a6-b52d-4166-90dd-2155a6b785ca
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_CDSSWE_PATIENT_PROGRAMME
        join:
          joinCondition: |-
            FROM {{ ref('TGT','DS_CDSSWE_PATIENT_PROGRAMME') }} ds_cdsswe_patient_programme
              JOIN l_cdsswe_patient
                ON ds_cdsswe_patient_programme.patient_id = l_cdsswe_patient.patient_id
              LEFT JOIN dim.dim_patient
                ON dim_patient.patient_nhi = l_cdsswe_patient.nhi_number
               AND NHI_sequence =1
        name: S_CDSSWE_PATIENT_PROGRAMME_10
        noLinkRefs: []
  name: S_CDSSWE_PATIENT_PROGRAMME_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
