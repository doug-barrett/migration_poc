fileVersion: 1
id: 1fb0ea0b-6d5e-4859-b081-bf709cca461e
name: STAGE_OPC_ACCOUNT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "FILTER ALL ACCOUNT RELATED EXCEPTIONS AT ONE PLACE."
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 703ce95f-26e1-4763-9ad0-e7127a1b8afe
          stepCounter: 1fb0ea0b-6d5e-4859-b081-bf709cca461e
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE HIGHEST-LEVEL OF HIERARCHY FOR AN ACCOUNT
        isBusinessKey: true
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39164390-b1a7-436f-a2ab-0050dbb721c0
                stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 489a3d8d-ff51-4258-ab28-35d7af7fd863
          stepCounter: 1fb0ea0b-6d5e-4859-b081-bf709cca461e
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE UNIQUE IDENTIFIER FOR AN ACCOUNT
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0496d4c9-e184-4f52-9202-c05cc9999a6e
                stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3857ac9d-e3d1-4ce9-b354-9ed598743089
          stepCounter: 1fb0ea0b-6d5e-4859-b081-bf709cca461e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE SAME VALUE AS THE ACCOUNTNAME COLUMN, BUT HAS BEEN RUN THROUGH A PROPERCASE FUNCTION
        name: DISPLAYACCOUNTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a453e57-10cf-4e12-ab9d-57a473cc094c
                stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f886fe8-d9e3-4b31-8ed2-aee290631c27
          stepCounter: 1fb0ea0b-6d5e-4859-b081-bf709cca461e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE TYPE, OR CLASSIFICATION, OF THE ACCOUNT
        name: ACCOUNTTYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3efc5d16-23e5-4acb-8724-6c8701a80a31
                stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3603c69-f298-4334-9547-95bcc07cabb6
          stepCounter: 1fb0ea0b-6d5e-4859-b081-bf709cca461e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE FIRST LINE OF THE ACCOUNT'S STREET ADDRESS
        name: ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d60199d8-6f79-4db4-aaa6-93691bb408af
                stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac372a8d-0d5d-4c0d-9c97-44f18a6af230
          stepCounter: 1fb0ea0b-6d5e-4859-b081-bf709cca461e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE SECOND LINE OF THE ACCOUNT'S STREET ADDRESS, USUALLY THE SUITE, BUILDING, OR FLOOR
        name: ADDRESS2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e76c58ad-0d98-4e10-a1e2-7d9877bed967
                stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4fd0b26-7e36-4725-825e-a5d75420f5b1
          stepCounter: 1fb0ea0b-6d5e-4859-b081-bf709cca461e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE NAME OF THE CITY THE ACCOUNT IS LOCATED IN
        name: CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c230ea2c-11c4-4fe7-85c1-a95299c0fd63
                stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 729728d0-7628-4b42-bf62-378b61f2ec40
          stepCounter: 1fb0ea0b-6d5e-4859-b081-bf709cca461e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE NAME OF THE COUNTY OR PARISH THE ACCOUNT IS LOCATED IN
        name: COUNTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ea698e1-28e2-4a59-81cc-9ac037b67678
                stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53c8617e-e91b-4b69-80fc-6ee677800ef8
          stepCounter: 1fb0ea0b-6d5e-4859-b081-bf709cca461e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE STATE OR PROVINCE THE ACCOUNT IS LOCATED IN
        name: STATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b5775d24-2751-4c07-82ac-b556a0c2c56b
                stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2a866ca-8a1c-4dc5-b43d-1e5694e0e533
          stepCounter: 1fb0ea0b-6d5e-4859-b081-bf709cca461e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE POSTAL CODE FOR THE ACCOUNT
        name: ZIPCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ee04339-50ab-407c-b718-af7106bd1aa6
                stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7df1ddf7-b48d-4455-a74d-2699401909eb
          stepCounter: 1fb0ea0b-6d5e-4859-b081-bf709cca461e
        config: {}
        dataType: DATE
        defaultValue: ""
        description: IS THE DATE THAT THE ACCOUNT EITHER REGISTERED OR, IN THE EVENT WE DO NOT HAVE A REGISTRATION, WILL BE THE DATE OF FIRST PURCHASE
        name: STARTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a7bc8df4-c0a7-4237-8205-41b60dfeb239
                stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5488510e-d6bc-47bc-a944-f2d5bad824e9
          stepCounter: 1fb0ea0b-6d5e-4859-b081-bf709cca461e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE TIER A LEVEL 1 ACCOUNT IS CLASSIFIED AS. BASICALLY, HOW MUCH ATTENTION ARE WE GOING TO GIVE THIS CUSTOMER.
        name: TIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ba478ecd-0d20-4d7c-8a51-ab87c4a54e34
                stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c5485e3-32ac-4da3-9776-611cb57226ca
          stepCounter: 1fb0ea0b-6d5e-4859-b081-bf709cca461e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE 9-DIGIT EIN (EMPLOYER IDENTIFICATION NUMBER) FOR THE ACCOUNT
        name: FEDERALTAXID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3629f92-b13f-43ce-88da-b685d545e8f6
                stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8f9206e-5f93-4b07-a63d-3c65726e449d
          stepCounter: 1fb0ea0b-6d5e-4859-b081-bf709cca461e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE PRIMARY URL FOR THE ACCOUNT
        name: WEBSITE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ab5b297-2be9-4df7-9e84-d3c376ed46e4
                stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b90f41ba-1670-4d08-a131-542ec80463a0
          stepCounter: 1fb0ea0b-6d5e-4859-b081-bf709cca461e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: THE SIZE BAND ARE CATEGORIZED INTO DIFFERENT SIZE BAND CODE DEPENDING ON THE CUSTOMER SIZE AND THE ACCOUNTTYPES.
        name: CUSTOMER_SIZE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fbc9b040-1378-46a2-be9a-5517592e12e9
                stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e71d5e7f-d980-4c2f-a480-5984fd5266c3
          stepCounter: 1fb0ea0b-6d5e-4859-b081-bf709cca461e
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CUSTOMER_SIZE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50c094cd-c8f1-42be-b203-ebb7b9ed4071
                stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: abba900d-716a-4040-b7d0-fc0ad91d7de3
          stepCounter: 1fb0ea0b-6d5e-4859-b081-bf709cca461e
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: CUSTOMERSIZEBAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cf59daff-6c7f-4d31-8ffb-fd46d8ce9abf
                stepCounter: 59ea7c50-5eb8-4354-93cd-69d2c7a87520
            transform: IFNULL(LOADOPC_CUSTOMER_SIZE_BAND.CUSTOMER_SIZE_BAND,'UNKNOWN')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b1b3d2f-f3bc-4bd8-98dc-f1ede1f263ac
          stepCounter: 1fb0ea0b-6d5e-4859-b081-bf709cca461e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "STAGEACCOUNT_ADDKEYS.ORGANIZATIONID=ACCOUNTGEOGRAPHY.ORGANIZATIONID\nSTAGEACCOUNT_ADDKEYS.FORCEID=ACCOUNTGEOGRAPHY.FORCEID"
        name: ACCOUNTGEOGRAPHYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 540335ea-0863-4025-987b-27ec2d55ba7e
                stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33144854-e7c8-45fc-b4db-caa7f77456f9
          stepCounter: 1fb0ea0b-6d5e-4859-b081-bf709cca461e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "STAGEACCOUNT_ADDKEYS.ORGANIZATIONID=SALESTERRITORY.ORGANIZATIONID\nSTAGEACCOUNT_ADDKEYS.ACCOUNTTERRITORY=SALESTERRITORY.TERRITORYNAME"
        name: SALESTERRITORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 830e9663-2704-4f6d-8f7e-affd04a751ab
                stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eaee76f6-c9fa-4843-affc-8a4f9ddf062d
          stepCounter: 1fb0ea0b-6d5e-4859-b081-bf709cca461e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEOPC_ACCOUNT.LEVEL1FORCEID=OPC_ACCOUNT.LEVEL1FORCEID
        name: ACCOUNTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 73101027-373e-40ba-a7a7-d0e1c69a5523
                stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b5a0f65f-4059-4ea3-adb3-913d29f88cf6
          stepCounter: 1fb0ea0b-6d5e-4859-b081-bf709cca461e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEACCOUNT_ADDKEYS.SECTORID=SECTOR.SECTORID
        name: SECTORKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2a4bbb8c-6a6a-4348-b2dd-a9380c3f4b69
                stepCounter: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dd14163a-d535-49eb-9187-3764d5171fe0
          stepCounter: 1fb0ea0b-6d5e-4859-b081-bf709cca461e
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 44758696-36b2-49aa-8bcf-6c4fb0e60948
          stepCounter: 1fb0ea0b-6d5e-4859-b081-bf709cca461e
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          OPC_ACCOUNT: 9278bd8f-b74a-43c6-8d67-d097a4c87be1
          LOAD_OPC_CUSTOMER_SIZE_BAND: 59ea7c50-5eb8-4354-93cd-69d2c7a87520
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOAD_OPC_CUSTOMER_SIZE_BAND
          - locationName: OMNIA_CONNECT_OPC
            nodeName: OPC_ACCOUNT
        join:
          joinCondition: |-
            FROM {{ ref('OMNIA_CONNECT_OPC','OPC_ACCOUNT') }} OPC_ACCOUNT
              LEFT JOIN {{ ref('LOAD','LOAD_OPC_CUSTOMER_SIZE_BAND') }} LOAD_OPC_CUSTOMER_SIZE_BAND
                ON OPC_ACCOUNT.ACCOUNTTYPE = LOAD_OPC_CUSTOMER_SIZE_BAND.ACCOUNT_TYPE
               AND OPC_ACCOUNT.CUSTOMER_SIZE_CODE = LOAD_OPC_CUSTOMER_SIZE_BAND.CUSTOMER_SIZE_CODE
        name: STAGEOPC_ACCOUNT
        noLinkRefs: []
  name: STAGE_OPC_ACCOUNT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
