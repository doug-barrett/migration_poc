fileVersion: 1
id: 916849d1-29bb-4cff-86b6-ea9bb6e26603
name: STAGE_OPC_ACCOUNT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "FILTER ALL ACCOUNT RELATED EXCEPTIONS AT ONE PLACE."
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e319bc65-d5be-4921-b801-79f8b7d62dd0
          stepCounter: 916849d1-29bb-4cff-86b6-ea9bb6e26603
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE HIGHEST-LEVEL OF HIERARCHY FOR AN ACCOUNT
        isBusinessKey: true
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 45b1e391-1f57-4616-bfb8-5a95e8fa0bf7
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a269bd51-4fe8-46ce-bdae-4f5d79acc4f2
          stepCounter: 916849d1-29bb-4cff-86b6-ea9bb6e26603
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE UNIQUE IDENTIFIER FOR AN ACCOUNT
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 45b8ca31-a3c4-4854-84ab-6dce26144004
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5fefaec9-46dd-47c6-9e93-13c44b8ab25a
          stepCounter: 916849d1-29bb-4cff-86b6-ea9bb6e26603
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE SAME VALUE AS THE ACCOUNTNAME COLUMN, BUT HAS BEEN RUN THROUGH A PROPERCASE FUNCTION
        name: DISPLAYACCOUNTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09d28d69-519f-447f-8b65-4727420cafdf
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 228009b9-e470-45e3-bc81-214824676e4a
          stepCounter: 916849d1-29bb-4cff-86b6-ea9bb6e26603
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE TYPE, OR CLASSIFICATION, OF THE ACCOUNT
        name: ACCOUNTTYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22d869e0-abeb-4bbe-bca9-75515b13b847
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81ca0556-2f3e-449c-9429-a122433ab473
          stepCounter: 916849d1-29bb-4cff-86b6-ea9bb6e26603
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE FIRST LINE OF THE ACCOUNT'S STREET ADDRESS
        name: ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: be0e46b6-00fc-436e-bd4c-edda32e279de
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b7f593a-a97e-496f-9095-4a6b9ef898a2
          stepCounter: 916849d1-29bb-4cff-86b6-ea9bb6e26603
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE SECOND LINE OF THE ACCOUNT'S STREET ADDRESS, USUALLY THE SUITE, BUILDING, OR FLOOR
        name: ADDRESS2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 36db7855-96ce-4edb-b02a-cd96615f2c3e
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71ed0275-0af9-47c9-9c5e-eb55eb9273a5
          stepCounter: 916849d1-29bb-4cff-86b6-ea9bb6e26603
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE NAME OF THE CITY THE ACCOUNT IS LOCATED IN
        name: CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9de6e6f0-0132-4c17-bf96-5a18f6846ccf
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d0b2468c-2d2f-4572-af26-eca261407d75
          stepCounter: 916849d1-29bb-4cff-86b6-ea9bb6e26603
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE NAME OF THE COUNTY OR PARISH THE ACCOUNT IS LOCATED IN
        name: COUNTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 925ccd51-f2f6-457a-8b87-ea7cb5123094
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55c96546-434c-42d6-8437-bf03b16463a7
          stepCounter: 916849d1-29bb-4cff-86b6-ea9bb6e26603
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE STATE OR PROVINCE THE ACCOUNT IS LOCATED IN
        name: STATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dbcfe9b8-29ae-4c7a-9a85-2c7c94f5c537
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 254b3137-cb89-4eed-9968-f6f890d1e948
          stepCounter: 916849d1-29bb-4cff-86b6-ea9bb6e26603
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE POSTAL CODE FOR THE ACCOUNT
        name: ZIPCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 44f9c510-63b8-4530-84e3-75a6a0bc01b0
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7aaa3ebd-2b3d-4c8d-857e-db96ad124fc4
          stepCounter: 916849d1-29bb-4cff-86b6-ea9bb6e26603
        config: {}
        dataType: DATE
        defaultValue: ""
        description: IS THE DATE THAT THE ACCOUNT EITHER REGISTERED OR, IN THE EVENT WE DO NOT HAVE A REGISTRATION, WILL BE THE DATE OF FIRST PURCHASE
        name: STARTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 274e66f2-2cd0-415f-8e4f-e516950eaec3
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a37f9342-4c36-4fed-b607-bf1947c0829d
          stepCounter: 916849d1-29bb-4cff-86b6-ea9bb6e26603
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE TIER A LEVEL 1 ACCOUNT IS CLASSIFIED AS. BASICALLY, HOW MUCH ATTENTION ARE WE GOING TO GIVE THIS CUSTOMER.
        name: TIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d0e5666-91bd-41e1-bf7c-30341285c264
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8749eee-8758-462d-a916-1e1790f326d7
          stepCounter: 916849d1-29bb-4cff-86b6-ea9bb6e26603
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE 9-DIGIT EIN (EMPLOYER IDENTIFICATION NUMBER) FOR THE ACCOUNT
        name: FEDERALTAXID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ac658b1-7ee0-4ab7-bf38-4a245f5e0a90
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05f4b2bd-f6d5-4674-b6fb-6c2669d955c0
          stepCounter: 916849d1-29bb-4cff-86b6-ea9bb6e26603
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE PRIMARY URL FOR THE ACCOUNT
        name: WEBSITE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d1c6f580-97a8-447a-83a3-cabcd6c439ff
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6fbb319-b994-451d-8d9a-d91be502f7bc
          stepCounter: 916849d1-29bb-4cff-86b6-ea9bb6e26603
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: THE SIZE BAND ARE CATEGORIZED INTO DIFFERENT SIZE BAND CODE DEPENDING ON THE CUSTOMER SIZE AND THE ACCOUNTTYPES.
        name: CUSTOMER_SIZE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7208171-d75f-4fab-bace-2ec38fa672b8
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78097e39-e412-435e-9358-8adecaa51497
          stepCounter: 916849d1-29bb-4cff-86b6-ea9bb6e26603
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CUSTOMER_SIZE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c307adac-b53a-4806-8372-085884d8172b
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0718a10-4d49-4cda-b77f-8b6f7c1889c8
          stepCounter: 916849d1-29bb-4cff-86b6-ea9bb6e26603
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: CUSTOMERSIZEBAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a85167a-d2cc-4a67-af33-5ca9c987418e
                stepCounter: 134cb21b-5070-490c-9fbd-870c163e0090
            transform: IFNULL(LOADOPC_CUSTOMER_SIZE_BAND.CUSTOMER_SIZE_BAND,'UNKNOWN')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: abb3f3b4-75db-4af1-b282-da545b704169
          stepCounter: 916849d1-29bb-4cff-86b6-ea9bb6e26603
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "STAGEACCOUNT_ADDKEYS.ORGANIZATIONID=ACCOUNTGEOGRAPHY.ORGANIZATIONID\nSTAGEACCOUNT_ADDKEYS.FORCEID=ACCOUNTGEOGRAPHY.FORCEID"
        name: ACCOUNTGEOGRAPHYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: df405f88-0391-44ee-900c-3f86fc980700
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66700fe5-9273-4c3b-b283-daa965dcf151
          stepCounter: 916849d1-29bb-4cff-86b6-ea9bb6e26603
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "STAGEACCOUNT_ADDKEYS.ORGANIZATIONID=SALESTERRITORY.ORGANIZATIONID\nSTAGEACCOUNT_ADDKEYS.ACCOUNTTERRITORY=SALESTERRITORY.TERRITORYNAME"
        name: SALESTERRITORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5fca724d-f24b-427d-a882-472a044b3020
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd3686f3-268d-497c-81bc-1247fec9379f
          stepCounter: 916849d1-29bb-4cff-86b6-ea9bb6e26603
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEOPC_ACCOUNT.LEVEL1FORCEID=OPC_ACCOUNT.LEVEL1FORCEID
        name: ACCOUNTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec624ec5-f65d-4fb7-ad8b-f762060c5614
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef303726-ef16-4d5d-9d62-d744262942cc
          stepCounter: 916849d1-29bb-4cff-86b6-ea9bb6e26603
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEACCOUNT_ADDKEYS.SECTORID=SECTOR.SECTORID
        name: SECTORKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94801baf-1854-4f19-b323-a810ba56847b
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b74cebe-db4d-4fbb-8a23-ff090c2e602c
          stepCounter: 916849d1-29bb-4cff-86b6-ea9bb6e26603
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be6d7665-f628-4818-bf08-b50eb53e42b4
          stepCounter: 916849d1-29bb-4cff-86b6-ea9bb6e26603
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          OPC_ACCOUNT: 3353bc4b-96a5-43e1-9c39-6e2080820932
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOAD_OPC_CUSTOMER_SIZE_BAND
          - locationName: OMNIA_CONNECT_OPC
            nodeName: OPC_ACCOUNT
          - locationName: UNKNOWN
            nodeName: LOADOPC_CUSTOMER_SIZE_BAND
        join:
          joinCondition: |-
            FROM {{ ref('OMNIA_CONNECT_OPC','OPC_ACCOUNT') }} OPC_ACCOUNT
              LEFT JOIN {{ ref('UNKNOWN','LOADOPC_CUSTOMER_SIZE_BAND') }} LOADOPC_CUSTOMER_SIZE_BAND
                ON OPC_ACCOUNT.ACCOUNTTYPE = LOADOPC_CUSTOMER_SIZE_BAND.ACCOUNT_TYPE
               AND OPC_ACCOUNT.CUSTOMER_SIZE_CODE = LOADOPC_CUSTOMER_SIZE_BAND.CUSTOMER_SIZE_CODE
        name: STAGEOPC_ACCOUNT
        noLinkRefs: []
  name: STAGE_OPC_ACCOUNT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
