fileVersion: 1
id: c8cf0716-a8e0-4a61-89a0-8db1b39415e1
name: S_EDS_DOCUMENT_30
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24de6c30-f29b-40ee-856c-6726cf212a84
          stepCounter: c8cf0716-a8e0-4a61-89a0-8db1b39415e1
        config: {}
        dataType: NUMERIC(18)
        defaultValue: ""
        description: Uniquely identifies a document.
        isBusinessKey: true
        name: EVENT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: df6cbcd6-ade9-4f71-bfa1-9556a4d5be5d
                stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f17eae0-41f4-430e-882b-ade169c41d69
          stepCounter: c8cf0716-a8e0-4a61-89a0-8db1b39415e1
        config: {}
        dataType: NUMERIC(18)
        defaultValue: ""
        description: ID identifying the original event associated with this event.
        name: ORIGINAL_EVENT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 31028363-1f0e-47ea-b214-c699936b1d8c
                stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 653e0764-ff05-49b4-ae3f-fb6e5d9c4adc
          stepCounter: c8cf0716-a8e0-4a61-89a0-8db1b39415e1
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: ""
        name: TEMPLATE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e4ca9cbf-f67e-4cf5-b7a0-560bd88500a8
                stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ba2da1f-1914-4ce6-891d-1c19977391de
          stepCounter: c8cf0716-a8e0-4a61-89a0-8db1b39415e1
        config: {}
        dataType: NVARCHAR(20)
        defaultValue: ""
        description: ""
        name: TEMPLATE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bebe7fcb-d1ee-4a84-b6da-8b58f5333e65
                stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 576cf422-51d0-489c-853f-4bac9c5004aa
          stepCounter: c8cf0716-a8e0-4a61-89a0-8db1b39415e1
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: TEMPLATE_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4606afa4-925e-4ac4-8a1d-afdb38ea0671
                stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac089ad2-f701-4cc8-925e-0d5fd7ad9b4a
          stepCounter: c8cf0716-a8e0-4a61-89a0-8db1b39415e1
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: ""
        name: TEMPLATE_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 310c5c5b-81c9-4569-a723-3e1a57ff9271
                stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ca00100-62fe-42be-90c6-05628b85d11b
          stepCounter: c8cf0716-a8e0-4a61-89a0-8db1b39415e1
        config: {}
        dataType: NCHAR(20)
        defaultValue: ""
        description: ""
        name: EPISODE_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7c6529f-5e0f-4ee5-9e78-2f6ec0646ce5
                stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b479fb0-ef0f-42bc-945d-5427e1a41cc0
          stepCounter: c8cf0716-a8e0-4a61-89a0-8db1b39415e1
        config: {}
        dataType: NVARCHAR(20)
        defaultValue: ""
        description: Patient NHI number.
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4e67a99-b556-4d24-8583-d6622c47771e
                stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75dcefd0-90bf-4a3d-9372-2924c7897cf0
          stepCounter: c8cf0716-a8e0-4a61-89a0-8db1b39415e1
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77256425-d7fb-42f6-a43d-297d102899d3
                stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3752e1d4-ed47-4620-81b1-6130686d6ef6
          stepCounter: c8cf0716-a8e0-4a61-89a0-8db1b39415e1
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05384952-7add-4a1a-a337-4cf1521e76f6
                stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb8c651f-92cb-427e-ac7e-2bd71c2833b4
          stepCounter: c8cf0716-a8e0-4a61-89a0-8db1b39415e1
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e103eeb5-65ee-4f5c-bef7-5626ba5b8495
                stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a0d220c9-e295-46da-91c2-a6c4a569b99a
          stepCounter: c8cf0716-a8e0-4a61-89a0-8db1b39415e1
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dce97f2f-55ab-45ff-9d00-1726ae671601
                stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c43bebf3-520d-417c-b5c1-8baf899f3c67
          stepCounter: c8cf0716-a8e0-4a61-89a0-8db1b39415e1
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f3018b79-5e4a-4bce-a1bc-bfa0e095e872
                stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e69589f-31d7-4d6d-9180-573c5cb5e327
          stepCounter: c8cf0716-a8e0-4a61-89a0-8db1b39415e1
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: PHYSICAL_LOCATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cdd20435-3960-4d91-83ce-6265793b2a33
                stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf60e4e6-fedb-4daa-8178-71bf6210cdc3
          stepCounter: c8cf0716-a8e0-4a61-89a0-8db1b39415e1
        config: {}
        dataType: NVARCHAR(20)
        defaultValue: ""
        description: ""
        name: PHYSICAL_LOCATION_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab431925-1417-4623-816d-70a2d139a024
                stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f48f475e-9858-4b12-b68a-8cdb3e78745b
          stepCounter: c8cf0716-a8e0-4a61-89a0-8db1b39415e1
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: ORIGINAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ba77402c-b647-4fa4-86a7-236958ff9487
                stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a73a045-0787-4602-8ecc-920487c4aa09
          stepCounter: c8cf0716-a8e0-4a61-89a0-8db1b39415e1
        config: {}
        dataType: NVARCHAR(1)
        defaultValue: ""
        description: ""
        name: INACTIVE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78186248-b8d5-43b0-8bfb-218faee6cdf6
                stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7a6ae09-abc2-4b6f-9e63-e57390b2e557
          stepCounter: c8cf0716-a8e0-4a61-89a0-8db1b39415e1
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_UPDATE_DATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd838c0b-1c85-4fb4-b53a-7e2b854d3ce1
                stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54a6016e-1c77-4f56-afba-8ae2b5da389d
          stepCounter: c8cf0716-a8e0-4a61-89a0-8db1b39415e1
        config: {}
        dataType: NCHAR(50)
        defaultValue: ""
        description: ""
        name: ORIG_EXT_HOSPITAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d220dad8-3614-4472-bfc2-cdbd3e781697
                stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be335fb8-fd9f-460b-9c13-7e8a99ff80c0
          stepCounter: c8cf0716-a8e0-4a61-89a0-8db1b39415e1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_EDS_document_30.s_eds_document_20.status=dim_EDS_document_status.document_status
        name: DIM_EDS_DOCUMENT_STATUS_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91995fb3-ea48-4dd9-a55d-8bb747f0ec2c
                stepCounter: 84f5056b-bd48-4477-8c12-5f88c981e107
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dbb35bcd-e4f1-4acb-ac73-f3ef645b6c4b
          stepCounter: c8cf0716-a8e0-4a61-89a0-8db1b39415e1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_EDS_document_30.s_eds_document_20.template_version=dim_EDS_template_list.version  s_EDS_document_30.s_eds_document_20.template_code=dim_EDS_template_list.template_code
        name: DIM_EDS_TEMPLATE_LIST_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c6b99cc-e5b9-4661-9ed1-5e9aa81931cf
                stepCounter: 6fb94ddb-af66-4257-981e-21c45e3e1013
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 156d73cd-a802-4160-9769-b02dfdf76b10
          stepCounter: c8cf0716-a8e0-4a61-89a0-8db1b39415e1
        config: {}
        dataType: INT
        defaultValue: ""
        description: s_EDS_event_20.cast(lastUpdateDateTime as date)=dim_EDS_last_update_date.calendar_date
        name: DIM_EDS_LAST_UPDATE_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 158ac687-cc82-4913-b409-643cb919a582
                stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ef14e3b-ffea-40b5-969e-0a74021ca839
          stepCounter: c8cf0716-a8e0-4a61-89a0-8db1b39415e1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated key for the date dimension. Nominal format is YYYYMMDD, but DD equal to 0 and greater than 31 permited for special date handling.
        name: DIM_ADMISSION_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b402ec63-d2cf-47e5-ab27-e5c03a6296f4
                stepCounter: 9996feda-efbd-41f4-8569-36f5c8b63c75
            transform: IFNULL(dim_admission_date.dim_admission_date_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1cd18a84-cfc3-4846-8ce8-a47ab948d20b
          stepCounter: c8cf0716-a8e0-4a61-89a0-8db1b39415e1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_EDS_document_30.s_eds_document_20.physical_location=dim_EDS_location.physicalLocation  s_EDS_document_30.s_eds_document_20.physical_location_type=dim_EDS_location.physicalLocationType
        name: DIM_EDS_LOCATION_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f04f4bae-a7cd-4089-aa0e-9b30a2d0a739
                stepCounter: bdee597d-567b-4bd6-9c4b-59bb6da44a38
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18a9cd1e-501d-45bf-bc9f-6c2b337483e1
          stepCounter: c8cf0716-a8e0-4a61-89a0-8db1b39415e1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_HOSPITAL_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a012b6d1-f6f0-408b-8759-a5198f9b00a1
                stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67d81d80-871e-408c-babc-2f7c26953077
          stepCounter: c8cf0716-a8e0-4a61-89a0-8db1b39415e1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated key for the date dimension. Nominal format is YYYYMMDD, but DD equal to 0 and greater than 31 permited for special date handling.
        name: DIM_DISCHARGE_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 985b56af-022e-46b3-82b0-51ae204ca926
                stepCounter: 45fbd3a8-64d0-4be6-b03a-8d128a18b549
            transform: IFNULL(dim_discharge_date.dim_discharge_date_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c714f757-44c4-4eab-9f21-64fac6a24806
          stepCounter: c8cf0716-a8e0-4a61-89a0-8db1b39415e1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_EDS_document_20.patient_reference_no=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33665c3e-dd10-4347-bb44-7fff12dfefc0
                stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 013d7049-a1d2-44d4-bfc0-3f1830c927eb
          stepCounter: c8cf0716-a8e0-4a61-89a0-8db1b39415e1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_EDS_event_20.extProviderId=dim_clinician.clinician_reference_no
        name: DIM_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5af561ed-af6a-4d1c-b72b-15c79a87c738
                stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38e771cb-33dc-46c1-8e7e-b7b60dbc7ac9
          stepCounter: c8cf0716-a8e0-4a61-89a0-8db1b39415e1
        config: {}
        dataType: INT
        defaultValue: ""
        description: s_EDS_event_20.create_date=dim_EDS_created_date.calendar_date
        name: DIM_EDS_CREATED_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c5e118b-9f63-4e15-ae9c-01e73a3525e8
                stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ec70381-acbc-4e9b-97d2-b30e34e77293
          stepCounter: c8cf0716-a8e0-4a61-89a0-8db1b39415e1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_EDS_event_20.physicalLocation=dim_service_point.service_point_reference_no
        name: DIM_SERVICE_POINT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f4548c3-baaf-460b-a1f7-bb8a9454b116
                stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c78f7bd8-4751-4705-96ec-de4122b2b8bf
          stepCounter: c8cf0716-a8e0-4a61-89a0-8db1b39415e1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_EDS_event_20.lastUpdateUserId=dim_last_modify_user_login_concerto.user_name
        name: DIM_LAST_MODIFY_USER_LOGIN_CONCERTO_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b3958ac8-23d7-4cae-af20-46c843abb7ed
                stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17d15c60-83f8-496e-bf11-26968a9c9b5e
          stepCounter: c8cf0716-a8e0-4a61-89a0-8db1b39415e1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_EDS_event_20.s_EDS_event_10.createUserId=dim_create_user_login_concerto.user_name
        name: DIM_CREATE_USER_LOGIN_CONCERTO_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4351c281-e262-454b-855b-fc20eb60e60e
                stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: faa29eaf-bc34-4b8b-8f98-90cda524c213
          stepCounter: c8cf0716-a8e0-4a61-89a0-8db1b39415e1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_EDS_event_20.specialtyType=dim_specialty.specialty_reference_no
        name: DIM_SPECIALTY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b9a8623-42a3-4786-bc58-f534cc5f7b81
                stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d793e52-df29-4a9e-8ce3-090532ad89a0
          stepCounter: c8cf0716-a8e0-4a61-89a0-8db1b39415e1
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_EDS_DOCUMENT_20: 73713efd-3821-41a6-98dc-f739c8ef4801
          DIM_ADMISSION_DATE: 9996feda-efbd-41f4-8569-36f5c8b63c75
          DIM_DISCHARGE_DATE: 45fbd3a8-64d0-4be6-b03a-8d128a18b549
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_EDS_DOCUMENT_20
          - locationName: TGT
            nodeName: DIM_ADMISSION_DATE
          - locationName: TGT
            nodeName: DIM_DISCHARGE_DATE
        join:
          joinCondition: |-
            FROM {{ ref('TGT','S_EDS_DOCUMENT_20') }} s_EDS_document_20
              LEFT JOIN {{ ref('TGT','DIM_ADMISSION_DATE') }} dim_admission_date
                ON IFNULL(cast(s_EDS_document_20.admit_date AS date),'1900-01-01 00:00:00.000') = dim_admission_date.admission_calendar_date
              LEFT JOIN {{ ref('TGT','DIM_DISCHARGE_DATE') }} dim_discharge_date
                ON IFNULL(cast(s_EDS_document_20.discharge_date AS date),'1900-01-01 00:00:00.000') = dim_discharge_date.discharge_calendar_date
        name: S_EDS_DOCUMENT_30
        noLinkRefs: []
  name: S_EDS_DOCUMENT_30
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
