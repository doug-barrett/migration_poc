fileVersion: 1
id: 840f8159-300b-4fb5-87ca-caa566d68569
name: S_IN_PATIENT_STAY_DETAIL_20
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "InPatient Ward Stays expanded by Calendar Day, with Specialty and Clinician details."
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f8efde0-12ac-446d-83df-3dd32082801d
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 41b5bca2-fbfc-4df6-b42d-d48b403d9aef
                stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae368be6-a94a-4df0-b504-c1f0f25ce29b
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9631bdb0-583d-45ba-a6d9-580e9cee1d91
                stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1d6c995-52ef-44d6-b8fb-9726fe387f18
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c14443e0-1bdd-4c76-b977-9643a6dfbe2e
                stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 89ceec1b-cb87-4dcd-8c01-78ffb450f6ce
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee08d4ce-8bb7-4555-8321-7fdc54ab026a
                stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 60b866c6-7910-4494-988f-43cd6f358a3e
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: stay_Patient National Health Index (NMPI)
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83c59575-719b-4cfb-ac53-ebb11a903589
                stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ab4e4e7-24ae-4640-b0f8-611e44ed9e97
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_stay_detail_20.patient_reference_no=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9962a01b-5f3d-4c1a-b371-997edef38d0f
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8bd7a9f0-7eaf-4e81-952e-c3dd73bc30ae
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: a specific calendar date of all dates covered  this stay
        name: STAY_CALENDAR_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aaf7d8f7-5039-4164-b4b0-593266f28149
                stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50aaddf6-6807-4a4b-8d3e-2c3c9762beb7
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_stay_detail_20.CONVERT(date,stay_calendar_date)=dim_date.calendar_date
        name: DIM_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e325898-55b4-4da5-b829-888e5823e2fc
                stepCounter: bc3fcb77-c0c4-477a-92d8-4db14f153b73
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6196f0d2-53a9-4b59-9490-6d5bc1111b7a
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SEEN_BY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e6131973-4cf3-4157-b438-659114c8e49f
                stepCounter: 1e35a775-a397-48bc-8506-7f4c875e53c1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40814f9a-a9b9-400c-a43d-bc6cdfe56488
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SEEN_BY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3882e6b3-7853-4c65-b67f-2e838aaf8e14
                stepCounter: 1e35a775-a397-48bc-8506-7f4c875e53c1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 835f0357-3fdf-4674-b114-86b425202502
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: STAY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 92bae77f-3748-4428-a77c-1bf365f90ccf
                stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
            transform: |-
              CASE WHEN DATEDIFF(DAY,s_in_patient_stay_detail_10.stay_calendar_date,s_in_patient_stay_detail_10.stay_start_date) = 0 THEN s_in_patient_stay_detail_10.stay_start_date
                          ELSE cast(s_in_patient_stay_detail_10.stay_calendar_date AS date)
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 268f94ba-d497-4799-84be-56a2c2646e40
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: STAY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce964ded-3592-4f6f-8e35-c711a39e3696
                stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
            transform: |-
              CASE WHEN DATEDIFF(DAY,s_in_patient_stay_detail_10.stay_calendar_date,s_in_patient_stay_detail_10.stay_end_date) = 0 AND stay_calendar_date <> s_in_patient_stay_detail_10.stay_end_date THEN s_in_patient_stay_detail_10.stay_end_date
                          ELSE s_in_patient_stay_detail_10.stay_calendar_date
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e7eeb56-f7cf-4891-9f83-522f17aa4df4
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMISSION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a88257ff-1058-48b1-a249-d7f2319850f9
                stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d6203c6-15f2-427b-96fe-354c2713a04d
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fed5694d-0e3c-4f62-a895-43343124f743
                stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f14d496-1b3c-458a-b7ad-c4a0fece83a3
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAY_WARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d05b0f5-fa53-4265-bf4d-b6be43619b09
                stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 082bd35c-4ecc-4738-ad1c-0c277f005b9d
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: stay_ward_code
        name: STAY_WARD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5b882827-c188-4f0c-b8ab-940dcfd95d03
                stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1497693d-b932-442e-a07f-1f3b671b17e9
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_WARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bba83b98-6285-455b-a478-fa9f9dc264d6
                stepCounter: 1e35a775-a397-48bc-8506-7f4c875e53c1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86716aac-ced5-4bb3-8e6a-c5c1d34477c8
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_stay_detail_20.stay_ward_code=dim_ward.ward_code
        name: DIM_WARD_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6aa5e7b8-4dc5-4b87-a4c2-5013db0e1dfc
                stepCounter: 50c31151-9204-4154-9caf-5d28244bde1a
            transform: IFNULL(dim_ward.dim_ward_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8c0adf7-a152-4f52-9988-089c68f8f7c6
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e9890381-b2ef-4a80-af37-8f8fadc5a730
                stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 707a8884-94dd-4b31-9c00-ac66363c7150
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Stay_Healthcare_Professional_Code
        name: STAY_CLINICIAN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56891a28-46a8-488f-b16b-c470b09c20bf
                stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d68a94e4-045f-49ad-8a16-0f1381ef61f6
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 73d06e9d-e14e-4906-8cfc-9f568bb86d3a
                stepCounter: 1e35a775-a397-48bc-8506-7f4c875e53c1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: feeab8f2-10fc-4c18-a5c4-6edacf600850
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_stay_detail_20.stay_clinician_reference_no=dim_clinician.clinician_reference_no
        name: DIM_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 911a8788-86e5-4a5c-a00a-a957d59070b8
                stepCounter: e8e4a684-3ef8-4076-846f-48d5689e824f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f78fe6a6-bf70-4920-940a-d202022c2fff
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3baffb64-9cc4-44c5-91e6-c7893a7c72da
                stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b46d30d-969c-45dd-bb5f-0e5cccca96de
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Event_Health_Specialty_Code
        name: EVENT_HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7cb3f210-ca32-45e9-b41a-9af93829fa29
                stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c4ed416-bfe8-491c-a3ff-fe80d2b85680
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eaa92fbb-d07c-43d9-beb3-7d54eb24c7eb
                stepCounter: 1e35a775-a397-48bc-8506-7f4c875e53c1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 996f4a6a-b57e-4172-b3a5-5a3ded46a04e
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_stay_detail_20.event_specialty_reference_no=dim_specialty.specialty_reference_no
        name: DIM_SPECIALTY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79aee918-ff6f-4b0a-a656-000827899f3e
                stepCounter: 4182a75e-d07b-4637-97fa-4c01e2878360
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 345b1e74-3ff1-4e46-b32f-498067f44545
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: stay_current_leave_reference_no
        name: STAY_CURRENT_LEAVE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 144c3b8d-8230-4ab3-84f5-dd74e459b0f7
                stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 90823b31-3b10-4e8e-a0e7-a5fb5370c003
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: STAY_CURRENT_LEAVE_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c6e1df0f-425f-44ee-92ba-2e52d5bfd8c0
                stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4afbb10-abd5-40a2-a69f-b32399ea2f18
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: STAY_CURRENT_LEAVE_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: af316983-c031-4f39-9757-33035bdc8294
                stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec4a45c7-42d5-47e1-bac5-c474a339b222
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ED_ATTENDANCE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 664412ac-c947-4f04-a783-253057dcd4f0
                stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 198002ea-ea41-491a-b3d8-0e67f13d7b99
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5dcf6435-805c-494f-ab4f-f7bfc3618ecf
                stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f70411fb-0107-4675-8906-826be6ba92f3
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Defaults to N then custom procedure updates where H00 = 1
        name: OVERNIGHT_STAY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 92bae77f-3748-4428-a77c-1bf365f90ccf
                stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
            transform: "'N'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f8a3c383-8244-41ca-b467-acdf7ed2a2e3
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: LEAVE_IN_STAY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 144c3b8d-8230-4ab3-84f5-dd74e459b0f7
                stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
            transform: |-
              CASE WHEN s_in_patient_stay_detail_10.stay_current_leave_reference_no IS NULL THEN 'N'
                          ELSE 'Y'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0a63744-b500-4234-8f36-437dce23d247
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAY_DAY_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c14443e0-1bdd-4c76-b977-9643a6dfbe2e
                stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
            transform: ROW_NUMBER() OVER (PARTITION BY s_in_patient_stay_detail_10.stay_reference_no ORDER BY s_in_patient_stay_detail_10.stay_calendar_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd05c96e-c541-4394-b09a-6f7d684ccd3b
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAY_DAY_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c14443e0-1bdd-4c76-b977-9643a6dfbe2e
                stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
            transform: COUNT(1) OVER (PARTITION BY s_in_patient_stay_detail_10.stay_reference_no)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1b6da6f-f547-4240-bf34-381485a22258
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_STAY_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 89dc8f4d-57be-4179-b73d-ef4b56f16069
                stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 13ee6f04-fd2c-4a65-9a67-0ad3ca7712bb
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_STAY_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd838134-2d6b-4490-9515-f7e321ceea8f
                stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b34718b1-53e1-406c-8898-7f809c71b6a7
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_STAY_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 197078e5-9519-49b5-82f5-33796068ea33
                stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
            transform: |-
              CASE WHEN cast(s_in_patient_stay_detail_10.stay_calendar_date AS date) = cast(s_in_patient_stay_detail_10.stay_start_Date AS date) AND s_in_patient_stay_detail_10.stay_calendar_date = s_in_patient_stay_detail_10.stay_end_Date  THEN DATEDIFF(mi,s_in_patient_stay_detail_10.stay_start_date, s_in_patient_stay_detail_10.stay_calendar_date)
                          WHEN cast(s_in_patient_stay_detail_10.stay_calendar_date AS date) = cast(s_in_patient_stay_detail_10.stay_start_Date AS date) AND s_in_patient_stay_detail_10.stay_calendar_date <> s_in_patient_stay_detail_10.stay_end_Date THEN DATEDIFF(mi,s_in_patient_stay_detail_10.stay_start_date, s_in_patient_stay_detail_10.stay_calendar_date)+1
                          WHEN cast(s_in_patient_stay_detail_10.stay_calendar_date AS date) = cast(s_in_patient_stay_detail_10.stay_end_Date AS date)                                                                                                   THEN DATEDIFF(mi,cast(cast(s_in_patient_stay_detail_10.stay_calendar_date AS date) AS datetime), s_in_patient_stay_detail_10.stay_end_date)
                          ELSE 1440
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c07963b0-44a7-488e-9b1d-d3d505e5959f
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_STAY_TOTAL_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bb91d3d1-749e-4a41-8fdb-77e530b438b9
                stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 58017b72-132e-4042-a456-9c8ce1c9438f
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e6131973-4cf3-4157-b438-659114c8e49f
                stepCounter: 1e35a775-a397-48bc-8506-7f4c875e53c1
            transform: DATEDIFF(mi,s_in_patient_seen_by_10.seen_by_start_date,s_in_patient_seen_by_10.seen_by_end_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45996f0c-cf65-4352-b61f-f291182fb9f7
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_SEEN_BY_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d972cc14-cdd9-44c6-a899-32854306607a
                stepCounter: 1e35a775-a397-48bc-8506-7f4c875e53c1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d77ed6f-3097-4cbf-8aa5-17af6f887ed2
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_SEEN_BY_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56a74b85-c014-4a84-b5a5-30010b205c72
                stepCounter: 1e35a775-a397-48bc-8506-7f4c875e53c1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5bbf2c7-2ab9-4059-a6fe-5ad51d5cb015
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 12am (00:00:00)
        name: H00
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aabdb22e-89bd-41b1-8d3d-63e5a7861982
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 1am
        name: H01
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0096bce4-a1a5-410d-837c-bf415955371f
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 2am
        name: H02
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d108359-18e1-4e4c-807f-f970dd8075e0
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 3am
        name: H03
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3fe0257d-f4b8-444f-b388-cd4a432b4565
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 4am
        name: H04
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db2cfe8d-a2db-42de-b557-585f0686bba9
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 5am
        name: H05
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 43c48264-1c9f-468b-b0d9-bb9773874639
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 6am
        name: H06
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ddc34d04-866a-4a43-900e-8a340474a629
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 7am
        name: H07
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18e9cac0-8d63-4894-aca4-4b4299070e57
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 8am
        name: H08
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b1a76ec-0511-48ed-81f2-e8fd5707fb20
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 9am
        name: H09
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3fc1a8a7-a18b-438e-aa36-48c294b908c9
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 10am
        name: H10
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0ec76a8-2456-47e9-87fa-225d70e558bb
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 11am
        name: H11
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d20f65a-8c63-4239-952c-44bd801e4e66
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 12pm (12:00:00)
        name: H12
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0fb73d67-60d2-4332-a3f6-f82df9143eff
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 1pm
        name: H13
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: acc401b9-b6d5-4401-94c5-2ad8cfc21bc4
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 2pm
        name: H14
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d60062f6-35ad-4b56-961c-3a75ecbd493a
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 3pm
        name: H15
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9caa4b8a-0ee7-4bf6-9a9f-9fbbe2847854
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 4pm
        name: H16
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3316b9ff-3ddf-4466-9818-bf175d287c56
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 5pm
        name: H17
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 37119052-d1df-4099-9125-54d966fcbd6e
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 6pm
        name: H18
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f061c5c0-2ac5-4904-ab10-d51dda70f80a
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 7pm
        name: H19
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 190a2fa2-2aee-4eb2-81b5-66af470f7306
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 8pm
        name: H20
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf201c9d-be25-47ff-a98c-8db7125c5b5d
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 9pm
        name: H21
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 84cca9e7-3711-4537-b736-8bd1757b79e8
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 10pm
        name: H22
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f7be40e-39fd-49da-a923-3ccd111a8ecf
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 11pm
        name: H23
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20074f4b-1025-489f-b3dc-344eaef991de
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: dss_data_quality_code
        name: DSS_DATA_QUALITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 924c9c53-e009-4257-aa82-12c194a14c25
                stepCounter: 09991c53-b3e2-450a-84e1-9722b55776ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b37b93f2-b779-4290-b6e8-88746a019f71
          stepCounter: 840f8159-300b-4fb5-87ca-caa566d68569
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DIM_WARD: 50c31151-9204-4154-9caf-5d28244bde1a
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_IN_PATIENT_STAY_DETAIL_10
          - locationName: TGT
            nodeName: DIM_WARD
        join:
          joinCondition: |-
            FROM s_in_patient_stay_detail_10
              LEFT OUTER JOIN s_in_patient_seen_by_10
                ON s_in_patient_seen_by_10.event_encounter_id = s_in_patient_stay_detail_10.event_encounter_id
               AND s_in_patient_stay_detail_10.stay_calendar_date >= s_in_patient_seen_by_10.seen_by_start_date
               AND (CASE WHEN event_seen_by_seq_num < event_seen_by_count THEN s_in_patient_stay_detail_10.stay_calendar_date ELSE CONVERT(date,s_in_patient_stay_detail_10.stay_calendar_date) END) <= CONVERT(DATE,IFNULL(s_in_patient_seen_by_10.seen_by_end_date,s_in_patient_seen_by_10.seen_by_start_date))
              LEFT OUTER JOIN {{ ref('TGT','DIM_WARD') }}
                ON s_in_patient_stay_detail_10.stay_ward_reference_no = dim_ward.ward_reference_no
               AND IFNULL(dim_ward.dss_start_date, GETDATE()-10000) <= s_in_patient_stay_detail_10.stay_start_date
               AND IFNULL(dim_ward.dss_end_date, GETDATE()+10000) >= s_in_patient_stay_detail_10.stay_start_date
        name: S_IN_PATIENT_STAY_DETAIL_20
        noLinkRefs: []
  name: S_IN_PATIENT_STAY_DETAIL_20
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
