fileVersion: 1
id: 839618b8-85ee-4c27-9c30-9db834cbbce9
name: S_LKP_MCC_MASTERCARD_MROC_HISTORY
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DATAVAULT_BUSINESS_VAULT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eadc9bc5-d27f-4939-aae6-883f69d3a943
          stepCounter: 839618b8-85ee-4c27-9c30-9db834cbbce9
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: ""
        name: HK_H_LKP_MCC_MASTERCARD
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e926f79b-e1da-42c1-b9ab-28f85001c9d7
                stepCounter: 2125f912-d1e5-42c2-91ac-bb6a445b4ae3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 179ecedd-54e9-4eea-b2b8-9adc59509d39
          stepCounter: 839618b8-85ee-4c27-9c30-9db834cbbce9
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: MCC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed238143-4899-4434-a2e6-475823dba1c4
                stepCounter: 2125f912-d1e5-42c2-91ac-bb6a445b4ae3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6fc5e83-2416-4be7-8285-dbef977d5f59
          stepCounter: 839618b8-85ee-4c27-9c30-9db834cbbce9
        config: {}
        dataType: VARCHAR(200)
        defaultValue: ""
        description: ""
        name: ISO_RANGE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d26017a9-76e8-4e92-9a68-b71c69cac5df
                stepCounter: 2125f912-d1e5-42c2-91ac-bb6a445b4ae3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1110a09b-48a0-4597-bef6-28820defe795
          stepCounter: 839618b8-85ee-4c27-9c30-9db834cbbce9
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: ISO_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a4de054-86f3-49bb-9264-6ade128abbfd
                stepCounter: 2125f912-d1e5-42c2-91ac-bb6a445b4ae3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1b3db36-b1d4-4ab9-9ae4-de7341b86e57
          stepCounter: 839618b8-85ee-4c27-9c30-9db834cbbce9
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: MASTER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c4b4abc-0f8e-47f9-99ca-77a77ba184aa
                stepCounter: 2125f912-d1e5-42c2-91ac-bb6a445b4ae3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f286a81-53ff-449d-bf7a-956db87ef870
          stepCounter: 839618b8-85ee-4c27-9c30-9db834cbbce9
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: MASTER_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fdfb1913-171e-42f5-9aca-394b1664880b
                stepCounter: 2125f912-d1e5-42c2-91ac-bb6a445b4ae3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 581fe0de-bb85-4eaa-8d1c-22e2f341b0c7
          stepCounter: 839618b8-85ee-4c27-9c30-9db834cbbce9
        config: {}
        dataType: VARCHAR(400)
        defaultValue: ""
        description: ""
        name: TCC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 018d30ed-0b38-4e11-a624-b8f53fbbce74
                stepCounter: 2125f912-d1e5-42c2-91ac-bb6a445b4ae3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d5d602b-1427-41bc-b95b-6fec30b5ce5c
          stepCounter: 839618b8-85ee-4c27-9c30-9db834cbbce9
        config: {}
        dataType: VARCHAR(200)
        defaultValue: ""
        description: ""
        name: TCC_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8d51d17f-a27b-4012-987a-a3632a95c156
                stepCounter: 2125f912-d1e5-42c2-91ac-bb6a445b4ae3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 52f27029-c8cb-4625-a226-de7a3e21ed0d
          stepCounter: 839618b8-85ee-4c27-9c30-9db834cbbce9
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: TCC_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48741787-8347-47e0-903a-32560d721af6
                stepCounter: 2125f912-d1e5-42c2-91ac-bb6a445b4ae3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5ccec87-bcb7-4e18-b5b9-0b8e91435955
          stepCounter: 839618b8-85ee-4c27-9c30-9db834cbbce9
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: MASTER_MCC_CATEG_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00980b53-741b-4441-82af-4abb9761c1ac
                stepCounter: 2125f912-d1e5-42c2-91ac-bb6a445b4ae3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 28d88d83-6c3e-4f97-a24b-c3cb3eafea98
          stepCounter: 839618b8-85ee-4c27-9c30-9db834cbbce9
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: MASTER_MCC_CATEG_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77ecd231-9ea7-42e9-972c-2f2a65392892
                stepCounter: 2125f912-d1e5-42c2-91ac-bb6a445b4ae3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 016b9d83-4997-4696-8d79-646f09efa458
          stepCounter: 839618b8-85ee-4c27-9c30-9db834cbbce9
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: GEOGRAPHY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9f91047b-0e14-42b1-9e90-5b541b259cc2
                stepCounter: 2125f912-d1e5-42c2-91ac-bb6a445b4ae3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8a78c3c-1c59-48c2-96c2-b6af15973c0a
          stepCounter: 839618b8-85ee-4c27-9c30-9db834cbbce9
        config: {}
        dataType: VARCHAR(200)
        defaultValue: ""
        description: ""
        name: COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a8fc3c6-3237-418e-8169-06338af81ed9
                stepCounter: 2125f912-d1e5-42c2-91ac-bb6a445b4ae3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 115c41b3-e11c-4266-b17c-fa609e9f8bda
          stepCounter: 839618b8-85ee-4c27-9c30-9db834cbbce9
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c1cc21cc-328d-43ea-a577-e6010a394c81
                stepCounter: 2125f912-d1e5-42c2-91ac-bb6a445b4ae3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5766e425-1240-41c0-aa7b-2526e86f2848
          stepCounter: 839618b8-85ee-4c27-9c30-9db834cbbce9
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: The changing hash
        name: DSS_CHANGE_HASH
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf4cfd19-b0d0-4602-8f92-090404b46886
                stepCounter: 2125f912-d1e5-42c2-91ac-bb6a445b4ae3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af121b02-b509-4aac-b16d-21a2042df66f
          stepCounter: 839618b8-85ee-4c27-9c30-9db834cbbce9
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Record source
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: abc0b0c7-0e58-41f6-8422-6a755e9183c7
                stepCounter: 2125f912-d1e5-42c2-91ac-bb6a445b4ae3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ffec2eb5-8def-426d-8e7c-e58b600fbbf4
          stepCounter: 839618b8-85ee-4c27-9c30-9db834cbbce9
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was loaded in the data vault
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03f9ec64-6a5d-4795-8c21-ed2e627e668b
                stepCounter: 2125f912-d1e5-42c2-91ac-bb6a445b4ae3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a4115e3e-b5d3-400b-95c9-5b31f307a950
          stepCounter: 839618b8-85ee-4c27-9c30-9db834cbbce9
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row started in the data vault
        isSystemStartDate: true
        name: DSS_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 258e42e3-aef9-4ffc-8970-d2206ba82262
                stepCounter: 2125f912-d1e5-42c2-91ac-bb6a445b4ae3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c81a136-a5f2-4279-8080-6d1c60a7717c
          stepCounter: 839618b8-85ee-4c27-9c30-9db834cbbce9
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: Version number of a business key in the data vault
        isSurrogateKey: true
        isSystemVersion: true
        name: DSS_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d29308b-7da9-477d-8279-d35a8eb15f4d
                stepCounter: 2125f912-d1e5-42c2-91ac-bb6a445b4ae3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95765d35-fcf2-4092-a406-5e3466f9b833
          stepCounter: 839618b8-85ee-4c27-9c30-9db834cbbce9
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was inserted in the data vault
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 273cc89b-3d77-4a5f-ac23-2caff5a51939
                stepCounter: 2125f912-d1e5-42c2-91ac-bb6a445b4ae3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e04829c-d3a4-478c-96c6-ee10432ed671
          stepCounter: 839618b8-85ee-4c27-9c30-9db834cbbce9
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: End date determined by the next Satellite change record dss_start_date
        isSystemEndDate: true
        name: DSS_END_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: LEAD(dss_start_date, 1, '9999-12-31') OVER(PARTITION BY hk_h_lkp_mcc_mastercard ORDER BY dss_start_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 813566b6-0f2c-4aad-8255-1ae1f732eca7
          stepCounter: 839618b8-85ee-4c27-9c30-9db834cbbce9
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: CurrentFlag 'N' unless next Satellite change record dss_start_date is null, indicating this is the most current record.
        isSurrogateKey: true
        isSystemCurrentFlag: true
        name: DSS_CURRENT_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN LEAD(dss_start_date, 1, NULL) OVER(PARTITION BY hk_h_lkp_mcc_mastercard ORDER BY dss_start_date) IS NULL THEN 'Y'
                          ELSE 'N'
                           END
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_LKP_MCC_MASTERCARD_MROC: 2125f912-d1e5-42c2-91ac-bb6a445b4ae3
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATAVAULT_RAW_VAULT
            nodeName: S_LKP_MCC_MASTERCARD_MROC
        join:
          joinCondition: FROM {{ ref('DATAVAULT_RAW_VAULT','S_LKP_MCC_MASTERCARD_MROC') }} s_lkp_mcc_mastercard_mroc
        name: S_LKP_MCC_MASTERCARD_MROC_HISTORY
        noLinkRefs: []
  name: S_LKP_MCC_MASTERCARD_MROC_HISTORY
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
