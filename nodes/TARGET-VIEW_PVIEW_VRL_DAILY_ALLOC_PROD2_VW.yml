fileVersion: 1
id: 63897bb7-ee6e-4b72-882a-13521f542024
name: VIEW_PVIEW_VRL_DAILY_ALLOC_PROD2_VW
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: "-- This view gets the site production for the wells.  It is used -- in the loader and many reports. -- units : liquids assume m3 in database --        gas - use calc settings of flow network basetemp  --        if 15 deg C then e3m3, if 0 deg C them e3"
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e642abdf-0b4e-4161-9e3d-04e43c2e63a6
          stepCounter: 63897bb7-ee6e-4b72-882a-13521f542024
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: IDFLOWNET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e1da49e-8182-4861-8905-81254314693e
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5bcdc507-09f3-443d-8d8d-598dcc21d20f
          stepCounter: 63897bb7-ee6e-4b72-882a-13521f542024
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: TEMPBASE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e8641371-a68d-4bd2-bd72-5d32bcc9be46
                stepCounter: ff7957af-8a84-42a3-9e98-3c09478b07b7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8e32ea4-32dd-4665-9f8c-ea8eadb8b91c
          stepCounter: 63897bb7-ee6e-4b72-882a-13521f542024
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7014a46b-a09f-4d32-ae9a-66b516c1d8d6
                stepCounter: b2609f15-a93c-4c5d-b86e-0898ad7558d0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 508b0eb8-659b-438b-aba1-36e8e1b0268a
          stepCounter: 63897bb7-ee6e-4b72-882a-13521f542024
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: IDRECCOMPORIGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 614f3f77-1081-4f63-a6bb-a0980a762bd9
                stepCounter: ea268a25-6178-41db-bb1c-626f178df0d6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8161ef63-1687-4277-a298-e65287fb1ada
          stepCounter: 63897bb7-ee6e-4b72-882a-13521f542024
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: IDRECUNITORIGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dfe22de8-f6e2-429b-90aa-91f793353b62
                stepCounter: d554b1ad-15ef-40f5-8fff-8a730cc8b68e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38ea3219-cd64-4739-939c-6b0b9eebc50c
          stepCounter: 63897bb7-ee6e-4b72-882a-13521f542024
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: PROD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f12a712-52a9-49bc-b9b3-9f6c776cada1
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c86b891-be43-4296-89c7-18e12fc18499
          stepCounter: 63897bb7-ee6e-4b72-882a-13521f542024
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: OPHOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 565c3190-bc88-4ecf-8f99-070028fb908c
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b87174ff-4e7c-47a8-9820-e9bbd0809d34
          stepCounter: 63897bb7-ee6e-4b72-882a-13521f542024
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: WI_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c20e0f47-3157-4ac3-b43f-71f5fe1a075d
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 936fcea6-c510-4db2-b83d-0969a9dc772e
          stepCounter: 63897bb7-ee6e-4b72-882a-13521f542024
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: WI_OIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56af0ab0-f80f-4382-9236-5939ab19ee61
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b205017-047a-4531-9e63-33826969f8bb
          stepCounter: 63897bb7-ee6e-4b72-882a-13521f542024
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: WORKING_INTEREST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f74efd7-6319-4826-ba22-e0fffee38500
          stepCounter: 63897bb7-ee6e-4b72-882a-13521f542024
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: GAS_RAW_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca6bdbb5-159b-46cb-b03b-3a442348eeae
          stepCounter: 63897bb7-ee6e-4b72-882a-13521f542024
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: GAS_SALES_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe3a6f96-49fc-48fe-bebc-0d4a04b3ffdf
          stepCounter: 63897bb7-ee6e-4b72-882a-13521f542024
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: GAS_SALES_WI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d454711-32a7-49c9-80cb-d1344a665a71
          stepCounter: 63897bb7-ee6e-4b72-882a-13521f542024
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: GAS_GROSS_US
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 61d3d3d4-3a42-4668-8e86-4137c3bcfc91
          stepCounter: 63897bb7-ee6e-4b72-882a-13521f542024
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: GAS_SALES_NRI_US
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d56fb3e-07cf-43e9-9363-72efddd25b5b
          stepCounter: 63897bb7-ee6e-4b72-882a-13521f542024
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: OIL_RAW_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b2bf522-5a8e-4542-b00a-94f7e3afba17
          stepCounter: 63897bb7-ee6e-4b72-882a-13521f542024
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: OIL_ALLOC_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7740fdd2-9a15-464a-9cfb-6900e026a6a5
          stepCounter: 63897bb7-ee6e-4b72-882a-13521f542024
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: OIL_ALLOC_WI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03c42c57-04f2-4a1e-9acb-fb9db750581d
          stepCounter: 63897bb7-ee6e-4b72-882a-13521f542024
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: OIL_SALES_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f975085-f458-4b73-b070-3d09b8a6eaa0
          stepCounter: 63897bb7-ee6e-4b72-882a-13521f542024
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: OIL_SALES_WI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6c290a1-2895-4c63-954d-faeff4af5d66
          stepCounter: 63897bb7-ee6e-4b72-882a-13521f542024
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: OIL_INV_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 932cf238-9ac0-4714-9489-04475695b678
          stepCounter: 63897bb7-ee6e-4b72-882a-13521f542024
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: OIL_INV_WI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f93e13c8-4601-4e0d-836c-de740852d419
          stepCounter: 63897bb7-ee6e-4b72-882a-13521f542024
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: NGL_ALLOC_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae4f0516-9a22-4fd6-af4b-7a0492eee825
          stepCounter: 63897bb7-ee6e-4b72-882a-13521f542024
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: COND_ALLOC_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4969e74-1a10-4e31-9aac-5d90ede5bffa
          stepCounter: 63897bb7-ee6e-4b72-882a-13521f542024
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: NGL_ALLOC_WI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 225b5f30-1f5e-490b-8a1a-e83bf0b20820
          stepCounter: 63897bb7-ee6e-4b72-882a-13521f542024
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: COND_ALLOC_WI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 62658c05-085d-4ca9-acb6-3182d5d22fc2
          stepCounter: 63897bb7-ee6e-4b72-882a-13521f542024
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: NGL_SALES_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d463faf-1d41-4300-a0e5-c5e87c109106
          stepCounter: 63897bb7-ee6e-4b72-882a-13521f542024
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: NGL_SALES_WI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3974e975-b391-4800-ab01-361d68c63f48
          stepCounter: 63897bb7-ee6e-4b72-882a-13521f542024
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: COND_SALES_WI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c4a39c6-b168-4783-9e60-7220ebeaf76c
          stepCounter: 63897bb7-ee6e-4b72-882a-13521f542024
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: OIL_ALLOC_NRI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 595b1a15-33a5-450e-b3ea-a2c9d9a39695
          stepCounter: 63897bb7-ee6e-4b72-882a-13521f542024
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: NGL_SALES_NRI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9979db0a-d13c-4b66-8127-797c18864ada
          stepCounter: 63897bb7-ee6e-4b72-882a-13521f542024
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: NGL_INV_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2faf2540-aedd-470b-9603-7c0558ed5f77
          stepCounter: 63897bb7-ee6e-4b72-882a-13521f542024
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: NGL_INV_WI
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42c279ac-3a10-49e5-aedd-3e854b362836
          stepCounter: 63897bb7-ee6e-4b72-882a-13521f542024
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: WATER_ALLOC_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7cb9ade-94e1-43ef-8d14-bd6f17d02592
          stepCounter: 63897bb7-ee6e-4b72-882a-13521f542024
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: WATER_ALLOC_WI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14302cdd-9af5-45a3-abcb-5f812635191a
          stepCounter: 63897bb7-ee6e-4b72-882a-13521f542024
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: WATER_RAW_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9fe75b0-dc14-4973-bcf9-2265eb3dae31
          stepCounter: 63897bb7-ee6e-4b72-882a-13521f542024
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: BOE_ALLOC_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91e2105f-8757-4226-9674-9ba2e8d780f7
          stepCounter: 63897bb7-ee6e-4b72-882a-13521f542024
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: BOE_ALLOC_WI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98350068-867d-4a48-b122-c39d45fa8f63
          stepCounter: 63897bb7-ee6e-4b72-882a-13521f542024
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: BOE_SALES_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 56afd217-6c21-43c1-bf64-f5a305c0c68a
          stepCounter: 63897bb7-ee6e-4b72-882a-13521f542024
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: BOE_SALES_WI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02e97352-f396-4d97-86de-050478fbfbfa
          stepCounter: 63897bb7-ee6e-4b72-882a-13521f542024
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: BOE_SALES_GROSS_US
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c3eeece-ce60-4535-9259-81608cba6af4
          stepCounter: 63897bb7-ee6e-4b72-882a-13521f542024
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: BOE_SALES_NRI_US
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 10c9aa15-dc67-43a8-bbc9-a6af412c4a09
          stepCounter: 63897bb7-ee6e-4b72-882a-13521f542024
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: BU_SF_ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 748cdf05-5750-44bd-bb7a-77b0769f897d
                stepCounter: bd388a52-3d72-4c70-833d-7de7c6a8abd1
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_PVIEW_VRL_DAILY_ALLOC_PROD2_VW: 63897bb7-ee6e-4b72-882a-13521f542024
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_PVIEW_VRL_DAILY_ALLOC_PROD2_VW') }} AS SELECT d.idflownet,
                   s.tempbase,
                   c.wellidregulatory AS uwi,
                   c.idrec AS idreccomporigin,
                   u.idrec AS idrecunitorigin,
                   d.dttm AS prod_date,
                   d.durop * 24 AS ophours,
                   d.wigas AS wi_gas,
                   d.wihcliq AS wi_oil,
                   CASE WHEN IfNULL(d.wigas, 0) = 0 THEN IfNULL(d.wihcliq, 0)
                        ELSE IfNULL(d.wigas, 0)
                         END AS working_interest,
                   d.volprodgathgas / 1000 * CASE WHEN s.tempbase IS NULL THEN 1
                        ELSE 37.25 / 35.49373
                         END AS gas_raw_gross,
                   d.voldispsalegas / 1000 * CASE WHEN s.tempbase IS NULL THEN 1
                        ELSE 37.25 / 35.49373
                         END AS gas_sales_gross,
                   d.wigas * d.voldispsalegas / 1000 * CASE WHEN s.tempbase IS NULL THEN 1
                        ELSE 37.25 / 35.49373
                         END AS gas_sales_wi,
                   d.volnewprodallocgas / 1000 * CASE WHEN s.tempbase IS NULL THEN 1
                        ELSE 37.25 / 35.49373
                         END AS gas_gross_us,
                   d.wigas * d.voldispsalegas / 1000 * CASE WHEN s.tempbase IS NULL THEN 1
                        ELSE 37.25 / 35.49373
                         END AS gas_sales_nri_us,
                   d.volprodgathhcliq AS oil_raw_gross,
                   d.volnewprodallocoil AS oil_alloc_gross,
                   d.wihcliq * d.volnewprodallocoil AS oil_alloc_wi,
                   d.voldispsaleoil - ifnull(d.volrecovhcliq, 0) AS oil_sales_gross,
                   d.wihcliq * (d.voldispsaleoil - ifnull(d.volrecovhcliq, 0)) AS oil_sales_wi,
                   d.volchginvhcliq AS oil_inv_gross,
                   d.wihcliq * d.volchginvhcliq AS oil_inv_wi,
                   d.volnewprodallocngl AS ngl_alloc_gross,
                   d.volnewprodalloccond AS cond_alloc_gross,
                   d.wihcliq * d.volnewprodallocngl AS ngl_alloc_wi,
                   d.wihcliq * d.volnewprodalloccond AS cond_alloc_wi,
                   d.voldispsalengl + d.voldispsalecond AS ngl_sales_gross,
                   d.wihcliq * d.voldispsalengl AS ngl_sales_wi,
                   d.wihcliq * d.voldispsalecond AS cond_sales_wi,
                   d.wihcliq * d.volnewprodallocoil AS oil_alloc_nri,
                   d.wihcliq * d.voldispsalengl AS ngl_sales_nri,
                   NULL AS ngl_inv_gross,
                   NULL AS ngl_inv_wi,
                   d.volnewprodallocwater AS water_alloc_gross,
                   d.wiwater * d.volnewprodallocwater AS water_alloc_wi,
                   d.volprodgathwater AS water_raw_gross,
                   ifnull(d.volnewprodallochcliq, 0) + ifnull(d.voldispsalegas, 0) / 1000 * CASE WHEN s.tempbase IS NULL THEN 1
                        ELSE 37.25 / 35.49373
                         END * 35.49373 / 6 * 0.158910004497153 AS boe_alloc_gross,
                   ifnull(d.volnewprodallochcliq * d.wihcliq, 0) + ifnull(d.voldispsalegas * d.wigas, 0) / 1000 * CASE WHEN s.tempbase IS NULL THEN 1
                        ELSE 37.25 / 35.49373
                         END * 35.49373 / 6 * 0.158910004497153 AS boe_alloc_wi,
                   ifnull(d.voldispsalehcliq, 0) + ifnull(d.voldispsalegas, 0) / 1000 * CASE WHEN s.tempbase IS NULL THEN 1
                        ELSE 37.25 / 35.49373
                         END * 35.49373 / 6 * 0.158910004497153 AS boe_sales_gross,
                   ifnull(d.voldispsalehcliq * d.wihcliq, 0) + ifnull(d.voldispsalegas * d.wigas, 0) / 1000 * CASE WHEN s.tempbase IS NULL THEN 1
                        ELSE 37.25 / 35.49373
                         END * 35.49373 / 6 * 0.158910004497153 AS boe_sales_wi,
                   ifnull(d.volnewprodallocoil, 0) + ifnull(d.volnewprodallocgas, 0) / 1000 * CASE WHEN s.tempbase IS NULL THEN 1
                        ELSE 37.25 / 35.31778
                         END * 35.31778 / 6 * 0.158910004497153 AS boe_sales_gross_us,
                   ifnull(d.volnewprodallocoil * d.wihcliq, 0) + ifnull(d.voldispsalengl * d.wihcliq, 0) + ifnull(d.voldispsalegas * d.wigas, 0) / 1000 * CASE WHEN s.tempbase IS NULL THEN 1
                        ELSE 37.25 / 35.31778
                         END * 35.31778 / 6 * 0.158910004497153 AS boe_sales_nri_us,
                   WS_EDW.PVIEW_SYSSECURITYTYP_VET_BU_ROLE(h.SYSSECURITYTYP) AS BU_SF_ROLE
              FROM DS_PRODVIEW.PVT_pvunitallocmonthday d
              LEFT JOIN DS_PRODVIEW.PVT_pvcalcset s
                ON s.idrec = d.idreccalcset
               AND s.tempbase != 15
             INNER JOIN DS_PRODVIEW.PVT_pvunitallocmonth m
                ON d.idrecparent = m.idrec
             INNER JOIN DS_PRODVIEW.PVT_pvunit u
                ON m.idrecparent = u.idrec
             INNER JOIN DS_PRODVIEW.PVT_pvunitcomp c
                ON u.idrec = c.idrecparent
             INNER JOIN DS_PRODVIEW.PVT_pvflownetheader h
                ON h.idflownet = d.idflownet
        dependencies:
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY') }}
        name: VIEW_PVIEW_VRL_DAILY_ALLOC_PROD2_VW
        noLinkRefs: []
  name: VIEW_PVIEW_VRL_DAILY_ALLOC_PROD2_VW
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
