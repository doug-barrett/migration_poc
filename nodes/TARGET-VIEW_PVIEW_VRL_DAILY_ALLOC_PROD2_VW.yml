fileVersion: 1
id: dd5b2c9a-bac8-417f-974f-af6503166235
name: VIEW_PVIEW_VRL_DAILY_ALLOC_PROD2_VW
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: "-- This view gets the site production for the wells.  It is used -- in the loader and many reports. -- units : liquids assume m3 in database --        gas - use calc settings of flow network basetemp  --        if 15 deg C then e3m3, if 0 deg C them e3"
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c92c06ca-bc64-466b-afc3-f7a1bbc4188d
          stepCounter: dd5b2c9a-bac8-417f-974f-af6503166235
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: IDFLOWNET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e63ff1c0-dd08-4f41-8d3f-2e5a1b550560
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4303706f-b998-457a-b46b-581e625260d3
          stepCounter: dd5b2c9a-bac8-417f-974f-af6503166235
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: TEMPBASE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 58066566-142a-47c4-b649-a8300dbbddca
                stepCounter: dd3550ac-fec2-457c-9c86-92e386a013c4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc678d03-eb74-4c19-8424-4dc1c4fdb32f
          stepCounter: dd5b2c9a-bac8-417f-974f-af6503166235
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 295d169a-8764-40e9-9347-7e6746bb1d69
                stepCounter: 81e6b0b1-1728-45bf-932d-6356544cf13a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a66a41d-2165-4e11-838e-6314dab218af
          stepCounter: dd5b2c9a-bac8-417f-974f-af6503166235
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: IDRECCOMPORIGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3509df89-57fe-4ce1-8638-e0de9c981421
                stepCounter: 04319371-5f30-47a8-b02a-17e2a1f1b18c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 926fdd6a-30d3-4841-8585-5f64fadec664
          stepCounter: dd5b2c9a-bac8-417f-974f-af6503166235
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: IDRECUNITORIGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6b6e1d74-6828-42ae-b9d7-69ba4615f389
                stepCounter: e5728334-2b6e-40fb-ae5e-e78da1de0994
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0a9376e-1868-42b9-aa63-d2c9729abbdc
          stepCounter: dd5b2c9a-bac8-417f-974f-af6503166235
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: PROD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e23862e-5f1c-4ceb-9ed3-26e0c07e30fc
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2eaf6736-98b0-4f68-b6f8-d9fdf464ab08
          stepCounter: dd5b2c9a-bac8-417f-974f-af6503166235
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: OPHOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 81e344fc-8e1c-48b6-b2a3-4528e7962c25
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ff8083c-e711-456a-abbb-d02436d3d916
          stepCounter: dd5b2c9a-bac8-417f-974f-af6503166235
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: WI_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef135fd3-29ca-4192-ae3c-b84d4a82b57c
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc60e7b8-d7f0-464c-b3d5-8055cb964070
          stepCounter: dd5b2c9a-bac8-417f-974f-af6503166235
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: WI_OIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1025f801-aa3b-4996-9bb3-4e2358493c31
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4854d4bc-1589-4dbc-a6c8-fedc486ab3d0
          stepCounter: dd5b2c9a-bac8-417f-974f-af6503166235
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: WORKING_INTEREST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d4e93b9-21b8-4347-9732-112be6aa903e
          stepCounter: dd5b2c9a-bac8-417f-974f-af6503166235
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: GAS_RAW_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2e05ffb-b5d1-4c18-804d-c3cc08120f71
          stepCounter: dd5b2c9a-bac8-417f-974f-af6503166235
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: GAS_SALES_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c050f1ec-f467-4364-afb6-9d1127ecb1ed
          stepCounter: dd5b2c9a-bac8-417f-974f-af6503166235
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: GAS_SALES_WI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4aad298a-54d7-4012-9ac6-d6d4f20e4c3a
          stepCounter: dd5b2c9a-bac8-417f-974f-af6503166235
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: GAS_GROSS_US
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7feaa0f-f719-41c0-aa58-bd7da50047ef
          stepCounter: dd5b2c9a-bac8-417f-974f-af6503166235
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: GAS_SALES_NRI_US
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 829f8767-a8e4-4a19-b8dd-2a756c8a7f41
          stepCounter: dd5b2c9a-bac8-417f-974f-af6503166235
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: OIL_RAW_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dbfbfa76-fb71-41ce-88eb-43faeca70bbb
          stepCounter: dd5b2c9a-bac8-417f-974f-af6503166235
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: OIL_ALLOC_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4fe61546-bbad-4c89-8981-efb8fd6dacaa
          stepCounter: dd5b2c9a-bac8-417f-974f-af6503166235
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: OIL_ALLOC_WI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c541e55-f9ed-4863-88bb-89cad6f850e7
          stepCounter: dd5b2c9a-bac8-417f-974f-af6503166235
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: OIL_SALES_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1fb75f8-02eb-4c7d-8c70-434ab5321ad9
          stepCounter: dd5b2c9a-bac8-417f-974f-af6503166235
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: OIL_SALES_WI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6130817a-3b7c-4389-ac03-fadae7f480ac
          stepCounter: dd5b2c9a-bac8-417f-974f-af6503166235
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: OIL_INV_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 113e3405-1837-4ba0-9965-50b3a194af80
          stepCounter: dd5b2c9a-bac8-417f-974f-af6503166235
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: OIL_INV_WI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2097db74-8b02-4593-841a-b5abf94ff8c9
          stepCounter: dd5b2c9a-bac8-417f-974f-af6503166235
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: NGL_ALLOC_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 974110f7-90dc-4af6-b3e3-6f3fade2291a
          stepCounter: dd5b2c9a-bac8-417f-974f-af6503166235
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: COND_ALLOC_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ffabfe75-0698-47ac-9dc1-02e0ff7abda5
          stepCounter: dd5b2c9a-bac8-417f-974f-af6503166235
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: NGL_ALLOC_WI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b839398-619d-465d-b094-e6ebb5ddee5c
          stepCounter: dd5b2c9a-bac8-417f-974f-af6503166235
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: COND_ALLOC_WI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8396407d-d087-4d21-8224-8b74c81cf4e8
          stepCounter: dd5b2c9a-bac8-417f-974f-af6503166235
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: NGL_SALES_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5cf8b55-680a-481a-9779-a09400c78223
          stepCounter: dd5b2c9a-bac8-417f-974f-af6503166235
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: NGL_SALES_WI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 086099ce-29b0-4a9c-8654-3625881a27b8
          stepCounter: dd5b2c9a-bac8-417f-974f-af6503166235
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: COND_SALES_WI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b54a7524-a742-4132-9614-0f34f8be8cf2
          stepCounter: dd5b2c9a-bac8-417f-974f-af6503166235
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: OIL_ALLOC_NRI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e485601-4f14-4ae4-85a0-a88491d0201f
          stepCounter: dd5b2c9a-bac8-417f-974f-af6503166235
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: NGL_SALES_NRI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c4ee921-4a2c-4216-a22f-3a1577c76d00
          stepCounter: dd5b2c9a-bac8-417f-974f-af6503166235
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: NGL_INV_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1427a30-ce15-42ba-a581-910518ed39a6
          stepCounter: dd5b2c9a-bac8-417f-974f-af6503166235
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: NGL_INV_WI
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: afdbcb51-c125-4b64-8851-a3841a542bc9
          stepCounter: dd5b2c9a-bac8-417f-974f-af6503166235
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: WATER_ALLOC_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aeec546d-84a1-42ac-8bd8-fa38b1047a14
          stepCounter: dd5b2c9a-bac8-417f-974f-af6503166235
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: WATER_ALLOC_WI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c0c26cd-a576-4c0e-b7ee-633148cbfd40
          stepCounter: dd5b2c9a-bac8-417f-974f-af6503166235
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: WATER_RAW_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8fb1fdb5-45ef-4397-99c5-65c88a1e131a
          stepCounter: dd5b2c9a-bac8-417f-974f-af6503166235
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: BOE_ALLOC_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9f6fb7f-364c-483e-91b3-54ab43ceefaf
          stepCounter: dd5b2c9a-bac8-417f-974f-af6503166235
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: BOE_ALLOC_WI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42be2818-87dd-4233-9159-03996d71c4c2
          stepCounter: dd5b2c9a-bac8-417f-974f-af6503166235
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: BOE_SALES_GROSS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4197dff8-48f1-43d9-8b6d-cb386bec2a26
          stepCounter: dd5b2c9a-bac8-417f-974f-af6503166235
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: BOE_SALES_WI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c67c239c-0817-40c3-b870-6118c0669283
          stepCounter: dd5b2c9a-bac8-417f-974f-af6503166235
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: BOE_SALES_GROSS_US
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9d330d5-e549-4c34-9b30-ead4c91f4271
          stepCounter: dd5b2c9a-bac8-417f-974f-af6503166235
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: BOE_SALES_NRI_US
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1bddbbb6-2201-49b8-b9bb-7bdf12ba073a
          stepCounter: dd5b2c9a-bac8-417f-974f-af6503166235
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: BU_SF_ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2461b3f-8900-4460-9da7-dc1b4d0593bc
                stepCounter: a23239e4-617a-4ab9-a42c-1fd9220b7fb3
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_PVIEW_VRL_DAILY_ALLOC_PROD2_VW: dd5b2c9a-bac8-417f-974f-af6503166235
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_PVIEW_VRL_DAILY_ALLOC_PROD2_VW') }} AS SELECT d.idflownet,
                   s.tempbase,
                   c.wellidregulatory AS uwi,
                   c.idrec AS idreccomporigin,
                   u.idrec AS idrecunitorigin,
                   d.dttm AS prod_date,
                   d.durop * 24 AS ophours,
                   d.wigas AS wi_gas,
                   d.wihcliq AS wi_oil,
                   CASE WHEN IfNULL(d.wigas, 0) = 0 THEN IfNULL(d.wihcliq, 0)
                        ELSE IfNULL(d.wigas, 0)
                         END AS working_interest,
                   d.volprodgathgas / 1000 * CASE WHEN s.tempbase IS NULL THEN 1
                        ELSE 37.25 / 35.49373
                         END AS gas_raw_gross,
                   d.voldispsalegas / 1000 * CASE WHEN s.tempbase IS NULL THEN 1
                        ELSE 37.25 / 35.49373
                         END AS gas_sales_gross,
                   d.wigas * d.voldispsalegas / 1000 * CASE WHEN s.tempbase IS NULL THEN 1
                        ELSE 37.25 / 35.49373
                         END AS gas_sales_wi,
                   d.volnewprodallocgas / 1000 * CASE WHEN s.tempbase IS NULL THEN 1
                        ELSE 37.25 / 35.49373
                         END AS gas_gross_us,
                   d.wigas * d.voldispsalegas / 1000 * CASE WHEN s.tempbase IS NULL THEN 1
                        ELSE 37.25 / 35.49373
                         END AS gas_sales_nri_us,
                   d.volprodgathhcliq AS oil_raw_gross,
                   d.volnewprodallocoil AS oil_alloc_gross,
                   d.wihcliq * d.volnewprodallocoil AS oil_alloc_wi,
                   d.voldispsaleoil - ifnull(d.volrecovhcliq, 0) AS oil_sales_gross,
                   d.wihcliq * (d.voldispsaleoil - ifnull(d.volrecovhcliq, 0)) AS oil_sales_wi,
                   d.volchginvhcliq AS oil_inv_gross,
                   d.wihcliq * d.volchginvhcliq AS oil_inv_wi,
                   d.volnewprodallocngl AS ngl_alloc_gross,
                   d.volnewprodalloccond AS cond_alloc_gross,
                   d.wihcliq * d.volnewprodallocngl AS ngl_alloc_wi,
                   d.wihcliq * d.volnewprodalloccond AS cond_alloc_wi,
                   d.voldispsalengl + d.voldispsalecond AS ngl_sales_gross,
                   d.wihcliq * d.voldispsalengl AS ngl_sales_wi,
                   d.wihcliq * d.voldispsalecond AS cond_sales_wi,
                   d.wihcliq * d.volnewprodallocoil AS oil_alloc_nri,
                   d.wihcliq * d.voldispsalengl AS ngl_sales_nri,
                   NULL AS ngl_inv_gross,
                   NULL AS ngl_inv_wi,
                   d.volnewprodallocwater AS water_alloc_gross,
                   d.wiwater * d.volnewprodallocwater AS water_alloc_wi,
                   d.volprodgathwater AS water_raw_gross,
                   ifnull(d.volnewprodallochcliq, 0) + ifnull(d.voldispsalegas, 0) / 1000 * CASE WHEN s.tempbase IS NULL THEN 1
                        ELSE 37.25 / 35.49373
                         END * 35.49373 / 6 * 0.158910004497153 AS boe_alloc_gross,
                   ifnull(d.volnewprodallochcliq * d.wihcliq, 0) + ifnull(d.voldispsalegas * d.wigas, 0) / 1000 * CASE WHEN s.tempbase IS NULL THEN 1
                        ELSE 37.25 / 35.49373
                         END * 35.49373 / 6 * 0.158910004497153 AS boe_alloc_wi,
                   ifnull(d.voldispsalehcliq, 0) + ifnull(d.voldispsalegas, 0) / 1000 * CASE WHEN s.tempbase IS NULL THEN 1
                        ELSE 37.25 / 35.49373
                         END * 35.49373 / 6 * 0.158910004497153 AS boe_sales_gross,
                   ifnull(d.voldispsalehcliq * d.wihcliq, 0) + ifnull(d.voldispsalegas * d.wigas, 0) / 1000 * CASE WHEN s.tempbase IS NULL THEN 1
                        ELSE 37.25 / 35.49373
                         END * 35.49373 / 6 * 0.158910004497153 AS boe_sales_wi,
                   ifnull(d.volnewprodallocoil, 0) + ifnull(d.volnewprodallocgas, 0) / 1000 * CASE WHEN s.tempbase IS NULL THEN 1
                        ELSE 37.25 / 35.31778
                         END * 35.31778 / 6 * 0.158910004497153 AS boe_sales_gross_us,
                   ifnull(d.volnewprodallocoil * d.wihcliq, 0) + ifnull(d.voldispsalengl * d.wihcliq, 0) + ifnull(d.voldispsalegas * d.wigas, 0) / 1000 * CASE WHEN s.tempbase IS NULL THEN 1
                        ELSE 37.25 / 35.31778
                         END * 35.31778 / 6 * 0.158910004497153 AS boe_sales_nri_us,
                   WS_EDW.PVIEW_SYSSECURITYTYP_VET_BU_ROLE(h.SYSSECURITYTYP) AS BU_SF_ROLE
              FROM DS_PRODVIEW.PVT_pvunitallocmonthday d
              LEFT JOIN DS_PRODVIEW.PVT_pvcalcset s
                ON s.idrec = d.idreccalcset
               AND s.tempbase != 15
             INNER JOIN DS_PRODVIEW.PVT_pvunitallocmonth m
                ON d.idrecparent = m.idrec
             INNER JOIN DS_PRODVIEW.PVT_pvunit u
                ON m.idrecparent = u.idrec
             INNER JOIN DS_PRODVIEW.PVT_pvunitcomp c
                ON u.idrec = c.idrecparent
             INNER JOIN DS_PRODVIEW.PVT_pvflownetheader h
                ON h.idflownet = d.idflownet
        dependencies:
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY') }}
        name: VIEW_PVIEW_VRL_DAILY_ALLOC_PROD2_VW
        noLinkRefs: []
  name: VIEW_PVIEW_VRL_DAILY_ALLOC_PROD2_VW
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
