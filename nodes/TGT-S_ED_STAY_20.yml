fileVersion: 1
id: dca41c40-3730-4c25-8145-448d9ba4f3e3
name: S_ED_STAY_20
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a530d86b-7133-472c-8824-74f36e136076
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Encounter unique identifier
        name: ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e08a28e-93fc-4605-85e2-0b787c491aed
                stepCounter: 19f97281-8cc4-4660-83be-6049689bc9c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 884d28b9-9c1d-4884-b97e-f0e00bcbcd39
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: Attendance ref no.
        name: AEATT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 32dc32a8-527a-4d9f-b8e6-ec44f2b05158
                stepCounter: 19f97281-8cc4-4660-83be-6049689bc9c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07f8095a-a5c6-428b-bda4-858cb6247b96
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: NUMERIC(10)
        defaultValue: ""
        description: PIMS ward stay ref no
        isBusinessKey: true
        name: AESTY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2722b90-f540-46bd-b666-4a3cb8529eb7
                stepCounter: 19f97281-8cc4-4660-83be-6049689bc9c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 795bfe50-fd95-4488-b93d-ba4f62ef63df
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Patient ref no.
        name: PATNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7113259e-4bae-4f9c-a4c1-8ed052dc0cad
                stepCounter: 19f97281-8cc4-4660-83be-6049689bc9c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 572c9362-d70b-4a1c-9629-feb2e8fe9806
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Profession carer ref no.
        name: PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c86d158e-2ebe-4059-ab38-6f80129f2ae7
                stepCounter: 19f97281-8cc4-4660-83be-6049689bc9c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26b6f1f6-c2d5-4c35-ba45-f761987cb9da
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: PIMS specialty ref no
        name: SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb1d8428-1260-4e99-8e19-b0d1a17a5dbe
                stepCounter: 19f97281-8cc4-4660-83be-6049689bc9c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 65d9c528-b885-40a9-876f-a7dc20098a43
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: PIMS service point ref no
        name: SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e87be8c-bd7a-45d5-96ab-c92e21e8899d
                stepCounter: 19f97281-8cc4-4660-83be-6049689bc9c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 687b4789-2688-4d4f-8d64-e9fc2a1f1c62
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Location stay start date and time
        name: START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c8ba470-105e-45fc-861c-30b32fc5bbf9
                stepCounter: 03b9dcc8-43a3-47b0-a031-c44629a076bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f0c72be-0645-4637-8dac-34d2f9269d14
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Location stay end date and time
        name: END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dee1f6dd-d790-4ae6-b294-c86c234fb483
                stepCounter: 03b9dcc8-43a3-47b0-a031-c44629a076bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea81c8cc-9ef5-4bdf-b42f-56c685cf2bbf
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Original start date for the encounter in PIMS
        name: ORIG_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 80781b01-0b6c-4ea2-9f31-653db2cbe745
                stepCounter: 19f97281-8cc4-4660-83be-6049689bc9c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3af847a2-cb99-4e56-bb2b-c739bb81d316
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Original end date for the encounter in PIMS
        name: ORIG_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7721f11-dc9c-496f-9636-7ce59845acbc
                stepCounter: 19f97281-8cc4-4660-83be-6049689bc9c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50804a4c-bec9-4303-90ef-a06594e7edc1
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time seen by professional carer
        name: SEEN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c2d6e64-4cc1-42f4-bbbd-5755d8d12751
                stepCounter: 19f97281-8cc4-4660-83be-6049689bc9c9
            transform: |-
              CASE WHEN s_ed_stay_10.seen_date BETWEEN s_ed_stay_18.start_date AND CASE WHEN s_ed_stay_18.row_num < s_ed_stay_18.row_count THEN CASE WHEN next.end_date > next.start_date AND next.start_date > s_ed_stay_10.start_date THEN next.start_date ELSE s_ed_stay_18.end_date END ELSE s_ed_stay_18.end_date END THEN s_ed_stay_10.seen_date
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 295b1855-b20f-41e0-8420-f8f9818f3a0f
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time patient transferred to a new specialty
        name: SPECT_XFER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 54dbb55c-20e5-41e3-abf2-20c15b7f49a4
                stepCounter: 19f97281-8cc4-4660-83be-6049689bc9c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6d84896-6cc0-4c47-a071-a6134741cc89
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time patient arrived
        name: ARRIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02eb4fe2-4949-45a6-86c1-4de3140e4edb
                stepCounter: 19f97281-8cc4-4660-83be-6049689bc9c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9870b4c5-cb77-426a-aa84-1c7470fc96e4
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time patient departed
        name: DEPARTED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51367620-44f1-4bf8-a7fc-6c0899ca03c5
                stepCounter: 19f97281-8cc4-4660-83be-6049689bc9c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6684a9f-1721-4492-b080-4eb60e885cd2
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Location of ward stay.
        name: LOCATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ca8d71f4-865e-45f6-9768-f9c48ae9e76f
                stepCounter: 19f97281-8cc4-4660-83be-6049689bc9c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0510d3c9-b443-4d9d-8b56-34dc2fe04aa7
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Service_Point_Reference_Number
        name: SERVICE_POINT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9f9723e6-279c-4c64-9171-33aa3b804e88
                stepCounter: 19f97281-8cc4-4660-83be-6049689bc9c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3bcda0c5-aef1-42eb-8f6b-0e5e46584ee2
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Clinician associated with the stay
        name: CLINICIAN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3925589-33a6-4b42-82d0-7f3098aab469
                stepCounter: 19f97281-8cc4-4660-83be-6049689bc9c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6745e5d-5099-4257-a9d2-56c7d914f989
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Healthcare_Professional_Reference_Number
        name: HEALTHCARE_PROFESSIONAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d4b2ad75-4e84-459f-9b29-ccfa952f14a6
                stepCounter: 19f97281-8cc4-4660-83be-6049689bc9c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 93b9a39b-7091-48da-b824-696158196cca
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Stay specialty.
        name: SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 99b3ffe5-93d9-4d27-8c6e-2e1248abbee1
                stepCounter: 19f97281-8cc4-4660-83be-6049689bc9c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d37f6b6f-e607-4372-ae59-4c18636cc6bf
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Health Specialty Code
        name: HEALTH_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c7f873c-4f38-45bc-abe0-c8ba4d533963
                stepCounter: 19f97281-8cc4-4660-83be-6049689bc9c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b9f0df19-a1c6-4000-8bc7-e8698f83e51c
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: PIMS Speciality Reference Number
        name: SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf4e43a9-922c-4b70-9535-9f3884242732
                stepCounter: 19f97281-8cc4-4660-83be-6049689bc9c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e71c5b52-a84f-4120-b4e2-01259010f6c1
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Number of events for the encounter
        name: ROW_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6aa02f9b-4d1a-465d-9e60-d34435da3b62
                stepCounter: 19f97281-8cc4-4660-83be-6049689bc9c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d88dc94-35fc-4403-840c-061a0cd57ea6
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Event number for the encounter in chronological order
        name: ROW_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77e3d1e9-cff3-48a7-801c-b56f99ed982a
                stepCounter: 03b9dcc8-43a3-47b0-a031-c44629a076bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f825be9d-cbbd-454d-87f5-a13432979a92
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: 'Which sort sequence (1-7) used when calculating stay start/end dates for the encounter. '
        name: SORT_REF
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d70e06f9-29b9-4834-8f4d-09a2503bdc25
                stepCounter: 03b9dcc8-43a3-47b0-a031-c44629a076bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09b4901e-fd45-4645-9fca-3e2d2abdf854
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: NUMERIC(10)
        defaultValue: ""
        description: ""
        name: PREV_STAY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7470df70-ff29-4f8e-874b-2f7c7ee325ba
                stepCounter: 03b9dcc8-43a3-47b0-a031-c44629a076bb
            transform: prev.aesty_refno
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de40805b-0a24-474e-85c8-9289ccb0ae21
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PREV_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IIF(s_ed_stay_18.row_num > 1, COALESCE(prev.start_date, prev.arrived_date), NULL)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 070b9e1e-902a-40e4-befc-24ca99c519bd
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PREV_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IIF(s_ed_stay_18.row_num > 1, CASE WHEN prev.end_date > s_ed_stay_18.start_date THEN prev.end_date ELSE s_ed_stay_18.start_date END, NULL)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2799fbe-8310-4739-af2c-9363f9b9bb10
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PREV_SPECT_XFER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bd7a4de4-8724-42ab-a12f-d0e70a55fb39
                stepCounter: 03b9dcc8-43a3-47b0-a031-c44629a076bb
            transform: prev.spect_xfer_date
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 46d67b12-3817-47cc-aab2-6e35d2e49e19
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PREV_SERVICE_POINT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c738b8d4-48fa-4658-b833-61777fd28dfd
                stepCounter: 03b9dcc8-43a3-47b0-a031-c44629a076bb
            transform: prev.location
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af0c99ee-fb4c-459c-9c97-6d6a4c1e58d8
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PREV_SERVICE_POINT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ef5d0d2-9134-4084-a9cf-edfc35c3228e
                stepCounter: 03b9dcc8-43a3-47b0-a031-c44629a076bb
            transform: prev.spont_refno
      - appliedColumnTests: {}
        columnReference:
          columnCounter: abf8169c-7f86-4be3-882b-618464b00683
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PREV_HEALTHCARE_PROFESSIONAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eebfdf3f-b1b5-4ca2-ac0f-cde02a3e3d05
                stepCounter: 03b9dcc8-43a3-47b0-a031-c44629a076bb
            transform: prev.clinician
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2012bb24-c400-4dcb-86c4-b84aad7ddc71
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PREV_HEALTHCARE_PROFESSIONAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 288d5420-22cf-4051-8638-faf052309c60
                stepCounter: 03b9dcc8-43a3-47b0-a031-c44629a076bb
            transform: prev.proca_refno
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e405ea80-a9a4-4009-9167-47df8ba39e92
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PREV_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a577478e-ce33-4f96-999f-a5dc986d2ffb
                stepCounter: 03b9dcc8-43a3-47b0-a031-c44629a076bb
            transform: prev.specialty
      - appliedColumnTests: {}
        columnReference:
          columnCounter: efff9758-07ef-4261-9ac3-dfc8885717fd
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PREV_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aeb13464-5183-418f-acab-854e8778d3f6
                stepCounter: 03b9dcc8-43a3-47b0-a031-c44629a076bb
            transform: prev.spect_refno
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e7aaba7-5b17-441c-9fbb-e487693d2cd0
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: NEXT_STAY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7470df70-ff29-4f8e-874b-2f7c7ee325ba
                stepCounter: 03b9dcc8-43a3-47b0-a031-c44629a076bb
            transform: next.aesty_refno
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 250bd168-fa76-42da-bee0-432a59577751
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NEXT_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c8ba470-105e-45fc-861c-30b32fc5bbf9
                stepCounter: 03b9dcc8-43a3-47b0-a031-c44629a076bb
            transform: IIF(s_ed_stay_18.row_num < s_ed_stay_18.row_count, CASE WHEN next.start_date > s_ed_stay_18.end_date THEN next.start_date ELSE s_ed_stay_18.end_date END, NULL)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d1758951-4874-4257-9478-89686a41cb11
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NEXT_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dee1f6dd-d790-4ae6-b294-c86c234fb483
                stepCounter: 03b9dcc8-43a3-47b0-a031-c44629a076bb
            transform: IIF(s_ed_stay_18.row_num < s_ed_stay_18.row_count, CASE WHEN next.end_date > s_ed_stay_18.departed_date THEN s_ed_stay_18.departed_date ELSE next.end_date END, NULL)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 039fc753-9e46-410c-ac84-6f838524807c
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NEXT_SPECT_XFER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bd7a4de4-8724-42ab-a12f-d0e70a55fb39
                stepCounter: 03b9dcc8-43a3-47b0-a031-c44629a076bb
            transform: next.spect_xfer_date
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48e4ead6-8bfc-4ac1-9227-eec9ad61d60c
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NEXT_SERVICE_POINT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c738b8d4-48fa-4658-b833-61777fd28dfd
                stepCounter: 03b9dcc8-43a3-47b0-a031-c44629a076bb
            transform: next.location
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a88aa48b-c97a-46f6-a20c-eb5f9595e894
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: NEXT_SERVICE_POINT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ef5d0d2-9134-4084-a9cf-edfc35c3228e
                stepCounter: 03b9dcc8-43a3-47b0-a031-c44629a076bb
            transform: next.spont_refno
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5044df7d-213b-47b5-8536-91fa952908a9
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NEXT_HEALTHCARE_PROFESSIONAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eebfdf3f-b1b5-4ca2-ac0f-cde02a3e3d05
                stepCounter: 03b9dcc8-43a3-47b0-a031-c44629a076bb
            transform: next.clinician
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af63bf0c-d932-4f6c-9d06-ed519385ebe6
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: NEXT_HEALTHCARE_PROFESSIONAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 288d5420-22cf-4051-8638-faf052309c60
                stepCounter: 03b9dcc8-43a3-47b0-a031-c44629a076bb
            transform: next.proca_refno
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3a530e3-7fcb-4685-b6fb-32fed17f51fb
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NEXT_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a577478e-ce33-4f96-999f-a5dc986d2ffb
                stepCounter: 03b9dcc8-43a3-47b0-a031-c44629a076bb
            transform: next.specialty
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2e22e1f-f007-4b10-bbc3-a59759f54887
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: NEXT_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aeb13464-5183-418f-acab-854e8778d3f6
                stepCounter: 03b9dcc8-43a3-47b0-a031-c44629a076bb
            transform: next.spect_refno
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 13d5e0e7-2d45-42e9-b3ff-f3452c4b575f
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 756152d4-2c5e-4449-8d6e-cd6bbce136c9
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Rank of non EMMED Specialty stays by start date
        name: NON_EMMED_STAY_RANK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 617abcf0-040e-4cec-a782-ba882e225eed
                stepCounter: 19f97281-8cc4-4660-83be-6049689bc9c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d95aece3-9fb0-4310-afd6-54600993212e
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Rank of non ED stays by start date, based on Stop_Clock Locations
        name: STOP_CLOCK_STAY_RANK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ace819a9-0954-4eb6-a969-c8a6c3a41af6
                stepCounter: 19f97281-8cc4-4660-83be-6049689bc9c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 90fa7a0e-de2e-4546-be09-b4a716e1fc12
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Rank of non ED stays by start date,  based on Observation Locations
        name: OBSERVATION_STAY_RANK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8d09394e-8cb2-4192-93d6-86529e8b81c8
                stepCounter: 19f97281-8cc4-4660-83be-6049689bc9c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf09f09a-bbc8-413d-acff-db7ac1836e4b
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Rank of stays by start date,  based on ADU Locations
        name: ADU_STAY_RANK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 58afc2b9-d6fb-485c-8a82-e4b15b76d70e
                stepCounter: 19f97281-8cc4-4660-83be-6049689bc9c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0dd2dfd5-a78f-4396-96c1-d3678236ed43
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Ranks of ED stay in ED Locations by descending end date.
        name: LAST_STAY_RANK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db9e8b24-680f-4c49-8faa-751f2347c189
                stepCounter: 19f97281-8cc4-4660-83be-6049689bc9c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09bda93f-9376-402d-8fd8-5c1b386e089d
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Rank of non ED stays by start date,  based on Non-ED Locations
        name: NON_ED_STAY_RANK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ba26c3e5-75b3-40a9-8eb6-408a4f90f0ba
                stepCounter: 19f97281-8cc4-4660-83be-6049689bc9c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 090f3785-3fc1-446b-b4cc-b70e812ed5c9
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Rank of stays by start date,  based on Inappropriate Locations
        name: INAPPROPRIATE_LOCATION_STAY_RANK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22ca5773-0d1c-47bf-8653-ea8360008886
                stepCounter: 19f97281-8cc4-4660-83be-6049689bc9c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 065f13dd-2f95-4687-9efa-dc42098a53fb
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Ranks stays for an encounter by seen date.
        name: SEEN_DATE_RANK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a7d93f9-8d71-4ad7-bad6-42b1dc7e8a10
                stepCounter: 19f97281-8cc4-4660-83be-6049689bc9c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 68f44147-0d27-4e73-b013-3ae414a68415
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Acute_Diagnosis_Unit_Location_Flag
        name: ACUTE_DIAGNOSIS_UNIT_LOCATION_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 525d2952-2e2f-40aa-a1de-4d42c1439d19
                stepCounter: 19f97281-8cc4-4660-83be-6049689bc9c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b4c7579-a702-4d91-96ef-057475dea168
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Stop_Clock_Location_Flag
        name: STOP_CLOCK_LOCATION_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 10b0d178-6bf2-4027-ba8a-f3f8fe911c29
                stepCounter: 19f97281-8cc4-4660-83be-6049689bc9c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a1c33a3-b5a7-4ad4-9aae-2149e9e2bbf3
          stepCounter: dca41c40-3730-4c25-8145-448d9ba4f3e3
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Observation_Location_Flag
        name: OBSERVATION_LOCATION_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f592126-3739-4b76-bc79-103f53ad4ae0
                stepCounter: 19f97281-8cc4-4660-83be-6049689bc9c9
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_ED_STAY_10
        join:
          joinCondition: |-
            FROM s_ed_stay_18
              JOIN s_ed_stay_10
                ON s_ed_stay_10.encounter = s_ed_stay_18.encounter
               AND s_ed_stay_10.aesty_refno = s_ed_stay_18.aesty_refno
              LEFT OUTER JOIN s_ed_stay_18 prev
                ON prev.aeatt_refno = s_ed_stay_18.aeatt_refno
               AND prev.row_num = s_ed_stay_18.row_num - 1
              LEFT OUTER JOIN s_ed_stay_18 NEXT
                ON next.aeatt_refno = s_ed_stay_18.aeatt_refno
               AND next.row_num = s_ed_stay_18.row_num + 1
        name: S_ED_STAY_20
        noLinkRefs: []
  name: S_ED_STAY_20
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
