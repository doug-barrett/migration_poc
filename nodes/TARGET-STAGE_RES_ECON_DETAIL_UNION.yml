fileVersion: 1
id: 80797118-3bee-4fa0-9042-5d83901675d0
name: STAGE_RES_ECON_DETAIL_UNION
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: "Combine expanded variable records with base data, excluding yearly summary records that were expanded"
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82789d60-8a22-459b-8d69-47713faee33c
          stepCounter: 80797118-3bee-4fa0-9042-5d83901675d0
        config: {}
        dataType: NUMBER(18)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: RESULT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83b981ab-42e3-4fcb-bcc6-a39b6f554956
                stepCounter: 7c391c8b-b889-40d5-a3ef-6579e2698c85
            transform: TARGET.RESULT_ID
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86a5a922-6dfe-4192-bc9d-5c521a183ea7
          stepCounter: 80797118-3bee-4fa0-9042-5d83901675d0
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: Used as batch processing partition value (16 distinct values at creation time)
        name: RESERVE_CATEGORY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc795d28-68a5-44f3-988a-9df771b180b6
                stepCounter: 8fcead86-02ae-4feb-804e-edf6dbd09d6e
            transform: TARGET.RESERVE_CATEGORY_ID
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f38c6bea-48b1-4501-b4bd-59c917738b95
          stepCounter: 80797118-3bee-4fa0-9042-5d83901675d0
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2e92084-bbf6-4d4b-8ad9-312d792ece0d
                stepCounter: 7c391c8b-b889-40d5-a3ef-6579e2698c85
            transform: TARGET.YEAR
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8231daa-73d2-471b-815a-e08250a5888f
          stepCounter: 80797118-3bee-4fa0-9042-5d83901675d0
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7239703-6bb2-445c-ae61-5cf32ad99469
                stepCounter: 7c391c8b-b889-40d5-a3ef-6579e2698c85
            transform: TARGET.MONTH
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 748c149d-7efb-499d-a553-9473ef5db48a
          stepCounter: 80797118-3bee-4fa0-9042-5d83901675d0
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Last Day of Economics Details Month, Year
        name: ACCT_PER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e430258b-44cc-49cd-87ed-01cd194c0c08
                stepCounter: 7c391c8b-b889-40d5-a3ef-6579e2698c85
            transform: TARGET.ACCT_PER_DATE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94ac2e9b-844c-4e79-beb7-9fd18cc0f24f
          stepCounter: 80797118-3bee-4fa0-9042-5d83901675d0
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: Reserve Economics Variable Type Code
        name: VARIABLE_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bdcf572e-489f-4720-aab4-f90b99bc19fb
                stepCounter: 7c391c8b-b889-40d5-a3ef-6579e2698c85
            transform: TARGET.VARIABLE_TYPE_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cabc6ad7-1cc4-41df-8363-85f78c4563d5
          stepCounter: 80797118-3bee-4fa0-9042-5d83901675d0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_VARIABLE_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 43f17dfc-be43-42bb-bbcf-45eebcac8ba2
                stepCounter: 7c391c8b-b889-40d5-a3ef-6579e2698c85
            transform: TARGET.DIM_VARIABLE_TYPE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f7096ed-e763-4bba-b206-99e758e82326
          stepCounter: 80797118-3bee-4fa0-9042-5d83901675d0
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: YR_TO_MTH_FLG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3ef0785a-6f33-41da-af06-fe9d2ca5050c
                stepCounter: 7c391c8b-b889-40d5-a3ef-6579e2698c85
            transform: TARGET.YR_TO_MTH_FLG
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e8c5ba5-93dd-4c5a-9df0-b87280a9efd7
          stepCounter: 80797118-3bee-4fa0-9042-5d83901675d0
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Value UOM Code
        name: UOM_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a342422a-5234-40d8-aa20-d5e2286fb8b1
                stepCounter: 7c391c8b-b889-40d5-a3ef-6579e2698c85
            transform: TARGET.UOM_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04cd1182-7dc3-4a4c-9510-34b60f49477e
          stepCounter: 80797118-3bee-4fa0-9042-5d83901675d0
        config: {}
        dataType: DECIMAL(36,8)
        defaultValue: ""
        description: Variable numeric value
        name: VALUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c14f9d0-ffa9-4aff-9128-e6cd0b570f0f
                stepCounter: 7c391c8b-b889-40d5-a3ef-6579e2698c85
            transform: TARGET.VALUE
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_RES_ECON_DETAIL: 7c391c8b-b889-40d5-a3ef-6579e2698c85
          STAGE_RES_ECON_DETAIL_YR_TO_MTH: 8fcead86-02ae-4feb-804e-edf6dbd09d6e
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STAGE_RES_ECON_DETAIL
          - locationName: TARGET
            nodeName: STAGE_RES_ECON_DETAIL_YR_TO_MTH
        join:
          joinCondition: |-
            FROM (
                    SELECT RESULT_ID ,
                           RESERVE_CATEGORY_ID ,
                           YEAR ,

                     MONTH ,
                           ACCT_PER_DATE ,
                           VARIABLE_TYPE_CODE ,
                           DIM_VARIABLE_TYPE_KEY ,
                           YR_TO_MTH_FLG ,
                           UOM_CODE ,
                           VALUE
                      FROM {{ ref('TARGET','STAGE_RES_ECON_DETAIL') }}
                     WHERE (YR_TO_MTH_FLG <> 'Y' OR MONTH <> 0)
                       AND NVL(VALUE,0) <> 0
                 UNION ALL SELECT RESULT_ID ,
                           RESERVE_CATEGORY_ID ,
                           YEAR ,
                           NEW_MONTH AS
                     MONTH ,
                           NEW_ACCT_PER_DATE AS ACCT_PER_DATE ,
                           VARIABLE_TYPE_CODE ,
                           DIM_VARIABLE_TYPE_KEY ,
                           YR_TO_MTH_FLG ,
                           UOM_CODE ,
                           NEW_MONTH_VALUE AS VALUE
                      FROM {{ ref('TARGET','STAGE_RES_ECON_DETAIL_YR_TO_MTH') }}
                   ) AS TARGET
        name: STAGE_RES_ECON_DETAIL_UNION
        noLinkRefs: []
  name: STAGE_RES_ECON_DETAIL_UNION
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
