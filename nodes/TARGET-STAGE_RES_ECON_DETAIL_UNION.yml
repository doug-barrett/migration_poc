fileVersion: 1
id: f556dd90-3edd-455f-90a2-76e382b59ec2
name: STAGE_RES_ECON_DETAIL_UNION
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: "Combine expanded variable records with base data, excluding yearly summary records that were expanded"
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25fbf99f-c500-4f2e-a9aa-5709e18301d1
          stepCounter: f556dd90-3edd-455f-90a2-76e382b59ec2
        config: {}
        dataType: NUMBER(18)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: RESULT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d227eb0-08f6-4aeb-9b87-32b765b1931b
                stepCounter: 9f609960-c8cc-496b-81c5-104bce8270fd
            transform: TARGET.RESULT_ID
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba36f906-8cb0-4373-90b7-08810167305c
          stepCounter: f556dd90-3edd-455f-90a2-76e382b59ec2
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: Used as batch processing partition value (16 distinct values at creation time)
        name: RESERVE_CATEGORY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ae77a8a-6897-496c-9509-8e5052f75b67
                stepCounter: 2e3dbaab-1144-4d75-9ab9-2410bfa96bf3
            transform: TARGET.RESERVE_CATEGORY_ID
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de10f75d-b62f-4b1c-bc75-796bda572108
          stepCounter: f556dd90-3edd-455f-90a2-76e382b59ec2
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b39faf27-dc7c-4d69-aca1-d5089ce92663
                stepCounter: 9f609960-c8cc-496b-81c5-104bce8270fd
            transform: TARGET.YEAR
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6bd90c3-89aa-42da-a0ac-71a02590dd70
          stepCounter: f556dd90-3edd-455f-90a2-76e382b59ec2
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2d061d0-df31-4f16-8a15-eb9726134828
                stepCounter: 9f609960-c8cc-496b-81c5-104bce8270fd
            transform: TARGET.MONTH
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91fe4681-c5ff-40ef-a9d5-f3329db11335
          stepCounter: f556dd90-3edd-455f-90a2-76e382b59ec2
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Last Day of Economics Details Month, Year
        name: ACCT_PER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c8cae45b-f63d-4826-ba3b-9fc1451a576c
                stepCounter: 9f609960-c8cc-496b-81c5-104bce8270fd
            transform: TARGET.ACCT_PER_DATE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 117065ab-6a04-4717-8aaf-2a3f0bd36cb8
          stepCounter: f556dd90-3edd-455f-90a2-76e382b59ec2
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: Reserve Economics Variable Type Code
        name: VARIABLE_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60aba6e9-22b9-4e45-b593-cae87fd49281
                stepCounter: 9f609960-c8cc-496b-81c5-104bce8270fd
            transform: TARGET.VARIABLE_TYPE_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c6e51be-3d82-4f3d-9bed-0e0624e8ae13
          stepCounter: f556dd90-3edd-455f-90a2-76e382b59ec2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_VARIABLE_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 140d03d9-d4a1-45e7-ab9f-6dc5927aa5b1
                stepCounter: 9f609960-c8cc-496b-81c5-104bce8270fd
            transform: TARGET.DIM_VARIABLE_TYPE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ac01a42-f94b-4f94-bfe6-a58750ae05eb
          stepCounter: f556dd90-3edd-455f-90a2-76e382b59ec2
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: YR_TO_MTH_FLG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3cc11ba7-9a23-4001-84cb-32b301f1da12
                stepCounter: 9f609960-c8cc-496b-81c5-104bce8270fd
            transform: TARGET.YR_TO_MTH_FLG
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 590c478d-4f7a-4be0-9407-d565c3314726
          stepCounter: f556dd90-3edd-455f-90a2-76e382b59ec2
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Value UOM Code
        name: UOM_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b6e7ce0-375b-4f0a-bcf7-1580666c8195
                stepCounter: 9f609960-c8cc-496b-81c5-104bce8270fd
            transform: TARGET.UOM_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1092fa77-c5c1-4133-90fd-777d04d26e19
          stepCounter: f556dd90-3edd-455f-90a2-76e382b59ec2
        config: {}
        dataType: DECIMAL(36,8)
        defaultValue: ""
        description: Variable numeric value
        name: VALUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a244a36-edca-4c33-96c1-412fd5723ce9
                stepCounter: 9f609960-c8cc-496b-81c5-104bce8270fd
            transform: TARGET.VALUE
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_RES_ECON_DETAIL: 9f609960-c8cc-496b-81c5-104bce8270fd
          STAGE_RES_ECON_DETAIL_YR_TO_MTH: 2e3dbaab-1144-4d75-9ab9-2410bfa96bf3
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STAGE_RES_ECON_DETAIL
          - locationName: TARGET
            nodeName: STAGE_RES_ECON_DETAIL_YR_TO_MTH
        join:
          joinCondition: |-
            FROM (
                    SELECT RESULT_ID ,
                           RESERVE_CATEGORY_ID ,
                           YEAR ,

                     MONTH ,
                           ACCT_PER_DATE ,
                           VARIABLE_TYPE_CODE ,
                           DIM_VARIABLE_TYPE_KEY ,
                           YR_TO_MTH_FLG ,
                           UOM_CODE ,
                           VALUE
                      FROM {{ ref('TARGET','STAGE_RES_ECON_DETAIL') }}
                     WHERE (YR_TO_MTH_FLG <> 'Y' OR MONTH <> 0)
                       AND NVL(VALUE,0) <> 0
                 UNION ALL SELECT RESULT_ID ,
                           RESERVE_CATEGORY_ID ,
                           YEAR ,
                           NEW_MONTH AS
                     MONTH ,
                           NEW_ACCT_PER_DATE AS ACCT_PER_DATE ,
                           VARIABLE_TYPE_CODE ,
                           DIM_VARIABLE_TYPE_KEY ,
                           YR_TO_MTH_FLG ,
                           UOM_CODE ,
                           NEW_MONTH_VALUE AS VALUE
                      FROM {{ ref('TARGET','STAGE_RES_ECON_DETAIL_YR_TO_MTH') }}
                   ) AS TARGET
        name: STAGE_RES_ECON_DETAIL_UNION
        noLinkRefs: []
  name: STAGE_RES_ECON_DETAIL_UNION
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
