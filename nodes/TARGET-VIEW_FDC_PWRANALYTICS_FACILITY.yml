fileVersion: 1
id: a879c44f-67c9-4193-96ee-7d29d94b6b4d
name: VIEW_FDC_PWRANALYTICS_FACILITY
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a54db71-56be-4d2f-81a4-2d52243b2bee
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: VARCHAR(400)
        defaultValue: ""
        description: ""
        name: WELL_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b320e948-aeaa-4b61-821e-9ac894cfbbb6
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: VARCHAR(200)
        defaultValue: ""
        description: ""
        name: UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec6e94a1-cb56-4b43-ade6-0ec6e6929b4a
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c071d19-749a-475a-b15c-e944e46de5b6
                stepCounter: 9dfef1fa-b086-4d68-9049-2499c9f4c250
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57161a72-5201-437b-a724-a56b33367820
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: VARCHAR(1200)
        defaultValue: ""
        description: ""
        name: CC_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 44af4916-491f-424f-888d-eadb23238e28
                stepCounter: 9dfef1fa-b086-4d68-9049-2499c9f4c250
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 078f3ebf-9e73-43c7-9142-d541bc38da0a
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: ""
        name: COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4a76cd3-6e9e-4692-bcb3-781dd9615074
                stepCounter: 9dfef1fa-b086-4d68-9049-2499c9f4c250
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20277271-9849-4200-8e29-e435c6a26545
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: VARCHAR(720)
        defaultValue: ""
        description: ""
        name: PROVINCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e6eab54-c359-42ec-a999-e2041f0b073f
                stepCounter: 9dfef1fa-b086-4d68-9049-2499c9f4c250
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0cdc28b6-e4e2-4cd8-867b-699d69fc601c
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: VARCHAR(750)
        defaultValue: ""
        description: ""
        name: CORE_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c59b4345-2fdc-4bee-93c3-179c61bc7e6a
                stepCounter: 9dfef1fa-b086-4d68-9049-2499c9f4c250
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 118c3961-c720-4350-8c41-f17402ccbae5
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: VARCHAR(750)
        defaultValue: ""
        description: ""
        name: AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 40da0e99-788d-482a-a061-34350f9924a6
                stepCounter: 9dfef1fa-b086-4d68-9049-2499c9f4c250
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b9d48dd-fa8e-40e6-9b4c-2f4bb5346e09
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: FOREMAN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9bb42155-c64f-4913-8bb1-4c4c34857108
                stepCounter: 9dfef1fa-b086-4d68-9049-2499c9f4c250
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe10ecc4-da54-4c1d-9124-308ebcca6040
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: RUN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 95f0e306-82b9-4809-a333-45544e9556a1
                stepCounter: 9dfef1fa-b086-4d68-9049-2499c9f4c250
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 554435f6-c7c2-45a7-8d8b-aba5106ff1c4
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: FACILITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 56a20abd-815c-4a44-bc46-0588d54382d3
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: BATTERY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14cc7a01-1b50-4fc4-947d-a9845a6914d6
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: WELL_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'facility'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a225fe84-1626-496a-8c38-0f518f9b527b
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: SURFACE_LOCATION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6deb7fd9-5927-4fa1-bdbf-8142f5724b1a
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: OPERATING_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 045c5342-481d-4cb8-91b3-e5cf9807051c
                stepCounter: 8dc824aa-410a-4144-86c0-da2a4ed185b7
            transform: SUM(FACT_FDC_PRODUCTION_VOLUMES.HOURS_ON)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b236e196-7750-42ff-987a-e4bc7a348a70
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: DOWNTIME_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 54a29f2f-1c86-4b8e-bc38-2d33d75cc578
                stepCounter: 8dc824aa-410a-4144-86c0-da2a4ed185b7
            transform: SUM(FACT_FDC_PRODUCTION_VOLUMES.HOURS_DOWN)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 527fac6e-cb15-4752-be86-94bb0d602b2f
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: ON_PROD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cde1c9b3-bad3-499a-af3f-76f91d4db08b
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: LAST_PROD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e010ff08-908d-43b6-9dce-443110f76432
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The calendar year. Format YYYY
        name: PROD_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 13677831-ca52-4c79-8fdb-1a8ccc9c8ceb
                stepCounter: 3dfc30c2-dcfd-4034-80eb-3387f1ead5ae
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d348616a-8e7d-478d-869c-f3e138b91342
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: VARCHAR(7)
        defaultValue: ""
        description: 'The calendar month name. Format MON. Examples: jan, feb, mar.'
        name: PROD_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4e979bf-4302-471d-a714-e35d28581817
                stepCounter: 3dfc30c2-dcfd-4034-80eb-3387f1ead5ae
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 332880f1-268a-4eef-abb2-b34933b4b9ee
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: 'The calendar month representation. Format YYYYMM. Example: 200206.'
        name: PROD_YEARMONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b11ca3a3-ca71-4527-a0d1-5eadc11b0c97
                stepCounter: 3dfc30c2-dcfd-4034-80eb-3387f1ead5ae
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2163f999-982b-4f3a-8b66-53388a3a4388
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: WORKING_INTEREST
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9feb9090-6b4b-4221-b872-b4fb2ceb0799
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: PUMP_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5fff9940-c056-47c0-ae9a-df6e148fa8fb
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: METER_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e01cc04-2ec1-449f-9bec-1a2802149ffe
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: METER_NUMBER_2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6fd30e04-60fd-4982-a10a-2a4ab6428edb
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: METER_NUMBER_3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ebab4978-7e92-449f-ab7e-58c3a958a1b2
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: CHILD_ACCOUNT_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0438fcc9-b83b-47ff-8859-9efa9af65e2d
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: CHILD_ACCOUNT_NUMBER_2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dd3fc927-19c5-4c9b-980a-5c64c3bdbece
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: CHILD_ACCOUNT_NUMBER_3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce916d8e-ca19-4d32-9749-e1c016459b81
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: VARCHAR(1000)
        defaultValue: ""
        description: ""
        name: FIELD_COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa47e81b-d9c2-48e8-92b6-c601a2d24916
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: SURFACE_EQUIPMENT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7aba00a9-db12-42bf-8b6a-08b17b55e6fe
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: SURFACE_EQUIPMENT_MODEL
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cfc1be35-6425-466a-919d-9bafcf8838a8
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: SURFACE_EQUIPMENT_MAKE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5420d67f-8660-4e98-8dc0-ef574b2bad09
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: SURFACE_EQUIPMENT_HP
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 00d7736b-acfc-4b51-88e5-d51a529bbe7b
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: BOTTOMHOLE_LATITUDE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82a45107-8d42-477b-a187-9223e79ef23b
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: BOTTOMHOLE_LONGITUDE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0cec3f4-de7b-442c-8825-64d7a5823c10
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SURFACE_LATITUDE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f20f99ee-869b-4cc5-8426-0fad4818552f
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SURFACE_LONGITUDE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c87e0d3-d764-439a-93f3-bcbc0307dba8
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: WATER_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 99792e93-55bf-4598-a3da-6e610daef595
                stepCounter: 8dc824aa-410a-4144-86c0-da2a4ed185b7
            transform: SUM(NVL(FACT_FDC_PRODUCTION_VOLUMES.WATER_METRIC, 0))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aca82aa7-3d5b-4857-b906-843044b0300a
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: OIL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ce1e1d4-e47d-42e5-943a-e2ecba1618f4
                stepCounter: 8dc824aa-410a-4144-86c0-da2a4ed185b7
            transform: SUM(NVL(FACT_FDC_PRODUCTION_VOLUMES.OIL_METRIC, 0))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50359950-45b4-4469-95ea-a0b17db17df8
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: GAS_E3M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 754f66ec-ab9a-4387-9b66-b24ad09d642e
                stepCounter: 8dc824aa-410a-4144-86c0-da2a4ed185b7
            transform: SUM(NVL(FACT_FDC_PRODUCTION_VOLUMES.GAS_METRIC, 0))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 270a2367-5f05-4d67-af8e-1b2e5044c532
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: OIL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e78eca67-9a2e-4423-bd44-5b28332efcbf
                stepCounter: 8dc824aa-410a-4144-86c0-da2a4ed185b7
            transform: SUM(NVL(FACT_FDC_PRODUCTION_VOLUMES.OIL_BOE, 0))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f4143440-8b87-4e56-9232-bf60eb2cca7a
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: GAS_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a4dea1f-9205-4396-809b-c209c8f362d1
                stepCounter: 8dc824aa-410a-4144-86c0-da2a4ed185b7
            transform: SUM(NVL(FACT_FDC_PRODUCTION_VOLUMES.GAS_BOE, 0))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9c1bb2f-8f7a-4e2d-abdc-ed0145e00cb4
          stepCounter: a879c44f-67c9-4193-96ee-7d29d94b6b4d
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a4dea1f-9205-4396-809b-c209c8f362d1
                stepCounter: 8dc824aa-410a-4144-86c0-da2a4ed185b7
            transform: SUM(NVL(FACT_FDC_PRODUCTION_VOLUMES.GAS_BOE, 0)+NVL(FACT_FDC_PRODUCTION_VOLUMES.OIL_BOE, 0)+NVL(FACT_FDC_PRODUCTION_VOLUMES.CONDENSATE_BOE, 0)+NVL(FACT_FDC_PRODUCTION_VOLUMES.NGL_BOE, 0))
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ODS_PVIEW_PVT_PVUNIT: e5728334-2b6e-40fb-ae5e-e78da1de0994
          FACT_FDC_PRODUCTION_VOLUMES: 8dc824aa-410a-4144-86c0-da2a4ed185b7
          ODS_PVIEW_PVT_PVUNITOTHERTAG: e5196c3d-153f-4d31-9741-0f7e059cc802
          DIM_FDC_ACTIVITY_PERIOD_DATE: 3dfc30c2-dcfd-4034-80eb-3387f1ead5ae
          DIM_LO_SAP_COST_CENTER_HIER: 9dfef1fa-b086-4d68-9049-2499c9f4c250
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: FU
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNIT
          - locationName: TARGET
            nodeName: FACT_FDC_PRODUCTION_VOLUMES
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITOTHERTAG
          - locationName: TARGET
            nodeName: DIM_FDC_ACTIVITY_PERIOD_DATE
          - locationName: TARGET
            nodeName: DIM_LO_SAP_COST_CENTER_HIER
        join:
          joinCondition: |-
            FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVUNIT') }} ODS_PVIEW_PVT_PVUNIT
              JOIN {{ ref('TARGET','FACT_FDC_PRODUCTION_VOLUMES') }} FACT_FDC_PRODUCTION_VOLUMES
                ON ODS_PVIEW_PVT_PVUNIT.IDREC = FACT_FDC_PRODUCTION_VOLUMES.DIM_WELL_KEY
              JOIN (
                    SELECT IDRECFACILITYCALC ,
                           USERNUM2 AS CHILD_ACCOUNT ,
                           CHILD_ACCOUNT_2 ,
                           CHILD_ACCOUNT_3 ,
                           USERNUM3 AS METER_NUMBER ,
                           METER_NUMBER_2 ,
                           METER_NUMBER_3 ,
                           NAME ,
                           COSTCENTERIDA AS CC_NUM
                      FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVUNIT') }} ODS_PVIEW_PVT_PVUNIT
                      LEFT JOIN (
                            SELECT IDFLOWNET,
                                   IDRECPARENT,
                                   MAX("'Child Account 2'") AS CHILD_ACCOUNT_2,
                                   MAX("'Child Account 3'") AS CHILD_ACCOUNT_3,
                                   MAX("'Meter Number 2'") AS METER_NUMBER_2,
                                   MAX("'Meter Number 3'") AS METER_NUMBER_3
                              FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITOTHERTAG') }} PIVOT(MAX(VALUE) FOR TYP1 IN ('Child Account 2', 'Child Account 3', 'Meter Number 2', 'Meter Number 3'))
                             WHERE DSS_CURRENT_FLAG = 'Y'
                               AND DSS_DELETE_FLAG != 'Y'
                             GROUP BY IDFLOWNET,
                                      IDRECPARENT
                           ) TAGS
                        ON ODS_PVIEW_PVT_PVUNIT.IDREC = TAGS.IDRECPARENT
                     WHERE ODS_PVIEW_PVT_PVUNIT.DSS_CURRENT_FLAG = 'Y'
                       AND ODS_PVIEW_PVT_PVUNIT.DSS_DELETE_FLAG != 'Y'
                       AND ODS_PVIEW_PVT_PVUNIT.TYP1 = 'facility'
                       AND ODS_PVIEW_PVT_PVUNIT.USERNUM2 IS NOT NULL
                       AND ODS_PVIEW_PVT_PVUNIT.USERNUM3 IS NOT NULL
                   ) FU
                ON ODS_PVIEW_PVT_PVUNIT.IDRECFACILITYCALC = FU.IDRECFACILITYCALC
              JOIN {{ ref('TARGET','DIM_FDC_ACTIVITY_PERIOD_DATE') }} DIM_FDC_ACTIVITY_PERIOD_DATE
                ON FACT_FDC_PRODUCTION_VOLUMES.DIM_ACTIVITY_PERIOD_DATE_KEY = DIM_FDC_ACTIVITY_PERIOD_DATE.DIM_ACTIVITY_PERIOD_DATE_KEY
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_COST_CENTER_HIER') }} DIM_LO_SAP_COST_CENTER_HIER
                ON FU.CC_NUM = DIM_LO_SAP_COST_CENTER_HIER.CC_NUM
             WHERE ODS_PVIEW_PVT_PVUNIT.DSS_CURRENT_FLAG = 'Y'
               AND ODS_PVIEW_PVT_PVUNIT.DSS_DELETE_FLAG != 'Y'
               AND FACT_FDC_PRODUCTION_VOLUMES.DIM_SCENARIO_KEY = 'pv_sales_alloc_blend'
               AND FACT_FDC_PRODUCTION_VOLUMES.DIM_GROSS_NET_KEY = '1'
               AND FU.NAME IS NOT NULL
             GROUP BY FU.NAME ,
                      FU.CHILD_ACCOUNT ,
                      FU.CHILD_ACCOUNT_2 ,
                      FU.CHILD_ACCOUNT_3 ,
                      FU.METER_NUMBER ,
                      FU.METER_NUMBER_2 ,
                      FU.METER_NUMBER_3 ,
                      DIM_LO_SAP_COST_CENTER_HIER.CC_NUM ,
                      DIM_LO_SAP_COST_CENTER_HIER.CC_NAME ,
                      DIM_LO_SAP_COST_CENTER_HIER.COUNTRY_NAME ,
                      DIM_LO_SAP_COST_CENTER_HIER.PROV_NAME ,
                      DIM_LO_SAP_COST_CENTER_HIER.COREAREA_NAME ,
                      DIM_LO_SAP_COST_CENTER_HIER.AREA_NAME ,
                      DIM_LO_SAP_COST_CENTER_HIER.MANUAL_FOREMAN ,
                      DIM_LO_SAP_COST_CENTER_HIER.RUN ,
                      DIM_FDC_ACTIVITY_PERIOD_DATE.ACTIVITY_YEAR_NUMBER ,
                      DIM_FDC_ACTIVITY_PERIOD_DATE.ACTIVITY_MONTH_NAME_SHORT ,
                      DIM_FDC_ACTIVITY_PERIOD_DATE.MONTH_SORT
        name: VIEW_FDC_PWRANALYTICS_FACILITY
        noLinkRefs: []
  name: VIEW_FDC_PWRANALYTICS_FACILITY
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
