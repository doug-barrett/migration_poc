fileVersion: 1
id: cc834dad-7016-407b-8031-5c1229790bcf
name: VIEW_FDC_PWRANALYTICS_FACILITY
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aeab8b27-4ab7-4911-a463-5a241cc652b6
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: VARCHAR(400)
        defaultValue: ""
        description: ""
        name: WELL_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d17d5b2a-20a6-452c-9aa9-f63fa5829cfe
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: VARCHAR(200)
        defaultValue: ""
        description: ""
        name: UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f33195d-18ee-4266-b424-a7318f6b1b42
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 937ab178-f703-463d-98a9-cef60d884893
                stepCounter: f5d6146b-7042-4b8a-b29d-05b61de7beb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24640dbb-1218-4cfe-9f77-d90f9f1a3203
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: VARCHAR(1200)
        defaultValue: ""
        description: ""
        name: CC_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09586ad6-0d99-4a90-8628-35fcdab73819
                stepCounter: f5d6146b-7042-4b8a-b29d-05b61de7beb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 892afbd1-4849-48e3-9a03-3357b8af4b9c
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: ""
        name: COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3c7892bc-fa14-4f5d-919e-b85950af2035
                stepCounter: f5d6146b-7042-4b8a-b29d-05b61de7beb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae2a58f0-500c-498a-a268-b45879eac03c
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: VARCHAR(720)
        defaultValue: ""
        description: ""
        name: PROVINCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4add7d48-d187-402d-8141-2ffc7dc340d7
                stepCounter: f5d6146b-7042-4b8a-b29d-05b61de7beb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af0e5ac1-cacb-4b7c-8180-c00c65cb1e93
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: VARCHAR(750)
        defaultValue: ""
        description: ""
        name: CORE_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00e96ad4-791c-4356-8040-2cf1964ebf2f
                stepCounter: f5d6146b-7042-4b8a-b29d-05b61de7beb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 630a414e-8916-457e-bf3b-6f97e0253bc2
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: VARCHAR(750)
        defaultValue: ""
        description: ""
        name: AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d0e5ef3f-c12c-45b2-a249-c410978a8ae3
                stepCounter: f5d6146b-7042-4b8a-b29d-05b61de7beb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f6b16fd-1206-4372-aacf-043fa8d12d97
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: FOREMAN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3626fc79-610d-4a17-aa39-53319b29f05c
                stepCounter: f5d6146b-7042-4b8a-b29d-05b61de7beb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7e4f494-e3ac-4f34-83c5-b59b4b11eb2f
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: RUN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 65a4f112-3f02-47bc-9a65-a848ffe91170
                stepCounter: f5d6146b-7042-4b8a-b29d-05b61de7beb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09995675-5d2f-4718-8cc6-f7451b03fa79
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: FACILITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a975563e-88de-4345-93df-c288442c876b
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: BATTERY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d9a94b2-9849-4b36-aed4-26de64e1e83b
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: WELL_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'facility'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 502b89aa-ec91-4783-b721-2e3a9011ae0f
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: SURFACE_LOCATION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6db4ab3-b53f-4d9d-b64c-c491b3d5d22b
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: OPERATING_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 14cbbe3f-6570-498b-af1a-913a83424aa6
                stepCounter: e22526cf-e4aa-4e4e-9099-3efa13af5b57
            transform: SUM(FACT_FDC_PRODUCTION_VOLUMES.HOURS_ON)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b665699-23e6-4513-b061-5aa9a9ea7707
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: DOWNTIME_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 361846f4-3342-4ef1-ae59-8e2574735df6
                stepCounter: e22526cf-e4aa-4e4e-9099-3efa13af5b57
            transform: SUM(FACT_FDC_PRODUCTION_VOLUMES.HOURS_DOWN)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77b54999-f22d-4747-9762-967ada3303a3
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: ON_PROD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b2b9b605-bb1a-4887-b440-3db4eb6ba02e
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: LAST_PROD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb8a1b1e-325c-4fbe-8163-b686d7ba48ce
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The calendar year. Format YYYY
        name: PROD_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 49b5e3cf-0dd9-4a41-9bc0-5ed07a47f52f
                stepCounter: 84709ea2-16bb-4d76-88e2-6998452e501b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba3fbe5c-f8ad-439a-8c3a-f192502aa84d
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: VARCHAR(7)
        defaultValue: ""
        description: 'The calendar month name. Format MON. Examples: jan, feb, mar.'
        name: PROD_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 12c04868-62d6-459e-933c-12b78b29123d
                stepCounter: 84709ea2-16bb-4d76-88e2-6998452e501b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a0e5e35b-5c61-423e-8272-b21528a870bc
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: 'The calendar month representation. Format YYYYMM. Example: 200206.'
        name: PROD_YEARMONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9e93163d-43b0-4ee5-b0a9-03519006f5ef
                stepCounter: 84709ea2-16bb-4d76-88e2-6998452e501b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88bd5019-9622-4f3d-a0d9-a165be5f5094
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: WORKING_INTEREST
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39671cb7-4312-4a91-8f8a-82f960d6b40e
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: PUMP_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6bfbc5bb-8e1f-43ea-aabc-99d90bed9615
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: METER_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e12429fe-a0ff-4b93-b7bd-8d96ce8478b5
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: METER_NUMBER_2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c862e672-3b97-440e-9a07-f03bcc18a636
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: METER_NUMBER_3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69a398cb-e3f2-461e-a5ea-d7ea56ed0bf2
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: CHILD_ACCOUNT_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f152434-ae58-4f77-a7fd-f8b5098ae050
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: CHILD_ACCOUNT_NUMBER_2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 37aae977-7573-4599-8029-a02b8206b545
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: CHILD_ACCOUNT_NUMBER_3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 736689fe-6dd4-4f15-a2d7-f12827171b62
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: VARCHAR(1000)
        defaultValue: ""
        description: ""
        name: FIELD_COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b85aad59-bbfd-4163-90d5-b7e98862c1e4
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: SURFACE_EQUIPMENT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5db3f2a6-9afe-4442-9c6a-bd6e971e23a1
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: SURFACE_EQUIPMENT_MODEL
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 254b822f-4300-4caa-a7cc-b4f66c491dcd
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: SURFACE_EQUIPMENT_MAKE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d0de0a20-88ab-4ec3-8fb5-deeee7144abe
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: SURFACE_EQUIPMENT_HP
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e41a09c-4813-43e4-87ed-87de6e84dc29
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: BOTTOMHOLE_LATITUDE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ec19a52-7b17-4c4e-9363-4f05b3060080
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: BOTTOMHOLE_LONGITUDE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 725c10e0-d0da-471c-b075-79542a19f187
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SURFACE_LATITUDE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de065f0b-b7bc-4c07-aa0e-61ca262ed1ba
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SURFACE_LONGITUDE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 784fb523-049c-4cbf-badf-b40ed4a4a6e6
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: WATER_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c6f9d20d-fe20-48c7-b4c3-b93a9a8976c7
                stepCounter: e22526cf-e4aa-4e4e-9099-3efa13af5b57
            transform: SUM(NVL(FACT_FDC_PRODUCTION_VOLUMES.WATER_METRIC, 0))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb50584d-c262-44a0-99eb-96c914d91068
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: OIL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea43b7e7-0d20-412e-bd9f-ae5b66f90896
                stepCounter: e22526cf-e4aa-4e4e-9099-3efa13af5b57
            transform: SUM(NVL(FACT_FDC_PRODUCTION_VOLUMES.OIL_METRIC, 0))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87b4a5a7-2ebc-4ee8-8fcb-b5810df20eed
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: GAS_E3M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 31dd2442-15f2-4052-bf66-67606c978647
                stepCounter: e22526cf-e4aa-4e4e-9099-3efa13af5b57
            transform: SUM(NVL(FACT_FDC_PRODUCTION_VOLUMES.GAS_METRIC, 0))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a96e99da-d166-4fa3-8b82-6d6418e300ce
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: OIL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84ecf357-e16b-4643-8390-10af31cd9d11
                stepCounter: e22526cf-e4aa-4e4e-9099-3efa13af5b57
            transform: SUM(NVL(FACT_FDC_PRODUCTION_VOLUMES.OIL_BOE, 0))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 987de64e-24d2-41ca-ba5c-abef2c7b41a6
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: GAS_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 99e30f25-6708-49f5-9bad-596a1d918f9f
                stepCounter: e22526cf-e4aa-4e4e-9099-3efa13af5b57
            transform: SUM(NVL(FACT_FDC_PRODUCTION_VOLUMES.GAS_BOE, 0))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75c0e45b-1212-47af-a744-67f75391ee2e
          stepCounter: cc834dad-7016-407b-8031-5c1229790bcf
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 99e30f25-6708-49f5-9bad-596a1d918f9f
                stepCounter: e22526cf-e4aa-4e4e-9099-3efa13af5b57
            transform: SUM(NVL(FACT_FDC_PRODUCTION_VOLUMES.GAS_BOE, 0)+NVL(FACT_FDC_PRODUCTION_VOLUMES.OIL_BOE, 0)+NVL(FACT_FDC_PRODUCTION_VOLUMES.CONDENSATE_BOE, 0)+NVL(FACT_FDC_PRODUCTION_VOLUMES.NGL_BOE, 0))
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ODS_PVIEW_PVT_PVUNIT: d554b1ad-15ef-40f5-8fff-8a730cc8b68e
          FACT_FDC_PRODUCTION_VOLUMES: e22526cf-e4aa-4e4e-9099-3efa13af5b57
          ODS_PVIEW_PVT_PVUNITOTHERTAG: 275ca4ff-a9c8-423c-893f-7ae26d6b631c
          DIM_FDC_ACTIVITY_PERIOD_DATE: 84709ea2-16bb-4d76-88e2-6998452e501b
          DIM_LO_SAP_COST_CENTER_HIER: f5d6146b-7042-4b8a-b29d-05b61de7beb0
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: FU
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNIT
          - locationName: TARGET
            nodeName: FACT_FDC_PRODUCTION_VOLUMES
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITOTHERTAG
          - locationName: TARGET
            nodeName: DIM_FDC_ACTIVITY_PERIOD_DATE
          - locationName: TARGET
            nodeName: DIM_LO_SAP_COST_CENTER_HIER
        join:
          joinCondition: |-
            FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVUNIT') }} ODS_PVIEW_PVT_PVUNIT
              JOIN {{ ref('TARGET','FACT_FDC_PRODUCTION_VOLUMES') }} FACT_FDC_PRODUCTION_VOLUMES
                ON ODS_PVIEW_PVT_PVUNIT.IDREC = FACT_FDC_PRODUCTION_VOLUMES.DIM_WELL_KEY
              JOIN (
                    SELECT IDRECFACILITYCALC ,
                           USERNUM2 AS CHILD_ACCOUNT ,
                           CHILD_ACCOUNT_2 ,
                           CHILD_ACCOUNT_3 ,
                           USERNUM3 AS METER_NUMBER ,
                           METER_NUMBER_2 ,
                           METER_NUMBER_3 ,
                           NAME ,
                           COSTCENTERIDA AS CC_NUM
                      FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVUNIT') }} ODS_PVIEW_PVT_PVUNIT
                      LEFT JOIN (
                            SELECT IDFLOWNET,
                                   IDRECPARENT,
                                   MAX("'Child Account 2'") AS CHILD_ACCOUNT_2,
                                   MAX("'Child Account 3'") AS CHILD_ACCOUNT_3,
                                   MAX("'Meter Number 2'") AS METER_NUMBER_2,
                                   MAX("'Meter Number 3'") AS METER_NUMBER_3
                              FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITOTHERTAG') }} PIVOT(MAX(VALUE) FOR TYP1 IN ('Child Account 2', 'Child Account 3', 'Meter Number 2', 'Meter Number 3'))
                             WHERE DSS_CURRENT_FLAG = 'Y'
                               AND DSS_DELETE_FLAG != 'Y'
                             GROUP BY IDFLOWNET,
                                      IDRECPARENT
                           ) TAGS
                        ON ODS_PVIEW_PVT_PVUNIT.IDREC = TAGS.IDRECPARENT
                     WHERE ODS_PVIEW_PVT_PVUNIT.DSS_CURRENT_FLAG = 'Y'
                       AND ODS_PVIEW_PVT_PVUNIT.DSS_DELETE_FLAG != 'Y'
                       AND ODS_PVIEW_PVT_PVUNIT.TYP1 = 'facility'
                       AND ODS_PVIEW_PVT_PVUNIT.USERNUM2 IS NOT NULL
                       AND ODS_PVIEW_PVT_PVUNIT.USERNUM3 IS NOT NULL
                   ) FU
                ON ODS_PVIEW_PVT_PVUNIT.IDRECFACILITYCALC = FU.IDRECFACILITYCALC
              JOIN {{ ref('TARGET','DIM_FDC_ACTIVITY_PERIOD_DATE') }} DIM_FDC_ACTIVITY_PERIOD_DATE
                ON FACT_FDC_PRODUCTION_VOLUMES.DIM_ACTIVITY_PERIOD_DATE_KEY = DIM_FDC_ACTIVITY_PERIOD_DATE.DIM_ACTIVITY_PERIOD_DATE_KEY
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_COST_CENTER_HIER') }} DIM_LO_SAP_COST_CENTER_HIER
                ON FU.CC_NUM = DIM_LO_SAP_COST_CENTER_HIER.CC_NUM
             WHERE ODS_PVIEW_PVT_PVUNIT.DSS_CURRENT_FLAG = 'Y'
               AND ODS_PVIEW_PVT_PVUNIT.DSS_DELETE_FLAG != 'Y'
               AND FACT_FDC_PRODUCTION_VOLUMES.DIM_SCENARIO_KEY = 'pv_sales_alloc_blend'
               AND FACT_FDC_PRODUCTION_VOLUMES.DIM_GROSS_NET_KEY = '1'
               AND FU.NAME IS NOT NULL
             GROUP BY FU.NAME ,
                      FU.CHILD_ACCOUNT ,
                      FU.CHILD_ACCOUNT_2 ,
                      FU.CHILD_ACCOUNT_3 ,
                      FU.METER_NUMBER ,
                      FU.METER_NUMBER_2 ,
                      FU.METER_NUMBER_3 ,
                      DIM_LO_SAP_COST_CENTER_HIER.CC_NUM ,
                      DIM_LO_SAP_COST_CENTER_HIER.CC_NAME ,
                      DIM_LO_SAP_COST_CENTER_HIER.COUNTRY_NAME ,
                      DIM_LO_SAP_COST_CENTER_HIER.PROV_NAME ,
                      DIM_LO_SAP_COST_CENTER_HIER.COREAREA_NAME ,
                      DIM_LO_SAP_COST_CENTER_HIER.AREA_NAME ,
                      DIM_LO_SAP_COST_CENTER_HIER.MANUAL_FOREMAN ,
                      DIM_LO_SAP_COST_CENTER_HIER.RUN ,
                      DIM_FDC_ACTIVITY_PERIOD_DATE.ACTIVITY_YEAR_NUMBER ,
                      DIM_FDC_ACTIVITY_PERIOD_DATE.ACTIVITY_MONTH_NAME_SHORT ,
                      DIM_FDC_ACTIVITY_PERIOD_DATE.MONTH_SORT
        name: VIEW_FDC_PWRANALYTICS_FACILITY
        noLinkRefs: []
  name: VIEW_FDC_PWRANALYTICS_FACILITY
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
