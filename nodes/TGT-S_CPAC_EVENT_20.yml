fileVersion: 1
id: a3be51ba-2307-4a5b-b57c-3c7528289dbe
name: S_CPAC_EVENT_20
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0421bcdd-6e12-4403-a3d2-58ce23f4bdba
          stepCounter: a3be51ba-2307-4a5b-b57c-3c7528289dbe
        config: {}
        dataType: NVARCHAR(10)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3cf1751a-951b-42ff-9461-e410f5c12f91
                stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c313d115-eda7-464e-807a-0b9c6e04d7f0
          stepCounter: a3be51ba-2307-4a5b-b57c-3c7528289dbe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 702dfc9d-df5e-42d8-86f8-9e68f29c462c
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06e5767c-8bcc-4fc0-8223-2bc050874816
          stepCounter: a3be51ba-2307-4a5b-b57c-3c7528289dbe
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: SPECIALTY_CODE
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN l_cpac_specialty.name='General Surgery'      THEN 'GENSU'
                          WHEN l_cpac_specialty.name like '%Orthopaedic%'   THEN 'ORTSU'
                          WHEN l_cpac_specialty.name = 'Gynaecology'        THEN 'GYNAE'
                          WHEN l_cpac_specialty.name ='Otorhinolaryngology' THEN 'ORL'
                          WHEN l_cpac_specialty.name = 'Urology'            THEN 'UROLO'
                          WHEN l_cpac_specialty.name = 'Cardiology'         THEN 'CARDI'
                          WHEN l_cpac_specialty.name = 'Plastic Surgery'    THEN 'PLASU'
                          WHEN l_cpac_specialty.name = 'Ophthalmology'      THEN 'OPHTH'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 19e8addd-3643-4d5c-8cd9-95de91a3589b
          stepCounter: a3be51ba-2307-4a5b-b57c-3c7528289dbe
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: OVERRIDE_REASON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d0bd7a00-d1fc-41a2-896b-c24832511e54
                stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22e75a73-d158-44d0-b014-d2416be30525
          stepCounter: a3be51ba-2307-4a5b-b57c-3c7528289dbe
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: BOOKING_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c7ccd20-17ad-4644-9cec-61d06223dfd4
                stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 56e1b160-d910-4898-a8a1-63ced036bb4d
          stepCounter: a3be51ba-2307-4a5b-b57c-3c7528289dbe
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: BOOKING_STATUS_STRING
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3889f21-7b26-43b1-a728-c6a2073eeb33
                stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9760580-5f8e-4084-a442-b1c62c14f802
          stepCounter: a3be51ba-2307-4a5b-b57c-3c7528289dbe
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: CALCULATED_BOOKING_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e4cea539-6b39-4949-bad6-820ba4c0d94a
                stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3754fd24-b719-4f71-9507-17ada192cb31
          stepCounter: a3be51ba-2307-4a5b-b57c-3c7528289dbe
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: CALCULATED_BOOKING_STATUS_STRING
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf85524d-a4b4-429d-9dcd-fec608cadfcb
                stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aac407d8-b73b-463e-adc2-904f38016ceb
          stepCounter: a3be51ba-2307-4a5b-b57c-3c7528289dbe
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CLINICALLY_APPROPRIATE_TIME_FRAME_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b5e2388b-d3da-4fe8-a8bb-e097277b3fb4
                stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0ef3690-45ab-4277-abd3-10c665d07b3e
          stepCounter: a3be51ba-2307-4a5b-b57c-3c7528289dbe
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: CLINICIAN_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2913014e-89b4-4fb7-87b3-ecd16b46c665
                stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1df89cb3-f86d-4993-a188-e19e56e78193
          stepCounter: a3be51ba-2307-4a5b-b57c-3c7528289dbe
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: IS_DUAL_SCORED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 119c265d-d209-4b5c-947b-b670582ff3b5
                stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6968018a-eb66-4853-9611-ba7e3106d6a8
          stepCounter: a3be51ba-2307-4a5b-b57c-3c7528289dbe
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: IS_OVERRIDABLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6e73ac6-4ba6-4508-a605-6a3311fac68b
                stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1cddf8c2-976f-477c-a0da-f28440ec40c7
          stepCounter: a3be51ba-2307-4a5b-b57c-3c7528289dbe
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: IS_OVERRIDDEN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4225063d-c837-47fc-9c2b-090946e84108
                stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1967a2a9-584d-4c46-82c5-7dadd938182e
          stepCounter: a3be51ba-2307-4a5b-b57c-3c7528289dbe
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SCORE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 922ad30b-384b-4fc2-8942-4374c5ed110a
                stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7c553b6-32f0-4373-9727-951b15075fc4
          stepCounter: a3be51ba-2307-4a5b-b57c-3c7528289dbe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: TIME_STAMP_LOCAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: da6e8cb6-f510-4d16-bcdd-f09e0b4f1b0a
                stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8ec40ac-ee1c-44d9-b395-d497c7f029ed
          stepCounter: a3be51ba-2307-4a5b-b57c-3c7528289dbe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: TIME_STAMP_UTC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8861dda9-1adb-4da2-a09f-5c1233befe4c
                stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33fd632b-c381-4964-931d-776c4c270a77
          stepCounter: a3be51ba-2307-4a5b-b57c-3c7528289dbe
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ADMISSION_SEQ_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 98136fb7-6d90-4356-b01e-a467c5af6aca
                stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1faac756-edae-46d0-9c31-d95afca1119d
          stepCounter: a3be51ba-2307-4a5b-b57c-3c7528289dbe
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: TOOL_PART
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 646f4033-28bd-4cf0-9e3d-ae35d2224bf2
                stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 432c7aa3-dac3-4597-a9f3-83e39e2cd086
          stepCounter: a3be51ba-2307-4a5b-b57c-3c7528289dbe
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ADMISSION_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f3e60ddf-f190-4e5d-9549-0d5a52bd7297
                stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 58cda00f-a8b7-4c56-82d9-55673dd59a8d
          stepCounter: a3be51ba-2307-4a5b-b57c-3c7528289dbe
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: CPAC_SCORING_CATEGORY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: abbaebeb-c7ba-45ea-bbd9-e4597088e800
                stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
            transform: ltrim(rtrim(CPAC_scoring_category_code))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8e04b11-0ec2-49cd-8c8b-204976fa6b8d
          stepCounter: a3be51ba-2307-4a5b-b57c-3c7528289dbe
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: CLINICIAN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c6e703f5-4ff0-419c-afae-b6379cdfc142
                stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8088d2cc-fd91-4929-b225-274b67bf5dbe
          stepCounter: a3be51ba-2307-4a5b-b57c-3c7528289dbe
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SPECIALTY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a0892ca-a12d-4042-bfa3-090d5ffd350b
                stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 68e24e59-5c4c-4357-8ab4-6b1d91d06e5e
          stepCounter: a3be51ba-2307-4a5b-b57c-3c7528289dbe
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TOOL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e0dd48da-e059-45e1-8f04-c6431e034220
                stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53fce119-16e8-4f0d-ad35-9cbffba3a9e6
          stepCounter: a3be51ba-2307-4a5b-b57c-3c7528289dbe
        config: {}
        dataType: SMALLDATETIME
        defaultValue: ""
        description: ""
        name: CREATED_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1fa5960c-0471-4839-97ad-843359edee21
                stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 184946a6-3f89-437d-b040-612554c2aca5
          stepCounter: a3be51ba-2307-4a5b-b57c-3c7528289dbe
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CPAC_EVENT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79e3f1a1-e468-4023-a866-e3459f92e9da
                stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16e4aa99-42dc-4d34-b5d5-85bf91a35017
          stepCounter: a3be51ba-2307-4a5b-b57c-3c7528289dbe
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: SPECIALTY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c2936731-a21f-4492-87b0-da5475bebed2
                stepCounter: eb4d630b-085a-4176-82b7-df2a4430f287
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 62afdaa4-f66b-469a-8c06-aa019b6824e8
          stepCounter: a3be51ba-2307-4a5b-b57c-3c7528289dbe
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: SCORING_TOOL_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 85a23e35-d4c4-4234-bb90-3630e3ddeb87
                stepCounter: 781407e8-ec8b-4aad-a81c-7cd9f84731a0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb2f219f-a8fc-45b2-9583-a040331cdab5
          stepCounter: a3be51ba-2307-4a5b-b57c-3c7528289dbe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_CPAC_EVENT_10: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
          L_CPAC_SCORING_TOOL: 781407e8-ec8b-4aad-a81c-7cd9f84731a0
          L_CPAC_SPECIALTY: eb4d630b-085a-4176-82b7-df2a4430f287
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_CPAC_EVENT_10
          - locationName: TGT
            nodeName: L_CPAC_SCORING_TOOL
          - locationName: TGT
            nodeName: L_CPAC_SPECIALTY
        join:
          joinCondition: |-
            FROM {{ ref('TGT','S_CPAC_EVENT_10') }} s_cpac_event_10
              JOIN {{ ref('TGT','L_CPAC_SCORING_TOOL') }} l_cpac_scoring_tool
                ON s_cpac_event_10.tool_id = l_cpac_scoring_tool.ID
              JOIN {{ ref('TGT','L_CPAC_SPECIALTY') }} l_cpac_specialty
                ON s_cpac_event_10.specialty_id = l_cpac_specialty.ID
              LEFT JOIN dim.dim_patient
                ON s_cpac_event_10.patient_nhi = dim_patient.patient_nhi
               AND dim_patient.NHI_sequence = 1
        name: S_CPAC_EVENT_20
        noLinkRefs: []
  name: S_CPAC_EVENT_20
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
