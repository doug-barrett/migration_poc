fileVersion: 1
id: 2497d712-3506-4cfb-b62b-118dcc07e040
name: VIEW_FACT_FDC_MOSAIC_CDM
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c611e8c3-26a4-403e-aa0d-0edbc9756fb0
          stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: ENTITY_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c611e8c3-26a4-403e-aa0d-0edbc9756fb0
                stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 44da63fd-2dd4-4d58-a157-826f838f3e86
          stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: SCENARIO_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 44da63fd-2dd4-4d58-a157-826f838f3e86
                stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e706ec0-a378-4597-85f8-f8cb83bf29fe
          stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0e706ec0-a378-4597-85f8-f8cb83bf29fe
                stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f9a5a96-53e0-4c3e-9945-47b2b1182619
          stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: ACTIVITY_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f9a5a96-53e0-4c3e-9945-47b2b1182619
                stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1820c3d1-80de-469d-ab50-c09585c368ca
          stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: ACTIVITY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1820c3d1-80de-469d-ab50-c09585c368ca
                stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 006a88c6-a596-4aa5-80ea-3ed84670dab3
          stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: NORMALIZED_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 006a88c6-a596-4aa5-80ea-3ed84670dab3
                stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5971da5e-b5d9-4b59-8d77-d4408a6e40a9
          stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: PRODUCING_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5971da5e-b5d9-4b59-8d77-d4408a6e40a9
                stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b87c6a17-3b7d-4583-b814-b17c471a6d05
          stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: ON_PROD_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b87c6a17-3b7d-4583-b814-b17c471a6d05
                stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92703cdf-4fac-49d5-a168-32088a051176
          stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 92703cdf-4fac-49d5-a168-32088a051176
                stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f11b1afe-aaf9-483e-bd32-b700118727ca
          stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: OIL_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f11b1afe-aaf9-483e-bd32-b700118727ca
                stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75c274c9-3efa-45ce-9261-f1239b431c69
          stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: OIL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75c274c9-3efa-45ce-9261-f1239b431c69
                stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57dc2a1d-31bf-4bc1-b5f0-51110a0c227f
          stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: OIL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 57dc2a1d-31bf-4bc1-b5f0-51110a0c227f
                stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da37a03c-1fa2-468c-be56-4db0055c7756
          stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: CONDENSATE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: da37a03c-1fa2-468c-be56-4db0055c7756
                stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: baec658d-d918-4b2f-8baa-0f67d80e7efb
          stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: CONDENSATE_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: baec658d-d918-4b2f-8baa-0f67d80e7efb
                stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a222a972-6369-4fa9-96c5-d6c41aefe3e1
          stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: CONDENSATE_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a222a972-6369-4fa9-96c5-d6c41aefe3e1
                stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa26bd06-9959-4626-804f-7f79c49ae8ae
          stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: NGL_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa26bd06-9959-4626-804f-7f79c49ae8ae
                stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4ae495e-7724-4b3c-85c6-8228cc9d6b4b
          stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: NGL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d4ae495e-7724-4b3c-85c6-8228cc9d6b4b
                stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 494ec298-ebd4-4711-a5b9-3eb69142d178
          stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: NGL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 494ec298-ebd4-4711-a5b9-3eb69142d178
                stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53d50955-dd85-4d2b-961f-6a8d63659a29
          stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 53d50955-dd85-4d2b-961f-6a8d63659a29
                stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f6c84d4-f7e2-4d9b-b986-e54f3bf45604
          stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: GAS_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f6c84d4-f7e2-4d9b-b986-e54f3bf45604
                stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ad6495f-92ec-46aa-a207-46de96e061cd
          stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: GAS_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ad6495f-92ec-46aa-a207-46de96e061cd
                stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91f1b32f-bb6d-4d20-a9a0-0cfd90f65291
          stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: RAW_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91f1b32f-bb6d-4d20-a9a0-0cfd90f65291
                stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9abf445c-4a6a-468e-9aa3-c8ce850f63dd
          stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: RAW_GAS_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9abf445c-4a6a-468e-9aa3-c8ce850f63dd
                stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2bbad06-b2aa-482c-a6ab-8c7455840a83
          stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: RAW_GAS_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2bbad06-b2aa-482c-a6ab-8c7455840a83
                stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5514f656-2c40-47a4-90c2-1a24b557efb0
          stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5514f656-2c40-47a4-90c2-1a24b557efb0
                stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72127280-f215-4cb4-b89b-4d2ddf075ded
          stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: WATER_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72127280-f215-4cb4-b89b-4d2ddf075ded
                stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f82ec044-921a-41b8-93a9-b9ea3b92e704
          stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: WATER_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f82ec044-921a-41b8-93a9-b9ea3b92e704
                stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b83eb5b9-2723-4213-9df0-f8d2ae933ca2
          stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: ETHANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b83eb5b9-2723-4213-9df0-f8d2ae933ca2
                stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dab72b45-bafd-4b30-b29f-7a639663126a
          stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: ETHANE_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dab72b45-bafd-4b30-b29f-7a639663126a
                stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e097d21d-b405-4f7b-a228-9a794a6a739b
          stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: ETHANE_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e097d21d-b405-4f7b-a228-9a794a6a739b
                stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 367a56bf-6825-4bb5-b6a6-d78244b4ca7f
          stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: PROPANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 367a56bf-6825-4bb5-b6a6-d78244b4ca7f
                stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d0e34c2-57dd-4540-bb53-68dde4e29955
          stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: PROPANE_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4d0e34c2-57dd-4540-bb53-68dde4e29955
                stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1720ac66-9c02-454e-a385-bca11cfb297c
          stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: PROPANE_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1720ac66-9c02-454e-a385-bca11cfb297c
                stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c7fb76ba-00e4-473d-aa79-c003efa57c5e
          stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: BUTANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7fb76ba-00e4-473d-aa79-c003efa57c5e
                stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ab105d7-ccce-43ac-8d09-aca12f734df4
          stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: BUTANE_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9ab105d7-ccce-43ac-8d09-aca12f734df4
                stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bef5d99e-fe80-4c84-80e3-558f6a64a938
          stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: BUTANE_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bef5d99e-fe80-4c84-80e3-558f6a64a938
                stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb6a94d1-6f7c-47ea-81c0-2090c8dbdd58
          stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: PENTANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb6a94d1-6f7c-47ea-81c0-2090c8dbdd58
                stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f8eab44d-e390-49d9-a43a-eb04eb0b5da6
          stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: PENTANE_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8eab44d-e390-49d9-a43a-eb04eb0b5da6
                stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03f36310-a18e-4ff0-a88a-55571e3e2670
          stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: PENTANE_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03f36310-a18e-4ff0-a88a-55571e3e2670
                stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a8332bf-b446-4a4c-97cd-67ad6fea48dd
          stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: COMMENT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a8332bf-b446-4a4c-97cd-67ad6fea48dd
                stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc9b68f5-8125-4ac7-b1ca-add0080c3fb6
          stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc9b68f5-8125-4ac7-b1ca-add0080c3fb6
                stepCounter: 2497d712-3506-4cfb-b62b-118dcc07e040
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_FACT_FDC_MOSAIC_CDM: 2497d712-3506-4cfb-b62b-118dcc07e040
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_FACT_FDC_MOSAIC_CDM') }} AS WITH MOSAIC_DATA AS (
                    SELECT DISTINCT ENTITY_ID ,
                           CASE_ID ,
                           ENTITY_NAME ,
                           CATEGORY ,
                           CAPITAL_EXPENSE_CATEGORY ,
                           YEAR ,

                     MONTH ,
                           GROSS_OIL_VOLUME ,
                           GROSS_FCOND_VOLUME AS GROSS_COND_VOLUME ,
                           GROSS_GAS_VOLUME ,
                           GROSS_RAW_GAS_VOLUME ,
                           GROSS_ETH_VOLUME ,
                           GROSS_PROP_VOLUME ,
                           GROSS_BUTANE_VOLUME ,
                           GROSS_COND_VOLUME AS GROSS_PENT_VOLUME ,
                           COSHARE_OIL_VOLUME ,
                           COSHARE_FCOND_VOLUME AS COSHARE_COND_VOLUME ,
                           COSHARE_GAS_VOLUME ,
                           COSHARE_ETH_VOLUME ,
                           COSHARE_PROP_VOLUME ,
                           COSHARE_BUTANE_VOLUME ,
                           COSHARE_COND_VOLUME AS COSHARE_PENT_VOLUME
                      FROM "WS_EDW"."VIEW_MOSAIC_CDM_VOLUMES"
                     WHERE
                     MONTH <> 0
                       AND CASE_ID IN ({{ parameters.MOSAIC_CDM_FORECAST_CASE_IDS }})
                       AND ENTITY_STATE_ID = 4
                       AND RESERVE_CATEGORY_ID IN (101,102,104,106)
                       AND GROSS_OIL_VOLUME + GROSS_COND_VOLUME + GROSS_FCOND_VOLUME + GROSS_GAS_VOLUME + GROSS_ETH_VOLUME + GROSS_PROP_VOLUME + GROSS_BUTANE_VOLUME != 0 --

                 UNION ALL --
             SELECT DISTINCT ENTITY_ID ,
                           CASE_ID ,
                           ENTITY_NAME ,
                           CATEGORY ,
                           CAPITAL_EXPENSE_CATEGORY ,
                           YEAR ,

                     MONTH ,
                           GROSS_OIL_VOLUME ,
                           GROSS_FCOND_VOLUME AS GROSS_COND_VOLUME ,
                           GROSS_GAS_VOLUME ,
                           GROSS_RAW_GAS_VOLUME ,
                           GROSS_ETH_VOLUME ,
                           GROSS_PROP_VOLUME ,
                           GROSS_BUTANE_VOLUME ,
                           GROSS_COND_VOLUME AS GROSS_PENT_VOLUME ,
                           COSHARE_OIL_VOLUME ,
                           COSHARE_FCOND_VOLUME AS COSHARE_COND_VOLUME ,
                           COSHARE_GAS_VOLUME ,
                           COSHARE_ETH_VOLUME ,
                           COSHARE_PROP_VOLUME ,
                           COSHARE_BUTANE_VOLUME ,
                           COSHARE_COND_VOLUME AS COSHARE_PENT_VOLUME
                      FROM "WS_EDW"."VIEW_MOSAIC_CDM_VOL_LIVE_FORECAST" WORKING
                     WHERE
                     MONTH <> 0
                       AND GROSS_OIL_VOLUME + GROSS_COND_VOLUME + GROSS_FCOND_VOLUME + GROSS_GAS_VOLUME + GROSS_ETH_VOLUME + GROSS_PROP_VOLUME + GROSS_BUTANE_VOLUME != 0
                   ) SELECT ENTITY_KEY ,
                   SCENARIO_KEY ,
                   GROSS_NET_KEY ,
                   ACTIVITY_DATE_KEY ,
                   ACTIVITY_DATE ,
                   '-1' AS NORMALIZED_DATE_KEY ,
                   '-1' AS PRODUCING_DATE_KEY ,
                   NULL AS ON_PROD_DATE_KEY ,
                   NULL AS CC_NUM ,
                   OIL_METRIC ,
                   OIL_IMPERIAL ,
                   OIL_BOE ,
                   CONDENSATE_METRIC ,
                   CONDENSATE_IMPERIAL ,
                   CONDENSATE_BOE ,
                   (ETHANE_METRIC + PROPANE_METRIC + BUTANE_METRIC + PENTANE_METRIC) AS NGL_METRIC ,
                   (ETHANE_IMPERIAL + PROPANE_IMPERIAL + BUTANE_IMPERIAL + PENTANE_IMPERIAL) AS NGL_IMPERIAL ,
                   (ETHANE_BOE + PROPANE_BOE + BUTANE_BOE + PENTANE_BOE) AS NGL_BOE ,
                   GAS_METRIC ,
                   GAS_IMPERIAL ,
                   GAS_BOE ,
                   RAW_GAS_METRIC ,
                   RAW_GAS_IMPERIAL ,
                   RAW_GAS_BOE ,
                   NULL AS WATER_METRIC ,
                   NULL AS WATER_IMPERIAL ,
                   NULL AS WATER_BOE ,
                   ETHANE_METRIC ,
                   ETHANE_IMPERIAL ,
                   ETHANE_BOE ,
                   PROPANE_METRIC ,
                   PROPANE_IMPERIAL ,
                   PROPANE_BOE ,
                   BUTANE_METRIC ,
                   BUTANE_IMPERIAL ,
                   BUTANE_BOE ,
                   PENTANE_METRIC ,
                   PENTANE_IMPERIAL ,
                   PENTANE_BOE ,
                   NULL AS COMMENT_TYPE ,
                   NULL AS COMMENT
              FROM (
                    --NET
             SELECT CAST(MD.ENTITY_ID AS VARCHAR(100)) AS ENTITY_KEY ,
                           CAST(MD.CASE_ID || '-' || NVL(MD.CATEGORY, 'UNKNOWN') || '-' || NVL(MD.CAPITAL_EXPENSE_CATEGORY, 'UNKNOWN') AS VARCHAR(100)) AS SCENARIO_KEY ,
                           '2' AS GROSS_NET_KEY ,
                           DD.DIM_DATE_KEY AS ACTIVITY_DATE_KEY ,
                           TO_DATE(DD.FULL_DATE) AS ACTIVITY_DATE ,
                           SUM(MD.COSHARE_OIL_VOLUME / VS.OIL_SI_TO_IMP_RATE) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS OIL_METRIC ,
                           SUM(MD.COSHARE_OIL_VOLUME) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS OIL_IMPERIAL ,
                           SUM(MD.COSHARE_OIL_VOLUME) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS OIL_BOE ,
                           SUM(MD.COSHARE_COND_VOLUME / VS.NGL_SI_TO_IMP_RATE) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS CONDENSATE_METRIC ,
                           SUM(MD.COSHARE_COND_VOLUME) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS CONDENSATE_IMPERIAL ,
                           SUM(MD.COSHARE_COND_VOLUME) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS CONDENSATE_BOE ,
                           SUM(MD.COSHARE_GAS_VOLUME / VS.GAS_SI_TO_IMP_RATE) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS GAS_METRIC ,
                           SUM(MD.COSHARE_GAS_VOLUME) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS GAS_IMPERIAL ,
                           SUM(MD.COSHARE_GAS_VOLUME / VS.GAS_SI_TO_IMP_RATE * GAS_BOE_THERMAL_RATE) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS GAS_BOE ,
                           NULL AS RAW_GAS_METRIC ,
                           NULL AS RAW_GAS_IMPERIAL ,
                           NULL AS RAW_GAS_BOE ,
                           SUM(MD.COSHARE_ETH_VOLUME / VS.NGL_SI_TO_IMP_RATE) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS ETHANE_METRIC ,
                           SUM(MD.COSHARE_ETH_VOLUME) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS ETHANE_IMPERIAL ,
                           SUM(MD.COSHARE_ETH_VOLUME) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS ETHANE_BOE ,
                           SUM(MD.COSHARE_PROP_VOLUME / VS.NGL_SI_TO_IMP_RATE) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS PROPANE_METRIC ,
                           SUM(MD.COSHARE_PROP_VOLUME) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS PROPANE_IMPERIAL ,
                           SUM(MD.COSHARE_PROP_VOLUME) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS PROPANE_BOE ,
                           SUM(MD.COSHARE_BUTANE_VOLUME / VS.NGL_SI_TO_IMP_RATE) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS BUTANE_METRIC ,
                           SUM(MD.COSHARE_BUTANE_VOLUME) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS BUTANE_IMPERIAL ,
                           SUM(MD.COSHARE_BUTANE_VOLUME) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS BUTANE_BOE ,
                           SUM(MD.COSHARE_PENT_VOLUME / VS.NGL_SI_TO_IMP_RATE) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS PENTANE_METRIC ,
                           SUM(MD.COSHARE_PENT_VOLUME) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS PENTANE_IMPERIAL ,
                           SUM(MD.COSHARE_PENT_VOLUME) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS PENTANE_BOE
                      FROM (
                            SELECT ME.* ,
                                   TO_DATE(ME.YEAR || '-' || RIGHT('0' || ME.MONTH, 2) || '-01') AS MOSAIC_DATE
                              FROM MOSAIC_DATA ME
                           ) MD
                      LEFT JOIN (
                            SELECT DIM_ACTIVITY_PERIOD_DATE_KEY AS DIM_DATE_KEY ,
                                   FULL_DATE ,
                                   TO_CHAR(DATE_TRUNC(MONTH, FULL_DATE), 'YYYYMMDD') AS FIRST_DATE_KEY
                              FROM "WS_EDW"."DIM_FDC_ACTIVITY_PERIOD_DATE"
                           ) DD
                        ON TO_CHAR(MD.MOSAIC_DATE, 'YYYYMMDD') = DD.FIRST_DATE_KEY
                     CROSS JOIN "WS_EDW"."VIEW_QBYTE_PRODUCT_RATES" VS
                     GROUP BY MD.ENTITY_ID ,
                              MD.CASE_ID ,
                              DD.DIM_DATE_KEY ,
                              TO_DATE(DD.FULL_DATE) ,
                              TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') ,
                              MD.CATEGORY ,
                              MD.CAPITAL_EXPENSE_CATEGORY
                 UNION ALL --GROSS
             SELECT CAST(MD.ENTITY_ID AS VARCHAR(100)) AS ENTITY_KEY ,
                           CAST(MD.CASE_ID || '-' || NVL(MD.CATEGORY, 'UNKNOWN') || '-' || NVL(MD.CAPITAL_EXPENSE_CATEGORY, 'UNKNOWN') AS VARCHAR(100)) AS SCENARIO_KEY ,
                           '1' AS GROSS_NET_KEY ,
                           DD.DIM_DATE_KEY AS ACTIVITY_DATE_KEY ,
                           TO_DATE(DD.FULL_DATE) AS ACTIVITY_DATE ,
                           SUM(MD.GROSS_OIL_VOLUME / VS.OIL_SI_TO_IMP_RATE) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS OIL_METRIC ,
                           SUM(MD.GROSS_OIL_VOLUME) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS OIL_IMPERIAL ,
                           SUM(MD.GROSS_OIL_VOLUME) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS OIL_BOE ,
                           SUM(MD.GROSS_COND_VOLUME / VS.NGL_SI_TO_IMP_RATE) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS CONDENSATE_METRIC ,
                           SUM(MD.GROSS_COND_VOLUME) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS CONDENSATE_IMPERIAL ,
                           SUM(MD.GROSS_COND_VOLUME) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS CONDENSATE_BOE ,
                           SUM(MD.GROSS_GAS_VOLUME / VS.GAS_SI_TO_IMP_RATE) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS GAS_METRIC ,
                           SUM(MD.GROSS_GAS_VOLUME) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS GAS_IMPERIAL ,
                           SUM(MD.GROSS_GAS_VOLUME / VS.GAS_SI_TO_IMP_RATE * VS.GAS_BOE_THERMAL_RATE) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS GAS_BOE ,
                           SUM(MD.GROSS_RAW_GAS_VOLUME / VS.GAS_SI_TO_IMP_RATE) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS RAW_GAS_METRIC ,
                           SUM(MD.GROSS_RAW_GAS_VOLUME) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS RAW_GAS_IMPERIAL ,
                           SUM(MD.GROSS_RAW_GAS_VOLUME / VS.GAS_SI_TO_IMP_RATE * VS.GAS_BOE_THERMAL_RATE) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS RAW_GAS_BOE ,
                           SUM(MD.GROSS_ETH_VOLUME / VS.NGL_SI_TO_IMP_RATE) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS ETHANE_METRIC ,
                           SUM(MD.GROSS_ETH_VOLUME) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS ETHANE_IMPERIAL ,
                           SUM(MD.GROSS_ETH_VOLUME) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS ETHANE_BOE ,
                           SUM(MD.GROSS_PROP_VOLUME / VS.NGL_SI_TO_IMP_RATE) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS PROPANE_METRIC ,
                           SUM(MD.GROSS_PROP_VOLUME) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS PROPANE_IMPERIAL ,
                           SUM(MD.GROSS_PROP_VOLUME) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS PROPANE_BOE ,
                           SUM(MD.GROSS_BUTANE_VOLUME / VS.NGL_SI_TO_IMP_RATE) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS BUTANE_METRIC ,
                           SUM(MD.GROSS_BUTANE_VOLUME) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS BUTANE_IMPERIAL ,
                           SUM(MD.GROSS_BUTANE_VOLUME) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS BUTANE_BOE ,
                           SUM(MD.GROSS_PENT_VOLUME / VS.NGL_SI_TO_IMP_RATE) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS PENTANE_METRIC ,
                           SUM(MD.GROSS_PENT_VOLUME) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS PENTANE_IMPERIAL ,
                           SUM(MD.GROSS_PENT_VOLUME) / TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') AS PENTANE_BOE
                      FROM (
                            SELECT ME.* ,
                                   TO_DATE(ME.YEAR || '-' || RIGHT('0' || ME.MONTH, 2) || '-01') AS MOSAIC_DATE
                              FROM MOSAIC_DATA ME
                           ) MD
                      LEFT JOIN (
                            SELECT DIM_ACTIVITY_PERIOD_DATE_KEY AS DIM_DATE_KEY ,
                                   FULL_DATE ,
                                   TO_CHAR(DATE_TRUNC(MONTH, FULL_DATE), 'YYYYMMDD') AS FIRST_DATE_KEY
                              FROM "WS_EDW"."DIM_FDC_ACTIVITY_PERIOD_DATE"
                           ) DD
                        ON TO_CHAR(MD.MOSAIC_DATE, 'YYYYMMDD') = DD.FIRST_DATE_KEY
                     CROSS JOIN "WS_EDW"."VIEW_QBYTE_PRODUCT_RATES" VS
                     GROUP BY MD.ENTITY_ID ,
                              MD.CASE_ID ,
                              DD.DIM_DATE_KEY ,
                              TO_DATE(DD.FULL_DATE) ,
                              TO_CHAR(LAST_DAY(MD.MOSAIC_DATE), 'DD') ,
                              MD.CATEGORY ,
                              MD.CAPITAL_EXPENSE_CATEGORY
                   ) SRC
        dependencies:
          - locationName: TARGET
            nodeName: VIEW_FACT_FDC_MOSAIC_CDM
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','VIEW_FACT_FDC_MOSAIC_CDM') }}
        name: VIEW_FACT_FDC_MOSAIC_CDM
        noLinkRefs: []
  name: VIEW_FACT_FDC_MOSAIC_CDM
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
