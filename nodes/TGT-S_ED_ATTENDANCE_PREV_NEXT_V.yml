fileVersion: 1
id: 0f7a48cc-7da7-4ae7-a039-23c2604b00ad
name: S_ED_ATTENDANCE_PREV_NEXT_V
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: "View of Patient's Previous and Next Attendance"
  isMultisource: false
  locationName: TGT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 605fccff-c152-45e4-9a90-6d0a6bf5a2f0
          stepCounter: 0f7a48cc-7da7-4ae7-a039-23c2604b00ad
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed9e5167-8032-4f20-8210-7c5200b8b023
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 44fdadd6-3638-4476-9efd-8b6a3502d52d
          stepCounter: 0f7a48cc-7da7-4ae7-a039-23c2604b00ad
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: AEATT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52e67909-b5a0-4605-93a2-b1e2063144b2
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71abb767-2806-4c9e-86a9-cef67ee2a2a8
          stepCounter: 0f7a48cc-7da7-4ae7-a039-23c2604b00ad
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATNT_REFNO
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07720c99-6c20-4c62-9b78-ba232d3f4720
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5fc114ee-32da-4303-8a6a-97ee8eea1fc9
          stepCounter: 0f7a48cc-7da7-4ae7-a039-23c2604b00ad
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_VISIT_COUNT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab2ae2b9-2b2f-41c5-8c15-a72c3501d182
                stepCounter: 02d90952-09d5-4a28-bbbc-fb2a26f5811d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e97f114-c2a3-4309-8a5f-af65543a0381
          stepCounter: 0f7a48cc-7da7-4ae7-a039-23c2604b00ad
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CURR_PATIENT_VISIT_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3199f413-740c-4949-95ec-ff98441232fb
          stepCounter: 0f7a48cc-7da7-4ae7-a039-23c2604b00ad
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CURR_ARRIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d458d5a-4c75-414f-b008-9f5878f7e570
          stepCounter: 0f7a48cc-7da7-4ae7-a039-23c2604b00ad
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CURR_DEPARTED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 513524b3-dfe9-4b60-877f-b1ace4785534
          stepCounter: 0f7a48cc-7da7-4ae7-a039-23c2604b00ad
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CURR_MEDICAL_DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16ee523b-7dc5-4188-b9e2-fa6608696c97
          stepCounter: 0f7a48cc-7da7-4ae7-a039-23c2604b00ad
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: CURR_DISCHARGE_REASON_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8466e5ce-d6d4-4cd7-b9c9-83dc073be217
          stepCounter: 0f7a48cc-7da7-4ae7-a039-23c2604b00ad
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CURR_LAST_SEEN_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b961109-3097-4c1d-bdc0-2b2a92e32cce
          stepCounter: 0f7a48cc-7da7-4ae7-a039-23c2604b00ad
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: CURR_LAST_SEEN_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 855dd28c-7dbc-448e-bd9f-556cb668df35
          stepCounter: 0f7a48cc-7da7-4ae7-a039-23c2604b00ad
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: CURR_LAST_SEEN_SPONT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16bee8b5-0f1e-4caa-9a01-d4906a9202db
          stepCounter: 0f7a48cc-7da7-4ae7-a039-23c2604b00ad
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PREV_ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a00a43d-b44c-4427-9603-09965d59a686
          stepCounter: 0f7a48cc-7da7-4ae7-a039-23c2604b00ad
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREV_AEATT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 00167a3e-9b4a-4d2b-8272-ef4a0aa740df
          stepCounter: 0f7a48cc-7da7-4ae7-a039-23c2604b00ad
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREV_PATIENT_VISIT_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38b289ca-6edd-4ed8-9f5c-23d005686e3d
          stepCounter: 0f7a48cc-7da7-4ae7-a039-23c2604b00ad
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PREV_ARRIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ece354e2-3c3e-4d83-8630-110bee83e01d
          stepCounter: 0f7a48cc-7da7-4ae7-a039-23c2604b00ad
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PREV_DEPARTED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a043d157-cb54-4987-a987-88ad85b3003a
          stepCounter: 0f7a48cc-7da7-4ae7-a039-23c2604b00ad
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PREV_MEDICAL_DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 979a2b9d-9cd0-4d40-a7a2-b90666eff203
          stepCounter: 0f7a48cc-7da7-4ae7-a039-23c2604b00ad
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: PREV_DISCHARGE_REASON_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3aa17968-e4fa-4d1d-834d-59fea86fffeb
          stepCounter: 0f7a48cc-7da7-4ae7-a039-23c2604b00ad
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREV_LAST_SEEN_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff33d820-016a-4851-a0c6-ebfb45d40fe1
          stepCounter: 0f7a48cc-7da7-4ae7-a039-23c2604b00ad
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PREV_LAST_SEEN_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: adc15a23-0766-4262-9a4a-120ea0e23a39
          stepCounter: 0f7a48cc-7da7-4ae7-a039-23c2604b00ad
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PREV_LAST_SEEN_SPONT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa40635c-59da-4405-b3f9-2cf88efed991
          stepCounter: 0f7a48cc-7da7-4ae7-a039-23c2604b00ad
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NEXT_ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e92f4e68-b2ab-4fed-bf94-dce2a9cb2c5d
          stepCounter: 0f7a48cc-7da7-4ae7-a039-23c2604b00ad
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NEXT_AEATT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 509e5c91-1641-4098-8ed3-d6bde9c510e3
          stepCounter: 0f7a48cc-7da7-4ae7-a039-23c2604b00ad
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NEXT_PATIENT_VISIT_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a45620c2-1404-487e-9e38-09020ea7b964
          stepCounter: 0f7a48cc-7da7-4ae7-a039-23c2604b00ad
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NEXT_ARRIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15a5133d-ddf8-499d-9f5c-28e844ec06e8
          stepCounter: 0f7a48cc-7da7-4ae7-a039-23c2604b00ad
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NEXT_DEPARTED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9e43837-00a6-47cc-9fa7-e9a6260ee948
          stepCounter: 0f7a48cc-7da7-4ae7-a039-23c2604b00ad
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NEXT_MEDICAL_DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b5baa233-53fe-489c-b554-16226aac7883
          stepCounter: 0f7a48cc-7da7-4ae7-a039-23c2604b00ad
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: NEXT_DISCHARGE_REASON_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 46c29441-69d1-4923-9c99-92119ad2dd1d
          stepCounter: 0f7a48cc-7da7-4ae7-a039-23c2604b00ad
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NEXT_LAST_SEEN_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf82ec53-cebb-4e4a-b65e-1ae805cf712f
          stepCounter: 0f7a48cc-7da7-4ae7-a039-23c2604b00ad
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NEXT_LAST_SEEN_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0dc0d8b-ae49-4927-8de7-41836c0c7aec
          stepCounter: 0f7a48cc-7da7-4ae7-a039-23c2604b00ad
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NEXT_LAST_SEEN_SPONT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            SELECT cur.encounter encounter,
                   cur.aeatt_refno aeatt_refno,
                   cur.patnt_refno patnt_refno,
                   cur.patient_visit_count patient_visit_count,
                   cur.patient_visit_num curr_patient_visit_num,
                   cur.arrived_date curr_arrived_date,
                   cur.departed_date curr_departed_date,
                   cur.medical_discharge_date curr_medical_discharge_date,
                   cur.discharge_reason_code curr_discharge_reason_code,
                   cur.last_seen_proca_refno curr_last_seen_proca_refno,
                   cur.last_seen_specialty curr_last_seen_specialty,
                   cur.last_seen_spont_code curr_last_seen_spont_code,
                   prv.encounter prev_encounter,
                   prv.aeatt_refno prev_aeatt_refno,
                   prv.patient_visit_num prev_patient_visit_num,
                   prv.arrived_date prev_arrived_date,
                   prv.departed_date prev_departed_date,
                   prv.medical_discharge_date prev_medical_discharge_date,
                   prv.discharge_reason_code prev_discharge_reason_code,
                   prv.last_seen_proca_refno prev_last_seen_proca_refno,
                   prv.last_seen_specialty prev_last_seen_specialty,
                   prv.last_seen_spont_code prev_last_seen_spont_code,
                   nxt.encounter next_encounter,
                   nxt.aeatt_refno next_aeatt_refno,
                   nxt.patient_visit_num next_patient_visit_num,
                   nxt.arrived_date next_arrived_date,
                   nxt.departed_date next_departed_date,
                   nxt.medical_discharge_date next_medical_discharge_date,
                   nxt.discharge_reason_code next_discharge_reason_code,
                   nxt.last_seen_proca_refno next_last_seen_proca_refno,
                   nxt.last_seen_specialty next_last_seen_specialty,
                   nxt.last_seen_spont_code next_last_seen_spont_code
              FROM [dbo].[s_ed_attendance_10] cur
              LEFT OUTER JOIN s_ed_attendance_10 prv
                ON (cur.patnt_refno = prv.patnt_refno AND prv.patient_visit_num = cur.patient_visit_num - 1)
              LEFT OUTER JOIN s_ed_attendance_10 nxt
                ON (cur.patnt_refno = nxt.patnt_refno AND nxt.patient_visit_num = cur.patient_visit_num + 1)
        dependencies:
          - locationName: TGT
            nodeName: S_ED_ATTENDANCE_10
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TGT','S_ED_ATTENDANCE_10') }}
        name: S_ED_ATTENDANCE_PREV_NEXT_V
        noLinkRefs: []
  name: S_ED_ATTENDANCE_PREV_NEXT_V
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
