fileVersion: 1
id: 36c297f1-1d20-4a9f-94c7-639496856041
name: V_ALCOHOL_ASSESSMENT_IPM_V
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb362347-d307-4018-a7e4-a440a0ed3b7d
          stepCounter: 36c297f1-1d20-4a9f-94c7-639496856041
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3490906-6f48-4084-913d-5535ca85a478
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 84044a21-f401-41c9-ba33-5040879205cd
          stepCounter: 36c297f1-1d20-4a9f-94c7-639496856041
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: ALCOHOL_ANSWER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fbb01e3b-4612-47c8-9a4a-5d6abddc60ef
                stepCounter: 06fa4241-360c-43d0-8e4a-8b860f92fc09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc276583-a6d0-4d74-bc7e-fed8a312a509
          stepCounter: 36c297f1-1d20-4a9f-94c7-639496856041
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ALCOHOL_ANSWERS_REVERSE_SEQUENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: row_number() OVER (PARTITION BY identifier ORDER BY ds_pims_ae_attendances.modif_dttm)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f49ac456-802a-44d2-beca-451825539f6b
          stepCounter: 36c297f1-1d20-4a9f-94c7-639496856041
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9b0a3740-22e0-45ec-baa5-484a6d6bfe97
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 85fde08d-4cc0-43aa-8bfa-8580a22cbf2b
          stepCounter: 36c297f1-1d20-4a9f-94c7-639496856041
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'ipm neref_refno'"
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_PIMS_AE_ATTENDANCES
        join:
          joinCondition: |-
            FROM ds_pims_ae_attendances
              JOIN ds_pims_reference_values
                ON ds_pims_ae_attendances.neref_refno = rfval_refno
               AND ds_pims_reference_values.archv_flag = 'N'
             WHERE ds_pims_ae_attendances.arrived_dttm BETWEEN '2019-07-11 07:03:30.000' AND '2023-04-04 00:00:00.000'
        name: V_ALCOHOL_ASSESSMENT_IPM_V
        noLinkRefs: []
  name: V_ALCOHOL_ASSESSMENT_IPM_V
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
