fileVersion: 1
id: b5931805-1e20-4363-b481-b439c2b36fd5
name: STAGESALESMERGE_ADDKEYS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3fb8610b-2ad6-49f8-a28c-1e3827638b0f
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: TRANSACTIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ae8a6888-11dd-444f-afba-59a9d404f8c9
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4bcf600e-bf05-4691-84c0-917b62d6797f
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.ORGANIZATIONID=ORGANIZATION.ORGANIZATIONID
        name: ORGANIZATIONKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d15e18b9-06b3-45ff-b242-8e7c7acb4293
                stepCounter: 0644b228-7403-43ca-a822-f63339fb237d
            transform: COALESCE(ORGANIZATION.ORGANIZATIONKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: afeb0c99-7d85-4ed6-96ca-25e29aefe7dc
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9667aaba-23fe-43c6-988c-218403e23d7d
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6577a9b-2e4a-4e95-ac49-9ff6a0b0a3ce
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.REPORTINGCUSTOMERID=ACCOUNT.FORCEID
        name: ACCOUNTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd325e05-7e18-499b-bd60-b3144ec04cb9
                stepCounter: e6f00723-a598-4272-b25a-ed544e4c0a06
            transform: COALESCE(ACCOUNT.ACCOUNTKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ca82fcb-1c7e-4040-9486-2390ee2cf676
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.REPORTINGCUSTOMERID=ACCOUNTGEOGRAPHY.FORCEID
        name: ACCOUNTGEOGRAPHYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fef9b59a-8fa9-4df6-a053-bc0b149168ed
                stepCounter: cccddd9c-726e-4888-9ddd-07f2bfcbaf77
            transform: COALESCE(ACCOUNTGEOGRAPHY.ACCOUNTGEOGRAPHYKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a01f3d3-fbda-41e5-bca5-1e59169c961f
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.REPORTINGCUSTOMERID=ACCOUNTHIERARCHY_OMNIA.FORCEID
        name: ACCOUNTHIERARCHYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ed9a5de-dd5f-4316-a4a8-ef6b7e974988
                stepCounter: 432f7eda-e005-4735-9abf-206604a22a08
            transform: COALESCE(ACCOUNTHIERARCHY_OMNIA.ACCOUNTHIERARCHYKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9bc20e5a-930a-4998-ac1d-d50bd49dcd73
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "STAGESALESMERGE_ADDKEYS.ACCOUNTID=REVENUEBUDGETFORCEIDDETAIL.FORCEID\nSTAGESALESMERGE_ADDKEYS.RECEIPTDATEFORBUDGET=REVENUEBUDGETFORCEIDDETAIL.BUDGETDATE"
        name: REVENUEBUDGETFORCEIDDETAILKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b379099e-bdf9-4957-bcc2-af634373e161
                stepCounter: 6195cda7-4db7-4a34-9d2f-03070a085c70
            transform: COALESCE(REVENUEBUDGETFORCEIDDETAIL.REVENUEBUDGETFORCEIDDETAILKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71f2f3ea-0949-44a3-8ec1-f380791f6730
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "STAGESALESMERGE_ADDKEYS.ACCOUNTID=REVENUEBUDGETFORCEIDDIRECTDETAIL.FORCEID\nSTAGESALESMERGE_ADDKEYS.RECEIPTDATEFORBUDGET=REVENUEBUDGETFORCEIDDIRECTDETAIL.BUDGETDATE"
        name: REVENUEBUDGETFORCEIDDIRECTDETAILKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 13c7244c-4904-4ebb-885c-efce4d5869eb
                stepCounter: 18bdbcbb-0df6-4e14-9391-f8b578a438e4
            transform: COALESCE(REVENUEBUDGETFORCEIDDIRECTDETAIL.REVENUEBUDGETFORCEIDDIRECTDETAILKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f05ab22f-922e-4d17-980d-d115b47819d7
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "STAGESALESMERGE_ADDKEYS.CONTRACTID=REVENUEBUDGETPDDETAIL.CONTRACTID\nSTAGESALESMERGE_ADDKEYS.RECEIPTDATEFORBUDGET=REVENUEBUDGETPDDETAIL.BUDGETDATE"
        name: REVENUEBUDGETPDDETAILKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 430bed21-0ded-4548-8d03-f3b6c16fc20a
                stepCounter: 55f18cd1-9f6a-42a7-a82f-6abdf143b35a
            transform: COALESCE(REVENUEBUDGETPDDETAIL.REVENUEBUDGETPDDETAILKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ee55d54-ffa9-437e-9b71-d0eb4e3d588f
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORIGINAL_CUSTOMER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d6aa137-6c53-486b-b6ba-ee30a4fe0893
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4556bb1b-eeda-488a-a9d8-d88a83b4d149
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORIGINAL_CUSTOMER_ADDRESS_STREET_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d00780c-bb49-4717-9017-5aded4b78a68
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7fcdcfa-ec01-4396-9649-9493b9001f15
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORIGINAL_CUSTOMER_ADDRESS_STREET_2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e504c445-72a1-4db0-a8c4-a59bb77447f5
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a780f564-d2f4-4cce-ab05-69f4535490fa
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORIGINAL_CUSTOMER_ADDRESS_CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb6d5441-f504-4674-a3a0-f80191586a2d
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4847ae4-9d6c-41ac-a295-497b61c730f5
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORIGINAL_CUSTOMER_ADDRESS_STATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 309bc758-6868-4202-a95b-96aeca8ecaf8
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d237b7e-d952-4f97-956a-5da09e0a4554
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORIGINAL_CUSTOMER_ADDRESS_POSTAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b3168726-491c-428c-887c-0b3cf19de6e0
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 899c0394-bcfa-4383-bf3b-65a012dd6a7f
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: INT
        defaultValue: ""
        description: UNIQUE IDENTIFIER FOR AN ACCOUNT. COMMONLY CALLED THE "FORCE ID"
        name: ACCOUNTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e6c0c147-65a1-4a42-b20d-6fc8fef98fcc
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6d971ef-05bf-4a9b-a884-eaeb4a2cea93
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: REGISTRATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 798d0468-39ba-4765-9ef2-f7de12547118
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 65727134-c2e4-43a9-a8da-8cc266d38a83
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: REPORTINGCUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 54d6e34e-e0e1-438c-8a3d-c8a3bce8c6b6
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de9373ff-44cd-48bc-ab3d-2ff737bfe879
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.SUPPLIERID=SUPPLIER.SUPPLIERID
        name: SUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 29f4e3f6-d1f4-4347-909f-18969301d6f1
                stepCounter: f82e9572-e5ea-45e1-991d-83ad35997403
            transform: COALESCE(SUPPLIER.SUPPLIERKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f662bc6-a79d-4d18-acf0-22d5d997cb1f
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SOURCEENTITYNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f6bf04b-62bd-4173-b272-a52ad5c61f4d
                stepCounter: 59cadb79-2e03-4a1c-9c6e-7e6588e89674
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc276885-ad66-4b0d-922a-a5c70bc22fbb
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.CONTRACTID=CONTRACT.CONTRACTSALESFORCEID
        name: CONTRACTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9eecd6c8-6720-4938-83f9-9ebbd7c72ec7
                stepCounter: 59cadb79-2e03-4a1c-9c6e-7e6588e89674
            transform: COALESCE(CONTRACT.CONTRACTKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53b7eed9-6083-4a68-91dc-887644e3894a
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: REVENUE TYPE (MOSTLY USED AS INPUT TO PREPARE NEXT YEAR'S BUDGET)
        name: REVENUETYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE--UC
              \N --WHEN BUYER=UC AND PPA=UC, THEN "SOLICITATION"
              \N WHEN ACCOUNTHIERARCHY_OMNIA.LEVEL1FORCEID IN(4052007,4052114,4052124,4052141,4052148,4052176,4052197,4052232,4052381,4055673,4057670) \N
                 AND ZEROIFNULL(CONTRACT.PPA_LEVEL_1_FORCEID) IN(4055673) \N THEN 'UC SOLICITATION' \N --WHEN BUYER=UC AND PPA<>UC, THEN "ADOPTION"
              \N WHEN ACCOUNTHIERARCHY_OMNIA.LEVEL1FORCEID IN(4052007,4052114,4052124,4052141,4052148,4052176,4052197,4052232,4052381,4055673,4057670) \N
                 AND ZEROIFNULL(CONTRACT.PPA_LEVEL_1_FORCEID) NOT IN(4055673) \N THEN 'UC ADOPTION' \N --WHEN BUYER<>UC AND PPA=UC, THEN "SYNDICATION"
              \N WHEN ACCOUNTHIERARCHY_OMNIA.LEVEL1FORCEID NOT IN(4052007,4052114,4052124,4052141,4052148,4052176,4052197,4052232,4052381,4055673,4057670) \N
                 AND ZEROIFNULL(CONTRACT.PPA_LEVEL_1_FORCEID) IN(4055673) \N THEN 'UC SYNDICATION' \N --
              \N ELSE \N CASE \N
                          WHEN SALESTERRITORY.TERRITORYGROUPNAME LIKE '%ISO%PUBLIC%'  THEN 'ISO PUBLIC' \N
                          WHEN SALESTERRITORY.TERRITORYGROUPNAME LIKE '%ISO%PRIVATE%' THEN 'ISO PRIVATE' \N
                          ELSE SALESTERRITORY.TERRITORYDIVISIONNAME \N
                           END \NEND
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 859ff2fc-0d6e-4f03-8a8a-57cfbb7d455a
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CONTRACTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8a508537-7cf0-4e1b-96be-0a269a56d848
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 56615b5a-81ff-4012-b1b5-c35e2fe79d9b
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: INT
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.RECEIPTDATE=DIMRECEIPTDATE.RECEIPTDATE
        name: RECEIPTDATEKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d04527ab-2002-461f-bf85-b55b865b1645
                stepCounter: 51cbcfa2-a7ad-4741-a911-b641fa22bffb
            transform: COALESCE(DIMRECEIPTDATE.RECEIPTDATEKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9803cd3d-28ae-4129-8b9b-f1212d5eda4f
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: RECEIPTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef8716eb-773a-460f-a6d2-94be3b4616e3
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d840da99-078c-441d-aae1-dd2c9b32a0f4
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: DATE
        defaultValue: ""
        description: GENERATE RECEIPT DATE FOR NEW 2019 BUDGET COMPARISON
        name: RECEIPTDATEFORBUDGET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 35f24fcf-5210-4861-8464-d4b99399497e
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ac2f2a5-19b3-4621-907d-30a9f00b2f26
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: INT
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.TRANSACTIONDATE=DIMTRANSACTIONDATE.TRANSACTIONDATE
        name: TRANSACTIONDATEKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 45f6717b-4c95-4512-8089-77ccef5c106c
                stepCounter: b43141ad-1f70-41dc-81ac-ec349cfdff08
            transform: COALESCE(DIMTRANSACTIONDATE.TRANSACTIONDATEKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e907424-8911-4f26-8560-9982eddcf6cf
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: TRANSACTIONDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 388bc4c1-f208-49d1-9506-6d20ac7c2c25
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 242a6cec-f8fa-4006-b370-ccf473c0a443
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ""
        name: UNITSSOLD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f6872ac3-b9f1-48e6-8dd7-e90bfaa46bc7
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0709194b-9fb1-4585-91a8-6fa00b100662
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ""
        name: PRICEPERUNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9d39013-8f46-4a23-bd4b-a720be32a65a
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8adc96a-1c4b-4a42-b528-d08abd768ef7
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ""
        name: SALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0915027e-45e2-48db-81da-040038973a08
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21f3cb22-2a82-4ef4-b8dc-3add63278645
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ""
        name: REVENUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b361b345-7aa1-45d2-9c36-4562f118c8c9
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9106ad06-5f5c-4fdf-b71f-3a3bee781cb4
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.TERRITORYID=SALESTERRITORY.TERRITORYID
        name: SALESTERRITORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a8dae22-dff8-47cf-b410-ceb4849b5d80
                stepCounter: c9c1b4f5-72b4-4490-8a2c-b2d068089b12
            transform: COALESCE(SALESTERRITORY.SALESTERRITORYKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5aac54d7-ff88-4bba-87da-b16c2bbc3ac8
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.TERRITORYIDFINANCIAL=FINANCIALSALESTERRITORY.FINANCIALTERRITORYID
        name: FINANCIALSALESTERRITORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9f3f5ee0-430d-41f4-ab4e-a00b8a7d5def
                stepCounter: 30afc909-3b40-40ba-9700-0223401193fc
            transform: COALESCE(FINANCIALSALESTERRITORY.FINANCIALSALESTERRITORYKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e78fd96-3f8d-4675-899e-50972ec776c8
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.TERRITORYIDDIRECT=DIRECTSALESTERRITORY.TERRITORYID
        name: DIRECTSALESTERRITORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23a04fdf-e448-4d48-83b4-e3d53fd82903
                stepCounter: 22676711-1077-42e5-9a74-cdb22a75cd7b
            transform: COALESCE(DIRECTSALESTERRITORY.DIRECTSALESTERRITORYKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 751dbfb0-684e-46fd-8c7b-64748462c00c
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: COMPANYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8da428f-589b-41be-bd34-4fb3e1f174d2
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7e2e4bf-98f4-4d6c-9787-57edde4afed7
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: INT
        defaultValue: ""
        description: ORIGINAL FORCEID (ID) OF THE CUSTOMER TRANSACTION.
        name: ORIGINALCUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60ae2581-6555-4be3-a8a6-60d404cf88d7
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ea5c40f-4ef1-4baa-80ef-66203e33b5c2
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LOFFICEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef97ef99-9e79-467b-984c-2c8cd6bf7dd0
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6cdd0849-0538-47a3-858e-231b25d7efb9
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: LOFFICENAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ade08e70-6d3b-4650-8179-eb84673ce816
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e81decf8-532d-4b6b-a973-40122375c3fd
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: INT
        defaultValue: ""
        description: VIZIENT SYSTEM IDENTIFIER
        name: SYSTEMID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91b7c652-7e1d-44a4-a9c8-f7495cc5fd05
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7158b198-0105-401c-b7e0-6dbcd3a15005
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        name: CONTRACTREBATEDETAILSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8d7f7787-8199-4ead-8721-03c66d55815c
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95f116aa-1189-43c2-9b7c-96dc436e592c
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        name: TRANSACTIONCLASSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0aba31da-812d-4821-a149-3c8dd79ea5f7
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48d51d8f-eb3e-40aa-b27e-11e72c2aff08
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.TRANSACTIONCLASSID=TRANSACTIONCLASS.TRANSACTIONCLASSID
        name: TRANSACTIONCLASSKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ca738427-f784-4596-958f-8c78445cea56
                stepCounter: da075f82-eba6-40af-b085-2422ba954e36
            transform: COALESCE(TRANSACTIONCLASS.TRANSACTIONCLASSKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e0398a0-c6d9-4863-99a6-1a73b8049c5d
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: MAXRECEIPTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: TO_DATE('$MAXRECEIPTDATE')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8933a305-bd6f-49c7-83f8-06a2b798e3e6
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        name: ____END_COMMON_COLUMNS____
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9210d0ef-ae69-466a-bbc6-492ffb13f5cc
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f3a9fcc-5bc9-4699-852a-739a2cebf75b
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3ea832b-df32-4696-9196-4b08cd77c826
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a20afc82-685c-46fb-aa35-6e1314dd138c
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 982716e4-4613-4e84-ab53-fd9ef3156c18
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39df2777-6191-4d2a-8e95-4bf6d83172b6
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SUPPLIERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 57bbc7da-5e17-42a9-8ec5-9a2317a09e21
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27ec04ce-58bf-4295-9e4f-34041e2c5d1d
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TERRITORYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2552462a-a874-435b-8e73-373ed9ebeff7
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d39cc2ab-a9f3-47a7-9238-63c14d499c7c
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TERRITORYIDFINANCIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1011e32-bc40-4574-a07c-957828453840
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5862d813-2556-4cf1-a196-63993f1c8596
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TERRITORYIDDIRECT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d81710ad-ef7a-4e19-8592-9c5c492616a6
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 804d34a3-baed-4ba9-9b63-6bf539f1e24f
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SALESUNITOFMEASURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 46542a86-ea28-454a-8dff-107b34d4c032
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e12d510-dc5f-4683-b086-c15748a21f56
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: TRANSACTIONNOTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 245f8dbb-bb85-463d-8146-6d814c0d53c0
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f5f18bd-1d08-4e65-8272-d57367e8ae9e
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        name: CHANNELPARTNERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 332a9ffe-2f74-406d-b3d9-01dab3afa588
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 139eb373-47a9-466c-87b3-2d5dd3c0fdc0
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: CHANGE THE SOURCE OF CHANNELPARTNERFEESHAREPARTNERID TO ACCOUNTHIERARCHY INSTEAD OF FROM SALESREPORTINGLINEITEMS(FORCESALES)
        name: CHANNELPARTNERFEESHAREPARTNERID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 86f7bd2d-8b63-49ca-967c-3a95b1e9ca3c
                stepCounter: 432f7eda-e005-4735-9abf-206604a22a08
            transform: COALESCE(ACCOUNTHIERARCHY_OMNIA.CHANNELPARTNERFEESHAREPARTNERID,STAGESALESMERGE_BIZXFORMS.CHANNELPARTNERFEESHAREPARTNERID,1)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7d744d5-c2cf-40b1-bcf4-56730e79e908
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: DECIMAL(38)
        defaultValue: ""
        description: ""
        name: CHANNELPARTNERLEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 12036154-1366-4be4-9100-893248b891b0
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da4421fc-54c2-4817-a5e7-ee6c8562de10
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        name: CONTRACTEXTERNALCATEGORYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 73e6d822-826d-4ac4-874c-f25cde828b5b
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87110c8b-9efe-4ff5-bb32-3a6050819dde
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: CUSTOMERIDFROMEXTERNALSYSTEM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3d8768bc-1103-4c1b-bb37-7693c41668a0
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15b1acb9-3a60-475a-8f42-cff5c78364a7
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CUSTOMERLEVEL1IDFROMEXTERNALSYSTEM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: baaa23e3-7e60-4458-b674-af29c3fe3c15
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11469d47-5247-4397-8eb4-7978363b8d09
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ALLIANCE_NAME_PREMIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e6c37c9-b53f-4f36-b9db-4278e16a2006
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ee9dd03-b64d-4a90-b070-7654b19df960
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        name: ____END_APPENDED_BIZ_KEY_COLUMNS____
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9f6670d9-dc2e-426f-9a19-309a7195a10a
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ccd268a9-6dd8-44f9-93d5-92281616c862
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ARTIFICIAL KEY FOR THE DSS SOURCE SYSTEM TABLE.
        isSurrogateKey: true
        name: DSS_SOURCE_SYSTEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa9bdd5a-3cc6-411b-8e29-a575c5cfb794
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: IFF(STAGESALESMERGE_BIZXFORMS.DSS_SOURCE_SYSTEM_KEY IS NULL,3,STAGESALESMERGE_BIZXFORMS.DSS_SOURCE_SYSTEM_KEY)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8c0b173-b04d-4da6-a495-e463ae5424e6
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47264fc3-9d6a-4451-9bc7-0edd8ea7b49a
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ef3081c-3718-40ff-b79e-2a06cf66d7b5
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d66f8aab-5519-49ae-b7ce-49d947f969ba
                stepCounter: 5bd1d15a-08f1-4521-b984-121d894196ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1857df24-093b-4f37-8075-b416929ce1b9
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64009a18-1586-45bf-bc86-6cc73f46b8a3
          stepCounter: b5931805-1e20-4363-b481-b439c2b36fd5
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGESALESMERGE_BIZXFORMS: 5bd1d15a-08f1-4521-b984-121d894196ff
          CONTRACT: 59cadb79-2e03-4a1c-9c6e-7e6588e89674
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: DIM
            nodeName: ACCOUNTGEOGRAPHY
          - locationName: DIM
            nodeName: ACCOUNTHIERARCHY_OMNIA
          - locationName: DIM
            nodeName: CONTRACT
          - locationName: DIM
            nodeName: DIMRECEIPTDATE
          - locationName: DIM
            nodeName: DIMTRANSACTIONDATE
          - locationName: DIM
            nodeName: DIRECTSALESTERRITORY
          - locationName: DIM
            nodeName: FINANCIALSALESTERRITORY
          - locationName: DIM
            nodeName: ORGANIZATION
          - locationName: DIM
            nodeName: REVENUEBUDGETFORCEIDDETAIL
          - locationName: DIM
            nodeName: REVENUEBUDGETFORCEIDDIRECTDETAIL
          - locationName: DIM
            nodeName: REVENUEBUDGETPDDETAIL
          - locationName: DIM
            nodeName: SALESTERRITORY
          - locationName: DIM
            nodeName: SUPPLIER
          - locationName: DIM
            nodeName: TRANSACTIONCLASS
          - locationName: STAGE
            nodeName: STAGESALESMERGE_BIZXFORMS
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','STAGESALESMERGE_BIZXFORMS') }} STAGESALESMERGE_BIZXFORMS
              LEFT JOIN {{ ref('DIM','CONTRACT') }} CONTRACT
                ON STAGESALESMERGE_BIZXFORMS.CONTRACTID = CONTRACT.CONTRACTID
               AND STAGESALESMERGE_BIZXFORMS.DSS_SOURCE_SYSTEM_KEY = CONTRACT.DSS_SOURCE_SYSTEM_KEY
        name: STAGESALESMERGE_ADDKEYS
        noLinkRefs: []
  name: STAGESALESMERGE_ADDKEYS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
