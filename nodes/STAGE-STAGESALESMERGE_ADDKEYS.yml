fileVersion: 1
id: 99992c2a-68ed-4557-81a1-4fda90feb25b
name: STAGESALESMERGE_ADDKEYS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee55f069-c5e3-48bf-9f17-fc703c4be184
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: TRANSACTIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2f14b51-4290-4a44-805f-87393ac10c0a
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a5dcd26-97ef-4506-9705-a8cf27a7148c
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.ORGANIZATIONID=ORGANIZATION.ORGANIZATIONID
        name: ORGANIZATIONKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a93740d0-6488-4cd4-8c2d-ae278ae82dae
                stepCounter: 8f190da7-2e2a-497e-b6b0-39c6a3ec1e0d
            transform: COALESCE(ORGANIZATION.ORGANIZATIONKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0dd3bbbe-4c80-463b-a19f-f1abbf343696
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 32ed6cca-d834-489f-9776-d5a4b5038035
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6600873-d574-4d58-a3c0-cb67fd9dc511
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.REPORTINGCUSTOMERID=ACCOUNT.FORCEID
        name: ACCOUNTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51242f2b-12a0-45ea-bdfb-000fdb4c550a
                stepCounter: 96e8695b-6733-4729-8797-91b12c74cb7e
            transform: COALESCE(ACCOUNT.ACCOUNTKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50a63da0-197c-4f13-ba4d-c40fadb410b5
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.REPORTINGCUSTOMERID=ACCOUNTGEOGRAPHY.FORCEID
        name: ACCOUNTGEOGRAPHYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fccef316-33d4-40c3-9857-f6d11d63b5d5
                stepCounter: e6436d6c-8c3d-4c35-bfe2-34ff054091f6
            transform: COALESCE(ACCOUNTGEOGRAPHY.ACCOUNTGEOGRAPHYKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32fc109e-603a-4cc1-bd1c-8165e5453381
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.REPORTINGCUSTOMERID=ACCOUNTHIERARCHY_OMNIA.FORCEID
        name: ACCOUNTHIERARCHYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 331b26cc-764d-40a8-8a0e-a6f4338ca8a3
                stepCounter: e17871d0-4fd7-49e8-a78c-cc7b8803262a
            transform: COALESCE(ACCOUNTHIERARCHY_OMNIA.ACCOUNTHIERARCHYKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b5ae1bf5-68ba-4b8a-8b82-f12ed1178ed8
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "STAGESALESMERGE_ADDKEYS.ACCOUNTID=REVENUEBUDGETFORCEIDDETAIL.FORCEID\nSTAGESALESMERGE_ADDKEYS.RECEIPTDATEFORBUDGET=REVENUEBUDGETFORCEIDDETAIL.BUDGETDATE"
        name: REVENUEBUDGETFORCEIDDETAILKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: abc61982-7e7d-4ee8-9c2c-df8c8cca288e
                stepCounter: 40b2c14b-0340-44d3-8c71-1549e9d4b545
            transform: COALESCE(REVENUEBUDGETFORCEIDDETAIL.REVENUEBUDGETFORCEIDDETAILKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 485a48a7-e170-4698-979f-d29ed0fc20f0
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "STAGESALESMERGE_ADDKEYS.ACCOUNTID=REVENUEBUDGETFORCEIDDIRECTDETAIL.FORCEID\nSTAGESALESMERGE_ADDKEYS.RECEIPTDATEFORBUDGET=REVENUEBUDGETFORCEIDDIRECTDETAIL.BUDGETDATE"
        name: REVENUEBUDGETFORCEIDDIRECTDETAILKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 57166972-81b8-4c05-b435-f6e8d01f6bcb
                stepCounter: ae372581-75d1-4ba0-a93b-0df14fef6e7d
            transform: COALESCE(REVENUEBUDGETFORCEIDDIRECTDETAIL.REVENUEBUDGETFORCEIDDIRECTDETAILKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eaf1416e-0027-4a41-8d96-d96217283e06
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "STAGESALESMERGE_ADDKEYS.CONTRACTID=REVENUEBUDGETPDDETAIL.CONTRACTID\nSTAGESALESMERGE_ADDKEYS.RECEIPTDATEFORBUDGET=REVENUEBUDGETPDDETAIL.BUDGETDATE"
        name: REVENUEBUDGETPDDETAILKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ccce9a1b-ca1b-4dc0-8395-cfb3979a73dc
                stepCounter: a53b478d-2efa-4b09-b9a0-df8abd07ae28
            transform: COALESCE(REVENUEBUDGETPDDETAIL.REVENUEBUDGETPDDETAILKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42857428-136c-4019-939c-1ba68e8c689f
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORIGINAL_CUSTOMER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 14457468-c54e-4fd5-977a-3b0af84e16e4
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c25acd9e-10b8-4a7e-a5cb-e28ee67a846f
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORIGINAL_CUSTOMER_ADDRESS_STREET_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c74e6e7-68be-4b08-a9ee-c50237b0b58f
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: abcc4e75-7fa1-42a2-bdd0-8ee6d263a55d
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORIGINAL_CUSTOMER_ADDRESS_STREET_2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 35973fe7-4e0b-49dc-a3c9-974a182a435b
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c410eac-060f-4230-98ea-ad3ef5e6d50b
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORIGINAL_CUSTOMER_ADDRESS_CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1090429e-dc42-4a03-b0fb-5892abed068b
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a678226b-5957-4fdf-bf9f-13eb18d1aab7
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORIGINAL_CUSTOMER_ADDRESS_STATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f336c207-6a80-4266-a530-6b58c71e54ff
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ef70d2b-2384-45a8-8d8c-596713e21df7
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORIGINAL_CUSTOMER_ADDRESS_POSTAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2b52fd3-2cb7-4d45-b1a5-13937fff4b2f
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 85e70593-a62e-4096-ad4b-2313c98862dd
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: INT
        defaultValue: ""
        description: UNIQUE IDENTIFIER FOR AN ACCOUNT. COMMONLY CALLED THE "FORCE ID"
        name: ACCOUNTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: be775510-e078-48cb-b232-0c97cad1ae7c
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 439b061a-c4c5-446d-ab0a-24797ffef4af
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: REGISTRATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddf8f590-5ba4-450f-8a88-101732fd53c1
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50a8ddbf-0819-4c48-b7f0-50a4c4f94ab3
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: REPORTINGCUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d1a49b4-86c5-497d-9776-f258a1aa981b
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72eeeda7-ccb3-4e4d-9319-c0f5387eec32
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.SUPPLIERID=SUPPLIER.SUPPLIERID
        name: SUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8af74fd2-6685-417f-ba69-54e34a59747a
                stepCounter: 46ab7310-f206-4d38-93fc-0dcfb497301d
            transform: COALESCE(SUPPLIER.SUPPLIERKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1dc4745-4257-4732-9315-44ffc236bf34
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SOURCEENTITYNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c22df81-de68-445f-b0e9-f2dbcbe9e2ae
                stepCounter: 930a330f-3276-4f21-bd05-9ed55fd63528
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c78e55eb-d652-455d-8238-ea4e75fbc78b
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.CONTRACTID=CONTRACT.CONTRACTSALESFORCEID
        name: CONTRACTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 012a8445-b992-4874-a802-ad1b6196a28d
                stepCounter: 930a330f-3276-4f21-bd05-9ed55fd63528
            transform: COALESCE(CONTRACT.CONTRACTKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5c383f8-7202-400a-b8ec-b34a97e88835
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: REVENUE TYPE (MOSTLY USED AS INPUT TO PREPARE NEXT YEAR'S BUDGET)
        name: REVENUETYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE--UC
              \N --WHEN BUYER=UC AND PPA=UC, THEN "SOLICITATION"
              \N WHEN ACCOUNTHIERARCHY_OMNIA.LEVEL1FORCEID IN(4052007,4052114,4052124,4052141,4052148,4052176,4052197,4052232,4052381,4055673,4057670) \N
                 AND ZEROIFNULL(CONTRACT.PPA_LEVEL_1_FORCEID) IN(4055673) \N THEN 'UC SOLICITATION' \N --WHEN BUYER=UC AND PPA<>UC, THEN "ADOPTION"
              \N WHEN ACCOUNTHIERARCHY_OMNIA.LEVEL1FORCEID IN(4052007,4052114,4052124,4052141,4052148,4052176,4052197,4052232,4052381,4055673,4057670) \N
                 AND ZEROIFNULL(CONTRACT.PPA_LEVEL_1_FORCEID) NOT IN(4055673) \N THEN 'UC ADOPTION' \N --WHEN BUYER<>UC AND PPA=UC, THEN "SYNDICATION"
              \N WHEN ACCOUNTHIERARCHY_OMNIA.LEVEL1FORCEID NOT IN(4052007,4052114,4052124,4052141,4052148,4052176,4052197,4052232,4052381,4055673,4057670) \N
                 AND ZEROIFNULL(CONTRACT.PPA_LEVEL_1_FORCEID) IN(4055673) \N THEN 'UC SYNDICATION' \N --
              \N ELSE \N CASE \N
                          WHEN SALESTERRITORY.TERRITORYGROUPNAME LIKE '%ISO%PUBLIC%'  THEN 'ISO PUBLIC' \N
                          WHEN SALESTERRITORY.TERRITORYGROUPNAME LIKE '%ISO%PRIVATE%' THEN 'ISO PRIVATE' \N
                          ELSE SALESTERRITORY.TERRITORYDIVISIONNAME \N
                           END \NEND
      - appliedColumnTests: {}
        columnReference:
          columnCounter: afa7a2fb-8c12-4817-acc1-02f07a0615dd
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CONTRACTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d46c53ac-d2b2-4690-98ef-8fadb5d7e435
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 069b6979-1bf8-4e34-ad73-86648764ac13
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: INT
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.RECEIPTDATE=DIMRECEIPTDATE.RECEIPTDATE
        name: RECEIPTDATEKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 669f1519-5f9d-464b-b967-3b919f5eb259
                stepCounter: d13b3440-8bde-40ca-9ad7-7d0a6431e115
            transform: COALESCE(DIMRECEIPTDATE.RECEIPTDATEKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f3cd391-0a4c-485d-993f-c2b77b9738ad
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: RECEIPTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f688a87-bc96-4c66-8271-0a3595bdd30e
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2baf708a-ab9d-4922-8486-37fd350f92f9
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: DATE
        defaultValue: ""
        description: GENERATE RECEIPT DATE FOR NEW 2019 BUDGET COMPARISON
        name: RECEIPTDATEFORBUDGET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 094b5a6e-6dce-4b9a-be86-4e13088bb66a
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a9d1f75-3c8a-4c62-8242-0798e29f9ff5
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: INT
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.TRANSACTIONDATE=DIMTRANSACTIONDATE.TRANSACTIONDATE
        name: TRANSACTIONDATEKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 293bd495-4ce6-4d0f-8596-c5d75fc6eda2
                stepCounter: f559ddb9-6dc3-4412-9aa2-81bbce93de47
            transform: COALESCE(DIMTRANSACTIONDATE.TRANSACTIONDATEKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 398ad4a0-eb78-462e-8ec7-6c3456b7bacb
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: TRANSACTIONDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 57c0b832-62e5-48fa-8546-920d2a0d2e2e
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71334edf-ea99-4006-b8fe-bd61f191bb1b
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ""
        name: UNITSSOLD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eb4e8121-d43d-4de0-b197-c1bdbca64ea3
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 63625e05-04ef-4835-a7cb-4c1772df39ef
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ""
        name: PRICEPERUNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cc80a1db-ce60-40b6-88e8-4066871e66ec
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7726dfae-44ee-4fbd-a03d-821c0ed813ad
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ""
        name: SALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d1337d00-50e6-4042-98ad-f09f98ae8cde
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7c9c156-b6df-47a1-ad57-0a7965dfbe1d
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ""
        name: REVENUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a72389a4-3489-452c-85f6-5b50417ccf09
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01610a35-90ee-4909-a43a-61327990567d
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.TERRITORYID=SALESTERRITORY.TERRITORYID
        name: SALESTERRITORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f15d9bd7-501a-4875-b2da-dd3887c0d861
                stepCounter: 6c05c91f-a46a-4beb-bed8-0ba46d8c9735
            transform: COALESCE(SALESTERRITORY.SALESTERRITORYKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09f3aed3-cc84-437e-8b7c-3cd1606d40b8
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.TERRITORYIDFINANCIAL=FINANCIALSALESTERRITORY.FINANCIALTERRITORYID
        name: FINANCIALSALESTERRITORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9dbca23d-ba16-4307-8d98-1f9dfac2dae4
                stepCounter: 6d779fbd-6583-4cb4-8f8b-a242e66b0139
            transform: COALESCE(FINANCIALSALESTERRITORY.FINANCIALSALESTERRITORYKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 28120b89-89ed-4c22-93c3-c35d0f64d99f
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.TERRITORYIDDIRECT=DIRECTSALESTERRITORY.TERRITORYID
        name: DIRECTSALESTERRITORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f87baad-83f6-4777-b347-81f162da22e5
                stepCounter: c0caa751-663b-4b5f-9a00-8e256d5d8470
            transform: COALESCE(DIRECTSALESTERRITORY.DIRECTSALESTERRITORYKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 895cbcc8-987a-42e7-b9c2-52dd3f40a185
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: COMPANYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 57136c63-3e78-4a45-bbd7-4fb3791608f8
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a70f9f35-684e-4ac6-ab85-ecd9ed17ba4c
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: INT
        defaultValue: ""
        description: ORIGINAL FORCEID (ID) OF THE CUSTOMER TRANSACTION.
        name: ORIGINALCUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cab8df69-aea4-40b4-87fd-1db9be5f258a
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80db4376-cd1f-41ed-8e4f-bab3dd8ebbb2
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LOFFICEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3abd676b-8ed1-4dbf-9d7e-889cc2810623
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0f0c1b9-3f04-48c5-b89a-87bff65d7fb9
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: LOFFICENAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b81dabc9-0cd7-4468-9a1f-e5c94e8fd384
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d46c08fc-6418-4c6e-908c-96e581f82e5b
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: INT
        defaultValue: ""
        description: VIZIENT SYSTEM IDENTIFIER
        name: SYSTEMID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 46196868-ea6f-4c04-a086-1795670174b5
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a7c441c-5920-4d4a-a2ad-a3900905e6df
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        name: CONTRACTREBATEDETAILSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 61dbbab9-c72a-4e7d-992d-7e84b53491bb
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e59becfb-f697-46ab-bf01-5f2ee5345831
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        name: TRANSACTIONCLASSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 66f11d39-133f-477b-8928-524531c8740d
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf679cd7-e013-4449-8c01-bed554e9f26a
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.TRANSACTIONCLASSID=TRANSACTIONCLASS.TRANSACTIONCLASSID
        name: TRANSACTIONCLASSKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 93c15466-3dc0-4809-b93a-bef3e9a1b726
                stepCounter: 3308f276-240e-4973-8050-5669c81f5e96
            transform: COALESCE(TRANSACTIONCLASS.TRANSACTIONCLASSKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8826c923-eb33-4887-aae6-ceb330891ceb
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: MAXRECEIPTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: TO_DATE('$MAXRECEIPTDATE')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29af1650-a665-4780-b74f-54a83c2e6de4
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        name: ____END_COMMON_COLUMNS____
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 336049e0-a6ea-439c-b26c-e894df6bcc8d
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86776cde-348e-4a47-8b3f-2150f1750fbc
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b331bda-5516-4a2a-a5a7-d49c243847d5
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18c0b7ff-aa7f-4f24-bd38-54bf9d627212
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f9b61858-8ef2-445b-87e0-b9f0cc1464ff
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 136877e8-3fb9-4249-97b8-9e7987bd88be
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SUPPLIERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ec3b07b-9ea1-4579-b9fc-7250d0c0de8e
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d522068-c8a0-4047-8bce-744b69783e3e
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TERRITORYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 126af632-9f69-40ec-a0da-36690d9ae41d
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa321555-ee1b-4bdb-80ce-90b042cc5a32
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TERRITORYIDFINANCIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4104649f-60df-4f1e-8f14-e6d78b53f5a2
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c5a288c-6089-4134-a740-051c313f8077
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TERRITORYIDDIRECT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ef764ee-c844-4c73-8314-ba40bfe83cb6
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 517b7eda-c7af-4a36-a899-90777e566687
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SALESUNITOFMEASURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2f65d15b-cbcb-4621-888b-106a0959d656
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4766c348-1d3f-4c20-9a6e-dc491b2e87cb
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: TRANSACTIONNOTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c231378-8635-4d28-b560-39717a7a9b92
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6cd7f4ac-1dd6-4b2a-ac0b-56a518aa5354
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        name: CHANNELPARTNERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 645bc9c7-284e-4fab-8546-99135ef13499
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 367b405f-62dd-43be-a4a8-2c23fab6b094
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: CHANGE THE SOURCE OF CHANNELPARTNERFEESHAREPARTNERID TO ACCOUNTHIERARCHY INSTEAD OF FROM SALESREPORTINGLINEITEMS(FORCESALES)
        name: CHANNELPARTNERFEESHAREPARTNERID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59eb9feb-cbbf-4ec8-9ab0-6a64a1eb4f21
                stepCounter: e17871d0-4fd7-49e8-a78c-cc7b8803262a
            transform: COALESCE(ACCOUNTHIERARCHY_OMNIA.CHANNELPARTNERFEESHAREPARTNERID,STAGESALESMERGE_BIZXFORMS.CHANNELPARTNERFEESHAREPARTNERID,1)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c7cb73c3-37df-409b-a6b3-97294dbab2b8
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: DECIMAL(38)
        defaultValue: ""
        description: ""
        name: CHANNELPARTNERLEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d09bad22-f0bd-4ea1-bedc-9098fc86110f
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74673c4c-966f-4e5e-acc6-5d8754fb829b
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        name: CONTRACTEXTERNALCATEGORYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 61ac9787-d91b-4bfa-ad6b-a99041b6d920
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c3c45f2-26b1-4ead-85b1-33619b2f0e6b
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: CUSTOMERIDFROMEXTERNALSYSTEM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb59ad21-fe0f-4a25-9665-aa9127d245dc
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ded8c967-2582-454c-9b29-d2fcf2ace0b8
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CUSTOMERLEVEL1IDFROMEXTERNALSYSTEM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 28b852e5-0fdd-40c7-a7f8-d23085d17eb0
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9b005c1-96ed-49a2-b4c7-860a9bce78b5
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ALLIANCE_NAME_PREMIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 679ae997-8949-43d1-96ad-ba29b681158a
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce888bef-c398-4012-9535-645fb9c00e62
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        name: ____END_APPENDED_BIZ_KEY_COLUMNS____
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6fc7d5c8-3728-4283-bf46-07f54f5e0231
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2565509c-894b-41c9-b078-379fd8665c52
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ARTIFICIAL KEY FOR THE DSS SOURCE SYSTEM TABLE.
        isSurrogateKey: true
        name: DSS_SOURCE_SYSTEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a18d3c0-ec87-442a-8fad-f5ec1b9e36a8
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: IFF(STAGESALESMERGE_BIZXFORMS.DSS_SOURCE_SYSTEM_KEY IS NULL,3,STAGESALESMERGE_BIZXFORMS.DSS_SOURCE_SYSTEM_KEY)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02991634-937b-444a-a2a1-8110121e63d7
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8cd091c5-930a-4bb8-b688-5436dd888a96
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a73a1cf7-f44f-4129-8929-6bb664e077af
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1bc30931-53d9-4be3-a6d3-d7e495844f51
                stepCounter: 016dc523-e1ce-4974-8574-a9dd981ba143
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8891982-83d3-43e2-b593-f15a06598461
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b730a35c-c55a-4a92-b251-a18b722463af
          stepCounter: 99992c2a-68ed-4557-81a1-4fda90feb25b
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGESALESMERGE_BIZXFORMS: 016dc523-e1ce-4974-8574-a9dd981ba143
          CONTRACT: 930a330f-3276-4f21-bd05-9ed55fd63528
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: DIM
            nodeName: ACCOUNTGEOGRAPHY
          - locationName: DIM
            nodeName: ACCOUNTHIERARCHY_OMNIA
          - locationName: DIM
            nodeName: CONTRACT
          - locationName: DIM
            nodeName: DIMRECEIPTDATE
          - locationName: DIM
            nodeName: DIMTRANSACTIONDATE
          - locationName: DIM
            nodeName: DIRECTSALESTERRITORY
          - locationName: DIM
            nodeName: FINANCIALSALESTERRITORY
          - locationName: DIM
            nodeName: ORGANIZATION
          - locationName: DIM
            nodeName: REVENUEBUDGETFORCEIDDETAIL
          - locationName: DIM
            nodeName: REVENUEBUDGETFORCEIDDIRECTDETAIL
          - locationName: DIM
            nodeName: REVENUEBUDGETPDDETAIL
          - locationName: DIM
            nodeName: SALESTERRITORY
          - locationName: DIM
            nodeName: SUPPLIER
          - locationName: DIM
            nodeName: TRANSACTIONCLASS
          - locationName: STAGE
            nodeName: STAGESALESMERGE_BIZXFORMS
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','STAGESALESMERGE_BIZXFORMS') }} STAGESALESMERGE_BIZXFORMS
              LEFT JOIN {{ ref('DIM','CONTRACT') }} CONTRACT
                ON STAGESALESMERGE_BIZXFORMS.CONTRACTID = CONTRACT.CONTRACTID
               AND STAGESALESMERGE_BIZXFORMS.DSS_SOURCE_SYSTEM_KEY = CONTRACT.DSS_SOURCE_SYSTEM_KEY
        name: STAGESALESMERGE_ADDKEYS
        noLinkRefs: []
  name: STAGESALESMERGE_ADDKEYS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
