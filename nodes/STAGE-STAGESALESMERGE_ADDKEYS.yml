fileVersion: 1
id: 76df3231-ca9f-4b54-ad10-80eacf7c091a
name: STAGESALESMERGE_ADDKEYS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25846650-8ad0-4262-b285-f64cca9df5a2
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: TRANSACTIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b54a0eb-c42f-46e1-bb37-a66bc6a92945
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 784d0bbf-27db-4299-9ffa-4dc21eef7ee3
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.ORGANIZATIONID=ORGANIZATION.ORGANIZATIONID
        name: ORGANIZATIONKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0e60b4ed-1bb5-4ed6-b177-59779a7c0179
                stepCounter: 2acec7e4-1787-436b-895b-4edfb712800c
            transform: COALESCE(ORGANIZATION.ORGANIZATIONKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 636cdbfc-49c7-48ec-9465-d344e186e51c
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72b35cf4-089e-4892-ac73-64e94c9f05d0
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38e14196-fabd-47ec-96f8-67821b1af493
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.REPORTINGCUSTOMERID=ACCOUNT.FORCEID
        name: ACCOUNTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bae9c318-63c2-4058-8e74-f5509f5b4522
                stepCounter: d5234d5a-eb19-45e2-9c42-47221579f347
            transform: COALESCE(ACCOUNT.ACCOUNTKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dac007c6-f039-4517-9149-905c29ab70c3
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.REPORTINGCUSTOMERID=ACCOUNTGEOGRAPHY.FORCEID
        name: ACCOUNTGEOGRAPHYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0633ea13-94c8-47c0-9ceb-9cb7e38a96b7
                stepCounter: edd2bdaf-5dbd-4108-bb25-d6c33fdbc711
            transform: COALESCE(ACCOUNTGEOGRAPHY.ACCOUNTGEOGRAPHYKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe4b9d7b-29d6-4cc2-896b-3aa961ac2212
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.REPORTINGCUSTOMERID=ACCOUNTHIERARCHY_OMNIA.FORCEID
        name: ACCOUNTHIERARCHYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 74598a90-c6c2-48d6-9ef0-92f5ac3a1124
                stepCounter: e398bc3c-b60d-4b77-8c04-2d1541bc7310
            transform: COALESCE(ACCOUNTHIERARCHY_OMNIA.ACCOUNTHIERARCHYKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f42a1bd6-7667-40ae-847a-7e9415c50190
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "STAGESALESMERGE_ADDKEYS.ACCOUNTID=REVENUEBUDGETFORCEIDDETAIL.FORCEID\nSTAGESALESMERGE_ADDKEYS.RECEIPTDATEFORBUDGET=REVENUEBUDGETFORCEIDDETAIL.BUDGETDATE"
        name: REVENUEBUDGETFORCEIDDETAILKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9b3b9904-1950-4b79-8d79-4f2bf3cc5072
                stepCounter: c27f52b8-860a-4a41-83cf-bac6ab0ac7f8
            transform: COALESCE(REVENUEBUDGETFORCEIDDETAIL.REVENUEBUDGETFORCEIDDETAILKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 953bde16-bb28-43c4-9c0a-e29734ccd008
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "STAGESALESMERGE_ADDKEYS.ACCOUNTID=REVENUEBUDGETFORCEIDDIRECTDETAIL.FORCEID\nSTAGESALESMERGE_ADDKEYS.RECEIPTDATEFORBUDGET=REVENUEBUDGETFORCEIDDIRECTDETAIL.BUDGETDATE"
        name: REVENUEBUDGETFORCEIDDIRECTDETAILKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9f986b60-fc9f-4665-bd7c-5f6bbe44a16b
                stepCounter: c65efad7-8ace-4b4e-8636-860fe3abb6b8
            transform: COALESCE(REVENUEBUDGETFORCEIDDIRECTDETAIL.REVENUEBUDGETFORCEIDDIRECTDETAILKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe9fc30d-a898-4efa-bc8e-8929a7349f93
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "STAGESALESMERGE_ADDKEYS.CONTRACTID=REVENUEBUDGETPDDETAIL.CONTRACTID\nSTAGESALESMERGE_ADDKEYS.RECEIPTDATEFORBUDGET=REVENUEBUDGETPDDETAIL.BUDGETDATE"
        name: REVENUEBUDGETPDDETAILKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 354dd50c-dd31-4f62-be03-e93f4c426e19
                stepCounter: 8ee78fa0-d503-4bdc-af13-75d384fbd677
            transform: COALESCE(REVENUEBUDGETPDDETAIL.REVENUEBUDGETPDDETAILKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5cbef5d-e3df-4cb4-bab7-88ade65e0f61
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORIGINAL_CUSTOMER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 820570e2-7356-4f7d-adf7-f8066e50dbb9
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31c6caad-7340-4a3e-b6ff-5269f8bb6b49
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORIGINAL_CUSTOMER_ADDRESS_STREET_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b38ac6ab-423b-4c76-917b-17f72854aa49
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c43dd9d-6683-4e4e-96d1-a1abee083144
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORIGINAL_CUSTOMER_ADDRESS_STREET_2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c3caf542-40a0-4b52-bf21-c198e4065e12
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf0a6b67-10e5-458e-bfaf-842020ec3e34
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORIGINAL_CUSTOMER_ADDRESS_CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64a7a7fe-9908-4842-9840-02e056e4c1ab
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15895399-7618-41c8-8cd8-6f8485328ea4
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORIGINAL_CUSTOMER_ADDRESS_STATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b057a4b6-ceb4-42f8-8281-e75eaf929f81
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a14d2e3-eb37-4688-805b-4ffc2afd121e
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORIGINAL_CUSTOMER_ADDRESS_POSTAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dce15dd8-72b1-43a7-af3c-2022387e1ac9
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 571a76e0-3743-42a4-9a3e-2501485349a5
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: INT
        defaultValue: ""
        description: UNIQUE IDENTIFIER FOR AN ACCOUNT. COMMONLY CALLED THE "FORCE ID"
        name: ACCOUNTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b467656f-34ac-4a6d-be83-4ae1ed065c43
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86d47223-1de9-4dcf-bcb9-3b073c1ae62c
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: REGISTRATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d74f6485-2d96-475a-8bd1-3ec45f2bb2d4
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a066a9de-0283-4d56-94f1-0cecb522dbd6
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: REPORTINGCUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5870bb43-bdb4-4e47-9c7d-80e6059481e2
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 914f77c2-c993-41bd-8910-6b9163aeddbb
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.SUPPLIERID=SUPPLIER.SUPPLIERID
        name: SUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0dbe6791-e486-4323-9105-61ec34f45e59
                stepCounter: 8d733483-4c1e-4c52-8f3e-9f99b8022f6d
            transform: COALESCE(SUPPLIER.SUPPLIERKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 73088c0f-210d-4a25-a01d-9c4923eb5613
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SOURCEENTITYNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e507b7d-0e88-4db6-9061-de17d6c24f69
                stepCounter: ab16115a-f5c7-4d24-bca6-41c596634f50
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6fb89d2a-b8e5-47b2-a52c-88f5381a2e94
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.CONTRACTID=CONTRACT.CONTRACTSALESFORCEID
        name: CONTRACTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52c7aa26-2ad9-4bd6-9ffc-9fc8c0ecb6dc
                stepCounter: ab16115a-f5c7-4d24-bca6-41c596634f50
            transform: COALESCE(CONTRACT.CONTRACTKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3fb7a66a-a363-4a3d-a958-776db56d4262
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: REVENUE TYPE (MOSTLY USED AS INPUT TO PREPARE NEXT YEAR'S BUDGET)
        name: REVENUETYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE--UC
              \N --WHEN BUYER=UC AND PPA=UC, THEN "SOLICITATION"
              \N WHEN ACCOUNTHIERARCHY_OMNIA.LEVEL1FORCEID IN(4052007,4052114,4052124,4052141,4052148,4052176,4052197,4052232,4052381,4055673,4057670) \N
                 AND ZEROIFNULL(CONTRACT.PPA_LEVEL_1_FORCEID) IN(4055673) \N THEN 'UC SOLICITATION' \N --WHEN BUYER=UC AND PPA<>UC, THEN "ADOPTION"
              \N WHEN ACCOUNTHIERARCHY_OMNIA.LEVEL1FORCEID IN(4052007,4052114,4052124,4052141,4052148,4052176,4052197,4052232,4052381,4055673,4057670) \N
                 AND ZEROIFNULL(CONTRACT.PPA_LEVEL_1_FORCEID) NOT IN(4055673) \N THEN 'UC ADOPTION' \N --WHEN BUYER<>UC AND PPA=UC, THEN "SYNDICATION"
              \N WHEN ACCOUNTHIERARCHY_OMNIA.LEVEL1FORCEID NOT IN(4052007,4052114,4052124,4052141,4052148,4052176,4052197,4052232,4052381,4055673,4057670) \N
                 AND ZEROIFNULL(CONTRACT.PPA_LEVEL_1_FORCEID) IN(4055673) \N THEN 'UC SYNDICATION' \N --
              \N ELSE \N CASE \N
                          WHEN SALESTERRITORY.TERRITORYGROUPNAME LIKE '%ISO%PUBLIC%'  THEN 'ISO PUBLIC' \N
                          WHEN SALESTERRITORY.TERRITORYGROUPNAME LIKE '%ISO%PRIVATE%' THEN 'ISO PRIVATE' \N
                          ELSE SALESTERRITORY.TERRITORYDIVISIONNAME \N
                           END \NEND
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55851ddc-4c46-4195-8159-94f17871a4a8
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CONTRACTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e6dd413e-72e6-46bc-b58e-4c099c73b189
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 053c979d-bdba-4379-a282-e00b621fdfe9
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: INT
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.RECEIPTDATE=DIMRECEIPTDATE.RECEIPTDATE
        name: RECEIPTDATEKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56a11c48-eda3-452d-8823-6159601714b7
                stepCounter: 2208854c-f7ba-4014-a250-d2598d1217cd
            transform: COALESCE(DIMRECEIPTDATE.RECEIPTDATEKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 735a8b5c-6d72-4a0f-a764-07366896bf86
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: RECEIPTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d6d2e0a2-5df9-4b8d-be79-3069448e418c
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 056f594c-5330-49de-9c09-9d0735bb0292
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: DATE
        defaultValue: ""
        description: GENERATE RECEIPT DATE FOR NEW 2019 BUDGET COMPARISON
        name: RECEIPTDATEFORBUDGET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 678fe072-4e4f-4289-9cee-bbf84b678671
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74fdeedb-a13f-489c-b7e4-7f33f7a50f97
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: INT
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.TRANSACTIONDATE=DIMTRANSACTIONDATE.TRANSACTIONDATE
        name: TRANSACTIONDATEKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 584d4a5f-e047-4ffd-84cc-67159046ebe2
                stepCounter: 04420abb-9d56-4991-8545-87b244f17df0
            transform: COALESCE(DIMTRANSACTIONDATE.TRANSACTIONDATEKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72368b8e-6bfc-460c-a2de-0f1cd4a26b4c
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: TRANSACTIONDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee550ea6-fd94-4393-b37a-e0dfc016dcf6
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e84c8948-f096-4f4e-a64d-e735bd8eb1b8
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ""
        name: UNITSSOLD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: edf0d414-4704-4117-9b8f-f598a96e9cce
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29a85a32-9dd1-47ec-8bec-5338d584fab4
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ""
        name: PRICEPERUNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18dba475-c357-4b95-8c0f-6533c8ef5962
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 43941eac-bec2-4f31-849b-d01474ca878c
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ""
        name: SALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 89bc84bb-f692-4e50-9bee-761ce430804e
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d393dcc-f82b-47a2-9650-37ab616199b5
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ""
        name: REVENUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 762f2f45-3974-4fae-8292-2ab1f99875fb
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c3da370-6d47-43b3-9a45-01a41792a109
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.TERRITORYID=SALESTERRITORY.TERRITORYID
        name: SALESTERRITORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7ac7fca-cb60-4a0a-bd1e-3e53b6a284ba
                stepCounter: 0800d08b-3992-497e-9eb7-c478c017e794
            transform: COALESCE(SALESTERRITORY.SALESTERRITORYKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e47ebd7-2e2d-4453-a317-233a18828005
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.TERRITORYIDFINANCIAL=FINANCIALSALESTERRITORY.FINANCIALTERRITORYID
        name: FINANCIALSALESTERRITORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1fa1156-d4c4-4c20-b486-e126533730b8
                stepCounter: e882e890-5ad7-4133-971f-d39c9c40581b
            transform: COALESCE(FINANCIALSALESTERRITORY.FINANCIALSALESTERRITORYKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c19f61c1-7540-404b-af9c-dd89fb99075e
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.TERRITORYIDDIRECT=DIRECTSALESTERRITORY.TERRITORYID
        name: DIRECTSALESTERRITORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6bba9d7a-e2ad-4c18-bfe7-7e007b4b266d
                stepCounter: da740e07-e762-4834-b934-f17b6b2c9132
            transform: COALESCE(DIRECTSALESTERRITORY.DIRECTSALESTERRITORYKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d1e383f1-7862-414f-b818-e51ce88fe67f
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: COMPANYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4abe316-b6fa-42c0-a9dc-25bf35d24fd4
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4be81cf6-f566-4962-bf89-59f01b3ebe0a
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: INT
        defaultValue: ""
        description: ORIGINAL FORCEID (ID) OF THE CUSTOMER TRANSACTION.
        name: ORIGINALCUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78a51363-62e6-4a9a-a2e2-98f98ecdb218
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 657024e2-060d-46c8-aae7-06b1d93883eb
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LOFFICEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c8579e3-90aa-4870-b8a5-91bdfc4a551e
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9d7028b-2c50-4f00-bcfd-dc124a42dd99
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: LOFFICENAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: da7d1c95-8263-4d95-9432-8a2e173fe7c4
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 275ceaf0-8252-4f3a-9006-30ecd09b73bd
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: INT
        defaultValue: ""
        description: VIZIENT SYSTEM IDENTIFIER
        name: SYSTEMID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a785f7a8-5611-42d1-86d1-69df89d23415
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5fd1a71-ea6e-4d9e-849a-029967830742
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        name: CONTRACTREBATEDETAILSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3696fc1-4550-4c06-8470-4847b8c56332
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20158bec-8c2c-4a8f-a23f-0bbe4e01a4d2
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        name: TRANSACTIONCLASSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fdac10c0-9216-4e0f-9899-caaa8df9b3b4
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd66591a-7f71-40f0-8155-e5199082b444
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESALESMERGE_ADDKEYS.TRANSACTIONCLASSID=TRANSACTIONCLASS.TRANSACTIONCLASSID
        name: TRANSACTIONCLASSKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e380694f-d864-4d9f-8d52-c3c1beb26c17
                stepCounter: 2d294c91-6849-4a8e-b698-9d55c4ee43b2
            transform: COALESCE(TRANSACTIONCLASS.TRANSACTIONCLASSKEY,0) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f8bade2c-45ed-405d-8416-99285a8da767
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: MAXRECEIPTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: TO_DATE('$MAXRECEIPTDATE')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 73fb5605-9ea7-4296-a080-90c922b505e0
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        name: ____END_COMMON_COLUMNS____
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4417fadb-704b-4d0a-a718-9e58d1d21b90
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e0fc5ad-e5cf-4e70-9516-ed287b0ce475
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bee7485c-fb3c-41ce-91da-ce12e30412e9
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc85bf88-2fc0-4df8-bbef-8b4dbf22f42c
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d9316fc-a1ef-4005-9f4f-a4f7569530b8
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf136f4c-90ac-4218-94dc-6b2909dfd030
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SUPPLIERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db4c307b-3f3d-49b1-9147-970c1b9bc661
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca31d5b7-aff0-478d-a639-d4f1e11b2946
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TERRITORYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2abc37bf-d505-477c-8c84-1258e16198a8
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27d1cb8e-5750-455c-9d37-6b0db22a9da9
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TERRITORYIDFINANCIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ec22614-3c5a-4ba4-bf56-5b9da71bfafe
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 58cb939e-aeaa-4dd8-9ab7-0bee54448e2b
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TERRITORYIDDIRECT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1532c77-fd36-41b0-b6f8-aff47e4bba25
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ffbe457-a6ee-4094-867d-8dae1f085f14
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SALESUNITOFMEASURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bb29bc2f-d318-466d-beb4-cf92a0c3ba2f
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb62aee4-5edc-41b1-934c-7a5496b3c940
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: TRANSACTIONNOTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 55bbe908-8183-49c3-8822-14347f7e2ccc
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6fbc8c19-8c06-4e37-b259-1f8ee50c2aca
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        name: CHANNELPARTNERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16d6f48c-bb70-4ea3-b039-c70ab4dd4a73
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cdbf2ea0-362d-4109-9bd5-130ad216fffd
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: CHANGE THE SOURCE OF CHANNELPARTNERFEESHAREPARTNERID TO ACCOUNTHIERARCHY INSTEAD OF FROM SALESREPORTINGLINEITEMS(FORCESALES)
        name: CHANNELPARTNERFEESHAREPARTNERID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a2cf664-550d-425f-9b1f-2dc994bb8c58
                stepCounter: e398bc3c-b60d-4b77-8c04-2d1541bc7310
            transform: COALESCE(ACCOUNTHIERARCHY_OMNIA.CHANNELPARTNERFEESHAREPARTNERID,STAGESALESMERGE_BIZXFORMS.CHANNELPARTNERFEESHAREPARTNERID,1)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be131333-ce46-4e01-86ba-eaebc2ed5f16
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: DECIMAL(38)
        defaultValue: ""
        description: ""
        name: CHANNELPARTNERLEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dfc76150-eb8d-4fcd-8151-3aaa8db5ddb3
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f53d6baf-6425-4b49-bd03-734c6a848b6d
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        name: CONTRACTEXTERNALCATEGORYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 319467ae-dcbc-4e4f-bc54-80a2d5239688
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 792eb5b9-e939-4d3c-9199-e76164962650
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: CUSTOMERIDFROMEXTERNALSYSTEM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1a6288bd-a6f4-4d86-9878-e8580c837dd6
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79ff034e-f300-4fdb-937d-bb02c5fbb529
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CUSTOMERLEVEL1IDFROMEXTERNALSYSTEM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3e9af4f-2f2e-49bb-9c68-f0e34930d399
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0957a43-cdcc-4b4f-9b4b-b9b9fce2c0d3
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ALLIANCE_NAME_PREMIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fdadcff6-ab48-489f-a6ac-bac2b0f7784f
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16ffb1b7-ae1a-46a5-8510-dc0812a9e468
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        name: ____END_APPENDED_BIZ_KEY_COLUMNS____
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 31f064d0-5f59-44e5-9984-3d8e3a27209c
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82d47043-cba6-4eac-9f0f-c71c8900aea8
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ARTIFICIAL KEY FOR THE DSS SOURCE SYSTEM TABLE.
        isSurrogateKey: true
        name: DSS_SOURCE_SYSTEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 912272e6-4544-47b0-9dff-2fff73639258
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: IFF(STAGESALESMERGE_BIZXFORMS.DSS_SOURCE_SYSTEM_KEY IS NULL,3,STAGESALESMERGE_BIZXFORMS.DSS_SOURCE_SYSTEM_KEY)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f86bddd-8c16-4a3c-b5be-318fb5fce0ca
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 13b6e099-50a1-4696-bad9-30badd26ac1c
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ac79270-31df-4fc6-bc7b-2516a632c5ad
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5787fd20-eb31-413a-88c1-0cbfc89ca3a6
                stepCounter: 8d820021-c4dd-475a-a5f9-c1223c9083be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd534a45-f100-4115-b8cf-1d6e0e338daf
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e598b177-24b2-4207-b5c0-3aef9127a2dd
          stepCounter: 76df3231-ca9f-4b54-ad10-80eacf7c091a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGESALESMERGE_BIZXFORMS: 8d820021-c4dd-475a-a5f9-c1223c9083be
          CONTRACT: ab16115a-f5c7-4d24-bca6-41c596634f50
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: DIM
            nodeName: ACCOUNTGEOGRAPHY
          - locationName: DIM
            nodeName: ACCOUNTHIERARCHY_OMNIA
          - locationName: DIM
            nodeName: CONTRACT
          - locationName: DIM
            nodeName: DIMRECEIPTDATE
          - locationName: DIM
            nodeName: DIMTRANSACTIONDATE
          - locationName: DIM
            nodeName: DIRECTSALESTERRITORY
          - locationName: DIM
            nodeName: FINANCIALSALESTERRITORY
          - locationName: DIM
            nodeName: ORGANIZATION
          - locationName: DIM
            nodeName: REVENUEBUDGETFORCEIDDETAIL
          - locationName: DIM
            nodeName: REVENUEBUDGETFORCEIDDIRECTDETAIL
          - locationName: DIM
            nodeName: REVENUEBUDGETPDDETAIL
          - locationName: DIM
            nodeName: SALESTERRITORY
          - locationName: DIM
            nodeName: SUPPLIER
          - locationName: DIM
            nodeName: TRANSACTIONCLASS
          - locationName: STAGE
            nodeName: STAGESALESMERGE_BIZXFORMS
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','STAGESALESMERGE_BIZXFORMS') }} STAGESALESMERGE_BIZXFORMS
              LEFT JOIN {{ ref('DIM','CONTRACT') }} CONTRACT
                ON STAGESALESMERGE_BIZXFORMS.CONTRACTID = CONTRACT.CONTRACTID
               AND STAGESALESMERGE_BIZXFORMS.DSS_SOURCE_SYSTEM_KEY = CONTRACT.DSS_SOURCE_SYSTEM_KEY
        name: STAGESALESMERGE_ADDKEYS
        noLinkRefs: []
  name: STAGESALESMERGE_ADDKEYS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
