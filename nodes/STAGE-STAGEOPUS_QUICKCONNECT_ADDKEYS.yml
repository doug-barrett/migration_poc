fileVersion: 1
id: faabbfa4-554b-48b6-98e3-70abc0e71385
name: STAGEOPUS_QUICKCONNECT_ADDKEYS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29b80395-0ac2-4dcf-9198-c7f866113c1f
          stepCounter: faabbfa4-554b-48b6-98e3-70abc0e71385
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPUSPRODUCTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8fddb3a8-8581-47ad-8268-7ebe45a933fd
                stepCounter: 934f8229-8c20-4d10-8c23-f861076b653f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1f3e016-96bf-4402-b77b-5133769bc08d
          stepCounter: faabbfa4-554b-48b6-98e3-70abc0e71385
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPUS_CONTACTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c8db74f0-c2b0-45f0-b327-a0a77a8872a9
                stepCounter: bc9fc8e9-df64-4382-9187-35501ef6eb51
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 954ad9fb-5663-49b8-8d7e-08115f0d2b03
          stepCounter: faabbfa4-554b-48b6-98e3-70abc0e71385
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DIMCONTACTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c6c95a9-173a-41a1-8a25-a73143fcc576
                stepCounter: 5fa12080-8040-4cbf-96f4-8e9c84eee853
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0498fa9-0216-4e21-9a15-09e9036a7c32
          stepCounter: faabbfa4-554b-48b6-98e3-70abc0e71385
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ACCOUNTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 923f9154-d06b-4433-99fd-95c767283389
                stepCounter: a594f58e-2240-453f-a570-12719830e3d0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dce38751-33f0-490d-84a2-99227256e68e
          stepCounter: faabbfa4-554b-48b6-98e3-70abc0e71385
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: StageOPUS_QUICKCONNECT_AddKeys.SupplierId=OPUS_SUPPLIER.SupplierOPUSId
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPUSSUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 603c3ffe-dae2-4135-b5c4-7fe690f68c0e
                stepCounter: 7fb2e9dd-f477-49a6-9807-bd5097b6a8f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d516c369-0399-419f-be09-1966bcd09d1f
          stepCounter: faabbfa4-554b-48b6-98e3-70abc0e71385
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated key for the date dimension. Nominal format is YYYYMMDD, but DD equal to 0 and greater than 31 permited for special date handling.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: QCCREATEDDATEKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 738d9729-46fb-4d0b-84b5-3f6d864206d7
                stepCounter: d639710e-6dfc-4009-b81c-5b982a65d7eb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f95676b-b0de-4f36-9515-21933cfd2f95
          stepCounter: faabbfa4-554b-48b6-98e3-70abc0e71385
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SUPPLIERFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5cb3553c-0098-4df8-b603-f4b12feae885
                stepCounter: 7fb2e9dd-f477-49a6-9807-bd5097b6a8f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 859fcaaa-1a8b-4728-a633-7e6f64b95320
          stepCounter: faabbfa4-554b-48b6-98e3-70abc0e71385
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CREATEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8921b681-5cba-4e3c-9e21-8b70998de1ab
                stepCounter: e9d5920c-a6e6-4938-9727-8f1f13358db7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e49d89fb-83e1-4a5a-91cb-972184f90249
          stepCounter: faabbfa4-554b-48b6-98e3-70abc0e71385
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PRODUCTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f173c7f4-cb1a-4dff-a7da-07af5cb9241b
                stepCounter: e9d5920c-a6e6-4938-9727-8f1f13358db7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f127f887-9e57-4879-b7d9-9f796235df21
          stepCounter: faabbfa4-554b-48b6-98e3-70abc0e71385
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dab56da1-6925-4910-bc15-a8b20a441bbf
                stepCounter: e9d5920c-a6e6-4938-9727-8f1f13358db7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 221b9645-5075-44c2-a810-7dc350726b29
          stepCounter: faabbfa4-554b-48b6-98e3-70abc0e71385
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f2855553-c719-49af-bd66-c0ca2a886392
                stepCounter: e9d5920c-a6e6-4938-9727-8f1f13358db7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 37908645-56e2-42e8-8412-e1420b7f1e7e
          stepCounter: faabbfa4-554b-48b6-98e3-70abc0e71385
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d38cbe4-26fe-4e07-aadd-21c67ee15932
                stepCounter: e9d5920c-a6e6-4938-9727-8f1f13358db7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a7cfdef-4f24-46b8-9c49-8b06790ab772
          stepCounter: faabbfa4-554b-48b6-98e3-70abc0e71385
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 349c3b45-cad0-4e02-af0d-962a4fd7bf64
                stepCounter: e9d5920c-a6e6-4938-9727-8f1f13358db7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6fa56c81-390b-4829-a384-0659beb8595d
          stepCounter: faabbfa4-554b-48b6-98e3-70abc0e71385
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LOCATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27c7cfb2-c99d-4ee0-9193-1f2c9e80a623
                stepCounter: e9d5920c-a6e6-4938-9727-8f1f13358db7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0b42e2b-b0b8-4195-9298-68b1e8831506
          stepCounter: faabbfa4-554b-48b6-98e3-70abc0e71385
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PURPOSE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e6f0d61d-8981-4583-bac5-e77e04156ad3
                stepCounter: e9d5920c-a6e6-4938-9727-8f1f13358db7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5f05e57-3008-4c69-b722-dbb92b7dcd11
          stepCounter: faabbfa4-554b-48b6-98e3-70abc0e71385
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: NOTES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: af26bff6-09cc-42aa-a366-d017731c7922
                stepCounter: e9d5920c-a6e6-4938-9727-8f1f13358db7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c080a652-5aee-4d71-bed5-6090055706a3
          stepCounter: faabbfa4-554b-48b6-98e3-70abc0e71385
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SEARCHPHRASE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ab016d5-7757-4578-a96b-b340e9796226
                stepCounter: e9d5920c-a6e6-4938-9727-8f1f13358db7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a731606-f708-4ae5-852b-bbc81f490c5b
          stepCounter: faabbfa4-554b-48b6-98e3-70abc0e71385
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: MODIFIEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 66d831ae-9791-43eb-b490-938e0cbfc872
                stepCounter: e9d5920c-a6e6-4938-9727-8f1f13358db7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 199938e5-b57a-411b-8f88-3acaa6d7e60b
          stepCounter: faabbfa4-554b-48b6-98e3-70abc0e71385
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: Record source.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 89ea533c-6e11-477d-b6d8-c76134c11242
                stepCounter: e9d5920c-a6e6-4938-9727-8f1f13358db7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d37a43f8-9bb2-4360-93ba-508c8f001d0b
          stepCounter: faabbfa4-554b-48b6-98e3-70abc0e71385
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Load date.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c1be9ad-3371-4197-a6d8-4af2a62c68ba
                stepCounter: e9d5920c-a6e6-4938-9727-8f1f13358db7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d2b13e6-65b9-4aef-8df4-31da6466b65f
          stepCounter: faabbfa4-554b-48b6-98e3-70abc0e71385
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 114c2838-f99b-4029-b58e-ebaf5f25ab8c
          stepCounter: faabbfa4-554b-48b6-98e3-70abc0e71385
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGEFACT_OPUS_QUICKCONNECT: e9d5920c-a6e6-4938-9727-8f1f13358db7
          VWOPUS_QC_DATE: d639710e-6dfc-4009-b81c-5b982a65d7eb
          OPUS_PRODUCT: 934f8229-8c20-4d10-8c23-f861076b653f
          CONTACT: 5fa12080-8040-4cbf-96f4-8e9c84eee853
          ACCOUNT: a594f58e-2240-453f-a570-12719830e3d0
          OPUS_CONTACT: bc9fc8e9-df64-4382-9187-35501ef6eb51
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: DIM
            nodeName: CONTACT
          - locationName: DIM
            nodeName: OPUS_CONTACT
          - locationName: DIM
            nodeName: OPUS_PRODUCT
          - locationName: DIM
            nodeName: OPUS_SUPPLIER
          - locationName: DIM
            nodeName: VWOPUS_QC_DATE
          - locationName: STAGE
            nodeName: STAGEFACT_OPUS_QUICKCONNECT
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','STAGEFACT_OPUS_QUICKCONNECT') }} StageFACT_OPUS_QUICKCONNECT
              LEFT JOIN {{ ref('DIM','VWOPUS_QC_DATE') }} vwOPUS_QC_DATE
                ON StageFACT_OPUS_QUICKCONNECT.CreatedDate = vwOPUS_QC_DATE.QC_CALENDAR_DATE
              LEFT JOIN {{ ref('DIM','OPUS_PRODUCT') }} OPUS_PRODUCT
                ON StageFACT_OPUS_QUICKCONNECT.ProductId = OPUS_PRODUCT.ProductId
              LEFT JOIN {{ ref('DIM','CONTACT') }} Contact
                ON StageFACT_OPUS_QUICKCONNECT.CustomerId = Contact.OPUS_Customer_Id
              LEFT JOIN {{ ref('DIM','ACCOUNT') }} ACCOUNT
                ON StageFACT_OPUS_QUICKCONNECT.OrganizationId = Account.OPUS_Organization_Id
              LEFT JOIN {{ ref('DIM','OPUS_CONTACT') }} OPUS_CONTACT
                ON StageFACT_OPUS_QUICKCONNECT.CustomerId = OPUS_CONTACT.CustomerId
               AND StageFACT_OPUS_QUICKCONNECT.OrganizationId = OPUS_CONTACT.OrganizationId
        name: STAGEOPUS_QUICKCONNECT_ADDKEYS
        noLinkRefs: []
  name: STAGEOPUS_QUICKCONNECT_ADDKEYS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
