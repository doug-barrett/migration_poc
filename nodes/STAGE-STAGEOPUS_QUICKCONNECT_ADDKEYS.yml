fileVersion: 1
id: 3ae47b2a-ec94-487a-a700-cc40411aa292
name: STAGEOPUS_QUICKCONNECT_ADDKEYS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96714279-c5cf-4406-b617-1cd52592583f
          stepCounter: 3ae47b2a-ec94-487a-a700-cc40411aa292
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: OPUSPRODUCTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39cd8d04-a0c1-4570-af6a-3ef5193e0188
                stepCounter: f0f25bb4-d26f-4e2a-9e67-429aa61f0625
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa5491ce-b371-47c1-8ae3-1d3b7ecc9b52
          stepCounter: 3ae47b2a-ec94-487a-a700-cc40411aa292
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: OPUS_CONTACTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3434011d-d965-4acb-b578-87fe620ca288
                stepCounter: c0d5aa6a-a938-447b-8e2e-a1e53d310fc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79ab3735-719f-475c-a532-fc4cea8c9390
          stepCounter: 3ae47b2a-ec94-487a-a700-cc40411aa292
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: DIMCONTACTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dcf753c9-6ce6-4287-960d-d7a6b21b22fc
                stepCounter: d056aba3-a0b9-4509-9a27-e51f9da7fe1b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91dfe7fa-2c39-43bb-986c-a93ebd1d6d60
          stepCounter: 3ae47b2a-ec94-487a-a700-cc40411aa292
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: ACCOUNTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bae9c318-63c2-4058-8e74-f5509f5b4522
                stepCounter: d5234d5a-eb19-45e2-9c42-47221579f347
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2fb45eef-215b-4920-88a7-80af98351632
          stepCounter: 3ae47b2a-ec94-487a-a700-cc40411aa292
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEOPUS_QUICKCONNECT_ADDKEYS.SUPPLIERID=OPUS_SUPPLIER.SUPPLIEROPUSID
        name: OPUSSUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3d1ff80d-7379-4792-8999-53104514e50f
                stepCounter: 433e71b5-067e-4283-a8d2-3f73351f62ac
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ef53539-0896-45af-a1da-747e28b53691
          stepCounter: 3ae47b2a-ec94-487a-a700-cc40411aa292
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED KEY FOR THE DATE DIMENSION. NOMINAL FORMAT IS YYYYMMDD, BUT DD EQUAL TO 0 AND GREATER THAN 31 PERMITED FOR SPECIAL DATE HANDLING.
        name: QCCREATEDDATEKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd80b000-aeed-4f4d-b031-2f549e370232
                stepCounter: 28b0723e-4e8b-4219-b096-121cbdc8077b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45984e70-6b45-4408-8321-24de01c0a431
          stepCounter: 3ae47b2a-ec94-487a-a700-cc40411aa292
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SUPPLIERFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd45c1b3-f5f5-45aa-8b0d-4efefa0094a9
                stepCounter: 433e71b5-067e-4283-a8d2-3f73351f62ac
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5fda1d79-48b1-4fa2-adff-864bdbfa1110
          stepCounter: 3ae47b2a-ec94-487a-a700-cc40411aa292
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CREATEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4463a5a9-6412-4532-aaf1-c8b8946d9a3e
                stepCounter: 253e80b1-46b2-47ac-84d9-edc37e6396d3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bccd1f0b-885b-4337-9a4f-012c28274104
          stepCounter: 3ae47b2a-ec94-487a-a700-cc40411aa292
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PRODUCTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ac2941c9-3830-43bb-9aae-ecadac9c2bac
                stepCounter: 253e80b1-46b2-47ac-84d9-edc37e6396d3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 434fde05-ec00-442c-8d62-2097c5df6361
          stepCounter: 3ae47b2a-ec94-487a-a700-cc40411aa292
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 32662e65-7b64-4515-aef8-cae5f5391b6d
                stepCounter: 253e80b1-46b2-47ac-84d9-edc37e6396d3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33a08ec0-396a-4483-a6f5-6d0b3f60a2f2
          stepCounter: 3ae47b2a-ec94-487a-a700-cc40411aa292
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e34057bf-9622-4e95-a684-ecd031c8ef95
                stepCounter: 253e80b1-46b2-47ac-84d9-edc37e6396d3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d89b27e-1ce7-4a6b-ac5e-69a1540f3546
          stepCounter: 3ae47b2a-ec94-487a-a700-cc40411aa292
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16c54470-a18a-4ee3-bea4-3f95beafc213
                stepCounter: 253e80b1-46b2-47ac-84d9-edc37e6396d3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a9e5e9f-9e7e-4e85-bb7a-63b88777aebf
          stepCounter: 3ae47b2a-ec94-487a-a700-cc40411aa292
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c736fb99-e190-492c-bb48-611779fd125e
                stepCounter: 253e80b1-46b2-47ac-84d9-edc37e6396d3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b168871b-45d4-46d6-970e-309e218bc7fd
          stepCounter: 3ae47b2a-ec94-487a-a700-cc40411aa292
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: LOCATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1be782e9-da01-46a1-a27e-1e67ceca4b0d
                stepCounter: 253e80b1-46b2-47ac-84d9-edc37e6396d3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 676b796b-dd63-4760-b520-cb22c50773b3
          stepCounter: 3ae47b2a-ec94-487a-a700-cc40411aa292
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PURPOSE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 965a811f-af8b-4274-8460-4ace03e4c168
                stepCounter: 253e80b1-46b2-47ac-84d9-edc37e6396d3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3a3c3c9-1160-4ebc-9627-7c90e13bc2ce
          stepCounter: 3ae47b2a-ec94-487a-a700-cc40411aa292
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: NOTES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f4c01bec-06b2-4451-8cfb-33f0e9bbd1da
                stepCounter: 253e80b1-46b2-47ac-84d9-edc37e6396d3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a389f221-8842-40fc-8df1-926cf68adad7
          stepCounter: 3ae47b2a-ec94-487a-a700-cc40411aa292
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: SEARCHPHRASE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6425036f-eede-4534-9f7e-48ed5b2d321b
                stepCounter: 253e80b1-46b2-47ac-84d9-edc37e6396d3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a0be48ab-add5-4010-acb9-397c446534f2
          stepCounter: 3ae47b2a-ec94-487a-a700-cc40411aa292
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: MODIFIEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 88974cf5-0872-4724-8d85-630a41ee5db8
                stepCounter: 253e80b1-46b2-47ac-84d9-edc37e6396d3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6c5f0e8-17fa-4795-af07-af89ce93a487
          stepCounter: 3ae47b2a-ec94-487a-a700-cc40411aa292
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8408a702-d3db-4b6e-9d28-90a9b285c140
                stepCounter: 253e80b1-46b2-47ac-84d9-edc37e6396d3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6da00567-af97-4d56-89af-0b54a4d1a8a6
          stepCounter: 3ae47b2a-ec94-487a-a700-cc40411aa292
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 99604ed4-e1ff-42e3-a95a-9b3f4d8f438b
                stepCounter: 253e80b1-46b2-47ac-84d9-edc37e6396d3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 471096ea-8811-42d4-bba4-f03b9c23cda3
          stepCounter: 3ae47b2a-ec94-487a-a700-cc40411aa292
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 233de7a8-ef61-4db9-96ee-9b5ec55e19b7
          stepCounter: 3ae47b2a-ec94-487a-a700-cc40411aa292
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGEFACT_OPUS_QUICKCONNECT: 253e80b1-46b2-47ac-84d9-edc37e6396d3
          VWOPUS_QC_DATE: 28b0723e-4e8b-4219-b096-121cbdc8077b
          OPUS_PRODUCT: f0f25bb4-d26f-4e2a-9e67-429aa61f0625
          CONTACT: d056aba3-a0b9-4509-9a27-e51f9da7fe1b
          ACCOUNT: d5234d5a-eb19-45e2-9c42-47221579f347
          OPUS_CONTACT: c0d5aa6a-a938-447b-8e2e-a1e53d310fc4
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: DIM
            nodeName: CONTACT
          - locationName: DIM
            nodeName: OPUS_CONTACT
          - locationName: DIM
            nodeName: OPUS_PRODUCT
          - locationName: DIM
            nodeName: OPUS_SUPPLIER
          - locationName: DIM
            nodeName: VWOPUS_QC_DATE
          - locationName: STAGE
            nodeName: STAGEFACT_OPUS_QUICKCONNECT
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','STAGEFACT_OPUS_QUICKCONNECT') }} STAGEFACT_OPUS_QUICKCONNECT
              LEFT JOIN {{ ref('DIM','VWOPUS_QC_DATE') }} VWOPUS_QC_DATE
                ON STAGEFACT_OPUS_QUICKCONNECT.CREATEDDATE = VWOPUS_QC_DATE.QC_CALENDAR_DATE
              LEFT JOIN {{ ref('DIM','OPUS_PRODUCT') }} OPUS_PRODUCT
                ON STAGEFACT_OPUS_QUICKCONNECT.PRODUCTID = OPUS_PRODUCT.PRODUCTID
              LEFT JOIN {{ ref('DIM','CONTACT') }} CONTACT
                ON STAGEFACT_OPUS_QUICKCONNECT.CUSTOMERID = CONTACT.OPUS_CUSTOMER_ID
              LEFT JOIN {{ ref('DIM','ACCOUNT') }} ACCOUNT
                ON STAGEFACT_OPUS_QUICKCONNECT.ORGANIZATIONID = ACCOUNT.OPUS_ORGANIZATION_ID
              LEFT JOIN {{ ref('DIM','OPUS_CONTACT') }} OPUS_CONTACT
                ON STAGEFACT_OPUS_QUICKCONNECT.CUSTOMERID = OPUS_CONTACT.CUSTOMERID
               AND STAGEFACT_OPUS_QUICKCONNECT.ORGANIZATIONID = OPUS_CONTACT.ORGANIZATIONID
        name: STAGEOPUS_QUICKCONNECT_ADDKEYS
        noLinkRefs: []
  name: STAGEOPUS_QUICKCONNECT_ADDKEYS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
