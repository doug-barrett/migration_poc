fileVersion: 1
id: bcf8d22e-06a8-4000-b13f-58d87327b93f
name: STAGEOPUS_QUICKCONNECT_ADDKEYS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6bbbf87-632b-4f2e-8ace-b8e82ebe4137
          stepCounter: bcf8d22e-06a8-4000-b13f-58d87327b93f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPUSPRODUCTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb5f1d8f-c184-4e6d-96e6-e0091c6e8092
                stepCounter: 601bd7d8-ec69-49fb-a0f1-9847c982e986
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0c101b5-02c6-4175-9127-3c3854b85dc1
          stepCounter: bcf8d22e-06a8-4000-b13f-58d87327b93f
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPUS_CONTACTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf8373b7-6487-4b03-82e7-7c357c7b7999
                stepCounter: a1714c53-65dc-4058-889d-a0edea7c661c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6afa0fbe-d636-4a8d-840a-f200e64c24f8
          stepCounter: bcf8d22e-06a8-4000-b13f-58d87327b93f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DIMCONTACTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a73af37f-395a-43e2-ad1e-46c2fedc925a
                stepCounter: e165c76e-6a45-4567-817a-c8ecf377ecd2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 093fb0a1-0c7a-4267-9a68-2473fa536da9
          stepCounter: bcf8d22e-06a8-4000-b13f-58d87327b93f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ACCOUNTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 142e5dc4-d508-469e-862b-8ad4d3c7b053
                stepCounter: c278473c-12f0-41e1-b65b-faa4b3c2a978
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c129b851-98b6-4336-a750-cb02da272d27
          stepCounter: bcf8d22e-06a8-4000-b13f-58d87327b93f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: StageOPUS_QUICKCONNECT_AddKeys.SupplierId=OPUS_SUPPLIER.SupplierOPUSId
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPUSSUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 92495bb3-216f-40b1-8389-02b19f311c56
                stepCounter: f4d3ca93-32bf-4539-9b82-c5c1d3869942
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a38a5948-f827-456d-82c0-d32160c70f9a
          stepCounter: bcf8d22e-06a8-4000-b13f-58d87327b93f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated key for the date dimension. Nominal format is YYYYMMDD, but DD equal to 0 and greater than 31 permited for special date handling.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: QCCREATEDDATEKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 01092d26-2649-4b18-8ebc-0ce0ef79e15d
                stepCounter: a1742e32-c76a-4103-8214-1b29dd51c756
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6fd9d931-5c9b-4278-bd0e-e682bd278ce4
          stepCounter: bcf8d22e-06a8-4000-b13f-58d87327b93f
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SUPPLIERFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 82e1ae19-7206-44dd-a011-0dd68d117b88
                stepCounter: f4d3ca93-32bf-4539-9b82-c5c1d3869942
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3a0fe87-5a77-4bf9-bdcf-6e12cc7ae439
          stepCounter: bcf8d22e-06a8-4000-b13f-58d87327b93f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CREATEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0272d6fc-83ee-46d1-a1eb-9923f6ffa07b
                stepCounter: 4820bf2b-6609-416e-95f1-de293e2ae30b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b5329b8-da7a-4cb6-aca8-8281859feffb
          stepCounter: bcf8d22e-06a8-4000-b13f-58d87327b93f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PRODUCTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6157c370-e0a4-45e6-aa9f-bde0fce8396b
                stepCounter: 4820bf2b-6609-416e-95f1-de293e2ae30b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6278590-a78e-4921-b9ea-b6240ee24f87
          stepCounter: bcf8d22e-06a8-4000-b13f-58d87327b93f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 852faf60-0ad9-40e7-b843-1fd9f35329ff
                stepCounter: 4820bf2b-6609-416e-95f1-de293e2ae30b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb5542c3-490f-49d9-8347-2a6cbcf80a6c
          stepCounter: bcf8d22e-06a8-4000-b13f-58d87327b93f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: caa401da-14e7-4944-aff4-d21bd360d4a0
                stepCounter: 4820bf2b-6609-416e-95f1-de293e2ae30b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a63013b-0cff-49df-887d-d96048e41c0d
          stepCounter: bcf8d22e-06a8-4000-b13f-58d87327b93f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9ebe49e-d50e-4993-baee-f6dd6994f285
                stepCounter: 4820bf2b-6609-416e-95f1-de293e2ae30b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9be965c-02db-4577-bc42-4b7de4cd9606
          stepCounter: bcf8d22e-06a8-4000-b13f-58d87327b93f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 08a1fa21-351c-4d71-b68e-8025a31a479d
                stepCounter: 4820bf2b-6609-416e-95f1-de293e2ae30b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 30966a8b-3e31-436c-94f2-86c32419df86
          stepCounter: bcf8d22e-06a8-4000-b13f-58d87327b93f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LOCATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3f1bcf0e-412d-481a-9c2c-81cf4640efc0
                stepCounter: 4820bf2b-6609-416e-95f1-de293e2ae30b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa08daf0-03be-4dad-a402-1f09fc1ea335
          stepCounter: bcf8d22e-06a8-4000-b13f-58d87327b93f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PURPOSE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7c02047-5975-4747-872a-93ec14445c6d
                stepCounter: 4820bf2b-6609-416e-95f1-de293e2ae30b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 888c2d74-dfe2-4c17-a572-719225946bbd
          stepCounter: bcf8d22e-06a8-4000-b13f-58d87327b93f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: NOTES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 54c06b76-5dc7-41bd-b073-15bcaf61e1fc
                stepCounter: 4820bf2b-6609-416e-95f1-de293e2ae30b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be25249d-fa57-43b1-bb8a-eb9db3d12e25
          stepCounter: bcf8d22e-06a8-4000-b13f-58d87327b93f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SEARCHPHRASE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 30dd2a51-49f3-4ee1-8e14-f25c302c09f6
                stepCounter: 4820bf2b-6609-416e-95f1-de293e2ae30b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1ce2191-241b-4982-8f91-fb38157aab1e
          stepCounter: bcf8d22e-06a8-4000-b13f-58d87327b93f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: MODIFIEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 61d43469-9b60-4c8a-a800-9fbc5bbc3d53
                stepCounter: 4820bf2b-6609-416e-95f1-de293e2ae30b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18621099-1987-4238-872d-667e82f67170
          stepCounter: bcf8d22e-06a8-4000-b13f-58d87327b93f
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: Record source.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 89887483-a63f-46e8-a5cc-d32c3bcae6cf
                stepCounter: 4820bf2b-6609-416e-95f1-de293e2ae30b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66e783d0-ec6a-4652-8715-9c9dc4c13ae6
          stepCounter: bcf8d22e-06a8-4000-b13f-58d87327b93f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Load date.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d5811ef2-f008-4923-b304-a14621d5b67c
                stepCounter: 4820bf2b-6609-416e-95f1-de293e2ae30b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a94b43b5-2dad-4850-9789-36f10506268f
          stepCounter: bcf8d22e-06a8-4000-b13f-58d87327b93f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 821f014f-5572-4d72-abe2-896d1ec21423
          stepCounter: bcf8d22e-06a8-4000-b13f-58d87327b93f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGEFACT_OPUS_QUICKCONNECT: 4820bf2b-6609-416e-95f1-de293e2ae30b
          VWOPUS_QC_DATE: a1742e32-c76a-4103-8214-1b29dd51c756
          OPUS_PRODUCT: 601bd7d8-ec69-49fb-a0f1-9847c982e986
          CONTACT: e165c76e-6a45-4567-817a-c8ecf377ecd2
          ACCOUNT: c278473c-12f0-41e1-b65b-faa4b3c2a978
          OPUS_CONTACT: a1714c53-65dc-4058-889d-a0edea7c661c
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: DIM
            nodeName: CONTACT
          - locationName: DIM
            nodeName: OPUS_CONTACT
          - locationName: DIM
            nodeName: OPUS_PRODUCT
          - locationName: DIM
            nodeName: OPUS_SUPPLIER
          - locationName: DIM
            nodeName: VWOPUS_QC_DATE
          - locationName: STAGE
            nodeName: STAGEFACT_OPUS_QUICKCONNECT
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','STAGEFACT_OPUS_QUICKCONNECT') }} StageFACT_OPUS_QUICKCONNECT
              LEFT JOIN {{ ref('DIM','VWOPUS_QC_DATE') }} vwOPUS_QC_DATE
                ON StageFACT_OPUS_QUICKCONNECT.CreatedDate = vwOPUS_QC_DATE.QC_CALENDAR_DATE
              LEFT JOIN {{ ref('DIM','OPUS_PRODUCT') }} OPUS_PRODUCT
                ON StageFACT_OPUS_QUICKCONNECT.ProductId = OPUS_PRODUCT.ProductId
              LEFT JOIN {{ ref('DIM','CONTACT') }} Contact
                ON StageFACT_OPUS_QUICKCONNECT.CustomerId = Contact.OPUS_Customer_Id
              LEFT JOIN {{ ref('DIM','ACCOUNT') }} ACCOUNT
                ON StageFACT_OPUS_QUICKCONNECT.OrganizationId = Account.OPUS_Organization_Id
              LEFT JOIN {{ ref('DIM','OPUS_CONTACT') }} OPUS_CONTACT
                ON StageFACT_OPUS_QUICKCONNECT.CustomerId = OPUS_CONTACT.CustomerId
               AND StageFACT_OPUS_QUICKCONNECT.OrganizationId = OPUS_CONTACT.OrganizationId
        name: STAGEOPUS_QUICKCONNECT_ADDKEYS
        noLinkRefs: []
  name: STAGEOPUS_QUICKCONNECT_ADDKEYS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
