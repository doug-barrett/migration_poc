fileVersion: 1
id: 439279cf-a7dc-41b1-8561-f8f639ba2be7
name: STAGEOPUS_QUICKCONNECT_ADDKEYS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92a425cb-13d1-4601-8227-6be0bf73500f
          stepCounter: 439279cf-a7dc-41b1-8561-f8f639ba2be7
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: OPUSPRODUCTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db8301c3-d64e-47ef-a3aa-ebca06657c4a
                stepCounter: ded28e11-487f-4827-943b-81fd3ec6c65e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a57f73f8-0b2c-4316-98a0-3810906e2aeb
          stepCounter: 439279cf-a7dc-41b1-8561-f8f639ba2be7
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: OPUS_CONTACTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b5116a58-7724-4f00-90f8-2b858596359a
                stepCounter: b85c7819-29df-44d8-8ca6-ce58cb2bf7ae
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1407d231-684c-4f55-a230-8d144460522f
          stepCounter: 439279cf-a7dc-41b1-8561-f8f639ba2be7
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: DIMCONTACTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dcf5f781-2b00-4e01-9503-c981ed1ab780
                stepCounter: 4015cdd7-ddd6-45b0-996c-53903de48f6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66880d22-6c13-4f81-a0a3-de10d60f0743
          stepCounter: 439279cf-a7dc-41b1-8561-f8f639ba2be7
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: ACCOUNTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51242f2b-12a0-45ea-bdfb-000fdb4c550a
                stepCounter: 96e8695b-6733-4729-8797-91b12c74cb7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 76b5433f-3633-4350-8d52-270e9b8090a8
          stepCounter: 439279cf-a7dc-41b1-8561-f8f639ba2be7
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEOPUS_QUICKCONNECT_ADDKEYS.SUPPLIERID=OPUS_SUPPLIER.SUPPLIEROPUSID
        name: OPUSSUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: be905c6f-acd8-4701-8431-32f0def6ec2e
                stepCounter: 4a40fd64-d675-4ba5-9c42-93e3222d3fbd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c15f3181-8261-4585-bbb3-b9f7c8c6f7d3
          stepCounter: 439279cf-a7dc-41b1-8561-f8f639ba2be7
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED KEY FOR THE DATE DIMENSION. NOMINAL FORMAT IS YYYYMMDD, BUT DD EQUAL TO 0 AND GREATER THAN 31 PERMITED FOR SPECIAL DATE HANDLING.
        name: QCCREATEDDATEKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d9ea860a-f373-4e69-8d66-135ea75defb6
                stepCounter: c215af51-f833-43f9-9085-5b8e7ca82749
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc0ed31b-ddaf-426b-abc5-306e5017e4dd
          stepCounter: 439279cf-a7dc-41b1-8561-f8f639ba2be7
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SUPPLIERFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1bcc706b-9e89-4fa7-8473-a804172084cb
                stepCounter: 4a40fd64-d675-4ba5-9c42-93e3222d3fbd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f30cb9f6-465b-419b-86c4-1bbbcaccaed8
          stepCounter: 439279cf-a7dc-41b1-8561-f8f639ba2be7
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CREATEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aee06a3e-b56b-466d-adcf-e11a5bb36158
                stepCounter: 1927027f-3c4c-48be-bcb1-62e50d0b9d6e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4470d57b-5586-4de2-88c6-d2ba88623528
          stepCounter: 439279cf-a7dc-41b1-8561-f8f639ba2be7
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PRODUCTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9e53099b-eae0-4a22-adb0-a00b50b045d2
                stepCounter: 1927027f-3c4c-48be-bcb1-62e50d0b9d6e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cbc3b628-b7dd-4361-8f06-2d41d1ecc140
          stepCounter: 439279cf-a7dc-41b1-8561-f8f639ba2be7
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d45b007-9a8d-4145-933e-0962420b1c9e
                stepCounter: 1927027f-3c4c-48be-bcb1-62e50d0b9d6e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f85dfb48-4901-4606-9117-e0b1dfda16ed
          stepCounter: 439279cf-a7dc-41b1-8561-f8f639ba2be7
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e0a3748-b691-4a5b-86fe-69362db23dad
                stepCounter: 1927027f-3c4c-48be-bcb1-62e50d0b9d6e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75c1af41-285f-4b38-8096-ca7ae93d4d6e
          stepCounter: 439279cf-a7dc-41b1-8561-f8f639ba2be7
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: afe9a4d9-1beb-420a-bfb3-baa65c9d1fd5
                stepCounter: 1927027f-3c4c-48be-bcb1-62e50d0b9d6e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33d0b607-f74b-4244-af32-059c1c1ccd36
          stepCounter: 439279cf-a7dc-41b1-8561-f8f639ba2be7
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c6e3408f-3cbe-4ffe-8ee0-78b7a2b29044
                stepCounter: 1927027f-3c4c-48be-bcb1-62e50d0b9d6e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea361d60-b561-45ad-ad76-2bdcf7a3d9cd
          stepCounter: 439279cf-a7dc-41b1-8561-f8f639ba2be7
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: LOCATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f0d00b45-7e1f-49ab-af78-2e956e83c095
                stepCounter: 1927027f-3c4c-48be-bcb1-62e50d0b9d6e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8d60735-ed00-4676-b554-b6bf3ca1b43b
          stepCounter: 439279cf-a7dc-41b1-8561-f8f639ba2be7
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PURPOSE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fbe1301f-6fa8-4073-89e8-47f8c078f807
                stepCounter: 1927027f-3c4c-48be-bcb1-62e50d0b9d6e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 024adf4b-94d9-400e-8857-e7a0868e48f2
          stepCounter: 439279cf-a7dc-41b1-8561-f8f639ba2be7
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: NOTES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4ede15a-132a-4efe-9f80-028371d86027
                stepCounter: 1927027f-3c4c-48be-bcb1-62e50d0b9d6e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45bc8c31-8d4a-4cab-a54c-1b8c597d911a
          stepCounter: 439279cf-a7dc-41b1-8561-f8f639ba2be7
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: SEARCHPHRASE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 31008ef7-1073-47af-b087-39843aae1562
                stepCounter: 1927027f-3c4c-48be-bcb1-62e50d0b9d6e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a091689-17e4-403f-a5fa-6b5220569b8c
          stepCounter: 439279cf-a7dc-41b1-8561-f8f639ba2be7
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: MODIFIEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d51f4cda-55ad-4ecd-8c38-ee2495628c72
                stepCounter: 1927027f-3c4c-48be-bcb1-62e50d0b9d6e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 498a266f-9994-4bd5-bb04-91845dba4910
          stepCounter: 439279cf-a7dc-41b1-8561-f8f639ba2be7
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39120276-ac97-4c8a-ad6d-e3e0661e1fa7
                stepCounter: 1927027f-3c4c-48be-bcb1-62e50d0b9d6e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f82cc4a-1e78-48c9-8598-b3f0c764ca5a
          stepCounter: 439279cf-a7dc-41b1-8561-f8f639ba2be7
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 684fc6d2-3fe0-4674-a579-2ce908ea6b7d
                stepCounter: 1927027f-3c4c-48be-bcb1-62e50d0b9d6e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09d21da6-14d2-4125-97f1-b4d4553956e9
          stepCounter: 439279cf-a7dc-41b1-8561-f8f639ba2be7
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6dc17ff1-76fc-454d-9539-f0f2dabaa40c
          stepCounter: 439279cf-a7dc-41b1-8561-f8f639ba2be7
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGEFACT_OPUS_QUICKCONNECT: 1927027f-3c4c-48be-bcb1-62e50d0b9d6e
          VWOPUS_QC_DATE: c215af51-f833-43f9-9085-5b8e7ca82749
          OPUS_PRODUCT: ded28e11-487f-4827-943b-81fd3ec6c65e
          CONTACT: 4015cdd7-ddd6-45b0-996c-53903de48f6b
          ACCOUNT: 96e8695b-6733-4729-8797-91b12c74cb7e
          OPUS_CONTACT: b85c7819-29df-44d8-8ca6-ce58cb2bf7ae
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: DIM
            nodeName: CONTACT
          - locationName: DIM
            nodeName: OPUS_CONTACT
          - locationName: DIM
            nodeName: OPUS_PRODUCT
          - locationName: DIM
            nodeName: OPUS_SUPPLIER
          - locationName: DIM
            nodeName: VWOPUS_QC_DATE
          - locationName: STAGE
            nodeName: STAGEFACT_OPUS_QUICKCONNECT
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','STAGEFACT_OPUS_QUICKCONNECT') }} STAGEFACT_OPUS_QUICKCONNECT
              LEFT JOIN {{ ref('DIM','VWOPUS_QC_DATE') }} VWOPUS_QC_DATE
                ON STAGEFACT_OPUS_QUICKCONNECT.CREATEDDATE = VWOPUS_QC_DATE.QC_CALENDAR_DATE
              LEFT JOIN {{ ref('DIM','OPUS_PRODUCT') }} OPUS_PRODUCT
                ON STAGEFACT_OPUS_QUICKCONNECT.PRODUCTID = OPUS_PRODUCT.PRODUCTID
              LEFT JOIN {{ ref('DIM','CONTACT') }} CONTACT
                ON STAGEFACT_OPUS_QUICKCONNECT.CUSTOMERID = CONTACT.OPUS_CUSTOMER_ID
              LEFT JOIN {{ ref('DIM','ACCOUNT') }} ACCOUNT
                ON STAGEFACT_OPUS_QUICKCONNECT.ORGANIZATIONID = ACCOUNT.OPUS_ORGANIZATION_ID
              LEFT JOIN {{ ref('DIM','OPUS_CONTACT') }} OPUS_CONTACT
                ON STAGEFACT_OPUS_QUICKCONNECT.CUSTOMERID = OPUS_CONTACT.CUSTOMERID
               AND STAGEFACT_OPUS_QUICKCONNECT.ORGANIZATIONID = OPUS_CONTACT.ORGANIZATIONID
        name: STAGEOPUS_QUICKCONNECT_ADDKEYS
        noLinkRefs: []
  name: STAGEOPUS_QUICKCONNECT_ADDKEYS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
