fileVersion: 1
id: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
name: S_SHARED_SCHEDULE_20
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: false
  description: "Schedule Type (Code)   'CNTCT' = Contact  'NPBAC' = Contact (Non-Patient Based Activity)  'OTPAT' = Outpatient  'THEAT' = Surgical Theatre"
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce37fc13-5764-42a8-aa66-1712c8dda5f7
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SCHEDULE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4cca5651-a5e9-4e65-94b2-15f67f41b5f4
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SCHEDULE_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b367eca-9a96-476b-a016-f830cb1d0af8
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: SCHEDULE_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f46e424f-3710-4c6f-adb5-12c6c298bdbe
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SCHEDULE_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "'T'+CONVERT(varchar,ds_pims_schedules.schdl_refno)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7127a0e4-ea17-4f16-a793-f88e2447b6fa
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PARENT_SCHEDULE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: adfa2cee-bc9e-499d-99bf-a5cdf05c86bb
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ISNULL(ds_pims_schedules.patnt_refno,ds_pims_schedules_p.patnt_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d78b5ece-e7af-4cc1-8f78-43d5c6ca0782
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ISNULL(ds_pims_schedules.spect_refno,ds_pims_schedules_p.spect_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1df7ca15-8120-4ace-97ea-e2b5fae3e074
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Health Specialty Code
        name: HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 109348be-f733-4626-8957-974595e84a92
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ISNULL(ds_pims_schedules.proca_refno,ds_pims_schedules_p.proca_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2206bb3b-eb12-4e7d-ba17-69e11f99117d
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ISNULL(ds_pims_schedules.spont_refno,ds_pims_schedules_p.spont_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a62c590-83ab-47f4-9ab2-9b8bb83eef93
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WARD_TRANSFER_TO_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5774bc35-f62d-4887-9b10-8ee3ca59166e
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49768b3e-fa7e-4e12-b612-ed39395f5100
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2113670-4e4a-4ead-8dca-d981e906abe9
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ED_ATTENDANCE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45dd9b5d-b92e-48d3-8509-503d9417a4ee
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: IP_WARD_STAY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c723186-856d-4b73-a20b-63dabd99e8ff
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REQUEST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a10c92a-8b6c-48e9-a288-2fe91e0bacd3
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: COALESCE(ds_pims_schedules.start_dttm,ds_pims_schedules_p.start_dttm,CONVERT(datetime,'19840701'))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c58bfd01-b2e9-4134-ac5c-c7e5091e79dc
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: COALESCE(ds_pims_schedules.end_dttm,ds_pims_schedules_p.end_dttm,CONVERT(datetime,'19840701'))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0a835a9-c104-462f-9c06-17e8f903cd81
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CALLED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 30f094ae-a47f-46e5-828c-c12c73725ba9
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ARRIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34fd600c-58eb-43a8-ab9d-0e1983817097
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SEEN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95485db5-a13b-4522-94f8-3c54f3c67513
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DEPARTED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd34fc0c-5a12-4c5e-95df-24947eb0a841
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CANCELLATION_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a35ff29-e4ab-461e-b420-bf7e68d0160b
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: CANCELLATION_REASON_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 56c6a965-16c9-4ca2-b4f2-08ab5b5797db
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CANCELLATION_BY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d078746b-cdcf-4625-9beb-4d8c9036f300
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CANCELLATION_REASON_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 838e67a6-f101-44d9-8253-0a9ed8615ddb
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: INTO_THEATRE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b65348d3-0b12-4a79-b7c0-bea279d11dd0
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: INTO_POSTOP_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96ff87c4-39f5-4f46-becd-1a10e63483fa
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ANAESTHETIC_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e61ba0a-c1ca-4dff-a91f-6602d16cfa65
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SCHEDULE_MOVEMENT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17a2e35a-9bfa-436d-8fd5-90f00317f5d7
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: DECIMAL(4)
        defaultValue: ""
        description: ""
        name: MOVE_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3911de0a-4b70-4a82-8332-03789b1448e7
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SCHEDULE_MOVEMENT_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c42e8bf-b5a4-4bf3-bcb4-55b58ae4fa21
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SCHEDULE_MOVEMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6a4f193-e22c-48ac-8532-7a49c4042ca4
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: schedule_theatre_status_code, "A=Actual", "P=Planned", "C=Cancelled"
        name: SCHEDULE_THEATRE_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE WHEN ds_pims_schedules.cancr_dttm IS NOT NULL THEN 'C'
                          ELSE CASE WHEN ds_pims_schedules.start_dttm IS NOT NULL AND ds_pims_schedules.start_dttm > getdate() THEN 'P' ELSE 'A' END
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71559839-a5ca-4337-b7a0-a49291817d6b
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: schedule_outpatient_status_code, "A=Actual", "P=Planned", "C=Cancelled"
        name: SCHEDULE_OUTPATIENT_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE WHEN ds_pims_schedules.cancr_dttm IS NOT NULL THEN 'C'
                          WHEN ds_pims_schedules.attnd_refno = 11540    THEN 'P'
                          ELSE 'A'
                           END -- Attendance "Not Specified"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1209dc43-cb2e-4039-ad14-84a8e40b7158
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: schedule_contact_status_code, "A=Actual", "P=Planned", "C=Cancelled"
        name: SCHEDULE_CONTACT_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE WHEN ds_pims_schedules.cancr_dttm IS NOT NULL   THEN 'C'
                          WHEN ds_pims_schedules.arrived_dttm IS NOT NULL THEN 'A'
                          ELSE 'P'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3862e289-ed01-44c9-bee1-6a62895623f1
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SERVICE_POINT_SESSION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 240b2a49-67b0-4b30-9a3f-2345ee38c9fb
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: VISIT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a5fbd58-f5f4-47b4-964e-d52478b875ca
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5fd0bc57-764c-48a9-83e8-bb677e73a038
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: URGENCY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d7be49a-af7e-4083-b544-7c4b9fb64ed5
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRIORITY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f117d24-7be7-4103-981c-a32f70e8db52
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: TRANSPORT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c652ce9f-c17b-4785-97a2-79eeb7823da7
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ATTENDANCE_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7dafa3f1-9d1a-4c10-81d1-22dbdca1df3d
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: ATTENDANCE_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32cdfdf2-eb07-4a6b-9e8b-9888b01736d9
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DID_NOT_ATTEND_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96b8a418-ed56-4202-a394-ceeb078baeaf
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SCHEDULE_OUTCOME_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8b17d92-1cc3-4b43-91d4-c84af2183da2
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OLD_SCHEDULE_OUTCOME_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d23561b-ef4e-4d23-b71a-928686f5bcc7
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMIN_CATEGORY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78f8bd5d-887f-4e5b-ac58-51a08162c021
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LOCATION_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81d5a279-d9a9-480a-b050-74bbc3ada85b
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CONTACT_PURPOSE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b3bfaae7-be93-4fe6-8a5c-64879f742f7c
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CONTACT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f4f71413-bb51-4805-bf86-cb69a2439a0f
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: RESOURCE_UNIT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18338180-9534-4a63-af17-6af8c15a0dfe
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAFF_ACTIVITY_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c49cc717-9868-4aba-83a5-31a15737df8b
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SCHEDULE_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 266e6ba7-f76a-4ec6-938f-c753d1fdd6a1
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: SCHEDULE_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a9027f8-7498-479f-a235-632134cd5d88
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREVIOUS_SCHEDULE_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 039b16c8-4031-45b8-84e2-7ea464b0e765
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: MOVE_REQUESTED_BY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07ce3a1a-bf74-4b09-841a-b36b2d88ba91
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CODING_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f4dd6af-96fd-470b-81ea-528e3051caaa
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_CONFIRMATION_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31c8b20d-090d-4e0a-8254-c79abd8b7a5a
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ANAESTHETIC_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 859712ae-8114-45b7-baa1-a6900f4ebd86
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LATE_START_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e359577-1c5b-4774-855d-d614a1ba1e47
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c0ace35-7ba2-4c32-8575-454631bfcb1b
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ANAESTHETIC_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91ea692b-4778-4610-9533-614a4fc18510
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIETARY_REQUIREMENTS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9109c05-cb98-4ef3-ae84-3fa260e4b0e4
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: BOOKING_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1a5c3f5-f1f0-4db4-aad3-a38b092c499b
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FUNDING_ARRANGEMENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3fadb319-30ab-4f60-942b-09890055f668
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CONTACT_RESCHEDULE_BY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: acc87612-4244-43da-9b0a-4d8cbb51715a
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CONTACT_RESCHEDULE_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a876f4cb-6717-4923-bf63-a590cc1c4027
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: UNPLANNED_RETURN_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3be5a6d8-12ad-4db0-808e-ab15c2f46a11
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: APPROXIMATE_SCHEDULE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 567d30cb-eb31-4a49-bf7b-63d76149b1ef
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: OVERBOOKED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 89a84251-93ae-43a1-8393-ed30eb382308
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FOLLOWUP_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d0617afd-9c49-41fd-bee4-15b807e53231
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c231318c-8936-492f-874f-51c2d8725739
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: REASN_COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15b11622-0e75-4256-a176-3faa4a819ec9
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SCHEDULE_DURATION_ARRIVED_TO_DEPARTED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: DATEDIFF(mi,ds_pims_schedules.arrived_dttm,ds_pims_schedules.departed_dttm)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: afda7b4a-649c-47ec-8141-89add9f618af
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SCHEDULE_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ISNULL(CONVERT(integer,ds_pims_schedules.duration),DATEDIFF(mi,ds_pims_schedules.start_dttm,ds_pims_schedules.end_dttm))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bc09c78d-933b-4df2-a15f-51d857632d0c
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OPERATION_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e65d34df-ebf0-40fa-a028-fcb59986a573
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ANAESTHETIC_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e3d232e-1d32-4958-a255-a46c5e2f5487
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_SCHEDULE_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE WHEN ds_pims_schedules.patnt_refno IS NOT NULL THEN (ROW_NUMBER() OVER (PARTITION BY ds_pims_schedules.patnt_refno, ds_pims_schedules.sctyp_refno ORDER BY ISNULL(ds_pims_schedules.start_dttm,getdate())))
                          ELSE 1
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71c90be4-5536-4ffb-80ea-bc6a98129e30
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_SCHEDULE_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE WHEN ds_pims_schedules.patnt_refno IS NOT NULL THEN (COUNT(1) OVER (PARTITION BY ds_pims_schedules.patnt_refno,ds_pims_schedules.sctyp_refno))
                          ELSE 1
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 553085f0-03c6-4aa4-a7fc-4e3e29c51b60
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Sequence for appointment within waitlist ordered from oldest to most recent
        name: WAITLIST_SCHEDULE_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ROW_NUMBER() OVER (PARTITION BY isnull(ds_pims_schedules.wlist_refno,ds_pims_schedules.refrl_refno) ORDER BY ISNULL(ds_pims_schedules.start_dttm,getdate())DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 12f98fb3-2eeb-46ef-9f02-797efd802000
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Sequence for appointment within waitlist ordered from most recent to oldest
        name: WAITLIST_SCHEDULE_REV_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ROW_NUMBER() OVER (PARTITION BY isnull(ds_pims_schedules.wlist_refno,ds_pims_schedules.refrl_refno) ORDER BY ISNULL(ds_pims_schedules.start_dttm,getdate())DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f051258-37b2-48fa-bcf9-9a68eaaf49d3
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Count of appointments on this waitlist
        name: WAITLIST_APPOINTMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: count(*) OVER (PARTITION BY isnull(ds_pims_schedules.wlist_refno,ds_pims_schedules.refrl_refno) ORDER BY ISNULL(ds_pims_schedules.start_dttm,getdate())DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 73c18d95-dbf2-4bfe-850f-86e33bf40f3e
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_SCHEDULE_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE WHEN ds_pims_schedules.refrl_refno IS NOT NULL THEN (ROW_NUMBER() OVER (PARTITION BY ds_pims_schedules.refrl_refno ORDER BY ISNULL(ds_pims_schedules.start_dttm,getdate())DESC))
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 346a87d8-6880-4415-920f-1ffcb7b530fa
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_SCHEDULE_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE WHEN ds_pims_schedules.refrl_refno IS NOT NULL THEN (COUNT(1) OVER (PARTITION BY ds_pims_schedules.refrl_refno))
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a03a500-ed10-406c-8672-6d621365b9bf
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: PRVSP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ee46b62-c208-4785-9a96-8a50d7a0cf81
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5e9c281-e662-46dc-9478-7d161be48f59
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d3ed342-fc1b-4c9e-9616-e3f8e781640c
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIFY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f34b47f-14c3-46fa-b421-d60f6885f8a2
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MODIFY_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7ba2844-90a0-4a4e-9c24-a2f21edf7669
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DSS_DATA_QUALITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN ((ds_pims_schedules.start_dttm IS NULL AND ds_pims_schedules.end_dttm IS NOT NULL) OR ds_pims_schedules.start_dttm > ds_pims_schedules.end_dttm OR ds_pims_schedules.start_dttm < '1984-07-01') OR ((ds_pims_schedules.arrived_dttm IS NULL AND ds_pims_schedules.departed_dttm IS NOT NULL) OR ds_pims_schedules.arrived_dttm > ds_pims_schedules.departed_dttm) OR (ds_pims_schedules.reqst_dttm > ds_pims_schedules.start_dttm) THEN 'DT'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aaaaf0ba-68b0-4bd0-8c7e-3e3b73704b20
          stepCounter: bb15cd9d-73ec-430f-ad2f-68dcfe439dd4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: UNKNOWN
            nodeName: DS_PIMS_SCHEDULES
          - locationName: UNKNOWN
            nodeName: DS_PIMS_SERVICE_POINTS
          - locationName: UNKNOWN
            nodeName: S_HEALTH_ORG_2
          - locationName: UNKNOWN
            nodeName: S_PIMS_PROVIDER_SPELLS
          - locationName: UNKNOWN
            nodeName: S_HEALTH_SPECIALTY_V
          - locationName: UNKNOWN
            nodeName: DS_PIMS_REFERENCE_VALUES
        join:
          joinCondition: |-
            FROM s_shared_schedule_10
              JOIN ds_pims_schedules
                ON s_shared_schedule_10.patnt_refno= ds_pims_schedules.patnt_refno -- LEFT OUTER JOIN ds_pims_schedules ds_pims_schedules_parent     -- ON ds_pims_schedules.parnt_refno IS NOT NULL     -- AND ds_pims_schedules.parnt_refno = ds_pims_schedules_parent.schdl_refno       LEFT OUTER JOIN ds_pims_schedules ds_pims_schedules_p    ON ds_pims_schedules.parnt_refno IS NOT NULL AND ds_pims_schedules_p.schdl_refno = ds_pims_schedules.parnt_refno          LEFT OUTER JOIN dim.dim_schedule_status    ON ds_pims_schedules.scsda_refno = dim_schedule_status.schedule_status_reference_no    AND ISNULL(ds_pims_schedules.start_dttm,ds_pims_schedules.create_dttm) BETWEEN dim_schedule_status.dss_start_date AND dim_schedule_status.dss_end_date       LEFT OUTER JOIN dim.dim_cancellation_reason    ON ds_pims_schedules.cancr_refno = dim_cancellation_reason.cancellation_reason_reference_no    AND ISNULL(ds_pims_schedules.start_dttm,ds_pims_schedules.create_dttm) BETWEEN dim_cancellation_reason.dss_start_date AND dim_cancellation_reason.dss_end_date      LEFT OUTER JOIN dim.dim_attendance_status    ON ds_pims_schedules.attnd_refno = dim_attendance_status.attendance_status_reference_no     AND ISNULL(ds_pims_schedules.start_dttm,ds_pims_schedules.create_dttm) BETWEEN dim_attendance_status.dss_start_date AND dim_attendance_status.dss_end_date    LEFT OUTER JOIN {{ ref('UNKNOWN','DS_PIMS_SERVICE_POINTS') }}  ON ds_pims_schedules.spont_refno = ds_pims_service_points.spont_refno  LEFT OUTER JOIN {{ ref('UNKNOWN','S_HEALTH_ORG_2') }}  ON ds_pims_service_points.heorg_refno = s_health_org_2.health_org_reference_no    LEFT OUTER JOIN {{ ref('UNKNOWN','S_PIMS_PROVIDER_SPELLS') }}  ON ds_pims_schedules.patnt_refno = s_pims_provider_spells.patnt_refno      and ( COALESCE (ds_pims_schedules.into_theatre_dttm,ds_pims_Schedules.arrived_dttm,ds_pims_schedules.start_dttm)   between s_pims_provider_spells.admit_dttm and isnull(s_pims_provider_spells.disch_dttm,getdate())  or coalesce(ds_pims_Schedules.departed_dttm,ds_pims_schedules.end_dttm)  between s_pims_provider_spells.admit_dttm and isnull(s_pims_provider_spells.disch_dttm,getdate()))  and s_pims_provider_spells.hospital_id = s_health_org_2.hospital_id  LEFT OUTER JOIN {{ ref('UNKNOWN','S_HEALTH_SPECIALTY_V') }}  ON ds_pims_schedules.spect_refno = s_health_specialty_v.specialty_reference_no  LEFT OUTER JOIN {{ ref('UNKNOWN','DS_PIMS_REFERENCE_VALUES') }}  ON ds_pims_schedules.sctyp_refno = ds_pims_reference_values.rfval_refno  LEFT OUTER JOIN {{ ref('UNKNOWN','DS_PIMS_REFERENCE_VALUES') }} cancr  on ds_pims_schedules.cancr_refno = cancr.rfval_refno  LEFT OUTER JOIN {{ ref('UNKNOWN','DS_PIMS_REFERENCE_VALUES') }} attnd  on ds_pims_schedules.attnd_refno = attnd.rfval_refno  LEFT OUTER JOIN {{ ref('UNKNOWN','DS_PIMS_REFERENCE_VALUES') }} scsda  on ds_pims_schedules.scsda_refno = scsda.rfval_refno
        name: S_SHARED_SCHEDULE_20
        noLinkRefs: []
  name: S_SHARED_SCHEDULE_20
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
