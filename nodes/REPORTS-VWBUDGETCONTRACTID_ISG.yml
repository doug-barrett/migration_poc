fileVersion: 1
id: d6bcb1c3-4842-491b-90af-8a93f89f8d34
name: VWBUDGETCONTRACTID_ISG
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: REPORTS
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9f83c7c-a25d-449b-88b1-14c44b12dfe0
          stepCounter: d6bcb1c3-4842-491b-90af-8a93f89f8d34
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CONTRACTID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c368e03-6811-407c-965a-599d0ec5b9c9
          stepCounter: d6bcb1c3-4842-491b-90af-8a93f89f8d34
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: BUDGETDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f5246a7-4fb3-4dce-9d14-e2b694e26f59
          stepCounter: d6bcb1c3-4842-491b-90af-8a93f89f8d34
        config: {}
        dataType: DECIMAL(18,2)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: BUDGETSALESAMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e697f543-7341-4683-8fb6-35a16237bacd
          stepCounter: d6bcb1c3-4842-491b-90af-8a93f89f8d34
        config: {}
        dataType: DECIMAL(18,2)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: BUDGETREVENUEAMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d5ff054-74a6-461c-bc3f-bb0e3b74c455
          stepCounter: d6bcb1c3-4842-491b-90af-8a93f89f8d34
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: BUDGETTYPE
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            WITH PDBudget_ISG AS (
                    SELECT '2019-01-01' [bd],
                           '2014' [cid],
                           163182 revAmt,
                           3971308 slsAmt
                     UNION SELECT '2019-02-01' [bd],
                           '2014' [cid],
                           144051 revAmt,
                           3598129 slsAmt
                     UNION SELECT '2019-03-01' [bd],
                           '2014' [cid],
                           143780 revAmt,
                           3474950 slsAmt
                     UNION SELECT '2019-04-01' [bd],
                           '2014' [cid],
                           143708 revAmt,
                           3480159 slsAmt
                     UNION SELECT '2019-05-01' [bd],
                           '2014' [cid],
                           144358 revAmt,
                           3492844 slsAmt
                     UNION SELECT '2019-06-01' [bd],
                           '2014' [cid],
                           119675 revAmt,
                           2929457 slsAmt
                     UNION SELECT '2019-07-01' [bd],
                           '2014' [cid],
                           157221 revAmt,
                           4236563 slsAmt
                     UNION SELECT '2019-08-01' [bd],
                           '2014' [cid],
                           153886 revAmt,
                           3999544 slsAmt
                     UNION SELECT '2019-09-01' [bd],
                           '2014' [cid],
                           137969 revAmt,
                           3503173 slsAmt
                     UNION SELECT '2019-10-01' [bd],
                           '2014' [cid],
                           167460 revAmt,
                           4348454 slsAmt
                     UNION SELECT '2019-11-01' [bd],
                           '2014' [cid],
                           140500 revAmt,
                           3657942 slsAmt
                     UNION SELECT '2019-12-01' [bd],
                           '2014' [cid],
                           132591 revAmt,
                           3460571 slsAmt
                     UNION SELECT '2020-01-01' [bd],
                           '2014' [cid],
                           163056.927773985 revAmt,
                           4077080.19291324 slsAmt
                     UNION SELECT '2020-02-01' [bd],
                           '2014' [cid],
                           157798.281666258 revAmt,
                           3945592.85177389 slsAmt
                     UNION SELECT '2020-03-01' [bd],
                           '2014' [cid],
                           170784.272640052 revAmt,
                           4270294.95003734 slsAmt
                     UNION SELECT '2020-04-01' [bd],
                           '2014' [cid],
                           165391.838398267 revAmt,
                           4135462.3664795 slsAmt
                     UNION SELECT '2020-05-01' [bd],
                           '2014' [cid],
                           166086.906879477 revAmt,
                           4152841.87912058 slsAmt
                     UNION SELECT '2020-06-01' [bd],
                           '2014' [cid],
                           169334.774059481 revAmt,
                           4234051.64511814 slsAmt
                     UNION SELECT '2020-07-01' [bd],
                           '2014' [cid],
                           163812.139819499 revAmt,
                           4095963.5369959 slsAmt
                     UNION SELECT '2020-08-01' [bd],
                           '2014' [cid],
                           166714.074787305 revAmt,
                           4168523.60383809 slsAmt
                     UNION SELECT '2020-09-01' [bd],
                           '2014' [cid],
                           155492.754358833 revAmt,
                           3887945.37952204 slsAmt
                     UNION SELECT '2020-10-01' [bd],
                           '2014' [cid],
                           195631.493738333 revAmt,
                           4891575.59337902 slsAmt
                     UNION SELECT '2020-11-01' [bd],
                           '2014' [cid],
                           167199.478071832 revAmt,
                           4180660.64176672 slsAmt
                     UNION SELECT '2020-12-01' [bd],
                           '2014' [cid],
                           146364.511138994 revAmt,
                           3659702.5189716 slsAmt
                     UNION SELECT '2019-01-01' [bd],
                           '2015' [cid],
                           68843 revAmt,
                           2294781 slsAmt
                     UNION SELECT '2019-02-01' [bd],
                           '2015' [cid],
                           71550 revAmt,
                           2384986 slsAmt
                     UNION SELECT '2019-03-01' [bd],
                           '2015' [cid],
                           159662 revAmt,
                           5322066 slsAmt
                     UNION SELECT '2019-04-01' [bd],
                           '2015' [cid],
                           119662 revAmt,
                           3988736 slsAmt
                     UNION SELECT '2019-05-01' [bd],
                           '2015' [cid],
                           79937 revAmt,
                           2664568 slsAmt
                     UNION SELECT '2019-06-01' [bd],
                           '2015' [cid],
                           92075 revAmt,
                           3069156 slsAmt
                     UNION SELECT '2019-07-01' [bd],
                           '2015' [cid],
                           72796 revAmt,
                           2426522 slsAmt
                     UNION SELECT '2019-08-01' [bd],
                           '2015' [cid],
                           93064 revAmt,
                           3102124 slsAmt
                     UNION SELECT '2019-09-01' [bd],
                           '2015' [cid],
                           90714 revAmt,
                           3023793 slsAmt
                     UNION SELECT '2019-10-01' [bd],
                           '2015' [cid],
                           101671 revAmt,
                           3389033 slsAmt
                     UNION SELECT '2019-11-01' [bd],
                           '2015' [cid],
                           116255 revAmt,
                           3875150 slsAmt
                     UNION SELECT '2019-12-01' [bd],
                           '2015' [cid],
                           93428 revAmt,
                           3114272 slsAmt
                     UNION SELECT '2020-01-01' [bd],
                           '2015' [cid],
                           128102.125176052 revAmt,
                           4815426.52068849 slsAmt
                     UNION SELECT '2020-02-01' [bd],
                           '2015' [cid],
                           123970.784354505 revAmt,
                           4660127.23794252 slsAmt
                     UNION SELECT '2020-03-01' [bd],
                           '2015' [cid],
                           134172.945427759 revAmt,
                           5043631.85921997 slsAmt
                     UNION SELECT '2020-04-01' [bd],
                           '2015' [cid],
                           129936.496871569 revAmt,
                           4884381.52123401 slsAmt
                     UNION SELECT '2020-05-01' [bd],
                           '2015' [cid],
                           130482.562290571 revAmt,
                           4904908.40864572 slsAmt
                     UNION SELECT '2020-06-01' [bd],
                           '2015' [cid],
                           133034.178426898 revAmt,
                           5000825.00641176 slsAmt
                     UNION SELECT '2020-07-01' [bd],
                           '2015' [cid],
                           128695.441076883 revAmt,
                           4837729.57865948 slsAmt
                     UNION SELECT '2020-08-01' [bd],
                           '2015' [cid],
                           130975.283102447 revAmt,
                           4923430.04411075 slsAmt
                     UNION SELECT '2020-09-01' [bd],
                           '2015' [cid],
                           122159.497022133 revAmt,
                           4592039.99079571 slsAmt
                     UNION SELECT '2020-10-01' [bd],
                           '2015' [cid],
                           153693.623701675 revAmt,
                           5777424.46205819 slsAmt
                     UNION SELECT '2020-11-01' [bd],
                           '2015' [cid],
                           131356.629624574 revAmt,
                           4937765.06122073 slsAmt
                     UNION SELECT '2020-12-01' [bd],
                           '2015' [cid],
                           114988.091479609 revAmt,
                           4322463.07009575 slsAmt
                     UNION SELECT '2019-01-01' [bd],
                           '2016' [cid],
                           85086 revAmt,
                           1282064 slsAmt
                     UNION SELECT '2019-02-01' [bd],
                           '2016' [cid],
                           89770 revAmt,
                           1339281 slsAmt
                     UNION SELECT '2019-03-01' [bd],
                           '2016' [cid],
                           113105 revAmt,
                           1693734 slsAmt
                     UNION SELECT '2019-04-01' [bd],
                           '2016' [cid],
                           109921 revAmt,
                           1643458 slsAmt
                     UNION SELECT '2019-05-01' [bd],
                           '2016' [cid],
                           112280 revAmt,
                           1681945 slsAmt
                     UNION SELECT '2019-06-01' [bd],
                           '2016' [cid],
                           113946 revAmt,
                           1710424 slsAmt
                     UNION SELECT '2019-07-01' [bd],
                           '2016' [cid],
                           111412 revAmt,
                           1658825 slsAmt
                     UNION SELECT '2019-08-01' [bd],
                           '2016' [cid],
                           126279 revAmt,
                           1879969 slsAmt
                     UNION SELECT '2019-09-01' [bd],
                           '2016' [cid],
                           115580 revAmt,
                           1725220 slsAmt
                     UNION SELECT '2019-10-01' [bd],
                           '2016' [cid],
                           127324 revAmt,
                           1889662 slsAmt
                     UNION SELECT '2019-11-01' [bd],
                           '2016' [cid],
                           116076 revAmt,
                           1721905 slsAmt
                     UNION SELECT '2019-12-01' [bd],
                           '2016' [cid],
                           104959 revAmt,
                           1563407 slsAmt
                     UNION SELECT '2020-01-01' [bd],
                           '2016' [cid],
                           69105.5702027563 revAmt,
                           2129066.69183256 slsAmt
                     UNION SELECT '2020-02-01' [bd],
                           '2016' [cid],
                           66876.8900557056 revAmt,
                           2060403.50514714 slsAmt
                     UNION SELECT '2020-03-01' [bd],
                           '2016' [cid],
                           72380.515833175 revAmt,
                           2229964.16853132 slsAmt
                     UNION SELECT '2020-04-01' [bd],
                           '2016' [cid],
                           70095.1345976352 revAmt,
                           2159554.08360689 slsAmt
                     UNION SELECT '2020-05-01' [bd],
                           '2016' [cid],
                           70389.7133339071 revAmt,
                           2168629.73081852 slsAmt
                     UNION SELECT '2020-06-01' [bd],
                           '2016' [cid],
                           71766.2001626549 revAmt,
                           2211037.77766966 slsAmt
                     UNION SELECT '2020-07-01' [bd],
                           '2016' [cid],
                           69425.638535588 revAmt,
                           2138927.64550884 slsAmt
                     UNION SELECT '2020-08-01' [bd],
                           '2016' [cid],
                           70655.5149559232 revAmt,
                           2176818.78675727 slsAmt
                     UNION SELECT '2020-09-01' [bd],
                           '2016' [cid],
                           65899.7786788835 revAmt,
                           2030299.77717704 slsAmt
                     UNION SELECT '2020-10-01' [bd],
                           '2016' [cid],
                           82911.0796392757 revAmt,
                           2554399.26949359 slsAmt
                     UNION SELECT '2020-11-01' [bd],
                           '2016' [cid],
                           70861.2349533097 revAmt,
                           2183156.79385271 slsAmt
                     UNION SELECT '2020-12-01' [bd],
                           '2016' [cid],
                           62031.1147633533 revAmt,
                           1911110.49243077 slsAmt
                     UNION SELECT '2019-01-01' [bd],
                           '2017' [cid],
                           25591 revAmt,
                           1707027 slsAmt
                     UNION SELECT '2019-02-01' [bd],
                           '2017' [cid],
                           18396 revAmt,
                           1392827 slsAmt
                     UNION SELECT '2019-03-01' [bd],
                           '2017' [cid],
                           20143 revAmt,
                           1250014 slsAmt
                     UNION SELECT '2019-04-01' [bd],
                           '2017' [cid],
                           37742 revAmt,
                           1951334 slsAmt
                     UNION SELECT '2019-05-01' [bd],
                           '2017' [cid],
                           36031 revAmt,
                           1875200 slsAmt
                     UNION SELECT '2019-06-01' [bd],
                           '2017' [cid],
                           43415 revAmt,
                           2610656 slsAmt
                     UNION SELECT '2019-07-01' [bd],
                           '2017' [cid],
                           38173 revAmt,
                           2070679 slsAmt
                     UNION SELECT '2019-08-01' [bd],
                           '2017' [cid],
                           40138 revAmt,
                           2382631 slsAmt
                     UNION SELECT '2019-09-01' [bd],
                           '2017' [cid],
                           32440 revAmt,
                           2089397 slsAmt
                     UNION SELECT '2019-10-01' [bd],
                           '2017' [cid],
                           42797 revAmt,
                           2632034 slsAmt
                     UNION SELECT '2019-11-01' [bd],
                           '2017' [cid],
                           37948 revAmt,
                           2169166 slsAmt
                     UNION SELECT '2019-12-01' [bd],
                           '2017' [cid],
                           31769 revAmt,
                           1946332 slsAmt
                     UNION SELECT '2020-01-01' [bd],
                           '2017' [cid],
                           86129.1408731121 revAmt,
                           1663697.16731032 slsAmt
                     UNION SELECT '2020-02-01' [bd],
                           '2017' [cid],
                           83351.4442882602 revAmt,
                           1610042.31956635 slsAmt
                     UNION SELECT '2020-03-01' [bd],
                           '2017' [cid],
                           90210.8415627457 revAmt,
                           1742540.5623136 slsAmt
                     UNION SELECT '2020-04-01' [bd],
                           '2017' [cid],
                           87362.4760575187 revAmt,
                           1687520.65181093 slsAmt
                     UNION SELECT '2020-05-01' [bd],
                           '2017' [cid],
                           87729.6217651678 revAmt,
                           1694612.55203905 slsAmt
                     UNION SELECT '2020-06-01' [bd],
                           '2017' [cid],
                           89445.1944409357 revAmt,
                           1727751.0853166 slsAmt
                     UNION SELECT '2020-07-01' [bd],
                           '2017' [cid],
                           86528.0553230848 revAmt,
                           1671402.7224069 slsAmt
                     UNION SELECT '2020-08-01' [bd],
                           '2017' [cid],
                           88060.9013607165 revAmt,
                           1701011.65133477 slsAmt
                     UNION SELECT '2020-09-01' [bd],
                           '2017' [cid],
                           82133.6298172109 revAmt,
                           1586518.63797316 slsAmt
                     UNION SELECT '2020-10-01' [bd],
                           '2017' [cid],
                           103335.520381947 revAmt,
                           1996060.92431897 slsAmt
                     UNION SELECT '2020-11-01' [bd],
                           '2017' [cid],
                           88317.2987333643 revAmt,
                           1705964.30241495 slsAmt
                     UNION SELECT '2020-12-01' [bd],
                           '2017' [cid],
                           77311.9533822463 revAmt,
                           1493381.64223376 slsAmt
                     UNION SELECT '2019-01-01' [bd],
                           '2018' [cid],
                           72225 revAmt,
                           1778571 slsAmt
                     UNION SELECT '2019-02-01' [bd],
                           '2018' [cid],
                           54769 revAmt,
                           1394463 slsAmt
                     UNION SELECT '2019-03-01' [bd],
                           '2018' [cid],
                           40966 revAmt,
                           1137316 slsAmt
                     UNION SELECT '2019-04-01' [bd],
                           '2018' [cid],
                           55393 revAmt,
                           1370921 slsAmt
                     UNION SELECT '2019-05-01' [bd],
                           '2018' [cid],
                           74734 revAmt,
                           1851619 slsAmt
                     UNION SELECT '2019-06-01' [bd],
                           '2018' [cid],
                           27469 revAmt,
                           838646 slsAmt
                     UNION SELECT '2019-07-01' [bd],
                           '2018' [cid],
                           59670 revAmt,
                           1529379 slsAmt
                     UNION SELECT '2019-08-01' [bd],
                           '2018' [cid],
                           55239 revAmt,
                           1401110 slsAmt
                     UNION SELECT '2019-09-01' [bd],
                           '2018' [cid],
                           36859 revAmt,
                           1018259 slsAmt
                     UNION SELECT '2019-10-01' [bd],
                           '2018' [cid],
                           65336 revAmt,
                           1680377 slsAmt
                     UNION SELECT '2019-11-01' [bd],
                           '2018' [cid],
                           51789 revAmt,
                           1354174 slsAmt
                     UNION SELECT '2019-12-01' [bd],
                           '2018' [cid],
                           41753 revAmt,
                           1172716 slsAmt
                     UNION SELECT '2020-01-01' [bd],
                           '2018' [cid],
                           61142.3422549481 revAmt,
                           2336454.58390644 slsAmt
                     UNION SELECT '2020-02-01' [bd],
                           '2018' [cid],
                           59170.4791485737 revAmt,
                           2261103.06115133 slsAmt
                     UNION SELECT '2020-03-01' [bd],
                           '2018' [cid],
                           64039.9067495888 revAmt,
                           2447180.27081974 slsAmt
                     UNION SELECT '2020-04-01' [bd],
                           '2018' [cid],
                           62017.8763795849 revAmt,
                           2369911.6881558 slsAmt
                     UNION SELECT '2020-05-01' [bd],
                           '2018' [cid],
                           62278.5099849704 revAmt,
                           2379871.37500397 slsAmt
                     UNION SELECT '2020-06-01' [bd],
                           '2018' [cid],
                           63496.3803902908 revAmt,
                           2426410.30017713 slsAmt
                     UNION SELECT '2020-07-01' [bd],
                           '2018' [cid],
                           61425.5282194593 revAmt,
                           2347276.07226423 slsAmt
                     UNION SELECT '2020-08-01' [bd],
                           '2018' [cid],
                           62513.6825433843 revAmt,
                           2388858.10959494 slsAmt
                     UNION SELECT '2020-09-01' [bd],
                           '2018' [cid],
                           58305.9630459271 revAmt,
                           2228066.99258746 slsAmt
                     UNION SELECT '2020-10-01' [bd],
                           '2018' [cid],
                           73357.0042640306 revAmt,
                           2803217.91009679 slsAmt
                     UNION SELECT '2020-11-01' [bd],
                           '2018' [cid],
                           62695.6968506534 revAmt,
                           2395813.48858226 slsAmt
                     UNION SELECT '2020-12-01' [bd],
                           '2018' [cid],
                           54883.0960831236 revAmt,
                           2097267.73121803 slsAmt
                   ) SELECT pi.[cid] AS ContractId,
                   cast(pi.[bd] AS Date) AS BudgetDate,
                   pi.[slsAmt] AS BudgetSalesAmount,
                   pi.[revAmt] AS BudgetRevenueAmount,
                   'PD Budget - ISG' AS BudgetType
              FROM [PDBudget_ISG] AS pi
             WHERE year(cast(pi.[bd] AS Date)) = 2020
        dependencies: []
        join:
          joinCondition: '-- Nodes used in the SQL override:'
        name: VWBUDGETCONTRACTID_ISG
        noLinkRefs: []
  name: VWBUDGETCONTRACTID_ISG
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
