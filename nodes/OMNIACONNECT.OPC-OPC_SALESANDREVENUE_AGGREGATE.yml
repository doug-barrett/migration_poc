fileVersion: 1
id: ca262a07-9f01-4bf9-a827-3275ced9acb1
name: OPC_SALESANDREVENUE_AGGREGATE
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: OMNIACONNECT.OPC
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 211129a5-d264-473f-b81d-c23fb869cd1e
          stepCounter: ca262a07-9f01-4bf9-a827-3275ced9acb1
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 834b3aa6-5a4c-4a85-ad0b-dc3108366feb
                stepCounter: 8fc70a2e-470f-4897-96e5-2979c1460b5c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32eea7fb-778a-4cc6-8dea-e8c29c9ff7bf
          stepCounter: ca262a07-9f01-4bf9-a827-3275ced9acb1
        config: {}
        dataType: INT
        defaultValue: ""
        description: UNIQUE IDENTIFIER FOR AN ACCOUNT. COMMONLY CALLED THE "FORCE ID"
        isBusinessKey: true
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c056063e-f309-4116-89d2-8118d5ecfee2
                stepCounter: 8fc70a2e-470f-4897-96e5-2979c1460b5c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a38fc8b-be68-4b05-91e1-112ff694d1d4
          stepCounter: ca262a07-9f01-4bf9-a827-3275ced9acb1
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22d14bcd-b51a-48b0-80ad-13976788bd06
                stepCounter: 8fc70a2e-470f-4897-96e5-2979c1460b5c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07649e0b-cf43-44e4-b924-e953d898cd77
          stepCounter: ca262a07-9f01-4bf9-a827-3275ced9acb1
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: TRANSACTIONDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 541f92a2-5e8e-4f01-b764-dae68ca5a7ce
                stepCounter: 8fc70a2e-470f-4897-96e5-2979c1460b5c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b0d83be-6a62-4429-acfb-6404e96b984b
          stepCounter: ca262a07-9f01-4bf9-a827-3275ced9acb1
        config: {}
        dataType: INT
        defaultValue: ""
        description: TRANSACTION YEAR
        name: TRANSACTION_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 541f92a2-5e8e-4f01-b764-dae68ca5a7ce
                stepCounter: 8fc70a2e-470f-4897-96e5-2979c1460b5c
            transform: YEAR(OPC_SALESANDREVENUE.TRANSACTIONDATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae52de9e-590e-4ecd-9113-4b08e654c267
          stepCounter: ca262a07-9f01-4bf9-a827-3275ced9acb1
        config: {}
        dataType: INT
        defaultValue: ""
        description: TRANSACTION MONTH
        name: TRANSACTION_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 541f92a2-5e8e-4f01-b764-dae68ca5a7ce
                stepCounter: 8fc70a2e-470f-4897-96e5-2979c1460b5c
            transform: MONTH(OPC_SALESANDREVENUE.TRANSACTIONDATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c56d9dc-caac-4ccd-813a-3e9e2fddeb34
          stepCounter: ca262a07-9f01-4bf9-a827-3275ced9acb1
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ""
        name: SALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0555abb6-33e7-49a0-9bb8-a9089ea89997
                stepCounter: 8fc70a2e-470f-4897-96e5-2979c1460b5c
            transform: SUM(OPC_SALESANDREVENUE.SALES)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be319e21-50d1-4c8b-975a-3e5da2580a6c
          stepCounter: ca262a07-9f01-4bf9-a827-3275ced9acb1
        config: {}
        dataType: INT
        defaultValue: ""
        description: SUPPLIER COUNT
        name: SUPPLIER_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22d14bcd-b51a-48b0-80ad-13976788bd06
                stepCounter: 8fc70a2e-470f-4897-96e5-2979c1460b5c
            transform: COUNT(OPC_SALESANDREVENUE.SUPPLIERID)
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          OPC_SALESANDREVENUE: 8fc70a2e-470f-4897-96e5-2979c1460b5c
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: OMNIACONNECT.OPC
            nodeName: OPC_SALESANDREVENUE
        join:
          joinCondition: |-
            FROM {{ ref('OMNIACONNECT.OPC','OPC_SALESANDREVENUE') }} OPC_SALESANDREVENUE
             GROUP BY OPC_SALESANDREVENUE.LEVEL1FORCEID,
                      OPC_SALESANDREVENUE.FORCEID,
                      OPC_SALESANDREVENUE.SUPPLIERID,
                      OPC_SALESANDREVENUE.TRANSACTIONDATE
        name: OPC_SALESANDREVENUE_AGGREGATE
        noLinkRefs: []
  name: OPC_SALESANDREVENUE_AGGREGATE
  overrideSQL: false
  schema: ""
  sqlType: Agreggate
  type: sql
  version: 1
type: Node
