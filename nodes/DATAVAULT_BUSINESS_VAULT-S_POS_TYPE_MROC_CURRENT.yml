fileVersion: 1
id: c88cf564-7534-49b2-a674-caf422bbe56c
name: S_POS_TYPE_MROC_CURRENT
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DATAVAULT_BUSINESS_VAULT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95f7e8c7-d993-4420-b992-c8a9f153d1c4
          stepCounter: c88cf564-7534-49b2-a674-caf422bbe56c
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: ""
        name: HK_H_POS_TYPE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21e7a034-7393-4c60-8385-47f5dddfbeae
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e36c541-5275-4a30-a8b9-00ece2d00f06
          stepCounter: c88cf564-7534-49b2-a674-caf422bbe56c
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 392fcee3-edaf-4807-b16f-2d3aa5f29cf3
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b50eb44f-9497-4f8f-a27f-2b956b374d09
          stepCounter: c88cf564-7534-49b2-a674-caf422bbe56c
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: FILE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 191d9ac3-ccfc-407a-a19d-9d9fc312db03
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21e456fb-b96e-4b6f-962c-beb909af7b84
          stepCounter: c88cf564-7534-49b2-a674-caf422bbe56c
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: POS_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: efe5c794-fed1-4406-8c0c-ff6ec4a76f5b
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6175b6dd-f7b9-46c8-a411-213f79d836d0
          stepCounter: c88cf564-7534-49b2-a674-caf422bbe56c
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: POS_TYPE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90b9804a-64fd-4ff1-94cc-a038e0a9d084
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f0acad3-08c6-4499-bcd2-ef1c18984e7f
          stepCounter: c88cf564-7534-49b2-a674-caf422bbe56c
        config: {}
        dataType: VARCHAR(11)
        defaultValue: ""
        description: ""
        name: POS_TYPE_INST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 14114d2a-03b8-41bc-aeaf-edf7f4ebd2b5
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67b2a778-b03d-48f0-8810-186b52428f61
          stepCounter: c88cf564-7534-49b2-a674-caf422bbe56c
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: POS_HARDWARE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 82ec5f39-e66d-497d-bb65-953aa7113cbd
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 317617d2-dc4b-4bef-9db1-8cfd5bc70b5f
          stepCounter: c88cf564-7534-49b2-a674-caf422bbe56c
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: POS_PROFILE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d70c6f04-ee48-4464-90d7-f6ea31c2ac5c
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5af0416-4490-480f-bd00-fc7736c57e3d
          stepCounter: c88cf564-7534-49b2-a674-caf422bbe56c
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: USE_MCC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c0a2ce41-76c0-4d5a-8de5-8c2ddc42eb29
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f136ead6-64dc-4750-8a28-b267c70be6ac
          stepCounter: c88cf564-7534-49b2-a674-caf422bbe56c
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: USE_LANGUAGE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db9f8385-7869-4a91-9c75-df1ecd886d88
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e53ae174-277b-41d1-9134-fc81d019380a
          stepCounter: c88cf564-7534-49b2-a674-caf422bbe56c
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: MODEL_VHQ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab51d28e-f0ea-48ca-8f46-b1ec8782f426
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc7bec15-0fab-45bc-8ff3-2435223fd41f
          stepCounter: c88cf564-7534-49b2-a674-caf422bbe56c
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: MODEL_BFIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b37756e6-72f4-42e9-87b2-4de74aa7c129
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c13061f0-ee17-4fbe-96e7-ed30233f8651
          stepCounter: c88cf564-7534-49b2-a674-caf422bbe56c
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: POS_TYPE_VIRTUAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84dfe693-fc4f-46cf-a926-4fb2ae2777f3
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6c72227-44c2-48c5-8cea-7bc837b86c09
          stepCounter: c88cf564-7534-49b2-a674-caf422bbe56c
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: POS_TYPE_ID_INDEX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 246ea9ed-67ca-4a41-a174-7a1321b64b57
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8a5cfd5-4a9a-4709-beb1-6c565062b9c1
          stepCounter: c88cf564-7534-49b2-a674-caf422bbe56c
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: POS_TYPE_SN_REQ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4f7c3459-fe95-4ba7-9f07-955e82d2b5ea
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06f6fe82-f9de-4812-87f5-7d91356870e4
          stepCounter: c88cf564-7534-49b2-a674-caf422bbe56c
        config: {}
        dataType: VARCHAR(19)
        defaultValue: ""
        description: ""
        name: POS_TYPE_POS_ID_IDX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7833af7d-cb68-4c9d-8ab3-5a9ee738323e
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70554b55-dddf-402e-8918-d1d75637dcd2
          stepCounter: c88cf564-7534-49b2-a674-caf422bbe56c
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: POS_TYPE_TMS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cdbec8f7-76db-41ef-a075-2606b524b49d
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ee0c142-8e3d-4fc3-ad9e-9379dc2f1db2
          stepCounter: c88cf564-7534-49b2-a674-caf422bbe56c
        config: {}
        dataType: NUMBER(38,0)
        defaultValue: ""
        description: ""
        name: POS_TMS_ENABLED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ef7c7b3-8ab4-426f-9df2-9eff3d460f3c
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 132456ac-cee3-437a-9be4-0530ce0517a5
          stepCounter: c88cf564-7534-49b2-a674-caf422bbe56c
        config: {}
        dataType: NUMBER(38,0)
        defaultValue: ""
        description: ""
        name: POS_ID_GENERATED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9bf2f4d0-66f3-483d-bd60-4e36786f353a
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 654dba69-6dd3-4b6b-9c90-8cb56e567079
          stepCounter: c88cf564-7534-49b2-a674-caf422bbe56c
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CREATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2b22130a-cae3-4f7b-b503-96f09980f3fb
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9a3288b-2cfc-4abe-998e-e45c22808580
          stepCounter: c88cf564-7534-49b2-a674-caf422bbe56c
        config: {}
        dataType: TIMESTAMP_NTZ(3)
        defaultValue: ""
        description: ""
        name: CREATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cef0f2a0-ce92-49d7-bc65-229af16bbd9d
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: adf49f3d-90ef-42b7-a42d-ba8f44990138
          stepCounter: c88cf564-7534-49b2-a674-caf422bbe56c
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: UPDATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ccb9a64d-8e60-4716-96da-597cc0a91ea5
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70dd8bb6-145b-4013-a754-04c65076d6b9
          stepCounter: c88cf564-7534-49b2-a674-caf422bbe56c
        config: {}
        dataType: TIMESTAMP_NTZ(3)
        defaultValue: ""
        description: ""
        name: UPDATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b17f2fcc-94a0-476a-a902-12ba16dc24c5
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bbf1ac0e-d161-4e9f-8e95-5e7e026cd97e
          stepCounter: c88cf564-7534-49b2-a674-caf422bbe56c
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: RUN_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 53afb78b-5e1e-46e7-b030-310e00a201ff
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 603bfcc1-de3b-4b6f-8bd2-129f29cab0c9
          stepCounter: c88cf564-7534-49b2-a674-caf422bbe56c
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: The changing hash
        name: DSS_CHANGE_HASH
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7cfe2d30-6f44-4d91-bc9f-a1df7627be68
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7327ea9e-4705-4bd9-9705-3a5b3e4ef9a3
          stepCounter: c88cf564-7534-49b2-a674-caf422bbe56c
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Record source
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f419dce5-b408-42e5-8ced-8e7c9cecfa96
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9224c9d4-82bf-4110-bb34-83b2783e0ceb
          stepCounter: c88cf564-7534-49b2-a674-caf422bbe56c
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was loaded in the data vault
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a493b9fa-7961-4dcb-a81e-6d6472fe4a25
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45f52742-a166-4812-8413-eaf0019a8040
          stepCounter: c88cf564-7534-49b2-a674-caf422bbe56c
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row started in the data vault
        isSystemStartDate: true
        name: DSS_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51440775-9e85-49f9-aeaa-bd0a3a7348d4
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e1fbdc0-fdfc-4626-9438-419e564268ca
          stepCounter: c88cf564-7534-49b2-a674-caf422bbe56c
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: Version number of a business key in the data vault
        isSurrogateKey: true
        isSystemVersion: true
        name: DSS_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 86ae9919-e14d-4f0e-9ccb-e54362249b74
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4cff2d93-edce-4808-8f50-0706cc8ef1cc
          stepCounter: c88cf564-7534-49b2-a674-caf422bbe56c
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was inserted in the data vault
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c43de0b-a51d-455d-834d-4afbd8b42fb2
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_POS_TYPE_MROC: e71cd662-66e1-41df-87d8-3956421a8a55
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATAVAULT_RAW_VAULT
            nodeName: S_POS_TYPE_MROC
        join:
          joinCondition: |-
            FROM {{ ref('DATAVAULT_RAW_VAULT','S_POS_TYPE_MROC') }} s_pos_type_mroc
             INNER JOIN (
                    SELECT hk_h_pos_type,
                           MAX(dss_start_date) AS dss_start_date
                      FROM {{ ref('DATAVAULT_RAW_VAULT','S_POS_TYPE_MROC') }}
                     GROUP BY hk_h_pos_type
                   ) curr
                ON curr.hk_h_pos_type = s_pos_type_mroc.hk_h_pos_type
               AND curr.dss_start_date = s_pos_type_mroc.dss_start_date
        name: S_POS_TYPE_MROC_CURRENT
        noLinkRefs: []
  name: S_POS_TYPE_MROC_CURRENT
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
