fileVersion: 1
id: cf43af4f-7421-4013-9993-60fcb4dd7aa4
name: S_POS_TYPE_MROC_CURRENT
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DATAVAULT_BUSINESS_VAULT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4e4f485-6ca8-4795-9222-a32e86d5c727
          stepCounter: cf43af4f-7421-4013-9993-60fcb4dd7aa4
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: ""
        name: HK_H_POS_TYPE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d0eb71d0-6f4e-4152-a371-a77f90dbda08
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 333ab02d-2113-4c4e-8649-b14f78dfbdb4
          stepCounter: cf43af4f-7421-4013-9993-60fcb4dd7aa4
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e315408b-8517-4696-ad63-5355d1fa619b
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2dd3d848-f803-4599-9c0c-c0c8b8459436
          stepCounter: cf43af4f-7421-4013-9993-60fcb4dd7aa4
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: FILE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6994c435-4c30-4819-b2cd-361733df9f60
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f7f52f6-87b1-4071-9228-4c4672f9abe5
          stepCounter: cf43af4f-7421-4013-9993-60fcb4dd7aa4
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: POS_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c1af8595-0c16-46e0-814d-6832a61d57d5
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee582af7-c9ba-48c3-82b7-810d93172bae
          stepCounter: cf43af4f-7421-4013-9993-60fcb4dd7aa4
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: POS_TYPE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d85751b5-1328-4f11-9c8a-47c1c7453227
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 956e19ee-cc0e-4520-bbc5-4c48848670f8
          stepCounter: cf43af4f-7421-4013-9993-60fcb4dd7aa4
        config: {}
        dataType: VARCHAR(11)
        defaultValue: ""
        description: ""
        name: POS_TYPE_INST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d4ac6388-548e-4252-99aa-95c226b0bee4
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3e0b28f-1b81-4f71-bf57-a325b15dddfb
          stepCounter: cf43af4f-7421-4013-9993-60fcb4dd7aa4
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: POS_HARDWARE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2c232b9-f9d8-4c38-80ee-4370f555a7e4
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c7ecc3a-302b-4df2-accd-64416fd175d5
          stepCounter: cf43af4f-7421-4013-9993-60fcb4dd7aa4
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: POS_PROFILE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 999feb12-76bd-48b5-b07e-b8151356a0f0
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d33de8b7-12a8-46ca-82ac-9a7104568a1e
          stepCounter: cf43af4f-7421-4013-9993-60fcb4dd7aa4
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: USE_MCC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dce8743f-f19a-4ad0-86d1-734bd4126f21
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39b12f9a-42a4-4f22-bfd9-32734a1a0a53
          stepCounter: cf43af4f-7421-4013-9993-60fcb4dd7aa4
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: USE_LANGUAGE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 903e0667-2325-4390-83ce-08d84c23c775
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec02390d-b36a-43be-883a-be6e5ece8191
          stepCounter: cf43af4f-7421-4013-9993-60fcb4dd7aa4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: MODEL_VHQ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07d0c5ba-1790-4b85-80e2-e625ac0bf52d
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 371911de-0881-4db3-b027-ab930bdd76c3
          stepCounter: cf43af4f-7421-4013-9993-60fcb4dd7aa4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: MODEL_BFIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 940651d6-9746-4586-9ad5-d33db043b3ca
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee9d5701-523c-46f8-a9a5-46bdc8df7c31
          stepCounter: cf43af4f-7421-4013-9993-60fcb4dd7aa4
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: POS_TYPE_VIRTUAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 963d81f0-0074-4890-93ce-22a2871db700
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f01ef64-5302-4f44-ba13-137f93009eea
          stepCounter: cf43af4f-7421-4013-9993-60fcb4dd7aa4
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: POS_TYPE_ID_INDEX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9c3027a-d12b-4528-988a-1cff9f6d29c1
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e644951c-6681-4700-8fa6-9a78a9fde36d
          stepCounter: cf43af4f-7421-4013-9993-60fcb4dd7aa4
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: POS_TYPE_SN_REQ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 26133f93-050d-401e-92dc-dc53e422385e
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d9f63d9-64d3-40a7-96eb-6eb51e54c9f7
          stepCounter: cf43af4f-7421-4013-9993-60fcb4dd7aa4
        config: {}
        dataType: VARCHAR(19)
        defaultValue: ""
        description: ""
        name: POS_TYPE_POS_ID_IDX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4731f93f-be6f-489e-b697-ef44df17cdcf
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d755b04-8ef3-4fb0-abee-9e0d837f99a2
          stepCounter: cf43af4f-7421-4013-9993-60fcb4dd7aa4
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: POS_TYPE_TMS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa5a857a-186f-495c-88c2-ac504edfe46a
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 651e1a1a-32ed-4bde-8a48-b0fa92ee0a63
          stepCounter: cf43af4f-7421-4013-9993-60fcb4dd7aa4
        config: {}
        dataType: NUMBER(38,0)
        defaultValue: ""
        description: ""
        name: POS_TMS_ENABLED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a42baaaa-d66d-4549-9456-a93b95a4fff5
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6bd75f07-1a77-4f8f-9a34-f2adab0cbdc4
          stepCounter: cf43af4f-7421-4013-9993-60fcb4dd7aa4
        config: {}
        dataType: NUMBER(38,0)
        defaultValue: ""
        description: ""
        name: POS_ID_GENERATED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f412c250-e701-4b39-9b86-43587c917c01
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09382bb8-d2a2-466d-90ac-57cff93a700e
          stepCounter: cf43af4f-7421-4013-9993-60fcb4dd7aa4
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CREATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b324b7ad-5262-482d-8310-2dd5fb379adf
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16179862-0471-40eb-ad05-10af1fc1dc8f
          stepCounter: cf43af4f-7421-4013-9993-60fcb4dd7aa4
        config: {}
        dataType: TIMESTAMP_NTZ(3)
        defaultValue: ""
        description: ""
        name: CREATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2dc27977-fd52-4193-8f89-a038a1f56813
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 103189a8-e440-4966-8de7-0870afb73d19
          stepCounter: cf43af4f-7421-4013-9993-60fcb4dd7aa4
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: UPDATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d6b5fa3-2ec5-4271-908a-ce7cb9384988
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8448f186-57d1-4192-b7ba-345634e6c023
          stepCounter: cf43af4f-7421-4013-9993-60fcb4dd7aa4
        config: {}
        dataType: TIMESTAMP_NTZ(3)
        defaultValue: ""
        description: ""
        name: UPDATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: be46c8c4-3330-424b-9832-a17ed10e5d34
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a504c0db-f2c0-45d8-9010-cd8394d7ea3d
          stepCounter: cf43af4f-7421-4013-9993-60fcb4dd7aa4
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: RUN_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d873438d-8c8e-49ad-8bd7-f53dc946eea9
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 385227e7-b189-4777-a6dd-32871e3be53a
          stepCounter: cf43af4f-7421-4013-9993-60fcb4dd7aa4
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: The changing hash
        name: DSS_CHANGE_HASH
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e4cbd8a9-1c42-474d-b649-02b6845417af
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 43068e5e-68a6-41b5-82c1-6ffa82f8a972
          stepCounter: cf43af4f-7421-4013-9993-60fcb4dd7aa4
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Record source
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 44f05808-ef3e-42fd-b4c5-c4e3e3a43ced
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca10ec27-24aa-4abb-966c-c11f34e1fabd
          stepCounter: cf43af4f-7421-4013-9993-60fcb4dd7aa4
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was loaded in the data vault
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8fbc9173-ea25-4256-8c41-124742a0979f
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5978bca6-de05-44fd-a173-148a2c843bf9
          stepCounter: cf43af4f-7421-4013-9993-60fcb4dd7aa4
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row started in the data vault
        isSystemStartDate: true
        name: DSS_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ff65e5d2-0bcf-4b00-8835-7838ca26b4d7
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 541c3188-59e4-44aa-8537-821b5cad8c44
          stepCounter: cf43af4f-7421-4013-9993-60fcb4dd7aa4
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: Version number of a business key in the data vault
        isSurrogateKey: true
        isSystemVersion: true
        name: DSS_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 009ac564-9f72-4aa9-9244-20632e29ad97
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17cd5125-e787-4b60-b9ac-d1d58f6e2541
          stepCounter: cf43af4f-7421-4013-9993-60fcb4dd7aa4
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was inserted in the data vault
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 486e64d3-9a8e-4ac8-a549-52ef46113085
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_POS_TYPE_MROC: 60a7d36a-d509-4601-b614-5f984e74d7f4
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATAVAULT_RAW_VAULT
            nodeName: S_POS_TYPE_MROC
        join:
          joinCondition: |-
            FROM {{ ref('DATAVAULT_RAW_VAULT','S_POS_TYPE_MROC') }} s_pos_type_mroc
             INNER JOIN (
                    SELECT hk_h_pos_type,
                           MAX(dss_start_date) AS dss_start_date
                      FROM {{ ref('DATAVAULT_RAW_VAULT','S_POS_TYPE_MROC') }}
                     GROUP BY hk_h_pos_type
                   ) curr
                ON curr.hk_h_pos_type = s_pos_type_mroc.hk_h_pos_type
               AND curr.dss_start_date = s_pos_type_mroc.dss_start_date
        name: S_POS_TYPE_MROC_CURRENT
        noLinkRefs: []
  name: S_POS_TYPE_MROC_CURRENT
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
