fileVersion: 1
id: 07c3cbef-6235-4c80-9630-35dce2231f0a
name: STAGE_FIN_SAP_ORDER
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f93ca4ac-eb4f-4fbe-bd6b-ce3487fd7a1b
          stepCounter: 07c3cbef-6235-4c80-9630-35dce2231f0a
        config: {}
        dataType: VARCHAR(12)
        defaultValue: ""
        description: Order Number
        isBusinessKey: true
        name: ORDER_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d5eba84-61c0-4e81-9683-052178189495
                stepCounter: d9804961-abf3-41ef-aae2-d16269ccb227
            transform: NULLIF(TRIM(LTRIM(ODS_SAP_AUFK.AUFNR,'0'),' '),'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: edc8c78b-b77e-44a6-94bb-16ce7ccbd9fe
          stepCounter: 07c3cbef-6235-4c80-9630-35dce2231f0a
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: Processing group
        name: PROCESSING_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a91610d6-914b-482c-952d-48386c3bdf77
                stepCounter: d9804961-abf3-41ef-aae2-d16269ccb227
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 368a7bec-0da3-4eef-8a27-52c1cd812459
          stepCounter: 07c3cbef-6235-4c80-9630-35dce2231f0a
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: Requesting company code
        name: REQ_COMPANY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c29d967-e7a4-43db-abda-9d6fda7e0a61
                stepCounter: d9804961-abf3-41ef-aae2-d16269ccb227
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b56e27c0-d03f-478e-baed-395dcf3d1f69
          stepCounter: 07c3cbef-6235-4c80-9630-35dce2231f0a
        config: {}
        dataType: DATE
        defaultValue: ""
        description: Change Date for Order Master
        name: CHANGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72be461a-c000-4047-a6e2-f21c4533c895
                stepCounter: d9804961-abf3-41ef-aae2-d16269ccb227
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca3eec0c-41ef-4126-9464-17480a7c63ba
          stepCounter: 07c3cbef-6235-4c80-9630-35dce2231f0a
        config: {}
        dataType: VARCHAR(12)
        defaultValue: ""
        description: Last Changed By
        name: CHANGE_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d076801d-54b9-4ce0-aca9-435fb009bcd3
                stepCounter: d9804961-abf3-41ef-aae2-d16269ccb227
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 430b364c-5273-4386-af5a-9945a9e5e905
          stepCounter: 07c3cbef-6235-4c80-9630-35dce2231f0a
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: Order status
        name: STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 551cbd3f-ce4c-4078-b925-b41225fe724d
                stepCounter: d9804961-abf3-41ef-aae2-d16269ccb227
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0bcfd98-b150-499c-acce-6aee923c2e3e
          stepCounter: 07c3cbef-6235-4c80-9630-35dce2231f0a
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: Order Type
        name: ORDER_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e55b37c-3e4a-4389-9a4a-968ee4dfb914
                stepCounter: d9804961-abf3-41ef-aae2-d16269ccb227
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1432c84-8d27-4f61-934d-f169af338c0e
          stepCounter: 07c3cbef-6235-4c80-9630-35dce2231f0a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: External order number
        name: EXTERNAL_ORDER_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2a3f4ccb-9bc9-40ec-9dbb-0355476f3db6
                stepCounter: d9804961-abf3-41ef-aae2-d16269ccb227
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80f91d0b-10ee-41ae-8a1b-2918bd17c117
          stepCounter: 07c3cbef-6235-4c80-9630-35dce2231f0a
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: Company Code
        name: COMPANY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0191c13e-9745-475a-b302-e5394fd258ed
                stepCounter: d9804961-abf3-41ef-aae2-d16269ccb227
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f0891c0-6ea4-48f1-8376-2c34e4cc05e8
          stepCounter: 07c3cbef-6235-4c80-9630-35dce2231f0a
        config: {}
        dataType: DATE
        defaultValue: ""
        description: Created On
        name: CREATED_ON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ffd6f18c-85bc-4d64-8b9d-e4d0f3c6002c
                stepCounter: d9804961-abf3-41ef-aae2-d16269ccb227
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c641429-c19c-424a-b74d-2452e33ae0dd
          stepCounter: 07c3cbef-6235-4c80-9630-35dce2231f0a
        config: {}
        dataType: VARCHAR(12)
        defaultValue: ""
        description: Entered By
        name: CREATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 44e47fef-5e2e-41a7-9ae9-d4244697f5d1
                stepCounter: d9804961-abf3-41ef-aae2-d16269ccb227
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e56acd5-f015-4f8b-bea5-8b4f3f6a3bc1
          stepCounter: 07c3cbef-6235-4c80-9630-35dce2231f0a
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: Equity type
        name: EQUITY_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf2e2933-4587-41e7-9671-98343fd02ee8
                stepCounter: d9804961-abf3-41ef-aae2-d16269ccb227
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 482bce3a-28df-4cfc-92a0-4e024f2e3b8f
          stepCounter: 07c3cbef-6235-4c80-9630-35dce2231f0a
        config: {}
        dataType: VARCHAR(16)
        defaultValue: ""
        description: Functional Area
        name: FUNCTIONAL_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 65502bdb-e5b3-49e0-ab20-b9585e1455cc
                stepCounter: d9804961-abf3-41ef-aae2-d16269ccb227
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45a98ab4-a003-47f3-ae90-d03a8e73b779
          stepCounter: 07c3cbef-6235-4c80-9630-35dce2231f0a
        config: {}
        dataType: DATE
        defaultValue: ""
        description: Close Date
        name: CLOSE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94e43ae6-5855-4551-8d91-d396fd9c96da
                stepCounter: d9804961-abf3-41ef-aae2-d16269ccb227
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1dbfc526-b6fd-492b-b06e-fef917752d61
          stepCounter: 07c3cbef-6235-4c80-9630-35dce2231f0a
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: Costing Sheet
        name: COSTING_SHEET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee946fbd-a3be-4eb2-86be-00ec54d9e086
                stepCounter: d9804961-abf3-41ef-aae2-d16269ccb227
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a56b12c5-00da-465f-ba63-f153fd99cdbc
          stepCounter: 07c3cbef-6235-4c80-9630-35dce2231f0a
        config: {}
        dataType: DATE
        defaultValue: ""
        description: Start Date
        name: START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b017759-1c27-4ce0-ae77-5550028ec1db
                stepCounter: d9804961-abf3-41ef-aae2-d16269ccb227
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a774ffbe-01b7-456f-85c4-fcb9f5b4eef6
          stepCounter: 07c3cbef-6235-4c80-9630-35dce2231f0a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Person Responsible
        name: PERSON_RESPONSIBLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6de43312-b7c8-4dfb-b03b-99eb425be71c
                stepCounter: d9804961-abf3-41ef-aae2-d16269ccb227
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf406dd7-fade-442f-871d-ce4c6cc24349
          stepCounter: 07c3cbef-6235-4c80-9630-35dce2231f0a
        config: {}
        dataType: VARCHAR(24)
        defaultValue: ""
        description: Work breakdown structure element (WBS element)
        name: AFE_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c7fec8c-4744-447e-ba8b-4c01b6fb22cf
                stepCounter: de47848d-954f-44ec-aa0e-4c963ecfcf9b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8a42c27-84a2-4020-b935-84a3a02b49b1
          stepCounter: 07c3cbef-6235-4c80-9630-35dce2231f0a
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Responsible cost center
        name: AFE_CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 61baa464-9883-4373-ac38-1148438b5d9b
                stepCounter: de47848d-954f-44ec-aa0e-4c963ecfcf9b
            transform: NULLIF(TRIM(LTRIM(ODS_SAP_PRPS.AKSTL,'0'),' '),'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 929768d9-ce8b-42b5-bd14-83e69eb9205b
          stepCounter: 07c3cbef-6235-4c80-9630-35dce2231f0a
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: Recovery Indicator
        name: RECOVERY_INDICATOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de5fb84e-6f19-4968-a9fb-717db0d3f3a5
                stepCounter: d9804961-abf3-41ef-aae2-d16269ccb227
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e84ef377-6d9a-4e1c-afe5-b38defec24ab
          stepCounter: 07c3cbef-6235-4c80-9630-35dce2231f0a
        config: {}
        dataType: VARCHAR(12)
        defaultValue: ""
        description: Reference Order Number
        name: REF_ORDER_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 99108336-1f4b-4d59-9892-8a9753760cdc
                stepCounter: d9804961-abf3-41ef-aae2-d16269ccb227
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da54f5fe-5f2e-4038-a4df-b43a2a848328
          stepCounter: 07c3cbef-6235-4c80-9630-35dce2231f0a
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: Location Plant
        name: LOCATION_PLANT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1184bf89-cce2-43a2-a42f-835e3f0d970a
                stepCounter: d9804961-abf3-41ef-aae2-d16269ccb227
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 35499cac-bd3b-4f45-9bd1-a6a44f44f2f5
          stepCounter: 07c3cbef-6235-4c80-9630-35dce2231f0a
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Location
        name: LOCATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd161a95-ffef-4fa0-8f19-051838493f60
                stepCounter: d9804961-abf3-41ef-aae2-d16269ccb227
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92caf870-702c-43a2-a432-5a06dfb24ad4
          stepCounter: 07c3cbef-6235-4c80-9630-35dce2231f0a
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: Tax Jurisdiction
        name: TAX_JURISDICTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de72970a-0f14-4f35-bd41-a70f55363232
                stepCounter: d9804961-abf3-41ef-aae2-d16269ccb227
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c60040ed-67ad-4492-bf44-b94f5b6434e9
          stepCounter: 07c3cbef-6235-4c80-9630-35dce2231f0a
        config: {}
        dataType: NUMBER(11,2)
        defaultValue: ""
        description: Estimated total costs of order
        name: ESTIMATED_COSTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a329f70-56c9-4d70-a39a-18e5dff876d0
                stepCounter: d9804961-abf3-41ef-aae2-d16269ccb227
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f15adeed-d70d-4a25-9e80-86a30e8666ec
          stepCounter: 07c3cbef-6235-4c80-9630-35dce2231f0a
        config: {}
        dataType: VARCHAR(12)
        defaultValue: ""
        description: Person Responsible for CO Internal Order
        name: USER_RESPONSIBLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18d3a25e-b1d3-48c0-9305-f46c4ef81635
                stepCounter: d9804961-abf3-41ef-aae2-d16269ccb227
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 439fbebd-4085-4312-b806-e5cd9d6c42d8
          stepCounter: 07c3cbef-6235-4c80-9630-35dce2231f0a
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: Joint venture
        name: JOINT_VENTURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f4c09e7-aa13-4b44-a523-d9b7b829a222
                stepCounter: d9804961-abf3-41ef-aae2-d16269ccb227
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e79a892-f13f-410b-8948-f6e2918849c6
          stepCounter: 07c3cbef-6235-4c80-9630-35dce2231f0a
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Claim inconsistency with order indicator
        name: UPDATE_NEEDED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cf31f275-22f0-4688-b5d9-ffc0e67082d0
                stepCounter: d9804961-abf3-41ef-aae2-d16269ccb227
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d8eb741-0ee7-45d1-bc38-3f387d1e3939
          stepCounter: 07c3cbef-6235-4c80-9630-35dce2231f0a
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: Plant
        name: PLANT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ba8baae-0835-4ffb-8ecc-931149fb5173
                stepCounter: d9804961-abf3-41ef-aae2-d16269ccb227
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bfbbf370-3461-40da-abf7-6388c754470b
          stepCounter: 07c3cbef-6235-4c80-9630-35dce2231f0a
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: Controlling Area
        name: CONTROLLING_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc626785-6350-4773-9d69-ba58c40af170
                stepCounter: d9804961-abf3-41ef-aae2-d16269ccb227
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 826fb435-6c2e-419e-bb95-d53dd328da11
          stepCounter: 07c3cbef-6235-4c80-9630-35dce2231f0a
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: Description
        name: DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a45ace8-5ef3-483b-8cca-ad31d8482ce5
                stepCounter: d9804961-abf3-41ef-aae2-d16269ccb227
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e0fb06d-56a5-45b8-ad08-6d89a6fd1a53
          stepCounter: 07c3cbef-6235-4c80-9630-35dce2231f0a
        config: {}
        dataType: VARCHAR(22)
        defaultValue: ""
        description: Object number
        name: OBJECT_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 26596d08-609f-4735-9a0d-0b6b6a974e69
                stepCounter: d9804961-abf3-41ef-aae2-d16269ccb227
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f488063-fe91-43a2-b8df-9ad9eaa7c2f3
          stepCounter: 07c3cbef-6235-4c80-9630-35dce2231f0a
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Cost Center for Basic Settlement
        name: CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 36ebdef7-e10e-455d-9285-63e28ad026bd
                stepCounter: d9804961-abf3-41ef-aae2-d16269ccb227
            transform: NULLIF(TRIM(LTRIM(ODS_SAP_AUFK.KOSTL,'0'),' '),'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 61ee31bc-ad32-463a-b958-2b15218ad2fb
          stepCounter: 07c3cbef-6235-4c80-9630-35dce2231f0a
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Requesting cost center
        name: REQ_CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 98c75685-695d-4f32-9897-b5263f06c02a
                stepCounter: d9804961-abf3-41ef-aae2-d16269ccb227
            transform: NULLIF(TRIM(LTRIM(ODS_SAP_AUFK.AKSTL,'0'),' '),'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5d1c243-0902-4c25-9c31-a9a7f1733c82
          stepCounter: 07c3cbef-6235-4c80-9630-35dce2231f0a
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Responsible cost center
        name: RESP_CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84e03a57-2bfa-4eaa-97c1-e678a4cafd18
                stepCounter: d9804961-abf3-41ef-aae2-d16269ccb227
            transform: NULLIF(TRIM(LTRIM(ODS_SAP_AUFK.KOSTV,'0'),' '),'')
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ODS_SAP_AUFK: d9804961-abf3-41ef-aae2-d16269ccb227
          ODS_SAP_PRPS: de47848d-954f-44ec-aa0e-4c963ecfcf9b
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: ODS_SAP_AUFK
          - locationName: TARGET
            nodeName: ODS_SAP_PRPS
        join:
          joinCondition: |-
            FROM (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_AUFK') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) ODS_SAP_AUFK
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_PRPS') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) ODS_SAP_PRPS
                ON (ODS_SAP_AUFK.PSPEL = ODS_SAP_PRPS.PSPNR)
        name: STAGE_FIN_SAP_ORDER
        noLinkRefs: []
  name: STAGE_FIN_SAP_ORDER
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
