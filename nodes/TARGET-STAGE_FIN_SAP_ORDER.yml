fileVersion: 1
id: 067716aa-8dd6-4e4b-a3c1-1d8990dae2c2
name: STAGE_FIN_SAP_ORDER
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66860ee9-3499-4f29-9114-c819bf46de42
          stepCounter: 067716aa-8dd6-4e4b-a3c1-1d8990dae2c2
        config: {}
        dataType: VARCHAR(12)
        defaultValue: ""
        description: Order Number
        isBusinessKey: true
        name: ORDER_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3f8117ae-2e88-4c6c-b40a-c63bef7c712b
                stepCounter: 52782c2c-549d-4460-9975-11ccecdb6158
            transform: NULLIF(TRIM(LTRIM(ODS_SAP_AUFK.AUFNR,'0'),' '),'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca1978b0-d03a-4d51-b9f9-edf124386443
          stepCounter: 067716aa-8dd6-4e4b-a3c1-1d8990dae2c2
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: Processing group
        name: PROCESSING_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02352cc0-494a-4a19-b812-2a3be302d136
                stepCounter: 52782c2c-549d-4460-9975-11ccecdb6158
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d81e169-9156-4933-aba0-00c72ce636ee
          stepCounter: 067716aa-8dd6-4e4b-a3c1-1d8990dae2c2
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: Requesting company code
        name: REQ_COMPANY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8d0fb3e7-25d5-4008-ac6f-6129dc64771e
                stepCounter: 52782c2c-549d-4460-9975-11ccecdb6158
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06f63ce3-7a44-4ced-874a-9346411760d3
          stepCounter: 067716aa-8dd6-4e4b-a3c1-1d8990dae2c2
        config: {}
        dataType: DATE
        defaultValue: ""
        description: Change Date for Order Master
        name: CHANGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4004a30e-76e1-427d-94e9-69331c402767
                stepCounter: 52782c2c-549d-4460-9975-11ccecdb6158
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87ede950-1588-4763-84c1-59a281c83727
          stepCounter: 067716aa-8dd6-4e4b-a3c1-1d8990dae2c2
        config: {}
        dataType: VARCHAR(12)
        defaultValue: ""
        description: Last Changed By
        name: CHANGE_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 30bb12c1-3794-4cdb-b20e-8f645a3ef695
                stepCounter: 52782c2c-549d-4460-9975-11ccecdb6158
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54eae4ed-eb5a-4748-afe2-e882ab3a2e1d
          stepCounter: 067716aa-8dd6-4e4b-a3c1-1d8990dae2c2
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: Order status
        name: STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: faac7969-13e7-4db6-b11a-e9065e933e66
                stepCounter: 52782c2c-549d-4460-9975-11ccecdb6158
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a1afbe5-fac5-4baa-a1aa-4b90bb66df6f
          stepCounter: 067716aa-8dd6-4e4b-a3c1-1d8990dae2c2
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: Order Type
        name: ORDER_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d71e06c9-5939-403b-8e20-209346febff5
                stepCounter: 52782c2c-549d-4460-9975-11ccecdb6158
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16dc6285-4df9-4136-8764-46679bbe2cf2
          stepCounter: 067716aa-8dd6-4e4b-a3c1-1d8990dae2c2
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: External order number
        name: EXTERNAL_ORDER_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2fe03790-3264-45e3-a0ad-bce895aa4441
                stepCounter: 52782c2c-549d-4460-9975-11ccecdb6158
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87301261-f938-4e6a-8ae2-43a056372e2e
          stepCounter: 067716aa-8dd6-4e4b-a3c1-1d8990dae2c2
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: Company Code
        name: COMPANY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0a86d9c1-4b1a-44cd-8c6e-b18e7861650b
                stepCounter: 52782c2c-549d-4460-9975-11ccecdb6158
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 08d405f6-5ab6-4737-85b7-5e80fbad511d
          stepCounter: 067716aa-8dd6-4e4b-a3c1-1d8990dae2c2
        config: {}
        dataType: DATE
        defaultValue: ""
        description: Created On
        name: CREATED_ON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de0ceb16-37c3-4579-b3de-20d3e27a10b8
                stepCounter: 52782c2c-549d-4460-9975-11ccecdb6158
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 886a7ad9-78fc-4b8a-bfb9-a796687a805a
          stepCounter: 067716aa-8dd6-4e4b-a3c1-1d8990dae2c2
        config: {}
        dataType: VARCHAR(12)
        defaultValue: ""
        description: Entered By
        name: CREATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: edac6363-af59-4c79-87e1-d222e6c667df
                stepCounter: 52782c2c-549d-4460-9975-11ccecdb6158
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c579040-5b6d-49ce-96c7-69800847e5b4
          stepCounter: 067716aa-8dd6-4e4b-a3c1-1d8990dae2c2
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: Equity type
        name: EQUITY_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 668a8241-f4fd-4b91-917c-7332f5c5559f
                stepCounter: 52782c2c-549d-4460-9975-11ccecdb6158
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f8f5680e-0356-465e-94d5-4c841937df0d
          stepCounter: 067716aa-8dd6-4e4b-a3c1-1d8990dae2c2
        config: {}
        dataType: VARCHAR(16)
        defaultValue: ""
        description: Functional Area
        name: FUNCTIONAL_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2207e42-a0af-4bae-8870-9be97860fe1e
                stepCounter: 52782c2c-549d-4460-9975-11ccecdb6158
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71a0faf0-f07a-49e5-a277-470150be1ac9
          stepCounter: 067716aa-8dd6-4e4b-a3c1-1d8990dae2c2
        config: {}
        dataType: DATE
        defaultValue: ""
        description: Close Date
        name: CLOSE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11f8cd2e-9e07-4e26-85f6-ff2634613e52
                stepCounter: 52782c2c-549d-4460-9975-11ccecdb6158
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 28580f08-161c-45db-a7b9-a532b6d79a87
          stepCounter: 067716aa-8dd6-4e4b-a3c1-1d8990dae2c2
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: Costing Sheet
        name: COSTING_SHEET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 38ea53cf-5df8-4d54-960a-f777417e7816
                stepCounter: 52782c2c-549d-4460-9975-11ccecdb6158
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c119b707-b3b2-4320-8570-77fc423643e2
          stepCounter: 067716aa-8dd6-4e4b-a3c1-1d8990dae2c2
        config: {}
        dataType: DATE
        defaultValue: ""
        description: Start Date
        name: START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d09712fc-7f42-42c4-a385-3850a8032444
                stepCounter: 52782c2c-549d-4460-9975-11ccecdb6158
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c6ee499-f6ed-4527-93b7-2835590c974f
          stepCounter: 067716aa-8dd6-4e4b-a3c1-1d8990dae2c2
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Person Responsible
        name: PERSON_RESPONSIBLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 377a86e4-901a-4ed0-a926-cf089d3b3f8a
                stepCounter: 52782c2c-549d-4460-9975-11ccecdb6158
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e3aea01-4347-47fd-bb2c-6f9de2b85a51
          stepCounter: 067716aa-8dd6-4e4b-a3c1-1d8990dae2c2
        config: {}
        dataType: VARCHAR(24)
        defaultValue: ""
        description: Work breakdown structure element (WBS element)
        name: AFE_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3793af05-7532-4997-8f05-0bcdac878d0a
                stepCounter: 3582ff46-fac5-4ac0-9aa5-b3268952c703
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 63f7090f-9e62-4c0d-b5fd-7a551029a54a
          stepCounter: 067716aa-8dd6-4e4b-a3c1-1d8990dae2c2
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Responsible cost center
        name: AFE_CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56e78e87-f44e-4a8b-a9d4-3c95884350e0
                stepCounter: 3582ff46-fac5-4ac0-9aa5-b3268952c703
            transform: NULLIF(TRIM(LTRIM(ODS_SAP_PRPS.AKSTL,'0'),' '),'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ad5d4a8-0916-4a87-9b33-735ebd29db1c
          stepCounter: 067716aa-8dd6-4e4b-a3c1-1d8990dae2c2
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: Recovery Indicator
        name: RECOVERY_INDICATOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4d85845-97bd-45ab-8f30-c9749dd82c04
                stepCounter: 52782c2c-549d-4460-9975-11ccecdb6158
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a571c45f-f2f9-4641-8196-fa5c584a08e3
          stepCounter: 067716aa-8dd6-4e4b-a3c1-1d8990dae2c2
        config: {}
        dataType: VARCHAR(12)
        defaultValue: ""
        description: Reference Order Number
        name: REF_ORDER_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4669f1f3-55e3-4c9a-b218-3db18463131b
                stepCounter: 52782c2c-549d-4460-9975-11ccecdb6158
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41dfa1e4-c94e-4454-84ca-10b38328e44e
          stepCounter: 067716aa-8dd6-4e4b-a3c1-1d8990dae2c2
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: Location Plant
        name: LOCATION_PLANT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a8b6941c-fa39-4504-8eba-2607f0c4621e
                stepCounter: 52782c2c-549d-4460-9975-11ccecdb6158
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4cfe58a8-944d-4552-a0d7-2562daac92de
          stepCounter: 067716aa-8dd6-4e4b-a3c1-1d8990dae2c2
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Location
        name: LOCATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bfb1504d-9c7b-4c3d-ad57-d4dbbd574ce3
                stepCounter: 52782c2c-549d-4460-9975-11ccecdb6158
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d8ba6f8-c921-4d3c-a1c0-604b606939fa
          stepCounter: 067716aa-8dd6-4e4b-a3c1-1d8990dae2c2
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: Tax Jurisdiction
        name: TAX_JURISDICTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee5169d4-40dd-4e14-b882-4b12028c54b1
                stepCounter: 52782c2c-549d-4460-9975-11ccecdb6158
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b34ecba-190b-4aa2-a477-ab2222f822ff
          stepCounter: 067716aa-8dd6-4e4b-a3c1-1d8990dae2c2
        config: {}
        dataType: NUMBER(11,2)
        defaultValue: ""
        description: Estimated total costs of order
        name: ESTIMATED_COSTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d8483d76-06bc-4a0e-b862-77d7ad3fe1d3
                stepCounter: 52782c2c-549d-4460-9975-11ccecdb6158
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dd1a28d8-6842-42c5-a91c-649baa07e123
          stepCounter: 067716aa-8dd6-4e4b-a3c1-1d8990dae2c2
        config: {}
        dataType: VARCHAR(12)
        defaultValue: ""
        description: Person Responsible for CO Internal Order
        name: USER_RESPONSIBLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50684889-cdc7-4f2b-b8c3-e606d030a359
                stepCounter: 52782c2c-549d-4460-9975-11ccecdb6158
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a0ad087d-7d88-444f-a7a9-e6f760a5e393
          stepCounter: 067716aa-8dd6-4e4b-a3c1-1d8990dae2c2
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: Joint venture
        name: JOINT_VENTURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: beaa1b97-be4f-4423-aa67-eb1320a3901c
                stepCounter: 52782c2c-549d-4460-9975-11ccecdb6158
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29f9b197-f1d2-445d-9ec6-d5d8669d521c
          stepCounter: 067716aa-8dd6-4e4b-a3c1-1d8990dae2c2
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Claim inconsistency with order indicator
        name: UPDATE_NEEDED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ecae6161-2d0a-42fa-a685-3382cb2c8199
                stepCounter: 52782c2c-549d-4460-9975-11ccecdb6158
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 274ad9ba-c0ff-443a-9abb-084739e4b217
          stepCounter: 067716aa-8dd6-4e4b-a3c1-1d8990dae2c2
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: Plant
        name: PLANT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3614b5ea-8020-4818-ade1-d95af5d06b5c
                stepCounter: 52782c2c-549d-4460-9975-11ccecdb6158
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ec4b8b4-dc88-40dc-9be7-3b6d63096c64
          stepCounter: 067716aa-8dd6-4e4b-a3c1-1d8990dae2c2
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: Controlling Area
        name: CONTROLLING_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 55f068a7-5a17-4866-93ac-d935487f5fd1
                stepCounter: 52782c2c-549d-4460-9975-11ccecdb6158
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1781a6a3-7ffa-44c3-ac2b-23d9195c0c84
          stepCounter: 067716aa-8dd6-4e4b-a3c1-1d8990dae2c2
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: Description
        name: DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 446926da-589f-4751-b881-6f30389ca254
                stepCounter: 52782c2c-549d-4460-9975-11ccecdb6158
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98d91506-cce1-4aff-8653-3cd76807c526
          stepCounter: 067716aa-8dd6-4e4b-a3c1-1d8990dae2c2
        config: {}
        dataType: VARCHAR(22)
        defaultValue: ""
        description: Object number
        name: OBJECT_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b2bb289-d4b0-4418-af04-8636dae632d4
                stepCounter: 52782c2c-549d-4460-9975-11ccecdb6158
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e1c0e7f-23eb-4510-99ef-d8b037d26633
          stepCounter: 067716aa-8dd6-4e4b-a3c1-1d8990dae2c2
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Cost Center for Basic Settlement
        name: CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 73e5e004-28b9-45e0-9981-f3eb02a541c1
                stepCounter: 52782c2c-549d-4460-9975-11ccecdb6158
            transform: NULLIF(TRIM(LTRIM(ODS_SAP_AUFK.KOSTL,'0'),' '),'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9210a93b-7223-4c6e-a36b-261e6273586d
          stepCounter: 067716aa-8dd6-4e4b-a3c1-1d8990dae2c2
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Requesting cost center
        name: REQ_CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2f756e23-e820-4e93-9b45-3e3b33da7155
                stepCounter: 52782c2c-549d-4460-9975-11ccecdb6158
            transform: NULLIF(TRIM(LTRIM(ODS_SAP_AUFK.AKSTL,'0'),' '),'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a536447-8762-4c5b-9bf1-22ad60d04b08
          stepCounter: 067716aa-8dd6-4e4b-a3c1-1d8990dae2c2
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Responsible cost center
        name: RESP_CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2b7272f0-ffc7-448d-99bc-5f56e9f43ce7
                stepCounter: 52782c2c-549d-4460-9975-11ccecdb6158
            transform: NULLIF(TRIM(LTRIM(ODS_SAP_AUFK.KOSTV,'0'),' '),'')
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ODS_SAP_AUFK: 52782c2c-549d-4460-9975-11ccecdb6158
          ODS_SAP_PRPS: 3582ff46-fac5-4ac0-9aa5-b3268952c703
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: ODS_SAP_AUFK
          - locationName: TARGET
            nodeName: ODS_SAP_PRPS
        join:
          joinCondition: |-
            FROM (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_AUFK') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) ODS_SAP_AUFK
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_PRPS') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) ODS_SAP_PRPS
                ON (ODS_SAP_AUFK.PSPEL = ODS_SAP_PRPS.PSPNR)
        name: STAGE_FIN_SAP_ORDER
        noLinkRefs: []
  name: STAGE_FIN_SAP_ORDER
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
