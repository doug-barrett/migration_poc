fileVersion: 1
id: 2b251488-225f-407b-a76a-5d0324e4f529
name: STAGE_OPUS_CONTACT2
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af2dfa25-22a3-4d17-94e5-db274fd847dc
          stepCounter: 2b251488-225f-407b-a76a-5d0324e4f529
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CONTACTSALESFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60506b5b-3459-47e6-815b-106f853ab476
                stepCounter: f2657516-2f6b-4224-b937-9a83e5226195
            transform: IFNULL(STAGEOPUS_CONTACT.CONTACTSALESFORCEID,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b65d83ae-13cc-4cc9-b10d-0bcdb215afb9
          stepCounter: 2b251488-225f-407b-a76a-5d0324e4f529
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: OPUS_DUPLICATE_RANK
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ROW_NUMBER() OVER(PARTITION BY STAGEOPUS_CONTACT.FORCEID,STAGEOPUS_CONTACT.LEVEL1FORCEID,STAGEOPUS_CONTACT.EMAIL ORDER BY IFNULL(STAGEOPUS_CONTACT.LASTACTIVITYDATE,'1899-01-01') DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16a74e88-d53c-4e11-82ff-263aa0ddb405
          stepCounter: 2b251488-225f-407b-a76a-5d0324e4f529
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: LASTACTIVITYDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22755cb8-4e28-471a-abdb-fa7b6f75f70c
                stepCounter: f2657516-2f6b-4224-b937-9a83e5226195
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c9176fb-8b14-4c82-ab56-d5627eed8fca
          stepCounter: 2b251488-225f-407b-a76a-5d0324e4f529
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cba06279-33a5-4dd3-be0a-d4ad3e46389e
                stepCounter: f2657516-2f6b-4224-b937-9a83e5226195
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0913a10-527e-417e-900d-b2192ba54cb5
          stepCounter: 2b251488-225f-407b-a76a-5d0324e4f529
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 35c78ec4-bb07-4f0b-94a1-91580525cca7
                stepCounter: f2657516-2f6b-4224-b937-9a83e5226195
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f937cf39-7a84-4f4e-834f-ace7814b1032
          stepCounter: 2b251488-225f-407b-a76a-5d0324e4f529
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8eefb16c-339e-4a07-9d45-16c92daada57
                stepCounter: f2657516-2f6b-4224-b937-9a83e5226195
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f0a7eb4-bd9a-4c92-99da-19100f151b37
          stepCounter: 2b251488-225f-407b-a76a-5d0324e4f529
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE HIGHEST-LEVEL OF HIERARCHY FOR AN ACCOUNT
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fda5b97d-b5de-422f-ae0c-d935ea46b5e1
                stepCounter: f2657516-2f6b-4224-b937-9a83e5226195
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75f3a4d1-a59a-4612-b04b-0ae2e5c560e5
          stepCounter: 2b251488-225f-407b-a76a-5d0324e4f529
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c65b5de8-88a0-4fc0-80fc-555fa8bf2d67
                stepCounter: f2657516-2f6b-4224-b937-9a83e5226195
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 52fece3e-93ea-4d2d-9a5c-42259763c77c
          stepCounter: 2b251488-225f-407b-a76a-5d0324e4f529
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75b724a9-31da-4c63-a28f-679812a14642
                stepCounter: f2657516-2f6b-4224-b937-9a83e5226195
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee66c780-5110-43a5-b109-f2acc13e15a1
          stepCounter: 2b251488-225f-407b-a76a-5d0324e4f529
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CREATEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16591d56-7bbf-40c6-9659-6dade45ad3d2
                stepCounter: f2657516-2f6b-4224-b937-9a83e5226195
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c15098e-120f-4ec8-9a88-77d39f254bea
          stepCounter: 2b251488-225f-407b-a76a-5d0324e4f529
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: EMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39d320f1-18f1-4142-8921-3c3d592b845f
                stepCounter: f2657516-2f6b-4224-b937-9a83e5226195
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b35d2320-2203-4763-99d4-59afc5283489
          stepCounter: 2b251488-225f-407b-a76a-5d0324e4f529
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CREATEDWAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03e71d35-d230-48b7-961c-3875a79dabdc
                stepCounter: f2657516-2f6b-4224-b937-9a83e5226195
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f392e88-e214-4ee7-b0f7-80b393d8d6f5
          stepCounter: 2b251488-225f-407b-a76a-5d0324e4f529
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: HOWDIDYOUHEARABOUTOPUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 89553f49-a433-4359-8379-3d25df31cf48
                stepCounter: f2657516-2f6b-4224-b937-9a83e5226195
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 505ecdcd-39a1-4042-9c8a-edb4be690c4d
          stepCounter: 2b251488-225f-407b-a76a-5d0324e4f529
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ACCEPTEDTERMSANDCONDITIONS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 557a4cff-7199-44ae-a22e-16cf30283344
                stepCounter: f2657516-2f6b-4224-b937-9a83e5226195
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c6605b2-29b8-43e3-b62b-080ace28089b
          stepCounter: 2b251488-225f-407b-a76a-5d0324e4f529
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: MODIFIEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9e6e8aae-8b32-4497-b9c3-6856bb4f67cc
                stepCounter: f2657516-2f6b-4224-b937-9a83e5226195
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c7a13c04-1287-458b-892a-84ef8959e467
          stepCounter: 2b251488-225f-407b-a76a-5d0324e4f529
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: LASTLOGINDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: efaa94d4-3a61-48f2-b4f4-2d24e2e2bafc
                stepCounter: f2657516-2f6b-4224-b937-9a83e5226195
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b815bbf9-5d67-43a8-ae3c-198764f958ca
          stepCounter: 2b251488-225f-407b-a76a-5d0324e4f529
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: OPUSSUBSOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60ed2a31-1289-4cb5-8714-4c8780d51d26
                stepCounter: f2657516-2f6b-4224-b937-9a83e5226195
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91963694-814f-4d9c-a1f2-9e8b4c9d8ff4
          stepCounter: 2b251488-225f-407b-a76a-5d0324e4f529
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6f2a5a1-69ca-4361-a95a-17dd4985418d
                stepCounter: f2657516-2f6b-4224-b937-9a83e5226195
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 052841c8-f4d2-4214-a861-96006f46bfc4
          stepCounter: 2b251488-225f-407b-a76a-5d0324e4f529
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e9fbffa-e234-4fd7-a7b3-9929053e2d01
                stepCounter: f2657516-2f6b-4224-b937-9a83e5226195
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ac9e34e-4cff-44cc-96b6-99af607e02f2
          stepCounter: 2b251488-225f-407b-a76a-5d0324e4f529
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38a43741-e772-4ae0-b8af-853143648b0b
          stepCounter: 2b251488-225f-407b-a76a-5d0324e4f529
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_OPUS_CONTACT: f2657516-2f6b-4224-b937-9a83e5226195
          CONTACT: 48094b19-3332-40c8-a5ed-b656d7687e09
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: STAGE
            nodeName: STAGE_OPUS_CONTACT
          - locationName: DIM
            nodeName: CONTACT
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','STAGE_OPUS_CONTACT') }} STAGE_OPUS_CONTACT
              LEFT JOIN {{ ref('DIM','CONTACT') }} CONTACT
                ON STAGE_OPUS_CONTACT.CONTACTSALESFORCEID = CONTACT.CONTACTSALESFORCEID
               AND STAGE_OPUS_CONTACT.FORCEID = CONTACT.FORCEID
        name: STAGEOPUS_CONTACT2
        noLinkRefs: []
  name: STAGE_OPUS_CONTACT2
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
