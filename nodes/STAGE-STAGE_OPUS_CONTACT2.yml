fileVersion: 1
id: d0d6f96c-390e-4dd9-b07d-be56ddbadc7b
name: STAGE_OPUS_CONTACT2
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da8bd22e-4307-4e67-8ed4-9c8249b0d6fa
          stepCounter: d0d6f96c-390e-4dd9-b07d-be56ddbadc7b
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CONTACTSALESFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e565f592-5b6e-431a-b69e-5f4d4aa0f718
                stepCounter: a6e66945-de23-4d37-96d4-eca0e04775ef
            transform: IFNULL(STAGEOPUS_CONTACT.CONTACTSALESFORCEID,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4850547f-3924-491d-81e8-454279e63613
          stepCounter: d0d6f96c-390e-4dd9-b07d-be56ddbadc7b
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: OPUS_DUPLICATE_RANK
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ROW_NUMBER() OVER(PARTITION BY STAGEOPUS_CONTACT.FORCEID,STAGEOPUS_CONTACT.LEVEL1FORCEID,STAGEOPUS_CONTACT.EMAIL ORDER BY IFNULL(STAGEOPUS_CONTACT.LASTACTIVITYDATE,'1899-01-01') DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0bc96ea-1cbb-4354-86ae-a23d14fd702d
          stepCounter: d0d6f96c-390e-4dd9-b07d-be56ddbadc7b
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: LASTACTIVITYDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 921ef76e-872e-4855-9792-cf2081365fcd
                stepCounter: a6e66945-de23-4d37-96d4-eca0e04775ef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03270754-35aa-40b9-ab3f-056b6f18350e
          stepCounter: d0d6f96c-390e-4dd9-b07d-be56ddbadc7b
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb98ec72-bcab-4f62-8dcf-118c2a48ed12
                stepCounter: a6e66945-de23-4d37-96d4-eca0e04775ef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a05fd06a-4c32-401e-ae6a-5ccb96a44ab7
          stepCounter: d0d6f96c-390e-4dd9-b07d-be56ddbadc7b
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f5ba1aa-ad0b-4cb2-bfba-a3bf5d3da969
                stepCounter: a6e66945-de23-4d37-96d4-eca0e04775ef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d16e6177-b2af-4d0c-9b85-2259c13342e6
          stepCounter: d0d6f96c-390e-4dd9-b07d-be56ddbadc7b
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9f18db8b-8dd7-4b94-9c7c-5b3e37283703
                stepCounter: a6e66945-de23-4d37-96d4-eca0e04775ef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7b36b39-1b5f-42bf-a278-c4b5ad966a01
          stepCounter: d0d6f96c-390e-4dd9-b07d-be56ddbadc7b
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE HIGHEST-LEVEL OF HIERARCHY FOR AN ACCOUNT
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d6d1fa69-37c2-42fc-a35b-aeadf98e9d42
                stepCounter: a6e66945-de23-4d37-96d4-eca0e04775ef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3af6a205-1d4b-4693-b1a8-7583bb0ab49a
          stepCounter: d0d6f96c-390e-4dd9-b07d-be56ddbadc7b
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a477f9ad-5987-49d4-9401-05aee955c402
                stepCounter: a6e66945-de23-4d37-96d4-eca0e04775ef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06a7f401-5c80-4378-92b4-8a66b136d4bf
          stepCounter: d0d6f96c-390e-4dd9-b07d-be56ddbadc7b
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed1df6ec-ae10-4331-affc-ff0be56a35ff
                stepCounter: a6e66945-de23-4d37-96d4-eca0e04775ef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b714ab1a-5858-4ea0-bf53-f9a0bd7f18c2
          stepCounter: d0d6f96c-390e-4dd9-b07d-be56ddbadc7b
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CREATEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f3f42ef6-87b6-4fcd-aaec-2f005dce6043
                stepCounter: a6e66945-de23-4d37-96d4-eca0e04775ef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 992ae22d-9b1b-4ed6-bca2-42451a304cc2
          stepCounter: d0d6f96c-390e-4dd9-b07d-be56ddbadc7b
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: EMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: af1512bd-0a4e-4145-bba7-d5c5d61a85c9
                stepCounter: a6e66945-de23-4d37-96d4-eca0e04775ef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf14960a-1186-44d3-8e15-72c7c4f7a3a5
          stepCounter: d0d6f96c-390e-4dd9-b07d-be56ddbadc7b
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CREATEDWAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4bd9b916-6694-4d1f-b5cc-23b88606bdc4
                stepCounter: a6e66945-de23-4d37-96d4-eca0e04775ef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0997e13-e36e-4020-bdb0-23ce2f3d39d4
          stepCounter: d0d6f96c-390e-4dd9-b07d-be56ddbadc7b
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: HOWDIDYOUHEARABOUTOPUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f9cbfdf-bb7a-428f-995f-d8b85da5bbd5
                stepCounter: a6e66945-de23-4d37-96d4-eca0e04775ef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff3c5683-4e40-490c-8068-2e576f200c28
          stepCounter: d0d6f96c-390e-4dd9-b07d-be56ddbadc7b
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ACCEPTEDTERMSANDCONDITIONS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 593d4210-d462-4624-b41e-579fe79c95bc
                stepCounter: a6e66945-de23-4d37-96d4-eca0e04775ef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 011091fc-f8ce-413c-bf7c-504a5299233b
          stepCounter: d0d6f96c-390e-4dd9-b07d-be56ddbadc7b
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: MODIFIEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a40d456-76e9-40af-a669-ace41b094da9
                stepCounter: a6e66945-de23-4d37-96d4-eca0e04775ef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb0b293d-e9a9-4b58-afe4-6f6119993d2f
          stepCounter: d0d6f96c-390e-4dd9-b07d-be56ddbadc7b
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: LASTLOGINDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 839c46f0-beb0-4309-8e96-f3300f3284c0
                stepCounter: a6e66945-de23-4d37-96d4-eca0e04775ef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a588377-f202-4683-8714-594c2dfadcac
          stepCounter: d0d6f96c-390e-4dd9-b07d-be56ddbadc7b
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: OPUSSUBSOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bd21c5da-01fc-41e6-9b51-594110e2500b
                stepCounter: a6e66945-de23-4d37-96d4-eca0e04775ef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8644221-e053-4bc3-9979-dd563de75b7a
          stepCounter: d0d6f96c-390e-4dd9-b07d-be56ddbadc7b
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0d93e8ec-a361-4c63-b983-38abf3591a79
                stepCounter: a6e66945-de23-4d37-96d4-eca0e04775ef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 134a8cc6-1b18-4393-9c41-2fe1486bff81
          stepCounter: d0d6f96c-390e-4dd9-b07d-be56ddbadc7b
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8183e870-b38d-4099-8ec7-c90284067dd4
                stepCounter: a6e66945-de23-4d37-96d4-eca0e04775ef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c02ee3db-ce97-456f-a3cc-04972f58f5ad
          stepCounter: d0d6f96c-390e-4dd9-b07d-be56ddbadc7b
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5b6b126-f659-413d-b328-091ee093385e
          stepCounter: d0d6f96c-390e-4dd9-b07d-be56ddbadc7b
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          CONTACT: 35f8d78b-6e7b-4fb6-a9b9-11bebbacf1ea
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: STAGE
            nodeName: STAGE_OPUS_CONTACT
          - locationName: UNKNOWN
            nodeName: STAGEOPUS_CONTACT
          - locationName: DIM
            nodeName: CONTACT
        join:
          joinCondition: |-
            FROM {{ ref('UNKNOWN','STAGEOPUS_CONTACT') }} STAGEOPUS_CONTACT
              LEFT JOIN {{ ref('DIM','CONTACT') }} CONTACT
                ON STAGEOPUS_CONTACT.CONTACTSALESFORCEID = CONTACT.CONTACTSALESFORCEID
               AND STAGEOPUS_CONTACT.FORCEID = CONTACT.FORCEID
        name: STAGEOPUS_CONTACT2
        noLinkRefs: []
  name: STAGE_OPUS_CONTACT2
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
