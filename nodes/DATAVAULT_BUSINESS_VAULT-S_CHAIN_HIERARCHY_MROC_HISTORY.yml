fileVersion: 1
id: d0fa4969-a61f-45bb-8a8b-989157693d32
name: S_CHAIN_HIERARCHY_MROC_HISTORY
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DATAVAULT_BUSINESS_VAULT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e26d18b-dd93-4359-9809-d218c334e548
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: ""
        name: HK_H_CHAIN_HIERARCHY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 58b3d20e-0419-4785-851f-2fd20b4e3d3f
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0848fda7-866e-4005-85d9-4f30975994b3
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: The Merchant Internal Number, the unique identifier to the system.
        isBusinessKey: true
        name: MERCHANT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d842fb5-7cde-437c-a60c-c655dbbea209
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ceb98760-d778-403c-8331-10756eeef34b
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: FILLER_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51be2fe2-a31e-4a79-ab0b-e1db7e341cc5
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18de2ccd-a910-4138-a082-d023e46b70d4
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: A code identifying an institution.
        name: INSTITUTION_ID_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 35286574-b5f0-4124-b991-5ff8a9570d23
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81d0546b-85ff-4990-afa5-061b57b22905
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: The sequence number is part of the physical primary key. It is being used to identify instances with the same Institution and Merchant Number. The currently effective instance is identified by the sequence number zero.
        name: SEQUENCE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94e7b299-6f91-40a9-9830-9b8d941e0a83
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66b9982b-b01a-485c-a5b8-ae8b7fcf0af5
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: Specifies the date from which an effective period of an instance starts.
        name: START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 939daed8-2b84-4c38-8894-e5e312991293
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a4b9844d-8a04-450b-a33b-7335603b2f56
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: Specifies the date from which an effective period of an instance ends.
        name: END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8332c5b9-b4cf-4b14-9e6a-8a2847a047c8
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d59ea58b-0d7a-4360-b312-2cea93f2dc38
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: "A logical delete indicator: '1' means it is logically deleted; '0' means it is not."
        name: DELETE_INDICATOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b86ae46d-86f4-4549-b0da-e2cc495e0bfd
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d01b33a1-8109-4198-ac1d-a25dbcca139b
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: For each Institution ID, Merchant Internal Number with a sequence number of zero, this specifies the next Sequence Number available for use.
        name: NEXT_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4d4c91f4-5112-41da-af61-9246abaff463
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bba1ad18-4862-42ab-96e3-151e67035511
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: Identifies the structure the merchant belongs to.
        name: STRUCTURE_IDENTIFICATION_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78a95b1c-3328-4d0b-8a68-771d85ce4ec5
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8cda81f-5f47-4607-a613-9c8d120cfa74
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: An Indicator to show if the merchant is active or not within the structure for the time period specified by the start and end dates. '1 ' = Active, '0 ' = Inactive.
        name: ACTIVE_INDICATOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5bb654db-a1d7-49ec-87b7-1ef214d5d2aa
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6c9bd61-a2e6-4f7d-84c6-358ee706d57e
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: Identifies the TOP level merchant in the structure. This is a hierarchical list of all the parents of the merchant given that there could be up to 9 levels within a hierarchical structure.
        name: PARENT_LEVEL_NUMBER_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2139150c-2936-4e2a-b265-ce4cd9a1a12b
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 30fcd298-78a4-4e47-bc38-fb1d7a0eac9b
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: NULLIF_PNT_LVL_2_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f5eb39c6-66df-45af-9d67-5df200bb3178
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c10474f-55dd-4572-9815-80085df56d9e
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: Identifies the second level merchant in the structure. This is a hierarchical list of all the parents of the merchant given that there could be up to 9 levels within a hierarchical structure.
        name: PARENT_LEVEL_NUMBER_2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3aee7e1b-c102-4450-90c9-c2de4d92f3a0
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6b22d75-db0b-4fbc-9aee-2386bc688105
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: NULLIF_PNT_LVL_3_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64ded52d-a140-4d6b-89af-596a958d660d
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8c1433b-db3c-46b5-83b6-8cbaa63131b9
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: Identifies the third level merchant in the structure. This is a hierarchical list of all the parents of the merchant given that there could be up to 9 levels within a hierarchical structure.
        name: PARENT_LEVEL_NUMBER_3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 85a5a782-fb0a-42df-b3e1-b93850c9f9e0
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc6958c7-e72e-4844-acb5-9502cad281a9
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: NULLIF_PNT_LVL_4_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4fa181a3-fde4-4ea4-baa3-b4eb550b6b95
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d385227-f058-4a7b-856f-3d5b94ad94c8
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: Identifies the fourth level merchant in the structure. This is a hierarchical list of all the parents of the merchant given that there could be up to 9 levels within a hierarchical structure.
        name: PARENT_LEVEL_NUMBER_4
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5aafd85e-a6d1-41eb-a20f-fc6db46cdb3b
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09bd6e47-783d-403f-8859-42a8f68be95b
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: NULLIF_PNT_LVL_5_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c3d3686-c1e8-4850-b3db-fd1825adc9b8
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c00d4c34-9cb0-404e-b99c-5238cf14fab2
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: Identifies the fifth level merchant in the structure. This is a hierarchical list of all the parents of the merchant given that there could be up to 9 levels within a hierarchical structure.
        name: PARENT_LEVEL_NUMBER_5
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f87d87e-350e-47bb-975f-74a171981c35
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9835b1aa-fe87-4365-b50d-a94169ab55fc
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: NULLIF_PNT_LVL_6_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 65d783d6-9cd1-487e-b7ce-918b5a90271e
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8f94b1d-017e-48e9-853c-ed46b393a29e
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: Identifies the sixth level merchant in the structure. This is a hierarchical list of all the parents of the merchant given that there could be up to 9 levels within a hierarchical structure.
        name: PARENT_LEVEL_NUMBER_6
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b8be6b7-37c0-4d5d-b391-b00e46091802
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6deab04-f32b-4b91-a0c9-1beb26455737
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: NULLIF_PNT_LVL_7_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a0d1ea40-5db5-4935-91c8-e80ea7804aae
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 671b0386-68be-48a2-ac48-0ff1e1efaf86
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: Identifies the seventh level merchant in the structure. This is a hierarchical list of all the parents of the merchant given that there could be up to 9 levels within a hierarchical structure.
        name: PARENT_LEVEL_NUMBER_7
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cce60f60-1fef-4895-9d84-c4140e7b6230
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c4cb25b-9849-440c-9cd4-d07892092e9e
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: NULLIF_PNT_LVL_8_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23ad9071-d43d-42d2-bac6-62811ec3f191
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c67a61a1-aecc-4d10-8158-250adf05d9cc
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: Identifies the eighth level merchant in the structure. This is a hierarchical list of all the parents of the merchant given that there could be up to 9 levels within a hierarchical structure.
        name: PARENT_LEVEL_NUMBER_8
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b4f9183-7fa8-4321-91b9-0f44fa3e321f
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7dc19acc-fb92-4624-b409-7adbd646238d
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: NULLIF_PNT_LVL_9_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3228407b-808a-4d91-8f15-86f888d547f3
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0421dfc-d02b-4f61-9077-75fe834788a4
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: Identifies the ninth level merchant in the structure. This is a hierarchical list of all the parents of the merchant given that there could be up to 9 levels within a hierarchical structure.
        name: PARENT_LEVEL_NUMBER_9
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3d7a4ea8-4832-4cc2-b8cf-5cf3cb0fb334
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c50c5c3-a4e7-4249-83b6-356d5f25e142
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: Identifies the level that the merchant is within the structure. There are nine possible levels within a structure, where 1 = top level merchant and 9 is the lowest level merchant.
        name: LEVEL_SEQUENCE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c86b07d2-05b9-4e4a-9632-769b3b3a9fc5
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 055faef7-0254-4be9-8310-4ce76b23cc26
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: A reference data look up code with 3 possible values that identify if the merchant within the structure is either a Top level merchant, an Intermediate or a Bottom level merchant.
        name: HIERARCHY_POSITION_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60c69a50-e614-4d24-9830-46a88f737406
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91acc943-ab30-442c-933a-78cbe9396f4b
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: Last update date
        name: LAST_UPDATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07ef31ca-b2ba-4717-8ccb-46670be180b6
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1012bc9-0465-4758-8abc-d0cbd9fd82f3
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: last update time
        name: LAST_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3f05804f-c2c4-4858-bf58-40d815fd1266
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac768a3f-9351-4a60-89d9-d1c66af97b24
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Last update user id
        name: LAST_UPDATE_USER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cccc813e-20a7-479f-849d-2f58a7546f0e
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b04f1465-cf76-4e69-8d9d-2c9bca937274
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: last update number
        name: LAST_UPDATE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f19facc0-b369-42d9-ae04-79f4920237e0
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e9f995d-4a77-47e8-8d02-a2a1889b96c8
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: P_ITN_ALS_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 875cfcd6-5977-4126-ac43-dfdae18e574d
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc1f26ba-1c09-488d-af1e-2686e0baf985
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: P_PTT_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dfda788b-4251-453b-9452-2f9076a09cc5
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d054caf-8b44-4de3-bc6b-26412806176f
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CREATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f6f82f28-2288-4691-8c94-6b0e3c4d3400
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1621c3c3-2788-4013-9d89-24f57832898b
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: CREATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f77719eb-0ded-4abb-a82d-4908e306486f
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e1ddf04-3c75-4b4c-852d-e315a9829568
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: UPDATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c32f79c9-54f3-4a8a-8ca9-7501b24197c9
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72300e47-05fe-4d39-95d0-98bc4d4f3b3f
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: UPDATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b926c77b-8497-4c25-9165-8ffba3d645f4
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6fd75838-4016-4638-96d1-b803d30526d3
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: RUN_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 58f446de-f5d1-47ad-9db3-85cdc5b1078e
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95d700f1-f99e-46d1-8d97-cb24b07dde5d
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: TIMESTAMP_NTZ(3)
        defaultValue: ""
        description: ""
        name: FILE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1109b03a-21cb-486d-bcc4-359820245e09
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6435c2fb-020d-4975-be64-7313a98da5af
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: The changing hash
        name: DSS_CHANGE_HASH
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ba44ff6-1f7e-428f-8ba4-29db1103d2fd
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86f546b6-e663-4d9c-805b-2e7d9e7f805d
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Record source
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 288e5866-59ca-4b53-bab5-1d67b790f0d9
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a970c6fa-5f3f-47e8-84d1-3f9117692cf3
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was loaded in the data vault
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e67c48c7-56ed-423d-85d8-55b27da89cd3
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 99c41bd1-b46f-4245-a277-4b563e3349e0
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row started in the data vault
        isSystemStartDate: true
        name: DSS_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6debd757-fe39-4954-8b5f-81f773b73aa0
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29673b1c-11a1-4454-b886-78794c79e778
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: Version number of a business key in the data vault
        isSurrogateKey: true
        isSystemVersion: true
        name: DSS_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: baa46a1c-1a76-4104-947e-418d844863bb
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14f4b4bb-fc0b-4eac-8eba-e8477695b37c
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was inserted in the data vault
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e273da1f-a1ee-47c9-9a3e-d1698134b395
                stepCounter: bbe9cf27-0228-4b98-8e56-305436c85207
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6a8ff2a-15eb-462c-9a57-4e67de886018
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: End date determined by the next Satellite change record dss_start_date
        isSystemEndDate: true
        name: DSS_END_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: LEAD(dss_start_date, 1, '9999-12-31') OVER(PARTITION BY hk_h_chain_hierarchy ORDER BY dss_start_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c16e147-2a67-4b62-a920-dd0874bb2bb8
          stepCounter: d0fa4969-a61f-45bb-8a8b-989157693d32
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: CurrentFlag 'N' unless next Satellite change record dss_start_date is null, indicating this is the most current record.
        isSurrogateKey: true
        isSystemCurrentFlag: true
        name: DSS_CURRENT_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN LEAD(dss_start_date, 1, NULL) OVER(PARTITION BY hk_h_chain_hierarchy ORDER BY dss_start_date) IS NULL THEN 'Y'
                          ELSE 'N'
                           END
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_CHAIN_HIERARCHY_MROC: bbe9cf27-0228-4b98-8e56-305436c85207
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATAVAULT_RAW_VAULT
            nodeName: S_CHAIN_HIERARCHY_MROC
        join:
          joinCondition: FROM {{ ref('DATAVAULT_RAW_VAULT','S_CHAIN_HIERARCHY_MROC') }} s_chain_hierarchy_mroc
        name: S_CHAIN_HIERARCHY_MROC_HISTORY
        noLinkRefs: []
  name: S_CHAIN_HIERARCHY_MROC_HISTORY
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
