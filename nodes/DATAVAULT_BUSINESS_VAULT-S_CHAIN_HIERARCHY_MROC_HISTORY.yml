fileVersion: 1
id: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
name: S_CHAIN_HIERARCHY_MROC_HISTORY
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DATAVAULT_BUSINESS_VAULT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d1e3ea13-b90b-47d9-9063-08a2280661c0
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: ""
        name: HK_H_CHAIN_HIERARCHY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: df12fa3c-3dd1-4b3a-9a00-8c5dcb89fe0e
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c463f8de-f76f-4417-a9b1-2daa1d88c8bd
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: The Merchant Internal Number, the unique identifier to the system.
        isBusinessKey: true
        name: MERCHANT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d06d358e-19d5-41f2-8f8f-dc74da7d8d7c
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41908740-ef14-49ae-bab4-408b5f34265f
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: FILLER_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bd5d9a9e-1201-4599-b579-4e6c4b479f95
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8752d01-dd1b-42ac-8a05-d252b4a6b2af
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: A code identifying an institution.
        name: INSTITUTION_ID_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 71a9ca0e-56de-4523-8c8e-d84b1b789538
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe7f9f0d-1b5b-4ad8-8fd7-f99369c4b494
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: The sequence number is part of the physical primary key. It is being used to identify instances with the same Institution and Merchant Number. The currently effective instance is identified by the sequence number zero.
        name: SEQUENCE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 98022a70-77af-401e-9471-cbb27bfdfa83
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 815e82d8-98e5-4cbf-a50a-908d9bbac8d8
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: Specifies the date from which an effective period of an instance starts.
        name: START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c8635adc-d0a8-4bfb-ad87-65b88fa9cb26
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 824f9f55-4cc0-45d7-be61-371125b8575b
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: Specifies the date from which an effective period of an instance ends.
        name: END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a4ffc3e-7a4d-4fda-9ed4-4d7ce3e8a6f9
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8c2c5b8-0033-4884-81ab-002885409ba8
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: "A logical delete indicator: '1' means it is logically deleted; '0' means it is not."
        name: DELETE_INDICATOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f32b6f0b-556c-4cce-a60d-d31ca5519758
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8434ed5c-d24d-4b31-a349-3aff7a001526
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: For each Institution ID, Merchant Internal Number with a sequence number of zero, this specifies the next Sequence Number available for use.
        name: NEXT_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 40c614cd-9f90-4ce0-be0c-b9726d75b61a
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab5a4d79-ae6b-45ad-aa97-32a28585b51e
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: Identifies the structure the merchant belongs to.
        name: STRUCTURE_IDENTIFICATION_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4309acbe-7f40-41fe-a8c1-b74f4975e10f
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 374304b1-b9ee-42fb-99d1-5a78011527ed
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: An Indicator to show if the merchant is active or not within the structure for the time period specified by the start and end dates. '1 ' = Active, '0 ' = Inactive.
        name: ACTIVE_INDICATOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2e22d6b-4de1-4bc4-88c3-044b493531ee
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a26136c-43a6-4013-9909-2d8e1a70c351
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: Identifies the TOP level merchant in the structure. This is a hierarchical list of all the parents of the merchant given that there could be up to 9 levels within a hierarchical structure.
        name: PARENT_LEVEL_NUMBER_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b32a359-2d22-40b8-a136-7aaf97c462b3
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb1c7060-1078-4449-9d33-7936013919ca
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: NULLIF_PNT_LVL_2_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 272562c2-a61c-4582-83db-f02fa642194b
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3bb558a-f320-4eae-8fcd-1711d3bdb8fa
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: Identifies the second level merchant in the structure. This is a hierarchical list of all the parents of the merchant given that there could be up to 9 levels within a hierarchical structure.
        name: PARENT_LEVEL_NUMBER_2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 618da8de-9ff7-4c34-beae-e3c18554e4ab
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ee13550-df4c-40bc-b483-97fa7b150aea
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: NULLIF_PNT_LVL_3_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d44ec8d5-385f-4f65-9b72-97e955de8b5e
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ee9b3c7-efbc-4128-8133-18ea43cf3208
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: Identifies the third level merchant in the structure. This is a hierarchical list of all the parents of the merchant given that there could be up to 9 levels within a hierarchical structure.
        name: PARENT_LEVEL_NUMBER_3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f016d895-754a-4b8a-bed9-19035afcba9e
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01547506-a645-42e3-b174-ebcd1659e0d8
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: NULLIF_PNT_LVL_4_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c7ec8d8-b473-4620-80b6-9560408a3a65
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e9c9d15-b06b-45a4-8dd8-a1949cd66423
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: Identifies the fourth level merchant in the structure. This is a hierarchical list of all the parents of the merchant given that there could be up to 9 levels within a hierarchical structure.
        name: PARENT_LEVEL_NUMBER_4
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 861b61c1-7fc1-4e97-ac5a-8072e159d8a0
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03e869dd-8be8-4f05-a1c7-47fd16d8943d
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: NULLIF_PNT_LVL_5_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8cb346f8-0e54-4457-9c32-d4a8f9ca036a
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce2bf498-1e6a-403e-a551-8fc8b08e6930
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: Identifies the fifth level merchant in the structure. This is a hierarchical list of all the parents of the merchant given that there could be up to 9 levels within a hierarchical structure.
        name: PARENT_LEVEL_NUMBER_5
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b508ef1a-7f53-480c-a586-d4df13b489db
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b30a4e98-cf01-4d38-b540-1215795a3d5e
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: NULLIF_PNT_LVL_6_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ae1b21c7-1d8a-4164-ab3b-c1198f481169
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5bfac8b-341c-4c25-961b-653c5824b867
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: Identifies the sixth level merchant in the structure. This is a hierarchical list of all the parents of the merchant given that there could be up to 9 levels within a hierarchical structure.
        name: PARENT_LEVEL_NUMBER_6
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8987cdbc-7d55-4b16-b5c5-90a56e4479b6
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf9ba8d3-f15d-4b37-918d-8a3585dab7b9
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: NULLIF_PNT_LVL_7_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 12a66c89-b151-4afa-a9cb-f36bc75f71fc
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6548e9ef-8461-4079-9890-a900b39de55e
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: Identifies the seventh level merchant in the structure. This is a hierarchical list of all the parents of the merchant given that there could be up to 9 levels within a hierarchical structure.
        name: PARENT_LEVEL_NUMBER_7
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7569e72a-c33c-4e66-932e-fe0cbf46b69d
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 56690ae3-ba70-47ab-978b-210bd29239ee
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: NULLIF_PNT_LVL_8_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a40b6473-1c9a-4c2e-82a3-10e4cc83f805
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4141e3dc-30a3-4a7d-b3db-3d444df9aa83
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: Identifies the eighth level merchant in the structure. This is a hierarchical list of all the parents of the merchant given that there could be up to 9 levels within a hierarchical structure.
        name: PARENT_LEVEL_NUMBER_8
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2066ecb5-2efb-41ad-8671-015047af267b
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb6ec4f1-6c1e-49e1-b5fb-935649540714
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: NULLIF_PNT_LVL_9_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e0225fa2-7095-42dd-9a10-50f1d5fa6795
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e6872b6-3222-4603-917a-261cc9cc7fb2
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: Identifies the ninth level merchant in the structure. This is a hierarchical list of all the parents of the merchant given that there could be up to 9 levels within a hierarchical structure.
        name: PARENT_LEVEL_NUMBER_9
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 583295c0-ec5d-4bf5-98b5-e6600e0399dd
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b2dffb77-de7e-450f-bbed-6001ca1c5ad2
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: Identifies the level that the merchant is within the structure. There are nine possible levels within a structure, where 1 = top level merchant and 9 is the lowest level merchant.
        name: LEVEL_SEQUENCE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: afc10b70-d144-47be-b038-5e564b782942
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab88e19f-12b6-4737-a76e-37738aec5dc2
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: A reference data look up code with 3 possible values that identify if the merchant within the structure is either a Top level merchant, an Intermediate or a Bottom level merchant.
        name: HIERARCHY_POSITION_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c26e2094-ee2a-4f3f-8089-0fb709e8ea17
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf14f5a9-e646-46f1-bd9d-ac43c1720d7d
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: Last update date
        name: LAST_UPDATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eb6453d2-03ba-44b7-b74a-14fdfcb298cf
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: acd93bd3-5b1f-4ae4-a479-28385d4e6f44
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: last update time
        name: LAST_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1a1a8127-bab9-4255-bb22-f73273ec95fc
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d542772-9e45-4c61-81e1-e001e03e31b0
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Last update user id
        name: LAST_UPDATE_USER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce19d994-dc60-4893-9093-9915b6ea6c66
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 19444c7e-7a24-4746-9e54-5544c621e490
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: last update number
        name: LAST_UPDATE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5793e268-0fb7-4c9b-8694-d9842c21af17
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb27c8d3-ad6a-4399-91f2-11f70e7ab275
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: P_ITN_ALS_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6dfe2ec9-d830-450b-b78d-d026ce4038ed
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c034c01c-bad7-44fb-a790-b5587fca6667
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: P_PTT_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11c91635-95ae-4962-85e6-122b7ed72712
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77030426-e50b-4cca-acef-dc1276fb7769
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CREATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec5fb25d-ca5a-4b76-8687-3458de8644fe
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 291aff95-bca8-440e-a3de-af6ba29d2f1c
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: CREATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ffec98ff-9242-4aa6-9319-3b9b12c2e130
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c99ff9ea-fb09-4315-aefd-1227ee644855
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: UPDATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8012855f-34e7-4e88-8441-fa79aa807b3d
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ac9d15e-163c-4893-a15d-2c86b221651f
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: UPDATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0efe7598-edcb-4af6-a8af-aa99eae831b4
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6431f95b-4688-4a29-a866-36c148bc8e9d
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: RUN_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2b8532e2-fb71-48b6-9052-8e7cb1fc0d13
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 959765a3-7eb3-416b-859f-08dbaa10a82f
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: TIMESTAMP_NTZ(3)
        defaultValue: ""
        description: ""
        name: FILE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dceceba2-84cf-4e80-9525-117a28b1c4ec
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67229861-852c-4463-93ff-db8af242b672
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: The changing hash
        name: DSS_CHANGE_HASH
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a23f5e92-3fb5-4c17-bc3d-811511909a5d
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86115abf-1900-41ba-aea6-46bdd626c6ad
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Record source
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 265f964f-02e1-4a11-8297-d062c7f79fd0
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6abed890-954b-4241-94b5-c1e0c8a7a2a9
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was loaded in the data vault
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24df0260-9e0d-4fcd-8b38-aa44a7e15f8f
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b102690-727d-4cc6-ad79-69b20bfa3961
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row started in the data vault
        isSystemStartDate: true
        name: DSS_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6904d4d5-2655-4a9c-bf1b-af12d8aa6f93
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a24d07b-a5c1-4e9e-a9c4-75b8ae3fdc34
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: Version number of a business key in the data vault
        isSurrogateKey: true
        isSystemVersion: true
        name: DSS_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e51b24de-97d8-42c5-a048-dfc6ab508019
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee49f0a4-47a2-4053-8d6b-e66abd73c4f6
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was inserted in the data vault
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 29e3554a-1ac8-4448-9886-926ad4e01f93
                stepCounter: af2a4808-74e9-4ee0-bf64-baca96f868d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 36edb7b2-9178-4229-98d0-cf9a6360df42
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: End date determined by the next Satellite change record dss_start_date
        isSystemEndDate: true
        name: DSS_END_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: LEAD(dss_start_date, 1, '9999-12-31') OVER(PARTITION BY hk_h_chain_hierarchy ORDER BY dss_start_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 217c6536-04f1-4e75-b770-5de34be2809f
          stepCounter: 48d16a13-3a2d-47ee-b5b3-79c1aea22019
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: CurrentFlag 'N' unless next Satellite change record dss_start_date is null, indicating this is the most current record.
        isSurrogateKey: true
        isSystemCurrentFlag: true
        name: DSS_CURRENT_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN LEAD(dss_start_date, 1, NULL) OVER(PARTITION BY hk_h_chain_hierarchy ORDER BY dss_start_date) IS NULL THEN 'Y'
                          ELSE 'N'
                           END
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_CHAIN_HIERARCHY_MROC: af2a4808-74e9-4ee0-bf64-baca96f868d5
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATAVAULT_RAW_VAULT
            nodeName: S_CHAIN_HIERARCHY_MROC
        join:
          joinCondition: FROM {{ ref('DATAVAULT_RAW_VAULT','S_CHAIN_HIERARCHY_MROC') }} s_chain_hierarchy_mroc
        name: S_CHAIN_HIERARCHY_MROC_HISTORY
        noLinkRefs: []
  name: S_CHAIN_HIERARCHY_MROC_HISTORY
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
