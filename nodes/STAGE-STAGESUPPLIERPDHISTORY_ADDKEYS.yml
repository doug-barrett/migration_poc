fileVersion: 1
id: 1e9bfbe9-67ac-4f9c-9717-e97bc0b43123
name: STAGESUPPLIERPDHISTORY_ADDKEYS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d0eca78e-f62f-4057-8df5-db178e6718fd
          stepCounter: 1e9bfbe9-67ac-4f9c-9717-e97bc0b43123
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: SUPPLIERSALESFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e6c61e4-0f71-40a9-80ba-cfb32a85617e
                stepCounter: c564afab-8b60-4f22-8f62-60b34fdcbd78
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 574597fe-37ad-471f-a858-0a4d7c2486d8
          stepCounter: 1e9bfbe9-67ac-4f9c-9717-e97bc0b43123
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SUPPLIERNAMESFDC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91865278-c3a2-4aa1-b619-8bb3d9e776a0
                stepCounter: c564afab-8b60-4f22-8f62-60b34fdcbd78
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae69b870-5b1f-4b64-a23a-86b8949ede71
          stepCounter: 1e9bfbe9-67ac-4f9c-9717-e97bc0b43123
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESUPPLIERPDHISTORY_ADDKEYS.SUPPLIERID=SUPPLIER.SUPPLIERID
        name: SUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 29f4e3f6-d1f4-4347-909f-18969301d6f1
                stepCounter: f82e9572-e5ea-45e1-991d-83ad35997403
            transform: IFNULL(SUPPLIER.SUPPLIERKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e1d560c-b5c9-423e-ab77-e31b07c96c77
          stepCounter: 1e9bfbe9-67ac-4f9c-9717-e97bc0b43123
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c00d64de-53b3-4b53-9008-cd7452c0460c
                stepCounter: c564afab-8b60-4f22-8f62-60b34fdcbd78
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 206844ba-9897-46ea-b6ba-922d49a4d66a
          stepCounter: 1e9bfbe9-67ac-4f9c-9717-e97bc0b43123
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: STARTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b511db92-2f1e-4832-a693-37d380d3c7a0
                stepCounter: c564afab-8b60-4f22-8f62-60b34fdcbd78
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3775182-e462-4c9c-be85-714887ef50f0
          stepCounter: 1e9bfbe9-67ac-4f9c-9717-e97bc0b43123
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: ENDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 63543a5d-a672-45b2-b7ae-57fe5caec79a
                stepCounter: c564afab-8b60-4f22-8f62-60b34fdcbd78
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d7d2aa1-7639-4ee3-9963-6a8276a62b21
          stepCounter: 1e9bfbe9-67ac-4f9c-9717-e97bc0b43123
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PD_VP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6b0e4750-a2c9-4408-be27-40def82840ff
                stepCounter: c564afab-8b60-4f22-8f62-60b34fdcbd78
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22666608-42c5-47aa-888b-6c3481225ed3
          stepCounter: 1e9bfbe9-67ac-4f9c-9717-e97bc0b43123
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PD_DIRECTOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1df7fa3-db1f-4389-b8c5-7f22ce1ea424
                stepCounter: c564afab-8b60-4f22-8f62-60b34fdcbd78
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f0b8d74-3b2a-4f8b-b841-e0bb58bcc47f
          stepCounter: 1e9bfbe9-67ac-4f9c-9717-e97bc0b43123
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: PD_VP_EMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ff170dac-5669-4333-8ba7-6651e48b55b8
                stepCounter: c564afab-8b60-4f22-8f62-60b34fdcbd78
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6636fd8f-59cf-4b41-9f9f-513f7da0619d
          stepCounter: 1e9bfbe9-67ac-4f9c-9717-e97bc0b43123
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: PD_DIRECTOR_EMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 289dd019-6c9b-4929-a46a-983558d4a07b
                stepCounter: c564afab-8b60-4f22-8f62-60b34fdcbd78
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a15941e-01eb-416c-9041-63fa54db7e0f
          stepCounter: 1e9bfbe9-67ac-4f9c-9717-e97bc0b43123
        config: {}
        dataType: VARCHAR(18)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: PD_ASSIGNMENT_SALESFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b0d1900-e99e-4eac-9f26-7990f354320b
                stepCounter: c564afab-8b60-4f22-8f62-60b34fdcbd78
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29f4a22d-dee4-4282-8d75-f502254a2de9
          stepCounter: 1e9bfbe9-67ac-4f9c-9717-e97bc0b43123
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: NON CONFORMED DIMENSION KEY
        isSurrogateKey: true
        name: DSS_SOURCE_SYSTEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '3'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2c7f7b4-ae3e-4f96-9861-048298cf64fd
          stepCounter: 1e9bfbe9-67ac-4f9c-9717-e97bc0b43123
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2932824-7f17-42fe-a7b9-7cd586b86b4e
                stepCounter: c564afab-8b60-4f22-8f62-60b34fdcbd78
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b3cbf170-acb8-4fcc-9f43-49f658d0e16e
          stepCounter: 1e9bfbe9-67ac-4f9c-9717-e97bc0b43123
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b7013590-c0f7-4078-8027-fcec146cfcc6
                stepCounter: c564afab-8b60-4f22-8f62-60b34fdcbd78
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 591d5480-5d5c-436d-8973-506ea4cbf826
          stepCounter: 1e9bfbe9-67ac-4f9c-9717-e97bc0b43123
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a446f3f1-0b82-40c7-ab28-cd0790c66912
          stepCounter: 1e9bfbe9-67ac-4f9c-9717-e97bc0b43123
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGESFDCSUPPLIERPDHISTORY: c564afab-8b60-4f22-8f62-60b34fdcbd78
          SUPPLIER: f82e9572-e5ea-45e1-991d-83ad35997403
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: SUPPLIER
          - locationName: STAGE
            nodeName: STAGESFDCSUPPLIERPDHISTORY
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','STAGESFDCSUPPLIERPDHISTORY') }} STAGESFDCSUPPLIERPDHISTORY
              LEFT JOIN {{ ref('DIM','SUPPLIER') }} SUPPLIER
                ON STAGESFDCSUPPLIERPDHISTORY.SUPPLIERID = SUPPLIER.SUPPLIERID
               AND SUPPLIER.DSS_SOURCE_SYSTEM_KEY = 3
        name: STAGESUPPLIERPDHISTORY_ADDKEYS
        noLinkRefs: []
  name: STAGESUPPLIERPDHISTORY_ADDKEYS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
