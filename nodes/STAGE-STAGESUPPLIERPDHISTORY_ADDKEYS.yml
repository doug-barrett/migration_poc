fileVersion: 1
id: 3e6a1979-8ec0-41ce-9053-872a678b5eb6
name: STAGESUPPLIERPDHISTORY_ADDKEYS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 46caa7c4-533d-4121-9a5b-00587ab9109c
          stepCounter: 3e6a1979-8ec0-41ce-9053-872a678b5eb6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: SUPPLIERSALESFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 370cc18a-c560-4ad0-8821-b012d11d9806
                stepCounter: 0da85e1b-bffe-46a7-826d-33b6f5168a35
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 271f4611-d521-4c96-9973-96c8ef0c3ac8
          stepCounter: 3e6a1979-8ec0-41ce-9053-872a678b5eb6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SUPPLIERNAMESFDC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00346ca2-0f5e-4d0c-9d8a-b6f0d975e479
                stepCounter: 0da85e1b-bffe-46a7-826d-33b6f5168a35
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88ff2fd3-733f-4154-b05b-dea9bdca590e
          stepCounter: 3e6a1979-8ec0-41ce-9053-872a678b5eb6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESUPPLIERPDHISTORY_ADDKEYS.SUPPLIERID=SUPPLIER.SUPPLIERID
        name: SUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8af74fd2-6685-417f-ba69-54e34a59747a
                stepCounter: 46ab7310-f206-4d38-93fc-0dcfb497301d
            transform: IFNULL(SUPPLIER.SUPPLIERKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2772856b-c04f-4c15-b9b2-99395a7a6eb6
          stepCounter: 3e6a1979-8ec0-41ce-9053-872a678b5eb6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0169e9e9-677a-473a-a674-27e479f10569
                stepCounter: 0da85e1b-bffe-46a7-826d-33b6f5168a35
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0bab5e17-17ed-410b-a7c6-d570a7414c7e
          stepCounter: 3e6a1979-8ec0-41ce-9053-872a678b5eb6
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: STARTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ead75da1-6f9a-482d-84df-658f167592c2
                stepCounter: 0da85e1b-bffe-46a7-826d-33b6f5168a35
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae644d4e-b98b-43df-ad1e-6cf481d29b16
          stepCounter: 3e6a1979-8ec0-41ce-9053-872a678b5eb6
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: ENDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 887c871b-efea-480d-a491-78bb6dad58eb
                stepCounter: 0da85e1b-bffe-46a7-826d-33b6f5168a35
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7b19ab9-2df5-4b43-83ac-65dd44f4a2b3
          stepCounter: 3e6a1979-8ec0-41ce-9053-872a678b5eb6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PD_VP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c2d936df-9ac1-4f7e-b9f1-4d6ebb3655e7
                stepCounter: 0da85e1b-bffe-46a7-826d-33b6f5168a35
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb43f61f-2728-44c4-a984-cba4ab995adb
          stepCounter: 3e6a1979-8ec0-41ce-9053-872a678b5eb6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PD_DIRECTOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e485d2f-42c0-4220-9244-a1f82f7190b6
                stepCounter: 0da85e1b-bffe-46a7-826d-33b6f5168a35
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1dc1609-66f7-4cb0-950e-aed7762ad4f2
          stepCounter: 3e6a1979-8ec0-41ce-9053-872a678b5eb6
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: PD_VP_EMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6cc4de4a-a6bf-409b-9f37-755961f7b2a5
                stepCounter: 0da85e1b-bffe-46a7-826d-33b6f5168a35
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af12b5b7-8b75-4afe-ae3c-3e05ed42e4c8
          stepCounter: 3e6a1979-8ec0-41ce-9053-872a678b5eb6
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: PD_DIRECTOR_EMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b69dba1-06a5-409a-8d3a-b1fbd18eb490
                stepCounter: 0da85e1b-bffe-46a7-826d-33b6f5168a35
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c9cd4e0-0d1f-43bd-ba92-04bd404125f1
          stepCounter: 3e6a1979-8ec0-41ce-9053-872a678b5eb6
        config: {}
        dataType: VARCHAR(18)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: PD_ASSIGNMENT_SALESFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03a8ea9f-bfaa-45d3-b55e-3ab9b12b9ef7
                stepCounter: 0da85e1b-bffe-46a7-826d-33b6f5168a35
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2adb62e-5385-416e-88b8-79a92ba13208
          stepCounter: 3e6a1979-8ec0-41ce-9053-872a678b5eb6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: NON CONFORMED DIMENSION KEY
        isSurrogateKey: true
        name: DSS_SOURCE_SYSTEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '3'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 00d90610-c942-4745-bb6e-274640a5811b
          stepCounter: 3e6a1979-8ec0-41ce-9053-872a678b5eb6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2748d2e-0b40-4f6a-b372-764398f25cf4
                stepCounter: 0da85e1b-bffe-46a7-826d-33b6f5168a35
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ecc1179e-0a54-4edd-b59a-06f8d1a3949e
          stepCounter: 3e6a1979-8ec0-41ce-9053-872a678b5eb6
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb83db26-6968-4349-b37a-39729b49630f
                stepCounter: 0da85e1b-bffe-46a7-826d-33b6f5168a35
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1f9cf25-7d47-4c91-92b7-0670d6d23958
          stepCounter: 3e6a1979-8ec0-41ce-9053-872a678b5eb6
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b32e036-65ad-416f-8503-18f95412ca23
          stepCounter: 3e6a1979-8ec0-41ce-9053-872a678b5eb6
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGESFDCSUPPLIERPDHISTORY: 0da85e1b-bffe-46a7-826d-33b6f5168a35
          SUPPLIER: 46ab7310-f206-4d38-93fc-0dcfb497301d
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: SUPPLIER
          - locationName: STAGE
            nodeName: STAGESFDCSUPPLIERPDHISTORY
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','STAGESFDCSUPPLIERPDHISTORY') }} STAGESFDCSUPPLIERPDHISTORY
              LEFT JOIN {{ ref('DIM','SUPPLIER') }} SUPPLIER
                ON STAGESFDCSUPPLIERPDHISTORY.SUPPLIERID = SUPPLIER.SUPPLIERID
               AND SUPPLIER.DSS_SOURCE_SYSTEM_KEY = 3
        name: STAGESUPPLIERPDHISTORY_ADDKEYS
        noLinkRefs: []
  name: STAGESUPPLIERPDHISTORY_ADDKEYS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
