fileVersion: 1
id: da7a33f7-89a5-4a62-a76e-546ef5f812bf
name: STAGESUPPLIERPDHISTORY_ADDKEYS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f52c06b9-91db-47de-a33b-e3f875d8405e
          stepCounter: da7a33f7-89a5-4a62-a76e-546ef5f812bf
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: SUPPLIERSALESFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: edd2b2d8-8ac0-4774-888c-1164f2effe24
                stepCounter: 7d114f26-ed08-4a70-9a00-34a84ce87496
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74db1db9-717b-4d01-a775-cf0f791dcefb
          stepCounter: da7a33f7-89a5-4a62-a76e-546ef5f812bf
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SUPPLIERNAMESFDC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 645a11ea-0510-46bc-bd77-d0927aef81c0
                stepCounter: 7d114f26-ed08-4a70-9a00-34a84ce87496
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ee111ad-c2b3-4517-b055-e5fccc78258f
          stepCounter: da7a33f7-89a5-4a62-a76e-546ef5f812bf
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: StageSupplierPDHistory_AddKeys.SupplierId=Supplier.SupplierId
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ca7d8c73-3078-40f4-859d-3f8262691621
                stepCounter: 4f59fbc0-7b06-498c-b967-f551d35c31c4
            transform: IFNULL(Supplier.SupplierKey,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dea93327-99c8-4fb3-a529-71460028bde5
          stepCounter: da7a33f7-89a5-4a62-a76e-546ef5f812bf
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f782946d-fde3-4a58-8586-7be2ba8a6ae5
                stepCounter: 7d114f26-ed08-4a70-9a00-34a84ce87496
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 243c5c11-19ec-49c8-b128-ce446636fec9
          stepCounter: da7a33f7-89a5-4a62-a76e-546ef5f812bf
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: STARTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eaf8fbf6-b68b-48d3-bf2d-49199e0fe968
                stepCounter: 7d114f26-ed08-4a70-9a00-34a84ce87496
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab542cb8-90e8-439b-8f31-25ba2e2b5671
          stepCounter: da7a33f7-89a5-4a62-a76e-546ef5f812bf
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: ENDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2229f7e-f4a2-403d-9cc4-caa9f63442e1
                stepCounter: 7d114f26-ed08-4a70-9a00-34a84ce87496
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2acc8bb4-84f8-4a83-8e75-fbebb02515d6
          stepCounter: da7a33f7-89a5-4a62-a76e-546ef5f812bf
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PD_VP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 474d9e74-a71a-4ea7-a32f-a2cee40dc338
                stepCounter: 7d114f26-ed08-4a70-9a00-34a84ce87496
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 62c40744-3961-40c3-aab3-ec3a91e17a56
          stepCounter: da7a33f7-89a5-4a62-a76e-546ef5f812bf
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PD_DIRECTOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 68f102c9-1676-409b-a65d-497b687a5ece
                stepCounter: 7d114f26-ed08-4a70-9a00-34a84ce87496
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 381d93cc-3d9a-48ed-97d9-ac363656bfaf
          stepCounter: da7a33f7-89a5-4a62-a76e-546ef5f812bf
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PD_VP_EMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ef221c0-d259-4621-9316-410ab026e169
                stepCounter: 7d114f26-ed08-4a70-9a00-34a84ce87496
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80185881-b081-4bb9-a7d0-3d8af83bc77a
          stepCounter: da7a33f7-89a5-4a62-a76e-546ef5f812bf
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PD_DIRECTOR_EMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d436b40c-8cce-42bd-9d78-2bbb61e41e8c
                stepCounter: 7d114f26-ed08-4a70-9a00-34a84ce87496
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1fc926ec-8bae-4e85-94e3-3e6b3a2eb00f
          stepCounter: da7a33f7-89a5-4a62-a76e-546ef5f812bf
        config: {}
        dataType: VARCHAR(18)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: PD_ASSIGNMENT_SALESFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e4d405a-fb60-43e1-9954-b4f0d4c6b88e
                stepCounter: 7d114f26-ed08-4a70-9a00-34a84ce87496
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71d6441a-a7a8-4f70-b72b-4f4e3ff64e80
          stepCounter: da7a33f7-89a5-4a62-a76e-546ef5f812bf
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: non conformed dimension key
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isSurrogateKey: true
        name: DSS_SOURCE_SYSTEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '3'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f1bd7c4-bd59-4841-8c32-418c4c9a6970
          stepCounter: da7a33f7-89a5-4a62-a76e-546ef5f812bf
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Record source.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b165f7d8-d369-4199-8d32-80d00960cd7c
                stepCounter: 7d114f26-ed08-4a70-9a00-34a84ce87496
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 566874be-e310-426a-ba61-143553ddad3f
          stepCounter: da7a33f7-89a5-4a62-a76e-546ef5f812bf
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Load date.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 615e9813-a80d-41a6-babf-57417129bf63
                stepCounter: 7d114f26-ed08-4a70-9a00-34a84ce87496
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8613141c-3949-4376-ab6b-c6e6b8582bbb
          stepCounter: da7a33f7-89a5-4a62-a76e-546ef5f812bf
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1bf2063f-1d7b-4d21-99fd-750009bcb4ed
          stepCounter: da7a33f7-89a5-4a62-a76e-546ef5f812bf
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGESFDCSUPPLIERPDHISTORY: 7d114f26-ed08-4a70-9a00-34a84ce87496
          SUPPLIER: 4f59fbc0-7b06-498c-b967-f551d35c31c4
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: SUPPLIER
          - locationName: STAGE
            nodeName: STAGESFDCSUPPLIERPDHISTORY
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','STAGESFDCSUPPLIERPDHISTORY') }} StageSFDCSupplierPDHistory
              LEFT JOIN {{ ref('DIM','SUPPLIER') }} Supplier
                ON StageSFDCSupplierPDHistory.SupplierId = Supplier.SupplierId
               AND Supplier.dss_source_system_key = 3
        name: STAGESUPPLIERPDHISTORY_ADDKEYS
        noLinkRefs: []
  name: STAGESUPPLIERPDHISTORY_ADDKEYS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
