fileVersion: 1
id: 75e9cebd-6757-4ecf-a568-bdb2c3cf09da
name: STAGESUPPLIERPDHISTORY_ADDKEYS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d31f1300-6219-48bc-bdca-8f984bd6f3af
          stepCounter: 75e9cebd-6757-4ecf-a568-bdb2c3cf09da
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: SUPPLIERSALESFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c3f4ec9-6746-4e9a-8b26-3d47a09f88e0
                stepCounter: 1fd0dcce-fa79-4083-a9b1-75b05ac27ef3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 603fb2b3-5e8f-43f7-9535-56a163e01eed
          stepCounter: 75e9cebd-6757-4ecf-a568-bdb2c3cf09da
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SUPPLIERNAMESFDC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 404dbf88-5f97-4a73-b3f7-675a7457bc5d
                stepCounter: 1fd0dcce-fa79-4083-a9b1-75b05ac27ef3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ebe8854e-7597-40e2-ab76-15d1ef918a02
          stepCounter: 75e9cebd-6757-4ecf-a568-bdb2c3cf09da
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESUPPLIERPDHISTORY_ADDKEYS.SUPPLIERID=SUPPLIER.SUPPLIERID
        name: SUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0dbe6791-e486-4323-9105-61ec34f45e59
                stepCounter: 8d733483-4c1e-4c52-8f3e-9f99b8022f6d
            transform: IFNULL(SUPPLIER.SUPPLIERKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7b1a75e-3324-4a6e-af6b-7adc4c625a48
          stepCounter: 75e9cebd-6757-4ecf-a568-bdb2c3cf09da
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b081c6b6-2774-457e-8765-b3df662780ad
                stepCounter: 1fd0dcce-fa79-4083-a9b1-75b05ac27ef3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c67e93f0-230e-4798-a8a9-5c99172dc0c9
          stepCounter: 75e9cebd-6757-4ecf-a568-bdb2c3cf09da
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: STARTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16a4eec2-a7bb-4197-98c3-01dff1c001be
                stepCounter: 1fd0dcce-fa79-4083-a9b1-75b05ac27ef3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dec232eb-1cd2-4034-8619-cca578396198
          stepCounter: 75e9cebd-6757-4ecf-a568-bdb2c3cf09da
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: ENDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6c1ef10-002b-47da-98d3-2e63621082e9
                stepCounter: 1fd0dcce-fa79-4083-a9b1-75b05ac27ef3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c64ccb0-6a52-4b3d-bf5d-3c1596c90c6c
          stepCounter: 75e9cebd-6757-4ecf-a568-bdb2c3cf09da
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PD_VP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2bc2567e-5f07-4c5d-b96c-b63a47ef2540
                stepCounter: 1fd0dcce-fa79-4083-a9b1-75b05ac27ef3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af0f1499-d861-43f5-9739-c98fa5383203
          stepCounter: 75e9cebd-6757-4ecf-a568-bdb2c3cf09da
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PD_DIRECTOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5b49c60f-b7e0-4740-bd82-28d989ee30e4
                stepCounter: 1fd0dcce-fa79-4083-a9b1-75b05ac27ef3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95d87902-49bd-447b-adff-c96138ba3380
          stepCounter: 75e9cebd-6757-4ecf-a568-bdb2c3cf09da
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: PD_VP_EMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ea67c35-a591-4a72-912a-b4155afb4d52
                stepCounter: 1fd0dcce-fa79-4083-a9b1-75b05ac27ef3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 481ae918-5687-4325-8750-9d2992b25d10
          stepCounter: 75e9cebd-6757-4ecf-a568-bdb2c3cf09da
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: PD_DIRECTOR_EMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e158f4b6-171a-4a15-b1e9-12f2be373738
                stepCounter: 1fd0dcce-fa79-4083-a9b1-75b05ac27ef3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32a7cc3e-6601-442a-ac26-256deb6cf46d
          stepCounter: 75e9cebd-6757-4ecf-a568-bdb2c3cf09da
        config: {}
        dataType: VARCHAR(18)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: PD_ASSIGNMENT_SALESFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d1f4fea1-8e13-4c49-a616-fd0922772ff2
                stepCounter: 1fd0dcce-fa79-4083-a9b1-75b05ac27ef3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 35653858-e42e-41c2-8764-56be8728b958
          stepCounter: 75e9cebd-6757-4ecf-a568-bdb2c3cf09da
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: NON CONFORMED DIMENSION KEY
        isSurrogateKey: true
        name: DSS_SOURCE_SYSTEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '3'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e03f11a-5567-479e-931c-67b87d185c19
          stepCounter: 75e9cebd-6757-4ecf-a568-bdb2c3cf09da
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7884cc29-8617-44f4-9fd6-30f27b8c8115
                stepCounter: 1fd0dcce-fa79-4083-a9b1-75b05ac27ef3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70da4240-b4c2-4656-86d9-bca0cd3c9655
          stepCounter: 75e9cebd-6757-4ecf-a568-bdb2c3cf09da
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a0f3b8b5-f1d2-4605-981a-01fb34a720fa
                stepCounter: 1fd0dcce-fa79-4083-a9b1-75b05ac27ef3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b8a8392-53af-4bcf-b3a0-bf3dd347847f
          stepCounter: 75e9cebd-6757-4ecf-a568-bdb2c3cf09da
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5dc6cd5-aaab-4936-b1b9-930367d07fca
          stepCounter: 75e9cebd-6757-4ecf-a568-bdb2c3cf09da
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGESFDCSUPPLIERPDHISTORY: 1fd0dcce-fa79-4083-a9b1-75b05ac27ef3
          SUPPLIER: 8d733483-4c1e-4c52-8f3e-9f99b8022f6d
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: SUPPLIER
          - locationName: STAGE
            nodeName: STAGESFDCSUPPLIERPDHISTORY
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','STAGESFDCSUPPLIERPDHISTORY') }} STAGESFDCSUPPLIERPDHISTORY
              LEFT JOIN {{ ref('DIM','SUPPLIER') }} SUPPLIER
                ON STAGESFDCSUPPLIERPDHISTORY.SUPPLIERID = SUPPLIER.SUPPLIERID
               AND SUPPLIER.DSS_SOURCE_SYSTEM_KEY = 3
        name: STAGESUPPLIERPDHISTORY_ADDKEYS
        noLinkRefs: []
  name: STAGESUPPLIERPDHISTORY_ADDKEYS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
