fileVersion: 1
id: 52fc0fd4-9d81-4cf4-b74c-a8f12c58248d
name: STAGE_SUPPLIERPDHISTORY_ADDKEYS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da59bf51-52f8-40ec-86e4-e7208deaa747
          stepCounter: 52fc0fd4-9d81-4cf4-b74c-a8f12c58248d
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: SUPPLIERSALESFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab8d4c9c-81ca-4310-8d6b-8c5e03a9492d
                stepCounter: 53ebe7a4-0545-4de4-9e8b-3649b33c84b2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6da0205d-7b21-423f-835e-8fdefd989187
          stepCounter: 52fc0fd4-9d81-4cf4-b74c-a8f12c58248d
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SUPPLIERNAMESFDC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c301220-6cb1-4b52-841f-e4d6bc16f887
                stepCounter: 53ebe7a4-0545-4de4-9e8b-3649b33c84b2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9191f273-dad9-443e-8ddb-7690fc6447cc
          stepCounter: 52fc0fd4-9d81-4cf4-b74c-a8f12c58248d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESUPPLIERPDHISTORY_ADDKEYS.SUPPLIERID=SUPPLIER.SUPPLIERID
        name: SUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2f4e397-bd41-483f-976a-9ed99246bd6e
                stepCounter: 470235be-2b1f-4c18-8481-f03bb4bed667
            transform: IFNULL(SUPPLIER.SUPPLIERKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f801a9fc-4bd5-43d3-bca9-4d4745c50bbc
          stepCounter: 52fc0fd4-9d81-4cf4-b74c-a8f12c58248d
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fbf87057-92af-4267-9297-669b66d3e299
                stepCounter: 53ebe7a4-0545-4de4-9e8b-3649b33c84b2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be74b7a4-210e-44c8-86b1-7d412b236b12
          stepCounter: 52fc0fd4-9d81-4cf4-b74c-a8f12c58248d
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: STARTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa0f360f-844a-4808-b3f2-4e93fe21a0c7
                stepCounter: 53ebe7a4-0545-4de4-9e8b-3649b33c84b2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd4b1fb5-1de5-419c-8bdb-1cdbb20d5552
          stepCounter: 52fc0fd4-9d81-4cf4-b74c-a8f12c58248d
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: ENDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 14b24d50-530f-4366-8ae4-7231569848f0
                stepCounter: 53ebe7a4-0545-4de4-9e8b-3649b33c84b2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87f69374-a1a1-4739-98ab-64417f04091f
          stepCounter: 52fc0fd4-9d81-4cf4-b74c-a8f12c58248d
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PD_VP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 515f81b0-c965-4f5e-91e3-edf1ddec87d2
                stepCounter: 53ebe7a4-0545-4de4-9e8b-3649b33c84b2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee8d4136-d7da-4732-af93-53183dc9b652
          stepCounter: 52fc0fd4-9d81-4cf4-b74c-a8f12c58248d
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PD_DIRECTOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0247b1ba-2ff5-4eb0-ac9c-d2f31350de83
                stepCounter: 53ebe7a4-0545-4de4-9e8b-3649b33c84b2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 43658e84-e899-4cf9-ab12-5d1c637929a9
          stepCounter: 52fc0fd4-9d81-4cf4-b74c-a8f12c58248d
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: PD_VP_EMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 73ea03db-1ed9-4e42-b94e-b15baabd2e7b
                stepCounter: 53ebe7a4-0545-4de4-9e8b-3649b33c84b2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1fa01c75-9ceb-46ee-9d41-20b7a1b0555e
          stepCounter: 52fc0fd4-9d81-4cf4-b74c-a8f12c58248d
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: PD_DIRECTOR_EMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 08dd48a9-88c1-4a69-9cc7-f5e3c1b81a00
                stepCounter: 53ebe7a4-0545-4de4-9e8b-3649b33c84b2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6dd7722-9e97-4ced-adde-6105c3a65f2e
          stepCounter: 52fc0fd4-9d81-4cf4-b74c-a8f12c58248d
        config: {}
        dataType: VARCHAR(18)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: PD_ASSIGNMENT_SALESFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d7126d0-20b5-4c8d-a85d-358b130aa1b7
                stepCounter: 53ebe7a4-0545-4de4-9e8b-3649b33c84b2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70afe610-7185-4332-99f0-98e09b3521c3
          stepCounter: 52fc0fd4-9d81-4cf4-b74c-a8f12c58248d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: NON CONFORMED DIMENSION KEY
        isSurrogateKey: true
        name: DSS_SOURCE_SYSTEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '3'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 76c9f217-7548-4a61-aae9-d0f15d92def2
          stepCounter: 52fc0fd4-9d81-4cf4-b74c-a8f12c58248d
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5eac064b-cf58-48e0-8839-08125997fe24
                stepCounter: 53ebe7a4-0545-4de4-9e8b-3649b33c84b2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32179e0b-077f-4527-87a7-fd8345231a9b
          stepCounter: 52fc0fd4-9d81-4cf4-b74c-a8f12c58248d
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a65ceee-239c-41dc-adbe-efa7ebebea2f
                stepCounter: 53ebe7a4-0545-4de4-9e8b-3649b33c84b2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f41cd5b7-559d-497c-a838-407b26d3207f
          stepCounter: 52fc0fd4-9d81-4cf4-b74c-a8f12c58248d
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4913d7b8-ef54-4707-a3c6-50200fd7ba29
          stepCounter: 52fc0fd4-9d81-4cf4-b74c-a8f12c58248d
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          SUPPLIER: 470235be-2b1f-4c18-8481-f03bb4bed667
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: SUPPLIER
          - locationName: STAGE
            nodeName: STAGE_SFDCSUPPLIERPDHISTORY
          - locationName: UNKNOWN
            nodeName: STAGESFDCSUPPLIERPDHISTORY
        join:
          joinCondition: |-
            FROM {{ ref('UNKNOWN','STAGESFDCSUPPLIERPDHISTORY') }} STAGESFDCSUPPLIERPDHISTORY
              LEFT JOIN {{ ref('DIM','SUPPLIER') }} SUPPLIER
                ON STAGESFDCSUPPLIERPDHISTORY.SUPPLIERID = SUPPLIER.SUPPLIERID
               AND SUPPLIER.DSS_SOURCE_SYSTEM_KEY = 3
        name: STAGESUPPLIERPDHISTORY_ADDKEYS
        noLinkRefs: []
  name: STAGE_SUPPLIERPDHISTORY_ADDKEYS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
