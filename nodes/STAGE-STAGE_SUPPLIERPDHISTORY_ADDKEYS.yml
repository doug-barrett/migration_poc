fileVersion: 1
id: 9d61d325-0ede-4d4c-a576-6a8ccb67df45
name: STAGE_SUPPLIERPDHISTORY_ADDKEYS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f04bc040-54e0-48c7-bac8-0c1a5826e9d5
          stepCounter: 9d61d325-0ede-4d4c-a576-6a8ccb67df45
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: SUPPLIERSALESFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6fa0444e-5090-4da4-98a5-11d5555e9aa7
                stepCounter: 9226c0b9-518d-453e-9d0c-b9509b73d9fa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c07098e-603c-4f10-8b02-cae642cca3c8
          stepCounter: 9d61d325-0ede-4d4c-a576-6a8ccb67df45
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SUPPLIERNAMESFDC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a42ff10d-2490-44c5-bbf4-b58fb8a75940
                stepCounter: 9226c0b9-518d-453e-9d0c-b9509b73d9fa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79c2b3e5-375b-44ba-b424-61e1f5d54a99
          stepCounter: 9d61d325-0ede-4d4c-a576-6a8ccb67df45
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGESUPPLIERPDHISTORY_ADDKEYS.SUPPLIERID=SUPPLIER.SUPPLIERID
        name: SUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a40ebd06-9c3a-4233-866a-175d204e1e97
                stepCounter: d1900eab-6bfb-4275-9540-868877d9163b
            transform: IFNULL(SUPPLIER.SUPPLIERKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88e2d5d2-bae8-47ea-a02f-9357db9adcd0
          stepCounter: 9d61d325-0ede-4d4c-a576-6a8ccb67df45
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7cc881f-d8c4-4042-93c8-3fa3c5d61657
                stepCounter: 9226c0b9-518d-453e-9d0c-b9509b73d9fa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 84d614d7-aae1-48a4-89d9-b4586a2657b6
          stepCounter: 9d61d325-0ede-4d4c-a576-6a8ccb67df45
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: STARTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0da8acad-184b-4295-a954-f87a401a1a53
                stepCounter: 9226c0b9-518d-453e-9d0c-b9509b73d9fa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79bdf98e-241a-4870-8719-71cd1691f9c6
          stepCounter: 9d61d325-0ede-4d4c-a576-6a8ccb67df45
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: ENDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 06b0594d-faa6-4ced-930f-4b1e2f27fbd7
                stepCounter: 9226c0b9-518d-453e-9d0c-b9509b73d9fa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd577ec1-f55a-4834-a184-6175ac7318d5
          stepCounter: 9d61d325-0ede-4d4c-a576-6a8ccb67df45
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PD_VP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 643cf6d8-7024-4cbc-b45e-e6ab9b28e254
                stepCounter: 9226c0b9-518d-453e-9d0c-b9509b73d9fa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de5416db-fa1f-4231-a242-372e58d69db3
          stepCounter: 9d61d325-0ede-4d4c-a576-6a8ccb67df45
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PD_DIRECTOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1214172-4668-4ea5-8717-39749c438163
                stepCounter: 9226c0b9-518d-453e-9d0c-b9509b73d9fa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9e95937-51b7-48d7-83a6-9e036d499cbf
          stepCounter: 9d61d325-0ede-4d4c-a576-6a8ccb67df45
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: PD_VP_EMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 28c8a688-2c0f-476d-8a46-84bf95ca94ce
                stepCounter: 9226c0b9-518d-453e-9d0c-b9509b73d9fa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 327340cb-ea39-413d-bf6f-7c7fbd68bc8c
          stepCounter: 9d61d325-0ede-4d4c-a576-6a8ccb67df45
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: PD_DIRECTOR_EMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b631590-e1b3-4f98-b20a-105ca03d25ca
                stepCounter: 9226c0b9-518d-453e-9d0c-b9509b73d9fa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e4b61be6-4dee-4f01-a067-18dea2ef89ad
          stepCounter: 9d61d325-0ede-4d4c-a576-6a8ccb67df45
        config: {}
        dataType: VARCHAR(18)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: PD_ASSIGNMENT_SALESFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60eb96bd-be94-4898-a8a8-738f4898793e
                stepCounter: 9226c0b9-518d-453e-9d0c-b9509b73d9fa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cac2d825-3a75-4aac-8a21-7f55b8aa7edf
          stepCounter: 9d61d325-0ede-4d4c-a576-6a8ccb67df45
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: NON CONFORMED DIMENSION KEY
        isSurrogateKey: true
        name: DSS_SOURCE_SYSTEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '3'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 166a92ea-3ce8-40ae-aea5-ec713b067313
          stepCounter: 9d61d325-0ede-4d4c-a576-6a8ccb67df45
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c2db843-c327-4f73-9eea-9602997c64e0
                stepCounter: 9226c0b9-518d-453e-9d0c-b9509b73d9fa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ad5b068-849c-45c4-a086-572ebd2c8f11
          stepCounter: 9d61d325-0ede-4d4c-a576-6a8ccb67df45
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a94872ad-ac4e-47fb-8c37-4220c067746e
                stepCounter: 9226c0b9-518d-453e-9d0c-b9509b73d9fa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26c0dd43-92b1-45c5-988c-16773fda0b00
          stepCounter: 9d61d325-0ede-4d4c-a576-6a8ccb67df45
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48ff1f15-9dab-4638-aea6-a3493b9b926d
          stepCounter: 9d61d325-0ede-4d4c-a576-6a8ccb67df45
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_SFDCSUPPLIERPDHISTORY: 9226c0b9-518d-453e-9d0c-b9509b73d9fa
          SUPPLIER: d1900eab-6bfb-4275-9540-868877d9163b
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: SUPPLIER
          - locationName: STAGE
            nodeName: STAGE_SFDCSUPPLIERPDHISTORY
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','STAGE_SFDCSUPPLIERPDHISTORY') }} STAGE_SFDCSUPPLIERPDHISTORY
              LEFT JOIN {{ ref('DIM','SUPPLIER') }} SUPPLIER
                ON STAGE_SFDCSUPPLIERPDHISTORY.SUPPLIERID = SUPPLIER.SUPPLIERID
               AND SUPPLIER.DS_S_SOURCE_SYSTEM_KEY = 3
        name: STAGESUPPLIERPDHISTORY_ADDKEYS
        noLinkRefs: []
  name: STAGE_SUPPLIERPDHISTORY_ADDKEYS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
