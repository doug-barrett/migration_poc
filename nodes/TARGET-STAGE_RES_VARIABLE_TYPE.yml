fileVersion: 1
id: 0425b6ba-5310-4c8e-bbe1-3529254a3b36
name: STAGE_RES_VARIABLE_TYPE
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c720ca1-0a7c-48f2-934b-6cd33d24f4e8
          stepCounter: 0425b6ba-5310-4c8e-bbe1-3529254a3b36
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: VARIABLE_TYPE_SRC
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TARGET.VARIABLE_TYPE_SRC
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9255a704-e567-43e7-a8f0-63936e34d984
          stepCounter: 0425b6ba-5310-4c8e-bbe1-3529254a3b36
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: Reserve Economics Variable Type Code
        isBusinessKey: true
        name: VARIABLE_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2f444c40-7e3c-4ad3-8058-f1bfeccbdd3e
                stepCounter: e668fc02-ac58-4ef9-9289-00d87217087e
            transform: TARGET.VARIABLE_TYPE_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fde8b562-2e69-4f20-9ad8-8319e10c6a74
          stepCounter: 0425b6ba-5310-4c8e-bbe1-3529254a3b36
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Reserve Economics Variable Type Description
        name: VARIABLE_TYPE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 71b8573d-6d05-44b5-9f51-e952ea0ea832
                stepCounter: 58fdfddb-91ed-4bad-ae69-b6ff28e21228
            transform: TARGET.VARIABLE_TYPE_DESC
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d6bac41-21d8-498d-a65d-a711327b11eb
          stepCounter: 0425b6ba-5310-4c8e-bbe1-3529254a3b36
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: UOM_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39e9d2b4-f3be-4a38-9bbf-9cf906f3f0e0
                stepCounter: 58fdfddb-91ed-4bad-ae69-b6ff28e21228
            transform: TARGET.UOM_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 10fe4335-e776-47d2-a6f3-02ea36f93947
          stepCounter: 0425b6ba-5310-4c8e-bbe1-3529254a3b36
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a52591aa-bbf4-4bcf-a718-7f72e3a1b4c0
                stepCounter: 58fdfddb-91ed-4bad-ae69-b6ff28e21228
            transform: TARGET.LINE_NO
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cbd75cac-cf07-406b-92dd-7aeb5471a3e3
          stepCounter: 0425b6ba-5310-4c8e-bbe1-3529254a3b36
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: LINE_NO_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f76558f-c881-4626-a101-a4e56bec46be
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c9aef1d-f3aa-4c23-a904-4804bdbc05b9
          stepCounter: 0425b6ba-5310-4c8e-bbe1-3529254a3b36
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: LINE_NO_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4460264-eeac-48f7-bae2-1748cdbcf9cb
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b049958f-a789-4e8f-993f-e3ebdeded1d7
          stepCounter: 0425b6ba-5310-4c8e-bbe1-3529254a3b36
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: ""
        name: LINE_NO_GROUP_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d5c91b8-bbdb-4a28-9f19-8240c943cc67
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e558b3b5-8061-4c4d-8ac3-ccd0738b9daf
          stepCounter: 0425b6ba-5310-4c8e-bbe1-3529254a3b36
        config: {}
        dataType: DECIMAL(38)
        defaultValue: ""
        description: Report Sequence of LINE_NO
        name: LINE_NO_SEQ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a953943-462a-4e35-ba62-2e80d34da8a3
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f2c1bf7-8015-4202-b841-84d10a01622b
          stepCounter: 0425b6ba-5310-4c8e-bbe1-3529254a3b36
        config: {}
        dataType: DECIMAL(1)
        defaultValue: ""
        description: value that can be used to flip the sign of the amount displayed - for Lease Ops Model purposes only
        name: FLIPSIGN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 37982685-aae7-42e3-9ca5-93bddaf9f612
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ddb1e4ac-1ae6-47ec-be55-594108adb759
          stepCounter: 0425b6ba-5310-4c8e-bbe1-3529254a3b36
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: Product Sort Sequence
        name: PRODUCT_SEQ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4bb1a160-d256-4014-9c88-79ec18daeffc
                stepCounter: 58fdfddb-91ed-4bad-ae69-b6ff28e21228
            transform: TARGET.PRODUCT_SEQ
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71def514-1260-49d1-bc5f-99b7bc27cfce
          stepCounter: 0425b6ba-5310-4c8e-bbe1-3529254a3b36
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: Volume Sort Sequence
        name: VOLUME_SEQ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64fb6d5d-345d-46da-9796-c8f06c11000a
                stepCounter: 58fdfddb-91ed-4bad-ae69-b6ff28e21228
            transform: TARGET.VOLUME_SEQ
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18bdf497-717f-4618-b2b4-06d06cf1ca7b
          stepCounter: 0425b6ba-5310-4c8e-bbe1-3529254a3b36
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: Cash Sort Sequence
        name: CASH_SEQ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6fe01716-435e-4be1-b82f-da5e07a076cc
                stepCounter: 58fdfddb-91ed-4bad-ae69-b6ff28e21228
            transform: TARGET.CASH_SEQ
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2d649b7-1617-40b0-a1f5-686caaea11c4
          stepCounter: 0425b6ba-5310-4c8e-bbe1-3529254a3b36
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Interpolate Yearly Data To Monthly
        name: YR_TO_MTH_FLG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b094753b-3f8d-486f-8f9a-5acaec852f72
                stepCounter: 58fdfddb-91ed-4bad-ae69-b6ff28e21228
            transform: TARGET.YR_TO_MTH_FLG
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a3a0dc1-546a-4818-b3b8-a38a42274c2a
          stepCounter: 0425b6ba-5310-4c8e-bbe1-3529254a3b36
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: Record source.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 53785a1f-c7f5-4f39-a9b3-b909e2460a5e
                stepCounter: 58fdfddb-91ed-4bad-ae69-b6ff28e21228
            transform: TARGET.DSS_RECORD_SOURCE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8d240a9-86de-4a3c-ba83-396415ccbea0
          stepCounter: 0425b6ba-5310-4c8e-bbe1-3529254a3b36
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Load date.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f4421869-36e0-41c5-8748-0047658d6319
                stepCounter: 58fdfddb-91ed-4bad-ae69-b6ff28e21228
            transform: TARGET.DSS_LOAD_DATE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4dd36a30-85a3-44b1-9572-5ecf52f94466
          stepCounter: 0425b6ba-5310-4c8e-bbe1-3529254a3b36
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9f695ce-e756-49d2-8838-2bf67535d82f
          stepCounter: 0425b6ba-5310-4c8e-bbe1-3529254a3b36
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOAD_VET_RES_ECON_VARIABLE_TYPE: 58fdfddb-91ed-4bad-ae69-b6ff28e21228
          LOAD_VET_RES_IND_VARIABLE_TYPE: e668fc02-ac58-4ef9-9289-00d87217087e
          DIM_LO_SAP_LEASE_OPS_HIER: 82938641-7c51-4aff-ad3a-c7a56af30c01
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: LOAD_VET_RES_ECON_VARIABLE_TYPE
          - locationName: TARGET
            nodeName: LOAD_VET_RES_IND_VARIABLE_TYPE
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_HIER
        join:
          joinCondition: |-
            FROM (
                    SELECT 'ECON' VARIABLE_TYPE_SRC ,
                           VARIABLE_TYPE_CODE ,
                           VARIABLE_TYPE_DESC ,
                           UOM_CODE ,
                           LINE_NO ,
                           PRODUCT_SEQ ,
                           VOLUME_SEQ ,
                           CASH_SEQ ,
                           YR_TO_MTH_FLG ,
                           DSS_RECORD_SOURCE ,
                           DSS_LOAD_DATE
                      FROM {{ ref('TARGET','LOAD_VET_RES_ECON_VARIABLE_TYPE') }}
                     UNION SELECT 'IND' VARIABLE_TYPE_SRC ,
                           VARIABLE_TYPE_CODE ,
                           VARIABLE_TYPE_DESC ,
                           UOM_CODE ,
                           LINE_NO ,
                           PRODUCT_SEQ ,
                           VOLUME_SEQ ,
                           CASH_SEQ ,
                           'N' YR_TO_MTH_FLG ,
                           DSS_RECORD_SOURCE ,
                           DSS_LOAD_DATE
                      FROM {{ ref('TARGET','LOAD_VET_RES_IND_VARIABLE_TYPE') }}
                   ) AS TARGET
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_HIER') }} DIM_LO_SAP_LEASE_OPS_HIER
                ON TARGET.LINE_NO = DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO
        name: STAGE_RES_VARIABLE_TYPE
        noLinkRefs: []
  name: STAGE_RES_VARIABLE_TYPE
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
