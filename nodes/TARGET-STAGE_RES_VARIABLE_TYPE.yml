fileVersion: 1
id: 9ffbdeff-72d1-42e9-a752-1440a8266765
name: STAGE_RES_VARIABLE_TYPE
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3a52e79-694c-4b46-9255-a908fc2f2cca
          stepCounter: 9ffbdeff-72d1-42e9-a752-1440a8266765
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: VARIABLE_TYPE_SRC
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TARGET.VARIABLE_TYPE_SRC
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03e0df3d-71d1-46fe-b41d-3fb7acff7a67
          stepCounter: 9ffbdeff-72d1-42e9-a752-1440a8266765
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: Reserve Economics Variable Type Code
        isBusinessKey: true
        name: VARIABLE_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9bfd07b5-af63-4b2f-bdef-537b0ea8b2df
                stepCounter: 72421401-fd10-4fa8-a525-1200ce00210a
            transform: TARGET.VARIABLE_TYPE_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c291ba65-ad99-4393-9a67-d766dff5d45f
          stepCounter: 9ffbdeff-72d1-42e9-a752-1440a8266765
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Reserve Economics Variable Type Description
        name: VARIABLE_TYPE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ca32b17-2726-4fec-b283-4641db7d01a1
                stepCounter: 2c723a4f-4552-4e15-8fd3-4b9514191796
            transform: TARGET.VARIABLE_TYPE_DESC
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad942d92-849c-4e6f-ac8e-aa30b4fa95a3
          stepCounter: 9ffbdeff-72d1-42e9-a752-1440a8266765
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: UOM_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 512044b9-af98-4fdb-ad0f-c12935c82103
                stepCounter: 2c723a4f-4552-4e15-8fd3-4b9514191796
            transform: TARGET.UOM_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ccfc4ec2-4a47-4a2e-9776-ad7f6e20910b
          stepCounter: 9ffbdeff-72d1-42e9-a752-1440a8266765
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b963aadd-e22d-482c-a3af-4ba8e956c9e6
                stepCounter: 2c723a4f-4552-4e15-8fd3-4b9514191796
            transform: TARGET.LINE_NO
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c1a8e46-0f1c-44ba-9aef-ebfeb013e798
          stepCounter: 9ffbdeff-72d1-42e9-a752-1440a8266765
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: LINE_NO_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b33d1283-b87f-47de-99a6-a3ee69543603
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 10dafc64-8312-4d32-8f87-f1a282a1b967
          stepCounter: 9ffbdeff-72d1-42e9-a752-1440a8266765
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: LINE_NO_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4607c855-a49d-4eb4-bbf8-11be2b047885
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9703545f-c961-4283-9a28-7d4cac320036
          stepCounter: 9ffbdeff-72d1-42e9-a752-1440a8266765
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: ""
        name: LINE_NO_GROUP_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: da99671c-2200-4c20-b04f-0e5973f1746a
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0fc40692-449c-4562-9888-8df770b8a88d
          stepCounter: 9ffbdeff-72d1-42e9-a752-1440a8266765
        config: {}
        dataType: DECIMAL(38)
        defaultValue: ""
        description: Report Sequence of LINE_NO
        name: LINE_NO_SEQ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb3df596-66af-48d1-a81d-3b43a5ba8411
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5eeaefb0-8edd-42d8-b609-d4bb341acd53
          stepCounter: 9ffbdeff-72d1-42e9-a752-1440a8266765
        config: {}
        dataType: DECIMAL(1)
        defaultValue: ""
        description: value that can be used to flip the sign of the amount displayed - for Lease Ops Model purposes only
        name: FLIPSIGN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 95812a84-0352-480f-b717-64d09e28f8c4
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4616e21-e510-4d6d-97d2-f45c9e12acf8
          stepCounter: 9ffbdeff-72d1-42e9-a752-1440a8266765
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: Product Sort Sequence
        name: PRODUCT_SEQ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddcabf28-66c9-4ac3-8fe7-9e1353199841
                stepCounter: 2c723a4f-4552-4e15-8fd3-4b9514191796
            transform: TARGET.PRODUCT_SEQ
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 84479e62-f55d-4b37-bcce-1dfaacb37914
          stepCounter: 9ffbdeff-72d1-42e9-a752-1440a8266765
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: Volume Sort Sequence
        name: VOLUME_SEQ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c3697d75-b3df-4cc0-802e-d1a6aff675bb
                stepCounter: 2c723a4f-4552-4e15-8fd3-4b9514191796
            transform: TARGET.VOLUME_SEQ
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f905af3e-2072-4ac0-b79f-1b788cbeca81
          stepCounter: 9ffbdeff-72d1-42e9-a752-1440a8266765
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: Cash Sort Sequence
        name: CASH_SEQ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f28905cb-c47d-4961-8505-f0ed7595e319
                stepCounter: 2c723a4f-4552-4e15-8fd3-4b9514191796
            transform: TARGET.CASH_SEQ
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 834780c6-4cdb-4a52-b4f6-e53802105311
          stepCounter: 9ffbdeff-72d1-42e9-a752-1440a8266765
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Interpolate Yearly Data To Monthly
        name: YR_TO_MTH_FLG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ba88f273-ab49-42bb-8fc0-b83cd05357c8
                stepCounter: 2c723a4f-4552-4e15-8fd3-4b9514191796
            transform: TARGET.YR_TO_MTH_FLG
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e01d64b-6bdc-44ed-9f0a-b83cb3f1aee7
          stepCounter: 9ffbdeff-72d1-42e9-a752-1440a8266765
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: Record source.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00b075bc-1c4b-499e-b01c-5c1dc0f27043
                stepCounter: 2c723a4f-4552-4e15-8fd3-4b9514191796
            transform: TARGET.DSS_RECORD_SOURCE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 46772721-fbd9-47c5-990a-02344536b258
          stepCounter: 9ffbdeff-72d1-42e9-a752-1440a8266765
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Load date.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e90a52f1-8e40-4d4f-85f9-933aa27872d9
                stepCounter: 2c723a4f-4552-4e15-8fd3-4b9514191796
            transform: TARGET.DSS_LOAD_DATE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a140dfa9-ac96-4a74-a361-b97b26a2df98
          stepCounter: 9ffbdeff-72d1-42e9-a752-1440a8266765
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df7d6d09-b33b-46ff-9c4e-1c2216cd086a
          stepCounter: 9ffbdeff-72d1-42e9-a752-1440a8266765
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOAD_VET_RES_ECON_VARIABLE_TYPE: 2c723a4f-4552-4e15-8fd3-4b9514191796
          LOAD_VET_RES_IND_VARIABLE_TYPE: 72421401-fd10-4fa8-a525-1200ce00210a
          DIM_LO_SAP_LEASE_OPS_HIER: e0b535c4-f94e-4ac1-b685-dfdff6293176
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: LOAD_VET_RES_ECON_VARIABLE_TYPE
          - locationName: TARGET
            nodeName: LOAD_VET_RES_IND_VARIABLE_TYPE
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_HIER
        join:
          joinCondition: |-
            FROM (
                    SELECT 'ECON' VARIABLE_TYPE_SRC ,
                           VARIABLE_TYPE_CODE ,
                           VARIABLE_TYPE_DESC ,
                           UOM_CODE ,
                           LINE_NO ,
                           PRODUCT_SEQ ,
                           VOLUME_SEQ ,
                           CASH_SEQ ,
                           YR_TO_MTH_FLG ,
                           DSS_RECORD_SOURCE ,
                           DSS_LOAD_DATE
                      FROM {{ ref('TARGET','LOAD_VET_RES_ECON_VARIABLE_TYPE') }}
                     UNION SELECT 'IND' VARIABLE_TYPE_SRC ,
                           VARIABLE_TYPE_CODE ,
                           VARIABLE_TYPE_DESC ,
                           UOM_CODE ,
                           LINE_NO ,
                           PRODUCT_SEQ ,
                           VOLUME_SEQ ,
                           CASH_SEQ ,
                           'N' YR_TO_MTH_FLG ,
                           DSS_RECORD_SOURCE ,
                           DSS_LOAD_DATE
                      FROM {{ ref('TARGET','LOAD_VET_RES_IND_VARIABLE_TYPE') }}
                   ) AS TARGET
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_HIER') }} DIM_LO_SAP_LEASE_OPS_HIER
                ON TARGET.LINE_NO = DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO
        name: STAGE_RES_VARIABLE_TYPE
        noLinkRefs: []
  name: STAGE_RES_VARIABLE_TYPE
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
