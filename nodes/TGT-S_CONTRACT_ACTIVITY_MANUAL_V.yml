fileVersion: 1
id: b05d60a4-54ba-4d7d-84d6-123ffa126a1b
name: S_CONTRACT_ACTIVITY_MANUAL_V
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4712d8c-8c78-46c7-83bc-f443ee01a414
          stepCounter: b05d60a4-54ba-4d7d-84d6-123ffa126a1b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PROVIDER_FUNDER_SPLIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e70ea479-745f-496c-b200-6e936a81913d
                stepCounter: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3de73d5-d7db-4a5a-9fe4-aff973cc172f
          stepCounter: b05d60a4-54ba-4d7d-84d6-123ffa126a1b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PUC_MAP_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5285ff8f-ba19-4735-b46c-ff733d764496
          stepCounter: b05d60a4-54ba-4d7d-84d6-123ffa126a1b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: RESPONSIBILITY_CENTRE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4770ebb4-ed2b-4105-8d20-0e02c711e981
                stepCounter: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c775501-dcd8-4172-b87c-8cfe507bdcfc
          stepCounter: b05d60a4-54ba-4d7d-84d6-123ffa126a1b
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: ""
        name: HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7366c5ac-3754-469d-b2c7-cacf66f8adc0
                stepCounter: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c8f033a-c374-46fb-9286-96f881f36dae
          stepCounter: b05d60a4-54ba-4d7d-84d6-123ffa126a1b
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: FACILITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: edcc4f00-cd62-4b7c-ab3a-b8381773175b
                stepCounter: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0b0602c-8a22-48b8-a249-a9d03cbc5bcf
          stepCounter: b05d60a4-54ba-4d7d-84d6-123ffa126a1b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REPORTING_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4d98b73e-1b7d-45ed-822f-094a0d270e64
                stepCounter: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 127832e9-9e2f-4800-9175-126c7df581f3
          stepCounter: b05d60a4-54ba-4d7d-84d6-123ffa126a1b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SOURCE_ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4f13fb73-6c4b-4c38-81e1-d56935362694
                stepCounter: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e563718-af2f-4273-a6a3-fa15b6e9db22
          stepCounter: b05d60a4-54ba-4d7d-84d6-123ffa126a1b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FUNDED_EVENT_ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7fb6a642-f9e5-42cb-ba9d-916e9ede972e
                stepCounter: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 764358c6-49d8-4351-b79b-d19ef470a98c
          stepCounter: b05d60a4-54ba-4d7d-84d6-123ffa126a1b
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6cbb7e8c-22d6-42c3-a6b8-eaa4779d96c2
                stepCounter: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7bdf3da7-7d50-4b37-841f-972c3cb3debd
          stepCounter: b05d60a4-54ba-4d7d-84d6-123ffa126a1b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f2f63665-6419-41df-96fb-2837977ea863
                stepCounter: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6d974de-ecad-45c8-9744-fcfc839fdba9
          stepCounter: b05d60a4-54ba-4d7d-84d6-123ffa126a1b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8316b258-3895-4d5d-aac5-4869eb3806a9
                stepCounter: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1203463a-87c6-4619-ad70-a9aa902b0710
          stepCounter: b05d60a4-54ba-4d7d-84d6-123ffa126a1b
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ADMIN_CATEGORY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f97a00db-7caf-4d1d-aef4-3a819e95906c
                stepCounter: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94449b3f-4068-4e40-9a0c-ac2b2a7de1b0
          stepCounter: b05d60a4-54ba-4d7d-84d6-123ffa126a1b
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: CONTRACT_ADMIT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5baed71d-c3a2-47c2-99ac-e153df14d8d1
                stepCounter: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 450a183b-31f8-47a2-9529-83833f79a57e
          stepCounter: b05d60a4-54ba-4d7d-84d6-123ffa126a1b
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: ADMISSION_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fcc3bab8-e45c-41dc-b986-63f9bf888d0e
          stepCounter: b05d60a4-54ba-4d7d-84d6-123ffa126a1b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: IDF_CLASS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9720bc90-4d91-42b0-8070-78c3fd630ef5
                stepCounter: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
            transform: |-
              CASE WHEN s_contract_manual_10.IDF_class = 'Unknown' THEN 'Non-IDF'
                          ELSE s_contract_manual_10.IDF_class
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47710086-e9aa-4bd4-bb7c-1aec41021429
          stepCounter: b05d60a4-54ba-4d7d-84d6-123ffa126a1b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DOMICILE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9720bc90-4d91-42b0-8070-78c3fd630ef5
                stepCounter: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c17f94c1-7375-488d-b80a-6883f9fb4f04
          stepCounter: b05d60a4-54ba-4d7d-84d6-123ffa126a1b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0fcb39cf-3844-4297-be9d-a78712d2c905
                stepCounter: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25c75817-07a8-43fe-8224-a232126383fe
          stepCounter: b05d60a4-54ba-4d7d-84d6-123ffa126a1b
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_VOLUME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b886e7d4-66e4-42ca-92b4-1fa649e9c189
                stepCounter: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1dd41949-7dbf-440d-9cfe-2e16842ff761
          stepCounter: b05d60a4-54ba-4d7d-84d6-123ffa126a1b
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: ESTIMATED_PURCHASE_UNIT_VOLUME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f2138e7-2524-433f-834c-bc93d7a8af15
                stepCounter: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b14289c-8f7e-431d-8d2f-3cab5c24c546
          stepCounter: b05d60a4-54ba-4d7d-84d6-123ffa126a1b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_contract_manual_10.age=dim_age_group.age_years
        name: DIM_AGE_GROUP_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2c8ae4b-eded-44c9-830e-439a9e89bf8b
                stepCounter: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 094b8d81-1b1f-48b7-a507-ce47adf558db
          stepCounter: b05d60a4-54ba-4d7d-84d6-123ffa126a1b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_PLANNED_CARE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 60160fb4-e72b-459b-94db-24d1faf5f104
          stepCounter: b05d60a4-54ba-4d7d-84d6-123ffa126a1b
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: DRG_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 003fd2cf-43f1-47d7-9225-3b4a97541158
          stepCounter: b05d60a4-54ba-4d7d-84d6-123ffa126a1b
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8648d261-3927-41a8-bd13-453365583d6e
                stepCounter: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5dfccb0f-7f5c-44f8-85bf-3a1ae1fb46a8
          stepCounter: b05d60a4-54ba-4d7d-84d6-123ffa126a1b
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: SOURCE_SYSTEM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "'Manual'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 728f1bf3-6a3c-44ad-ab7f-aaf5d98e1e97
          stepCounter: b05d60a4-54ba-4d7d-84d6-123ffa126a1b
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PVS_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e35acdcd-fbc4-4995-8fe6-959d75b7bda8
                stepCounter: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_CONTRACT_MANUAL_10: 8469b3ff-a80e-44d9-a76c-8802a3c39c5a
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_CONTRACT_MANUAL_10
        join:
          joinCondition: |-
            FROM {{ ref('TGT','S_CONTRACT_MANUAL_10') }}
             INNER JOIN l_mappings_Purchase_Unit_list_Manual
                ON s_contract_manual_10.PVS_ID = l_mappings_Purchase_Unit_list_Manual .pvs_id
               AND reporting_date BETWEEN l_mappings_Purchase_Unit_list_Manual.start_date AND IFNULL(l_mappings_Purchase_Unit_list_Manual.end_date,getdate()+100)
        name: S_CONTRACT_ACTIVITY_MANUAL_V
        noLinkRefs: []
  name: S_CONTRACT_ACTIVITY_MANUAL_V
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
