fileVersion: 1
id: 76147fc5-2aff-4cf8-b400-8d6ed64e2791
name: STAGE_OPUS_CART_ADDKEYS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70e5a16c-13d9-4e45-b0dc-c73f5ec8e6fa
          stepCounter: 76147fc5-2aff-4cf8-b400-8d6ed64e2791
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: DIMCONTACTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83cf9f2b-90d3-43c6-a6b1-c06956fa7f02
                stepCounter: 35f8d78b-6e7b-4fb6-a9b9-11bebbacf1ea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9f48dcd-e2b7-4865-a690-f03866ce9beb
          stepCounter: 76147fc5-2aff-4cf8-b400-8d6ed64e2791
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEOPUS_CART_ADDKEYS.CARTID=OPUS_CART.CARTID
        name: OPUSCARTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cae767ad-0afc-4d05-903e-a6adc43c6805
                stepCounter: 27724535-d1fa-4df2-8b8f-280e8b1e9538
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5746dc6-350c-4a9c-9ed7-8d9e03a02371
          stepCounter: 76147fc5-2aff-4cf8-b400-8d6ed64e2791
        config: {}
        dataType: INT
        defaultValue: ""
        description: STAGEOPUS_CART_ADDKEYS.CUSTOMERID=OPUS_CONTACT.CUSTOMERID
        name: OPUS_CONTACTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a6f9af9-be7f-4d21-8fa2-113279b41bca
                stepCounter: 92b541a9-bde9-4589-83f2-dc55c69a0757
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b83d790-b8d1-4c83-a9f2-d9f2b451ac16
          stepCounter: 76147fc5-2aff-4cf8-b400-8d6ed64e2791
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEOPUS_CART_ADDKEYS.STAGEFACT_OPUS_CART.SUPPLIERID=OPUS_SUPPLIER.SUPPLIEROPUSID
        name: OPUSSUPPLIERKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11f9a13a-8aa9-47bc-81b6-a5a6d4d0ee80
                stepCounter: 9a72d1e4-1aba-4fd2-8b64-b6f16fb0a880
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96cd9aa9-6932-4b42-93df-812e601f8213
          stepCounter: 76147fc5-2aff-4cf8-b400-8d6ed64e2791
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SUPPLIERFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4f0297e-fa6c-47ad-a92b-176b626a7804
                stepCounter: 9a72d1e4-1aba-4fd2-8b64-b6f16fb0a880
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: beac547a-d87e-45d6-827e-ac19090175b0
          stepCounter: 76147fc5-2aff-4cf8-b400-8d6ed64e2791
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEOPUS_CART_ADDKEYS.PRODUCTID=OPUS_PRODUCT.PRODUCTID
        name: OPUSPRODUCTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a7284217-1be5-4550-b871-d3c057a5c106
                stepCounter: d63040c1-6075-45f1-a723-d8667ae09cf5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 51294e65-2b45-41d7-a568-3819b7819b36
          stepCounter: 76147fc5-2aff-4cf8-b400-8d6ed64e2791
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: ACCOUNTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9809deca-da5b-4fe0-a80a-ab6cafa8782e
                stepCounter: 745ecacb-59f4-457a-9a6f-e827d225494e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2c922e1-f0d5-4c59-977f-f89f6d235904
          stepCounter: 76147fc5-2aff-4cf8-b400-8d6ed64e2791
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: ITEMADDEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 462fc0d2-be5c-4d3f-8f39-201f1befa8e2
                stepCounter: 41d57f39-2f57-4650-8b20-a05ea0f01377
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a4d968c3-036e-4bc9-8dbb-d441db0062a0
          stepCounter: 76147fc5-2aff-4cf8-b400-8d6ed64e2791
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: ITEMMODIFIEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0fd79152-15bc-4d25-9440-cd3bea28c333
                stepCounter: 41d57f39-2f57-4650-8b20-a05ea0f01377
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9a12454-e2b4-49af-adc6-1a12ebbb6983
          stepCounter: 76147fc5-2aff-4cf8-b400-8d6ed64e2791
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PRODUCTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c19fe5f-9507-44a3-9f9a-2aba92335d04
                stepCounter: 41d57f39-2f57-4650-8b20-a05ea0f01377
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f02fdd60-a14c-49b1-85c9-f249db37d94a
          stepCounter: 76147fc5-2aff-4cf8-b400-8d6ed64e2791
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa4c1a5a-07cd-46d5-ac3c-baf82b5fce93
                stepCounter: 41d57f39-2f57-4650-8b20-a05ea0f01377
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 617138e7-3e72-42e3-9b9f-16e2d1a7802f
          stepCounter: 76147fc5-2aff-4cf8-b400-8d6ed64e2791
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3359c068-4b8b-44ce-9d52-4064a79d9218
                stepCounter: 41d57f39-2f57-4650-8b20-a05ea0f01377
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e046e1cb-7291-4a07-83e5-75c3bf0f2984
          stepCounter: 76147fc5-2aff-4cf8-b400-8d6ed64e2791
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94d0a4bc-9924-4fc7-8b3a-4122eb8de751
                stepCounter: 41d57f39-2f57-4650-8b20-a05ea0f01377
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0cf8d279-6dc2-4fbe-b18b-dc1c24162f30
          stepCounter: 76147fc5-2aff-4cf8-b400-8d6ed64e2791
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: CARTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50ca0d4f-f7bc-40c8-88ed-35970ba9fb25
                stepCounter: 41d57f39-2f57-4650-8b20-a05ea0f01377
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a08cc40f-4e30-4a2a-a502-8f7f52b0e185
          stepCounter: 76147fc5-2aff-4cf8-b400-8d6ed64e2791
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: QUANTITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ccd3b79-694f-4310-9637-439c42cbee14
                stepCounter: 41d57f39-2f57-4650-8b20-a05ea0f01377
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ceb0bfb-f352-4dd4-a602-83d76d416c5b
          stepCounter: 76147fc5-2aff-4cf8-b400-8d6ed64e2791
        config: {}
        dataType: NUMBER(38,4)
        defaultValue: ""
        description: ""
        name: PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 93917b27-05c2-4258-8c07-9cfce781007e
                stepCounter: 41d57f39-2f57-4650-8b20-a05ea0f01377
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df6b8ab2-f9c1-4158-9570-7edf590d77ff
          stepCounter: 76147fc5-2aff-4cf8-b400-8d6ed64e2791
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CARTSTATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1665c7dd-45b9-4eb7-8c23-a88dc70f424e
                stepCounter: 41d57f39-2f57-4650-8b20-a05ea0f01377
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af6ee0e7-2160-4d4c-beb5-664c555895b0
          stepCounter: 76147fc5-2aff-4cf8-b400-8d6ed64e2791
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d912152-2d02-4308-8551-9c33ee4599ba
                stepCounter: 41d57f39-2f57-4650-8b20-a05ea0f01377
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c99c90d9-deab-4f03-a5c9-f0db2a4a2d4e
          stepCounter: 76147fc5-2aff-4cf8-b400-8d6ed64e2791
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: DIM_SUPPLIER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b2276a7-20ad-4eff-9ac6-88e98d12a277
                stepCounter: 41d57f39-2f57-4650-8b20-a05ea0f01377
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2528d3bc-8c67-4463-8d06-fc367916646d
          stepCounter: 76147fc5-2aff-4cf8-b400-8d6ed64e2791
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ae4ad235-34c3-41fd-9ae3-3b9e21f45d72
                stepCounter: 41d57f39-2f57-4650-8b20-a05ea0f01377
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d79eb4c1-13f9-47e5-a788-5d16828d34e8
          stepCounter: 76147fc5-2aff-4cf8-b400-8d6ed64e2791
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 37d97def-2b81-445f-b97b-8790c9c31eae
          stepCounter: 76147fc5-2aff-4cf8-b400-8d6ed64e2791
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          OPUS_CART: 27724535-d1fa-4df2-8b8f-280e8b1e9538
          CONTACT: 35f8d78b-6e7b-4fb6-a9b9-11bebbacf1ea
          OPUS_PRODUCT: d63040c1-6075-45f1-a723-d8667ae09cf5
          ACCOUNT: 745ecacb-59f4-457a-9a6f-e827d225494e
          OPUS_CONTACT: 92b541a9-bde9-4589-83f2-dc55c69a0757
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: DIM
            nodeName: CONTACT
          - locationName: DIM
            nodeName: OPUS_CART
          - locationName: DIM
            nodeName: OPUS_CONTACT
          - locationName: DIM
            nodeName: OPUS_PRODUCT
          - locationName: DIM
            nodeName: OPUS_SUPPLIER
          - locationName: STAGE
            nodeName: STAGE_FACT_OPUS_CART
          - locationName: UNKNOWN
            nodeName: STAGEFACT_OPUS_CART
        join:
          joinCondition: |-
            FROM {{ ref('UNKNOWN','STAGEFACT_OPUS_CART') }} STAGEFACT_OPUS_CART
              LEFT JOIN {{ ref('DIM','OPUS_CART') }} OPUS_CART
                ON STAGEFACT_OPUS_CART.CARTID = OPUS_CART.CARTID
              LEFT JOIN {{ ref('DIM','CONTACT') }} CONTACT
                ON STAGEFACT_OPUS_CART.CUSTOMERID = CONTACT.OPUS_CUSTOMER_ID
              LEFT JOIN {{ ref('DIM','OPUS_PRODUCT') }} OPUS_PRODUCT
                ON STAGEFACT_OPUS_CART.PRODUCTID = OPUS_PRODUCT.PRODUCTID
              LEFT JOIN {{ ref('DIM','ACCOUNT') }} ACCOUNT
                ON STAGEFACT_OPUS_CART.ORGANIZATIONID = ACCOUNT.OPUS_ORGANIZATION_ID
              LEFT JOIN {{ ref('DIM','OPUS_CONTACT') }} OPUS_CONTACT
                ON STAGEFACT_OPUS_CART.CUSTOMERID = OPUS_CONTACT.CUSTOMERID
               AND STAGEFACT_OPUS_CART.ORGANIZATIONID=OPUS_CONTACT.ORGANIZATIONID
        name: STAGEOPUS_CART_ADDKEYS
        noLinkRefs: []
  name: STAGE_OPUS_CART_ADDKEYS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
