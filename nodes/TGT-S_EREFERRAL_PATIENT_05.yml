fileVersion: 1
id: 85b7be89-0863-4607-a138-a7cfd86a44e4
name: S_EREFERRAL_PATIENT_05
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 83a3164c-c41e-43a7-8f56-e324fe268e1e
          stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4221bebd-453f-438d-951c-50152ec4f7d9
                stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8afac337-1381-4495-a25c-02c1efb378c4
          stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: EXTERNALID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: deb8da7a-8449-4fae-b16b-37c9059e8782
                stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95f6ebdb-bcbb-409b-82fd-d1b0ee8dd204
          stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: DHBID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e99d8a1-3154-4e2a-be74-c573892807f9
                stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2633f75-3c0e-45e2-9bd4-c224e44196bd
          stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SERVICEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91dda4f8-69e8-48e1-b5be-b5dcc883518b
                stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e74b3a5-0e8f-4302-97d6-0fe3f01462f4
          stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: REFERREDFORID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a53ebf80-19a9-4ea4-a49c-af778374a0dd
                stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 85938f1b-2037-422b-818f-e5b5560ad1e0
          stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATIONDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39e1a043-42ad-4abe-be1c-cc06334d9f74
                stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 564735d7-c1cd-4337-8030-1dd22642b64b
          stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SUBMISSIONDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf48fd98-6990-4b30-8df0-1e1a275eae00
                stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 10db5da5-43e8-424e-93f3-6652cff8b210
          stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: PATIENTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e7f8750-6cb8-4701-830d-098d4bddc9ad
                stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c0238f3-4c9d-4c57-8e46-4db847d47298
          stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: PATIENTGIVENNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07db3478-2d2f-4bc3-9d7b-c7cc158ab660
                stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2839605-651a-416c-9a46-0c5ed6fe674b
          stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: PATIENTFAMILYNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a95315ca-13fd-4c08-ab5b-96a21ff01c12
                stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 271ce227-0e72-4d90-a09b-14659901176a
          stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PATIENTDOB
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5b268a8d-5d3e-4cce-ba17-7639a6ead761
                stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d09001e6-61b9-40b6-960b-e4124d799931
          stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: REFERRERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2427c57e-7562-4027-be74-32864a418d65
                stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2f9b82c-fb49-4cf5-90be-e1ddfae1bd03
          stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: REFERRERIDTYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 58cee981-61a3-4a4f-94fa-0b2336c53389
                stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 62ae901e-fdbc-478b-bbea-05431fb753c7
          stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: REFERRERGIVENNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bdbbaae2-8987-43e0-998a-a06a2bd98af4
                stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c9ee5cd-1707-4f43-89e3-2e1729fab22f
          stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: REFERRERFAMILYNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 080722b2-6aa1-41fd-abbd-8a4f65083227
                stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac5c0151-b799-49fe-8d35-67920f5f4f7b
          stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LASTUPDATEDDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9e02f12e-8e53-4357-8bc0-825ec5d84ba6
                stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d421299e-8352-4318-a8cd-f014f3e443d0
          stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: LASTUPDATEDUSER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddda03f2-8654-4773-babe-a938e4c9e881
                stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6867f445-db99-426c-8b1c-678f0700a59c
          stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: ACCELIGIBLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c55b0572-c36d-41da-afbb-b964e51afe2e
                stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 790b730d-9315-41c4-a81e-5ea98b7ad96d
          stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: ELIGIBILITYSTATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 34f39919-92d9-4ac4-8f7e-c3d175a365dc
                stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f4ea881-8664-419e-bdab-cbf56907131a
          stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: RESIDENTIALDHB
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6936a89e-efb3-4afd-b7b4-ac2fd91a417a
                stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3169393a-06fc-45a4-a3bf-38293118a239
          stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: PMSAPPLICATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0bc3eeaf-98e5-4a8b-a557-70c602a7caa3
                stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e7e7f26-e4e9-4a57-8d7b-1730e7534260
          stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LATESTHISTORYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 41c7c736-fb21-4874-8cff-1ad2bf318482
                stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e99fa2ca-b26a-4fca-b2a6-dee2ffba4684
          stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: REFERRERMESSAGINGENABLED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 63ca2900-5159-42e5-aa56-1ee2bdee6352
                stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7aeece4-e06b-4805-811c-0ec786836139
          stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: URGENCYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f8a4107-b31e-4bfd-bd0f-546f8a85db5c
                stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ae259e8-e4db-4906-8885-230e75054e62
          stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
        config: {}
        dataType: NVARCHAR(250)
        defaultValue: ""
        description: ""
        name: PATIENTADDRESSSTREET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ffd4d8bb-82a3-445c-abcc-4a6a4c04ae34
                stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 52c98ce5-2520-4f55-8f51-36d86f34be6f
          stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
        config: {}
        dataType: NVARCHAR(250)
        defaultValue: ""
        description: ""
        name: PATIENTADDRESSSUBURB
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a9bb107b-5251-4343-83d3-34a88531461b
                stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db6aaedb-a43c-47b9-9a13-23c56028e93b
          stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
        config: {}
        dataType: NVARCHAR(250)
        defaultValue: ""
        description: ""
        name: PATIENTADDRESSCITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 832e977b-ca06-47db-bfeb-7ae4469ce9be
                stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7bf527d3-5db9-41bb-853d-8c9314bd0185
          stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: PATIENTADDRESSPOSTCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb97214a-847e-48cf-9a17-27aea6f8dd71
                stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d2104b6-8a44-4ea7-83ce-f737d3eb7050
          stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
        config: {}
        dataType: NVARCHAR(250)
        defaultValue: ""
        description: ""
        name: PATIENTADDRESSCOUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 15f5bfae-43fe-4492-b198-eb4c1d01f581
                stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bffcad86-9954-4163-af34-fe23d36a59ff
          stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
        config: {}
        dataType: CHAR(3)
        defaultValue: ""
        description: ""
        name: PATIENTADDRESSTYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59767766-e3be-44c2-9034-3df6f3a51174
                stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5b1461b-176a-4af9-838d-357169e1cfb5
          stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: REFERRALNUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 167b6659-7224-4232-9e88-d8676098bbd7
                stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8973bda-d102-4d5e-82d7-e531781b0f5b
          stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: REFERRERFACILITYHPI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 603f671c-e92b-4af7-a05c-7b5cd5367dba
                stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 138d8ff3-4c1b-441b-8618-d7c1d928d2d7
          stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: COMPLETIONDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b98ac4e5-2575-43fb-ad58-c80f4c1471c8
                stepCounter: cc2cad72-944d-49ba-9ced-d91986548e7c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 548d0eee-b5ba-4a11-b8cf-92a7d4acf937
          stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_REFERRAL
        join:
          joinCondition: |-
            FROM [ds_Referral] ds_Referral
              LEFT JOIN l_reference_testpatients
                ON ds_Referral.patientId = l_reference_testpatients.NMPI
             WHERE l_reference_testpatients.NMPI IS NULL
               AND ds_Referral.patientid like '[A-Z][A-Z][A-Z][0-9][0-9][0-9][0-9]'
        name: S_EREFERRAL_PATIENT_05
        noLinkRefs: []
  name: S_EREFERRAL_PATIENT_05
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
