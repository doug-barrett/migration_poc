fileVersion: 1
id: 1f888c0c-c0bc-4225-aebf-0a0cae18c7f0
name: S_PJ_ED_EVENT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Get all the ED data required from fact_emergency_department_attendance."
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04157529-10b2-479e-8d0d-a5e38b443ca2
          stepCounter: 1f888c0c-c0bc-4225-aebf-0a0cae18c7f0
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Encounter unique identifier
        name: ED_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fdb7f53d-9364-43f5-a15c-5f30226a4d4c
                stepCounter: 5d078a68-3e5b-41a6-a867-060ad6916a66
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d15dd37-70c2-4f6e-a0c9-1f87e64f1150
          stepCounter: 1f888c0c-c0bc-4225-aebf-0a0cae18c7f0
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: encounter_id of IP admission
        name: IP_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 74375d8c-7f04-4e1a-9776-89526cfffaa0
                stepCounter: 5d078a68-3e5b-41a6-a867-060ad6916a66
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f6184b1-febd-43be-b262-a01aa085fd40
          stepCounter: 1f888c0c-c0bc-4225-aebf-0a0cae18c7f0
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a6aea326-9f4d-4bc8-b559-8b395a2a5fb6
                stepCounter: 5d078a68-3e5b-41a6-a867-060ad6916a66
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e94a4e6b-74cd-4e23-a644-ec742404f318
          stepCounter: 1f888c0c-c0bc-4225-aebf-0a0cae18c7f0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ED_EVENT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a9ec6cb7-db96-4235-8f70-1fff82d6a5d1
                stepCounter: 5d078a68-3e5b-41a6-a867-060ad6916a66
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42de99b2-f5a6-4032-9fb3-e8db6a2b4765
          stepCounter: 1f888c0c-c0bc-4225-aebf-0a0cae18c7f0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: patient_visit_count
        name: ED_EVENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 374aac2c-1562-4bbe-a7c8-aa0aa7313f81
                stepCounter: 5d078a68-3e5b-41a6-a867-060ad6916a66
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88b62899-92f0-432a-8c82-46196fe8a356
          stepCounter: 1f888c0c-c0bc-4225-aebf-0a0cae18c7f0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Visit date and time.
        name: ED_PRESENTATION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f6238c5-19a1-42f1-8deb-e3996c7fe40f
                stepCounter: 5d078a68-3e5b-41a6-a867-060ad6916a66
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed128777-40a1-4afd-a5dd-3b7c3944d789
          stepCounter: 1f888c0c-c0bc-4225-aebf-0a0cae18c7f0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time when patient first seen by a clinician.
        name: ED_FIRST_SEEN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a8b7cf67-0229-45ba-9599-4c55919679a4
                stepCounter: 5d078a68-3e5b-41a6-a867-060ad6916a66
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2626ea97-6352-4014-8a16-034610c667bf
          stepCounter: 1f888c0c-c0bc-4225-aebf-0a0cae18c7f0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time patient discharged.
        name: ED_DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 63798d57-68a1-4a9c-9bb1-fa85d9a6e0ee
                stepCounter: 5d078a68-3e5b-41a6-a867-060ad6916a66
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3931b8e-cbc8-4775-b3f5-96b2d67e960b
          stepCounter: 1f888c0c-c0bc-4225-aebf-0a0cae18c7f0
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ED_HOSPITAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7fa9a1f-bc9e-48df-a946-0346f12dca3e
                stepCounter: ce5e5ba3-482d-46a9-a8ae-9f160067f51d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8c290fb-1c6a-4190-a5bd-d02440cb88a3
          stepCounter: 1f888c0c-c0bc-4225-aebf-0a0cae18c7f0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: TREATMENT_PROTOCOL_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 410f28dd-59d5-4f2d-b2aa-75b1a5a19b9e
                stepCounter: bca3ad6c-7baa-4f42-8e2f-7ab945c58863
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1362f5d1-da69-4b4d-b749-c7fb883d3805
          stepCounter: 1f888c0c-c0bc-4225-aebf-0a0cae18c7f0
        config: {}
        dataType: NUMERIC(38,4)
        defaultValue: ""
        description: 'Actual cost of the ED event  '
        name: ED_ACTUAL_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e784472-94c4-4ade-86d1-0313435ce489
                stepCounter: 5d078a68-3e5b-41a6-a867-060ad6916a66
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a53d09e-2cd6-4f17-a486-c28c945e9530
          stepCounter: 1f888c0c-c0bc-4225-aebf-0a0cae18c7f0
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: Planned price x purchase unit volume
        name: ED_REVENUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e6d82e8-597d-4e09-bd26-905c599c9800
                stepCounter: 6bba0578-7ad6-41df-94c4-5d25f4782845
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24925e7f-957c-48c7-a880-fdfe02127782
          stepCounter: 1f888c0c-c0bc-4225-aebf-0a0cae18c7f0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_attendance_30.patient_reference_no=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60734846-d6dc-43ce-be5c-05cbbe758e87
                stepCounter: 5d078a68-3e5b-41a6-a867-060ad6916a66
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3e0aaf4-987d-4672-8942-cf86826d5082
          stepCounter: 1f888c0c-c0bc-4225-aebf-0a0cae18c7f0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_attendance_30.patient_age_on_arrival_years=dim_age_group.age_years
        name: DIM_AGE_GROUP_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ba03a98-77b0-4212-bb1a-f0be86fbe624
                stepCounter: 5d078a68-3e5b-41a6-a867-060ad6916a66
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c2c9e0b-2e50-4f6c-85e5-f9f686e9733d
          stepCounter: 1f888c0c-c0bc-4225-aebf-0a0cae18c7f0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_attendance_30.treatmentprotocolid=dim_ED_treatment_protocol.treatment_protocol_no
        name: DIM_ED_TREATMENT_PROTOCOL_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a922433e-a2e6-432b-9454-92579619ad7d
                stepCounter: 5d078a68-3e5b-41a6-a867-060ad6916a66
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6f878f3-584b-4707-b7d2-4ccf9b41b114
          stepCounter: 1f888c0c-c0bc-4225-aebf-0a0cae18c7f0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Triage code
        name: DIM_ED_TRIAGE_CATEGORY_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fbf464a0-c7ce-4fed-8893-14c54e69116c
                stepCounter: 5d078a68-3e5b-41a6-a867-060ad6916a66
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6d2a05a-e455-4d4a-82fd-56dae8899238
          stepCounter: 1f888c0c-c0bc-4225-aebf-0a0cae18c7f0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_attendance_30.hospital_code=dim_hospital.hospital_code
        name: DIM_HOSPITAL_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c3999cde-53e9-42f3-abf4-75ab5e27e1a0
                stepCounter: 5d078a68-3e5b-41a6-a867-060ad6916a66
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bc2698ec-3987-44ca-b9d8-75e943f2e684
          stepCounter: 1f888c0c-c0bc-4225-aebf-0a0cae18c7f0
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Referral ref no.
        name: ED_REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e3055bd2-0020-4468-bcc0-06d09f6a1bbe
                stepCounter: 5d078a68-3e5b-41a6-a867-060ad6916a66
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f479a67-3d44-495e-b89c-537526a567c6
          stepCounter: 1f888c0c-c0bc-4225-aebf-0a0cae18c7f0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: FACT_EMERGENCY_DEPARTMENT_ATTENDANCE
        join:
          joinCondition: |-
            FROM fact.fact_emergency_department_attendance
              JOIN dim.dim_hospital
                ON fact_emergency_department_attendance.dim_hospital_key = dim_hospital.dim_hospital_key
              JOIN dim.dim_ED_treatment_protocol
                ON fact_emergency_department_attendance.dim_ed_treatment_protocol_key = dim_ED_treatment_protocol.dim_ed_treatment_protocol_key
              LEFT OUTER JOIN s_PJ_revenue
                ON fact_emergency_department_attendance.attendance_encounter_id = s_PJ_revenue.source_encounter
             WHERE fact_emergency_department_attendance.ip_encounter_id IS NOT NULL
               AND fact_emergency_department_attendance.patient_nhi IS NOT NULL
        name: S_PJ_ED_EVENT
        noLinkRefs: []
  name: S_PJ_ED_EVENT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
