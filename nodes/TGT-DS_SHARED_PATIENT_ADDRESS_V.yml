fileVersion: 1
id: d680dd18-8eae-4523-827d-94095e554fc0
name: DS_SHARED_PATIENT_ADDRESS_V
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: "Calculate the number of addresses  for each patient reference number"
  isMultisource: false
  locationName: TGT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 254c613b-5cf4-461e-bafb-e43df8479858
          stepCounter: d680dd18-8eae-4523-827d-94095e554fc0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 30641881-33cf-4583-be67-fd1feb636701
                stepCounter: ccb2a266-85a2-40b6-8ad5-61236ff5f846
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 58b88fa0-d2ef-4646-8a9e-98dec6dc729a
          stepCounter: d680dd18-8eae-4523-827d-94095e554fc0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADDRESS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 12d88bc6-8dd4-4bd0-b5f0-cb18648fe410
                stepCounter: ccb2a266-85a2-40b6-8ad5-61236ff5f846
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db88d6a2-e9a8-4398-be43-0dc9bae63c6e
          stepCounter: d680dd18-8eae-4523-827d-94095e554fc0
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fbd96c41-bcb3-455e-8742-d76f61b73953
                stepCounter: ccb2a266-85a2-40b6-8ad5-61236ff5f846
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f29207b6-bbaf-400e-bdda-22c404e33451
          stepCounter: d680dd18-8eae-4523-827d-94095e554fc0
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: ADDRESS_ROLE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0af2feda-a893-4df5-a39f-ffc7997014f3
                stepCounter: ccb2a266-85a2-40b6-8ad5-61236ff5f846
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 84219e7d-5678-489c-9112-a20c8a96e858
          stepCounter: d680dd18-8eae-4523-827d-94095e554fc0
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: ADDRESS_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1eb342d2-ca23-4bb6-ae4c-bc3ef8d18698
                stepCounter: ccb2a266-85a2-40b6-8ad5-61236ff5f846
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e137758-6936-482a-938b-c8821f283ec8
          stepCounter: d680dd18-8eae-4523-827d-94095e554fc0
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ADDRESS_LINE1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 301f8fdd-2d92-4a45-8ed2-6531ec46539c
                stepCounter: ccb2a266-85a2-40b6-8ad5-61236ff5f846
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a7105ae-33b2-4d8f-bc46-2e0fecf1c5eb
          stepCounter: d680dd18-8eae-4523-827d-94095e554fc0
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ADDRESS_LINE2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f385397a-b08e-4b5e-8db0-2a37136f2236
                stepCounter: ccb2a266-85a2-40b6-8ad5-61236ff5f846
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e132186-6771-4aa4-a0f8-684defcd8e32
          stepCounter: d680dd18-8eae-4523-827d-94095e554fc0
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ADDRESS_LINE3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc58ecfb-4b0f-4039-a866-9756041dabd0
                stepCounter: ccb2a266-85a2-40b6-8ad5-61236ff5f846
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 19759c10-eca6-4c08-b772-9039f4c41416
          stepCounter: d680dd18-8eae-4523-827d-94095e554fc0
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ADDRESS_LINE4
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6076857d-cfb2-4f77-bef8-955c03573dd1
                stepCounter: ccb2a266-85a2-40b6-8ad5-61236ff5f846
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1c72b19-a3d1-4815-bfb6-da1174c1b455
          stepCounter: d680dd18-8eae-4523-827d-94095e554fc0
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: SUBURB
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db92a629-67d0-49db-9df1-e54da623b4ee
                stepCounter: ccb2a266-85a2-40b6-8ad5-61236ff5f846
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac6a973c-71dc-4f71-aede-683bcd5cd3b7
          stepCounter: d680dd18-8eae-4523-827d-94095e554fc0
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: STATE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 25aee69c-fe6b-4ce6-a86c-95d85712a9f1
                stepCounter: ccb2a266-85a2-40b6-8ad5-61236ff5f846
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d30c8a44-85e1-4f44-80bc-19641adda53c
          stepCounter: d680dd18-8eae-4523-827d-94095e554fc0
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: POSTAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 30d8703a-85ad-436f-bb26-30d7119df4de
                stepCounter: ccb2a266-85a2-40b6-8ad5-61236ff5f846
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45b76f61-62ef-408e-94ed-b2aff6794632
          stepCounter: d680dd18-8eae-4523-827d-94095e554fc0
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: HEALTH_DISTRICT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d16c7c2-31eb-454e-a5cf-f089a4222919
                stepCounter: ccb2a266-85a2-40b6-8ad5-61236ff5f846
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97b38e09-3fa7-4039-8af9-b3501ab4eae9
          stepCounter: d680dd18-8eae-4523-827d-94095e554fc0
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: COUNTRY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c77b793-9709-47a2-abd5-6150a5225774
                stepCounter: ccb2a266-85a2-40b6-8ad5-61236ff5f846
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a73311a-7aa6-4e9b-920c-5cd8a03516ff
          stepCounter: d680dd18-8eae-4523-827d-94095e554fc0
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: COUNTRY_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c35b18a0-e6b7-478a-982a-831b872257c8
                stepCounter: ccb2a266-85a2-40b6-8ad5-61236ff5f846
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8bf01a54-dbab-4051-87db-259a54b14285
          stepCounter: d680dd18-8eae-4523-827d-94095e554fc0
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: PLACE_OF_BIRTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 43f33bb1-2435-4042-bb1b-e8b42a010517
                stepCounter: ccb2a266-85a2-40b6-8ad5-61236ff5f846
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3bb9b02c-171a-4a66-83d1-cf1522c3ecce
          stepCounter: d680dd18-8eae-4523-827d-94095e554fc0
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: DOMICILE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0675aad5-2d29-4c86-a69d-105132101005
                stepCounter: ccb2a266-85a2-40b6-8ad5-61236ff5f846
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cca4623f-e539-4ba6-af00-7ca08d360b98
          stepCounter: d680dd18-8eae-4523-827d-94095e554fc0
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: DOMICILE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dabfe4dd-7c58-4cea-85b6-82accf624f7d
                stepCounter: ccb2a266-85a2-40b6-8ad5-61236ff5f846
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db1d4847-d4b6-4f7f-b1d6-1c8c87bd422e
          stepCounter: d680dd18-8eae-4523-827d-94095e554fc0
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: AREA_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2a8b8ece-d9d4-42ac-a9d1-2b2b79b084b1
                stepCounter: ccb2a266-85a2-40b6-8ad5-61236ff5f846
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1328d4a8-c6b8-43cb-9ae9-690c3218f255
          stepCounter: d680dd18-8eae-4523-827d-94095e554fc0
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: DHB_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e9246c7b-6fc6-49de-9c82-288cf34308a5
                stepCounter: ccb2a266-85a2-40b6-8ad5-61236ff5f846
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f29aec8d-cae0-4130-8999-75a0529ffa1a
          stepCounter: d680dd18-8eae-4523-827d-94095e554fc0
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: DHB_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0a565ffc-a349-414e-b8a9-88e4f34a7c79
                stepCounter: ccb2a266-85a2-40b6-8ad5-61236ff5f846
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd67bf4f-9bda-4461-8700-8e09d7f713cf
          stepCounter: d680dd18-8eae-4523-827d-94095e554fc0
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: IDF_CLASS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fedcf48f-f753-40d2-b4d9-3511c5b1fdab
                stepCounter: ccb2a266-85a2-40b6-8ad5-61236ff5f846
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f74be333-c4ff-4570-9dbd-9fd85be6ffc2
          stepCounter: d680dd18-8eae-4523-827d-94095e554fc0
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: REGION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ef16027-49ea-42c9-9b07-9fd05f14986c
                stepCounter: ccb2a266-85a2-40b6-8ad5-61236ff5f846
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a75fd825-9452-480d-bce6-52438c13ac91
          stepCounter: d680dd18-8eae-4523-827d-94095e554fc0
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: NORTHERN_REGION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59805acf-3397-4873-a39c-2f8f6628486c
                stepCounter: ccb2a266-85a2-40b6-8ad5-61236ff5f846
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 230a616a-cfdc-4834-9897-0c9295bff897
          stepCounter: d680dd18-8eae-4523-827d-94095e554fc0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADDRESS_VALIDITY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c150fbf5-44fa-4b1c-b0e3-0f5b80825d2d
                stepCounter: ccb2a266-85a2-40b6-8ad5-61236ff5f846
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1345c827-f692-4797-8952-f14f2a5f13c9
          stepCounter: d680dd18-8eae-4523-827d-94095e554fc0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADDRESS_VALIDITY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f63edd4a-46a1-4a95-b6e8-89d388ae6b1b
                stepCounter: ccb2a266-85a2-40b6-8ad5-61236ff5f846
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87f89883-1555-404c-aff4-7daada566385
          stepCounter: d680dd18-8eae-4523-827d-94095e554fc0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: 'row number identifying superseded addresses for a patient '
        name: ADDRESS_ROW_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cca55bae-76c3-4feb-b77f-36a1ab42dd3c
                stepCounter: ccb2a266-85a2-40b6-8ad5-61236ff5f846
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f120ef6b-7665-4a84-950d-39c096ad6abf
          stepCounter: d680dd18-8eae-4523-827d-94095e554fc0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: 'row number identifying duplicated addresses (multiple address-roles) for a patient '
        name: ADDRESS_DUP_ROW_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8bfc344b-d1b9-4978-91f7-a1e4f79494e7
                stepCounter: ccb2a266-85a2-40b6-8ad5-61236ff5f846
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d20b95e-db13-4a9b-9c43-0643001aa6f1
          stepCounter: d680dd18-8eae-4523-827d-94095e554fc0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 594936a5-940d-4f25-b9f9-28a23001040b
                stepCounter: ccb2a266-85a2-40b6-8ad5-61236ff5f846
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DS_SHARED_PATIENT_ADDRESS: ccb2a266-85a2-40b6-8ad5-61236ff5f846
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_SHARED_PATIENT_ADDRESS
        join:
          joinCondition: |-
            FROM {{ ref('TGT','DS_SHARED_PATIENT_ADDRESS') }}
             WHERE address_type_code = 'POSTL'
               AND address_role_code = 'HOME'
        name: DS_SHARED_PATIENT_ADDRESS_V
        noLinkRefs: []
  name: DS_SHARED_PATIENT_ADDRESS_V
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
