fileVersion: 1
id: 73713efd-3821-41a6-98dc-f739c8ef4801
name: S_EDS_DOCUMENT_20
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df6cbcd6-ade9-4f71-bfa1-9556a4d5be5d
          stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
        config: {}
        dataType: NUMERIC(18)
        defaultValue: ""
        description: Uniquely identifies a document.
        isBusinessKey: true
        name: EVENT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec7f269f-9fe8-454a-b07b-85aeaeea7214
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31028363-1f0e-47ea-b214-c699936b1d8c
          stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
        config: {}
        dataType: NUMERIC(18)
        defaultValue: ""
        description: ID identifying the original event associated with this event.
        name: ORIGINAL_EVENT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c19cf526-defa-44f8-8e06-758120de33b6
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: COALESCE(s_EDS_event_10.original_event_id, s_EDS_event_10.event_id)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bebe7fcb-d1ee-4a84-b6da-8b58f5333e65
          stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
        config: {}
        dataType: NVARCHAR(20)
        defaultValue: ""
        description: ""
        name: TEMPLATE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5bb1a127-e19a-4c9a-94da-ce34fa8e01e7
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4606afa4-925e-4ac4-8a1d-afdb38ea0671
          stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: TEMPLATE_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72d3ca87-9c1d-4085-a84e-bfdc370e1eff
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7c6529f-5e0f-4ee5-9e78-2f6ec0646ce5
          stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
        config: {}
        dataType: NCHAR(20)
        defaultValue: ""
        description: ""
        name: EPISODE_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cebdb257-e849-4bc3-b5b0-b1056dd3b536
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a4e67a99-b556-4d24-8583-d6622c47771e
          stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
        config: {}
        dataType: NVARCHAR(20)
        defaultValue: ""
        description: Patient NHI number.
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2176544f-602d-4406-a041-930b1f605865
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8cc9d4d2-e8ad-4a37-b80a-beee1fe79c38
          stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: 'Internal unique identifier for a patient from the Patient Management System '
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e97f9df9-522f-4edf-a576-4f04663dea60
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 158ac687-cc82-4913-b409-643cb919a582
          stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
        config: {}
        dataType: INT
        defaultValue: ""
        description: s_EDS_document_20.cast(lastUpdateDateTime as date)=dim_EDS_last_update_date.calendar_date
        name: DIM_EDS_LAST_UPDATE_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2a42ff0-1ca4-4a00-a43f-0b6ea545a93b
                stepCounter: e377ade6-197b-4ce5-8efb-2862582076d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77256425-d7fb-42f6-a43d-297d102899d3
          stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09ba3320-7c0b-4de9-b14b-f9d8450182a3
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5206517e-24dc-475f-aba9-65915bca0f13
          stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09ba3320-7c0b-4de9-b14b-f9d8450182a3
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: cast(s_EDS_event_10.createDateTime AS date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a0e1f88-2ff0-4296-a26b-0f216c06be07
          stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
        config: {}
        dataType: NVARCHAR(20)
        defaultValue: ""
        description: ""
        name: STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: da2bc353-84e0-4151-82e9-13454428011d
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78186248-b8d5-43b0-8bfb-218faee6cdf6
          stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: INACTIVE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 41b31f6b-6478-4be3-a166-dc8f04b5df52
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05384952-7add-4a1a-a337-4cf1521e76f6
          stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f5ab0a5-f3c9-4990-9c75-7cb5f8230eda
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: --cast(s_EDS_event_10.admitDate AT TIME ZONE 'UTC' AT TIME ZONE 'New Zealand Standard Time' AS datetime)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e103eeb5-65ee-4f5c-bef7-5626ba5b8495
          stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 89f665c3-b8fc-4ce0-a98d-74931e2a604e
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: --cast(s_EDS_event_10.dischargeDate AT TIME ZONE 'UTC' AT TIME ZONE 'New Zealand Standard Time' AS datetime)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3d42b68-8534-4ef8-a5dc-a6d367f763ec
          stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMIT_DATE_UTC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f5ab0a5-f3c9-4990-9c75-7cb5f8230eda
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 783ee078-decc-401b-8c9a-ab55f7d74d14
          stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCHARGE_DATE_UTC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 89f665c3-b8fc-4ce0-a98d-74931e2a604e
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dce97f2f-55ab-45ff-9d00-1726ae671601
          stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b65ca1c6-ef8e-4732-8006-3ed4d88e24f2
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dadf20b1-ae20-46b1-8385-d0a9a3d2b9c0
          stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
        config: {}
        dataType: NVARCHAR(250)
        defaultValue: ""
        description: ""
        name: EXT_PROVIDER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c560c739-474c-4832-b17b-0fd7f57d9ebe
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec6e4f86-610f-43ed-8d75-41d1d9d9d8bf
          stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: EXT_REFERRAL_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 166f17a3-ea6b-4750-80ac-8f8865342b58
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02ab0fdb-f637-4fcb-8e88-df9f45ec1011
          stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
        config: {}
        dataType: NVARCHAR(128)
        defaultValue: ""
        description: ""
        name: LASTUPDATEUSERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7e90859-9131-42d0-99f7-0354b108fd57
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ff9e59c-9f42-4ea0-aa35-f1fdd57ccb54
          stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
        config: {}
        dataType: NVARCHAR(90)
        defaultValue: ""
        description: ""
        name: LASTUPDATEUSERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e092d40-02e4-4999-b8e3-5fd521acea19
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 681117dc-4a78-4cc8-b3ae-4f3efdcca4dd
          stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
        config: {}
        dataType: NVARCHAR(20)
        defaultValue: ""
        description: ""
        name: LASTUPDATEUSERCLINICIANID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e0723f3a-ce7c-4647-a326-b9bc28ac3ddc
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd838c0b-1c85-4fb4-b53a-7e2b854d3ce1
          stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LASTUPDATEDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 43844429-10f5-4416-a055-30887f4e3375
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: -- cast(s_EDS_event_10.lastUpdateDateTime AT TIME ZONE 'UTC' AT TIME ZONE 'New Zealand Standard Time' AS datetime)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2abd999-6447-4bca-bc6b-4cc4638f9929
          stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LASTUPDATEDATETIME_UTC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 43844429-10f5-4416-a055-30887f4e3375
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4351c281-e262-454b-855b-fc20eb60e60e
          stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_EDS_document_20.s_EDS_event_10.createUserId=dim_create_user_login_concerto.user_name
        name: DIM_CREATE_USER_LOGIN_CONCERTO_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 68706e5d-f3c8-4b07-af66-769a301d6d9c
                stepCounter: 84e9f5b1-7654-4f9a-87c3-b87de0f332a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f3018b79-5e4a-4bce-a1bc-bfa0e095e872
          stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 166f17a3-ea6b-4750-80ac-8f8865342b58
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: "'R' + s_EDS_event_10.extReferralNo"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cdd20435-3960-4d91-83ce-6265793b2a33
          stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: PHYSICAL_LOCATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9456c41-3179-408a-9258-b95e05483836
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab431925-1417-4623-816d-70a2d139a024
          stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
        config: {}
        dataType: NVARCHAR(20)
        defaultValue: ""
        description: ""
        name: PHYSICAL_LOCATION_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bb1e1f8d-9065-45b1-a9e9-225376835138
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba77402c-b647-4fa4-86a7-236958ff9487
          stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: ORIGINAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 650f92c2-93bd-4e74-b6b9-c159de40e389
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b9e3bae-1586-43a9-b1ae-f520c5124dc1
          stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
        config: {}
        dataType: NCHAR(20)
        defaultValue: ""
        description: ""
        name: SPECIALTY_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ea10296-15eb-4c09-8d78-32369bd5fb9c
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d220dad8-3614-4472-bfc2-cdbd3e781697
          stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
        config: {}
        dataType: NCHAR(50)
        defaultValue: ""
        description: ""
        name: ORIG_EXT_HOSPITAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 43e9c518-b235-4621-9227-e0e8faff03cb
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a012b6d1-f6f0-408b-8759-a5198f9b00a1
          stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_HOSPITAL_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c1eff0c-fd0d-4a47-ad0f-2fd4a80c00a7
                stepCounter: ce5e5ba3-482d-46a9-a8ae-9f160067f51d
            transform: IFNULL(dim_hospital.dim_hospital_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33665c3e-dd10-4347-bb44-7fff12dfefc0
          stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_EDS_document_20.patient_reference_no=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9962a01b-5f3d-4c1a-b371-997edef38d0f
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5af561ed-af6a-4d1c-b72b-15c79a87c738
          stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_EDS_document_20.extProviderId=dim_clinician.clinician_reference_no
        name: DIM_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 911a8788-86e5-4a5c-a00a-a957d59070b8
                stepCounter: e8e4a684-3ef8-4076-846f-48d5689e824f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c5e118b-9f63-4e15-ae9c-01e73a3525e8
          stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
        config: {}
        dataType: INT
        defaultValue: ""
        description: s_EDS_document_20.cast(s_EDS_event_10.createDateTime as date)=dim_EDS_created_date.calendar_date
        name: DIM_EDS_CREATED_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b063f4d2-cd74-47c5-a2f2-a74b4580224e
                stepCounter: 93a71c72-5113-441b-99d4-d05f2c00134c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f4548c3-baaf-460b-a1f7-bb8a9454b116
          stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_EDS_document_20.physicalLocation=dim_service_point.service_point_reference_no
        name: DIM_SERVICE_POINT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 66428538-0101-4e75-9137-beccf8a67c9a
                stepCounter: 331048bb-7ff9-400f-b8c4-4ac7cc91d7e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b9a8623-42a3-4786-bc58-f534cc5f7b81
          stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_EDS_document_20.specialtyType=dim_specialty.specialty_reference_no
        name: DIM_SPECIALTY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79aee918-ff6f-4b0a-a656-000827899f3e
                stepCounter: 4182a75e-d07b-4637-97fa-4c01e2878360
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e4ca9cbf-f67e-4cf5-b7a0-560bd88500a8
          stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: ""
        name: TEMPLATEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a52d5d40-93c0-48af-b617-ac2db7bb9622
                stepCounter: eead500e-6b50-4f40-9027-af1c5bc6a758
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b3958ac8-23d7-4cae-af20-46c843abb7ed
          stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_EDS_document_20.s_EDS_event_10.lastUpdateUserId=dim_last_modify_user_login_concerto.user_name
        name: DIM_LAST_MODIFY_USER_LOGIN_CONCERTO_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: faf66468-3790-4610-8b5e-f6328e096184
                stepCounter: 9f0babe7-0834-47a8-b944-d4c8ec750e45
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 310c5c5b-81c9-4569-a723-3e1a57ff9271
          stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: ""
        name: TEMPLATE_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a6622169-d255-40f7-b81f-adc7a557734f
                stepCounter: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39dc4589-7af2-49cb-a39a-d385e8d4111f
          stepCounter: 73713efd-3821-41a6-98dc-f739c8ef4801
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_EDS_EVENT_10: 52cd8b73-2275-4276-a5fa-178fe5e5c3cc
          DS_EDS_STRUCTUREDFORMDATA: 1235c156-b2fa-4226-baa2-245b1464110d
          DS_EDS_ATOMICOBSERVATION: 6d6a9821-dc88-4076-a2a3-76f434ec32f3
          DIM_HOSPITAL: ce5e5ba3-482d-46a9-a8ae-9f160067f51d
          DS_EDS_TEMPLATELIST: eead500e-6b50-4f40-9027-af1c5bc6a758
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_EDS_EVENT_10
          - locationName: TGT
            nodeName: DS_EDS_STRUCTUREDFORMDATA
          - locationName: TGT
            nodeName: DS_EDS_ATOMICOBSERVATION
          - locationName: TGT
            nodeName: DIM_HOSPITAL
          - locationName: TGT
            nodeName: DS_EDS_TEMPLATELIST
        join:
          joinCondition: FROM {{ ref('TGT','S_EDS_EVENT_10') }} s_EDS_event_10 --LEFT JOIN {{ ref('TGT','DS_EDS_STRUCTUREDFORMDATA') }} ds_EDS_StructuredFormData    --ON s_EDS_event_10.event_id = ds_EDS_StructuredFormData.dischargeEventId  --LEFT JOIN {{ ref('TGT','DS_EDS_ATOMICOBSERVATION') }} ds_EDS_AtomicObservation   -- ON ds_EDS_StructuredFormData.structuredFormDataId = ds_EDS_AtomicObservation.structuredFormDataId  LEFT JOIN {{ ref('TGT','DIM_HOSPITAL') }} dim_hospital    ON IFNULL(s_EDS_event_10.origExtHospitalCode,'Unknown') = dim_hospital.hospital_code  and  dim_hospital.dss_current_flag='Y'    --JOIN {{ ref('TGT','DS_EDS_TEMPLATELIST') }} ds_EDS_TemplateList     -- ON s_EDS_event_10.templateCode = ds_EDS_TemplateList.templateCode     --AND s_EDS_event_10.templateVersion = ds_EDS_TemplateList.version    JOIN  ( select *, ROW_NUMBER () over(partition by templateCode,        version order by templateId desc) rn from ds_EDS_TemplateList)ds_EDS_TemplateList    ON s_EDS_event_10.templateCode = ds_EDS_TemplateList.templateCode  AND s_EDS_event_10.templateVersion = ds_EDS_TemplateList.version  and rn=1
        name: S_EDS_DOCUMENT_20
        noLinkRefs: []
  name: S_EDS_DOCUMENT_20
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
