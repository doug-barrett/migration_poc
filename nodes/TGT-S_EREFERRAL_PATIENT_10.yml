fileVersion: 1
id: 846dc711-2463-4d0d-95fe-190d9c92250d
name: S_EREFERRAL_PATIENT_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf97e400-4fe5-4f70-b5a1-cfa0ab3edc1c
          stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: FIRST_VERSION
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: row_number() over(PARTITION BY patientid ORDER BY patientid)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 433b4a58-a8e0-4a86-8d25-9a085f015921
          stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: EXTERNAL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8afac337-1381-4495-a25c-02c1efb378c4
                stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6341b242-2d3f-4685-8aa7-d7c46886396f
          stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: DHB_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 95f6ebdb-bcbb-409b-82fd-d1b0ee8dd204
                stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e411a84-835a-462d-b632-7ed5291190fb
          stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SERVICE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c2633f75-3c0e-45e2-9bd4-c224e44196bd
                stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee97d93a-f052-461a-ade5-7409e11e0fa1
          stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: REFERRED_FOR_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e74b3a5-0e8f-4302-97d6-0fe3f01462f4
                stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 984582b2-b687-4459-a35c-1f3d9c497b1b
          stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 85938f1b-2037-422b-818f-e5b5560ad1e0
                stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dfffd6fc-eabe-4543-8d66-059d895aa375
          stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SUBMISSION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 564735d7-c1cd-4337-8030-1dd22642b64b
                stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91135cd8-e62d-4475-9e12-3a70c25a04bd
          stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: PATIENT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 10db5da5-43e8-424e-93f3-6652cff8b210
                stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c02540d9-da54-4892-aa7c-64cdafe7b8ba
          stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: PATIENT_GIVEN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c0238f3-4c9d-4c57-8e46-4db847d47298
                stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
            transform: |-
              CASE WHEN CHARINDEX('-',patientgivenname) > 0 THEN STUFF(STUFF(LOWER(patientgivenname),1,1,UPPER(LEFT(patientgivenname,1))),CHARINDEX('-',patientgivenname)+1,1,UPPER(SUBSTRING(patientgivenname,CHARINDEX('-',patientgivenname)+1,1)))
                          WHEN CHARINDEX(' ',patientgivenname) > 0 THEN STUFF(STUFF(LOWER(patientgivenname),1,1,UPPER(LEFT(patientgivenname,1))),CHARINDEX(' ',patientgivenname)+1,1,UPPER(SUBSTRING(patientgivenname,CHARINDEX(' ',patientgivenname)+1,1)))
                          ELSE STUFF(LOWER(patientgivenname),1,1,UPPER(LEFT(patientgivenname,1)))
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4bb43e93-b094-4796-8a3b-278ea658d524
          stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: PATIENT_FAMILY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2839605-651a-416c-9a46-0c5ed6fe674b
                stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
            transform: |-
              CASE WHEN CHARINDEX('-',patientfamilyname) > 0 THEN STUFF(STUFF(LOWER(patientfamilyname),1,1,UPPER(LEFT(patientfamilyname,1))),CHARINDEX('-',patientfamilyname)+1,1,UPPER(SUBSTRING(patientfamilyname,CHARINDEX('-',patientfamilyname)+1,1)))
                          WHEN CHARINDEX(' ',patientfamilyname) > 0 THEN STUFF(STUFF(LOWER(patientfamilyname),1,1,UPPER(LEFT(patientfamilyname,1))),CHARINDEX(' ',patientfamilyname)+1,1,UPPER(SUBSTRING(patientfamilyname,CHARINDEX(' ',patientfamilyname)+1,1)))
                          ELSE STUFF(LOWER(patientfamilyname),1,1,UPPER(LEFT(patientfamilyname,1)))
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae2465b3-319c-41f8-b803-b91e11d44355
          stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PATIENT_DOB
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 271ce227-0e72-4d90-a09b-14659901176a
                stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae285710-40d1-40f4-bf9e-3f824c0dbd63
          stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: REFERRER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d09001e6-61b9-40b6-960b-e4124d799931
                stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50bbbb7a-7eee-46d3-a024-0027081cf4e5
          stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: REFERRER_ID_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2f9b82c-fb49-4cf5-90be-e1ddfae1bd03
                stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24beb36e-cfbc-4bc7-9ea9-c525f3d973a9
          stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_UPDATED_DATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ac5c0151-b799-49fe-8d35-67920f5f4f7b
                stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0468c085-d3dd-4db3-ae00-44de034d95cc
          stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: LAST_UPDATED_USER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d421299e-8352-4318-a8cd-f014f3e443d0
                stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 492a1021-e32e-41cc-8e7a-42301aa2b427
          stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: ACC_ELIGIBLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6867f445-db99-426c-8b1c-678f0700a59c
                stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 603c8048-8d76-434e-a74b-a548ea2eb8fc
          stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: ELIGIBILITY_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 790b730d-9315-41c4-a81e-5ea98b7ad96d
                stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 670c0481-bc8c-40a9-9648-955a403838f7
          stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: RESIDENTIAL_DHB
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f4ea881-8664-419e-bdab-cbf56907131a
                stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d968f484-6f61-4e34-976d-93f0c9ce13a0
          stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: PMS_APPLICATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3169393a-06fc-45a4-a3bf-38293118a239
                stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0344639b-5f5c-4229-a0ed-f096ac06541c
          stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LATEST_HISTORY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9e7e7f26-e4e9-4a57-8d7b-1730e7534260
                stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80577e5c-a294-4eb1-aec0-89f297740443
          stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: REFERRER_MESSAGING_ENABLED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e99fa2ca-b26a-4fca-b2a6-dee2ffba4684
                stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d80c6972-4a56-48f1-b79d-34c25c568379
          stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: URGENCY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a7aeece4-e06b-4805-811c-0ec786836139
                stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78bcb455-9135-4063-8941-293a1064673b
          stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
        config: {}
        dataType: NVARCHAR(250)
        defaultValue: ""
        description: ""
        name: PATIENT_ADDRESS_STREET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ae259e8-e4db-4906-8885-230e75054e62
                stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0692633-b962-410c-af08-e36e700d1ecb
          stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
        config: {}
        dataType: NVARCHAR(250)
        defaultValue: ""
        description: ""
        name: PATIENT_ADDRESS_SUBURB
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52c98ce5-2520-4f55-8f51-36d86f34be6f
                stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d08d706-d220-42cd-97ac-1837658f8e20
          stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
        config: {}
        dataType: NVARCHAR(250)
        defaultValue: ""
        description: ""
        name: PATIENT_ADDRESS_CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db6aaedb-a43c-47b9-9a13-23c56028e93b
                stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 866aae88-db9e-4d95-96b5-1256a536c130
          stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: PATIENT_ADDRESS_POSTCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7bf527d3-5db9-41bb-853d-8c9314bd0185
                stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a7a50f0-8ee3-4074-873a-9cb884062f04
          stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
        config: {}
        dataType: NVARCHAR(250)
        defaultValue: ""
        description: ""
        name: PATIENT_ADDRESS_COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d2104b6-8a44-4ea7-83ce-f737d3eb7050
                stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 23b58ff4-56df-4b56-92a8-4150a0b9548b
          stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
        config: {}
        dataType: CHAR(3)
        defaultValue: ""
        description: ""
        name: PATIENT_ADDRESS_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bffcad86-9954-4163-af34-fe23d36a59ff
                stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a28518a4-8e58-46be-98cf-bf85e74c0dd2
          stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: REFERRAL_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5b1461b-176a-4af9-838d-357169e1cfb5
                stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d06d9e84-0ed3-4b85-b5ee-6f035a23f4d8
          stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: REFERRER_FACILITY_HPI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e8973bda-d102-4d5e-82d7-e531781b0f5b
                stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 515526a8-0d5b-4040-b59d-8985e96dc21b
          stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: COMPLETION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 138d8ff3-4c1b-441b-8618-d7c1d928d2d7
                stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80600af1-96b8-4595-9fc4-4f3bae9d2ada
          stepCounter: 846dc711-2463-4d0d-95fe-190d9c92250d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 548d0eee-b5ba-4a11-b8cf-92a7d4acf937
                stepCounter: 85b7be89-0863-4607-a138-a7cfd86a44e4
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies: []
        join:
          joinCondition: FROM [s_ereferral_patient_05] s_ereferral_patient_05
        name: S_EREFERRAL_PATIENT_10
        noLinkRefs: []
  name: S_EREFERRAL_PATIENT_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
