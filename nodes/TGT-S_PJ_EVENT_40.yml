fileVersion: 1
id: cae1b514-79bd-4f7b-b509-f6443b95de8d
name: S_PJ_EVENT_40
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "More calculations that could not be easily defined in the source table."
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15cf30a7-2718-4fd9-a6dd-2c0f02940643
          stepCounter: cae1b514-79bd-4f7b-b509-f6443b95de8d
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7afd8ce5-1d40-42db-a949-07ca5d22d493
                stepCounter: 42aaacf1-f8a4-46e2-99e8-f6e9f10d3e89
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 825e7190-f6fd-43a9-847f-54159d1c5e54
          stepCounter: cae1b514-79bd-4f7b-b509-f6443b95de8d
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Numbers events for each patient in event_start_date order.
        name: PATIENT_EVENT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: af9c278a-884a-4db5-9a94-653d5e4bef0f
                stepCounter: 42aaacf1-f8a4-46e2-99e8-f6e9f10d3e89
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6441ad00-56f9-4369-9d3c-7f74a2266f5a
          stepCounter: cae1b514-79bd-4f7b-b509-f6443b95de8d
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Total number of events for each patient.
        name: PATIENT_EVENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f917632-1d26-4af5-9c3c-d1cfcd2ebd9b
                stepCounter: 42aaacf1-f8a4-46e2-99e8-f6e9f10d3e89
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 418e0dcc-bc60-4a10-b7c2-f487103bee25
          stepCounter: cae1b514-79bd-4f7b-b509-f6443b95de8d
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Journey number for the patient.
        name: JOURNEY_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03a3e91b-d102-498c-b29d-f920df885913
                stepCounter: 42aaacf1-f8a4-46e2-99e8-f6e9f10d3e89
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f1ff203-32f8-4a25-97f0-a612dfbbc9e6
          stepCounter: cae1b514-79bd-4f7b-b509-f6443b95de8d
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Journey count for the patient.
        name: JOURNEY_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 69935384-c204-464e-a4bb-d9147c72dc22
                stepCounter: 42aaacf1-f8a4-46e2-99e8-f6e9f10d3e89
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e36814ac-f11e-4a07-8328-56fd88026fb4
          stepCounter: cae1b514-79bd-4f7b-b509-f6443b95de8d
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Source for this event e.g. ED, Inpatient.
        name: EVENT_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52094038-bc98-494c-b12f-333cbb86c493
                stepCounter: 42aaacf1-f8a4-46e2-99e8-f6e9f10d3e89
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26f6d2f3-ac0f-4c1d-b20e-76bf882830d0
          stepCounter: cae1b514-79bd-4f7b-b509-f6443b95de8d
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: IP encounter unique identifier
        name: IP_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 13b6dff2-19eb-43ae-b540-6a9f76339ed0
                stepCounter: 42aaacf1-f8a4-46e2-99e8-f6e9f10d3e89
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6829e819-4aa7-4710-a0e8-cd11a149ba87
          stepCounter: cae1b514-79bd-4f7b-b509-f6443b95de8d
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ED Encounter unique identifier
        name: ED_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc8b0542-c992-46b9-bfcf-621afc498629
                stepCounter: 42aaacf1-f8a4-46e2-99e8-f6e9f10d3e89
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7a91455-f7e0-448d-ad54-15ff512d7431
          stepCounter: cae1b514-79bd-4f7b-b509-f6443b95de8d
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ED_HOSPITAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a6e316b-8352-4056-9e5b-35ac25fe8851
                stepCounter: 42aaacf1-f8a4-46e2-99e8-f6e9f10d3e89
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 08a48ad5-ae29-4627-bf04-84588890bc9f
          stepCounter: cae1b514-79bd-4f7b-b509-f6443b95de8d
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Set to 1 if this is the ED event related to the index IP event.
        name: INDEX_ED_EVENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a9a118a-2f3f-457f-9d2d-00214375860f
                stepCounter: 42aaacf1-f8a4-46e2-99e8-f6e9f10d3e89
            transform: |-
              CASE WHEN t2.ip_index_event_seq_num = 1 THEN 1
                          ELSE 0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e0b66e6-575b-442b-86df-d42ee96f3997
          stepCounter: cae1b514-79bd-4f7b-b509-f6443b95de8d
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Theatre Encounter unique identifier
        name: THEATRE_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b63e08c4-ea77-412d-a591-eaca26cf0c7f
                stepCounter: 42aaacf1-f8a4-46e2-99e8-f6e9f10d3e89
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de40266a-9ac4-40ae-bba6-2f871033e1fb
          stepCounter: cae1b514-79bd-4f7b-b509-f6443b95de8d
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: theatre_acute_flag
        name: THEATRE_ACUTE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 313a2ece-86b6-4255-987a-82bc8736d8fd
                stepCounter: 42aaacf1-f8a4-46e2-99e8-f6e9f10d3e89
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59d182df-5d6a-43d1-b611-a5c8481cdf32
          stepCounter: cae1b514-79bd-4f7b-b509-f6443b95de8d
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: ""
        name: THEATRE_CANCELLED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 794586d2-2d82-42e9-bb48-2e04e8a38bbe
                stepCounter: 42aaacf1-f8a4-46e2-99e8-f6e9f10d3e89
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ade9d72-4b0b-4a12-a4bf-bf655ab0d720
          stepCounter: cae1b514-79bd-4f7b-b509-f6443b95de8d
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: RADIOLOGY_ACCESSION_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f3c9bc49-92e2-4e84-8cbe-813bc3449b88
                stepCounter: 42aaacf1-f8a4-46e2-99e8-f6e9f10d3e89
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e07dac52-8917-48a3-a3bf-ae5515b36bf4
          stepCounter: cae1b514-79bd-4f7b-b509-f6443b95de8d
        config: {}
        dataType: VARCHAR(22)
        defaultValue: ""
        description: eOrder_id
        name: RADIOLOGY_EORDER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24f0f8e2-ae3d-4197-94a4-22a04f912ccb
                stepCounter: 42aaacf1-f8a4-46e2-99e8-f6e9f10d3e89
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2beb7cc8-3c7a-4725-804a-d38c09f66282
          stepCounter: cae1b514-79bd-4f7b-b509-f6443b95de8d
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: OP encounter unique identifier
        name: OP_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47485247-e3ab-4d69-9c81-2a7c9428fdac
                stepCounter: 42aaacf1-f8a4-46e2-99e8-f6e9f10d3e89
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a45a7b6-42db-4d9e-bc6b-3dcbdd51ea27
          stepCounter: cae1b514-79bd-4f7b-b509-f6443b95de8d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Start date of the first elective surgery for the journey.
        name: FIRST_ELECTIVE_THEATRE_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d7a8a68f-55ac-4cfd-9b93-4bee61eb5a82
                stepCounter: 42aaacf1-f8a4-46e2-99e8-f6e9f10d3e89
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 657e2c14-9e45-4999-961f-e1e3d9e3272b
          stepCounter: cae1b514-79bd-4f7b-b509-f6443b95de8d
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Numbers acute theatre events following the first planned (elective) theatre event.
        name: RETURN_THEATRE_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 29d9cc9b-f7b5-4706-b14b-028fe2ed1891
                stepCounter: 42aaacf1-f8a4-46e2-99e8-f6e9f10d3e89
            transform: |-
              CASE WHEN s_PJ_event_30.theatre_acute_flag = 1 AND s_PJ_event_30.event_start_date > s_PJ_event_30.first_elective_theatre_start_date THEN ROW_NUMBER() OVER(PARTITION BY s_PJ_event_30.patient_nhi, s_PJ_event_30.journey_num, s_PJ_event_30.theatre_acute_flag, CASE WHEN s_PJ_event_30.event_start_date > s_PJ_event_30.first_elective_theatre_start_date THEN 1 ELSE 0 END ORDER BY s_PJ_event_30.event_start_date)
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7330a42-cdf0-4458-862d-4cd84b916f35
          stepCounter: cae1b514-79bd-4f7b-b509-f6443b95de8d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Event start date and time e.g. admit time.
        name: EVENT_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0721b0a1-6087-499c-8b23-faa5d289068a
                stepCounter: 42aaacf1-f8a4-46e2-99e8-f6e9f10d3e89
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4488eb9c-9354-4652-a08f-caac219ba8c3
          stepCounter: cae1b514-79bd-4f7b-b509-f6443b95de8d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time when the event ended e.g. discharge time.
        name: EVENT_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 04e340aa-4340-4abf-865d-eaef143db11f
                stepCounter: 42aaacf1-f8a4-46e2-99e8-f6e9f10d3e89
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2bd3086-0f8b-4c74-b887-9532b515b31d
          stepCounter: cae1b514-79bd-4f7b-b509-f6443b95de8d
        config: {}
        dataType: INT
        defaultValue: ""
        description: Number of minutes since the previous event for the patient.
        name: PREV_EVENT_MINS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 903fe1e6-4926-485d-b8d0-95e22f19c09a
                stepCounter: 42aaacf1-f8a4-46e2-99e8-f6e9f10d3e89
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3dda04ce-8a50-4f6e-a2a0-a6b48353e199
          stepCounter: cae1b514-79bd-4f7b-b509-f6443b95de8d
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Numbers events for each journey in event_start_date order.
        name: JOURNEY_EVENT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 193964be-3d71-423a-81e9-7ff3cbef84ed
                stepCounter: 42aaacf1-f8a4-46e2-99e8-f6e9f10d3e89
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38b592e8-dc2d-4a03-8761-eaecb1c6ab95
          stepCounter: cae1b514-79bd-4f7b-b509-f6443b95de8d
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Total number of events for each journey.
        name: JOURNEY_EVENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c710d93-9613-4305-8e46-4222236beccf
                stepCounter: 42aaacf1-f8a4-46e2-99e8-f6e9f10d3e89
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e4c4682-aded-4d14-8ed5-b88b6afade81
          stepCounter: cae1b514-79bd-4f7b-b509-f6443b95de8d
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Numbers events within each journey/source combination.
        name: JOURNEY_SOURCE_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 29d9cc9b-f7b5-4706-b14b-028fe2ed1891
                stepCounter: 42aaacf1-f8a4-46e2-99e8-f6e9f10d3e89
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59d75c09-5aa6-46ed-8455-a7f35fde324c
          stepCounter: cae1b514-79bd-4f7b-b509-f6443b95de8d
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Total number of events for each journey/source combination.
        name: JOURNEY_SOURCE_EVENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2f48e1ad-9d10-40f7-86e9-59e9e9281260
                stepCounter: 42aaacf1-f8a4-46e2-99e8-f6e9f10d3e89
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0035111-f895-4047-8636-8f5019f8787a
          stepCounter: cae1b514-79bd-4f7b-b509-f6443b95de8d
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: If set to 1 indicates the IP event classified as the Index event. Will be the first IP event which does end in ED i.e. discharge ward is ECC or ECCW.
        name: IP_INDEX_EVENT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a9a118a-2f3f-457f-9d2d-00214375860f
                stepCounter: 42aaacf1-f8a4-46e2-99e8-f6e9f10d3e89
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32d07cb8-f9eb-4214-b1d7-0d55bd6e4e61
          stepCounter: cae1b514-79bd-4f7b-b509-f6443b95de8d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ip event_length_of_stay
        name: IP_EVENT_LENGTH_OF_STAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 250f837f-37f3-4a89-9962-4d05c2152ac2
                stepCounter: 42aaacf1-f8a4-46e2-99e8-f6e9f10d3e89
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bce66d02-1c8b-4c52-af1b-ce2425514cca
          stepCounter: cae1b514-79bd-4f7b-b509-f6443b95de8d
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Service_Point_Code
        name: IP_ADMIT_WARD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 106d690a-9720-4274-b3af-94a1972e0526
                stepCounter: 42aaacf1-f8a4-46e2-99e8-f6e9f10d3e89
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d16ab6b-facd-4f4d-8d3c-9418f47eefa7
          stepCounter: cae1b514-79bd-4f7b-b509-f6443b95de8d
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Service_Point_Code
        name: IP_DISCHARGE_WARD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 738145e1-923a-4eab-8d67-db6ee084153e
                stepCounter: 42aaacf1-f8a4-46e2-99e8-f6e9f10d3e89
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4804f20c-65cf-4d4e-88b0-657697162813
          stepCounter: cae1b514-79bd-4f7b-b509-f6443b95de8d
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Specialty Code
        name: IP_ADMIT_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d2ff61b-d525-4f75-b5f8-bb02af8daa10
                stepCounter: 42aaacf1-f8a4-46e2-99e8-f6e9f10d3e89
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e927924-3e27-4845-9ea5-6863cb55e3c0
          stepCounter: cae1b514-79bd-4f7b-b509-f6443b95de8d
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Specialty Code
        name: IP_DISCHARGE_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ac3b79b7-5d6c-4a5b-9b5e-2d7286e78dc3
                stepCounter: 42aaacf1-f8a4-46e2-99e8-f6e9f10d3e89
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f49f35ab-0e8d-4eca-b27e-694ecb3dfa13
          stepCounter: cae1b514-79bd-4f7b-b509-f6443b95de8d
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Flag indicating whether this is a rehab event i.e. discharge specialty = AT&R.
        name: REHAB_EVENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b3d1cdb-c711-402b-876e-e1c55b1d3a8c
                stepCounter: 42aaacf1-f8a4-46e2-99e8-f6e9f10d3e89
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f17e4976-01bc-415e-b22b-77e101ac53f9
          stepCounter: cae1b514-79bd-4f7b-b509-f6443b95de8d
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Flag indicating whether this is an IP rehab event i.e. admission_specialty_level2_code = 'MHSSE'
        name: MH_EVENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 779c2faf-4e0a-4b08-a686-d7b45b37e076
                stepCounter: 42aaacf1-f8a4-46e2-99e8-f6e9f10d3e89
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 047929a4-c2d3-4b3e-b6ba-14112c86fc05
          stepCounter: cae1b514-79bd-4f7b-b509-f6443b95de8d
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Numbers events for each Rehab event for a journey in event_start_date order.
        name: REHAB_EVENT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: da2c158d-8eee-44e0-b240-9ad823a559b8
                stepCounter: 42aaacf1-f8a4-46e2-99e8-f6e9f10d3e89
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a1f8781-3e02-4fad-9901-470450e826f3
          stepCounter: cae1b514-79bd-4f7b-b509-f6443b95de8d
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Number of rehab events for the journey.
        name: REHAB_EVENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 095ee09a-2d68-45db-9059-92ea0f3a7a28
                stepCounter: 42aaacf1-f8a4-46e2-99e8-f6e9f10d3e89
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc7e1faa-0153-42c0-bb17-2d12a31a0360
          stepCounter: cae1b514-79bd-4f7b-b509-f6443b95de8d
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: DRG_FAMILY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ba9d5cc3-18f2-4350-a0e6-e1f266187716
                stepCounter: 42aaacf1-f8a4-46e2-99e8-f6e9f10d3e89
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54d58416-b7d9-4dd3-a232-96e6b705d270
          stepCounter: cae1b514-79bd-4f7b-b509-f6443b95de8d
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Set to 1 if the event has been clinically coded to a DRG.
        name: CODED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: afc4264f-bd41-458c-8d84-96e662818240
                stepCounter: 42aaacf1-f8a4-46e2-99e8-f6e9f10d3e89
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ca04964-1a08-4c93-8960-964162c0214f
          stepCounter: cae1b514-79bd-4f7b-b509-f6443b95de8d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_PJ_EVENT_30
        join:
          joinCondition: FROM s_PJ_event_30 -- If this is a North Shore Hospital ED event join back  -- to the same table to check whether it is related  -- to the index IP event for the journey.  LEFT OUTER JOIN s_PJ_event_30 t2  ON  s_PJ_event_30.patient_nhi      = t2.patient_nhi  AND s_PJ_event_30.journey_num      = t2.journey_num  AND s_PJ_event_30.ip_encounter_id  = t2.ip_encounter_id    AND s_PJ_event_30.ed_encounter_id  = t2.ed_encounter_id  AND s_PJ_event_30.ed_hospital_code = 'NSH'  AND t2.event_source                = 'IP'
        name: S_PJ_EVENT_40
        noLinkRefs: []
  name: S_PJ_EVENT_40
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
