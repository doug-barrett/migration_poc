fileVersion: 1
id: 2e4ae044-1045-4cab-aaf0-ddc6bdc3f71f
name: VIEW_MOSAIC_CDM_BUDGET_CAPEX
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01a8c6d0-97cd-492d-9afa-7eb48828b364
          stepCounter: 2e4ae044-1045-4cab-aaf0-ddc6bdc3f71f
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: R_VERSION_IDX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c77bdf46-dd09-4966-a087-149b30876057
                stepCounter: 0d3373ad-e7c9-44de-b926-a7a70e957a1f
            transform: TARGET.R_VERSION_IDX
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1af55056-6e0f-4f30-83fa-84a61685787c
          stepCounter: 2e4ae044-1045-4cab-aaf0-ddc6bdc3f71f
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: BUDGET_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0fc20865-81c2-4e62-8321-1888ab1d566a
                stepCounter: 926f66cd-b572-4a61-8ce9-3817fb11dee0
            transform: TARGET.BUDGET_NAME
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf5c12ca-aca0-4d69-a836-280b8c33a64d
          stepCounter: 2e4ae044-1045-4cab-aaf0-ddc6bdc3f71f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: BUDGET_EFFECTIVE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b4949b6-4d4b-4767-ae54-529ef7fca7be
                stepCounter: 2e084f92-31fb-4024-9ed6-378d92d03523
            transform: TARGET.BUDGET_EFFECTIVE_DATE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 554dd1ba-81ae-4411-b268-d09da15abf62
          stepCounter: 2e4ae044-1045-4cab-aaf0-ddc6bdc3f71f
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: R_SRC_IDX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 96392892-baad-4d67-a559-a89a21831d9f
                stepCounter: 0d3373ad-e7c9-44de-b926-a7a70e957a1f
            transform: TARGET.R_SRC_IDX
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a94057f-7c9e-450d-9d75-f497be8e1288
          stepCounter: 2e4ae044-1045-4cab-aaf0-ddc6bdc3f71f
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: CASE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7995d0f3-ff66-483f-bfb7-eb6f9da02a47
                stepCounter: 0d3373ad-e7c9-44de-b926-a7a70e957a1f
            transform: TARGET.CASE_ID
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a4f387a6-d50f-425a-a5a6-a77ef973a495
          stepCounter: 2e4ae044-1045-4cab-aaf0-ddc6bdc3f71f
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: CASE_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 70baf03b-dd5c-46ba-9cb6-93faaceafd38
                stepCounter: 0d3373ad-e7c9-44de-b926-a7a70e957a1f
            transform: TARGET.CASE_NAME
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 62876150-ccaa-4faf-bb92-8cee8222d465
          stepCounter: 2e4ae044-1045-4cab-aaf0-ddc6bdc3f71f
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: VINTAGE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc4a53ec-f729-4f2b-8ca8-25d5b223cc90
                stepCounter: 926f66cd-b572-4a61-8ce9-3817fb11dee0
            transform: TARGET.VINTAGE_ID
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 56528c16-92ce-4c05-bd90-e3dbe1d00e85
          stepCounter: 2e4ae044-1045-4cab-aaf0-ddc6bdc3f71f
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: VINTAGE_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bb23876e-87ed-42ed-8957-d1c708eadeb5
                stepCounter: 926f66cd-b572-4a61-8ce9-3817fb11dee0
            transform: TARGET.VINTAGE_NAME
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b086073d-9953-48fb-a35b-5c29be8eea0f
          stepCounter: 2e4ae044-1045-4cab-aaf0-ddc6bdc3f71f
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: ENTITY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 35235bbf-b7d5-4a7c-827b-03f469ef6f2b
                stepCounter: 2e084f92-31fb-4024-9ed6-378d92d03523
            transform: TARGET.ENTITY_ID
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c31c21a-36eb-4cdf-8d68-bc2de65dc15a
          stepCounter: 2e4ae044-1045-4cab-aaf0-ddc6bdc3f71f
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: ENTITY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c2bd0fae-7ad8-4b55-bb7c-21037598da93
                stepCounter: 2e084f92-31fb-4024-9ed6-378d92d03523
            transform: TARGET.ENTITY_NAME
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 46b3bd88-4fbc-479e-bec5-814e2085f81d
          stepCounter: 2e4ae044-1045-4cab-aaf0-ddc6bdc3f71f
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: ENTITY_UUID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2e215011-e6cd-48dd-8430-f99d156e9375
                stepCounter: 0d3373ad-e7c9-44de-b926-a7a70e957a1f
            transform: TARGET.ENTITY_UUID
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c84fe32-ea95-4f87-9bfd-64e6f9fbb57c
          stepCounter: 2e4ae044-1045-4cab-aaf0-ddc6bdc3f71f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: ACCT_PER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b7a8e94-23c7-4862-b900-5f753ff2be30
                stepCounter: 0d3373ad-e7c9-44de-b926-a7a70e957a1f
            transform: TARGET.ACCT_PER_DATE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92f8fe15-d4ee-47b4-8be9-b467c8390be8
          stepCounter: 2e4ae044-1045-4cab-aaf0-ddc6bdc3f71f
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: AFE_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7618617e-a535-488c-b594-72a1adfdbb8b
                stepCounter: 0d3373ad-e7c9-44de-b926-a7a70e957a1f
            transform: TARGET.AFE_TYPE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d39a45a-a42b-46d8-b4d5-cd0c2d6b3338
          stepCounter: 2e4ae044-1045-4cab-aaf0-ddc6bdc3f71f
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: CC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 240ac005-4224-449b-a85a-483c2bb85fd3
                stepCounter: 0d3373ad-e7c9-44de-b926-a7a70e957a1f
            transform: TARGET.CC
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7424f02d-c4d2-46ed-8fca-ce5b9022e77c
          stepCounter: 2e4ae044-1045-4cab-aaf0-ddc6bdc3f71f
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: DEST_ORG_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a2e8585-ba23-40ca-acd5-77f756ff92c2
                stepCounter: 0d3373ad-e7c9-44de-b926-a7a70e957a1f
            transform: TARGET.DEST_ORG_ID
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ffe70d3-721e-493e-9e21-88fb8f665aca
          stepCounter: 2e4ae044-1045-4cab-aaf0-ddc6bdc3f71f
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: The user-defined code for the reporting entity.
        name: COUNTRY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c001948a-232a-4334-9783-49dbd5b2e688
                stepCounter: 067903b4-15b6-458b-abc2-85946f5a3432
            transform: NVL(DIM_LO_SAP_CC_CORP_HIER_CURRENT.COUNTRY_CODE, 'Unknown')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a247544b-5c22-44f5-8bba-33bfad397323
          stepCounter: 2e4ae044-1045-4cab-aaf0-ddc6bdc3f71f
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: The user-defined code for the reporting entity.
        name: PROV_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7232afab-1540-48f7-8fee-6f30b110639d
                stepCounter: 067903b4-15b6-458b-abc2-85946f5a3432
            transform: NVL(DIM_LO_SAP_CC_CORP_HIER_CURRENT.PROV_CODE, 'Unknown')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1833a32-7a6f-4940-b24a-5f5e2c532e69
          stepCounter: 2e4ae044-1045-4cab-aaf0-ddc6bdc3f71f
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: The name or description of the entity.
        name: COREAREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c8d8af15-264c-40af-8b0b-4dce3b18ed31
                stepCounter: 067903b4-15b6-458b-abc2-85946f5a3432
            transform: NVL(DIM_LO_SAP_CC_CORP_HIER_CURRENT.COREAREA_NAME, 'Unknown')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7fdb6487-4c4c-43d6-9f10-9111dd0e37c8
          stepCounter: 2e4ae044-1045-4cab-aaf0-ddc6bdc3f71f
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: The name or description of the entity.
        name: AREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a489a103-50e2-4347-8d34-6965b140eea8
                stepCounter: 067903b4-15b6-458b-abc2-85946f5a3432
            transform: NVL(DIM_LO_SAP_CC_CORP_HIER_CURRENT.AREA_NAME, 'Unknown')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: efa8a851-c59c-4da8-bcd4-b04a768075be
          stepCounter: 2e4ae044-1045-4cab-aaf0-ddc6bdc3f71f
        config: {}
        dataType: VARCHAR(300)
        defaultValue: ""
        description: ""
        name: OPERATOR_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3de449d8-75b7-4097-918c-39a43e892f85
                stepCounter: f601baef-839f-49ab-b102-ee3fad93f21c
            transform: NVL(DIM_LO_SAP_COST_CENTER.OPERATOR_NAME,'Unknown')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 161f4b04-7e1b-48fc-b759-2ef1be358df7
          stepCounter: 2e4ae044-1045-4cab-aaf0-ddc6bdc3f71f
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: GROSS_OR_NET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 80eeae63-0076-4252-9bcc-e15c32f0c098
                stepCounter: 0d3373ad-e7c9-44de-b926-a7a70e957a1f
            transform: TARGET.GROSS_OR_NET_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b94fe3a-c048-40e8-9892-730ea7d18f8f
          stepCounter: 2e4ae044-1045-4cab-aaf0-ddc6bdc3f71f
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe3705ad-74e1-468c-ad16-886c52c7684b
                stepCounter: 0d3373ad-e7c9-44de-b926-a7a70e957a1f
            transform: TARGET.CAD_AMT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d647c06-eccf-43b6-b6e5-e9d28497c3ec
          stepCounter: 2e4ae044-1045-4cab-aaf0-ddc6bdc3f71f
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ff0fb92-0d2c-4299-a8ed-6279139cfeca
                stepCounter: 0d3373ad-e7c9-44de-b926-a7a70e957a1f
            transform: TARGET.OP_AMT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01a5adf9-6413-4064-ada7-f6c39b6d1167
          stepCounter: 2e4ae044-1045-4cab-aaf0-ddc6bdc3f71f
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2cc5e71a-5e1c-4669-af76-c59988a7fddd
                stepCounter: 0d3373ad-e7c9-44de-b926-a7a70e957a1f
            transform: TARGET.OP_CURR_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 368ad0a2-7b7f-4f85-a8e3-deaaeadd8ecd
          stepCounter: 2e4ae044-1045-4cab-aaf0-ddc6bdc3f71f
        config: {}
        dataType: NUMBER(14,10)
        defaultValue: ""
        description: ""
        name: OP_FX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3ddd019-5f4f-4b16-b0bb-074368ba262e
                stepCounter: 0d3373ad-e7c9-44de-b926-a7a70e957a1f
            transform: TARGET.OP_FX
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_MOSAIC_CDM_BUDGET_CAPEX_1: 0d3373ad-e7c9-44de-b926-a7a70e957a1f
          STAGE_MOSAIC_CDM_BUDGET_CAPEX_2: 926f66cd-b572-4a61-8ce9-3817fb11dee0
          STAGE_MOSAIC_CDM_BUDGET_CAPEX_3: 2e084f92-31fb-4024-9ed6-378d92d03523
          DIM_LO_SAP_CC_CORP_HIER_CURRENT: 067903b4-15b6-458b-abc2-85946f5a3432
          DIM_LO_SAP_COST_CENTER: f601baef-839f-49ab-b102-ee3fad93f21c
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STAGE_MOSAIC_CDM_BUDGET_CAPEX_1
          - locationName: TARGET
            nodeName: STAGE_MOSAIC_CDM_BUDGET_CAPEX_2
          - locationName: TARGET
            nodeName: STAGE_MOSAIC_CDM_BUDGET_CAPEX_3
          - locationName: TARGET
            nodeName: DIM_LO_SAP_CC_CORP_HIER_CURRENT
          - locationName: TARGET
            nodeName: DIM_LO_SAP_COST_CENTER
        join:
          joinCondition: |-
            FROM (
                    SELECT *
                      FROM {{ ref('TARGET','STAGE_MOSAIC_CDM_BUDGET_CAPEX_1') }}
                     UNION SELECT *
                      FROM {{ ref('TARGET','STAGE_MOSAIC_CDM_BUDGET_CAPEX_2') }}
                     UNION SELECT *
                      FROM {{ ref('TARGET','STAGE_MOSAIC_CDM_BUDGET_CAPEX_3') }}
                   ) AS TARGET
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_CC_CORP_HIER_CURRENT') }} DIM_LO_SAP_CC_CORP_HIER_CURRENT
                ON TARGET.CC = DIM_LO_SAP_CC_CORP_HIER_CURRENT.CC_NUM
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_COST_CENTER') }} DIM_LO_SAP_COST_CENTER
                ON TARGET.CC = DIM_LO_SAP_COST_CENTER.CC_NUM
        name: VIEW_MOSAIC_CDM_BUDGET_CAPEX
        noLinkRefs: []
  name: VIEW_MOSAIC_CDM_BUDGET_CAPEX
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
