fileVersion: 1
id: a9ecb8c7-da61-42f1-add4-de4d087d8053
name: VIEW_MOSAIC_CDM_BUDGET_CAPEX
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c8dbbad-b42a-4b6d-948a-ff3a4e8a9197
          stepCounter: a9ecb8c7-da61-42f1-add4-de4d087d8053
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: R_VERSION_IDX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db5eb2ab-5ee6-45ba-bb6a-3c633cc99782
                stepCounter: 20fa0f22-9484-41d6-bf18-d362306407d0
            transform: TARGET.R_VERSION_IDX
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1665e763-4194-4260-8a3e-23d249f74924
          stepCounter: a9ecb8c7-da61-42f1-add4-de4d087d8053
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: BUDGET_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a48c112d-e1e0-4039-8282-4a6e0eba70f9
                stepCounter: 8044e88f-5d31-4c96-80d3-438ff503d561
            transform: TARGET.BUDGET_NAME
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 459c202f-aaa4-4918-a4f5-946438daed7d
          stepCounter: a9ecb8c7-da61-42f1-add4-de4d087d8053
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: BUDGET_EFFECTIVE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02723a23-17b8-44fe-a9b4-c5d5af5bda7a
                stepCounter: 94eec8c2-f05b-49df-b668-0c3e2c3faa40
            transform: TARGET.BUDGET_EFFECTIVE_DATE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 37cd5b53-4040-468a-b2fa-68548740dd22
          stepCounter: a9ecb8c7-da61-42f1-add4-de4d087d8053
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: R_SRC_IDX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 127a4802-d256-464d-9808-a4553444f071
                stepCounter: 20fa0f22-9484-41d6-bf18-d362306407d0
            transform: TARGET.R_SRC_IDX
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3f71692-22c4-4305-9c36-ca7fe021df68
          stepCounter: a9ecb8c7-da61-42f1-add4-de4d087d8053
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: CASE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 178510cd-4226-4e25-8137-bf046d97c99b
                stepCounter: 20fa0f22-9484-41d6-bf18-d362306407d0
            transform: TARGET.CASE_ID
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20eafa72-8075-4503-9e52-5eb5e7f52202
          stepCounter: a9ecb8c7-da61-42f1-add4-de4d087d8053
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: CASE_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed7983df-883a-4a7c-9bce-bdd3c33b0d71
                stepCounter: 20fa0f22-9484-41d6-bf18-d362306407d0
            transform: TARGET.CASE_NAME
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7ad71c2-66de-4508-b93e-6758d037511d
          stepCounter: a9ecb8c7-da61-42f1-add4-de4d087d8053
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: VINTAGE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d85eab49-2129-409d-af6b-98a5a6482645
                stepCounter: 8044e88f-5d31-4c96-80d3-438ff503d561
            transform: TARGET.VINTAGE_ID
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d77c14a-aea3-4812-b914-6bf96bd3ee3f
          stepCounter: a9ecb8c7-da61-42f1-add4-de4d087d8053
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: VINTAGE_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84006fea-7fb8-42a3-a4b7-f2c255d4c2f5
                stepCounter: 8044e88f-5d31-4c96-80d3-438ff503d561
            transform: TARGET.VINTAGE_NAME
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94712abb-93af-4806-adeb-b8bca08f2b21
          stepCounter: a9ecb8c7-da61-42f1-add4-de4d087d8053
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: ENTITY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 875ba27c-238c-4c8a-8eed-a9fa5c10a741
                stepCounter: 94eec8c2-f05b-49df-b668-0c3e2c3faa40
            transform: TARGET.ENTITY_ID
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 881fa12c-ea4a-4472-8448-dff21ca3629a
          stepCounter: a9ecb8c7-da61-42f1-add4-de4d087d8053
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: ENTITY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb4d190a-b482-49f0-b683-f63923966b25
                stepCounter: 94eec8c2-f05b-49df-b668-0c3e2c3faa40
            transform: TARGET.ENTITY_NAME
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98c43e4d-70b1-4ef7-a14b-7c2243e80c27
          stepCounter: a9ecb8c7-da61-42f1-add4-de4d087d8053
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: ENTITY_UUID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3cb1214c-7af2-4f97-864a-45044203cc37
                stepCounter: 20fa0f22-9484-41d6-bf18-d362306407d0
            transform: TARGET.ENTITY_UUID
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af5839fb-3dd7-4f1b-8e37-744958104a35
          stepCounter: a9ecb8c7-da61-42f1-add4-de4d087d8053
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: ACCT_PER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78b09522-32ff-41f6-a53e-e969d8d3c8b8
                stepCounter: 20fa0f22-9484-41d6-bf18-d362306407d0
            transform: TARGET.ACCT_PER_DATE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18716fc1-7429-41fc-86a9-cc1517c2d501
          stepCounter: a9ecb8c7-da61-42f1-add4-de4d087d8053
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: AFE_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b04fd149-c681-4ab1-86e1-ff2e1500199f
                stepCounter: 20fa0f22-9484-41d6-bf18-d362306407d0
            transform: TARGET.AFE_TYPE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e33036f5-f770-401f-a9f9-f51cd4dd4327
          stepCounter: a9ecb8c7-da61-42f1-add4-de4d087d8053
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: CC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce5bc4c8-d8c6-40b5-b1e8-ba5bfc578bdf
                stepCounter: 20fa0f22-9484-41d6-bf18-d362306407d0
            transform: TARGET.CC
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f54e6fa-364b-429c-b405-5066ce633b0c
          stepCounter: a9ecb8c7-da61-42f1-add4-de4d087d8053
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: DEST_ORG_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 832a6a51-beb8-4f11-b580-2b8f6d1cb2d7
                stepCounter: 20fa0f22-9484-41d6-bf18-d362306407d0
            transform: TARGET.DEST_ORG_ID
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25cc9843-9a28-455c-9c0e-e494cf9e2258
          stepCounter: a9ecb8c7-da61-42f1-add4-de4d087d8053
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: The user-defined code for the reporting entity.
        name: COUNTRY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4be6bca3-bee7-4f89-90bd-4834062f282a
                stepCounter: 2cca214d-2f7a-400c-a483-58b288ed6097
            transform: NVL(DIM_LO_SAP_CC_CORP_HIER_CURRENT.COUNTRY_CODE, 'Unknown')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e878d2df-0de1-457d-b1f3-64b867eec1fb
          stepCounter: a9ecb8c7-da61-42f1-add4-de4d087d8053
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: The user-defined code for the reporting entity.
        name: PROV_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a738a046-11b0-4082-a0f6-a86c56484c91
                stepCounter: 2cca214d-2f7a-400c-a483-58b288ed6097
            transform: NVL(DIM_LO_SAP_CC_CORP_HIER_CURRENT.PROV_CODE, 'Unknown')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04a9ef44-c97b-4ed5-a9e8-1fe5d698c253
          stepCounter: a9ecb8c7-da61-42f1-add4-de4d087d8053
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: The name or description of the entity.
        name: COREAREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 619126d9-0cd3-45df-bfbd-2f5dca6da0bd
                stepCounter: 2cca214d-2f7a-400c-a483-58b288ed6097
            transform: NVL(DIM_LO_SAP_CC_CORP_HIER_CURRENT.COREAREA_NAME, 'Unknown')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9e2c8dc-c26f-4c1d-9981-31513ce1e753
          stepCounter: a9ecb8c7-da61-42f1-add4-de4d087d8053
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: The name or description of the entity.
        name: AREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec8da7e4-2ee4-4296-8f0a-7c334356d71e
                stepCounter: 2cca214d-2f7a-400c-a483-58b288ed6097
            transform: NVL(DIM_LO_SAP_CC_CORP_HIER_CURRENT.AREA_NAME, 'Unknown')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aed5bcdc-d484-4a6b-adc9-efaf7c6346d4
          stepCounter: a9ecb8c7-da61-42f1-add4-de4d087d8053
        config: {}
        dataType: VARCHAR(300)
        defaultValue: ""
        description: ""
        name: OPERATOR_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d57224cf-3acd-4744-a6ec-a049020f4eb3
                stepCounter: 99b4a618-454e-46de-874d-ad30b4d42108
            transform: NVL(DIM_LO_SAP_COST_CENTER.OPERATOR_NAME,'Unknown')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9fc236f6-4634-4d33-8fdc-62fcc7dd5feb
          stepCounter: a9ecb8c7-da61-42f1-add4-de4d087d8053
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: GROSS_OR_NET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 507391b0-85c4-4719-a2c0-69c5a235cca2
                stepCounter: 20fa0f22-9484-41d6-bf18-d362306407d0
            transform: TARGET.GROSS_OR_NET_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 228ffe5f-b9a2-4476-bb5a-67ea9376795b
          stepCounter: a9ecb8c7-da61-42f1-add4-de4d087d8053
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0789d2a3-667f-42f8-8465-9ff4f0696768
                stepCounter: 20fa0f22-9484-41d6-bf18-d362306407d0
            transform: TARGET.CAD_AMT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4fe7a7c3-2996-4cbd-ad0a-fb985af0cd87
          stepCounter: a9ecb8c7-da61-42f1-add4-de4d087d8053
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e95ea857-eee2-405f-8f5f-56d1778e0318
                stepCounter: 20fa0f22-9484-41d6-bf18-d362306407d0
            transform: TARGET.OP_AMT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb833a0a-5491-4cd1-95fe-5bd90a4c08cb
          stepCounter: a9ecb8c7-da61-42f1-add4-de4d087d8053
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 04ee2b0b-2312-4e79-bfd1-84fa43e1fc9c
                stepCounter: 20fa0f22-9484-41d6-bf18-d362306407d0
            transform: TARGET.OP_CURR_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c5f6746-ac15-4a2d-b07e-239ab225b8b4
          stepCounter: a9ecb8c7-da61-42f1-add4-de4d087d8053
        config: {}
        dataType: NUMBER(14,10)
        defaultValue: ""
        description: ""
        name: OP_FX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: be0a7e85-389f-4346-bb17-d7750a7fbfa5
                stepCounter: 20fa0f22-9484-41d6-bf18-d362306407d0
            transform: TARGET.OP_FX
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_MOSAIC_CDM_BUDGET_CAPEX_1: 20fa0f22-9484-41d6-bf18-d362306407d0
          STAGE_MOSAIC_CDM_BUDGET_CAPEX_2: 8044e88f-5d31-4c96-80d3-438ff503d561
          STAGE_MOSAIC_CDM_BUDGET_CAPEX_3: 94eec8c2-f05b-49df-b668-0c3e2c3faa40
          DIM_LO_SAP_CC_CORP_HIER_CURRENT: 2cca214d-2f7a-400c-a483-58b288ed6097
          DIM_LO_SAP_COST_CENTER: 99b4a618-454e-46de-874d-ad30b4d42108
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STAGE_MOSAIC_CDM_BUDGET_CAPEX_1
          - locationName: TARGET
            nodeName: STAGE_MOSAIC_CDM_BUDGET_CAPEX_2
          - locationName: TARGET
            nodeName: STAGE_MOSAIC_CDM_BUDGET_CAPEX_3
          - locationName: TARGET
            nodeName: DIM_LO_SAP_CC_CORP_HIER_CURRENT
          - locationName: TARGET
            nodeName: DIM_LO_SAP_COST_CENTER
        join:
          joinCondition: |-
            FROM (
                    SELECT *
                      FROM {{ ref('TARGET','STAGE_MOSAIC_CDM_BUDGET_CAPEX_1') }}
                     UNION SELECT *
                      FROM {{ ref('TARGET','STAGE_MOSAIC_CDM_BUDGET_CAPEX_2') }}
                     UNION SELECT *
                      FROM {{ ref('TARGET','STAGE_MOSAIC_CDM_BUDGET_CAPEX_3') }}
                   ) AS TARGET
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_CC_CORP_HIER_CURRENT') }} DIM_LO_SAP_CC_CORP_HIER_CURRENT
                ON TARGET.CC = DIM_LO_SAP_CC_CORP_HIER_CURRENT.CC_NUM
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_COST_CENTER') }} DIM_LO_SAP_COST_CENTER
                ON TARGET.CC = DIM_LO_SAP_COST_CENTER.CC_NUM
        name: VIEW_MOSAIC_CDM_BUDGET_CAPEX
        noLinkRefs: []
  name: VIEW_MOSAIC_CDM_BUDGET_CAPEX
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
