fileVersion: 1
id: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
name: S_PATIENT_1
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Stage table for Patient data from PIMS and reference tables, prior to updating the Patients Dimension.  Uses a Custom Procedure to update Ethnicity"
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b3ee63bf-02f1-4516-b768-8e458b775ee3
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Patient Reference Number
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c1d681d-fba6-4c9e-bfdf-cc4bbe97e046
                stepCounter: 34c6fd4e-f463-4453-bad1-3a1d762d3caa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f20826af-35d3-46fe-b914-b4c6cc297a16
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: Patient Title
        name: PATIENT_TITLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 108cffc1-4b46-4c8d-8f85-427dbbb97c31
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: Patient Forename
        name: PATIENT_FORENAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 670dec5e-1e36-445c-b654-5d573f94eb8a
                stepCounter: 34c6fd4e-f463-4453-bad1-3a1d762d3caa
            transform: IFNULL(ds_pims_patients.forename, 'Unknown')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c702a49-6531-4348-b9cb-27bc4cbcc292
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: Patient surname
        name: PATIENT_SURNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 82bf8c6b-3687-4179-8d94-aef5ed75cae6
                stepCounter: 34c6fd4e-f463-4453-bad1-3a1d762d3caa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a0d5e2a5-29f1-429d-a006-5caa0107e3ca
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: Preferred Forename
        name: PREFERRED_FORENAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e34817fc-d0ec-401b-a051-53abd17de22a
                stepCounter: 34c6fd4e-f463-4453-bad1-3a1d762d3caa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e207fd28-d984-486d-91fd-c5b6603a7ecd
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: VARCHAR(60)
        defaultValue: ""
        description: patient_fullname
        name: PATIENT_FULLNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 82bf8c6b-3687-4179-8d94-aef5ed75cae6
                stepCounter: 34c6fd4e-f463-4453-bad1-3a1d762d3caa
            transform: |-
              CASE WHEN CHARINDEX('-',surname) > 0 THEN STUFF(STUFF(LOWER(surname),1,1,UPPER(LEFT(surname,1))),CHARINDEX('-',surname)+1,1,UPPER(SUBSTRING(surname,CHARINDEX('-',surname)+1,1)))
                          WHEN CHARINDEX(' ',surname) > 0 THEN STUFF(STUFF(LOWER(surname),1,1,UPPER(LEFT(surname,1))),CHARINDEX(' ',surname)+1,1,UPPER(SUBSTRING(surname,CHARINDEX(' ',surname)+1,1)))
                          ELSE STUFF(LOWER(surname),1,1,UPPER(LEFT(surname,1)))
                           END +', '+ STUFF(LOWER(forename),1,1,UPPER(LEFT(forename,1))) +' '+ CASE WHEN prefrd_forename <> forename THEN STUFF(LOWER(prefrd_forename+')'),1,1,UPPER(LEFT('('+prefrd_forename,2)))
                          ELSE ''
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 555debdc-952d-4936-a59e-322e86127bba
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Patient date of birth
        name: DATE_OF_BIRTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c23a99b1-3968-4ed1-8c00-4209f8878eaf
                stepCounter: 34c6fd4e-f463-4453-bad1-3a1d762d3caa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f3607ed-a86d-4177-af2e-f35c64452c39
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date Of Death
        name: DATE_OF_DEATH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 627b33f3-4ae6-495e-86e0-b5d1c724dfe9
                stepCounter: 34c6fd4e-f463-4453-bad1-3a1d762d3caa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cdc420d2-e316-41de-93f1-07a1c477f3d9
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd8e25c9-7a3c-446d-b6ba-d91333ebfb6e
                stepCounter: 34c6fd4e-f463-4453-bad1-3a1d762d3caa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0ced8b8-9f23-4805-9535-314e7e6b4647
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: PIMS Gender_Reference_Number
        name: GENDER_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2c4fc1f-57e7-4ff2-af1b-9c12c332457a
                stepCounter: 34c6fd4e-f463-4453-bad1-3a1d762d3caa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 015140c5-b60a-4088-bf92-9a557f4b644e
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: Patient gender.
        name: GENDER_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 722bd001-0b97-4d56-9a49-5e2707f64061
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: INTERPRETER_REQUIRED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7070814-43de-4b64-81b9-165090448b87
                stepCounter: 34c6fd4e-f463-4453-bad1-3a1d762d3caa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6bf1b080-fb6e-4e19-8ba9-7be17095e8e3
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: SPOKL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4867fc87-3018-45f7-bb3e-7a7b38037ad9
                stepCounter: 34c6fd4e-f463-4453-bad1-3a1d762d3caa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5575060-cfcb-4b72-ac7c-361d5cc69b23
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: spoken language
        name: SPOKEN_LANGUAGE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 053c9e1b-6043-4e8b-a674-b6360e0bff25
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Ethnicity Group Reference Number
        name: ETHNICITY_GROUP_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f99a52eb-a5ce-4343-9a91-6c7a81df24aa
                stepCounter: 34c6fd4e-f463-4453-bad1-3a1d762d3caa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 892d3b15-c756-493c-ab55-784d697f1a67
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: Ethnicity Group1 Description
        name: ETHNICITY_GROUP1_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b97b4e43-f3e0-47c7-80aa-feddff6466b7
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: Ethnicity Group1 Priority
        name: ETHNICITY_GROUP1_PRIORITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 279eb8f5-07ee-4de8-9248-2ff0f350b859
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: Ethnicity Code 1
        name: ETHNICITY_CODE_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e9d47d8-c5e8-4159-8704-e15c709b0a5b
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: Ethnicity Group2 Description
        name: ETHNICITY_GROUP2_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 36c24b2f-6682-4ed2-b544-a86613421b57
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: Ethnicity Group2 Priority
        name: ETHNICITY_GROUP2_PRIORITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26ecde68-54c6-4f8e-9107-a3123b1047cd
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: Ethnicity Code 2
        name: ETHNICITY_CODE_2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5bae5413-601d-45c2-936c-2d5194a603c3
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: Ethnicity Group3 Description
        name: ETHNICITY_GROUP3_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b92826e-3109-44a9-9c08-149e96e5b7fb
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: Ethnicity Group3 Priority
        name: ETHNICITY_GROUP3_PRIORITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d6d6bea-d52f-4d71-9c4e-6c959964db4a
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: Ethnicity Code 3
        name: ETHNICITY_CODE_3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 36ea6570-0666-456b-9fc3-8c291471da00
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: Ethnicity Highest Priority
        name: ETHNICITY_HIGHEST_PRIORITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e97f46b2-1b7b-4ebc-b64c-db761b80522e
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: Prioritised Ethnicity Code
        name: PRIORITISED_ETHNICITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e07ab68-12be-4930-ae2d-15e33fa7c0f1
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: Prioritised Ethnicity Description
        name: PRIORITISED_ETHNICITY_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a6f272c-bfea-440a-8e7b-b4d5d679c9d8
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: Prioritised Ethnicity Alt1 Level1 Description
        name: PRIORITISED_ETHNICITY_ALT1_LEVEL1_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc1eb70c-4fe2-4a7b-b835-2026c7407c0b
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: Prioritised_Ethnicity Level0 Description
        name: PRIORITISED_ETHNICITY_LEVEL0_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d316aa04-98a4-4de3-8ab0-b3831289fb71
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: Prioritised Ethnicity Level1 Description
        name: PRIORITISED_ETHNICITY_LEVEL1_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9324d02-c987-402f-b4ec-11d79858e1e6
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: Prioritised Ethnicity Alt2 Level1 Description
        name: PRIORITISED_ETHNICITY_ALT2_LEVEL1_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9129ad7-5521-4f72-add2-111a13d266a4
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: NVARCHAR(30)
        defaultValue: ""
        description: ""
        name: DOMICILE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9067a29a-b46f-45bf-a8e2-7b729d096b90
                stepCounter: 2da7aae8-175b-4a39-a6f9-6845a7d85844
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb6bc548-4191-41a3-89b2-184d1a26d29b
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: NVARCHAR(80)
        defaultValue: ""
        description: ""
        name: DOMICILE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: df01f356-efac-46c4-a017-6fcfc717179c
                stepCounter: 2da7aae8-175b-4a39-a6f9-6845a7d85844
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd12d698-1554-49b4-a9fa-0850b150b526
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: AREA_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 85e6b964-0635-4958-9a6f-287b21fc00b4
                stepCounter: 2da7aae8-175b-4a39-a6f9-6845a7d85844
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0fa51699-ee94-438d-86f4-07e0dd25d016
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: DHB_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1d30657-1709-4981-806c-83719c3b3d96
                stepCounter: 2da7aae8-175b-4a39-a6f9-6845a7d85844
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 244a40d9-ba6e-445e-bcb5-4689f55e8e18
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: DHB_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 28609a20-0fb7-430d-ad08-30eb71d2ee15
                stepCounter: 2da7aae8-175b-4a39-a6f9-6845a7d85844
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 65494384-7f05-42b8-8a5e-017a4a453ab6
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: IDF_CLASS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6592bbb3-e5ed-4d24-bca2-816dd00d8c05
                stepCounter: 2da7aae8-175b-4a39-a6f9-6845a7d85844
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bad60e74-0615-452d-929d-ad8ac3a9148e
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: REGION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 30653bfd-e37f-438c-8531-a15c785da45a
                stepCounter: 2da7aae8-175b-4a39-a6f9-6845a7d85844
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a1d9b61-4f73-45c5-923d-4a605cee7c3e
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: residency indicator Y/N or unknown
        name: RESIDENT_YNUNK_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0208167c-cfee-4c20-96bf-7667572a59fd
                stepCounter: 34c6fd4e-f463-4453-bad1-3a1d762d3caa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a214800-7add-423a-bd7e-f650a06d7241
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: Resident flag Y/N/U Yes, No or Unknown
        name: RESIDENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fbb01e3b-4612-47c8-9a4a-5d6abddc60ef
                stepCounter: 06fa4241-360c-43d0-8e4a-8b860f92fc09
            transform: |-
              CASE ds_pims_reference_values.main_code
                          WHEN 'YES'                         THEN 'Y'
                          WHEN 'NO'                          THEN 'N'
                          ELSE 'U'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf5f27bf-f9b9-4dcc-9eac-40167c432980
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: NORTHERN_REGION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 354b7332-e8af-4a19-b418-8b18e4a40575
                stepCounter: 2da7aae8-175b-4a39-a6f9-6845a7d85844
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7d060f9-b971-4674-986b-7745294dfa28
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time when patient record last modified in PIMS.
        name: MODIF_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b08c635-e525-48fd-b958-be9026e404e4
                stepCounter: 34c6fd4e-f463-4453-bad1-3a1d762d3caa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75ce6093-9cf6-47a2-9769-9c5b4d78f1f5
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Create Date
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64e9daea-ad0c-4082-8bbb-d38f9bae225e
                stepCounter: 34c6fd4e-f463-4453-bad1-3a1d762d3caa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f91ae8d-f0b3-4904-ad9e-0365979533a9
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SMOKING_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c402ee40-0d83-4e78-8000-8a810096f046
          stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DS_PIMS_REFERENCE_VALUES: 06fa4241-360c-43d0-8e4a-8b860f92fc09
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_PIMS_PATIENTS
          - locationName: TGT
            nodeName: DS_PIMS_REFERENCE_VALUES
        join:
          joinCondition: |-
            FROM ds_pims_patients
              LEFT OUTER JOIN ds_pims_reference_values ds_pims_reference_values1
                ON ds_pims_patients.title_refno = ds_pims_reference_values1.rfval_refno
               AND getdate() BETWEEN ds_pims_reference_values1.start_dttm AND IFNULL(ds_pims_reference_values1.end_dttm,getdate())
              LEFT OUTER JOIN ds_pims_reference_values ds_pims_reference_values2
                ON ds_pims_patients.sexxx_refno = ds_pims_reference_values2.rfval_refno
               AND getdate() BETWEEN ds_pims_reference_values2.start_dttm AND IFNULL(ds_pims_reference_values2.end_dttm,getdate())
              LEFT OUTER JOIN ds_pims_reference_values ds_pims_reference_values5
                ON ds_pims_patients.spokl_refno = ds_pims_reference_values5.rfval_refno
              LEFT OUTER JOIN s_ethnicity s_ethnicity1
                ON ds_pims_patients.ethgr_refno = s_ethnicity1.ethnicity_group_reference_no
              LEFT OUTER JOIN s_ethnicity s_ethnicity2
                ON ds_pims_patients.second_ethgr_refno = s_ethnicity2.ethnicity_group_reference_no
              LEFT OUTER JOIN s_ethnicity s_ethnicity3
                ON ds_pims_patients.third_ethgr_refno = s_ethnicity3.ethnicity_group_reference_no
              LEFT OUTER JOIN s_patient_address_v s_patient_address_v
                ON s_patient_address_v.patient_reference_no = ds_pims_patients.patnt_refno
               AND s_patient_address_v.address_row_num = 1
              LEFT OUTER JOIN {{ ref('TGT','DS_PIMS_REFERENCE_VALUES') }}
                ON ds_pims_patients.resident_ynunk_refno = ds_pims_reference_values.rfval_refno
              LEFT OUTER JOIN {{ ref('TGT','DS_PIMS_REFERENCE_VALUES') }} ds_pims_reference_values3
                ON ds_pims_patients.multb_refno = ds_pims_reference_values3.rfval_refno
        name: S_PATIENT_1
        noLinkRefs: []
  name: S_PATIENT_1
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
