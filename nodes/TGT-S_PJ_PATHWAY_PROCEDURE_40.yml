fileVersion: 1
id: bc093600-8420-41f4-9163-07d4d80a07d3
name: S_PJ_PATHWAY_PROCEDURE_40
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Map events to pathways via theatre booking codes."
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c17ec56-0a57-46c3-987c-dcff989294db
          stepCounter: bc093600-8420-41f4-9163-07d4d80a07d3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Unique ID for a patient journey
        name: JOURNEY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03be379b-2efc-4a43-a50d-0bdfff9a73bf
                stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e4c0ec8-a2d7-4a68-a5eb-bcc35e04c2d5
          stepCounter: bc093600-8420-41f4-9163-07d4d80a07d3
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2bd64fd3-5840-481c-903a-d31e6df19115
                stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9d4421a-3162-4851-8dd7-ee16c59633ae
          stepCounter: bc093600-8420-41f4-9163-07d4d80a07d3
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Journey number for the patient.
        name: JOURNEY_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: df81c12e-69b9-4a55-a0b5-4a4f3168ba12
                stepCounter: 1ee1f8b7-5986-473d-a6af-01d245ca08b4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a2f1ead-d3d9-47da-9c1c-8c89512cfd14
          stepCounter: bc093600-8420-41f4-9163-07d4d80a07d3
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PROCEDURE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9de6de3c-e498-498d-b374-2810b4051c1c
          stepCounter: bc093600-8420-41f4-9163-07d4d80a07d3
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ICD_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "''"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6a9ef14-fdbd-45bb-9f3d-5750a6eb8c4a
          stepCounter: bc093600-8420-41f4-9163-07d4d80a07d3
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: ICD_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "''"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a458ba7-d2ed-40d7-bcf3-2c64c8963ae2
          stepCounter: bc093600-8420-41f4-9163-07d4d80a07d3
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: PROCEDURE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 923e252d-5be7-4ea7-a451-9f19d2acab53
                stepCounter: e2bedfb6-4e4a-4772-b218-923451ca6cfc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2f12caf-aa34-4904-a6ce-e4446760823c
          stepCounter: bc093600-8420-41f4-9163-07d4d80a07d3
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: DRG_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b4c3b72-6a34-4c9d-8216-8eb7c5fa83e4
          stepCounter: bc093600-8420-41f4-9163-07d4d80a07d3
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: DRG_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 89ccb662-31fa-479b-872a-b3a220a079b1
          stepCounter: bc093600-8420-41f4-9163-07d4d80a07d3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_ICD_CODE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb8db54b-a66d-4f04-ac14-e4604b89be15
          stepCounter: bc093600-8420-41f4-9163-07d4d80a07d3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_DRG_CODE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6bb40bd7-36cf-453f-ae71-a2274d3394e8
          stepCounter: bc093600-8420-41f4-9163-07d4d80a07d3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_ED_TREATMENT_PROTOCOL_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01a30c2c-f57c-4d6b-a70e-f3d969bffddd
          stepCounter: bc093600-8420-41f4-9163-07d4d80a07d3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_THEATRE_BOOKING_PROCEDURE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1a591118-652a-4989-a418-f745a4035598
                stepCounter: 255a8bc5-5383-4153-a4c1-d791d6c02c10
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75ce725b-c966-46ef-9744-6285648a8f7e
          stepCounter: bc093600-8420-41f4-9163-07d4d80a07d3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_THEATRE_PROCEDURE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb7a57aa-11b2-4abd-94ff-0b50d3935752
          stepCounter: bc093600-8420-41f4-9163-07d4d80a07d3
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: CODE_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c73b2a9d-2c47-46ec-8c40-d62485371c8e
                stepCounter: 298d8144-7a9f-4d48-a62f-419b6da64625
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b2c5dfa-efa8-40ea-80ba-02e27b54dc7f
          stepCounter: bc093600-8420-41f4-9163-07d4d80a07d3
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PATHWAY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eeb7b32b-8f2a-437f-8a26-00aa90fc341e
                stepCounter: 298d8144-7a9f-4d48-a62f-419b6da64625
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c94b7723-9676-4c54-93f1-5e976a6eedd7
          stepCounter: bc093600-8420-41f4-9163-07d4d80a07d3
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PATHWAY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 822a56ac-8b7d-465d-a60d-afe98e705c59
                stepCounter: 298d8144-7a9f-4d48-a62f-419b6da64625
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de8c5cc6-24ee-4a0e-87de-7da195416a9e
          stepCounter: bc093600-8420-41f4-9163-07d4d80a07d3
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f9c4f67-e8f2-4ec7-b342-4ffc0a502a3f
                stepCounter: 298d8144-7a9f-4d48-a62f-419b6da64625
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e8f5f6a-328f-4995-bb4d-7c3f943bfcd5
          stepCounter: bc093600-8420-41f4-9163-07d4d80a07d3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_SPECIALTY_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b85a1e98-f006-44f3-b271-293c15237feb
                stepCounter: 298d8144-7a9f-4d48-a62f-419b6da64625
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d38290d-eb83-4839-9e8f-41af3ce8bb9d
          stepCounter: bc093600-8420-41f4-9163-07d4d80a07d3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: TREATMENT_PROTOCOL_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e009f44-734a-4289-8221-7835e51a48eb
                stepCounter: 298d8144-7a9f-4d48-a62f-419b6da64625
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb4a7875-a6f0-408c-a863-714219532350
          stepCounter: bc093600-8420-41f4-9163-07d4d80a07d3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_PJ_JOURNEY
        join:
          joinCondition: |-
            FROM s_PJ_journey
              JOIN fact.fact_theatre_booking
                ON s_PJ_journey.index_ip_encounter_id = fact_theatre_booking.ip_event_encounter_id
              JOIN dim.dim_theatre_booking_procedure
                ON fact_theatre_booking.dim_theatre_booking_procedure_key = dim_theatre_booking_procedure.dim_theatre_booking_procedure_key
              JOIN s_PJ_pathway_code_xref
                ON dim_theatre_booking_procedure.booking_procedure = s_PJ_pathway_code_xref.booking_procedure
             WHERE s_PJ_journey.acute_booking_id IS NOT NULL
        name: S_PJ_PATHWAY_PROCEDURE_40
        noLinkRefs: []
  name: S_PJ_PATHWAY_PROCEDURE_40
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
