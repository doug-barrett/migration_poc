fileVersion: 1
id: 2352471d-b17d-4cc7-9a4d-25b5a1a5de13
name: VIEW_CSLAND_WELL_DOI_DETAIL
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1ae77ef-ed12-45ba-a1ff-e66b28cd6e51
          stepCounter: 2352471d-b17d-4cc7-9a4d-25b5a1a5de13
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: WELL_FILE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ccf77d0a-7b28-4186-89e5-f964390828ee
                stepCounter: 2393d61c-a07b-428f-ad0e-948208327c38
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e528f293-65a6-4f82-b28d-24945bdd7055
          stepCounter: 2352471d-b17d-4cc7-9a4d-25b5a1a5de13
        config: {}
        dataType: DECIMAL(7)
        defaultValue: ""
        description: ""
        name: DOI_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84ad3ac6-6986-4681-8c33-4a9b339d8cae
                stepCounter: 4c591dae-8cae-4462-b16e-495c5989ebb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ecfb7a87-1fcc-4856-a3c7-0eb99e8b6806
          stepCounter: 2352471d-b17d-4cc7-9a4d-25b5a1a5de13
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DOI_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60964802-6912-4016-81d2-f68db88ca9e5
                stepCounter: 2666f026-1171-4402-99af-47c5ee6092ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2a3e000-702a-4766-a639-5fa03809f01b
          stepCounter: 2352471d-b17d-4cc7-9a4d-25b5a1a5de13
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: DOI_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21679f94-12c3-464c-90ef-4897b957cf97
                stepCounter: d2bd2d6f-5926-4bb8-9642-b5aaafb48852
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0bccf73a-8dd8-466f-9672-e6464fcd262f
          stepCounter: 2352471d-b17d-4cc7-9a4d-25b5a1a5de13
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: DOI_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: efe834e0-3e15-48b3-83f5-fe18e69b0a28
                stepCounter: 2666f026-1171-4402-99af-47c5ee6092ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f3f26c3-7b43-4b91-853f-6e52b89ffdb9
          stepCounter: 2352471d-b17d-4cc7-9a4d-25b5a1a5de13
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CHANGED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 92a8b1ce-37ff-4860-892e-53a905e5faf4
                stepCounter: 2666f026-1171-4402-99af-47c5ee6092ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 689d1f75-c827-4052-b3ab-cd6e39d8be94
          stepCounter: 2352471d-b17d-4cc7-9a4d-25b5a1a5de13
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: WELL_DOI_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c90932ab-182d-43ee-b8d4-a0da56ab3f47
                stepCounter: 2666f026-1171-4402-99af-47c5ee6092ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aefe64c2-04ab-42e2-a3d3-cd33d9ad53de
          stepCounter: 2352471d-b17d-4cc7-9a4d-25b5a1a5de13
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: EFFECTIVE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8660bb6e-e159-45b6-8fc0-cd6924ef6efe
                stepCounter: 2666f026-1171-4402-99af-47c5ee6092ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d0397f74-dcf8-4e74-8625-6ed277fd2454
          stepCounter: 2352471d-b17d-4cc7-9a4d-25b5a1a5de13
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: EXPIRY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de877534-23cf-4838-b856-3b01941db1fe
                stepCounter: 2666f026-1171-4402-99af-47c5ee6092ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7835df92-261a-4fcb-b531-9f773e13ab1b
          stepCounter: 2352471d-b17d-4cc7-9a4d-25b5a1a5de13
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: WELL_OWNED_DOI_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5c38b63-f893-42fc-8def-b57710c6de20
                stepCounter: 2666f026-1171-4402-99af-47c5ee6092ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f22460ef-1c64-432f-90a3-496937555453
          stepCounter: 2352471d-b17d-4cc7-9a4d-25b5a1a5de13
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: OWNER_IN_PENALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3970f27c-9b05-4aeb-a7a6-f07bcbb37a33
                stepCounter: 4c591dae-8cae-4462-b16e-495c5989ebb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a1c43da-1fe1-4dff-b51a-b4393b93f651
          stepCounter: 2352471d-b17d-4cc7-9a4d-25b5a1a5de13
        config: {}
        dataType: VARCHAR(60)
        defaultValue: ""
        description: Comments
        name: COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d9756c30-edae-44bc-a581-49cc8f3a6003
                stepCounter: 2666f026-1171-4402-99af-47c5ee6092ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 12b6f0ba-f82f-46e0-a98c-aa5de08668f5
          stepCounter: 2352471d-b17d-4cc7-9a4d-25b5a1a5de13
        config: {}
        dataType: DECIMAL(6)
        defaultValue: ""
        description: ""
        name: PARTNER_OCCURRENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c40a795c-fd97-4c63-b7da-b198386529cc
                stepCounter: 4c591dae-8cae-4462-b16e-495c5989ebb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8118d68a-d59b-4674-afcc-9d63cd063c1f
          stepCounter: 2352471d-b17d-4cc7-9a4d-25b5a1a5de13
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PARTNER_BA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05f2ec9a-e62a-42cc-aa20-5ba476d5cd21
                stepCounter: 4c591dae-8cae-4462-b16e-495c5989ebb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17da49d1-5de8-4225-b183-611bc496daea
          stepCounter: 2352471d-b17d-4cc7-9a4d-25b5a1a5de13
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: PARTNER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7cdfc49f-aa22-4a4a-ad06-6a087f45b67d
                stepCounter: 195380c1-f588-4c27-9c13-2d48662dc985
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78486788-b007-4141-b80a-dcc419aa9bd4
          stepCounter: 2352471d-b17d-4cc7-9a4d-25b5a1a5de13
        config: {}
        dataType: DECIMAL(11,8)
        defaultValue: ""
        description: ""
        name: PARTNER_PERCENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f0286f0e-21c4-426a-8cee-a0d0b6882ac4
                stepCounter: 4c591dae-8cae-4462-b16e-495c5989ebb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8143a989-75d3-4b0e-a802-60987d565e5c
          stepCounter: 2352471d-b17d-4cc7-9a4d-25b5a1a5de13
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: OWNING_PARTNER_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00b031bb-27e5-42ed-ae99-c37a1446a25e
                stepCounter: 001fcc0c-faa3-492e-990b-29437efcbbc0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0fb58e83-833f-41ac-80bc-06694c64b928
          stepCounter: 2352471d-b17d-4cc7-9a4d-25b5a1a5de13
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: SILENT_PARTNER_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c8576b2-31e8-4733-b87d-15c8d262a64e
                stepCounter: 4c591dae-8cae-4462-b16e-495c5989ebb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dea73a5c-af92-4831-8c6d-3f09a43f5aae
          stepCounter: 2352471d-b17d-4cc7-9a4d-25b5a1a5de13
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PARTNER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2b7896c-d3ee-452b-97f0-fc91c72bba7a
                stepCounter: 4c591dae-8cae-4462-b16e-495c5989ebb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7294b6e5-e317-47c5-9d49-31839b3aee07
          stepCounter: 2352471d-b17d-4cc7-9a4d-25b5a1a5de13
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: PARTNER_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c6fc463-d6b2-47af-a01c-0bccfc785465
                stepCounter: 61f17e1f-2d1c-4948-960a-7d2c86b563a2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6248985a-8526-492a-a2ae-68dc760e9018
          stepCounter: 2352471d-b17d-4cc7-9a4d-25b5a1a5de13
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: PENALTY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3970f27c-9b05-4aeb-a7a6-f07bcbb37a33
                stepCounter: 4c591dae-8cae-4462-b16e-495c5989ebb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f9fdb28-5ec7-4ad2-ba14-28ed98f5d303
          stepCounter: 2352471d-b17d-4cc7-9a4d-25b5a1a5de13
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: SILENT_OWNER_BA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ccb9643-cdba-4b1c-877e-8d169c9a68ef
                stepCounter: 4c591dae-8cae-4462-b16e-495c5989ebb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff03bbae-ad8c-4671-8fe6-22b1dc0e6043
          stepCounter: 2352471d-b17d-4cc7-9a4d-25b5a1a5de13
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: SILENT_OWNER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7cdfc49f-aa22-4a4a-ad06-6a087f45b67d
                stepCounter: 195380c1-f588-4c27-9c13-2d48662dc985
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3ed0f0f-18a1-4963-90d0-07428f964813
          stepCounter: 2352471d-b17d-4cc7-9a4d-25b5a1a5de13
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PARTNER_SUMMARY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05f2ec9a-e62a-42cc-aa20-5ba476d5cd21
                stepCounter: 4c591dae-8cae-4462-b16e-495c5989ebb0
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_CSLAND_WELL_DOI_DETAIL: 2352471d-b17d-4cc7-9a4d-25b5a1a5de13
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_CSLAND_WELL_DOI_DETAIL') }} AS SELECT TRIM(DX.FILE_NUMBER) "WELL_FILE_KEY",
                   DD.DOI_ID,
                   DX.DOI_TYPE "DOI_TYPE_CODE",
                   TD.DESCRIPTION "DOI_TYPE",
                   DX.DOI_STATUS,
                   DX.CHANGED_DATE,
                   DX.ACCOUNT_GROUP "WELL_DOI_TYPE",
                   DX.EFFECTIVE_DATE,
                   DX.EXPIRY_DATE,
                   DX.OWNER "WELL_OWNED_DOI_FLAG",
                   DECODE(MAX(DECODE(DECODE(TOW.OWNER,NULL,'N','Y')||NVL(DD.PENALTY,'N'),'YY',1,0)) OVER (PARTITION BY DD.DOI_ID, DD.PARTNER),1,'Y','N') "OWNER_IN_PENALTY",
                   DX.COMMENTS,
                   DD.OCCURRENCE "PARTNER_OCCURRENCE",
                   DD.PARTNER "PARTNER_BA",
                   BA1.NAME "PARTNER_NAME",
                   DD.PARTNER_PERCENT,
                   DECODE(TOW.OWNER,NULL,'N','Y') "OWNING_PARTNER_FLAG",
                   DD.SILENT_PARTNER "SILENT_PARTNER_FLAG",
                   DD.PARTNER_TYPE "PARTNER_TYPE_CODE",
                   TP.DESCRIPTION "PARTNER_TYPE",
                   DD.PENALTY "PENALTY_FLAG",
                   DD.SILENT_OWNER "SILENT_OWNER_BA",
                   BA2.NAME "SILENT_OWNER_NAME",
                   RPAD(BA1.NAME||'  ('||TRIM(DD.PARTNER)||')', 50, ' ') || LPAD(TO_CHAR(NVL(DD.PARTNER_PERCENT,0),'990.0000000'),12,' ') || '   ' || RPAD(NVL(DD.PARTNER_TYPE,' '),10,' ') || '   ' || 'Owner: '||DECODE(TOW.OWNER,NULL,'N','Y') || '   ' || 'Silent Partner: '||DECODE(DD.SILENT_PARTNER,'*','S',' ') || '   ' || 'Penalty: '||NVL(DD.PENALTY,'N') || '   ' || 'Silent Owner: '||RPAD(BA2.NAME||'  ('||TRIM(DD.SILENT_OWNER)||')', 50, ' ') "PARTNER_SUMMARY"
              FROM DS_CSLAND.D_XREF DX,
                   DS_CSLAND.D_DETAIL DD,
                   DS_CSLAND.T_OWNERS TOW,
                   DS_CSLAND.BA_TABLE BA1,
                   DS_CSLAND.BA_TABLE BA2,
                   DS_CSLAND.T_DOI TD,
                   DS_CSLAND.T_PTYPE TP
             WHERE DX.DOI_ID = DD.DOI_ID
               AND DD.PARTNER = TOW.OWNER(+)
               AND DX.EFFECTIVE_DATE <= CURRENT_TIMESTAMP
               AND DX.EXPIRY_DATE > CURRENT_TIMESTAMP
               AND DD.PARTNER = BA1.PRIMARY_KEY(+)
               AND DD.SILENT_OWNER = BA2.PRIMARY_KEY(+)
               AND DX.DOI_TYPE = TD.CODE(+)
               AND DD.PARTNER_TYPE = TP.CODE(+)
               AND DX.SUBSYSTEM = 'W'
        dependencies:
          - locationName: TARGET
            nodeName: VIEW_CSLAND_WELL_DETAIL
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','VIEW_CSLAND_WELL_DETAIL') }}
        name: VIEW_CSLAND_WELL_DOI_DETAIL
        noLinkRefs: []
  name: VIEW_CSLAND_WELL_DOI_DETAIL
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
