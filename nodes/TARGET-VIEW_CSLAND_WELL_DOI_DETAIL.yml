fileVersion: 1
id: db9d577e-4179-4756-9fc4-94d82167973d
name: VIEW_CSLAND_WELL_DOI_DETAIL
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7af56c2-12a0-43f0-b215-0f31f4109b34
          stepCounter: db9d577e-4179-4756-9fc4-94d82167973d
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: WELL_FILE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2b16560b-39b7-4cb0-8b6e-79679471343e
                stepCounter: b1d1f06e-f672-4111-8570-9ab68d4ef792
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5649f68c-ad28-4715-8c13-b0edaae2cde8
          stepCounter: db9d577e-4179-4756-9fc4-94d82167973d
        config: {}
        dataType: DECIMAL(7)
        defaultValue: ""
        description: ""
        name: DOI_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f841507-16ce-4612-80ff-8261367e7396
                stepCounter: 5d401374-6e3b-4e5f-b27a-ab979c40cb21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6156667b-dc79-4067-b4ac-265086382d0f
          stepCounter: db9d577e-4179-4756-9fc4-94d82167973d
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DOI_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 353fb880-be91-4706-8ff0-4c9fc93a1a3f
                stepCounter: 8a1aebb0-1dcf-4f1e-be95-93508ea7ab7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b4c0053-5e9a-4593-a0ec-e7011b815ce8
          stepCounter: db9d577e-4179-4756-9fc4-94d82167973d
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: DOI_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 469c271a-3b3f-43c4-99c1-c621b8c1d32a
                stepCounter: fc08e86c-5254-4f5e-97fc-e83555aefe1e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 618da2b6-5a43-4b4a-859d-5a69214e60dd
          stepCounter: db9d577e-4179-4756-9fc4-94d82167973d
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: DOI_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 739336c2-7514-48c7-a582-79f9a8720b53
                stepCounter: 8a1aebb0-1dcf-4f1e-be95-93508ea7ab7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d473853-a4ae-4363-8cc1-e511f032a1c3
          stepCounter: db9d577e-4179-4756-9fc4-94d82167973d
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CHANGED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc8fc0bb-41fd-4169-a46f-03db0ed56c7f
                stepCounter: 8a1aebb0-1dcf-4f1e-be95-93508ea7ab7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5782fb4-5e9c-4797-b82e-f09d84c2bd3f
          stepCounter: db9d577e-4179-4756-9fc4-94d82167973d
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: WELL_DOI_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0abf96c0-1750-4523-a439-2a9c97feeaba
                stepCounter: 8a1aebb0-1dcf-4f1e-be95-93508ea7ab7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6fff3047-8c33-4e2d-a224-0a2da261343d
          stepCounter: db9d577e-4179-4756-9fc4-94d82167973d
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: EFFECTIVE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dbba7f4f-8c90-4747-bbce-8099b28ea271
                stepCounter: 8a1aebb0-1dcf-4f1e-be95-93508ea7ab7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fbb18158-d84a-4e76-bac1-b33e436de5b6
          stepCounter: db9d577e-4179-4756-9fc4-94d82167973d
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: EXPIRY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6510da05-a4fa-41d5-ba0f-2e995a04bf86
                stepCounter: 8a1aebb0-1dcf-4f1e-be95-93508ea7ab7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33da14d4-b55a-4c51-a51a-678fe1bbcaf3
          stepCounter: db9d577e-4179-4756-9fc4-94d82167973d
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: WELL_OWNED_DOI_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b19904c-a62a-4040-971d-0bdb22e62c05
                stepCounter: 8a1aebb0-1dcf-4f1e-be95-93508ea7ab7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48e3a600-4d5f-4736-ba0d-184d8d9a4803
          stepCounter: db9d577e-4179-4756-9fc4-94d82167973d
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: OWNER_IN_PENALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa838ebf-6c6f-4617-9d3b-7a71ef98a87a
                stepCounter: 5d401374-6e3b-4e5f-b27a-ab979c40cb21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40efc1e3-cba2-4144-ad18-878a9cd278b6
          stepCounter: db9d577e-4179-4756-9fc4-94d82167973d
        config: {}
        dataType: VARCHAR(60)
        defaultValue: ""
        description: Comments
        name: COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d469ab2-0795-4db4-ac98-b9cfd3a6af1f
                stepCounter: 8a1aebb0-1dcf-4f1e-be95-93508ea7ab7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d00560c6-b345-4fe4-a4f1-dcdaafa992b5
          stepCounter: db9d577e-4179-4756-9fc4-94d82167973d
        config: {}
        dataType: DECIMAL(6)
        defaultValue: ""
        description: ""
        name: PARTNER_OCCURRENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3943edef-ae37-48bc-b3bf-f803a5e29470
                stepCounter: 5d401374-6e3b-4e5f-b27a-ab979c40cb21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 043fd292-2c37-4779-98cf-fd72f08d319e
          stepCounter: db9d577e-4179-4756-9fc4-94d82167973d
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PARTNER_BA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8953a1e0-0998-4339-acdc-88c81059d248
                stepCounter: 5d401374-6e3b-4e5f-b27a-ab979c40cb21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f42d44f-7852-45ed-867d-e6b5720e0aa7
          stepCounter: db9d577e-4179-4756-9fc4-94d82167973d
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: PARTNER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e973675-26ea-41fb-9f8f-450a5924d092
                stepCounter: 17e8c098-2969-4300-91b0-b858f6d02add
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40a5ef9c-4171-469b-9514-7da92ea56123
          stepCounter: db9d577e-4179-4756-9fc4-94d82167973d
        config: {}
        dataType: DECIMAL(11,8)
        defaultValue: ""
        description: ""
        name: PARTNER_PERCENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4390719f-f647-4285-96c0-635bec86b40c
                stepCounter: 5d401374-6e3b-4e5f-b27a-ab979c40cb21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7301e916-920e-48b8-95ac-d01cb76e5700
          stepCounter: db9d577e-4179-4756-9fc4-94d82167973d
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: OWNING_PARTNER_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 44d0ab4a-fac5-4653-9b8e-cec8e672afb9
                stepCounter: 7d1c0def-cbcd-49c8-bb14-0ee1ccba7672
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 411f6ca3-4749-4e56-ad75-8db75f8c50d2
          stepCounter: db9d577e-4179-4756-9fc4-94d82167973d
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: SILENT_PARTNER_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77e72a62-cac0-40a8-81ba-90e06dd1591b
                stepCounter: 5d401374-6e3b-4e5f-b27a-ab979c40cb21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f760cbe4-9862-4673-aac3-e6d423853a4b
          stepCounter: db9d577e-4179-4756-9fc4-94d82167973d
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PARTNER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a944f58a-7836-4f13-9526-46953ba1623a
                stepCounter: 5d401374-6e3b-4e5f-b27a-ab979c40cb21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3f92eb9-c7b0-4d6f-974e-a04f3e213d8b
          stepCounter: db9d577e-4179-4756-9fc4-94d82167973d
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: PARTNER_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1aedf7e7-d423-495f-8d9b-278728e3db5b
                stepCounter: 8257f393-4593-4b10-b20d-11d5bf639afd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7cb5e5b-a7ba-4ad3-ba31-755e07d7aa5c
          stepCounter: db9d577e-4179-4756-9fc4-94d82167973d
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: PENALTY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa838ebf-6c6f-4617-9d3b-7a71ef98a87a
                stepCounter: 5d401374-6e3b-4e5f-b27a-ab979c40cb21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c7196c19-00ac-402b-bac8-8516be9022d0
          stepCounter: db9d577e-4179-4756-9fc4-94d82167973d
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: SILENT_OWNER_BA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de841b6a-76f6-4c20-9d40-c64fc14a99c1
                stepCounter: 5d401374-6e3b-4e5f-b27a-ab979c40cb21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9fff2ff3-ab6d-4194-ac11-261d434a4caa
          stepCounter: db9d577e-4179-4756-9fc4-94d82167973d
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: SILENT_OWNER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e973675-26ea-41fb-9f8f-450a5924d092
                stepCounter: 17e8c098-2969-4300-91b0-b858f6d02add
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0fe6520-3e24-4017-b87c-b31b10e48414
          stepCounter: db9d577e-4179-4756-9fc4-94d82167973d
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PARTNER_SUMMARY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8953a1e0-0998-4339-acdc-88c81059d248
                stepCounter: 5d401374-6e3b-4e5f-b27a-ab979c40cb21
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_CSLAND_WELL_DOI_DETAIL: db9d577e-4179-4756-9fc4-94d82167973d
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_CSLAND_WELL_DOI_DETAIL') }} AS SELECT TRIM(DX.FILE_NUMBER) "WELL_FILE_KEY",
                   DD.DOI_ID,
                   DX.DOI_TYPE "DOI_TYPE_CODE",
                   TD.DESCRIPTION "DOI_TYPE",
                   DX.DOI_STATUS,
                   DX.CHANGED_DATE,
                   DX.ACCOUNT_GROUP "WELL_DOI_TYPE",
                   DX.EFFECTIVE_DATE,
                   DX.EXPIRY_DATE,
                   DX.OWNER "WELL_OWNED_DOI_FLAG",
                   DECODE(MAX(DECODE(DECODE(TOW.OWNER,NULL,'N','Y')||NVL(DD.PENALTY,'N'),'YY',1,0)) OVER (PARTITION BY DD.DOI_ID, DD.PARTNER),1,'Y','N') "OWNER_IN_PENALTY",
                   DX.COMMENTS,
                   DD.OCCURRENCE "PARTNER_OCCURRENCE",
                   DD.PARTNER "PARTNER_BA",
                   BA1.NAME "PARTNER_NAME",
                   DD.PARTNER_PERCENT,
                   DECODE(TOW.OWNER,NULL,'N','Y') "OWNING_PARTNER_FLAG",
                   DD.SILENT_PARTNER "SILENT_PARTNER_FLAG",
                   DD.PARTNER_TYPE "PARTNER_TYPE_CODE",
                   TP.DESCRIPTION "PARTNER_TYPE",
                   DD.PENALTY "PENALTY_FLAG",
                   DD.SILENT_OWNER "SILENT_OWNER_BA",
                   BA2.NAME "SILENT_OWNER_NAME",
                   RPAD(BA1.NAME||'  ('||TRIM(DD.PARTNER)||')', 50, ' ') || LPAD(TO_CHAR(NVL(DD.PARTNER_PERCENT,0),'990.0000000'),12,' ') || '   ' || RPAD(NVL(DD.PARTNER_TYPE,' '),10,' ') || '   ' || 'Owner: '||DECODE(TOW.OWNER,NULL,'N','Y') || '   ' || 'Silent Partner: '||DECODE(DD.SILENT_PARTNER,'*','S',' ') || '   ' || 'Penalty: '||NVL(DD.PENALTY,'N') || '   ' || 'Silent Owner: '||RPAD(BA2.NAME||'  ('||TRIM(DD.SILENT_OWNER)||')', 50, ' ') "PARTNER_SUMMARY"
              FROM DS_CSLAND.D_XREF DX,
                   DS_CSLAND.D_DETAIL DD,
                   DS_CSLAND.T_OWNERS TOW,
                   DS_CSLAND.BA_TABLE BA1,
                   DS_CSLAND.BA_TABLE BA2,
                   DS_CSLAND.T_DOI TD,
                   DS_CSLAND.T_PTYPE TP
             WHERE DX.DOI_ID = DD.DOI_ID
               AND DD.PARTNER = TOW.OWNER(+)
               AND DX.EFFECTIVE_DATE <= CURRENT_TIMESTAMP
               AND DX.EXPIRY_DATE > CURRENT_TIMESTAMP
               AND DD.PARTNER = BA1.PRIMARY_KEY(+)
               AND DD.SILENT_OWNER = BA2.PRIMARY_KEY(+)
               AND DX.DOI_TYPE = TD.CODE(+)
               AND DD.PARTNER_TYPE = TP.CODE(+)
               AND DX.SUBSYSTEM = 'W'
        dependencies:
          - locationName: TARGET
            nodeName: VIEW_CSLAND_WELL_DETAIL
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','VIEW_CSLAND_WELL_DETAIL') }}
        name: VIEW_CSLAND_WELL_DOI_DETAIL
        noLinkRefs: []
  name: VIEW_CSLAND_WELL_DOI_DETAIL
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
