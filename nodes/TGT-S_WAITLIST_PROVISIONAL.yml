fileVersion: 1
id: 229030e7-a32c-4fb2-8caa-6872d9bbb485
name: S_WAITLIST_PROVISIONAL
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: afc63ffc-c4bb-4f97-af9f-54fc7a71b020
          stepCounter: 229030e7-a32c-4fb2-8caa-6872d9bbb485
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: USSCR_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f425ea80-eec6-47dc-88c6-e4da6c71a95d
                stepCounter: 4cb1aabb-3db5-4093-8698-3c7d4b015e5e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79db72e8-15b5-42cd-a71c-4d02b68b4711
          stepCounter: 229030e7-a32c-4fb2-8caa-6872d9bbb485
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a398f10-0e5d-4eca-b3cf-6cc0b87b7515
                stepCounter: c5429209-b899-4e7f-9548-ca0e9a55f302
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94e3d41f-2b34-4146-b1df-fa3499c0eeb9
          stepCounter: 229030e7-a32c-4fb2-8caa-6872d9bbb485
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: WAITLIST_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a398f10-0e5d-4eca-b3cf-6cc0b87b7515
                stepCounter: c5429209-b899-4e7f-9548-ca0e9a55f302
            transform: "'W' + CONVERT(varchar(20), ds_pims_ldd_local_datavalues.sorce_refno)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e36d219-b55c-4c56-9ebe-a877b86d1649
          stepCounter: 229030e7-a32c-4fb2-8caa-6872d9bbb485
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: LCLDA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dbd3ebce-bc67-473e-b3a7-be4052b657c7
                stepCounter: c5429209-b899-4e7f-9548-ca0e9a55f302
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 558d2783-5238-4792-afeb-940e465306b1
          stepCounter: 229030e7-a32c-4fb2-8caa-6872d9bbb485
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: PATNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b076c301-deb4-4824-a7f6-1615c4559777
                stepCounter: c5429209-b899-4e7f-9548-ca0e9a55f302
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a2ce496-3664-4393-aaf7-aa4c1e3ac391
          stepCounter: 229030e7-a32c-4fb2-8caa-6872d9bbb485
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 195966fa-4913-4265-89be-ea2d5be14973
                stepCounter: c5429209-b899-4e7f-9548-ca0e9a55f302
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8858c517-1038-45a5-97e7-e6dc7a168247
          stepCounter: 229030e7-a32c-4fb2-8caa-6872d9bbb485
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PROVISIONAL_CLINICIAN_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f4017d9-b354-485f-ab33-0754b012bbb7
                stepCounter: c5429209-b899-4e7f-9548-ca0e9a55f302
            transform: TRY_CAST(ds_pims_ldd_local_datavalues.ussob_value_6 AS INT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c669287e-70d6-43d0-857c-c77ec31276fa
          stepCounter: 229030e7-a32c-4fb2-8caa-6872d9bbb485
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_waitlist_provisional.TRY_CAST(ds_pims_ldd_local_datavalues.ussob_value_6 AS INT)=dim_provisional_clinician.provisional_clinician_reference_no
        name: DIM_PROVISIONAL_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e59f9e3c-d929-4daa-9b33-b910389bfaf8
                stepCounter: 36945bd9-6631-47ea-a5ba-657db39c9f12
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aed3de71-7f03-4a9c-b6ac-5752bbc408b0
          stepCounter: 229030e7-a32c-4fb2-8caa-6872d9bbb485
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PROVISIONAL_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 98ddbbfb-f092-4cba-9996-f7c0cc7c4a34
                stepCounter: c5429209-b899-4e7f-9548-ca0e9a55f302
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7af70999-9a24-4b03-ad50-637b9ab5d7a1
          stepCounter: 229030e7-a32c-4fb2-8caa-6872d9bbb485
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_WAITLIST_BOOKING_STATUS_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 44c3ceea-be3e-490f-993c-2e19a2c7fc05
                stepCounter: 3b273b47-3733-4612-903f-ceef191c2efb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32d1b173-cb6e-43a0-9690-6a8bc145cac0
          stepCounter: 229030e7-a32c-4fb2-8caa-6872d9bbb485
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: COMMENTS_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c46b1787-f1f9-4de2-9f91-73db2231eb4c
                stepCounter: c5429209-b899-4e7f-9548-ca0e9a55f302
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b341af5-862c-4a02-9855-567d51d657f2
          stepCounter: 229030e7-a32c-4fb2-8caa-6872d9bbb485
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REMVL_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 36a3fdff-30f8-45fe-b227-f477953b83cc
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c8a33be-5590-4212-a530-97885b6105ab
          stepCounter: 229030e7-a32c-4fb2-8caa-6872d9bbb485
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: NOTES_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7509a993-f2d2-4b90-9549-d04577496bc2
                stepCounter: 0f2c28d6-5d4a-4bb6-a9e2-a0fb820af70d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6a028b1-c8de-4576-b47a-96740badb3f1
          stepCounter: 229030e7-a32c-4fb2-8caa-6872d9bbb485
        config: {}
        dataType: VARCHAR(MAX)
        defaultValue: ""
        description: ""
        name: PROVISIONAL_COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fbab881d-00cc-4689-a24d-dc4eac20ed5b
                stepCounter: 8132e10c-cb6f-416f-97aa-7dec7177518c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20d7b0fe-a489-48ba-9e6e-d5f10bfa019d
          stepCounter: 229030e7-a32c-4fb2-8caa-6872d9bbb485
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: L_PIMS_USER_SCREENS
        join:
          joinCondition: |-
            FROM l_pims_user_screens
              JOIN ds_pims_ldd_local_datavalues
                ON ds_pims_ldd_local_datavalues.usscr_refno = l_pims_user_screens.USSCR_REFNO
               AND (ds_pims_ldd_local_datavalues.ussob_memo_1 IS NOT NULL OR ds_pims_ldd_local_datavalues.ussob_dttm_value_1 IS NOT NULL)
               AND ds_pims_ldd_local_datavalues.archv_flag = 'N'
              JOIN ds_pims_waiting_list_entries
                ON ds_pims_waiting_list_entries.wlist_refno = ds_pims_ldd_local_datavalues.sorce_refno
               AND ds_pims_waiting_list_entries.remvl_dttm IS NULL
               AND ds_pims_waiting_list_entries.archv_flag = 'N'
              LEFT OUTER JOIN ds_pims_note_roles
                ON ds_pims_note_roles.sorce_refno = ds_pims_ldd_local_datavalues.lclda_refno
               AND ds_pims_note_roles.sorce_code = 'MEM01'
              LEFT OUTER JOIN ds_pims_notes
                ON ds_pims_notes.notes_refno = ds_pims_note_roles.notes_refno
              LEFT OUTER JOIN dim.dim_waitlist_booking_status
                ON dim_waitlist_booking_status.waitlist_booking_status_desc = 'Provisional'
               AND ds_pims_ldd_local_datavalues.ussob_dttm_value_1 IS NOT NULL -- Provisional Date not null    WHERE l_pims_user_screens.code = 'ATSTRI'
        name: S_WAITLIST_PROVISIONAL
        noLinkRefs: []
  name: S_WAITLIST_PROVISIONAL
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
