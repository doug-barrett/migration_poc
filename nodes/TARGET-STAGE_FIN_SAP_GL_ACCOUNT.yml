fileVersion: 1
id: 5d4fef26-c744-4424-aaca-e67fdfd9eeeb
name: STAGE_FIN_SAP_GL_ACCOUNT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be44f760-72b1-40dc-8d7e-8bacff376d3c
          stepCounter: 5d4fef26-c744-4424-aaca-e67fdfd9eeeb
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ACCT_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03191fa0-b453-4f65-884d-bd7427484f41
                stepCounter: 0916925b-ab25-46b1-ba79-1612daedec0e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a669f92e-a267-4fea-b315-472e57b296dd
          stepCounter: 5d4fef26-c744-4424-aaca-e67fdfd9eeeb
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: MAJOR_ACCT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1980e91d-66a1-406a-8bef-1bb472d339b2
                stepCounter: 408889f4-50b9-484f-b8c9-4abd4e415863
            transform: LTRIM(ODS_SAP_SKA1.SAKNR,'0')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f39b0c88-48a3-430f-8da0-129b50213113
          stepCounter: 5d4fef26-c744-4424-aaca-e67fdfd9eeeb
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: MINOR_ACCT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d935328-e00d-4cc2-8fa6-12b27183f621
          stepCounter: 5d4fef26-c744-4424-aaca-e67fdfd9eeeb
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: ACCOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1980e91d-66a1-406a-8bef-1bb472d339b2
                stepCounter: 408889f4-50b9-484f-b8c9-4abd4e415863
            transform: LTRIM(ODS_SAP_SKA1.SAKNR,'0')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87184d77-7b17-4d85-a570-351873e68ae5
          stepCounter: 5d4fef26-c744-4424-aaca-e67fdfd9eeeb
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: The first element of the destination system code value.
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 486a0429-ad27-4bc5-b1a1-5681cdb17cd4
          stepCounter: 5d4fef26-c744-4424-aaca-e67fdfd9eeeb
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Indicates amounts are gross or net.
        name: GROSS_OR_NET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a092ef1c-265e-4c4b-bd22-dc4e44443ad8
          stepCounter: 5d4fef26-c744-4424-aaca-e67fdfd9eeeb
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: The major account to which our share is posted.
        name: NET_MAJOR_ACCT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 870d9b78-2aac-43f6-b91c-67269dce6603
          stepCounter: 5d4fef26-c744-4424-aaca-e67fdfd9eeeb
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PROD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b93e478-0279-469a-816f-382bac909e7a
          stepCounter: 5d4fef26-c744-4424-aaca-e67fdfd9eeeb
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d1ebf97-88aa-4c85-9ac1-5bd9d0788c86
          stepCounter: 5d4fef26-c744-4424-aaca-e67fdfd9eeeb
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: CURR_CONVERSION_RULE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 050389c7-5523-47e8-9e16-30eaca7efe2e
          stepCounter: 5d4fef26-c744-4424-aaca-e67fdfd9eeeb
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: AFE_REQD_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef74acfb-6ab7-4f02-92cf-b584a431e54a
          stepCounter: 5d4fef26-c744-4424-aaca-e67fdfd9eeeb
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: CC_REQD_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1cee95b3-30c1-4ae7-95d0-681e26699ca4
          stepCounter: 5d4fef26-c744-4424-aaca-e67fdfd9eeeb
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: VOL_REQD_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 30f1e7b8-c7f6-41f4-aafe-9b9fdf813d90
          stepCounter: 5d4fef26-c744-4424-aaca-e67fdfd9eeeb
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: ACTVY_DATE_REQD_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fde4d025-8adc-468c-84c4-fa5f2d451f2e
          stepCounter: 5d4fef26-c744-4424-aaca-e67fdfd9eeeb
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: CTRL_ACCT_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49c996bd-097c-4e4a-bdcd-f6f9d2ffd4a0
          stepCounter: 5d4fef26-c744-4424-aaca-e67fdfd9eeeb
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ce2758e-45a0-4f94-ba15-26a312b5d82d
                stepCounter: 408889f4-50b9-484f-b8c9-4abd4e415863
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 681104d0-aa4f-408a-8c0f-688854c34ec6
          stepCounter: 5d4fef26-c744-4424-aaca-e67fdfd9eeeb
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: TERM_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ce155af-19fc-49d2-b497-c5dcc0579752
          stepCounter: 5d4fef26-c744-4424-aaca-e67fdfd9eeeb
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: LAST_UPDT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 00f10074-3016-4f4c-93c3-48eab2f3f39b
          stepCounter: 5d4fef26-c744-4424-aaca-e67fdfd9eeeb
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ACCT_GROUP_CODE
        name: ACCT_GROUP_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3fe9fa55-4a8b-445a-93b9-41cfc5bb681b
          stepCounter: 5d4fef26-c744-4424-aaca-e67fdfd9eeeb
        config: {}
        dataType: VARCHAR(16)
        defaultValue: ""
        description: ""
        name: FUNCTIONAL_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5fe93869-ec43-4331-ad7c-5d8c9d4fda65
                stepCounter: 408889f4-50b9-484f-b8c9-4abd4e415863
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 809e3989-4156-4cf2-8f97-b72c04d2742d
          stepCounter: 5d4fef26-c744-4424-aaca-e67fdfd9eeeb
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: FUNCTIONAL_AREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b04d2b4d-12c4-487d-9c2f-e05dd85350f9
                stepCounter: 43c13db8-7f40-4ec6-b4cb-fb85c4f1f157
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ODS_SAP_SKA1: 408889f4-50b9-484f-b8c9-4abd4e415863
          ODS_SAP_SKAT: 0916925b-ab25-46b1-ba79-1612daedec0e
          ODS_SAP_TFKBT: 43c13db8-7f40-4ec6-b4cb-fb85c4f1f157
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: ODS_SAP_SKAT
          - locationName: TARGET
            nodeName: ODS_SAP_SKA1
          - locationName: TARGET
            nodeName: ODS_SAP_TFKBT
        join:
          joinCondition: |-
            FROM (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_SKA1') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) ODS_SAP_SKA1
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_SKAT') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                       AND SPRAS = 'E'
                   ) ODS_SAP_SKAT
                ON ODS_SAP_SKA1.SAKNR = ODS_SAP_SKAT.SAKNR
               AND ODS_SAP_SKA1.KTOPL = ODS_SAP_SKAT.KTOPL
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_TFKBT') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                       AND SPRAS = 'E'
                   ) ODS_SAP_TFKBT
                ON ODS_SAP_SKA1.FUNC_AREA = ODS_SAP_TFKBT.FKBER
             WHERE ODS_SAP_SKA1.KTOPL = 'ZVET'
        name: STAGE_FIN_SAP_GL_ACCOUNT
        noLinkRefs: []
  name: STAGE_FIN_SAP_GL_ACCOUNT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
