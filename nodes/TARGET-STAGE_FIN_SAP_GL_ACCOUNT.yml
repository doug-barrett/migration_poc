fileVersion: 1
id: dbd904e0-3b71-46d0-958b-a8de0bcf3626
name: STAGE_FIN_SAP_GL_ACCOUNT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 62b0e35c-983f-4f41-86c3-011250a5543c
          stepCounter: dbd904e0-3b71-46d0-958b-a8de0bcf3626
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ACCT_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d5332a2-159e-47cf-a4a3-e4a3dbf99efb
                stepCounter: 7f75087a-1b98-4094-93f8-7ddb6e8e93ee
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4835c63-701a-4ae2-a709-fb54b8aed326
          stepCounter: dbd904e0-3b71-46d0-958b-a8de0bcf3626
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: MAJOR_ACCT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e345ba2e-4ad9-4375-9e39-b5672b47bc39
                stepCounter: 5052a2dc-0fed-47c2-a5ee-e75b532ad991
            transform: LTRIM(ODS_SAP_SKA1.SAKNR,'0')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d1f33040-557b-42ec-ae64-4923d90fc097
          stepCounter: dbd904e0-3b71-46d0-958b-a8de0bcf3626
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: MINOR_ACCT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78ce30bd-4076-4c11-9667-ff8e7c706a37
          stepCounter: dbd904e0-3b71-46d0-958b-a8de0bcf3626
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: ACCOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e345ba2e-4ad9-4375-9e39-b5672b47bc39
                stepCounter: 5052a2dc-0fed-47c2-a5ee-e75b532ad991
            transform: LTRIM(ODS_SAP_SKA1.SAKNR,'0')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7b029b4-b6b3-415c-a06a-b03b42813161
          stepCounter: dbd904e0-3b71-46d0-958b-a8de0bcf3626
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: The first element of the destination system code value.
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a8627b8-5e67-41dd-be7c-3b609064bb36
          stepCounter: dbd904e0-3b71-46d0-958b-a8de0bcf3626
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Indicates amounts are gross or net.
        name: GROSS_OR_NET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b35bb6b-f124-49bb-be5e-1d3428dd0da4
          stepCounter: dbd904e0-3b71-46d0-958b-a8de0bcf3626
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: The major account to which our share is posted.
        name: NET_MAJOR_ACCT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2cd442e9-d50b-443e-964a-445a04e25ae3
          stepCounter: dbd904e0-3b71-46d0-958b-a8de0bcf3626
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PROD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66c49920-04bc-469c-b368-46774699ef99
          stepCounter: dbd904e0-3b71-46d0-958b-a8de0bcf3626
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f6d07b7-927e-43d6-9ddf-6d5ab42cc5c0
          stepCounter: dbd904e0-3b71-46d0-958b-a8de0bcf3626
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: CURR_CONVERSION_RULE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96bcd13c-4304-4529-b603-b3cfe4534dcf
          stepCounter: dbd904e0-3b71-46d0-958b-a8de0bcf3626
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: AFE_REQD_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e257240-e834-48f0-9489-ba26aca55c48
          stepCounter: dbd904e0-3b71-46d0-958b-a8de0bcf3626
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: CC_REQD_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 354f28c9-b06b-42e6-9fb7-124ff53a6e50
          stepCounter: dbd904e0-3b71-46d0-958b-a8de0bcf3626
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: VOL_REQD_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dcb5ec9d-a8c1-4bcf-a4dc-ab68af048bcd
          stepCounter: dbd904e0-3b71-46d0-958b-a8de0bcf3626
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: ACTVY_DATE_REQD_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 504cf450-64ea-4a95-acae-ae83d75164ac
          stepCounter: dbd904e0-3b71-46d0-958b-a8de0bcf3626
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: CTRL_ACCT_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22f4693a-6433-4e08-8ec0-3e3f0579af75
          stepCounter: dbd904e0-3b71-46d0-958b-a8de0bcf3626
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4f574c73-001a-4405-a25f-00a83f5341eb
                stepCounter: 5052a2dc-0fed-47c2-a5ee-e75b532ad991
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7206be6-8b6c-42d9-a2fc-de22a9530638
          stepCounter: dbd904e0-3b71-46d0-958b-a8de0bcf3626
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: TERM_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24004380-8ce6-42f5-9fcf-50284546686a
          stepCounter: dbd904e0-3b71-46d0-958b-a8de0bcf3626
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: LAST_UPDT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6d1bf0b-a4ad-445c-9439-463a9923151e
          stepCounter: dbd904e0-3b71-46d0-958b-a8de0bcf3626
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ACCT_GROUP_CODE
        name: ACCT_GROUP_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 025a46e4-8cf7-4cf1-b009-a18fd543aa08
          stepCounter: dbd904e0-3b71-46d0-958b-a8de0bcf3626
        config: {}
        dataType: VARCHAR(16)
        defaultValue: ""
        description: ""
        name: FUNCTIONAL_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 690b40c0-f8ec-485f-9cc2-11b851412a2a
                stepCounter: 5052a2dc-0fed-47c2-a5ee-e75b532ad991
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c21f62c-a313-487e-871d-30bdf9c406bc
          stepCounter: dbd904e0-3b71-46d0-958b-a8de0bcf3626
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: FUNCTIONAL_AREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f862aee-a2e0-462c-be94-281d06d5a42e
                stepCounter: deacf6ea-f8a6-4783-88a5-38cfcabbf1d3
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ODS_SAP_SKA1: 5052a2dc-0fed-47c2-a5ee-e75b532ad991
          ODS_SAP_SKAT: 7f75087a-1b98-4094-93f8-7ddb6e8e93ee
          ODS_SAP_TFKBT: deacf6ea-f8a6-4783-88a5-38cfcabbf1d3
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: ODS_SAP_SKAT
          - locationName: TARGET
            nodeName: ODS_SAP_SKA1
          - locationName: TARGET
            nodeName: ODS_SAP_TFKBT
        join:
          joinCondition: |-
            FROM (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_SKA1') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) ODS_SAP_SKA1
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_SKAT') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                       AND SPRAS = 'E'
                   ) ODS_SAP_SKAT
                ON ODS_SAP_SKA1.SAKNR = ODS_SAP_SKAT.SAKNR
               AND ODS_SAP_SKA1.KTOPL = ODS_SAP_SKAT.KTOPL
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_TFKBT') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                       AND SPRAS = 'E'
                   ) ODS_SAP_TFKBT
                ON ODS_SAP_SKA1.FUNC_AREA = ODS_SAP_TFKBT.FKBER
             WHERE ODS_SAP_SKA1.KTOPL = 'ZVET'
        name: STAGE_FIN_SAP_GL_ACCOUNT
        noLinkRefs: []
  name: STAGE_FIN_SAP_GL_ACCOUNT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
