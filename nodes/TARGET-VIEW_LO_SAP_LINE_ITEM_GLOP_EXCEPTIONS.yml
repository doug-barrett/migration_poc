fileVersion: 1
id: be59c73c-dc5a-40c3-889b-9ca9928e62b6
name: VIEW_LO_SAP_LINE_ITEM_GLOP_EXCEPTIONS
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 30b7a56d-1aee-4993-b7cd-e1b60617505d
          stepCounter: be59c73c-dc5a-40c3-889b-9ca9928e62b6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        isSurrogateKey: true
        name: DIM_LINE_ITEM_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ebb273a7-5c02-468d-b30d-1750c783e9d8
                stepCounter: a12e113e-c1e1-48ab-9f81-fdc5cfa0e26c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d37bafea-a950-4ce8-bc93-56774f53d7f2
          stepCounter: be59c73c-dc5a-40c3-889b-9ca9928e62b6
        config: {}
        dataType: VARCHAR(38)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: LI_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 20bced6a-9d3d-4607-9f72-4667589e8d47
                stepCounter: d0ab4a94-a909-487b-8651-345f5baff59d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97224fb6-3561-4de2-97b8-00a47f9f8dfa
          stepCounter: be59c73c-dc5a-40c3-889b-9ca9928e62b6
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: ACTVY_PER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9408314a-ddfe-4a17-82bd-51a2553ccd2a
                stepCounter: a12e113e-c1e1-48ab-9f81-fdc5cfa0e26c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74537f4a-3a73-4500-8bd7-e43b5877da15
          stepCounter: be59c73c-dc5a-40c3-889b-9ca9928e62b6
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: ACCT_PER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 974be20d-c8aa-4471-aac3-e739b3e1ef68
                stepCounter: a12e113e-c1e1-48ab-9f81-fdc5cfa0e26c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77874fde-7773-43a1-862b-72aceadb12e5
          stepCounter: be59c73c-dc5a-40c3-889b-9ca9928e62b6
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: DOCUMENT_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a9c43d6-d848-4e4d-9414-c4128cb1634d
                stepCounter: d0ab4a94-a909-487b-8651-345f5baff59d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 077fc36f-fbf9-4bf6-92cf-ccd6686f27ff
          stepCounter: be59c73c-dc5a-40c3-889b-9ca9928e62b6
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: DOCUMENT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5bae0c2f-579b-43f0-abcb-0fcaf6ad8b0c
                stepCounter: d0ab4a94-a909-487b-8651-345f5baff59d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74d8a7d6-7f78-4cc5-9392-d7f48d6e8567
          stepCounter: be59c73c-dc5a-40c3-889b-9ca9928e62b6
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DOCUMENT_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c887d176-538d-4156-ab5d-abd00b092d6a
                stepCounter: d0ab4a94-a909-487b-8651-345f5baff59d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea2269c2-43ba-40d7-9aee-3b595c1113c3
          stepCounter: be59c73c-dc5a-40c3-889b-9ca9928e62b6
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DOCUMENT_LINE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 620fb53e-1f84-4ee2-9dee-f2b853f771c5
                stepCounter: d0ab4a94-a909-487b-8651-345f5baff59d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 961ea607-2b7a-484a-959d-a35a8cf48526
          stepCounter: be59c73c-dc5a-40c3-889b-9ca9928e62b6
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: DEST_ORG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3efbc208-230b-479f-bc42-dbea0a40cd5e
                stepCounter: d0ab4a94-a909-487b-8651-345f5baff59d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c397434-dc4f-4aa9-bfa3-4ec0f2995c9a
          stepCounter: be59c73c-dc5a-40c3-889b-9ca9928e62b6
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: DEST_ORG_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 794a0ef2-fe83-4eb5-a8c9-235cd725b412
                stepCounter: d0ab4a94-a909-487b-8651-345f5baff59d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45d92da6-8ef3-4de5-874b-14e055b7dd96
          stepCounter: be59c73c-dc5a-40c3-889b-9ca9928e62b6
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: The name or description of the entity.
        name: CC_COUNTRY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 056a7ce0-cfc1-48b9-a5fc-02a0fe107682
                stepCounter: 2cca214d-2f7a-400c-a483-58b288ed6097
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 36c7d206-ab81-4149-90a3-6f88849b0c15
          stepCounter: be59c73c-dc5a-40c3-889b-9ca9928e62b6
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: The name or description of the entity.
        name: CC_PROV_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7c08b94-a01d-4313-a313-3f96d8c0798f
                stepCounter: 2cca214d-2f7a-400c-a483-58b288ed6097
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7698c8d1-27a6-4c5b-b7ab-ae91919380a4
          stepCounter: be59c73c-dc5a-40c3-889b-9ca9928e62b6
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: The name or description of the entity.
        name: CC_COREAREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 619126d9-0cd3-45df-bfbd-2f5dca6da0bd
                stepCounter: 2cca214d-2f7a-400c-a483-58b288ed6097
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb8e4a34-c85b-4e35-9aec-64ea294a190c
          stepCounter: be59c73c-dc5a-40c3-889b-9ca9928e62b6
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: The name or description of the entity.
        name: CC_AREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec8da7e4-2ee4-4296-8f0a-7c334356d71e
                stepCounter: 2cca214d-2f7a-400c-a483-58b288ed6097
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c6087a8-e366-466d-9171-4fd53cd57060
          stepCounter: be59c73c-dc5a-40c3-889b-9ca9928e62b6
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: CC_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f423b95-97ef-4fa8-b931-4afdbec33830
                stepCounter: 99b4a618-454e-46de-874d-ad30b4d42108
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1bbbf6f6-e458-4f61-9caa-3f9c67138600
          stepCounter: be59c73c-dc5a-40c3-889b-9ca9928e62b6
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 29722a03-29be-40ea-86d4-b02403f924a2
                stepCounter: 99b4a618-454e-46de-874d-ad30b4d42108
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 290f8ab5-f820-4494-9737-acfb5dcd7641
          stepCounter: be59c73c-dc5a-40c3-889b-9ca9928e62b6
        config: {}
        dataType: VARCHAR(16)
        defaultValue: ""
        description: ""
        name: FUNCTIONAL_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6aec42a-cc9f-4160-86cc-70e845b3d74b
                stepCounter: d0ab4a94-a909-487b-8651-345f5baff59d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 73ea7a2a-4a69-4c3e-90fd-09b37556e2a9
          stepCounter: be59c73c-dc5a-40c3-889b-9ca9928e62b6
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: FUNCTIONAL_AREA_NAME
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 36e37b34-d3d1-4ee7-b8ca-ef6c5e47de38
                stepCounter: d0ab4a94-a909-487b-8651-345f5baff59d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa84e551-b3ef-4b58-a829-7ff52ebdbacb
          stepCounter: be59c73c-dc5a-40c3-889b-9ca9928e62b6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ACCOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 70a930d3-1c03-4f2d-8070-e63de745db51
                stepCounter: d0ab4a94-a909-487b-8651-345f5baff59d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7138492-cc3e-4cf3-ac82-9f6e7246dbd4
          stepCounter: be59c73c-dc5a-40c3-889b-9ca9928e62b6
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ACCOUNT_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2237daf0-4078-468f-a937-1b6f0113f180
                stepCounter: eded27ac-fd68-4b41-8110-94b692c365d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a4b5c61-39be-440a-b657-ce100172c75e
          stepCounter: be59c73c-dc5a-40c3-889b-9ca9928e62b6
        config: {}
        dataType: VARCHAR(16)
        defaultValue: ""
        description: ""
        name: LI_CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2b6a0906-a7a4-4721-8767-96ac6c3b7b4c
                stepCounter: d0ab4a94-a909-487b-8651-345f5baff59d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 56e6dd5a-7c78-4dd5-80ab-578d659d019a
          stepCounter: be59c73c-dc5a-40c3-889b-9ca9928e62b6
        config: {}
        dataType: VARCHAR(24)
        defaultValue: ""
        description: ""
        name: AFE_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 68d592c4-3b2d-4271-a98c-e316452e8c97
                stepCounter: d0ab4a94-a909-487b-8651-345f5baff59d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f3028dfc-d023-459d-8816-49aced4aa634
          stepCounter: be59c73c-dc5a-40c3-889b-9ca9928e62b6
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: AFE_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe5e0b24-3c8e-4ddf-a3f1-3e9faead87ed
                stepCounter: f1879670-70ca-4133-bc5d-193fd6cd9104
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bda8aef8-2ada-449d-aeed-c5551f89e380
          stepCounter: be59c73c-dc5a-40c3-889b-9ca9928e62b6
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: Description for the code.
        name: AFE_TYPE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 25bfe9a8-74d3-4767-9717-c5569c90a7fd
                stepCounter: f1879670-70ca-4133-bc5d-193fd6cd9104
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b50e6fc2-93d9-48ec-9a02-8831daea594a
          stepCounter: be59c73c-dc5a-40c3-889b-9ca9928e62b6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: AFE_FUNCTIONAL_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19a0e24b-4a46-42e5-ba90-51815308086a
                stepCounter: d0ab4a94-a909-487b-8651-345f5baff59d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce8f5e97-43a7-401b-88ac-834481940365
          stepCounter: be59c73c-dc5a-40c3-889b-9ca9928e62b6
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: AFE_FUNCTIONAL_AREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 573421b9-d24f-4bd7-be13-630903479137
                stepCounter: d0ab4a94-a909-487b-8651-345f5baff59d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4728f543-7ed9-46e4-a805-890ff1c1606d
          stepCounter: be59c73c-dc5a-40c3-889b-9ca9928e62b6
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: AFE_CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 89cfa699-7f0d-4ceb-8359-934345c49e2a
                stepCounter: d0ab4a94-a909-487b-8651-345f5baff59d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26106746-c284-4054-b94b-1934f660c5eb
          stepCounter: be59c73c-dc5a-40c3-889b-9ca9928e62b6
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: AFE_CC_FUNCTIONAL_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 731f12c8-98c0-43ac-9c1c-08b9df6d320c
                stepCounter: d0ab4a94-a909-487b-8651-345f5baff59d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e5e2a6b-9493-40d0-9e76-cb4ea36d6f59
          stepCounter: be59c73c-dc5a-40c3-889b-9ca9928e62b6
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: AFE_CC_FUNCTIONAL_AREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f61d4bfe-cf50-41b8-b050-6af3af450131
                stepCounter: d0ab4a94-a909-487b-8651-345f5baff59d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79a53e98-380b-4746-bf49-99fb2f408136
          stepCounter: be59c73c-dc5a-40c3-889b-9ca9928e62b6
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: Lease Ops Line Number
        name: UNMAPPED_LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1114a530-83e9-4ceb-81b7-2e1033819f5e
                stepCounter: d0ab4a94-a909-487b-8651-345f5baff59d
            transform: NVL(DIM_LO_SAP_LINE_ITEM.LINE_NO,'Unknown')
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          FACT_LO_SAP_ACTUALS: a12e113e-c1e1-48ab-9f81-fdc5cfa0e26c
          DIM_LO_SAP_LINE_ITEM: d0ab4a94-a909-487b-8651-345f5baff59d
          DIM_LO_SAP_AFE_TYPE: f1879670-70ca-4133-bc5d-193fd6cd9104
          DIM_LO_SAP_GL_ACCOUNT: eded27ac-fd68-4b41-8110-94b692c365d5
          DIM_LO_SAP_COST_CENTER: 99b4a618-454e-46de-874d-ad30b4d42108
          DIM_LO_SAP_CC_CORP_HIER_CURRENT: 2cca214d-2f7a-400c-a483-58b288ed6097
          DIM_LO_SAP_LEASE_OPS_HIER: e0b535c4-f94e-4ac1-b685-dfdff6293176
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: FACT_LO_SAP_ACTUALS
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LINE_ITEM
          - locationName: TARGET
            nodeName: DIM_LO_SAP_AFE_TYPE
          - locationName: TARGET
            nodeName: DIM_LO_SAP_GL_ACCOUNT
          - locationName: TARGET
            nodeName: DIM_LO_SAP_COST_CENTER
          - locationName: TARGET
            nodeName: DIM_LO_SAP_CC_CORP_HIER_CURRENT
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_HIER
        join:
          joinCondition: |-
            FROM {{ ref('TARGET','FACT_LO_SAP_ACTUALS') }} FACT_LO_SAP_ACTUALS
              JOIN {{ ref('TARGET','DIM_LO_SAP_LINE_ITEM') }} DIM_LO_SAP_LINE_ITEM
                ON FACT_LO_SAP_ACTUALS.DIM_LINE_ITEM_KEY = DIM_LO_SAP_LINE_ITEM.DIM_LINE_ITEM_KEY
              JOIN {{ ref('TARGET','DIM_LO_SAP_AFE_TYPE') }} DIM_LO_SAP_AFE_TYPE
                ON FACT_LO_SAP_ACTUALS.DIM_AFE_TYPE_KEY = DIM_LO_SAP_AFE_TYPE.DIM_AFE_TYPE_KEY
              JOIN {{ ref('TARGET','DIM_LO_SAP_GL_ACCOUNT') }} DIM_LO_SAP_GL_ACCOUNT
                ON FACT_LO_SAP_ACTUALS.DIM_GL_ACCOUNT_KEY = DIM_LO_SAP_GL_ACCOUNT.DIM_GL_ACCOUNT_KEY
              JOIN {{ ref('TARGET','DIM_LO_SAP_COST_CENTER') }} DIM_LO_SAP_COST_CENTER
                ON FACT_LO_SAP_ACTUALS.DIM_COST_CENTER_KEY = DIM_LO_SAP_COST_CENTER.DIM_COST_CENTER_KEY
              JOIN {{ ref('TARGET','DIM_LO_SAP_CC_CORP_HIER_CURRENT') }} DIM_LO_SAP_CC_CORP_HIER_CURRENT
                ON DIM_LO_SAP_COST_CENTER.DIM_CC_CORP_HIER_CURRENT_KEY = DIM_LO_SAP_CC_CORP_HIER_CURRENT.DIM_CC_CORP_HIER_CURRENT_KEY
              JOIN {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_HIER') }} DIM_LO_SAP_LEASE_OPS_HIER
                ON DIM_LO_SAP_LINE_ITEM.LINE_NO = DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO
             WHERE DIM_LO_SAP_LINE_ITEM.DIM_LINE_ITEM_KEY <> 0
               AND FACT_LO_SAP_ACTUALS.GROSS_OR_NET_CODE = 'N'
               AND DIM_LO_SAP_LINE_ITEM.POSTING_DATE >= 2024
               AND (DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO_GROUP = '199' OR DIM_LO_SAP_LINE_ITEM.LINE_NO IS NULL)
               AND TO_NUMBER(DIM_LO_SAP_LINE_ITEM.ACCOUNT) >= 400000
               AND TO_NUMBER(DIM_LO_SAP_LINE_ITEM.ACCOUNT) NOT IN (791000)
               AND COALESCE(DIM_LO_SAP_LINE_ITEM.FUNCTIONAL_AREA ,DIM_LO_SAP_LINE_ITEM.AFE_FUNCTIONAL_AREA ,DIM_LO_SAP_LINE_ITEM.AFE_CC_FUNCTIONAL_AREA) <= 'Z012'
        name: VIEW_LO_SAP_LINE_ITEM_GLOP_EXCEPTIONS
        noLinkRefs: []
  name: VIEW_LO_SAP_LINE_ITEM_GLOP_EXCEPTIONS
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
