fileVersion: 1
id: 2f03c453-dc4b-49fe-98a4-307f350f3dba
name: VIEW_LO_SAP_LINE_ITEM_GLOP_EXCEPTIONS
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb9138a5-0cb5-43e7-826b-91fea40c74cc
          stepCounter: 2f03c453-dc4b-49fe-98a4-307f350f3dba
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        isSurrogateKey: true
        name: DIM_LINE_ITEM_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2c13a4d-b6db-4c98-84ae-cd143e998b05
                stepCounter: d5af52cd-460f-4473-aea6-9d6cb06937f3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6eb746c-751c-49bb-99ad-e588e8e291ba
          stepCounter: 2f03c453-dc4b-49fe-98a4-307f350f3dba
        config: {}
        dataType: VARCHAR(38)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: LI_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a9a963b-7a13-4e46-a176-459cb2ee6f56
                stepCounter: 6d556ec5-1a14-4fec-b7c2-d8beb2ab5abd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 317e84a5-c562-4270-91f4-3140a7469144
          stepCounter: 2f03c453-dc4b-49fe-98a4-307f350f3dba
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: ACTVY_PER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1129d1bc-1d95-4e82-b471-66ac59f89bea
                stepCounter: d5af52cd-460f-4473-aea6-9d6cb06937f3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fba9f2d4-e595-455c-b671-d97d54fd64d9
          stepCounter: 2f03c453-dc4b-49fe-98a4-307f350f3dba
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: ACCT_PER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 356fbd63-7be8-4882-b80d-78f1c5d11c38
                stepCounter: d5af52cd-460f-4473-aea6-9d6cb06937f3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 059e1b18-41c9-4a66-9e45-ca1d767e4833
          stepCounter: 2f03c453-dc4b-49fe-98a4-307f350f3dba
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: DOCUMENT_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f0e6eab-a842-4bd1-819a-df40ab746264
                stepCounter: 6d556ec5-1a14-4fec-b7c2-d8beb2ab5abd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1fd59cf2-8506-4a4d-a2f2-4f00f652ed98
          stepCounter: 2f03c453-dc4b-49fe-98a4-307f350f3dba
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: DOCUMENT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 693e9dab-c194-45b6-8c68-6185d6923f65
                stepCounter: 6d556ec5-1a14-4fec-b7c2-d8beb2ab5abd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3fffb41a-1ede-4d54-81da-76616e1af82b
          stepCounter: 2f03c453-dc4b-49fe-98a4-307f350f3dba
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DOCUMENT_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5fdd90c3-017c-430d-b8ef-f931c9571711
                stepCounter: 6d556ec5-1a14-4fec-b7c2-d8beb2ab5abd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 19e3fcab-fe0b-468b-82ca-5af02f1e8e7f
          stepCounter: 2f03c453-dc4b-49fe-98a4-307f350f3dba
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DOCUMENT_LINE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e0d27dba-6c11-466a-9baf-b7081bc2129f
                stepCounter: 6d556ec5-1a14-4fec-b7c2-d8beb2ab5abd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2dcc6988-9325-4c77-bdff-1d59cde3e448
          stepCounter: 2f03c453-dc4b-49fe-98a4-307f350f3dba
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: DEST_ORG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b94cd3fa-dfd2-43ba-8bec-81581b3c8f92
                stepCounter: 6d556ec5-1a14-4fec-b7c2-d8beb2ab5abd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1668d118-4a01-49d8-9403-8935f3d55715
          stepCounter: 2f03c453-dc4b-49fe-98a4-307f350f3dba
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: DEST_ORG_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ced111c7-ce4d-4aa8-af8a-c0e8e3e43045
                stepCounter: 6d556ec5-1a14-4fec-b7c2-d8beb2ab5abd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac3ceb8a-f52d-4bf2-a8d7-977691f9db9c
          stepCounter: 2f03c453-dc4b-49fe-98a4-307f350f3dba
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: The name or description of the entity.
        name: CC_COUNTRY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 34f21eb2-2aac-4baf-8b65-fbfb11a87c41
                stepCounter: 067903b4-15b6-458b-abc2-85946f5a3432
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6dda6813-6d8f-4faa-9eba-ae7bbb8f271d
          stepCounter: 2f03c453-dc4b-49fe-98a4-307f350f3dba
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: The name or description of the entity.
        name: CC_PROV_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 569e12e0-57e2-4ab0-b1e9-fada992660c6
                stepCounter: 067903b4-15b6-458b-abc2-85946f5a3432
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 427991d9-d3a3-45e6-82c3-e927bf673929
          stepCounter: 2f03c453-dc4b-49fe-98a4-307f350f3dba
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: The name or description of the entity.
        name: CC_COREAREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c8d8af15-264c-40af-8b0b-4dce3b18ed31
                stepCounter: 067903b4-15b6-458b-abc2-85946f5a3432
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c84a9c4b-423a-4f81-8052-7f3effb56274
          stepCounter: 2f03c453-dc4b-49fe-98a4-307f350f3dba
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: The name or description of the entity.
        name: CC_AREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a489a103-50e2-4347-8d34-6965b140eea8
                stepCounter: 067903b4-15b6-458b-abc2-85946f5a3432
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 372b9df1-9ad1-4eb9-a4ee-f504f47d83fe
          stepCounter: 2f03c453-dc4b-49fe-98a4-307f350f3dba
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: CC_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c15405c6-ad65-4525-9a28-c675167e0664
                stepCounter: f601baef-839f-49ab-b102-ee3fad93f21c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ccfa0a4f-d27d-4390-b98d-d15f133a2787
          stepCounter: 2f03c453-dc4b-49fe-98a4-307f350f3dba
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d28aa41c-a9a8-4fe7-be64-2f4058706ecd
                stepCounter: f601baef-839f-49ab-b102-ee3fad93f21c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5251c5c9-3750-432c-9815-cf2ee8910a8f
          stepCounter: 2f03c453-dc4b-49fe-98a4-307f350f3dba
        config: {}
        dataType: VARCHAR(16)
        defaultValue: ""
        description: ""
        name: FUNCTIONAL_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3f7b2e6f-36dc-480e-bee0-5d6a1b4ba3f1
                stepCounter: 6d556ec5-1a14-4fec-b7c2-d8beb2ab5abd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eddfcbf7-45ce-4dc7-848c-4cb335289c77
          stepCounter: 2f03c453-dc4b-49fe-98a4-307f350f3dba
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: FUNCTIONAL_AREA_NAME
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3ea3be81-6969-4a42-a0c2-cd9e12bc98d1
                stepCounter: 6d556ec5-1a14-4fec-b7c2-d8beb2ab5abd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a86db92c-fd25-4a74-aa89-d762aee34bc5
          stepCounter: 2f03c453-dc4b-49fe-98a4-307f350f3dba
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ACCOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c6851ad0-02fb-43f1-9e58-1c3653d1f032
                stepCounter: 6d556ec5-1a14-4fec-b7c2-d8beb2ab5abd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc01c1b2-144a-4185-9208-06d6c242d5c6
          stepCounter: 2f03c453-dc4b-49fe-98a4-307f350f3dba
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ACCOUNT_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3361fee1-f29a-425f-bfa8-2b6f6b054891
                stepCounter: 435a18b2-1dc7-4fc8-b5d0-3eab3af614fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 89d9410f-3049-4570-b94e-920e87e8c5ca
          stepCounter: 2f03c453-dc4b-49fe-98a4-307f350f3dba
        config: {}
        dataType: VARCHAR(16)
        defaultValue: ""
        description: ""
        name: LI_CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24cef670-673d-4d1c-8d63-4d4df920885f
                stepCounter: 6d556ec5-1a14-4fec-b7c2-d8beb2ab5abd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2da10789-6d53-425a-a053-31ef81ba8b40
          stepCounter: 2f03c453-dc4b-49fe-98a4-307f350f3dba
        config: {}
        dataType: VARCHAR(24)
        defaultValue: ""
        description: ""
        name: AFE_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7f30fb4-847a-4e08-bfee-e92a31e400a4
                stepCounter: 6d556ec5-1a14-4fec-b7c2-d8beb2ab5abd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9cdb49da-72c0-424f-af44-675d090ee1b0
          stepCounter: 2f03c453-dc4b-49fe-98a4-307f350f3dba
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: AFE_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 15dded3e-20ac-4399-9582-0cd9a37c7604
                stepCounter: f93a8e45-7804-49aa-b6a3-966e768997dc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f855fd6-bd23-4703-9700-980c8ac5653c
          stepCounter: 2f03c453-dc4b-49fe-98a4-307f350f3dba
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: Description for the code.
        name: AFE_TYPE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67785ce3-e522-42ca-b754-609d323237b2
                stepCounter: f93a8e45-7804-49aa-b6a3-966e768997dc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb6e3bcf-aeb1-4afb-8752-e62299fe4a73
          stepCounter: 2f03c453-dc4b-49fe-98a4-307f350f3dba
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: AFE_FUNCTIONAL_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9cf4646f-028e-47cf-8138-eb39158d1991
                stepCounter: 6d556ec5-1a14-4fec-b7c2-d8beb2ab5abd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1fd84e8a-ea0d-4253-b32e-dd744bb4c5cc
          stepCounter: 2f03c453-dc4b-49fe-98a4-307f350f3dba
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: AFE_FUNCTIONAL_AREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f2769010-fd6c-4b4d-9518-75a4678c5058
                stepCounter: 6d556ec5-1a14-4fec-b7c2-d8beb2ab5abd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 117cce87-fb52-4b8e-ba6e-8c3d54f8d2c3
          stepCounter: 2f03c453-dc4b-49fe-98a4-307f350f3dba
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: AFE_CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5fbfad53-e520-42d7-83a8-a4aa3dbbd7f6
                stepCounter: 6d556ec5-1a14-4fec-b7c2-d8beb2ab5abd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a75b2e4-8df0-48ae-bc90-ccde53e3955e
          stepCounter: 2f03c453-dc4b-49fe-98a4-307f350f3dba
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: AFE_CC_FUNCTIONAL_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a689563a-f22a-4a00-b99d-4e4ba46b8c6e
                stepCounter: 6d556ec5-1a14-4fec-b7c2-d8beb2ab5abd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ccfc4ab-f470-4d25-9632-08a9d86bcac8
          stepCounter: 2f03c453-dc4b-49fe-98a4-307f350f3dba
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: AFE_CC_FUNCTIONAL_AREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dd473a93-dc64-4cae-b664-3426a73c8081
                stepCounter: 6d556ec5-1a14-4fec-b7c2-d8beb2ab5abd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 61db7f24-1aa4-407b-8cf2-bab24c1d2907
          stepCounter: 2f03c453-dc4b-49fe-98a4-307f350f3dba
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: Lease Ops Line Number
        name: UNMAPPED_LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2fd97d52-2ad7-4c88-ab60-95c5229a9aff
                stepCounter: 6d556ec5-1a14-4fec-b7c2-d8beb2ab5abd
            transform: NVL(DIM_LO_SAP_LINE_ITEM.LINE_NO,'Unknown')
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          FACT_LO_SAP_ACTUALS: d5af52cd-460f-4473-aea6-9d6cb06937f3
          DIM_LO_SAP_LINE_ITEM: 6d556ec5-1a14-4fec-b7c2-d8beb2ab5abd
          DIM_LO_SAP_AFE_TYPE: f93a8e45-7804-49aa-b6a3-966e768997dc
          DIM_LO_SAP_GL_ACCOUNT: 435a18b2-1dc7-4fc8-b5d0-3eab3af614fd
          DIM_LO_SAP_COST_CENTER: f601baef-839f-49ab-b102-ee3fad93f21c
          DIM_LO_SAP_CC_CORP_HIER_CURRENT: 067903b4-15b6-458b-abc2-85946f5a3432
          DIM_LO_SAP_LEASE_OPS_HIER: 82938641-7c51-4aff-ad3a-c7a56af30c01
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: FACT_LO_SAP_ACTUALS
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LINE_ITEM
          - locationName: TARGET
            nodeName: DIM_LO_SAP_AFE_TYPE
          - locationName: TARGET
            nodeName: DIM_LO_SAP_GL_ACCOUNT
          - locationName: TARGET
            nodeName: DIM_LO_SAP_COST_CENTER
          - locationName: TARGET
            nodeName: DIM_LO_SAP_CC_CORP_HIER_CURRENT
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_HIER
        join:
          joinCondition: |-
            FROM {{ ref('TARGET','FACT_LO_SAP_ACTUALS') }} FACT_LO_SAP_ACTUALS
              JOIN {{ ref('TARGET','DIM_LO_SAP_LINE_ITEM') }} DIM_LO_SAP_LINE_ITEM
                ON FACT_LO_SAP_ACTUALS.DIM_LINE_ITEM_KEY = DIM_LO_SAP_LINE_ITEM.DIM_LINE_ITEM_KEY
              JOIN {{ ref('TARGET','DIM_LO_SAP_AFE_TYPE') }} DIM_LO_SAP_AFE_TYPE
                ON FACT_LO_SAP_ACTUALS.DIM_AFE_TYPE_KEY = DIM_LO_SAP_AFE_TYPE.DIM_AFE_TYPE_KEY
              JOIN {{ ref('TARGET','DIM_LO_SAP_GL_ACCOUNT') }} DIM_LO_SAP_GL_ACCOUNT
                ON FACT_LO_SAP_ACTUALS.DIM_GL_ACCOUNT_KEY = DIM_LO_SAP_GL_ACCOUNT.DIM_GL_ACCOUNT_KEY
              JOIN {{ ref('TARGET','DIM_LO_SAP_COST_CENTER') }} DIM_LO_SAP_COST_CENTER
                ON FACT_LO_SAP_ACTUALS.DIM_COST_CENTER_KEY = DIM_LO_SAP_COST_CENTER.DIM_COST_CENTER_KEY
              JOIN {{ ref('TARGET','DIM_LO_SAP_CC_CORP_HIER_CURRENT') }} DIM_LO_SAP_CC_CORP_HIER_CURRENT
                ON DIM_LO_SAP_COST_CENTER.DIM_CC_CORP_HIER_CURRENT_KEY = DIM_LO_SAP_CC_CORP_HIER_CURRENT.DIM_CC_CORP_HIER_CURRENT_KEY
              JOIN {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_HIER') }} DIM_LO_SAP_LEASE_OPS_HIER
                ON DIM_LO_SAP_LINE_ITEM.LINE_NO = DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO
             WHERE DIM_LO_SAP_LINE_ITEM.DIM_LINE_ITEM_KEY <> 0
               AND FACT_LO_SAP_ACTUALS.GROSS_OR_NET_CODE = 'N'
               AND DIM_LO_SAP_LINE_ITEM.POSTING_DATE >= 2024
               AND (DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO_GROUP = '199' OR DIM_LO_SAP_LINE_ITEM.LINE_NO IS NULL)
               AND TO_NUMBER(DIM_LO_SAP_LINE_ITEM.ACCOUNT) >= 400000
               AND TO_NUMBER(DIM_LO_SAP_LINE_ITEM.ACCOUNT) NOT IN (791000)
               AND COALESCE(DIM_LO_SAP_LINE_ITEM.FUNCTIONAL_AREA ,DIM_LO_SAP_LINE_ITEM.AFE_FUNCTIONAL_AREA ,DIM_LO_SAP_LINE_ITEM.AFE_CC_FUNCTIONAL_AREA) <= 'Z012'
        name: VIEW_LO_SAP_LINE_ITEM_GLOP_EXCEPTIONS
        noLinkRefs: []
  name: VIEW_LO_SAP_LINE_ITEM_GLOP_EXCEPTIONS
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
