fileVersion: 1
id: 00dbd860-d0cb-4c4b-adda-302bf30fa639
name: OPC_SALESANDREVENUE_AGGREGATE
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: OMNIA_CONNECT_OPC
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9abe430-1362-4a48-8f57-a0f4eba31a33
          stepCounter: 00dbd860-d0cb-4c4b-adda-302bf30fa639
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f629191-cb2d-40ba-9047-8cab9f334238
                stepCounter: ce2fbe4f-2294-4e33-b4a6-ecdfb8e8d372
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11815e51-9dbf-4f71-b04b-fc01beb6a4ae
          stepCounter: 00dbd860-d0cb-4c4b-adda-302bf30fa639
        config: {}
        dataType: INT
        defaultValue: ""
        description: Unique identifier for an account. Commonly called the "Force Id"
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b70779a9-b736-4533-86c9-9df1b4bb7da0
                stepCounter: ce2fbe4f-2294-4e33-b4a6-ecdfb8e8d372
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f15504f-1edf-4627-aeed-4051173a84eb
          stepCounter: 00dbd860-d0cb-4c4b-adda-302bf30fa639
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ceb5222f-c090-4d17-aefe-e6bfea16857f
                stepCounter: ce2fbe4f-2294-4e33-b4a6-ecdfb8e8d372
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b45f64d-9a86-4022-891d-a44dbbd9217a
          stepCounter: 00dbd860-d0cb-4c4b-adda-302bf30fa639
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: TRANSACTIONDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07de4abb-4f2e-4797-a482-d63601bc76bc
                stepCounter: ce2fbe4f-2294-4e33-b4a6-ecdfb8e8d372
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 205cc0e6-a1b1-4f12-a30b-ed28ae2623ab
          stepCounter: 00dbd860-d0cb-4c4b-adda-302bf30fa639
        config: {}
        dataType: INT
        defaultValue: ""
        description: Transaction Year
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TRANSACTION_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07de4abb-4f2e-4797-a482-d63601bc76bc
                stepCounter: ce2fbe4f-2294-4e33-b4a6-ecdfb8e8d372
            transform: YEAR(OPC_SalesAndRevenue.TransactionDate)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81e412ce-59e3-4e91-947d-8f5056a6e715
          stepCounter: 00dbd860-d0cb-4c4b-adda-302bf30fa639
        config: {}
        dataType: INT
        defaultValue: ""
        description: Transaction Month
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TRANSACTION_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07de4abb-4f2e-4797-a482-d63601bc76bc
                stepCounter: ce2fbe4f-2294-4e33-b4a6-ecdfb8e8d372
            transform: MONTH(OPC_SalesAndRevenue.TransactionDate)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45b8a054-4ec2-4771-b6ca-3c1b5572bb48
          stepCounter: 00dbd860-d0cb-4c4b-adda-302bf30fa639
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ba138ee5-63ba-44ee-89b1-1ac7affe846b
                stepCounter: ce2fbe4f-2294-4e33-b4a6-ecdfb8e8d372
            transform: SUM(OPC_SalesAndRevenue.Sales)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d25b2e5f-ecac-44f3-9a6d-0e21308f594d
          stepCounter: 00dbd860-d0cb-4c4b-adda-302bf30fa639
        config: {}
        dataType: INT
        defaultValue: ""
        description: Supplier Count
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SUPPLIER_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ceb5222f-c090-4d17-aefe-e6bfea16857f
                stepCounter: ce2fbe4f-2294-4e33-b4a6-ecdfb8e8d372
            transform: COUNT(OPC_SalesAndRevenue.SupplierId)
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          OPC_SALESANDREVENUE: ce2fbe4f-2294-4e33-b4a6-ecdfb8e8d372
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: OMNIA_CONNECT_OPC
            nodeName: OPC_SALESANDREVENUE
        join:
          joinCondition: |-
            FROM {{ ref('OMNIA_CONNECT_OPC','OPC_SALESANDREVENUE') }} OPC_SalesAndRevenue
             GROUP BY OPC_SalesAndRevenue.Level1ForceId,
                      OPC_SalesAndRevenue.ForceId,
                      OPC_SalesAndRevenue.SupplierId,
                      OPC_SalesAndRevenue.TransactionDate
        name: OPC_SALESANDREVENUE_AGGREGATE
        noLinkRefs: []
  name: OPC_SALESANDREVENUE_AGGREGATE
  overrideSQL: false
  schema: ""
  sqlType: Fact
  type: sql
  version: 1
type: Node
