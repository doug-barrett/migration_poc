fileVersion: 1
id: 56f63873-f803-4a62-be59-8f5cc940a47a
name: VIEW_FIN_WBS_ELEMENTS
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7690817-ff8a-4b2f-9b23-fb56d2ba8537
          stepCounter: 56f63873-f803-4a62-be59-8f5cc940a47a
        config: {}
        dataType: VARCHAR(24)
        defaultValue: ""
        description: ""
        name: WBS_ELEMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d1d82d36-1c18-4ea0-ac08-1be6e06555bb
                stepCounter: 0ababbaf-41b3-4bd0-a251-c8aab7eb6948
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97f75458-a60f-478a-9243-fe436ec1093d
          stepCounter: 56f63873-f803-4a62-be59-8f5cc940a47a
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: WBS_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b76acb9-ba75-4dae-ae15-d7fe67212ab6
                stepCounter: 0ababbaf-41b3-4bd0-a251-c8aab7eb6948
            transform: TRANSLATE(DIM_LO_SAP_AFE.AFE_NAME, chr(10)||chr(13), '  ')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40cfb5b5-9a53-4fa4-b572-2cb89dfdfc0b
          stepCounter: 56f63873-f803-4a62-be59-8f5cc940a47a
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: WBS_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe5e0b24-3c8e-4ddf-a3f1-3e9faead87ed
                stepCounter: f1879670-70ca-4133-bc5d-193fd6cd9104
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d320ae1-3fc0-4dd4-a278-9e30dd969cdc
          stepCounter: 56f63873-f803-4a62-be59-8f5cc940a47a
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: WBS_TYPE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 25bfe9a8-74d3-4767-9717-c5569c90a7fd
                stepCounter: f1879670-70ca-4133-bc5d-193fd6cd9104
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e6be650-cfed-4e38-aa84-0666a97fed22
          stepCounter: 56f63873-f803-4a62-be59-8f5cc940a47a
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4dc4c0af-56f4-4672-be23-a1f1d92fe389
                stepCounter: 0ababbaf-41b3-4bd0-a251-c8aab7eb6948
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b166aac-e68c-4dc6-b6ed-aee4cecea8c6
          stepCounter: 56f63873-f803-4a62-be59-8f5cc940a47a
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: CORP_PLANNING_PROJECT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd124d53-314d-4f3f-b1c4-213d21addafe
                stepCounter: 0ababbaf-41b3-4bd0-a251-c8aab7eb6948
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 43c4adf4-756e-4680-9da8-be8b4a51fbe9
          stepCounter: 56f63873-f803-4a62-be59-8f5cc940a47a
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: ENTITY_UUID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f3dffd8-f0f0-46bc-a579-ac49a69808d8
                stepCounter: 8fb55a48-5325-4654-b350-dae61985104b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 965e3872-f930-45fd-9606-e11cf6d0b072
          stepCounter: 56f63873-f803-4a62-be59-8f5cc940a47a
        config: {}
        dataType: NUMBER(15,2)
        defaultValue: ""
        description: ""
        name: ALLOC_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33e0a66d-5704-4511-88d2-a03c210b3baf
                stepCounter: 0ababbaf-41b3-4bd0-a251-c8aab7eb6948
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb557ae0-1940-403a-9eb1-4ffc20c9ec98
          stepCounter: 56f63873-f803-4a62-be59-8f5cc940a47a
        config: {}
        dataType: NUMBER(15,2)
        defaultValue: ""
        description: ""
        name: OP_ALLOC_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6afd18f6-b306-40f6-8023-9edf7d50d8dc
                stepCounter: 0ababbaf-41b3-4bd0-a251-c8aab7eb6948
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7812e3a2-c008-4a1b-b68a-f8f142a384a9
          stepCounter: 56f63873-f803-4a62-be59-8f5cc940a47a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c19cda48-acaf-4f19-b587-7df33a71dd24
                stepCounter: 0ababbaf-41b3-4bd0-a251-c8aab7eb6948
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c35de737-ce82-40cc-82c0-b4e947186d91
          stepCounter: 56f63873-f803-4a62-be59-8f5cc940a47a
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a83ed0f0-6206-4ecc-9ae5-757673a5a871
                stepCounter: f1879670-70ca-4133-bc5d-193fd6cd9104
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de831d7f-faef-4314-b314-f558025a5a90
          stepCounter: 56f63873-f803-4a62-be59-8f5cc940a47a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: LINE_NO_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b325ab3d-926a-4d70-9b80-f86b9201596c
                stepCounter: f1879670-70ca-4133-bc5d-193fd6cd9104
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dac6f99c-9846-4932-b1a3-76f8c1668875
          stepCounter: 56f63873-f803-4a62-be59-8f5cc940a47a
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: COMPANY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a93c96c8-2d8e-450a-9ff8-5e447292e8e8
                stepCounter: 0ababbaf-41b3-4bd0-a251-c8aab7eb6948
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8126d7fb-dc76-4f82-a572-8fcbd2fd35bd
          stepCounter: 56f63873-f803-4a62-be59-8f5cc940a47a
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: COUNTRY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4be6bca3-bee7-4f89-90bd-4834062f282a
                stepCounter: 2cca214d-2f7a-400c-a483-58b288ed6097
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d353d3ff-658d-493a-8667-57586e977286
          stepCounter: 56f63873-f803-4a62-be59-8f5cc940a47a
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PROV_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a738a046-11b0-4082-a0f6-a86c56484c91
                stepCounter: 2cca214d-2f7a-400c-a483-58b288ed6097
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c93d8450-33ea-4c6a-bb1b-2fb668a5a11c
          stepCounter: 56f63873-f803-4a62-be59-8f5cc940a47a
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: ""
        name: COREAREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 619126d9-0cd3-45df-bfbd-2f5dca6da0bd
                stepCounter: 2cca214d-2f7a-400c-a483-58b288ed6097
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ebfb368-94d0-4538-9310-19fe4c1bef68
          stepCounter: 56f63873-f803-4a62-be59-8f5cc940a47a
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: ""
        name: AREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec8da7e4-2ee4-4296-8f0a-7c334356d71e
                stepCounter: 2cca214d-2f7a-400c-a483-58b288ed6097
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94b2b329-faf3-43e1-9fd6-12cb8f96ba97
          stepCounter: 56f63873-f803-4a62-be59-8f5cc940a47a
        config: {}
        dataType: VARCHAR(300)
        defaultValue: ""
        description: ""
        name: OPERATOR_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d57224cf-3acd-4744-a6ec-a049020f4eb3
                stepCounter: 99b4a618-454e-46de-874d-ad30b4d42108
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f2b9dff-8412-489d-9fbf-a6880542e3ee
          stepCounter: 56f63873-f803-4a62-be59-8f5cc940a47a
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7477933-8967-4b8d-8cb0-21769faeea34
                stepCounter: 0ababbaf-41b3-4bd0-a251-c8aab7eb6948
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 58b20728-5fb6-46aa-9eb5-f9521a37bc3e
          stepCounter: 56f63873-f803-4a62-be59-8f5cc940a47a
        config: {}
        dataType: NUMBER(9,6)
        defaultValue: ""
        description: ""
        name: VET_WI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39ad708b-466d-466e-bcc6-62d8c306c3e3
                stepCounter: 0ababbaf-41b3-4bd0-a251-c8aab7eb6948
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40f8070d-f1bc-4636-b03f-d0da1379eb56
          stepCounter: 56f63873-f803-4a62-be59-8f5cc940a47a
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: COST_CENTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d5262fea-e795-4fbf-aece-76b902f03e99
                stepCounter: 0ababbaf-41b3-4bd0-a251-c8aab7eb6948
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02b15f8f-30b8-4615-8c5a-dc0b63f47d11
          stepCounter: 56f63873-f803-4a62-be59-8f5cc940a47a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: SYSTEM_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 417ad309-0f95-4387-8921-7096c80fb725
                stepCounter: 0ababbaf-41b3-4bd0-a251-c8aab7eb6948
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f8d06ad-a129-45ec-b50d-e79f5fddc9d1
          stepCounter: 56f63873-f803-4a62-be59-8f5cc940a47a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: USER_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 293502be-0e73-44ba-9846-55c3ca16ae10
                stepCounter: 0ababbaf-41b3-4bd0-a251-c8aab7eb6948
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9c88359-47e4-45dc-b430-5cc873bf89d8
          stepCounter: 56f63873-f803-4a62-be59-8f5cc940a47a
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: PERSON_RESPONSIBLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 20308ef1-4633-4e07-a45d-ee3607d0bae3
                stepCounter: 0ababbaf-41b3-4bd0-a251-c8aab7eb6948
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_FIN_WBS_ELEMENTS: 56f63873-f803-4a62-be59-8f5cc940a47a
          DIM_LO_SAP_AFE: 0ababbaf-41b3-4bd0-a251-c8aab7eb6948
          DIM_LO_SAP_AFE_TYPE: f1879670-70ca-4133-bc5d-193fd6cd9104
          DIM_LO_SAP_COST_CENTER: 99b4a618-454e-46de-874d-ad30b4d42108
          DIM_LO_SAP_CC_CORP_HIER_CURRENT: 2cca214d-2f7a-400c-a483-58b288ed6097
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_FIN_WBS_ELEMENTS') }} AS SELECT DA.AFE_NUM WBS_ELEMENT,
                   TRANSLATE(DA.AFE_NAME,chr(10)||chr(13),'  ') WBS_DESC,
                   DAT.AFE_TYPE WBS_TYPE,
                   DAT.AFE_TYPE_DESC WBS_TYPE_DESC,
                   DA.AFE_CREATE_DATE CREATE_DATE,
                   NVL(DA.CORP_PLANNING_PROJECT,'{{ parameters.MOSAIC_CDM_UNBUDGETED_ENTITY_NAME }}') CORP_PLANNING_PROJECT,
                   NVL(ZMP.ENTITY_UUID,'{{ parameters.MOSAIC_CDM_UNBUDGETED_ENTITY_UUID }}') ENTITY_UUID,
                   DA.ALLOC_AMT,
                   DA.OP_ALLOC_AMT,
                   DA.OP_CURR_CODE,
                   DAT.LINE_NO,
                   DAT.LINE_NO_DESC,
                   DA.MANAGING_ORG_ID COMPANY_CODE,
                   DCCH.COUNTRY_CODE,
                   DCCH.PROV_CODE,
                   DCCH.COREAREA_NAME,
                   DCCH.AREA_NAME,
                   DCC.OPERATOR_NAME,
                   DA.UWI,
                   DA.VET_WBS_WI VET_WI,
                   DA.CC_NUM COST_CENTER,
                   DA.SYSTEM_STAT_CODES SYSTEM_STATUS,
                   DA.AFE_STAT_DESC USER_STATUS,
                   DA.ENGINEER_ASSIGNED PERSON_RESPONSIBLE
              FROM {{ ref('TARGET','DIM_LO_SAP_AFE') }} DA
              JOIN {{ ref('TARGET','DIM_LO_SAP_AFE_TYPE') }} DAT
                ON (DA.DIM_AFE_TYPE_KEY = DAT.DIM_AFE_TYPE_KEY)
              JOIN {{ ref('TARGET','DIM_LO_SAP_COST_CENTER') }} DCC
                ON (DA.CC_NUM = DCC.CC_NUM)
              JOIN {{ ref('TARGET','DIM_LO_SAP_CC_CORP_HIER_CURRENT') }} DCCH
                ON (DCC.DIM_CC_CORP_HIER_CURRENT_KEY = DCCH.DIM_CC_CORP_HIER_CURRENT_KEY)
              LEFT JOIN DS_SAP.ZCZFINMOSAICPRJ ZMP
                ON DA.CORP_PLANNING_PROJECT = ZMP.ZZMOSAIC_PRJ
             WHERE DA.DIM_AFE_KEY <> 0
        dependencies:
          - locationName: TARGET
            nodeName: DIM_LO_SAP_AFE
          - locationName: TARGET
            nodeName: DIM_LO_SAP_AFE_TYPE
          - locationName: TARGET
            nodeName: DIM_LO_SAP_COST_CENTER
          - locationName: TARGET
            nodeName: DIM_LO_SAP_CC_CORP_HIER_CURRENT
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','DIM_LO_SAP_AFE') }}
            {{ ref('TARGET','DIM_LO_SAP_AFE_TYPE') }}
            {{ ref('TARGET','DIM_LO_SAP_COST_CENTER') }}
            {{ ref('TARGET','DIM_LO_SAP_CC_CORP_HIER_CURRENT') }}
        name: VIEW_FIN_WBS_ELEMENTS
        noLinkRefs: []
  name: VIEW_FIN_WBS_ELEMENTS
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
