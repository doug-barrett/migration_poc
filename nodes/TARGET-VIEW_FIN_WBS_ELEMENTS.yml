fileVersion: 1
id: 540d3598-7bac-4386-8edd-07a03f884ab3
name: VIEW_FIN_WBS_ELEMENTS
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae0d1fd6-e91d-4aa1-bde0-64bfccf618a2
          stepCounter: 540d3598-7bac-4386-8edd-07a03f884ab3
        config: {}
        dataType: VARCHAR(24)
        defaultValue: ""
        description: ""
        name: WBS_ELEMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 270699d5-caa0-4a2a-bb87-9c4903a4317d
                stepCounter: d581a60e-c37c-4e7b-a259-5faf3ac3ff93
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7b8f99c-deb6-4479-9c1c-ad09f9d401cf
          stepCounter: 540d3598-7bac-4386-8edd-07a03f884ab3
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: WBS_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c12798a-fe8b-4be0-ab2f-4fa0e5e50203
                stepCounter: d581a60e-c37c-4e7b-a259-5faf3ac3ff93
            transform: TRANSLATE(DIM_LO_SAP_AFE.AFE_NAME, chr(10)||chr(13), '  ')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 23cf602e-4fc3-40be-9a78-822bf6d4b7b5
          stepCounter: 540d3598-7bac-4386-8edd-07a03f884ab3
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: WBS_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 15dded3e-20ac-4399-9582-0cd9a37c7604
                stepCounter: f93a8e45-7804-49aa-b6a3-966e768997dc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: caa71474-8164-4abb-b07e-94088f50f19b
          stepCounter: 540d3598-7bac-4386-8edd-07a03f884ab3
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: WBS_TYPE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67785ce3-e522-42ca-b754-609d323237b2
                stepCounter: f93a8e45-7804-49aa-b6a3-966e768997dc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41f22578-26f5-400c-bb4b-82c86b25519e
          stepCounter: 540d3598-7bac-4386-8edd-07a03f884ab3
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fbd6a241-5506-4b47-8fea-20c826c64471
                stepCounter: d581a60e-c37c-4e7b-a259-5faf3ac3ff93
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c7a2347-d6d3-4d29-afc2-3ec68d0eaf1e
          stepCounter: 540d3598-7bac-4386-8edd-07a03f884ab3
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: CORP_PLANNING_PROJECT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9b34a00f-a801-42d5-b7ba-52eee2d06d50
                stepCounter: d581a60e-c37c-4e7b-a259-5faf3ac3ff93
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b31e7d29-95d3-4aba-9886-bb7a7878f86f
          stepCounter: 540d3598-7bac-4386-8edd-07a03f884ab3
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: ENTITY_UUID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f7167e9-2e35-424d-b0cd-d08561649bb4
                stepCounter: b3c548e8-dbbb-4703-a3e2-4c29ea3ea796
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c51f485-c3c2-4297-9ad5-2d73088e9238
          stepCounter: 540d3598-7bac-4386-8edd-07a03f884ab3
        config: {}
        dataType: NUMBER(15,2)
        defaultValue: ""
        description: ""
        name: ALLOC_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 87635127-6dd6-4521-8bbc-e1131627611c
                stepCounter: d581a60e-c37c-4e7b-a259-5faf3ac3ff93
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb806496-988f-432e-9fdb-9033dcda3456
          stepCounter: 540d3598-7bac-4386-8edd-07a03f884ab3
        config: {}
        dataType: NUMBER(15,2)
        defaultValue: ""
        description: ""
        name: OP_ALLOC_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a5137253-d4b8-4ed0-a609-d4adab1eed7e
                stepCounter: d581a60e-c37c-4e7b-a259-5faf3ac3ff93
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bde95d58-a889-4b58-b55c-1e34d0b8ad5a
          stepCounter: 540d3598-7bac-4386-8edd-07a03f884ab3
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 42d39ec5-009a-43f4-a3af-b1cc1fac3fc9
                stepCounter: d581a60e-c37c-4e7b-a259-5faf3ac3ff93
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6fb47e5-9e2f-492e-ada2-5eaa3aee60e2
          stepCounter: 540d3598-7bac-4386-8edd-07a03f884ab3
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cedf3a73-f0bc-4e8b-92e3-5cb8ebfb1a4d
                stepCounter: f93a8e45-7804-49aa-b6a3-966e768997dc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 60a7ab31-684c-42db-94db-8a6df50097cc
          stepCounter: 540d3598-7bac-4386-8edd-07a03f884ab3
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: LINE_NO_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ff9b3fb-d27e-46d6-adfc-d83dbff9ee58
                stepCounter: f93a8e45-7804-49aa-b6a3-966e768997dc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 032b07b0-a38b-4639-8a81-61ea2c1e45be
          stepCounter: 540d3598-7bac-4386-8edd-07a03f884ab3
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: COMPANY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9c74509-8f65-4de5-980a-b0cea282c1a7
                stepCounter: d581a60e-c37c-4e7b-a259-5faf3ac3ff93
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16128a9e-5818-4f68-aaf7-18a1d9db68f3
          stepCounter: 540d3598-7bac-4386-8edd-07a03f884ab3
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: COUNTRY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c001948a-232a-4334-9783-49dbd5b2e688
                stepCounter: 067903b4-15b6-458b-abc2-85946f5a3432
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5960623-e77c-4cb3-95ad-b5997534e872
          stepCounter: 540d3598-7bac-4386-8edd-07a03f884ab3
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PROV_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7232afab-1540-48f7-8fee-6f30b110639d
                stepCounter: 067903b4-15b6-458b-abc2-85946f5a3432
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 007fb9c9-d162-4b21-b819-50e673b68bc6
          stepCounter: 540d3598-7bac-4386-8edd-07a03f884ab3
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: ""
        name: COREAREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c8d8af15-264c-40af-8b0b-4dce3b18ed31
                stepCounter: 067903b4-15b6-458b-abc2-85946f5a3432
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 634fd7b3-3121-46e7-a05c-8af9ced4d644
          stepCounter: 540d3598-7bac-4386-8edd-07a03f884ab3
        config: {}
        dataType: VARCHAR(240)
        defaultValue: ""
        description: ""
        name: AREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a489a103-50e2-4347-8d34-6965b140eea8
                stepCounter: 067903b4-15b6-458b-abc2-85946f5a3432
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 84003a74-941d-4804-b37e-5fe77f74d762
          stepCounter: 540d3598-7bac-4386-8edd-07a03f884ab3
        config: {}
        dataType: VARCHAR(300)
        defaultValue: ""
        description: ""
        name: OPERATOR_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3de449d8-75b7-4097-918c-39a43e892f85
                stepCounter: f601baef-839f-49ab-b102-ee3fad93f21c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de6a4be2-173f-4667-a4b6-23d89d7d33f8
          stepCounter: 540d3598-7bac-4386-8edd-07a03f884ab3
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5563562c-4e6a-498b-bae0-e0366064c886
                stepCounter: d581a60e-c37c-4e7b-a259-5faf3ac3ff93
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e8abd0c-502d-4442-b22d-c78db5f47ffb
          stepCounter: 540d3598-7bac-4386-8edd-07a03f884ab3
        config: {}
        dataType: NUMBER(9,6)
        defaultValue: ""
        description: ""
        name: VET_WI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7cf79e8b-f3f3-4b32-aa8b-ffe0178b81f2
                stepCounter: d581a60e-c37c-4e7b-a259-5faf3ac3ff93
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a702e59c-9519-4c57-842d-d1288ad8a89c
          stepCounter: 540d3598-7bac-4386-8edd-07a03f884ab3
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: COST_CENTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 232df295-5e14-4b86-9520-9a91bcb7203c
                stepCounter: d581a60e-c37c-4e7b-a259-5faf3ac3ff93
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c7d8d97a-f459-40d5-85d8-1efcd747d927
          stepCounter: 540d3598-7bac-4386-8edd-07a03f884ab3
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: SYSTEM_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 894d4484-0c7d-4c04-be2e-0bc0285568c4
                stepCounter: d581a60e-c37c-4e7b-a259-5faf3ac3ff93
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64bb64b3-3cd6-4175-9a26-0a3bbd1a8bd7
          stepCounter: 540d3598-7bac-4386-8edd-07a03f884ab3
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: USER_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0a1a4030-c393-4ce1-b382-28d5caf3ba29
                stepCounter: d581a60e-c37c-4e7b-a259-5faf3ac3ff93
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 172dc9e1-9261-4790-b763-036fd9d99ae8
          stepCounter: 540d3598-7bac-4386-8edd-07a03f884ab3
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: PERSON_RESPONSIBLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56a32cec-cfc8-48da-af6e-d1eeb3039ced
                stepCounter: d581a60e-c37c-4e7b-a259-5faf3ac3ff93
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_FIN_WBS_ELEMENTS: 540d3598-7bac-4386-8edd-07a03f884ab3
          DIM_LO_SAP_AFE: d581a60e-c37c-4e7b-a259-5faf3ac3ff93
          DIM_LO_SAP_AFE_TYPE: f93a8e45-7804-49aa-b6a3-966e768997dc
          DIM_LO_SAP_COST_CENTER: f601baef-839f-49ab-b102-ee3fad93f21c
          DIM_LO_SAP_CC_CORP_HIER_CURRENT: 067903b4-15b6-458b-abc2-85946f5a3432
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_FIN_WBS_ELEMENTS') }} AS SELECT DA.AFE_NUM WBS_ELEMENT,
                   TRANSLATE(DA.AFE_NAME,chr(10)||chr(13),'  ') WBS_DESC,
                   DAT.AFE_TYPE WBS_TYPE,
                   DAT.AFE_TYPE_DESC WBS_TYPE_DESC,
                   DA.AFE_CREATE_DATE CREATE_DATE,
                   NVL(DA.CORP_PLANNING_PROJECT,'{{ parameters.MOSAIC_CDM_UNBUDGETED_ENTITY_NAME }}') CORP_PLANNING_PROJECT,
                   NVL(ZMP.ENTITY_UUID,'{{ parameters.MOSAIC_CDM_UNBUDGETED_ENTITY_UUID }}') ENTITY_UUID,
                   DA.ALLOC_AMT,
                   DA.OP_ALLOC_AMT,
                   DA.OP_CURR_CODE,
                   DAT.LINE_NO,
                   DAT.LINE_NO_DESC,
                   DA.MANAGING_ORG_ID COMPANY_CODE,
                   DCCH.COUNTRY_CODE,
                   DCCH.PROV_CODE,
                   DCCH.COREAREA_NAME,
                   DCCH.AREA_NAME,
                   DCC.OPERATOR_NAME,
                   DA.UWI,
                   DA.VET_WBS_WI VET_WI,
                   DA.CC_NUM COST_CENTER,
                   DA.SYSTEM_STAT_CODES SYSTEM_STATUS,
                   DA.AFE_STAT_DESC USER_STATUS,
                   DA.ENGINEER_ASSIGNED PERSON_RESPONSIBLE
              FROM {{ ref('TARGET','DIM_LO_SAP_AFE') }} DA
              JOIN {{ ref('TARGET','DIM_LO_SAP_AFE_TYPE') }} DAT
                ON (DA.DIM_AFE_TYPE_KEY = DAT.DIM_AFE_TYPE_KEY)
              JOIN {{ ref('TARGET','DIM_LO_SAP_COST_CENTER') }} DCC
                ON (DA.CC_NUM = DCC.CC_NUM)
              JOIN {{ ref('TARGET','DIM_LO_SAP_CC_CORP_HIER_CURRENT') }} DCCH
                ON (DCC.DIM_CC_CORP_HIER_CURRENT_KEY = DCCH.DIM_CC_CORP_HIER_CURRENT_KEY)
              LEFT JOIN DS_SAP.ZCZFINMOSAICPRJ ZMP
                ON DA.CORP_PLANNING_PROJECT = ZMP.ZZMOSAIC_PRJ
             WHERE DA.DIM_AFE_KEY <> 0
        dependencies:
          - locationName: TARGET
            nodeName: DIM_LO_SAP_AFE
          - locationName: TARGET
            nodeName: DIM_LO_SAP_AFE_TYPE
          - locationName: TARGET
            nodeName: DIM_LO_SAP_COST_CENTER
          - locationName: TARGET
            nodeName: DIM_LO_SAP_CC_CORP_HIER_CURRENT
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','DIM_LO_SAP_AFE') }}
            {{ ref('TARGET','DIM_LO_SAP_AFE_TYPE') }}
            {{ ref('TARGET','DIM_LO_SAP_COST_CENTER') }}
            {{ ref('TARGET','DIM_LO_SAP_CC_CORP_HIER_CURRENT') }}
        name: VIEW_FIN_WBS_ELEMENTS
        noLinkRefs: []
  name: VIEW_FIN_WBS_ELEMENTS
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
