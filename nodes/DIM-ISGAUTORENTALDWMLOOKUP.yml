fileVersion: 1
id: 453234bb-60fe-45d2-b511-8930ec183b77
name: ISGAUTORENTALDWMLOOKUP
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DIM
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: abc15001-a3b2-4254-9d4c-ca1af686befc
          stepCounter: 453234bb-60fe-45d2-b511-8930ec183b77
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: CHARGEDAYS
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 44ce2a20-2a40-4e44-8954-e16e937d0539
          stepCounter: 453234bb-60fe-45d2-b511-8930ec183b77
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: WEEKDAYS
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 61eadc62-4ca1-4875-a4d6-c776a8bb66af
          stepCounter: 453234bb-60fe-45d2-b511-8930ec183b77
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: MONTHDAYS
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1aa1e014-f774-482d-aa5e-d8d4ac44d6e1
          stepCounter: 453234bb-60fe-45d2-b511-8930ec183b77
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: BLMONTHS
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6d3794d-7dee-44ef-bd55-fc266c2cda8c
          stepCounter: 453234bb-60fe-45d2-b511-8930ec183b77
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: BLWEEKS
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4eaddd70-c7f5-450e-a2c0-7a10a6229a7f
          stepCounter: 453234bb-60fe-45d2-b511-8930ec183b77
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: BLDAYS
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ISGAUTORENTALDWMLOOKUP: 453234bb-60fe-45d2-b511-8930ec183b77
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('DIM','ISGAUTORENTALDWMLOOKUP') }} (\NCHARGEDAYS , \NBLMONTHS , \NBLWEEKS , \NBLDAYS , \NWEEKDAYS , \NMONTHDAYS \N) AS \NWITH DAYSWEEKSMONTHSCONFIG AS (
                    SELECT 5.25 AS WEEKDAYS,
                           20 AS MONTHDAYS,
                           183 AS TOTALDAYS
                   ),
                   \NDAYCOUNT AS (
                    SELECT SEQ4() AS CHARGEDAYS
                      FROM TABLE(GENERATOR(ROWCOUNT => (SELECT TOTALDAYS FROM DAYSWEEKSMONTHSCONFIG))) V
                   ),
                   \NBASEDATA AS (
                    SELECT *
                      FROM DAYSWEEKSMONTHSCONFIG,
                           DAYCOUNT
                   ),
                   \NBLMONTHS AS (
                    SELECT *,
                           FLOOR((CHARGEDAYS+(30-MONTHDAYS))/30) AS BLMONTHS
                      FROM BASEDATA
                   ),
                   \NBLWEEKS AS (
                    SELECT *,
                           FLOOR((IFF(CHARGEDAYS-(BLMONTHS*30)>0,CHARGEDAYS-(BLMONTHS*30),0)+7-WEEKDAYS)/7) AS BLWEEKS
                      FROM BLMONTHS
                   ),
                   \NBLDAYS AS (
                    SELECT *,
                           IFF(CHARGEDAYS-BLMONTHS*30-BLWEEKS*7>0,CHARGEDAYS-BLMONTHS*30-BLWEEKS*7,0) AS BLDAYS
                      FROM BLWEEKS
                   ) \NSELECT CHARGEDAYS,
                   BLMONTHS,
                   BLWEEKS,
                   BLDAYS,
                   WEEKDAYS,
                   MONTHDAYS
              FROM BLDAYS
        dependencies: []
        join:
          joinCondition: '-- Nodes used in the SQL override:'
        name: ISGAUTORENTALDWMLOOKUP
        noLinkRefs: []
  name: ISGAUTORENTALDWMLOOKUP
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
