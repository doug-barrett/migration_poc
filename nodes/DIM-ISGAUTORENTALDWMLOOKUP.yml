fileVersion: 1
id: b6382cf6-d51e-46eb-a209-27c13a969595
name: ISGAUTORENTALDWMLOOKUP
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DIM
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a7b8d83-c7b7-470c-b5b9-f23ff6cf958d
          stepCounter: b6382cf6-d51e-46eb-a209-27c13a969595
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: CHARGEDAYS
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f12b161b-2f36-4e49-a052-8c32cad35fb4
          stepCounter: b6382cf6-d51e-46eb-a209-27c13a969595
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: WEEKDAYS
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1e901d7-2962-4c13-b2b4-26ccdb25c55a
          stepCounter: b6382cf6-d51e-46eb-a209-27c13a969595
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: MONTHDAYS
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c4084f6-de65-421a-880f-872b98458978
          stepCounter: b6382cf6-d51e-46eb-a209-27c13a969595
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: BLMONTHS
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8db6b4a-3b7d-4f81-bf76-8a1d71feeebd
          stepCounter: b6382cf6-d51e-46eb-a209-27c13a969595
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: BLWEEKS
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6a63a4c-a4be-40e7-9886-37639e9880d2
          stepCounter: b6382cf6-d51e-46eb-a209-27c13a969595
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: BLDAYS
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ISGAUTORENTALDWMLOOKUP: b6382cf6-d51e-46eb-a209-27c13a969595
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('DIM','ISGAUTORENTALDWMLOOKUP') }} (\NCHARGEDAYS , \NBLMONTHS , \NBLWEEKS , \NBLDAYS , \NWEEKDAYS , \NMONTHDAYS \N) AS \NWITH DAYSWEEKSMONTHSCONFIG AS (
                    SELECT 5.25 AS WEEKDAYS,
                           20 AS MONTHDAYS,
                           183 AS TOTALDAYS
                   ),
                   \NDAYCOUNT AS (
                    SELECT SEQ4() AS CHARGEDAYS
                      FROM TABLE(GENERATOR(ROWCOUNT => (SELECT TOTALDAYS FROM DAYSWEEKSMONTHSCONFIG))) V
                   ),
                   \NBASEDATA AS (
                    SELECT *
                      FROM DAYSWEEKSMONTHSCONFIG,
                           DAYCOUNT
                   ),
                   \NBLMONTHS AS (
                    SELECT *,
                           FLOOR((CHARGEDAYS+(30-MONTHDAYS))/30) AS BLMONTHS
                      FROM BASEDATA
                   ),
                   \NBLWEEKS AS (
                    SELECT *,
                           FLOOR((IFF(CHARGEDAYS-(BLMONTHS*30)>0,CHARGEDAYS-(BLMONTHS*30),0)+7-WEEKDAYS)/7) AS BLWEEKS
                      FROM BLMONTHS
                   ),
                   \NBLDAYS AS (
                    SELECT *,
                           IFF(CHARGEDAYS-BLMONTHS*30-BLWEEKS*7>0,CHARGEDAYS-BLMONTHS*30-BLWEEKS*7,0) AS BLDAYS
                      FROM BLWEEKS
                   ) \NSELECT CHARGEDAYS,
                   BLMONTHS,
                   BLWEEKS,
                   BLDAYS,
                   WEEKDAYS,
                   MONTHDAYS
              FROM BLDAYS
        dependencies: []
        join:
          joinCondition: '-- Nodes used in the SQL override:'
        name: ISGAUTORENTALDWMLOOKUP
        noLinkRefs: []
  name: ISGAUTORENTALDWMLOOKUP
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
