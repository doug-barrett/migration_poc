fileVersion: 1
id: 45937c1b-4fbd-439d-aebc-0e58a6e3b7da
name: ISGAUTORENTALDWMLOOKUP
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DIM
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 893f486b-a2be-428a-8cf1-6965ef9b249e
          stepCounter: 45937c1b-4fbd-439d-aebc-0e58a6e3b7da
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: CHARGEDAYS
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 772f9028-dc10-4844-946d-8dd7a6e89581
          stepCounter: 45937c1b-4fbd-439d-aebc-0e58a6e3b7da
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: WEEKDAYS
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ee75830-e746-4575-ae1b-72aea3797764
          stepCounter: 45937c1b-4fbd-439d-aebc-0e58a6e3b7da
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: MONTHDAYS
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b466465-8c42-4e3f-85e8-d69f20ee3e55
          stepCounter: 45937c1b-4fbd-439d-aebc-0e58a6e3b7da
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: BLMONTHS
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9b5287d-139e-40ff-b2e2-73792ba8df2a
          stepCounter: 45937c1b-4fbd-439d-aebc-0e58a6e3b7da
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: BLWEEKS
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b37f750-01ef-4fd1-be74-9ead557a7518
          stepCounter: 45937c1b-4fbd-439d-aebc-0e58a6e3b7da
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: BLDAYS
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ISGAUTORENTALDWMLOOKUP: 45937c1b-4fbd-439d-aebc-0e58a6e3b7da
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('DIM','ISGAUTORENTALDWMLOOKUP') }} (\NCHARGEDAYS , \NBLMONTHS , \NBLWEEKS , \NBLDAYS , \NWEEKDAYS , \NMONTHDAYS \N) AS \NWITH DAYSWEEKSMONTHSCONFIG AS (
                    SELECT 5.25 AS WEEKDAYS,
                           20 AS MONTHDAYS,
                           183 AS TOTALDAYS
                   ),
                   \NDAYCOUNT AS (
                    SELECT SEQ4() AS CHARGEDAYS
                      FROM TABLE(GENERATOR(ROWCOUNT => (SELECT TOTALDAYS FROM DAYSWEEKSMONTHSCONFIG))) V
                   ),
                   \NBASEDATA AS (
                    SELECT *
                      FROM DAYSWEEKSMONTHSCONFIG,
                           DAYCOUNT
                   ),
                   \NBLMONTHS AS (
                    SELECT *,
                           FLOOR((CHARGEDAYS+(30-MONTHDAYS))/30) AS BLMONTHS
                      FROM BASEDATA
                   ),
                   \NBLWEEKS AS (
                    SELECT *,
                           FLOOR((IFF(CHARGEDAYS-(BLMONTHS*30)>0,CHARGEDAYS-(BLMONTHS*30),0)+7-WEEKDAYS)/7) AS BLWEEKS
                      FROM BLMONTHS
                   ),
                   \NBLDAYS AS (
                    SELECT *,
                           IFF(CHARGEDAYS-BLMONTHS*30-BLWEEKS*7>0,CHARGEDAYS-BLMONTHS*30-BLWEEKS*7,0) AS BLDAYS
                      FROM BLWEEKS
                   ) \NSELECT CHARGEDAYS,
                   BLMONTHS,
                   BLWEEKS,
                   BLDAYS,
                   WEEKDAYS,
                   MONTHDAYS
              FROM BLDAYS
        dependencies: []
        join:
          joinCondition: '-- Nodes used in the SQL override:'
        name: ISGAUTORENTALDWMLOOKUP
        noLinkRefs: []
  name: ISGAUTORENTALDWMLOOKUP
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
