fileVersion: 1
id: 52836cb5-f67e-4215-adce-65383f049e66
name: ISGAUTORENTALDWMLOOKUP
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DIM
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 602809a6-b50e-42cc-ab2c-6b1173ea4670
          stepCounter: 52836cb5-f67e-4215-adce-65383f049e66
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: CHARGEDAYS
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02b7ac49-15e9-402a-8b8e-71406f6fd876
          stepCounter: 52836cb5-f67e-4215-adce-65383f049e66
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: WEEKDAYS
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: afbc2bb9-5b90-40ea-acd7-9e1164166050
          stepCounter: 52836cb5-f67e-4215-adce-65383f049e66
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: MONTHDAYS
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 454662fb-8b50-4abe-aa53-aa537db4c9b4
          stepCounter: 52836cb5-f67e-4215-adce-65383f049e66
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: BLMONTHS
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 665b2c45-03e2-4fff-8f7e-b59255053eb4
          stepCounter: 52836cb5-f67e-4215-adce-65383f049e66
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: BLWEEKS
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32000959-ca03-479e-8979-59c70574839e
          stepCounter: 52836cb5-f67e-4215-adce-65383f049e66
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: BLDAYS
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ISGAUTORENTALDWMLOOKUP: 52836cb5-f67e-4215-adce-65383f049e66
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('DIM','ISGAUTORENTALDWMLOOKUP') }} (\NCHARGEDAYS , \NBLMONTHS , \NBLWEEKS , \NBLDAYS , \NWEEKDAYS , \NMONTHDAYS \N) AS \NWITH DAYSWEEKSMONTHSCONFIG AS (
                    SELECT 5.25 AS WEEKDAYS,
                           20 AS MONTHDAYS,
                           183 AS TOTALDAYS
                   ),
                   \NDAYCOUNT AS (
                    SELECT SEQ4() AS CHARGEDAYS
                      FROM TABLE(GENERATOR(ROWCOUNT => (SELECT TOTALDAYS FROM DAYSWEEKSMONTHSCONFIG))) V
                   ),
                   \NBASEDATA AS (
                    SELECT *
                      FROM DAYSWEEKSMONTHSCONFIG,
                           DAYCOUNT
                   ),
                   \NBLMONTHS AS (
                    SELECT *,
                           FLOOR((CHARGEDAYS+(30-MONTHDAYS))/30) AS BLMONTHS
                      FROM BASEDATA
                   ),
                   \NBLWEEKS AS (
                    SELECT *,
                           FLOOR((IFF(CHARGEDAYS-(BLMONTHS*30)>0,CHARGEDAYS-(BLMONTHS*30),0)+7-WEEKDAYS)/7) AS BLWEEKS
                      FROM BLMONTHS
                   ),
                   \NBLDAYS AS (
                    SELECT *,
                           IFF(CHARGEDAYS-BLMONTHS*30-BLWEEKS*7>0,CHARGEDAYS-BLMONTHS*30-BLWEEKS*7,0) AS BLDAYS
                      FROM BLWEEKS
                   ) \NSELECT CHARGEDAYS,
                   BLMONTHS,
                   BLWEEKS,
                   BLDAYS,
                   WEEKDAYS,
                   MONTHDAYS
              FROM BLDAYS
        dependencies: []
        join:
          joinCondition: '-- Nodes used in the SQL override:'
        name: ISGAUTORENTALDWMLOOKUP
        noLinkRefs: []
  name: ISGAUTORENTALDWMLOOKUP
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
