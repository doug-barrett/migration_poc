fileVersion: 1
id: a443b177-7fa6-494d-8e75-1bdf41158335
name: ISGAUTORENTALDWMLOOKUP
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DIM
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd791097-6056-4316-8f3a-cd01e908a9ce
          stepCounter: a443b177-7fa6-494d-8e75-1bdf41158335
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: CHARGEDAYS
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34518b8c-d156-4841-b292-d7c1afe673ef
          stepCounter: a443b177-7fa6-494d-8e75-1bdf41158335
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: WEEKDAYS
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac0bc7b5-767d-48f4-9566-2013e43bbf0a
          stepCounter: a443b177-7fa6-494d-8e75-1bdf41158335
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: MONTHDAYS
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc3c367b-ae63-409a-9964-74f983cbdc19
          stepCounter: a443b177-7fa6-494d-8e75-1bdf41158335
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: BLMONTHS
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2ee3930-3538-4a3f-b1b1-9768ab5d1aa0
          stepCounter: a443b177-7fa6-494d-8e75-1bdf41158335
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: BLWEEKS
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72248c9c-f484-4c6e-b89c-99a8d9846061
          stepCounter: a443b177-7fa6-494d-8e75-1bdf41158335
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: BLDAYS
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ISGAUTORENTALDWMLOOKUP: a443b177-7fa6-494d-8e75-1bdf41158335
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('DIM','ISGAUTORENTALDWMLOOKUP') }} (\NCHARGEDAYS , \NBLMONTHS , \NBLWEEKS , \NBLDAYS , \NWEEKDAYS , \NMONTHDAYS \N) AS \NWITH DAYSWEEKSMONTHSCONFIG AS (
                    SELECT 5.25 AS WEEKDAYS,
                           20 AS MONTHDAYS,
                           183 AS TOTALDAYS
                   ),
                   \NDAYCOUNT AS (
                    SELECT SEQ4() AS CHARGEDAYS
                      FROM TABLE(GENERATOR(ROWCOUNT => (SELECT TOTALDAYS FROM DAYSWEEKSMONTHSCONFIG))) V
                   ),
                   \NBASEDATA AS (
                    SELECT *
                      FROM DAYSWEEKSMONTHSCONFIG,
                           DAYCOUNT
                   ),
                   \NBLMONTHS AS (
                    SELECT *,
                           FLOOR((CHARGEDAYS+(30-MONTHDAYS))/30) AS BLMONTHS
                      FROM BASEDATA
                   ),
                   \NBLWEEKS AS (
                    SELECT *,
                           FLOOR((IFF(CHARGEDAYS-(BLMONTHS*30)>0,CHARGEDAYS-(BLMONTHS*30),0)+7-WEEKDAYS)/7) AS BLWEEKS
                      FROM BLMONTHS
                   ),
                   \NBLDAYS AS (
                    SELECT *,
                           IFF(CHARGEDAYS-BLMONTHS*30-BLWEEKS*7>0,CHARGEDAYS-BLMONTHS*30-BLWEEKS*7,0) AS BLDAYS
                      FROM BLWEEKS
                   ) \NSELECT CHARGEDAYS,
                   BLMONTHS,
                   BLWEEKS,
                   BLDAYS,
                   WEEKDAYS,
                   MONTHDAYS
              FROM BLDAYS
        dependencies: []
        join:
          joinCondition: '-- Nodes used in the SQL override:'
        name: ISGAUTORENTALDWMLOOKUP
        noLinkRefs: []
  name: ISGAUTORENTALDWMLOOKUP
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
