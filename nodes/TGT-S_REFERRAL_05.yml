fileVersion: 1
id: ee4abcce-6648-4426-b899-c6422bc1e7fa
name: S_REFERRAL_05
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17b0b14e-5787-40db-a593-0d97b57cc8f3
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ESPI1_ELIGIBLE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 155b5b8b-4dab-4dec-bcae-96de8a4a2655
                stepCounter: 410d8e56-9f7e-4108-8289-feac32247ef2
            transform: |-
              CASE WHEN RETYP_refno = 200800 AND IFNULL(l_mappings_referral_reason.ESPI1_inclusion,0) = 1 AND IFNULL(s_specialty_1.ESPI1_inclusion,'N') ='Y' THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f39cb41-e505-4878-a90e-81e0c6f840e4
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Is this referral an National patient flow referral, Note this rule is the ESPI1 rule plus Surveillance
        name: NPF_PRESENTING_REFERRAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 155b5b8b-4dab-4dec-bcae-96de8a4a2655
                stepCounter: 410d8e56-9f7e-4108-8289-feac32247ef2
            transform: |-
              CASE WHEN s_referral_activity_05.referral_waitlist_count > 0 AND s_referral_activity_05.referral_waitlist_count = s_referral_activity_05.NPF_excluded_WL                                                                                                                                               THEN 'N'
                          WHEN RETYP_refno =200800 AND ds_pims_referrals.recvd_dttm >= '01-Jul-2014' AND IFNULL(l_mappings_referral_reason.NPF_inclusion,0) = 1 AND IFNULL(s_specialty_1.NPF_inclusion,'N') ='Y' AND not(ds_pims_referrals.rject_refno IN(1400017800,1400019280) AND IFNULL(referral_waitlist_count,0) = 0) THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 036f6021-4b83-4986-97b4-cf0c31be918d
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ea5d433-91ca-48a7-9ae4-faea9f093b1b
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: "'R' + CONVERT(varchar,ds_pims_referrals.refrl_refno)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed7dc494-4c07-4196-bce6-c842413d8d90
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ESPI1_INCLUSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 69c52a4e-79bf-4dc0-830a-c11b6398d87f
                stepCounter: 19f323a9-95a3-4efc-bdc1-7adc75cffc2a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 177b08c6-d70c-42f3-92a0-e1c92961704c
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: NPF_INCLUSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d258ee3-e063-47ef-ba2d-7b65dcfc0e79
                stepCounter: 19f323a9-95a3-4efc-bdc1-7adc75cffc2a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb4e03a1-8f38-46b7-b5e7-3f1ddc1fd7b4
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: REFERRAL_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'R'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79914490-2a07-45ee-b7c3-989c9d8cf6e8
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFRL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ea5d433-91ca-48a7-9ae4-faea9f093b1b
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f1f3a583-4191-42cd-9320-97623562a1fb
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9b958777-5cbb-4a87-a4d5-2df92d9f4399
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d0d82db-fdbe-46b6-bb4f-6eb3be107047
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SORRF_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2cef6014-6f76-4c22-8173-e8ac42625bf2
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d0604d4-c3f1-4e2e-858b-79c09b05115b
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SENT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0fe73cfe-d31f-4f4c-b329-bd8709ea5b3c
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4cb586cf-30f1-4bed-a658-aac10813738b
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: RECVD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d559d91-e33e-47a7-a819-1f7cce3c6112
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: |-
              CASE WHEN ds_pims_referrals.recvd_dttm < '1984-07-01' OR ds_pims_referrals.recvd_dttm IS NULL THEN COALESCE(ds_pims_referrals.sent_dttm,ds_pims_referrals.authr_dttm,getdate())
                          ELSE ds_pims_referrals.recvd_dttm
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: abc1ca03-0c87-49d1-8a6e-103012a01d20
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: RECVD_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d559d91-e33e-47a7-a819-1f7cce3c6112
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a96241c-e678-45f0-a826-33bd043cc4f5
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REASN_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c40a7ad5-4af2-47cf-bd63-c1f6eb19c254
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bbbc4d6e-76a8-4ecd-acb8-9ed23d44b0f5
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CANCD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75df44dd-2792-486c-bb08-f4269de90912
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f25e5707-79d3-4344-a79b-70bad28f806a
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CANRS_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7394ac28-f2b2-4e57-bcf1-9854ab3b93b0
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 028f37c5-2b05-4ce0-9981-e090ce184c36
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: URGNC_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c6c14013-e1e9-4e74-9a10-832c934fb14a
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c3a5e4c-5a7c-415c-89d9-dfbc5eba623c
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRITY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 82731dc1-37e7-489c-b7ac-9be4ca18d5b5
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 800d9dad-0d3d-422b-acc6-ecae31aaf4d0
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: LETTER_SENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16891d6a-ba3f-40bc-a024-0cca2fda00e1
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cba72450-656c-49f8-9578-5a071896ff1a
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CLOSR_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b66ecb9-86fa-46cf-9e69-db13c44d34c5
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e6830e5-3e5d-4e70-81ab-f4c9b1daa905
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ORDTA_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22960ffc-9e06-4457-bd7a-b3d27a6504a0
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b98ab27d-13c5-453c-a876-b8a82bdd0280
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: AUTHR_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18288d3e-685e-4972-afd0-155358ab1ebe
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95c90bfd-4c6c-48b5-9cec-71299605c71e
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: AUTHR_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e6d24db8-8306-4889-99de-ff9b22df4bab
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24441f9b-7204-4551-83e3-53fc7231c3ca
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: AUTHR_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 876a1072-e8be-4426-a1d0-b906d1f669a3
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6fb32625-9b8a-42c4-8fdc-601ec9e395f2
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: AUTHR_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3055d7ba-0014-4e16-afa4-5d81608e3f50
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06f12fcd-675f-4ec3-99fb-6223b46bbac1
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: RESP_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23a83907-d1d4-40e7-a42f-7acee11cc29a
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0da121bc-2703-4ae4-8eaa-ed5e1fb97605
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFBY_STEAM_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4402eb67-ba0a-43ec-8911-43c6fa853f13
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 006a1480-4be5-4633-bda2-9e1989642a6d
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFBY_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2eb59e4d-ed8c-4413-895c-2f62daabf8bf
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d9671ae-9617-43af-925c-902b8efdde36
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFBY_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee463a13-670e-474e-909b-796ab470f0d7
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c74581ad-f5d7-4262-9047-0f7a1f440b23
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFBY_HEORG_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a7fb66e4-e739-4e45-a716-2693f052ae2b
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a2a2263-21b9-4bfa-a92f-773f80e9284e
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFTO_STEAM_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 607aeda1-4505-4215-899b-76b76c362601
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af65a1f0-475f-4b39-ab49-6d232ac25587
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFTO_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 53c236fa-c554-49c8-b648-f11ff0f4c5f9
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 225acc2c-b8d1-4ddb-9ce0-fccd4f94cfa4
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFTO_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9ad4814-be66-4584-a9de-289a9e5a8644
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2724db4-53a5-4294-8332-c9ef2912d3d2
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFTO_HEORG_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b11b1350-5282-48cf-a9eb-079e73946038
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d62a2058-8f07-4b97-b02e-4f36f9f80d33
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: RFOCM_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3921da58-758f-4a46-90dd-249b16569784
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b5069472-9e6c-489e-9f23-cff5591e2372
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: RSTAT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9165ec1b-551b-4836-833d-6b1499307ff6
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ea63ff4-d1d0-478e-b2f8-1eda6179b74e
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: RJECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3feadcf8-22df-411a-9a6c-497126c713f0
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e103680-6d84-48a7-9489-1b1008ab157b
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: POCAR_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ede737b-3b22-49fb-8fb2-4eb7112416dd
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 28244bd1-c3a8-4ed9-94eb-3846b91986be
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: RETYP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9329c99d-1236-4ba8-8a8b-1c7ac975df01
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c8a1f7d-aa0c-4cb9-8a13-717ab362dca0
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PARNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6898272a-7c31-4ab9-80b9-b71be42c8aca
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7aa1ccd2-5441-4943-9ab6-3848f55b5648
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_CONTACT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64364c31-3aee-4a6b-b071-13b1754b6d57
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7438abe-89b9-48d8-b3ce-64e4f2439ec0
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NEXT_CONTACT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: abca1e41-da43-4a87-897e-f1cde7a775c1
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c1c9ac2-c4ea-4006-af31-80d808fb26d1
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SUSP_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 35d8a89d-adf4-44e3-bf3b-28dbdfae30a2
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41883e32-8d5e-4f3a-80dc-61b62ec0cb15
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SUSP_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 70166445-4150-4220-8304-7d8836bde095
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c507083d-a8b4-4857-8142-be581f22cea3
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SUSRS_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d17a9bd-3e16-4a4e-ba67-6b7d1b15ae4f
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d0d754eb-437e-4375-af1b-c4f75cad2ba3
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: RQURG_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79e2efdc-6eca-4d79-a11a-90b8b496e893
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5cdc8afc-fbe6-47e2-aec7-d50aa076f347
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: AUSTS_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4193ddcf-5a59-4747-aa8d-f2fe3abb0779
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78c79569-eb56-4f21-b59f-26ffb4b83f80
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: AURQS_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d2ce8d5-5d53-485d-bef9-ece735ff4cf9
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ef41da4-da83-42ba-aa7c-104b0fe6afa6
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CNSLT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48d71369-f128-422e-847f-b60895aa1dc1
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1ed2030-3f29-42c3-8fcd-1649f0102564
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CSTAT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a10881ec-5b84-4bee-89df-dc3401831a9d
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d11512a5-75f5-4009-9834-6d885c13a032
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADCAT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e0e93d68-4049-4bd3-aaf1-6478fbc2c3ad
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15cbaafc-5698-4356-9935-a49d4a2496bd
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACTYP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e4915849-dbef-4f19-ac98-420a0c7918a2
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40c19296-5af7-459c-a3b9-e74a7cd6d457
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CLINICAL_PRIORITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 26437200-2074-44e0-b446-6d6fc3550723
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9f3a694-d481-4259-b011-f07fd8616f8c
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACCRL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d5280228-c77a-4c44-ae3c-6dda54759c0f
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: face3a46-61e6-4434-9b85-b6796ea76d99
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACCTY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6fb73b91-6f38-40bb-9716-841aed29d0b4
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6ca7a45-03a1-4ad3-91ae-66705f6dd29d
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ACC_CLAIM_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b7066f7a-f7c1-4eb4-ba52-82f4cb39659e
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 698ab37b-8f85-486c-a464-a60052dbdaff
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ACC_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77be34a0-0432-492b-8833-09f48a343536
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: IFNULL(NULLIF(LTRIM(RTRIM(ds_pims_referrals.acc_number)),''),'None')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d52cd267-1d7d-4da8-a7b9-fae9d20eb34c
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ACC_NO_DERIVED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77be34a0-0432-492b-8833-09f48a343536
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: IFNULL(IFNULL(LEFT(LTRIM(ACC_number),20),LEFT(LTRIM(ACC_claim_number),20)),'None')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96caa052-ee5f-494d-8a3b-2160d176ce0b
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ACC_VALID_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77be34a0-0432-492b-8833-09f48a343536
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: |-
              CASE WHEN (LEN(LTRIM(REPLACE(acc_number,'/',''))) IN (11,10,8) AND ISNUMERIC(LTRIM(REPLACE(acc_number,'/',''))) = 1) OR (LEN(LTRIM(REPLACE(acc_number,'/',''))) IN (7) AND ISNUMERIC(SUBSTRING(LTRIM(REPLACE(acc_number,'/','')),3,5)) = 1 AND ISNUMERIC(SUBSTRING(LTRIM(REPLACE(acc_number,'/','')),1,2)) = 0) OR (LEN(LTRIM(REPLACE(acc_number,'/',''))) IN (11) AND ISNUMERIC(SUBSTRING(LTRIM(REPLACE(acc_number,'/','')),2,10)) = 1 AND ISNUMERIC(SUBSTRING(LTRIM(REPLACE(acc_number,'/','')),1,1)) = 0) THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fefd45a7-bd73-49a8-9afa-543050bad6b7
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: INSURER_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77be34a0-0432-492b-8833-09f48a343536
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: LEFT(RTRIM(LTRIM(acc_number)),20)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e8f4a53-edbf-42f6-a8c4-d4fde3754907
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACCAS_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 830d35be-48e5-4cd3-bc2c-63bae1e30d69
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07ae5e6c-3382-4b31-ac51-2d42d018c813
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: EXPIRY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 36ba09b0-2df4-4fba-a805-a49f2822c261
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15c23df1-467e-4e17-b054-592d90929927
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFTO_WARD_SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 54e00323-9627-48e6-928b-521cd5d366f6
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42f6cd32-85a4-4904-83a4-96b6a4ca2e6e
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CLMAS_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 561ad531-e2ca-44ac-a06e-1c5352bbb166
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f8fa5f5-13e2-41fb-98f6-dbc12af6e2eb
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CLORS_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 520b0bc1-57bc-4efb-a31d-884e07b40b46
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: faaedaf9-eb97-44b0-930d-717e8f52f471
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CONSE_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c87c9b1b-9af2-4b69-b88d-9e866fdd6567
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc60dc1c-bcc8-408b-adf6-2c935d79da36
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: RFOTY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 69de05e5-9e53-4971-94ee-ecce4699a8d5
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b5719f4-b930-42fa-852f-f38d54cea05f
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PROGR_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 165b8f36-7fb0-4170-99e0-18ec6ad7554a
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 36bb350f-decc-428c-b652-80da08e6af4f
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FUNDA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 101eeecb-cab1-4fd0-9d4d-1440996a134d
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb67ad0f-32cf-4813-844b-71ab862c5786
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: RFVPD_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 12f14f0b-740e-423a-872e-6f19e4e7edf2
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac6a3077-ec49-4662-bc33-8f8c3d3be20a
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SUBPR_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd5b5997-251f-4b71-8c57-0f93ba2d7627
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49b22639-4860-4f56-95f4-a2d5c339db17
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFTO_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ecddc2e-10fd-4d81-bc00-ba480c92fd47
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b61da0a0-eced-43f1-9d80-68913114ed59
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 600c2568-61ea-4287-8e38-09d576abd668
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e25429c-f961-406e-b165-d3da69fcae25
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: patient_referral_seq_num
        name: PATIENT_REFERRAL_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ROW_NUMBER() OVER (PARTITION BY ds_pims_referrals.patnt_refno ORDER BY ds_pims_referrals.recvd_dttm)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 587132bf-627c-449c-b9d2-5f7c68a68cb1
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: patient_referral_count
        name: PATIENT_REFERRAL_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: COUNT(1) OVER (PARTITION BY ds_pims_referrals.patnt_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a3ffe1c-af05-421f-8257-f982698aa46f
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Waitlists associated with this referral
        name: REFERRAL_WAITLIST_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: da39fd7c-153f-4911-b412-629ade1aed60
                stepCounter: 44ce9384-d319-45b2-a044-f54bcff3c9d7
            transform: IFNULL(referral_waitlist_count,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cdd77c94-4e56-4677-abd6-c6fdfa130fd4
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Emergency attendances associated with this referral
        name: REFERRAL_AE_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ece5f080-9676-4edd-acb7-2ab6d5955a63
                stepCounter: 44ce9384-d319-45b2-a044-f54bcff3c9d7
            transform: IFNULL(referral_AE_count,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f1e6ef0-4169-4969-86f5-42abc70cb490
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Appointment (theatre/contacts/outpatients) associated with this referral
        name: REFERRAL_APPOINTMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e05352e5-4147-4a28-b1d2-7aa04721160d
                stepCounter: 44ce9384-d319-45b2-a044-f54bcff3c9d7
            transform: IFNULL(referral_appointment_count,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67f3e70a-218f-4928-9bed-940a55c24053
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Admissions associated with this referral
        name: REFERRAL_ADMISSION_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb12b639-fbf8-4620-aa22-9dffec28d552
                stepCounter: 44ce9384-d319-45b2-a044-f54bcff3c9d7
            transform: IFNULL(referral_admission_count,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c4bfd8a-d0fa-47e7-9222-cd886a78f878
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Excluded wailtists associated with this referral
        name: NPF_EXCLUDED_WAITLIST_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b925f831-a16a-4830-be1c-ac0c037119de
                stepCounter: 44ce9384-d319-45b2-a044-f54bcff3c9d7
            transform: IFNULL(NPF_Excluded_WL,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c843b4ce-67e7-4d07-ab47-0fb8ccea5b45
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Suspension wailtists associated with this referral
        name: NPF_SUSPENSION_EXCEPTION_WAITLIST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d748a4ef-d7f8-42ee-b360-1f54bec91ef4
                stepCounter: 44ce9384-d319-45b2-a044-f54bcff3c9d7
            transform: IFNULL(NPF_Suspension_exception_WL,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f42237b-1f57-440b-bc6d-a60987ad8c76
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ca1a9cd-8411-404c-92ab-490295ef9674
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a70b467b-13f5-416c-888d-3e376554cb72
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9875e262-5e02-4b86-a2a9-30c6a19697b9
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0935e83-df0d-4f97-837e-6d9b87f2db09
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIFY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fbbfe493-c681-41b8-86ab-60ac638d6d9a
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b611dcf2-0051-4536-865d-6ceb175d8971
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MODIFY_USER_LOGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5b59a6ae-2cf6-452d-a0a0-a32973529e4b
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80188d31-f263-4359-8694-aafbdfb780d5
          stepCounter: ee4abcce-6648-4426-b899-c6422bc1e7fa
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DS_PIMS_PATIENTS: 34c6fd4e-f463-4453-bad1-3a1d762d3caa
          S_REFERRAL_ACTIVITY_05: 44ce9384-d319-45b2-a044-f54bcff3c9d7
          L_MAPPINGS_REFERRAL_REASON: 410d8e56-9f7e-4108-8289-feac32247ef2
          S_SPECIALTY_1: 19f323a9-95a3-4efc-bdc1-7adc75cffc2a
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: L_MAPPINGS_REFERRAL_REASON
          - locationName: TGT
            nodeName: DS_PIMS_PATIENTS
          - locationName: TGT
            nodeName: S_REFERRAL_ACTIVITY_05
          - locationName: TGT
            nodeName: S_SPECIALTY_1
        join:
          joinCondition: |-
            FROM ds_pims_referrals
              JOIN {{ ref('TGT','DS_PIMS_PATIENTS') }}
                ON ds_pims_referrals.patnt_refno = ds_pims_patients.patnt_refno
              LEFT OUTER JOIN {{ ref('TGT','S_REFERRAL_ACTIVITY_05') }}
                ON ds_pims_referrals.refrl_refno = s_referral_activity_05.refrl_refno
              LEFT OUTER JOIN {{ ref('TGT','L_MAPPINGS_REFERRAL_REASON') }}
                ON ds_pims_referrals.reasn_refno = l_mappings_referral_reason.RFVAL_REFNO
              LEFT OUTER JOIN {{ ref('TGT','S_SPECIALTY_1') }}
                ON ds_pims_referrals.refto_spect_refno = s_specialty_1.specialty_reference_no
        name: S_REFERRAL_05
        noLinkRefs: []
  name: S_REFERRAL_05
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
