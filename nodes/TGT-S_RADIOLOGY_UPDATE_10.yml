fileVersion: 1
id: 4513a90a-e3cd-4b96-a852-8eb037f5c55a
name: S_RADIOLOGY_UPDATE_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31b056f1-261b-4aae-a725-dce5fd2e00ec
          stepCounter: 4513a90a-e3cd-4b96-a852-8eb037f5c55a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9d51e8c-331b-475a-8672-f349addd4625
          stepCounter: 4513a90a-e3cd-4b96-a852-8eb037f5c55a
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SEQUENCE
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: row_number() over(PARTITION BY placer_group_reference ORDER BY messagedatetime)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3e2e3d3-9637-4ef1-959c-7f5a3b381803
          stepCounter: 4513a90a-e3cd-4b96-a852-8eb037f5c55a
        config: {}
        dataType: VARCHAR(22)
        defaultValue: ""
        description: ""
        name: PLACER_GROUP_REFERENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d12ee5e-2e45-4323-87b9-a082c8e5a589
          stepCounter: 4513a90a-e3cd-4b96-a852-8eb037f5c55a
        config: {}
        dataType: VARCHAR(24)
        defaultValue: ""
        description: ""
        name: MESSAGE_DATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b8425a1-822d-458c-a30b-c514053ec7f5
          stepCounter: 4513a90a-e3cd-4b96-a852-8eb037f5c55a
        config: {}
        dataType: VARCHAR(24)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE WHEN ds_HL7_RadiologyUpdateMessage.PatientType = 'D1' THEN 'COMRAD'
                          ELSE EventEncounter
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2da65d2-e0ff-4e3e-8532-36fdec269dfb
          stepCounter: 4513a90a-e3cd-4b96-a852-8eb037f5c55a
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_HL7_RADIOLOGYUPDATEMESSAGE
          - locationName: UNKNOWN
            nodeName: DS_HL7_RADIOLOGYUPDATEMESSAGE
        join:
          joinCondition: FROM {{ ref('UNKNOWN','DS_HL7_RADIOLOGYUPDATEMESSAGE') }}
        name: S_RADIOLOGY_UPDATE_10
        noLinkRefs: []
  name: S_RADIOLOGY_UPDATE_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
