fileVersion: 1
id: 05089bcb-0076-46d4-ab08-226b965e1462
name: S_WARD_SHIFT_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee517868-8514-4c2e-b33e-331ba73ef061
          stepCounter: 05089bcb-0076-46d4-ab08-226b965e1462
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Unique identifies each ward shift row.
        name: WARD_SHIFT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3931769-4505-4733-abdc-123832d68158
                stepCounter: f5dbfa9b-37fc-4018-a2aa-31c4a69831a1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b829a1a-19fc-4de9-81da-cfcfe0a43e82
          stepCounter: 05089bcb-0076-46d4-ab08-226b965e1462
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: SHIFT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 43b54409-f368-480b-9eb5-a263afeda665
                stepCounter: f5dbfa9b-37fc-4018-a2aa-31c4a69831a1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c1a5003-1088-45bf-a24b-b6850b781666
          stepCounter: 05089bcb-0076-46d4-ab08-226b965e1462
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: SHIFT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 342c5d2a-0836-4126-83a2-39ad7c762cb4
                stepCounter: f5dbfa9b-37fc-4018-a2aa-31c4a69831a1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95c68fa0-6797-4ae9-8560-b27cebaacf37
          stepCounter: 05089bcb-0076-46d4-ab08-226b965e1462
        config: {}
        dataType: NUMERIC(9,5)
        defaultValue: ""
        description: ""
        name: SHIFT_START_TIME_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a01b91c-bb06-443c-92cc-be691dc1a041
                stepCounter: f5dbfa9b-37fc-4018-a2aa-31c4a69831a1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7afeabcd-6c99-4a1e-ab55-1921117a6981
          stepCounter: 05089bcb-0076-46d4-ab08-226b965e1462
        config: {}
        dataType: NUMERIC(9,5)
        defaultValue: ""
        description: ""
        name: SHIFT_LENGTH_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ca8b7ed1-7288-4f5c-928c-f48940cece8d
                stepCounter: f5dbfa9b-37fc-4018-a2aa-31c4a69831a1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0615a600-5e9b-48e0-9544-6a07c4a837cb
          stepCounter: 05089bcb-0076-46d4-ab08-226b965e1462
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: ""
        name: WORKED_SHIFT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ee3891a-69d3-4ea9-9dfb-191a36225704
                stepCounter: f5dbfa9b-37fc-4018-a2aa-31c4a69831a1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f1162120-6660-4358-a408-0574acb3e748
          stepCounter: 05089bcb-0076-46d4-ab08-226b965e1462
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: ""
        name: TRENDCARE_WARD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0fb9b7a2-3d69-4d22-9ad2-fc53afb9d041
                stepCounter: f5dbfa9b-37fc-4018-a2aa-31c4a69831a1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 99b4b1e4-3ccc-4aa8-83b4-bf73166aa804
          stepCounter: 05089bcb-0076-46d4-ab08-226b965e1462
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PIMS_WARD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d427b6f8-539d-4413-81a7-bf590abd4177
                stepCounter: a18bc076-c380-4661-b7c4-e1b900547ff6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d75c784c-63ad-4aae-823a-ea2156d93032
          stepCounter: 05089bcb-0076-46d4-ab08-226b965e1462
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Service_Point_Reference_Number
        name: WARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 65baf514-8750-4e30-80ce-5f491362fa1c
                stepCounter: a18bc076-c380-4661-b7c4-e1b900547ff6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa1043b8-f5f9-49a6-b105-990c1a5a797d
          stepCounter: 05089bcb-0076-46d4-ab08-226b965e1462
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: ""
        name: RESOURCED_BEDS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 833f12f4-b285-4ab5-b613-ef179624de31
                stepCounter: f1e55d7b-a5d2-4843-b396-4646d16b6e79
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 290f5b74-2abf-4f11-8a48-69d6d922bb1a
          stepCounter: 05089bcb-0076-46d4-ab08-226b965e1462
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: ""
        name: AVAILABLE_BEDS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72275fbe-724b-46d2-8500-1251013da1f8
                stepCounter: f5dbfa9b-37fc-4018-a2aa-31c4a69831a1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd532f81-1c59-4859-9b3f-178c3cbef76e
          stepCounter: 05089bcb-0076-46d4-ab08-226b965e1462
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: ""
        name: CLOSED_BEDS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3363edb3-49a7-47be-b973-c8850a451616
                stepCounter: f5dbfa9b-37fc-4018-a2aa-31c4a69831a1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dab75baf-294a-4605-b06a-57df04e87b2c
          stepCounter: 05089bcb-0076-46d4-ab08-226b965e1462
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: ""
        name: TOTAL_PATIENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e2b0a3b-2e80-4c75-b7f3-38eb7e40510f
                stepCounter: f5dbfa9b-37fc-4018-a2aa-31c4a69831a1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f205720-f36e-4a8c-b091-c01978f5d915
          stepCounter: 05089bcb-0076-46d4-ab08-226b965e1462
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: ""
        name: ACUTE_PATIENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 496c9384-e5eb-4545-a4d2-60f70e5aa518
                stepCounter: f5dbfa9b-37fc-4018-a2aa-31c4a69831a1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5a8bc4b-b137-41d1-8fab-c8ab22778d3f
          stepCounter: 05089bcb-0076-46d4-ab08-226b965e1462
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: ""
        name: ELECTIVE_PATIENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c51fdf1e-973f-4ba0-9765-b33292e89fbc
                stepCounter: f5dbfa9b-37fc-4018-a2aa-31c4a69831a1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 970fb12f-1941-432e-a235-396289b585b4
          stepCounter: 05089bcb-0076-46d4-ab08-226b965e1462
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: ""
        name: ACTUALISED_PATIENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cbcef79b-6d59-43f7-9eb8-6be2510b7236
                stepCounter: f5dbfa9b-37fc-4018-a2aa-31c4a69831a1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d34274aa-cef1-4435-9a13-d495b5b5b907
          stepCounter: 05089bcb-0076-46d4-ab08-226b965e1462
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: ""
        name: UNCATEGORISED_PATIENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5cc2ad3c-61dd-46be-97a4-b943cd14d692
                stepCounter: f5dbfa9b-37fc-4018-a2aa-31c4a69831a1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98900d89-292d-44ea-96e0-101a620224f9
          stepCounter: 05089bcb-0076-46d4-ab08-226b965e1462
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: ""
        name: BRING_FORWARD_PATIENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e898a02f-547c-40c9-8632-d57d13197f7e
                stepCounter: f5dbfa9b-37fc-4018-a2aa-31c4a69831a1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11dea09f-0d15-4847-8156-61af6aef732e
          stepCounter: 05089bcb-0076-46d4-ab08-226b965e1462
        config: {}
        dataType: NUMERIC(9,5)
        defaultValue: ""
        description: ""
        name: WORKED_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e8735003-b2d9-49b3-8a78-666fabd02853
                stepCounter: f5dbfa9b-37fc-4018-a2aa-31c4a69831a1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18896591-a1d2-40f9-8941-788c6867ad83
          stepCounter: 05089bcb-0076-46d4-ab08-226b965e1462
        config: {}
        dataType: NUMERIC(9,5)
        defaultValue: ""
        description: ""
        name: REQUIRED_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8bdccd0f-832a-4cb9-9011-05bff73f4dbc
                stepCounter: f5dbfa9b-37fc-4018-a2aa-31c4a69831a1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa7fe84d-ee5d-42b2-b2f3-7d38d52ff934
          stepCounter: 05089bcb-0076-46d4-ab08-226b965e1462
        config: {}
        dataType: NUMERIC(9,5)
        defaultValue: ""
        description: ""
        name: ABSENT_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9ef52fb7-83a9-48e5-af15-8889c1da8e12
                stepCounter: f5dbfa9b-37fc-4018-a2aa-31c4a69831a1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a03b4d3f-7207-4df3-ad02-32a3a336d88a
          stepCounter: 05089bcb-0076-46d4-ab08-226b965e1462
        config: {}
        dataType: NUMERIC(9,5)
        defaultValue: ""
        description: ""
        name: PART_SPECIALLED_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7fa80de-b6c2-4385-9b5e-387cd677273f
                stepCounter: f5dbfa9b-37fc-4018-a2aa-31c4a69831a1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9001248a-703a-49b2-9235-4a20cc7434b9
          stepCounter: 05089bcb-0076-46d4-ab08-226b965e1462
        config: {}
        dataType: NUMERIC(9,5)
        defaultValue: ""
        description: ""
        name: SICK_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d517e77a-1227-4c96-bc9f-2f25c3575c53
                stepCounter: f5dbfa9b-37fc-4018-a2aa-31c4a69831a1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ba3e074-266f-4d37-a27b-1c04cb085b23
          stepCounter: 05089bcb-0076-46d4-ab08-226b965e1462
        config: {}
        dataType: NUMERIC(9,5)
        defaultValue: ""
        description: ""
        name: SPECIALLED_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 88d34b9a-e44f-4e5a-ab1b-0c34ee6d1a12
                stepCounter: f5dbfa9b-37fc-4018-a2aa-31c4a69831a1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2dbc4aa-01f7-4e91-a09e-47218ba432d6
          stepCounter: 05089bcb-0076-46d4-ab08-226b965e1462
        config: {}
        dataType: NUMERIC(9,5)
        defaultValue: ""
        description: ""
        name: TRAINING_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c9912c0e-d7f2-4192-8b44-a356ce92422a
                stepCounter: f5dbfa9b-37fc-4018-a2aa-31c4a69831a1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ec64867-7f68-4695-8dcd-1940bf6b2d36
          stepCounter: 05089bcb-0076-46d4-ab08-226b965e1462
        config: {}
        dataType: NUMERIC(9,5)
        defaultValue: ""
        description: ""
        name: CLINICAL_PROFILE_RN_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 920022c0-f2e5-41ed-a91b-bcd5b05e11e1
                stepCounter: f5dbfa9b-37fc-4018-a2aa-31c4a69831a1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e627a60-9bd1-4cff-bcde-4059eb3e936b
          stepCounter: 05089bcb-0076-46d4-ab08-226b965e1462
        config: {}
        dataType: NUMERIC(9,5)
        defaultValue: ""
        description: ""
        name: CLINICAL_PROFILE_EN_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16f7e8f5-eb21-4b94-be4b-7650e29ddd08
                stepCounter: f5dbfa9b-37fc-4018-a2aa-31c4a69831a1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7540842-7865-4fcf-875b-69794429844b
          stepCounter: 05089bcb-0076-46d4-ab08-226b965e1462
        config: {}
        dataType: NUMERIC(9,5)
        defaultValue: ""
        description: ""
        name: CLINICAL_PROFILE_OTHER_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4fd8bc7-700c-40e4-9faa-47deba1468a8
                stepCounter: f5dbfa9b-37fc-4018-a2aa-31c4a69831a1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4cefc723-b45f-4ab3-a1b5-4bf9c730e782
          stepCounter: 05089bcb-0076-46d4-ab08-226b965e1462
        config: {}
        dataType: NUMERIC(9,5)
        defaultValue: ""
        description: ""
        name: HPPD_PROFILE_VALUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50543ce3-6381-45a7-8cb2-fcbc262a0c8b
                stepCounter: f5dbfa9b-37fc-4018-a2aa-31c4a69831a1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09e46946-5a1b-4cbf-9c7a-94ffc087cf94
          stepCounter: 05089bcb-0076-46d4-ab08-226b965e1462
        config: {}
        dataType: NUMERIC(9,5)
        defaultValue: ""
        description: ""
        name: MINIMUM_PROFILE_RN_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 31295eaa-d69f-41c4-9424-4fc5e05d59fa
                stepCounter: f5dbfa9b-37fc-4018-a2aa-31c4a69831a1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4251ad67-2b43-492e-a54b-1f4f47be851f
          stepCounter: 05089bcb-0076-46d4-ab08-226b965e1462
        config: {}
        dataType: NUMERIC(9,5)
        defaultValue: ""
        description: ""
        name: MINIMUM_PROFILE_EN_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c93f6fb-82d0-40b6-97a8-a501cca07ce9
                stepCounter: f5dbfa9b-37fc-4018-a2aa-31c4a69831a1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 23bebf19-376d-464b-8069-b39037797534
          stepCounter: 05089bcb-0076-46d4-ab08-226b965e1462
        config: {}
        dataType: NUMERIC(9,5)
        defaultValue: ""
        description: ""
        name: MINIMUM_PROFILE_OTHER_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5b969bf7-d42b-49c6-b23e-2a009fe03dec
                stepCounter: f5dbfa9b-37fc-4018-a2aa-31c4a69831a1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03868b6e-4281-4c72-bc47-213d1b06451e
          stepCounter: 05089bcb-0076-46d4-ab08-226b965e1462
        config: {}
        dataType: NUMERIC(9,5)
        defaultValue: ""
        description: ""
        name: RATIO_PROFILE_VALUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7840b74c-d18b-41c1-a322-963219add7e3
                stepCounter: f5dbfa9b-37fc-4018-a2aa-31c4a69831a1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2c69679-eb5a-45e5-8554-2ec07a25c185
          stepCounter: 05089bcb-0076-46d4-ab08-226b965e1462
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: CLOSE_BED_REASON_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00899955-b596-4add-9661-6711d4e74f3f
                stepCounter: f5dbfa9b-37fc-4018-a2aa-31c4a69831a1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8eb3facc-a039-416e-8cd7-57981a51e4bf
          stepCounter: 05089bcb-0076-46d4-ab08-226b965e1462
        config: {}
        dataType: VARCHAR(512)
        defaultValue: ""
        description: ""
        name: SHIFT_NOTES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1281a626-2fb5-4248-bb42-bccb187923b4
                stepCounter: f5dbfa9b-37fc-4018-a2aa-31c4a69831a1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a4924d6c-ed52-4319-bed4-af9e82e23232
          stepCounter: 05089bcb-0076-46d4-ab08-226b965e1462
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_CHANGE_DATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 41809808-97d1-42e0-abb3-eea9894e7f28
                stepCounter: f5dbfa9b-37fc-4018-a2aa-31c4a69831a1
            transform: NULLIF(tlLastChangeStaffShiftDatetime, '2777-07-07')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92737be0-6e89-43f2-bb3e-8952593e1281
          stepCounter: 05089bcb-0076-46d4-ab08-226b965e1462
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DS_TCARE_WARD_BED: f1e55d7b-a5d2-4843-b396-4646d16b6e79
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_TCARE_SUMMARYSHIFT
          - locationName: TGT
            nodeName: DS_TCARE_WARD_BED
        join:
          joinCondition: |-
            FROM ds_tcare_SummaryShift
              LEFT OUTER JOIN (
                    SELECT DISTINCT trendcare_ward_code,
                           pims_ward_code,
                           ward_reference_no
                      FROM s_ward_shift_dim
                   ) s_ward_shift_dim
                ON ds_tcare_SummaryShift.tlWardCode = s_ward_shift_dim.trendcare_ward_code
              LEFT OUTER JOIN {{ ref('TGT','DS_TCARE_WARD_BED') }}
                ON ds_tcare_SummaryShift.tlWardCode = ds_tcare_ward_bed.trendcare_ward_code
               AND ds_tcare_SummaryShift.tlDate = ds_tcare_ward_bed.shift_date
             WHERE ds_tcare_SummaryShift.tlDate >= CONVERT(datetime, @v_pa_trendcare_Incremental, 120)-30
        name: S_WARD_SHIFT_10
        noLinkRefs: []
  name: S_WARD_SHIFT_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
