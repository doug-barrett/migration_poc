fileVersion: 1
id: 12769581-a2b9-47bf-b7f5-99a1a7ba1c51
name: ODS_BUDGET_CSV_LOADS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Budget CSV Data Loads"
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d50f2fd9-46bc-4b3d-9f33-b4de2e4f01df
          stepCounter: 12769581-a2b9-47bf-b7f5-99a1a7ba1c51
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: Common ID amungst all csv files (last 14 digits - timestamp)
        isBusinessKey: true
        name: FILE_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b175f75d-3df2-4848-a064-e90b06d7c630
                stepCounter: db6d0c16-edfb-4ef6-9dd1-71529cbc1dd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc430609-9b5b-4402-b5ca-d9b97af1c772
          stepCounter: 12769581-a2b9-47bf-b7f5-99a1a7ba1c51
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: Type of data in source CSV file. Prefix code of CSV file
        isBusinessKey: true
        name: LOAD_FILE_TYPE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7291bb72-7c25-4965-b15a-8ba3ace2a2ec
                stepCounter: db6d0c16-edfb-4ef6-9dd1-71529cbc1dd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 900bdc26-80a1-49db-815b-541d55437908
          stepCounter: 12769581-a2b9-47bf-b7f5-99a1a7ba1c51
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: R_VERSION.IDX for Budget Version currently being loaded
        isBusinessKey: true
        name: FK_R_VERSION_IDX
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c426fa3c-3b43-49ea-84ee-a46727639d3c
                stepCounter: db6d0c16-edfb-4ef6-9dd1-71529cbc1dd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 888113d6-62fd-4d39-bd1c-6192ff02d060
          stepCounter: 12769581-a2b9-47bf-b7f5-99a1a7ba1c51
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: EFFECTIVE_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 92f27b33-c795-48ff-a6e9-d7aca696534c
                stepCounter: db6d0c16-edfb-4ef6-9dd1-71529cbc1dd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05bc4338-7054-4418-9ed5-bdd50af1b2d4
          stepCounter: 12769581-a2b9-47bf-b7f5-99a1a7ba1c51
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: DEST_ORG_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0fedf2af-e795-48c4-b3db-ace129373218
                stepCounter: db6d0c16-edfb-4ef6-9dd1-71529cbc1dd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6fb6569-7045-4a69-9902-34b621459d6c
          stepCounter: 12769581-a2b9-47bf-b7f5-99a1a7ba1c51
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: COST_CENTRE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bcaf84cf-d09a-4ec8-9326-61f3fec89cd4
                stepCounter: db6d0c16-edfb-4ef6-9dd1-71529cbc1dd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cfbdbc95-4048-4b24-86a8-22fe02f8d63c
          stepCounter: 12769581-a2b9-47bf-b7f5-99a1a7ba1c51
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: FUNCTIONAL_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e0e99d00-325e-4be0-89af-cbb910b8ce7d
                stepCounter: db6d0c16-edfb-4ef6-9dd1-71529cbc1dd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b11a27d8-9523-4cac-bee1-3e1c309528f6
          stepCounter: 12769581-a2b9-47bf-b7f5-99a1a7ba1c51
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: ACCOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 85fd2052-ced4-40bc-935a-2400bcf61330
                stepCounter: db6d0c16-edfb-4ef6-9dd1-71529cbc1dd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8f7d61c-a649-44d8-9f13-53973c6f5578
          stepCounter: 12769581-a2b9-47bf-b7f5-99a1a7ba1c51
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: AFE_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 737b0f07-227a-428b-92f2-c60f87ae99db
                stepCounter: db6d0c16-edfb-4ef6-9dd1-71529cbc1dd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3cdc1007-0493-4522-a9e3-1d3761921d94
          stepCounter: 12769581-a2b9-47bf-b7f5-99a1a7ba1c51
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: GROSS_OR_NET
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: acee564e-ccf0-48df-87d6-485b6fd43fc1
                stepCounter: db6d0c16-edfb-4ef6-9dd1-71529cbc1dd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd9a2f3e-1e9e-4db7-b204-7979b8964f48
          stepCounter: 12769581-a2b9-47bf-b7f5-99a1a7ba1c51
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: ACTVY_PER_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 431325a4-a95a-44a1-84b2-18827e036fb4
                stepCounter: db6d0c16-edfb-4ef6-9dd1-71529cbc1dd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c839e622-1f75-456c-8dde-facc020bc112
          stepCounter: 12769581-a2b9-47bf-b7f5-99a1a7ba1c51
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: ACCT_PER_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d04c7f54-24a6-4734-ae57-ddd3d4101bf6
                stepCounter: db6d0c16-edfb-4ef6-9dd1-71529cbc1dd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8874d3e5-b9e0-419e-8c22-565def2ae641
          stepCounter: 12769581-a2b9-47bf-b7f5-99a1a7ba1c51
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Monthly Amount
        name: AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d44db43-57c5-47a2-a628-9b15f5031fd7
                stepCounter: db6d0c16-edfb-4ef6-9dd1-71529cbc1dd6
            transform: DECODE(STAGE_BUDGET_CSV_FINAL.AMT_CURR_CODE ,NULL,NULL ,STAGE_BUDGET_CSV_FINAL.AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f7c6e4e-cf59-437c-b238-5e7c17cc8a36
          stepCounter: 12769581-a2b9-47bf-b7f5-99a1a7ba1c51
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: AMT_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4999c4a1-0d3b-4693-821f-1ad9ed3e78d1
                stepCounter: db6d0c16-edfb-4ef6-9dd1-71529cbc1dd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a0c60444-f9e4-47fa-9c1f-902238cc42c6
          stepCounter: 12769581-a2b9-47bf-b7f5-99a1a7ba1c51
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: LINE_ITEMS.LI_VOL
        name: VOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d44db43-57c5-47a2-a628-9b15f5031fd7
                stepCounter: db6d0c16-edfb-4ef6-9dd1-71529cbc1dd6
            transform: DECODE(STAGE_BUDGET_CSV_FINAL.VOL_UOM_CODE ,NULL,NULL ,STAGE_BUDGET_CSV_FINAL.AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c3e66c1-9a2b-4467-9c1c-87c21ec6e310
          stepCounter: 12769581-a2b9-47bf-b7f5-99a1a7ba1c51
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: SI, M3, BOE, IMPERIAL
        name: VOL_UOM_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 14b05968-0fb2-44e4-8234-2789c16db971
                stepCounter: db6d0c16-edfb-4ef6-9dd1-71529cbc1dd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8eee2c5-6b89-421c-9075-68a6c1bcb606
          stepCounter: 12769581-a2b9-47bf-b7f5-99a1a7ba1c51
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: ORIG_FILENAME
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4f2f1b87-ff57-46f4-ac46-d4fc2e4e91f5
                stepCounter: db6d0c16-edfb-4ef6-9dd1-71529cbc1dd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1e804a3-cb08-4bd0-b2cb-0574d17fda94
          stepCounter: 12769581-a2b9-47bf-b7f5-99a1a7ba1c51
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: Record source.
        name: DSS_RECORD_SOURCE_LI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b808b01-74a4-4235-a7be-a290574b6777
                stepCounter: db6d0c16-edfb-4ef6-9dd1-71529cbc1dd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 118d7a48-89e4-40b0-8597-7d96665041f7
          stepCounter: 12769581-a2b9-47bf-b7f5-99a1a7ba1c51
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: Record source.
        name: DSS_RECORD_SOURCE_HDR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a27296a-442c-468d-916a-1e689648388b
                stepCounter: db6d0c16-edfb-4ef6-9dd1-71529cbc1dd6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5016e14f-be0d-4aed-a53b-dabcb4f2bf37
          stepCounter: 12769581-a2b9-47bf-b7f5-99a1a7ba1c51
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d88f673-eb69-4257-b56d-4d5ae235cd0c
          stepCounter: 12769581-a2b9-47bf-b7f5-99a1a7ba1c51
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b83ac9f-a842-46c4-a1f6-6262f8367630
          stepCounter: 12769581-a2b9-47bf-b7f5-99a1a7ba1c51
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Load date of CSV file into Data Store
        name: DS_LOADED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_BUDGET_CSV_FINAL: db6d0c16-edfb-4ef6-9dd1-71529cbc1dd6
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STAGE_BUDGET_CSV_FINAL
        join:
          joinCondition: FROM {{ ref('TARGET','STAGE_BUDGET_CSV_FINAL') }} STAGE_BUDGET_CSV_FINAL
        name: ODS_BUDGET_CSV_LOADS
        noLinkRefs: []
  name: ODS_BUDGET_CSV_LOADS
  overrideSQL: false
  schema: ""
  sqlType: '38'
  type: sql
  version: 1
type: Node
