fileVersion: 1
id: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
name: VIEW_FACT_FDC_PRODVIEW_DOWNTIME
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: "Calculate lost production using 15 day averages with hours on greater than 4"
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 006f2563-e5fe-45d7-9883-15ba4ffd3778
          stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ENTITY_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 006f2563-e5fe-45d7-9883-15ba4ffd3778
                stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f083a3c-64af-4aa1-a70e-1881c73251db
          stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
        config: {}
        dataType: VARCHAR(753)
        defaultValue: ""
        description: ""
        name: SCENARIO_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2f083a3c-64af-4aa1-a70e-1881c73251db
                stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6600e47c-b94c-4859-98a6-09adfdfe2d36
          stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
        config: {}
        dataType: NUMBER(1)
        defaultValue: ""
        description: ""
        name: GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6600e47c-b94c-4859-98a6-09adfdfe2d36
                stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47da7f6c-f752-4508-b7e2-782dd9d89d3b
          stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ACTIVITY_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47da7f6c-f752-4508-b7e2-782dd9d89d3b
                stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b2104d1-e896-44d5-8736-ef41526268fa
          stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: ACTIVITY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9b2104d1-e896-44d5-8736-ef41526268fa
                stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f855f85f-f923-48a4-b7d5-f1dcbf935cf1
          stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
        config: {}
        dataType: NUMBER(10)
        defaultValue: ""
        description: ""
        name: NORMALIZED_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f855f85f-f923-48a4-b7d5-f1dcbf935cf1
                stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f63572ef-a22d-40b9-877a-7393c7bdfa80
          stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: PRODUCING_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f63572ef-a22d-40b9-877a-7393c7bdfa80
                stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72c68254-f98a-42ca-aafe-f0e903b53749
          stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ON_PROD_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72c68254-f98a-42ca-aafe-f0e903b53749
                stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67d6b321-8ead-4d23-946c-7364d2afb502
          stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67d6b321-8ead-4d23-946c-7364d2afb502
                stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8ab4781-f019-4ae1-b216-86a1778548aa
          stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: HOURS_ON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a8ab4781-f019-4ae1-b216-86a1778548aa
                stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e9b6114-92b7-4b2b-9b55-d43b9ee4edea
          stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: HOURS_DOWN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e9b6114-92b7-4b2b-9b55-d43b9ee4edea
                stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70339077-c71b-480b-9548-8690160a587b
          stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODE1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 70339077-c71b-480b-9548-8690160a587b
                stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1a5a033-d1ae-48e4-84c9-95f56bb18ede
          stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODE2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c1a5a033-d1ae-48e4-84c9-95f56bb18ede
                stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1033466e-6361-4fbe-a25c-bccc90b5905a
          stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODE3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1033466e-6361-4fbe-a25c-bccc90b5905a
                stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 593f6972-ba5f-4f7b-b1f9-0ff85dde0b0f
          stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
        config: {}
        dataType: VARCHAR(2000)
        defaultValue: ""
        description: ""
        name: DT_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 593f6972-ba5f-4f7b-b1f9-0ff85dde0b0f
                stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5dfbaa45-d83e-4ad5-9fca-a6a16b1a3708
          stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: SYSCREATEUSER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5dfbaa45-d83e-4ad5-9fca-a6a16b1a3708
                stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7fc6d816-92bf-40ec-bb31-af10327d6265
          stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: SYSMODUSER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7fc6d816-92bf-40ec-bb31-af10327d6265
                stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7a8d4f0-6a55-4de5-9d0e-d549ddb08172
          stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: LOST_OIL_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b7a8d4f0-6a55-4de5-9d0e-d549ddb08172
                stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5143cfa2-5e1b-4829-9dc3-16d0b43916c1
          stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: LOST_OIL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5143cfa2-5e1b-4829-9dc3-16d0b43916c1
                stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 347c103e-e2b6-4f1d-94ec-f85d9f98964a
          stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: LOST_OIL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 347c103e-e2b6-4f1d-94ec-f85d9f98964a
                stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2072d46-eef0-449a-baad-86d875463921
          stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: LOST_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2072d46-eef0-449a-baad-86d875463921
                stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 339374a4-a0bc-497d-84b7-0cb67146eef2
          stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: LOST_GAS_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 339374a4-a0bc-497d-84b7-0cb67146eef2
                stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 722bb0c1-c764-49f6-9a38-a91a7ab77305
          stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: LOST_GAS_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 722bb0c1-c764-49f6-9a38-a91a7ab77305
                stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 68effb52-f65c-41a1-aefe-602a06ba21ef
          stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: LOST_COND_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 68effb52-f65c-41a1-aefe-602a06ba21ef
                stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cbcff41d-66dd-4c6f-9344-ba892a9dfbc1
          stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: LOST_COND_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cbcff41d-66dd-4c6f-9344-ba892a9dfbc1
                stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 36655a41-320a-48b7-9324-3c79079ef8d4
          stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: LOST_COND_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 36655a41-320a-48b7-9324-3c79079ef8d4
                stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16c1b2a0-d270-4f12-9811-3ea3a68709d8
          stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: LOST_NGL_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16c1b2a0-d270-4f12-9811-3ea3a68709d8
                stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b88c5d2-bfb2-4975-a1c1-ca923ab71a05
          stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: LOST_NGL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b88c5d2-bfb2-4975-a1c1-ca923ab71a05
                stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09fc85a0-8bdd-47ff-9372-18dbb7548a18
          stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: LOST_NGL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09fc85a0-8bdd-47ff-9372-18dbb7548a18
                stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5172a0d5-9797-44b0-8603-ffd5a0142605
          stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: AVG_OIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5172a0d5-9797-44b0-8603-ffd5a0142605
                stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd118117-433d-4852-ab2c-8b523db2af76
          stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: AVG_OIL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bd118117-433d-4852-ab2c-8b523db2af76
                stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b2437d9e-4d53-4c08-90dc-20d08479bb18
          stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: AVG_OIL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2437d9e-4d53-4c08-90dc-20d08479bb18
                stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bff43d93-5a7e-4ad2-91fb-ab6d2365444a
          stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: AVG_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bff43d93-5a7e-4ad2-91fb-ab6d2365444a
                stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 51de010b-4c49-46c1-b993-fe7498b5aa8d
          stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: AVG_GAS_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51de010b-4c49-46c1-b993-fe7498b5aa8d
                stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b079fa5-b053-4cbc-9114-dd8169aa609f
          stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: AVG_GAS_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6b079fa5-b053-4cbc-9114-dd8169aa609f
                stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4c8b06b-5873-4ec5-9936-168e184ca928
          stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: AVG_COND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4c8b06b-5873-4ec5-9936-168e184ca928
                stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8561eb70-aaa2-4b7a-9182-132b88eace0c
          stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: AVG_COND_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8561eb70-aaa2-4b7a-9182-132b88eace0c
                stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72556e2e-f792-4ca6-92a3-94c936f40bce
          stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: AVG_COND_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72556e2e-f792-4ca6-92a3-94c936f40bce
                stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 90497819-4906-44c9-97d9-cbb01ca1f626
          stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: AVG_NGL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90497819-4906-44c9-97d9-cbb01ca1f626
                stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 949a3b21-8b88-4b97-9937-534424449f4f
          stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: AVG_NGL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 949a3b21-8b88-4b97-9937-534424449f4f
                stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9f78452-b699-4d92-8c00-914ccfa1eef7
          stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: AVG_NGL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c9f78452-b699-4d92-8c00-914ccfa1eef7
                stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 90e1674d-a4e2-4107-8272-c20ed732bc11
          stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: AVG_HOURS_ON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90e1674d-a4e2-4107-8272-c20ed732bc11
                stepCounter: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_FACT_FDC_PRODVIEW_DOWNTIME: 9dced4b0-c961-4d44-b61e-a24e4f7c9fa8
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_FACT_FDC_PRODVIEW_DOWNTIME') }} AS WITH PROD_CTE AS (
                    SELECT *,
                           NVL(OIL_BOE, 0) + NVL(GAS_BOE, 0) + NVL(COND_BOE, 0) + NVL(NGL_BOE, 0) AS TOTAL_BOE
                      FROM(
                            SELECT P.IDREC,
                                   P.IDRECUNIT AS ENTITY_KEY,
                                   W.STATUS,
                                   W.STATUS_DATE,
                                   P.DTTM AS ACTIVITY_DATE,
                                   P.DUROP * 24 AS HOURS_ON,
                                   P.DURDOWN * 24 AS HOURS_DOWN,
                                   P.VOLNEWPRODALLOCOIL AS OIL_METRIC,
                                   P.VOLNEWPRODALLOCOIL * NVL(CF.LIQUID_BOE_THERMAL, 1) AS OIL_IMPERIAL,
                                   P.VOLNEWPRODALLOCOIL * NVL(CF.LIQUID_BOE_THERMAL, 1) AS OIL_BOE,
                                   (P.VOLDISPSALEGAS / 1000) AS GAS_METRIC,
                                   (P.VOLDISPSALEGAS / 1000) * NVL(CF.GAS_SI_TO_IMP_CONV_FACTOR, 1) AS GAS_IMPERIAL,
                                   (P.VOLDISPSALEGAS / 1000) * NVL(CF.GAS_BOE_THERMAL, 1) AS GAS_BOE,
                                   P.VOLNEWPRODALLOCCOND AS COND_METRIC,
                                   P.VOLNEWPRODALLOCCOND * NVL(CF.LIQUID_BOE_THERMAL, 1) AS COND_IMPERIAL,
                                   P.VOLNEWPRODALLOCCOND * NVL(CF.LIQUID_BOE_THERMAL, 1) AS COND_BOE,
                                   P.VOLNEWPRODALLOCNGL AS NGL_METRIC,
                                   P.VOLNEWPRODALLOCNGL * NVL(CF.LIQUID_BOE_THERMAL, 1) AS NGL_IMPERIAL,
                                   P.VOLNEWPRODALLOCNGL * NVL(CF.LIQUID_BOE_THERMAL, 1) AS NGL_BOE
                              FROM "WS_DATA_STORE"."ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY" P
                              JOIN "WS_STAGE_BT"."STAGE_PRODVIEW_WELLS" W
                                ON P.IDFLOWNET = W.IDFLOWNET
                               AND P.IDRECUNIT = W.ENTITY_KEY
                              JOIN (
                                    SELECT DISTINCT MAX(CASE WHEN PROD_CODE IN ('GAS','GCOMP','GGATH','GPROC') THEN SI_TO_IMP_CONV_FACTOR END) AS GAS_SI_TO_IMP_CONV_FACTOR,
                                           MAX(CASE WHEN PROD_CODE IN ('GAS','GCOMP','GGATH','GPROC') THEN BOE_THERMAL END) AS GAS_BOE_THERMAL,
                                           MAX(CASE WHEN PROD_CODE NOT IN ('GAS','GCOMP','GGATH','GPROC') THEN BOE_THERMAL END) AS LIQUID_BOE_THERMAL
                                      FROM "WS_STAGE_BT"."STAGE_FIN_SAP_PRODUCT_TYPE"
                                   ) CF
                                ON 1 = 1
                             WHERE (DUROP * 24) >= 4
                               AND W.ENTITY_KEY NOT IN (
                                    SELECT ENTITY_KEY
                                      FROM "WS_STAGE_BT"."STAGE_PRODVIEW_WELLS" W
                                     WHERE W.HIGH_PRIORITY = 'Y'
                                       AND W.COUNTRY = 'FRANCE'
                                   )
                               AND P.DSS_CURRENT_FLAG = 'Y'
                               AND P.DSS_DELETE_FLAG != 'Y'
                           )
                   ),
                   AVG_CTE AS (
                    SELECT A.IDREC,
                           A.ENTITY_KEY,
                           A.ACTIVITY_DATE,
                           A."15D_AVG_OIL",
                           A."15D_AVG_OIL_IMPERIAL",
                           A."15D_AVG_OIL_BOE",
                           A."15D_AVG_GAS",
                           A."15D_AVG_GAS_IMPERIAL",
                           A."15D_AVG_GAS_BOE",
                           A."15D_AVG_COND",
                           A."15D_AVG_COND_IMPERIAL",
                           A."15D_AVG_COND_BOE",
                           A."15D_AVG_NGL",
                           A."15D_AVG_NGL_IMPERIAL",
                           A."15D_AVG_NGL_BOE",
                           A."15D_AVG_TOTAL_BOE",
                           A."15D_AVG_HOURS_ON",
                           A."15D_AVG_OIL" / A."15D_AVG_HOURS_ON" AS AVG_OIL_PER_HOUR,
                           A."15D_AVG_OIL_IMPERIAL" / A."15D_AVG_HOURS_ON" AS AVG_OIL_IMPERIAL_PER_HOUR,
                           A."15D_AVG_OIL_BOE" / A."15D_AVG_HOURS_ON" AS AVG_OIL_BOE_PER_HOUR,
                           A."15D_AVG_GAS" / A."15D_AVG_HOURS_ON" AS AVG_GAS_PER_HOUR,
                           A."15D_AVG_GAS_IMPERIAL" / A."15D_AVG_HOURS_ON" AS AVG_GAS_IMPERIAL_PER_HOUR,
                           A."15D_AVG_GAS_BOE" / A."15D_AVG_HOURS_ON" AS AVG_GAS_BOE_PER_HOUR,
                           A."15D_AVG_COND" / A."15D_AVG_HOURS_ON" AS AVG_COND_PER_HOUR,
                           A."15D_AVG_COND_IMPERIAL" / A."15D_AVG_HOURS_ON" AS AVG_COND_IMPERIAL_PER_HOUR,
                           A."15D_AVG_COND_BOE" / A."15D_AVG_HOURS_ON" AS AVG_COND_BOE_PER_HOUR,
                           A."15D_AVG_NGL" / A."15D_AVG_HOURS_ON" AS AVG_NGL_PER_HOUR,
                           A."15D_AVG_NGL_IMPERIAL" / A."15D_AVG_HOURS_ON" AS AVG_NGL_IMPERIAL_PER_HOUR,
                           A."15D_AVG_NGL_BOE" / A."15D_AVG_HOURS_ON" AS AVG_NGL_BOE_PER_HOUR,
                           A."15D_AVG_TOTAL_BOE" / A."15D_AVG_HOURS_ON" AS AVG_TOTAL_BOE_PER_HOUR,
                           DATEDIFF(DAY, A.AVG_START_DATE, A.AVG_END_DATE) + 1 AS NUM_DAYS
                      FROM (
                            SELECT P.IDREC,
                                   P.ENTITY_KEY,
                                   P.STATUS,
                                   P.STATUS_DATE,
                                   P.ACTIVITY_DATE,
                                   P.HOURS_ON,
                                   P.HOURS_DOWN,
                                   AVG(OIL_METRIC) OVER (PARTITION BY P.ENTITY_KEY ORDER BY P.ACTIVITY_DATE ROWS BETWEEN 15 PRECEDING AND 1 PRECEDING) AS "15D_AVG_OIL",
                                   AVG(OIL_IMPERIAL) OVER (PARTITION BY P.ENTITY_KEY ORDER BY P.ACTIVITY_DATE ROWS BETWEEN 15 PRECEDING AND 1 PRECEDING) AS "15D_AVG_OIL_IMPERIAL",
                                   AVG(OIL_BOE) OVER (PARTITION BY P.ENTITY_KEY ORDER BY P.ACTIVITY_DATE ROWS BETWEEN 15 PRECEDING AND 1 PRECEDING) AS "15D_AVG_OIL_BOE",
                                   AVG(GAS_METRIC) OVER (PARTITION BY P.ENTITY_KEY ORDER BY P.ACTIVITY_DATE ROWS BETWEEN 15 PRECEDING AND 1 PRECEDING) AS "15D_AVG_GAS",
                                   AVG(GAS_IMPERIAL) OVER (PARTITION BY P.ENTITY_KEY ORDER BY P.ACTIVITY_DATE ROWS BETWEEN 15 PRECEDING AND 1 PRECEDING) AS "15D_AVG_GAS_IMPERIAL",
                                   AVG(GAS_BOE) OVER (PARTITION BY P.ENTITY_KEY ORDER BY P.ACTIVITY_DATE ROWS BETWEEN 15 PRECEDING AND 1 PRECEDING) AS "15D_AVG_GAS_BOE",
                                   AVG(COND_METRIC) OVER (PARTITION BY P.ENTITY_KEY ORDER BY P.ACTIVITY_DATE ROWS BETWEEN 15 PRECEDING AND 1 PRECEDING) AS "15D_AVG_COND",
                                   AVG(COND_IMPERIAL) OVER (PARTITION BY P.ENTITY_KEY ORDER BY P.ACTIVITY_DATE ROWS BETWEEN 15 PRECEDING AND 1 PRECEDING) AS "15D_AVG_COND_IMPERIAL",
                                   AVG(COND_BOE) OVER (PARTITION BY P.ENTITY_KEY ORDER BY P.ACTIVITY_DATE ROWS BETWEEN 15 PRECEDING AND 1 PRECEDING) AS "15D_AVG_COND_BOE",
                                   AVG(NGL_METRIC) OVER (PARTITION BY P.ENTITY_KEY ORDER BY P.ACTIVITY_DATE ROWS BETWEEN 15 PRECEDING AND 1 PRECEDING) AS "15D_AVG_NGL",
                                   AVG(NGL_IMPERIAL) OVER (PARTITION BY P.ENTITY_KEY ORDER BY P.ACTIVITY_DATE ROWS BETWEEN 15 PRECEDING AND 1 PRECEDING) AS "15D_AVG_NGL_IMPERIAL",
                                   AVG(NGL_BOE) OVER (PARTITION BY P.ENTITY_KEY ORDER BY P.ACTIVITY_DATE ROWS BETWEEN 15 PRECEDING AND 1 PRECEDING) AS "15D_AVG_NGL_BOE",
                                   AVG(TOTAL_BOE) OVER (PARTITION BY P.ENTITY_KEY ORDER BY P.ACTIVITY_DATE ROWS BETWEEN 14 PRECEDING AND CURRENT ROW) AS "15D_AVG_TOTAL_BOE",
                                   AVG(HOURS_ON) OVER (PARTITION BY P.ENTITY_KEY ORDER BY P.ACTIVITY_DATE ROWS BETWEEN 14 PRECEDING AND CURRENT ROW) AS "15D_AVG_HOURS_ON",
                                   MIN(ACTIVITY_DATE) OVER (PARTITION BY P.ENTITY_KEY ORDER BY P.ACTIVITY_DATE ROWS BETWEEN 15 PRECEDING AND 1 PRECEDING) AS AVG_START_DATE,
                                   MAX(ACTIVITY_DATE) OVER (PARTITION BY P.ENTITY_KEY ORDER BY P.ACTIVITY_DATE ROWS BETWEEN 15 PRECEDING AND 1 PRECEDING) AS AVG_END_DATE
                              FROM PROD_CTE P
                           ) A
                     WHERE DATEDIFF(DAY, A.AVG_START_DATE, A.AVG_END_DATE) + 1 < 60
                   ) SELECT *
              FROM (
                    SELECT SRC.ENTITY_KEY,
                           SRC.SCENARIO_KEY,
                           G_N.GN AS GROSS_NET_KEY,
                           SRC.ACTIVITY_DATE_KEY,
                           SRC.DTTM AS ACTIVITY_DATE,
                           SRC.NORMALIZED_DATE_KEY,
                           SRC.PRODUCING_DATE_KEY,
                           SRC.ON_PROD_DATE_KEY,
                           SRC.CC_NUM,
                           SRC.HOURS_ON,
                           SRC.HOURS_DOWN,
                           SRC.CODE1,
                           SRC.CODE2,
                           SRC.CODE3,
                           SRC.DT_COMMENT,
                           SRC.SYSCREATEUSER,
                           SRC.SYSMODUSER, -- LOST PRODUCTION
             CASE WHEN (SRC.DTTM >= SRC.STATUS_DATE AND SRC.STATUS IN ('Injecting','Inj','Converted to Injection','Injection')) OR DATEDIFF(DAY, LAST_VALUE(LAST_PROD_DATE IGNORE NULLS) OVER (PARTITION BY SRC.ENTITY_KEY, G_N.GN ORDER BY SRC.DTTM ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING), SRC.DTTM) > 60 THEN NULL
                                ELSE AVG_OIL_BOE_PER_HOUR * SRC.HOURS_DOWN * CASE WHEN G_N.GN = 2 THEN SRC.WIHCLIQ ELSE 1 END
                                 END AS LOST_OIL_BOE,
                           CASE WHEN (SRC.DTTM >= SRC.STATUS_DATE AND SRC.STATUS IN ('Injecting','Inj','Converted to Injection','Injection')) OR DATEDIFF(DAY, LAST_VALUE(LAST_PROD_DATE IGNORE NULLS) OVER (PARTITION BY SRC.ENTITY_KEY, G_N.GN ORDER BY SRC.DTTM ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING), SRC.DTTM) > 60 THEN NULL
                                ELSE AVG_GAS_BOE_PER_HOUR * SRC.HOURS_DOWN * CASE WHEN G_N.GN = 2 THEN SRC.WIGAS ELSE 1 END
                                 END AS LOST_GAS_BOE,
                           CASE WHEN (SRC.DTTM >= SRC.STATUS_DATE AND SRC.STATUS IN ('Injecting','Inj','Converted to Injection','Injection')) OR DATEDIFF(DAY, LAST_VALUE(LAST_PROD_DATE IGNORE NULLS) OVER (PARTITION BY SRC.ENTITY_KEY, G_N.GN ORDER BY SRC.DTTM ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING), SRC.DTTM) > 60 THEN NULL
                                ELSE AVG_COND_BOE_PER_HOUR * SRC.HOURS_DOWN * CASE WHEN G_N.GN = 2 THEN SRC.WIHCLIQ ELSE 1 END
                                 END AS LOST_COND_BOE,
                           CASE WHEN SRC.DTTM >= SRC.STATUS_DATE AND SRC.STATUS IN ('Injecting','Inj','Converted to Injection','Injection') THEN NULL
                                ELSE AVG_NGL_BOE_PER_HOUR * SRC.HOURS_DOWN * CASE WHEN G_N.GN = 2 THEN SRC.WIHCLIQ ELSE 1 END
                                 END AS LOST_NGL_BOE, -- LOST TOTAL BOE
             CASE WHEN (SRC.DTTM >= SRC.STATUS_DATE AND SRC.STATUS IN ('Injecting','Inj','Converted to Injection','Injection')) OR DATEDIFF(DAY, LAST_VALUE(LAST_PROD_DATE IGNORE NULLS) OVER (PARTITION BY SRC.ENTITY_KEY, G_N.GN ORDER BY SRC.DTTM ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING), SRC.DTTM) > 60 THEN NULL
                                ELSE AVG_TOTAL_BOE_PER_HOUR * SRC.HOURS_DOWN * CASE WHEN G_N.GN = 2 THEN SRC.WIHCLIQ ELSE 1 END
                                 END AS LOST_TOTAL_BOE,
                           SRC."15D_AVG_OIL_BOE" AS AVG_OIL_BOE,
                           SRC."15D_AVG_GAS_BOE" AS AVG_GAS_BOE,
                           SRC."15D_AVG_COND_BOE" AS AVG_COND_BOE,
                           SRC."15D_AVG_NGL_BOE" AS AVG_NGL_BOE,
                           SRC."15D_AVG_TOTAL_BOE" AS AVG_TOTAL_BOE,
                           SRC."15D_AVG_HOURS_ON" AS AVG_HOURS_ON,
                           DATEDIFF(DAY, LAST_VALUE(LAST_PROD_DATE IGNORE NULLS) OVER (PARTITION BY SRC.ENTITY_KEY, G_N.GN ORDER BY SRC.DTTM ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING), SRC.DTTM) AS DAYS_SINCE_PROD
                      FROM (
                            SELECT P.DTTM,
                                   W.ENTITY_KEY,
                                   TO_VARCHAR(P.DTTM, 'YYYYMMDD') AS ACTIVITY_DATE_KEY,
                                   P.DUROP * 24 AS HOURS_ON,
                                   P.DURDOWN * 24 AS HOURS_DOWN,
                                   DT.CODEDOWNTM1 AS CODE1,
                                   DT.CODEDOWNTM2 AS CODE2,
                                   DT.CODEDOWNTM3 AS CODE3,
                                   DT.COM AS DT_COMMENT,
                                   DT.SYSCREATEUSER,
                                   DT.SYSMODUSER,
                                   NVL(UPPER(TRIM(DT.CODEDOWNTM1)), 'UNKNOWN') || '-' || NVL(UPPER(TRIM(DT.CODEDOWNTM2)), 'UNKNOWN') || '-' || NVL(UPPER(TRIM(DT.CODEDOWNTM3)), 'UNKNOWN') || '-' || NVL(UPPER(TRIM(W.COUNTRY)), 'UNKNOWN') AS SCENARIO_KEY,
                                   CASE WHEN W.ON_PROD_DATE IS NULL  THEN '-1'
                                        WHEN W.ON_PROD_DATE > P.DTTM THEN '-1'
                                        ELSE DATEDIFF(DAY, W.ON_PROD_DATE, P.DTTM) + 1
                                         END AS NORMALIZED_DATE_KEY,
                                   '-1' AS PRODUCING_DATE_KEY,
                                   COALESCE(TO_VARCHAR(W.ON_PROD_DATE, 'YYYYMMDD'), '-1') AS ON_PROD_DATE_KEY,
                                   COALESCE(W.CC_NUM, '-1') AS CC_NUM,
                                   LAST_VALUE(A."15D_AVG_HOURS_ON" IGNORE NULLS) OVER (PARTITION BY P.IDRECUNIT ORDER BY P.DTTM ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS "15D_AVG_HOURS_ON", -- 15 DAY AVERAGES
             LAST_VALUE(A."15D_AVG_OIL_BOE" IGNORE NULLS) OVER (PARTITION BY P.IDRECUNIT ORDER BY A.ENTITY_KEY, A.ACTIVITY_DATE ROWS BETWEEN 15 PRECEDING AND 1 PRECEDING) AS "15D_AVG_OIL_BOE",
                                   LAST_VALUE(A."15D_AVG_GAS_BOE" IGNORE NULLS) OVER (PARTITION BY P.IDRECUNIT ORDER BY A.ENTITY_KEY, A.ACTIVITY_DATE ROWS BETWEEN 15 PRECEDING AND 1 PRECEDING) AS "15D_AVG_GAS_BOE",
                                   LAST_VALUE(A."15D_AVG_COND_BOE" IGNORE NULLS) OVER (PARTITION BY P.IDRECUNIT ORDER BY A.ENTITY_KEY, A.ACTIVITY_DATE ROWS BETWEEN 15 PRECEDING AND 1 PRECEDING) AS "15D_AVG_COND_BOE",
                                   LAST_VALUE(A."15D_AVG_NGL_BOE" IGNORE NULLS) OVER (PARTITION BY P.IDRECUNIT ORDER BY A.ENTITY_KEY, A.ACTIVITY_DATE ROWS BETWEEN 15 PRECEDING AND 1 PRECEDING) AS "15D_AVG_NGL_BOE", -- 15 DAY AVERAGE TOTAL BOE
             LAST_VALUE(A."15D_AVG_TOTAL_BOE" IGNORE NULLS) OVER (PARTITION BY P.IDRECUNIT ORDER BY P.DTTM ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS "15D_AVG_TOTAL_BOE", -- AVG PER HOUR
             LAST_VALUE(A."AVG_OIL_BOE_PER_HOUR" IGNORE NULLS) OVER (PARTITION BY P.IDRECUNIT ORDER BY A.ENTITY_KEY, A.ACTIVITY_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS "AVG_OIL_BOE_PER_HOUR",
                                   LAST_VALUE(A."AVG_GAS_BOE_PER_HOUR" IGNORE NULLS) OVER (PARTITION BY P.IDRECUNIT ORDER BY A.ENTITY_KEY, A.ACTIVITY_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS "AVG_GAS_BOE_PER_HOUR",
                                   LAST_VALUE(A."AVG_COND_BOE_PER_HOUR" IGNORE NULLS) OVER (PARTITION BY P.IDRECUNIT ORDER BY A.ENTITY_KEY, A.ACTIVITY_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS "AVG_COND_BOE_PER_HOUR",
                                   LAST_VALUE(A."AVG_NGL_BOE_PER_HOUR" IGNORE NULLS) OVER (PARTITION BY P.IDRECUNIT ORDER BY A.ENTITY_KEY, A.ACTIVITY_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS "AVG_NGL_BOE_PER_HOUR", -- TOTAL BOE AVG PER HOUR
             LAST_VALUE(A."AVG_TOTAL_BOE_PER_HOUR" IGNORE NULLS) OVER (PARTITION BY P.IDRECUNIT ORDER BY P.DTTM ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS "AVG_TOTAL_BOE_PER_HOUR",
                                   P.WIGAS,
                                   P.WIHCLIQ,
                                   W.STATUS,
                                   W.STATUS_DATE,
                                   CASE WHEN P.DUROP > 0 THEN P.DTTM
                                        ELSE NULL
                                         END AS LAST_PROD_DATE
                              FROM "WS_DATA_STORE"."ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY" P
                              JOIN "WS_STAGE_BT"."STAGE_PRODVIEW_WELLS" W
                                ON P.IDFLOWNET = W.IDFLOWNET
                               AND P.IDRECUNIT = W.ENTITY_KEY
                              LEFT JOIN "WS_DATA_STORE"."ODS_PVIEW_PVT_PVUNITCOMPDOWNTM" DT
                                ON P.IDRECDOWNTIME = DT.IDREC
                               AND DT.DSS_CURRENT_FLAG = 'Y'
                               AND DT.DSS_DELETE_FLAG != 'Y'
                              LEFT JOIN AVG_CTE A
                                ON P.IDREC = A.IDREC
                             WHERE P.DSS_CURRENT_FLAG = 'Y'
                               AND P.DSS_DELETE_FLAG != 'Y'
                               AND W.ENTITY_KEY NOT IN (
                                    SELECT ENTITY_KEY
                                      FROM "WS_STAGE_BT"."STAGE_PRODVIEW_WELLS" W
                                     WHERE W.HIGH_PRIORITY = 'Y'
                                       AND W.COUNTRY = 'FRANCE'
                                   )
                             ORDER BY P.DTTM
                           ) SRC
                     CROSS JOIN (
                            SELECT 1 AS GN
                             UNION SELECT 2 AS GN
                           ) G_N
                   ) DWN_TM
             WHERE HOURS_DOWN > 0
        dependencies:
          - locationName: TARGET
            nodeName: VIEW_FACT_FDC_PRODVIEW_DOWNTIME
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','VIEW_FACT_FDC_PRODVIEW_DOWNTIME') }}
        name: VIEW_FACT_FDC_PRODVIEW_DOWNTIME
        noLinkRefs: []
  name: VIEW_FACT_FDC_PRODVIEW_DOWNTIME
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
