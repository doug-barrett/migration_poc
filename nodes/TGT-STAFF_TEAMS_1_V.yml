fileVersion: 1
id: e245e6bd-9f0f-4578-b9e1-8cbccdcb19c1
name: STAFF_TEAMS_1_V
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a07ec1e-de94-4200-abc4-6de1b728ab10
          stepCounter: e245e6bd-9f0f-4578-b9e1-8cbccdcb19c1
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SCHEDULE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b5ab558-a34e-4fd8-9b8e-311c0d96346a
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 827e8898-f103-4080-93ba-cadb6344188d
          stepCounter: e245e6bd-9f0f-4578-b9e1-8cbccdcb19c1
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SERVICE_POINT_SESSION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 849899d1-23c5-4751-9dee-2a919651f1c0
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc09841a-8b2f-4e91-b1b3-c9b3e8073995
          stepCounter: e245e6bd-9f0f-4578-b9e1-8cbccdcb19c1
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: STAFF_TEAM_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: df7effe6-3058-4d31-8657-1bcae9c8c673
                stepCounter: cdb854c9-3a5c-4020-a5f4-71b58cb5e589
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e67c09b-38d4-4dc9-9de8-4e6a08bb7ef3
          stepCounter: e245e6bd-9f0f-4578-b9e1-8cbccdcb19c1
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CLINICIAN_REFERENCE_NO
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 455d7269-34d2-440e-b123-0e7ff8fe8978
                stepCounter: 3f7e4431-5c07-47a3-b850-49b3af652a4b
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE VIEW {{ this }}(schedule_reference_no, service_point_session_reference_no, staff_team_code, clinician_reference_no) AS SELECT ds_pims_schedules.schdl_refno schedule_reference_no,
                   ds_pims_schedules.spssn_refno service_point_session_reference_no,
                   PCRTP.main_code staff_team_code,
                   ds_pims_prof_carer_map.proca_refno clinician_reference_no
              FROM ds_pims_prof_carer_map
             INNER JOIN ds_pims_schedules
                ON ds_pims_schedules.schdl_refno = ds_pims_prof_carer_map.schdl_refno
             INNER JOIN ds_pims_reference_values PCRTP
                ON PCRTP.rfval_refno = ds_pims_prof_carer_map.pcrtp_refno
               AND ds_pims_prof_carer_map.role_order = 1
               AND PCRTP.main_code IN ('SUPRI','ANATH','ANATS','ANATE','SUASS','SUSEC')
        dependencies:
          - locationName: TGT
            nodeName: DS_PIMS_SCHEDULES
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TGT','DS_PIMS_SCHEDULES') }}
        name: STAFF_TEAMS_1_V
        noLinkRefs: []
  name: STAFF_TEAMS_1_V
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
