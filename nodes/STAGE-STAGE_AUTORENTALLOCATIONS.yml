fileVersion: 1
id: cdf9af6d-6a08-41ce-86c6-e57284fe694a
name: STAGE_AUTORENTALLOCATIONS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 150290b1-bb14-4ca6-ba4e-a1471642470e
          stepCounter: cdf9af6d-6a08-41ce-86c6-e57284fe694a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: RENTALSTATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33ad936a-ca69-43cf-a8bb-826184ab0575
                stepCounter: 5ab1dd91-2863-465c-bfe4-2ceea15f8450
            transform: UPPER(TRIM(LOADAUTORENTALUSAGEDATA.RENTALSTATION))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dd047fea-be31-4366-b61e-eec522465800
          stepCounter: cdf9af6d-6a08-41ce-86c6-e57284fe694a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: BRANDDESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 729b928c-d508-4b0f-88bb-20f5074e2db9
                stepCounter: 5ab1dd91-2863-465c-bfe4-2ceea15f8450
            transform: UPPER(TRIM(LOADAUTORENTALUSAGEDATA.BRANDDESCRIPTION))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb72a813-36b9-4645-9d74-4858ee07a2ee
          stepCounter: cdf9af6d-6a08-41ce-86c6-e57284fe694a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: RENTALSTATIONNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8195edcc-4d79-40be-b79f-317e198cc30f
                stepCounter: 5ab1dd91-2863-465c-bfe4-2ceea15f8450
            transform: MIN(UPPER(LOADAUTORENTALUSAGEDATA.RENTALSTATIONNAME))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18e16194-1cad-482e-924c-eb0b80929ef4
          stepCounter: cdf9af6d-6a08-41ce-86c6-e57284fe694a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: RENTALCITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 63148384-af5a-4ed6-a1d2-e33eadd43525
                stepCounter: 5ab1dd91-2863-465c-bfe4-2ceea15f8450
            transform: UPPER(TRIM(LOADAUTORENTALUSAGEDATA.RENTALCITY))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 386200a1-9eda-4ac1-a91a-564fe4a43c31
          stepCounter: cdf9af6d-6a08-41ce-86c6-e57284fe694a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: RENTALSTATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fbd400b2-83ec-4b1b-90a3-353938760666
                stepCounter: 5ab1dd91-2863-465c-bfe4-2ceea15f8450
            transform: UPPER(TRIM(LOADAUTORENTALUSAGEDATA.RENTALSTATE))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f65c185-d364-4001-b4b9-60e89affe817
          stepCounter: cdf9af6d-6a08-41ce-86c6-e57284fe694a
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: DATEADDED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 44e2b394-65bb-4527-b55b-d13a40f09c2d
                stepCounter: 5ab1dd91-2863-465c-bfe4-2ceea15f8450
            transform: MIN(LOADAUTORENTALUSAGEDATA.RENTALDATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 629262c0-fd4f-41ac-87d7-f3a61b447855
          stepCounter: cdf9af6d-6a08-41ce-86c6-e57284fe694a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: RENTALCOUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e44b650-1d80-45a8-a567-2dacecb8bc08
                stepCounter: 5ab1dd91-2863-465c-bfe4-2ceea15f8450
            transform: MIN(LOADAUTORENTALUSAGEDATA.CHECKOUTSTATIONCOUNTRYCODE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c15def58-efbc-48f2-95c8-91470e33cab2
          stepCounter: cdf9af6d-6a08-41ce-86c6-e57284fe694a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: NORMALIZEDCITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 63148384-af5a-4ed6-a1d2-e33eadd43525
                stepCounter: 5ab1dd91-2863-465c-bfe4-2ceea15f8450
            transform: INITCAP(MIN(LOADAUTORENTALUSAGEDATA.RENTALCITY))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4656226-4a94-42ca-b340-cf195329ef4c
          stepCounter: cdf9af6d-6a08-41ce-86c6-e57284fe694a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: ISGNORMALIZEDCITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 63148384-af5a-4ed6-a1d2-e33eadd43525
                stepCounter: 5ab1dd91-2863-465c-bfe4-2ceea15f8450
            transform: INITCAP(MIN(LOADAUTORENTALUSAGEDATA.RENTALCITY))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d331eee4-d664-445d-a524-5647718d56f0
          stepCounter: cdf9af6d-6a08-41ce-86c6-e57284fe694a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: NOTES
        name: NOTES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 44e2b394-65bb-4527-b55b-d13a40f09c2d
                stepCounter: 5ab1dd91-2863-465c-bfe4-2ceea15f8450
            transform: MIN(LOADAUTORENTALUSAGEDATA.RENTALDATE) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c1f389a-141e-445e-a704-15e24860bcee
          stepCounter: cdf9af6d-6a08-41ce-86c6-e57284fe694a
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05c54e71-dc86-466f-ab77-e083cccdfad8
                stepCounter: 5ab1dd91-2863-465c-bfe4-2ceea15f8450
            transform: MIN(LOADAUTORENTALUSAGEDATA.DSS_RECORD_SOURCE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2970e233-71c8-4f7e-ad35-34a8d8b468a6
          stepCounter: cdf9af6d-6a08-41ce-86c6-e57284fe694a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e31712f-9935-4f89-84e3-7b1dc4d64457
                stepCounter: 5ab1dd91-2863-465c-bfe4-2ceea15f8450
            transform: MIN(LOADAUTORENTALUSAGEDATA.DSS_LOAD_DATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ebedcf6-2fb0-4a5a-afb6-b657b6be49ae
          stepCounter: cdf9af6d-6a08-41ce-86c6-e57284fe694a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1cb36ddb-bdf0-4883-81a8-359aa2226907
          stepCounter: cdf9af6d-6a08-41ce-86c6-e57284fe694a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOAD_AUTORENTALUSAGEDATA: 5ab1dd91-2863-465c-bfe4-2ceea15f8450
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOAD_AUTORENTALUSAGEDATA
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOAD_AUTORENTALUSAGEDATA') }} LOAD_AUTORENTALUSAGEDATA
             GROUP BY UPPER(TRIM(LOAD_AUTORENTALUSAGEDATA.RENTALSTATION)) ,
                      UPPER(TRIM(LOAD_AUTORENTALUSAGEDATA.BRANDDESCRIPTION)) ,
                      UPPER(TRIM(LOAD_AUTORENTALUSAGEDATA.RENTALCITY)) ,
                      UPPER(TRIM(LOAD_AUTORENTALUSAGEDATA.RENTALSTATE))
        name: STAGEAUTORENTALLOCATIONS
        noLinkRefs: []
  name: STAGE_AUTORENTALLOCATIONS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
