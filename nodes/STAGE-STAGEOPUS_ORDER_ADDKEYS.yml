fileVersion: 1
id: c96daca8-4268-4ca9-96ad-0afce56c4052
name: STAGEOPUS_ORDER_ADDKEYS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 621ab4a1-4494-477d-99ed-eadf2ce495e3
          stepCounter: c96daca8-4268-4ca9-96ad-0afce56c4052
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: OPUS_CONTACTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b5116a58-7724-4f00-90f8-2b858596359a
                stepCounter: b85c7819-29df-44d8-8ca6-ce58cb2bf7ae
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e6446c3-a397-4dca-8221-ec96403f4729
          stepCounter: c96daca8-4268-4ca9-96ad-0afce56c4052
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: OPUSPRODUCTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db8301c3-d64e-47ef-a3aa-ebca06657c4a
                stepCounter: ded28e11-487f-4827-943b-81fd3ec6c65e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 36591c41-6058-40db-a4bc-e5743512a945
          stepCounter: c96daca8-4268-4ca9-96ad-0afce56c4052
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: OPUSCARTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d4ffa5b4-12a2-42c8-ac2f-58b4d0ef0638
                stepCounter: b82c2f85-3de1-4ac3-bf9e-379eb53cc591
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8bcec71-dead-42f5-97d9-ec87bfce97a9
          stepCounter: c96daca8-4268-4ca9-96ad-0afce56c4052
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: OPUSBILLINGADDRESSKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9cdab1c3-f33b-4b19-8535-14cf338eb3dd
                stepCounter: 40222bba-56fe-42ab-9f89-a48603f30638
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 752adda4-03bb-4316-b2f0-d7b129ee562e
          stepCounter: c96daca8-4268-4ca9-96ad-0afce56c4052
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: OPUSPAYMENTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c6ba0ed-aece-4cd4-88ee-b149a5b7ee62
                stepCounter: a102818f-bbe7-47df-bf91-bd1c1d89e5a8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2e3d20c-f3ad-4110-b4e2-b272e4e72c8d
          stepCounter: c96daca8-4268-4ca9-96ad-0afce56c4052
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEOPUS_ORDER_ADDKEYS.SUPPLIERID=OPUS_SUPPLIER.SUPPLIEROPUSID
        name: OPUSSUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: be905c6f-acd8-4701-8431-32f0def6ec2e
                stepCounter: 4a40fd64-d675-4ba5-9c42-93e3222d3fbd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e98c6a3b-65fa-4a16-9a18-d2b4732deb65
          stepCounter: c96daca8-4268-4ca9-96ad-0afce56c4052
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: OPUSSHIPPINGADDRESSKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc4368a2-445d-4837-8c8c-75602f03eee1
                stepCounter: 94b2a18a-4ad3-4f18-8d82-986676a75a77
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e8ea5b1-dbb4-41eb-9a62-d4dae6c0db32
          stepCounter: c96daca8-4268-4ca9-96ad-0afce56c4052
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: DIMCONTACTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dcf5f781-2b00-4e01-9503-c981ed1ab780
                stepCounter: 4015cdd7-ddd6-45b0-996c-53903de48f6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 970ba21d-e2c6-4422-940a-16517c703210
          stepCounter: c96daca8-4268-4ca9-96ad-0afce56c4052
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: ACCOUNTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51242f2b-12a0-45ea-bdfb-000fdb4c550a
                stepCounter: 96e8695b-6733-4729-8797-91b12c74cb7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f5cb6b2-84e0-481b-94ee-e6c2abca33aa
          stepCounter: c96daca8-4268-4ca9-96ad-0afce56c4052
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED KEY FOR THE DATE DIMENSION. NOMINAL FORMAT IS YYYYMMDD, BUT DD EQUAL TO 0 AND GREATER THAN 31 PERMITED FOR SPECIAL DATE HANDLING.
        name: OPUSORDERDATEKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 54642355-96d6-4a1e-b27d-4b2a775839e1
                stepCounter: 7a4306c6-e3a1-466c-8039-06f3d2ba93bd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a56ce220-7d3c-4328-960a-5908467b1a8c
          stepCounter: c96daca8-4268-4ca9-96ad-0afce56c4052
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PARENTORDERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8684522a-9665-4b72-af3d-5f6445ac5cd4
                stepCounter: 4013880a-b61c-4f91-92ea-709f55b9425e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88364765-238a-497c-bcc4-b2db47bfdcc8
          stepCounter: c96daca8-4268-4ca9-96ad-0afce56c4052
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PARENTORDERNUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e547d0a-e94e-41f6-9aa9-4c191f5755cd
                stepCounter: 4013880a-b61c-4f91-92ea-709f55b9425e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0018d2ba-118a-4e46-837b-99e711d403b9
          stepCounter: c96daca8-4268-4ca9-96ad-0afce56c4052
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SUPPLIERFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1bcc706b-9e89-4fa7-8473-a804172084cb
                stepCounter: 4a40fd64-d675-4ba5-9c42-93e3222d3fbd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0f6ceae-5665-4a32-a212-c4eab4dc2eae
          stepCounter: c96daca8-4268-4ca9-96ad-0afce56c4052
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORDERNUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4574ad03-2a58-40ec-bd4a-74b603054dba
                stepCounter: 4013880a-b61c-4f91-92ea-709f55b9425e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f559751-d432-4cca-ad2c-20714c203a9f
          stepCounter: c96daca8-4268-4ca9-96ad-0afce56c4052
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: ORDERDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83f18831-be89-4988-a0f3-6b1156c5ef37
                stepCounter: 4013880a-b61c-4f91-92ea-709f55b9425e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 12f8b5ad-0eef-42f5-8219-bdc1a00272fe
          stepCounter: c96daca8-4268-4ca9-96ad-0afce56c4052
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CARTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aea34361-af3d-46e1-8a9d-0610e090e456
                stepCounter: 4013880a-b61c-4f91-92ea-709f55b9425e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a1c81e9-1697-42e3-8bb4-145efed44e40
          stepCounter: c96daca8-4268-4ca9-96ad-0afce56c4052
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: ORDERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24080c86-234b-4ed4-9604-e8bf7cc0c227
                stepCounter: 4013880a-b61c-4f91-92ea-709f55b9425e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6bb9ff8b-ee31-44db-872e-278541c27afa
          stepCounter: c96daca8-4268-4ca9-96ad-0afce56c4052
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d253fd9b-4f96-4104-a323-c60216a70078
                stepCounter: 4013880a-b61c-4f91-92ea-709f55b9425e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0f8d098-3840-4cd0-ab11-94f461de0cb4
          stepCounter: c96daca8-4268-4ca9-96ad-0afce56c4052
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORDERSTATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c4a5926-3d47-40b8-8c32-4e963a1875bf
                stepCounter: 4013880a-b61c-4f91-92ea-709f55b9425e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14621b7a-cf83-4344-8d4c-2ccf490e7cb8
          stepCounter: c96daca8-4268-4ca9-96ad-0afce56c4052
        config: {}
        dataType: NUMBER(38,4)
        defaultValue: ""
        description: ""
        name: PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b11bc17-5eea-4e15-8786-5c00308a01e0
                stepCounter: 4013880a-b61c-4f91-92ea-709f55b9425e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75dae970-b5aa-4d9d-8381-263028900843
          stepCounter: c96daca8-4268-4ca9-96ad-0afce56c4052
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: QUANTITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a72487b-aac1-4e89-b8ce-8022490d91cc
                stepCounter: 4013880a-b61c-4f91-92ea-709f55b9425e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ceca3fc6-d15c-4220-888e-76748effc7a5
          stepCounter: c96daca8-4268-4ca9-96ad-0afce56c4052
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PRODUCTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64206876-b4ad-4d93-b651-21e9cbe35f23
                stepCounter: 4013880a-b61c-4f91-92ea-709f55b9425e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e7d7fd5-9289-42c9-b6a2-376f99844396
          stepCounter: c96daca8-4268-4ca9-96ad-0afce56c4052
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ba4afe25-6195-494b-94e4-661658ef0327
                stepCounter: 4013880a-b61c-4f91-92ea-709f55b9425e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9e4b394-ff98-40fe-a4bd-ad20e3b6cc38
          stepCounter: c96daca8-4268-4ca9-96ad-0afce56c4052
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21814e45-17b3-41ee-b9c6-30e852dfa937
                stepCounter: 4013880a-b61c-4f91-92ea-709f55b9425e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ff2d5bf-aa83-4a26-91a3-931a34aa50b1
          stepCounter: c96daca8-4268-4ca9-96ad-0afce56c4052
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PAYMENTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c6ed3d69-15d3-43fc-8af3-79f1c06b9aaf
                stepCounter: 4013880a-b61c-4f91-92ea-709f55b9425e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7671e3db-38f1-4f6f-bc7a-3d2808c7b07b
          stepCounter: c96daca8-4268-4ca9-96ad-0afce56c4052
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: BILLINGADDRESSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cf1a5f1b-45e4-42db-a443-55a4b26b34a5
                stepCounter: 4013880a-b61c-4f91-92ea-709f55b9425e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e828046f-071d-480b-887e-b4327b9bf8d6
          stepCounter: c96daca8-4268-4ca9-96ad-0afce56c4052
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: SHIPPINGADDRESSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d81b7a4a-0abb-4686-b830-6525802a9d6c
                stepCounter: 4013880a-b61c-4f91-92ea-709f55b9425e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6723b7e-9134-4304-8e21-d6d71f3032a9
          stepCounter: c96daca8-4268-4ca9-96ad-0afce56c4052
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5df9d76d-d517-49ab-8d00-378a71db470d
                stepCounter: 4013880a-b61c-4f91-92ea-709f55b9425e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d25e8c93-b234-4048-946b-348bf5a6516d
          stepCounter: c96daca8-4268-4ca9-96ad-0afce56c4052
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1b51fb0-d8be-4620-a60c-60b8fc42d3ec
                stepCounter: 4013880a-b61c-4f91-92ea-709f55b9425e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 812bc581-7091-4b80-a287-61a5ccabf7c0
          stepCounter: c96daca8-4268-4ca9-96ad-0afce56c4052
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78e14125-d3e2-41b9-ae83-79f822312c48
          stepCounter: c96daca8-4268-4ca9-96ad-0afce56c4052
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGEFACT_OPUS_ORDER: 4013880a-b61c-4f91-92ea-709f55b9425e
          OPUS_PRODUCT: ded28e11-487f-4827-943b-81fd3ec6c65e
          OPUS_CART: b82c2f85-3de1-4ac3-bf9e-379eb53cc591
          OPUS_BILLING_ADDRESS: 40222bba-56fe-42ab-9f89-a48603f30638
          OPUS_PAYMENT: a102818f-bbe7-47df-bf91-bd1c1d89e5a8
          OPUS_SHIPPING_ADDRESS: 94b2a18a-4ad3-4f18-8d82-986676a75a77
          CONTACT: 4015cdd7-ddd6-45b0-996c-53903de48f6b
          ACCOUNT: 96e8695b-6733-4729-8797-91b12c74cb7e
          VWOPUS_ORDER_DATE: 7a4306c6-e3a1-466c-8039-06f3d2ba93bd
          OPUS_CONTACT: b85c7819-29df-44d8-8ca6-ce58cb2bf7ae
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: DIM
            nodeName: CONTACT
          - locationName: DIM
            nodeName: OPUS_BILLING_ADDRESS
          - locationName: DIM
            nodeName: OPUS_CART
          - locationName: DIM
            nodeName: OPUS_CONTACT
          - locationName: DIM
            nodeName: OPUS_PAYMENT
          - locationName: DIM
            nodeName: OPUS_PRODUCT
          - locationName: DIM
            nodeName: OPUS_SHIPPING_ADDRESS
          - locationName: DIM
            nodeName: OPUS_SUPPLIER
          - locationName: DIM
            nodeName: VWOPUS_ORDER_DATE
          - locationName: STAGE
            nodeName: STAGEFACT_OPUS_ORDER
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','STAGEFACT_OPUS_ORDER') }} STAGEFACT_OPUS_ORDER
              LEFT JOIN {{ ref('DIM','OPUS_PRODUCT') }} OPUS_PRODUCT
                ON STAGEFACT_OPUS_ORDER.PRODUCTID = OPUS_PRODUCT.PRODUCTID
              LEFT JOIN {{ ref('DIM','OPUS_CART') }} OPUS_CART
                ON STAGEFACT_OPUS_ORDER.CARTID = OPUS_CART.CARTID
              LEFT JOIN {{ ref('DIM','OPUS_BILLING_ADDRESS') }} OPUS_BILLING_ADDRESS
                ON STAGEFACT_OPUS_ORDER.BILLINGADDRESSID = OPUS_BILLING_ADDRESS.BILLINGADDRESSID
               AND STAGEFACT_OPUS_ORDER.ORGANIZATIONID = OPUS_BILLING_ADDRESS.ORGANIZATIONID
              LEFT JOIN {{ ref('DIM','OPUS_PAYMENT') }} OPUS_PAYMENT
                ON STAGEFACT_OPUS_ORDER.PAYMENTID = OPUS_PAYMENT.PAYMENTID
              LEFT JOIN {{ ref('DIM','OPUS_SHIPPING_ADDRESS') }} OPUS_SHIPPING_ADDRESS
                ON STAGEFACT_OPUS_ORDER.SHIPPINGADDRESSID = OPUS_SHIPPING_ADDRESS.SHIPPINGADDRESSID
               AND STAGEFACT_OPUS_ORDER.ORGANIZATIONID = OPUS_SHIPPING_ADDRESS.ORGANIZATIONID
              LEFT JOIN {{ ref('DIM','CONTACT') }} CONTACT
                ON STAGEFACT_OPUS_ORDER.CUSTOMERID = CONTACT.OPUS_CUSTOMER_ID
              LEFT JOIN {{ ref('DIM','ACCOUNT') }} ACCOUNT
                ON STAGEFACT_OPUS_ORDER.ORGANIZATIONID = ACCOUNT.OPUS_ORGANIZATION_ID
              LEFT JOIN {{ ref('DIM','VWOPUS_ORDER_DATE') }} VWOPUS_ORDER_DATE
                ON STAGEFACT_OPUS_ORDER.ORDERDATE = VWOPUS_ORDER_DATE.OPUS_ORDER_CALENDAR_DATE
              LEFT JOIN {{ ref('DIM','OPUS_CONTACT') }} OPUS_CONTACT
                ON STAGEFACT_OPUS_ORDER.CUSTOMERID = OPUS_CONTACT.CUSTOMERID
               AND STAGEFACT_OPUS_ORDER.ORGANIZATIONID = OPUS_CONTACT.ORGANIZATIONID
        name: STAGEOPUS_ORDER_ADDKEYS
        noLinkRefs: []
  name: STAGEOPUS_ORDER_ADDKEYS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
