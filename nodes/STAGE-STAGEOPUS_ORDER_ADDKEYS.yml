fileVersion: 1
id: 22b1d902-9753-41e5-96df-f3cea0a20b3f
name: STAGEOPUS_ORDER_ADDKEYS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c3c9096-e69b-413a-abae-d77225501bee
          stepCounter: 22b1d902-9753-41e5-96df-f3cea0a20b3f
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: OPUS_CONTACTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 25c9e286-e8b7-4519-9df4-4e5208ac087e
                stepCounter: 3988039f-a827-4207-aa98-2ae88da5c868
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e994dd8-ca98-42dc-b552-08725cb39943
          stepCounter: 22b1d902-9753-41e5-96df-f3cea0a20b3f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: OPUSPRODUCTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 610408dc-08b7-46f2-83a2-edff23a9575a
                stepCounter: 3c136768-fb84-4332-a4df-1882e24f47c8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0d54ab4-20b5-419e-9f33-7c744b88a964
          stepCounter: 22b1d902-9753-41e5-96df-f3cea0a20b3f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: OPUSCARTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b0dd98e4-9e71-4732-8edd-ec24b56ccab3
                stepCounter: 06507037-35ca-47d4-a17f-3aa4490482f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bc9b6544-a38f-457c-a7d2-59d7340adc28
          stepCounter: 22b1d902-9753-41e5-96df-f3cea0a20b3f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: OPUSBILLINGADDRESSKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 88fa773d-ee04-4c84-92ca-f7e3e770b7a4
                stepCounter: 163c4e94-1c2e-4825-9f9b-197c47977dc3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e731b2f-f278-4d3a-8a53-79e57e5205b4
          stepCounter: 22b1d902-9753-41e5-96df-f3cea0a20b3f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: OPUSPAYMENTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1590b171-8216-4aac-8c8b-a9870690c388
                stepCounter: 66d55d9a-b2af-4773-9f7d-a9b425f61718
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa347c58-5651-47fd-9d81-66363701375b
          stepCounter: 22b1d902-9753-41e5-96df-f3cea0a20b3f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEOPUS_ORDER_ADDKEYS.SUPPLIERID=OPUS_SUPPLIER.SUPPLIEROPUSID
        name: OPUSSUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 771e6817-e54a-430a-87a4-50ee15fb2d1c
                stepCounter: ee7f1895-c11d-4da2-81d2-a34aa558b65c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4c3b7f3-7d73-4607-b680-faeb920393f8
          stepCounter: 22b1d902-9753-41e5-96df-f3cea0a20b3f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: OPUSSHIPPINGADDRESSKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eac79938-2e97-4c2f-93c4-eb32df157887
                stepCounter: 12f2af54-e7bc-4096-8fef-d42e27224e81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b896292-d080-4974-b544-e3b5205d25df
          stepCounter: 22b1d902-9753-41e5-96df-f3cea0a20b3f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: DIMCONTACTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3f8b0170-7680-48a3-8b6d-02c5d2e7d012
                stepCounter: 69bed407-4a56-4539-a027-399a1d5dc1bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f3c901c-a756-4176-88f0-9a96fe144c3b
          stepCounter: 22b1d902-9753-41e5-96df-f3cea0a20b3f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: ACCOUNTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd325e05-7e18-499b-bd60-b3144ec04cb9
                stepCounter: e6f00723-a598-4272-b25a-ed544e4c0a06
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 284cbc83-ef9e-4a3d-b0dd-79d9e4c36b46
          stepCounter: 22b1d902-9753-41e5-96df-f3cea0a20b3f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED KEY FOR THE DATE DIMENSION. NOMINAL FORMAT IS YYYYMMDD, BUT DD EQUAL TO 0 AND GREATER THAN 31 PERMITED FOR SPECIAL DATE HANDLING.
        name: OPUSORDERDATEKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d264196e-8c51-425f-b513-f2fc66402303
                stepCounter: c46a8896-68ba-4d3e-842f-3740662428c1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 12a3ac4f-eb80-4d6c-9e80-03e08a547251
          stepCounter: 22b1d902-9753-41e5-96df-f3cea0a20b3f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PARENTORDERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 043360d7-9b2b-4328-8ae2-474fcf43ba84
                stepCounter: 582b464a-298d-492e-92ce-e407215b34ee
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a66dc706-9e1d-48f7-961c-ea799ec9dd1b
          stepCounter: 22b1d902-9753-41e5-96df-f3cea0a20b3f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PARENTORDERNUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e9a155ae-78e0-48cc-a4a1-f394ab172e29
                stepCounter: 582b464a-298d-492e-92ce-e407215b34ee
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9914f8f1-c0be-4d88-99ee-06dbc867a395
          stepCounter: 22b1d902-9753-41e5-96df-f3cea0a20b3f
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SUPPLIERFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7fd1ecf6-b0a1-4a5f-a26e-3a1f505cb6c4
                stepCounter: ee7f1895-c11d-4da2-81d2-a34aa558b65c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ed51e0f-3341-46bd-a399-8b4e2c91f247
          stepCounter: 22b1d902-9753-41e5-96df-f3cea0a20b3f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORDERNUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1fb1649-8e0a-41f9-a544-2299ec841989
                stepCounter: 582b464a-298d-492e-92ce-e407215b34ee
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 074ecb3d-7b71-4308-926e-185e7966a6f9
          stepCounter: 22b1d902-9753-41e5-96df-f3cea0a20b3f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: ORDERDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2dbf50d9-2e57-4929-b95a-9d540de99970
                stepCounter: 582b464a-298d-492e-92ce-e407215b34ee
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 585439ea-bba7-4bae-9018-19fe9812792d
          stepCounter: 22b1d902-9753-41e5-96df-f3cea0a20b3f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CARTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5afc6a37-5ec0-46e6-8cfa-18263963e6d1
                stepCounter: 582b464a-298d-492e-92ce-e407215b34ee
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a0c543c-a904-44c1-9e5c-9b55cf3d123a
          stepCounter: 22b1d902-9753-41e5-96df-f3cea0a20b3f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: ORDERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a4b51b3-90ce-4c2a-8e43-62cd596ba34d
                stepCounter: 582b464a-298d-492e-92ce-e407215b34ee
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d418ae33-9471-41cd-bf79-922cc22a6f15
          stepCounter: 22b1d902-9753-41e5-96df-f3cea0a20b3f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db1cc4a1-7f8e-48ca-a55c-8e4505d5cccb
                stepCounter: 582b464a-298d-492e-92ce-e407215b34ee
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9acd3331-aa49-4304-a8d4-e76600148b8a
          stepCounter: 22b1d902-9753-41e5-96df-f3cea0a20b3f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORDERSTATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 80bac501-eb3c-4ece-85a9-ee450d1fa2f9
                stepCounter: 582b464a-298d-492e-92ce-e407215b34ee
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87d5b238-8eae-4be2-961a-55c6fee9b4ee
          stepCounter: 22b1d902-9753-41e5-96df-f3cea0a20b3f
        config: {}
        dataType: NUMBER(38,4)
        defaultValue: ""
        description: ""
        name: PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5950c7bb-3b03-44fb-8da2-91d7627b0fcb
                stepCounter: 582b464a-298d-492e-92ce-e407215b34ee
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c7804cf0-40ec-4293-86fd-1eb04d2457f3
          stepCounter: 22b1d902-9753-41e5-96df-f3cea0a20b3f
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: QUANTITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d77efcb2-bf1c-4d69-aae7-e45b3c0ea57a
                stepCounter: 582b464a-298d-492e-92ce-e407215b34ee
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 476a792d-40fc-4e1e-848f-d4812b26ada2
          stepCounter: 22b1d902-9753-41e5-96df-f3cea0a20b3f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PRODUCTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa158748-1975-4256-a72f-d926211ac86c
                stepCounter: 582b464a-298d-492e-92ce-e407215b34ee
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 621ea6b8-a951-4eae-8cbf-8ae8381b5ada
          stepCounter: 22b1d902-9753-41e5-96df-f3cea0a20b3f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 992c5b09-b561-43ee-a3f9-e1b13c1e9562
                stepCounter: 582b464a-298d-492e-92ce-e407215b34ee
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e51ba27-ccf7-429b-8672-d7f43ae07298
          stepCounter: 22b1d902-9753-41e5-96df-f3cea0a20b3f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9117856e-eab7-4936-8847-65e0e5f87b7f
                stepCounter: 582b464a-298d-492e-92ce-e407215b34ee
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f1ef4f3-4f51-4f1b-a0ae-f9e48af06644
          stepCounter: 22b1d902-9753-41e5-96df-f3cea0a20b3f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PAYMENTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0632b7fe-fdc6-4195-8441-7a3d6c121adf
                stepCounter: 582b464a-298d-492e-92ce-e407215b34ee
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 420f5cd5-f4ae-48f6-b0be-935f2c7fbb60
          stepCounter: 22b1d902-9753-41e5-96df-f3cea0a20b3f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: BILLINGADDRESSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ba1f14e-b9aa-4e82-86a4-979d43b95694
                stepCounter: 582b464a-298d-492e-92ce-e407215b34ee
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e23f9ac-053a-4b15-9c17-4f5e05ac7014
          stepCounter: 22b1d902-9753-41e5-96df-f3cea0a20b3f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: SHIPPINGADDRESSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c189381-e814-49ae-8fee-c232bcd1d024
                stepCounter: 582b464a-298d-492e-92ce-e407215b34ee
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 027925c7-7193-4e37-a354-664036f5a44b
          stepCounter: 22b1d902-9753-41e5-96df-f3cea0a20b3f
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 88fa0291-2b0f-4612-98a6-205e7901c025
                stepCounter: 582b464a-298d-492e-92ce-e407215b34ee
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d280a614-1e16-446d-8389-573a9f28c1a3
          stepCounter: 22b1d902-9753-41e5-96df-f3cea0a20b3f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dcd1b553-34d2-4758-9ee5-ab64daa93ec3
                stepCounter: 582b464a-298d-492e-92ce-e407215b34ee
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d86157f-d0bf-4677-8745-1d63ef8b9398
          stepCounter: 22b1d902-9753-41e5-96df-f3cea0a20b3f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a65456ec-9e8c-4239-bbd2-50b91f557a62
          stepCounter: 22b1d902-9753-41e5-96df-f3cea0a20b3f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGEFACT_OPUS_ORDER: 582b464a-298d-492e-92ce-e407215b34ee
          OPUS_PRODUCT: 3c136768-fb84-4332-a4df-1882e24f47c8
          OPUS_CART: 06507037-35ca-47d4-a17f-3aa4490482f1
          OPUS_BILLING_ADDRESS: 163c4e94-1c2e-4825-9f9b-197c47977dc3
          OPUS_PAYMENT: 66d55d9a-b2af-4773-9f7d-a9b425f61718
          OPUS_SHIPPING_ADDRESS: 12f2af54-e7bc-4096-8fef-d42e27224e81
          CONTACT: 69bed407-4a56-4539-a027-399a1d5dc1bb
          ACCOUNT: e6f00723-a598-4272-b25a-ed544e4c0a06
          VWOPUS_ORDER_DATE: c46a8896-68ba-4d3e-842f-3740662428c1
          OPUS_CONTACT: 3988039f-a827-4207-aa98-2ae88da5c868
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: DIM
            nodeName: CONTACT
          - locationName: DIM
            nodeName: OPUS_BILLING_ADDRESS
          - locationName: DIM
            nodeName: OPUS_CART
          - locationName: DIM
            nodeName: OPUS_CONTACT
          - locationName: DIM
            nodeName: OPUS_PAYMENT
          - locationName: DIM
            nodeName: OPUS_PRODUCT
          - locationName: DIM
            nodeName: OPUS_SHIPPING_ADDRESS
          - locationName: DIM
            nodeName: OPUS_SUPPLIER
          - locationName: DIM
            nodeName: VWOPUS_ORDER_DATE
          - locationName: STAGE
            nodeName: STAGEFACT_OPUS_ORDER
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','STAGEFACT_OPUS_ORDER') }} STAGEFACT_OPUS_ORDER
              LEFT JOIN {{ ref('DIM','OPUS_PRODUCT') }} OPUS_PRODUCT
                ON STAGEFACT_OPUS_ORDER.PRODUCTID = OPUS_PRODUCT.PRODUCTID
              LEFT JOIN {{ ref('DIM','OPUS_CART') }} OPUS_CART
                ON STAGEFACT_OPUS_ORDER.CARTID = OPUS_CART.CARTID
              LEFT JOIN {{ ref('DIM','OPUS_BILLING_ADDRESS') }} OPUS_BILLING_ADDRESS
                ON STAGEFACT_OPUS_ORDER.BILLINGADDRESSID = OPUS_BILLING_ADDRESS.BILLINGADDRESSID
               AND STAGEFACT_OPUS_ORDER.ORGANIZATIONID = OPUS_BILLING_ADDRESS.ORGANIZATIONID
              LEFT JOIN {{ ref('DIM','OPUS_PAYMENT') }} OPUS_PAYMENT
                ON STAGEFACT_OPUS_ORDER.PAYMENTID = OPUS_PAYMENT.PAYMENTID
              LEFT JOIN {{ ref('DIM','OPUS_SHIPPING_ADDRESS') }} OPUS_SHIPPING_ADDRESS
                ON STAGEFACT_OPUS_ORDER.SHIPPINGADDRESSID = OPUS_SHIPPING_ADDRESS.SHIPPINGADDRESSID
               AND STAGEFACT_OPUS_ORDER.ORGANIZATIONID = OPUS_SHIPPING_ADDRESS.ORGANIZATIONID
              LEFT JOIN {{ ref('DIM','CONTACT') }} CONTACT
                ON STAGEFACT_OPUS_ORDER.CUSTOMERID = CONTACT.OPUS_CUSTOMER_ID
              LEFT JOIN {{ ref('DIM','ACCOUNT') }} ACCOUNT
                ON STAGEFACT_OPUS_ORDER.ORGANIZATIONID = ACCOUNT.OPUS_ORGANIZATION_ID
              LEFT JOIN {{ ref('DIM','VWOPUS_ORDER_DATE') }} VWOPUS_ORDER_DATE
                ON STAGEFACT_OPUS_ORDER.ORDERDATE = VWOPUS_ORDER_DATE.OPUS_ORDER_CALENDAR_DATE
              LEFT JOIN {{ ref('DIM','OPUS_CONTACT') }} OPUS_CONTACT
                ON STAGEFACT_OPUS_ORDER.CUSTOMERID = OPUS_CONTACT.CUSTOMERID
               AND STAGEFACT_OPUS_ORDER.ORGANIZATIONID = OPUS_CONTACT.ORGANIZATIONID
        name: STAGEOPUS_ORDER_ADDKEYS
        noLinkRefs: []
  name: STAGEOPUS_ORDER_ADDKEYS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
