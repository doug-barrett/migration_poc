fileVersion: 1
id: cc13247f-19a8-4da4-8189-9eba91dfe53f
name: STAGEOPUS_ORDER_ADDKEYS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d5256fe-5a1c-470a-88b7-3d958774d7ea
          stepCounter: cc13247f-19a8-4da4-8189-9eba91dfe53f
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: OPUS_CONTACTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3434011d-d965-4acb-b578-87fe620ca288
                stepCounter: c0d5aa6a-a938-447b-8e2e-a1e53d310fc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff8f4944-1b8a-4a16-944d-40a4bdf36070
          stepCounter: cc13247f-19a8-4da4-8189-9eba91dfe53f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: OPUSPRODUCTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39cd8d04-a0c1-4570-af6a-3ef5193e0188
                stepCounter: f0f25bb4-d26f-4e2a-9e67-429aa61f0625
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c84c3c05-9fd2-4b11-b52c-6760f0717cc8
          stepCounter: cc13247f-19a8-4da4-8189-9eba91dfe53f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: OPUSCARTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3905c792-e1ba-409b-bf1f-38c663098a8d
                stepCounter: 625443fe-16ff-4435-ae20-b1b1c489bf1e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8847d17b-b2e1-4a51-9372-7c697fea3dcd
          stepCounter: cc13247f-19a8-4da4-8189-9eba91dfe53f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: OPUSBILLINGADDRESSKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c53a3c8-9bd9-438f-863a-153a8921bfc8
                stepCounter: 1754f4d6-4bc7-4881-ae36-8ba5394a24fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eacb84e4-9e02-4ade-9584-f131176e39b9
          stepCounter: cc13247f-19a8-4da4-8189-9eba91dfe53f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: OPUSPAYMENTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 06908941-a25f-4477-ae54-050216f384f9
                stepCounter: 5e2150c7-a87c-46d6-85e2-08f57926ac3b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72aa93a2-2f88-45b3-911c-7fe37fc833ac
          stepCounter: cc13247f-19a8-4da4-8189-9eba91dfe53f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEOPUS_ORDER_ADDKEYS.SUPPLIERID=OPUS_SUPPLIER.SUPPLIEROPUSID
        name: OPUSSUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3d1ff80d-7379-4792-8999-53104514e50f
                stepCounter: 433e71b5-067e-4283-a8d2-3f73351f62ac
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 915392aa-e39a-41ce-8a2b-56d7372d817a
          stepCounter: cc13247f-19a8-4da4-8189-9eba91dfe53f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: OPUSSHIPPINGADDRESSKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11d13366-d10c-4cc5-8852-c754240be5d1
                stepCounter: c13d86b8-ed0a-4447-86f3-bc64ba3b04b8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0cbc940-66af-4d76-a8c7-fb7eae07f19e
          stepCounter: cc13247f-19a8-4da4-8189-9eba91dfe53f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: DIMCONTACTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dcf753c9-6ce6-4287-960d-d7a6b21b22fc
                stepCounter: d056aba3-a0b9-4509-9a27-e51f9da7fe1b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab0d5567-1007-4c5f-b338-12261f4030b5
          stepCounter: cc13247f-19a8-4da4-8189-9eba91dfe53f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: ACCOUNTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bae9c318-63c2-4058-8e74-f5509f5b4522
                stepCounter: d5234d5a-eb19-45e2-9c42-47221579f347
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f34586b-d981-4410-b8da-689bc6a4909e
          stepCounter: cc13247f-19a8-4da4-8189-9eba91dfe53f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED KEY FOR THE DATE DIMENSION. NOMINAL FORMAT IS YYYYMMDD, BUT DD EQUAL TO 0 AND GREATER THAN 31 PERMITED FOR SPECIAL DATE HANDLING.
        name: OPUSORDERDATEKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fda38031-db65-42e6-b5c0-eedbdb0fdd22
                stepCounter: 68a37472-c8ff-47f9-8d83-2e69e6a5d507
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a6d38a8-0b8b-487f-974b-22a72bb2b7d3
          stepCounter: cc13247f-19a8-4da4-8189-9eba91dfe53f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PARENTORDERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0cfd2649-f3de-4cb7-ba90-b136d44c1f04
                stepCounter: 1daf6cad-e0d0-468f-a153-cd1736fd08a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e75fd797-f509-45b2-b5af-ed62f89c13c0
          stepCounter: cc13247f-19a8-4da4-8189-9eba91dfe53f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PARENTORDERNUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cbd40243-e4b4-49f6-9ad9-ffd22335631b
                stepCounter: 1daf6cad-e0d0-468f-a153-cd1736fd08a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b2e43145-232e-4b01-bca9-a98d45b9d7cd
          stepCounter: cc13247f-19a8-4da4-8189-9eba91dfe53f
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SUPPLIERFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd45c1b3-f5f5-45aa-8b0d-4efefa0094a9
                stepCounter: 433e71b5-067e-4283-a8d2-3f73351f62ac
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54a92952-4a46-4b9d-8e82-3b52571867ad
          stepCounter: cc13247f-19a8-4da4-8189-9eba91dfe53f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORDERNUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f68268a-c4c4-433b-b214-58cc4c7b8aa7
                stepCounter: 1daf6cad-e0d0-468f-a153-cd1736fd08a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0def85c4-894f-4a33-b6f2-9e23bfcd0f8b
          stepCounter: cc13247f-19a8-4da4-8189-9eba91dfe53f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: ORDERDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a52309e4-45b8-4caa-9b4d-8671212a2b7e
                stepCounter: 1daf6cad-e0d0-468f-a153-cd1736fd08a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 216e8c6e-614b-41dc-93b3-980be94b1296
          stepCounter: cc13247f-19a8-4da4-8189-9eba91dfe53f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CARTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e143ffa1-84d2-4019-af9b-5c024c3a7c8e
                stepCounter: 1daf6cad-e0d0-468f-a153-cd1736fd08a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21e46211-1a94-4152-9e09-6bcbad94d065
          stepCounter: cc13247f-19a8-4da4-8189-9eba91dfe53f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: ORDERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 82c3b538-0cbe-43f2-bb85-1527a91adc00
                stepCounter: 1daf6cad-e0d0-468f-a153-cd1736fd08a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e4b5d829-dea5-4890-b71c-4a0e9090dea8
          stepCounter: cc13247f-19a8-4da4-8189-9eba91dfe53f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 790bac7c-71e4-4e52-be39-63ece46fcf82
                stepCounter: 1daf6cad-e0d0-468f-a153-cd1736fd08a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e568a16-7cb9-4921-8859-82cbad4fc71e
          stepCounter: cc13247f-19a8-4da4-8189-9eba91dfe53f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORDERSTATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb841d04-73c6-4143-83d3-f5e6d27664db
                stepCounter: 1daf6cad-e0d0-468f-a153-cd1736fd08a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cecfcd72-9043-4083-8e28-fa30121d7886
          stepCounter: cc13247f-19a8-4da4-8189-9eba91dfe53f
        config: {}
        dataType: NUMBER(38,4)
        defaultValue: ""
        description: ""
        name: PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2f9bdba-7c43-4911-b8aa-ccbf2e7ec8d8
                stepCounter: 1daf6cad-e0d0-468f-a153-cd1736fd08a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2950b253-6fc5-47ec-a927-0f36a03335ec
          stepCounter: cc13247f-19a8-4da4-8189-9eba91dfe53f
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: QUANTITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea888315-5cf9-41de-8fc2-bb91d57e5f6d
                stepCounter: 1daf6cad-e0d0-468f-a153-cd1736fd08a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e079312-a443-4931-af46-0b20a03895a7
          stepCounter: cc13247f-19a8-4da4-8189-9eba91dfe53f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PRODUCTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 95cd0df1-0277-4ca9-910f-8ce335a03eb7
                stepCounter: 1daf6cad-e0d0-468f-a153-cd1736fd08a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3aac0445-7879-4d3c-bbea-fe0fe77796e6
          stepCounter: cc13247f-19a8-4da4-8189-9eba91dfe53f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a6a23bc-ccda-4806-93bd-dd2b4262e78d
                stepCounter: 1daf6cad-e0d0-468f-a153-cd1736fd08a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 153fe50d-11bc-4216-b9c0-5673d61bfba9
          stepCounter: cc13247f-19a8-4da4-8189-9eba91dfe53f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db11c4b4-3de1-496a-ad66-67bce0916e55
                stepCounter: 1daf6cad-e0d0-468f-a153-cd1736fd08a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 65eed94a-92aa-4eaa-bdcf-b650e4348e6e
          stepCounter: cc13247f-19a8-4da4-8189-9eba91dfe53f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PAYMENTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c9aae184-977f-43d0-8902-741a747c16bd
                stepCounter: 1daf6cad-e0d0-468f-a153-cd1736fd08a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22a346c7-f3b6-43ed-a916-c16b2b60dd1e
          stepCounter: cc13247f-19a8-4da4-8189-9eba91dfe53f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: BILLINGADDRESSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ad114e0f-0300-454c-a54f-559fce75b327
                stepCounter: 1daf6cad-e0d0-468f-a153-cd1736fd08a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f45f7f9f-46f9-430d-bbf3-a8eac06fc559
          stepCounter: cc13247f-19a8-4da4-8189-9eba91dfe53f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: SHIPPINGADDRESSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9b409976-a16f-44cb-b909-641346fa33f9
                stepCounter: 1daf6cad-e0d0-468f-a153-cd1736fd08a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e0a14fd-1d58-4f4f-bcfa-ea1a1abb63c4
          stepCounter: cc13247f-19a8-4da4-8189-9eba91dfe53f
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5270176e-ffb4-49cb-a766-e1b3e49400c1
                stepCounter: 1daf6cad-e0d0-468f-a153-cd1736fd08a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 964fd379-b27f-4282-9e1d-4b03d713b2d9
          stepCounter: cc13247f-19a8-4da4-8189-9eba91dfe53f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8219e426-0f9d-498f-b210-e64c07a427cb
                stepCounter: 1daf6cad-e0d0-468f-a153-cd1736fd08a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 335ea941-f59c-4ade-bb1f-b4e37b06cda8
          stepCounter: cc13247f-19a8-4da4-8189-9eba91dfe53f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eeb1577a-995c-4c8d-b845-beac5c1e43df
          stepCounter: cc13247f-19a8-4da4-8189-9eba91dfe53f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGEFACT_OPUS_ORDER: 1daf6cad-e0d0-468f-a153-cd1736fd08a7
          OPUS_PRODUCT: f0f25bb4-d26f-4e2a-9e67-429aa61f0625
          OPUS_CART: 625443fe-16ff-4435-ae20-b1b1c489bf1e
          OPUS_BILLING_ADDRESS: 1754f4d6-4bc7-4881-ae36-8ba5394a24fd
          OPUS_PAYMENT: 5e2150c7-a87c-46d6-85e2-08f57926ac3b
          OPUS_SHIPPING_ADDRESS: c13d86b8-ed0a-4447-86f3-bc64ba3b04b8
          CONTACT: d056aba3-a0b9-4509-9a27-e51f9da7fe1b
          ACCOUNT: d5234d5a-eb19-45e2-9c42-47221579f347
          VWOPUS_ORDER_DATE: 68a37472-c8ff-47f9-8d83-2e69e6a5d507
          OPUS_CONTACT: c0d5aa6a-a938-447b-8e2e-a1e53d310fc4
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: DIM
            nodeName: CONTACT
          - locationName: DIM
            nodeName: OPUS_BILLING_ADDRESS
          - locationName: DIM
            nodeName: OPUS_CART
          - locationName: DIM
            nodeName: OPUS_CONTACT
          - locationName: DIM
            nodeName: OPUS_PAYMENT
          - locationName: DIM
            nodeName: OPUS_PRODUCT
          - locationName: DIM
            nodeName: OPUS_SHIPPING_ADDRESS
          - locationName: DIM
            nodeName: OPUS_SUPPLIER
          - locationName: DIM
            nodeName: VWOPUS_ORDER_DATE
          - locationName: STAGE
            nodeName: STAGEFACT_OPUS_ORDER
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','STAGEFACT_OPUS_ORDER') }} STAGEFACT_OPUS_ORDER
              LEFT JOIN {{ ref('DIM','OPUS_PRODUCT') }} OPUS_PRODUCT
                ON STAGEFACT_OPUS_ORDER.PRODUCTID = OPUS_PRODUCT.PRODUCTID
              LEFT JOIN {{ ref('DIM','OPUS_CART') }} OPUS_CART
                ON STAGEFACT_OPUS_ORDER.CARTID = OPUS_CART.CARTID
              LEFT JOIN {{ ref('DIM','OPUS_BILLING_ADDRESS') }} OPUS_BILLING_ADDRESS
                ON STAGEFACT_OPUS_ORDER.BILLINGADDRESSID = OPUS_BILLING_ADDRESS.BILLINGADDRESSID
               AND STAGEFACT_OPUS_ORDER.ORGANIZATIONID = OPUS_BILLING_ADDRESS.ORGANIZATIONID
              LEFT JOIN {{ ref('DIM','OPUS_PAYMENT') }} OPUS_PAYMENT
                ON STAGEFACT_OPUS_ORDER.PAYMENTID = OPUS_PAYMENT.PAYMENTID
              LEFT JOIN {{ ref('DIM','OPUS_SHIPPING_ADDRESS') }} OPUS_SHIPPING_ADDRESS
                ON STAGEFACT_OPUS_ORDER.SHIPPINGADDRESSID = OPUS_SHIPPING_ADDRESS.SHIPPINGADDRESSID
               AND STAGEFACT_OPUS_ORDER.ORGANIZATIONID = OPUS_SHIPPING_ADDRESS.ORGANIZATIONID
              LEFT JOIN {{ ref('DIM','CONTACT') }} CONTACT
                ON STAGEFACT_OPUS_ORDER.CUSTOMERID = CONTACT.OPUS_CUSTOMER_ID
              LEFT JOIN {{ ref('DIM','ACCOUNT') }} ACCOUNT
                ON STAGEFACT_OPUS_ORDER.ORGANIZATIONID = ACCOUNT.OPUS_ORGANIZATION_ID
              LEFT JOIN {{ ref('DIM','VWOPUS_ORDER_DATE') }} VWOPUS_ORDER_DATE
                ON STAGEFACT_OPUS_ORDER.ORDERDATE = VWOPUS_ORDER_DATE.OPUS_ORDER_CALENDAR_DATE
              LEFT JOIN {{ ref('DIM','OPUS_CONTACT') }} OPUS_CONTACT
                ON STAGEFACT_OPUS_ORDER.CUSTOMERID = OPUS_CONTACT.CUSTOMERID
               AND STAGEFACT_OPUS_ORDER.ORGANIZATIONID = OPUS_CONTACT.ORGANIZATIONID
        name: STAGEOPUS_ORDER_ADDKEYS
        noLinkRefs: []
  name: STAGEOPUS_ORDER_ADDKEYS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
