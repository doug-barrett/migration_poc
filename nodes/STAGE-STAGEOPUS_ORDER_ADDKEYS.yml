fileVersion: 1
id: 67537a53-9b19-4510-8ee8-bb7e7da92d21
name: STAGEOPUS_ORDER_ADDKEYS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5448a056-1152-4dc0-b0d3-b20602cd2884
          stepCounter: 67537a53-9b19-4510-8ee8-bb7e7da92d21
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPUS_CONTACTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c8db74f0-c2b0-45f0-b327-a0a77a8872a9
                stepCounter: bc9fc8e9-df64-4382-9187-35501ef6eb51
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5f3b14c-152e-462c-9f43-0dd6daf96a2d
          stepCounter: 67537a53-9b19-4510-8ee8-bb7e7da92d21
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPUSPRODUCTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8fddb3a8-8581-47ad-8268-7ebe45a933fd
                stepCounter: 934f8229-8c20-4d10-8c23-f861076b653f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7e57d48-8598-4799-993d-7de5c63bc1bb
          stepCounter: 67537a53-9b19-4510-8ee8-bb7e7da92d21
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPUSCARTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 184e306b-40e8-4457-bdf8-499065946a9f
                stepCounter: 910d8723-98c3-4495-b7d4-791e60bd1885
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6738cc6-a210-406e-a9f1-10e7e0c5c111
          stepCounter: 67537a53-9b19-4510-8ee8-bb7e7da92d21
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPUSBILLINGADDRESSKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f69fbcef-36a6-4a1e-8de5-3969f31c473a
                stepCounter: 90a10be1-72a1-48f0-8bfe-635d368b7e32
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c9109f8-dd4c-4b28-b091-8a8eeb518f91
          stepCounter: 67537a53-9b19-4510-8ee8-bb7e7da92d21
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPUSPAYMENTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dd791b65-03b1-40aa-b108-9dcbc0d6ecb0
                stepCounter: 2dc69be1-73ab-4422-9fd3-2f7130892989
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ffc81e8-8c04-4548-abc2-b21a8f4d62ad
          stepCounter: 67537a53-9b19-4510-8ee8-bb7e7da92d21
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: StageOPUS_ORDER_AddKeys.SupplierId=OPUS_SUPPLIER.SupplierOPUSId
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPUSSUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 603c3ffe-dae2-4135-b5c4-7fe690f68c0e
                stepCounter: 7fb2e9dd-f477-49a6-9807-bd5097b6a8f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c94045f9-4563-4466-8ad6-721f2188d654
          stepCounter: 67537a53-9b19-4510-8ee8-bb7e7da92d21
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPUSSHIPPINGADDRESSKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3418f656-2dab-4215-b86f-4e4269d5799c
                stepCounter: 61f21d46-cddf-49f3-b27a-0799c4623b48
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 716002f2-424b-4fa1-b848-d0ff3c91a863
          stepCounter: 67537a53-9b19-4510-8ee8-bb7e7da92d21
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DIMCONTACTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c6c95a9-173a-41a1-8a25-a73143fcc576
                stepCounter: 5fa12080-8040-4cbf-96f4-8e9c84eee853
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 466731ed-4066-420f-b0c3-484b4cf355c3
          stepCounter: 67537a53-9b19-4510-8ee8-bb7e7da92d21
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ACCOUNTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 923f9154-d06b-4433-99fd-95c767283389
                stepCounter: a594f58e-2240-453f-a570-12719830e3d0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f63371cb-3f43-4870-a564-ae8784896047
          stepCounter: 67537a53-9b19-4510-8ee8-bb7e7da92d21
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated key for the date dimension. Nominal format is YYYYMMDD, but DD equal to 0 and greater than 31 permited for special date handling.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPUSORDERDATEKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef740465-10b0-4dda-8615-b5c724b223ba
                stepCounter: a6ec05ff-f7a7-4dae-934c-f3992835523a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70fe2065-1c2d-4469-a21a-451bd4a785b2
          stepCounter: 67537a53-9b19-4510-8ee8-bb7e7da92d21
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PARENTORDERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c0f9349d-24e5-4732-b0ba-69bf1ae3ae33
                stepCounter: 93d502d4-acd7-4673-955e-3189d4b97940
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b747edc7-6578-4bb7-b6e4-16fd980439fa
          stepCounter: 67537a53-9b19-4510-8ee8-bb7e7da92d21
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PARENTORDERNUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 986501c3-c8f0-48bc-8872-2b72284dbe92
                stepCounter: 93d502d4-acd7-4673-955e-3189d4b97940
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2ea63b4-f8a1-4525-97ce-bf9f6be1cd03
          stepCounter: 67537a53-9b19-4510-8ee8-bb7e7da92d21
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SUPPLIERFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5cb3553c-0098-4df8-b603-f4b12feae885
                stepCounter: 7fb2e9dd-f477-49a6-9807-bd5097b6a8f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 282d3787-24f8-43a6-b3f0-3ab0b75a1aba
          stepCounter: 67537a53-9b19-4510-8ee8-bb7e7da92d21
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ORDERNUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 43765bb0-bf3b-4586-8e82-6bc356dc6c05
                stepCounter: 93d502d4-acd7-4673-955e-3189d4b97940
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6bb56307-0c43-4aaf-b865-6b22970c04da
          stepCounter: 67537a53-9b19-4510-8ee8-bb7e7da92d21
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ORDERDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c6f98697-404b-4db6-b2ad-9e398bacace4
                stepCounter: 93d502d4-acd7-4673-955e-3189d4b97940
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cba044d3-e276-4746-9e0b-fa97749e350f
          stepCounter: 67537a53-9b19-4510-8ee8-bb7e7da92d21
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CARTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 92febf5e-955f-47d6-b6e3-528f764317b4
                stepCounter: 93d502d4-acd7-4673-955e-3189d4b97940
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3fdb1843-e294-463c-83ae-2e2cfe5c60c8
          stepCounter: 67537a53-9b19-4510-8ee8-bb7e7da92d21
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: ORDERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de2c4875-41ff-4658-bc98-8ae6228b9c57
                stepCounter: 93d502d4-acd7-4673-955e-3189d4b97940
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09be8b09-4f20-4ca1-8f95-39c73ae28a30
          stepCounter: 67537a53-9b19-4510-8ee8-bb7e7da92d21
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 68171857-00fc-4277-869f-a73547b524fc
                stepCounter: 93d502d4-acd7-4673-955e-3189d4b97940
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7a4b09b-bd07-4f76-a5ea-f1aff42bfbcf
          stepCounter: 67537a53-9b19-4510-8ee8-bb7e7da92d21
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ORDERSTATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 987aae0e-ccf1-465a-91b7-509fd137a048
                stepCounter: 93d502d4-acd7-4673-955e-3189d4b97940
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 274e1a6f-df3c-44fe-bfdb-1eeeddd78a62
          stepCounter: 67537a53-9b19-4510-8ee8-bb7e7da92d21
        config: {}
        dataType: NUMBER(38,4)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e366ce70-5536-4779-889c-a31bfacdc596
                stepCounter: 93d502d4-acd7-4673-955e-3189d4b97940
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0dbb27e-39a7-4c78-8a4d-cc5cdc9d7672
          stepCounter: 67537a53-9b19-4510-8ee8-bb7e7da92d21
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: QUANTITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c39b4a1d-f743-49b4-96bf-155143ef5410
                stepCounter: 93d502d4-acd7-4673-955e-3189d4b97940
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dac402d7-e6f2-4397-9332-b7128f2c7af9
          stepCounter: 67537a53-9b19-4510-8ee8-bb7e7da92d21
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PRODUCTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d1beb18-fe83-4b75-bd7d-c7689a42b410
                stepCounter: 93d502d4-acd7-4673-955e-3189d4b97940
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 46fbc356-ca19-4e1f-8e24-d1bd0f1e52ce
          stepCounter: 67537a53-9b19-4510-8ee8-bb7e7da92d21
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1fa85150-13ed-41d2-9366-83da2126e0db
                stepCounter: 93d502d4-acd7-4673-955e-3189d4b97940
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5faeb9db-c94f-41d7-a874-70c5eca1d6b4
          stepCounter: 67537a53-9b19-4510-8ee8-bb7e7da92d21
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c45455a6-01a7-45b2-b92c-42d25d24276d
                stepCounter: 93d502d4-acd7-4673-955e-3189d4b97940
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e1be967-1eaa-49e1-b5d1-f7ec20db6cb1
          stepCounter: 67537a53-9b19-4510-8ee8-bb7e7da92d21
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PAYMENTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef8a1c6b-b75a-4e8f-a18f-760532603856
                stepCounter: 93d502d4-acd7-4673-955e-3189d4b97940
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4b3dad9-5273-4046-8f6f-70508eef175c
          stepCounter: 67537a53-9b19-4510-8ee8-bb7e7da92d21
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: BILLINGADDRESSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5994a77c-cd91-4917-adbc-a401f2cff61b
                stepCounter: 93d502d4-acd7-4673-955e-3189d4b97940
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 989b8830-f4e7-447c-89a9-f226554f48e9
          stepCounter: 67537a53-9b19-4510-8ee8-bb7e7da92d21
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SHIPPINGADDRESSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d9dcdc30-8619-4cd4-82f1-456613a5bb65
                stepCounter: 93d502d4-acd7-4673-955e-3189d4b97940
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dd7fd6e4-ceb3-4b2f-8a81-189ffc9e688a
          stepCounter: 67537a53-9b19-4510-8ee8-bb7e7da92d21
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: Record source.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d1cbad7-fbe7-4c2c-81f6-652fc271f62b
                stepCounter: 93d502d4-acd7-4673-955e-3189d4b97940
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8c3d620-e889-42f6-97a9-11cd61c83fff
          stepCounter: 67537a53-9b19-4510-8ee8-bb7e7da92d21
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Load date.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a195fc55-7264-4465-9adf-21e651d6c96e
                stepCounter: 93d502d4-acd7-4673-955e-3189d4b97940
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d0299e4-8df1-4477-ad53-8df3b1075615
          stepCounter: 67537a53-9b19-4510-8ee8-bb7e7da92d21
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ddf7e36a-01a3-4d4a-ab80-aba76d7b23b1
          stepCounter: 67537a53-9b19-4510-8ee8-bb7e7da92d21
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGEFACT_OPUS_ORDER: 93d502d4-acd7-4673-955e-3189d4b97940
          OPUS_PRODUCT: 934f8229-8c20-4d10-8c23-f861076b653f
          OPUS_CART: 910d8723-98c3-4495-b7d4-791e60bd1885
          OPUS_BILLING_ADDRESS: 90a10be1-72a1-48f0-8bfe-635d368b7e32
          OPUS_PAYMENT: 2dc69be1-73ab-4422-9fd3-2f7130892989
          OPUS_SHIPPING_ADDRESS: 61f21d46-cddf-49f3-b27a-0799c4623b48
          CONTACT: 5fa12080-8040-4cbf-96f4-8e9c84eee853
          ACCOUNT: a594f58e-2240-453f-a570-12719830e3d0
          VWOPUS_ORDER_DATE: a6ec05ff-f7a7-4dae-934c-f3992835523a
          OPUS_CONTACT: bc9fc8e9-df64-4382-9187-35501ef6eb51
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: DIM
            nodeName: CONTACT
          - locationName: DIM
            nodeName: OPUS_BILLING_ADDRESS
          - locationName: DIM
            nodeName: OPUS_CART
          - locationName: DIM
            nodeName: OPUS_CONTACT
          - locationName: DIM
            nodeName: OPUS_PAYMENT
          - locationName: DIM
            nodeName: OPUS_PRODUCT
          - locationName: DIM
            nodeName: OPUS_SHIPPING_ADDRESS
          - locationName: DIM
            nodeName: OPUS_SUPPLIER
          - locationName: DIM
            nodeName: VWOPUS_ORDER_DATE
          - locationName: STAGE
            nodeName: STAGEFACT_OPUS_ORDER
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','STAGEFACT_OPUS_ORDER') }} StageFACT_OPUS_ORDER
              LEFT JOIN {{ ref('DIM','OPUS_PRODUCT') }} OPUS_PRODUCT
                ON StageFACT_OPUS_ORDER.ProductId = OPUS_PRODUCT.ProductId
              LEFT JOIN {{ ref('DIM','OPUS_CART') }} OPUS_CART
                ON StageFACT_OPUS_ORDER.CartId = OPUS_CART.CartId
              LEFT JOIN {{ ref('DIM','OPUS_BILLING_ADDRESS') }} OPUS_BILLING_ADDRESS
                ON StageFACT_OPUS_ORDER.BillingAddressId = OPUS_BILLING_ADDRESS.BillingAddressId
               AND StageFACT_OPUS_ORDER.OrganizationId = OPUS_Billing_ADDRESS.OrganizationId
              LEFT JOIN {{ ref('DIM','OPUS_PAYMENT') }} OPUS_PAYMENT
                ON StageFACT_OPUS_ORDER.PaymentId = OPUS_PAYMENT.PaymentId
              LEFT JOIN {{ ref('DIM','OPUS_SHIPPING_ADDRESS') }} OPUS_SHIPPING_ADDRESS
                ON StageFACT_OPUS_ORDER.ShippingAddressId = OPUS_SHIPPING_ADDRESS.ShippingAddressId
               AND StageFACT_OPUS_ORDER.OrganizationId = OPUS_SHIPPING_ADDRESS.OrganizationId
              LEFT JOIN {{ ref('DIM','CONTACT') }} Contact
                ON StageFACT_OPUS_ORDER.CustomerId = Contact.OPUS_Customer_Id
              LEFT JOIN {{ ref('DIM','ACCOUNT') }} ACCOUNT
                ON StageFACT_OPUS_ORDER.OrganizationId = Account.OPUS_Organization_Id
              LEFT JOIN {{ ref('DIM','VWOPUS_ORDER_DATE') }} vwOPUS_ORDER_DATE
                ON StageFACT_OPUS_ORDER.OrderDate = vwOPUS_ORDER_DATE.OPUS_ORDER_CALENDAR_DATE
              LEFT JOIN {{ ref('DIM','OPUS_CONTACT') }} OPUS_CONTACT
                ON StageFACT_OPUS_ORDER.CustomerId = OPUS_CONTACT.CustomerId
               AND StageFACT_OPUS_ORDER.OrganizationId = OPUS_CONTACT.OrganizationId
        name: STAGEOPUS_ORDER_ADDKEYS
        noLinkRefs: []
  name: STAGEOPUS_ORDER_ADDKEYS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
