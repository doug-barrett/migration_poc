fileVersion: 1
id: 7ba2b997-6b61-41d4-8eef-d3c05fa6b27e
name: STAGEOPUS_ORDER_ADDKEYS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e542499-742a-45af-afac-943de1a080fb
          stepCounter: 7ba2b997-6b61-41d4-8eef-d3c05fa6b27e
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPUS_CONTACTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf8373b7-6487-4b03-82e7-7c357c7b7999
                stepCounter: a1714c53-65dc-4058-889d-a0edea7c661c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34bf88b3-ed2e-4ff3-b945-ff5bdf68c8ba
          stepCounter: 7ba2b997-6b61-41d4-8eef-d3c05fa6b27e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPUSPRODUCTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb5f1d8f-c184-4e6d-96e6-e0091c6e8092
                stepCounter: 601bd7d8-ec69-49fb-a0f1-9847c982e986
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57ef404b-d6f1-47dd-bcc1-93e975bb5055
          stepCounter: 7ba2b997-6b61-41d4-8eef-d3c05fa6b27e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPUSCARTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56b66edd-e082-4520-b0ec-0841a2804403
                stepCounter: bdadfb15-0110-46ae-8e30-70f653fd0c8a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2e37776-60e3-4cd7-813e-80b6454c2893
          stepCounter: 7ba2b997-6b61-41d4-8eef-d3c05fa6b27e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPUSBILLINGADDRESSKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8623573b-a973-47e2-be35-8572efdc6d72
                stepCounter: 708c379e-3ee0-4fc3-a436-39927355ab4f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6fdb055e-cb97-40fa-b414-2e035ba586f1
          stepCounter: 7ba2b997-6b61-41d4-8eef-d3c05fa6b27e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPUSPAYMENTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bb3244b3-b084-4337-92bd-00f2ad0cdea9
                stepCounter: 4bd3f855-ab2c-455b-ae28-72b305fb25ef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8900de7-3a59-4983-b6e7-18d203ce6f80
          stepCounter: 7ba2b997-6b61-41d4-8eef-d3c05fa6b27e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: StageOPUS_ORDER_AddKeys.SupplierId=OPUS_SUPPLIER.SupplierOPUSId
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPUSSUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 92495bb3-216f-40b1-8389-02b19f311c56
                stepCounter: f4d3ca93-32bf-4539-9b82-c5c1d3869942
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4972faca-ad22-4f1c-a121-006242876997
          stepCounter: 7ba2b997-6b61-41d4-8eef-d3c05fa6b27e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPUSSHIPPINGADDRESSKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0d80d65d-1a7a-48fe-906b-ce5295c4baf5
                stepCounter: 17e7a2fb-fbf6-4fc3-8d72-21078081d6c7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 733a9b3e-b2ba-47ca-b2d9-67df3b2f5b52
          stepCounter: 7ba2b997-6b61-41d4-8eef-d3c05fa6b27e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DIMCONTACTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a73af37f-395a-43e2-ad1e-46c2fedc925a
                stepCounter: e165c76e-6a45-4567-817a-c8ecf377ecd2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7ddbaee-ee34-4ee3-b737-0f83105958aa
          stepCounter: 7ba2b997-6b61-41d4-8eef-d3c05fa6b27e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ACCOUNTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 142e5dc4-d508-469e-862b-8ad4d3c7b053
                stepCounter: c278473c-12f0-41e1-b65b-faa4b3c2a978
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b34d2577-ae97-4d98-a57f-ff0dae06b74d
          stepCounter: 7ba2b997-6b61-41d4-8eef-d3c05fa6b27e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated key for the date dimension. Nominal format is YYYYMMDD, but DD equal to 0 and greater than 31 permited for special date handling.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPUSORDERDATEKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 06c7e4f6-b213-4c57-8309-2f551331039a
                stepCounter: f160c54f-fad3-4ccd-ab11-fbbf07d7f135
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e806130-6fca-45ee-a4b7-0478029f8272
          stepCounter: 7ba2b997-6b61-41d4-8eef-d3c05fa6b27e
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PARENTORDERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: edcb3437-3ad3-4171-893e-06fa133d9162
                stepCounter: b0ffae15-4cc2-4ac3-b775-0a7de100e39c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa159af6-09dc-47e0-a5a0-38805b5ab87f
          stepCounter: 7ba2b997-6b61-41d4-8eef-d3c05fa6b27e
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PARENTORDERNUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eadfe71d-c9f8-4e78-aecd-79f4bd054b7d
                stepCounter: b0ffae15-4cc2-4ac3-b775-0a7de100e39c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3070ccaf-14c2-45ea-9a13-ec1a74d57136
          stepCounter: 7ba2b997-6b61-41d4-8eef-d3c05fa6b27e
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SUPPLIERFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 82e1ae19-7206-44dd-a011-0dd68d117b88
                stepCounter: f4d3ca93-32bf-4539-9b82-c5c1d3869942
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 928f3f3c-a8ac-48fb-9b5b-bc7da6fe5d8d
          stepCounter: 7ba2b997-6b61-41d4-8eef-d3c05fa6b27e
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ORDERNUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 242d2f9d-ba5c-4a43-9c65-201b33ae5a9a
                stepCounter: b0ffae15-4cc2-4ac3-b775-0a7de100e39c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 08de873c-7ce7-45fd-b692-a185993ff73c
          stepCounter: 7ba2b997-6b61-41d4-8eef-d3c05fa6b27e
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ORDERDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f37840a-3c0b-4b16-9d63-8fe0d01eb5c7
                stepCounter: b0ffae15-4cc2-4ac3-b775-0a7de100e39c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77f672d9-5825-43c9-92a2-f0e852958984
          stepCounter: 7ba2b997-6b61-41d4-8eef-d3c05fa6b27e
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CARTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 32ddc5f6-0060-43fa-9817-e2fe2f186117
                stepCounter: b0ffae15-4cc2-4ac3-b775-0a7de100e39c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54745464-349f-4dbd-8f54-6866ce8c84e2
          stepCounter: 7ba2b997-6b61-41d4-8eef-d3c05fa6b27e
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: ORDERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f758629e-3245-4402-b31d-25a3fbe64c38
                stepCounter: b0ffae15-4cc2-4ac3-b775-0a7de100e39c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ec9b1da-ba31-4f1a-9399-e26638be075e
          stepCounter: 7ba2b997-6b61-41d4-8eef-d3c05fa6b27e
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3caed174-cc2c-4e93-8d3e-d4fc1ffac315
                stepCounter: b0ffae15-4cc2-4ac3-b775-0a7de100e39c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce772160-79ea-4b23-b4c5-bda6c38d70d0
          stepCounter: 7ba2b997-6b61-41d4-8eef-d3c05fa6b27e
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ORDERSTATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed8d0aaf-2df1-4f27-99f3-9e954e929132
                stepCounter: b0ffae15-4cc2-4ac3-b775-0a7de100e39c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97ce2281-600f-4507-8bd1-0c088798f564
          stepCounter: 7ba2b997-6b61-41d4-8eef-d3c05fa6b27e
        config: {}
        dataType: NUMBER(38,4)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67b9f16a-fcf0-4526-b680-1b8e79eeb70f
                stepCounter: b0ffae15-4cc2-4ac3-b775-0a7de100e39c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80a82b28-0780-42b6-86a9-82fa1547ae48
          stepCounter: 7ba2b997-6b61-41d4-8eef-d3c05fa6b27e
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: QUANTITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 406a0761-94e2-4bb1-87ba-17d7499e88e4
                stepCounter: b0ffae15-4cc2-4ac3-b775-0a7de100e39c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2845c158-9e3c-43c6-8ae6-43e70afa19bb
          stepCounter: 7ba2b997-6b61-41d4-8eef-d3c05fa6b27e
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PRODUCTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94d2570a-9c4b-420d-990b-4e9840f3ce72
                stepCounter: b0ffae15-4cc2-4ac3-b775-0a7de100e39c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 293f4091-7212-4924-8b92-1ae9221c21b7
          stepCounter: 7ba2b997-6b61-41d4-8eef-d3c05fa6b27e
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2f0e4937-0f27-4bae-a23f-a32a5475e500
                stepCounter: b0ffae15-4cc2-4ac3-b775-0a7de100e39c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 288b24d9-96da-4a0f-ad01-7dedb4045766
          stepCounter: 7ba2b997-6b61-41d4-8eef-d3c05fa6b27e
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d02d5df2-8a6b-4b4a-9cf1-c415ab9fbf19
                stepCounter: b0ffae15-4cc2-4ac3-b775-0a7de100e39c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f42cbe80-1f71-4d32-95e3-e8759d0fcef2
          stepCounter: 7ba2b997-6b61-41d4-8eef-d3c05fa6b27e
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PAYMENTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: baae1b7e-62f5-4f70-b272-4e17b4b5dc29
                stepCounter: b0ffae15-4cc2-4ac3-b775-0a7de100e39c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7686936-f993-432d-b3f5-e46674f8c532
          stepCounter: 7ba2b997-6b61-41d4-8eef-d3c05fa6b27e
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: BILLINGADDRESSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 49321aca-434a-4872-84ce-a8ca19e3a9e1
                stepCounter: b0ffae15-4cc2-4ac3-b775-0a7de100e39c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa5279e1-fe0f-4a34-8016-8bd14d742594
          stepCounter: 7ba2b997-6b61-41d4-8eef-d3c05fa6b27e
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SHIPPINGADDRESSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7fbe081c-d1db-49c9-a507-76d8040e86cf
                stepCounter: b0ffae15-4cc2-4ac3-b775-0a7de100e39c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b8981d5-4d03-4e4e-a72e-30e3900b8a56
          stepCounter: 7ba2b997-6b61-41d4-8eef-d3c05fa6b27e
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: Record source.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f73589d7-1c4b-4d2e-bcec-24767bf79702
                stepCounter: b0ffae15-4cc2-4ac3-b775-0a7de100e39c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3594af44-d1b0-41b7-8a91-33e42728dc51
          stepCounter: 7ba2b997-6b61-41d4-8eef-d3c05fa6b27e
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Load date.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 63cbcb22-f405-48f2-adaf-7b2932aaa890
                stepCounter: b0ffae15-4cc2-4ac3-b775-0a7de100e39c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e202dc1c-5595-405e-b044-219c3da624f8
          stepCounter: 7ba2b997-6b61-41d4-8eef-d3c05fa6b27e
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c22b539-6af0-4f8d-be9a-05986c799321
          stepCounter: 7ba2b997-6b61-41d4-8eef-d3c05fa6b27e
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGEFACT_OPUS_ORDER: b0ffae15-4cc2-4ac3-b775-0a7de100e39c
          OPUS_PRODUCT: 601bd7d8-ec69-49fb-a0f1-9847c982e986
          OPUS_CART: bdadfb15-0110-46ae-8e30-70f653fd0c8a
          OPUS_BILLING_ADDRESS: 708c379e-3ee0-4fc3-a436-39927355ab4f
          OPUS_PAYMENT: 4bd3f855-ab2c-455b-ae28-72b305fb25ef
          OPUS_SHIPPING_ADDRESS: 17e7a2fb-fbf6-4fc3-8d72-21078081d6c7
          CONTACT: e165c76e-6a45-4567-817a-c8ecf377ecd2
          ACCOUNT: c278473c-12f0-41e1-b65b-faa4b3c2a978
          VWOPUS_ORDER_DATE: f160c54f-fad3-4ccd-ab11-fbbf07d7f135
          OPUS_CONTACT: a1714c53-65dc-4058-889d-a0edea7c661c
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: DIM
            nodeName: CONTACT
          - locationName: DIM
            nodeName: OPUS_BILLING_ADDRESS
          - locationName: DIM
            nodeName: OPUS_CART
          - locationName: DIM
            nodeName: OPUS_CONTACT
          - locationName: DIM
            nodeName: OPUS_PAYMENT
          - locationName: DIM
            nodeName: OPUS_PRODUCT
          - locationName: DIM
            nodeName: OPUS_SHIPPING_ADDRESS
          - locationName: DIM
            nodeName: OPUS_SUPPLIER
          - locationName: DIM
            nodeName: VWOPUS_ORDER_DATE
          - locationName: STAGE
            nodeName: STAGEFACT_OPUS_ORDER
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','STAGEFACT_OPUS_ORDER') }} StageFACT_OPUS_ORDER
              LEFT JOIN {{ ref('DIM','OPUS_PRODUCT') }} OPUS_PRODUCT
                ON StageFACT_OPUS_ORDER.ProductId = OPUS_PRODUCT.ProductId
              LEFT JOIN {{ ref('DIM','OPUS_CART') }} OPUS_CART
                ON StageFACT_OPUS_ORDER.CartId = OPUS_CART.CartId
              LEFT JOIN {{ ref('DIM','OPUS_BILLING_ADDRESS') }} OPUS_BILLING_ADDRESS
                ON StageFACT_OPUS_ORDER.BillingAddressId = OPUS_BILLING_ADDRESS.BillingAddressId
               AND StageFACT_OPUS_ORDER.OrganizationId = OPUS_Billing_ADDRESS.OrganizationId
              LEFT JOIN {{ ref('DIM','OPUS_PAYMENT') }} OPUS_PAYMENT
                ON StageFACT_OPUS_ORDER.PaymentId = OPUS_PAYMENT.PaymentId
              LEFT JOIN {{ ref('DIM','OPUS_SHIPPING_ADDRESS') }} OPUS_SHIPPING_ADDRESS
                ON StageFACT_OPUS_ORDER.ShippingAddressId = OPUS_SHIPPING_ADDRESS.ShippingAddressId
               AND StageFACT_OPUS_ORDER.OrganizationId = OPUS_SHIPPING_ADDRESS.OrganizationId
              LEFT JOIN {{ ref('DIM','CONTACT') }} Contact
                ON StageFACT_OPUS_ORDER.CustomerId = Contact.OPUS_Customer_Id
              LEFT JOIN {{ ref('DIM','ACCOUNT') }} ACCOUNT
                ON StageFACT_OPUS_ORDER.OrganizationId = Account.OPUS_Organization_Id
              LEFT JOIN {{ ref('DIM','VWOPUS_ORDER_DATE') }} vwOPUS_ORDER_DATE
                ON StageFACT_OPUS_ORDER.OrderDate = vwOPUS_ORDER_DATE.OPUS_ORDER_CALENDAR_DATE
              LEFT JOIN {{ ref('DIM','OPUS_CONTACT') }} OPUS_CONTACT
                ON StageFACT_OPUS_ORDER.CustomerId = OPUS_CONTACT.CustomerId
               AND StageFACT_OPUS_ORDER.OrganizationId = OPUS_CONTACT.OrganizationId
        name: STAGEOPUS_ORDER_ADDKEYS
        noLinkRefs: []
  name: STAGEOPUS_ORDER_ADDKEYS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
