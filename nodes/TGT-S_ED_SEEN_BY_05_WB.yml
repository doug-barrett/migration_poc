fileVersion: 1
id: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
name: S_ED_SEEN_BY_05_WB
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Stage Table, of WB Seen-By Data, to include Patient ID where the Enconter is provided instead"
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71efcd61-3d9a-41e3-a7be-a48036d84283
          stepCounter: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CACHENUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c05158b-f5c7-4f5d-ad2d-b59a4e04fbb1
                stepCounter: 67549678-cd35-4ad8-8f92-50af3c66539f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3944a425-629a-4c50-a0f7-450b314f98dc
          stepCounter: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 312e2f04-68a6-4ca7-9f68-e92f8c14ecb0
                stepCounter: 67549678-cd35-4ad8-8f92-50af3c66539f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fbf35d6e-80fd-43a5-bb8a-be419d980d43
          stepCounter: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: AEATT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 312e2f04-68a6-4ca7-9f68-e92f8c14ecb0
                stepCounter: 67549678-cd35-4ad8-8f92-50af3c66539f
            transform: substring(ds_WB_CacheAudit.encounternumber,2,20)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 154246ab-3a75-4741-b84b-7e1ace9d01c0
          stepCounter: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27fc81e8-050e-42f3-860b-87535af5f1c4
                stepCounter: 8ac69b4c-4a2a-4f8a-b9de-04aa425a1af3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf6d14fd-3672-4144-bff4-41703a277ebd
          stepCounter: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: EPISODETYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fcc9c6f9-3bbe-4ad4-a6ff-0e2ab7b7e5eb
                stepCounter: 67549678-cd35-4ad8-8f92-50af3c66539f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 232d337a-aca8-48f9-8759-36cd8911cbc3
          stepCounter: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Original value of Patient NHI from Source (may contain Encounter ID)
        name: WHITEBOARD_PATIENTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3055260-b585-480f-93f0-4231e052f569
                stepCounter: 67549678-cd35-4ad8-8f92-50af3c66539f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 568b215e-04ad-4483-abdd-db1ecd23e6e7
          stepCounter: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Derived from Whiteboard Patient ID
        name: PATIENTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3055260-b585-480f-93f0-4231e052f569
                stepCounter: 67549678-cd35-4ad8-8f92-50af3c66539f
            transform: |-
              CASE WHEN LEFT(ds_WB_CacheAudit.patientid,5) = 'Temp:' THEN (SELECT top 1 patient_NHI FROM ds_ed_attendance_30 WHERE attendance_encounter_id = SUBSTRING(ds_WB_CacheAudit.patientid,6,11))
                          ELSE ds_WB_CacheAudit.patientid
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bea35345-98e3-49df-a239-942be0b93ae6
          stepCounter: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
        config: {}
        dataType: VARCHAR(170)
        defaultValue: ""
        description: ""
        name: PATIENTFULLNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b59ae9a-05d7-43ce-9ef2-311bd8049de6
                stepCounter: 67549678-cd35-4ad8-8f92-50af3c66539f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa9292d0-31ac-4571-a6e4-fe2d6f6d3e13
          stepCounter: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SPECIALTYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b564c8eb-1ec9-4cf0-888b-41f8be832c98
                stepCounter: 8ac69b4c-4a2a-4f8a-b9de-04aa425a1af3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 62581170-8c84-4e1a-be5c-af3bc510ea33
          stepCounter: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0424e0dc-3548-468a-a8a3-7a24285fcb7d
                stepCounter: 67549678-cd35-4ad8-8f92-50af3c66539f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1dff88de-f4a8-4567-8bc5-7233d14cdd77
          stepCounter: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: HOSPITAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a24c4c3-12e4-49bc-8113-386f42608c15
                stepCounter: 67549678-cd35-4ad8-8f92-50af3c66539f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 200644a4-155f-4483-bc1c-c6a5d31a2194
          stepCounter: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LOCATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 31cf32ab-fcd4-4278-b5c8-2fc731597c95
                stepCounter: 8ac69b4c-4a2a-4f8a-b9de-04aa425a1af3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7556818-12c7-4704-b0d0-216ce4b98ca0
          stepCounter: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SERVICE_POINT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 960b4f1a-1ea5-4c78-a3cd-68599cf9a0b0
                stepCounter: 67549678-cd35-4ad8-8f92-50af3c66539f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d89ee81-0968-4cfe-82a4-641859ee3dc8
          stepCounter: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FACILITYCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07c598fd-7c33-4851-9ad9-63e0aed333a1
                stepCounter: 67549678-cd35-4ad8-8f92-50af3c66539f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3391b80d-b0f0-465e-ab79-85d9375c191a
          stepCounter: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CLINIC_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4d83743-b616-4b7d-b0fa-b69abb4f5aaa
                stepCounter: 8ac69b4c-4a2a-4f8a-b9de-04aa425a1af3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a46665e1-8e3a-413a-9ebd-cbdf8d473d22
          stepCounter: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ARRIVEDDTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4cdb3826-6e51-4f89-a76b-a6fab9d05705
                stepCounter: 8ac69b4c-4a2a-4f8a-b9de-04aa425a1af3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4f67ec7-1719-49c0-8a1c-dee6d82aa6fe
          stepCounter: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: TRIAGECATEGORY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 475c9774-fcac-4186-9b27-070c41c0f21c
                stepCounter: 8ac69b4c-4a2a-4f8a-b9de-04aa425a1af3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05d965f6-2ab7-4033-b288-e168225d96e8
          stepCounter: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
        config: {}
        dataType: VARCHAR(512)
        defaultValue: ""
        description: ""
        name: PRESENTINGCOMPLAINT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 54589344-7802-4c05-982d-f5ba8225c213
                stepCounter: 8ac69b4c-4a2a-4f8a-b9de-04aa425a1af3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb1804f9-1678-4884-a3f0-ca07489eaeb3
          stepCounter: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: BEDREQUESTSTATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb992478-c01b-4118-b0cc-9780d6ff49fc
                stepCounter: 8ac69b4c-4a2a-4f8a-b9de-04aa425a1af3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2222c380-35c4-427e-9252-52a5078e071d
          stepCounter: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CURRENTSTATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3084cff0-2b04-4274-b2f1-169921dbb203
                stepCounter: 8ac69b4c-4a2a-4f8a-b9de-04aa425a1af3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 773a529f-b195-40a8-b325-3fbe54d81201
          stepCounter: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ASSIGNEDNURSEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c14fc320-5033-4650-ad79-e6d81d8b5fce
                stepCounter: 8ac69b4c-4a2a-4f8a-b9de-04aa425a1af3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04382950-45ae-460b-82ba-f55c582800e0
          stepCounter: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NURSESEENBYDTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dfdba31a-317b-48dd-9e67-7a81e9a1e123
                stepCounter: 8ac69b4c-4a2a-4f8a-b9de-04aa425a1af3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 975d03d3-880b-4663-b7f6-860e74ec2917
          stepCounter: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ASSIGNEDDOCTORID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4d6cc9f8-caa0-4d07-9f8d-c07e4efed295
                stepCounter: 8ac69b4c-4a2a-4f8a-b9de-04aa425a1af3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 37b950ea-693a-4690-a223-ef0fa53cb325
          stepCounter: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: treatmentprotocolid
        name: TREATMENTPROTOCOLID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c2cfb543-fcf1-4ec5-a9ff-a3c52305f327
                stepCounter: 8ac69b4c-4a2a-4f8a-b9de-04aa425a1af3
            transform: IFNULL(s_ed_WB_CacheHistory.treatmentprotocolid,l_WB_Cache.treatmentprotocolid)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb7d0e6e-0962-4dab-b0db-3a4ee834acfc
          stepCounter: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SEENBYDOCTORID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe8e90df-03e6-4b5a-800f-6c1c6510db08
                stepCounter: 67549678-cd35-4ad8-8f92-50af3c66539f
            transform: |-
              CASE WHEN IFNULL(ds_WB_CacheAudit.seenbydoctorid,'') = ''      THEN ds_WB_CacheAudit.userid
                          WHEN ds_WB_CacheAudit.performedaction = 'Doctor handover' THEN ds_WB_CacheAudit.userid
                          ELSE ds_WB_CacheAudit.seenbydoctorid
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a226987-00c7-4b59-b679-c14d213ff76f
          stepCounter: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DOCTORSEENBYDTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 44a2dda5-5fd7-4c20-95e5-06efdafcccca
                stepCounter: 8ac69b4c-4a2a-4f8a-b9de-04aa425a1af3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b60d71e8-a689-4175-80e9-e884b351118d
          stepCounter: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SEENBYDOCTORSURNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5990f700-bbe7-4205-a587-eb52694bdf54
                stepCounter: 67549678-cd35-4ad8-8f92-50af3c66539f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 754986cd-cf3d-4cdd-8dd7-98f701212633
          stepCounter: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SEENBYDOCTORFIRSTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d839ff14-9fcc-42f8-b80c-5a9edb26cc1b
                stepCounter: 67549678-cd35-4ad8-8f92-50af3c66539f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5cc20845-6e26-44e1-b80d-e4322a32d44a
          stepCounter: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: CONSULTANT_HEALTHCARE_PROFESSIONAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3502c9b5-6bf7-4b8a-84f6-88d48b6dbe09
                stepCounter: 67549678-cd35-4ad8-8f92-50af3c66539f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 968f5013-1954-4151-91e3-00b73ecd11f7
          stepCounter: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ASSIGNEDCONSULTANTSURNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 97060a62-bd52-4b2d-bf90-39bb2b6734f9
                stepCounter: 67549678-cd35-4ad8-8f92-50af3c66539f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eeb7d42a-60ee-4381-9550-f5fdba5469e8
          stepCounter: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: ASSIGNEDCONSULTANTFIRSTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 37356d18-85d0-486c-8de2-0848319b89fb
                stepCounter: 67549678-cd35-4ad8-8f92-50af3c66539f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0775030c-66e4-46e0-8e47-d8e12e5a8aa1
          stepCounter: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: DISCHARGETYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 98b98fbf-0481-4358-8800-f2450e38550f
                stepCounter: 8ac69b4c-4a2a-4f8a-b9de-04aa425a1af3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06ab433b-f466-488b-8601-a23d9e32eb3f
          stepCounter: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DISCHARGECLINICIANID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 30b89e8b-0e5f-4da2-8152-61f802702702
                stepCounter: 8ac69b4c-4a2a-4f8a-b9de-04aa425a1af3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e4c4c6c-8e67-43a4-b168-ea33fac2e4fe
          stepCounter: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DISCHARGECLINICIANTYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47e14f36-15d0-481f-89f8-42886f566def
                stepCounter: 8ac69b4c-4a2a-4f8a-b9de-04aa425a1af3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 85e6e9dc-8eda-4a66-a8da-6f3d5ac06643
          stepCounter: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MEDICALDISCHARGEDTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8805a344-c100-45fc-aa53-275f872e28a0
                stepCounter: 8ac69b4c-4a2a-4f8a-b9de-04aa425a1af3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ffe7ed15-39eb-4c84-96d7-0a78e2f9f117
          stepCounter: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SITEDEPARTEDDTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78a59f09-c555-4d56-95e7-b41a29544e73
                stepCounter: 8ac69b4c-4a2a-4f8a-b9de-04aa425a1af3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5db63b27-0047-4f84-ab95-cfd28556158b
          stepCounter: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PERFORMEDACTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3fdd97b3-1e59-4de3-880a-291aaa93c7ee
                stepCounter: 67549678-cd35-4ad8-8f92-50af3c66539f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b316fda-dbf3-450d-81d9-883cd7cbfdbb
          stepCounter: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ACTIONDTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d086a2f-bbcc-4797-8abb-eb05cdaf63e5
                stepCounter: 67549678-cd35-4ad8-8f92-50af3c66539f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f81d4e1-79c0-475d-b27f-b4ccb2ad4c62
          stepCounter: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: TRANSACTIONDTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22cd2323-69d2-4423-a82f-1f89e773489f
                stepCounter: 67549678-cd35-4ad8-8f92-50af3c66539f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6114d9d9-3635-48ca-b23d-049c54627d92
          stepCounter: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Dummy col so that s_ed_centric_encounter is shown as a referenced table
        name: DUMMY_COL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45f5c592-96f8-434b-a684-12a91d6dbd41
          stepCounter: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: extra col so that incremental use column, value = 1
        name: TABLE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '1'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7c7c2cc-e521-4824-abaa-775407e9026a
          stepCounter: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
        config: {}
        dataType: INT
        defaultValue: ""
        description: 'partion by cachenumber '
        name: RN
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ROW_NUMBER() OVER (PARTITION BY ds_WB_CacheAudit.id ORDER BY ds_WB_CacheAudit.id)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06b7cc16-be9e-4ba6-852c-469bec3d702c
          stepCounter: ecd421ba-1aa9-4cae-aee2-d51f8560d78b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_WB_CACHEAUDIT
        join:
          joinCondition: |-
            FROM ds_WB_CacheAudit
              JOIN s_centric_encounter_changes
                ON ds_WB_CacheAudit.encounternumber = s_centric_encounter_changes.encounter --LEFT OUTER JOIN   -- (SELECT * FROM ds_WB_CacheHistory WHERE encounternumber+CONVERT(varchar,transactiondttm) IN   --   (SELECT MAX(encounternumber+CONVERT(varchar,transactiondttm))   --    FROM ds_WB_CacheHistory where encounternumber is not null GROUP BY encounternumber)) ds_WB_CacheHistory    --ON ds_WB_CacheAudit.encounternumber = ds_WB_CacheHistory.encounternumber  LEFT OUTER JOIN s_ed_WB_CacheHistory    ON ds_WB_CacheAudit.encounternumber = s_ed_WB_CacheHistory.encounternumber    LEFT OUTER JOIN l_WB_Cache   ON ds_WB_CacheAudit.encounternumber = l_WB_Cache.encounternumber     LEFT OUTER JOIN (SELECT DISTINCT Encounter FROM ds_centric_Patient_Clinician)ds_centric_Patient_Clinician    ON ds_WB_CacheAudit.encounternumber = ds_centric_Patient_Clinician.encounter    WHERE performedAction IN   ('Nurse Seen By','Doctor Seen By','Remove Nurse Seen By And Treatment Protocol','RemoveSeenBy',    'Assign Treatment Protocol','Doctor Handover','Remove Nurse Seen By','Remove Treatment Protocol','Remove Doctor Seen By')    AND ds_centric_Patient_Clinician.encounter IS NULL -- Replaces ds_centric_Patient_Clinician check below  --AND ds_WB_CacheAudit.EncounterNumber NOT IN (SELECT DISTINCT Encounter FROM ds_centric_Patient_Clinician)
        name: S_ED_SEEN_BY_05_WB
        noLinkRefs: []
  name: S_ED_SEEN_BY_05_WB
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
