fileVersion: 1
id: d488382b-c794-4ecb-ae7f-98ff8a2ec59f
name: STAGE_LO_SAP_70A
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78ad9850-7606-4935-ba99-5d6681212eb0
          stepCounter: d488382b-c794-4ecb-ae7f-98ff8a2ec59f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEDGER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7fdf67a-e425-404d-9cf4-849164dc0b16
                stepCounter: fed629e0-7830-4277-b323-42025afcec75
            transform: TARGET.DIM_LEDGER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7db52879-2f6c-45bc-a3e2-2c90fbc2e338
          stepCounter: d488382b-c794-4ecb-ae7f-98ff8a2ec59f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACTVY_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e51bb39-6eb7-4505-aff3-d4ae01d83936
                stepCounter: fed629e0-7830-4277-b323-42025afcec75
            transform: TARGET.DIM_ACTVY_PER_DATE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b8d2c15-9220-4eef-a792-d63b12b80582
          stepCounter: d488382b-c794-4ecb-ae7f-98ff8a2ec59f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACCT_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0663322a-3952-4256-b1ca-13d853412805
                stepCounter: eefa6fde-3665-412e-bba8-d4a58bcbbf39
            transform: TARGET.DIM_ACCT_PER_DATE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 809f79b8-7c15-4250-9dc3-86859387b90b
          stepCounter: d488382b-c794-4ecb-ae7f-98ff8a2ec59f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_COST_CENTER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bccf843f-90b8-4941-a0e2-c82ac22a38b5
                stepCounter: fed629e0-7830-4277-b323-42025afcec75
            transform: TARGET.DIM_COST_CENTER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cca9b21d-2811-41bc-8b52-c4cbd8b14dd0
          stepCounter: d488382b-c794-4ecb-ae7f-98ff8a2ec59f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf1822f6-c47a-44cb-a647-7d9c774cfd3b
          stepCounter: d488382b-c794-4ecb-ae7f-98ff8a2ec59f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_DEST_ORGANIZATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bfdfa86e-2948-4f93-a5c4-99a12faa4f31
                stepCounter: fed629e0-7830-4277-b323-42025afcec75
            transform: TARGET.DIM_DEST_ORGANIZATION_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02c76f7b-4401-40ed-9442-5363253e661c
          stepCounter: d488382b-c794-4ecb-ae7f-98ff8a2ec59f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GL_ACCOUNT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4ac62e1-ecac-4500-8058-abfa446e8ea2
          stepCounter: d488382b-c794-4ecb-ae7f-98ff8a2ec59f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1dd22b3f-54f5-4cec-bfc1-7fce5dcc0e57
                stepCounter: fed629e0-7830-4277-b323-42025afcec75
            transform: TARGET.DIM_GROSS_NET_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 059b47cf-1639-42f4-8164-0cd151865e30
          stepCounter: d488382b-c794-4ecb-ae7f-98ff8a2ec59f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_HIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03094dcc-28c0-4fee-b106-8de0eba3539c
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d9610b7-1506-4a16-9fb3-6475cbc4aec7
          stepCounter: d488382b-c794-4ecb-ae7f-98ff8a2ec59f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_VERSION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf563602-b233-42a1-ad75-0e69290bf32a
                stepCounter: fed629e0-7830-4277-b323-42025afcec75
            transform: TARGET.DIM_LEASE_OPS_VERSION_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ad80352-8800-4328-8396-ede108ada340
          stepCounter: d488382b-c794-4ecb-ae7f-98ff8a2ec59f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LINE_ITEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98a84f62-d72f-4b22-883f-3fc8c657c38b
          stepCounter: d488382b-c794-4ecb-ae7f-98ff8a2ec59f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_VOUCHER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 84bf1636-2018-4a3d-8bdf-44e568782eec
          stepCounter: d488382b-c794-4ecb-ae7f-98ff8a2ec59f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50267b6d-9a83-4a91-98e9-903f43381497
          stepCounter: d488382b-c794-4ecb-ae7f-98ff8a2ec59f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_INVOICE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42059aaa-3f33-4dd8-9a1f-f4b689200144
          stepCounter: d488382b-c794-4ecb-ae7f-98ff8a2ec59f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_PRODUCT_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d471eb8a-3d90-4a50-ac17-4d146a9b6a49
          stepCounter: d488382b-c794-4ecb-ae7f-98ff8a2ec59f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3f84c21-4ee9-4cae-88e0-9ce9656d3204
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd5734aa-8fd9-4442-ba9e-75bc17d034fe
          stepCounter: d488382b-c794-4ecb-ae7f-98ff8a2ec59f
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa825158-7815-437a-acd9-f6796a4b20a7
                stepCounter: fed629e0-7830-4277-b323-42025afcec75
            transform: SUM(OP_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f327d68-a01a-40c2-8ede-73bf3928f6ba
          stepCounter: d488382b-c794-4ecb-ae7f-98ff8a2ec59f
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94bbb329-7bc7-4f76-9546-f4f5b7b51dd7
                stepCounter: fed629e0-7830-4277-b323-42025afcec75
            transform: SUM(CAD_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66d281bf-bb23-4cf5-850e-7979be8acfa0
          stepCounter: d488382b-c794-4ecb-ae7f-98ff8a2ec59f
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: 'Gross Line Item Net Op Amount '
        name: NET_OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a661b107-bb93-452f-bbe6-52167e57a652
                stepCounter: fed629e0-7830-4277-b323-42025afcec75
            transform: SUM(NET_OP_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e05e11a-858d-423c-9d0f-160b4d48ee95
          stepCounter: d488382b-c794-4ecb-ae7f-98ff8a2ec59f
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: LI_VOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc2d13d0-d706-4c30-97c7-821dd8adb7d0
                stepCounter: fed629e0-7830-4277-b323-42025afcec75
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c348005e-c17f-4a81-95ab-cdde27cd0fc6
          stepCounter: d488382b-c794-4ecb-ae7f-98ff8a2ec59f
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in cubic meters (m3)
        name: LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1472f2b2-0579-40c4-b385-4e842d0a93ea
                stepCounter: fed629e0-7830-4277-b323-42025afcec75
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 296f34ea-4b9f-4506-9f0e-a880d641e63f
          stepCounter: d488382b-c794-4ecb-ae7f-98ff8a2ec59f
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in imperial measurement
        name: LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c140ce0-9c6d-4c3f-8611-c2997ba1f537
                stepCounter: fed629e0-7830-4277-b323-42025afcec75
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2588a678-caf0-4b0b-ad79-5506ac77fa02
          stepCounter: d488382b-c794-4ecb-ae7f-98ff8a2ec59f
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in BOE (Barrel of Oil Equivalent)
        name: LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c437cc62-ef79-4bfe-8b87-0e8a0eceaa0d
                stepCounter: fed629e0-7830-4277-b323-42025afcec75
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: add283cb-1182-4bf9-a0b0-68ab1268d054
          stepCounter: d488382b-c794-4ecb-ae7f-98ff8a2ec59f
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in normalized cubic meters (nm3)
        name: LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a680f9ea-5ff3-4184-a78f-50a50b48fa26
                stepCounter: fed629e0-7830-4277-b323-42025afcec75
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f8cf347-e57f-4964-b00e-b5b6ab1a1417
          stepCounter: d488382b-c794-4ecb-ae7f-98ff8a2ec59f
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: ""
        name: EXCHANGE_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 01bee524-a84c-4c10-acf5-da5e445ad93a
                stepCounter: fed629e0-7830-4277-b323-42025afcec75
            transform: TARGET.EXCHANGE_RATE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab596756-ec84-49e4-ae40-0a7df776863c
          stepCounter: d488382b-c794-4ecb-ae7f-98ff8a2ec59f
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f03bd78f-a926-4152-bf51-fe5309c0d417
                stepCounter: fed629e0-7830-4277-b323-42025afcec75
            transform: TARGET.OP_CURR_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f45ed45e-75a2-4ebf-8d60-778564e4ec94
          stepCounter: d488382b-c794-4ecb-ae7f-98ff8a2ec59f
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Indicates amounts are gross or net.
        name: GROSS_OR_NET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e03c2a5b-09f8-44dd-bd96-2dc5e568554c
                stepCounter: fed629e0-7830-4277-b323-42025afcec75
            transform: TARGET.GROSS_OR_NET_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ecdf3e8b-e212-4113-b622-12a45a34763d
          stepCounter: d488382b-c794-4ecb-ae7f-98ff8a2ec59f
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: LINE_NO_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4607c855-a49d-4eb4-bbf8-11be2b047885
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd7f028e-337f-4df7-b367-2ed0c11adb3d
          stepCounter: d488382b-c794-4ecb-ae7f-98ff8a2ec59f
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: OP_NONOP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c65368c9-1778-4e84-884b-0514e08d7c3e
                stepCounter: fed629e0-7830-4277-b323-42025afcec75
            transform: TARGET.OP_NONOP
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c75b3ff-70f8-4adb-a309-f890a4e4ba84
          stepCounter: d488382b-c794-4ecb-ae7f-98ff8a2ec59f
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PROD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_LO_SAP_60A: fed629e0-7830-4277-b323-42025afcec75
          STAGE_LO_SAP_65A: eefa6fde-3665-412e-bba8-d4a58bcbbf39
          DIM_LO_SAP_LEASE_OPS_HIER: e0b535c4-f94e-4ac1-b685-dfdff6293176
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_60A
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_65A
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_HIER
        join:
          joinCondition: |-
            FROM (
                    SELECT STAGE_LO_SAP_60A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_60A') }} STAGE_LO_SAP_60A
                 UNION ALL SELECT STAGE_LO_SAP_65A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_65A') }} STAGE_LO_SAP_65A
                   ) TARGET
             CROSS JOIN (
                    SELECT DIM_LEASE_OPS_HIER_KEY,
                           LINE_NO,
                           LINE_NO_GROUP
                      FROM {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_HIER') }}
                     WHERE DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO = '70A'
                   ) DIM_LO_SAP_LEASE_OPS_HIER
             GROUP BY TARGET.DIM_LEDGER_KEY,
                      TARGET.DIM_ACTVY_PER_DATE_KEY,
                      TARGET.DIM_ACCT_PER_DATE_KEY,
                      TARGET.DIM_COST_CENTER_KEY,
                      TARGET.DIM_DEST_ORGANIZATION_KEY,
                      TARGET.DIM_GROSS_NET_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.DIM_LEASE_OPS_HIER_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO_GROUP,
                      TARGET.DIM_LEASE_OPS_VERSION_KEY,
                      TARGET.EXCHANGE_RATE,
                      TARGET.OP_CURR_CODE,
                      TARGET.GROSS_OR_NET_CODE,
                      TARGET.OP_NONOP
        name: STAGE_LO_SAP_70A
        noLinkRefs: []
  name: STAGE_LO_SAP_70A
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
