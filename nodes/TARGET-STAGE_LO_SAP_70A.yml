fileVersion: 1
id: 9e8bbd5c-94f8-43c6-a168-348f3df517bd
name: STAGE_LO_SAP_70A
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8af0832c-ee1c-4f9d-8d92-304267eb1b2b
          stepCounter: 9e8bbd5c-94f8-43c6-a168-348f3df517bd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEDGER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4258ad0f-2363-4c4d-94e5-abdae9e60a2d
                stepCounter: bae625da-e586-450a-9593-857b575ce3c6
            transform: TARGET.DIM_LEDGER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e182abed-b6e2-41b8-8cee-fd0f6c1d06ea
          stepCounter: 9e8bbd5c-94f8-43c6-a168-348f3df517bd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACTVY_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d75401ad-8b4a-4a0e-9bc7-f7f7576c153e
                stepCounter: bae625da-e586-450a-9593-857b575ce3c6
            transform: TARGET.DIM_ACTVY_PER_DATE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3c0b815-a583-47e8-b3be-6185d6b8cdb9
          stepCounter: 9e8bbd5c-94f8-43c6-a168-348f3df517bd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACCT_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 814bcc1a-40d1-4113-86ac-bb6da4b92a5e
                stepCounter: 4fe24b35-de82-4407-bc45-6149c107644c
            transform: TARGET.DIM_ACCT_PER_DATE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5e4c209-4d9c-425b-84e3-6516734003ac
          stepCounter: 9e8bbd5c-94f8-43c6-a168-348f3df517bd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_COST_CENTER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8fc80944-9594-4a74-8eb8-2ce9244b859b
                stepCounter: bae625da-e586-450a-9593-857b575ce3c6
            transform: TARGET.DIM_COST_CENTER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92a6c603-7f1b-427b-adbb-b83358c8b1fd
          stepCounter: 9e8bbd5c-94f8-43c6-a168-348f3df517bd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cde33269-b545-44e2-aa71-a64b624b19bd
          stepCounter: 9e8bbd5c-94f8-43c6-a168-348f3df517bd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_DEST_ORGANIZATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e04e7fc-8678-4022-8e54-9f2e0197436b
                stepCounter: bae625da-e586-450a-9593-857b575ce3c6
            transform: TARGET.DIM_DEST_ORGANIZATION_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5ce73af-6822-4044-ae3d-9a496731e504
          stepCounter: 9e8bbd5c-94f8-43c6-a168-348f3df517bd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GL_ACCOUNT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42735b15-86d7-472d-8c35-9f614548faec
          stepCounter: 9e8bbd5c-94f8-43c6-a168-348f3df517bd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2adc0bb0-5ed3-40c0-afc7-06bb95c58855
                stepCounter: bae625da-e586-450a-9593-857b575ce3c6
            transform: TARGET.DIM_GROSS_NET_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e60d768-9341-4d35-b0e6-50a5a187a60c
          stepCounter: 9e8bbd5c-94f8-43c6-a168-348f3df517bd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_HIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21fac97a-151e-4cc2-8783-56a1148d309b
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91a5b83d-5bad-4ab5-b212-4e64ea01c588
          stepCounter: 9e8bbd5c-94f8-43c6-a168-348f3df517bd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_VERSION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2bddd159-7f21-4142-89f7-4c9b6324eec4
                stepCounter: bae625da-e586-450a-9593-857b575ce3c6
            transform: TARGET.DIM_LEASE_OPS_VERSION_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70c58c09-fb33-4c16-bfdc-d5b29ddb2072
          stepCounter: 9e8bbd5c-94f8-43c6-a168-348f3df517bd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LINE_ITEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d258fc7-a81e-4ef2-8081-421bb576d382
          stepCounter: 9e8bbd5c-94f8-43c6-a168-348f3df517bd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_VOUCHER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc858182-6153-4421-b3f2-819a06869a51
          stepCounter: 9e8bbd5c-94f8-43c6-a168-348f3df517bd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bba03893-e5d3-48a7-9d3c-08132b035e42
          stepCounter: 9e8bbd5c-94f8-43c6-a168-348f3df517bd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_INVOICE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 76e46d12-f09a-46bc-a453-ebf0254c833a
          stepCounter: 9e8bbd5c-94f8-43c6-a168-348f3df517bd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_PRODUCT_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 009c810a-09bd-4d3b-a12a-880f874c75d2
          stepCounter: 9e8bbd5c-94f8-43c6-a168-348f3df517bd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1a83d4b-9af5-4a64-b5b2-f6f811cf7698
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7545bdcf-1cde-48d4-bead-07b8eed525b4
          stepCounter: 9e8bbd5c-94f8-43c6-a168-348f3df517bd
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e21b461c-25c5-42fb-9a59-d83f7d6397b2
                stepCounter: bae625da-e586-450a-9593-857b575ce3c6
            transform: SUM(OP_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 93bd8016-474a-4e40-82cd-9402807a1c2c
          stepCounter: 9e8bbd5c-94f8-43c6-a168-348f3df517bd
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3d655231-74f4-4e05-bd22-040a41315d2a
                stepCounter: bae625da-e586-450a-9593-857b575ce3c6
            transform: SUM(CAD_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 720b297f-410c-4e7a-9c6c-edc3e4d1800f
          stepCounter: 9e8bbd5c-94f8-43c6-a168-348f3df517bd
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: 'Gross Line Item Net Op Amount '
        name: NET_OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0214ccbe-96fd-416f-9f1b-3f5d55864e62
                stepCounter: bae625da-e586-450a-9593-857b575ce3c6
            transform: SUM(NET_OP_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b25b91bd-6114-4cfa-b278-54826b808084
          stepCounter: 9e8bbd5c-94f8-43c6-a168-348f3df517bd
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: LI_VOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bd59464f-d779-4288-9992-60508a491452
                stepCounter: bae625da-e586-450a-9593-857b575ce3c6
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3937ebfb-21ea-43ea-87d1-0319af2c84f1
          stepCounter: 9e8bbd5c-94f8-43c6-a168-348f3df517bd
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in cubic meters (m3)
        name: LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 412726ed-f0ba-457b-93cb-cbb0bf95b868
                stepCounter: bae625da-e586-450a-9593-857b575ce3c6
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7db5200-e77e-4875-9f51-6a9820312178
          stepCounter: 9e8bbd5c-94f8-43c6-a168-348f3df517bd
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in imperial measurement
        name: LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f04af16c-5d04-4006-ac00-9c2482b67480
                stepCounter: bae625da-e586-450a-9593-857b575ce3c6
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c42a386-36e9-4bac-9390-3043b84d0c01
          stepCounter: 9e8bbd5c-94f8-43c6-a168-348f3df517bd
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in BOE (Barrel of Oil Equivalent)
        name: LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d00b820c-3100-4d37-924b-141240f1418e
                stepCounter: bae625da-e586-450a-9593-857b575ce3c6
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4af6fbed-2d44-49c2-8e6a-1af78b2fb700
          stepCounter: 9e8bbd5c-94f8-43c6-a168-348f3df517bd
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in normalized cubic meters (nm3)
        name: LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ad973a36-3c01-4c66-aea8-d22d336680a9
                stepCounter: bae625da-e586-450a-9593-857b575ce3c6
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7edfed1-41c5-455a-9f40-2aef4dd3484b
          stepCounter: 9e8bbd5c-94f8-43c6-a168-348f3df517bd
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: ""
        name: EXCHANGE_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 575333aa-b1d5-4b16-889e-ccf8420c7008
                stepCounter: bae625da-e586-450a-9593-857b575ce3c6
            transform: TARGET.EXCHANGE_RATE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a329e72-d89c-4473-ac78-477a225f06ef
          stepCounter: 9e8bbd5c-94f8-43c6-a168-348f3df517bd
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ebf58c79-c9a7-444f-aadf-8879f8f00f6b
                stepCounter: bae625da-e586-450a-9593-857b575ce3c6
            transform: TARGET.OP_CURR_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e72d443a-bbf3-4cdd-a0b7-94ed9e9cb08f
          stepCounter: 9e8bbd5c-94f8-43c6-a168-348f3df517bd
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Indicates amounts are gross or net.
        name: GROSS_OR_NET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b348d818-a55d-4fa5-868e-87e3e72534ed
                stepCounter: bae625da-e586-450a-9593-857b575ce3c6
            transform: TARGET.GROSS_OR_NET_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e036469e-fa11-4f0c-8507-46c67375914b
          stepCounter: 9e8bbd5c-94f8-43c6-a168-348f3df517bd
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: LINE_NO_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4460264-eeac-48f7-bae2-1748cdbcf9cb
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd827035-49c2-4549-9753-83eb388981d5
          stepCounter: 9e8bbd5c-94f8-43c6-a168-348f3df517bd
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: OP_NONOP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 62ae0ea4-a4e2-41c6-bb9a-21eacade4937
                stepCounter: bae625da-e586-450a-9593-857b575ce3c6
            transform: TARGET.OP_NONOP
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d79f5f3-b75b-4c6d-88b9-6673f296ecd4
          stepCounter: 9e8bbd5c-94f8-43c6-a168-348f3df517bd
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PROD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_LO_SAP_60A: bae625da-e586-450a-9593-857b575ce3c6
          STAGE_LO_SAP_65A: 4fe24b35-de82-4407-bc45-6149c107644c
          DIM_LO_SAP_LEASE_OPS_HIER: 82938641-7c51-4aff-ad3a-c7a56af30c01
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_60A
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_65A
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_HIER
        join:
          joinCondition: |-
            FROM (
                    SELECT STAGE_LO_SAP_60A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_60A') }} STAGE_LO_SAP_60A
                 UNION ALL SELECT STAGE_LO_SAP_65A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_65A') }} STAGE_LO_SAP_65A
                   ) TARGET
             CROSS JOIN (
                    SELECT DIM_LEASE_OPS_HIER_KEY,
                           LINE_NO,
                           LINE_NO_GROUP
                      FROM {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_HIER') }}
                     WHERE DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO = '70A'
                   ) DIM_LO_SAP_LEASE_OPS_HIER
             GROUP BY TARGET.DIM_LEDGER_KEY,
                      TARGET.DIM_ACTVY_PER_DATE_KEY,
                      TARGET.DIM_ACCT_PER_DATE_KEY,
                      TARGET.DIM_COST_CENTER_KEY,
                      TARGET.DIM_DEST_ORGANIZATION_KEY,
                      TARGET.DIM_GROSS_NET_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.DIM_LEASE_OPS_HIER_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO_GROUP,
                      TARGET.DIM_LEASE_OPS_VERSION_KEY,
                      TARGET.EXCHANGE_RATE,
                      TARGET.OP_CURR_CODE,
                      TARGET.GROSS_OR_NET_CODE,
                      TARGET.OP_NONOP
        name: STAGE_LO_SAP_70A
        noLinkRefs: []
  name: STAGE_LO_SAP_70A
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
