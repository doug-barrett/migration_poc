fileVersion: 1
id: b4718bcf-bd6d-494e-99e1-028b86461941
name: S_HWARE_BABY_BIRTH_SUMMARY_20
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb96d30f-2629-47c9-903f-461637f0d503
          stepCounter: b4718bcf-bd6d-494e-99e1-028b86461941
        config: {}
        dataType: NVARCHAR(12)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 63756623-7653-4460-b030-27eb29ef345c
                stepCounter: 7f43e1fe-5cb9-4edb-802c-7d797066b8f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1aa23dc6-1c2d-4717-a674-71e53fffd364
          stepCounter: b4718bcf-bd6d-494e-99e1-028b86461941
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: GESTATION
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 15dd176c-319c-452f-a171-0856fd8e711a
                stepCounter: 7f43e1fe-5cb9-4edb-802c-7d797066b8f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d0884ad2-77cf-4546-9c46-442fc99ab9f1
          stepCounter: b4718bcf-bd6d-494e-99e1-028b86461941
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: BABY_LAST_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4ba7d11-65b4-4d82-8249-156856b4b1f6
                stepCounter: 7f43e1fe-5cb9-4edb-802c-7d797066b8f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 148bdb64-fb1e-4397-acfc-97ddec81402d
          stepCounter: b4718bcf-bd6d-494e-99e1-028b86461941
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: BABY_GIVEN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f561c84-eb3b-42e3-8301-5884dc313a3d
                stepCounter: 7f43e1fe-5cb9-4edb-802c-7d797066b8f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eaf08e84-954a-4149-b6f1-84760db1caea
          stepCounter: b4718bcf-bd6d-494e-99e1-028b86461941
        config: {}
        dataType: NVARCHAR(12)
        defaultValue: ""
        description: ""
        name: MOTHER_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d1f3319-07dc-493d-ae74-75b4db81dc94
                stepCounter: 7f43e1fe-5cb9-4edb-802c-7d797066b8f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bc377620-4995-470e-a904-47036f32a60a
          stepCounter: b4718bcf-bd6d-494e-99e1-028b86461941
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: BABY_SID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2a6dc234-eaf3-4e80-bbce-292cf5751722
                stepCounter: 7f43e1fe-5cb9-4edb-802c-7d797066b8f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 12458a45-ad26-4763-b201-ece890154338
          stepCounter: b4718bcf-bd6d-494e-99e1-028b86461941
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: MOTHER_SID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9f84d2e5-4219-44fc-b311-7ce895da177d
                stepCounter: 7f43e1fe-5cb9-4edb-802c-7d797066b8f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6b546da-39ea-4a7c-ae2b-19b80e28c603
          stepCounter: b4718bcf-bd6d-494e-99e1-028b86461941
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: BIRTH_WEIGHT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d306733-b27f-4f39-85dc-ac0fcb96219a
                stepCounter: 7f43e1fe-5cb9-4edb-802c-7d797066b8f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b36627c-c1f4-46de-a484-f1d2497f8bf1
          stepCounter: b4718bcf-bd6d-494e-99e1-028b86461941
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DELIVERY_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 69410645-de04-4c62-a0c6-ac3b6f9a3fc2
                stepCounter: 7f43e1fe-5cb9-4edb-802c-7d797066b8f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21956bb8-6b20-4779-a1ce-652576b5a585
          stepCounter: b4718bcf-bd6d-494e-99e1-028b86461941
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ESTIMATED_DELIVERY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3173f360-cad0-46f8-90b3-329b3e153a21
                stepCounter: 7f43e1fe-5cb9-4edb-802c-7d797066b8f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed2fe4f7-92b0-4283-adb2-8d3bc3f6daca
          stepCounter: b4718bcf-bd6d-494e-99e1-028b86461941
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: inaptient admission relating to the birth event
        name: IP_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d543039b-e67f-4d0d-b335-616be1dff363
                stepCounter: 7f43e1fe-5cb9-4edb-802c-7d797066b8f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8cb9aa1b-9d79-4fa1-b922-0db15d36a186
          stepCounter: b4718bcf-bd6d-494e-99e1-028b86461941
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_hware_baby_birth_summary_20.baby_nhi=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9962a01b-5f3d-4c1a-b371-997edef38d0f
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 35b96807-2f29-4160-8765-d1183594ae9a
          stepCounter: b4718bcf-bd6d-494e-99e1-028b86461941
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_hware_baby_birth_summary_20.mother_nhi=dim_mother_as_patient.mother_patient_NHI
        name: DIM_MOTHER_AS_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1bbdfd97-1730-4e9f-bc1f-f73f2187cd6c
                stepCounter: 024a2928-ecd7-4540-96bf-7778d450f618
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40fc709b-87ef-42ac-9efd-ec591830692e
          stepCounter: b4718bcf-bd6d-494e-99e1-028b86461941
        config: {}
        dataType: INT
        defaultValue: ""
        description: Generated artificial key
        name: DIM_DELIVERY_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 86b36f73-01cc-45e3-814f-7b1bd027f7d0
                stepCounter: 14c3a5da-40bc-4e67-8bfc-9815e9d8746f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 158c91cc-2c0e-4114-bbc3-6358c52beeea
          stepCounter: b4718bcf-bd6d-494e-99e1-028b86461941
        config: {}
        dataType: INT
        defaultValue: ""
        description: Generated artificial key
        name: DIM_ESTIMATED_DELIVERY_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9b839f3d-b1e4-4bba-94de-afdb3a716525
                stepCounter: 6f9e01bd-ddf1-4c04-9c07-85dc338c3fcf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88a1ba56-3228-49e6-bdd9-d93d9e612804
          stepCounter: b4718bcf-bd6d-494e-99e1-028b86461941
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_HWARE_BABY_BIRTH_SUMMARY_10: 7f43e1fe-5cb9-4edb-802c-7d797066b8f1
          DIM_PATIENT: d52dd438-7899-4242-9e38-539d2a1447df
          DIM_DELIVERY_DATE: 14c3a5da-40bc-4e67-8bfc-9815e9d8746f
          DIM_ESTIMATED_DELIVERY_DATE: 6f9e01bd-ddf1-4c04-9c07-85dc338c3fcf
          DIM_MOTHER_AS_PATIENT: 024a2928-ecd7-4540-96bf-7778d450f618
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_HWARE_BABY_BIRTH_SUMMARY_10
          - locationName: TGT
            nodeName: DIM_PATIENT
          - locationName: TGT
            nodeName: DIM_DELIVERY_DATE
          - locationName: TGT
            nodeName: DIM_ESTIMATED_DELIVERY_DATE
          - locationName: TGT
            nodeName: DIM_MOTHER_AS_PATIENT
        join:
          joinCondition: |-
            FROM {{ ref('TGT','S_HWARE_BABY_BIRTH_SUMMARY_10') }} s_hware_baby_birth_summary_10
              JOIN {{ ref('TGT','DIM_PATIENT') }}
                ON dim_patient.patient_NHI = baby_NHI
               AND dim_patient.NHI_sequence = 1
              JOIN {{ ref('TGT','DIM_DELIVERY_DATE') }} dim_delivery_date
                ON cast(s_hware_baby_birth_summary_10.Delivery_time AS date) = dim_delivery_date.calendar_date
              JOIN {{ ref('TGT','DIM_ESTIMATED_DELIVERY_DATE') }} dim_estimated_delivery_date
                ON cast(s_hware_baby_birth_summary_10.EDD_best_s88 AS date) = dim_estimated_delivery_date.calendar_date
              JOIN {{ ref('TGT','DIM_MOTHER_AS_PATIENT') }}
                ON dim_mother_as_patient.mother_patient_NHI = mother_NHI
        name: S_HWARE_BABY_BIRTH_SUMMARY_20
        noLinkRefs: []
  name: S_HWARE_BABY_BIRTH_SUMMARY_20
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
