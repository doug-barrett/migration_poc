fileVersion: 1
id: 8a70a301-b624-4238-b4a6-54643361e58c
name: STAGE_FIN_SAP_COST_CENTER
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef6d3e61-b416-4e03-b22f-4c4ce1029e09
          stepCounter: 8a70a301-b624-4238-b4a6-54643361e58c
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: be491f70-5b6f-4d69-a7ee-1b5962bd80d5
                stepCounter: aa27980f-cc7c-4789-a145-f840ecccef05
            transform: NULLIF(TRIM(LTRIM(ODS_SAP_CSKS.KOSTL,'0'),' '),'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2a3a856-ce32-4915-93fa-402bdcaffbbe
          stepCounter: 8a70a301-b624-4238-b4a6-54643361e58c
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: CC_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7fa21ccf-3c3e-4443-96a9-2fd31626dd24
                stepCounter: 42fb1903-01e2-4ed6-b472-c551a2d86b97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a0ab2b2f-6b80-4721-b770-86d52a948300
          stepCounter: 8a70a301-b624-4238-b4a6-54643361e58c
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: CC_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0782866c-2611-42c5-98cd-c81bd359fcbc
                stepCounter: aa27980f-cc7c-4789-a145-f840ecccef05
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a82087fa-6be8-4706-8499-5359f493724b
          stepCounter: 8a70a301-b624-4238-b4a6-54643361e58c
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 974e23ad-c9e2-46aa-ac8e-72eb6b1eee91
                stepCounter: be971e1b-b3ad-4385-94de-3bffe76b59fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8694f465-ff4d-4dcf-9259-5a2e1df0f2b6
          stepCounter: 8a70a301-b624-4238-b4a6-54643361e58c
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: OWNERSHIP_ORG_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 142c0ca3-8dc5-4d93-aa31-febcca9614a4
                stepCounter: aa27980f-cc7c-4789-a145-f840ecccef05
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 881cba27-0212-4dd5-9e15-0d0a476e5156
          stepCounter: 8a70a301-b624-4238-b4a6-54643361e58c
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: OWNERSHIP_ORGANIZATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e063e94c-f948-49aa-854c-1e1627c372f1
                stepCounter: 2c701d0c-4f6b-4d48-bf42-61b56bce4087
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0b2b6de-0783-4bc6-b776-e2379fc41664
          stepCounter: 8a70a301-b624-4238-b4a6-54643361e58c
        config: {}
        dataType: VARCHAR(200)
        defaultValue: ""
        description: UWI of the Cost Centre
        name: UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 752b3948-1409-4ef2-a7a8-9561a0d7f57e
                stepCounter: aa27980f-cc7c-4789-a145-f840ecccef05
            transform: TRANSLATE(ODS_SAP_CSKS.ZZCCUWI,'/-','')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6cc7918c-4fd4-4023-bb16-2a8420b88f73
          stepCounter: 8a70a301-b624-4238-b4a6-54643361e58c
        config: {}
        dataType: VARCHAR(200)
        defaultValue: ""
        description: Formatted UWI of the Cost Centre
        name: FORMATTED_UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 752b3948-1409-4ef2-a7a8-9561a0d7f57e
                stepCounter: aa27980f-cc7c-4789-a145-f840ecccef05
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31b9376a-e1fb-4ccc-bb6d-197074549ea7
          stepCounter: 8a70a301-b624-4238-b4a6-54643361e58c
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: OPERATOR_CLIENT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db54abfa-446a-431d-88c7-d26d96e13092
                stepCounter: aa27980f-cc7c-4789-a145-f840ecccef05
            transform: LTRIM(ODS_SAP_CSKS.ZZOPERATOR,'0')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b2eee6df-4c4f-46b4-b4ed-1b238d7c6809
          stepCounter: 8a70a301-b624-4238-b4a6-54643361e58c
        config: {}
        dataType: VARCHAR(300)
        defaultValue: ""
        description: ""
        name: OPERATOR_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fbee6458-5945-40da-a5e5-5c8df92ab487
                stepCounter: c4c2ed94-cb6d-4c6e-9420-764d6413a012
            transform: ODS_SAP_BUT000_OP.NAME_ORG1
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9bd411f9-23be-48ae-af23-3d9c24113e66
          stepCounter: 8a70a301-b624-4238-b4a6-54643361e58c
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: CONTRACT_OPERATOR_CLIENT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76df7c7c-b4ce-4b4f-b99b-6866d5e69e6f
                stepCounter: aa27980f-cc7c-4789-a145-f840ecccef05
            transform: LTRIM(ODS_SAP_CSKS.ZZCONTRACT_OPERATOR,'0')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ae34972-f585-46c6-ba3d-d4ccb5ea0fd3
          stepCounter: 8a70a301-b624-4238-b4a6-54643361e58c
        config: {}
        dataType: VARCHAR(300)
        defaultValue: ""
        description: ""
        name: CONTRACT_OPERATOR_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fbee6458-5945-40da-a5e5-5c8df92ab487
                stepCounter: c4c2ed94-cb6d-4c6e-9420-764d6413a012
            transform: ODS_SAP_BUT000_CO.NAME_ORG1
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0a4ce39-25c0-4fc2-885e-3353dcdc1b27
          stepCounter: 8a70a301-b624-4238-b4a6-54643361e58c
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: TERM_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c0a06ec9-23b5-4a09-abfa-160226554a18
                stepCounter: aa27980f-cc7c-4789-a145-f840ecccef05
            transform: DECODE(NULLIF(ODS_SAP_CSKS.BKZKP,''),NULL,NULL,DATEADD('DAY', -1, DATE_TRUNC('DAY', CURRENT_TIMESTAMP)))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14d6a12e-f067-483f-a28e-116fc0157427
          stepCounter: 8a70a301-b624-4238-b4a6-54643361e58c
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: LOCKED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52ac2ffd-ee8b-4ae4-bb37-8962ad8b3c32
                stepCounter: aa27980f-cc7c-4789-a145-f840ecccef05
            transform: NULLIF(ODS_SAP_CSKS.BKZKP,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14a56207-b340-4a34-b36e-10e6958b5995
          stepCounter: 8a70a301-b624-4238-b4a6-54643361e58c
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: ""
        name: COST_CENTER_PROVINCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9eea6433-c118-416d-b117-b46c7ae72911
                stepCounter: aa27980f-cc7c-4789-a145-f840ecccef05
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 44ff267d-04fd-4917-bc2a-0174ec2d3ad0
          stepCounter: 8a70a301-b624-4238-b4a6-54643361e58c
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: ""
        name: COST_CENTER_COUNTRY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 86b0704c-de1f-4b84-a9c7-eb037887da58
                stepCounter: aa27980f-cc7c-4789-a145-f840ecccef05
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f1a9b0dc-f143-4c8c-89d5-45d88d8fed01
          stepCounter: 8a70a301-b624-4238-b4a6-54643361e58c
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: COST_CENTER_COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 515acc9d-8d84-44f5-8cc9-b8c51245ec5e
                stepCounter: b251a047-8d77-44ee-8632-1c3e4432df4b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70a4770f-ef1f-4fa9-977b-442b66bb21d9
          stepCounter: 8a70a301-b624-4238-b4a6-54643361e58c
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: IS_JIB
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cda16739-a827-4003-906b-9885da1850f9
          stepCounter: 8a70a301-b624-4238-b4a6-54643361e58c
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: ALLOW_OTHER_ORGS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9f89c27-6ae3-48da-8f22-a2ef6f3abde3
          stepCounter: 8a70a301-b624-4238-b4a6-54643361e58c
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: OVERHEAD_METHOD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a386b98-6d3b-4ab9-a383-ce4a75a875b3
                stepCounter: aa27980f-cc7c-4789-a145-f840ecccef05
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0de80887-8786-45e9-b38b-f6e835e31b3c
          stepCounter: 8a70a301-b624-4238-b4a6-54643361e58c
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: RUN
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 56ae1955-c217-4add-9a89-ceabca95638a
          stepCounter: 8a70a301-b624-4238-b4a6-54643361e58c
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: ACQUISITION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5da98d62-2103-4dc6-b6a6-ad3d0fe6ebd1
                stepCounter: aa27980f-cc7c-4789-a145-f840ecccef05
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d788d264-8939-41aa-89b5-fc1ac0a35eb2
          stepCounter: 8a70a301-b624-4238-b4a6-54643361e58c
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: GCA_FCC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b8ec9807-cc78-486b-a23b-c5807aaf8a34
                stepCounter: aa27980f-cc7c-4789-a145-f840ecccef05
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32980392-52da-44af-9f10-644f263cca18
          stepCounter: 8a70a301-b624-4238-b4a6-54643361e58c
        config: {}
        dataType: DATE
        defaultValue: ""
        description: Date when the cost center was created
        name: CC_CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0d345412-9358-4818-b8dd-9a2eaf83cf39
                stepCounter: aa27980f-cc7c-4789-a145-f840ecccef05
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3511d6e0-47ed-4fdd-857b-07b1475b308c
          stepCounter: 8a70a301-b624-4238-b4a6-54643361e58c
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CBM_FORMATION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7a02eec-62f3-4923-aa07-218f4db5e984
          stepCounter: 8a70a301-b624-4238-b4a6-54643361e58c
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: UNIT_CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 43c77b98-5b48-42e2-8f57-89ef9e799c7d
          stepCounter: 8a70a301-b624-4238-b4a6-54643361e58c
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: OP_NONOP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 12f31cab-d8bc-44f8-97ac-5a92ea906ff7
                stepCounter: aa27980f-cc7c-4789-a145-f840ecccef05
            transform: DECODE(ODS_SAP_CSKS.ZZNONOP_FLAG,'X','NONOP','OP')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: deb9f528-4623-4bdd-9a56-dc3d2daa0819
          stepCounter: 8a70a301-b624-4238-b4a6-54643361e58c
        config: {}
        dataType: NUMBER(14,11)
        defaultValue: ""
        description: The Land Percent.
        name: WORKING_INTEREST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 04ce7999-6672-43f8-b580-54a96ef7c01c
                stepCounter: fbcd2f99-7f66-42c6-83ab-89807dbf03aa
            transform: NVL(JV.VERM_SHARE,100)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 489b6d8f-cbea-4ce7-bae9-9d74bdd988f5
          stepCounter: 8a70a301-b624-4238-b4a6-54643361e58c
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: PERSON_RESPONSIBLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c3317d5b-2e21-47f9-96b1-0c9a9115caae
                stepCounter: aa27980f-cc7c-4789-a145-f840ecccef05
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb062f13-729a-4e6e-b781-65db19c43400
          stepCounter: 8a70a301-b624-4238-b4a6-54643361e58c
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: FUNCTIONAL_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9ffce451-e676-4bac-8b51-033436e1e7fe
                stepCounter: aa27980f-cc7c-4789-a145-f840ecccef05
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed67a7d2-154a-4399-9c18-378516b56caf
          stepCounter: 8a70a301-b624-4238-b4a6-54643361e58c
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: FUNCTIONAL_AREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b04d2b4d-12c4-487d-9c2f-e05dd85350f9
                stepCounter: 43c13db8-7f40-4ec6-b4cb-fb85c4f1f157
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef5b2331-48e2-4c1b-afb0-dcb68877619b
          stepCounter: 8a70a301-b624-4238-b4a6-54643361e58c
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: JOINT_VENTURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc9ffbd2-b836-421f-8890-a69cb7c5cbdb
                stepCounter: aa27980f-cc7c-4789-a145-f840ecccef05
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0627a71-b895-47ae-b4f6-4488d3c6bb37
          stepCounter: 8a70a301-b624-4238-b4a6-54643361e58c
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: RECOVERY_INDICATOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef69b1da-637c-4add-8995-6b47987a7017
                stepCounter: aa27980f-cc7c-4789-a145-f840ecccef05
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47fb3aba-429c-4729-b6fc-4acec1fbf87c
          stepCounter: 8a70a301-b624-4238-b4a6-54643361e58c
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: EQUITY_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc4dbe80-dd23-4faa-876b-0590ff10d739
                stepCounter: aa27980f-cc7c-4789-a145-f840ecccef05
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c771c35-ce18-4917-95f3-c504afa4f386
          stepCounter: 8a70a301-b624-4238-b4a6-54643361e58c
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: NULL or Cost Center Number for relating historic data
        name: CC_NUM_HISTORIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91694ea4-9df9-4eea-93b8-6213f08bd3f2
                stepCounter: 37a3c5f9-bde6-4048-9551-3702914c4bce
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ODS_SAP_CSKS: aa27980f-cc7c-4789-a145-f840ecccef05
          ODS_SAP_CSKT: 42fb1903-01e2-4ed6-b472-c551a2d86b97
          ODS_SAP_BUT000: c4c2ed94-cb6d-4c6e-9420-764d6413a012
          ODS_SAP_T005T: b251a047-8d77-44ee-8632-1c3e4432df4b
          ODS_SAP_T001: 2c701d0c-4f6b-4d48-bf42-61b56bce4087
          ODS_SAP_T8JV: 91438067-79bd-4d7c-a9ae-e7792219ed8a
          ODS_SAP_T8JG: 62715bd6-4801-4ca0-8cf2-b5e1bca57922
          ODS_SAP_T8J9A: fbcd2f99-7f66-42c6-83ab-89807dbf03aa
          ODS_SAP_TKT05: be971e1b-b3ad-4385-94de-3bffe76b59fd
          ODS_SAP_TFKBT: 43c13db8-7f40-4ec6-b4cb-fb85c4f1f157
          LOAD_VET_FIN_SAP_CC_ATTR: 37a3c5f9-bde6-4048-9551-3702914c4bce
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: ODS_SAP_CSKS
          - locationName: TARGET
            nodeName: ODS_SAP_CSKT
          - locationName: TARGET
            nodeName: ODS_SAP_BUT000
          - locationName: TARGET
            nodeName: ODS_SAP_T005T
          - locationName: TARGET
            nodeName: ODS_SAP_T001
          - locationName: TARGET
            nodeName: ODS_SAP_T8JV
          - locationName: TARGET
            nodeName: ODS_SAP_T8JG
          - locationName: TARGET
            nodeName: ODS_SAP_T8J9A
          - locationName: TARGET
            nodeName: ODS_SAP_TKT05
          - locationName: TARGET
            nodeName: ODS_SAP_TFKBT
          - locationName: TARGET
            nodeName: LOAD_VET_FIN_SAP_CC_ATTR
        join:
          joinCondition: |-
            FROM (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_CSKS') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) ODS_SAP_CSKS
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_CSKT') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                       AND SPRAS = 'E'
                   ) ODS_SAP_CSKT
                ON ODS_SAP_CSKS.KOSTL = ODS_SAP_CSKT.KOSTL
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_BUT000') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) ODS_SAP_BUT000_CO
                ON ODS_SAP_CSKS.ZZCONTRACT_OPERATOR = ODS_SAP_BUT000_CO.PARTNER
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_T005T') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                       AND SPRAS = 'E'
                   ) ODS_SAP_T005T
                ON ODS_SAP_CSKS.LAND1 = ODS_SAP_T005T.LAND1
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_T001') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) ODS_SAP_T001
                ON ODS_SAP_CSKS.BUKRS = ODS_SAP_T001.BUKRS
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_BUT000') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) ODS_SAP_BUT000_OP
                ON ODS_SAP_CSKS.ZZOPERATOR = ODS_SAP_BUT000_OP.PARTNER
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_T8JV') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) ODS_SAP_T8JV
                ON ODS_SAP_CSKS.VNAME = ODS_SAP_T8JV.VNAME
               AND ODS_SAP_CSKS.BUKRS = ODS_SAP_T8JV.BUKRS
              LEFT JOIN (
                    SELECT ODS_SAP_T8JG.BUKRS,
                           ODS_SAP_T8JG.VNAME,
                           ODS_SAP_T8JG.ETYPE,
                           (ODS_SAP_T8J9A.OPSHARE + ODS_SAP_T8J9A.NOPSHARE) VERM_SHARE
                      FROM (
                            SELECT *,
                                   MAX({{ parameters.SAP_INVERTED_DATE_SUBTRACTOR }}-TO_NUMBER(ODS_SAP_T8JG.FDATE)) OVER (PARTITION BY BUKRS, VNAME, ETYPE) AS MAX_FDATE
                              FROM {{ ref('TARGET','ODS_SAP_T8JG') }}
                             WHERE EGROUPACT = 'X'
                               AND DSS_CURRENT_FLAG = 'Y'
                               AND DSS_DELETE_FLAG != 'Y'
                           ) ODS_SAP_T8JG,
                           (
                            SELECT *
                              FROM {{ ref('TARGET','ODS_SAP_T8J9A') }}
                             WHERE DSS_CURRENT_FLAG = 'Y'
                               AND DSS_DELETE_FLAG != 'Y'
                           ) ODS_SAP_T8J9A
                     WHERE ({{ parameters.SAP_INVERTED_DATE_SUBTRACTOR }}-TO_NUMBER(ODS_SAP_T8JG.FDATE)) = ODS_SAP_T8JG.MAX_FDATE
                       AND ODS_SAP_T8J9A.BUKRS = ODS_SAP_T8JG.BUKRS
                       AND ODS_SAP_T8J9A.JOA = ODS_SAP_T8JG.VNAME
                       AND ODS_SAP_T8J9A.EGRUP = ODS_SAP_T8JG.EGRUP
                   ) JV
                ON ODS_SAP_CSKS.BUKRS = JV.BUKRS
               AND ODS_SAP_CSKS.VNAME = JV.VNAME
               AND ODS_SAP_CSKS.ETYPE = JV.ETYPE
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_TKT05') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                       AND SPRAS = 'E'
                   ) ODS_SAP_TKT05
                ON ODS_SAP_CSKS.KOSAR = ODS_SAP_TKT05.KOSAR
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_TFKBT') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                       AND SPRAS = 'E'
                   ) ODS_SAP_TFKBT
                ON ODS_SAP_CSKS.FUNC_AREA = ODS_SAP_TFKBT.FKBER
              LEFT JOIN {{ ref('TARGET','LOAD_VET_FIN_SAP_CC_ATTR') }} LOAD_VET_FIN_SAP_CC_ATTR
                ON LTRIM(ODS_SAP_CSKS.KOSTL,'0') = LOAD_VET_FIN_SAP_CC_ATTR.CC_NUM
        name: STAGE_FIN_SAP_COST_CENTER
        noLinkRefs: []
  name: STAGE_FIN_SAP_COST_CENTER
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
