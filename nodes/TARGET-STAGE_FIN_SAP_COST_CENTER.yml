fileVersion: 1
id: 6c3ac3f8-7073-49b0-98a8-ddc75f7492b9
name: STAGE_FIN_SAP_COST_CENTER
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c84ef37a-d069-4a14-9f0c-622ccdf7add5
          stepCounter: 6c3ac3f8-7073-49b0-98a8-ddc75f7492b9
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b28fee6-b107-44b4-9115-38fcb7ca6e44
                stepCounter: 9b3a977a-eef0-47b3-a40e-a27ab9656405
            transform: NULLIF(TRIM(LTRIM(ODS_SAP_CSKS.KOSTL,'0'),' '),'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: abb91aed-2bc5-4797-b16b-7497f6aace66
          stepCounter: 6c3ac3f8-7073-49b0-98a8-ddc75f7492b9
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: CC_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c30bb64-2aca-48c3-ae82-3cf1cd928dab
                stepCounter: 5269b0f1-3982-431e-a886-768117055ef1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: becc7971-814f-49e5-a1fe-0e2d0ce8831e
          stepCounter: 6c3ac3f8-7073-49b0-98a8-ddc75f7492b9
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: CC_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b5b2e00-7bbb-4a73-98b3-7ecbb4e7ede9
                stepCounter: 9b3a977a-eef0-47b3-a40e-a27ab9656405
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0886276-7abd-438e-a25d-e626b2f9b250
          stepCounter: 6c3ac3f8-7073-49b0-98a8-ddc75f7492b9
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ed3b1f9-dbe1-438c-8281-7861830a3faa
                stepCounter: 0914b845-eeee-463c-8f5a-3e07608073b1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4bf0908b-869b-4299-91dd-1500fee92f19
          stepCounter: 6c3ac3f8-7073-49b0-98a8-ddc75f7492b9
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: OWNERSHIP_ORG_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc35c3a2-90d4-4dd8-acf8-a4b5ef2bd1c4
                stepCounter: 9b3a977a-eef0-47b3-a40e-a27ab9656405
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7b0f3d6-353b-4d68-a07b-f1b7ba4d0305
          stepCounter: 6c3ac3f8-7073-49b0-98a8-ddc75f7492b9
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: OWNERSHIP_ORGANIZATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c88df64-0b02-454e-98bb-f429ee21f644
                stepCounter: 380b20ff-1088-454d-94c3-b7fc7688cca8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f0ddb83-39b7-467c-8836-9f4b12241593
          stepCounter: 6c3ac3f8-7073-49b0-98a8-ddc75f7492b9
        config: {}
        dataType: VARCHAR(200)
        defaultValue: ""
        description: UWI of the Cost Centre
        name: UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8aad2501-0a25-4bac-ada0-d41c92f6acb9
                stepCounter: 9b3a977a-eef0-47b3-a40e-a27ab9656405
            transform: TRANSLATE(ODS_SAP_CSKS.ZZCCUWI,'/-','')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dd264b7b-5386-49d8-ad2c-8993e7945bb9
          stepCounter: 6c3ac3f8-7073-49b0-98a8-ddc75f7492b9
        config: {}
        dataType: VARCHAR(200)
        defaultValue: ""
        description: Formatted UWI of the Cost Centre
        name: FORMATTED_UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8aad2501-0a25-4bac-ada0-d41c92f6acb9
                stepCounter: 9b3a977a-eef0-47b3-a40e-a27ab9656405
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94ed1962-d8d1-4f2c-a57f-442da57003d5
          stepCounter: 6c3ac3f8-7073-49b0-98a8-ddc75f7492b9
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: OPERATOR_CLIENT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 88196ab9-54d9-4bdd-bccf-6ddeceac8d8a
                stepCounter: 9b3a977a-eef0-47b3-a40e-a27ab9656405
            transform: LTRIM(ODS_SAP_CSKS.ZZOPERATOR,'0')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 965953a6-b947-4397-a81b-66f0661d9cd5
          stepCounter: 6c3ac3f8-7073-49b0-98a8-ddc75f7492b9
        config: {}
        dataType: VARCHAR(300)
        defaultValue: ""
        description: ""
        name: OPERATOR_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d02822b-d167-4639-a445-8014036b469d
                stepCounter: 62fe7825-68d9-41db-9e29-9c780aedaf9a
            transform: ODS_SAP_BUT000_OP.NAME_ORG1
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6464675-417d-4c6f-aa64-a03f0d1fe201
          stepCounter: 6c3ac3f8-7073-49b0-98a8-ddc75f7492b9
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: CONTRACT_OPERATOR_CLIENT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fac312b6-cd70-4ea1-b8ae-3c5d4a0de6ff
                stepCounter: 9b3a977a-eef0-47b3-a40e-a27ab9656405
            transform: LTRIM(ODS_SAP_CSKS.ZZCONTRACT_OPERATOR,'0')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8e802ab-422e-4ab2-86cd-db53fe1ea86a
          stepCounter: 6c3ac3f8-7073-49b0-98a8-ddc75f7492b9
        config: {}
        dataType: VARCHAR(300)
        defaultValue: ""
        description: ""
        name: CONTRACT_OPERATOR_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d02822b-d167-4639-a445-8014036b469d
                stepCounter: 62fe7825-68d9-41db-9e29-9c780aedaf9a
            transform: ODS_SAP_BUT000_CO.NAME_ORG1
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7390eff-2b5e-47e9-84b3-4ca1bc3121ac
          stepCounter: 6c3ac3f8-7073-49b0-98a8-ddc75f7492b9
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: TERM_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2cae54c6-a31b-48bb-b3ad-cacd984fa259
                stepCounter: 9b3a977a-eef0-47b3-a40e-a27ab9656405
            transform: DECODE(NULLIF(ODS_SAP_CSKS.BKZKP,''),NULL,NULL,DATEADD('DAY', -1, DATE_TRUNC('DAY', CURRENT_TIMESTAMP)))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 90b348e6-e3c1-4a02-b0d3-ab3400770c45
          stepCounter: 6c3ac3f8-7073-49b0-98a8-ddc75f7492b9
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: LOCKED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f754029a-5220-4ff0-9721-1216aaca1a8c
                stepCounter: 9b3a977a-eef0-47b3-a40e-a27ab9656405
            transform: NULLIF(ODS_SAP_CSKS.BKZKP,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f9d7788-efca-4a58-8af9-1cbec1187000
          stepCounter: 6c3ac3f8-7073-49b0-98a8-ddc75f7492b9
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: ""
        name: COST_CENTER_PROVINCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 30f00162-de8c-45de-b796-a829b05de033
                stepCounter: 9b3a977a-eef0-47b3-a40e-a27ab9656405
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ebf3a3ae-f171-4c30-ac80-a43467d7c468
          stepCounter: 6c3ac3f8-7073-49b0-98a8-ddc75f7492b9
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: ""
        name: COST_CENTER_COUNTRY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 73d3820d-dc99-4ff9-80fe-65c104580164
                stepCounter: 9b3a977a-eef0-47b3-a40e-a27ab9656405
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c5908f1-f3c3-43e5-a0aa-642a3123d5a2
          stepCounter: 6c3ac3f8-7073-49b0-98a8-ddc75f7492b9
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: COST_CENTER_COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5b060c8e-6e9d-49ff-a720-9dae7248a6d2
                stepCounter: a33fc14a-3560-4ef2-ae35-d48eac2526aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f89697c4-cbc4-4a3a-b384-50932a7bc605
          stepCounter: 6c3ac3f8-7073-49b0-98a8-ddc75f7492b9
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: IS_JIB
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e5eb987-5aec-438c-9a2d-cebf5e21ebc8
          stepCounter: 6c3ac3f8-7073-49b0-98a8-ddc75f7492b9
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: ALLOW_OTHER_ORGS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97e2d9be-e1e5-4394-bde1-b0dedc5d93f9
          stepCounter: 6c3ac3f8-7073-49b0-98a8-ddc75f7492b9
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: OVERHEAD_METHOD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 70205bb7-606e-4f9a-907d-54343b7ed3b3
                stepCounter: 9b3a977a-eef0-47b3-a40e-a27ab9656405
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7276c0b1-aeed-419b-b95e-fff3a6adef06
          stepCounter: 6c3ac3f8-7073-49b0-98a8-ddc75f7492b9
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: RUN
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34d075e5-4c53-4893-94c5-783de52fbeb8
          stepCounter: 6c3ac3f8-7073-49b0-98a8-ddc75f7492b9
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: ACQUISITION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3f6d7a23-213b-4faa-af4e-bc49bd09b8a2
                stepCounter: 9b3a977a-eef0-47b3-a40e-a27ab9656405
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32348ff7-0959-4816-844b-5444c3342b43
          stepCounter: 6c3ac3f8-7073-49b0-98a8-ddc75f7492b9
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: GCA_FCC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 075f4bbb-a1fd-46b4-82bd-98fa3f3d3d20
                stepCounter: 9b3a977a-eef0-47b3-a40e-a27ab9656405
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 68de5ab0-b3ee-423b-86b5-c913b4b7c8d2
          stepCounter: 6c3ac3f8-7073-49b0-98a8-ddc75f7492b9
        config: {}
        dataType: DATE
        defaultValue: ""
        description: Date when the cost center was created
        name: CC_CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ad3faa08-4eb7-4b09-bf8a-0ccb1da2f41d
                stepCounter: 9b3a977a-eef0-47b3-a40e-a27ab9656405
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 76f5dae6-e7ca-4c81-81c8-71ca6b9837b1
          stepCounter: 6c3ac3f8-7073-49b0-98a8-ddc75f7492b9
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CBM_FORMATION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bdb13269-2fbc-4ff0-b4ce-6226143a43e9
          stepCounter: 6c3ac3f8-7073-49b0-98a8-ddc75f7492b9
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: UNIT_CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e34cc494-e7f1-4161-95ae-142f867159b9
          stepCounter: 6c3ac3f8-7073-49b0-98a8-ddc75f7492b9
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: OP_NONOP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2ab53b9-b354-4b5b-bfee-b86970c68876
                stepCounter: 9b3a977a-eef0-47b3-a40e-a27ab9656405
            transform: DECODE(ODS_SAP_CSKS.ZZNONOP_FLAG,'X','NONOP','OP')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9a4731e-1e8a-499b-8aba-2f65d0d5d2ae
          stepCounter: 6c3ac3f8-7073-49b0-98a8-ddc75f7492b9
        config: {}
        dataType: NUMBER(14,11)
        defaultValue: ""
        description: The Land Percent.
        name: WORKING_INTEREST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 622de643-93f5-4800-bd44-8d58a70da738
                stepCounter: d1b90642-490c-4c62-b284-0dce260a90f8
            transform: NVL(JV.VERM_SHARE,100)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a948ea50-199f-4727-a427-8be6c8909994
          stepCounter: 6c3ac3f8-7073-49b0-98a8-ddc75f7492b9
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: PERSON_RESPONSIBLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 57b8a8b0-8678-4eab-9d8d-344fb38c9f35
                stepCounter: 9b3a977a-eef0-47b3-a40e-a27ab9656405
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8d78ef2-4b79-4514-b245-36b55bd16e42
          stepCounter: 6c3ac3f8-7073-49b0-98a8-ddc75f7492b9
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: FUNCTIONAL_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 85c08796-52d2-417c-b319-f8f31abb7929
                stepCounter: 9b3a977a-eef0-47b3-a40e-a27ab9656405
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0758928b-fe45-4dbc-8ed3-d4b28199b9c0
          stepCounter: 6c3ac3f8-7073-49b0-98a8-ddc75f7492b9
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: FUNCTIONAL_AREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f862aee-a2e0-462c-be94-281d06d5a42e
                stepCounter: deacf6ea-f8a6-4783-88a5-38cfcabbf1d3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5b650bb-b0d9-4634-b96a-0efebd137fbf
          stepCounter: 6c3ac3f8-7073-49b0-98a8-ddc75f7492b9
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: JOINT_VENTURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0a012e68-0e31-4a64-be78-3debb1a0728a
                stepCounter: 9b3a977a-eef0-47b3-a40e-a27ab9656405
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9a5eb49-6068-4605-a32d-87ac2aa1dbf6
          stepCounter: 6c3ac3f8-7073-49b0-98a8-ddc75f7492b9
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: RECOVERY_INDICATOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d0461e95-38ea-4ea0-9dcb-7de16c11c713
                stepCounter: 9b3a977a-eef0-47b3-a40e-a27ab9656405
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b2a5fcd-e79d-4ea4-aaad-bce896c496c9
          stepCounter: 6c3ac3f8-7073-49b0-98a8-ddc75f7492b9
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: EQUITY_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d6c4521b-ccbe-46da-8713-c67a9ef895c4
                stepCounter: 9b3a977a-eef0-47b3-a40e-a27ab9656405
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: efe6b764-11b8-4708-9760-8edded5cc2e8
          stepCounter: 6c3ac3f8-7073-49b0-98a8-ddc75f7492b9
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: NULL or Cost Center Number for relating historic data
        name: CC_NUM_HISTORIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ba567206-4f5a-4446-ae59-e3bde0dc5002
                stepCounter: 9cf36381-fa09-44aa-95fd-2dcc8c5e29e7
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ODS_SAP_CSKS: 9b3a977a-eef0-47b3-a40e-a27ab9656405
          ODS_SAP_CSKT: 5269b0f1-3982-431e-a886-768117055ef1
          ODS_SAP_BUT000: 62fe7825-68d9-41db-9e29-9c780aedaf9a
          ODS_SAP_T005T: a33fc14a-3560-4ef2-ae35-d48eac2526aa
          ODS_SAP_T001: 380b20ff-1088-454d-94c3-b7fc7688cca8
          ODS_SAP_T8JV: b0bb6f77-3850-4a93-b9e5-722e6e82eda6
          ODS_SAP_T8JG: 56ecb7ef-46f9-419d-817d-300802c06611
          ODS_SAP_T8J9A: d1b90642-490c-4c62-b284-0dce260a90f8
          ODS_SAP_TKT05: 0914b845-eeee-463c-8f5a-3e07608073b1
          ODS_SAP_TFKBT: deacf6ea-f8a6-4783-88a5-38cfcabbf1d3
          LOAD_VET_FIN_SAP_CC_ATTR: 9cf36381-fa09-44aa-95fd-2dcc8c5e29e7
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: ODS_SAP_CSKS
          - locationName: TARGET
            nodeName: ODS_SAP_CSKT
          - locationName: TARGET
            nodeName: ODS_SAP_BUT000
          - locationName: TARGET
            nodeName: ODS_SAP_T005T
          - locationName: TARGET
            nodeName: ODS_SAP_T001
          - locationName: TARGET
            nodeName: ODS_SAP_T8JV
          - locationName: TARGET
            nodeName: ODS_SAP_T8JG
          - locationName: TARGET
            nodeName: ODS_SAP_T8J9A
          - locationName: TARGET
            nodeName: ODS_SAP_TKT05
          - locationName: TARGET
            nodeName: ODS_SAP_TFKBT
          - locationName: TARGET
            nodeName: LOAD_VET_FIN_SAP_CC_ATTR
        join:
          joinCondition: |-
            FROM (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_CSKS') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) ODS_SAP_CSKS
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_CSKT') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                       AND SPRAS = 'E'
                   ) ODS_SAP_CSKT
                ON ODS_SAP_CSKS.KOSTL = ODS_SAP_CSKT.KOSTL
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_BUT000') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) ODS_SAP_BUT000_CO
                ON ODS_SAP_CSKS.ZZCONTRACT_OPERATOR = ODS_SAP_BUT000_CO.PARTNER
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_T005T') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                       AND SPRAS = 'E'
                   ) ODS_SAP_T005T
                ON ODS_SAP_CSKS.LAND1 = ODS_SAP_T005T.LAND1
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_T001') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) ODS_SAP_T001
                ON ODS_SAP_CSKS.BUKRS = ODS_SAP_T001.BUKRS
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_BUT000') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) ODS_SAP_BUT000_OP
                ON ODS_SAP_CSKS.ZZOPERATOR = ODS_SAP_BUT000_OP.PARTNER
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_T8JV') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) ODS_SAP_T8JV
                ON ODS_SAP_CSKS.VNAME = ODS_SAP_T8JV.VNAME
               AND ODS_SAP_CSKS.BUKRS = ODS_SAP_T8JV.BUKRS
              LEFT JOIN (
                    SELECT ODS_SAP_T8JG.BUKRS,
                           ODS_SAP_T8JG.VNAME,
                           ODS_SAP_T8JG.ETYPE,
                           (ODS_SAP_T8J9A.OPSHARE + ODS_SAP_T8J9A.NOPSHARE) VERM_SHARE
                      FROM (
                            SELECT *,
                                   MAX({{ parameters.SAP_INVERTED_DATE_SUBTRACTOR }}-TO_NUMBER(ODS_SAP_T8JG.FDATE)) OVER (PARTITION BY BUKRS, VNAME, ETYPE) AS MAX_FDATE
                              FROM {{ ref('TARGET','ODS_SAP_T8JG') }}
                             WHERE EGROUPACT = 'X'
                               AND DSS_CURRENT_FLAG = 'Y'
                               AND DSS_DELETE_FLAG != 'Y'
                           ) ODS_SAP_T8JG,
                           (
                            SELECT *
                              FROM {{ ref('TARGET','ODS_SAP_T8J9A') }}
                             WHERE DSS_CURRENT_FLAG = 'Y'
                               AND DSS_DELETE_FLAG != 'Y'
                           ) ODS_SAP_T8J9A
                     WHERE ({{ parameters.SAP_INVERTED_DATE_SUBTRACTOR }}-TO_NUMBER(ODS_SAP_T8JG.FDATE)) = ODS_SAP_T8JG.MAX_FDATE
                       AND ODS_SAP_T8J9A.BUKRS = ODS_SAP_T8JG.BUKRS
                       AND ODS_SAP_T8J9A.JOA = ODS_SAP_T8JG.VNAME
                       AND ODS_SAP_T8J9A.EGRUP = ODS_SAP_T8JG.EGRUP
                   ) JV
                ON ODS_SAP_CSKS.BUKRS = JV.BUKRS
               AND ODS_SAP_CSKS.VNAME = JV.VNAME
               AND ODS_SAP_CSKS.ETYPE = JV.ETYPE
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_TKT05') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                       AND SPRAS = 'E'
                   ) ODS_SAP_TKT05
                ON ODS_SAP_CSKS.KOSAR = ODS_SAP_TKT05.KOSAR
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_TFKBT') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                       AND SPRAS = 'E'
                   ) ODS_SAP_TFKBT
                ON ODS_SAP_CSKS.FUNC_AREA = ODS_SAP_TFKBT.FKBER
              LEFT JOIN {{ ref('TARGET','LOAD_VET_FIN_SAP_CC_ATTR') }} LOAD_VET_FIN_SAP_CC_ATTR
                ON LTRIM(ODS_SAP_CSKS.KOSTL,'0') = LOAD_VET_FIN_SAP_CC_ATTR.CC_NUM
        name: STAGE_FIN_SAP_COST_CENTER
        noLinkRefs: []
  name: STAGE_FIN_SAP_COST_CENTER
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
