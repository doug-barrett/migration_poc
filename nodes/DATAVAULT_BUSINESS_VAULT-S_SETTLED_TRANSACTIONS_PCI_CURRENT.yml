fileVersion: 1
id: 6439c096-d790-4f4d-908d-18496280a4f9
name: S_SETTLED_TRANSACTIONS_PCI_CURRENT
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DATAVAULT_BUSINESS_VAULT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c40f128-640d-4266-9138-433284b11bbd
          stepCounter: 6439c096-d790-4f4d-908d-18496280a4f9
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: ""
        name: HK_H_SETTLED_TRANSACTIONS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f13f13a-986c-41d2-9395-aa07ee07f3ad
                stepCounter: 54062b20-c5ab-455c-bc24-aa2727eb8a30
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad3cae0d-e636-4b33-b80a-0e4c6108d0ac
          stepCounter: 6439c096-d790-4f4d-908d-18496280a4f9
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: RECID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2aecd312-429a-40c6-8e43-3057121fcab6
                stepCounter: 54062b20-c5ab-455c-bc24-aa2727eb8a30
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b3445a90-6f62-446b-bb11-c5da05354962
          stepCounter: 6439c096-d790-4f4d-908d-18496280a4f9
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: Identifies the Merchant who initially received the transaction.
        isBusinessKey: true
        name: TRANSACTION_MERCHANT_INTERNAL_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 206c5054-5acd-42bf-a30e-134d11d05fb5
                stepCounter: 54062b20-c5ab-455c-bc24-aa2727eb8a30
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b2bdd8d-5a63-47db-b6f8-027f038a62d0
          stepCounter: 6439c096-d790-4f4d-908d-18496280a4f9
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: A description of the card identification (PAN Number) on which the transaction was made.
        name: CARD_IDENTIFICATION_TEXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6fd7d32b-81d1-46e3-a86c-45cdaf25b278
                stepCounter: 54062b20-c5ab-455c-bc24-aa2727eb8a30
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04164468-436f-4184-87f5-da975f23213c
          stepCounter: 6439c096-d790-4f4d-908d-18496280a4f9
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: Identifies the card scheme associated with the transaction that has been derived from the PAN using the Interchange BIN table and the System Card Type Mapping table.
        name: CARD_SCHEME_ID_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 501afbe2-ccc8-4a47-a19e-120b48d2a324
                stepCounter: 54062b20-c5ab-455c-bc24-aa2727eb8a30
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f8a40e2b-03a5-459d-acd9-74e9e0f37d9c
          stepCounter: 6439c096-d790-4f4d-908d-18496280a4f9
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: The changing hash
        name: DSS_CHANGE_HASH
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: da90de01-0403-428c-ab60-2e71bc464d60
                stepCounter: 54062b20-c5ab-455c-bc24-aa2727eb8a30
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bfdd9ddf-e837-4ff7-a215-83632672be71
          stepCounter: 6439c096-d790-4f4d-908d-18496280a4f9
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Record source
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 954c9cd7-4fdc-45d1-b66a-377bc9ee9510
                stepCounter: 54062b20-c5ab-455c-bc24-aa2727eb8a30
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53391399-33ae-413b-929d-ee487d78cfe8
          stepCounter: 6439c096-d790-4f4d-908d-18496280a4f9
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was loaded in the data vault
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c86ff663-89bf-4983-aef9-4dff59133f4a
                stepCounter: 54062b20-c5ab-455c-bc24-aa2727eb8a30
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f3622d10-dc7a-4dd4-b08f-149e004bc372
          stepCounter: 6439c096-d790-4f4d-908d-18496280a4f9
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row started in the data vault
        isSystemStartDate: true
        name: DSS_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1bd1a0e-6baf-4075-b403-97c6a18d1756
                stepCounter: 54062b20-c5ab-455c-bc24-aa2727eb8a30
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39de2642-7c69-4c5e-b5f1-859c7daf2958
          stepCounter: 6439c096-d790-4f4d-908d-18496280a4f9
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: Version number of a business key in the data vault
        isSurrogateKey: true
        isSystemVersion: true
        name: DSS_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: afc5e04e-08f2-4610-b047-8ed13b4fc4ba
                stepCounter: 54062b20-c5ab-455c-bc24-aa2727eb8a30
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06d67827-7737-4f65-89e1-b8fc0993cb54
          stepCounter: 6439c096-d790-4f4d-908d-18496280a4f9
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was inserted in the data vault
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: adcd95da-d7c0-4ffb-a84a-82f9c2550c3e
                stepCounter: 54062b20-c5ab-455c-bc24-aa2727eb8a30
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_SETTLED_TRANSACTIONS_PCI: 54062b20-c5ab-455c-bc24-aa2727eb8a30
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATAVAULT_RAW_VAULT
            nodeName: S_SETTLED_TRANSACTIONS_PCI
        join:
          joinCondition: |-
            FROM {{ ref('DATAVAULT_RAW_VAULT','S_SETTLED_TRANSACTIONS_PCI') }} s_settled_transactions_pci
             INNER JOIN (
                    SELECT hk_h_settled_transactions,
                           MAX(dss_start_date) AS dss_start_date
                      FROM {{ ref('DATAVAULT_RAW_VAULT','S_SETTLED_TRANSACTIONS_PCI') }}
                     GROUP BY hk_h_settled_transactions
                   ) curr
                ON curr.hk_h_settled_transactions = s_settled_transactions_pci.hk_h_settled_transactions
               AND curr.dss_start_date = s_settled_transactions_pci.dss_start_date
        name: S_SETTLED_TRANSACTIONS_PCI_CURRENT
        noLinkRefs: []
  name: S_SETTLED_TRANSACTIONS_PCI_CURRENT
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
