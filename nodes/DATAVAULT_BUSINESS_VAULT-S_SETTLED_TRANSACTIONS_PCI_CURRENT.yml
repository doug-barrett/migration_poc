fileVersion: 1
id: 3c3e9773-b7d6-4deb-a831-8b940920f548
name: S_SETTLED_TRANSACTIONS_PCI_CURRENT
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DATAVAULT_BUSINESS_VAULT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8975ed8e-7de1-4a1f-88e1-e5219885f562
          stepCounter: 3c3e9773-b7d6-4deb-a831-8b940920f548
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: ""
        name: HK_H_SETTLED_TRANSACTIONS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f915ac4-4c4a-47c3-aa40-8d6d558036e3
                stepCounter: e0dfdb7a-522a-4c99-a499-d0db6ace82a2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1f64708-1b63-42da-a95f-b3bec2af061b
          stepCounter: 3c3e9773-b7d6-4deb-a831-8b940920f548
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: RECID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2580e7c-c29b-444e-bcfa-175a03dce4d6
                stepCounter: e0dfdb7a-522a-4c99-a499-d0db6ace82a2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8aad057b-cd3d-4092-83f6-20c6ececb5f2
          stepCounter: 3c3e9773-b7d6-4deb-a831-8b940920f548
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: Identifies the Merchant who initially received the transaction.
        isBusinessKey: true
        name: TRANSACTION_MERCHANT_INTERNAL_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 80d57fee-a4e2-4032-8e01-c32893098c9a
                stepCounter: e0dfdb7a-522a-4c99-a499-d0db6ace82a2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a672ab9e-eeef-41ef-a2d6-d45d4c8b040b
          stepCounter: 3c3e9773-b7d6-4deb-a831-8b940920f548
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: A description of the card identification (PAN Number) on which the transaction was made.
        name: CARD_IDENTIFICATION_TEXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 962b2eb6-1342-4173-8db8-a3c70fc5a5db
                stepCounter: e0dfdb7a-522a-4c99-a499-d0db6ace82a2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ecfc8b14-3f6c-4084-bc95-4f0b45f1926a
          stepCounter: 3c3e9773-b7d6-4deb-a831-8b940920f548
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: Identifies the card scheme associated with the transaction that has been derived from the PAN using the Interchange BIN table and the System Card Type Mapping table.
        name: CARD_SCHEME_ID_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72760714-b85d-469f-ba95-13c3fc23a212
                stepCounter: e0dfdb7a-522a-4c99-a499-d0db6ace82a2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e318f85-e8d6-47f6-9cf1-d7497e805acf
          stepCounter: 3c3e9773-b7d6-4deb-a831-8b940920f548
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: The changing hash
        name: DSS_CHANGE_HASH
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 584ab19e-f393-443b-9279-a0b38dacf59e
                stepCounter: e0dfdb7a-522a-4c99-a499-d0db6ace82a2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8eb8b1fb-5fad-4503-a1ed-79a5a284151f
          stepCounter: 3c3e9773-b7d6-4deb-a831-8b940920f548
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Record source
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 96891799-ccc8-4b49-99b2-f71724e6a490
                stepCounter: e0dfdb7a-522a-4c99-a499-d0db6ace82a2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c7716ce3-5bfd-4862-935b-9605355069bf
          stepCounter: 3c3e9773-b7d6-4deb-a831-8b940920f548
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was loaded in the data vault
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 69396f86-6c04-45f2-9aeb-77582c979898
                stepCounter: e0dfdb7a-522a-4c99-a499-d0db6ace82a2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4c3a602-c4b8-4dc0-9cf2-822187ca4d80
          stepCounter: 3c3e9773-b7d6-4deb-a831-8b940920f548
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row started in the data vault
        isSystemStartDate: true
        name: DSS_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea570de0-e48c-44c6-9e9f-46249fc1b406
                stepCounter: e0dfdb7a-522a-4c99-a499-d0db6ace82a2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 23cc4e0f-5ba5-4fa5-a0ba-68f6918da777
          stepCounter: 3c3e9773-b7d6-4deb-a831-8b940920f548
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: Version number of a business key in the data vault
        isSurrogateKey: true
        isSystemVersion: true
        name: DSS_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11a79688-2fdb-4bfa-b6ac-26007172a9d6
                stepCounter: e0dfdb7a-522a-4c99-a499-d0db6ace82a2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7dfe0a1d-68c0-46e8-8a46-b8a9a8b8e224
          stepCounter: 3c3e9773-b7d6-4deb-a831-8b940920f548
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was inserted in the data vault
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c21cb991-dc5e-403f-8004-5dcc6f04c0f3
                stepCounter: e0dfdb7a-522a-4c99-a499-d0db6ace82a2
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_SETTLED_TRANSACTIONS_PCI: e0dfdb7a-522a-4c99-a499-d0db6ace82a2
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATAVAULT_RAW_VAULT
            nodeName: S_SETTLED_TRANSACTIONS_PCI
        join:
          joinCondition: |-
            FROM {{ ref('DATAVAULT_RAW_VAULT','S_SETTLED_TRANSACTIONS_PCI') }} s_settled_transactions_pci
             INNER JOIN (
                    SELECT hk_h_settled_transactions,
                           MAX(dss_start_date) AS dss_start_date
                      FROM {{ ref('DATAVAULT_RAW_VAULT','S_SETTLED_TRANSACTIONS_PCI') }}
                     GROUP BY hk_h_settled_transactions
                   ) curr
                ON curr.hk_h_settled_transactions = s_settled_transactions_pci.hk_h_settled_transactions
               AND curr.dss_start_date = s_settled_transactions_pci.dss_start_date
        name: S_SETTLED_TRANSACTIONS_PCI_CURRENT
        noLinkRefs: []
  name: S_SETTLED_TRANSACTIONS_PCI_CURRENT
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
