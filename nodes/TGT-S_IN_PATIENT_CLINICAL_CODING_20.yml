fileVersion: 1
id: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
name: S_IN_PATIENT_CLINICAL_CODING_20
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3136f85a-22ee-433e-9b8f-d36d7e6dcfbb
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b8db10f-5652-4bae-9619-dd69f02bc714
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fed5b295-0d88-4c5e-af42-a1f2fbb30d83
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: VARCHAR(16)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d574b2dd-ae88-447d-b521-70d9854ba2ee
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3efe97c-a204-4fa5-bd59-81b4b1897ff4
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: VARCHAR(16)
        defaultValue: ""
        description: ""
        name: ORIGINAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a11a590-c7f3-4cb8-b03e-7be13b4a0fb9
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3215998f-d59a-4e7e-8c21-88077c175a78
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_CODING_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ff3da67d-649d-477b-8fd1-ac0141f5be82
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d139c912-009c-48ef-9130-65214583b587
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_CODING_NEW_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b0b8c4fb-b851-4959-8507-fd897c81e764
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b2a8a61-e2e8-4cf3-8359-ac2d636105b5
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_CODING_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ac733ab6-6958-4df3-a2b9-64e23b9a21f5
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14a92c61-0eca-4857-9505-34ab2f91d185
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_CODING_RANK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59f1cf3f-a5d0-4bbe-b06a-3efc90953c4a
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9cae9700-7771-4463-82b6-e35a46e817f6
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: CONDITION_ONSET_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3befdf32-afb3-49b5-8bdf-d854922bf6fd
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d09dc41c-ffbb-40c1-abed-344134f941c8
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: EVENT_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 733212d6-669d-419c-b3c1-f2526cd87cab
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 254d1a60-76b8-4675-a3b1-b8eff2767f55
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: ""
        name: HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a485a95e-69cd-4ef2-ac34-fbb18cc0b2d4
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64f14988-e83f-4e80-a1f1-31eea4d9e02c
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f2b30fb3-c83f-4995-89bf-8244df79268a
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88619c52-ddf4-4bdb-a296-5c1973eba88e
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d749776-771a-481c-ac5d-86b2f4cada95
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4254981-4a65-4112-8e41-0d0bb70f40a9
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: VARCHAR(200)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1a1fc4b8-c07f-45d2-b929-00f4752074c0
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cfabb234-ef54-4229-b2d7-a15a839f563e
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a8d6e011-f85f-4c01-9a67-e5405ff8d3fb
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a95dc23-d7e7-416f-9678-361acc91c9c3
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_clinical_coding_10.diagnosis_procedure_code=dim_ICD_code.ICD_code
        name: DIM_ICD_CODE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a8126d6-2dfc-4e86-b5c3-07ba2dc92e2d
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3756e48-aeda-405d-8f51-89ff304f452e
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: DRG_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cdad8423-9d9b-4d64-87bb-7d3969f8ec69
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 60ee5e0c-0cc5-4ead-a161-e818164137ea
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: WIES_MOH_RATING
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 14351023-1edb-43ec-8273-e3ec3a968ca1
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 499c0dce-0893-4829-a38a-14f6104eb6ba
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: Generated artificial key
        name: DIM_DRG_CODE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8bd0a5c0-d5a2-4d49-91dd-c4253418a9b4
                stepCounter: c9ea96b1-10f0-4480-aff0-b535fb105991
            transform: IFNULL(dim_DRG_code.dim_DRG_code_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c365b98e-829e-419d-97ef-dbc96aaf16f9
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: MDC_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 507bfb60-57cb-428d-967a-473b8a372c23
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8ae396d-adb8-45ec-8f6e-7f516f252ddb
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_clinical_coding_20.MDC_code=dim_MDC_code.MDC_code
        name: DIM_MDC_CODE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23085b92-b2e0-4c56-9010-c0b5de017357
                stepCounter: fefa4b8d-0977-47df-951a-4365058f9b77
            transform: IFNULL(dim_MDC_code.dim_MDC_code_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d49f6368-2595-4366-b1dc-360d9bf58367
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18619c3f-4140-425c-8ab4-cbdabdfa05f7
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f4b6c2ce-9a3c-476b-99f9-dea6e5f692b6
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: VARCHAR(7)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db8ec63b-65d9-45bd-a12c-a50fffef32b1
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1da24501-e359-4dea-ad99-214d6ea38d68
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 985f0ba0-97cf-4152-a49b-7e86cb71409e
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2dfaf554-19b0-4f56-a6c6-271e3e58dbf1
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_clinical_coding_20.patient_reference_no=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9962a01b-5f3d-4c1a-b371-997edef38d0f
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: IFNULL(dim_patient.dim_patient_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2b90ea2-3717-4904-8650-84ec845d0e0d
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DATE_OF_BIRTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c671397a-3caf-40c5-bdfa-2ca24bd64e16
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8bc5ed4c-766e-4c59-8d6c-dc5541557cca
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: HOSPITAL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 95278522-96c3-4abe-822a-ca416aec8891
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3571a858-e2b7-49c7-a962-3773697f8da5
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed7ba841-19fd-4d6d-9ed7-0f38e0b79147
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: afad59d9-062a-40d2-9bec-2587b18599bf
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: WARD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3565a872-574b-4d95-957f-14bf38f2d17e
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 58bc56f1-7d01-4cb0-af5e-682c7e36de69
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_clinical_coding_20.ward_code=dim_ward.ward_code
        name: DIM_WARD_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6aa5e7b8-4dc5-4b87-a4c2-5013db0e1dfc
                stepCounter: 50c31151-9204-4154-9caf-5d28244bde1a
            transform: IFNULL(dim_ward.dim_ward_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d212264-5a2c-455a-a748-0cfc0d4bb2f5
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: clinician_reference_no
        name: CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 148b73dc-671e-4f97-996d-f5639566eaa1
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6878241-ebee-4ecb-8ee0-cfdef08e0e77
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_clinical_coding_20.clinician_reference_no=dim_clinician.clinician_reference_no
        name: DIM_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 911a8788-86e5-4a5c-a00a-a957d59070b8
                stepCounter: e8e4a684-3ef8-4076-846f-48d5689e824f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a45d1094-f036-4123-9427-55912f2700d5
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: specialty_reference_no
        name: SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ed2712c-6577-41a7-a5a6-847041c363b8
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17f8a338-f3fa-4255-a23d-114b4580d6b9
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_clinical_coding_20.specialty_reference_no=dim_specialty.specialty_reference_no
        name: DIM_SPECIALTY_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79aee918-ff6f-4b0a-a656-000827899f3e
                stepCounter: 4182a75e-d07b-4637-97fa-4c01e2878360
            transform: IFNULL(dim_specialty.dim_specialty_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 099e9b04-bddf-4006-966f-da59844231f3
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMISSION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 633c1d31-1eb3-4c96-9be4-b31854ec725d
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eab6cab4-a5c0-42b1-8fa7-89d755c4f572
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_clinical_coding_20.CONVERT(date,admission_date)=dim_admission_date.admission_calendar_date
        name: DIM_ADMISSION_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b402ec63-d2cf-47e5-ab27-e5c03a6296f4
                stepCounter: 9996feda-efbd-41f4-8569-36f5c8b63c75
            transform: IFNULL(dim_admission_date.dim_admission_date_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7391fa6f-2ef3-4951-8849-c9e6cf5cca7c
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MOH_ADMISSION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f779854a-6902-4956-b68d-7eddca153a6b
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f08d30c-f44c-4229-83e7-04f29cf12c2d
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: ADMISSION_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 306a400d-9a77-45ec-ac29-7214893dd594
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e17789ff-0081-4652-9953-835e086a5044
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: ""
        name: DIM_ADMISSION_SOURCE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c51545c-208a-4795-b104-c8e71ed30273
                stepCounter: 03e13fac-da9d-4222-8e2c-95b3d7218199
            transform: IFNULL(dim_admission_source.dim_admission_source_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea216920-3b80-4c8f-9037-dba13e4b23b0
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: ADMISSION_METHOD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b16b2b71-5593-4e0f-91be-13936636b288
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e075ffdc-ae59-4b00-8bd6-5d3d20eb5805
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: ""
        name: DIM_ADMISSION_METHOD_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f228ac9a-42c6-489f-bcad-ee502f61a194
                stepCounter: 469bfd7a-0084-4352-8ef5-69fd15a77ed4
            transform: IFNULL(dim_admission_method.dim_admission_method_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04a8fddf-ee5c-495a-805a-98d085e65f8f
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: discharge_date
        name: DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b145006-b35d-4ffa-ac5a-55fe499e75db
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f3d6088-ed2c-4578-9c90-d909ff41eff4
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_clinical_coding_20.CONVERT(date,discharge_date)=dim_discharge_date.discharge_calendar_date
        name: DIM_DISCHARGE_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 985b56af-022e-46b3-82b0-51ae204ca926
                stepCounter: 45fbd3a8-64d0-4be6-b03a-8d128a18b549
            transform: IFNULL(dim_discharge_date.dim_discharge_date_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c857c61-01dc-4376-8104-7fc437f63638
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MOH_DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ff844f4-b391-473c-b9fe-9f7bfa0a9df3
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bccd57af-2e83-4664-921a-3396d7dc6a1d
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: discharge_Financial year (YYYY)
        name: DISCHARGE_FINANCIAL_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8338e861-47c1-479f-8721-f71845c679f5
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b35b7ca2-cb54-4681-a9c3-c2ff902d8052
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: DISCHARGE_METHOD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c220be1-dde6-4284-beb6-92404f0b10e0
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 60656d28-93a7-434d-ab02-b1de03d9d409
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: ""
        name: DIM_DISCHARGE_METHOD_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7cfc7a5d-1a68-40a3-8031-dd6da6eb8ba9
                stepCounter: 1bd29797-d2cb-4604-b84b-82897e347c39
            transform: IFNULL(dim_discharge_method.dim_discharge_method_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb375db7-a9ef-432e-90ba-9cc7e4e2c5f5
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b6e79de-7c9a-4ba8-bbb7-21113bcc6ee8
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f7b6b3b-2077-4945-907f-deeb49e6c4d8
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_CODE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ce7267b-129c-4578-957f-529e47b2c701
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb35898d-07ab-4c11-b86b-269abfdbcc32
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_clinical_coding_20.purchase_unit_code=dim_purchase_unit.purchase_unit_code
        name: DIM_PURCHASE_UNIT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d9c041f-76d6-44c7-8d88-936673dfd7a0
                stepCounter: d198650d-0f77-489d-92ec-0c0257cd5a43
            transform: IFNULL(dim_purchase_unit.dim_purchase_unit_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d05200c-f345-42bb-9eca-e0bf6bd47a35
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: EXCLUDED_PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a292a042-495c-438d-965f-fe51563bc740
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6881917-e937-4182-a89a-2eb09903832b
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: NZ_RESIDENCY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 149cce3f-811e-4f15-a522-bb43e6e78ce2
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 433d0fbb-9f86-4616-82fc-f8e11b3c814c
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: DOMICILE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7933ff80-f6e5-4e8a-af48-142a0b69871f
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e56f9793-dd9e-4335-917f-7daa39b1e3f5
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_clinical_coding_20.domicile_code=dim_domicile.domicile_code
        name: DIM_DOMICILE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e049fc8-a2a3-4bad-9b91-11b9d158b35e
                stepCounter: 330ad0aa-b8b1-4da9-ab37-b4fe8f889452
            transform: IFNULL(dim_domicile.dim_domicile_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e166c3ac-205f-4bf3-aefd-d69e757aed90
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: VARCHAR(12)
        defaultValue: ""
        description: ""
        name: ACC_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 20315069-8192-4b27-a879-56bc21d5abc9
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f1501b6b-c514-423c-a304-34c4f94c7ece
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: VENTILATOR_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 06abd8e2-fcdc-4e81-b376-5e32d405ed7e
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27330c36-75bf-4eea-8492-302cbcda97cb
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: WIES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 14351023-1edb-43ec-8273-e3ec3a968ca1
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: |-
              CASE WHEN s_in_patient_clinical_coding_10.event_coding_rank = 1 THEN s_in_patient_clinical_coding_10.WIES
                          ELSE 0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1f9e4ea-658f-47b5-afdf-9fd8a588f53b
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: value is 1 when icd code matches Z716 smoking advice given
        name: SMOKING_ADVICE_GIVEN
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0fd07d36-fef5-4c1f-abba-28d89f3f1e25
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a10c80f2-1b51-4cd6-8031-f801438ed1a2
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: value is 1 when icd code matches Z716 smoking advice given
        name: SMOKER_IDENTIFIED
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19b72702-36d0-4f72-87e9-d016b01a4743
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f48113ea-7dc8-49cf-bea8-05b96e8be695
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CODING_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de3dc018-6782-47be-bd51-997cb98bfaa6
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 13d16b29-be8b-4133-aaf8-a9bce2e69208
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CODING_DURATION_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de3dc018-6782-47be-bd51-997cb98bfaa6
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: DATEDIFF(dd,s_in_patient_clinical_coding_10.discharge_date_orig,s_in_patient_clinical_coding_10.coding_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fec5b74e-ea69-4208-8a2f-889f316b8052
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5eff946f-18fc-4189-b02e-76aacaba0cc7
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ddf4926-175d-48de-968c-cd8b3c37a912
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: USER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9ae0b81d-5fd3-42be-83e3-8b7488759909
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 969a47a1-9697-4a2a-9d1b-aed57105a04e
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 174cd0b8-fd06-488b-a629-55ec72ce9c4c
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec25685d-009d-4b2d-a4bf-13c431cd9fe2
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: RECORD_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 007c1a1c-b706-4c92-879d-16ece3cf051c
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33634709-63eb-4c37-baf5-d3794676efe1
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DSS_DATA_QUALITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b89079ca-5e75-41db-9f67-e065b8a40bb1
                stepCounter: 55183b06-17cb-4dca-ab7a-e59f2f78b57b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50f93ceb-719c-4d80-825e-3c296dc0bec4
          stepCounter: 069a8ae5-0465-4904-97f4-4480f8c0e5c4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DIM_PURCHASE_UNIT: d198650d-0f77-489d-92ec-0c0257cd5a43
          DIM_WARD: 50c31151-9204-4154-9caf-5d28244bde1a
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_IN_PATIENT_CLINICAL_CODING_10
          - locationName: TGT
            nodeName: DIM_PURCHASE_UNIT
          - locationName: TGT
            nodeName: DIM_WARD
        join:
          joinCondition: |-
            FROM s_in_patient_clinical_coding_10
              LEFT OUTER JOIN dim.dim_DRG_code
                ON s_in_patient_clinical_coding_10.DRG_code = dim_DRG_code.DRG_code
               AND s_in_patient_clinical_coding_10.discharge_date BETWEEN dim_DRG_code.WIES_validity_start_date AND dim_DRG_code.WIES_validity_end_date
              LEFT OUTER JOIN dim.dim_admission_source
                ON s_in_patient_clinical_coding_10.admission_source_code = dim_admission_source.admission_source_code
               AND IFNULL(dim_admission_source.dss_start_date, GETDATE()-10000) <= s_in_patient_clinical_coding_10.discharge_date
               AND IFNULL(dim_admission_source.dss_end_date, GETDATE()+10000) >= s_in_patient_clinical_coding_10.discharge_date
              LEFT OUTER JOIN dim.dim_admission_method
                ON s_in_patient_clinical_coding_10.admission_method_code = dim_admission_method.admission_method_code
               AND IFNULL(dim_admission_method.dss_start_date, GETDATE()-10000) <= s_in_patient_clinical_coding_10.discharge_date
               AND IFNULL(dim_admission_method.dss_end_date, GETDATE()+10000) >= s_in_patient_clinical_coding_10.discharge_date
              LEFT OUTER JOIN dim.dim_discharge_method
                ON s_in_patient_clinical_coding_10.discharge_method_code = dim_discharge_method.discharge_method_code
               AND IFNULL(dim_discharge_method.dss_start_date, GETDATE()-10000) <= s_in_patient_clinical_coding_10.discharge_date
               AND IFNULL(dim_discharge_method.dss_end_date, GETDATE()+10000) >= s_in_patient_clinical_coding_10.discharge_date
              LEFT OUTER JOIN {{ ref('TGT','DIM_PURCHASE_UNIT') }}
                ON s_in_patient_clinical_coding_10.purchase_unit_code = dim_purchase_unit.purchase_unit_code
               AND s_in_patient_clinical_coding_10.discharge_date BETWEEN dim_purchase_unit.validity_start_date AND dim_purchase_unit.validity_end_date
              LEFT OUTER JOIN {{ ref('TGT','DIM_WARD') }}
                ON s_in_patient_clinical_coding_10.ward_reference_no = dim_ward.ward_reference_no
               AND IFNULL(dim_ward.dss_start_date, GETDATE()-10000) <= s_in_patient_clinical_coding_10.discharge_date
               AND IFNULL(dim_ward.dss_end_date, GETDATE()+10000) >= s_in_patient_clinical_coding_10.discharge_date
        name: S_IN_PATIENT_CLINICAL_CODING_20
        noLinkRefs: []
  name: S_IN_PATIENT_CLINICAL_CODING_20
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
