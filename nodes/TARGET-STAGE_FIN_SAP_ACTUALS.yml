fileVersion: 1
id: 9bf4b1b9-796f-46b6-8c46-10940fc92461
name: STAGE_FIN_SAP_ACTUALS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8483ebc-13cb-40dd-bd61-7d7bd9d505dc
          stepCounter: 9bf4b1b9-796f-46b6-8c46-10940fc92461
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEDGER_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: af0a440c-8437-4811-a1c3-68aa38a3b0a0
                stepCounter: 231e86b2-e335-450f-b991-fc6aa2c2fe4c
            transform: NVL(DIM_LO_SAP_LEDGER.DIM_LEDGER_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25a166c3-fe04-4ec5-abad-921798be8f06
          stepCounter: 9bf4b1b9-796f-46b6-8c46-10940fc92461
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACTVY_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e612152e-f3ce-4b43-924c-ba5523fc7f3f
                stepCounter: f8e715c1-87e2-4cc6-a839-d0b610927a6b
            transform: nvl(DIM_LO_SAP_ACTVY_PER_DATE.DIM_ACTVY_PER_DATE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25ddfa2d-416e-4658-8704-680b3ba5d6d7
          stepCounter: 9bf4b1b9-796f-46b6-8c46-10940fc92461
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACCT_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 181c6f17-4ebf-46a1-b5ba-e8fd39fce1a8
                stepCounter: 030f9454-0584-4b79-8319-768ccf1fc4ab
            transform: nvl(DIM_LO_SAP_ACCT_PER_DATE.DIM_ACCT_PER_DATE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b0ed1e0-ea5c-4751-a536-cfa429d38f9c
          stepCounter: 9bf4b1b9-796f-46b6-8c46-10940fc92461
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LINE_ITEM_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3834de13-ebed-4450-84f2-096b0c4886b5
                stepCounter: d0ab4a94-a909-487b-8651-345f5baff59d
            transform: nvl(DIM_LO_SAP_LINE_ITEM.DIM_LINE_ITEM_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 294f692f-359f-4cc1-8713-5100627f81a4
          stepCounter: 9bf4b1b9-796f-46b6-8c46-10940fc92461
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_VOUCHER_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c90b01b-ab3e-4edb-a0ad-64f56a9ed059
                stepCounter: 1d472b56-8930-4c1b-b3e1-6a0b7af640a0
            transform: nvl(DIM_LO_SAP_VOUCHER.DIM_VOUCHER_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 391126cd-f76a-476e-9556-287a563d0a15
          stepCounter: 9bf4b1b9-796f-46b6-8c46-10940fc92461
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_COST_CENTER_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f9cd4561-df13-4a2c-9e91-edfcf7767bd5
                stepCounter: 99b4a618-454e-46de-874d-ad30b4d42108
            transform: nvl(DIM_LO_SAP_COST_CENTER.DIM_COST_CENTER_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3cae3115-0e62-4b36-aeae-f77916c984b5
          stepCounter: 9bf4b1b9-796f-46b6-8c46-10940fc92461
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 245a4951-1f76-4c9f-b18b-b238087af3e2
                stepCounter: 0ababbaf-41b3-4bd0-a251-c8aab7eb6948
            transform: nvl(DIM_LO_SAP_AFE.DIM_AFE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0b92050-54e0-42bd-9006-c3c44425c431
          stepCounter: 9bf4b1b9-796f-46b6-8c46-10940fc92461
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 739b941e-c607-4803-994d-db4e17460ddc
                stepCounter: f1879670-70ca-4133-bc5d-193fd6cd9104
            transform: nvl(DIM_LO_SAP_AFE_TYPE.DIM_AFE_TYPE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88b9a1eb-f3c4-4978-99d8-8a90ae216f76
          stepCounter: 9bf4b1b9-796f-46b6-8c46-10940fc92461
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_INVOICE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c883d386-c78a-4ebf-9804-6d887b53bf10
                stepCounter: 1d34134b-57a2-432b-b3e2-cbfbc27ed60e
            transform: nvl(DIM_LO_SAP_INVOICE.DIM_INVOICE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4dac1900-d43b-47d5-a408-af4deff51142
          stepCounter: 9bf4b1b9-796f-46b6-8c46-10940fc92461
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_ORDER_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d94e6d7d-8f3d-4957-a211-8a790cf7a6b8
                stepCounter: 809a5202-eb28-40f4-8b6d-5b02f78f1376
            transform: nvl(DIM_LO_SAP_ORDER.DIM_ORDER_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 52ccb076-8470-483b-a67e-7ee89d1197fb
          stepCounter: 9bf4b1b9-796f-46b6-8c46-10940fc92461
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_DEST_ORGANIZATION_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5cdadf22-7f44-45f1-a78d-060f129ef387
                stepCounter: c958411f-21aa-4192-bbb1-c20096a8bcd3
            transform: nvl(DIM_LO_SAP_DEST_ORGANIZATION.DIM_DEST_ORGANIZATION_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e43d11b-82b6-4cb6-b230-f2e0048414d0
          stepCounter: 9bf4b1b9-796f-46b6-8c46-10940fc92461
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GL_ACCOUNT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1bfac200-cf5f-4920-af2c-25aea984b61d
                stepCounter: eded27ac-fd68-4b41-8110-94b692c365d5
            transform: nvl(DIM_LO_SAP_GL_ACCOUNT.DIM_GL_ACCOUNT_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7c5aa7b-2d50-4cff-aba9-d2fa486cae59
          stepCounter: 9bf4b1b9-796f-46b6-8c46-10940fc92461
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GROSS_NET_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2829c0ef-25f1-4706-9bef-2fe6fcf26e1d
                stepCounter: 592816dc-3717-40cf-ac36-2ff66c9e8146
            transform: nvl(DIM_LO_SAP_GROSS_NET.DIM_GROSS_NET_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ede61f7e-0727-4c4a-8266-c5668e9661a4
          stepCounter: 9bf4b1b9-796f-46b6-8c46-10940fc92461
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_PRODUCT_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b89587af-fd5b-4cfb-b17d-a9946c3f7396
                stepCounter: e14ab72e-3f25-44f0-b70c-6a0192afcc50
            transform: nvl(DIM_LO_SAP_PRODUCT_TYPE.DIM_PRODUCT_TYPE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9622bcbf-f9d9-4273-bd13-4ab998064caa
          stepCounter: 9bf4b1b9-796f-46b6-8c46-10940fc92461
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: DIM_ACTVY_PER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94ccb4b1-376e-4199-ae79-56d8dd4f9d8d
                stepCounter: f8e715c1-87e2-4cc6-a839-d0b610927a6b
            transform: nvl(DIM_LO_SAP_ACTVY_PER_DATE.DATE,(SELECT DISTINCT DATE FROM {{ ref('TARGET','DIM_LO_SAP_ACTVY_PER_DATE') }} WHERE DIM_ACTVY_PER_DATE_KEY = 0))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3ed325c-4018-48ee-a8a8-7b341de497bb
          stepCounter: 9bf4b1b9-796f-46b6-8c46-10940fc92461
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: DIM_ACCT_PER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c0531083-75c3-40ab-9120-804f63efb3a4
                stepCounter: 030f9454-0584-4b79-8319-768ccf1fc4ab
            transform: nvl(DIM_LO_SAP_ACCT_PER_DATE.DATE,(SELECT DISTINCT DATE FROM {{ ref('TARGET','DIM_LO_SAP_ACCT_PER_DATE') }} WHERE DIM_ACCT_PER_DATE_KEY = 0))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cbc1628a-4816-4b77-a108-c8e8853a953a
          stepCounter: 9bf4b1b9-796f-46b6-8c46-10940fc92461
        config: {}
        dataType: VARCHAR(38)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: LI_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 087f18e3-3489-42af-a08a-e7544931ff30
                stepCounter: d310660d-8d8d-4155-898e-2bc2c935b749
            transform: ODS_SAP_ACDOCA.RLDNR|| ODS_SAP_ACDOCA.RBUKRS|| TO_CHAR(ODS_SAP_ACDOCA.GJAHR)|| ODS_SAP_ACDOCA.BELNR|| ODS_SAP_ACDOCA.DOCLN
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40915b9f-fe46-431a-a292-b1af17234292
          stepCounter: 9bf4b1b9-796f-46b6-8c46-10940fc92461
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: GLOP_LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1114a530-83e9-4ceb-81b7-2e1033819f5e
                stepCounter: d0ab4a94-a909-487b-8651-345f5baff59d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb1ea87b-d331-4e2e-b496-d69788e428f4
          stepCounter: 9bf4b1b9-796f-46b6-8c46-10940fc92461
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: GLOP_AMT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eaf1dca2-9782-422e-85c5-da635ee6821c
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3213c70d-c751-4a31-9a90-1a5968dd5a41
          stepCounter: 9bf4b1b9-796f-46b6-8c46-10940fc92461
        config: {}
        dataType: NUMBER(26,5)
        defaultValue: ""
        description: ""
        name: GLOP_EXCHANGE_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 546c27dd-fad7-407b-912d-21850da10627
                stepCounter: a0af4353-38fe-4b99-9582-f996832a6066
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81874e9d-6f9a-4373-a08a-24a18c75122d
          stepCounter: 9bf4b1b9-796f-46b6-8c46-10940fc92461
        config: {}
        dataType: NUMBER(23,2)
        defaultValue: ""
        description: ""
        name: OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ac73f18-e79e-420c-ac24-bfae389af54a
                stepCounter: d310660d-8d8d-4155-898e-2bc2c935b749
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4facf7a5-2ae1-441d-abc2-6fb00f492101
          stepCounter: 9bf4b1b9-796f-46b6-8c46-10940fc92461
        config: {}
        dataType: NUMBER(23,2)
        defaultValue: ""
        description: Gross Line Item Net Op Amount
        name: NET_OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 13294350-218e-4cc7-af96-f43be3f2f9bb
                stepCounter: d310660d-8d8d-4155-898e-2bc2c935b749
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d5b2c1f-9139-4174-bfd7-7455f85032d6
          stepCounter: 9bf4b1b9-796f-46b6-8c46-10940fc92461
        config: {}
        dataType: NUMBER(23,2)
        defaultValue: ""
        description: ""
        name: VCHR_CURR_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4ce50a3-b05c-4e86-b334-0dc6b9105354
                stepCounter: d310660d-8d8d-4155-898e-2bc2c935b749
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78261860-a168-4703-bf21-819bb6ddb630
          stepCounter: 9bf4b1b9-796f-46b6-8c46-10940fc92461
        config: {}
        dataType: NUMBER(23,2)
        defaultValue: ""
        description: ""
        name: CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c4b483f-86ce-4c2b-9d4b-a4d702e87662
                stepCounter: d310660d-8d8d-4155-898e-2bc2c935b749
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 274a04b5-724f-42b9-98a4-8ad1c717110e
          stepCounter: 9bf4b1b9-796f-46b6-8c46-10940fc92461
        config: {}
        dataType: NUMBER(23,2)
        defaultValue: ""
        description: The CAD equivalent for GLOP transactions. This is only applicable to the Lease Ops model and should not be used for other reports
        name: GLOP_CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c4b483f-86ce-4c2b-9d4b-a4d702e87662
                stepCounter: d310660d-8d8d-4155-898e-2bc2c935b749
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 505c8d3e-c67f-49a8-94e6-0b543fc25058
          stepCounter: 9bf4b1b9-796f-46b6-8c46-10940fc92461
        config: {}
        dataType: NUMBER(23,2)
        defaultValue: ""
        description: ""
        name: LI_VOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e076a8a-bd1f-4787-9df3-30b5b6ccd322
                stepCounter: d310660d-8d8d-4155-898e-2bc2c935b749
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b25fe7c-d508-4303-967a-f7c02d9aba31
          stepCounter: 9bf4b1b9-796f-46b6-8c46-10940fc92461
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: ""
        name: LI_VOL_UOM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11aee58a-4273-4a7c-acc9-bd625657cd63
                stepCounter: d310660d-8d8d-4155-898e-2bc2c935b749
            transform: SUBSTR(ODS_SAP_ACDOCA.RUNIT,1,3)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f88f34c4-b3b0-4176-8a8b-0ff5584e9554
          stepCounter: 9bf4b1b9-796f-46b6-8c46-10940fc92461
        config: {}
        dataType: NUMBER(23,2)
        defaultValue: ""
        description: Line item Volume in BOE (Barrel of Oil Equivalent)
        name: LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 846c6f2f-e52a-47a9-9fc4-eb3c16751117
                stepCounter: afdd1b22-0903-46c3-973a-2d9afcc2520c
            transform: ODS_SAP_ACDOCA.MSL * LOAD_VET_FIN_SAP_CONVERSION.LI_TO_BOE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 677c5b45-f69a-4893-9671-532b381cc8b0
          stepCounter: 9bf4b1b9-796f-46b6-8c46-10940fc92461
        config: {}
        dataType: NUMBER(23,2)
        defaultValue: ""
        description: Line item Volume in cubic meters (m3)
        name: LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 878c4df3-4809-43c5-805b-b6c5b13a2011
                stepCounter: afdd1b22-0903-46c3-973a-2d9afcc2520c
            transform: ODS_SAP_ACDOCA.MSL * LOAD_VET_FIN_SAP_CONVERSION.LI_TO_GLOP_METRIC
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c922c32f-8c84-4745-bece-cdb57afc2614
          stepCounter: 9bf4b1b9-796f-46b6-8c46-10940fc92461
        config: {}
        dataType: NUMBER(23,2)
        defaultValue: ""
        description: Line item Volume in Normalized Cubic Meters (m3)
        name: LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 878c4df3-4809-43c5-805b-b6c5b13a2011
                stepCounter: afdd1b22-0903-46c3-973a-2d9afcc2520c
            transform: ODS_SAP_ACDOCA.MSL * LOAD_VET_FIN_SAP_CONVERSION.LI_TO_GLOP_METRIC
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e66cff60-c93a-46de-bcf7-ba91574b79cb
          stepCounter: 9bf4b1b9-796f-46b6-8c46-10940fc92461
        config: {}
        dataType: NUMBER(23,2)
        defaultValue: ""
        description: Line item Volume in imperial measurement
        name: LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0a3d9ea1-5678-4c28-a9e1-5e80a0091918
                stepCounter: afdd1b22-0903-46c3-973a-2d9afcc2520c
            transform: ODS_SAP_ACDOCA.MSL * LOAD_VET_FIN_SAP_CONVERSION.LI_TO_GLOP_IMP
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40a25b86-74f0-44f3-86fc-6d4144fd1ff9
          stepCounter: 9bf4b1b9-796f-46b6-8c46-10940fc92461
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 366e919f-f342-47e9-a3c7-69aed27b84a0
                stepCounter: d310660d-8d8d-4155-898e-2bc2c935b749
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0758d437-bc62-47b6-b5c1-3b9f347419a6
          stepCounter: 9bf4b1b9-796f-46b6-8c46-10940fc92461
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Indicates amounts are gross or net.
        name: GROSS_OR_NET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b816d0b-81d7-4fb5-84ec-2161f890977f
          stepCounter: 9bf4b1b9-796f-46b6-8c46-10940fc92461
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: EDW Business Unit Role controlling RLS access
        name: BU_SF_ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4f4946a5-569c-4299-81c4-85e07aed37f4
                stepCounter: 81633694-61f3-481a-9531-1221e1a00464
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ODS_SAP_ACDOCA: d310660d-8d8d-4155-898e-2bc2c935b749
          ODS_SAP_BKPF: a0af4353-38fe-4b99-9582-f996832a6066
          DIM_LO_SAP_LEDGER: 231e86b2-e335-450f-b991-fc6aa2c2fe4c
          DIM_LO_SAP_LINE_ITEM: d0ab4a94-a909-487b-8651-345f5baff59d
          DIM_LO_SAP_VOUCHER: 1d472b56-8930-4c1b-b3e1-6a0b7af640a0
          DIM_LO_SAP_ACCT_PER_DATE: 030f9454-0584-4b79-8319-768ccf1fc4ab
          DIM_LO_SAP_ACTVY_PER_DATE: f8e715c1-87e2-4cc6-a839-d0b610927a6b
          DIM_LO_SAP_DEST_ORGANIZATION: c958411f-21aa-4192-bbb1-c20096a8bcd3
          DIM_LO_SAP_GL_ACCOUNT: eded27ac-fd68-4b41-8110-94b692c365d5
          DIM_LO_SAP_GROSS_NET: 592816dc-3717-40cf-ac36-2ff66c9e8146
          DIM_LO_SAP_INVOICE: 1d34134b-57a2-432b-b3e2-cbfbc27ed60e
          DIM_LO_SAP_AFE: 0ababbaf-41b3-4bd0-a251-c8aab7eb6948
          DIM_LO_SAP_AFE_TYPE: f1879670-70ca-4133-bc5d-193fd6cd9104
          DIM_LO_SAP_ORDER: 809a5202-eb28-40f4-8b6d-5b02f78f1376
          DIM_LO_SAP_COST_CENTER: 99b4a618-454e-46de-874d-ad30b4d42108
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEDGER
          - locationName: TARGET
            nodeName: ODS_SAP_ACDOCA
          - locationName: TARGET
            nodeName: ODS_SAP_BKPF
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LINE_ITEM
          - locationName: TARGET
            nodeName: DIM_LO_SAP_VOUCHER
          - locationName: TARGET
            nodeName: DIM_LO_SAP_ACCT_PER_DATE
          - locationName: TARGET
            nodeName: DIM_LO_SAP_ACTVY_PER_DATE
          - locationName: TARGET
            nodeName: DIM_LO_SAP_DEST_ORGANIZATION
          - locationName: TARGET
            nodeName: DIM_LO_SAP_GL_ACCOUNT
          - locationName: TARGET
            nodeName: DIM_LO_SAP_GROSS_NET
          - locationName: TARGET
            nodeName: DIM_LO_SAP_INVOICE
          - locationName: TARGET
            nodeName: DIM_LO_SAP_AFE
          - locationName: TARGET
            nodeName: DIM_LO_SAP_AFE_TYPE
          - locationName: TARGET
            nodeName: DIM_LO_SAP_ORDER
          - locationName: TARGET
            nodeName: DIM_LO_SAP_COST_CENTER
        join:
          joinCondition: |-
            EXTENDED
              FROM (
                    SELECT RLDNR,
                           RBUKRS,
                           GJAHR,
                           BELNR,
                           DOCLN ,
                           RHCUR,
                           RUNIT,
                           PS_PSP_PNR ,
                           RCNTR,
                           RACCT,
                           RECID,
                           AUFNR ,
                           SUM(HSL) HSL ,
                           SUM(TSL) TSL ,
                           SUM(KSL) KSL ,
                           SUM(MSL) MSL ,
                           SUM(FCSL) FCSL ,
                           'N' AS GROSS_OR_NET_CODE
                      FROM {{ ref('TARGET','ODS_SAP_ACDOCA') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                     GROUP BY RLDNR,
                              RBUKRS,
                              GJAHR,
                              BELNR,
                              DOCLN ,
                              RHCUR,
                              RUNIT,
                              PS_PSP_PNR ,
                              RCNTR,
                              RACCT,
                              RECID,
                              AUFNR
                     UNION SELECT RLDNR,
                           RBUKRS,
                           GJAHR,
                           BELNR,
                           DOCLN ,
                           RHCUR,
                           RUNIT,
                           PS_PSP_PNR ,
                           RCNTR,
                           RACCT,
                           RECID,
                           AUFNR ,
                           SUM(HSL) HSL ,
                           SUM(TSL) TSL ,
                           SUM(KSL) KSL ,
                           SUM(MSL) MSL ,
                           SUM(FCSL) FCSL ,
                           'G' AS GROSS_OR_NET_CODE
                      FROM {{ ref('TARGET','ODS_SAP_ACDOCA') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                       AND RECID NOT IN ('CB','ZA','ZB','ZY')
                     GROUP BY RLDNR,
                              RBUKRS,
                              GJAHR,
                              BELNR,
                              DOCLN ,
                              RHCUR,
                              RUNIT,
                              PS_PSP_PNR ,
                              RCNTR,
                              RACCT,
                              RECID,
                              AUFNR
                   ) ODS_SAP_ACDOCA
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_BKPF') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) ODS_SAP_BKPF
                ON ODS_SAP_BKPF.BELNR = ODS_SAP_ACDOCA.BELNR
               AND ODS_SAP_BKPF.GJAHR = ODS_SAP_ACDOCA.GJAHR
               AND ODS_SAP_BKPF.BUKRS = ODS_SAP_ACDOCA.RBUKRS
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_LEDGER') }} DIM_LO_SAP_LEDGER
                ON ODS_SAP_ACDOCA.RLDNR = DIM_LO_SAP_LEDGER.LEDGER_CODE
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_LINE_ITEM') }} DIM_LO_SAP_LINE_ITEM
                ON ODS_SAP_ACDOCA.RLDNR||ODS_SAP_ACDOCA.RBUKRS||TO_CHAR(ODS_SAP_ACDOCA.GJAHR)||ODS_SAP_ACDOCA.BELNR||ODS_SAP_ACDOCA.DOCLN = DIM_LO_SAP_LINE_ITEM.LI_ID
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_VOUCHER') }} DIM_LO_SAP_VOUCHER
                ON ODS_SAP_ACDOCA.RLDNR||ODS_SAP_ACDOCA.RBUKRS||TO_CHAR(ODS_SAP_ACDOCA.GJAHR)||ODS_SAP_ACDOCA.BELNR = DIM_LO_SAP_VOUCHER.VOUCHER_ID
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_ACCT_PER_DATE') }} DIM_LO_SAP_ACCT_PER_DATE
                ON DIM_LO_SAP_LINE_ITEM.ACCT_PER_DATE = DIM_LO_SAP_ACCT_PER_DATE.DATE
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_ACTVY_PER_DATE') }} DIM_LO_SAP_ACTVY_PER_DATE
                ON DIM_LO_SAP_LINE_ITEM.ACTVY_PER_DATE = DIM_LO_SAP_ACTVY_PER_DATE.DATE
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_DEST_ORGANIZATION') }} DIM_LO_SAP_DEST_ORGANIZATION
                ON ODS_SAP_ACDOCA.RBUKRS = DIM_LO_SAP_DEST_ORGANIZATION.ORG_ID
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_GL_ACCOUNT') }} DIM_LO_SAP_GL_ACCOUNT
                ON LTRIM(ODS_SAP_ACDOCA.RACCT,'0') = DIM_LO_SAP_GL_ACCOUNT.ACCOUNT
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_GROSS_NET') }} DIM_LO_SAP_GROSS_NET
                ON ODS_SAP_ACDOCA.GROSS_OR_NET_CODE = DIM_LO_SAP_GROSS_NET.GROSS_OR_NET_CODE
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_INVOICE') }} DIM_LO_SAP_INVOICE
                ON ODS_SAP_ACDOCA.RLDNR||ODS_SAP_ACDOCA.RBUKRS||TO_CHAR(ODS_SAP_ACDOCA.GJAHR)||ODS_SAP_ACDOCA.BELNR = DIM_LO_SAP_INVOICE.INVOICE_ID
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_AFE') }} DIM_LO_SAP_AFE
                ON CASE -- Order WBS 		WHEN NULLIF(TRIM(LTRIM(ODS_SAP_ACDOCA.AUFNR,'0'),' '),'') IS NOT NULL THEN 			DIM_LO_SAP_LINE_ITEM.ORDER_AFE_NUM 		-- LI WBS 		ELSE DIM_LO_SAP_LINE_ITEM.AFE_NUM 	END = DIM_LO_SAP_AFE.AFE_NUM LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_AFE_TYPE') }} DIM_LO_SAP_AFE_TYPE   ON DIM_LO_SAP_AFE.DIM_AFE_TYPE_KEY = DIM_LO_SAP_AFE_TYPE.DIM_AFE_TYPE_KEY LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_ORDER') }} DIM_LO_SAP_ORDER   ON LTRIM(ODS_SAP_ACDOCA.AUFNR,'0') = DIM_LO_SAP_ORDER.ORDER_NUM LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_COST_CENTER') }} DIM_LO_SAP_COST_CENTER   ON CASE              -- Order 		WHEN NULLIF(TRIM(LTRIM(ODS_SAP_ACDOCA.AUFNR,'0'),' '),'') IS NOT NULL THEN 			COALESCE(DIM_LO_SAP_LINE_ITEM.ORDER_CC_NUM 					,DIM_LO_SAP_LINE_ITEM.ORDER_REQ_CC_NUM 					,DIM_LO_SAP_LINE_ITEM.ORDER_RESP_CC_NUM 					,DIM_LO_SAP_LINE_ITEM.ORDER_AFE_CC_NUM)  		-- Non-Capital WBS 		WHEN NVL(DIM_LO_SAP_AFE_TYPE.NON_CAPITAL_FLAG,'Y') = 'Y' THEN 			COALESCE(DIM_LO_SAP_LINE_ITEM.CC_NUM 					,DIM_LO_SAP_LINE_ITEM.AFE_CC_NUM)
        name: STAGE_FIN_SAP_ACTUALS
        noLinkRefs: []
  name: STAGE_FIN_SAP_ACTUALS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
