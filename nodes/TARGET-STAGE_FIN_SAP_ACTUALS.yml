fileVersion: 1
id: 81800469-6489-4f7d-a6b2-cd8109625655
name: STAGE_FIN_SAP_ACTUALS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c8efb8a-12d6-41f9-93ce-770f17e6a74c
          stepCounter: 81800469-6489-4f7d-a6b2-cd8109625655
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEDGER_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a95e2d1c-75ca-40be-9561-3a563b611557
                stepCounter: e8524c23-d9e0-4d83-86ae-428803327912
            transform: NVL(DIM_LO_SAP_LEDGER.DIM_LEDGER_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f17ae12-aaee-43ac-8931-82f9921767ed
          stepCounter: 81800469-6489-4f7d-a6b2-cd8109625655
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACTVY_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5e7d210-78fe-4ce0-90cc-1b081cdc0b0b
                stepCounter: 2dd43a82-d1cd-4faa-9896-f735a52c38e7
            transform: nvl(DIM_LO_SAP_ACTVY_PER_DATE.DIM_ACTVY_PER_DATE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b5741c1-9a10-459c-a6a0-6720342d8b85
          stepCounter: 81800469-6489-4f7d-a6b2-cd8109625655
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACCT_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 25381cf9-3703-41d6-b9ba-0b0525bb8912
                stepCounter: 16046caa-0e21-4501-abd9-fc6a817b0803
            transform: nvl(DIM_LO_SAP_ACCT_PER_DATE.DIM_ACCT_PER_DATE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c865cd9-deb6-4cca-b941-4e8c25dd55d2
          stepCounter: 81800469-6489-4f7d-a6b2-cd8109625655
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LINE_ITEM_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3d13f59a-c3fc-40c8-89e4-d190a2994529
                stepCounter: 6d556ec5-1a14-4fec-b7c2-d8beb2ab5abd
            transform: nvl(DIM_LO_SAP_LINE_ITEM.DIM_LINE_ITEM_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8eb5e77e-0e3a-469e-b4a1-a18ae1489c81
          stepCounter: 81800469-6489-4f7d-a6b2-cd8109625655
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_VOUCHER_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 69e12839-0672-4feb-96e1-91e1a39e3579
                stepCounter: d3f1c808-ea3c-40a0-a26f-56aac63a6b65
            transform: nvl(DIM_LO_SAP_VOUCHER.DIM_VOUCHER_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88a75b0a-7f26-4fee-ba8b-beb529f6bdbf
          stepCounter: 81800469-6489-4f7d-a6b2-cd8109625655
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_COST_CENTER_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b116dc36-a893-4aee-bac6-660b69b80fe7
                stepCounter: f601baef-839f-49ab-b102-ee3fad93f21c
            transform: nvl(DIM_LO_SAP_COST_CENTER.DIM_COST_CENTER_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ab23eae-8666-40e4-814e-3f7f78a0df4d
          stepCounter: 81800469-6489-4f7d-a6b2-cd8109625655
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e0b83b1-8da0-4bfb-9cb2-0c8415bc1684
                stepCounter: d581a60e-c37c-4e7b-a259-5faf3ac3ff93
            transform: nvl(DIM_LO_SAP_AFE.DIM_AFE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4733d7e-3de4-4e3c-9f25-1deeb5ea51e6
          stepCounter: 81800469-6489-4f7d-a6b2-cd8109625655
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a431731-7890-4611-9bf0-533c6bd5b624
                stepCounter: f93a8e45-7804-49aa-b6a3-966e768997dc
            transform: nvl(DIM_LO_SAP_AFE_TYPE.DIM_AFE_TYPE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b2c6295f-0074-455f-889f-53513173dc76
          stepCounter: 81800469-6489-4f7d-a6b2-cd8109625655
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_INVOICE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d4668be-8f11-42a8-bb57-24471a8c95a3
                stepCounter: da942990-f8c6-4b3b-8228-c0b3b421d97c
            transform: nvl(DIM_LO_SAP_INVOICE.DIM_INVOICE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8991e4d8-82c1-43a7-8956-693b58e51f0d
          stepCounter: 81800469-6489-4f7d-a6b2-cd8109625655
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_ORDER_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4f91b61b-63b7-4b80-a339-24a4685774b0
                stepCounter: 1c137071-2a40-4dd6-8c0d-7b478d9fec1f
            transform: nvl(DIM_LO_SAP_ORDER.DIM_ORDER_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e674f142-6321-472a-83e1-8ebe7da0b3c6
          stepCounter: 81800469-6489-4f7d-a6b2-cd8109625655
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_DEST_ORGANIZATION_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a0d7283d-e92d-4ee0-8225-07d405212e15
                stepCounter: c39a02ca-a012-4752-ac49-7f679c9ff6e4
            transform: nvl(DIM_LO_SAP_DEST_ORGANIZATION.DIM_DEST_ORGANIZATION_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 433e3ce2-89ae-4778-810a-4ebb35e6d8b3
          stepCounter: 81800469-6489-4f7d-a6b2-cd8109625655
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GL_ACCOUNT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 81b0e0b7-59c3-4d21-a951-f953739615a8
                stepCounter: 435a18b2-1dc7-4fc8-b5d0-3eab3af614fd
            transform: nvl(DIM_LO_SAP_GL_ACCOUNT.DIM_GL_ACCOUNT_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ba091d6-965c-45d9-814a-64297be4369f
          stepCounter: 81800469-6489-4f7d-a6b2-cd8109625655
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GROSS_NET_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eb169a24-d282-43b6-ade8-2177eeff938e
                stepCounter: 38bc0451-df93-413f-b149-93d0fd46c572
            transform: nvl(DIM_LO_SAP_GROSS_NET.DIM_GROSS_NET_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 613fc05b-62c3-4091-8de9-5d453d0a6c47
          stepCounter: 81800469-6489-4f7d-a6b2-cd8109625655
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_PRODUCT_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b67eb7a6-721a-4634-97dc-8549a0d1c04a
                stepCounter: af796a63-3184-4858-86cc-362cb792e537
            transform: nvl(DIM_LO_SAP_PRODUCT_TYPE.DIM_PRODUCT_TYPE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3bf28b7-a490-4391-9d0f-137a755f5703
          stepCounter: 81800469-6489-4f7d-a6b2-cd8109625655
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: DIM_ACTVY_PER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f6b66f2-3123-427b-b8f2-02216e1ca051
                stepCounter: 2dd43a82-d1cd-4faa-9896-f735a52c38e7
            transform: nvl(DIM_LO_SAP_ACTVY_PER_DATE.DATE,(SELECT DISTINCT DATE FROM {{ ref('TARGET','DIM_LO_SAP_ACTVY_PER_DATE') }} WHERE DIM_ACTVY_PER_DATE_KEY = 0))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40c24ddb-e58b-4024-96a6-15e1ef1347db
          stepCounter: 81800469-6489-4f7d-a6b2-cd8109625655
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: DIM_ACCT_PER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 45fe8510-7013-4779-ad36-b2fca6a58b30
                stepCounter: 16046caa-0e21-4501-abd9-fc6a817b0803
            transform: nvl(DIM_LO_SAP_ACCT_PER_DATE.DATE,(SELECT DISTINCT DATE FROM {{ ref('TARGET','DIM_LO_SAP_ACCT_PER_DATE') }} WHERE DIM_ACCT_PER_DATE_KEY = 0))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed02ef2c-f321-443d-9018-a975c6312690
          stepCounter: 81800469-6489-4f7d-a6b2-cd8109625655
        config: {}
        dataType: VARCHAR(38)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: LI_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc871783-9afd-4af5-8882-c179ca221817
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: ODS_SAP_ACDOCA.RLDNR|| ODS_SAP_ACDOCA.RBUKRS|| TO_CHAR(ODS_SAP_ACDOCA.GJAHR)|| ODS_SAP_ACDOCA.BELNR|| ODS_SAP_ACDOCA.DOCLN
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb40265a-78c6-4106-833e-ef77d3c5ae5a
          stepCounter: 81800469-6489-4f7d-a6b2-cd8109625655
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: GLOP_LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2fd97d52-2ad7-4c88-ab60-95c5229a9aff
                stepCounter: 6d556ec5-1a14-4fec-b7c2-d8beb2ab5abd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09b1c921-c1f5-4ab8-ad02-8e4c18087665
          stepCounter: 81800469-6489-4f7d-a6b2-cd8109625655
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: GLOP_AMT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb502f0b-51ee-4921-9832-b1e05667ab62
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d654e318-308a-40c3-aba9-277d3c78a165
          stepCounter: 81800469-6489-4f7d-a6b2-cd8109625655
        config: {}
        dataType: NUMBER(26,5)
        defaultValue: ""
        description: ""
        name: GLOP_EXCHANGE_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94ae11b1-7718-49b1-931e-eb5f03960c63
                stepCounter: fcf862a8-1642-409e-b4fd-c9257fbc2f70
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b82ef079-0869-491c-985b-bb8a8a5db197
          stepCounter: 81800469-6489-4f7d-a6b2-cd8109625655
        config: {}
        dataType: NUMBER(23,2)
        defaultValue: ""
        description: ""
        name: OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ffdb7be0-4b33-48e6-b619-70fb4c0430b2
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8bbd050-9602-4c01-8d48-3f11fb111fc9
          stepCounter: 81800469-6489-4f7d-a6b2-cd8109625655
        config: {}
        dataType: NUMBER(23,2)
        defaultValue: ""
        description: Gross Line Item Net Op Amount
        name: NET_OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 01ddb8c6-77b5-4108-9d7c-14efff7c61ce
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 660307d0-55ac-44a5-aebb-bb813a001584
          stepCounter: 81800469-6489-4f7d-a6b2-cd8109625655
        config: {}
        dataType: NUMBER(23,2)
        defaultValue: ""
        description: ""
        name: VCHR_CURR_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 084c673f-ddbe-4b4f-bc06-00ea9b8aa9ef
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a131f36e-9706-48ee-8ffa-8cd7c396baba
          stepCounter: 81800469-6489-4f7d-a6b2-cd8109625655
        config: {}
        dataType: NUMBER(23,2)
        defaultValue: ""
        description: ""
        name: CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 986216fb-ace1-4802-bc57-c57b0d2907fb
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 972ac049-6c41-49ad-8dc3-edb76038017a
          stepCounter: 81800469-6489-4f7d-a6b2-cd8109625655
        config: {}
        dataType: NUMBER(23,2)
        defaultValue: ""
        description: The CAD equivalent for GLOP transactions. This is only applicable to the Lease Ops model and should not be used for other reports
        name: GLOP_CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 986216fb-ace1-4802-bc57-c57b0d2907fb
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8149ac7a-1bd0-4e98-8a3e-1cfcf1f1be51
          stepCounter: 81800469-6489-4f7d-a6b2-cd8109625655
        config: {}
        dataType: NUMBER(23,2)
        defaultValue: ""
        description: ""
        name: LI_VOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ada2acac-7d96-4fb4-aeb6-49c13fc01c47
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ffe99d9-bd6d-4874-b2d4-4440d29ff28b
          stepCounter: 81800469-6489-4f7d-a6b2-cd8109625655
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: ""
        name: LI_VOL_UOM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc737bdd-4300-45be-893b-6659b85f8f43
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: SUBSTR(ODS_SAP_ACDOCA.RUNIT,1,3)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6204e2d4-8ba6-4b6c-b093-3aa92ad88265
          stepCounter: 81800469-6489-4f7d-a6b2-cd8109625655
        config: {}
        dataType: NUMBER(23,2)
        defaultValue: ""
        description: Line item Volume in BOE (Barrel of Oil Equivalent)
        name: LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a68309e1-7247-4eab-96e9-57e8f672bbee
                stepCounter: 1403c7f4-03b4-4310-a62b-39ecaecfc517
            transform: ODS_SAP_ACDOCA.MSL * LOAD_VET_FIN_SAP_CONVERSION.LI_TO_BOE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f3c40a33-6ae3-44fd-8546-44dd7189e3ab
          stepCounter: 81800469-6489-4f7d-a6b2-cd8109625655
        config: {}
        dataType: NUMBER(23,2)
        defaultValue: ""
        description: Line item Volume in cubic meters (m3)
        name: LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bcd1e20e-b101-4cb8-8889-1c01c3354da3
                stepCounter: 1403c7f4-03b4-4310-a62b-39ecaecfc517
            transform: ODS_SAP_ACDOCA.MSL * LOAD_VET_FIN_SAP_CONVERSION.LI_TO_GLOP_METRIC
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c23f06a2-4bb8-4e56-bbee-1842f9dfc7dc
          stepCounter: 81800469-6489-4f7d-a6b2-cd8109625655
        config: {}
        dataType: NUMBER(23,2)
        defaultValue: ""
        description: Line item Volume in Normalized Cubic Meters (m3)
        name: LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bcd1e20e-b101-4cb8-8889-1c01c3354da3
                stepCounter: 1403c7f4-03b4-4310-a62b-39ecaecfc517
            transform: ODS_SAP_ACDOCA.MSL * LOAD_VET_FIN_SAP_CONVERSION.LI_TO_GLOP_METRIC
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d422061-bdaf-443f-93d1-6f3c767fc6e4
          stepCounter: 81800469-6489-4f7d-a6b2-cd8109625655
        config: {}
        dataType: NUMBER(23,2)
        defaultValue: ""
        description: Line item Volume in imperial measurement
        name: LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8753fefb-04df-43cd-b5dd-956ed6482a5a
                stepCounter: 1403c7f4-03b4-4310-a62b-39ecaecfc517
            transform: ODS_SAP_ACDOCA.MSL * LOAD_VET_FIN_SAP_CONVERSION.LI_TO_GLOP_IMP
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c765b67b-2823-40a8-aeb5-e2b7fab2290f
          stepCounter: 81800469-6489-4f7d-a6b2-cd8109625655
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e6b1511-2670-4d20-ab37-d0ebf1d413a2
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f57abff-1f52-4368-9b30-1b3a5dd06eae
          stepCounter: 81800469-6489-4f7d-a6b2-cd8109625655
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Indicates amounts are gross or net.
        name: GROSS_OR_NET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92e0f707-0816-4af3-901c-21261e848ad5
          stepCounter: 81800469-6489-4f7d-a6b2-cd8109625655
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: EDW Business Unit Role controlling RLS access
        name: BU_SF_ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 93ae425d-c55d-4e37-805b-d6ffd4925922
                stepCounter: c7311ad4-0c9e-41d7-8970-047b5393cebd
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ODS_SAP_ACDOCA: 0f008214-d701-47dc-8dec-ed7f400b3d52
          ODS_SAP_BKPF: fcf862a8-1642-409e-b4fd-c9257fbc2f70
          DIM_LO_SAP_LEDGER: e8524c23-d9e0-4d83-86ae-428803327912
          DIM_LO_SAP_LINE_ITEM: 6d556ec5-1a14-4fec-b7c2-d8beb2ab5abd
          DIM_LO_SAP_VOUCHER: d3f1c808-ea3c-40a0-a26f-56aac63a6b65
          DIM_LO_SAP_ACCT_PER_DATE: 16046caa-0e21-4501-abd9-fc6a817b0803
          DIM_LO_SAP_ACTVY_PER_DATE: 2dd43a82-d1cd-4faa-9896-f735a52c38e7
          DIM_LO_SAP_DEST_ORGANIZATION: c39a02ca-a012-4752-ac49-7f679c9ff6e4
          DIM_LO_SAP_GL_ACCOUNT: 435a18b2-1dc7-4fc8-b5d0-3eab3af614fd
          DIM_LO_SAP_GROSS_NET: 38bc0451-df93-413f-b149-93d0fd46c572
          DIM_LO_SAP_INVOICE: da942990-f8c6-4b3b-8228-c0b3b421d97c
          DIM_LO_SAP_AFE: d581a60e-c37c-4e7b-a259-5faf3ac3ff93
          DIM_LO_SAP_AFE_TYPE: f93a8e45-7804-49aa-b6a3-966e768997dc
          DIM_LO_SAP_ORDER: 1c137071-2a40-4dd6-8c0d-7b478d9fec1f
          DIM_LO_SAP_COST_CENTER: f601baef-839f-49ab-b102-ee3fad93f21c
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEDGER
          - locationName: TARGET
            nodeName: ODS_SAP_ACDOCA
          - locationName: TARGET
            nodeName: ODS_SAP_BKPF
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LINE_ITEM
          - locationName: TARGET
            nodeName: DIM_LO_SAP_VOUCHER
          - locationName: TARGET
            nodeName: DIM_LO_SAP_ACCT_PER_DATE
          - locationName: TARGET
            nodeName: DIM_LO_SAP_ACTVY_PER_DATE
          - locationName: TARGET
            nodeName: DIM_LO_SAP_DEST_ORGANIZATION
          - locationName: TARGET
            nodeName: DIM_LO_SAP_GL_ACCOUNT
          - locationName: TARGET
            nodeName: DIM_LO_SAP_GROSS_NET
          - locationName: TARGET
            nodeName: DIM_LO_SAP_INVOICE
          - locationName: TARGET
            nodeName: DIM_LO_SAP_AFE
          - locationName: TARGET
            nodeName: DIM_LO_SAP_AFE_TYPE
          - locationName: TARGET
            nodeName: DIM_LO_SAP_ORDER
          - locationName: TARGET
            nodeName: DIM_LO_SAP_COST_CENTER
        join:
          joinCondition: |-
            EXTENDED
              FROM (
                    SELECT RLDNR,
                           RBUKRS,
                           GJAHR,
                           BELNR,
                           DOCLN ,
                           RHCUR,
                           RUNIT,
                           PS_PSP_PNR ,
                           RCNTR,
                           RACCT,
                           RECID,
                           AUFNR ,
                           SUM(HSL) HSL ,
                           SUM(TSL) TSL ,
                           SUM(KSL) KSL ,
                           SUM(MSL) MSL ,
                           SUM(FCSL) FCSL ,
                           'N' AS GROSS_OR_NET_CODE
                      FROM {{ ref('TARGET','ODS_SAP_ACDOCA') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                     GROUP BY RLDNR,
                              RBUKRS,
                              GJAHR,
                              BELNR,
                              DOCLN ,
                              RHCUR,
                              RUNIT,
                              PS_PSP_PNR ,
                              RCNTR,
                              RACCT,
                              RECID,
                              AUFNR
                     UNION SELECT RLDNR,
                           RBUKRS,
                           GJAHR,
                           BELNR,
                           DOCLN ,
                           RHCUR,
                           RUNIT,
                           PS_PSP_PNR ,
                           RCNTR,
                           RACCT,
                           RECID,
                           AUFNR ,
                           SUM(HSL) HSL ,
                           SUM(TSL) TSL ,
                           SUM(KSL) KSL ,
                           SUM(MSL) MSL ,
                           SUM(FCSL) FCSL ,
                           'G' AS GROSS_OR_NET_CODE
                      FROM {{ ref('TARGET','ODS_SAP_ACDOCA') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                       AND RECID NOT IN ('CB','ZA','ZB','ZY')
                     GROUP BY RLDNR,
                              RBUKRS,
                              GJAHR,
                              BELNR,
                              DOCLN ,
                              RHCUR,
                              RUNIT,
                              PS_PSP_PNR ,
                              RCNTR,
                              RACCT,
                              RECID,
                              AUFNR
                   ) ODS_SAP_ACDOCA
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_BKPF') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) ODS_SAP_BKPF
                ON ODS_SAP_BKPF.BELNR = ODS_SAP_ACDOCA.BELNR
               AND ODS_SAP_BKPF.GJAHR = ODS_SAP_ACDOCA.GJAHR
               AND ODS_SAP_BKPF.BUKRS = ODS_SAP_ACDOCA.RBUKRS
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_LEDGER') }} DIM_LO_SAP_LEDGER
                ON ODS_SAP_ACDOCA.RLDNR = DIM_LO_SAP_LEDGER.LEDGER_CODE
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_LINE_ITEM') }} DIM_LO_SAP_LINE_ITEM
                ON ODS_SAP_ACDOCA.RLDNR||ODS_SAP_ACDOCA.RBUKRS||TO_CHAR(ODS_SAP_ACDOCA.GJAHR)||ODS_SAP_ACDOCA.BELNR||ODS_SAP_ACDOCA.DOCLN = DIM_LO_SAP_LINE_ITEM.LI_ID
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_VOUCHER') }} DIM_LO_SAP_VOUCHER
                ON ODS_SAP_ACDOCA.RLDNR||ODS_SAP_ACDOCA.RBUKRS||TO_CHAR(ODS_SAP_ACDOCA.GJAHR)||ODS_SAP_ACDOCA.BELNR = DIM_LO_SAP_VOUCHER.VOUCHER_ID
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_ACCT_PER_DATE') }} DIM_LO_SAP_ACCT_PER_DATE
                ON DIM_LO_SAP_LINE_ITEM.ACCT_PER_DATE = DIM_LO_SAP_ACCT_PER_DATE.DATE
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_ACTVY_PER_DATE') }} DIM_LO_SAP_ACTVY_PER_DATE
                ON DIM_LO_SAP_LINE_ITEM.ACTVY_PER_DATE = DIM_LO_SAP_ACTVY_PER_DATE.DATE
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_DEST_ORGANIZATION') }} DIM_LO_SAP_DEST_ORGANIZATION
                ON ODS_SAP_ACDOCA.RBUKRS = DIM_LO_SAP_DEST_ORGANIZATION.ORG_ID
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_GL_ACCOUNT') }} DIM_LO_SAP_GL_ACCOUNT
                ON LTRIM(ODS_SAP_ACDOCA.RACCT,'0') = DIM_LO_SAP_GL_ACCOUNT.ACCOUNT
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_GROSS_NET') }} DIM_LO_SAP_GROSS_NET
                ON ODS_SAP_ACDOCA.GROSS_OR_NET_CODE = DIM_LO_SAP_GROSS_NET.GROSS_OR_NET_CODE
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_INVOICE') }} DIM_LO_SAP_INVOICE
                ON ODS_SAP_ACDOCA.RLDNR||ODS_SAP_ACDOCA.RBUKRS||TO_CHAR(ODS_SAP_ACDOCA.GJAHR)||ODS_SAP_ACDOCA.BELNR = DIM_LO_SAP_INVOICE.INVOICE_ID
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_AFE') }} DIM_LO_SAP_AFE
                ON CASE -- Order WBS 		WHEN NULLIF(TRIM(LTRIM(ODS_SAP_ACDOCA.AUFNR,'0'),' '),'') IS NOT NULL THEN 			DIM_LO_SAP_LINE_ITEM.ORDER_AFE_NUM 		-- LI WBS 		ELSE DIM_LO_SAP_LINE_ITEM.AFE_NUM 	END = DIM_LO_SAP_AFE.AFE_NUM LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_AFE_TYPE') }} DIM_LO_SAP_AFE_TYPE   ON DIM_LO_SAP_AFE.DIM_AFE_TYPE_KEY = DIM_LO_SAP_AFE_TYPE.DIM_AFE_TYPE_KEY LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_ORDER') }} DIM_LO_SAP_ORDER   ON LTRIM(ODS_SAP_ACDOCA.AUFNR,'0') = DIM_LO_SAP_ORDER.ORDER_NUM LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_COST_CENTER') }} DIM_LO_SAP_COST_CENTER   ON CASE              -- Order 		WHEN NULLIF(TRIM(LTRIM(ODS_SAP_ACDOCA.AUFNR,'0'),' '),'') IS NOT NULL THEN 			COALESCE(DIM_LO_SAP_LINE_ITEM.ORDER_CC_NUM 					,DIM_LO_SAP_LINE_ITEM.ORDER_REQ_CC_NUM 					,DIM_LO_SAP_LINE_ITEM.ORDER_RESP_CC_NUM 					,DIM_LO_SAP_LINE_ITEM.ORDER_AFE_CC_NUM)  		-- Non-Capital WBS 		WHEN NVL(DIM_LO_SAP_AFE_TYPE.NON_CAPITAL_FLAG,'Y') = 'Y' THEN 			COALESCE(DIM_LO_SAP_LINE_ITEM.CC_NUM 					,DIM_LO_SAP_LINE_ITEM.AFE_CC_NUM)
        name: STAGE_FIN_SAP_ACTUALS
        noLinkRefs: []
  name: STAGE_FIN_SAP_ACTUALS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
