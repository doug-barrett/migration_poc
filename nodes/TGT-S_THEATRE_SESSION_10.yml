fileVersion: 1
id: 37218e3d-4048-4cde-a233-bc277433139f
name: S_THEATRE_SESSION_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 252b93d0-f80e-426e-ad7b-233aa64feab7
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: THEATRE_SESSION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c117a913-5e0f-491d-8212-360f03791d95
                stepCounter: f407f61b-a488-45b0-8d11-48c1ce331269
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8419169-faaf-4496-9e2a-88dcae16c4bc
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: THEATRE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b8be81a5-a247-401b-aae2-442666d8a7a4
                stepCounter: 50d37543-6dd1-4ea0-bfe9-dc03dfc2dacc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5309a13b-7f5f-417a-ae60-11a2f10c9721
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Service_Point_Code
        name: SURGICAL_THEATRE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2dccb124-9f78-45c2-8f2b-d6cbb85e06e7
                stepCounter: 50d37543-6dd1-4ea0-bfe9-dc03dfc2dacc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7e5560a-b9c6-4262-bf45-bb990ea9dd24
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8a0cc70-96f5-4324-8b79-c7a34c24d7b2
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dddaff70-ba3a-49bd-a246-df19956e9b37
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SURGEON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d006aef-216d-4a18-9910-4afe86d742d9
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e1b3b6a-30c8-417f-9afc-1d78ffb38b02
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: HEALTH_ORGANISATION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb87680b-afb7-4430-89ad-a863bd3d0257
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7df2a16c-807e-45c6-8b7c-c5a8d4088260
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAFF_TEAM_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 99cebdcb-9562-4876-94c8-d61513187a37
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1d1ea67-34a4-4b4b-84ac-beccb9aee3ff
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SESSION_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7f5ad10-4dfd-412b-a55b-d390c000dd0e
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4395bbe5-6d6a-48f7-bf19-74efa66781e8
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SESSION_END_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd6c4549-7991-4dd2-ab40-af39e3a4c06a
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ef03e74-f591-4d06-9765-ab5a6db4ace8
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SESSION_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 610c6ecd-7bf3-4ba6-a5cd-0d1fc2ee7bae
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc5f051e-0cc2-4024-bbac-554489ce3a1e
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SESSION_CANCELLED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c351b7c-7cad-481b-a7cd-27a86d729e26
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45f1343c-7113-4ee6-a5b8-04c4ba897e7c
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c393f1c-4562-49c4-a9d0-5889aaa5021f
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b3a4806-31dc-46ac-b9fb-f1f3a7544f70
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e375c49a-5f37-4059-ae8f-465a05b2b38c
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be3c687c-4fe3-4c20-ab7a-df67436f9e42
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: SESSION_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f5bac63a-463c-4966-b7f5-7eae3a4e92b1
                stepCounter: c162f447-4367-47b0-93c5-31704ed2b3c6
            transform: |-
              CASE WHEN dim_session_status.session_status_code IN ('SESOH','SESCN')--('Session on Hold','Session Cancelled')
               THEN 'C'
                          ELSE CASE WHEN ds_session_05.start_date > convert(datetime,@v_ca_date,120) THEN 'P' ELSE 'A' END
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b2f8699e-5e6a-4e36-874e-0e3fc1415af8
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_CHANGE_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9cc9850-5950-4634-bf08-d6472441d233
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e4a7e9f-d5ce-467c-8f92-eea27da315b3
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CLINIC_PURPOSE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 35dd62dd-3127-473b-8141-064c4a844dbf
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec8337a2-f568-4821-87b3-83cff7f9f4cf
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CLINIC_FREQUENCY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 93ac740f-4fd8-4db4-8307-9cc8fdd244cf
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bff1414f-c410-4936-8add-d67339fc4c58
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CLINIC_FREQUENCY_OFFSET_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1609e09f-72b8-43d4-bf0a-4dde7ec92bc2
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f3268a85-e2ae-4498-a9c2-b3d20bc17331
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_FREQUENCY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f5175c2-f177-4a41-acb8-09ab98d9e56b
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 37a83818-63ab-44da-88c1-31485d3d06b2
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_FREQUENCY_OFFSET_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e96d8dbe-8823-4a19-a3c5-b56c087e0271
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6f367c6-1d40-43af-887b-f4680d2fb18f
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_CHANGE_REQUEST_BY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db583fc1-9894-430f-92c1-2aa9c39827cd
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 559c443c-9d52-49ba-90dc-8b0a6356b01a
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_LATE_START_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ae3ab32-6ac8-4fbd-9fac-872ef21f5192
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0eb20773-fb23-487e-9bea-fb642e738e0f
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_theatre_session_10.session_late_start_reason_reference_no=dim_consolidate_session_delay.session_late_start_reason_reference_no
        name: DIM_CONSOLIDATE_SESSION_DELAY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ebd5530-9846-47d1-9e30-306a15df8a9a
                stepCounter: e169fe2b-3714-40d3-98e5-43e67d3b3491
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e988d5ee-5d3d-4779-bbcb-085e6234de66
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: SESSION_ANAESTHETIST_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4dd14a43-0549-44af-a369-0fcc329bf688
                stepCounter: 0b54428e-1fee-4f84-9918-32e73c82e055
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 709c44ec-eb67-4b66-bc0a-79998def0137
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_PRIMARY_SURGEON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59a4a8dd-b872-4f03-8825-8b61bbab7784
                stepCounter: 8add32ee-017a-4476-95b2-993059555600
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0db150d0-9442-4d41-86b7-20ebc395ecfe
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_PRIMARY_ANAESTHETIST_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 735ebc15-51b4-49c1-ab04-f71cfcaed2c1
                stepCounter: 8add32ee-017a-4476-95b2-993059555600
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b47280d7-eecc-4351-bae4-86c08eea9909
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: THEATRE_SESSION_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ceebc46-5485-44cb-b87e-4b3ba4e1d255
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c829d9a-86a1-47a9-986d-5037a9507811
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: THEATRE_SESSION_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd033c8c-027f-4431-a721-00a7fa6a15f6
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: LEFT(ds_session_05.appointment_desc,255)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38c9fd09-4a8c-4341-9a02-3ac3911c9e4c
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: THEATRE_SESSION_DAY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ceebc46-5485-44cb-b87e-4b3ba4e1d255
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: |-
              CASE WHEN appointment_code LIKE '%AD%' THEN 'All Day'
                          WHEN appointment_code LIKE '%AM%' THEN 'AM'
                          WHEN appointment_code LIKE '%PM%' THEN 'PM'
                          ELSE 'Not Specified'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47e3da47-05aa-4257-ab67-5c51124a566f
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: AM_LONG_DELAY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 43a533c7-f193-45fb-aedf-87bada42d1bf
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: GROUP_CLINIC_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e8460039-6d66-4b35-8767-0d6bf7a2b3a0
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9a42f0e-2ccf-44d8-b1c3-8ebdfabd9d18
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: EXCLUDE_HOLIDAYS_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 761a7771-0063-4483-b271-77a4fb93e3bd
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 73d6e146-3525-49c8-ba5b-5dcc744afc65
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: FINAL_SESSION_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c714cc4-a97f-4ba6-9fe6-266f891e51e8
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 63dda677-4d8e-4837-bb13-e4abb5d71eb2
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: TEMPLATE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 036c249a-0b9d-4db0-987f-172839edcb21
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af9d34a8-a6fb-434e-ae50-739c5f44b21c
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FIRST_THEATRE_VISIT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c98dbf4-e337-4bf2-9940-d9761330ff4e
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_BOOKED_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5744e47c-c112-4b61-898f-d0e549006797
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_PATIENT_READY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IFNULL(ds_theatre_visit_summary.first_patient_ready_date,ds_theatre_visit_summary.first_patient_into_theatre_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 045dc847-001c-45a7-99f6-6a89c0554097
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_PATIENT_INTO_THEATRE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b15915d4-1952-485d-a896-4abe6a3cf58c
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_PATIENT_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IFNULL(ds_theatre_visit_summary.first_patient_into_theatre_date,ds_theatre_visit_summary.first_booked_start_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e080314-13b5-4d8b-9ce2-1d7db4c787d1
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LAST_THEATRE_VISIT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b9428ac8-00f4-43d5-b6ff-2e8156927b14
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_PATIENT_OUT_OF_THEATRE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b0ba72b-68c0-4a32-8a79-a9a44433d176
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_PATIENT_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: COALESCE(ds_theatre_visit_summary.last_patient_into_postop_date,ds_theatre_visit_summary.last_patient_out_of_theatre_date,ds_theatre_visit_summary.last_booked_end_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d81c8918-f649-457e-81d0-634741c2ec0e
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_PATIENT_INTO_POSTOP_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d43cb44b-be01-4c1b-85e2-836145a170fa
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_BOOKED_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 00128c0b-5e6f-4a2f-9e61-7b58c1270a94
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CANCELLED_OPERATIONS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IFNULL(ds_theatre_visit_summary.cancelled_operations_num,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 19602af0-c262-425b-beb6-97e1fc506aa3
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_CLINICS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ceebc46-5485-44cb-b87e-4b3ba4e1d255
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: |-
              CASE WHEN appointment_code LIKE '%AD%'                                                                                                                          THEN 2
                          WHEN appointment_code LIKE '%AM%'                                                                                                                          THEN 1
                          WHEN appointment_code LIKE '%PM%'                                                                                                                          THEN 1
                          WHEN appointment_code NOT LIKE '%AD%' AND appointment_code NOT LIKE '%AM%' AND appointment_code NOT LIKE '%PM%' AND DATEDIFF(N,start_date,end_date) >= 270 THEN 2
                          WHEN appointment_code NOT LIKE '%AD%' AND appointment_code NOT LIKE '%AM%' AND appointment_code NOT LIKE '%PM%' AND DATEDIFF(N,start_date,end_date) <= 270 THEN 1
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9ebe9ba-af7d-48f2-a306-ec2b17ab2334
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACTUAL_OPERATIONS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IFNULL(ds_theatre_visit_summary.actual_operations_num,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a409bd7-6ad8-4e92-8a52-344900706d5d
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_ACTUAL_SLOTS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IFNULL(ds_session_05.session_duration_mins / ds_session_05.slot_duration_mins,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd118b4b-0a16-4990-8e52-e58b04456783
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_PLANNED_SLOTS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 17f9c2b3-c827-43e7-a3c0-417756b3b3ae
                stepCounter: 26e9d2a5-d387-4c66-b1ca-71c463e57593
            transform: IFNULL(s_service_point_time_slot.available_slots,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 645b99df-e421-42d6-be05-b8982f9f377d
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PLANNED_OPERATIONS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34cb1775-3b10-4e09-915d-3fb494f6a464
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_PLANNED_NEW_SLOTS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a96d0f23-a067-4d09-876e-7d918637ade9
                stepCounter: 26e9d2a5-d387-4c66-b1ca-71c463e57593
            transform: |-
              CASE WHEN IFNULL(s_service_point_time_slot.FUP_slots,0) > 0 THEN 0
                          ELSE IFNULL(s_service_point_time_slot.new_slots,0)
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2bfd7097-b9a6-4585-ac4c-10e047a0a42b
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LISTS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN DATEDIFF(mi,ds_session_05.start_date, ds_session_05.end_date) < 360 THEN 1.0
                          ELSE 2.0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7abe6cdc-8871-4669-866c-7dfd3dd9f8b8
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: VISIT_TOTAL_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IFNULL(ds_theatre_visit_summary.visit_total_duration,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc5b6e91-9459-46f2-99ac-3189f607e959
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_PLANNED_FUP_SLOTS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 80c3da51-adc9-4b9d-86d9-1e238be18034
                stepCounter: 26e9d2a5-d387-4c66-b1ca-71c463e57593
            transform: |-
              CASE WHEN IFNULL(s_service_point_time_slot.new_slots,0) > 0 THEN 0
                          ELSE IFNULL(s_service_point_time_slot.FUP_slots,0)
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de7f7dde-8998-4b05-ab8e-2f4f3c772094
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_PLANNED_MIXED_SLOTS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 17f9c2b3-c827-43e7-a3c0-417756b3b3ae
                stepCounter: 26e9d2a5-d387-4c66-b1ca-71c463e57593
            transform: |-
              CASE WHEN IFNULL(s_service_point_time_slot.new_slots,0) + IFNULL(s_service_point_time_slot.fup_slots,0) > 1 OR (IFNULL(s_service_point_time_slot.new_slots,0) = 0 AND IFNULL(s_service_point_time_slot.fup_slots,0) = 0) THEN IFNULL(s_service_point_time_slot.available_slots,0)
                          ELSE 0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 740f66a9-8a54-427d-92f9-ac3799a0c213
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: IN_THEATRE_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IFNULL(ds_theatre_visit_summary.in_theatre_duration,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4412b2aa-8b6f-42e8-9fe5-5fd6907b4c43
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ANAESTHETIC_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IFNULL(ds_theatre_visit_summary.anaesthetic_duration,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f4a6c6b6-3b73-4d25-8948-6bb02b6d0b6f
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: KNIFE_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IFNULL(ds_theatre_visit_summary.knife_duration,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 079342fc-5e3e-4b7d-ae04-cf06c0932b51
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: AVERAGE_TURNAROUND_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IFNULL(ABS(ds_theatre_visit_summary.average_turnaround_duration),0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03b2525f-fb4a-404c-83b5-945aed9bdad7
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: surgeon_duration
        name: SURGEON_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d945e46a-e60c-46ab-a8ed-35352c2facf9
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: DECIMAL(10,2)
        defaultValue: ""
        description: ""
        name: THEATRE_SESSION_UTILISATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE WHEN IFNULL(DATEDIFF(mi,ds_session_05.start_date,ds_session_05.end_date),0) > 0 THEN (DATEDIFF(mi,CASE WHEN ds_theatre_visit_summary.first_patient_ready_date < ds_session_05.start_date THEN ds_session_05.start_date ELSE ds_theatre_visit_summary.first_patient_ready_date END, CASE WHEN ds_theatre_visit_summary.last_patient_out_of_theatre_date > ds_session_05.end_date THEN ds_session_05.end_date ELSE ds_theatre_visit_summary.last_patient_out_of_theatre_date END) * 100) / DATEDIFF(mi,ds_session_05.start_date,ds_session_05.end_date)
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98f92200-e407-41a7-a1c9-e13e5377a21a
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: DECIMAL(10,2)
        defaultValue: ""
        description: ""
        name: DAP_UTILISATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE WHEN IFNULL(DATEDIFF(mi,ds_session_05.start_date,ds_session_05.end_date),0) > 0 THEN (DATEDIFF(mi,IFNULL(ds_theatre_visit_summary.first_patient_ready_date,ds_theatre_visit_summary.first_patient_into_theatre_date), IFNULL(ds_theatre_visit_summary.last_patient_out_of_theatre_date,ds_theatre_visit_summary.last_patient_into_postop_date)) * 100) / DATEDIFF(mi,ds_session_05.start_date,ds_session_05.end_date)
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6146615-00ef-4fb7-b3c8-bf294236e71c
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: IP_OPERATIONS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5bacee09-c88a-45d8-8b92-bab20d331837
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: duration UOM
        name: DURATION_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'minute'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f5759d5-fe28-431a-a3ca-df965ea9fd72
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_SLOT_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0da425b2-b819-4ef8-9d37-91cbd1e44952
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e4b5be28-caf1-4445-8141-b27a5a13c0c8
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f3e4d6b5-7733-439d-b8c7-fc0fbb9bd521
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: IFNULL(ds_session_05.session_duration_mins,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 542e2a8c-90cc-4168-98d3-9bc0a495dc40
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_DURATION_CALC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 610c6ecd-7bf3-4ba6-a5cd-0d1fc2ee7bae
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: IFNULL(DATEDIFF(mi,ds_session_05.start_date,ds_session_05.end_date),0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1ad8668-cc41-411d-a368-9d16dba7eb75
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_WIES
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d791a236-4137-4787-85d9-b1acf6d303ce
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_WIES_THEATRE_COMPONENT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa5f8309-9a04-4b7b-8e3f-1ef808c90f3f
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: ""
        name: STANDARD_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5ea219b-d4ac-46a1-a560-da34ecfd0cc4
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: ""
        name: ACTUAL_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6bd98c7-2b2b-4249-900e-f830b57220af
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: THEATRE_USAGE_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 252b85d7-1e65-450a-ae6c-07a4527e4679
                stepCounter: 0800cfbd-02fc-4bd7-a656-513d65577485
            transform: |-
              --ROW_NUMBER() OVER (PARTITION BY ds_session_05.service_point_reference_no
               -- ORDER BY ds_session_05.start_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c99da3fa-c8eb-4d83-a1f5-41b7afd0037f
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: THEATRE_USAGE_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e6fc5f76-2fd8-42d8-b40e-c5cd6315dd69
                stepCounter: 0800cfbd-02fc-4bd7-a656-513d65577485
            transform: --COUNT(1) OVER (PARTITION BY ds_session_05.service_point_reference_no)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d13f3253-64bc-48a4-8042-7a58f450237e
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: THEATRE_SESSION_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '1'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 12e8cffb-71bc-4eaf-af2a-3654ad19c059
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1efb711f-49d9-400d-bbbd-07d5d5c3b605
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7847f335-252a-4f36-a923-b60d2eec1a3d
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: INSTRUCTIONS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2e098447-0b83-4139-822f-81be2cf5c01e
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f60fefdf-1ffa-47d1-b02d-4aa2e65e518b
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78dbb840-d1d2-4edf-b95b-afb931fed1e4
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 126f0c6d-6337-4b60-9641-bc0a7de885d5
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 97218b98-01b9-4ab1-b1d7-61cb38773a79
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4cd1e796-c393-4930-8150-36ca59e7973b
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIFY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c14a53be-adc4-4e7b-9321-5fc149b4337d
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a05c6976-4241-4543-9cfe-7d443e700fed
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MODIFY_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e3e95ab9-c06c-4314-abae-3114e47a7b54
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e0be2bf-234a-4d4b-a65a-1ec92b651a6e
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DSS_DATA_QUALITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d72e9ff-6df0-40fa-b9d0-0533f111681c
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8eeaecd-3c20-4e5f-b4ec-cdfd320ea8b4
          stepCounter: 37218e3d-4048-4cde-a233-bc277433139f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_SESS_PROCA_OWNER_V: 0b54428e-1fee-4f84-9918-32e73c82e055
          DIM_CONSOLIDATE_SESSION_DELAY: e169fe2b-3714-40d3-98e5-43e67d3b3491
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_THEATRE_SESSION_REFERENCE_05
          - locationName: TGT
            nodeName: S_SESS_PROCA_OWNER_V
          - locationName: TGT
            nodeName: DIM_CONSOLIDATE_SESSION_DELAY
        join:
          joinCondition: |-
            FROM ds_session_05
              JOIN ds_session_05_v
                ON ds_session_05_v.service_point_session_reference_no = ds_session_05.service_point_session_reference_no
              JOIN s_theatre_session_reference_05
                ON s_theatre_session_reference_05.theatre_session_reference_no = ds_session_05.service_point_session_reference_no
             INNER JOIN dim.dim_surgical_theatre
                ON dim_surgical_theatre.surgical_theatre_reference_no = ds_session_05.service_point_reference_no --  AND ds_session_05.start_date BETWEEN dim_surgical_theatre.dss_start_date AND dim_surgical_theatre.dss_end_date          LEFT OUTER JOIN dim.dim_session_status      ON ds_session_05.session_status_reference_no = dim_session_status.session_status_reference_no      AND IFNULL(dim_session_status.dss_start_date, dateadd(day,-10000,GETDATE())) <= ds_session_05.start_date      AND IFNULL(dim_session_status.dss_end_date, dateadd(day,10000,GETDATE())) >= ds_session_05.start_date          LEFT OUTER JOIN s_service_point_time_slot      ON ds_session_05.service_point_session_reference_no = s_service_point_time_slot.service_point_session_reference_no          LEFT OUTER JOIN ds_theatre_visit_summary       ON ds_session_05.service_point_session_reference_no = ds_theatre_visit_summary.theatre_session_reference_no            LEFT OUTER JOIN s_theatre_team      ON ds_session_05.service_point_session_reference_no = s_theatre_team.theatre_session_reference_no       AND s_theatre_team.theatre_session_visit_seq_num = 1            LEFT OUTER JOIN {{ ref('TGT','S_SESS_PROCA_OWNER_V') }}    ON ds_session_05.service_point_session_reference_no = s_Sess_Proca_Owner_v.spssn_refno    --where ds_session_05.dss_update_time > @v_pa_theatre_incremental      LEFT OUTER JOIN {{ ref('TGT','DIM_CONSOLIDATE_SESSION_DELAY') }}      ON ds_session_05.session_late_start_reason_reference_no = dim_consolidate_session_delay.session_late_start_reason_reference_no    --where ds_session_05.dss_update_time > getdate() - 1.5
        name: S_THEATRE_SESSION_10
        noLinkRefs: []
  name: S_THEATRE_SESSION_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
