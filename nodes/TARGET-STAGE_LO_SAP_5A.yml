fileVersion: 1
id: 8d0f06f2-b741-44fb-9712-2e8b2dff8c73
name: STAGE_LO_SAP_5A
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b378698a-f072-458d-a169-7610ff2ed33c
          stepCounter: 8d0f06f2-b741-44fb-9712-2e8b2dff8c73
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEDGER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd6fd979-034f-45ef-a80a-3ccb7a5215e5
                stepCounter: aee767c0-925c-484b-bc5a-a83ef3f717db
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d77d418-7b7b-4aa0-a9c5-afddf6ff9080
          stepCounter: 8d0f06f2-b741-44fb-9712-2e8b2dff8c73
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACTVY_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f80ac524-b9b3-4832-a7ca-4b7e7e122c91
                stepCounter: aee767c0-925c-484b-bc5a-a83ef3f717db
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34c72f29-668b-4d51-a09b-a19d46fcba31
          stepCounter: 8d0f06f2-b741-44fb-9712-2e8b2dff8c73
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACCT_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e73bb804-4b69-4e70-a9f4-39664eb1f202
                stepCounter: aee767c0-925c-484b-bc5a-a83ef3f717db
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0fa2a2f1-5881-4301-842c-15266b63a73c
          stepCounter: 8d0f06f2-b741-44fb-9712-2e8b2dff8c73
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_COST_CENTER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 10c94e82-06b1-4a71-8dd8-7b1fe6c71b16
                stepCounter: aee767c0-925c-484b-bc5a-a83ef3f717db
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae133064-e1a8-4e1d-856b-823d6ed7376f
          stepCounter: 8d0f06f2-b741-44fb-9712-2e8b2dff8c73
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed6a2434-4d0d-4215-9509-cc6034b6e391
          stepCounter: 8d0f06f2-b741-44fb-9712-2e8b2dff8c73
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_DEST_ORGANIZATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 13bdde5b-3f7d-4919-a728-8d50427815f9
                stepCounter: aee767c0-925c-484b-bc5a-a83ef3f717db
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ffce8ed-2cc8-4a56-b7b0-904ab38094f3
          stepCounter: 8d0f06f2-b741-44fb-9712-2e8b2dff8c73
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GL_ACCOUNT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4bfb259d-c5d9-4c33-8d7b-e2e5db782010
          stepCounter: 8d0f06f2-b741-44fb-9712-2e8b2dff8c73
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f34f72cc-766f-47ca-8e2d-5b70a9b10f8f
                stepCounter: aee767c0-925c-484b-bc5a-a83ef3f717db
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04726404-dc6f-4149-9a75-0888aac2188c
          stepCounter: 8d0f06f2-b741-44fb-9712-2e8b2dff8c73
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_HIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03094dcc-28c0-4fee-b106-8de0eba3539c
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d08312c-73d6-4e64-a891-64d68059da96
          stepCounter: 8d0f06f2-b741-44fb-9712-2e8b2dff8c73
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_VERSION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ab01836-2dca-4dab-baf2-a72ba6401d48
                stepCounter: aee767c0-925c-484b-bc5a-a83ef3f717db
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 332477ac-3cf9-42fd-8362-0841df4be2ba
          stepCounter: 8d0f06f2-b741-44fb-9712-2e8b2dff8c73
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LINE_ITEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e804803-956b-4160-b8fa-2c21b87138be
          stepCounter: 8d0f06f2-b741-44fb-9712-2e8b2dff8c73
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_VOUCHER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c413395-8ebb-4809-8776-d14cfdf9926f
          stepCounter: 8d0f06f2-b741-44fb-9712-2e8b2dff8c73
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4bfd8b9e-7607-44c0-bfdc-7b11cafdb63a
          stepCounter: 8d0f06f2-b741-44fb-9712-2e8b2dff8c73
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_INVOICE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec6b0cdb-4553-4d5b-83da-9fdd58fd2a4a
          stepCounter: 8d0f06f2-b741-44fb-9712-2e8b2dff8c73
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_PRODUCT_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dacbb490-276f-4c6a-9bff-82514ce329f3
          stepCounter: 8d0f06f2-b741-44fb-9712-2e8b2dff8c73
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3f84c21-4ee9-4cae-88e0-9ce9656d3204
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11f3ee3a-e68b-4c00-af05-f0ca6c5a9915
          stepCounter: 8d0f06f2-b741-44fb-9712-2e8b2dff8c73
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9683ed8-01a7-4ed1-8da9-7886f01201da
          stepCounter: 8d0f06f2-b741-44fb-9712-2e8b2dff8c73
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25cade92-0c5d-49f2-b0d9-a05618b1240e
          stepCounter: 8d0f06f2-b741-44fb-9712-2e8b2dff8c73
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: 'Gross Line Item Net Op Amount '
        name: NET_OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1c6babd-4135-4812-96ce-cfc32e5807bc
          stepCounter: 8d0f06f2-b741-44fb-9712-2e8b2dff8c73
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: LI_VOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 565d3323-ec85-439a-87b4-2b6b38b05be0
                stepCounter: aee767c0-925c-484b-bc5a-a83ef3f717db
            transform: SUM(STAGE_LO_SAP_5.LI_VOL)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 393ccada-15ae-4c96-9757-208e164eb76d
          stepCounter: 8d0f06f2-b741-44fb-9712-2e8b2dff8c73
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in cubic meters (m3)
        name: LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e3e0755-7cad-4903-9769-e893abdbd156
                stepCounter: aee767c0-925c-484b-bc5a-a83ef3f717db
            transform: SUM(DECODE(STAGE_LO_SAP_5.LINE_NO, '5.4',STAGE_LO_SAP_5.LI_VOL_M3*'{{ parameters.M3_BOE_FACTOR }}', STAGE_LO_SAP_5.LI_VOL_M3))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc5113a1-8c84-40be-bcbd-89a03890c7f1
          stepCounter: 8d0f06f2-b741-44fb-9712-2e8b2dff8c73
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in imperial measurement
        name: LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5bf9e4e1-ffe9-41e7-9247-c1a7b5b55318
                stepCounter: aee767c0-925c-484b-bc5a-a83ef3f717db
            transform: SUM(DECODE(STAGE_LO_SAP_5.LINE_NO, '5.4',STAGE_LO_SAP_5.LI_VOL_IMPERIAL/'{{ parameters.GAS_IMPERIAL_FACTOR }}', STAGE_LO_SAP_5.LI_VOL_IMPERIAL))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86c29980-a665-42b6-ba3d-0c886ef7414b
          stepCounter: 8d0f06f2-b741-44fb-9712-2e8b2dff8c73
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in BOE (Barrel of Oil Equivalent)
        name: LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24ba43ef-801d-4dd8-aae7-a33816fdd34f
                stepCounter: aee767c0-925c-484b-bc5a-a83ef3f717db
            transform: SUM(STAGE_LO_SAP_5.LI_VOL_BOE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 58d073da-3748-4312-af39-7c840094633d
          stepCounter: 8d0f06f2-b741-44fb-9712-2e8b2dff8c73
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in normalized cubic meters (nm3)
        name: LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 375f4bfa-5b89-43a3-92a4-6d3ca605e933
                stepCounter: aee767c0-925c-484b-bc5a-a83ef3f717db
            transform: SUM(DECODE(STAGE_LO_SAP_5.LINE_NO, '5.4',STAGE_LO_SAP_5.LI_VOL_NM3*'{{ parameters.NM3_BOE_FACTOR }}', STAGE_LO_SAP_5.LI_VOL_NM3))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b62f50db-6299-4ba0-b8b0-3442a7abe720
          stepCounter: 8d0f06f2-b741-44fb-9712-2e8b2dff8c73
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: ""
        name: EXCHANGE_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 588b83b7-5200-45f5-afe9-f0e85ff11db4
                stepCounter: aee767c0-925c-484b-bc5a-a83ef3f717db
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70fed1ec-b5cb-40d7-8ecf-dbdced8f8246
          stepCounter: 8d0f06f2-b741-44fb-9712-2e8b2dff8c73
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c1446fa1-b222-4400-b2f2-d1562e8d6f33
                stepCounter: aee767c0-925c-484b-bc5a-a83ef3f717db
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f2949cd-c010-443a-9c76-70c6568ac7f6
          stepCounter: 8d0f06f2-b741-44fb-9712-2e8b2dff8c73
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Indicates amounts are gross or net.
        name: GROSS_OR_NET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18b63e45-da5a-4946-bce2-901e88d39733
                stepCounter: aee767c0-925c-484b-bc5a-a83ef3f717db
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2025614-708b-4473-90b9-933fbbdf942d
          stepCounter: 8d0f06f2-b741-44fb-9712-2e8b2dff8c73
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: LINE_NO_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4607c855-a49d-4eb4-bbf8-11be2b047885
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 613f68cf-5336-425e-8e5e-d0e7af52ee05
          stepCounter: 8d0f06f2-b741-44fb-9712-2e8b2dff8c73
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: OP_NONOP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4f6ac063-e796-4638-aa07-4ebb90431d7d
                stepCounter: aee767c0-925c-484b-bc5a-a83ef3f717db
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 687e5e11-5da4-48cf-a1d9-fa234265211c
          stepCounter: 8d0f06f2-b741-44fb-9712-2e8b2dff8c73
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PROD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_LO_SAP_5: aee767c0-925c-484b-bc5a-a83ef3f717db
          DIM_LO_SAP_LEASE_OPS_HIER: e0b535c4-f94e-4ac1-b685-dfdff6293176
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_5
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_HIER
        join:
          joinCondition: |-
            FROM {{ ref('TARGET','STAGE_LO_SAP_5') }} STAGE_LO_SAP_5
             CROSS JOIN (
                    SELECT DIM_LEASE_OPS_HIER_KEY,
                           LINE_NO,
                           LINE_NO_GROUP
                      FROM {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_HIER') }}
                     WHERE DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO = '5A'
                   ) DIM_LO_SAP_LEASE_OPS_HIER
             GROUP BY STAGE_LO_SAP_5.DIM_LEDGER_KEY,
                      STAGE_LO_SAP_5.DIM_ACTVY_PER_DATE_KEY,
                      STAGE_LO_SAP_5.DIM_ACCT_PER_DATE_KEY,
                      STAGE_LO_SAP_5.DIM_COST_CENTER_KEY,
                      STAGE_LO_SAP_5.DIM_DEST_ORGANIZATION_KEY,
                      STAGE_LO_SAP_5.DIM_GROSS_NET_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.DIM_LEASE_OPS_HIER_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO_GROUP,
                      STAGE_LO_SAP_5.DIM_LEASE_OPS_VERSION_KEY,
                      STAGE_LO_SAP_5.EXCHANGE_RATE,
                      STAGE_LO_SAP_5.OP_CURR_CODE,
                      STAGE_LO_SAP_5.GROSS_OR_NET_CODE,
                      STAGE_LO_SAP_5.OP_NONOP
        name: STAGE_LO_SAP_5A
        noLinkRefs: []
  name: STAGE_LO_SAP_5A
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
