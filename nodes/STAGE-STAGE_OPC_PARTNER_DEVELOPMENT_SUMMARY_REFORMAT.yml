fileVersion: 1
id: 840a7c96-d2bf-4b86-9239-c222f0144b96
name: STAGE_OPC_PARTNER_DEVELOPMENT_SUMMARY_REFORMAT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e18f22d-ee69-4859-aefa-d7f58730a350
          stepCounter: 840a7c96-d2bf-4b86-9239-c222f0144b96
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ACCOUNT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b312b1b-fa0c-4e78-b1da-9db2c5529a57
          stepCounter: 840a7c96-d2bf-4b86-9239-c222f0144b96
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83de3780-90ba-482e-80fc-bb3f3ae2b350
                stepCounter: 1153366b-d1b6-4a62-88d7-83bdd71d764b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_PD_SUMMARY_GA4.DATE),'YYYYMMDD')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a6e96d5-2272-49be-8b33-3e488611f7a4
          stepCounter: 840a7c96-d2bf-4b86-9239-c222f0144b96
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: GA_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83de3780-90ba-482e-80fc-bb3f3ae2b350
                stepCounter: 1153366b-d1b6-4a62-88d7-83bdd71d764b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_PD_SUMMARY_GA4.DATE),'YYYYMMDD') \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6460ccc7-d88f-4842-b4be-4a6e2c229042
          stepCounter: 840a7c96-d2bf-4b86-9239-c222f0144b96
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: USER ID
        name: GA_DIMENSION10
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 035b27d1-3918-46e3-8554-bdc17650f122
                stepCounter: 1153366b-d1b6-4a62-88d7-83bdd71d764b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31d83446-7755-4f20-8ef3-eaa69293a2dc
          stepCounter: 840a7c96-d2bf-4b86-9239-c222f0144b96
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: USER NAME
        name: GA_DIMENSION11
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ead2a564-9a42-4310-8495-4bfc4bd9e62e
                stepCounter: b7986fba-dcf2-476d-bb80-43b446548bce
            transform: INITCAP(CONCAT(LOADOPCUSERS.FIRSTNAME,' ',LOADOPCUSERS.LASTNAME))
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: INITCAP(CONCAT(LOADOPCUSERS.FIRSTNAME,' ',LOADOPCUSERS.LASTNAME))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f66edfe6-6152-4c03-a882-f2adbd11325b
          stepCounter: 840a7c96-d2bf-4b86-9239-c222f0144b96
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER ID - SUPPLIER NAME
        name: GA_DIMENSION12
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c14592f0-04b3-4b35-87e5-e248d84c01ee
                stepCounter: 1153366b-d1b6-4a62-88d7-83bdd71d764b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 249f7eb2-f57d-4b16-961a-6064f6524ec2
          stepCounter: 840a7c96-d2bf-4b86-9239-c222f0144b96
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER ID
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c14592f0-04b3-4b35-87e5-e248d84c01ee
                stepCounter: 1153366b-d1b6-4a62-88d7-83bdd71d764b
            transform: SPLIT_PART(LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO.USER_SUPPLIER,'-',1) \N \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: SPLIT_PART(LOADGA_OPC_PD_SUMMARY_GA4.USER_SUPPLIER,'-',1) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff8bdc0d-0c4e-4a11-9da7-9564724221e7
          stepCounter: 840a7c96-d2bf-4b86-9239-c222f0144b96
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER NAME
        name: SUPPLIER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c14592f0-04b3-4b35-87e5-e248d84c01ee
                stepCounter: 1153366b-d1b6-4a62-88d7-83bdd71d764b
            transform: INITCAP(SPLIT_PART(LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO.USER_SUPPLIER,'-',2)) \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: INITCAP(SPLIT_PART(LOADGA_OPC_PD_SUMMARY_GA4.USER_SUPPLIER,'-',2))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ff284be-9944-4949-894b-f605c8217ac6
          stepCounter: 840a7c96-d2bf-4b86-9239-c222f0144b96
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: SEARCHES
        name: GA_METRIC3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9451a1be-b7b0-4d4a-be22-c3bcff249928
                stepCounter: 1153366b-d1b6-4a62-88d7-83bdd71d764b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b3c90b23-405d-4837-a4f8-60c98172e144
          stepCounter: 840a7c96-d2bf-4b86-9239-c222f0144b96
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: CONTACT INVOKES
        name: GA_METRIC4
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 039d18f8-818c-4771-80c3-b3bc3d277840
                stepCounter: 1153366b-d1b6-4a62-88d7-83bdd71d764b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b20eabc3-7b2b-4c50-af76-42e5a4367ce8
          stepCounter: 840a7c96-d2bf-4b86-9239-c222f0144b96
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: EXPORTS
        name: GA_METRIC5
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f88131be-8d55-4e83-92e1-5e57d0e80626
                stepCounter: 1153366b-d1b6-4a62-88d7-83bdd71d764b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91e16f10-464e-480f-8ccb-316cf2db3ce9
          stepCounter: 840a7c96-d2bf-4b86-9239-c222f0144b96
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: FIRST LOGINS
        name: GA_METRIC6
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e63686be-945c-4d50-85ed-c61086fb0231
                stepCounter: 1153366b-d1b6-4a62-88d7-83bdd71d764b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81021e05-725f-4ccd-bb7f-323769c6b7db
          stepCounter: 840a7c96-d2bf-4b86-9239-c222f0144b96
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: GA_SESSIONS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 29d56a64-c37b-4fbe-a8a4-e609991c9c6b
                stepCounter: 1153366b-d1b6-4a62-88d7-83bdd71d764b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: COALESCE(LOADGA_OPC_PD_SUMMARY_GA4.LOGINS,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cfe37339-7203-4dd3-9f8f-712c0730c93a
          stepCounter: 840a7c96-d2bf-4b86-9239-c222f0144b96
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PROFILE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de630f07-ecae-41b3-8d4e-6fdb9c35c8cf
          stepCounter: 840a7c96-d2bf-4b86-9239-c222f0144b96
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83de3780-90ba-482e-80fc-bb3f3ae2b350
                stepCounter: 1153366b-d1b6-4a62-88d7-83bdd71d764b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_PD_SUMMARY_GA4.DATE),'YYYYMMDD') \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f95c85c-52bb-4faf-b271-bf28939da750
          stepCounter: 840a7c96-d2bf-4b86-9239-c222f0144b96
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: WEB_PROPERTY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f75bb316-aed7-4d0b-9073-ae7fdbdd0b1c
          stepCounter: 840a7c96-d2bf-4b86-9239-c222f0144b96
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_BATCHED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27602ff3-ad2d-4d7c-a845-fd2513b5b1be
                stepCounter: 1153366b-d1b6-4a62-88d7-83bdd71d764b
            transform: TO_TIMESTAMP(LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO.__HEVO__LOADED_AT,3)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_PD_SUMMARY_GA4.__HEVO__LOADED_AT,3)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 60013b20-ac3e-45ac-8ba7-b8b9b82b3597
          stepCounter: 840a7c96-d2bf-4b86-9239-c222f0144b96
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_EXTRACTED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23a84818-fd2e-402c-b795-727b1d1e1489
                stepCounter: 1153366b-d1b6-4a62-88d7-83bdd71d764b
            transform: TO_TIMESTAMP(LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO.__HEVO__LOADED_AT,3) \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_PD_SUMMARY_GA4.__HEVO__INGESTED_AT,3)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c7e64063-569f-4b93-b0cb-9fc177add54d
          stepCounter: 840a7c96-d2bf-4b86-9239-c222f0144b96
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_RECEIVED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27602ff3-ad2d-4d7c-a845-fd2513b5b1be
                stepCounter: 1153366b-d1b6-4a62-88d7-83bdd71d764b
            transform: TO_TIMESTAMP(LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO.__HEVO__LOADED_AT,3) \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_PD_SUMMARY_GA4.__HEVO__LOADED_AT,3)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92a049c3-fcd7-4b2c-b80e-94e5e6cd1177
          stepCounter: 840a7c96-d2bf-4b86-9239-c222f0144b96
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: _SDC_RECORD_HASH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3a5fff1-c1ed-419c-8607-49343f01fafe
                stepCounter: 1153366b-d1b6-4a62-88d7-83bdd71d764b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b61460e9-6a45-4de2-9480-cec0fd964261
          stepCounter: 840a7c96-d2bf-4b86-9239-c222f0144b96
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: _SDC_SEQUENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c185f832-7eca-45d6-b4fd-c92fafb50ada
          stepCounter: 840a7c96-d2bf-4b86-9239-c222f0144b96
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: _SDC_TABLE_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b44ec02d-d233-480d-ae72-23424cde0ea6
          stepCounter: 840a7c96-d2bf-4b86-9239-c222f0144b96
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: HOSTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef790dd1-861c-430b-a54c-07f02999666e
                stepCounter: 1153366b-d1b6-4a62-88d7-83bdd71d764b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf691278-27da-489b-b389-789b02aa636c
          stepCounter: 840a7c96-d2bf-4b86-9239-c222f0144b96
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: THIS FIELD WILL BE USED TO FILTER WHICH OPC ENVIRONMENT THIS GA RECORD WILL BE SHOWN.
        name: FILTER_DATABASE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef790dd1-861c-430b-a54c-07f02999666e
                stepCounter: 1153366b-d1b6-4a62-88d7-83bdd71d764b
            transform: CASE HOSTNAME \N WHEN 'OPC-SCUS-SVC-WEB-DEV.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_DEV' \N WHEN 'LOCALHOST' \N THEN 'OMNIACONNECT_DEV' \N WHEN'OPC-SCUS-SVC-WEB-QA.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA' \N WHEN 'OPC-SCUS-SVC-WEB-PROD-STAGING.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA' \N WHEN 'OPC-SCUS-SVC-WEB-UAT.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_UAT' \N WHEN 'OMNIACONNECT.OMNIAPARTNERS.COM' \N THEN 'OMNIACONNECT' \N ELSE NULL \NEND \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: CASE HOSTNAME \N WHEN 'OPC-SCUS-SVC-WEB-DEV.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_DEV' \N WHEN 'LOCALHOST' \N THEN 'OMNIACONNECT_DEV' \N WHEN'OPC-SCUS-SVC-WEB-QA.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA' \N WHEN 'OPC-SCUS-SVC-WEB-PROD-STAGING.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA' \N WHEN 'OPC-SCUS-SVC-WEB-UAT.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_UAT' \N WHEN 'OMNIACONNECT.OMNIAPARTNERS.COM' \N THEN 'OMNIACONNECT' \N ELSE NULL \NEND \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a849782d-7ace-444f-90ca-541f275565c0
          stepCounter: 840a7c96-d2bf-4b86-9239-c222f0144b96
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2aab0ddf-0539-4a8d-8582-a375fb8af626
                stepCounter: 1153366b-d1b6-4a62-88d7-83bdd71d764b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ade5a7bc-1bd4-4ed0-878c-88adc6bab453
          stepCounter: 840a7c96-d2bf-4b86-9239-c222f0144b96
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 55f3adc7-f4a8-4df6-be1d-48bea4b95774
                stepCounter: 1153366b-d1b6-4a62-88d7-83bdd71d764b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf6cd5ff-922f-43b1-a6d5-0b58008fcf13
          stepCounter: 840a7c96-d2bf-4b86-9239-c222f0144b96
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c8dde9e-ad80-4f97-92e1-5ab9a3ebdb42
          stepCounter: 840a7c96-d2bf-4b86-9239-c222f0144b96
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOAD_OPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO: 1153366b-d1b6-4a62-88d7-83bdd71d764b
          LOAD_OPCUSERS: b7986fba-dcf2-476d-bb80-43b446548bce
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOAD_OPCUSERS
          - locationName: LOAD
            nodeName: LOAD_OPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOAD_OPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO') }} LOAD_OPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO
              LEFT JOIN {{ ref('LOAD','LOAD_OPCUSERS') }} LOAD_OPCUSERS
                ON LOAD_OPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO.USER_ID = LOAD_OPCUSERS.IDENTITYUSERID
        name: SRC_STAGEOPC_PARTNER_DEVELOPMENT_SUMMARY_GA3
        noLinkRefs: []
  name: STAGE_OPC_PARTNER_DEVELOPMENT_SUMMARY_REFORMAT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
