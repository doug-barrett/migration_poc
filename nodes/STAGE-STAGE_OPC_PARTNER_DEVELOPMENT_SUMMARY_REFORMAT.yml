fileVersion: 1
id: d6f18587-7e5b-4198-aba8-b4f170d69978
name: STAGE_OPC_PARTNER_DEVELOPMENT_SUMMARY_REFORMAT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e062ee99-872c-4324-a270-b2c6c1d94495
          stepCounter: d6f18587-7e5b-4198-aba8-b4f170d69978
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ACCOUNT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e90ede4-2822-485d-bb8a-8182e0ddcfab
          stepCounter: d6f18587-7e5b-4198-aba8-b4f170d69978
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d63445f2-fd73-4323-b984-f914bc3d387b
                stepCounter: a86dcfdb-74f8-4468-9d87-a351fa1764f8
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_PD_SUMMARY_GA4.DATE),'YYYYMMDD')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0ce72e7-6dd2-4aa1-9522-5fdce1369afb
          stepCounter: d6f18587-7e5b-4198-aba8-b4f170d69978
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: GA_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d63445f2-fd73-4323-b984-f914bc3d387b
                stepCounter: a86dcfdb-74f8-4468-9d87-a351fa1764f8
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_PD_SUMMARY_GA4.DATE),'YYYYMMDD') \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e44e91c-3895-4743-8f2a-150d181610e2
          stepCounter: d6f18587-7e5b-4198-aba8-b4f170d69978
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: USER ID
        name: GA_DIMENSION10
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ca9032d0-2b9b-4931-8a50-0bd0ba9a2b79
                stepCounter: a86dcfdb-74f8-4468-9d87-a351fa1764f8
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f8525ae-3e6a-4419-8af1-db299fd3797f
          stepCounter: d6f18587-7e5b-4198-aba8-b4f170d69978
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: USER NAME
        name: GA_DIMENSION11
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c97f9234-e9fe-4c36-978f-5659f29c2202
                stepCounter: 8428b8a3-cdb3-4ef1-beff-8735fbf176bc
            transform: INITCAP(CONCAT(LOADOPCUSERS.FIRSTNAME,' ',LOADOPCUSERS.LASTNAME))
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: INITCAP(CONCAT(LOADOPCUSERS.FIRSTNAME,' ',LOADOPCUSERS.LASTNAME))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b1078aa-e435-4468-9d1b-2ed4fc97efa1
          stepCounter: d6f18587-7e5b-4198-aba8-b4f170d69978
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER ID - SUPPLIER NAME
        name: GA_DIMENSION12
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27800315-d1ee-475b-aff4-e9c247f27f59
                stepCounter: a86dcfdb-74f8-4468-9d87-a351fa1764f8
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8bfa7cc-b4bb-45b5-adb1-d78d730bcebc
          stepCounter: d6f18587-7e5b-4198-aba8-b4f170d69978
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER ID
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27800315-d1ee-475b-aff4-e9c247f27f59
                stepCounter: a86dcfdb-74f8-4468-9d87-a351fa1764f8
            transform: SPLIT_PART(LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO.USER_SUPPLIER,'-',1) \N \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: SPLIT_PART(LOADGA_OPC_PD_SUMMARY_GA4.USER_SUPPLIER,'-',1) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb9d2d87-5a8a-4a66-94be-4dc6201cf50a
          stepCounter: d6f18587-7e5b-4198-aba8-b4f170d69978
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER NAME
        name: SUPPLIER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27800315-d1ee-475b-aff4-e9c247f27f59
                stepCounter: a86dcfdb-74f8-4468-9d87-a351fa1764f8
            transform: INITCAP(SPLIT_PART(LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO.USER_SUPPLIER,'-',2)) \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: INITCAP(SPLIT_PART(LOADGA_OPC_PD_SUMMARY_GA4.USER_SUPPLIER,'-',2))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b11241f1-45d8-43b6-bcfb-e4adfac2076d
          stepCounter: d6f18587-7e5b-4198-aba8-b4f170d69978
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: SEARCHES
        name: GA_METRIC3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79a3ba44-648d-4b89-8c50-5469b21203f9
                stepCounter: a86dcfdb-74f8-4468-9d87-a351fa1764f8
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a229ebb8-5ee2-4a0e-ad5f-05ace08ec608
          stepCounter: d6f18587-7e5b-4198-aba8-b4f170d69978
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: CONTACT INVOKES
        name: GA_METRIC4
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5b65a11-0e47-4890-a6a2-473713956b5f
                stepCounter: a86dcfdb-74f8-4468-9d87-a351fa1764f8
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a94ec1b-aea6-47f7-bf4a-b2c4c100d686
          stepCounter: d6f18587-7e5b-4198-aba8-b4f170d69978
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: EXPORTS
        name: GA_METRIC5
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 49ff58e4-6845-459e-a288-477ebb814190
                stepCounter: a86dcfdb-74f8-4468-9d87-a351fa1764f8
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c84acf40-3418-49e4-9e66-5440fc30b0fe
          stepCounter: d6f18587-7e5b-4198-aba8-b4f170d69978
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: FIRST LOGINS
        name: GA_METRIC6
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 625eba12-1f92-453d-ba0e-45845f8d61dc
                stepCounter: a86dcfdb-74f8-4468-9d87-a351fa1764f8
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a3f9d7a-6c47-40f4-b8a3-ceb8a5eb397b
          stepCounter: d6f18587-7e5b-4198-aba8-b4f170d69978
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: GA_SESSIONS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa6c9e88-02d8-4f8e-aba5-df5b579240da
                stepCounter: a86dcfdb-74f8-4468-9d87-a351fa1764f8
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: COALESCE(LOADGA_OPC_PD_SUMMARY_GA4.LOGINS,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 00f99d98-0b49-4ad0-831b-3d8dd65a7ce5
          stepCounter: d6f18587-7e5b-4198-aba8-b4f170d69978
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PROFILE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d413dac-36dc-455d-bb53-300327b64dc9
          stepCounter: d6f18587-7e5b-4198-aba8-b4f170d69978
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d63445f2-fd73-4323-b984-f914bc3d387b
                stepCounter: a86dcfdb-74f8-4468-9d87-a351fa1764f8
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_PD_SUMMARY_GA4.DATE),'YYYYMMDD') \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9366d3ba-d990-4eff-b659-59d680d4d847
          stepCounter: d6f18587-7e5b-4198-aba8-b4f170d69978
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: WEB_PROPERTY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: baf2f400-cb25-4dd6-80bc-8af5ae6932ee
          stepCounter: d6f18587-7e5b-4198-aba8-b4f170d69978
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_BATCHED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 92357d06-ce90-476e-b55d-99b9ca4af43e
                stepCounter: a86dcfdb-74f8-4468-9d87-a351fa1764f8
            transform: TO_TIMESTAMP(LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO.__HEVO__LOADED_AT,3)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_PD_SUMMARY_GA4.__HEVO__LOADED_AT,3)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 296d3fa5-a09f-4486-8421-8ad15820bf7c
          stepCounter: d6f18587-7e5b-4198-aba8-b4f170d69978
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_EXTRACTED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d87d69f3-28a8-4c94-99ee-b639d619b1a9
                stepCounter: a86dcfdb-74f8-4468-9d87-a351fa1764f8
            transform: TO_TIMESTAMP(LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO.__HEVO__LOADED_AT,3) \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_PD_SUMMARY_GA4.__HEVO__INGESTED_AT,3)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3937415-8693-4812-92da-b42024d4cc8d
          stepCounter: d6f18587-7e5b-4198-aba8-b4f170d69978
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_RECEIVED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 92357d06-ce90-476e-b55d-99b9ca4af43e
                stepCounter: a86dcfdb-74f8-4468-9d87-a351fa1764f8
            transform: TO_TIMESTAMP(LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO.__HEVO__LOADED_AT,3) \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_PD_SUMMARY_GA4.__HEVO__LOADED_AT,3)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a5bcd0d-5a25-4a21-a990-45d546c4fa7d
          stepCounter: d6f18587-7e5b-4198-aba8-b4f170d69978
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: _SDC_RECORD_HASH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9aff0878-3ad2-44cd-a720-d698afd1b5b1
                stepCounter: a86dcfdb-74f8-4468-9d87-a351fa1764f8
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66ab7451-b915-4021-b0e4-42f18176a02d
          stepCounter: d6f18587-7e5b-4198-aba8-b4f170d69978
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: _SDC_SEQUENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7b7577c-cdea-4a02-a68e-89a70f61fee5
          stepCounter: d6f18587-7e5b-4198-aba8-b4f170d69978
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: _SDC_TABLE_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87473a90-6f80-4e12-b0d8-191b62630352
          stepCounter: d6f18587-7e5b-4198-aba8-b4f170d69978
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: HOSTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c63a223-31d4-45a1-bd71-8ea925daa61f
                stepCounter: a86dcfdb-74f8-4468-9d87-a351fa1764f8
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f526b77-eba0-4eb5-acd9-96fb1521dde9
          stepCounter: d6f18587-7e5b-4198-aba8-b4f170d69978
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: THIS FIELD WILL BE USED TO FILTER WHICH OPC ENVIRONMENT THIS GA RECORD WILL BE SHOWN.
        name: FILTER_DATABASE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c63a223-31d4-45a1-bd71-8ea925daa61f
                stepCounter: a86dcfdb-74f8-4468-9d87-a351fa1764f8
            transform: CASE HOSTNAME \N WHEN 'OPC-SCUS-SVC-WEB-DEV.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_DEV' \N WHEN 'LOCALHOST' \N THEN 'OMNIACONNECT_DEV' \N WHEN'OPC-SCUS-SVC-WEB-QA.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA' \N WHEN 'OPC-SCUS-SVC-WEB-PROD-STAGING.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA' \N WHEN 'OPC-SCUS-SVC-WEB-UAT.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_UAT' \N WHEN 'OMNIACONNECT.OMNIAPARTNERS.COM' \N THEN 'OMNIACONNECT' \N ELSE NULL \NEND \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: CASE HOSTNAME \N WHEN 'OPC-SCUS-SVC-WEB-DEV.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_DEV' \N WHEN 'LOCALHOST' \N THEN 'OMNIACONNECT_DEV' \N WHEN'OPC-SCUS-SVC-WEB-QA.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA' \N WHEN 'OPC-SCUS-SVC-WEB-PROD-STAGING.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA' \N WHEN 'OPC-SCUS-SVC-WEB-UAT.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_UAT' \N WHEN 'OMNIACONNECT.OMNIAPARTNERS.COM' \N THEN 'OMNIACONNECT' \N ELSE NULL \NEND \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f474accd-f10b-4e7f-ae27-14f3f8dd5915
          stepCounter: d6f18587-7e5b-4198-aba8-b4f170d69978
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b2c2594-e365-481e-83ad-556ad4ef2ac7
                stepCounter: a86dcfdb-74f8-4468-9d87-a351fa1764f8
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f565cc51-737c-4807-947e-c3f694205608
          stepCounter: d6f18587-7e5b-4198-aba8-b4f170d69978
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d0318e3b-9103-4714-a89f-c9ebef0a2fa6
                stepCounter: a86dcfdb-74f8-4468-9d87-a351fa1764f8
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11f41516-9798-4123-aacb-e7435c80aaed
          stepCounter: d6f18587-7e5b-4198-aba8-b4f170d69978
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16737060-d2c1-4df7-8d6d-52560b235068
          stepCounter: d6f18587-7e5b-4198-aba8-b4f170d69978
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOAD_OPCUSERS
          - locationName: LOAD
            nodeName: LOAD_OPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO
          - locationName: UNKNOWN
            nodeName: LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO
          - locationName: UNKNOWN
            nodeName: LOADOPCUSERS
        join:
          joinCondition: |-
            FROM {{ ref('UNKNOWN','LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO') }} LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO
              LEFT JOIN {{ ref('UNKNOWN','LOADOPCUSERS') }} LOADOPCUSERS
                ON LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO.USER_ID = LOADOPCUSERS.IDENTITYUSERID
        name: SRC_STAGEOPC_PARTNER_DEVELOPMENT_SUMMARY_GA3
        noLinkRefs: []
  name: STAGE_OPC_PARTNER_DEVELOPMENT_SUMMARY_REFORMAT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
