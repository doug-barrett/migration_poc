fileVersion: 1
id: 94a35bed-4a84-499a-bced-a9c10f0c22f3
name: S_TMS_TERMINAL_ALLOCATION_LOG_MROC_CURRENT
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DATAVAULT_BUSINESS_VAULT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b6eb5f7-9def-4471-a740-23524162f823
          stepCounter: 94a35bed-4a84-499a-bced-a9c10f0c22f3
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: ""
        name: HK_H_TMS_TERMINAL_ALLOCATION
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a25f312f-3fe0-452b-86a6-237adffe44bb
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e741809f-c5a8-49cc-8f86-3c1fff957b8c
          stepCounter: 94a35bed-4a84-499a-bced-a9c10f0c22f3
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: Locale identifier
        isBusinessKey: true
        name: LOCALE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11ab311a-11ae-449c-acb9-19f103800aea
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86b00643-9d90-4004-b901-fa9f835fca71
          stepCounter: 94a35bed-4a84-499a-bced-a9c10f0c22f3
        config: {}
        dataType: VARCHAR(9)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: MERCHANT_NUMBER_ACI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8b1d72e-3ce7-470f-a218-04b56b0349ae
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac325e46-2f3a-46b4-974f-99cfc29e7b57
          stepCounter: 94a35bed-4a84-499a-bced-a9c10f0c22f3
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: FILE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c10d8afb-89b2-46ac-acc6-eea31ee44754
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c389f35c-8310-43af-be7c-4258f86129d7
          stepCounter: 94a35bed-4a84-499a-bced-a9c10f0c22f3
        config: {}
        dataType: VARCHAR(19)
        defaultValue: ""
        description: ""
        name: DEVICE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84ad3997-7dce-444e-8cf7-967be7ebe79a
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2c7e0b1-6be5-440c-9819-69141bd1a3b8
          stepCounter: 94a35bed-4a84-499a-bced-a9c10f0c22f3
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Merchant number associated with the Locale
        name: MERCHANT_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a7de5359-4c7d-4239-bd9c-6275fa47887b
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07806fe5-ca2a-4de7-ba49-d58a8a23b5b6
          stepCounter: 94a35bed-4a84-499a-bced-a9c10f0c22f3
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ACTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc70146a-3ee5-45c5-8ce7-99f9569c2b49
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 167673ea-776e-4904-8bff-cf9cef8c084e
          stepCounter: 94a35bed-4a84-499a-bced-a9c10f0c22f3
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: USER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 61685951-e22a-4632-a4db-8791af7902ef
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91a106ac-accf-4ceb-a90a-b0d25b7492d8
          stepCounter: 94a35bed-4a84-499a-bced-a9c10f0c22f3
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: "Indicates the interface that performed the action:\n\n- 1: Terminal\n\n- 2: TMS Interface\n\n- 3: Merchant Direct\n\n- 4: Gift & Loyalty\n\n- 5: OMS-Boarding Interface\n\n- 6: Scheduler Interface\n\n- 7: GO Portal Interface\n\n- 8: MFS Interface\n\n- 9: Boarding Migration"
        name: RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a48e64f7-0acd-47a4-85b1-e0f6c0bf1b2d
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bfde72d8-ad1d-4533-9074-9f82469479ad
          stepCounter: 94a35bed-4a84-499a-bced-a9c10f0c22f3
        config: {}
        dataType: TIMESTAMP_NTZ(3)
        defaultValue: ""
        description: ""
        name: CREATION_TS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ae7f3c3b-ab1c-4bab-a6e1-bf88b0ea64f9
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b5a8caa-fb3c-4628-970f-c59cf0550204
          stepCounter: 94a35bed-4a84-499a-bced-a9c10f0c22f3
        config: {}
        dataType: NUMBER(38,0)
        defaultValue: ""
        description: ""
        name: DEVICE_SLOT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ecd9368-94a4-4582-b807-b2cd2a1c8225
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4cc6d2dd-9346-4809-818b-2951822c4d6c
          stepCounter: 94a35bed-4a84-499a-bced-a9c10f0c22f3
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CREATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f985a848-9454-4815-8a44-b159d2d64843
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8fd547dd-05e3-4a0f-a63d-e722f0af7330
          stepCounter: 94a35bed-4a84-499a-bced-a9c10f0c22f3
        config: {}
        dataType: TIMESTAMP_NTZ(3)
        defaultValue: ""
        description: ""
        name: CREATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8d8c6412-6aae-40b3-8374-f117c234a265
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 476aaacd-76a9-4861-bcb4-e580d585b70c
          stepCounter: 94a35bed-4a84-499a-bced-a9c10f0c22f3
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: UPDATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db8a815d-6575-4e67-8ec8-d7f039a9abe3
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c08c5e9-519c-464f-b6e1-56d386f41a76
          stepCounter: 94a35bed-4a84-499a-bced-a9c10f0c22f3
        config: {}
        dataType: TIMESTAMP_NTZ(3)
        defaultValue: ""
        description: ""
        name: UPDATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ebabe1f-6c31-4238-8c36-a33ab6f669ff
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 852e5c62-ff59-49c8-9739-4cd2006686e0
          stepCounter: 94a35bed-4a84-499a-bced-a9c10f0c22f3
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: RUN_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6bfac010-f1f8-4a8c-942f-13c74c9f6a2f
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f6218fb-3d21-480a-b266-1f18ffbd6bb8
          stepCounter: 94a35bed-4a84-499a-bced-a9c10f0c22f3
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: The changing hash
        name: DSS_CHANGE_HASH
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b000fc61-c70a-47b6-b0b1-232e9d2e917a
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9932bd63-4309-455f-a6db-e4af93dd16f3
          stepCounter: 94a35bed-4a84-499a-bced-a9c10f0c22f3
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Record source
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 583bb1c7-23c5-4b23-b4d4-c8af6e40ef19
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 895ca725-909c-4173-94c4-1267da112baf
          stepCounter: 94a35bed-4a84-499a-bced-a9c10f0c22f3
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was loaded in the data vault
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ede1ecce-402c-450a-8b4d-37dc297d3418
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a4386af1-77c6-4390-8219-7def6d440487
          stepCounter: 94a35bed-4a84-499a-bced-a9c10f0c22f3
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row started in the data vault
        isSystemStartDate: true
        name: DSS_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90100557-6e5b-41ac-b39b-cccaa607f671
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72999817-c90c-44e6-957d-a4856e7bf30d
          stepCounter: 94a35bed-4a84-499a-bced-a9c10f0c22f3
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: Version number of a business key in the data vault
        isSurrogateKey: true
        isSystemVersion: true
        name: DSS_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0bbd32e8-f916-4c09-b861-cc5a37e8564e
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9717cd0-7d57-4a3f-9dd8-ecbafa833149
          stepCounter: 94a35bed-4a84-499a-bced-a9c10f0c22f3
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was inserted in the data vault
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed988546-dd18-461b-901b-7ed6accf7ebb
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_TMS_TERMINAL_ALLOCATION_LOG_MROC: feba6e7b-a930-467f-9825-95803431c2bb
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATAVAULT_RAW_VAULT
            nodeName: S_TMS_TERMINAL_ALLOCATION_LOG_MROC
        join:
          joinCondition: |-
            FROM {{ ref('DATAVAULT_RAW_VAULT','S_TMS_TERMINAL_ALLOCATION_LOG_MROC') }} s_tms_terminal_allocation_log_mroc
             INNER JOIN (
                    SELECT hk_h_tms_terminal_allocation,
                           MAX(dss_start_date) AS dss_start_date
                      FROM {{ ref('DATAVAULT_RAW_VAULT','S_TMS_TERMINAL_ALLOCATION_LOG_MROC') }}
                     GROUP BY hk_h_tms_terminal_allocation
                   ) curr
                ON curr.hk_h_tms_terminal_allocation = s_tms_terminal_allocation_log_mroc.hk_h_tms_terminal_allocation
               AND curr.dss_start_date = s_tms_terminal_allocation_log_mroc.dss_start_date
        name: S_TMS_TERMINAL_ALLOCATION_LOG_MROC_CURRENT
        noLinkRefs: []
  name: S_TMS_TERMINAL_ALLOCATION_LOG_MROC_CURRENT
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
