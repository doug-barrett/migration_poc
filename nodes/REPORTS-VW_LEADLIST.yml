fileVersion: 1
id: eb78ccb9-3648-4ec3-a4c5-9b069e492ad6
name: VW_LEADLIST
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: REPORTS
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ef1bb89-2dc2-43bf-82cc-87f605bc6dd8
          stepCounter: eb78ccb9-3648-4ec3-a4c5-9b069e492ad6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEFACTSALESMERGE_1.REPORTINGCUSTOMERID=ACCOUNT.FORCEID
        name: ACCOUNTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7240b431-c8ff-414f-8f2b-4e4d741bbeff
                stepCounter: cd36f532-f0d8-47ba-b9d6-84ea35d998c4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 43278989-4434-4f48-b291-c93b0f9593b1
          stepCounter: eb78ccb9-3648-4ec3-a4c5-9b069e492ad6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEFACTSALESMERGE_1.REPORTINGCUSTOMERID=ACCOUNTGEOGRAPHY.FORCEID
        name: ACCOUNTGEOGRAPHYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ea16698-4335-42e8-b709-94e675839f41
                stepCounter: cd36f532-f0d8-47ba-b9d6-84ea35d998c4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a3bc98f-a25c-47d2-815f-88ee543262d7
          stepCounter: eb78ccb9-3648-4ec3-a4c5-9b069e492ad6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEFACTSALESMERGE_1.ACCOUNT.ACCOUNTTERRITORY=SALESTERRITORY.TERRITORYNAME
        name: SALESTERRITORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c1d6ef95-835f-4a7c-b19f-9cb7b1782698
                stepCounter: cd36f532-f0d8-47ba-b9d6-84ea35d998c4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9163ea2-6224-40a7-9d4b-bbe2bf896e11
          stepCounter: eb78ccb9-3648-4ec3-a4c5-9b069e492ad6
        config: {}
        dataType: INT
        defaultValue: ""
        description: UNIQUE IDENTIFIER FOR AN ACCOUNT. COMMONLY CALLED THE "FORCE ID"
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a3160ab-05f3-4f3a-9c6b-05cb492a0191
                stepCounter: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 43d47c0b-3933-460d-81a5-87b5c33173c9
          stepCounter: eb78ccb9-3648-4ec3-a4c5-9b069e492ad6
        config: {}
        dataType: INT
        defaultValue: ""
        description: PARENT ID FOR AN ACCOUNT. WILL BE THE SAME AS FORCEID IF THERE IS NO PARENT OR IF THIS IS THE TOP-MOST ACCOUNT IN A HIERARCHY
        name: FORCEPARENTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5cc3774c-6a7c-456a-a0d9-812d937eaf8e
                stepCounter: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cee0d167-34d5-4e22-9eb6-5334692d0948
          stepCounter: eb78ccb9-3648-4ec3-a4c5-9b069e492ad6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "STAGEFACTSALESMERGE_1.SUPPLIERID=SUPPLIER.SUPPLIERID\nSTAGEFACTSALESMERGE_1.SUPPLIERNAME=SUPPLIER.SUPPLIERNAME\nSTAGEFACTSALESMERGE_1.CONTRACTNUMBER=SUPPLIER.CONTRACTNUMBER"
        name: NUMOFSUPPLIERSUSED
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 826c498d-3152-435e-85a1-b2dc76f327c3
                stepCounter: cd36f532-f0d8-47ba-b9d6-84ea35d998c4
            transform: COUNT (DISTINCT SALESANDREVENUE.SUPPLIERKEY)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea4732b9-cc42-4d88-9da4-b5db5192527f
          stepCounter: eb78ccb9-3648-4ec3-a4c5-9b069e492ad6
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ""
        name: ROLLING12MONTHSALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3593ab52-5241-4ba6-9c64-87170e135296
                stepCounter: cd36f532-f0d8-47ba-b9d6-84ea35d998c4
            transform: SUM(SALESANDREVENUE.SALES)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b728549-b754-49f1-8182-33c63a28bfac
          stepCounter: eb78ccb9-3648-4ec3-a4c5-9b069e492ad6
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ""
        name: ROLLING12MONTHREVENUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19b36c8d-6f61-4475-beeb-42cf99c19490
                stepCounter: cd36f532-f0d8-47ba-b9d6-84ea35d998c4
            transform: SUM(SALESANDREVENUE.REVENUE)
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE VIEW {{ this }}(\NACCOUNTKEY, \NACCOUNTGEOGRAPHYKEY,\NSALESTERRITORYKEY, \NFORCEID, \NFORCEPARENTID, \NNUMOFSUPPLIERSUSED, \NROLLING12MONTHSALES, \NROLLING12MONTHREVENUE) \NAS \NSELECT \NSALESANDREVENUE.ACCOUNTKEY, \NSALESANDREVENUE.ACCOUNTGEOGRAPHYKEY, \N--SALESANDREVENUE.ACCOUNTEXTERNALIDKEY,
            \NSALESANDREVENUE.SALESTERRITORYKEY, \NACCOUNT.FORCEID, \NACCOUNT.FORCEPARENTID,\NCOUNT (DISTINCT SALESANDREVENUE.SUPPLIERKEY), \NSUM(SALESANDREVENUE.SALES), \NSUM(SALESANDREVENUE.REVENUE) \NFROM FACT.SALESANDREVENUE SALESANDREVENUE \N
             INNER JOIN DIM.ACCOUNT ACCOUNT
                ON \N ACCOUNT.ACCOUNTKEY = SALESANDREVENUE.ACCOUNTKEY\NWHERE DATEDIFF(MONTH,SALESANDREVENUE.TRANSACTIONDATE,SALESANDREVENUE.MAXRECEIPTDATE) <= 12\NGROUP BY \N SALESANDREVENUE.ACCOUNTKEY \N , SALESANDREVENUE.ACCOUNTGEOGRAPHYKEY \N--  , SALESANDREVENUE.ACCOUNTEXTERNALIDKEY
            \N , SALESANDREVENUE.SALESTERRITORYKEY \N , ACCOUNT.FORCEID \N , ACCOUNT.FORCEPARENTID
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: FACT
            nodeName: SALESANDREVENUE
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('DIM','ACCOUNT') }}
            {{ ref('FACT','SALESANDREVENUE') }}
        name: VWLEADLIST
        noLinkRefs: []
  name: VW_LEADLIST
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
