fileVersion: 1
id: 474b12ee-b1d8-4aef-95de-672f1a0f4b04
name: VW_LEADLIST
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: REPORTS
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7f058f1-c23c-4f8c-b977-55aa7ed45afd
          stepCounter: 474b12ee-b1d8-4aef-95de-672f1a0f4b04
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEFACTSALESMERGE_1.REPORTINGCUSTOMERID=ACCOUNT.FORCEID
        name: ACCOUNTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb79aa2b-c7e5-482f-b8fb-01107f61a36e
                stepCounter: bc791129-d159-4fb2-a8c8-429979cdade2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a4449a0b-a949-4f59-bc7e-da3e57577753
          stepCounter: 474b12ee-b1d8-4aef-95de-672f1a0f4b04
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEFACTSALESMERGE_1.REPORTINGCUSTOMERID=ACCOUNTGEOGRAPHY.FORCEID
        name: ACCOUNTGEOGRAPHYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ba0504c3-61bc-4651-8681-10fcb409e8e4
                stepCounter: bc791129-d159-4fb2-a8c8-429979cdade2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11b248fd-8b1c-418e-a002-7df364f814ee
          stepCounter: 474b12ee-b1d8-4aef-95de-672f1a0f4b04
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEFACTSALESMERGE_1.ACCOUNT.ACCOUNTTERRITORY=SALESTERRITORY.TERRITORYNAME
        name: SALESTERRITORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23e914c3-7d49-4ca9-a54e-9dc536c511a2
                stepCounter: bc791129-d159-4fb2-a8c8-429979cdade2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd74d780-5755-4839-82ae-740538b65ce5
          stepCounter: 474b12ee-b1d8-4aef-95de-672f1a0f4b04
        config: {}
        dataType: INT
        defaultValue: ""
        description: UNIQUE IDENTIFIER FOR AN ACCOUNT. COMMONLY CALLED THE "FORCE ID"
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 87ea6a58-f1f0-4c3d-996d-16565db55a0a
                stepCounter: 745ecacb-59f4-457a-9a6f-e827d225494e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a99af121-ddd0-4569-801e-cb5ec853b47d
          stepCounter: 474b12ee-b1d8-4aef-95de-672f1a0f4b04
        config: {}
        dataType: INT
        defaultValue: ""
        description: PARENT ID FOR AN ACCOUNT. WILL BE THE SAME AS FORCEID IF THERE IS NO PARENT OR IF THIS IS THE TOP-MOST ACCOUNT IN A HIERARCHY
        name: FORCEPARENTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 87e8334d-2d20-4e98-a961-b4dcc714b647
                stepCounter: 745ecacb-59f4-457a-9a6f-e827d225494e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae58e6c3-5ad2-402c-89d4-05c150d66bcb
          stepCounter: 474b12ee-b1d8-4aef-95de-672f1a0f4b04
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "STAGEFACTSALESMERGE_1.SUPPLIERID=SUPPLIER.SUPPLIERID\nSTAGEFACTSALESMERGE_1.SUPPLIERNAME=SUPPLIER.SUPPLIERNAME\nSTAGEFACTSALESMERGE_1.CONTRACTNUMBER=SUPPLIER.CONTRACTNUMBER"
        name: NUMOFSUPPLIERSUSED
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 17ec6213-0e27-4115-ab3c-b400ce7ff853
                stepCounter: bc791129-d159-4fb2-a8c8-429979cdade2
            transform: COUNT (DISTINCT SALESANDREVENUE.SUPPLIERKEY)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc193996-4863-4084-bc38-a0443f0a2182
          stepCounter: 474b12ee-b1d8-4aef-95de-672f1a0f4b04
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ""
        name: ROLLING12MONTHSALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 88d891f1-4009-4fad-846f-67b858ce11b0
                stepCounter: bc791129-d159-4fb2-a8c8-429979cdade2
            transform: SUM(SALESANDREVENUE.SALES)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9fb4034-b683-4c0a-8520-3edcd517e77d
          stepCounter: 474b12ee-b1d8-4aef-95de-672f1a0f4b04
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ""
        name: ROLLING12MONTHREVENUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0764b9a5-3c5c-46b8-bc39-4769f4f16eac
                stepCounter: bc791129-d159-4fb2-a8c8-429979cdade2
            transform: SUM(SALESANDREVENUE.REVENUE)
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE VIEW {{ this }}(\NACCOUNTKEY, \NACCOUNTGEOGRAPHYKEY,\NSALESTERRITORYKEY, \NFORCEID, \NFORCEPARENTID, \NNUMOFSUPPLIERSUSED, \NROLLING12MONTHSALES, \NROLLING12MONTHREVENUE) \NAS \NSELECT \NSALESANDREVENUE.ACCOUNTKEY, \NSALESANDREVENUE.ACCOUNTGEOGRAPHYKEY, \N--SALESANDREVENUE.ACCOUNTEXTERNALIDKEY,
            \NSALESANDREVENUE.SALESTERRITORYKEY, \NACCOUNT.FORCEID, \NACCOUNT.FORCEPARENTID,\NCOUNT (DISTINCT SALESANDREVENUE.SUPPLIERKEY), \NSUM(SALESANDREVENUE.SALES), \NSUM(SALESANDREVENUE.REVENUE) \NFROM FACT.SALESANDREVENUE SALESANDREVENUE \N
             INNER JOIN DIM.ACCOUNT ACCOUNT
                ON \N ACCOUNT.ACCOUNTKEY = SALESANDREVENUE.ACCOUNTKEY\NWHERE DATEDIFF(MONTH,SALESANDREVENUE.TRANSACTIONDATE,SALESANDREVENUE.MAXRECEIPTDATE) <= 12\NGROUP BY \N SALESANDREVENUE.ACCOUNTKEY \N , SALESANDREVENUE.ACCOUNTGEOGRAPHYKEY \N--  , SALESANDREVENUE.ACCOUNTEXTERNALIDKEY
            \N , SALESANDREVENUE.SALESTERRITORYKEY \N , ACCOUNT.FORCEID \N , ACCOUNT.FORCEPARENTID
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: FACT
            nodeName: SALESANDREVENUE
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('DIM','ACCOUNT') }}
            {{ ref('FACT','SALESANDREVENUE') }}
        name: VWLEADLIST
        noLinkRefs: []
  name: VW_LEADLIST
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
