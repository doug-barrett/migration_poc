fileVersion: 1
id: f759e7aa-bfda-4635-a409-000e53daae44
name: VIEW_PVIEW_VRL_AUS_GAS_VW
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 00801d5c-17f3-47db-a5ca-cc5b4c3b11ae
          stepCounter: f759e7aa-bfda-4635-a409-000e53daae44
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: IDFLOWNET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 01a1b083-d104-45b8-b243-1dbc29b5156c
                stepCounter: 4d5f8dc2-7128-46f3-9f46-cce4f98b49ae
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3579ca46-4326-47d2-bd0e-022bc7adec87
          stepCounter: f759e7aa-bfda-4635-a409-000e53daae44
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d743abc-ee18-4c9e-82b4-cefbb60fc5e0
                stepCounter: 79c9f452-8395-416a-93d1-1a1b09a2afa3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1282ad5-996f-47e3-9730-ecb50a713a92
          stepCounter: f759e7aa-bfda-4635-a409-000e53daae44
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: INJ_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67cf82f3-780b-4d68-879b-4d9c48ab3b45
                stepCounter: 79c9f452-8395-416a-93d1-1a1b09a2afa3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8afa9aad-d982-4826-9de6-881981086549
          stepCounter: f759e7aa-bfda-4635-a409-000e53daae44
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: LIFT_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67cf82f3-780b-4d68-879b-4d9c48ab3b45
                stepCounter: 79c9f452-8395-416a-93d1-1a1b09a2afa3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a2028e4-1df6-4ae8-bae8-d3313e81e0f4
          stepCounter: f759e7aa-bfda-4635-a409-000e53daae44
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: FORMATION_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67cf82f3-780b-4d68-879b-4d9c48ab3b45
                stepCounter: 79c9f452-8395-416a-93d1-1a1b09a2afa3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b7b787c-77be-4f5d-8ebd-6c345dc469e6
          stepCounter: f759e7aa-bfda-4635-a409-000e53daae44
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: FUEL_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67cf82f3-780b-4d68-879b-4d9c48ab3b45
                stepCounter: 79c9f452-8395-416a-93d1-1a1b09a2afa3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 913b21b0-3ff5-4b38-961f-e273ec03ec93
          stepCounter: f759e7aa-bfda-4635-a409-000e53daae44
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: FLARE_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67cf82f3-780b-4d68-879b-4d9c48ab3b45
                stepCounter: 79c9f452-8395-416a-93d1-1a1b09a2afa3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4c59891-9d3e-46b0-b5ad-527e8eebb1b4
          stepCounter: f759e7aa-bfda-4635-a409-000e53daae44
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: THRUPUT_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67cf82f3-780b-4d68-879b-4d9c48ab3b45
                stepCounter: 79c9f452-8395-416a-93d1-1a1b09a2afa3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8af468b-cde4-4a43-a9b6-c501384548d3
          stepCounter: f759e7aa-bfda-4635-a409-000e53daae44
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: B10_DOWN_HOLE_PRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39a1465f-0fdd-443d-8245-7a6fa25da76f
                stepCounter: 85e0ef36-c6ba-4104-9cbd-88c0747b7946
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 441eafe3-b00c-4e91-a620-cd2094e27354
          stepCounter: f759e7aa-bfda-4635-a409-000e53daae44
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PRESS_UOM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f84d38d4-0c7d-41c6-a1d1-f1f565ce0cd9
                stepCounter: b357e5f5-9796-48cc-a1a8-b82071f04338
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c3cb4c6-21b5-446c-bc9d-c2df67db4a65
          stepCounter: f759e7aa-bfda-4635-a409-000e53daae44
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: BU_SF_ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2461b3f-8900-4460-9da7-dc1b4d0593bc
                stepCounter: a23239e4-617a-4ab9-a42c-1fd9220b7fb3
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_PVIEW_VRL_AUS_GAS_VW: f759e7aa-bfda-4635-a409-000e53daae44
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_PVIEW_VRL_AUS_GAS_VW') }} AS SELECT g.idflownet,
                   CAST(ge.dttm AS date) AS date,
                   round(sum(CASE WHEN lower(g.name) like '%inj%' THEN ge.volgascalc ELSE 0 END), 2) AS inj_gas,
                   round(sum(CASE WHEN lower(g.name) like '%wna lift%' OR lower(g.name) like '%wnb lift%' THEN ge.volgascalc ELSE 0 END), 2) AS lift_gas,
                   round(sum(CASE WHEN lower(g.name) like '%formation%' THEN ge.volgascalc ELSE 0 END), 2) AS formation_gas,
                   round(sum(CASE WHEN lower(g.name) like '%fuel%' THEN ge.volgascalc ELSE 0 END), 2) AS fuel_gas,
                   round(sum(CASE WHEN lower(g.name) like '%flare%' THEN ge.volgascalc ELSE 0 END), 2) AS flare_gas,
                   round(sum(CASE WHEN lower(g.name) like '%wna lift%' OR lower(g.name) like '%wnb lift%' OR lower(g.name) like '%formation%' THEN ge.volgascalc ELSE 0 END), 2) AS thruput_gas,
                   round(avg(pe.value), 2) AS b10_down_hole_press,
                   p.uomreading press_uom,
                   WS_EDW.PVIEW_SYSSECURITYTYP_VET_BU_ROLE(h.SYSSECURITYTYP) AS BU_SF_ROLE
              FROM DS_PRODVIEW.PVT_pvunitmeterpdgas g
             INNER JOIN DS_PRODVIEW.PVT_pvunitmeterpdgasentry ge
                ON g.idrec = ge.idrecparent
              LEFT JOIN DS_PRODVIEW.PVT_pvunitmeaspt p
                ON p.idflownet = p.idflownet
               AND lower(p.name) like '%b10 down hole press%'
              LEFT JOIN DS_PRODVIEW.PVT_pvunitmeasptentry pe
                ON p.idrec = pe.idrecparent
               AND ge.dttm = pe.dttm
             INNER JOIN DS_PRODVIEW.PVT_pvflownetheader h
                ON h.idflownet = g.idflownet
             WHERE g.idflownet = '58877C62BE0F489EA5E5B14F1A3D3947'
             GROUP BY g.idflownet,
                      h.SYSSECURITYTYP,
                      ge.dttm,
                      p.uomreading
        dependencies:
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITMETERPDGAS
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITMETERPDGAS') }}
        name: VIEW_PVIEW_VRL_AUS_GAS_VW
        noLinkRefs: []
  name: VIEW_PVIEW_VRL_AUS_GAS_VW
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
