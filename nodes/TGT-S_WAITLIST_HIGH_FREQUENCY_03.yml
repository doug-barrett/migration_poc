fileVersion: 1
id: 71c20e53-b691-47e5-8561-ad1abef0489c
name: S_WAITLIST_HIGH_FREQUENCY_03
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Staging of Elective Services Waitlist"
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b61958d-811b-4b23-b924-f11890f6ab2e
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: WAITLIST_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72ac5d31-0410-466a-83cf-88855b88368c
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: "'W' + CONVERT(varchar,ds_pims_waiting_list_entries.wlist_refno)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3577e5cc-fad8-44a5-a4b8-2ef0a60423d5
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: WAITLIST_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'W'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ddfa0a2-bac7-4317-bfb9-8f866c277c38
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WLIST_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72ac5d31-0410-466a-83cf-88855b88368c
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e19ce4e5-a798-4671-ade5-e62d1f825ecf
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e16ad8e0-4912-482e-9888-176f95f3db3e
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 913bb5a4-7776-4cad-9942-17bea39a1667
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFRL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 45024991-df53-4c1c-81be-8ac36a442528
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec70aa95-2a27-47ba-8d16-cfcae3942617
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REFERRAL_RECEIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d559d91-e33e-47a7-a819-1f7cce3c6112
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d2d1050-f15c-4d4a-94a4-25c07068c1e1
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRED_BY_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2eb59e4d-ed8c-4413-895c-2f62daabf8bf
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 83d03d14-8fd8-4c12-9e96-590cc6046423
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRED_TO_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9ad4814-be66-4584-a9de-289a9e5a8644
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb9c2b01-4089-41bd-829a-5cf211036aa4
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRED_BY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee463a13-670e-474e-909b-796ab470f0d7
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 46cbf71a-5234-4bd7-bf24-78ac429e003a
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRED_TO_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 53c236fa-c554-49c8-b648-f11ff0f4c5f9
                stepCounter: ae7c0e60-053e-4fb8-aa4e-d49e3e08e3c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8fd2986-4e2b-4ed9-a424-d8f41a74baf3
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WLRUL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 01cb5bb0-9430-4c98-92be-c6da843e88c5
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ebee106b-bc30-41f8-b76e-bacc8f7d0fa5
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LOCAL_WLRUL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0735eef9-6f57-4376-9604-d6947f38cf7f
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04dff23a-e4db-423e-a3e1-fe847fded477
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4d42d46-5377-48ed-9814-b6bb7ab8361a
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e531bc4-b9ff-4bf4-822a-f8add361c2c9
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c8f88627-3352-4bc7-889f-bad783763b6b
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25405f93-3352-430d-899b-6ec30cb4ca51
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMET_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19618be1-f741-41a1-b6fb-ee329f9b2918
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03c279ad-9675-4cf1-87e6-4d5d3e2e7cab
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADCAT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02a41e52-ad77-4a59-8c5c-9e1bc2bd3d03
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 496399f6-d8ab-4ec7-a91c-8a40e5817863
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: BKTYP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1e6f333-0d47-4aa1-bf1c-d19e43292266
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c7443745-3391-4830-b95b-38c758b02921
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: INMGT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0317d84b-48fe-4268-8e47-2f0f1a212fe3
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d896c709-74bf-4254-83da-e73f8fcb0a88
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRITY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9da45f82-e5c3-4715-9fa6-a2079ba27739
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 93bc4d9c-d8f4-4a11-a805-f975ce793b49
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SVTYP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4cbea798-da47-488f-911c-1c3131e6152e
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa16db50-35dc-4e84-bf9a-dfe5fd024445
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: def499da-ec76-4985-9111-f1ed579df909
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4be811b6-02db-4e68-9e83-8ca9b6de220c
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: XFER_SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4145fb35-c397-4b3a-8c36-c7f8bf156bf1
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 19a93e69-945c-431c-b616-b3d8dc8c4e90
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WHOCO_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90a80ba1-9472-4097-a082-22b198dc5167
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04b544c9-0ddb-41d1-bce8-65c6458bc84e
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REMVL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ce446ad-7b4b-4094-a0d7-9b84fd634bc6
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c20d010-c912-4408-a596-872265fcc13d
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CSTAT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cf926383-a873-4d2e-8516-ed65887b30b7
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2772d2d-855f-495b-a640-e11fa15cd5c3
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ANTYP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 49ae38f4-1c86-4de8-aba5-2c1733aff0d3
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da28041f-7242-469c-8bdb-f011208e7f07
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACBKS_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 35f54fbe-6970-408a-ada1-b8b2c6dd561e
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66543be9-5dcf-475d-a408-9bd8e66909b9
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMDC_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c7c579c-9d37-47d1-bd42-8cf831b868b2
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d20b1c96-b19a-47e4-b24a-6c104ac50896
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACPRT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 913b9f72-87cd-4c6a-9a69-70a3e1593a69
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: coalesce(lldv3.ussob_value_6,ACPRT_REFNO,lldv2.ussob_value_4)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc7e7bb4-7ffe-46fd-b9fa-b81834f19b49
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: PLANNED_PROC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a18db8a-0b70-4e2e-b537-0f04e3eea350
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 12134f75-7b1d-44ce-b068-dbc36d8c0660
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EXTERNAL_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7eb1a77c-b53e-464e-88e4-ca10f0567964
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66c363c9-2154-4688-9dcd-7b4499187d37
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WLIST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 065ea057-d4a2-4882-bbf6-86cfbb25bd6b
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: IFNULL(ds_pims_waiting_list_entries.wlist_dttm, ds_pims_waiting_list_entries.remvl_dttm)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d58953a9-675f-4490-a4f3-51581226f318
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f32e18e2-22d9-4b54-be37-6860250fb42b
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8992477b-07eb-4414-9427-26bdebd59b5f
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REMVL_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 36a3fdff-30f8-45fe-b227-f477953b83cc
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0dec00a-11d3-42f5-8fe9-798628042c4a
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITING_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a977f9e-b766-4b63-9fad-8ebc40710eab
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: COALESCE(ds_pims_waiting_list_entries.waiting_start_dttm,ds_pims_waiting_list_entries.wlist_dttm,ds_pims_waiting_list_entries.remvl_dttm)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 775ccf6b-4288-446d-8738-a0a6b19a8722
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITLIST_SUSPENSION_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9b8c7fd0-fd04-426f-9a03-37fb8b8bb0e2
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a96cc789-c5b2-43cc-b15e-2ef519e89f1d
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ACKNW_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a53052a-770e-4aa6-ad4e-854493227a19
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64f98b17-5495-4bd5-801b-0c1049740395
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADM_CARE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d77ce402-cc2e-40f1-8fb2-a6a9efd88e32
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57184226-fcfd-491a-a03d-400a64e03e35
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: BOOK_STATUS_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4083150f-31cf-4e40-bfff-2932be8d3320
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 35d7f233-8604-4d65-b542-8b79b89047d3
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CERTAINTY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 97f5140c-14e3-4f78-a330-2be2ffc6592f
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4d14e18-c750-495d-89a8-aaf4085c9d44
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FSA_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75d1dd7f-d27d-4e04-a2ac-8779e738b0a0
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e856bddc-87f7-469a-a00f-4d3f55bd74ec
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ADMIT_READY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5da1380-a7f3-4bad-af1b-81f9c753063b
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c7a975a8-de4e-4b06-9e71-7f272cf93b6a
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: SHORT_NOTICE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 70db9b8f-8296-4824-9ec9-cc00ecdf66cb
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e458d042-74db-4da9-a524-3af887d03711
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACTIVE_INDICATOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9f39335b-2dc3-4307-8c5c-21078dba94f8
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa63b200-97eb-462c-b428-97cb2d9576da
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: THEAT_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b7c0990-620d-42e7-ac31-61a9476707be
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6193dbf-5d39-4d5d-856d-b43ce052f02f
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LENGTH_STAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48471857-31e0-4286-b861-6df30576524a
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d77af35c-6125-4355-8fba-c2ed7ae3f083
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITING_SUSP_TOTAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f8de371-5509-492f-a1c1-fd2258f5a888
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a4a4a710-e101-4ea5-9df0-59cd008a764f
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_WAITLIST_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e16ad8e0-4912-482e-9888-176f95f3db3e
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ROW_NUMBER() OVER (PARTITION BY ds_pims_waiting_list_entries.patnt_refno ORDER BY COALESCE(ds_pims_waiting_list_entries.waiting_start_dttm,ds_pims_waiting_list_entries.wlist_dttm,ds_pims_waiting_list_entries.remvl_dttm))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae5fd4c0-bb15-4df8-9d65-ddc451cd3872
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Sequence of the waitlist withing a referral
        name: PATIENT_REFERRAL_WAITLIST_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e16ad8e0-4912-482e-9888-176f95f3db3e
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ROW_NUMBER() OVER (PARTITION BY ds_pims_waiting_list_entries.refrl_refno,ds_pims_waiting_list_entries.patnt_refno ORDER BY COALESCE(ds_pims_waiting_list_entries.waiting_start_dttm,ds_pims_waiting_list_entries.wlist_dttm ,ds_pims_waiting_list_entries.remvl_dttm) ,ds_pims_waiting_list_entries.svtyp_refno DESC ,ds_pims_waiting_list_entries.wlist_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 541edc6b-ab5e-44a5-ba89-19c2fc81f760
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_WAITLIST_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e16ad8e0-4912-482e-9888-176f95f3db3e
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: COUNT(1) OVER (PARTITION BY ds_pims_waiting_list_entries.patnt_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0974cce-7d5e-40b4-85a0-cf5a3180a711
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: WAITLIST_APPOINTMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddac70c1-37bd-44f2-b5cd-f0049f80872b
                stepCounter: 4663c21b-e6e2-4d6b-83d0-40e35b0266f3
            transform: IFNULL(s_waitlist_activity_05.waitlist_appointment_count,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad62449b-f709-44d2-ac00-dfbd8cf19ee1
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: WAITLIST_ADMISSION_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d5ac55c7-81ef-40df-b518-b5f538f74228
                stepCounter: 4663c21b-e6e2-4d6b-83d0-40e35b0266f3
            transform: IFNULL(s_waitlist_activity_05.waitlist_admission_count,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c1038db-0881-4210-826e-61a1ab769105
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: WAITLIST_ATTENDED_APPOINTMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 62d5db15-4e76-406f-81b6-1c009821f5c6
                stepCounter: 4663c21b-e6e2-4d6b-83d0-40e35b0266f3
            transform: IFNULL(s_waitlist_activity_05.waitlist_attended_appointment_count,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a21be9a9-fd54-44f3-806a-d0fbd067f819
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: WAITLIST_ACTIVITY_OCCURED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 183fd0dc-e30c-481d-b352-0c43421e7602
                stepCounter: 4663c21b-e6e2-4d6b-83d0-40e35b0266f3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7436ee3b-0590-4abc-b365-e8842526988f
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 54a36e8f-ba7f-4068-9df0-6b9e6a8452a9
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 151d463d-0638-439c-a693-8e0d41be3477
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77765bc2-2220-40a4-9edb-66cffdb194d1
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 93102729-2033-468b-ac74-b31a8390ff5e
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIFY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05447b97-8577-4a77-ab7d-0e51aed83253
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dfb1a5c8-3815-42b0-847b-1cd1464fee0e
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MODIFY_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0820e519-7ede-45ae-a61d-b2004b3bd538
                stepCounter: 5bae6c33-9021-48f2-90a9-01c3d6e29585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57d67d2f-b580-4b49-ae9b-5ffbfce63012
          stepCounter: 71c20e53-b691-47e5-8561-ad1abef0489c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_WAITLIST_ACTIVITY_05: 4663c21b-e6e2-4d6b-83d0-40e35b0266f3
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_PIMS_WAITING_LIST_ENTRIES
          - locationName: TGT
            nodeName: S_WAITLIST_ACTIVITY_05
        join:
          joinCondition: |-
            FROM ds_pims_waiting_list_entries
              LEFT OUTER JOIN ds_pims_referrals
                ON ds_pims_waiting_list_entries.refrl_refno = ds_pims_referrals.refrl_refno
              LEFT OUTER JOIN {{ ref('TGT','S_WAITLIST_ACTIVITY_05') }}
                ON ds_pims_waiting_list_entries.wlist_refno = s_waitlist_activity_05.wlist_refno
              LEFT OUTER JOIN (
                    SELECT *
                      FROM ds_pims_ldd_local_datavalues
                     WHERE USSCR_REFNO = 1000020060
                   ) lldv2
                ON ds_pims_waiting_list_entries.patnt_refno = lldv2.patnt_refno
               AND ds_pims_waiting_list_entries.wlist_refno = lldv2.sorce_refno
              LEFT OUTER JOIN (
                    SELECT *
                      FROM ds_pims_ldd_local_datavalues
                     WHERE USSCR_REFNO = 2000020300
                   ) lldv3
                ON ds_pims_waiting_list_entries.patnt_refno = lldv3.patnt_refno
               AND ds_pims_waiting_list_entries.wlist_refno = lldv3.sorce_refno
             WHERE ds_pims_waiting_list_entries.remvl_dttm IS NULL
        name: S_WAITLIST_HIGH_FREQUENCY_03
        noLinkRefs: []
  name: S_WAITLIST_HIGH_FREQUENCY_03
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
