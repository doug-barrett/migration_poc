fileVersion: 1
id: d413426e-7801-434e-bf9a-f41e798a34bd
name: S_CONSOLIDATE_WHITEBOARD_ACTION_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Only custom procedure running from 19092023 for ED incremental process."
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f51b13f-89a1-4710-ba02-fd51a2441745
          stepCounter: d413426e-7801-434e-bf9a-f41e798a34bd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e9a5403-d0b8-4580-ac3a-176042673c74
                stepCounter: 19f0f96c-e43a-4042-85cb-705a024aed20
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d0a8e4dc-afa2-4216-b487-6ad3ef6b8164
          stepCounter: d413426e-7801-434e-bf9a-f41e798a34bd
        config: {}
        dataType: INT
        defaultValue: ""
        description: whiteboard unique id from WB cacheAudit table
        isBusinessKey: true
        name: WHITEBOARD_ACTION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 453d2449-3245-4cd1-9ab2-249f3f5c4d0e
                stepCounter: 555aeb58-1fff-4f50-affb-02fd1a4f7b68
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f916ca6-a54d-4827-92dd-159f1b10ac9c
          stepCounter: d413426e-7801-434e-bf9a-f41e798a34bd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: iPM encounter number
        name: ATTENDANCE_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a8b7fc48-c893-4cda-8f8a-55a8a95a9661
                stepCounter: 19f0f96c-e43a-4042-85cb-705a024aed20
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c282ca7-27c3-4419-a89a-9a60279ad7d6
          stepCounter: d413426e-7801-434e-bf9a-f41e798a34bd
        config: {}
        dataType: INT
        defaultValue: ""
        description: stay_reference_no
        name: STAY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c68619f6-0f73-417e-a9eb-ca2a33405ac3
                stepCounter: 19f0f96c-e43a-4042-85cb-705a024aed20
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 00b44a47-5ac0-432b-9bd6-3b09f6272779
          stepCounter: d413426e-7801-434e-bf9a-f41e798a34bd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_whiteboard_action.WB_action_specialty_code=dim_ED_WB_action_specialty.ED_WB_action_specialty_code
        name: DIM_ED_WB_ACTION_SPECIALTY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33fb88e0-a616-4125-93a7-2a65db26df2c
                stepCounter: 19f0f96c-e43a-4042-85cb-705a024aed20
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67b5aba7-2224-4909-b965-8ff45343c5b8
          stepCounter: d413426e-7801-434e-bf9a-f41e798a34bd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: iPM specialty under which the action was performed
        name: WB_ACTION_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d9f9527a-e143-4787-8a3a-1eb0fe994c6c
                stepCounter: 19f0f96c-e43a-4042-85cb-705a024aed20
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 341c05c3-111f-4338-93e7-1c15a466a79c
          stepCounter: d413426e-7801-434e-bf9a-f41e798a34bd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: iPM specialty group EMMED or other as they are managed independently
        name: SPECIALTY_CODE_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c864a1c5-ca5f-42ae-88d1-04a0a720344b
                stepCounter: 19f0f96c-e43a-4042-85cb-705a024aed20
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d4416ee-0195-466b-bb78-7ce3fb5a707a
          stepCounter: d413426e-7801-434e-bf9a-f41e798a34bd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_WB_ACTION_ASSIGNED_CONSULTANT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 902e3d0a-a6cc-44fc-b085-7dd5084dd4fd
                stepCounter: 555aeb58-1fff-4f50-affb-02fd1a4f7b68
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0033c0ee-5270-4685-9fea-bdc26950175f
          stepCounter: d413426e-7801-434e-bf9a-f41e798a34bd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_CENTRIC_SEENBY_CLINICIAN_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b7f16bc-7fce-4726-96e2-268c12b478f3
          stepCounter: d413426e-7801-434e-bf9a-f41e798a34bd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_whiteboard_action.WB_action_performed=dim_ED_WB_action.WB_action_performed
        name: DIM_ED_WB_ACTION_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9b42e868-a087-473b-8621-19fab6e8e8e5
                stepCounter: 19f0f96c-e43a-4042-85cb-705a024aed20
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7482c980-571a-462d-a75e-6887211a6536
          stepCounter: d413426e-7801-434e-bf9a-f41e798a34bd
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: WB_ACTION_PERFORMED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 98124df3-5931-4489-afb9-725c789cba56
                stepCounter: 19f0f96c-e43a-4042-85cb-705a024aed20
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9a86b7d-6957-4e94-aa63-dc3086d2d38c
          stepCounter: d413426e-7801-434e-bf9a-f41e798a34bd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: datetime at which the action was performed
        name: WB_ACTION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6105212d-a630-4693-ae46-71b3532043a8
                stepCounter: 19f0f96c-e43a-4042-85cb-705a024aed20
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3cd87dc6-f2d2-45e6-8870-4c8e96702600
          stepCounter: d413426e-7801-434e-bf9a-f41e798a34bd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_whiteboard_action.WB_action_seenby_doctor=dim_ED_WB_action_seenby_clinician.WB_action_seenby_clinician_user_code
        name: DIM_ED_WB_ACTION_SEENBY_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64c9b1e1-d80a-43a0-97f4-2ce92a2fb87d
                stepCounter: 19f0f96c-e43a-4042-85cb-705a024aed20
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a4d5f84-bf37-43cc-8e0c-da768687856b
          stepCounter: d413426e-7801-434e-bf9a-f41e798a34bd
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: WB_ACTION_SEENBY_DOCTOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 44b8c057-3357-4e78-b51f-535c0730bd10
                stepCounter: 19f0f96c-e43a-4042-85cb-705a024aed20
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a0372254-8548-4f13-a129-0cc88851671b
          stepCounter: d413426e-7801-434e-bf9a-f41e798a34bd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: iPM assigned consultant at time of action
        name: WB_ACTION_ASSIGNED_CONSULTANT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b724885-52d1-4055-a39d-be0c3210c1d3
                stepCounter: 19f0f96c-e43a-4042-85cb-705a024aed20
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 93ffe525-e962-4abd-a848-0b0607f13fe0
          stepCounter: d413426e-7801-434e-bf9a-f41e798a34bd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: datetime the record was crated
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d1d2ef98-e95e-4942-99dc-26a2563d9ed8
                stepCounter: 19f0f96c-e43a-4042-85cb-705a024aed20
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b5b2872-272a-425c-9d7a-8a987de5d396
          stepCounter: d413426e-7801-434e-bf9a-f41e798a34bd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e43d3d53-5bf8-4486-93e2-8dea12ca4a32
                stepCounter: 19f0f96c-e43a-4042-85cb-705a024aed20
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cdcaa177-ec2a-4519-8ab9-2e5b15b8f6fd
          stepCounter: d413426e-7801-434e-bf9a-f41e798a34bd
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bd786a64-1453-48ce-a960-4de28034d785
                stepCounter: 19f0f96c-e43a-4042-85cb-705a024aed20
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 070ce8ca-5b9a-4cea-a16a-acb914d23ccf
          stepCounter: d413426e-7801-434e-bf9a-f41e798a34bd
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CREATE_USER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a5519c59-00bd-4297-a92b-d51e4a3fbe49
                stepCounter: 19f0f96c-e43a-4042-85cb-705a024aed20
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a9b7ac2-0054-4cc6-8fef-dfe01abf59af
          stepCounter: d413426e-7801-434e-bf9a-f41e798a34bd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_whiteboard_action.service_point_code=dim_ED_location.ED_location_reference_no
        name: DIM_ED_LOCATION_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b71f9f1c-89ba-4af7-a12e-b5f399030060
                stepCounter: 19f0f96c-e43a-4042-85cb-705a024aed20
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: efda14f4-05bd-4037-ae75-ef33e52c5500
          stepCounter: d413426e-7801-434e-bf9a-f41e798a34bd
        config: {}
        dataType: INT
        defaultValue: ""
        description: Sequence tof action within encounter
        name: ACTION_SEQUENCE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f5580149-a349-4ff3-b537-d95afb52e25d
                stepCounter: 19f0f96c-e43a-4042-85cb-705a024aed20
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5974b970-5308-47f9-ba3e-b5c13da15a7e
          stepCounter: d413426e-7801-434e-bf9a-f41e798a34bd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SERVICE_POINT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2394b16-ad90-4e7d-aabb-77c1fa485ade
                stepCounter: 19f0f96c-e43a-4042-85cb-705a024aed20
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f4b57f2-9038-4a2e-8bb7-288d2911b90b
          stepCounter: d413426e-7801-434e-bf9a-f41e798a34bd
        config: {}
        dataType: INT
        defaultValue: ""
        description: Sequence of seen by action within encounter
        name: SEEN_BY_ACTION_SEQUENCE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 53bfdc5f-c0cc-4912-8fd6-18a98233f17a
                stepCounter: 19f0f96c-e43a-4042-85cb-705a024aed20
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24d0917e-1a4f-410b-9aa2-476e905377cc
          stepCounter: d413426e-7801-434e-bf9a-f41e798a34bd
        config: {}
        dataType: INT
        defaultValue: ""
        description: Sequence withing an encounter grouping removal actions with thier corresponding actions
        name: REMOVAL_ACTION_SEQUENCE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d59775bb-3016-47c4-aef0-053a47edade9
                stepCounter: 19f0f96c-e43a-4042-85cb-705a024aed20
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e3c769c-5b6d-4020-acea-e0be1c723a74
          stepCounter: d413426e-7801-434e-bf9a-f41e798a34bd
        config: {}
        dataType: INT
        defaultValue: ""
        description: Sequence or seen bys within an specialty grouping
        name: SPECIALTY_GROUP_SEQUENCE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09b4ede5-69e3-4484-a8a0-cfc5494c479d
                stepCounter: 19f0f96c-e43a-4042-85cb-705a024aed20
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c402ba1-e16d-42b5-b7ac-d0bcb4710de5
          stepCounter: d413426e-7801-434e-bf9a-f41e798a34bd
        config: {}
        dataType: INT
        defaultValue: ""
        description: Reverse Sequence for seen bys within an specialty grouping
        name: SPECIALTY_GROUP_SEQUENCE_REV
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7918f8df-b30a-431f-97bd-cbbfdc16defb
                stepCounter: 19f0f96c-e43a-4042-85cb-705a024aed20
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4cc77bcc-02ee-4eda-8c76-3d58136d2c65
          stepCounter: d413426e-7801-434e-bf9a-f41e798a34bd
        config: {}
        dataType: INT
        defaultValue: ""
        description: Grouping removal actions with thier corresponding actions
        name: REMOVAL_GROUPING
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aba0570c-32b9-440f-a990-6d469a36b582
                stepCounter: 19f0f96c-e43a-4042-85cb-705a024aed20
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 677f42c7-1711-4088-b02b-676ee9dd853c
          stepCounter: d413426e-7801-434e-bf9a-f41e798a34bd
        config: {}
        dataType: INT
        defaultValue: ""
        description: Was the action performed to remove a previous action? 1 = yes
        name: REMOVE_ACTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e24339a-f251-4a59-9677-03ac72f09843
                stepCounter: 19f0f96c-e43a-4042-85cb-705a024aed20
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0cd63aca-aafb-4276-8eb9-ffc89eff3aea
          stepCounter: d413426e-7801-434e-bf9a-f41e798a34bd
        config: {}
        dataType: INT
        defaultValue: ""
        description: Is the action deleted by a removal action
        name: REMOVED_ACTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2cbc5971-79ac-427e-a182-6976b296a150
                stepCounter: 19f0f96c-e43a-4042-85cb-705a024aed20
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 52f9d9d4-8921-40d6-9baf-472e2458958a
          stepCounter: d413426e-7801-434e-bf9a-f41e798a34bd
        config: {}
        dataType: INT
        defaultValue: ""
        description: Was the action performed a seenby action? 1 = yes
        name: SEEN_BY_ACTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1617bc02-aecc-4ec3-8f99-863310a7e76a
                stepCounter: 19f0f96c-e43a-4042-85cb-705a024aed20
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1778072-1fcb-4609-b7c7-6e984b7728f5
          stepCounter: d413426e-7801-434e-bf9a-f41e798a34bd
        config: {}
        dataType: INT
        defaultValue: ""
        description: Was the action performed a Doctor seenby action to show in ED stay
        name: SEEN_BY_ACTION_DR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 98124df3-5931-4489-afb9-725c789cba56
                stepCounter: 19f0f96c-e43a-4042-85cb-705a024aed20
            transform: |-
              CASE WHEN s_centric_whiteboard_action.WB_action_performed IN ('Doctor Seen By','Doctor Handover') THEN 1
                          ELSE 0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4da8ce06-5ba4-44e2-b0e1-4b360edbe7f0
          stepCounter: d413426e-7801-434e-bf9a-f41e798a34bd
        config: {}
        dataType: INT
        defaultValue: ""
        description: Sequence to handle non unique concerto user ids
        name: AUDIT_SEQUENCE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7769e130-98fc-4379-9a96-6dfd0c714512
                stepCounter: 19f0f96c-e43a-4042-85cb-705a024aed20
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e242a909-bb64-49b2-8a81-b0ec49c048ea
          stepCounter: d413426e-7801-434e-bf9a-f41e798a34bd
        config: {}
        dataType: INT
        defaultValue: ""
        description: Action type sequence within an event
        name: EVENT_ACTION_TYPE_SEQUENCE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b89ccf01-3dc5-4850-a599-339450ea1620
                stepCounter: 19f0f96c-e43a-4042-85cb-705a024aed20
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DS_ED_WHITEBOARD_ACTION_WB: 555aeb58-1fff-4f50-affb-02fd1a4f7b68
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_CENTRIC_WHITEBOARD_ACTION
          - locationName: TGT
            nodeName: DS_ED_WHITEBOARD_ACTION_WB
        join:
          joinCondition: FROM {{ ref('TGT','DS_ED_WHITEBOARD_ACTION_WB') }}
        name: S_CONSOLIDATE_WHITEBOARD_ACTION_10
        noLinkRefs: []
  name: S_CONSOLIDATE_WHITEBOARD_ACTION_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
