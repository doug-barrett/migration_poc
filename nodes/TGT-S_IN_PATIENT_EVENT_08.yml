fileVersion: 1
id: 4f56759e-2e4d-470f-a15f-457906749985
name: S_IN_PATIENT_EVENT_08
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Table of NHIs that have a null discharge date or discharge date that is within the period calculated via parameter inpatient_lookback_days. Set parameter to 0 to load all events."
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 415ece5a-cc5b-4671-8d57-9f0622c1ea9d
          stepCounter: 4f56759e-2e4d-470f-a15f-457906749985
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRVSP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72f89dd8-4b2c-44b2-888e-3975e7b10f53
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7326ec5-065f-41e9-a104-2d9b1503587d
          stepCounter: 4f56759e-2e4d-470f-a15f-457906749985
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8755b653-4af7-45ac-95ed-1e2e7134f7a8
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c2e85ce-1b2b-4a50-9ad2-523890cc13ff
          stepCounter: 4f56759e-2e4d-470f-a15f-457906749985
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 01c61f5c-21f8-498c-8a9a-3bf9fc714db7
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9dac456d-41f2-4073-a965-62470f3aa227
          stepCounter: 4f56759e-2e4d-470f-a15f-457906749985
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_IN_PATIENT_EVENT_05
        join:
          joinCondition: |-
            FROM s_in_patient_event_05
             WHERE @v_inpatient_lookback_days = '0' -- Load all events  OR disch_date >= DATEADD(DD, CONVERT(int, @v_inpatient_lookback_days) * -1, GETDATE())  OR disch_date IS NULL
        name: S_IN_PATIENT_EVENT_08
        noLinkRefs: []
  name: S_IN_PATIENT_EVENT_08
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
