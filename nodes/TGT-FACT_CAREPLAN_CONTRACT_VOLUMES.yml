fileVersion: 1
id: 4b65329e-9442-4127-bca3-4f840d0a03b5
name: FACT_CAREPLAN_CONTRACT_VOLUMES
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e4711d53-873f-4e1d-bacc-2969ad9f9d0c
          stepCounter: 4b65329e-9442-4127-bca3-4f840d0a03b5
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: links back to encounter in fact careplan community
        name: SOURCE_ENCOUNTER_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bd8c908e-ab85-473b-8a36-701479bd4781
                stepCounter: ca3d7c8a-189c-4bce-9f99-69db552963f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03d869d5-ca44-4a13-8e5b-08343e5c2d8f
          stepCounter: 4b65329e-9442-4127-bca3-4f840d0a03b5
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: based on the careplan identifier altered to reflect the contract grain
        name: ACTIVE_CAREPLAN_MONTH_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c317b13-0e88-4d7c-a5ca-f483f805dbba
                stepCounter: ca3d7c8a-189c-4bce-9f99-69db552963f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7264693-0ad5-40b0-975e-c3e9312cbf5e
          stepCounter: 4b65329e-9442-4127-bca3-4f840d0a03b5
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d0387518-2cd7-4972-8339-2c34ff12b28d
                stepCounter: ca3d7c8a-189c-4bce-9f99-69db552963f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97060b9e-8595-4847-a956-80164f1859ae
          stepCounter: 4b65329e-9442-4127-bca3-4f840d0a03b5
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: DIM_DOMICILE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 841025b4-9d14-467b-8dd4-d4337c27235e
                stepCounter: ca3d7c8a-189c-4bce-9f99-69db552963f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d44517e-f001-47dc-b64f-9609ca5f639c
          stepCounter: 4b65329e-9442-4127-bca3-4f840d0a03b5
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: DIM_CAREPLAN_COMMUNITY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d4d85db-634e-4768-b496-be0b7598ec5a
                stepCounter: ca3d7c8a-189c-4bce-9f99-69db552963f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e4e4bc8-3877-4136-b7e0-b30bbd72b7aa
          stepCounter: 4b65329e-9442-4127-bca3-4f840d0a03b5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_careplan_contract_volumes.purchase_unit_code=dim_purchase_unit.purchase_unit_code
        name: DIM_PURCHASE_UNIT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d9c041f-76d6-44c7-8d88-936673dfd7a0
                stepCounter: d198650d-0f77-489d-92ec-0c0257cd5a43
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4f7a2d6-4c45-4dbc-ab64-695d508fb531
          stepCounter: 4b65329e-9442-4127-bca3-4f840d0a03b5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: phase_start_date
        name: PHASE_START_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 06972060-8e37-4de2-b572-516371fc621c
                stepCounter: ca3d7c8a-189c-4bce-9f99-69db552963f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f1b490ce-07ee-4512-9c8f-3e9b99eade81
          stepCounter: 4b65329e-9442-4127-bca3-4f840d0a03b5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: phase_end_date
        name: PHASE_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe222462-72d1-4866-a45d-5a1db2c2bd9c
                stepCounter: ca3d7c8a-189c-4bce-9f99-69db552963f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04fbc6ad-c1db-454b-a203-6381dfbeef00
          stepCounter: 4b65329e-9442-4127-bca3-4f840d0a03b5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CONTRACT_MONTH_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4be93bee-4a96-43cc-bd01-0a2306cf9ff8
                stepCounter: ca3d7c8a-189c-4bce-9f99-69db552963f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7830f760-a7d8-4aba-8a17-90fd31034b80
          stepCounter: 4b65329e-9442-4127-bca3-4f840d0a03b5
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: DIM_CONTRACT_MONTH_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f08fe04-6dbe-4b2b-9d9c-b7ca25e8a3b3
                stepCounter: ca3d7c8a-189c-4bce-9f99-69db552963f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d87dfe2b-6b86-4ff6-976e-766bacb839e5
          stepCounter: 4b65329e-9442-4127-bca3-4f840d0a03b5
        config: {}
        dataType: INT
        defaultValue: ""
        description: purchase_unit_volume
        name: PURCHASE_UNIT_VOLUME
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91697fea-c91b-423d-98d9-1757ed60237b
                stepCounter: ca3d7c8a-189c-4bce-9f99-69db552963f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ed5ec2a-35de-40aa-b647-1d0532345968
          stepCounter: 4b65329e-9442-4127-bca3-4f840d0a03b5
        config: {}
        dataType: INT
        defaultValue: ""
        description: NNPAC_volume, is one volume for the first month in the year the careplan is open
        name: NNPAC_VOLUME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 10a9e1ca-afc2-48f8-b51c-5edbf4375c5e
                stepCounter: ca3d7c8a-189c-4bce-9f99-69db552963f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d0f9c33-e129-4ac2-a9ad-e73f8b302a7d
          stepCounter: 4b65329e-9442-4127-bca3-4f840d0a03b5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_CAREPLAN_CONTRACT_VOLUMES: ca3d7c8a-189c-4bce-9f99-69db552963f9
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_CAREPLAN_CONTRACT_VOLUMES
        join:
          joinCondition: |-
            FROM {{ ref('TGT','S_CAREPLAN_CONTRACT_VOLUMES') }}
             WHERE unique_month_sequence = 1 --ensures no dupilcates due to mutiple careplans
        name: FACT_CAREPLAN_CONTRACT_VOLUMES
        noLinkRefs: []
  name: FACT_CAREPLAN_CONTRACT_VOLUMES
  overrideSQL: false
  schema: ""
  sqlType: Fact
  type: sql
  version: 1
type: Node
