fileVersion: 1
id: 8528d871-7672-465e-98ce-cb287560803a
name: STAGE_RES_ECON_DETAIL_SUB2
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: "Created as UDV due to Wherescape join length limitations (12000 chars, 165 rows).  Cross join with Econ Variables to unpivoid Mosaic data and only rows where value <> 0"
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f9a6cea-2e36-4d02-ae54-182d61ea650f
          stepCounter: 8528d871-7672-465e-98ce-cb287560803a
        config: {}
        dataType: NUMBER(18)
        defaultValue: ""
        description: ""
        name: RESULT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f1d94a9e-7ca3-4fc9-8ddb-793f1dbba06b
                stepCounter: 73041168-0d77-4a50-b09b-1dc5148a9a7f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8999f195-51d2-460f-868a-9cafa0a9d6ae
          stepCounter: 8528d871-7672-465e-98ce-cb287560803a
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: RESERVE_CATEGORY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5b9f41fd-e48b-4cd0-9743-092d4a718986
                stepCounter: 73041168-0d77-4a50-b09b-1dc5148a9a7f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c397ba77-7934-46f4-907d-ef76866a6cc9
          stepCounter: 8528d871-7672-465e-98ce-cb287560803a
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9b902fab-cc1b-40cb-9b23-d3b82cc7b307
                stepCounter: 73041168-0d77-4a50-b09b-1dc5148a9a7f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9ffd449-9db1-4096-b3ac-9cb6f36423e7
          stepCounter: 8528d871-7672-465e-98ce-cb287560803a
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea6d1c53-26f3-45ca-8765-c9eb35997bc0
                stepCounter: 73041168-0d77-4a50-b09b-1dc5148a9a7f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78c8ff17-b0dc-48f8-8aa8-ab810c832da8
          stepCounter: 8528d871-7672-465e-98ce-cb287560803a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Last Day of Economics Details Month, Year
        name: ACCT_PER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74b460e1-ae0f-4f12-9a2c-0577c92a1b40
          stepCounter: 8528d871-7672-465e-98ce-cb287560803a
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: Reserve Economics Variable Type Code
        name: VARIABLE_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f2e5825-f361-4b61-868c-7659417837ef
                stepCounter: 8a1525e5-68c5-43f0-a476-cc3d5f080a3d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cadb5052-b4f4-47e3-bd43-143deda784d1
          stepCounter: 8528d871-7672-465e-98ce-cb287560803a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_VARIABLE_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 04e84d20-5874-43da-b85e-3f14ff1846c6
                stepCounter: 8a1525e5-68c5-43f0-a476-cc3d5f080a3d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 28049014-e623-4f49-a544-5bc5958e7648
          stepCounter: 8528d871-7672-465e-98ce-cb287560803a
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Interpolate Yearly Data To Monthly
        name: YR_TO_MTH_FLG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f997da91-c0c4-4a26-ac3e-01ea896a01c2
                stepCounter: 8a1525e5-68c5-43f0-a476-cc3d5f080a3d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: def4cba8-47fb-43bc-8018-bac84ef7c890
          stepCounter: 8528d871-7672-465e-98ce-cb287560803a
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Value UOM Code
        name: UOM_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e8d5f8d-975f-4091-9bb9-f31906ae2223
                stepCounter: 8a1525e5-68c5-43f0-a476-cc3d5f080a3d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d82c85b-965b-4d23-8441-7ffc1004fc7a
          stepCounter: 8528d871-7672-465e-98ce-cb287560803a
        config: {}
        dataType: DECIMAL(36,8)
        defaultValue: ""
        description: Variable numeric value
        name: VALUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_RES_ECON_DETAIL_SUB2: 8528d871-7672-465e-98ce-cb287560803a
          STAGE_RES_ECON_DETAIL_SUB1: 73041168-0d77-4a50-b09b-1dc5148a9a7f
          DIM_RES_VARIABLE_TYPE: 8a1525e5-68c5-43f0-a476-cc3d5f080a3d
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','STAGE_RES_ECON_DETAIL_SUB2') }} AS SELECT TARGET.RESULT_ID AS RESULT_ID,
                   TARGET.RESERVE_CATEGORY_ID ,
                   TARGET.YEAR AS YEAR,
                   TARGET.MONTH AS
             MONTH ,
                   LAST_DAY(TO_DATE(TRIM(TO_CHAR(TARGET.YEAR,'0000')) || TRIM(TO_CHAR(DECODE(TARGET.MONTH,0,12,TARGET.MONTH),'00')) || '01','YYYYMMDD')) AS ACCT_PER_DATE ,
                   TARGET.VARIABLE_TYPE_CODE AS VARIABLE_TYPE_CODE ,
                   NVL(TARGET.DIM_VARIABLE_TYPE_KEY,0) AS DIM_VARIABLE_TYPE_KEY ,
                   NVL(TARGET.YR_TO_MTH_FLG,'N') AS YR_TO_MTH_FLG ,
                   TARGET.UOM_CODE AS UOM_CODE ,
                   NVL(TARGET.VALUE,0) AS VALUE
              FROM (
                    SELECT STAGE_RES_ECON_DETAIL_SUB1.RESULT_ID AS RESULT_ID ,
                           STAGE_RES_ECON_DETAIL_SUB1.RESERVE_CATEGORY_ID ,
                           STAGE_RES_ECON_DETAIL_SUB1.YEAR AS YEAR ,
                           STAGE_RES_ECON_DETAIL_SUB1.MONTH AS
                     MONTH ,
                           DIM_RES_VARIABLE_TYPE.VARIABLE_TYPE_CODE AS VARIABLE_TYPE_CODE ,
                           DIM_RES_VARIABLE_TYPE.DIM_VARIABLE_TYPE_KEY AS DIM_VARIABLE_TYPE_KEY ,
                           DIM_RES_VARIABLE_TYPE.YR_TO_MTH_FLG AS YR_TO_MTH_FLG ,
                           DIM_RES_VARIABLE_TYPE.UOM_CODE AS UOM_CODE ,
                           DECODE(DIM_RES_VARIABLE_TYPE.VARIABLE_TYPE_CODE , 'GROSS_BOE_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.total_company_boe_volume , 'WI_BOE_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.company_wi_boe_volume , 'COSHARE_BOE_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.company_share_boe_volume , 'GROSS_OIL_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.oil_pool_volume , 'WI_OIL_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.oil_working_interest_volume , 'RI_OIL_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.oil_royalty_interest_volume , 'COSHARE_OIL_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.company_share_oil_volume , 'GROSS_GAS_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.gas_pool_volume , 'WI_GAS_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.gas_working_interest_volume , 'RI_GAS_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.gas_royalty_interest_volume , 'COSHARE_GAS_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.company_share_gas_volume , 'GROSS_NGL_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.ngl_pool_volume , 'WI_NGL_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.ngl_working_interest_volume , 'RI_NGL_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.ngl_royalty_interest_volume , 'COSHARE_NGL_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.company_share_ngl_volume , 'GROSS_ETH_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.eth_pool_volume , 'WI_ETH_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.eth_working_interest_volume , 'RI_ETH_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.eth_royalty_interest_volume , 'COSHARE_ETH_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.company_share_eth_volume , 'GROSS_PROP_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.prop_pool_volume , 'WI_PROP_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.prop_working_interest_volume , 'RI_PROP_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.prop_royalty_interest_volume , 'COSHARE_PROP_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.company_share_prop_volume , 'GROSS_BUTANE_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.but_pool_volume , 'WI_BUTANE_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.but_working_interest_volume , 'RI_BUTANE_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.but_royalty_interest_volume , 'COSHARE_BUTANE_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.company_share_but_volume , 'GROSS_COND_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.cond_pool_volume , 'WI_COND_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.cond_working_interest_volume , 'RI_COND_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.cond_royalty_interest_volume , 'COSHARE_COND_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.company_share_cond_volume , 'GROSS_FCOND_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.fcond_lease_volume , 'WI_FCOND_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.fcond_working_interest_volume , 'RI_FCOND_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.fcond_royalty_interest_volume , 'COSHARE_FCOND_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.company_share_fcond_volume , 'OIL_WI_REVENUE', STAGE_RES_ECON_DETAIL_SUB1.oil_working_interest_revenue , 'GAS_WI_REVENUE', STAGE_RES_ECON_DETAIL_SUB1.gas_working_interest_revenue , 'NGL_WI_REVENUE', STAGE_RES_ECON_DETAIL_SUB1.ngl_working_interest_revenue , 'ETHANE_WI_REVENUE', STAGE_RES_ECON_DETAIL_SUB1.eth_working_interest_revenue , 'PROPANE_WI_REVENUE', STAGE_RES_ECON_DETAIL_SUB1.prop_working_interest_revenue , 'BUTANE_WI_REVENUE', STAGE_RES_ECON_DETAIL_SUB1.but_working_interest_revenue , 'CONDENSATE_WI_REVENUE', STAGE_RES_ECON_DETAIL_SUB1.cond_working_interest_revenue , 'FIELD_CONDENSATE_WI_REVENUE', STAGE_RES_ECON_DETAIL_SUB1.fcond_revenue , 'COMPANY_SHARE_OIL_REVENUE', STAGE_RES_ECON_DETAIL_SUB1.company_share_oil_revenue , 'COMPANY_SHARE_GAS_REVENUE', STAGE_RES_ECON_DETAIL_SUB1.company_share_gas_revenue , 'COMPANY_SHARE_NGL_REVENUE', STAGE_RES_ECON_DETAIL_SUB1.company_share_NGL_revenue , 'COMPANY_SHARE_ETHANE_REVENUE', STAGE_RES_ECON_DETAIL_SUB1.company_share_eth_revenue , 'COMPANY_SHARE_PROPANE_REVENUE', STAGE_RES_ECON_DETAIL_SUB1.company_share_prop_revenue , 'COMPANY_SHARE_BUTANE_REVENUE', STAGE_RES_ECON_DETAIL_SUB1.company_share_but_revenue , 'COMPANY_SHARE_COND_REVENUE', STAGE_RES_ECON_DETAIL_SUB1.company_share_cond_revenue , 'COMPANY_SHARE_FCOND_REVENUE', STAGE_RES_ECON_DETAIL_SUB1.company_share_fcond_revenue , 'NET_CROWN_ROYALTY', STAGE_RES_ECON_DETAIL_SUB1.net_crown_royalty , 'NET_REVENUE_BEFORE_ROYALTY', STAGE_RES_ECON_DETAIL_SUB1.net_revenue_before_royalty , 'FREEHOLD_ROYALTY_BURDEN', STAGE_RES_ECON_DETAIL_SUB1.FH_royalty_Burden , 'TOTAL_ORR_ROYALTY', STAGE_RES_ECON_DETAIL_SUB1.total_ORR_royalty , 'PRODUCTION_TAX', STAGE_RES_ECON_DETAIL_SUB1.production_tax , 'TOTAL_NET_BURDENS', STAGE_RES_ECON_DETAIL_SUB1.total_net_burdens , 'NET_REVENUE_AFTER_ROYALTY', STAGE_RES_ECON_DETAIL_SUB1.net_revenue_after_royalty , 'OTHER_INCOME', STAGE_RES_ECON_DETAIL_SUB1.other_production_income , 'RESOURCE_SALES_REVENUE_TAX', STAGE_RES_ECON_DETAIL_SUB1.resource_sales_revenue_tax , 'FIXED_PRODUCTION_EXPENSE', STAGE_RES_ECON_DETAIL_SUB1.fixed_production_expense , 'VARIABLE_PRODUCTION_EXPENSE', STAGE_RES_ECON_DETAIL_SUB1.variable_production_expense , 'OTHER_PRODUCTION_EXPENSE', STAGE_RES_ECON_DETAIL_SUB1.other_production_expense , 'TOTAL_OPERATING_COSTS', STAGE_RES_ECON_DETAIL_SUB1.total_operating_costs , 'ABANDONMENT', (STAGE_RES_ECON_DETAIL_SUB1.site_restoration_cost - STAGE_RES_ECON_DETAIL_SUB1.salvage_cost) , 'NET_OPERATING_INCOME', STAGE_RES_ECON_DETAIL_SUB1.net_operating_income , 'TOTAL_NET_INVESTMENT', STAGE_RES_ECON_DETAIL_SUB1.net_investment , 'BEFORE_TAX_CASH_FLOW', STAGE_RES_ECON_DETAIL_SUB1.before_tax_cash_flow , 'DAILY_COSHARE_OIL_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.company_share_oil_volume / DECODE(STAGE_RES_ECON_DETAIL_SUB1.month, 0,TO_NUMBER(TRIM(TO_CHAR(DATE_PART('DOY',TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || '1231','YYYYMMDD')))),'999'), EXTRACT(DAYS FROM LAST_DAY(TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.month,'00')) || '01','YYYYMMDD')))) , 'DAILY_COSHARE_GAS_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.company_share_gas_volume / DECODE(STAGE_RES_ECON_DETAIL_SUB1.month, 0,TO_NUMBER(TRIM(TO_CHAR(DATE_PART('DOY',TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || '1231','YYYYMMDD')))),'999'), EXTRACT(DAYS FROM LAST_DAY(TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.month,'00')) || '01','YYYYMMDD')))) , 'DAILY_COSHARE_NGL_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.company_share_ngl_volume/ DECODE(STAGE_RES_ECON_DETAIL_SUB1.month, 0,TO_NUMBER(TRIM(TO_CHAR(DATE_PART('DOY',TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || '1231','YYYYMMDD')))),'999'), EXTRACT(DAYS FROM LAST_DAY(TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.month,'00')) || '01','YYYYMMDD')))) , 'DAILY_COSHARE_BOE_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.company_share_boe_volume/ DECODE(STAGE_RES_ECON_DETAIL_SUB1.month, 0,TO_NUMBER(TRIM(TO_CHAR(DATE_PART('DOY',TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || '1231','YYYYMMDD')))),'999'), EXTRACT(DAYS FROM LAST_DAY(TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.month,'00')) || '01','YYYYMMDD')))) , 'DAILY_COSHARE_ETH_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.company_share_eth_volume/ DECODE(STAGE_RES_ECON_DETAIL_SUB1.month, 0,TO_NUMBER(TRIM(TO_CHAR(DATE_PART('DOY',TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || '1231','YYYYMMDD')))),'999'), EXTRACT(DAYS FROM LAST_DAY(TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.month,'00')) || '01','YYYYMMDD')))) , 'DAILY_COSHARE_PROP_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.company_share_prop_volume/ DECODE(STAGE_RES_ECON_DETAIL_SUB1.month, 0,TO_NUMBER(TRIM(TO_CHAR(DATE_PART('DOY',TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || '1231','YYYYMMDD')))),'999'), EXTRACT(DAYS FROM LAST_DAY(TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.month,'00')) || '01','YYYYMMDD')))) , 'DAILY_COSHARE_COND_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.company_share_cond_volume / DECODE(STAGE_RES_ECON_DETAIL_SUB1.month, 0,TO_NUMBER(TRIM(TO_CHAR(DATE_PART('DOY',TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || '1231','YYYYMMDD')))),'999'), EXTRACT(DAYS FROM LAST_DAY(TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.month,'00')) || '01','YYYYMMDD')))) , 'DAILY_COSHARE_FCOND_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.company_share_fcond_volume / DECODE(STAGE_RES_ECON_DETAIL_SUB1.month, 0,TO_NUMBER(TRIM(TO_CHAR(DATE_PART('DOY',TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || '1231','YYYYMMDD')))),'999'), EXTRACT(DAYS FROM LAST_DAY(TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.month,'00')) || '01','YYYYMMDD')))) , 'DAILY_COSHARE_BUT_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.company_share_but_volume / DECODE(STAGE_RES_ECON_DETAIL_SUB1.month, 0,TO_NUMBER(TRIM(TO_CHAR(DATE_PART('DOY',TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || '1231','YYYYMMDD')))),'999'), EXTRACT(DAYS FROM LAST_DAY(TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.month,'00')) || '01','YYYYMMDD')))) , 'DAILY_WI_OIL_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.oil_working_interest_volume / DECODE(STAGE_RES_ECON_DETAIL_SUB1.month, 0,TO_NUMBER(TRIM(TO_CHAR(DATE_PART('DOY',TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || '1231','YYYYMMDD')))),'999'), EXTRACT(DAYS FROM LAST_DAY(TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.month,'00')) || '01','YYYYMMDD')))) , 'DAILY_WI_GAS_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.gas_working_interest_volume / DECODE(STAGE_RES_ECON_DETAIL_SUB1.month, 0,TO_NUMBER(TRIM(TO_CHAR(DATE_PART('DOY',TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || '1231','YYYYMMDD')))),'999'), EXTRACT(DAYS FROM LAST_DAY(TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.month,'00')) || '01','YYYYMMDD')))) , 'DAILY_WI_NGL_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.ngl_working_interest_volume / DECODE(STAGE_RES_ECON_DETAIL_SUB1.month, 0,TO_NUMBER(TRIM(TO_CHAR(DATE_PART('DOY',TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || '1231','YYYYMMDD')))),'999'), EXTRACT(DAYS FROM LAST_DAY(TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.month,'00')) || '01','YYYYMMDD')))) , 'DAILY_WI_BOE_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.company_wi_boe_volume / DECODE(STAGE_RES_ECON_DETAIL_SUB1.month, 0,TO_NUMBER(TRIM(TO_CHAR(DATE_PART('DOY',TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || '1231','YYYYMMDD')))),'999'), EXTRACT(DAYS FROM LAST_DAY(TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.month,'00')) || '01','YYYYMMDD')))) , 'DAILY_WI_ETH_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.eth_working_interest_volume / DECODE(STAGE_RES_ECON_DETAIL_SUB1.month, 0,TO_NUMBER(TRIM(TO_CHAR(DATE_PART('DOY',TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || '1231','YYYYMMDD')))),'999'), EXTRACT(DAYS FROM LAST_DAY(TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.month,'00')) || '01','YYYYMMDD')))) , 'DAILY_WI_PROP_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.prop_working_interest_volume / DECODE(STAGE_RES_ECON_DETAIL_SUB1.month, 0,TO_NUMBER(TRIM(TO_CHAR(DATE_PART('DOY',TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || '1231','YYYYMMDD')))),'999'), EXTRACT(DAYS FROM LAST_DAY(TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.month,'00')) || '01','YYYYMMDD')))) , 'DAILY_WI_COND_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.cond_working_interest_volume / DECODE(STAGE_RES_ECON_DETAIL_SUB1.month, 0,TO_NUMBER(TRIM(TO_CHAR(DATE_PART('DOY',TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || '1231','YYYYMMDD')))),'999'), EXTRACT(DAYS FROM LAST_DAY(TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.month,'00')) || '01','YYYYMMDD')))) , 'DAILY_WI_FCOND_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.fcond_working_interest_volume / DECODE(STAGE_RES_ECON_DETAIL_SUB1.month, 0,TO_NUMBER(TRIM(TO_CHAR(DATE_PART('DOY',TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || '1231','YYYYMMDD')))),'999'), EXTRACT(DAYS FROM LAST_DAY(TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.month,'00')) || '01','YYYYMMDD')))) , 'DAILY_WI_BUT_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.but_working_interest_volume / DECODE(STAGE_RES_ECON_DETAIL_SUB1.month, 0,TO_NUMBER(TRIM(TO_CHAR(DATE_PART('DOY',TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || '1231','YYYYMMDD')))),'999'), EXTRACT(DAYS FROM LAST_DAY(TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.month,'00')) || '01','YYYYMMDD')))) , NULL) AS VALUE
                      FROM {{ ref('TARGET','STAGE_RES_ECON_DETAIL_SUB1') }} STAGE_RES_ECON_DETAIL_SUB1
                     CROSS JOIN (
                            SELECT *
                              FROM {{ ref('TARGET','DIM_RES_VARIABLE_TYPE') }}
                             WHERE VARIABLE_TYPE_SRC = 'ECON'
                           ) DIM_RES_VARIABLE_TYPE
                   ) AS TARGET
             WHERE NVL(TARGET.VALUE,0) <> 0
        dependencies:
          - locationName: TARGET
            nodeName: STAGE_RES_ECON_DETAIL_SUB1
          - locationName: TARGET
            nodeName: DIM_RES_VARIABLE_TYPE
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','STAGE_RES_ECON_DETAIL_SUB1') }}
            {{ ref('TARGET','DIM_RES_VARIABLE_TYPE') }}
        name: STAGE_RES_ECON_DETAIL_SUB2
        noLinkRefs: []
  name: STAGE_RES_ECON_DETAIL_SUB2
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
