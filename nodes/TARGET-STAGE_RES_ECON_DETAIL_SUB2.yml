fileVersion: 1
id: bb0faa1b-dc5d-4ced-b5c9-5e9026206d1f
name: STAGE_RES_ECON_DETAIL_SUB2
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: "Created as UDV due to Wherescape join length limitations (12000 chars, 165 rows).  Cross join with Econ Variables to unpivoid Mosaic data and only rows where value <> 0"
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 400aad81-9d06-4ad8-aee1-80da6833f448
          stepCounter: bb0faa1b-dc5d-4ced-b5c9-5e9026206d1f
        config: {}
        dataType: NUMBER(18)
        defaultValue: ""
        description: ""
        name: RESULT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a36e3fcf-c1cc-49d8-8b11-818fe316c81a
                stepCounter: b539c594-b4a6-47de-ab49-0187773ff76b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a85989c-894d-49bd-b8e0-e419eab45e8e
          stepCounter: bb0faa1b-dc5d-4ced-b5c9-5e9026206d1f
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: RESERVE_CATEGORY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f50486aa-94ae-4bbe-9811-23a0415baaef
                stepCounter: b539c594-b4a6-47de-ab49-0187773ff76b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b62847bf-d4b1-4bad-946e-93f55bce6757
          stepCounter: bb0faa1b-dc5d-4ced-b5c9-5e9026206d1f
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8d1794c6-0651-431f-8d8a-f48f2a113b58
                stepCounter: b539c594-b4a6-47de-ab49-0187773ff76b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a0c6ba4-4886-4e14-91d8-b3d3db756586
          stepCounter: bb0faa1b-dc5d-4ced-b5c9-5e9026206d1f
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3c10f8d1-8ee2-4e56-bde4-031b3cebbf1a
                stepCounter: b539c594-b4a6-47de-ab49-0187773ff76b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ab1e11e-effc-4b06-9e17-7df94fc7f8e5
          stepCounter: bb0faa1b-dc5d-4ced-b5c9-5e9026206d1f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Last Day of Economics Details Month, Year
        name: ACCT_PER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 146953c5-7e66-4b1a-a36d-30d5cab56efc
          stepCounter: bb0faa1b-dc5d-4ced-b5c9-5e9026206d1f
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: Reserve Economics Variable Type Code
        name: VARIABLE_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 10ac6702-7975-46e6-989c-9416811c12bf
                stepCounter: 9d6c0752-b0d7-434d-9272-d6cea2151615
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d5a3482-006a-4644-a39c-b73cb6731e8c
          stepCounter: bb0faa1b-dc5d-4ced-b5c9-5e9026206d1f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_VARIABLE_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ffadff7d-17ab-4045-8e94-7e3e155d78e8
                stepCounter: 9d6c0752-b0d7-434d-9272-d6cea2151615
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ceb868cc-b97d-43f3-b2b4-11057ac1852d
          stepCounter: bb0faa1b-dc5d-4ced-b5c9-5e9026206d1f
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Interpolate Yearly Data To Monthly
        name: YR_TO_MTH_FLG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 63b143c7-ad0c-4bce-a489-0453cf5cfb48
                stepCounter: 9d6c0752-b0d7-434d-9272-d6cea2151615
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39b53270-c66f-4180-a247-a1be75f1dafc
          stepCounter: bb0faa1b-dc5d-4ced-b5c9-5e9026206d1f
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Value UOM Code
        name: UOM_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 742aef7f-a280-48c3-9261-ca2c12edf918
                stepCounter: 9d6c0752-b0d7-434d-9272-d6cea2151615
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47c9a35d-d140-4da6-a11c-66b6f95b29fd
          stepCounter: bb0faa1b-dc5d-4ced-b5c9-5e9026206d1f
        config: {}
        dataType: DECIMAL(36,8)
        defaultValue: ""
        description: Variable numeric value
        name: VALUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_RES_ECON_DETAIL_SUB2: bb0faa1b-dc5d-4ced-b5c9-5e9026206d1f
          STAGE_RES_ECON_DETAIL_SUB1: b539c594-b4a6-47de-ab49-0187773ff76b
          DIM_RES_VARIABLE_TYPE: 9d6c0752-b0d7-434d-9272-d6cea2151615
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','STAGE_RES_ECON_DETAIL_SUB2') }} AS SELECT TARGET.RESULT_ID AS RESULT_ID,
                   TARGET.RESERVE_CATEGORY_ID ,
                   TARGET.YEAR AS YEAR,
                   TARGET.MONTH AS
             MONTH ,
                   LAST_DAY(TO_DATE(TRIM(TO_CHAR(TARGET.YEAR,'0000')) || TRIM(TO_CHAR(DECODE(TARGET.MONTH,0,12,TARGET.MONTH),'00')) || '01','YYYYMMDD')) AS ACCT_PER_DATE ,
                   TARGET.VARIABLE_TYPE_CODE AS VARIABLE_TYPE_CODE ,
                   NVL(TARGET.DIM_VARIABLE_TYPE_KEY,0) AS DIM_VARIABLE_TYPE_KEY ,
                   NVL(TARGET.YR_TO_MTH_FLG,'N') AS YR_TO_MTH_FLG ,
                   TARGET.UOM_CODE AS UOM_CODE ,
                   NVL(TARGET.VALUE,0) AS VALUE
              FROM (
                    SELECT STAGE_RES_ECON_DETAIL_SUB1.RESULT_ID AS RESULT_ID ,
                           STAGE_RES_ECON_DETAIL_SUB1.RESERVE_CATEGORY_ID ,
                           STAGE_RES_ECON_DETAIL_SUB1.YEAR AS YEAR ,
                           STAGE_RES_ECON_DETAIL_SUB1.MONTH AS
                     MONTH ,
                           DIM_RES_VARIABLE_TYPE.VARIABLE_TYPE_CODE AS VARIABLE_TYPE_CODE ,
                           DIM_RES_VARIABLE_TYPE.DIM_VARIABLE_TYPE_KEY AS DIM_VARIABLE_TYPE_KEY ,
                           DIM_RES_VARIABLE_TYPE.YR_TO_MTH_FLG AS YR_TO_MTH_FLG ,
                           DIM_RES_VARIABLE_TYPE.UOM_CODE AS UOM_CODE ,
                           DECODE(DIM_RES_VARIABLE_TYPE.VARIABLE_TYPE_CODE , 'GROSS_BOE_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.total_company_boe_volume , 'WI_BOE_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.company_wi_boe_volume , 'COSHARE_BOE_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.company_share_boe_volume , 'GROSS_OIL_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.oil_pool_volume , 'WI_OIL_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.oil_working_interest_volume , 'RI_OIL_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.oil_royalty_interest_volume , 'COSHARE_OIL_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.company_share_oil_volume , 'GROSS_GAS_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.gas_pool_volume , 'WI_GAS_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.gas_working_interest_volume , 'RI_GAS_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.gas_royalty_interest_volume , 'COSHARE_GAS_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.company_share_gas_volume , 'GROSS_NGL_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.ngl_pool_volume , 'WI_NGL_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.ngl_working_interest_volume , 'RI_NGL_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.ngl_royalty_interest_volume , 'COSHARE_NGL_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.company_share_ngl_volume , 'GROSS_ETH_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.eth_pool_volume , 'WI_ETH_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.eth_working_interest_volume , 'RI_ETH_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.eth_royalty_interest_volume , 'COSHARE_ETH_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.company_share_eth_volume , 'GROSS_PROP_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.prop_pool_volume , 'WI_PROP_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.prop_working_interest_volume , 'RI_PROP_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.prop_royalty_interest_volume , 'COSHARE_PROP_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.company_share_prop_volume , 'GROSS_BUTANE_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.but_pool_volume , 'WI_BUTANE_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.but_working_interest_volume , 'RI_BUTANE_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.but_royalty_interest_volume , 'COSHARE_BUTANE_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.company_share_but_volume , 'GROSS_COND_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.cond_pool_volume , 'WI_COND_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.cond_working_interest_volume , 'RI_COND_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.cond_royalty_interest_volume , 'COSHARE_COND_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.company_share_cond_volume , 'GROSS_FCOND_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.fcond_lease_volume , 'WI_FCOND_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.fcond_working_interest_volume , 'RI_FCOND_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.fcond_royalty_interest_volume , 'COSHARE_FCOND_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.company_share_fcond_volume , 'OIL_WI_REVENUE', STAGE_RES_ECON_DETAIL_SUB1.oil_working_interest_revenue , 'GAS_WI_REVENUE', STAGE_RES_ECON_DETAIL_SUB1.gas_working_interest_revenue , 'NGL_WI_REVENUE', STAGE_RES_ECON_DETAIL_SUB1.ngl_working_interest_revenue , 'ETHANE_WI_REVENUE', STAGE_RES_ECON_DETAIL_SUB1.eth_working_interest_revenue , 'PROPANE_WI_REVENUE', STAGE_RES_ECON_DETAIL_SUB1.prop_working_interest_revenue , 'BUTANE_WI_REVENUE', STAGE_RES_ECON_DETAIL_SUB1.but_working_interest_revenue , 'CONDENSATE_WI_REVENUE', STAGE_RES_ECON_DETAIL_SUB1.cond_working_interest_revenue , 'FIELD_CONDENSATE_WI_REVENUE', STAGE_RES_ECON_DETAIL_SUB1.fcond_revenue , 'COMPANY_SHARE_OIL_REVENUE', STAGE_RES_ECON_DETAIL_SUB1.company_share_oil_revenue , 'COMPANY_SHARE_GAS_REVENUE', STAGE_RES_ECON_DETAIL_SUB1.company_share_gas_revenue , 'COMPANY_SHARE_NGL_REVENUE', STAGE_RES_ECON_DETAIL_SUB1.company_share_NGL_revenue , 'COMPANY_SHARE_ETHANE_REVENUE', STAGE_RES_ECON_DETAIL_SUB1.company_share_eth_revenue , 'COMPANY_SHARE_PROPANE_REVENUE', STAGE_RES_ECON_DETAIL_SUB1.company_share_prop_revenue , 'COMPANY_SHARE_BUTANE_REVENUE', STAGE_RES_ECON_DETAIL_SUB1.company_share_but_revenue , 'COMPANY_SHARE_COND_REVENUE', STAGE_RES_ECON_DETAIL_SUB1.company_share_cond_revenue , 'COMPANY_SHARE_FCOND_REVENUE', STAGE_RES_ECON_DETAIL_SUB1.company_share_fcond_revenue , 'NET_CROWN_ROYALTY', STAGE_RES_ECON_DETAIL_SUB1.net_crown_royalty , 'NET_REVENUE_BEFORE_ROYALTY', STAGE_RES_ECON_DETAIL_SUB1.net_revenue_before_royalty , 'FREEHOLD_ROYALTY_BURDEN', STAGE_RES_ECON_DETAIL_SUB1.FH_royalty_Burden , 'TOTAL_ORR_ROYALTY', STAGE_RES_ECON_DETAIL_SUB1.total_ORR_royalty , 'PRODUCTION_TAX', STAGE_RES_ECON_DETAIL_SUB1.production_tax , 'TOTAL_NET_BURDENS', STAGE_RES_ECON_DETAIL_SUB1.total_net_burdens , 'NET_REVENUE_AFTER_ROYALTY', STAGE_RES_ECON_DETAIL_SUB1.net_revenue_after_royalty , 'OTHER_INCOME', STAGE_RES_ECON_DETAIL_SUB1.other_production_income , 'RESOURCE_SALES_REVENUE_TAX', STAGE_RES_ECON_DETAIL_SUB1.resource_sales_revenue_tax , 'FIXED_PRODUCTION_EXPENSE', STAGE_RES_ECON_DETAIL_SUB1.fixed_production_expense , 'VARIABLE_PRODUCTION_EXPENSE', STAGE_RES_ECON_DETAIL_SUB1.variable_production_expense , 'OTHER_PRODUCTION_EXPENSE', STAGE_RES_ECON_DETAIL_SUB1.other_production_expense , 'TOTAL_OPERATING_COSTS', STAGE_RES_ECON_DETAIL_SUB1.total_operating_costs , 'ABANDONMENT', (STAGE_RES_ECON_DETAIL_SUB1.site_restoration_cost - STAGE_RES_ECON_DETAIL_SUB1.salvage_cost) , 'NET_OPERATING_INCOME', STAGE_RES_ECON_DETAIL_SUB1.net_operating_income , 'TOTAL_NET_INVESTMENT', STAGE_RES_ECON_DETAIL_SUB1.net_investment , 'BEFORE_TAX_CASH_FLOW', STAGE_RES_ECON_DETAIL_SUB1.before_tax_cash_flow , 'DAILY_COSHARE_OIL_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.company_share_oil_volume / DECODE(STAGE_RES_ECON_DETAIL_SUB1.month, 0,TO_NUMBER(TRIM(TO_CHAR(DATE_PART('DOY',TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || '1231','YYYYMMDD')))),'999'), EXTRACT(DAYS FROM LAST_DAY(TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.month,'00')) || '01','YYYYMMDD')))) , 'DAILY_COSHARE_GAS_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.company_share_gas_volume / DECODE(STAGE_RES_ECON_DETAIL_SUB1.month, 0,TO_NUMBER(TRIM(TO_CHAR(DATE_PART('DOY',TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || '1231','YYYYMMDD')))),'999'), EXTRACT(DAYS FROM LAST_DAY(TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.month,'00')) || '01','YYYYMMDD')))) , 'DAILY_COSHARE_NGL_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.company_share_ngl_volume/ DECODE(STAGE_RES_ECON_DETAIL_SUB1.month, 0,TO_NUMBER(TRIM(TO_CHAR(DATE_PART('DOY',TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || '1231','YYYYMMDD')))),'999'), EXTRACT(DAYS FROM LAST_DAY(TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.month,'00')) || '01','YYYYMMDD')))) , 'DAILY_COSHARE_BOE_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.company_share_boe_volume/ DECODE(STAGE_RES_ECON_DETAIL_SUB1.month, 0,TO_NUMBER(TRIM(TO_CHAR(DATE_PART('DOY',TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || '1231','YYYYMMDD')))),'999'), EXTRACT(DAYS FROM LAST_DAY(TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.month,'00')) || '01','YYYYMMDD')))) , 'DAILY_COSHARE_ETH_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.company_share_eth_volume/ DECODE(STAGE_RES_ECON_DETAIL_SUB1.month, 0,TO_NUMBER(TRIM(TO_CHAR(DATE_PART('DOY',TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || '1231','YYYYMMDD')))),'999'), EXTRACT(DAYS FROM LAST_DAY(TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.month,'00')) || '01','YYYYMMDD')))) , 'DAILY_COSHARE_PROP_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.company_share_prop_volume/ DECODE(STAGE_RES_ECON_DETAIL_SUB1.month, 0,TO_NUMBER(TRIM(TO_CHAR(DATE_PART('DOY',TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || '1231','YYYYMMDD')))),'999'), EXTRACT(DAYS FROM LAST_DAY(TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.month,'00')) || '01','YYYYMMDD')))) , 'DAILY_COSHARE_COND_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.company_share_cond_volume / DECODE(STAGE_RES_ECON_DETAIL_SUB1.month, 0,TO_NUMBER(TRIM(TO_CHAR(DATE_PART('DOY',TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || '1231','YYYYMMDD')))),'999'), EXTRACT(DAYS FROM LAST_DAY(TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.month,'00')) || '01','YYYYMMDD')))) , 'DAILY_COSHARE_FCOND_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.company_share_fcond_volume / DECODE(STAGE_RES_ECON_DETAIL_SUB1.month, 0,TO_NUMBER(TRIM(TO_CHAR(DATE_PART('DOY',TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || '1231','YYYYMMDD')))),'999'), EXTRACT(DAYS FROM LAST_DAY(TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.month,'00')) || '01','YYYYMMDD')))) , 'DAILY_COSHARE_BUT_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.company_share_but_volume / DECODE(STAGE_RES_ECON_DETAIL_SUB1.month, 0,TO_NUMBER(TRIM(TO_CHAR(DATE_PART('DOY',TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || '1231','YYYYMMDD')))),'999'), EXTRACT(DAYS FROM LAST_DAY(TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.month,'00')) || '01','YYYYMMDD')))) , 'DAILY_WI_OIL_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.oil_working_interest_volume / DECODE(STAGE_RES_ECON_DETAIL_SUB1.month, 0,TO_NUMBER(TRIM(TO_CHAR(DATE_PART('DOY',TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || '1231','YYYYMMDD')))),'999'), EXTRACT(DAYS FROM LAST_DAY(TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.month,'00')) || '01','YYYYMMDD')))) , 'DAILY_WI_GAS_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.gas_working_interest_volume / DECODE(STAGE_RES_ECON_DETAIL_SUB1.month, 0,TO_NUMBER(TRIM(TO_CHAR(DATE_PART('DOY',TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || '1231','YYYYMMDD')))),'999'), EXTRACT(DAYS FROM LAST_DAY(TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.month,'00')) || '01','YYYYMMDD')))) , 'DAILY_WI_NGL_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.ngl_working_interest_volume / DECODE(STAGE_RES_ECON_DETAIL_SUB1.month, 0,TO_NUMBER(TRIM(TO_CHAR(DATE_PART('DOY',TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || '1231','YYYYMMDD')))),'999'), EXTRACT(DAYS FROM LAST_DAY(TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.month,'00')) || '01','YYYYMMDD')))) , 'DAILY_WI_BOE_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.company_wi_boe_volume / DECODE(STAGE_RES_ECON_DETAIL_SUB1.month, 0,TO_NUMBER(TRIM(TO_CHAR(DATE_PART('DOY',TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || '1231','YYYYMMDD')))),'999'), EXTRACT(DAYS FROM LAST_DAY(TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.month,'00')) || '01','YYYYMMDD')))) , 'DAILY_WI_ETH_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.eth_working_interest_volume / DECODE(STAGE_RES_ECON_DETAIL_SUB1.month, 0,TO_NUMBER(TRIM(TO_CHAR(DATE_PART('DOY',TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || '1231','YYYYMMDD')))),'999'), EXTRACT(DAYS FROM LAST_DAY(TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.month,'00')) || '01','YYYYMMDD')))) , 'DAILY_WI_PROP_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.prop_working_interest_volume / DECODE(STAGE_RES_ECON_DETAIL_SUB1.month, 0,TO_NUMBER(TRIM(TO_CHAR(DATE_PART('DOY',TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || '1231','YYYYMMDD')))),'999'), EXTRACT(DAYS FROM LAST_DAY(TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.month,'00')) || '01','YYYYMMDD')))) , 'DAILY_WI_COND_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.cond_working_interest_volume / DECODE(STAGE_RES_ECON_DETAIL_SUB1.month, 0,TO_NUMBER(TRIM(TO_CHAR(DATE_PART('DOY',TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || '1231','YYYYMMDD')))),'999'), EXTRACT(DAYS FROM LAST_DAY(TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.month,'00')) || '01','YYYYMMDD')))) , 'DAILY_WI_FCOND_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.fcond_working_interest_volume / DECODE(STAGE_RES_ECON_DETAIL_SUB1.month, 0,TO_NUMBER(TRIM(TO_CHAR(DATE_PART('DOY',TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || '1231','YYYYMMDD')))),'999'), EXTRACT(DAYS FROM LAST_DAY(TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.month,'00')) || '01','YYYYMMDD')))) , 'DAILY_WI_BUT_VOLUME', STAGE_RES_ECON_DETAIL_SUB1.but_working_interest_volume / DECODE(STAGE_RES_ECON_DETAIL_SUB1.month, 0,TO_NUMBER(TRIM(TO_CHAR(DATE_PART('DOY',TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || '1231','YYYYMMDD')))),'999'), EXTRACT(DAYS FROM LAST_DAY(TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.year,'0000')) || TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL_SUB1.month,'00')) || '01','YYYYMMDD')))) , NULL) AS VALUE
                      FROM {{ ref('TARGET','STAGE_RES_ECON_DETAIL_SUB1') }} STAGE_RES_ECON_DETAIL_SUB1
                     CROSS JOIN (
                            SELECT *
                              FROM {{ ref('TARGET','DIM_RES_VARIABLE_TYPE') }}
                             WHERE VARIABLE_TYPE_SRC = 'ECON'
                           ) DIM_RES_VARIABLE_TYPE
                   ) AS TARGET
             WHERE NVL(TARGET.VALUE,0) <> 0
        dependencies:
          - locationName: TARGET
            nodeName: STAGE_RES_ECON_DETAIL_SUB1
          - locationName: TARGET
            nodeName: DIM_RES_VARIABLE_TYPE
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','STAGE_RES_ECON_DETAIL_SUB1') }}
            {{ ref('TARGET','DIM_RES_VARIABLE_TYPE') }}
        name: STAGE_RES_ECON_DETAIL_SUB2
        noLinkRefs: []
  name: STAGE_RES_ECON_DETAIL_SUB2
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
