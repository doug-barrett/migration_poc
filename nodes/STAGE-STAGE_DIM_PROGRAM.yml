fileVersion: 1
id: 40f9d64d-139e-45f9-8834-62bd766158e9
name: STAGE_DIM_PROGRAM
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: true
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f75183ed-a10b-48df-9a60-89dd8bce5fd9
          stepCounter: 40f9d64d-139e-45f9-8834-62bd766158e9
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: PROGRAMNUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d0baf245-2cb0-4c25-be05-8aecc42b57d8
                stepCounter: 3c18a8a6-659a-41ef-a313-903bb4da2130
            transform: ""
          - columnReferences:
              - columnCounter: 8fe73dda-b6ff-463b-96b0-ecdd860774da
                stepCounter: c4d1c7ba-b243-45f6-9517-fc4b8a253943
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba795c0e-52ac-44f1-bc51-db681d038cbd
          stepCounter: 40f9d64d-139e-45f9-8834-62bd766158e9
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: ABBREVIATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f2055835-5149-45e9-85f7-48cc9e751373
                stepCounter: 3c18a8a6-659a-41ef-a313-903bb4da2130
            transform: ""
          - columnReferences:
              - columnCounter: 58bd8b69-e735-4df4-b837-b6d1a2237cbb
                stepCounter: c4d1c7ba-b243-45f6-9517-fc4b8a253943
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c16087c7-6021-40e8-a2f5-fc8cae09048d
          stepCounter: 40f9d64d-139e-45f9-8834-62bd766158e9
        config: {}
        dataType: VARCHAR(60)
        defaultValue: ""
        description: ""
        name: DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b30720cc-4786-4a3b-9b83-d6338987db54
                stepCounter: 3c18a8a6-659a-41ef-a313-903bb4da2130
            transform: ""
          - columnReferences:
              - columnCounter: 1a867990-ccf7-4fa0-b30f-9e21b378427e
                stepCounter: c4d1c7ba-b243-45f6-9517-fc4b8a253943
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 121ab54d-f0df-4204-ac25-8e9c53398643
          stepCounter: 40f9d64d-139e-45f9-8834-62bd766158e9
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: COUNTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cae1f313-88b5-4381-9bd6-45168c83eed0
                stepCounter: d581d06d-09d0-4630-97fd-343c50c4fb52
            transform: ""
          - columnReferences:
              - columnCounter: d05c7118-b536-4f5f-b65a-ef0e52c4d5ae
                stepCounter: d7b45098-5316-444d-a864-ff4b111e73e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 969e9456-2a1e-4a11-b51b-b91a328eb6c7
          stepCounter: 40f9d64d-139e-45f9-8834-62bd766158e9
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: ""
        name: HCP_PLAN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 80adcc0e-96b2-4b73-b6bd-62f7a41bee96
                stepCounter: 11fa7bcc-c5b8-415c-871a-738359504a2f
            transform: ""
          - columnReferences:
              - columnCounter: ac606d9f-4b93-45ce-8955-82e507eabbc6
                stepCounter: c4d1c7ba-b243-45f6-9517-fc4b8a253943
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06f8fcf8-9d26-4568-9e1b-37656a2f7a1e
          stepCounter: 40f9d64d-139e-45f9-8834-62bd766158e9
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ' DHCS identifies our programs using this code.'
        name: PROGRAMPLANCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "''"
          - columnReferences:
              - columnCounter: ac606d9f-4b93-45ce-8955-82e507eabbc6
                stepCounter: c4d1c7ba-b243-45f6-9517-fc4b8a253943
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2822516-81a1-4407-bb87-ab9c97aedf04
          stepCounter: 40f9d64d-139e-45f9-8834-62bd766158e9
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: COUNTY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3bfadbdc-6476-499a-b088-7a8f4faf865c
                stepCounter: d581d06d-09d0-4630-97fd-343c50c4fb52
            transform: ""
          - columnReferences:
              - columnCounter: 2d09b776-41ab-4543-ab1b-9a38a26f9c6b
                stepCounter: c4d1c7ba-b243-45f6-9517-fc4b8a253943
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72a8cb10-c93a-41d9-ad69-78a0e7015792
          stepCounter: 40f9d64d-139e-45f9-8834-62bd766158e9
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: applies logic for county regions
        name: REGION_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3bfadbdc-6476-499a-b088-7a8f4faf865c
                stepCounter: d581d06d-09d0-4630-97fd-343c50c4fb52
            transform: ""
          - columnReferences:
              - columnCounter: 2d09b776-41ab-4543-ab1b-9a38a26f9c6b
                stepCounter: c4d1c7ba-b243-45f6-9517-fc4b8a253943
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 12b82a22-e7a2-4f45-8a52-019cfa197d50
          stepCounter: 40f9d64d-139e-45f9-8834-62bd766158e9
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: PROGRAM_ROLL_UP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77456daf-eedc-48ec-8a71-3c2fc253f2ee
                stepCounter: d3f9b455-ed3e-4ea4-897f-5bbb7a6a931d
            transform: ""
          - columnReferences:
              - columnCounter: 44c2c807-aab9-4fdf-8253-d8e39ded8879
                stepCounter: c4d1c7ba-b243-45f6-9517-fc4b8a253943
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 096ff3f3-922c-446c-954b-6bde78af2469
          stepCounter: 40f9d64d-139e-45f9-8834-62bd766158e9
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PROGRAM_TYPE_ROLL_UP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 094feb37-5f4a-41aa-9d67-eebe412f19df
                stepCounter: d3f9b455-ed3e-4ea4-897f-5bbb7a6a931d
            transform: ""
          - columnReferences:
              - columnCounter: 44c2c807-aab9-4fdf-8253-d8e39ded8879
                stepCounter: c4d1c7ba-b243-45f6-9517-fc4b8a253943
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b779f60-c305-4e12-a527-008f95561593
          stepCounter: 40f9d64d-139e-45f9-8834-62bd766158e9
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PROGRAM_TYPE_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 094feb37-5f4a-41aa-9d67-eebe412f19df
                stepCounter: d3f9b455-ed3e-4ea4-897f-5bbb7a6a931d
            transform: ""
          - columnReferences:
              - columnCounter: 44c2c807-aab9-4fdf-8253-d8e39ded8879
                stepCounter: c4d1c7ba-b243-45f6-9517-fc4b8a253943
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0de9e687-26e3-48b0-8be3-ac5e74bc0e84
          stepCounter: 40f9d64d-139e-45f9-8834-62bd766158e9
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: EFF_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc3f8cc4-79de-47a9-ae4c-4b43e0484f7b
                stepCounter: 3c18a8a6-659a-41ef-a313-903bb4da2130
            transform: ""
          - columnReferences:
              - columnCounter: c2209e11-8318-4523-b33d-77331dcf80c2
                stepCounter: c4d1c7ba-b243-45f6-9517-fc4b8a253943
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e790555-ca1a-4493-8ac3-ddc7fc95cc4a
          stepCounter: 40f9d64d-139e-45f9-8834-62bd766158e9
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8d03f994-7029-4267-baa7-0fd39c94edac
                stepCounter: 3c18a8a6-659a-41ef-a313-903bb4da2130
            transform: ""
          - columnReferences:
              - columnCounter: 1bac4088-c086-434a-9ba8-d1b7f29fd313
                stepCounter: c4d1c7ba-b243-45f6-9517-fc4b8a253943
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f310a820-8597-4591-b5ea-4697f79d1b87
          stepCounter: 40f9d64d-139e-45f9-8834-62bd766158e9
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: Data Source for Record
        name: DSS_SOURCE_SYSTEM
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'AIS'"
          - columnReferences: []
            transform: "'HSP'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c379ceb8-75d2-42c3-b9ea-4e54f489fb45
          stepCounter: 40f9d64d-139e-45f9-8834-62bd766158e9
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOAD_RPRT_LINEOFBUSINESS: 3c18a8a6-659a-41ef-a313-903bb4da2130
          LOAD_RPRT_COUNTY: d581d06d-09d0-4630-97fd-343c50c4fb52
          LOAD_RPRT_COUNTYCOVERED: 11fa7bcc-c5b8-415c-871a-738359504a2f
          LOAD_RPRT_PROGRAMROLLUPLU: d3f9b455-ed3e-4ea4-897f-5bbb7a6a931d
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOAD_RPRT_LINEOFBUSINESS
          - locationName: LOAD
            nodeName: LOAD_RPRT_COUNTY
          - locationName: LOAD
            nodeName: LOAD_RPRT_COUNTYCOVERED
          - locationName: LOAD
            nodeName: LOAD_RPRT_PROGRAMROLLUPLU
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOAD_RPRT_LINEOFBUSINESS') }} load_RPRT_LineOfBusiness
              LEFT OUTER JOIN {{ ref('LOAD','LOAD_RPRT_COUNTY') }} load_RPRT_county
                ON load_RPRT_LineOfBusiness.county_code = load_RPRT_county.county_code
              LEFT OUTER JOIN {{ ref('LOAD','LOAD_RPRT_COUNTYCOVERED') }} load_RPRT_CountyCovered
                ON load_RPRT_county.county_code = load_RPRT_CountyCovered.county_code
              LEFT OUTER JOIN {{ ref('LOAD','LOAD_RPRT_PROGRAMROLLUPLU') }} load_RPRT_ProgramRollupLu
                ON load_RPRT_LineOfBusiness.program_number = load_RPRT_ProgramRollupLu.program_number
        name: SRC_stage_dim_Program_RPRT
        noLinkRefs: []
      - aliases:
          DS_RR_GROUPS: c4d1c7ba-b243-45f6-9517-fc4b8a253943
          DS_DHCS_COUNTY_CODES: d7b45098-5316-444d-a864-ff4b111e73e7
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATA_STORE
            nodeName: DS_RR_GROUPS
          - locationName: DATA_STORE
            nodeName: DS_DHCS_COUNTY_CODES
        join:
          joinCondition: |-
            FROM {{ ref('DATA_STORE','DS_RR_GROUPS') }} ds_RR_Groups
              LEFT JOIN {{ ref('DATA_STORE','DS_DHCS_COUNTY_CODES') }} ds_DHCS_COUNTY_CODES
                ON UPPER(ds_RR_Groups.County) = ds_DHCS_COUNTY_CODES.COUNTY_NAME
             WHERE ds_RR_Groups.AdditionalGroupNumber IS NOT NULL
        name: SRC_stage_dim_Program_HSP
        noLinkRefs: []
  name: STAGE_DIM_PROGRAM
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
