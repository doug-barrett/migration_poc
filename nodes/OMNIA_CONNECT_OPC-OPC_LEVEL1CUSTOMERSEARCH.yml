fileVersion: 1
id: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
name: OPC_LEVEL1CUSTOMERSEARCH
operation:
  config:
    distinct: true
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: OMNIA_CONNECT_OPC
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 502dc7c8-12bb-499f-bd4f-4fb8b1ad0799
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: INT
        defaultValue: ""
        description: is the highest-level of hierarchy for an account
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cf92bf6c-56fa-4e9d-b8cf-e06bf30d200a
                stepCounter: 29434de6-599c-4dd7-a66a-90bd1531218b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 43fe782d-2c7e-4836-92cc-014a3509e882
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the same value as the AccountName column, but has been run through a ProperCase function
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DISPLAYACCOUNTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f96cc61-e81c-400f-96e9-7ca6b32dde00
                stepCounter: 29434de6-599c-4dd7-a66a-90bd1531218b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c87474f-b381-4919-8793-7681b387f86d
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the type, or classification, of the account
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ACCOUNTTYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f9af0d4-daa9-4baf-a7ed-69de8e7375a7
                stepCounter: 29434de6-599c-4dd7-a66a-90bd1531218b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d0f3cf4-6947-4631-aa46-d211a7d62621
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Street Address Line 1 matched with USPS.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9bfa0855-bad9-4574-b0a9-0edcff450f30
                stepCounter: 29434de6-599c-4dd7-a66a-90bd1531218b
            transform: COALESCE(INITCAP(OPC_Account.UspsAddress),'')
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e70eb33f-306e-4a05-a081-d1c8ff43a227
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Street Address Line 2 matched with USPS.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ADDRESS2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eab07941-8b67-4c0f-95ec-d888dceed2ad
                stepCounter: 29434de6-599c-4dd7-a66a-90bd1531218b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1be7b617-0bb4-4540-b0e1-e6b12cbe6b15
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Address City matched with USPS.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 62475855-a388-4304-bc9e-9fb2233268fc
                stepCounter: 29434de6-599c-4dd7-a66a-90bd1531218b
            transform: COALESCE(OPC_Account.UspsCity, OPC_Account.City,'')
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98dc5f86-02b2-405c-b4dd-346073310ae6
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Address County matched with USPS.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: COUNTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9b510bfe-ab43-4c7f-b5b3-ae374b2b60b0
                stepCounter: 29434de6-599c-4dd7-a66a-90bd1531218b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d29347f-6afc-4dc9-806e-9a76e675a957
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Address State matched with USPS.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: STATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91a63c74-d110-4843-a4b9-acb5164c886d
                stepCounter: 29434de6-599c-4dd7-a66a-90bd1531218b
            transform: COALESCE(OPC_Account.UspsState, OPC_Account.State, '')
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50c3a814-73d0-4a19-9a57-d41d055d564b
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Address PostalCode matched with USPS.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ZIPCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 65f0ab69-6a57-4a69-99b4-f6ff80d84712
                stepCounter: 29434de6-599c-4dd7-a66a-90bd1531218b
            transform: COALESCE(OPC_Account.UspsZipCode, OPC_Account.ZipCode, '0')
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16dc766e-48aa-4689-a736-5ef843b366b4
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: DATE
        defaultValue: ""
        description: is the date that the account either registered or, in the event we do not have a registration, will be the date of first purchase
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: STARTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c1ec7299-a43a-45bf-a8a6-fe1372f81315
                stepCounter: 29434de6-599c-4dd7-a66a-90bd1531218b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ebffa3fc-1177-4329-9517-a9b407975d53
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Strategic Account Reason
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c87eb2a-fdf6-4dc1-8c85-63810f9793b3
                stepCounter: 29434de6-599c-4dd7-a66a-90bd1531218b
            transform: COALESCE(OPC_Account.StrategicAccountReason,OPC_Account.MemberSegment)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4497fb93-9a64-437a-9478-2d81240fc0d8
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the 9-digit EIN (employer identification number) for the account
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: FEDERALTAXID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e1e5123-3c37-48a6-9513-228c4c3c5d55
                stepCounter: 29434de6-599c-4dd7-a66a-90bd1531218b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 713023c0-ac2c-4fa0-aa67-0240653409f6
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the primary URL for the account
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: WEBSITE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 15a7d211-7590-4a83-ac06-f08d2d648311
                stepCounter: 29434de6-599c-4dd7-a66a-90bd1531218b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f08a02e-2cea-4a08-bba2-0c7e90ac0e24
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Territory Name
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 26a31949-7ae4-4030-8731-ff666fdbac9c
                stepCounter: e8d1a634-d4b1-4609-8370-5c02827f7db4
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ecc8ca58-d417-466f-83a8-e43606153b6d
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYDIVISIONLEADERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00bde512-492a-4b75-8e10-990493d5c62f
                stepCounter: e8d1a634-d4b1-4609-8370-5c02827f7db4
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 13a1eccd-7242-46bf-8553-89d0a5a501dd
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYDIVISIONLEADERUPN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b0404480-2070-489f-90fe-8b666ce60dd5
                stepCounter: e8d1a634-d4b1-4609-8370-5c02827f7db4
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d78a38f9-79ea-48b8-b484-09837e4000fa
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYGROUPLEADERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c093e719-56b8-465d-93ca-0c834f6d47e0
                stepCounter: e8d1a634-d4b1-4609-8370-5c02827f7db4
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 08ba3035-22f6-490b-9f25-2a91048b7c79
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYGROUPLEADERUPN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b5551ef-2217-4053-b59b-1b22aef57758
                stepCounter: e8d1a634-d4b1-4609-8370-5c02827f7db4
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 93002a3c-d11d-4ddb-8166-59d28b17053b
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Territory Manager Name
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYMANAGER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8fd2560e-73d5-478b-9977-7e9031b5a38a
                stepCounter: e8d1a634-d4b1-4609-8370-5c02827f7db4
            transform: |-
              CASE --  WHEN OPC_Account.StrategicAccountReason LIKE 'Tier 3%' THEN ''

                          WHEN Employee.Email = 'shayne.calzavara@omniapartners.com'           THEN ''
                          WHEN Employee.Email = 'doug.looney@omniapartners.com'                THEN 'OMNIA Partners Support'
                          ELSE SalesTerritory.TerritoryManager
                           END
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ebae9614-0938-4614-bb38-78e205d97468
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYMANAGERUPN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f6ab2b21-4d26-48a4-a3d9-79cfa0d14510
                stepCounter: e8d1a634-d4b1-4609-8370-5c02827f7db4
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f92e10c6-59c8-49c8-9c21-819e5775d708
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Territory Manager Email
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYMANAGEREMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd1bcb5c-b86d-4bda-82d3-f8b7a3481c54
                stepCounter: a7f237a1-4409-4432-ab25-4789043286b9
            transform: |-
              CASE --  WHEN OPC_Account.StrategicAccountReason LIKE 'Tier 3%'

                          WHEN Employee.Email = 'shayne.calzavara@omniapartners.com'    THEN IFF(OPC_Account.UspsState = 'TX','ISO.Tier3TX@omniapartners.com','ISO.Tier3@omniapartners.com')
                          WHEN Employee.Email ='doug.looney@omniapartners.com'          THEN 'info@omniapartners.com'
                          ELSE Employee.Email
                           END
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55a09b48-e2dc-4996-a9ee-ba4c30abb64f
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Territory Manager Office Phone Number
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYMANAGEROFFICEPHONENUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75485bb6-4b2f-4150-a2d6-669fc4a50b62
                stepCounter: a7f237a1-4409-4432-ab25-4789043286b9
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ac7ef67-5993-4825-b56b-16b98b19ebe1
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Territory Manager Mobile Phone Number
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYMANAGERMOBILEPHONENUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f6088448-eaba-4027-9495-654b695bab1b
                stepCounter: a7f237a1-4409-4432-ab25-4789043286b9
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 575fd9f9-fa80-4d49-88e6-398279ce1321
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the name of the OMNIA Partners SPD team VP, who supervises a group of SPD Directors.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SPDVP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4389a7be-645a-4db4-a9a9-5bf0f7a49ba2
                stepCounter: 4f59fbc0-7b06-498c-b967-f551d35c31c4
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cbe90ca4-80ab-4ef4-9a77-9241c9477bf4
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SPDVPEMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4263843-d6b5-4196-a95c-2980868a3e7d
                stepCounter: 4f59fbc0-7b06-498c-b967-f551d35c31c4
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2a5a938-6618-4f3b-9839-ca4f4786bf87
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the name of the OMNIA Partners SPD team member responsible for managing the relationship with this supplier.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SPDDIRECTOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78be4246-fb60-4e3e-8bcc-7ae23d4ba1bb
                stepCounter: 4f59fbc0-7b06-498c-b967-f551d35c31c4
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42aec9b2-100a-4872-9c7f-bcb373cb93ec
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SPDDIRECTOREMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 768f59a9-d020-40ee-9d12-285c25c0bfd3
                stepCounter: 4f59fbc0-7b06-498c-b967-f551d35c31c4
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f8cfce9-6a2d-47d4-a003-eef96b8932aa
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the preferred, cleaned up name of the supplier. This is the one you want to use for reports
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: REPORTINGSUPPLIERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77ae6e90-7353-49fa-afec-de241698e34d
                stepCounter: 4f59fbc0-7b06-498c-b967-f551d35c31c4
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f27d36d-8a9e-44bd-9eb2-f426fa552c72
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: METROAREANAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6489c8ca-bb58-4156-b941-4c66b549d149
                stepCounter: 6b7d4d0b-42b1-465f-8ccb-9513fc6da626
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aded983c-03a7-4043-b819-40f5283c4091
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: METROAREATOTALPOPULATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5597b344-9cfe-4067-8e32-8b1b52eea6e5
                stepCounter: 6b7d4d0b-42b1-465f-8ccb-9513fc6da626
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea51af7d-69d3-454c-aacb-947a173e3907
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: Latitude
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LAT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4612c8ab-4a68-4c90-aec7-6fa2e7a5d49a
                stepCounter: 6b7d4d0b-42b1-465f-8ccb-9513fc6da626
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fecafba2-175b-4964-bdb0-d11bc84591e1
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: Longitude
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2e9fc03a-5f14-4e5b-8ec2-32c5b962d49d
                stepCounter: 6b7d4d0b-42b1-465f-8ccb-9513fc6da626
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 183c6f5d-8090-496a-85b7-d953f5754304
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Sector
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SECTOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3eef6603-f7a3-4550-82a3-e544b063bf75
                stepCounter: ad43ae62-19f3-46ea-9308-98a9fdcc8256
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78d16306-6ba2-4ef2-a494-7584c56fbe81
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Supplier Id
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 68304ca4-cb9c-40a8-a689-3f982536a518
                stepCounter: f40363cb-ec2c-4bb3-ba5a-ce987f7c9535
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 569f0c02-b5dc-4b49-a596-fe076ce3fee3
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: INT
        defaultValue: ""
        description: Number Of Contacts for given Level 1 ForceId
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: NUMBEROFCONTACTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09251f6f-3cd3-4f68-b273-b23598cd185e
                stepCounter: 4de81596-476e-45ca-bd86-5c5368a16b7a
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55ad6078-9010-478b-ad75-7555d03808b7
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: Previous 12 Months Sum Of Sales
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PREVIOUS12MONTHS_SUMOFSALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2f3396d0-c859-44ec-831d-70be60aa1c38
                stepCounter: f40363cb-ec2c-4bb3-ba5a-ce987f7c9535
            transform: IFNULL(OPC_vwAggLevel1ForceIdUsageStats_All.Previous12Months_SumOfSales,0)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 282cbf56-a32c-427b-9453-6b216831ce32
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: Current 12 Months Sum Of Sales
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CURRENT12MONTHS_SUMOFSALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b270167d-9634-442c-83a5-82973435480f
                stepCounter: f40363cb-ec2c-4bb3-ba5a-ce987f7c9535
            transform: IFNULL(OPC_vwAggLevel1ForceIdUsageStats_All.Current12Months_SumOfSales,0)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b5ea1273-6a69-4392-ae45-07dbd006a5c2
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: (Current 12 Months Sales) - (Previous 12 Months Sales)
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CURRENT12MONTHS_SALESDIFF
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b270167d-9634-442c-83a5-82973435480f
                stepCounter: f40363cb-ec2c-4bb3-ba5a-ce987f7c9535
            transform: IFNULL(Current12Months_SumOfSales - Previous12Months_SumOfSales,0)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0adafa9a-a3fa-4c09-8b1d-dcec177e932b
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ((Current 12 Months Sales) - (Previous 12 Months Sales)) / (Previous 12 Months Sales)
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CURRENT12MONTHS_SALESDIFFPERC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b270167d-9634-442c-83a5-82973435480f
                stepCounter: f40363cb-ec2c-4bb3-ba5a-ce987f7c9535
            transform: IFNULL((Current12Months_SumOfSales - Previous12Months_SumOfSales)/NULLIF(Previous12Months_SumOfSales,0),0)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: faa7f285-9317-4367-a7eb-a63bb9f4db1b
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: INT
        defaultValue: ""
        description: Previous 12 Months Number Of Suppliers Used
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PREVIOUS12MONTHS_NUMOFSUPPLIERSUSED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ad629cc2-86f6-4be9-9580-0953c1048786
                stepCounter: 76287839-b851-41dc-a758-334db18c6e46
            transform: IFNULL(OPC_AggLevel1_PY_LTM.Level1_PY_LTM_NumOfSuppliersUsed,0)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 68dffce9-cc7c-443f-81f6-742651db1121
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: INT
        defaultValue: ""
        description: Current 12 Months Number Of Suppliers Used
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CURRENT12MONTHS_NUMOFSUPPLIERSUSED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39a369ab-54b8-415a-abfc-2176749a1331
                stepCounter: 3ee6d5dd-14fa-4362-abfd-c0c03dff3942
            transform: IFNULL(OPC_AggLevel1_LTM.Level1_LTM_NumOfSuppliersUsed,0)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a03f257c-db64-4b74-ae21-ce5c0344cad8
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: INT
        defaultValue: ""
        description: (Current 12 Months Number Of Suppliers Used) - (Previous 12 Months Number Of Suppliers Used)
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CURRENT12MONTHS_NUMOFSUPPLIERSUSEDDIFF
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39a369ab-54b8-415a-abfc-2176749a1331
                stepCounter: 3ee6d5dd-14fa-4362-abfd-c0c03dff3942
            transform: ZEROIFNULL(OPC_AggLevel1_LTM.Level1_LTM_NumOfSuppliersUsed) - ZEROIFNULL(OPC_AggLevel1_PY_LTM.Level1_PY_LTM_NumOfSuppliersUsed)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c1905d6-0b1d-47d0-b47b-ed2b22f4e16f
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ((Current 12 Months Number Of Suppliers Used) - (Previous 12 Months Number Of Suppliers Used)) / (Previous 12 Months Number Of Suppliers Used)
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CURRENT12MONTHS_NUMOFSUPPLIERSUSEDDIFFPERC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39a369ab-54b8-415a-abfc-2176749a1331
                stepCounter: 3ee6d5dd-14fa-4362-abfd-c0c03dff3942
            transform: IFNULL((ZEROIFNULL(OPC_AggLevel1_LTM.Level1_LTM_NumOfSuppliersUsed) - ZEROIFNULL(OPC_AggLevel1_PY_LTM.Level1_PY_LTM_NumOfSuppliersUsed))/NULLIF(OPC_AggLevel1_PY_LTM.Level1_PY_LTM_NumOfSuppliersUsed, 0),0)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 077228f5-6aab-4f0f-ab5f-20aa92763e54
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: OMNIA Engagement Score
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OMNIA_SCORE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 29eb46fd-7c9b-488e-af94-42f6531b73d0
                stepCounter: 96749e90-aa72-4898-ae20-e121d7f852cf
            transform: |-
              CASE COALESCE(OPC_Account.StrategicAccountReason,OPC_Account.MemberSegment) --Public (Account.StrategicAccountReason)

                          WHEN 'Market Mover'                                                                                                THEN '10'
                          WHEN 'Tier 1'                                                                                                      THEN '10'
                          WHEN 'Tier 2'                                                                                                      THEN '10' --Private (Account.MemberSegment)

                          WHEN 'Fortune 1000'                                                                                                THEN '10'
                          WHEN 'Bullseye'                                                                                                    THEN '10' --Else

                          ELSE IFNULL(OMNIA_Score.OMNIA_Score,'Starter')
                           END
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8b7a550-8e05-492e-9fed-512ecc368537
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: MAXRECEIPTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8befd7a3-9864-4195-96b7-9dc5b5c2a7db
                stepCounter: f40363cb-ec2c-4bb3-ba5a-ce987f7c9535
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b91b83e5-e3ee-4b70-ab64-613c2c05a0ca
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Size Band Code
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CUSTOMER_SIZE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb1e3f4d-01f5-4186-837f-42d01e0bf563
                stepCounter: 29434de6-599c-4dd7-a66a-90bd1531218b
            transform: IFNULL(OPC_Account.Customer_Size_Code,'')
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad2604a0-1eea-431a-bb3b-046954d96096
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Customer Size Band
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CUSTOMERSIZEBAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f8a22c8-6378-446d-9a6e-9e475ac7af47
                stepCounter: 29434de6-599c-4dd7-a66a-90bd1531218b
            transform: IFNULL(OPC_Account.CUSTOMER_SIZE_BAND,'Unknown')
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc52fdf2-2607-431a-9fcc-80be4e9abe4d
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: INT
        defaultValue: ""
        description: Size Band Number
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CUSTOMER_SIZE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b6e4c98-73ce-44f7-8d1d-a8c46c534630
                stepCounter: 29434de6-599c-4dd7-a66a-90bd1531218b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5afdfa0-e5d9-4f49-a181-c10c443c6def
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Significant Capital Spend in Last 3 Years
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SIGNIFICANTCAPITALSPENDINLAST3YEARS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f297070-f953-40fb-b18c-d2c46e025cca
                stepCounter: f40363cb-ec2c-4bb3-ba5a-ce987f7c9535
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b000057-f2a4-4eca-84e8-f0cf3a0a6696
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: WESHARE_PARTICIPANT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cde3d269-d97b-4018-bfd9-6e66a172c6ff
                stepCounter: 29434de6-599c-4dd7-a66a-90bd1531218b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72af2163-c50a-40c6-89f7-bd392012413d
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PARTICIPATING_PROGRAM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56f58868-dcbf-4792-aee2-3b012cf19c93
                stepCounter: 29434de6-599c-4dd7-a66a-90bd1531218b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e4148f5-bd68-4fb7-8edd-0bde5dab1a55
          stepCounter: 14097139-53f7-4a68-ad0a-2efb9ffcf03e
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: denotes whether the row is an Account, Child Account, Duplicate, or Delivery Location.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: RECORDDESIGNATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3d6a6814-db55-42aa-99b0-1f7342c484c5
                stepCounter: 29434de6-599c-4dd7-a66a-90bd1531218b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          OPC_ACCOUNT: 29434de6-599c-4dd7-a66a-90bd1531218b
          SECTOR: ad43ae62-19f3-46ea-9308-98a9fdcc8256
          ACCOUNTGEOGRAPHY: 6b7d4d0b-42b1-465f-8ccb-9513fc6da626
          SALESTERRITORY: e8d1a634-d4b1-4609-8370-5c02827f7db4
          EMPLOYEE: a7f237a1-4409-4432-ab25-4789043286b9
          OPC_VWAGGLEVEL1FORCEIDUSAGESTATS_LIFETIME_CONTACTS: 4de81596-476e-45ca-bd86-5c5368a16b7a
          OPC_VWAGGLEVEL1FORCEIDUSAGESTATS_ALL: f40363cb-ec2c-4bb3-ba5a-ce987f7c9535
          OMNIA_SCORE: 96749e90-aa72-4898-ae20-e121d7f852cf
          OPC_AGGLEVEL1_LTM: 3ee6d5dd-14fa-4362-abfd-c0c03dff3942
          OPC_AGGLEVEL1_PY_LTM: 76287839-b851-41dc-a758-334db18c6e46
          SUPPLIER: 4f59fbc0-7b06-498c-b967-f551d35c31c4
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNTGEOGRAPHY
          - locationName: DIM
            nodeName: EMPLOYEE
          - locationName: DIM
            nodeName: OMNIA_SCORE
          - locationName: DIM
            nodeName: SALESTERRITORY
          - locationName: DIM
            nodeName: SECTOR
          - locationName: DIM
            nodeName: SUPPLIER
          - locationName: OMNIA_CONNECT_OPC
            nodeName: OPC_ACCOUNT
          - locationName: OMNIA_PARTNERS_CONNECT
            nodeName: OPC_AGGLEVEL1_LTM
          - locationName: OMNIA_PARTNERS_CONNECT
            nodeName: OPC_AGGLEVEL1_PY_LTM
          - locationName: OMNIA_PARTNERS_CONNECT
            nodeName: OPC_VWAGGLEVEL1FORCEIDUSAGESTATS_ALL
          - locationName: OMNIA_PARTNERS_CONNECT
            nodeName: OPC_VWAGGLEVEL1FORCEIDUSAGESTATS_LIFETIME_CONTACTS
        join:
          joinCondition: |-
            FROM {{ ref('OMNIA_CONNECT_OPC','OPC_ACCOUNT') }} OPC_Account
              LEFT JOIN {{ ref('DIM','SECTOR') }} Sector
                ON OPC_Account.SectorKey = Sector.SectorKey
              LEFT JOIN {{ ref('DIM','ACCOUNTGEOGRAPHY') }} AccountGeography
                ON OPC_Account.AccountGeographyKey = AccountGeography.AccountGeographyKey
              LEFT JOIN {{ ref('DIM','SALESTERRITORY') }} SalesTerritory
                ON OPC_Account.SalesTerritoryKey = SalesTerritory.SalesTerritoryKey
              LEFT JOIN {{ ref('DIM','EMPLOYEE') }} Employee
                ON SalesTerritory.TerritoryManagerUPN = Employee.UserPrincipalName
              LEFT JOIN {{ ref('OMNIA_PARTNERS_CONNECT','OPC_VWAGGLEVEL1FORCEIDUSAGESTATS_LIFETIME_CONTACTS') }} OPC_vwAggLevel1ForceIdUsageStats_Lifetime_Contacts
                ON OPC_Account.Level1ForceId = OPC_vwAggLevel1ForceIdUsageStats_Lifetime_Contacts.ForceId
              LEFT JOIN {{ ref('OMNIA_PARTNERS_CONNECT','OPC_VWAGGLEVEL1FORCEIDUSAGESTATS_ALL') }} OPC_vwAggLevel1ForceIdUsageStats_All
                ON OPC_Account.Level1ForceId = OPC_vwAggLevel1ForceIdUsageStats_All.Level1ForceId
              LEFT JOIN {{ ref('DIM','OMNIA_SCORE') }} OMNIA_Score
                ON OPC_Account.AccountKey = OMNIA_Score.AccountKey
              LEFT JOIN {{ ref('OMNIA_PARTNERS_CONNECT','OPC_AGGLEVEL1_LTM') }} OPC_AggLevel1_LTM
                ON OPC_Account.Level1ForceId = OPC_AggLevel1_LTM.Level1ForceId
              LEFT JOIN {{ ref('OMNIA_PARTNERS_CONNECT','OPC_AGGLEVEL1_PY_LTM') }} OPC_AggLevel1_PY_LTM
                ON OPC_Account.Level1ForceId = OPC_AggLevel1_PY_LTM.Level1ForceId
              LEFT JOIN {{ ref('DIM','SUPPLIER') }} Supplier
                ON OPC_vwAggLevel1ForceIdUsageStats_All.SupplierId = Supplier.SupplierId
             WHERE OPC_Account.RecordDesignation = 'Account'
                OR (OPC_Account.RecordDesignation = 'Prospect' AND OPC_Account.Participating_Program = 'Club 25 Agency')
        name: SRC_OPC_LEVEL1CUSTOMERSEARCH_1_SUPPLIERID
        noLinkRefs: []
  name: OPC_LEVEL1CUSTOMERSEARCH
  overrideSQL: false
  schema: ""
  sqlType: Fact
  type: sql
  version: 1
type: Node
