fileVersion: 1
id: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
name: OPC_LEVEL1CUSTOMERSEARCH
operation:
  config:
    distinct: true
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: OMNIA_CONNECT_OPC
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b59554f-c0af-458b-a49d-81f9e2e6a9fe
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: INT
        defaultValue: ""
        description: is the highest-level of hierarchy for an account
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21211ff2-8822-4e39-aae7-8f707fba7e37
                stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f969f01e-2b56-4eb6-8dff-76941ffca98d
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the same value as the AccountName column, but has been run through a ProperCase function
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DISPLAYACCOUNTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: adcdda35-f145-4a49-81a5-8405e0edda62
                stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bfac4335-8816-4ab2-b2ca-72dbabf1b02a
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the type, or classification, of the account
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ACCOUNTTYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f89edba-12b2-4f52-9b42-ca6b8bbafa39
                stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2afe9199-c9e3-4c0c-8271-882bb6f0ba8d
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Street Address Line 1 matched with USPS.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91e1c718-2ec2-4078-acd2-492cb00b8093
                stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
            transform: COALESCE(INITCAP(OPC_Account.UspsAddress),'')
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e558b549-277f-4e2b-b834-22788665296b
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Street Address Line 2 matched with USPS.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ADDRESS2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 377142e5-2a19-4143-b3e8-568d303e630e
                stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2b3ab2a-ac5e-4309-be4d-0938434a4b21
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Address City matched with USPS.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2045265-384b-484e-b970-a2a2f816fe7a
                stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
            transform: COALESCE(OPC_Account.UspsCity, OPC_Account.City,'')
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6bc59097-22b4-44dc-ac27-190a4bc9c12a
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Address County matched with USPS.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: COUNTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 537f9aa2-6003-476e-a7a7-249ba858ffcf
                stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 242bf2aa-9f32-40fb-b363-0c671427fdc7
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Address State matched with USPS.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: STATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 14821ff5-4e8b-4de7-80b4-29ec0f3f497f
                stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
            transform: COALESCE(OPC_Account.UspsState, OPC_Account.State, '')
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f410e303-6ca3-4d8d-855c-3eb2f446da27
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Address PostalCode matched with USPS.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ZIPCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d4adc7b3-dc8c-4396-afaa-f6e150cccac5
                stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
            transform: COALESCE(OPC_Account.UspsZipCode, OPC_Account.ZipCode, '0')
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7b12d63-d021-4949-ae77-0273d2817458
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: DATE
        defaultValue: ""
        description: is the date that the account either registered or, in the event we do not have a registration, will be the date of first purchase
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: STARTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f2de7fdd-9f2f-4c90-b41c-4ec64a884aba
                stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0de12a83-481d-40d6-8318-f17c6aa17938
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Strategic Account Reason
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f54ec149-7cf1-4c44-8fa1-7adaefa60c01
                stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
            transform: COALESCE(OPC_Account.StrategicAccountReason,OPC_Account.MemberSegment)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4237df59-87bc-4aff-8c8c-774b95c25b78
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the 9-digit EIN (employer identification number) for the account
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: FEDERALTAXID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 855e2c28-c8f5-453f-a922-fb464c50b8ec
                stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9cb7fc0a-a5a6-41a5-a832-80167676efa9
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the primary URL for the account
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: WEBSITE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 154fc7bb-8c0e-4470-8563-ed9be43a77c3
                stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1cd294e8-59aa-41fd-b8e6-8e8011c7829a
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Territory Name
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e786f40-9ae6-4476-87cf-0f91ff148107
                stepCounter: d6a79cd8-6fb5-44b6-8edd-144a831c1a87
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6607b7c-9d94-4300-ab4f-fe41f8a2e7b0
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYDIVISIONLEADERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d4f62ec9-f4f8-4cf3-bda2-d1671753a5f8
                stepCounter: d6a79cd8-6fb5-44b6-8edd-144a831c1a87
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f63f37e2-3ee1-4af8-9f00-1e9950b5c803
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYDIVISIONLEADERUPN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 61691af4-05cb-43e2-a31d-8a52eda256db
                stepCounter: d6a79cd8-6fb5-44b6-8edd-144a831c1a87
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57d64892-2239-49e0-8f22-89fbbf02d2eb
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYGROUPLEADERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db258190-d312-4904-9342-3df956e50523
                stepCounter: d6a79cd8-6fb5-44b6-8edd-144a831c1a87
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f17e219-33fe-461c-824e-710a2229bdd7
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYGROUPLEADERUPN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd0aec4e-954d-4194-a2c6-8d486a241d0f
                stepCounter: d6a79cd8-6fb5-44b6-8edd-144a831c1a87
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d0702e9-34f3-4571-b426-2d29ff777415
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Territory Manager Name
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYMANAGER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dda776da-540a-4a6d-94b6-4b763c676560
                stepCounter: d6a79cd8-6fb5-44b6-8edd-144a831c1a87
            transform: |-
              CASE --  WHEN OPC_Account.StrategicAccountReason LIKE 'Tier 3%' THEN ''

                          WHEN Employee.Email = 'shayne.calzavara@omniapartners.com'           THEN ''
                          WHEN Employee.Email = 'doug.looney@omniapartners.com'                THEN 'OMNIA Partners Support'
                          ELSE SalesTerritory.TerritoryManager
                           END
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a6f5040-e6cc-4568-b880-b33da47c9b33
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYMANAGERUPN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2646e265-902a-4689-a010-e5f9ee4137b8
                stepCounter: d6a79cd8-6fb5-44b6-8edd-144a831c1a87
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8215786-3403-49ed-984a-f139d53c443d
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Territory Manager Email
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYMANAGEREMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1692d93-72bd-410e-b14f-52161511e436
                stepCounter: 3d6df800-db3f-4950-91b8-10cb2cd33d0d
            transform: |-
              CASE --  WHEN OPC_Account.StrategicAccountReason LIKE 'Tier 3%'

                          WHEN Employee.Email = 'shayne.calzavara@omniapartners.com'    THEN IFF(OPC_Account.UspsState = 'TX','ISO.Tier3TX@omniapartners.com','ISO.Tier3@omniapartners.com')
                          WHEN Employee.Email ='doug.looney@omniapartners.com'          THEN 'info@omniapartners.com'
                          ELSE Employee.Email
                           END
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6cf23b4-0e00-4f6a-9173-c11e53a3093f
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Territory Manager Office Phone Number
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYMANAGEROFFICEPHONENUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef033215-e5c1-42d9-a295-02a46107f6d5
                stepCounter: 3d6df800-db3f-4950-91b8-10cb2cd33d0d
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f54e9859-e344-4eda-9ed0-a9fcaf50e131
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Territory Manager Mobile Phone Number
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYMANAGERMOBILEPHONENUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 28b1e440-56dd-4f54-a0db-52d15bb3fcb7
                stepCounter: 3d6df800-db3f-4950-91b8-10cb2cd33d0d
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5250287e-41df-4a6c-8118-8fad9e656d90
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the name of the OMNIA Partners SPD team VP, who supervises a group of SPD Directors.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SPDVP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 08be3cf0-d836-46eb-9913-4b4f304b99d8
                stepCounter: 9f5fdf04-d6f5-421b-90d1-773791a249c8
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 543e0bbf-547c-4c9e-92b2-6d77040f1e56
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SPDVPEMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a0f25fe8-71bb-4b7f-9d44-4d8b8b6f756d
                stepCounter: 9f5fdf04-d6f5-421b-90d1-773791a249c8
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92786dd6-591e-47b1-b8f4-61758449dc46
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the name of the OMNIA Partners SPD team member responsible for managing the relationship with this supplier.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SPDDIRECTOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eae48aa1-3bd7-46cf-a442-031ece2ced37
                stepCounter: 9f5fdf04-d6f5-421b-90d1-773791a249c8
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 348e474e-61dc-4d8b-9334-5b29fcc44b19
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SPDDIRECTOREMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b48b0e8-4d71-4ff5-a891-1d9b80901455
                stepCounter: 9f5fdf04-d6f5-421b-90d1-773791a249c8
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 484b1721-96af-4ea9-96fe-3d3696a45984
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the preferred, cleaned up name of the supplier. This is the one you want to use for reports
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: REPORTINGSUPPLIERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e87ede00-fc9f-4c9c-adbc-10805a02a046
                stepCounter: 9f5fdf04-d6f5-421b-90d1-773791a249c8
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2e6feb6-2e80-44fc-884b-43a6a4816912
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: METROAREANAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6aa29dfd-1e4c-4c80-9a30-97438f8d4936
                stepCounter: 8f924652-6f75-4806-91c6-512d2aec293b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f60dcaa9-84c2-409c-874e-842461a20c2f
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: METROAREATOTALPOPULATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ba159e50-3bb8-4d3d-b71f-83a63eee75f6
                stepCounter: 8f924652-6f75-4806-91c6-512d2aec293b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a324c748-4dd7-4a92-bd39-8003ef3bb09e
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: Latitude
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LAT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4359890a-7a68-48c0-a8f3-512f4154f69c
                stepCounter: 8f924652-6f75-4806-91c6-512d2aec293b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f450a16-84f8-45f5-b257-e03c2ac9b57e
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: Longitude
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 28f8456c-d01c-4e42-82cd-3da75e21fd15
                stepCounter: 8f924652-6f75-4806-91c6-512d2aec293b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc7acd5d-84b8-48fa-92e5-855a41bb6111
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Sector
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SECTOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1387474e-fcf4-4a8b-8490-ea1a4e0ac9ca
                stepCounter: 85493fd2-0856-4b9b-9baa-aeff138297e1
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64dd8be7-9888-472a-a521-b2a7accc4ecc
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Supplier Id
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60452d79-c846-4f83-8305-95e86979f32a
                stepCounter: 8cf1d4bb-b9bf-4657-bac9-cb2274b7f325
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e1c6290-689f-4a3a-ab98-3f8f7e12b818
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: INT
        defaultValue: ""
        description: Number Of Contacts for given Level 1 ForceId
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: NUMBEROFCONTACTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 82f61b0b-c470-4e26-a8d4-4acaf9da242b
                stepCounter: f5cf40f3-dc12-4ece-87c1-88f04ff1ad2f
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f00ec30-f1f2-4547-8417-882acda6507d
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: Previous 12 Months Sum Of Sales
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PREVIOUS12MONTHS_SUMOFSALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb62b7a9-91f3-4537-a182-2644c080bb6b
                stepCounter: 8cf1d4bb-b9bf-4657-bac9-cb2274b7f325
            transform: IFNULL(OPC_vwAggLevel1ForceIdUsageStats_All.Previous12Months_SumOfSales,0)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d53b7e9-e687-42ae-b7e1-09ed81218007
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: Current 12 Months Sum Of Sales
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CURRENT12MONTHS_SUMOFSALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e82cf21-536e-482c-9be8-38a48ccdbaa7
                stepCounter: 8cf1d4bb-b9bf-4657-bac9-cb2274b7f325
            transform: IFNULL(OPC_vwAggLevel1ForceIdUsageStats_All.Current12Months_SumOfSales,0)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4eb976e8-65df-4b0a-b9a5-c5ecd08b86f8
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: (Current 12 Months Sales) - (Previous 12 Months Sales)
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CURRENT12MONTHS_SALESDIFF
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e82cf21-536e-482c-9be8-38a48ccdbaa7
                stepCounter: 8cf1d4bb-b9bf-4657-bac9-cb2274b7f325
            transform: IFNULL(Current12Months_SumOfSales - Previous12Months_SumOfSales,0)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39b3f2d6-f350-4921-bc87-33f8094c915b
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ((Current 12 Months Sales) - (Previous 12 Months Sales)) / (Previous 12 Months Sales)
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CURRENT12MONTHS_SALESDIFFPERC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e82cf21-536e-482c-9be8-38a48ccdbaa7
                stepCounter: 8cf1d4bb-b9bf-4657-bac9-cb2274b7f325
            transform: IFNULL((Current12Months_SumOfSales - Previous12Months_SumOfSales)/NULLIF(Previous12Months_SumOfSales,0),0)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f20e643c-b1c9-49a5-903b-e415910f99d7
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: INT
        defaultValue: ""
        description: Previous 12 Months Number Of Suppliers Used
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PREVIOUS12MONTHS_NUMOFSUPPLIERSUSED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4d23f27-302c-4ec9-8cbf-62af8d228680
                stepCounter: 5bb37ba3-9ad7-4dba-9355-ca41a21cba01
            transform: IFNULL(OPC_AggLevel1_PY_LTM.Level1_PY_LTM_NumOfSuppliersUsed,0)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a061f640-fa1b-4cea-8960-6eac57785ec0
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: INT
        defaultValue: ""
        description: Current 12 Months Number Of Suppliers Used
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CURRENT12MONTHS_NUMOFSUPPLIERSUSED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51d64f60-8da4-480c-8f97-beae68f2ae9e
                stepCounter: c919004d-c222-4f5a-8f12-2dd286586d91
            transform: IFNULL(OPC_AggLevel1_LTM.Level1_LTM_NumOfSuppliersUsed,0)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 502adfb8-0cfa-459c-a0cd-6a0144e2e4b1
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: INT
        defaultValue: ""
        description: (Current 12 Months Number Of Suppliers Used) - (Previous 12 Months Number Of Suppliers Used)
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CURRENT12MONTHS_NUMOFSUPPLIERSUSEDDIFF
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51d64f60-8da4-480c-8f97-beae68f2ae9e
                stepCounter: c919004d-c222-4f5a-8f12-2dd286586d91
            transform: ZEROIFNULL(OPC_AggLevel1_LTM.Level1_LTM_NumOfSuppliersUsed) - ZEROIFNULL(OPC_AggLevel1_PY_LTM.Level1_PY_LTM_NumOfSuppliersUsed)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd37cef3-f514-4466-967b-ff54a95b86a0
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ((Current 12 Months Number Of Suppliers Used) - (Previous 12 Months Number Of Suppliers Used)) / (Previous 12 Months Number Of Suppliers Used)
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CURRENT12MONTHS_NUMOFSUPPLIERSUSEDDIFFPERC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51d64f60-8da4-480c-8f97-beae68f2ae9e
                stepCounter: c919004d-c222-4f5a-8f12-2dd286586d91
            transform: IFNULL((ZEROIFNULL(OPC_AggLevel1_LTM.Level1_LTM_NumOfSuppliersUsed) - ZEROIFNULL(OPC_AggLevel1_PY_LTM.Level1_PY_LTM_NumOfSuppliersUsed))/NULLIF(OPC_AggLevel1_PY_LTM.Level1_PY_LTM_NumOfSuppliersUsed, 0),0)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f42c7733-5086-428f-9626-ded33f85f165
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: OMNIA Engagement Score
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OMNIA_SCORE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 34a817be-e87b-44cc-a23b-4fbebf8a5670
                stepCounter: 46b2bea9-9815-472d-9eb1-469a35e14463
            transform: |-
              CASE COALESCE(OPC_Account.StrategicAccountReason,OPC_Account.MemberSegment) --Public (Account.StrategicAccountReason)

                          WHEN 'Market Mover'                                                                                                THEN '10'
                          WHEN 'Tier 1'                                                                                                      THEN '10'
                          WHEN 'Tier 2'                                                                                                      THEN '10' --Private (Account.MemberSegment)

                          WHEN 'Fortune 1000'                                                                                                THEN '10'
                          WHEN 'Bullseye'                                                                                                    THEN '10' --Else

                          ELSE IFNULL(OMNIA_Score.OMNIA_Score,'Starter')
                           END
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b7c67e0-aaa0-4497-b4bc-b29ecb3f8313
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: MAXRECEIPTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e3a994c2-e82d-4d81-b6a2-25a7fdd0d1c2
                stepCounter: 8cf1d4bb-b9bf-4657-bac9-cb2274b7f325
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b787cd8b-d482-470f-bfb6-eefa91275a8f
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Size Band Code
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CUSTOMER_SIZE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 99e2a756-8b2c-4cfd-9716-422b5d519931
                stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
            transform: IFNULL(OPC_Account.Customer_Size_Code,'')
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53b5b83c-58f9-44e3-9e15-35f7319bbc65
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Customer Size Band
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CUSTOMERSIZEBAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ae59306d-841c-48ff-8f2a-86dea689fc92
                stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
            transform: IFNULL(OPC_Account.CUSTOMER_SIZE_BAND,'Unknown')
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59844245-c61b-4dce-bfa3-ec99a4b69097
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: INT
        defaultValue: ""
        description: Size Band Number
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CUSTOMER_SIZE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39c32a95-0e5d-4d61-b18d-584df26a74f1
                stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 30a0e182-9b76-48ea-b80a-88853317045f
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Significant Capital Spend in Last 3 Years
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SIGNIFICANTCAPITALSPENDINLAST3YEARS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1e72de1-a40f-4721-bfdd-b5ffb692ec3d
                stepCounter: 8cf1d4bb-b9bf-4657-bac9-cb2274b7f325
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f4f166a-754d-4db8-9896-ebbe91772a39
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: WESHARE_PARTICIPANT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ca553eb-eb4a-460d-8202-348eae5c2096
                stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d3421ff-1fc9-4150-9488-5bd538579bf5
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PARTICIPATING_PROGRAM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: faad0887-9047-4a6f-8169-80948e275c5b
                stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d64ded8-a99d-4eac-9c93-7ff4ed2c5d7a
          stepCounter: b42cbdc7-17e0-4d65-8321-ef29ec7b8c8a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: denotes whether the row is an Account, Child Account, Duplicate, or Delivery Location.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: RECORDDESIGNATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1aafd628-644f-4d98-af7e-79efe4401c2c
                stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          OPC_ACCOUNT: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
          SECTOR: 85493fd2-0856-4b9b-9baa-aeff138297e1
          ACCOUNTGEOGRAPHY: 8f924652-6f75-4806-91c6-512d2aec293b
          SALESTERRITORY: d6a79cd8-6fb5-44b6-8edd-144a831c1a87
          EMPLOYEE: 3d6df800-db3f-4950-91b8-10cb2cd33d0d
          OPC_VWAGGLEVEL1FORCEIDUSAGESTATS_LIFETIME_CONTACTS: f5cf40f3-dc12-4ece-87c1-88f04ff1ad2f
          OPC_VWAGGLEVEL1FORCEIDUSAGESTATS_ALL: 8cf1d4bb-b9bf-4657-bac9-cb2274b7f325
          OMNIA_SCORE: 46b2bea9-9815-472d-9eb1-469a35e14463
          OPC_AGGLEVEL1_LTM: c919004d-c222-4f5a-8f12-2dd286586d91
          OPC_AGGLEVEL1_PY_LTM: 5bb37ba3-9ad7-4dba-9355-ca41a21cba01
          SUPPLIER: 9f5fdf04-d6f5-421b-90d1-773791a249c8
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNTGEOGRAPHY
          - locationName: DIM
            nodeName: EMPLOYEE
          - locationName: DIM
            nodeName: OMNIA_SCORE
          - locationName: DIM
            nodeName: SALESTERRITORY
          - locationName: DIM
            nodeName: SECTOR
          - locationName: DIM
            nodeName: SUPPLIER
          - locationName: OMNIA_CONNECT_OPC
            nodeName: OPC_ACCOUNT
          - locationName: OMNIA_PARTNERS_CONNECT
            nodeName: OPC_AGGLEVEL1_LTM
          - locationName: OMNIA_PARTNERS_CONNECT
            nodeName: OPC_AGGLEVEL1_PY_LTM
          - locationName: OMNIA_PARTNERS_CONNECT
            nodeName: OPC_VWAGGLEVEL1FORCEIDUSAGESTATS_ALL
          - locationName: OMNIA_PARTNERS_CONNECT
            nodeName: OPC_VWAGGLEVEL1FORCEIDUSAGESTATS_LIFETIME_CONTACTS
        join:
          joinCondition: |-
            FROM {{ ref('OMNIA_CONNECT_OPC','OPC_ACCOUNT') }} OPC_Account
              LEFT JOIN {{ ref('DIM','SECTOR') }} Sector
                ON OPC_Account.SectorKey = Sector.SectorKey
              LEFT JOIN {{ ref('DIM','ACCOUNTGEOGRAPHY') }} AccountGeography
                ON OPC_Account.AccountGeographyKey = AccountGeography.AccountGeographyKey
              LEFT JOIN {{ ref('DIM','SALESTERRITORY') }} SalesTerritory
                ON OPC_Account.SalesTerritoryKey = SalesTerritory.SalesTerritoryKey
              LEFT JOIN {{ ref('DIM','EMPLOYEE') }} Employee
                ON SalesTerritory.TerritoryManagerUPN = Employee.UserPrincipalName
              LEFT JOIN {{ ref('OMNIA_PARTNERS_CONNECT','OPC_VWAGGLEVEL1FORCEIDUSAGESTATS_LIFETIME_CONTACTS') }} OPC_vwAggLevel1ForceIdUsageStats_Lifetime_Contacts
                ON OPC_Account.Level1ForceId = OPC_vwAggLevel1ForceIdUsageStats_Lifetime_Contacts.ForceId
              LEFT JOIN {{ ref('OMNIA_PARTNERS_CONNECT','OPC_VWAGGLEVEL1FORCEIDUSAGESTATS_ALL') }} OPC_vwAggLevel1ForceIdUsageStats_All
                ON OPC_Account.Level1ForceId = OPC_vwAggLevel1ForceIdUsageStats_All.Level1ForceId
              LEFT JOIN {{ ref('DIM','OMNIA_SCORE') }} OMNIA_Score
                ON OPC_Account.AccountKey = OMNIA_Score.AccountKey
              LEFT JOIN {{ ref('OMNIA_PARTNERS_CONNECT','OPC_AGGLEVEL1_LTM') }} OPC_AggLevel1_LTM
                ON OPC_Account.Level1ForceId = OPC_AggLevel1_LTM.Level1ForceId
              LEFT JOIN {{ ref('OMNIA_PARTNERS_CONNECT','OPC_AGGLEVEL1_PY_LTM') }} OPC_AggLevel1_PY_LTM
                ON OPC_Account.Level1ForceId = OPC_AggLevel1_PY_LTM.Level1ForceId
              LEFT JOIN {{ ref('DIM','SUPPLIER') }} Supplier
                ON OPC_vwAggLevel1ForceIdUsageStats_All.SupplierId = Supplier.SupplierId
             WHERE OPC_Account.RecordDesignation = 'Account'
                OR (OPC_Account.RecordDesignation = 'Prospect' AND OPC_Account.Participating_Program = 'Club 25 Agency')
        name: SRC_OPC_LEVEL1CUSTOMERSEARCH_1_SUPPLIERID
        noLinkRefs: []
  name: OPC_LEVEL1CUSTOMERSEARCH
  overrideSQL: false
  schema: ""
  sqlType: Fact
  type: sql
  version: 1
type: Node
