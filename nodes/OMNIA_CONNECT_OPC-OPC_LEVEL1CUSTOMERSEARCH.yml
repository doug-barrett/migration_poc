fileVersion: 1
id: 4693c755-27bb-4243-8b47-359d721249aa
name: OPC_LEVEL1CUSTOMERSEARCH
operation:
  config:
    distinct: true
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: OMNIA_CONNECT_OPC
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db32df24-9c00-4976-8147-6c8bc455990a
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE HIGHEST-LEVEL OF HIERARCHY FOR AN ACCOUNT
        isBusinessKey: true
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 45b1e391-1f57-4616-bfb8-5a95e8fa0bf7
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a53fb4ee-1bd7-4376-bc5e-c250f7c98350
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE SAME VALUE AS THE ACCOUNTNAME COLUMN, BUT HAS BEEN RUN THROUGH A PROPERCASE FUNCTION
        name: DISPLAYACCOUNTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09d28d69-519f-447f-8b65-4727420cafdf
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c313a15-2da5-46e4-9fb3-5d338e850266
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE TYPE, OR CLASSIFICATION, OF THE ACCOUNT
        name: ACCOUNTTYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22d869e0-abeb-4bbe-bca9-75515b13b847
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: feb7da09-05b0-420a-88d5-b778433550b8
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: STREET ADDRESS LINE 1 MATCHED WITH USPS.
        name: ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 34dd0325-bdf8-464c-8a59-b5271d3577f5
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: COALESCE(INITCAP(OPC_ACCOUNT.USPSADDRESS),'')
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b33b8ecb-fae0-4d5c-a3e9-a30ec48b6a0f
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: STREET ADDRESS LINE 2 MATCHED WITH USPS.
        name: ADDRESS2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0523e6b9-4784-4ede-b143-736ccd7b4582
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b185448a-201a-46f6-aa1e-f456e29edfde
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ADDRESS CITY MATCHED WITH USPS.
        name: CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 813084ef-8c40-446d-a99e-4e1363c6c4c6
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: COALESCE(OPC_ACCOUNT.USPSCITY, OPC_ACCOUNT.CITY,'')
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0a3bedb-2366-4bb4-b644-2d9944f2e98f
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ADDRESS COUNTY MATCHED WITH USPS.
        name: COUNTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb6c2e78-61ef-40d8-91c0-59f55c815a00
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 311b0814-de74-42f2-b6dc-14063cc3adcb
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ADDRESS STATE MATCHED WITH USPS.
        name: STATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 06ea2b65-4762-4098-a147-c6a7b2712887
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: COALESCE(OPC_ACCOUNT.USPSSTATE, OPC_ACCOUNT.STATE, '')
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6db7f617-1db7-4db8-9cde-0c42a41e0e88
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ADDRESS POSTALCODE MATCHED WITH USPS.
        name: ZIPCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 85d681a7-0d4c-4f6d-bec9-29971837b8f5
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: COALESCE(OPC_ACCOUNT.USPSZIPCODE, OPC_ACCOUNT.ZIPCODE, '0')
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ef44db9-680d-474f-825e-099e231f21e6
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: DATE
        defaultValue: ""
        description: IS THE DATE THAT THE ACCOUNT EITHER REGISTERED OR, IN THE EVENT WE DO NOT HAVE A REGISTRATION, WILL BE THE DATE OF FIRST PURCHASE
        name: STARTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 274e66f2-2cd0-415f-8e4f-e516950eaec3
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c68c95d6-6788-407e-a5db-8c736cd9595d
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: STRATEGIC ACCOUNT REASON
        name: TIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 15ff087f-90cc-4dad-bdaa-eb6d3d7f8ac0
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: COALESCE(OPC_ACCOUNT.STRATEGICACCOUNTREASON,OPC_ACCOUNT.MEMBERSEGMENT)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e884532d-4150-41a4-9793-16bb901ac907
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE 9-DIGIT EIN (EMPLOYER IDENTIFICATION NUMBER) FOR THE ACCOUNT
        name: FEDERALTAXID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ac658b1-7ee0-4ab7-bf38-4a245f5e0a90
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d8dca5c-a576-4616-9747-b1dbeff9b4f4
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE PRIMARY URL FOR THE ACCOUNT
        name: WEBSITE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d1c6f580-97a8-447a-83a3-cabcd6c439ff
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18ed3e69-ccc5-4e65-9e11-7840ebf457c3
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: TERRITORY NAME
        name: TERRITORYNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6646e42a-401f-4bad-8eb0-aa65f2a7e75b
                stepCounter: 07968cf7-54e4-49f9-a23e-a93b9c30c8d0
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c558001-f74b-4c39-bb27-71ec17cc2afa
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYDIVISIONLEADERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 141e263c-8921-40f7-8435-a67a8347c72c
                stepCounter: 07968cf7-54e4-49f9-a23e-a93b9c30c8d0
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a04e983a-e6c7-4c21-b123-ad096d9965f6
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYDIVISIONLEADERUPN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 513a49b4-1874-48b9-a3f8-d6ab58ec84c2
                stepCounter: 07968cf7-54e4-49f9-a23e-a93b9c30c8d0
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e8f4110-98d7-451e-a1c0-957efa3270b0
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYGROUPLEADERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc6d4edb-6819-4514-b092-a53ff7b8da36
                stepCounter: 07968cf7-54e4-49f9-a23e-a93b9c30c8d0
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6f76191-e94d-44a1-9cc9-7eac489f1c3f
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYGROUPLEADERUPN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 86ec063c-5bef-4108-9302-b344b0fb3d39
                stepCounter: 07968cf7-54e4-49f9-a23e-a93b9c30c8d0
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98888588-7920-46c0-85dc-6cc9e24bad71
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: TERRITORY MANAGER NAME
        name: TERRITORYMANAGER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 121a5d0e-47ff-4a72-9451-053498effab3
                stepCounter: 07968cf7-54e4-49f9-a23e-a93b9c30c8d0
            transform: |-
              CASE \N--  WHEN OPC_ACCOUNT.STRATEGICACCOUNTREASON LIKE 'TIER 3%' THEN ''
              \N WHEN EMPLOYEE.EMAIL = 'SHAYNE.CALZAVARA@OMNIAPARTNERS.COM' THEN '' \N WHEN EMPLOYEE.EMAIL = 'DOUG.LOONEY@OMNIAPARTNERS.COM' THEN 'OMNIA PARTNERS SUPPORT' \N ELSE SALESTERRITORY.TERRITORYMANAGER \NEND
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea0fe8b4-d2a3-41e2-8993-a8516637d667
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYMANAGERUPN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e23f7c74-1367-41b5-95ac-015cc3b967a7
                stepCounter: 07968cf7-54e4-49f9-a23e-a93b9c30c8d0
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d828f8e-52ed-487a-9a4f-3fe8a6ff5f71
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: TERRITORY MANAGER EMAIL
        name: TERRITORYMANAGEREMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72b8981d-3ef3-48f3-8d25-d543d23e1220
                stepCounter: 0b93ae97-da2a-4760-b19c-d39a706c9a75
            transform: |-
              CASE \N--  WHEN OPC_ACCOUNT.STRATEGICACCOUNTREASON LIKE 'TIER 3%'
              \N WHEN EMPLOYEE.EMAIL = 'SHAYNE.CALZAVARA@OMNIAPARTNERS.COM' \N THEN IFF(OPC_ACCOUNT.USPSSTATE = 'TX','ISO.TIER3TX@OMNIAPARTNERS.COM','ISO.TIER3@OMNIAPARTNERS.COM') \N WHEN EMPLOYEE.EMAIL ='DOUG.LOONEY@OMNIAPARTNERS.COM' THEN 'INFO@OMNIAPARTNERS.COM' \N ELSE EMPLOYEE.EMAIL \NEND \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 909b2de5-9e80-46d1-af62-e99dc16a0166
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: TERRITORY MANAGER OFFICE PHONE NUMBER
        name: TERRITORYMANAGEROFFICEPHONENUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07c9e6db-013f-4de8-a942-f4944576c20e
                stepCounter: 0b93ae97-da2a-4760-b19c-d39a706c9a75
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42bef4d8-f3bf-4b67-b268-e36051fe76f3
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: TERRITORY MANAGER MOBILE PHONE NUMBER
        name: TERRITORYMANAGERMOBILEPHONENUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19dcfd4c-b4c0-47a1-be29-29117869690d
                stepCounter: 0b93ae97-da2a-4760-b19c-d39a706c9a75
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 08417e62-8f10-4833-9218-c77515463418
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE NAME OF THE OMNIA PARTNERS SPD TEAM VP, WHO SUPERVISES A GROUP OF SPD DIRECTORS.
        name: SPDVP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e84c2af3-8a92-41bf-9385-793aa1922991
                stepCounter: 470235be-2b1f-4c18-8481-f03bb4bed667
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06e9f648-34ed-48a6-a68c-93381ef2790c
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SPDVPEMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8869a513-06bb-400f-b7c1-88c8e753d198
                stepCounter: 470235be-2b1f-4c18-8481-f03bb4bed667
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2fdc3b99-19a5-4afd-9fdc-c7e39d4a61b7
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE NAME OF THE OMNIA PARTNERS SPD TEAM MEMBER RESPONSIBLE FOR MANAGING THE RELATIONSHIP WITH THIS SUPPLIER.
        name: SPDDIRECTOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3c14ab2a-59c5-439d-bcf0-2a08dca9f483
                stepCounter: 470235be-2b1f-4c18-8481-f03bb4bed667
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df70f00d-ee01-4118-9abb-5b900a522d27
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SPDDIRECTOREMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d366bbdf-55f8-43b1-b00e-d7259f451bea
                stepCounter: 470235be-2b1f-4c18-8481-f03bb4bed667
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40786c18-90fb-4c1f-86ea-6a9c1548ad51
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE PREFERRED, CLEANED UP NAME OF THE SUPPLIER. THIS IS THE ONE YOU WANT TO USE FOR REPORTS
        name: REPORTINGSUPPLIERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d540aa96-a25c-45d3-b97c-86a23d48d564
                stepCounter: 470235be-2b1f-4c18-8481-f03bb4bed667
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2a68967-304d-4f45-9a22-49479c6c13ea
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: METROAREANAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b58e99f3-cb2d-4476-bed9-6c3eec7faf4f
                stepCounter: d0f4be43-15dd-4e34-9b37-62ad9deca642
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee7e8346-e333-489d-98d9-c3a662903b72
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: ""
        name: METROAREATOTALPOPULATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 142cd11d-8c6d-406a-85ef-db27981303c1
                stepCounter: d0f4be43-15dd-4e34-9b37-62ad9deca642
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a95897ec-ec9c-453c-9e4a-d0ccec0c8e0b
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: LATITUDE
        name: LAT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 193d3c29-ca5e-4e3b-8ebb-29e1b2489015
                stepCounter: d0f4be43-15dd-4e34-9b37-62ad9deca642
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77d11887-2c13-4b24-ada6-65b30d522767
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: LONGITUDE
        name: LON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 399c45c4-cb76-4b4b-a85d-02f692004d53
                stepCounter: d0f4be43-15dd-4e34-9b37-62ad9deca642
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 60121422-8a15-4ff8-8718-0f17a4cd8346
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SECTOR
        name: SECTOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e65f138e-d202-4a0f-9582-c19139f64000
                stepCounter: a087658c-732e-4983-8055-10c77da80366
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50ea0ced-0478-4f9f-a58c-83cac1df28ca
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER ID
        isBusinessKey: true
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 596a6da3-4684-4f36-91e0-6a673f349671
                stepCounter: 9c2ad97b-6501-4cb5-8602-b24b0fbf9ed4
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dbdbd41a-7881-4a71-93eb-2e9448be74b8
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: INT
        defaultValue: ""
        description: NUMBER OF CONTACTS FOR GIVEN LEVEL 1 FORCEID
        name: NUMBEROFCONTACTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dba4cf8a-012f-4a49-9ed7-7089a794b0c2
                stepCounter: c9744949-b951-4549-adaf-f5e0bafaf072
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6340eae8-39e8-4a34-9a9c-7c8318295521
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: PREVIOUS 12 MONTHS SUM OF SALES
        name: PREVIOUS12MONTHS_SUMOFSALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ac849c6-b68f-490c-99e4-67b8b31644ac
                stepCounter: 9c2ad97b-6501-4cb5-8602-b24b0fbf9ed4
            transform: IFNULL(OPC_VWAGGLEVEL1FORCEIDUSAGESTATS_ALL.PREVIOUS12MONTHS_SUMOFSALES,0)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 300bda33-7c11-48f5-acb8-8be02295a1a2
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: CURRENT 12 MONTHS SUM OF SALES
        name: CURRENT12MONTHS_SUMOFSALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e0c62411-24c8-4078-b8b2-4fde9a1deadc
                stepCounter: 9c2ad97b-6501-4cb5-8602-b24b0fbf9ed4
            transform: IFNULL(OPC_VWAGGLEVEL1FORCEIDUSAGESTATS_ALL.CURRENT12MONTHS_SUMOFSALES,0)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c5f6388-73e8-43fb-ae73-653291f72eab
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: (CURRENT 12 MONTHS SALES) - (PREVIOUS 12 MONTHS SALES)
        name: CURRENT12MONTHS_SALESDIFF
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e0c62411-24c8-4078-b8b2-4fde9a1deadc
                stepCounter: 9c2ad97b-6501-4cb5-8602-b24b0fbf9ed4
            transform: IFNULL(CURRENT12MONTHS_SUMOFSALES - PREVIOUS12MONTHS_SUMOFSALES,0)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a4597233-a29a-4d3c-a102-f8040d790e7e
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ((CURRENT 12 MONTHS SALES) - (PREVIOUS 12 MONTHS SALES)) / (PREVIOUS 12 MONTHS SALES)
        name: CURRENT12MONTHS_SALESDIFFPERC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e0c62411-24c8-4078-b8b2-4fde9a1deadc
                stepCounter: 9c2ad97b-6501-4cb5-8602-b24b0fbf9ed4
            transform: IFNULL((CURRENT12MONTHS_SUMOFSALES - PREVIOUS12MONTHS_SUMOFSALES)/NULLIF(PREVIOUS12MONTHS_SUMOFSALES,0),0)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9549af0-1cde-4097-8310-a37d99075db1
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: INT
        defaultValue: ""
        description: PREVIOUS 12 MONTHS NUMBER OF SUPPLIERS USED
        name: PREVIOUS12MONTHS_NUMOFSUPPLIERSUSED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d85855f5-06b0-4803-9e32-6cb2fb458bf8
                stepCounter: b8ea90bb-2445-45fc-9d75-6e699147bc90
            transform: IFNULL(OPC_AGGLEVEL1_PY_LTM.LEVEL1_PY_LTM_NUMOFSUPPLIERSUSED,0)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77ba9d3e-d21b-44a3-8189-25998fcd47ed
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: INT
        defaultValue: ""
        description: CURRENT 12 MONTHS NUMBER OF SUPPLIERS USED
        name: CURRENT12MONTHS_NUMOFSUPPLIERSUSED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a5f13dd3-e0a8-48ef-a583-b8fc3d01f758
                stepCounter: 21c649ab-1c42-4b33-bda4-057e463dbf9f
            transform: IFNULL(OPC_AGGLEVEL1_LTM.LEVEL1_LTM_NUMOFSUPPLIERSUSED,0)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e62b7991-7e02-495e-b2f0-e381164e74d9
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: INT
        defaultValue: ""
        description: (CURRENT 12 MONTHS NUMBER OF SUPPLIERS USED) - (PREVIOUS 12 MONTHS NUMBER OF SUPPLIERS USED)
        name: CURRENT12MONTHS_NUMOFSUPPLIERSUSEDDIFF
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a5f13dd3-e0a8-48ef-a583-b8fc3d01f758
                stepCounter: 21c649ab-1c42-4b33-bda4-057e463dbf9f
            transform: ZEROIFNULL(OPC_AGGLEVEL1_LTM.LEVEL1_LTM_NUMOFSUPPLIERSUSED) - ZEROIFNULL(OPC_AGGLEVEL1_PY_LTM.LEVEL1_PY_LTM_NUMOFSUPPLIERSUSED)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c78e5c88-b1ad-4913-b226-27cfa60e4a0b
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: ((CURRENT 12 MONTHS NUMBER OF SUPPLIERS USED) - (PREVIOUS 12 MONTHS NUMBER OF SUPPLIERS USED)) / (PREVIOUS 12 MONTHS NUMBER OF SUPPLIERS USED)
        name: CURRENT12MONTHS_NUMOFSUPPLIERSUSEDDIFFPERC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a5f13dd3-e0a8-48ef-a583-b8fc3d01f758
                stepCounter: 21c649ab-1c42-4b33-bda4-057e463dbf9f
            transform: IFNULL((ZEROIFNULL(OPC_AGGLEVEL1_LTM.LEVEL1_LTM_NUMOFSUPPLIERSUSED) - ZEROIFNULL(OPC_AGGLEVEL1_PY_LTM.LEVEL1_PY_LTM_NUMOFSUPPLIERSUSED) \N)/NULLIF(OPC_AGGLEVEL1_PY_LTM.LEVEL1_PY_LTM_NUMOFSUPPLIERSUSED, 0),0)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 58a1b92d-219e-4bb5-bf18-f93b7eb4da1b
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: OMNIA ENGAGEMENT SCORE
        name: OMNIA_SCORE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 823fad5a-777a-4566-8e36-b30a4cd63aa7
                stepCounter: 25b4c50b-c253-4add-84a1-3c9a0e1708be
            transform: |-
              CASE COALESCE(OPC_ACCOUNT.STRATEGICACCOUNTREASON,OPC_ACCOUNT.MEMBERSEGMENT) \N --PUBLIC (ACCOUNT.STRATEGICACCOUNTREASON)
              \N WHEN 'MARKET MOVER' THEN '10' \N WHEN 'TIER 1' THEN '10' \N WHEN 'TIER 2' THEN '10' \N --PRIVATE (ACCOUNT.MEMBERSEGMENT)
              \N WHEN 'FORTUNE 1000' THEN '10' \N WHEN 'BULLSEYE' THEN '10' \N --ELSE
              \N ELSE IFNULL(OMNIA_SCORE.OMNIA_SCORE,'STARTER') \NEND
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f8634e3d-026e-4b60-bdd2-ca65c00351e1
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: MAXRECEIPTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5558465c-f71a-4f14-a2a8-8a2da675e28b
                stepCounter: 9c2ad97b-6501-4cb5-8602-b24b0fbf9ed4
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc4c928f-ca84-46f9-8850-a2e2e13953d4
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SIZE BAND CODE
        name: CUSTOMER_SIZE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7208171-d75f-4fab-bace-2ec38fa672b8
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: IFNULL(OPC_ACCOUNT.CUSTOMER_SIZE_CODE,'')
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b542689d-49ed-4714-ac7a-6f4abd702d1a
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: CUSTOMER SIZE BAND
        name: CUSTOMERSIZEBAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 600bb171-27fc-4f2f-86b6-a88ddfd468b3
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: IFNULL(OPC_ACCOUNT.CUSTOMER_SIZE_BAND,'UNKNOWN')
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b57a27a1-b9f0-42fd-8302-45df351c70ae
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: INT
        defaultValue: ""
        description: SIZE BAND NUMBER
        name: CUSTOMER_SIZE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c307adac-b53a-4806-8372-085884d8172b
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c02261f-c681-4ae6-82c3-238b0a9fd21e
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SIGNIFICANT CAPITAL SPEND IN LAST 3 YEARS
        name: SIGNIFICANTCAPITALSPENDINLAST3YEARS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec0d8466-3ffe-4e5b-a222-ba12e3e7ff82
                stepCounter: 9c2ad97b-6501-4cb5-8602-b24b0fbf9ed4
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ef1aaa0-0cd6-47d2-a9c3-6d6843802184
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        name: WESHARE_PARTICIPANT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1956570d-899f-43fb-8561-a63d8f1de0a8
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7075b276-5e8f-4c7a-8255-b92e8608ca24
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PARTICIPATING_PROGRAM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 865dad22-4118-4060-851f-9c80e828b3f7
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf31db9c-35b9-49b9-bac1-55692d37b432
          stepCounter: 4693c755-27bb-4243-8b47-359d721249aa
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: DENOTES WHETHER THE ROW IS AN ACCOUNT, CHILD ACCOUNT, DUPLICATE, OR DELIVERY LOCATION.
        name: RECORDDESIGNATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ff3ea4e-a612-47e0-a706-f43a6caee5d3
                stepCounter: 3353bc4b-96a5-43e1-9c39-6e2080820932
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          OPC_ACCOUNT: 3353bc4b-96a5-43e1-9c39-6e2080820932
          SECTOR: a087658c-732e-4983-8055-10c77da80366
          ACCOUNTGEOGRAPHY: d0f4be43-15dd-4e34-9b37-62ad9deca642
          SALESTERRITORY: 07968cf7-54e4-49f9-a23e-a93b9c30c8d0
          EMPLOYEE: 0b93ae97-da2a-4760-b19c-d39a706c9a75
          OMNIA_SCORE: 25b4c50b-c253-4add-84a1-3c9a0e1708be
          SUPPLIER: 470235be-2b1f-4c18-8481-f03bb4bed667
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNTGEOGRAPHY
          - locationName: DIM
            nodeName: EMPLOYEE
          - locationName: DIM
            nodeName: OMNIA_SCORE
          - locationName: DIM
            nodeName: SALESTERRITORY
          - locationName: DIM
            nodeName: SECTOR
          - locationName: DIM
            nodeName: SUPPLIER
          - locationName: OMNIA_CONNECT_OPC
            nodeName: OPC_ACCOUNT
          - locationName: OMNIA_PARTNERS_CONNECT
            nodeName: OPC_AGG_LEVEL1_LTM
          - locationName: OMNIA_PARTNERS_CONNECT
            nodeName: OPC_AGG_LEVEL1_PY_LTM
          - locationName: OMNIA_PARTNERS_CONNECT
            nodeName: OPC_VW_AGG_LEVEL1FORCEIDUSAGESTATS_ALL
          - locationName: OMNIA_PARTNERS_CONNECT
            nodeName: OPC_VW_AGG_LEVEL1FORCEIDUSAGESTATS_LIFETIME_CONTACTS
          - locationName: UNKNOWN
            nodeName: OPC_VWAGGLEVEL1FORCEIDUSAGESTATS_LIFETIME_CONTACTS
          - locationName: UNKNOWN
            nodeName: OPC_VWAGGLEVEL1FORCEIDUSAGESTATS_ALL
          - locationName: UNKNOWN
            nodeName: OPC_AGGLEVEL1_LTM
          - locationName: UNKNOWN
            nodeName: OPC_AGGLEVEL1_PY_LTM
        join:
          joinCondition: |-
            FROM {{ ref('OMNIA_CONNECT_OPC','OPC_ACCOUNT') }} OPC_ACCOUNT
              LEFT JOIN {{ ref('DIM','SECTOR') }} SECTOR
                ON OPC_ACCOUNT.SECTORKEY = SECTOR.SECTORKEY
              LEFT JOIN {{ ref('DIM','ACCOUNTGEOGRAPHY') }} ACCOUNTGEOGRAPHY
                ON OPC_ACCOUNT.ACCOUNTGEOGRAPHYKEY = ACCOUNTGEOGRAPHY.ACCOUNTGEOGRAPHYKEY
              LEFT JOIN {{ ref('DIM','SALESTERRITORY') }} SALESTERRITORY
                ON OPC_ACCOUNT.SALESTERRITORYKEY = SALESTERRITORY.SALESTERRITORYKEY
              LEFT JOIN {{ ref('DIM','EMPLOYEE') }} EMPLOYEE
                ON SALESTERRITORY.TERRITORYMANAGERUPN = EMPLOYEE.USERPRINCIPALNAME
              LEFT JOIN {{ ref('UNKNOWN','OPC_VWAGGLEVEL1FORCEIDUSAGESTATS_LIFETIME_CONTACTS') }} OPC_VWAGGLEVEL1FORCEIDUSAGESTATS_LIFETIME_CONTACTS
                ON OPC_ACCOUNT.LEVEL1FORCEID = OPC_VWAGGLEVEL1FORCEIDUSAGESTATS_LIFETIME_CONTACTS.FORCEID
              LEFT JOIN {{ ref('UNKNOWN','OPC_VWAGGLEVEL1FORCEIDUSAGESTATS_ALL') }} OPC_VWAGGLEVEL1FORCEIDUSAGESTATS_ALL
                ON OPC_ACCOUNT.LEVEL1FORCEID = OPC_VWAGGLEVEL1FORCEIDUSAGESTATS_ALL.LEVEL1FORCEID
              LEFT JOIN {{ ref('DIM','OMNIA_SCORE') }} OMNIA_SCORE
                ON OPC_ACCOUNT.ACCOUNTKEY = OMNIA_SCORE.ACCOUNTKEY
              LEFT JOIN {{ ref('UNKNOWN','OPC_AGGLEVEL1_LTM') }} OPC_AGGLEVEL1_LTM
                ON OPC_ACCOUNT.LEVEL1FORCEID = OPC_AGGLEVEL1_LTM.LEVEL1FORCEID
              LEFT JOIN {{ ref('UNKNOWN','OPC_AGGLEVEL1_PY_LTM') }} OPC_AGGLEVEL1_PY_LTM
                ON OPC_ACCOUNT.LEVEL1FORCEID = OPC_AGGLEVEL1_PY_LTM.LEVEL1FORCEID
              LEFT JOIN {{ ref('DIM','SUPPLIER') }} SUPPLIER
                ON OPC_VWAGGLEVEL1FORCEIDUSAGESTATS_ALL.SUPPLIERID = SUPPLIER.SUPPLIERID
             WHERE OPC_ACCOUNT.RECORDDESIGNATION = 'ACCOUNT'
                OR (OPC_ACCOUNT.RECORDDESIGNATION = 'PROSPECT' AND OPC_ACCOUNT.PARTICIPATING_PROGRAM = 'CLUB 25 AGENCY')
        name: SRC_OPC_LEVEL1CUSTOMERSEARCH_1_SUPPLIERID
        noLinkRefs: []
  name: OPC_LEVEL1CUSTOMERSEARCH
  overrideSQL: false
  schema: ""
  sqlType: Agreggate
  type: sql
  version: 1
type: Node
