fileVersion: 1
id: bba3f180-52a9-4f54-8004-c8413b49cda5
name: STAGE_REVENUEBUDGETSTERRITORYHISTORY
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "SEE NOTES"
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba22b0e7-f3a2-4452-96fc-e74d2bfe089f
          stepCounter: bba3f180-52a9-4f54-8004-c8413b49cda5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: TERRITORYHISTORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1cc5e32c-fa0f-40da-9617-a4a669404bac
                stepCounter: f0f6702a-18f9-4337-a799-77d02dc285ca
            transform: IFNULL(TERRITORYHISTORY.TERRITORYHISTORYKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1dbc3b86-fe27-4195-a6eb-b6bb55736e08
          stepCounter: bba3f180-52a9-4f54-8004-c8413b49cda5
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TERRITORYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea7b4c8c-147a-4c6f-a4f6-9648a25c3761
                stepCounter: 95d67c69-93c2-43ff-878a-401f5283cb57
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71632084-df12-48ca-bdb4-2969cd762b7e
          stepCounter: bba3f180-52a9-4f54-8004-c8413b49cda5
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYDIVISIONNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4716ecc2-d29b-4200-afb5-f7d3737c84f5
                stepCounter: f0f6702a-18f9-4337-a799-77d02dc285ca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66a4900a-48bf-4e04-82a5-26e7e4ba029f
          stepCounter: bba3f180-52a9-4f54-8004-c8413b49cda5
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYDIVISIONLEADERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: da32a63b-86b0-4330-9f0a-9a00bceb6630
                stepCounter: f0f6702a-18f9-4337-a799-77d02dc285ca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 283cea65-5424-4417-82ed-3ef028bb67df
          stepCounter: bba3f180-52a9-4f54-8004-c8413b49cda5
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYGROUPNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b826407d-dbfb-4288-9341-1d2ecf37b77a
                stepCounter: f0f6702a-18f9-4337-a799-77d02dc285ca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f6f17f1-1a39-4b7c-9d2e-e3ba3dcbfd41
          stepCounter: bba3f180-52a9-4f54-8004-c8413b49cda5
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYGROUPLEADERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ebbcfe5-83ce-4837-80e0-a1d101cea2cd
                stepCounter: f0f6702a-18f9-4337-a799-77d02dc285ca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53ef3a30-e565-4a66-a972-be952302ad23
          stepCounter: bba3f180-52a9-4f54-8004-c8413b49cda5
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60c57825-dedd-4ba7-8226-8ce9160e58d5
                stepCounter: f0f6702a-18f9-4337-a799-77d02dc285ca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 673403d0-542f-4418-aa24-644c5ef1c3f2
          stepCounter: bba3f180-52a9-4f54-8004-c8413b49cda5
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYFULLNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d427fdb-660e-4337-b5f4-9fb11831e87d
                stepCounter: f0f6702a-18f9-4337-a799-77d02dc285ca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0c7f68f-800e-4b07-8dcf-c1ee0f6f18d9
          stepCounter: bba3f180-52a9-4f54-8004-c8413b49cda5
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYMANAGER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fab1bc16-8eb1-4aae-9155-aa31d8501383
                stepCounter: f0f6702a-18f9-4337-a799-77d02dc285ca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b174fc4a-4f25-44f3-bb93-961d1597905b
          stepCounter: bba3f180-52a9-4f54-8004-c8413b49cda5
        config: {}
        dataType: INT
        defaultValue: ""
        description: STAGEREVENUEBUDGETSTERRITORYHISTORY.BUDGETDATE=DIMBUDGETDATE.BUDGETDATE
        name: BUDGETDATEKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c44e398-1413-4060-9f9e-0716da9c3ba0
                stepCounter: bbadb7c4-d0be-4b54-9433-eddd7cf4a5be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48fb7c67-97cc-4629-91d5-3888c5b139d0
          stepCounter: bba3f180-52a9-4f54-8004-c8413b49cda5
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: BUDGETDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c1a2e5de-71aa-417b-a9ae-dbfe2ab4d862
                stepCounter: 95d67c69-93c2-43ff-878a-401f5283cb57
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea5fa111-50c3-47f0-8732-b1b36d550c81
          stepCounter: bba3f180-52a9-4f54-8004-c8413b49cda5
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BUDGETSALESAMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d6d25373-63a7-4747-935b-0a59708d6b2d
                stepCounter: 95d67c69-93c2-43ff-878a-401f5283cb57
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 877823dc-99ed-45a2-9b2c-0002e439a90c
          stepCounter: bba3f180-52a9-4f54-8004-c8413b49cda5
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BUDGETREVENUEAMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00f9198b-3de6-48e5-934e-583113204eac
                stepCounter: 95d67c69-93c2-43ff-878a-401f5283cb57
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 048e0cc2-b76f-4a8a-a277-eeec36eb999b
          stepCounter: bba3f180-52a9-4f54-8004-c8413b49cda5
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76d9402e-f2a7-4712-bd98-4a7348e6b475
                stepCounter: 95d67c69-93c2-43ff-878a-401f5283cb57
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9b168fe-9b48-49e0-b64f-3eec3389dbc0
          stepCounter: bba3f180-52a9-4f54-8004-c8413b49cda5
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ca8d869-06ab-443f-ba71-42041054af00
                stepCounter: 95d67c69-93c2-43ff-878a-401f5283cb57
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cbec8877-7889-42a5-8bfb-053ed5be899d
          stepCounter: bba3f180-52a9-4f54-8004-c8413b49cda5
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a01c21c9-96c8-4faa-9f4a-01edff3090b0
          stepCounter: bba3f180-52a9-4f54-8004-c8413b49cda5
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          TERRITORYHISTORY: f0f6702a-18f9-4337-a799-77d02dc285ca
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: DIM_BUDGETDATE
          - locationName: DIM
            nodeName: TERRITORYHISTORY
          - locationName: LOAD
            nodeName: LOAD_REVENUEBUDGETSTERRITORY
          - locationName: UNKNOWN
            nodeName: LOADREVENUEBUDGETSTERRITORY
        join:
          joinCondition: |-
            FROM {{ ref('UNKNOWN','LOADREVENUEBUDGETSTERRITORY') }} LOADREVENUEBUDGETSTERRITORY
              LEFT JOIN {{ ref('DIM','TERRITORYHISTORY') }} TERRITORYHISTORY
                ON LOADREVENUEBUDGETSTERRITORY.TERRITORYID = TERRITORYHISTORY.TERRITORYID
               AND LOADREVENUEBUDGETSTERRITORY.BUDGETDATE BETWEEN TERRITORYHISTORY.TERRITORYMANAGERSTARTDATE AND TERRITORYHISTORY.TERRITORYMANAGERENDDATE
        name: STAGEREVENUEBUDGETSTERRITORYHISTORY
        noLinkRefs: []
  name: STAGE_REVENUEBUDGETSTERRITORYHISTORY
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
