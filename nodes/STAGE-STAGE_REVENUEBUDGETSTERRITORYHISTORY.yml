fileVersion: 1
id: 3e7d88f0-4d6e-4fd4-9107-f1426f9262bc
name: STAGE_REVENUEBUDGETSTERRITORYHISTORY
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "SEE NOTES"
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 966df4aa-d0cb-462a-a737-e422e595a13c
          stepCounter: 3e7d88f0-4d6e-4fd4-9107-f1426f9262bc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: TERRITORYHISTORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5259dfd4-68ca-440e-b4bb-759937b3585c
                stepCounter: d8361311-2235-48f0-bc26-7b9ea5d34df0
            transform: IFNULL(TERRITORYHISTORY.TERRITORYHISTORYKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 246a2ea2-fe77-4b26-ba6b-4f80e3e1489b
          stepCounter: 3e7d88f0-4d6e-4fd4-9107-f1426f9262bc
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TERRITORYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb91162c-49e5-4bac-9801-04fae45e8550
                stepCounter: 9341ab13-c077-43bb-b822-d25591a20cf5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c77b5a05-5cdb-49de-b231-be04a42c58ec
          stepCounter: 3e7d88f0-4d6e-4fd4-9107-f1426f9262bc
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYDIVISIONNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: df0997ee-6009-455f-aefb-aee20b47bbf4
                stepCounter: d8361311-2235-48f0-bc26-7b9ea5d34df0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 12d00b0a-b898-48f6-be3a-d66cd8915c6b
          stepCounter: 3e7d88f0-4d6e-4fd4-9107-f1426f9262bc
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYDIVISIONLEADERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d59ed6c-7f69-4e1c-b86a-49d91cb197f8
                stepCounter: d8361311-2235-48f0-bc26-7b9ea5d34df0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a571c47-2911-4133-af27-3d8d75e57569
          stepCounter: 3e7d88f0-4d6e-4fd4-9107-f1426f9262bc
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYGROUPNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1a0c0dcd-275d-4194-86bf-a865b762ce88
                stepCounter: d8361311-2235-48f0-bc26-7b9ea5d34df0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c013853-c15e-4ca4-9f8b-dfde0959d54c
          stepCounter: 3e7d88f0-4d6e-4fd4-9107-f1426f9262bc
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYGROUPLEADERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52423972-47d3-42a1-a89c-8028f5570af0
                stepCounter: d8361311-2235-48f0-bc26-7b9ea5d34df0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f655545e-2f60-44d2-9b9c-bb6d8ad60316
          stepCounter: 3e7d88f0-4d6e-4fd4-9107-f1426f9262bc
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b12d5908-1aa3-4924-b0f3-d6d7e301195e
                stepCounter: d8361311-2235-48f0-bc26-7b9ea5d34df0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b240d29d-0058-4ba8-aef6-a397a7567cac
          stepCounter: 3e7d88f0-4d6e-4fd4-9107-f1426f9262bc
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYFULLNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: afa29983-fd3c-4ce5-9a08-6593a4932871
                stepCounter: d8361311-2235-48f0-bc26-7b9ea5d34df0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 183ad10a-5b31-49d7-8948-c2d975ca0444
          stepCounter: 3e7d88f0-4d6e-4fd4-9107-f1426f9262bc
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYMANAGER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91477dd5-ffd8-4df5-9975-f9576231af1d
                stepCounter: d8361311-2235-48f0-bc26-7b9ea5d34df0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 51c4f9aa-c0ef-46ce-b25b-ac171c0669b0
          stepCounter: 3e7d88f0-4d6e-4fd4-9107-f1426f9262bc
        config: {}
        dataType: INT
        defaultValue: ""
        description: STAGEREVENUEBUDGETSTERRITORYHISTORY.BUDGETDATE=DIMBUDGETDATE.BUDGETDATE
        name: BUDGETDATEKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a917df9-58e8-4356-9420-64035f12ade4
                stepCounter: 8a34b157-a453-4238-a82a-c2e8e5b4131c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9d54177-b0a0-4525-ac01-231b5af38993
          stepCounter: 3e7d88f0-4d6e-4fd4-9107-f1426f9262bc
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: BUDGETDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef90183e-e52a-4589-b6c9-a4eb76d8eb0b
                stepCounter: 9341ab13-c077-43bb-b822-d25591a20cf5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c7a5926-5f64-43f2-ab96-716f32c6dce1
          stepCounter: 3e7d88f0-4d6e-4fd4-9107-f1426f9262bc
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BUDGETSALESAMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79927800-b2e5-4488-9f46-8d3ffb1f5355
                stepCounter: 9341ab13-c077-43bb-b822-d25591a20cf5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dfa371a7-86f8-4687-9cf0-b5ed5fb66b0e
          stepCounter: 3e7d88f0-4d6e-4fd4-9107-f1426f9262bc
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BUDGETREVENUEAMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2e6f1d06-4a57-478b-86a4-f44ba0490145
                stepCounter: 9341ab13-c077-43bb-b822-d25591a20cf5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dca33482-ca74-4d75-8fe2-869e7b527d7f
          stepCounter: 3e7d88f0-4d6e-4fd4-9107-f1426f9262bc
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 54068bec-095c-4fef-ba6c-4ce47cae254c
                stepCounter: 9341ab13-c077-43bb-b822-d25591a20cf5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0966b7e5-8303-48d3-be0e-13bde7950112
          stepCounter: 3e7d88f0-4d6e-4fd4-9107-f1426f9262bc
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 940058a4-e371-4364-a289-2b6cc8ff470d
                stepCounter: 9341ab13-c077-43bb-b822-d25591a20cf5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 329bc3b3-8c23-4cd6-8bca-40e628afdf47
          stepCounter: 3e7d88f0-4d6e-4fd4-9107-f1426f9262bc
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db2590f2-ee19-4bef-be10-561146621751
          stepCounter: 3e7d88f0-4d6e-4fd4-9107-f1426f9262bc
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOAD_REVENUEBUDGETSTERRITORY: 9341ab13-c077-43bb-b822-d25591a20cf5
          TERRITORYHISTORY: d8361311-2235-48f0-bc26-7b9ea5d34df0
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: DIM_BUDGETDATE
          - locationName: DIM
            nodeName: TERRITORYHISTORY
          - locationName: LOAD
            nodeName: LOAD_REVENUEBUDGETSTERRITORY
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOAD_REVENUEBUDGETSTERRITORY') }} LOAD_REVENUEBUDGETSTERRITORY
              LEFT JOIN {{ ref('DIM','TERRITORYHISTORY') }} TERRITORYHISTORY
                ON LOAD_REVENUEBUDGETSTERRITORY.TERRITORYID = TERRITORYHISTORY.TERRITORYID
               AND LOAD_REVENUEBUDGETSTERRITORY.BUDGETDATE BETWEEN TERRITORYHISTORY.TERRITORYMANAGERSTARTDATE AND TERRITORYHISTORY.TERRITORYMANAGERENDDATE
        name: STAGEREVENUEBUDGETSTERRITORYHISTORY
        noLinkRefs: []
  name: STAGE_REVENUEBUDGETSTERRITORYHISTORY
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
