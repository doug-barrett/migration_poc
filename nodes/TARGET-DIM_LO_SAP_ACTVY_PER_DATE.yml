fileVersion: 1
id: f8e715c1-87e2-4cc6-a839-d0b610927a6b
name: DIM_LO_SAP_ACTVY_PER_DATE
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e612152e-f3ce-4b43-924c-ba5523fc7f3f
          stepCounter: f8e715c1-87e2-4cc6-a839-d0b610927a6b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated key for the date dimension. Nominal format is YYYYMMDD, but DD equal to 0 and greater than 31 permited for special date handling.
        name: DIM_ACTVY_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f10c496e-43e4-4922-b52a-6ad1c4ad8e74
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94ccb4b1-376e-4199-ae79-56d8dd4f9d8d
          stepCounter: f8e715c1-87e2-4cc6-a839-d0b610927a6b
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: The calendar date for this row.
        name: DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22fc0aa6-a875-4164-ab11-fd35b6a269ec
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97598549-e1a2-4e43-bf68-fbe357d0ba3a
          stepCounter: f8e715c1-87e2-4cc6-a839-d0b610927a6b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The calendar month number 1-12.
        name: MONTH_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 101a7a76-b6e1-4e7a-99ec-cbfefd368862
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: TO_NUMBER(TO_CHAR(DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE),'MM'),'99')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69a331c7-78a9-48ed-920d-01e3d0780ae5
          stepCounter: f8e715c1-87e2-4cc6-a839-d0b610927a6b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: 'The calendar month representation. Format YYYYMM. Example: 200206.'
        name: MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c44bfcf3-11ec-463f-9a7c-b6c87dbfa903
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: TO_NUMBER(TO_CHAR(DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE),'YYYYMM'),'999999')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a7b8688-daa6-45b9-9ccf-6531d7f8742e
          stepCounter: f8e715c1-87e2-4cc6-a839-d0b610927a6b
        config: {}
        dataType: VARCHAR(7)
        defaultValue: ""
        description: 'The calendar month name. Format MON. Examples: jan, feb, mar.'
        name: MONTH_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 37be88a7-ff8a-46d7-b4bc-d309ffeef97a
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: TO_CHAR(DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE),'Mon')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2c9277f-a9c2-400d-b84f-29714ed45b1d
          stepCounter: f8e715c1-87e2-4cc6-a839-d0b610927a6b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The calendar quarter number 1-4.
        name: QUARTER_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75b5251d-c8ee-4b60-ab66-5042d173479c
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: TO_NUMBER(TO_CHAR(DATE_PART('Q',DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE))),'9')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb0798e7-b614-475e-bddc-e07903c45def
          stepCounter: f8e715c1-87e2-4cc6-a839-d0b610927a6b
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: QUARTER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75b5251d-c8ee-4b60-ab66-5042d173479c
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: TO_NUMBER(TO_CHAR(DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE),'YYYY'),'9999') || ' Q' || TO_NUMBER(TO_CHAR(DATE_PART('Q',DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE))),'9')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b40ece0-2732-46c6-bc26-6fb9aad5c70b
          stepCounter: f8e715c1-87e2-4cc6-a839-d0b610927a6b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The calendar quarter representation. Format YYYYQQ. Example 200204.
        name: QUARTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b83e744a-bea9-41ee-a1a1-c0c855a6b4a3
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: TO_NUMBER(TO_CHAR(DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE), 'YYYY') || '0' || TO_CHAR(DATE_PART('Q',DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE))), '999999')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e7895fc-aae6-4bdc-ad2d-d890665865f2
          stepCounter: f8e715c1-87e2-4cc6-a839-d0b610927a6b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The calendar year. Format YYYY
        name: YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7dc8b9d7-b462-4cf5-8544-d9b98f76c383
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: TO_NUMBER(TO_CHAR(DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE),'YYYY'),'9999')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d187c418-46ea-4a60-91bf-d8a92f9ee3c3
          stepCounter: f8e715c1-87e2-4cc6-a839-d0b610927a6b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: YEAR_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7dc8b9d7-b462-4cf5-8544-d9b98f76c383
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: "'ACTIVITY ' || TO_NUMBER(TO_CHAR(DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE),'YYYY'),'9999')"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 19658ff3-37f3-4fb9-852a-a26ef2b48d36
          stepCounter: f8e715c1-87e2-4cc6-a839-d0b610927a6b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: YEAR_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7dc8b9d7-b462-4cf5-8544-d9b98f76c383
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: TO_NUMBER(TO_CHAR(DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE),'YYYY'),'9999') || ' - ' || TO_CHAR(DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE),'Mon')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ce4a87c-8626-4dc9-9906-14f4a3b8c039
          stepCounter: f8e715c1-87e2-4cc6-a839-d0b610927a6b
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate the current month. Set as per current_cal_day.
        name: CURRENT_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c8abb136-d9ea-44b6-bd0c-b3beb4271a0b
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: DECODE(DIM_DATE.DIM_DATE_KEY,0,'No',DIM_DATE.CURRENT_CAL_MONTH)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f7744f1-5cdb-462b-b18b-7d8011ba6cd5
          stepCounter: f8e715c1-87e2-4cc6-a839-d0b610927a6b
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate the current year. Set as per current_cal_day.
        name: CURRENT_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f99f829f-5044-4d00-af54-6675d1b1abd1
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: DECODE(DIM_DATE.DIM_DATE_KEY,0,'No',DIM_DATE.CURRENT_CAL_YEAR)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ec61e00-12e4-45e8-84f0-df6e741b35f2
          stepCounter: f8e715c1-87e2-4cc6-a839-d0b610927a6b
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate days in the current month to date. Set as per current_cal_day.
        name: CURRENT_MTD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3f4acc77-5529-4206-a1c2-9541dc57724b
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: DECODE(DIM_DATE.DIM_DATE_KEY,0,'No',DIM_DATE.CURRENT_CAL_MTD)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2156d31f-4f57-4898-9b2b-3efca346effa
          stepCounter: f8e715c1-87e2-4cc6-a839-d0b610927a6b
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate days in the current year to date. Set as per current_cal_day.
        name: CURRENT_YTD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b233f7d-fbf8-4645-babf-d20f3ab279f4
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: DECODE(DIM_DATE.DIM_DATE_KEY,0,'No',DIM_DATE.CURRENT_CAL_YTD)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6bbf543-7e3d-4850-ab99-7b5f2b896c5a
          stepCounter: f8e715c1-87e2-4cc6-a839-d0b610927a6b
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate days that constitute a full year counting back from the current day. Set as per current_cal_day.
        name: MOVING_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5871881f-8bd7-445d-9872-ad07ae4c46e4
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: DECODE(DIM_DATE.DIM_DATE_KEY,0,'No',DIM_DATE.MOVING_CAL_YEAR)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f71c1d5-8613-46e6-9528-69f9ba476158
          stepCounter: f8e715c1-87e2-4cc6-a839-d0b610927a6b
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date/time that this record was inserted in the data warehouse
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0fea260d-2077-4417-b8d7-31fd14652b30
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8acb369e-9ffc-42df-bd21-98b4c02615e1
          stepCounter: f8e715c1-87e2-4cc6-a839-d0b610927a6b
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date/time that this record was updated in the data warehouse
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee1a52d9-502e-4f9a-853f-104f1152f9a8
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DIM_DATE: 514e5b21-eab9-4985-9a00-e22a0e84a361
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: DIM_DATE
        join:
          joinCondition: FROM {{ ref('TARGET','DIM_DATE') }}
        name: DIM_LO_SAP_ACTVY_PER_DATE
        noLinkRefs: []
  name: DIM_LO_SAP_ACTVY_PER_DATE
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
