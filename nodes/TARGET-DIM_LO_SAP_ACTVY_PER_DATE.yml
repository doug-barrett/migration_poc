fileVersion: 1
id: 2dd43a82-d1cd-4faa-9896-f735a52c38e7
name: DIM_LO_SAP_ACTVY_PER_DATE
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5e7d210-78fe-4ce0-90cc-1b081cdc0b0b
          stepCounter: 2dd43a82-d1cd-4faa-9896-f735a52c38e7
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated key for the date dimension. Nominal format is YYYYMMDD, but DD equal to 0 and greater than 31 permited for special date handling.
        name: DIM_ACTVY_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d67dd194-392b-41c2-a867-1d286b03a749
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f6b66f2-3123-427b-b8f2-02216e1ca051
          stepCounter: 2dd43a82-d1cd-4faa-9896-f735a52c38e7
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: The calendar date for this row.
        name: DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9cafcfb4-e64b-48a7-a8b7-ac2946945d8c
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f521cca-ece9-489b-9fb8-f582ad0246ff
          stepCounter: 2dd43a82-d1cd-4faa-9896-f735a52c38e7
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The calendar month number 1-12.
        name: MONTH_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c65aa60-d958-46ff-a0ff-7fd9866c63be
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: TO_NUMBER(TO_CHAR(DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE),'MM'),'99')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab0c8e32-0b19-466a-903c-5d52901046bf
          stepCounter: 2dd43a82-d1cd-4faa-9896-f735a52c38e7
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: 'The calendar month representation. Format YYYYMM. Example: 200206.'
        name: MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 705122d1-4e8b-4357-8445-cf24443c78b6
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: TO_NUMBER(TO_CHAR(DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE),'YYYYMM'),'999999')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3b63e1e-b56e-4857-b3d7-79f894936d49
          stepCounter: 2dd43a82-d1cd-4faa-9896-f735a52c38e7
        config: {}
        dataType: VARCHAR(7)
        defaultValue: ""
        description: 'The calendar month name. Format MON. Examples: jan, feb, mar.'
        name: MONTH_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ebed47fc-a249-4cfc-839b-753f0dd2390c
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: TO_CHAR(DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE),'Mon')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07ebfd3b-375c-4cbe-bec9-cacc57bbde82
          stepCounter: 2dd43a82-d1cd-4faa-9896-f735a52c38e7
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The calendar quarter number 1-4.
        name: QUARTER_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ed2507c-0acd-42e0-88dc-c56344ac7d6d
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: TO_NUMBER(TO_CHAR(DATE_PART('Q',DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE))),'9')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db2c6773-7139-435f-a423-2d97c28f617f
          stepCounter: 2dd43a82-d1cd-4faa-9896-f735a52c38e7
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: QUARTER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ed2507c-0acd-42e0-88dc-c56344ac7d6d
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: TO_NUMBER(TO_CHAR(DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE),'YYYY'),'9999') || ' Q' || TO_NUMBER(TO_CHAR(DATE_PART('Q',DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE))),'9')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17572866-2a1d-4df3-9d9b-48e2c76e6a8d
          stepCounter: 2dd43a82-d1cd-4faa-9896-f735a52c38e7
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The calendar quarter representation. Format YYYYQQ. Example 200204.
        name: QUARTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51d9af37-47d2-4723-a6c5-f3cafaf883c0
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: TO_NUMBER(TO_CHAR(DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE), 'YYYY') || '0' || TO_CHAR(DATE_PART('Q',DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE))), '999999')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39a6d28b-447c-4e19-a29a-d921a157f0bc
          stepCounter: 2dd43a82-d1cd-4faa-9896-f735a52c38e7
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The calendar year. Format YYYY
        name: YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52559a82-8e7c-4739-8223-a5afc69ed5a3
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: TO_NUMBER(TO_CHAR(DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE),'YYYY'),'9999')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc5f04a8-ef52-497a-add7-ceaa48591e15
          stepCounter: 2dd43a82-d1cd-4faa-9896-f735a52c38e7
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: YEAR_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52559a82-8e7c-4739-8223-a5afc69ed5a3
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: "'ACTIVITY ' || TO_NUMBER(TO_CHAR(DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE),'YYYY'),'9999')"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d0de29f-4b12-4b1d-b2e4-b9a8595eebbe
          stepCounter: 2dd43a82-d1cd-4faa-9896-f735a52c38e7
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: YEAR_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52559a82-8e7c-4739-8223-a5afc69ed5a3
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: TO_NUMBER(TO_CHAR(DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE),'YYYY'),'9999') || ' - ' || TO_CHAR(DECODE(DIM_DATE.DIM_DATE_KEY,0,TO_DATE('{{ parameters.SAP_UNKNOWN_DATE_VALUE }}','YYYYMMDD'),DIM_DATE.CALENDAR_DATE),'Mon')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9040d64-3003-4dcb-8f7d-8af283f549d1
          stepCounter: 2dd43a82-d1cd-4faa-9896-f735a52c38e7
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate the current month. Set as per current_cal_day.
        name: CURRENT_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7a81ac4-125b-4a7c-a258-81162fe2e311
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: DECODE(DIM_DATE.DIM_DATE_KEY,0,'No',DIM_DATE.CURRENT_CAL_MONTH)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41fa1583-aed2-403b-8787-b59c9ec39220
          stepCounter: 2dd43a82-d1cd-4faa-9896-f735a52c38e7
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate the current year. Set as per current_cal_day.
        name: CURRENT_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d98f4b5-c5df-443a-a8e6-2cada8b59e1d
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: DECODE(DIM_DATE.DIM_DATE_KEY,0,'No',DIM_DATE.CURRENT_CAL_YEAR)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b3907fc6-bfa4-4f93-b61d-17d40ec4a2b6
          stepCounter: 2dd43a82-d1cd-4faa-9896-f735a52c38e7
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate days in the current month to date. Set as per current_cal_day.
        name: CURRENT_MTD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa668c22-1a25-40a1-b22d-ab5e6ed4fa65
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: DECODE(DIM_DATE.DIM_DATE_KEY,0,'No',DIM_DATE.CURRENT_CAL_MTD)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d23ebff-b66f-49d1-92e2-e49448adf0a2
          stepCounter: 2dd43a82-d1cd-4faa-9896-f735a52c38e7
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate days in the current year to date. Set as per current_cal_day.
        name: CURRENT_YTD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a7ff769-cb53-4c9c-beb6-f23a5309087a
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: DECODE(DIM_DATE.DIM_DATE_KEY,0,'No',DIM_DATE.CURRENT_CAL_YTD)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb56cae8-32fa-4d04-9d6c-0a0063dc4d2b
          stepCounter: 2dd43a82-d1cd-4faa-9896-f735a52c38e7
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: Flag to indicate days that constitute a full year counting back from the current day. Set as per current_cal_day.
        name: MOVING_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 88fcac99-72c8-450a-8b6b-89f8b982f741
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: DECODE(DIM_DATE.DIM_DATE_KEY,0,'No',DIM_DATE.MOVING_CAL_YEAR)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31db72b9-69d9-4d55-8533-c71880a03aa7
          stepCounter: 2dd43a82-d1cd-4faa-9896-f735a52c38e7
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date/time that this record was inserted in the data warehouse
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c04cbc11-68f6-4f7e-8836-e29eac1879f2
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7041f91-a31b-4871-829c-7b6b07f0b707
          stepCounter: 2dd43a82-d1cd-4faa-9896-f735a52c38e7
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date/time that this record was updated in the data warehouse
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 989dc3b8-ad89-43bb-85a2-83ea36a1a9de
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DIM_DATE: e36e3241-fb91-480b-b6e9-be9a8d12930f
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: DIM_DATE
        join:
          joinCondition: FROM {{ ref('TARGET','DIM_DATE') }}
        name: DIM_LO_SAP_ACTVY_PER_DATE
        noLinkRefs: []
  name: DIM_LO_SAP_ACTVY_PER_DATE
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
