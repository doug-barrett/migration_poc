fileVersion: 1
id: 27426e95-7fb8-4538-90fa-457a665cd2d9
name: S_HES_FORM_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f8cd3ff-4826-4c59-8a9e-0d24337dc29a
          stepCounter: 27426e95-7fb8-4538-90fa-457a665cd2d9
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: patient_reference_no
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 702dfc9d-df5e-42d8-86f8-9e68f29c462c
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3dafaff0-14cd-4357-8c00-a8a4317002d7
          stepCounter: 27426e95-7fb8-4538-90fa-457a665cd2d9
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: HEALTH_ORG_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4972b9c-6a37-47f8-85ca-a980f6fd81a8
                stepCounter: ce5e5ba3-482d-46a9-a8ae-9f160067f51d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 36b0a955-24bf-4e2f-8e9a-7d5ff99b4be2
          stepCounter: 27426e95-7fb8-4538-90fa-457a665cd2d9
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SAVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: MAX(CASE WHEN ds_cvdis_HES_activity.status IN(0) THEN ds_cvdis_HES_activity.sdate ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 908c312c-359e-49ec-a03b-103492d20a5d
          stepCounter: 27426e95-7fb8-4538-90fa-457a665cd2d9
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NEW_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: MAX(CASE WHEN ds_cvdis_HES_activity.status IN(1) THEN ds_cvdis_HES_activity.sdate ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: efe5c432-2fc0-411b-8ac7-c0b0ad2ed8f9
          stepCounter: 27426e95-7fb8-4538-90fa-457a665cd2d9
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SENDER_EMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 85b8b504-9b22-445c-8b09-527e2bbda0d7
                stepCounter: ccdf1f63-49a3-40e0-85f0-985255ee2146
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4826758-2e12-4bc9-9e69-fa485386b14c
          stepCounter: 27426e95-7fb8-4538-90fa-457a665cd2d9
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ACCEPTED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: MAX(CASE WHEN ds_cvdis_HES_activity.status IN(2) THEN ds_cvdis_HES_activity.sdate ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae139daf-b7cd-49cd-9bb2-63464e610511
          stepCounter: 27426e95-7fb8-4538-90fa-457a665cd2d9
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1101be0-a7fd-4b7a-9817-c7491d42fb9f
                stepCounter: ccdf1f63-49a3-40e0-85f0-985255ee2146
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98dd8528-6116-4f3c-9d4a-f53e041c1569
          stepCounter: 27426e95-7fb8-4538-90fa-457a665cd2d9
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: TEMPLATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6b7658ef-4a3b-464b-9a2b-00fd9a58c5a0
                stepCounter: ccdf1f63-49a3-40e0-85f0-985255ee2146
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1fa3a12-0605-4a58-a1dc-bb55311b7537
          stepCounter: 27426e95-7fb8-4538-90fa-457a665cd2d9
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DECLINED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: MAX(CASE WHEN ds_cvdis_HES_activity.status IN(3) THEN ds_cvdis_HES_activity.sdate ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe374cc9-90f2-4f6e-a221-97211850156e
          stepCounter: 27426e95-7fb8-4538-90fa-457a665cd2d9
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITLISTED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: MAX(CASE WHEN ds_cvdis_HES_activity.status IN(6) THEN ds_cvdis_HES_activity.sdate ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a4c324be-710e-4fa4-a8a6-ec63d754df16
          stepCounter: 27426e95-7fb8-4538-90fa-457a665cd2d9
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PATIENT_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7265ee2a-2b7e-4fe6-9c3e-710443c983a9
                stepCounter: ccdf1f63-49a3-40e0-85f0-985255ee2146
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9a1ffdd-0a0f-4100-9ef9-4a756cfbf571
          stepCounter: 27426e95-7fb8-4538-90fa-457a665cd2d9
        config: {}
        dataType: VARCHAR(8000)
        defaultValue: ""
        description: ""
        name: ADDRESS_LABEL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83250e7e-edd4-4250-b7e2-9c887cf0c555
                stepCounter: ccdf1f63-49a3-40e0-85f0-985255ee2146
            transform: convert(varchar,addresslabel)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96c3efe6-f656-405c-ba67-c9f94d64fb8f
          stepCounter: 27426e95-7fb8-4538-90fa-457a665cd2d9
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CANCELLED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: MAX(CASE WHEN ds_cvdis_HES_activity.status IN(8) THEN ds_cvdis_HES_activity.sdate ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f8d1315e-409a-45aa-832f-4d1f9b90cd16
          stepCounter: 27426e95-7fb8-4538-90fa-457a665cd2d9
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: COMPLETE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: MAX(CASE WHEN ds_cvdis_HES_activity.status IN(9) THEN ds_cvdis_HES_activity.sdate ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6897986b-f999-455b-bf80-21b7978afda9
          stepCounter: 27426e95-7fb8-4538-90fa-457a665cd2d9
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: OUTCOME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 31ff5cda-c032-42e1-ac41-fbf4225deb3a
                stepCounter: ccdf1f63-49a3-40e0-85f0-985255ee2146
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d1dc3937-5fbb-490a-8fea-84bd061a80d1
          stepCounter: 27426e95-7fb8-4538-90fa-457a665cd2d9
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: REFERRAL_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18a1eb97-d193-4daa-b3e6-6d6eb895f807
                stepCounter: ccdf1f63-49a3-40e0-85f0-985255ee2146
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b522f0f6-0299-4bd2-a25f-cf65bd667680
          stepCounter: 27426e95-7fb8-4538-90fa-457a665cd2d9
        config: {}
        dataType: VARCHAR(8000)
        defaultValue: ""
        description: ""
        name: REASON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 593d110e-ecbd-4305-a5cd-355e9ed9c5b8
                stepCounter: ccdf1f63-49a3-40e0-85f0-985255ee2146
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f5dc06c-b817-4c7c-9450-aa4637dfbdc0
          stepCounter: 27426e95-7fb8-4538-90fa-457a665cd2d9
        config: {}
        dataType: VARCHAR(8000)
        defaultValue: ""
        description: ""
        name: LAST_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2cfc7bd-d930-471b-9f3e-fa2347d8ed1f
                stepCounter: ccdf1f63-49a3-40e0-85f0-985255ee2146
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0adfc333-c2bf-4ad0-95b3-a99fca8b310a
          stepCounter: 27426e95-7fb8-4538-90fa-457a665cd2d9
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: BOOKING_SENT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cae80057-bf01-403c-802e-1e9cf9fbc2fb
                stepCounter: ccdf1f63-49a3-40e0-85f0-985255ee2146
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b80beef-952f-4b31-a0a3-ef289ed6d181
          stepCounter: 27426e95-7fb8-4538-90fa-457a665cd2d9
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 71d44a1e-82fd-4c24-8511-f2a165ce89de
                stepCounter: ccdf1f63-49a3-40e0-85f0-985255ee2146
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4adedd44-00bc-4fcd-9575-2019b65f4f6b
          stepCounter: 27426e95-7fb8-4538-90fa-457a665cd2d9
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: abfd7480-7271-4d02-9392-e6f92e36b7bc
                stepCounter: ccdf1f63-49a3-40e0-85f0-985255ee2146
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 56c94ba0-bb0e-4958-8878-d31da6838a8d
          stepCounter: 27426e95-7fb8-4538-90fa-457a665cd2d9
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: RECEIVE_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b64007b-7acf-4ee5-8615-e1c86cc71464
                stepCounter: ccdf1f63-49a3-40e0-85f0-985255ee2146
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba4b1aef-dfe0-4735-8c34-fde2c4d6249d
          stepCounter: 27426e95-7fb8-4538-90fa-457a665cd2d9
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ACTIVE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5b119618-8ca5-4b5b-b419-3722ac4909a8
                stepCounter: ccdf1f63-49a3-40e0-85f0-985255ee2146
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 283b3c26-c154-4924-9edf-fe0225b07922
          stepCounter: 27426e95-7fb8-4538-90fa-457a665cd2d9
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CVDIS_UPDATED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5fd61feb-2846-4737-ba49-770985cc1d2c
                stepCounter: ccdf1f63-49a3-40e0-85f0-985255ee2146
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d426098d-8834-442a-ac3a-51eaf7ade1f9
          stepCounter: 27426e95-7fb8-4538-90fa-457a665cd2d9
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PRIORITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 176d9d0f-9a73-4074-a232-de20ee604e0c
                stepCounter: ccdf1f63-49a3-40e0-85f0-985255ee2146
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8752b4af-e444-4ef0-8cfd-0f38abde7899
          stepCounter: 27426e95-7fb8-4538-90fa-457a665cd2d9
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d469372-8987-4a58-adfb-9220c4da84e0
                stepCounter: ccdf1f63-49a3-40e0-85f0-985255ee2146
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 354b1009-d9e4-4eac-aaaa-83912cde0f5b
          stepCounter: 27426e95-7fb8-4538-90fa-457a665cd2d9
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: USER_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f7ddd52-4285-4f50-bdca-334347e5815e
                stepCounter: ccdf1f63-49a3-40e0-85f0-985255ee2146
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9300247-8f03-4f98-8fd0-356c024a7374
          stepCounter: 27426e95-7fb8-4538-90fa-457a665cd2d9
        config: {}
        dataType: INT
        defaultValue: ""
        description: 'common reference between cardiology system and Specialist referrals '
        name: CDA_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0192606c-5e1f-49dd-bf38-f71cdd0dbbcd
                stepCounter: ccdf1f63-49a3-40e0-85f0-985255ee2146
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c7d34b5-314f-4bf8-8084-fbd0333465e7
          stepCounter: 27426e95-7fb8-4538-90fa-457a665cd2d9
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: USER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b7ae372-cece-4930-8e08-ec46a75689e2
                stepCounter: ccdf1f63-49a3-40e0-85f0-985255ee2146
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7550c8b-3a0d-4526-a237-a89f525d21a2
          stepCounter: 27426e95-7fb8-4538-90fa-457a665cd2d9
        config: {}
        dataType: VARCHAR(8000)
        defaultValue: ""
        description: ""
        name: ALERTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 041bd311-8b44-412a-9904-2b725049623f
                stepCounter: ccdf1f63-49a3-40e0-85f0-985255ee2146
            transform: convert(varchar,alerts)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8340abae-75c6-450a-a6da-9738c9bbdaf0
          stepCounter: 27426e95-7fb8-4538-90fa-457a665cd2d9
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: HES_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5d420f2-7c7f-479b-8993-08ba47681369
                stepCounter: ccdf1f63-49a3-40e0-85f0-985255ee2146
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 485d8d35-3d38-40c2-ae74-dc30532dee8b
          stepCounter: 27426e95-7fb8-4538-90fa-457a665cd2d9
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: REFERRAL_HOSPITAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c153a96-6c98-4539-a11a-b45f0b0047e7
                stepCounter: ccdf1f63-49a3-40e0-85f0-985255ee2146
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e361cc38-4a10-40f0-9ccb-5e8cec9a54ec
          stepCounter: 27426e95-7fb8-4538-90fa-457a665cd2d9
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: REFERRED_FROM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7aa5b854-67b4-4336-8d54-1be147a729cc
                stepCounter: ccdf1f63-49a3-40e0-85f0-985255ee2146
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ffb59fba-41cb-4a27-83ab-8376bc46c16f
          stepCounter: 27426e95-7fb8-4538-90fa-457a665cd2d9
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: REFERRAL_WARD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe881413-081a-48ef-aaa8-2701046c6a3d
                stepCounter: ccdf1f63-49a3-40e0-85f0-985255ee2146
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 720ad17d-f1f8-4478-95d8-ffc62be9b991
          stepCounter: 27426e95-7fb8-4538-90fa-457a665cd2d9
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: COMPLETED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 059c47a1-5a3f-4336-a2e0-a8267da72e82
                stepCounter: ccdf1f63-49a3-40e0-85f0-985255ee2146
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 380af596-b6ed-45f5-899d-effb8cbb2a5f
          stepCounter: 27426e95-7fb8-4538-90fa-457a665cd2d9
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: 'Cardio Informatio management System  '
        name: CIMS_SERVICE_ORDER_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e882839-db59-445b-ba9a-f7a0fce2b646
                stepCounter: ccdf1f63-49a3-40e0-85f0-985255ee2146
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03a9091e-7742-45ad-84a2-d520d84934ed
          stepCounter: 27426e95-7fb8-4538-90fa-457a665cd2d9
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: REFERRAL_TO_SERVICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c9edb3bb-5ef5-4a1c-b959-9b852e7e575b
                stepCounter: ccdf1f63-49a3-40e0-85f0-985255ee2146
            transform: convert(varchar,Reftoservice)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d6896bd-7936-40ac-b744-feb5d50dee92
          stepCounter: 27426e95-7fb8-4538-90fa-457a665cd2d9
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: REFERRED_TO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 65042f32-0115-40d3-a7bd-733102ec31ea
                stepCounter: ccdf1f63-49a3-40e0-85f0-985255ee2146
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97397eb6-ad7c-4b5d-8705-b123e231534e
          stepCounter: 27426e95-7fb8-4538-90fa-457a665cd2d9
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: RESPONSIBLE_CLINICIAN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9ab44a17-17ad-48e3-b50b-07a557ae332e
                stepCounter: ccdf1f63-49a3-40e0-85f0-985255ee2146
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 37cbb646-834a-4c93-8e45-c18461518379
          stepCounter: 27426e95-7fb8-4538-90fa-457a665cd2d9
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PROCEDURE_OUTCOME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 81e88294-243e-4a99-b47c-0af6912bc44a
                stepCounter: ccdf1f63-49a3-40e0-85f0-985255ee2146
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 374ce3de-994d-4d00-8656-a78e7cf26187
          stepCounter: 27426e95-7fb8-4538-90fa-457a665cd2d9
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PROCEDURE_COMPLETED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: afd8c6ea-1c76-462f-8642-71d3ec00acb2
                stepCounter: ccdf1f63-49a3-40e0-85f0-985255ee2146
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a05f160-899d-4a67-be6e-fc57cce47d43
          stepCounter: 27426e95-7fb8-4538-90fa-457a665cd2d9
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DS_CVDIS_HES: ccdf1f63-49a3-40e0-85f0-985255ee2146
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DIM_PATIENT
          - locationName: TGT
            nodeName: DS_CVDIS_HES
        join:
          joinCondition: |-
            FROM {{ ref('TGT','DS_CVDIS_HES') }} ds_cvdis_HES
              LEFT JOIN ds_cvdis_HES_activity
                ON ds_cvdis_HES_activity.HESID= ds_cvdis_HES.HESID
              LEFT JOIN dim.dim_patient
                ON ds_cvdis_HES.NHI= dim_patient.patient_nhi
               AND nhi_sequence=1
              LEFT OUTER JOIN dim.[dim_hospital]
                ON ds_cvdis_HES.refhospital = dim_hospital.hospital_desc
               AND dim_hospital.dss_current_flag = @v_dss_current_flag
              LEFT JOIN l_reference_testpatients
                ON ds_cvdis_HES.NHI=l_reference_testpatients.NMPI
             WHERE l_reference_testpatients.NMPI IS NULL
               AND ds_cvdis_HES.NHI like '[A-Z][A-Z][A-Z][0-9][0-9][0-9][0-9]'
             GROUP BY dim_patient.patient_reference_no,
                      dim_hospital.health_org_reference_no,
                      ds_cvdis_HES.senderEmail,
                      ds_cvdis_HES.NHI,
                      ds_cvdis_HES.template,
                      ds_cvdis_HES.patstatus,
                      convert(varchar,addresslabel),
                      ds_cvdis_HES.outcome,
                      ds_cvdis_HES.ReferralStatus,
                      ds_cvdis_HES.reason,
                      ds_cvdis_HES.lastComment,
                      ds_cvdis_HES.sdate,
                      ds_cvdis_HES.encounterId,
                      ds_cvdis_HES.status,
                      ds_cvdis_HES.receiveEncounterId,
                      ds_cvdis_HES.active,
                      ds_cvdis_HES.cvdisupdated,
                      ds_cvdis_HES.priority,
                      ds_cvdis_HES.name,
                      ds_cvdis_HES.userCode,
                      ds_cvdis_HES.cdaId,
                      ds_cvdis_HES.username,
                      convert(varchar,alerts),
                      ds_cvdis_HES.HESID,
                      ds_cvdis_HES.refHospital,
                      ds_cvdis_HES.fromBU,
                      ds_cvdis_HES.refWard,
                      ds_cvdis_HES.completeddate,
                      ds_cvdis_HES.CIMSServiceOrderCode,
                      convert(varchar,Reftoservice),
                      ds_cvdis_HES.toBU,
                      ds_cvdis_HES.responsible_clinician,
                      ds_cvdis_HES.procedureOutcome,
                      ds_cvdis_HES.procedureCompleted
        name: S_HES_FORM_10
        noLinkRefs: []
  name: S_HES_FORM_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
