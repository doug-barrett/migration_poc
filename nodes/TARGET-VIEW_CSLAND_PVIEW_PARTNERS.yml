fileVersion: 1
id: 8d87527b-4443-46a9-84ee-6f6c012230cc
name: VIEW_CSLAND_PVIEW_PARTNERS
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: "DOI partners from CSLand for ProdView master data integration"
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 63325063-019d-4a51-a0aa-1561ce161bc8
          stepCounter: 8d87527b-4443-46a9-84ee-6f6c012230cc
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: WELL_FILE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb5e83e4-8241-489a-a342-a723c2726c60
                stepCounter: 3827a394-a2a4-4244-b906-f8c11d9c8582
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67cc2a4a-d052-4649-8fe8-fffd314ea6ab
          stepCounter: 8d87527b-4443-46a9-84ee-6f6c012230cc
        config: {}
        dataType: VARCHAR(16)
        defaultValue: ""
        description: ""
        name: WELL_UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f5861d01-5cf3-487e-89f4-322846f51d8a
                stepCounter: 3827a394-a2a4-4244-b906-f8c11d9c8582
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 23eaba83-5751-41c4-a667-c3120eeda63f
          stepCounter: 8d87527b-4443-46a9-84ee-6f6c012230cc
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: WELL_FILE_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4bcede6c-cd02-46fb-b2b5-8729ccf3fb90
                stepCounter: 250c3271-f34f-46da-994a-8c335b143783
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd9fb52a-40ac-4b13-8501-5c9488de5cf4
          stepCounter: 8d87527b-4443-46a9-84ee-6f6c012230cc
        config: {}
        dataType: NUMBER(7)
        defaultValue: ""
        description: ""
        name: DOI_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f841507-16ce-4612-80ff-8261367e7396
                stepCounter: 5d401374-6e3b-4e5f-b27a-ab979c40cb21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a848d72-63dc-4032-b4c4-4300fdc1401b
          stepCounter: 8d87527b-4443-46a9-84ee-6f6c012230cc
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DOI_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 353fb880-be91-4706-8ff0-4c9fc93a1a3f
                stepCounter: 8a1aebb0-1dcf-4f1e-be95-93508ea7ab7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fcb92ea9-17c0-48f1-a90b-0d159c7ebcc3
          stepCounter: 8d87527b-4443-46a9-84ee-6f6c012230cc
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: DOI_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 469c271a-3b3f-43c4-99c1-c621b8c1d32a
                stepCounter: fc08e86c-5254-4f5e-97fc-e83555aefe1e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d42e89f-1036-417a-a531-14638fe86673
          stepCounter: 8d87527b-4443-46a9-84ee-6f6c012230cc
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: DOI_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 739336c2-7514-48c7-a582-79f9a8720b53
                stepCounter: 8a1aebb0-1dcf-4f1e-be95-93508ea7ab7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f586010-c271-41ce-b37a-321dfebcf3d0
          stepCounter: 8d87527b-4443-46a9-84ee-6f6c012230cc
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CHANGED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc8fc0bb-41fd-4169-a46f-03db0ed56c7f
                stepCounter: 8a1aebb0-1dcf-4f1e-be95-93508ea7ab7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 855f45a7-76d4-4e1e-9778-6ed5c3244eb0
          stepCounter: 8d87527b-4443-46a9-84ee-6f6c012230cc
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: WELL_DOI_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0abf96c0-1750-4523-a439-2a9c97feeaba
                stepCounter: 8a1aebb0-1dcf-4f1e-be95-93508ea7ab7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39c49f41-07b1-4479-8f30-ad133b6ee887
          stepCounter: 8d87527b-4443-46a9-84ee-6f6c012230cc
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: EFFECTIVE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dbba7f4f-8c90-4747-bbce-8099b28ea271
                stepCounter: 8a1aebb0-1dcf-4f1e-be95-93508ea7ab7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c957470-c5ea-4000-976d-17934dc8ce89
          stepCounter: 8d87527b-4443-46a9-84ee-6f6c012230cc
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: EXPIRY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6510da05-a4fa-41d5-ba0f-2e995a04bf86
                stepCounter: 8a1aebb0-1dcf-4f1e-be95-93508ea7ab7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3cdba467-8ac0-4e26-9e3d-1373b8e58514
          stepCounter: 8d87527b-4443-46a9-84ee-6f6c012230cc
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: WELL_OWNED_DOI_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b19904c-a62a-4040-971d-0bdb22e62c05
                stepCounter: 8a1aebb0-1dcf-4f1e-be95-93508ea7ab7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 883ff9cf-f37f-4aaf-92a0-0b8e4189c2aa
          stepCounter: 8d87527b-4443-46a9-84ee-6f6c012230cc
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: OWNER_IN_PENALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 51642c80-af74-40d2-8409-7af2811653d5
          stepCounter: 8d87527b-4443-46a9-84ee-6f6c012230cc
        config: {}
        dataType: NUMBER(6)
        defaultValue: ""
        description: ""
        name: PARTNER_OCCURRENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3943edef-ae37-48bc-b3bf-f803a5e29470
                stepCounter: 5d401374-6e3b-4e5f-b27a-ab979c40cb21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2cbb0de-e6c0-4209-a9d5-d2c133791526
          stepCounter: 8d87527b-4443-46a9-84ee-6f6c012230cc
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PARTNER_BA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8953a1e0-0998-4339-acdc-88c81059d248
                stepCounter: 5d401374-6e3b-4e5f-b27a-ab979c40cb21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a0bc7c8-d526-4561-8923-7bc5ad55585d
          stepCounter: 8d87527b-4443-46a9-84ee-6f6c012230cc
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: PARTNER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e973675-26ea-41fb-9f8f-450a5924d092
                stepCounter: 17e8c098-2969-4300-91b0-b858f6d02add
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c73c95ae-f884-4da7-b45c-d9832830f7d7
          stepCounter: 8d87527b-4443-46a9-84ee-6f6c012230cc
        config: {}
        dataType: NUMBER(11,8)
        defaultValue: ""
        description: ""
        name: PARTNER_PERCENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4390719f-f647-4285-96c0-635bec86b40c
                stepCounter: 5d401374-6e3b-4e5f-b27a-ab979c40cb21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d55203e-be23-4494-9e30-4c9a1ba878ea
          stepCounter: 8d87527b-4443-46a9-84ee-6f6c012230cc
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: OWNING_PARTNER_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b9db526e-f016-4482-acc5-ece4c1afc62d
          stepCounter: 8d87527b-4443-46a9-84ee-6f6c012230cc
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: SILENT_PARTNER_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77e72a62-cac0-40a8-81ba-90e06dd1591b
                stepCounter: 5d401374-6e3b-4e5f-b27a-ab979c40cb21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b262ec58-5e81-4f22-8dcf-63f30ecedd8b
          stepCounter: 8d87527b-4443-46a9-84ee-6f6c012230cc
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PARTNER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a944f58a-7836-4f13-9526-46953ba1623a
                stepCounter: 5d401374-6e3b-4e5f-b27a-ab979c40cb21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04bf44bc-8cad-4a68-bc5c-9b947268829d
          stepCounter: 8d87527b-4443-46a9-84ee-6f6c012230cc
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: PARTNER_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1aedf7e7-d423-495f-8d9b-278728e3db5b
                stepCounter: 8257f393-4593-4b10-b20d-11d5bf639afd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 61b211c4-c00c-4144-a0ca-5b9d64d42911
          stepCounter: 8d87527b-4443-46a9-84ee-6f6c012230cc
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: PENALTY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa838ebf-6c6f-4617-9d3b-7a71ef98a87a
                stepCounter: 5d401374-6e3b-4e5f-b27a-ab979c40cb21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9f6b9ad-5a92-4a25-82dc-1ca12b984be9
          stepCounter: 8d87527b-4443-46a9-84ee-6f6c012230cc
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: SILENT_OWNER_BA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de841b6a-76f6-4c20-9d40-c64fc14a99c1
                stepCounter: 5d401374-6e3b-4e5f-b27a-ab979c40cb21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aae32542-cf0a-407a-a22e-ae5e08cabaa6
          stepCounter: 8d87527b-4443-46a9-84ee-6f6c012230cc
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: SILENT_OWNER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e973675-26ea-41fb-9f8f-450a5924d092
                stepCounter: 17e8c098-2969-4300-91b0-b858f6d02add
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b99d5f70-40b7-439b-93b7-470c17e60733
          stepCounter: 8d87527b-4443-46a9-84ee-6f6c012230cc
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PARTNER_SUMMARY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_CSLAND_PVIEW_PARTNERS: 8d87527b-4443-46a9-84ee-6f6c012230cc
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_CSLAND_PVIEW_PARTNERS') }} AS SELECT WD1.FILE_NUMBER "WELL_FILE_NUMBER",
                   WD1.WELL_UWI,
                   TWFS.DESCRIPTION "WELL_FILE_STATUS",
                   DD.DOI_ID,
                   DX.DOI_TYPE "DOI_TYPE_CODE",
                   TD.DESCRIPTION "DOI_TYPE",
                   DX.DOI_STATUS,
                   DX.CHANGED_DATE,
                   DX.ACCOUNT_GROUP "WELL_DOI_TYPE",
                   DX.EFFECTIVE_DATE,
                   DX.EXPIRY_DATE,
                   DX.OWNER "WELL_OWNED_DOI_FLAG",
                   DECODE(MAX(DECODE(DECODE(TOW.OWNER,NULL,'N','Y')||NVL(DD.PENALTY,'N'),'YY',1,0)) OVER (PARTITION BY DD.DOI_ID, DD.PARTNER),1,'Y','N') "OWNER_IN_PENALTY",
                   DD.OCCURRENCE "PARTNER_OCCURRENCE",
                   DD.PARTNER "PARTNER_BA",
                   BA1.NAME "PARTNER_NAME",
                   DD.PARTNER_PERCENT,
                   DECODE(TOW.OWNER,NULL,'N','Y') "OWNING_PARTNER_FLAG",
                   DD.SILENT_PARTNER "SILENT_PARTNER_FLAG",
                   DD.PARTNER_TYPE "PARTNER_TYPE_CODE",
                   TP.DESCRIPTION "PARTNER_TYPE",
                   DD.PENALTY "PENALTY_FLAG",
                   DD.SILENT_OWNER "SILENT_OWNER_BA",
                   BA2.NAME "SILENT_OWNER_NAME",
                   RPAD(BA1.NAME||'  ('||TRIM(DD.PARTNER)||')', 50, ' ') || LPAD(TO_CHAR(NVL(DD.PARTNER_PERCENT,0),'990.0000000'),12,' ') || '   ' || RPAD(NVL(DD.PARTNER_TYPE,' '),10,' ') || '   ' || 'Owner: '||DECODE(TOW.OWNER,NULL,'N','Y') || '   ' || 'Silent Partner: '||DECODE(DD.SILENT_PARTNER,'*','S',' ') || '   ' || 'Penalty: '||NVL(DD.PENALTY,'N') || '   ' || 'Silent Owner: '||RPAD(BA2.NAME||'  ('||TRIM(DD.SILENT_OWNER)||')', 50, ' ') "PARTNER_SUMMARY"
              FROM DS_CSLAND.D_XREF DX,
                   DS_CSLAND.D_DETAIL DD,
                   DS_CSLAND.T_OWNERS TOW,
                   DS_CSLAND.BA_TABLE BA1,
                   DS_CSLAND.BA_TABLE BA2,
                   DS_CSLAND.T_DOI TD,
                   DS_CSLAND.T_PTYPE TP,
                   DS_CSLAND.W_DETAIL1 WD1,
                   DS_CSLAND.T_WFSTATUS TWFS
             WHERE DX.DOI_ID = DD.DOI_ID
               AND DD.PARTNER = TOW.OWNER(+)
               AND DX.EFFECTIVE_DATE <= CURRENT_TIMESTAMP
               AND DX.EXPIRY_DATE > CURRENT_TIMESTAMP
               AND DD.PARTNER = BA1.PRIMARY_KEY(+)
               AND DD.SILENT_OWNER = BA2.PRIMARY_KEY(+)
               AND DX.DOI_TYPE = TD.CODE(+)
               AND DD.PARTNER_TYPE = TP.CODE(+)
               AND DX.SUBSYSTEM = 'W'
               AND DX.FILE_NUMBER = WD1.FILE_NUMBER
               AND WD1.FILE_STATUS = TWFS.CODE
               AND BA1.FILE_STATUS = 'ACTIVE'
               AND DX.DOI_TYPE NOT LIKE 'ROY TO%'
               AND WD1.FILE_STATUS NOT IN ('S', 'T', 'FRANCE')
        dependencies:
          - locationName: TARGET
            nodeName: ODS_CSLAND_W_DETAIL1
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_CSLAND_W_DETAIL1') }}
        name: VIEW_CSLAND_PVIEW_PARTNERS
        noLinkRefs: []
  name: VIEW_CSLAND_PVIEW_PARTNERS
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
