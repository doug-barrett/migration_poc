fileVersion: 1
id: 7bcb7596-01b0-4e4c-ba92-80d520c65361
name: VIEW_CSLAND_PVIEW_PARTNERS
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: "DOI partners from CSLand for ProdView master data integration"
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f8404a54-456c-4e97-b857-db6c5edfa59f
          stepCounter: 7bcb7596-01b0-4e4c-ba92-80d520c65361
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: WELL_FILE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 536089c6-5508-4b08-90e4-416273afec75
                stepCounter: acf1f27e-42aa-45fa-aae6-5035f7fc804c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40a0bf84-6a59-4195-85ef-ac0cc57de9a9
          stepCounter: 7bcb7596-01b0-4e4c-ba92-80d520c65361
        config: {}
        dataType: VARCHAR(16)
        defaultValue: ""
        description: ""
        name: WELL_UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 984250f7-369b-4059-8a28-889af155173e
                stepCounter: acf1f27e-42aa-45fa-aae6-5035f7fc804c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf41f084-687d-48f3-8b30-b35cf200d319
          stepCounter: 7bcb7596-01b0-4e4c-ba92-80d520c65361
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: WELL_FILE_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f5a22cda-bccc-455c-b763-d19de77708f4
                stepCounter: 56f42c85-ca1f-476d-b6ce-0577235c7ecc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47b426e8-3143-4a8e-942d-a9ac294d9d1b
          stepCounter: 7bcb7596-01b0-4e4c-ba92-80d520c65361
        config: {}
        dataType: NUMBER(7)
        defaultValue: ""
        description: ""
        name: DOI_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84ad3ac6-6986-4681-8c33-4a9b339d8cae
                stepCounter: 4c591dae-8cae-4462-b16e-495c5989ebb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca076665-e93f-44ac-8bac-999b3032dfa2
          stepCounter: 7bcb7596-01b0-4e4c-ba92-80d520c65361
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DOI_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60964802-6912-4016-81d2-f68db88ca9e5
                stepCounter: 2666f026-1171-4402-99af-47c5ee6092ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6aa39d69-68ff-40c1-a9f1-34eda24c1d08
          stepCounter: 7bcb7596-01b0-4e4c-ba92-80d520c65361
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: DOI_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21679f94-12c3-464c-90ef-4897b957cf97
                stepCounter: d2bd2d6f-5926-4bb8-9642-b5aaafb48852
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e2b49ef-f4d4-4a45-8633-e80fec7fd54a
          stepCounter: 7bcb7596-01b0-4e4c-ba92-80d520c65361
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: DOI_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: efe834e0-3e15-48b3-83f5-fe18e69b0a28
                stepCounter: 2666f026-1171-4402-99af-47c5ee6092ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f8694411-c4a7-4d71-8c2a-71e4feb09582
          stepCounter: 7bcb7596-01b0-4e4c-ba92-80d520c65361
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CHANGED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 92a8b1ce-37ff-4860-892e-53a905e5faf4
                stepCounter: 2666f026-1171-4402-99af-47c5ee6092ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d0d603f-4ef5-4a22-8dcd-70afe7950138
          stepCounter: 7bcb7596-01b0-4e4c-ba92-80d520c65361
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: WELL_DOI_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c90932ab-182d-43ee-b8d4-a0da56ab3f47
                stepCounter: 2666f026-1171-4402-99af-47c5ee6092ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d17862c0-d2d9-4810-9bd6-d08bcaaa0c61
          stepCounter: 7bcb7596-01b0-4e4c-ba92-80d520c65361
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: EFFECTIVE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8660bb6e-e159-45b6-8fc0-cd6924ef6efe
                stepCounter: 2666f026-1171-4402-99af-47c5ee6092ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3627db6b-de77-4c9d-94d8-eca9b4124dc0
          stepCounter: 7bcb7596-01b0-4e4c-ba92-80d520c65361
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: EXPIRY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de877534-23cf-4838-b856-3b01941db1fe
                stepCounter: 2666f026-1171-4402-99af-47c5ee6092ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 002a6464-4688-4be7-8b88-edafdcc8a6ad
          stepCounter: 7bcb7596-01b0-4e4c-ba92-80d520c65361
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: WELL_OWNED_DOI_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5c38b63-f893-42fc-8def-b57710c6de20
                stepCounter: 2666f026-1171-4402-99af-47c5ee6092ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40ffc70b-a703-4197-add2-69862f6b2988
          stepCounter: 7bcb7596-01b0-4e4c-ba92-80d520c65361
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: OWNER_IN_PENALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a49ae17c-3d0f-4d13-b136-8d584823fbd7
          stepCounter: 7bcb7596-01b0-4e4c-ba92-80d520c65361
        config: {}
        dataType: NUMBER(6)
        defaultValue: ""
        description: ""
        name: PARTNER_OCCURRENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c40a795c-fd97-4c63-b7da-b198386529cc
                stepCounter: 4c591dae-8cae-4462-b16e-495c5989ebb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c0da985-3929-4e4e-9509-46b44e5b122b
          stepCounter: 7bcb7596-01b0-4e4c-ba92-80d520c65361
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PARTNER_BA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05f2ec9a-e62a-42cc-aa20-5ba476d5cd21
                stepCounter: 4c591dae-8cae-4462-b16e-495c5989ebb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f580616-0373-423d-9155-124013b3df3f
          stepCounter: 7bcb7596-01b0-4e4c-ba92-80d520c65361
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: PARTNER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7cdfc49f-aa22-4a4a-ad06-6a087f45b67d
                stepCounter: 195380c1-f588-4c27-9c13-2d48662dc985
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7ab6046-f6a5-438c-8462-c40f9b4e4489
          stepCounter: 7bcb7596-01b0-4e4c-ba92-80d520c65361
        config: {}
        dataType: NUMBER(11,8)
        defaultValue: ""
        description: ""
        name: PARTNER_PERCENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f0286f0e-21c4-426a-8cee-a0d0b6882ac4
                stepCounter: 4c591dae-8cae-4462-b16e-495c5989ebb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b7dbba2-445a-4550-9453-57d271b8b10e
          stepCounter: 7bcb7596-01b0-4e4c-ba92-80d520c65361
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: OWNING_PARTNER_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7018aeb7-521c-46cc-8a6e-ff8d5077dd7a
          stepCounter: 7bcb7596-01b0-4e4c-ba92-80d520c65361
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: SILENT_PARTNER_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c8576b2-31e8-4733-b87d-15c8d262a64e
                stepCounter: 4c591dae-8cae-4462-b16e-495c5989ebb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e883ba94-5d94-42f0-a9b9-b22306866d96
          stepCounter: 7bcb7596-01b0-4e4c-ba92-80d520c65361
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PARTNER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2b7896c-d3ee-452b-97f0-fc91c72bba7a
                stepCounter: 4c591dae-8cae-4462-b16e-495c5989ebb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1c14a0a-ef26-4c40-a712-202bed45a647
          stepCounter: 7bcb7596-01b0-4e4c-ba92-80d520c65361
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: PARTNER_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c6fc463-d6b2-47af-a01c-0bccfc785465
                stepCounter: 61f17e1f-2d1c-4948-960a-7d2c86b563a2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39c6b51b-2f05-48db-ac96-b830322305ec
          stepCounter: 7bcb7596-01b0-4e4c-ba92-80d520c65361
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: PENALTY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3970f27c-9b05-4aeb-a7a6-f07bcbb37a33
                stepCounter: 4c591dae-8cae-4462-b16e-495c5989ebb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a76ee2af-4663-4d6f-a818-64101e1cda5b
          stepCounter: 7bcb7596-01b0-4e4c-ba92-80d520c65361
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: SILENT_OWNER_BA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ccb9643-cdba-4b1c-877e-8d169c9a68ef
                stepCounter: 4c591dae-8cae-4462-b16e-495c5989ebb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7236aaca-9f59-4571-82fa-97ac7d4cdbcd
          stepCounter: 7bcb7596-01b0-4e4c-ba92-80d520c65361
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: SILENT_OWNER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7cdfc49f-aa22-4a4a-ad06-6a087f45b67d
                stepCounter: 195380c1-f588-4c27-9c13-2d48662dc985
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9fa1ec6d-3016-4fd6-b73d-d3054ec1ffc7
          stepCounter: 7bcb7596-01b0-4e4c-ba92-80d520c65361
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PARTNER_SUMMARY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_CSLAND_PVIEW_PARTNERS: 7bcb7596-01b0-4e4c-ba92-80d520c65361
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_CSLAND_PVIEW_PARTNERS') }} AS SELECT WD1.FILE_NUMBER "WELL_FILE_NUMBER",
                   WD1.WELL_UWI,
                   TWFS.DESCRIPTION "WELL_FILE_STATUS",
                   DD.DOI_ID,
                   DX.DOI_TYPE "DOI_TYPE_CODE",
                   TD.DESCRIPTION "DOI_TYPE",
                   DX.DOI_STATUS,
                   DX.CHANGED_DATE,
                   DX.ACCOUNT_GROUP "WELL_DOI_TYPE",
                   DX.EFFECTIVE_DATE,
                   DX.EXPIRY_DATE,
                   DX.OWNER "WELL_OWNED_DOI_FLAG",
                   DECODE(MAX(DECODE(DECODE(TOW.OWNER,NULL,'N','Y')||NVL(DD.PENALTY,'N'),'YY',1,0)) OVER (PARTITION BY DD.DOI_ID, DD.PARTNER),1,'Y','N') "OWNER_IN_PENALTY",
                   DD.OCCURRENCE "PARTNER_OCCURRENCE",
                   DD.PARTNER "PARTNER_BA",
                   BA1.NAME "PARTNER_NAME",
                   DD.PARTNER_PERCENT,
                   DECODE(TOW.OWNER,NULL,'N','Y') "OWNING_PARTNER_FLAG",
                   DD.SILENT_PARTNER "SILENT_PARTNER_FLAG",
                   DD.PARTNER_TYPE "PARTNER_TYPE_CODE",
                   TP.DESCRIPTION "PARTNER_TYPE",
                   DD.PENALTY "PENALTY_FLAG",
                   DD.SILENT_OWNER "SILENT_OWNER_BA",
                   BA2.NAME "SILENT_OWNER_NAME",
                   RPAD(BA1.NAME||'  ('||TRIM(DD.PARTNER)||')', 50, ' ') || LPAD(TO_CHAR(NVL(DD.PARTNER_PERCENT,0),'990.0000000'),12,' ') || '   ' || RPAD(NVL(DD.PARTNER_TYPE,' '),10,' ') || '   ' || 'Owner: '||DECODE(TOW.OWNER,NULL,'N','Y') || '   ' || 'Silent Partner: '||DECODE(DD.SILENT_PARTNER,'*','S',' ') || '   ' || 'Penalty: '||NVL(DD.PENALTY,'N') || '   ' || 'Silent Owner: '||RPAD(BA2.NAME||'  ('||TRIM(DD.SILENT_OWNER)||')', 50, ' ') "PARTNER_SUMMARY"
              FROM DS_CSLAND.D_XREF DX,
                   DS_CSLAND.D_DETAIL DD,
                   DS_CSLAND.T_OWNERS TOW,
                   DS_CSLAND.BA_TABLE BA1,
                   DS_CSLAND.BA_TABLE BA2,
                   DS_CSLAND.T_DOI TD,
                   DS_CSLAND.T_PTYPE TP,
                   DS_CSLAND.W_DETAIL1 WD1,
                   DS_CSLAND.T_WFSTATUS TWFS
             WHERE DX.DOI_ID = DD.DOI_ID
               AND DD.PARTNER = TOW.OWNER(+)
               AND DX.EFFECTIVE_DATE <= CURRENT_TIMESTAMP
               AND DX.EXPIRY_DATE > CURRENT_TIMESTAMP
               AND DD.PARTNER = BA1.PRIMARY_KEY(+)
               AND DD.SILENT_OWNER = BA2.PRIMARY_KEY(+)
               AND DX.DOI_TYPE = TD.CODE(+)
               AND DD.PARTNER_TYPE = TP.CODE(+)
               AND DX.SUBSYSTEM = 'W'
               AND DX.FILE_NUMBER = WD1.FILE_NUMBER
               AND WD1.FILE_STATUS = TWFS.CODE
               AND BA1.FILE_STATUS = 'ACTIVE'
               AND DX.DOI_TYPE NOT LIKE 'ROY TO%'
               AND WD1.FILE_STATUS NOT IN ('S', 'T', 'FRANCE')
        dependencies:
          - locationName: TARGET
            nodeName: ODS_CSLAND_W_DETAIL1
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_CSLAND_W_DETAIL1') }}
        name: VIEW_CSLAND_PVIEW_PARTNERS
        noLinkRefs: []
  name: VIEW_CSLAND_PVIEW_PARTNERS
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
