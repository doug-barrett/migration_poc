fileVersion: 1
id: a03e1d58-5881-4567-b376-d36c89a086af
name: S_IN_PATIENT_CODING_20
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6240eb4-9452-4fbb-9517-bfdb08e06c71
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: VARCHAR(16)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4db76560-f9cc-4629-a3ea-d3b42d836e0c
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e873a4bf-7e42-44ab-8106-2363c5bd4b03
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: VARCHAR(12)
        defaultValue: ""
        description: ""
        name: ACC_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 68ba53a5-4acd-473b-88f7-5360d249b726
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 395e67fa-91b7-45c9-84f9-5641ae93d2ea
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ACCIDENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 958d48f9-0b5c-4be9-9296-c0862b35fe7b
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07ddedd7-4aea-4b99-a438-6d345a9a2d57
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMISSION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a3a6cfc-016b-4191-9515-4eb2033186eb
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 213f2213-6226-492e-938f-ab13bb975c28
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMISSION_WEIGHT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a42e5e16-13f0-4bf8-9a54-70dddb2b57e3
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24d6f721-7736-4d06-9e12-9f3d38912790
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: ADMITSOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60d7a884-58da-49e5-9c06-eb1766a73f57
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3fecf9f7-9be2-40f8-8701-1e167d53fdbf
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: ADMITTYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5bebe1ea-5ee0-4c19-b906-2bd905ab71b1
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4599b7cf-206e-48ab-a601-11290ee9cba8
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: BIRTH_WEIGHT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0e8f1479-b149-4cef-ade2-34939e759790
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34e16c8d-27d7-49c8-85bc-e80d1d757d06
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CCL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c05e1dd7-74ec-411c-a97b-9b0c4dd6cbec
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb13ea51-d4d8-47ba-9702-64e3fe3d066e
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CODED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 45ba8e1b-b945-47e9-a8aa-be8d89569f04
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6199c335-643a-4f6b-9018-a924cb7e85dd
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 385e40b4-d861-4e87-bad7-d02144c36537
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7fca59b2-d02f-4d0c-b2f7-9d777c28ee4a
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CPAP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a63f0200-3437-4479-ada2-3eaff0511430
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7eb3a353-bd33-4a24-a3d4-4f06634ff22f
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: DOMICILE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78258a69-d2c5-40af-8c6d-400fef62f571
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c368590-d86c-49ec-a37f-3d3e59f10adf
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DATE_ADDED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b5a06d63-ab48-45c7-94d4-37cb0444a22c
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2602737-1326-410f-bb37-5f1b5a3fdc3a
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b807aa81-8e44-47ce-8c06-c25850c3491e
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9a03f5f-faba-4584-8360-b72409d314e8
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: DRG_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1c49091-2e1f-4ee7-a7b0-1cec15435630
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 60b9b3a6-10b0-4a2a-9de7-006cbe26ddc6
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: VARCHAR(16)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_ID_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 955586ba-b506-478d-bfce-6dc084b84c2a
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d69543ea-5bc7-4816-be38-08898fd0c565
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: EVENTENDTYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 856d2b86-adc1-4877-a1f7-63cccd092fd7
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf3276c2-cfb2-42d3-85f1-87a8791b5122
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: EVENTTYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: effde8f3-01fa-4aab-a315-38d86114c166
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1f12830-9408-4964-a626-9c02cfec6a3b
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FILE_REFERENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 355bd3d0-08eb-47f3-8864-cda888b4caa3
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 51bc3a1d-f4e0-46b6-9860-48c8b1853a50
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: GESTATION_PERIOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b7bcf6f2-902d-46c0-b2e6-8df0d78eaaef
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e2f5e12-1a8f-4dec-b826-eb320654bde4
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: GESTATIONAL_AGE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f6ed1c2d-2be1-49f9-b19e-4044f4bcba95
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32f1b510-9fc8-4c04-aa57-ab55cc992967
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: ""
        name: HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 41e86619-105c-4574-9822-768d2955e88c
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92f00169-86b1-49f7-ba89-6fcc0c80ba80
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: HOSPITAL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e4fb50a1-0591-4245-9c7b-605f3aa71867
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: IFNULL(CASE WHEN s_in_patient_coding_10.hospital_id ='' THEN NULL ELSE s_in_patient_coding_10.hospital_id END,s_in_patient_coding_10.iPM_facility_code)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d30b9738-e96c-4bc7-b1e6-42d8936d18af
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_coding_20.event_encounter_id=dim_ICD_diagnosis_coding.event_encounter_id  s_in_patient_coding_20.dim_ICD_procedure_coding.diagnosis_procedure_type='D'=dim_ICD_diagnosis_coding.diagnosis_procedure_type
        name: DIM_ICD_DIAGNOSIS_CODING_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d60c981-be20-43a5-8e66-3bf30df51646
                stepCounter: ea944822-7ca8-4640-bfb3-6f41b12d3433
            transform: IFNULL(dim_ICD_diagnosis_coding.dim_ICD_diagnosis_coding_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48fcf906-5413-4f68-8f9f-40f4d49ee3fb
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_coding_20.event_encounter_id=dim_ICD_procedure_coding.event_encounter_id  s_in_patient_coding_20.dim_ICD_diagnosis_coding.diagnosis_procedure_type = 'P'=dim_ICD_procedure_coding.diagnosis_procedure_type
        name: DIM_ICD_PROCEDURE_CODING_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 54160687-e6fe-48e1-be9c-79af2374fca7
                stepCounter: cc82fe0c-7539-4905-913b-1e991cd32882
            transform: IFNULL(dim_ICD_procedure_coding_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: acd22c25-c93d-4294-a9d5-266ed90b2fc2
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_coding_20.event_encounter_id=dim_ICD_procedure_coding.event_encounter_id  s_in_patient_coding_20.dim_ICD_diagnosis_coding.diagnosis_procedure_type = 'P'=dim_ICD_procedure_coding.diagnosis_procedure_type
        name: DIM_ICD_SUPPLEMENTARY_CODING_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f201dd1c-46cf-422c-9586-2a6b072e51d4
                stepCounter: 84b95849-04a5-48b6-b6bb-f5b9d2aeb8a5
            transform: IFNULL(dim_ICD_supplementary_coding_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b25b12a-40d7-416f-98af-acf5e05e6574
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: IPM_EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e218fb7b-7c5b-4fab-8983-ed404695c1c0
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8835d82d-229f-4e32-80c5-aee9c48d437f
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: IPM_ADMIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2b9a3ea0-09c7-42af-8889-5b6f027d32df
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94fe4fef-fef1-48fe-aaee-ebdedffa979a
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: IPM_DISCH_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a19706d-fcac-42b7-b16c-fc3ee01bcd35
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d05c0e97-5ea0-4c46-8caf-448f963b6e96
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: MOH Principal Purchaser code mapped from admin category
        name: IPM_PURCHASER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 332369be-8093-4ca6-98e0-38f873dbfe02
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42c61070-c920-45e2-b0d1-d95e096ab587
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: IPM_DISCH_HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: adb836ed-5cd6-48c1-ba42-e4d9c0a4571f
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8952afb-b645-48e2-ad71-c023ad06b24d
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: IPM_FACILITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2f2400ee-1617-4c41-aa5b-7713fbecf83e
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 363d460e-4835-4ecd-8447-9cd1f9def019
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: IPM_MECH_VENT_HRS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 37d17189-90b3-4ff4-b881-f917ff6dfa2b
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8c04ef6-33ae-4580-8dd7-d84c892c2162
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: IPM_PDC_ADMIT_DATE_MATCH_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f1c7e4ee-880e-4851-9d47-c2c81ffe65b5
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eca07612-8668-4188-b405-d220537d5393
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: IPM_PDC_DISCH_DATE_MATCH_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 08d206d4-b13c-43c9-bb52-1f1dcfd7fb5f
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2fdd5c52-446c-45a1-82e6-37b31376d593
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: IPM_PDC_PURCHASER_MATCH_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 391e9c6f-06b8-4300-916b-5aa6cafcb4a2
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0925d1b-da19-43f6-a0a1-891402188982
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: IPM_PDC_SPECIALTY_MATCH_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 229f7654-c582-435e-a3f7-b5ee8f32a488
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 891ee1e1-2ab7-4300-8518-c8636b4ea2ae
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: IPM_PDC_FACILITY_MATCH_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c66dab8-fbf9-4b3f-a39b-4946aa7e5155
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0aa6e789-a39e-4db8-b5a1-5b4ce472da30
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: IPM_PDC_EVENT_TYPE_MATCH_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 63cbf0b7-cbf8-468b-b9d8-203040ceaefc
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47d5d216-27cb-4a3a-a6f7-f8c4882b75c0
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: IPM_PDC_NHI_MATCH_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 62e0b390-5782-4101-a30c-8de8cca17839
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9947d591-ecc1-452a-9513-b6ca13f50e4a
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: MDC_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 046f0d92-776d-415e-93d2-18ddb30c9a33
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6fe4f604-a04f-40ea-ba49-e83351464bc2
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: MECHANICAL_VENTILATOR_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec7da387-5a88-4327-96e7-2576f4157f1d
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b177282-1a1c-4d05-90db-491280d9e3ae
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: MOTHERS_AGE_AT_ADMISSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0afff821-996d-4bcc-b5fe-a4f6ca3708f9
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 28d81bda-64c7-4ce8-821c-95122e520092
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: VARCHAR(7)
        defaultValue: ""
        description: ""
        name: NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50eb0ac3-58e4-4a8f-b75e-8942f506d0e9
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a9663a5-7f0b-4936-bd4c-d9490714422f
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: NZ_RESIDENCY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67efcc15-9982-42d9-96ba-bf83f698c3bd
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 30f8ff56-1056-4998-afd8-3d2f5707e911
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: AGE_AT_ADMISSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b558311a-c6e2-454d-89d8-446df515a5d9
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa807377-ab00-46c6-9299-f4d239c834ed
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: AGE_AT_DISCHARGE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c371ca64-e804-460d-ac5c-62e4ed6404bf
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 077e0eaf-2d93-4db2-873d-966179dec1cd
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ORIGINAL_FILE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe4e2f38-f80a-44e4-bf92-814989725489
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f407cbf-d814-496a-82d6-7cff86863376
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PATIENT_DATE_OF_BIRTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b65722be-e624-4cee-a5ee-850bd0a1b678
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7080ced8-2dad-4835-81cb-807c06901761
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: The date that the patient died
        name: PATIENT_DATE_OF_DEATH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 82e046ab-e125-4178-8cb7-01aaa6865d14
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9778c25-fa95-4c47-9a23-74ce04a6f4be
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: POST_OP_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18e998ba-d705-40e2-8489-9a276b17c00f
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c95f6ae-f3b9-49db-934b-3e241246b13b
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRE_OP_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 553eb4a0-952b-45ab-8bda-89f091973a26
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab8dd2aa-b89b-4afd-a3a4-1e5fd5bdb113
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: PRINCIPAL_PAYER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 82554f03-8f66-4b5a-a9c1-5b31d60b2f5c
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06a7292d-f683-44c7-96a7-eb38fd00298f
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ae6f1fe6-212b-4c38-98cc-79023e01bb7c
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9dc66dfe-0cb2-46e4-bf25-4e2195252ae8
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: RECORD_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a338516c-6cd4-43fd-881c-0e940b9c5389
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1a4b9bc-880a-47f8-9fe8-9f75ccd708ba
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: WIES_RATING
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c72e73e1-660a-4928-81bd-4f7920c4de57
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7dfc90c9-7697-4d56-946a-0e31750d3d25
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_coding_20.age_at_discharge=dim_age_group.age_years
        name: DIM_AGE_GROUP_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18bfabd7-19aa-4de0-9ce7-aa560645bce6
                stepCounter: 3d5ba8a8-80ec-4848-b58a-d31b34cc53ed
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c01cbff0-3b5c-471d-a125-8aeba120d9d9
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: DISCHARGE_TO_CODING_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: datediff(DAY,s_in_patient_coding_10.discharge_date, IFNULL(s_in_patient_coding_10.coded_date,getdate()))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50925544-9ca7-4a04-836e-7c28f9bb022b
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_coding_20.DRG_code=dim_DRG_code.DRG_code
        name: DIM_DRG_CODE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8bd0a5c0-d5a2-4d49-91dd-c4253418a9b4
                stepCounter: c9ea96b1-10f0-4480-aff0-b535fb105991
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 757dd60d-1c5c-450f-a75e-fcce0ffa02f9
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: IPM_MODIF_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1002e061-675f-48b4-83cc-25d38d6276bb
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a32b95cb-7788-4afa-989e-101c2a0d79c1
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_coding_20.coded_date=dim_coded_date.calendar_date
        name: DIM_CODED_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0eece01a-42b9-4944-bf1c-a39e89f508e8
                stepCounter: 6397a769-4d0d-4397-8be2-8cb876794c81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d080021d-c5b1-4be2-a19d-e914850fdef8
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_coding_20.domicile_code=dim_domicile.domicile_code
        name: DIM_DOMICILE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e049fc8-a2a3-4bad-9b91-11b9d158b35e
                stepCounter: 330ad0aa-b8b1-4da9-ab37-b4fe8f889452
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f34649e1-f814-4a04-82c1-90f96a313fef
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_coding_20.hospital_id=dim_health_facility.health_facility_code
        name: DIM_HEALTH_FACILITY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6bf6bd17-b626-4e3a-ab8c-d3ff41850356
                stepCounter: 2f6f101b-8a09-4182-a969-06add4b17ff5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5122a70d-5001-4a97-90d7-7675ab651310
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_coding_20.principal_payer=dim_purchaser.purchaser_reference_no
        name: DIM_PURCHASER_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5359e9e9-a873-4f6d-8b70-005d22be8ed1
                stepCounter: 83d04de3-0551-4ba3-814b-2ca3e4840adf
            transform: IFNULL(dim_purchaser.dim_purchaser_key,1)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7eb7918-8ec1-434b-b26b-9673ec2a5059
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce0403ed-4781-402d-88bf-4aaf4becce40
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b505f97d-076c-45c4-8baf-e9b14e66bfd7
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_coding_10.admission_date=dim_admission_date.admission_calendar_date
        name: DIM_ADMISSION_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0bd497f8-5363-481d-b4ce-69300aee8e32
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03468a15-ff55-42ed-8cfc-fcc4ef8e69ee
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_MOTHER_OF_PATIENT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7eb53d0-fdf7-475e-8c13-4272dafb30c6
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 350bc75f-8d25-4e5c-9a78-e84a1a272ffb
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_coding_10.discharge_date=dim_discharge_date.discharge_calendar_date
        name: DIM_DISCHARGE_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c029511-0f0d-49cd-8e85-b3e365fdd011
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b19cc18-4ea3-4029-bf21-26276edd9461
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_coding_20.admittype=dim_MOH_admission_type.admission_type_code
        name: DIM_MOH_ADMISSION_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ece3d059-1d23-44cb-81f3-913d83843e5f
                stepCounter: 364dc965-e2be-40db-b284-328a39d4c07c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7cbdac65-d79d-4292-9ef5-c02b7b3f4ca1
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_coding_20.health_specialty_code=dim_MOH_discharge_health_specialty.discharge_health_specialty_code
        name: DIM_MOH_DISCHARGE_HEALTH_SPECIALTY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 806da96f-fb0f-4ba0-8a14-b09c5f7a1274
                stepCounter: 69d376d7-1684-4615-bd7a-05f9e14faa5a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a26373a5-5847-4b83-b4b2-d612be3cc951
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_coding_20.eventtype=dim_MOH_event_type.event_type
        name: DIM_MOH_EVENT_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b7f54e06-90db-4356-85d9-f7938b092e2c
                stepCounter: 6b8fad6b-df0f-406c-90a9-259147eb3fe9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb4c195e-28ea-4bca-87b0-1596b702ec73
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_coding_20.eventendtype=dim_MOH_event_end_type.Event_End_Type_Code
        name: DIM_MOH_EVENT_END_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f3caec7f-57c2-4767-a51f-a827cb57f7e8
                stepCounter: f2522e0c-3a2e-4d57-92a5-41179d44fa82
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c90dc3d5-16dd-4758-a28b-9bcdb36a2207
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: VARCHAR(150)
        defaultValue: ""
        description: ""
        name: LAST_MODIF_USER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1d3a544-369b-4f35-9ec4-02f7f9f8937b
                stepCounter: a832c05d-d821-478c-ae75-b83a2c201fcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f315744b-7914-4c54-9842-127b3efd0b39
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_coding_20.last_modif_user=dim_modify_user_login.modify_user_login_code
        name: DIM_MODIFY_USER_LOGIN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ceaa34a6-dd0b-40fb-bc61-9df93cc05e7b
                stepCounter: bef0768d-dddb-4d02-af8d-03160de42b62
            transform: IFNULL(dim_modify_user_login.dim_modify_user_login_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d090130-3158-4476-bfb5-42a8d969cd0e
          stepCounter: a03e1d58-5881-4567-b376-d36c89a086af
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_IN_PATIENT_CODING_10: a832c05d-d821-478c-ae75-b83a2c201fcc
          DIM_CODED_DATE: 6397a769-4d0d-4397-8be2-8cb876794c81
          DIM_ICD_DIAGNOSIS_CODING: ea944822-7ca8-4640-bfb3-6f41b12d3433
          DIM_ICD_PROCEDURE_CODING: cc82fe0c-7539-4905-913b-1e991cd32882
          DIM_ICD_SUPPLEMENTARY_CODING: 84b95849-04a5-48b6-b6bb-f5b9d2aeb8a5
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_IN_PATIENT_CODING_10
          - locationName: TGT
            nodeName: DIM_CODED_DATE
          - locationName: TGT
            nodeName: DIM_ICD_DIAGNOSIS_CODING
          - locationName: TGT
            nodeName: DIM_ICD_PROCEDURE_CODING
          - locationName: TGT
            nodeName: DIM_ICD_SUPPLEMENTARY_CODING
        join:
          joinCondition: |-
            FROM {{ ref('TGT','S_IN_PATIENT_CODING_10') }}
              LEFT JOIN (
                    SELECT *,
                           row_number() OVER (PARTITION BY purchaser_code ORDER BY dim_purchaser_key DESC)rn
                      FROM dim.[dim_purchaser]
                   ) dim_purchaser
                ON IFNULL(s_in_patient_coding_10.principal_payer,'Unknown') = dim_purchaser.purchaser_code
               AND dim_purchaser.dss_current_flag = 'Y'
               AND rn=1
              LEFT JOIN {{ ref('TGT','DIM_CODED_DATE') }}
                ON IFNULL(cast(s_in_patient_coding_10.coded_date AS date),'1900-01-01') = dim_coded_date.calendar_date
              LEFT OUTER JOIN {{ ref('TGT','DIM_ICD_DIAGNOSIS_CODING') }}
                ON s_in_patient_coding_10.event_encounter_id = dim_ICD_diagnosis_coding.event_encounter_id
               AND dim_ICD_diagnosis_coding.diagnosis_procedure_type = 'D'
              LEFT OUTER JOIN {{ ref('TGT','DIM_ICD_PROCEDURE_CODING') }}
                ON s_in_patient_coding_10.event_encounter_id = dim_ICD_procedure_coding.event_encounter_id
               AND dim_ICD_procedure_coding.diagnosis_procedure_type = 'P'
              LEFT OUTER JOIN {{ ref('TGT','DIM_ICD_SUPPLEMENTARY_CODING') }}
                ON s_in_patient_coding_10.event_encounter_id = dim_ICD_supplementary_coding.event_encounter_id
               AND dim_ICD_supplementary_coding.diagnosis_procedure_type = 'E'
        name: S_IN_PATIENT_CODING_20
        noLinkRefs: []
  name: S_IN_PATIENT_CODING_20
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
