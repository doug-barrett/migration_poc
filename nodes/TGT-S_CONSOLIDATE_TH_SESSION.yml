fileVersion: 1
id: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
name: S_CONSOLIDATE_TH_SESSION
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d6a2a69-3737-4749-8e44-0e7c30cb3565
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: RN
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: row_number() OVER (PARTITION BY theatre_session_reference_no ORDER BY dim_session_specialty_key)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9bae761-a356-42d5-a249-4521bd7f2847
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SURGICAL_THEATRE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84b9f8f9-640c-4ed6-aaaa-77a720d60272
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 098db70c-df2d-41c1-8d8d-72ac8f362e71
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: SESSION_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b54e4c09-0b2b-43a3-8456-dd5e9fdd7763
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d30d905-56a6-49c1-892f-1fa093e04bea
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SESSION_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 87940888-1119-4ad0-8b01-6c9ee886ff31
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e883798d-9946-4d0a-8409-908ee4fac16b
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SESSION_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c1ac55b-4789-4153-a05e-b1a8de1668c8
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6abc14c-9db4-4d5b-90d5-bac16b8a3fd2
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SESSION_CANCELLED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 209ae3af-fa38-4df6-9cc8-ca2e9437cf87
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 08a22efb-89f1-4099-8d9d-4053f2b2676c
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: AM_LONG_DELAY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a7a3503e-beea-4b08-86cf-dff00e40f27a
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39c61f8c-3c03-4450-8ded-6f4f5dd1c660
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: VARCHAR(12)
        defaultValue: ""
        description: ""
        name: FIRST_THEATRE_VISIT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27f1c3c9-8530-411e-9307-8aba63975ac5
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2053c023-52e5-4e27-8c22-5bef914283af
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_BOOKED_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e27ca17-a928-40ac-8026-630283032400
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 357f98c9-81c3-4794-beae-1d70e841c5bd
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_PATIENT_READY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 01dcee84-f1ff-4184-bfd1-abd64d3d6aee
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a2eec14-fec1-40fa-b462-ee3a5eebacdc
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_PATIENT_INTO_THEATRE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d56b851f-2320-4838-aa22-cb712435f5bf
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 520e8a18-48b6-4d80-a28d-7276501a21c0
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: VARCHAR(12)
        defaultValue: ""
        description: ""
        name: LAST_THEATRE_VISIT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b796f9f-18d8-454b-8078-ac4ba85d2b9f
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db1632c5-ba05-4459-9852-c2fd3f55d15b
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_PATIENT_OUT_OF_THEATRE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 93223faf-60d4-452e-a04b-91c14db5caf8
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7a88082-4d43-42c6-bc3a-af5d7fa3b63b
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_PATIENT_INTO_POSTOP_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0dbd685a-9e39-43ac-bdfc-9abf1887943c
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bea71b42-0f62-4468-a22e-3787a9e14230
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_BOOKED_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc373f40-4761-4d43-b502-d434af06dd81
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba0ffe86-f303-4a47-b93a-945232b81239
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CANCELLED_OPERATIONS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c6f2277-3452-4b23-beac-f612180835e7
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b939c299-443e-41a8-91c7-2251703f09d8
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_consolidate_TH_session.session_end_date=dim_session_end_date.session_end_calendar_date
        name: DIM_SESSION_END_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bd56ca11-a688-48ef-9a32-6ea1825341b3
                stepCounter: f1095cf2-b5dc-4b38-85ba-edc3c15ac7b9
            transform: IFNULL(dim_session_end_date_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21e83606-8bdc-4637-9ffd-6922fca65750
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACTUAL_OPERATIONS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ad99258-aed7-415f-a9eb-285c65c79024
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77d120ea-3084-4497-b95b-5d7ba01cc631
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PLANNED_OPERATIONS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 646a7bda-d34d-4600-85b4-7ab04aef940f
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8479cd4a-f12e-4797-8212-a6ea827dd57c
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LISTS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 220da7a0-94be-4cbb-84e2-021ef95012ef
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c06981b-52a9-479d-9a0e-3be0fb9ba3e1
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: ""
        name: KNIFE_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cea34be0-bc5c-4264-a5fc-84f859e153f1
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 73249772-fc82-4929-ab5a-aba16b337a70
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: ""
        name: IN_THEATRE_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 659ee685-5241-423f-a441-fc00e3b83877
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dcfdb406-7424-4ff5-a150-a6e3c1dd087a
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: ""
        name: AVERAGE_TURNAROUND_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f2d73594-c703-4c55-b9de-72a6eeb83bde
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 83f5c135-8e7c-42cb-83a8-65a3304295ad
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: session_duration
        name: SESSION_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2a777ae2-ac9d-44b9-bfc4-7dabd5bedaa9
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 025bb5d1-80dc-407f-aaa1-0d1f79576cc9
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: CR_COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 358b272f-05fb-4652-b0fe-b27ec459abf8
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9daeee2c-795f-40f7-8d43-c686b3b06ba1
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SESSION_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 276e6127-c1ba-4ded-ae59-55c9a21a1cf1
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c893d187-5aeb-47f1-8f9a-c07bd9623bc4
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: SESSION_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39e6b747-3b06-402c-98ac-e113dc999af5
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 93a43c25-3f24-419e-97b1-518392113343
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: session_specialty
        name: SESSION_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8a2b73be-bf8d-4bda-8637-822405862693
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: feab4d00-b506-49f0-94b1-fd6fe1493bd2
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: SESSION_ACUTE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a19e9681-5893-4af8-8b99-8f9619d746aa
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 544ffb05-2c2b-4f17-9637-543338baf978
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_consolidate_TH_session.session_start_date=dim_session_start_date.session_start_calendar_date
        name: DIM_SESSION_START_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c5aa047-0439-4ed1-8b51-8347d511c652
                stepCounter: a7f556fc-e53a-44d8-8e23-aef57f633eaf
            transform: IFNULL(dim_session_start_date_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53064369-0b6c-4678-a54e-3072496ca05e
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_nexus_Session_20.session_status=dim_session_Status_Code.SessionStatusCode
        name: DIM_SESSION_STATUS_CODE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b0f9df6-fbc3-47d3-8384-f44ed6929a9a
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cef4bc31-3992-4674-9ad2-6fc772cc3c16
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_SESSION_SPECIALTY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e558406-3ea4-4062-97fe-866d3b756462
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53ed0624-3a11-43e5-a059-9081f2d05ff2
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_SURGICAL_THEATRE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 569024db-c1f5-45dd-a769-8af72d0c6f87
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8106d2f-496b-4e2d-bfce-7da4d5736add
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_nexus_Session_20.session_change_reason_reference_no=dim_session_change_reason.session_change_reason_reference_no
        name: DIM_SESSION_CHANGE_REASON_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ba59c775-b398-47b1-8ce8-bb6b44409e1a
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5bf2be9e-124c-411c-86fa-8f907df3e116
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_PATIENT_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9da86c04-97d3-488e-bf84-e3bb7dda0b6a
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e1228b7-94bd-44d2-b0a2-07fd5f68ec2b
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_PATIENT_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03a5178c-fe47-436f-b9e8-529e189cb323
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d330680-8d89-405e-9f89-3f76b753f7ce
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_nexus_Session_20.session_change_by_request_reference_no=dim_session_change_request_by.session_change_request_by_reference_no
        name: DIM_SESSION_CHANGE_REQUEST_BY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d7090a9-b65f-4ca5-85d5-de812297192a
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 067e43c9-a4c8-4ad4-81fa-1be2e988b1ea
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_CONSOLIDATE_SESSION_DELAY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b3532d40-702d-4611-9fa3-b93b2e73780e
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02f7fdc4-83ab-48bf-ad79-027684582d17
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: create_date
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c6b6af59-a51f-4d3c-bd44-32641bb10042
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad94b892-3f2d-4cf7-b2c2-8d7430a747e7
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: create_user_login_code
        name: CREATE_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a05bb98-65fa-464f-a96a-482461e1efdd
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6818e865-5916-495f-80c5-b99cd05cf90e
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIFY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e538c3fe-a7dc-4456-ac05-3a039e53eba4
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09a6c82e-7d77-4e0f-8c10-41f185e6b338
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: MODIFY_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a33b2c00-feae-4710-aa8c-733ae22fe962
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7105415-faf3-4e4b-aae5-4ab7c1d1b854
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: actual_session_time
        name: ACTUAL_SESSION_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f6d703b5-7e4e-4530-b6c5-23f8bc48a7ab
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8dbb77b0-11e2-4952-b8b1-8a16122e878e
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: anaesthetic_duration
        name: ANAESTHETIC_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23bd31dc-3cd3-4dd5-8db1-9cede36c2212
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 173980e8-3dcd-41e1-9e73-a6a124c3fa2b
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_PRIMARY_SURGEON_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: df94a626-852e-4ad3-9490-2da4806ecb57
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 449e9e21-42b4-42da-8f28-d4a06afd8119
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_THEATRE_SESSION_ANAESTHETIST_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db394f82-7a38-437c-9078-e7867fc09774
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8503be32-09bf-4148-ba87-ef3f363912cb
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_THEATRE_SESSION_OWNER_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: af844a4f-705a-4853-8d30-549d8da04e07
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b5288d1-4c46-4a50-aec0-9312e77d4d20
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: surgeon_duration
        name: SURGEON_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5484cbaf-cb6c-4bc3-962c-a29f95427670
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 276a8a92-1e5a-4cf2-b2b6-184e7900c262
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: CHAR
        defaultValue: ""
        description: a flag that states if a session is out of hours sessions e.g. sessions schedule to start at 00:00 and end before 08:30, as well as sessions starting from 16:30 and ending at 23:59 sessions.
        name: OUT_OF_HOURS_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 53fec082-3ff0-4e09-a934-e0c48c9429b5
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 978ad6c4-1ee4-409f-884a-3fa346468f9d
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: INT
        defaultValue: ""
        description: 'The diff. in minutes between ‚ÄúIFNULL(first patient ready, first_into_theatre)" and "last patient out of theatre" for a session (excluding early starts and late finishes).  Excluding out of hours sessions  '
        name: SESSION_UTILISATION_NUMERATOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 55e6f867-7b91-4229-aaa2-c75d8a3c5e8d
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53a59d56-8b09-45ac-a572-e2326efa6a0f
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_PRIMARY_ANAESTHETIST_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a382b0d0-1906-48d5-b1e8-3fa3c8a15e99
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d7230f6-2caf-451e-a890-bd7fcfb0b56e
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: INT
        defaultValue: ""
        description: 'Elective - the scheduled theatre session minutes for sessions that have actual operations in them  Acute - the scheduled theatre session minutes for sessions that have actual operations in them.    Some sessions are set up as 00:00 to 23:59.    Can these sessions get their times adjusted to 8:30 am -> 10pm for the purpose of this calculation.  Excluding out of hours sessions  '
        name: SESSION_UTILISATION_DENOMINATOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2342ee9-689f-4871-a2d0-0e4d2ec17e16
                stepCounter: 80133569-fd15-4522-a551-8df9d8c8428c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db6380ec-1104-41e3-86ee-97b6c107bae2
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: ""
        name: THEATRE_SESSION_REFERENCE_NO
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b865977-a0e7-41cf-9dc4-2f609b63a34a
                stepCounter: 2c835a51-ba1f-4dc8-9261-edbbc6b9abb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee702ec9-1006-453f-a444-d2a336d8d2ca
          stepCounter: 7e9faaf5-2f15-45fb-a3ff-4802dd381bdd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_THEATRE_SESSION_20_V: 2c835a51-ba1f-4dc8-9261-edbbc6b9abb9
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_THEATRE_SESSION_20_V
        join:
          joinCondition: FROM {{ ref('TGT','S_THEATRE_SESSION_20_V') }}
        name: S_CONSOLIDATE_TH_SESSION
        noLinkRefs: []
  name: S_CONSOLIDATE_TH_SESSION
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
