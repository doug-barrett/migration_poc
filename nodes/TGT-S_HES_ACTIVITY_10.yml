fileVersion: 1
id: 8f1f159b-0815-44c2-8ea7-8a33da2f1d89
name: S_HES_ACTIVITY_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Starts buidling a HES fact table"
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa330e84-e9f8-4c06-ba04-96f9751ec8cf
          stepCounter: 8f1f159b-0815-44c2-8ea7-8a33da2f1d89
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: HES_ACTIVITY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f8404f3-cfd9-4eb7-a5d0-a39c65d878c0
                stepCounter: c76684d8-a391-40e2-a3f0-7ace35b85ead
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14c30286-b7bf-4696-8f68-190134342dee
          stepCounter: 8f1f159b-0815-44c2-8ea7-8a33da2f1d89
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: HESID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78a78c95-07eb-418f-9a00-2194c70ad966
                stepCounter: c76684d8-a391-40e2-a3f0-7ace35b85ead
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d48d171b-5ce2-4fd2-933f-eeabc77ef981
          stepCounter: 8f1f159b-0815-44c2-8ea7-8a33da2f1d89
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e8f17544-a6e7-4b07-a232-aec3c1304375
                stepCounter: c76684d8-a391-40e2-a3f0-7ace35b85ead
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dfc551ac-59fb-4447-964e-ff4549a9d02f
          stepCounter: 8f1f159b-0815-44c2-8ea7-8a33da2f1d89
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_HES_activity_10.status=dim_HES_status.status_code
        name: DIM_HES_STATUS_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a7d01aa-6f3e-4dda-b6cf-0664f9f4c676
                stepCounter: fc1a6aef-13c9-4fe4-881e-6a7d81cc3e1a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26a44e95-4bf4-422f-af54-2309d9e3679e
          stepCounter: 8f1f159b-0815-44c2-8ea7-8a33da2f1d89
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_HES_activity_10.previous_status=dim_HES_previous_status.status_code
        name: DIM_HES_PREVIOUS_STATUS_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c6e720f-5bf4-4515-8e6d-d580b0f6b87c
                stepCounter: a762189e-759d-48a0-99cd-554c1513b7e1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7536b91-548f-4805-a9b4-866b4ddc6b57
          stepCounter: 8f1f159b-0815-44c2-8ea7-8a33da2f1d89
        config: {}
        dataType: VARCHAR(8000)
        defaultValue: ""
        description: ""
        name: COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ca402b1c-f7b9-4219-8608-6d6d5814433d
                stepCounter: c76684d8-a391-40e2-a3f0-7ace35b85ead
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7eb5f9fe-8fe7-4b0e-b7f0-ac0dd0d559a7
          stepCounter: 8f1f159b-0815-44c2-8ea7-8a33da2f1d89
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5b5a15d9-0cb9-4e07-9c4c-462dadeafd57
                stepCounter: c76684d8-a391-40e2-a3f0-7ace35b85ead
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c7e44da-50a2-4f6e-a656-d1914a86bb3d
          stepCounter: 8f1f159b-0815-44c2-8ea7-8a33da2f1d89
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated key for the date dimension. Nominal format is YYYYMMDD, but DD equal to 0 and greater than 31 permited for special date handling.
        name: DIM_START_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4e465c3-6432-4578-b9e4-7938382edf1c
                stepCounter: b5d2a386-b1bd-4a43-9c5e-529fea37aabc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6577fd63-2817-4e5d-a424-6e461608bf05
          stepCounter: 8f1f159b-0815-44c2-8ea7-8a33da2f1d89
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: EDIT_USER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8211656c-62ae-4c13-923b-9c1ead9e388a
                stepCounter: c76684d8-a391-40e2-a3f0-7ace35b85ead
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a022801-a18c-4b70-88aa-a329b36cda67
          stepCounter: 8f1f159b-0815-44c2-8ea7-8a33da2f1d89
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: EDIT_USER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: af741512-b7a5-4ba4-87ae-49c261c0e3ab
                stepCounter: c76684d8-a391-40e2-a3f0-7ace35b85ead
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 99f77153-7df8-4c0d-a6b3-99a7dba7dcc0
          stepCounter: 8f1f159b-0815-44c2-8ea7-8a33da2f1d89
        config: {}
        dataType: TEXT
        defaultValue: ""
        description: ""
        name: PREVIOUS_HESID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bb0f4c24-fd3a-46ed-8ca7-dc04604fa828
                stepCounter: c76684d8-a391-40e2-a3f0-7ace35b85ead
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80ab7ab4-42ea-4911-8a29-99f9261c93b4
          stepCounter: 8f1f159b-0815-44c2-8ea7-8a33da2f1d89
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PREVIOUS_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0524c0dc-eec8-4a0a-b360-b6a1ea795383
                stepCounter: c76684d8-a391-40e2-a3f0-7ace35b85ead
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd522887-43d3-4b2d-adaf-f42772ead967
          stepCounter: 8f1f159b-0815-44c2-8ea7-8a33da2f1d89
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PRIORITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4de05292-094a-4a9a-a15e-73ee890a2bf7
                stepCounter: c76684d8-a391-40e2-a3f0-7ace35b85ead
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f984fa38-22c4-4c32-909d-dd481e9ce934
          stepCounter: 8f1f159b-0815-44c2-8ea7-8a33da2f1d89
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_HES_activity_10.priority=dim_HES_priority.priority
        name: DIM_HES_PRIORITY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 371ac592-dbe7-4fb4-a416-afe8078d73b9
                stepCounter: a86188be-17a6-4447-ac9c-f12287f58bef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a23a758-c3fe-4dba-9617-fdfdba0867fd
          stepCounter: 8f1f159b-0815-44c2-8ea7-8a33da2f1d89
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: REFERRAL_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3ecb20bc-d4d3-46a9-af54-050cf5648dba
                stepCounter: c76684d8-a391-40e2-a3f0-7ace35b85ead
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 08dbb5ea-7167-4994-b2ac-92accb1e9e71
          stepCounter: 8f1f159b-0815-44c2-8ea7-8a33da2f1d89
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_CVDIS_HES_ACTIVITY
        join:
          joinCondition: |-
            FROM ds_cvdis_HES_activity
              JOIN dim.dim_start_date
                ON cast(ds_cvdis_HES_activity.sDate AS date) = dim_start_date.start_calendar_date
             WHERE ds_cvdis_HES_activity.sdate > CONVERT(datetime, @v_pa_HES_incremental, 120)
        name: S_HES_ACTIVITY_10
        noLinkRefs: []
  name: S_HES_ACTIVITY_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
