fileVersion: 1
id: ae198099-9d8b-4fa2-8f8d-1194c82a3161
name: S_SUPPORT_PLAN_NASC_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7fe032a2-d903-4b33-91b2-1d158ace1fad
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: CONTACT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 858f817e-b65b-40cb-a92e-371d91100641
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86259dde-31d1-4d88-9af6-bdccba658e68
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: CONTACT_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'NA'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cbce6bdb-a1e5-4bb0-ac18-679c5f70cf37
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: TASK_REQUEST_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8281d50f-9f5d-4a1b-bd23-f4a290899a34
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96891edf-c9a1-460f-9677-300eb05e2f0f
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: patient_programme id
        name: PROGRAMME_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a0bd06e-5434-419e-90c7-fb5ec8d66ee2
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26d041bd-48d2-4db2-b9f8-c829f2cae79d
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: patient_programme status
        name: PROGRAMME_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ac8a1cf-1a95-4eb6-8780-75de64bc9181
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: IFNULL(s_support_plan_NASC_v.programme_status,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 10a240c1-ffae-406e-8dfa-a838834c41b2
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 96e151fb-69b9-40dd-a9d7-aa2e702edcda
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d2c8e60-2bb8-49e5-8884-56361e9ad59f
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: TASK_DESC
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 940189ed-ed59-4bca-a915-8cbe83479d78
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f4d0042d-63bd-4fd5-9aef-e32e86e360c2
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: HEALTH_ORG_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d5533bdf-3f02-4cbb-99bf-7576696c9645
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ad06faf-b6db-4684-ad03-1c78f6a7a508
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SEEN_BY_CLINICIAN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c1a5872-83f2-4d46-a933-9076843955fe
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: |-
              CASE WHEN ISNUMERIC(s_support_plan_NASC_v.seen_by_clinician_id) = 0 THEN s_support_plan_NASC_v.seen_by_clinician_id
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 442ebaf1-f4f1-4fd0-9c7f-be3d7af3e307
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SEEN_BY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c1a5872-83f2-4d46-a933-9076843955fe
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: |-
              CASE WHEN ISNUMERIC(s_support_plan_NASC_v.seen_by_clinician_id) = 1 THEN s_support_plan_NASC_v.seen_by_clinician_id
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d17958f8-12fb-487c-856b-e475a2c5dbe8
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 87d0e5ac-2af1-4bdb-8f80-4339433cc305
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc774361-7fe4-40a0-8592-28658741401a
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: HOSPITAL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1620d22-c9c7-4cdd-bf00-744982e3f606
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 225a7675-b6f7-4922-b2ee-e5d5660ac919
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PROVIDER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b8bbcda8-64a5-4d45-9cba-707986a4fb8a
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eabfac0b-7385-4962-ad23-c983efe87967
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PROVIDER_ROLE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4334673d-e220-4c06-bb10-726981b5f97a
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7414e82b-0e79-44a3-85d5-78f7f05cedbb
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PROGRAMME_ROLE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a0b3f703-4e4d-4b0f-bf3b-811af4c61ce4
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f02296ea-b0d4-44bf-bc32-318eda0b3e8a
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: DEPARTMENT_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d788f13-a646-4910-9c25-9a645fe4a4f6
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7b75f08-cba0-47ea-bcb9-0883679be938
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SERVICE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 159e34a9-2c35-4dd6-82d9-9ad52fbe3912
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1288de86-07dc-4c66-947a-54740d89408a
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: TASK_REQUEST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6aad72b-4994-4140-add1-d6872ea6d326
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7c0a45a-a210-40cb-ab50-a6d8c58a45f4
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: EPISODE_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 31cf76c1-6482-473a-abf2-4778ebfa3c0c
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a6f443a-fa17-4972-9e25-0f0c3c0e7dd0
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: NASC_SERVICE_ATO_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a84a47f-b164-45da-9031-d49b074a5616
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: IFNULL(s_support_plan_NASC_v.NASC_service_ATO_id,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d13cb4b-309d-47c0-85f5-ac8248161179
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SERVICE_GAPS_ATO_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ff974243-b13b-4ef2-beaa-bf773a79965c
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: IFNULL(s_support_plan_NASC_v.service_gaps_ATO_id,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bc684df6-2057-469c-966e-697037550d81
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: RESIDENTIAL_PLACEMENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4011bf7f-b1b7-4b13-b88f-3b6c41159178
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: |-
              CASE s_support_plan_NASC_v.residential_placement_ind
                          WHEN 'Yes'                                      THEN 'Y'
                          WHEN 'No'                                       THEN 'N'
                          ELSE ''
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49a75fca-4605-42f6-839f-aec3ec7900ce
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: RESIDENTIAL_PLACEMENT_REASON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7605c915-9250-475d-9629-39822e8d391d
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: IFNULL(s_support_plan_NASC_v.residential_placement_reason,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8f25e1e-27a2-4d8a-8eab-2be8ffb110c1
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PLACEMENT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 49e02eb6-681e-4532-a2b4-a45e8a4c3207
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: IFNULL(s_support_plan_NASC_v.placement_type,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b9d92395-3e11-41dc-abd7-c8dd826608dc
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PLACEMENT_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e7162e6-f882-46d4-99ab-8bc318ea51e9
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: IFNULL(s_support_plan_NASC_v.placement_source,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ae45db2-32ba-41ae-8934-2aa163d701fe
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: OUTCOME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a44cad6d-34d2-478b-87b9-565d2edd69a2
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: IFNULL(s_support_plan_NASC_v.outcome,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41e0f32c-ec5e-49c3-bb55-15981b6ab5a4
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PLAN_COMPLETED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: edbb232a-f22b-4b2a-b62e-144637271f4b
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 90396630-e7da-4d6e-9b70-4251d57af233
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REVIEW_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 147a6af9-4fa8-4908-986e-f04c3f2e6c17
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: |-
              CASE WHEN ISDATE(s_support_plan_NASC_v.review_date) = 1 THEN CONVERT(datetime,s_support_plan_NASC_v.review_date)
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f88c177-bdf5-44db-9c0e-1825e37b6acc
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: REVIEW_DATE_CHAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 147a6af9-4fa8-4908-986e-f04c3f2e6c17
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: left(CASE WHEN ISDATE(s_support_plan_NASC_v.review_date) = 0 THEN s_support_plan_NASC_v.review_date ELSE NULL END,20)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27b84bee-3113-446c-aa1d-e249bd134d05
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: REVIEW_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7abbc9f-ad41-48f2-8544-043065b9898d
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: IFNULL(s_support_plan_NASC_v.review_type,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4f2b130-2b51-458a-9d44-bf4990eea178
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: EXIT_REASON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d9a292f1-f13b-478a-a482-c350fb879840
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: IFNULL(s_support_plan_NASC_v.exit_reason,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 200f712e-7a64-4564-b140-9b4a1fbbf5ee
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: EXIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fdbae57f-cdee-4812-ac10-f4981ee4ac2e
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3cd48719-3d8b-4b0a-9f04-a1677632d149
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SCID_MIGRATED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e63529ff-80e0-4aa1-ac32-2d97288e1b90
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 327f4dad-7dcc-4307-a93c-8e467f386796
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: TRANSFER_OUT_RESIDENTIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dfcda69a-a0ae-4111-974a-3ab656fce470
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: IFNULL(s_support_plan_NASC_v.transfer_out_residential,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75066c58-c22a-4c83-8216-a3d38ed20eef
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: TRANSFER_OUT_DHB
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 35971b9d-ded4-4852-8d29-a2aee2b12c32
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: IFNULL(s_support_plan_NASC_v.transfer_out_DHB,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39995dfc-2472-4c0f-a5b2-3bc3fbe5be05
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: TRANSFER_INTERNAL_NASC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1715b31c-df66-4ff5-9139-0d72ec9a1776
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: IFNULL(s_support_plan_NASC_v.transfer_internal_NASC,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03edab92-e714-48d0-b2a2-54e2bfe94b87
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: OBSERVATION_REPORT_DUE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ca5a6a9-5f73-49d8-acb2-05c7e8425587
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eddb0e1f-659d-48b6-be00-6f3a161ad166
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: OBSERVATION_REPORT_COMPLETION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec61cdef-ebd2-47c1-b49d-f1be4223bb66
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb440e8b-52d6-45e2-90c3-06756314aabc
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: OBSERVATION_REPORT_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a5461f04-1a3e-4aaf-80e3-c20c0f7c9592
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: IFNULL(s_support_plan_NASC_v.observation_report_status,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 512d7a6d-5246-40c4-9a7a-3791bbb60480
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_SUPPORT_PLAN_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6aad72b-4994-4140-add1-d6872ea6d326
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: ROW_NUMBER() OVER (PARTITION BY s_support_plan_NASC_v.patient_NHI ORDER BY s_support_plan_NASC_v.task_request_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f0fb5d7-72ba-40d2-93bf-090a6e5ac4c6
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_SUPPORT_PLAN_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 96e151fb-69b9-40dd-a9d7-aa2e702edcda
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: COUNT(1) OVER (PARTITION BY s_support_plan_NASC_v.patient_NHI)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40582cfe-f829-43b8-bb31-50ee83fab7b1
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_SUPPORT_PLAN_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6aad72b-4994-4140-add1-d6872ea6d326
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: ROW_NUMBER() OVER (PARTITION BY s_support_plan_NASC_v.referral_encounter_id ORDER BY s_support_plan_NASC_v.task_request_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 08b307a6-7862-4a8e-aaff-7225bebed522
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_SUPPORT_PLAN_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 87d0e5ac-2af1-4bdb-8f80-4339433cc305
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: COUNT(1) OVER (PARTITION BY s_support_plan_NASC_v.referral_encounter_id)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 467e0986-85e3-4b01-a5f3-6598b82f2f13
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a5030852-3379-45f1-a795-1918217a26f5
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba1c38f1-af4e-4844-8e8c-ec221a63f1b8
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb40091c-92d3-491e-b690-527477363577
                stepCounter: adc780a1-aeaf-471c-8eb5-a2407e4da337
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef5c96bd-499c-4f3f-8ea3-5dfe7640a59b
          stepCounter: ae198099-9d8b-4fa2-8f8d-1194c82a3161
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_SUPPORT_PLAN_NASC_V
        join:
          joinCondition: FROM s_support_plan_NASC_v
        name: S_SUPPORT_PLAN_NASC_10
        noLinkRefs: []
  name: S_SUPPORT_PLAN_NASC_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
