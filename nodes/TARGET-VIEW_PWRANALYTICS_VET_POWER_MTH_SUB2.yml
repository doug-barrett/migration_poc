fileVersion: 1
id: d2e176fb-f1de-4929-9340-09ed96269b91
name: VIEW_PWRANALYTICS_VET_POWER_MTH_SUB2
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b6e08e2-a786-4a38-b056-b0bddbf4bfe0
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: VARCHAR(13)
        defaultValue: ""
        description: ""
        name: COUNTRY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6419b2f4-2017-4f7f-8d21-230cc3a2cea2
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: VARCHAR(12)
        defaultValue: ""
        description: ""
        name: PROVINCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d1ed6dd-0391-47b7-9ac8-e651a8d5265b
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: VARCHAR(14)
        defaultValue: ""
        description: ""
        name: LANGUAGE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c304e5fe-5908-45b8-9d5d-7a19bf33390a
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: CURRENCY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9740e788-11e9-4aaa-ad3d-36a5524ff59c
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: VARCHAR(24)
        defaultValue: ""
        description: ""
        name: UTILITY_PROVIDER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ad3eb7f-e549-47e7-b5f8-80f86eb3b41d
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: NUMBER(38,0)
        defaultValue: ""
        description: ""
        name: INVOICE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a4cc338-2122-43a1-a87d-1cdb25221187
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: ACCOUNT_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 931ffeec-e893-4e60-a62d-8a6ef76fcc93
                stepCounter: 35e8a248-3036-4082-9634-0324abcb2e94
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31bfa72e-16a6-4448-b7fa-210f6f3c18a1
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: DELIVERY_POINT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c565d365-4b75-4944-89b4-56ad2104c50f
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: CONSUMPTION_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 960e4e95-463a-444e-ac13-5dc79d4127d4
                stepCounter: 35e8a248-3036-4082-9634-0324abcb2e94
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55ec30dd-887b-4c3e-8fe1-89cbd726136d
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: METER_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 209eee1c-c447-46ef-9115-312bb05f2ee3
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: COST_CENTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 988b980d-4fa3-4f48-9e85-9b2a107e86a2
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 534cd6d2-630a-4a2c-b19c-b7bb2a6a197e
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: TOTAL_CONSUMPTION_KWH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1373be9f-7b84-4618-bb93-aa8c350fdd2f
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PEAK_CONSUMPTION_KWH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42e7dc8f-3c59-4c95-bc92-e435b5163565
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OFF_PEAK_CONSUMPTION_KWH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 28042ece-869c-4820-bd22-81f2408727f0
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: REGISTERED_DEMAND_KVA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aeca9420-1854-400c-8c6b-8961c8d78ea8
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BILLED_DEMAND_KVA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c569e8d5-e24e-4657-b74a-a6b416fe1cae
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CURRENT_METER_READ_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cffc72bd-9f71-416e-9bc0-489ce0fc7a88
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: CURRENT_METER_READ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 932f33a9-02a6-4588-9693-d73226d9880a
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: PREVIOUS_METER_READ_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: abcb1840-47b7-49b0-96ea-5a3cc757e868
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PREVIOUS_METER_READ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4bc943c5-f70f-414e-9ea0-f80d7b890500
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: TOTAL_AMOUNT_DUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e99c3d9c-ef96-4964-95a0-ba08e6d8789d
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: SUBTOTAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d1991df9-2399-49d1-bd82-abdee1e0a10f
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: ENERGY_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a0d21df9-61b9-4549-b3bb-d9ae82ce9c17
                stepCounter: 35e8a248-3036-4082-9634-0324abcb2e94
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 76d7f247-d9b5-47b7-9d7c-3c9973a130e2
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PEAK_ENERGY_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0935d5fa-5f10-4ba5-8e63-3008f3943861
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OFF_PEAK_ENERGY_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6dbe8e0a-1c0a-46c8-80ce-7dde28b84ff0
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BASIC_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e96aa413-768a-4fef-809c-6ee1c80f9f56
                stepCounter: 35e8a248-3036-4082-9634-0324abcb2e94
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47867021-0531-4ead-8c27-5ce567bd02e9
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: DEMAND_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a0b295e8-b238-4b64-9e4b-9b81fde7e5e0
                stepCounter: 35e8a248-3036-4082-9634-0324abcb2e94
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 909cc54a-f34d-4567-90db-c5ef90638637
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: REACTIVE_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e4949476-5ba7-4049-bae2-679a3235d0a9
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: TRANSMISSION_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2abc4aae-b59d-4cda-901f-1d3d6c592eb0
                stepCounter: 35e8a248-3036-4082-9634-0324abcb2e94
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 46b4fcc2-37da-4752-b5e8-16d8732ec5df
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OTHER_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6d64996-aa25-4ad6-b730-3f508df22b78
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: SERVICE_ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f38052f4-18be-4ee3-835b-65233d8ec7d6
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: CARBON_TAX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6fd0359-c97b-4b7c-9582-2adffae95cba
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: CARBON_TAX_GST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 002f2847-21a3-4705-afba-4d7202723929
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: FEDERAL_TAX_GST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 752ee293-636f-4423-a765-43f27277a7a9
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb1956af-896a-4bd3-9d45-a4d492362970
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: MST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2969a76a-f947-49f9-a081-8891f3f32e98
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: VAT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b694dcc0-f2ec-4d4a-a45c-81d4b9afdb70
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: METER_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb7e4988-735a-4c72-8181-45494cb17e03
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BILL_MULTIPLIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34217977-557f-4c35-ac44-b12e4dc2a982
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae00b243-2e19-45fa-bde9-0d01ac0cca82
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: POWER_FACTOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1fe4bb63-4204-4a79-92de-ad9af7bf98d3
                stepCounter: 35e8a248-3036-4082-9634-0324abcb2e94
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f1d1a13-1f5b-47b6-ab6c-a6551d9f74dd
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PEAK_DEMAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b1a4e14-fe11-43ac-8270-d7fcaab72cc4
          stepCounter: d2e176fb-f1de-4929-9340-09ed96269b91
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BILL_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_PWRANALYTICS_VET_POWER_MTH_SUB2: d2e176fb-f1de-4929-9340-09ed96269b91
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_PWRANALYTICS_VET_POWER_MTH_SUB2') }} AS WITH PW2 AS (
                    SELECT 'United States' AS Country ,
                           '' AS Province ,
                           'English' AS LANGUAGE ,
                           'USD' AS Currency ,
                           'Powder River Energy Corp' AS Utility_Provider ,
                           cast(0 AS VARCHAR(255)) AS Invoice_Number ,
                           cast(cast(ACCOUNT_NUMBER AS bigint) AS varchar(225)) AS Account_Number ,
                           cast(cast(ACCOUNT_NUMBER AS bigint) AS varchar(225)) AS Delivery_Point ,
                           cast(CONSUMPTION_MONTH AS date) AS Consumption_Month ,
                           cast(METER_NUMBER AS varchar(100)) AS Meter_Number ,
                           cast('' AS varchar(100)) AS Cost_Center ,
                           cast('' AS varchar(100)) AS Area ,
                           cast(CONSUMPTION_KWH AS float) AS Total_Consumption_kWh ,
                           cast(0 AS float) AS Peak_Consumption_kWh ,
                           cast(0 AS float) AS Off_Peak_Consumption_kWh ,
                           cast(0 AS float) AS Registered_Demand_kVA ,
                           cast(DEMAND_KVA AS float) AS Billed_Demand_kVA ,
                           TRY_TO_DATE(TRIM(RIGHT(READ_DATES, 8), '- '), 'MM/DD/YY') AS Current_Meter_Read_Date ,
                           cast(CURRENT_READ AS int) AS Current_Meter_Read ,
                           TRY_TO_DATE(TRIM(LEFT(READ_DATES, 8), '- '), 'MM/DD/YY') AS Previous_Meter_Read_Date ,
                           cast(PREVIOUS_READ AS int) AS Previous_Meter_Read ,
                           cast(TOTAL_COST AS float) AS Total_Amount_Due ,
                           cast(ENERGY_COST AS float)+cast(BASIC_COST AS float)+cast(TRANSMISSION_COST AS float)+cast(DEMAND_COST AS float)+cast(ADJUSTCHG AS float) +cast(FEDERAL_TAX AS float) AS Subtotal ,
                           cast(ENERGY_COST AS float) AS Energy_Cost ,
                           cast(0 AS float) AS Peak_Energy_Cost ,
                           cast(0 AS float) AS Off_Peak_Energy_Cost ,
                           cast(BASIC_COST AS float) AS Basic_Cost ,
                           cast(DEMAND_COST AS float) AS Demand_Cost ,
                           cast(0 AS float) AS Reactive_Cost ,
                           cast(TRANSMISSION_COST AS float) AS Transmission_Cost ,
                           cast(ADJUSTCHG AS float) AS Other_Cost ,
                           cast((CASE WHEN SERVICE_LOCATION like 'ANDERSON 43-72-12A-1H' THEN 'ANDERSON 43-72-12A-1H' WHEN SERVICE_LOCATION like 'ANDERSON 43-72-12D-1-1PH' THEN 'ANDERSON 43-72-12D-1-1PH' WHEN SERVICE_LOCATION like 'BLACK GROWLER 12-27' THEN 'Black Growler 12-27' WHEN SERVICE_LOCATION like 'CASTLE 3-21TH' THEN 'Castle 3-21TH' WHEN SERVICE_LOCATION like 'CHITTENDEN 44-71-28C-1H' THEN 'CHITTENDEN 44-71-28C-1H' WHEN SERVICE_LOCATION like 'CHU 199 I' THEN 'CHU 199i' WHEN SERVICE_LOCATION like 'CHU 4-1' THEN 'CHU 4-1 Water Source' WHEN SERVICE_LOCATION like 'CHU BATTERY 1-1' THEN 'CHU 1-1 Water Source' WHEN SERVICE_LOCATION like 'DOROUGH 44-71-21A-1H' THEN 'DOROUGH 44-71-21A-1H' WHEN SERVICE_LOCATION like 'ELLBOGEN 44-71-4B-1H' THEN 'ELLBOGEN 44-71-4B-1H' WHEN SERVICE_LOCATION like 'FLEISCHMAN 44-71-14B-23-1H' THEN 'FLEISCHMAN 44-71-14B-23-1H' WHEN SERVICE_LOCATION like 'FLOCCHINI 44-72-7B-8-1PH' THEN 'FLOCCHINI 44-72-7B-8-1PH' WHEN SERVICE_LOCATION like 'GU 31' THEN 'GU 031' WHEN SERVICE_LOCATION like 'HEINKE 44-71-2C-35-1H WELL/ TANK BATTERY' THEN 'HEINKE 43-71-2C-35-1H' WHEN SERVICE_LOCATION like 'JASON 1 5' THEN 'Jayson Unit 1-5' WHEN SERVICE_LOCATION like 'JASON 1-2' THEN 'Jayson Unit 1-2' WHEN SERVICE_LOCATION like 'JASON UNIT 2 1' THEN 'Jayson Unit 2-1' WHEN SERVICE_LOCATION like 'LEADBETTER 43-71-7B-1H' THEN 'LEADBETTER 43-71-7B-1H' WHEN SERVICE_LOCATION like 'LEADBETTER 43-71-7D-6-2H' THEN 'LEADBETTER 43-71-7D-6-2H' WHEN SERVICE_LOCATION like 'NAPIER 44-71-22D-15-1H WELL & TANK BATT' THEN 'NAPIER 44-71-22D-15-1H' WHEN SERVICE_LOCATION like 'RENO 43-71-8B-17-2H' THEN 'RENO 43-71-8B-17-2H' WHEN SERVICE_LOCATION like 'USA 43-71-4A-9-2 TH' THEN 'USA 43-71-4A-9-2TH' ELSE SERVICE_LOCATION END) AS varchar) AS Service_Address ,
                           cast(0 AS float)AS Carbon_Tax ,
                           cast(0 AS float)AS Carbon_Tax_GST ,
                           cast(FEDERAL_TAX AS float) AS Federal_Tax_GST ,
                           cast(0 AS float) AS PST ,
                           cast(0 AS float) AS MST ,
                           cast(0 AS float) AS VAT ,
                           cast('' AS varchar(100)) AS Meter_Type ,
                           cast(MULTIPLIER AS int) AS Bill_Multiplier ,
                           cast('' AS varchar(100)) AS Rate ,
                           cast(POWER_FACTOR AS float) AS Power_Factor ,
                           cast(0 AS float) AS Peak_Demand ,
                           cast(0 AS int) AS Bill_Days
                      FROM DS_POWER.USBU_PREC
                 UNION ALL SELECT 'Germany' AS Country ,
                           '' AS Province ,
                           'German/English' AS LANGUAGE ,
                           'EUR' AS Currency ,
                           'Enercity' AS Utility_Provider ,
                           CAST(Rechnungsnummer AS VARCHAR(255)) AS Invoice_Number ,
                           CAST(Kundennummer AS VARCHAR(255)) AS Account_Number ,
                           cast(CAST(IFNULL(Marktlokation,0) AS bigint) AS nvarchar(225)) AS Delivery_Point ,
                           DATEFROMPARTS(year(Abrechnungszeitraum), MONTH (Abrechnungszeitraum), 01)AS Consumption_Month ,
                           CAST(Zahlernummer AS nvarchar(50)) AS Meter_Number ,
                           CAST('' AS nvarchar(50)) AS Cost_Center ,
                           CAST('' AS nvarchar(50)) AS Area ,
                           CAST((IFNULL(Verbrauch_Wirkarbeit_HT,0) + IFNULL(Verbrauch_Wirkarbeit_NT,0)) AS float) AS Total_Consumption_kWh ,
                           CAST(Verbrauch_Wirkarbeit_HT AS float) AS Peak_Consumption_kWh ,
                           CAST(Verbrauch_Wirkarbeit_NT AS float) AS Off_Peak_Consumption_kWh ,
                           Leistung AS Registered_Demand_kVA ,
                           CAST(0 AS float) AS Billed_Demand_kVA ,
                           CAST(NULL AS datetime) AS Current_Meter_Read_Date ,
                           CAST(0 AS int) AS Current_Meter_Read ,
                           CAST(NULL AS datetime) AS Previous_Meter_Read_Date ,
                           CAST(0 AS int) AS Previous_Meter_Read ,
                           Restbetrag_einschlieblich_Umsatzsteuer AS Total_Amount_Due ,
                           Nettobetrag AS Subtotal ,
                           CAST(Betrag_Kauf_Spotmarktmenge AS float) AS Energy_Cost ,
                           CAST(Netzentgelt_Leistungspreis AS float) AS Peak_Energy_Cost ,
                           CAST(Netzentgelt_Arbeitspreis_Wirkstrom AS float) AS Off_Peak_Energy_Cost ,
                           CAST(Messstellenbetrieb_Netznutzung AS float) AS Basic_Cost ,
                           CAST(Dienstleistungspreis AS float) AS Demand_Cost ,
                           CAST(NaturOption AS float) AS Reactive_Cost ,
                           CAST(Offshore_Umlage AS float) AS Transmission_Cost ,
                           (CAST(Entlastungsbetrag_Preisbremse AS float)+ CAST(Umlage_aus_KWK AS float)+ CAST(StromNEV_Umlage_Zone AS float)+ CAST(Konzessionsabgabe AS float)+ CAST(Telefonanschluss AS float)) AS Other_Cost ,
                           CAST(Verbrauchsstelle AS nvarchar(50)) AS Service_Address ,
                           CAST(Stromsteuer AS float)AS Carbon_Tax ,
                           CAST(0 AS float)AS Carbon_Tax_GST ,
                           CAST(0 AS float) AS Federal_Tax_GST ,
                           CAST(0 AS float) AS PST ,
                           CAST(0 AS float) AS MST ,
                           CAST(Summe_Umsatzsteuer AS float) AS VAT ,
                           CAST('' AS nvarchar(50)) AS Meter_Type ,
                           CAST(0 AS int) AS Bill_Multiplier ,
                           CAST('' AS nvarchar(100)) AS Rate ,
                           CAST(0 AS float) AS Power_Factor ,
                           CAST(0 AS float) AS Peak_Demand ,
                           CAST(0 AS int) AS Bill_Days
                      FROM DS_POWER.GBU_ENERCITY
                 UNION ALL SELECT 'NETHERLANDS' AS Country ,
                           '' AS Province ,
                           'Dutch' AS LANGUAGE ,
                           'EURO' AS Currency ,
                           'Vattenfall' AS Utility_Provider ,
                           CAST(INVOICE AS VARCHAR(255)) AS Invoice_Number ,
                           cast(CAST(CONTRACTREKENIG AS bigint) AS varchar(255)) AS Account_Number ,
                           CAST(EANcode AS varchar) AS Delivery_Point ,
                           CAST(Factuurdatum AS date) AS Consumption_Month ,
                           CAST(EANcode AS varchar) AS Meter_Number ,
                           CAST(CC_NUM AS varchar) AS Cost_Center ,
                           CAST('' AS varchar) AS Area ,
                           Verbruik AS Total_Consumption_kWh ,
                           Verbruik_piekuren_on_peak_Consumption AS Peak_Consumption_kWh ,
                           Verbruik_daluren_off_peak_Consumption AS Off_Peak_Consumption_kWh ,
                           CAST(0 AS float) AS Registered_Demand_kVA ,
                           CAST(0 AS float) AS Billed_Demand_kVA ,
                           CAST(EindLeveringsperiode AS datetime) AS Current_Meter_Read_Date ,
                           CAST(0 AS int) AS Current_Meter_Read ,
                           CAST(BeginLeveringsperiode AS datetime) AS Previous_Meter_Read_Date ,
                           CAST(0 AS int) AS Previous_Meter_Read ,
                           BedragincluBTW AS Total_Amount_Due ,
                           BedragexclBTW AS Subtotal ,
                           CAST(Voorschot_Elektriciteit_Levering+Voorschot_Netbeheer AS float) AS Energy_Cost ,
                           CAST(Voorschot_Elektriciteit_Levering AS float) AS Peak_Energy_Cost ,
                           CAST(Voorschot_Netbeheer AS float) AS Off_Peak_Energy_Cost ,
                           CAST(0 AS float) AS Basic_Cost ,
                           CAST(IFNULL(ENERGIEBELASTING_EB,0) AS float) AS Demand_Cost ,
                           CAST(0 AS float) AS Reactive_Cost ,
                           CAST(IFNULL(OPSLAG_DUURZAME_ENERGIE_ODE,0) AS float) AS Transmission_Cost ,
                           CAST(IFNULL(Energy_Rebate_Subtotal_EB_vermindering,0) AS float) AS Other_Cost ,
                           CAST(SERVICE_ADDRESS AS varchar) AS Service_Address ,
                           CAST(0 AS float)AS Carbon_Tax ,
                           CAST(0 AS float)AS Carbon_Tax_GST ,
                           CAST(0 AS float) AS Federal_Tax_GST ,
                           CAST(0 AS float) AS PST ,
                           CAST(0 AS float) AS MST ,
                           CAST(0 AS float) AS VAT -- Type 1 is Basic and TYPE 2 is Smart ---
             ,
                           CASE WHEN Verbruik IS NULL THEN 'Basic'
                                ELSE 'Smart'
                                 END AS Meter_Type ,
                           CAST(0 AS int) AS Bill_Multiplier ,
                           CAST('' AS varchar) AS Rate ,
                           CAST(0 AS float) AS Power_Factor ,
                           CAST(0 AS float) AS Peak_Demand ,
                           CAST(30 AS int) AS Bill_Days ---Certificaten van Oorsprong is ignored in Subtotal ---

                      FROM DS_POWER.NBU_VATTENFALL
                 UNION ALL SELECT 'France' AS Country ,
                           '' AS Province ,
                           'French/English' AS LANGUAGE ,
                           'EUR' AS Currency ,
                           '' AS Utility_Provider ,
                           cast(NUM_FACTURE AS VARCHAR(255)) AS Invoice_Number ,
                           cast(cast(REF_ACHEMINEMENT AS bigint)AS varchar(225)) AS Account_Number ,
                           cast(cast(REF_ACHEMINEMENT AS bigint)AS varchar(225)) AS Delivery_Point ,
                           DATEFROMPARTS(year(cast(DATE_DE_FIN_DE_CONSOMMATION AS date)),month(cast(DATE_DE_FIN_DE_CONSOMMATION AS date)),01) AS Consumption_Month ,
                           cast('' AS varchar(100)) AS Meter_Number ,
                           cast('' AS varchar(100)) AS Cost_Center ,
                           cast('' AS varchar(100)) AS Area ,
                           cast(0 AS float) AS Total_Consumption_kWh ,
                           cast(0 AS float) AS Peak_Consumption_kWh ,
                           cast(0 AS float) AS Off_Peak_Consumption_kWh ,
                           cast(0 AS float) AS Registered_Demand_kVA ,
                           cast(0 AS float) AS Billed_Demand_kVA ,
                           cast(NULL AS datetime) AS Current_Meter_Read_Date ,
                           cast(0 AS int) AS Current_Meter_Read ,
                           cast(NULL AS datetime) AS Previous_Meter_Read_Date ,
                           cast(0 AS int) AS Previous_Meter_Read ,
                           cast(0 AS float) AS Total_Amount_Due ,
                           cast(0 AS float) AS Subtotal ,
                           cast(0 AS float) AS Energy_Cost ,
                           cast(0 AS float) AS Peak_Energy_Cost ,
                           cast(0 AS float) AS Off_Peak_Energy_Cost ,
                           cast(0 AS float) AS Basic_Cost ,
                           cast(0.0 AS float) AS Demand_Cost ,
                           cast(0 AS float) AS Reactive_Cost ,
                           cast(0 AS float) AS Transmission_Cost ,
                           cast(0 AS float) AS Other_Cost ,
                           cast('' AS varchar(100)) AS Service_Address ,
                           cast(0 AS float)AS Carbon_Tax ,
                           cast(0 AS float)AS Carbon_Tax_GST ,
                           cast(0 AS float) AS Federal_Tax_GST ,
                           cast(0 AS float) AS PST ,
                           cast(0 AS float) AS MST ,
                           cast(0 AS float) AS VAT ,
                           cast('' AS varchar(100)) AS Meter_Type ,
                           cast(0 AS int) AS Bill_Multiplier ,
                           cast('' AS varchar(100)) AS Rate ,
                           cast(0 AS float) AS Power_Factor ,
                           cast(0 AS float) AS Peak_Demand ,
                           cast(0 AS int) AS Bill_Days
                      FROM DS_POWER.FBU_EDF
                   ) SELECT *
              FROM PW2
        dependencies:
          - locationName: TARGET
            nodeName: ODS_PWRANALYTICS_USBU_PREC
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_PWRANALYTICS_USBU_PREC') }}
        name: VIEW_PWRANALYTICS_VET_POWER_MTH_SUB2
        noLinkRefs: []
  name: VIEW_PWRANALYTICS_VET_POWER_MTH_SUB2
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
