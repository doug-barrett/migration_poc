fileVersion: 1
id: 239c601d-e21e-4be9-9cca-858f5013645f
name: VIEW_PWRANALYTICS_VET_POWER_MTH_SUB2
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 210790ef-613c-44c6-ae02-c94baafbea40
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: VARCHAR(13)
        defaultValue: ""
        description: ""
        name: COUNTRY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db08580f-4d32-4cb4-9d94-5b33887610ba
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: VARCHAR(12)
        defaultValue: ""
        description: ""
        name: PROVINCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3974983a-3aed-48db-baaa-d7d91148f066
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: VARCHAR(14)
        defaultValue: ""
        description: ""
        name: LANGUAGE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c746a31a-335a-45f8-ae7c-87f62a0b8c07
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: CURRENCY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2b07cf2-495c-40b6-9591-d5e13b5d8dc0
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: VARCHAR(24)
        defaultValue: ""
        description: ""
        name: UTILITY_PROVIDER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29a51084-edf0-4f5b-8a0f-8da482302302
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: NUMBER(38,0)
        defaultValue: ""
        description: ""
        name: INVOICE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8411119-f98f-4a69-a069-9b5bd7b1c9f2
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: ACCOUNT_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 20de2128-7de2-43b1-b9a3-2181af48d1cb
                stepCounter: c0247743-51cd-46b7-a254-8eacf88bfc98
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66cee8a7-2780-474e-81f4-c064296241b4
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: DELIVERY_POINT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21e4f0aa-ee2d-42fa-96c1-19666fd65c21
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: CONSUMPTION_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f0aa0471-57a5-4b91-9c3d-0ea00854d148
                stepCounter: c0247743-51cd-46b7-a254-8eacf88bfc98
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 603b92d8-e5bb-42ab-9103-a03b9bfe507e
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: METER_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7db0c0f-ba62-4f76-bab3-7d25dc6bd70c
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: COST_CENTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 043c6f26-21ee-45b5-8044-399d88d73c66
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6655a0b5-3cd2-4ce7-abe2-be2dff86911d
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: TOTAL_CONSUMPTION_KWH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 283ed824-dfdb-4878-866f-4da49c1b01da
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PEAK_CONSUMPTION_KWH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6b19e7f-5a4b-4f07-a7a0-c59641ae2b8e
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OFF_PEAK_CONSUMPTION_KWH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 414b2881-ab41-4b09-9dd0-4352df954654
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: REGISTERED_DEMAND_KVA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ca94264-c32f-4107-a3fd-a0b43a0bfc54
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BILLED_DEMAND_KVA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ee67922-cf4a-48db-8564-966a2139e330
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CURRENT_METER_READ_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1261f278-1206-4dfe-90be-7c310f0dc87f
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: CURRENT_METER_READ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f8ad152b-0d46-4648-a640-97c95179ca99
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: PREVIOUS_METER_READ_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bc06dbf0-80c1-43c5-853c-12ba9b30d981
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PREVIOUS_METER_READ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 334cf08a-75f3-4b8c-92b9-6b0710aabb11
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: TOTAL_AMOUNT_DUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6147a7e4-d3af-4f55-8405-067c7cea179f
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: SUBTOTAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 90607e99-2b4f-4030-bb10-017b8848c3c3
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: ENERGY_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 95d26362-1e74-4691-af16-c99c3a0b5569
                stepCounter: c0247743-51cd-46b7-a254-8eacf88bfc98
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: acf49873-33c5-4753-8c95-000cb1380c7b
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PEAK_ENERGY_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34b8113c-74ad-4015-95e3-2b0448780515
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OFF_PEAK_ENERGY_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 10e490ac-0045-4893-9cad-dec3bad9896f
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BASIC_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5377811e-dc8d-44d8-bff8-e79913cbbcbf
                stepCounter: c0247743-51cd-46b7-a254-8eacf88bfc98
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2fbaf85-31ae-4ec3-9d45-67f4b13a6cb1
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: DEMAND_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5cecb907-49a3-4bf3-995f-fd72a8b21ff9
                stepCounter: c0247743-51cd-46b7-a254-8eacf88bfc98
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16e5a318-312c-4789-8b6b-5d7e9d5d69ff
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: REACTIVE_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07c77cc5-f039-4096-b26d-7f6c77ab6e3c
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: TRANSMISSION_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8a3b283f-b651-4fc7-adef-632d7768e17f
                stepCounter: c0247743-51cd-46b7-a254-8eacf88bfc98
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bad5e0ea-4ac9-4a8a-89e4-9041b167d1da
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OTHER_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f117356-47aa-44e1-a57e-ac4143294bb6
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: SERVICE_ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eced5a99-2f83-4c81-80c6-7a2807ae4db1
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: CARBON_TAX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6a4e922-0eb8-46a3-8261-4984f39d0056
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: CARBON_TAX_GST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48f97762-3cee-47d0-bb33-4af6709c4d2f
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: FEDERAL_TAX_GST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80ced8e1-50c9-426d-b045-00998a264547
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee5f777b-8bde-4cfa-90f1-95e9587fa39e
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: MST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d34b903-421e-44af-a8cc-4b0c839947d8
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: VAT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d0c620a-3a5f-48d9-892b-960673e58d8d
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: METER_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05431ddc-e898-4116-865a-4ff5d7bb6986
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BILL_MULTIPLIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f4d70fe-3eea-4a8c-8833-496c676b50d6
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64a1aef6-72ee-4641-8376-86ba2d4aa59c
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: POWER_FACTOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab5d7bdf-8e3b-438c-82dc-88155c717167
                stepCounter: c0247743-51cd-46b7-a254-8eacf88bfc98
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c5eede2-5b34-404e-94b7-e668c73fc926
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PEAK_DEMAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11907c92-24d9-4516-a433-62e7282619f5
          stepCounter: 239c601d-e21e-4be9-9cca-858f5013645f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BILL_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_PWRANALYTICS_VET_POWER_MTH_SUB2: 239c601d-e21e-4be9-9cca-858f5013645f
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_PWRANALYTICS_VET_POWER_MTH_SUB2') }} AS WITH PW2 AS (
                    SELECT 'United States' AS Country ,
                           '' AS Province ,
                           'English' AS LANGUAGE ,
                           'USD' AS Currency ,
                           'Powder River Energy Corp' AS Utility_Provider ,
                           cast(0 AS VARCHAR(255)) AS Invoice_Number ,
                           cast(cast(ACCOUNT_NUMBER AS bigint) AS varchar(225)) AS Account_Number ,
                           cast(cast(ACCOUNT_NUMBER AS bigint) AS varchar(225)) AS Delivery_Point ,
                           cast(CONSUMPTION_MONTH AS date) AS Consumption_Month ,
                           cast(METER_NUMBER AS varchar(100)) AS Meter_Number ,
                           cast('' AS varchar(100)) AS Cost_Center ,
                           cast('' AS varchar(100)) AS Area ,
                           cast(CONSUMPTION_KWH AS float) AS Total_Consumption_kWh ,
                           cast(0 AS float) AS Peak_Consumption_kWh ,
                           cast(0 AS float) AS Off_Peak_Consumption_kWh ,
                           cast(0 AS float) AS Registered_Demand_kVA ,
                           cast(DEMAND_KVA AS float) AS Billed_Demand_kVA ,
                           TRY_TO_DATE(TRIM(RIGHT(READ_DATES, 8), '- '), 'MM/DD/YY') AS Current_Meter_Read_Date ,
                           cast(CURRENT_READ AS int) AS Current_Meter_Read ,
                           TRY_TO_DATE(TRIM(LEFT(READ_DATES, 8), '- '), 'MM/DD/YY') AS Previous_Meter_Read_Date ,
                           cast(PREVIOUS_READ AS int) AS Previous_Meter_Read ,
                           cast(TOTAL_COST AS float) AS Total_Amount_Due ,
                           cast(ENERGY_COST AS float)+cast(BASIC_COST AS float)+cast(TRANSMISSION_COST AS float)+cast(DEMAND_COST AS float)+cast(ADJUSTCHG AS float) +cast(FEDERAL_TAX AS float) AS Subtotal ,
                           cast(ENERGY_COST AS float) AS Energy_Cost ,
                           cast(0 AS float) AS Peak_Energy_Cost ,
                           cast(0 AS float) AS Off_Peak_Energy_Cost ,
                           cast(BASIC_COST AS float) AS Basic_Cost ,
                           cast(DEMAND_COST AS float) AS Demand_Cost ,
                           cast(0 AS float) AS Reactive_Cost ,
                           cast(TRANSMISSION_COST AS float) AS Transmission_Cost ,
                           cast(ADJUSTCHG AS float) AS Other_Cost ,
                           cast((CASE WHEN SERVICE_LOCATION like 'ANDERSON 43-72-12A-1H' THEN 'ANDERSON 43-72-12A-1H' WHEN SERVICE_LOCATION like 'ANDERSON 43-72-12D-1-1PH' THEN 'ANDERSON 43-72-12D-1-1PH' WHEN SERVICE_LOCATION like 'BLACK GROWLER 12-27' THEN 'Black Growler 12-27' WHEN SERVICE_LOCATION like 'CASTLE 3-21TH' THEN 'Castle 3-21TH' WHEN SERVICE_LOCATION like 'CHITTENDEN 44-71-28C-1H' THEN 'CHITTENDEN 44-71-28C-1H' WHEN SERVICE_LOCATION like 'CHU 199 I' THEN 'CHU 199i' WHEN SERVICE_LOCATION like 'CHU 4-1' THEN 'CHU 4-1 Water Source' WHEN SERVICE_LOCATION like 'CHU BATTERY 1-1' THEN 'CHU 1-1 Water Source' WHEN SERVICE_LOCATION like 'DOROUGH 44-71-21A-1H' THEN 'DOROUGH 44-71-21A-1H' WHEN SERVICE_LOCATION like 'ELLBOGEN 44-71-4B-1H' THEN 'ELLBOGEN 44-71-4B-1H' WHEN SERVICE_LOCATION like 'FLEISCHMAN 44-71-14B-23-1H' THEN 'FLEISCHMAN 44-71-14B-23-1H' WHEN SERVICE_LOCATION like 'FLOCCHINI 44-72-7B-8-1PH' THEN 'FLOCCHINI 44-72-7B-8-1PH' WHEN SERVICE_LOCATION like 'GU 31' THEN 'GU 031' WHEN SERVICE_LOCATION like 'HEINKE 44-71-2C-35-1H WELL/ TANK BATTERY' THEN 'HEINKE 43-71-2C-35-1H' WHEN SERVICE_LOCATION like 'JASON 1 5' THEN 'Jayson Unit 1-5' WHEN SERVICE_LOCATION like 'JASON 1-2' THEN 'Jayson Unit 1-2' WHEN SERVICE_LOCATION like 'JASON UNIT 2 1' THEN 'Jayson Unit 2-1' WHEN SERVICE_LOCATION like 'LEADBETTER 43-71-7B-1H' THEN 'LEADBETTER 43-71-7B-1H' WHEN SERVICE_LOCATION like 'LEADBETTER 43-71-7D-6-2H' THEN 'LEADBETTER 43-71-7D-6-2H' WHEN SERVICE_LOCATION like 'NAPIER 44-71-22D-15-1H WELL & TANK BATT' THEN 'NAPIER 44-71-22D-15-1H' WHEN SERVICE_LOCATION like 'RENO 43-71-8B-17-2H' THEN 'RENO 43-71-8B-17-2H' WHEN SERVICE_LOCATION like 'USA 43-71-4A-9-2 TH' THEN 'USA 43-71-4A-9-2TH' ELSE SERVICE_LOCATION END) AS varchar) AS Service_Address ,
                           cast(0 AS float)AS Carbon_Tax ,
                           cast(0 AS float)AS Carbon_Tax_GST ,
                           cast(FEDERAL_TAX AS float) AS Federal_Tax_GST ,
                           cast(0 AS float) AS PST ,
                           cast(0 AS float) AS MST ,
                           cast(0 AS float) AS VAT ,
                           cast('' AS varchar(100)) AS Meter_Type ,
                           cast(MULTIPLIER AS int) AS Bill_Multiplier ,
                           cast('' AS varchar(100)) AS Rate ,
                           cast(POWER_FACTOR AS float) AS Power_Factor ,
                           cast(0 AS float) AS Peak_Demand ,
                           cast(0 AS int) AS Bill_Days
                      FROM DS_POWER.USBU_PREC
                 UNION ALL SELECT 'Germany' AS Country ,
                           '' AS Province ,
                           'German/English' AS LANGUAGE ,
                           'EUR' AS Currency ,
                           'Enercity' AS Utility_Provider ,
                           CAST(Rechnungsnummer AS VARCHAR(255)) AS Invoice_Number ,
                           CAST(Kundennummer AS VARCHAR(255)) AS Account_Number ,
                           cast(CAST(IFNULL(Marktlokation,0) AS bigint) AS nvarchar(225)) AS Delivery_Point ,
                           DATEFROMPARTS(year(Abrechnungszeitraum), MONTH (Abrechnungszeitraum), 01)AS Consumption_Month ,
                           CAST(Zahlernummer AS nvarchar(50)) AS Meter_Number ,
                           CAST('' AS nvarchar(50)) AS Cost_Center ,
                           CAST('' AS nvarchar(50)) AS Area ,
                           CAST((IFNULL(Verbrauch_Wirkarbeit_HT,0) + IFNULL(Verbrauch_Wirkarbeit_NT,0)) AS float) AS Total_Consumption_kWh ,
                           CAST(Verbrauch_Wirkarbeit_HT AS float) AS Peak_Consumption_kWh ,
                           CAST(Verbrauch_Wirkarbeit_NT AS float) AS Off_Peak_Consumption_kWh ,
                           Leistung AS Registered_Demand_kVA ,
                           CAST(0 AS float) AS Billed_Demand_kVA ,
                           CAST(NULL AS datetime) AS Current_Meter_Read_Date ,
                           CAST(0 AS int) AS Current_Meter_Read ,
                           CAST(NULL AS datetime) AS Previous_Meter_Read_Date ,
                           CAST(0 AS int) AS Previous_Meter_Read ,
                           Restbetrag_einschlieblich_Umsatzsteuer AS Total_Amount_Due ,
                           Nettobetrag AS Subtotal ,
                           CAST(Betrag_Kauf_Spotmarktmenge AS float) AS Energy_Cost ,
                           CAST(Netzentgelt_Leistungspreis AS float) AS Peak_Energy_Cost ,
                           CAST(Netzentgelt_Arbeitspreis_Wirkstrom AS float) AS Off_Peak_Energy_Cost ,
                           CAST(Messstellenbetrieb_Netznutzung AS float) AS Basic_Cost ,
                           CAST(Dienstleistungspreis AS float) AS Demand_Cost ,
                           CAST(NaturOption AS float) AS Reactive_Cost ,
                           CAST(Offshore_Umlage AS float) AS Transmission_Cost ,
                           (CAST(Entlastungsbetrag_Preisbremse AS float)+ CAST(Umlage_aus_KWK AS float)+ CAST(StromNEV_Umlage_Zone AS float)+ CAST(Konzessionsabgabe AS float)+ CAST(Telefonanschluss AS float)) AS Other_Cost ,
                           CAST(Verbrauchsstelle AS nvarchar(50)) AS Service_Address ,
                           CAST(Stromsteuer AS float)AS Carbon_Tax ,
                           CAST(0 AS float)AS Carbon_Tax_GST ,
                           CAST(0 AS float) AS Federal_Tax_GST ,
                           CAST(0 AS float) AS PST ,
                           CAST(0 AS float) AS MST ,
                           CAST(Summe_Umsatzsteuer AS float) AS VAT ,
                           CAST('' AS nvarchar(50)) AS Meter_Type ,
                           CAST(0 AS int) AS Bill_Multiplier ,
                           CAST('' AS nvarchar(100)) AS Rate ,
                           CAST(0 AS float) AS Power_Factor ,
                           CAST(0 AS float) AS Peak_Demand ,
                           CAST(0 AS int) AS Bill_Days
                      FROM DS_POWER.GBU_ENERCITY
                 UNION ALL SELECT 'NETHERLANDS' AS Country ,
                           '' AS Province ,
                           'Dutch' AS LANGUAGE ,
                           'EURO' AS Currency ,
                           'Vattenfall' AS Utility_Provider ,
                           CAST(INVOICE AS VARCHAR(255)) AS Invoice_Number ,
                           cast(CAST(CONTRACTREKENIG AS bigint) AS varchar(255)) AS Account_Number ,
                           CAST(EANcode AS varchar) AS Delivery_Point ,
                           CAST(Factuurdatum AS date) AS Consumption_Month ,
                           CAST(EANcode AS varchar) AS Meter_Number ,
                           CAST(CC_NUM AS varchar) AS Cost_Center ,
                           CAST('' AS varchar) AS Area ,
                           Verbruik AS Total_Consumption_kWh ,
                           Verbruik_piekuren_on_peak_Consumption AS Peak_Consumption_kWh ,
                           Verbruik_daluren_off_peak_Consumption AS Off_Peak_Consumption_kWh ,
                           CAST(0 AS float) AS Registered_Demand_kVA ,
                           CAST(0 AS float) AS Billed_Demand_kVA ,
                           CAST(EindLeveringsperiode AS datetime) AS Current_Meter_Read_Date ,
                           CAST(0 AS int) AS Current_Meter_Read ,
                           CAST(BeginLeveringsperiode AS datetime) AS Previous_Meter_Read_Date ,
                           CAST(0 AS int) AS Previous_Meter_Read ,
                           BedragincluBTW AS Total_Amount_Due ,
                           BedragexclBTW AS Subtotal ,
                           CAST(Voorschot_Elektriciteit_Levering+Voorschot_Netbeheer AS float) AS Energy_Cost ,
                           CAST(Voorschot_Elektriciteit_Levering AS float) AS Peak_Energy_Cost ,
                           CAST(Voorschot_Netbeheer AS float) AS Off_Peak_Energy_Cost ,
                           CAST(0 AS float) AS Basic_Cost ,
                           CAST(IFNULL(ENERGIEBELASTING_EB,0) AS float) AS Demand_Cost ,
                           CAST(0 AS float) AS Reactive_Cost ,
                           CAST(IFNULL(OPSLAG_DUURZAME_ENERGIE_ODE,0) AS float) AS Transmission_Cost ,
                           CAST(IFNULL(Energy_Rebate_Subtotal_EB_vermindering,0) AS float) AS Other_Cost ,
                           CAST(SERVICE_ADDRESS AS varchar) AS Service_Address ,
                           CAST(0 AS float)AS Carbon_Tax ,
                           CAST(0 AS float)AS Carbon_Tax_GST ,
                           CAST(0 AS float) AS Federal_Tax_GST ,
                           CAST(0 AS float) AS PST ,
                           CAST(0 AS float) AS MST ,
                           CAST(0 AS float) AS VAT -- Type 1 is Basic and TYPE 2 is Smart ---
             ,
                           CASE WHEN Verbruik IS NULL THEN 'Basic'
                                ELSE 'Smart'
                                 END AS Meter_Type ,
                           CAST(0 AS int) AS Bill_Multiplier ,
                           CAST('' AS varchar) AS Rate ,
                           CAST(0 AS float) AS Power_Factor ,
                           CAST(0 AS float) AS Peak_Demand ,
                           CAST(30 AS int) AS Bill_Days ---Certificaten van Oorsprong is ignored in Subtotal ---

                      FROM DS_POWER.NBU_VATTENFALL
                 UNION ALL SELECT 'France' AS Country ,
                           '' AS Province ,
                           'French/English' AS LANGUAGE ,
                           'EUR' AS Currency ,
                           '' AS Utility_Provider ,
                           cast(NUM_FACTURE AS VARCHAR(255)) AS Invoice_Number ,
                           cast(cast(REF_ACHEMINEMENT AS bigint)AS varchar(225)) AS Account_Number ,
                           cast(cast(REF_ACHEMINEMENT AS bigint)AS varchar(225)) AS Delivery_Point ,
                           DATEFROMPARTS(year(cast(DATE_DE_FIN_DE_CONSOMMATION AS date)),month(cast(DATE_DE_FIN_DE_CONSOMMATION AS date)),01) AS Consumption_Month ,
                           cast('' AS varchar(100)) AS Meter_Number ,
                           cast('' AS varchar(100)) AS Cost_Center ,
                           cast('' AS varchar(100)) AS Area ,
                           cast(0 AS float) AS Total_Consumption_kWh ,
                           cast(0 AS float) AS Peak_Consumption_kWh ,
                           cast(0 AS float) AS Off_Peak_Consumption_kWh ,
                           cast(0 AS float) AS Registered_Demand_kVA ,
                           cast(0 AS float) AS Billed_Demand_kVA ,
                           cast(NULL AS datetime) AS Current_Meter_Read_Date ,
                           cast(0 AS int) AS Current_Meter_Read ,
                           cast(NULL AS datetime) AS Previous_Meter_Read_Date ,
                           cast(0 AS int) AS Previous_Meter_Read ,
                           cast(0 AS float) AS Total_Amount_Due ,
                           cast(0 AS float) AS Subtotal ,
                           cast(0 AS float) AS Energy_Cost ,
                           cast(0 AS float) AS Peak_Energy_Cost ,
                           cast(0 AS float) AS Off_Peak_Energy_Cost ,
                           cast(0 AS float) AS Basic_Cost ,
                           cast(0.0 AS float) AS Demand_Cost ,
                           cast(0 AS float) AS Reactive_Cost ,
                           cast(0 AS float) AS Transmission_Cost ,
                           cast(0 AS float) AS Other_Cost ,
                           cast('' AS varchar(100)) AS Service_Address ,
                           cast(0 AS float)AS Carbon_Tax ,
                           cast(0 AS float)AS Carbon_Tax_GST ,
                           cast(0 AS float) AS Federal_Tax_GST ,
                           cast(0 AS float) AS PST ,
                           cast(0 AS float) AS MST ,
                           cast(0 AS float) AS VAT ,
                           cast('' AS varchar(100)) AS Meter_Type ,
                           cast(0 AS int) AS Bill_Multiplier ,
                           cast('' AS varchar(100)) AS Rate ,
                           cast(0 AS float) AS Power_Factor ,
                           cast(0 AS float) AS Peak_Demand ,
                           cast(0 AS int) AS Bill_Days
                      FROM DS_POWER.FBU_EDF
                   ) SELECT *
              FROM PW2
        dependencies:
          - locationName: TARGET
            nodeName: ODS_PWRANALYTICS_USBU_PREC
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_PWRANALYTICS_USBU_PREC') }}
        name: VIEW_PWRANALYTICS_VET_POWER_MTH_SUB2
        noLinkRefs: []
  name: VIEW_PWRANALYTICS_VET_POWER_MTH_SUB2
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
