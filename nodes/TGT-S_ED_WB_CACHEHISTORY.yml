fileVersion: 1
id: 8ac69b4c-4a2a-4f8a-b9de-04aa425a1af3
name: S_ED_WB_CACHEHISTORY
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa7ac489-2b04-429f-b8de-e3f74ebcc2c2
          stepCounter: 8ac69b4c-4a2a-4f8a-b9de-04aa425a1af3
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ENCOUNTERNUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 71fa8b02-5822-43bc-836f-489148525fe7
                stepCounter: ae31da5f-d6ce-4409-8325-8589631b2317
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54589344-7802-4c05-982d-f5ba8225c213
          stepCounter: 8ac69b4c-4a2a-4f8a-b9de-04aa425a1af3
        config: {}
        dataType: VARCHAR(512)
        defaultValue: ""
        description: ""
        name: PRESENTINGCOMPLAINT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a735903c-c796-4a52-9f7a-050a6dd383d8
                stepCounter: ae31da5f-d6ce-4409-8325-8589631b2317
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4cdb3826-6e51-4f89-a76b-a6fab9d05705
          stepCounter: 8ac69b4c-4a2a-4f8a-b9de-04aa425a1af3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ARRIVEDDTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bae6c515-0514-4e00-acd1-9a082b16ec44
                stepCounter: ae31da5f-d6ce-4409-8325-8589631b2317
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b564c8eb-1ec9-4cf0-888b-41f8be832c98
          stepCounter: 8ac69b4c-4a2a-4f8a-b9de-04aa425a1af3
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SPECIALTYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b987155b-4a9c-4bdd-a7e1-b62355a8846f
                stepCounter: ae31da5f-d6ce-4409-8325-8589631b2317
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31cf32ab-fcd4-4278-b5c8-2fc731597c95
          stepCounter: 8ac69b4c-4a2a-4f8a-b9de-04aa425a1af3
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LOCATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 749f5df4-7328-439f-939c-af2a43fd459e
                stepCounter: ae31da5f-d6ce-4409-8325-8589631b2317
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4d83743-b616-4b7d-b0fa-b69abb4f5aaa
          stepCounter: 8ac69b4c-4a2a-4f8a-b9de-04aa425a1af3
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CLINIC_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9fc67941-27cd-4f47-b8f2-3614a6023586
                stepCounter: ae31da5f-d6ce-4409-8325-8589631b2317
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 475c9774-fcac-4186-9b27-070c41c0f21c
          stepCounter: 8ac69b4c-4a2a-4f8a-b9de-04aa425a1af3
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: TRIAGECATEGORY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 477ad28d-73d3-44bf-9f8f-e234523dbee6
                stepCounter: ae31da5f-d6ce-4409-8325-8589631b2317
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27fc81e8-050e-42f3-860b-87535af5f1c4
          stepCounter: 8ac69b4c-4a2a-4f8a-b9de-04aa425a1af3
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: STAYREFERENCENUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c24bf83c-5e38-4ed3-99e7-3c5ba9d23494
                stepCounter: ae31da5f-d6ce-4409-8325-8589631b2317
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3084cff0-2b04-4274-b2f1-169921dbb203
          stepCounter: 8ac69b4c-4a2a-4f8a-b9de-04aa425a1af3
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CURRENTSTATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d1cd3a50-235a-4509-88a5-d1810f6e4d77
                stepCounter: ae31da5f-d6ce-4409-8325-8589631b2317
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb992478-c01b-4118-b0cc-9780d6ff49fc
          stepCounter: 8ac69b4c-4a2a-4f8a-b9de-04aa425a1af3
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: BEDREQUESTSTATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33e257da-8be8-4948-a57d-1fa3e0302c25
                stepCounter: ae31da5f-d6ce-4409-8325-8589631b2317
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d6cc9f8-caa0-4d07-9f8d-c07e4efed295
          stepCounter: 8ac69b4c-4a2a-4f8a-b9de-04aa425a1af3
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ASSIGNEDDOCTORID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6669c84e-55e7-4ff8-a804-14fc2ea66f01
                stepCounter: ae31da5f-d6ce-4409-8325-8589631b2317
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c14fc320-5033-4650-ad79-e6d81d8b5fce
          stepCounter: 8ac69b4c-4a2a-4f8a-b9de-04aa425a1af3
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ASSIGNEDNURSEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de19b585-a8c4-4ac7-b14b-535fa5e97a6c
                stepCounter: ae31da5f-d6ce-4409-8325-8589631b2317
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 44a2dda5-5fd7-4c20-95e5-06efdafcccca
          stepCounter: 8ac69b4c-4a2a-4f8a-b9de-04aa425a1af3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DOCTORSEENBYDTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 238d3195-58fb-4ca4-af60-7a002ae41e8f
                stepCounter: ae31da5f-d6ce-4409-8325-8589631b2317
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dfdba31a-317b-48dd-9e67-7a81e9a1e123
          stepCounter: 8ac69b4c-4a2a-4f8a-b9de-04aa425a1af3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NURSESEENBYDTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb84c548-1264-49ff-88fa-733d50e3b506
                stepCounter: ae31da5f-d6ce-4409-8325-8589631b2317
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2cfb543-fcf1-4ec5-a9ff-a3c52305f327
          stepCounter: 8ac69b4c-4a2a-4f8a-b9de-04aa425a1af3
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TREATMENTPROTOCOLID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bdac097c-3d4e-4dd0-85d9-e33ed6ccf71b
                stepCounter: ae31da5f-d6ce-4409-8325-8589631b2317
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98b98fbf-0481-4358-8800-f2450e38550f
          stepCounter: 8ac69b4c-4a2a-4f8a-b9de-04aa425a1af3
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: DISCHARGETYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 769ea308-6353-46cb-bedd-ec47dbd8a591
                stepCounter: ae31da5f-d6ce-4409-8325-8589631b2317
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 30b89e8b-0e5f-4da2-8152-61f802702702
          stepCounter: 8ac69b4c-4a2a-4f8a-b9de-04aa425a1af3
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: DISCHARGECLINICIANID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb93f7fd-b4d6-4716-aa8d-03d5e4bf4c86
                stepCounter: ae31da5f-d6ce-4409-8325-8589631b2317
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47e14f36-15d0-481f-89f8-42886f566def
          stepCounter: 8ac69b4c-4a2a-4f8a-b9de-04aa425a1af3
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DISCHARGECLINICIANTYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 740e1465-9703-4468-b17c-f4ee58f9698c
                stepCounter: ae31da5f-d6ce-4409-8325-8589631b2317
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8805a344-c100-45fc-aa53-275f872e28a0
          stepCounter: 8ac69b4c-4a2a-4f8a-b9de-04aa425a1af3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MEDICALDISCHARGEDTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75d675c0-a282-4249-8e16-27003122f3b0
                stepCounter: ae31da5f-d6ce-4409-8325-8589631b2317
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78a59f09-c555-4d56-95e7-b41a29544e73
          stepCounter: 8ac69b4c-4a2a-4f8a-b9de-04aa425a1af3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SITEDEPARTEDDTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 89337810-c715-4375-8944-6f2fc5ce627e
                stepCounter: ae31da5f-d6ce-4409-8325-8589631b2317
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df422ea8-dc49-460e-9a5c-d042a3f81e27
          stepCounter: 8ac69b4c-4a2a-4f8a-b9de-04aa425a1af3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_WB_CACHEHISTORY
        join:
          joinCondition: |-
            FROM ds_WB_CacheHistory
             WHERE encounternumber + CONVERT(varchar,transactiondttm) IN (
                    SELECT MAX(encounternumber + CONVERT(varchar,transactiondttm))
                      FROM ds_WB_CacheHistory
                     WHERE encounternumber IS NOT NULL
                     GROUP BY encounternumber
                   )
        name: S_ED_WB_CACHEHISTORY
        noLinkRefs: []
  name: S_ED_WB_CACHEHISTORY
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
