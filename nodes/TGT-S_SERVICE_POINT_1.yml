fileVersion: 1
id: 3996776c-8783-4100-b740-2e180bb6ff64
name: S_SERVICE_POINT_1
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Stage-1 of the Service Point data to include Specialty and Professional Carer Data"
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1595be3a-8fcc-490e-9a66-0a21994c6a59
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Service_Point_Reference_Number
        name: SERVICE_POINT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f70bc995-b904-4041-904c-60f8e1b466d0
                stepCounter: 00ad68b8-b3a1-4406-bae4-ef41c7c67d56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 555c8b09-3607-4465-bdf7-02aa8afd8e74
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Service_Point_Code
        name: SERVICE_POINT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 20c651f3-cfd0-4a61-9f08-7f606e3055a0
                stepCounter: 00ad68b8-b3a1-4406-bae4-ef41c7c67d56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e17fed63-2aab-436f-b658-e569e3f8e5a3
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: Service_Point_Name
        name: SERVICE_POINT_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c27d187-751e-48ba-910f-943c6cedb2b9
                stepCounter: 00ad68b8-b3a1-4406-bae4-ef41c7c67d56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69e0e9e9-627f-4bb5-a72f-8b528fd4468d
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Service_Point_Description
        name: SERVICE_POINT_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3fc9decd-4dd6-4aff-a0d1-24d06cf28c93
                stepCounter: 00ad68b8-b3a1-4406-bae4-ef41c7c67d56
            transform: IFNULL(ds_pims_service_points.description,'N/A')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a0a4b5f-ee10-4de8-89bf-1cd244ac274b
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Service_Point_Type_Reference_Number
        name: SERVICE_POINT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3ce7862e-e4b3-4d45-a91b-c6a9f440379d
                stepCounter: 00ad68b8-b3a1-4406-bae4-ef41c7c67d56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db057860-047c-4b37-ade4-8195c2d0af76
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: Service_Point_Type_Code
        name: SERVICE_POINT_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f8df97c8-a6ea-4f49-b6c4-282eed458553
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: Service_Point_Type_Description
        name: SERVICE_POINT_TYPE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IFNULL(ds_pims_reference_values1.description,'N/A')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ccc4354-dbd0-4ec3-9b54-2c5e95b318f9
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Health_Org_Reference_Number
        name: HEALTH_ORG_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b243f09c-d35b-4038-afce-09826c82c7ef
                stepCounter: 00ad68b8-b3a1-4406-bae4-ef41c7c67d56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0bb3c144-0ab0-45ec-a0a7-594cb34f2532
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Health_Org_Parent_Reference_Number
        name: HEALTH_ORG_PARENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ab37c1a-f88b-48ef-ae88-1c1d716e903b
                stepCounter: 4f45d370-f46b-4d30-8837-83a353835394
            transform: IFNULL(ds_pims_health_organisations.parnt_refno,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6963130a-7bbf-4602-8ad8-69c720379331
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Health_Org_Code
        name: HEALTH_ORG_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4ef5551-f136-424e-8175-4eda8e012f1e
                stepCounter: 4f45d370-f46b-4d30-8837-83a353835394
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3acccfb4-8e7f-41ff-844b-ba2e328db959
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Health_Org_Description
        name: HEALTH_ORG_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94cef180-84bd-4860-90c1-5c9f2654d5f0
                stepCounter: 4f45d370-f46b-4d30-8837-83a353835394
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8cc777a3-db3d-4efc-932b-5ce6a19c0746
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Health_Org_Type_Reference_Number
        name: HEALTH_ORG_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07a44630-f416-4357-a479-6e4f93af1803
                stepCounter: 4f45d370-f46b-4d30-8837-83a353835394
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 361121eb-05ce-4498-9b3c-7560e13b464c
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: Health_Org_Type_Code
        name: HEALTH_ORG_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d0562abd-119f-45be-9c77-e2b13835dfc8
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: Health_Org_Type_Description
        name: HEALTH_ORG_TYPE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3fe75d9-a1b4-4b17-bb77-ff4e5d02bf3d
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: PIMS Specialty_Reference_Number
        name: SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3312c343-d0ad-4a13-8238-56de94c3689e
                stepCounter: 00ad68b8-b3a1-4406-bae4-ef41c7c67d56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0f35657-5af5-4542-99a7-f999a716405e
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Specialty code.
        name: SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 599a368d-d53f-4343-92c1-d52acc0f5b36
                stepCounter: ac3ba691-d98e-4eaf-90fd-8ead76242a08
            transform: IFNULL(ds_pims_specialties.main_ident,'N/A')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f2cbbaa-2bfc-4226-9298-12fac9d09c7c
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Specialty_Description
        name: SPECIALTY_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 915b6b35-ef51-4003-b4a1-28656fd210f5
                stepCounter: ac3ba691-d98e-4eaf-90fd-8ead76242a08
            transform: IFNULL(ds_pims_specialties.description,'N/A')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd82fc55-2e0a-461b-8f40-34cf6c66d05b
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Professional_Carer_Reference_Number
        name: PROFESSIONAL_CARER_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2e14b61-7e05-4c33-823f-b4abc5fc97ae
                stepCounter: 00ad68b8-b3a1-4406-bae4-ef41c7c67d56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 785ba7f2-f3c1-4bda-8b02-8680c718d7df
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Professional_Carer_Code
        name: PROFESSIONAL_CARER_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02370e0f-eb58-45d0-a9a5-c2b7ac3886a1
                stepCounter: d42ee6db-29e1-4d7b-88a3-e45c058528e1
            transform: IFNULL(ds_pims_prof_carers.main_ident,'N/A')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09536b2f-494b-42ed-97d2-7b8a94f894dc
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: VARCHAR(60)
        defaultValue: ""
        description: Professional_Carer_Name
        name: PROFESSIONAL_CARER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: IFNULL(LTRIM(ds_pims_prof_carers.forename + ' ' + ds_pims_prof_carers.surname),'N/A')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 438b710d-54aa-4066-8bc2-94f91781f0d9
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: Professional_Carer_Type_Code
        name: PROFESSIONAL_CARER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IFNULL(ds_pims_reference_values3.main_code,'N/A')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e9b78d2-be0d-412c-b638-deaacb3b0b7f
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: Professional_Carer_Type_Description
        name: PROFESSIONAL_CARER_TYPE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IFNULL(ds_pims_reference_values3.description,'N/A')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 109fafa0-37d7-4f94-9517-531c2f9dc64b
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date from which service point is valid.
        name: SERVICE_POINT_VALIDITY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4fa8f316-c9b3-4efe-9485-fc5f583d6bfa
                stepCounter: 00ad68b8-b3a1-4406-bae4-ef41c7c67d56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 526b4c87-956c-45ad-9ea3-48405654c1db
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date to which service point is valid.
        name: SERVICE_POINT_VALIDITY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f96101c5-d85a-49a6-a354-efd1fc7fc18a
                stepCounter: 00ad68b8-b3a1-4406-bae4-ef41c7c67d56
            transform: IFNULL(ds_pims_service_points.end_dttm,CONVERT(datetime,'20440630'))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 867b6f1e-a1c0-4d91-9ba7-ed73ecb3e4c8
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: HOSPITAL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03bc1771-5dcc-4515-a4da-3c35f60321ec
                stepCounter: f903dfcc-bf47-48e8-a3ce-81284bdda142
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f989297f-8757-4714-8220-17334dcf0a7f
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Inappropriate_Location_Flag
        name: INAPPROPRIATE_LOCATION_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b3d7205c-55d9-419d-b6bb-1512dac4e762
                stepCounter: f903dfcc-bf47-48e8-a3ce-81284bdda142
            transform: |-
              CASE IFNULL(l_mappings_service_points.inappropraiteedlocation,0)
                          WHEN 1                                                      THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71742a81-9ca9-4e03-a301-0c7790006034
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Stop_Clock_Location_Flag
        name: STOP_CLOCK_LOCATION_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d63c7482-d708-4c08-9b22-a395deb08b53
                stepCounter: f903dfcc-bf47-48e8-a3ce-81284bdda142
            transform: |-
              CASE IFNULL(l_mappings_service_points.edstopclocklocation,0)
                          WHEN 1                                                  THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 324d167d-56e6-4d57-9f0e-d454decac74c
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Observation_Location_Flag
        name: OBSERVATION_LOCATION_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4eb6211-b8be-4e92-b2a3-f192d7e0baac
                stepCounter: f903dfcc-bf47-48e8-a3ce-81284bdda142
            transform: |-
              CASE IFNULL(l_mappings_service_points.obslocation,0)
                          WHEN 1                                          THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d80b76e-79b4-4a77-985e-a294bc52aa5b
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Emergency_Department_Location_Flag
        name: EMERGENCY_DEPARTMENT_LOCATION_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e449fdb3-9f4a-496e-8fd7-6671aacaefcf
                stepCounter: f903dfcc-bf47-48e8-a3ce-81284bdda142
            transform: |-
              CASE IFNULL(l_mappings_service_points.edlocation,0)
                          WHEN 1                                         THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a08cdef-8511-4d5d-8556-080d68de5a9a
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Acute_Diagnosis_Unit_Location_Flag
        name: ACUTE_DIAGNOSIS_UNIT_LOCATION_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3d8bace-d6d3-4f0e-bf0e-c85da170ac19
                stepCounter: f903dfcc-bf47-48e8-a3ce-81284bdda142
            transform: |-
              CASE IFNULL(l_mappings_service_points.adulocation,0)
                          WHEN 1                                          THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 923f6370-26f6-4b06-a7b9-056f207fc978
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: RESPONSIBILITY_CENTRE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 508f1724-ac77-4685-b86f-9c7ea744a213
                stepCounter: f903dfcc-bf47-48e8-a3ce-81284bdda142
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9700362-ba06-48b5-b9c1-3dd8bf52a5db
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: INCLUDE_IN_COSTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 45a4ca0e-153f-4695-8527-2b35c0ac7c67
                stepCounter: f903dfcc-bf47-48e8-a3ce-81284bdda142
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca1ccf7c-fba7-4ca7-b0b9-90bdeb08038b
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: INCLUDE_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab07a02e-8405-4a0b-ad28-56a830b6d224
                stepCounter: f903dfcc-bf47-48e8-a3ce-81284bdda142
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec4ceebe-7281-4310-910d-f1a2a48e4a19
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CALCULATE_AS_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f10fbb6-27bb-4250-aaa7-e898393939f7
                stepCounter: f903dfcc-bf47-48e8-a3ce-81284bdda142
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3755a420-ef51-4aeb-bf00-00b167fc231c
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: EXCLUDE_FROM_SPECIALTY_PRODUCTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2fc5b54-ed0b-4725-8d90-8423793fb116
                stepCounter: f903dfcc-bf47-48e8-a3ce-81284bdda142
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 145d11d5-3351-4f78-a439-a90d6635ef4f
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: INCLUDE_WARD_CODE_ON_SPECIALTY_PRODUCT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e2a21bc-d2f3-4bda-8896-4c48ce46c77e
                stepCounter: f903dfcc-bf47-48e8-a3ce-81284bdda142
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 23c15296-9b76-4863-b3a5-a47eadd22301
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: INCLUDE_WARD_CODE_ON_BED_PRODUCT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dcf49fc1-909d-4dc3-9398-6b0b804e800e
                stepCounter: f903dfcc-bf47-48e8-a3ce-81284bdda142
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 149e35e3-f127-402f-8d68-38cbe98967e5
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: NEWS_ELIGIBLE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f5778921-99a0-40bd-af65-a77f9cb28cfb
                stepCounter: f903dfcc-bf47-48e8-a3ce-81284bdda142
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b7c9c77-741a-4bb9-8c50-7152befd936b
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: NEWS_COMPLIANT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 34dbb6ab-b1d1-4230-af83-f939ff1c2ec3
                stepCounter: f903dfcc-bf47-48e8-a3ce-81284bdda142
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c0dd965-bc7d-4ed4-9e79-2e95dbe73ead
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: VARCHAR(150)
        defaultValue: ""
        description: ""
        name: MENTAL_HEALTH_TEAM_DESCR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab62d349-92f1-41ab-b685-1279be4efa8f
                stepCounter: f903dfcc-bf47-48e8-a3ce-81284bdda142
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cae18b2f-024e-453d-ad62-77123ad5b211
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: MHS_PRIMHD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ca22f62-5b70-4f0d-95fd-0a1138c333c5
                stepCounter: f903dfcc-bf47-48e8-a3ce-81284bdda142
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0c2d7e0-94a8-423a-bf3e-10b168955405
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: NEW_SERVICE_MAPPING
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6abb3e5f-b1ba-44b6-804a-ff85b27dd02a
                stepCounter: f903dfcc-bf47-48e8-a3ce-81284bdda142
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4ebfc69-f65c-49b3-b97b-442f89f48f70
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: ACUTE_OCCUPANCY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a69f0aac-5e75-432d-a16a-fc013be90d85
                stepCounter: f903dfcc-bf47-48e8-a3ce-81284bdda142
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a318fa5-25ad-4699-b591-7751795feae1
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: FIRST_LOCATION_MAPPING
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8a3bf4ad-2329-44b9-a281-8d43a1cbe7c0
                stepCounter: f903dfcc-bf47-48e8-a3ce-81284bdda142
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9a4e983-3de1-4564-a2e3-4c75a6d6d871
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: USER_CREATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ad1a89a-727f-4e39-9dbc-f8b148e7300c
                stepCounter: 00ad68b8-b3a1-4406-bae4-ef41c7c67d56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 56ab93e3-561c-47fc-b365-5fbe3ceeb3d4
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 32059b86-b5ea-41e2-a2b3-6571e4a5a808
                stepCounter: 00ad68b8-b3a1-4406-bae4-ef41c7c67d56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b14d337-5f06-4290-b300-9a012dbb1ec2
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: USER_MODIF
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab369646-1a35-4996-847c-c76dd107c8d3
                stepCounter: 00ad68b8-b3a1-4406-bae4-ef41c7c67d56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c0a79ab-31a3-449f-b92e-452cb0ef143f
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: ONLINE_BOOKABLE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dff48b7b-61cb-4ecb-8cc6-f8cb3e7a0ef4
                stepCounter: 99dfb622-7f1c-4589-b7c3-b8e927d40a26
            transform: |-
              CASE WHEN specialties.online_bookable_flag ='Y' AND ds_pims_service_points.end_dttm IS NULL AND olbc.main_code ='OBOOKY' THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 23fb935f-a82b-4dbd-9c9d-c46aa03a3c27
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIF_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d6046a03-556e-491a-a845-cd3271d6e1a7
                stepCounter: 00ad68b8-b3a1-4406-bae4-ef41c7c67d56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f4c70a88-81e2-4030-b0b5-2f8af11ab714
          stepCounter: 3996776c-8783-4100-b740-2e180bb6ff64
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_PIMS_SERVICE_POINTS
        join:
          joinCondition: |-
            FROM ds_pims_service_points
              JOIN ds_pims_reference_values ds_pims_reference_values1
                ON ds_pims_service_points.sptyp_refno = ds_pims_reference_values1.rfval_refno -- AND GETDATE() BETWEEN ds_pims_reference_values1.start_dttm AND IFNULL(ds_pims_reference_values1.end_dttm,GETDATE())      LEFT OUTER JOIN ds_pims_health_organisations    ON ds_pims_service_points.heorg_refno = ds_pims_health_organisations.heorg_refno      LEFT OUTER JOIN ds_pims_reference_values ds_pims_reference_values2    ON ds_pims_health_organisations.hotyp_refno = ds_pims_reference_values2.rfval_refno    -- AND GETDATE() BETWEEN ds_pims_reference_values2.start_dttm AND IFNULL(ds_pims_reference_values2.end_dttm,GETDATE())      LEFT OUTER JOIN ds_pims_specialties    ON ds_pims_service_points.spect_refno = ds_pims_specialties.spect_refno      LEFT OUTER JOIN ds_pims_prof_carers    ON ds_pims_service_points.proca_refno = ds_pims_prof_carers.proca_refno      LEFT OUTER JOIN ds_pims_reference_values ds_pims_reference_values3    ON ds_pims_prof_carers.prtyp_refno = ds_pims_reference_values3.rfval_refno     -- AND GETDATE() BETWEEN ds_pims_reference_values3.start_dttm AND IFNULL(ds_pims_reference_values3.end_dttm,GETDATE())      LEFT OUTER JOIN l_mappings_service_points    ON ds_pims_service_points.spont_refno = l_mappings_service_points.spont_refno    AND GETDATE() BETWEEN l_mappings_service_points.start_date AND IFNULL(l_mappings_service_points.end_date,GETDATE())  left join (select spect_refno,online_bookable_flag from l_mappings_specialties    where online_bookable_flag ='Y'    ) specialties      on specialties.spect_refno = ds_pims_service_points.spect_refno    left join ds_pims_reference_values olbc        on ds_pims_service_points.fnsrc_refno=olbc.rfval_refno     and olbc.ARCHV_FLAG = 'N'         and olbc.END_DTTM is null
        name: S_SERVICE_POINT_1
        noLinkRefs: []
  name: S_SERVICE_POINT_1
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
