fileVersion: 1
id: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
name: S_IN_PATIENT_EVENT_01
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "First step in populating s_in_patient_event_05."
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22187ab1-b74c-4c3b-94b9-a7f532b72302
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRVSP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59d3088d-97f2-4c53-9ebc-ae021c7b49e2
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 182159ee-bf3e-4f7c-8dc3-b90598d0bf9e
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc28819c-55e3-49c8-b08c-b1de8ea0eb0d
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f956283-3927-48bf-8a8e-cf18a53e18d3
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: ""
        name: EVENT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59d3088d-97f2-4c53-9ebc-ae021c7b49e2
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ROW_NUMBER() OVER(PARTITION BY ds_pims_provider_spells.prvsp_refno ORDER BY ds_pims_provider_spells.admit_dttm)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab7da21b-0cf8-4f8a-9be6-e830b657681b
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Specialty of the first inpatient professional carer episode
        name: ADMIT_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72c532b7-79a7-49aa-8bc0-c737daef331d
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e2ebdb9-4ed2-4e3c-89b2-ae0a65620a04
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11ba3682-5d1a-4a53-bfaf-b4b646e6c99f
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d9d7832-586e-4eaa-a4d4-717fb8f796cc
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Event Service Point Code
        name: EVENT_SERVICE_POINT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd8b5dc7-5f8d-48f1-96e5-e9f85b2dc97c
                stepCounter: 331048bb-7ff9-400f-b8c4-4ac7cc91d7e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b69ccb67-7336-47fa-87e3-a7f539b3ee79
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: hospital_code
        name: HOSPITAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b060a5be-3e78-40a1-96c9-11a9b2f6d0f3
                stepCounter: 331048bb-7ff9-400f-b8c4-4ac7cc91d7e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94eca5d8-1004-4305-b485-5776c21dd8fd
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: HOSPITAL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c859f23e-870e-43b1-a6e4-7ff0f4ff7626
                stepCounter: 331048bb-7ff9-400f-b8c4-4ac7cc91d7e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2c7f9bd-4133-427f-8d41-2a3b301a1f57
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMET_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b9fc1ad-a8cc-4c29-bd6b-b55c9007f7ce
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31bac07b-21bc-4a59-b46a-5490981541d9
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: ADMISSION_METHOD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cfd358e5-689e-4542-a972-0aba002b02cf
                stepCounter: 469bfd7a-0084-4352-8ef5-69fd15a77ed4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ddbe2e02-2865-4ffc-9641-dbcf3b57c5a7
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: ADMISSION_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d98142f0-f261-4055-ad8c-581c6636e853
                stepCounter: 04c42cb2-f015-4d9e-ae6d-9feed9f13b97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8fb2d54-1f40-4281-b045-68470a13a512
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADSOR_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d682efad-8fd7-4911-beb0-f3a99784edd4
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eadcfb7c-a4f7-4c1e-a7df-8807f11d237c
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: READM_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c018533-12b7-4065-b16b-5f92a9fb86f2
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6858bf93-7d0a-4834-a200-cc2898000772
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CLEVL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b37f4af8-553e-4dd4-9c1c-b8aa02f27b3d
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70eca12f-7c56-4890-b153-0f267f048e0b
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a06254d-d86c-4cf5-ab17-b37af0d69b0a
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05e29e0a-36b3-4079-a023-3735b939613d
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DISDE_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3f097725-1edd-4539-b340-14de489b6fa2
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9bb68d7f-a11a-45bb-aa36-31a824ca66bf
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADCAT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4414ecc-4c91-49ec-a055-6affc8dbde9a
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e86363b1-a018-4e0e-b48f-a1b26d5a7b9c
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DISMT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a2db989-19c9-48be-ab15-47452de5e290
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2260c666-8884-4871-9485-0c7fa9cd5cf2
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EVENT_END_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 63829b4b-cb50-47c5-b8fc-df3a7548d9af
                stepCounter: 1bd29797-d2cb-4604-b84b-82897e347c39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 248d93bc-2b05-48ab-ae0a-b744d9c04d39
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Flag indicating event can be the initial one in an OS3 sequence.
        name: OS3_ADMIT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cfd358e5-689e-4542-a972-0aba002b02cf
                stepCounter: 469bfd7a-0084-4352-8ef5-69fd15a77ed4
            transform: |-
              CASE WHEN dim_admission_method.admission_method_code IN ('AC','ZC','AP','WN') AND ds_pims_provider_spells.adcat_refno IN (1000008242, 1000008240, 1000008180) THEN 1
                          ELSE 0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 915406d9-0f38-476a-86d4-3034355de560
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Flag indicating event can be the final one in an OS3 sequence.
        name: OS3_DISCHARGE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 63829b4b-cb50-47c5-b8fc-df3a7548d9af
                stepCounter: 1bd29797-d2cb-4604-b84b-82897e347c39
            transform: IIF(dim_discharge_method.event_end_type_code NOT IN ('DA', 'DF', 'DO', 'DP', 'DT', 'DW', 'ET','NA','0'), 1, 0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d7117a6-7eaf-4bd4-bf46-3cbcc7394133
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f7b850f-ce72-4e87-b4f3-6e2838f4dd0a
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98e936be-d525-41ab-9adb-589089b6c168
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1125cf7f-7027-45ac-acc8-b3a92505c4da
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: |-
              CASE WHEN ds_pims_provider_spells.admit_dttm IS NULL OR ds_pims_provider_spells.admit_dttm <= '1990-01-01' OR ds_pims_provider_spells.admit_dttm > GETDATE() THEN IFNULL(ds_pims_provider_spells.disch_dttm, CONVERT(date, GETDATE()))
                          ELSE ds_pims_provider_spells.admit_dttm
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d165fd3-991a-4c51-857a-7cbee8826792
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMIT_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1125cf7f-7027-45ac-acc8-b3a92505c4da
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7787e3c3-fc64-42d2-9a2b-9bc505cc3c21
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCH_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee3a67e8-1a53-44ab-aa64-cafc588de09c
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: |-
              CASE WHEN ds_pims_provider_spells.disch_dttm IS NULL OR ds_pims_provider_spells.disch_dttm <= '1990-01-01' OR ds_pims_provider_spells.disch_dttm > GETDATE() OR ds_pims_provider_spells.disch_dttm < ds_pims_provider_spells.admit_dttm THEN NULL
                          ELSE ds_pims_provider_spells.disch_dttm
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dad5c612-b8b1-48df-a2ae-12ba0fbf4136
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCH_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee3a67e8-1a53-44ab-aa64-cafc588de09c
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 040a4bab-7c05-4373-839f-b1532c59f3c0
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFRL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 80e5eecf-b3fb-4fc8-b661-b39389f47738
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d54a472-2674-41aa-89d6-51bd9da04e71
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: AEATT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3d60c752-dcc2-482d-b5d3-e8c11f77a74f
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a932e43-08a8-4b2d-8892-9848799ff040
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: FIRST_REGULAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b9caf7d-206b-4215-923e-0a8fcf1d38fd
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 099d55a7-196a-4c91-a93c-181fe9ef5dba
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: INMGT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76ce2d66-f620-4545-bd3f-71d1e5604f03
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25a0caf8-4787-4aee-bd57-69ca0fd12608
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: EXPDS_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2a5a335e-f714-4f3e-a830-98ebf37f63e8
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 173a74bb-6d31-47bc-be7c-a23f11564a69
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: DISABLED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19b4dc46-790d-4855-996e-74e704416106
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8a44177-7076-4626-bf7d-9ecf944772c9
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: CONFIDENTIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a6604579-0800-40b1-867d-e59c721e91d4
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 52875546-e9a8-4aaa-9c62-986e0c12cd5e
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: IDENTIFIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e7ce674-a689-4f6e-b177-025b020aa1ad
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9470d659-c8a2-4474-bfd8-110ea8e63eb0
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WLIST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d1ddefc-a73c-4486-a6a2-280c2804408d
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6beed65-0d9d-458d-b325-815bdc0e3e90
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: FAST_TRACK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 474c4ea1-defd-43a9-bbcc-24c1a12f7605
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb8d86c8-631b-45b3-9798-9309be76f831
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: AGEBD_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ba2821a-4594-442f-9a59-e7629eb68743
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f0ec995-005e-4851-8778-174e4cf58541
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: NO_FUNDS_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: adaf7607-d34e-4c33-a149-678ed4d276ce
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2a5f75a-69f1-4695-ae4f-e63b2c3e8f62
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: PRVSN_START_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23a37a08-2f83-4370-9738-9133ff8e3c00
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eed8db8c-1fe6-42b6-bbc8-a2fa6d737308
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: PRVSN_END_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75adebc2-28b6-4c2e-81fe-a7029f349f41
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a754a3cc-80b0-472d-aa27-ad03ee4f04d7
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CNTCT_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3dfd02a9-1ba2-4aa2-808e-04d07280dc1b
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cec7153a-c5b3-4601-9ac1-bfc81e0895f7
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MED_DISCH_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: adf2c303-3c4f-4246-a72c-d79692864825
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: |-
              CASE WHEN ds_pims_provider_spells.med_disch_dttm IS NULL OR ds_pims_provider_spells.med_disch_dttm <= '1990-01-01' OR ds_pims_provider_spells.med_disch_dttm > GETDATE() THEN ds_pims_provider_spells.disch_dttm
                          ELSE ds_pims_provider_spells.med_disch_dttm
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a54f2cc-6358-4aad-bf53-53df3ae2ffd4
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MED_DISCH_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: adf2c303-3c4f-4246-a72c-d79692864825
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 390ad4b8-f847-41fc-a9c1-351b8e0d16c2
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PMETD_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3644fefd-e190-4734-9fa9-5752d0cf61e4
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d43eaf90-0817-429e-a4ce-56805f843ed3
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DSINF_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67295302-afd0-45b8-bd94-f3c17581dfa1
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 551db9bf-0e4b-470b-b165-eff32aad47c0
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: IDPAP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 610a8953-82f0-459f-be85-6fb303187454
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2f37668-a529-4db8-9b35-88beca0aa919
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: CONSENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 300e2654-6b58-4cf5-879e-85f966675fb4
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a26aaff4-3467-413a-9d66-a73c651d6498
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: GP_ADVISE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 620ed001-b626-4a15-8bc6-0946baba77e0
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16d937bf-05b5-4c05-a66d-49ad162e0a31
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: IRADM_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 14ab4fe6-1fce-4b98-8199-a0a695c00493
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9fc18ea7-cfa5-4187-8e58-415231fcc470
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: MECH_VENT_HRS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1c99fd5-9431-4507-9aed-ed743ea80145
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 30a28d69-9457-4b17-a096-bb9133844ce9
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: AMBULANCE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd844a44-4711-40f4-b299-8db19bad94f6
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7dfb0e2-06ed-45f2-ac40-a408c9947af5
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRIOR_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e87c7168-bf9d-43a0-aafd-bc2b4959d2dc
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c408fd3-553b-4d4b-b04a-89b788cadeab
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: RELATED_ADMISSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 442b4b35-07d7-4d71-838f-176e081c31fa
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9f92648-4d0d-4c91-9c08-10d05bfd4f7c
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: READM_REHAB_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b45c7aa4-a942-4d04-80f4-f2a6d595fa4f
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7bb7f2c-a3dd-4668-b3ff-9877d294fc17
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SRTPC_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0d4d50fc-13d3-469c-9630-b41641ee3a7d
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 834ed93b-3708-4b9c-a7ec-5f7b8098d19b
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACAST_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64690faa-b9d5-4e60-9be7-eafc067d95aa
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8d8bdbc-42f1-4392-a7ab-56280bef077e
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ACC_EXPIRY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 550e0fe6-5e63-4326-9718-c13735c22824
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f9b4f3f-0001-4042-8173-a9122e87c544
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REHAB_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a9233bee-8c08-4b7c-924e-7fff577e1ec1
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b9ef01f2-c010-42c9-acff-46c48fd22ef7
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: WLIST_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f993f650-d845-4c5d-be64-636ff53122f0
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0605adfa-bc92-48ee-a3d7-08d06a54a951
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: Carer Episode Outcome
        name: CEOCM_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 37c6568a-2041-4be3-acb2-4c317fab46eb
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6880864-9d23-445a-b248-2e2c4ac2141b
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Specialty of the last inpatient stay episode. Discharge Specialty
        name: SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              -- 23-Feb
              -- Commented out COALESCE. Not sure why it's there. Not done in Prod.
              --ALESCE(ds_pims_prof_carer_episodes_dx.spect_refno, ds_pims_provider_spells.spect_refno)
              ds_pims_prof_carer_episodes_dx.spect_refno
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dff44a25-f545-4d6d-8cfa-28c7f473d149
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CODING_ADMIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1fe7ef84-1dca-487e-affa-fe3c1e92e15a
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e87a2927-9449-4214-8b7c-af667b9d7163
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CODING_DISCH_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f6e8c6a-b20c-4b30-9522-15c66332156b
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45361dd4-e574-4460-9454-575ac3d19cbe
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: DRG_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a888a138-9840-4736-912c-e9bbecc170b1
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15da2239-4e8f-4def-81f3-1f623e48c2df
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: CODED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a888a138-9840-4736-912c-e9bbecc170b1
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: |-
              CASE WHEN ds_plato_event_details.drg IS NULL THEN 'N'
                          ELSE 'Y'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b471764d-9a5f-4da9-a502-91057cf4e146
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: MDC_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bbfff9b7-6cdd-477d-aa95-451e49e98293
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ef280f9-2347-4dc6-a4be-429ec9576056
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: NMDS_EVENT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dbd0c0df-350d-40ec-9506-fb0f852f6485
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa6b51ea-fce9-4f89-8f4c-37d6d0da5627
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d251445f-9071-45c8-9852-33801fbc8496
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: REPLACE(ds_plato_event_details.purchaseunit, '.', '0')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86c9bbc2-e920-4c06-9991-8efe01c90ae6
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_CODE_FIXED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d251445f-9071-45c8-9852-33801fbc8496
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49855d8c-f672-4e20-9434-ebcc3bffa1b6
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: SCBU_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d251445f-9071-45c8-9852-33801fbc8496
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: |-
              CASE WHEN ds_pims_provider_spells.inmgt_refno = 1410021940                                                                               THEN 'N' -- Incorrectly coded rows

                          WHEN REPLACE(IFNULL(NULLIF(ds_plato_event_details.purchaseunit, 'EXCLU'), ds_plato_event_details.excludedpuc), '.', '0') = 'W06003' THEN 'Y'
                          WHEN s_in_patient_stay_SCBU.prvsp_refno IS NOT NULL                                                                                 THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a068cd5b-23d9-43ca-9289-76ac902ba0f1
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Set to 1 if one of the ward stays for the event is SCBU. This column not currently used. Only here for debuggint purposes.
        name: SCBU_WARD_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6425c40c-46f3-4898-a10c-0b1e7b0f3310
                stepCounter: b3db02b2-73e6-4b50-8873-51eb92151fdd
            transform: IIF(s_in_patient_stay_SCBU.prvsp_refno IS NULL, 0, 1)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0331ddc5-5e73-4505-8ba1-dfb763151992
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: EXCLUDED_PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 153c73dc-f731-43e8-9540-7e2a583b3d4d
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a9d66ed-7176-418d-8601-2b836c6b80a0
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: WIES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b45e174c-eb7a-42b6-99e1-0f5aab799629
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18368986-5ffc-4a99-9355-cf86fcbae7e6
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CODEDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de6a7f94-2e9f-4ef2-97eb-88a7041af0da
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91431e27-8386-496a-8595-71f59e171d71
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 825a0fbe-d2ca-442e-8e51-3d2c9ff9b8da
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b07fff47-69cf-46f1-9bf8-48c7e9604c67
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CCL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3267cd08-5fed-4f36-9f84-b284df240080
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d1f1141-cd68-424f-8209-0c09f6d4c830
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_SURGICAL_THEATRE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c1deffcf-a4ed-43d4-b5a6-381bf06f689c
                stepCounter: 559bcb0e-7f2c-42ea-a758-d73dead63a4f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af8e01d9-4a42-4ced-a633-800324fcc46f
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: surgical_theatre_group
        name: SURGICAL_THEATRE_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83f665b1-5917-4560-bcc5-f026dceaf20f
                stepCounter: 50d37543-6dd1-4ea0-bfe9-dc03dfc2dacc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ed03acc-5793-4fb3-a2dd-3f3ac8737114
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: PACKAGE_OF_CARE_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83f665b1-5917-4560-bcc5-f026dceaf20f
                stepCounter: 50d37543-6dd1-4ea0-bfe9-dc03dfc2dacc
            transform: IIF(dim_admission_type.admission_type_code <> 'AC' AND dim_service_point.service_point_code IN ('ESCSU', 'ESCPU', 'ESCN') AND dim_surgical_theatre.surgical_theatre_group = 'ESC', 'Y', 'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 819098d9-0911-46eb-b367-45fede5d4e9c
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9fa58c0b-e217-4364-ae63-76c06b664a12
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8634f377-c6cb-445e-aee1-cb497d5720db
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d46d5d71-f9ed-4a34-b036-a6357ea34022
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df197b7e-307f-4027-b82b-b50f825b00a1
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIFY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddce7ea8-e372-4d24-b23d-c90c5bdfaf39
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9d849a3-e3e0-4aed-9977-af7828c93f82
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MODIFY_USER_LOGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: affa354a-ceac-43e3-85b3-7511cf413cd9
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c292ac60-4ddc-4691-93cd-85465b163160
          stepCounter: 5f2dc218-3c5d-438e-90e3-4a3bee885d80
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_PIMS_PROVIDER_SPELLS
        join:
          joinCondition: |-
            FROM ds_pims_provider_spells
              LEFT OUTER JOIN ds_pims_prof_carer_episodes
                ON ds_pims_prof_carer_episodes.prvsp_refno = ds_pims_provider_spells.prvsp_refno
               AND ds_pims_prof_carer_episodes.start_dttm = ds_pims_provider_spells.admit_dttm
               AND ds_pims_prof_carer_episodes.archv_flag = 'N'
              LEFT OUTER JOIN ds_pims_prof_carer_episodes ds_pims_prof_carer_episodes_dx
                ON ds_pims_prof_carer_episodes_dx.prvsp_refno = ds_pims_provider_spells.prvsp_refno
               AND ds_pims_prof_carer_episodes_dx.end_dttm = ds_pims_provider_spells.disch_dttm
               AND ds_pims_prof_carer_episodes_dx.archv_flag = 'N'
              LEFT OUTER JOIN (
                    SELECT IP_Event_encounter_ID,
                           dim_surgical_theatre_key,
                           ROW_NUMBER() OVER(PARTITION BY IP_Event_encounter_ID ORDER BY dss_update_time DESC) row_num
                      FROM ds_consolidate_theatre
                     WHERE patient_theatre_visit_seq_num = 1
                   ) ds_consolidate_theatre
                ON ds_consolidate_theatre.IP_Event_encounter_ID = ds_pims_provider_spells.encounter_id
               AND ds_consolidate_theatre.row_num = 1
              LEFT OUTER JOIN ds_plato_event_details
                ON ds_pims_provider_spells.encounter_id = ds_plato_event_details.pimsencounter
              LEFT OUTER JOIN s_in_patient_stay_SCBU
                ON ds_pims_provider_spells.prvsp_refno = s_in_patient_stay_SCBU.prvsp_refno
              LEFT OUTER JOIN dim.dim_admission_method
                ON ds_pims_provider_spells.admet_refno = dim_admission_method.admission_method_reference_no
               AND dim_admission_method.dss_current_flag = 'Y'
              LEFT OUTER JOIN dim.dim_admission_type
                ON ds_pims_provider_spells.admet_refno = dim_admission_type.admission_method_reference_no
               AND dim_admission_method.dss_current_flag = 'Y'
              LEFT OUTER JOIN dim.dim_discharge_method
                ON ds_pims_provider_spells.dismt_refno = dim_discharge_method.discharge_method_reference_no
              LEFT OUTER JOIN dim.dim_service_point
                ON ds_pims_provider_spells.spont_refno = dim_service_point.service_point_reference_no
               AND dim_service_point.dss_current_flag = 'Y'
              LEFT OUTER JOIN dim.dim_surgical_theatre
                ON ds_consolidate_theatre.dim_surgical_theatre_key = dim_surgical_theatre.dim_surgical_theatre_key
             WHERE ds_pims_provider_spells.prvsn_start_flag = 'N'
        name: S_IN_PATIENT_EVENT_01
        noLinkRefs: []
  name: S_IN_PATIENT_EVENT_01
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
