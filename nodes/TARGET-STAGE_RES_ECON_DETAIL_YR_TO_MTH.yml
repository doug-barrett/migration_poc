fileVersion: 1
id: 8fcead86-02ae-4feb-804e-edf6dbd09d6e
name: STAGE_RES_ECON_DETAIL_YR_TO_MTH
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: "Expand yealy summary records into monthly (ACCT_PRE_DATE) records using DIM_DATE. "
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bdb2df12-2fc0-4955-a4bd-88884cd4618e
          stepCounter: 8fcead86-02ae-4feb-804e-edf6dbd09d6e
        config: {}
        dataType: NUMBER(18)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: RESULT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83b981ab-42e3-4fcb-bcc6-a39b6f554956
                stepCounter: 7c391c8b-b889-40d5-a3ef-6579e2698c85
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bc795d28-68a5-44f3-988a-9df771b180b6
          stepCounter: 8fcead86-02ae-4feb-804e-edf6dbd09d6e
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: Used as batch processing partition value (16 distinct values at creation time)
        name: RESERVE_CATEGORY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f6f0e20b-aee1-49ea-bb33-cf4e30ddcefa
                stepCounter: 7c391c8b-b889-40d5-a3ef-6579e2698c85
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5fcd319-faa4-4cce-a03e-f42c2c3b3007
          stepCounter: 8fcead86-02ae-4feb-804e-edf6dbd09d6e
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2e92084-bbf6-4d4b-8ad9-312d792ece0d
                stepCounter: 7c391c8b-b889-40d5-a3ef-6579e2698c85
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0df349b6-cc58-4e20-b090-61f7cc0d2a8d
          stepCounter: 8fcead86-02ae-4feb-804e-edf6dbd09d6e
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7239703-6bb2-445c-ae61-5cf32ad99469
                stepCounter: 7c391c8b-b889-40d5-a3ef-6579e2698c85
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d78a5522-bbb1-4970-8a02-2b65dfd13c39
          stepCounter: 8fcead86-02ae-4feb-804e-edf6dbd09d6e
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Last Day of Economics Details Month, Year
        name: ACCT_PER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e430258b-44cc-49cd-87ed-01cd194c0c08
                stepCounter: 7c391c8b-b889-40d5-a3ef-6579e2698c85
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: beddc24d-4ed3-4aaf-a79e-7d510a0ab6b6
          stepCounter: 8fcead86-02ae-4feb-804e-edf6dbd09d6e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_VARIABLE_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 43f17dfc-be43-42bb-bbcf-45eebcac8ba2
                stepCounter: 7c391c8b-b889-40d5-a3ef-6579e2698c85
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c619dec-accc-4711-9b92-e9a321faccb1
          stepCounter: 8fcead86-02ae-4feb-804e-edf6dbd09d6e
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: Reserve Economics Variable Type Code
        name: VARIABLE_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bdcf572e-489f-4720-aab4-f90b99bc19fb
                stepCounter: 7c391c8b-b889-40d5-a3ef-6579e2698c85
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1fd7abb-542c-4353-96aa-e50e31e524ef
          stepCounter: 8fcead86-02ae-4feb-804e-edf6dbd09d6e
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Interpolate Yearly Data To Monthly
        name: YR_TO_MTH_FLG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3ef0785a-6f33-41da-af06-fe9d2ca5050c
                stepCounter: 7c391c8b-b889-40d5-a3ef-6579e2698c85
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b67e7c45-75e1-4b0a-914d-dc3e0896a602
          stepCounter: 8fcead86-02ae-4feb-804e-edf6dbd09d6e
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Value UOM Code
        name: UOM_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a342422a-5234-40d8-aa20-d5e2286fb8b1
                stepCounter: 7c391c8b-b889-40d5-a3ef-6579e2698c85
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d529148-0892-441a-b500-a51eff466946
          stepCounter: 8fcead86-02ae-4feb-804e-edf6dbd09d6e
        config: {}
        dataType: DECIMAL(36,8)
        defaultValue: ""
        description: Variable numeric value
        name: VALUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c14f9d0-ffa9-4aff-9128-e6cd0b570f0f
                stepCounter: 7c391c8b-b889-40d5-a3ef-6579e2698c85
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f3813e22-8477-4500-b9cd-b884a0ad587f
          stepCounter: 8fcead86-02ae-4feb-804e-edf6dbd09d6e
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: YEAR_DAYS
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: TO_NUMBER(TRIM(TO_CHAR(DATE_PART('DOY',TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL.YEAR,'0000')) || '1231','YYYYMMDD')))),'999')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03449e2f-65ce-4426-afa2-3c3b8fc2d724
          stepCounter: 8fcead86-02ae-4feb-804e-edf6dbd09d6e
        config: {}
        dataType: DECIMAL(36,8)
        defaultValue: ""
        description: ""
        name: YEAR_PER_DAY_VALUE
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: VALUE/TO_NUMBER(TRIM(TO_CHAR(DATE_PART('DOY',TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL.VALUE,'0000')) || '1231','YYYYMMDD')))),'999')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef765f94-354a-472c-aa20-38b2e3ed3d17
          stepCounter: 8fcead86-02ae-4feb-804e-edf6dbd09d6e
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: NEW_ACCT_PER_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9cafcfb4-e64b-48a7-a8b7-ac2946945d8c
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 408dfd52-8125-4df0-a268-c22a936e5903
          stepCounter: 8fcead86-02ae-4feb-804e-edf6dbd09d6e
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: NEW_MONTH
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: EXTRACT(MONTH FROM DIM_DATE.CALENDAR_DATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8bddf1f6-02ff-4483-b0c0-50d65fa59e3b
          stepCounter: 8fcead86-02ae-4feb-804e-edf6dbd09d6e
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: NEW_MONTH_DAYS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: EXTRACT(DAYS FROM DIM_DATE.CALENDAR_DATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2fe849e1-b748-433f-8671-f2519d1fca92
          stepCounter: 8fcead86-02ae-4feb-804e-edf6dbd09d6e
        config: {}
        dataType: DECIMAL(36,8)
        defaultValue: ""
        description: ""
        name: NEW_MONTH_VALUE
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: (STAGE_RES_ECON_DETAIL.VALUE/TO_NUMBER(TRIM(TO_CHAR(DATE_PART('DOY',TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL.YEAR,'0000')) || '1231','YYYYMMDD')))),'999'))*EXTRACT(DAYS FROM DIM_DATE.CALENDAR_DATE)
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_RES_ECON_DETAIL: 7c391c8b-b889-40d5-a3ef-6579e2698c85
          DIM_DATE: e36e3241-fb91-480b-b6e9-be9a8d12930f
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STAGE_RES_ECON_DETAIL
          - locationName: TARGET
            nodeName: DIM_DATE
        join:
          joinCondition: |-
            FROM {{ ref('TARGET','STAGE_RES_ECON_DETAIL') }} STAGE_RES_ECON_DETAIL
             INNER JOIN {{ ref('TARGET','DIM_DATE') }} DIM_DATE
                ON (STAGE_RES_ECON_DETAIL.YEAR = DIM_DATE.CAL_YEAR AND DIM_DATE.CALENDAR_DATE = LAST_DAY(DIM_DATE.CALENDAR_DATE))
             WHERE STAGE_RES_ECON_DETAIL.YR_TO_MTH_FLG = 'Y'
               AND STAGE_RES_ECON_DETAIL.MONTH = 0
               AND NVL(STAGE_RES_ECON_DETAIL.VALUE,0) <> 0
        name: STAGE_RES_ECON_DETAIL_YR_TO_MTH
        noLinkRefs: []
  name: STAGE_RES_ECON_DETAIL_YR_TO_MTH
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
