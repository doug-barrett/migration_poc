fileVersion: 1
id: 2e3dbaab-1144-4d75-9ab9-2410bfa96bf3
name: STAGE_RES_ECON_DETAIL_YR_TO_MTH
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: "Expand yealy summary records into monthly (ACCT_PRE_DATE) records using DIM_DATE. "
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 56613ac3-7dc3-4dd7-a61c-18c3c6d7c2e8
          stepCounter: 2e3dbaab-1144-4d75-9ab9-2410bfa96bf3
        config: {}
        dataType: NUMBER(18)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: RESULT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d227eb0-08f6-4aeb-9b87-32b765b1931b
                stepCounter: 9f609960-c8cc-496b-81c5-104bce8270fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ae77a8a-6897-496c-9509-8e5052f75b67
          stepCounter: 2e3dbaab-1144-4d75-9ab9-2410bfa96bf3
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: Used as batch processing partition value (16 distinct values at creation time)
        name: RESERVE_CATEGORY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ac8da268-5bf8-4865-96be-6a97df6f3bd8
                stepCounter: 9f609960-c8cc-496b-81c5-104bce8270fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da58f258-5b40-47e1-9b40-fd048a0fbc08
          stepCounter: 2e3dbaab-1144-4d75-9ab9-2410bfa96bf3
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b39faf27-dc7c-4d69-aca1-d5089ce92663
                stepCounter: 9f609960-c8cc-496b-81c5-104bce8270fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95048df5-d0e2-4db7-97a6-cc45ce238343
          stepCounter: 2e3dbaab-1144-4d75-9ab9-2410bfa96bf3
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2d061d0-df31-4f16-8a15-eb9726134828
                stepCounter: 9f609960-c8cc-496b-81c5-104bce8270fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc85f627-5ff3-45ec-acd3-307b0eeb6acf
          stepCounter: 2e3dbaab-1144-4d75-9ab9-2410bfa96bf3
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Last Day of Economics Details Month, Year
        name: ACCT_PER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c8cae45b-f63d-4826-ba3b-9fc1451a576c
                stepCounter: 9f609960-c8cc-496b-81c5-104bce8270fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59d2eaa3-b47e-42be-bcdb-1e216c129e89
          stepCounter: 2e3dbaab-1144-4d75-9ab9-2410bfa96bf3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_VARIABLE_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 140d03d9-d4a1-45e7-ab9f-6dc5927aa5b1
                stepCounter: 9f609960-c8cc-496b-81c5-104bce8270fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c68a175-f0b8-4fcd-8144-f1e624b20743
          stepCounter: 2e3dbaab-1144-4d75-9ab9-2410bfa96bf3
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: Reserve Economics Variable Type Code
        name: VARIABLE_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60aba6e9-22b9-4e45-b593-cae87fd49281
                stepCounter: 9f609960-c8cc-496b-81c5-104bce8270fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ecb38d4-2845-423d-8b0f-9032c08e0edf
          stepCounter: 2e3dbaab-1144-4d75-9ab9-2410bfa96bf3
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Interpolate Yearly Data To Monthly
        name: YR_TO_MTH_FLG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3cc11ba7-9a23-4001-84cb-32b301f1da12
                stepCounter: 9f609960-c8cc-496b-81c5-104bce8270fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42d09d73-af9e-43cf-a994-fc11f3ad907d
          stepCounter: 2e3dbaab-1144-4d75-9ab9-2410bfa96bf3
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Value UOM Code
        name: UOM_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b6e7ce0-375b-4f0a-bcf7-1580666c8195
                stepCounter: 9f609960-c8cc-496b-81c5-104bce8270fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1dece2a-2e1c-4b24-8334-2a8d59793898
          stepCounter: 2e3dbaab-1144-4d75-9ab9-2410bfa96bf3
        config: {}
        dataType: DECIMAL(36,8)
        defaultValue: ""
        description: Variable numeric value
        name: VALUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a244a36-edca-4c33-96c1-412fd5723ce9
                stepCounter: 9f609960-c8cc-496b-81c5-104bce8270fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77e896e7-6cc8-4f9f-867e-943bdb13b62f
          stepCounter: 2e3dbaab-1144-4d75-9ab9-2410bfa96bf3
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: YEAR_DAYS
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: TO_NUMBER(TRIM(TO_CHAR(DATE_PART('DOY',TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL.YEAR,'0000')) || '1231','YYYYMMDD')))),'999')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50003084-3cab-4f61-bd03-9449bf1ee0fd
          stepCounter: 2e3dbaab-1144-4d75-9ab9-2410bfa96bf3
        config: {}
        dataType: DECIMAL(36,8)
        defaultValue: ""
        description: ""
        name: YEAR_PER_DAY_VALUE
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: VALUE/TO_NUMBER(TRIM(TO_CHAR(DATE_PART('DOY',TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL.VALUE,'0000')) || '1231','YYYYMMDD')))),'999')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b5c9f5d-3030-4bbb-834b-84c0429417f9
          stepCounter: 2e3dbaab-1144-4d75-9ab9-2410bfa96bf3
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: NEW_ACCT_PER_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22fc0aa6-a875-4164-ab11-fd35b6a269ec
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 35d0ea2a-694f-4e5c-88bf-ad1f8f6fbdd5
          stepCounter: 2e3dbaab-1144-4d75-9ab9-2410bfa96bf3
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: NEW_MONTH
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: EXTRACT(MONTH FROM DIM_DATE.CALENDAR_DATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9df2e95d-adec-44f0-867e-2dec7875c50c
          stepCounter: 2e3dbaab-1144-4d75-9ab9-2410bfa96bf3
        config: {}
        dataType: NUMBER(9)
        defaultValue: ""
        description: ""
        name: NEW_MONTH_DAYS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: EXTRACT(DAYS FROM DIM_DATE.CALENDAR_DATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 46f14c59-1b53-45b3-b6db-9e8fe47c250f
          stepCounter: 2e3dbaab-1144-4d75-9ab9-2410bfa96bf3
        config: {}
        dataType: DECIMAL(36,8)
        defaultValue: ""
        description: ""
        name: NEW_MONTH_VALUE
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: (STAGE_RES_ECON_DETAIL.VALUE/TO_NUMBER(TRIM(TO_CHAR(DATE_PART('DOY',TO_DATE(TRIM(TO_CHAR(STAGE_RES_ECON_DETAIL.YEAR,'0000')) || '1231','YYYYMMDD')))),'999'))*EXTRACT(DAYS FROM DIM_DATE.CALENDAR_DATE)
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_RES_ECON_DETAIL: 9f609960-c8cc-496b-81c5-104bce8270fd
          DIM_DATE: 514e5b21-eab9-4985-9a00-e22a0e84a361
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STAGE_RES_ECON_DETAIL
          - locationName: TARGET
            nodeName: DIM_DATE
        join:
          joinCondition: |-
            FROM {{ ref('TARGET','STAGE_RES_ECON_DETAIL') }} STAGE_RES_ECON_DETAIL
             INNER JOIN {{ ref('TARGET','DIM_DATE') }} DIM_DATE
                ON (STAGE_RES_ECON_DETAIL.YEAR = DIM_DATE.CAL_YEAR AND DIM_DATE.CALENDAR_DATE = LAST_DAY(DIM_DATE.CALENDAR_DATE))
             WHERE STAGE_RES_ECON_DETAIL.YR_TO_MTH_FLG = 'Y'
               AND STAGE_RES_ECON_DETAIL.MONTH = 0
               AND NVL(STAGE_RES_ECON_DETAIL.VALUE,0) <> 0
        name: STAGE_RES_ECON_DETAIL_YR_TO_MTH
        noLinkRefs: []
  name: STAGE_RES_ECON_DETAIL_YR_TO_MTH
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
