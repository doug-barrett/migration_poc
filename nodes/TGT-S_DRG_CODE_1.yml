fileVersion: 1
id: b727f66f-95e4-4d4d-9254-780d6569fd69
name: S_DRG_CODE_1
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "DRG Codes and Weighted Inlier Equivalent Seperation Rates, by DRG, from the MOH"
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d40bdc6b-9d96-4014-90b1-a20c9d9aec16
          stepCounter: b727f66f-95e4-4d4d-9254-780d6569fd69
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: FINANCIAL_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 390267d7-4283-416d-a973-e5950707bc05
                stepCounter: 5a57eae7-8ae4-4d54-9902-57eb38afec2c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb4bb8ab-be72-41cc-a459-f3f2b79aec73
          stepCounter: b727f66f-95e4-4d4d-9254-780d6569fd69
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: DRG_FAMILY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a18fd23-cdde-4022-b0f2-7ce981370f6d
                stepCounter: 5a57eae7-8ae4-4d54-9902-57eb38afec2c
            transform: left(l_reference_MOH_WIES.drg,3)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac47929d-1646-4244-b7c2-0667ad10038c
          stepCounter: b727f66f-95e4-4d4d-9254-780d6569fd69
        config: {}
        dataType: NVARCHAR(255)
        defaultValue: ""
        description: ""
        name: DRG_FAMILY_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c3a79812-95b8-4706-bdd9-c41733b35da6
                stepCounter: 9d694bc2-0925-4e08-8e34-6f26a08c5a5e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0840558-0b28-4736-9d7c-5a375c177c0d
          stepCounter: b727f66f-95e4-4d4d-9254-780d6569fd69
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: DRG_CATEGORY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a18fd23-cdde-4022-b0f2-7ce981370f6d
                stepCounter: 5a57eae7-8ae4-4d54-9902-57eb38afec2c
            transform: |-
              CASE WHEN substring(l_reference_MOH_WIES.drg,2,2) BETWEEN '01' AND '39' THEN 'Surgical'
                          WHEN substring(l_reference_MOH_WIES.drg,2,2) BETWEEN '60' AND '99' THEN 'Medical'
                          ELSE 'Other'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: adf4f92c-65e3-44c1-af53-854e159f94a0
          stepCounter: b727f66f-95e4-4d4d-9254-780d6569fd69
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: DRG_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a18fd23-cdde-4022-b0f2-7ce981370f6d
                stepCounter: 5a57eae7-8ae4-4d54-9902-57eb38afec2c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df0b4774-ab18-4679-bbd1-1a821045aec7
          stepCounter: b727f66f-95e4-4d4d-9254-780d6569fd69
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: DRG_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: af8f7050-4b18-4cc4-b29d-7742cfd9cfbe
                stepCounter: 5a57eae7-8ae4-4d54-9902-57eb38afec2c
            transform: l_reference_MOH_WIES.drg + ' - ' +l_reference_MOH_WIES.drg_description
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3fb18039-0b13-484d-893f-9223b9545625
          stepCounter: b727f66f-95e4-4d4d-9254-780d6569fd69
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: MECHANICAL_VENT_COPAYMENT_IND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0a094362-82c6-44d6-bc43-bfee5baf0b9e
                stepCounter: 5a57eae7-8ae4-4d54-9902-57eb38afec2c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6673df4e-0297-4496-afa6-e85ebbac3013
          stepCounter: b727f66f-95e4-4d4d-9254-780d6569fd69
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: INLIER_SAMEDAY_ONEDAY_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 80af96f1-b6b7-4f72-a335-4f3ba317027d
                stepCounter: 5a57eae7-8ae4-4d54-9902-57eb38afec2c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3a8ed05-b8e5-405c-a658-ecd17111db9d
          stepCounter: b727f66f-95e4-4d4d-9254-780d6569fd69
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: LOWER_LOS_BOUNDARY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bdafbf6c-2a1b-4a8c-ba06-3fb1148e1f0d
                stepCounter: 5a57eae7-8ae4-4d54-9902-57eb38afec2c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a566cd15-27fc-4889-80bf-3c06d904650f
          stepCounter: b727f66f-95e4-4d4d-9254-780d6569fd69
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: UPPER_LOS_BOUNDARY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0692834e-bf8d-4edc-9022-f4d4c6627704
                stepCounter: 5a57eae7-8ae4-4d54-9902-57eb38afec2c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e14ca7f-65f1-4288-a4cb-f00f937ad974
          stepCounter: b727f66f-95e4-4d4d-9254-780d6569fd69
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: AVERAGE_LOS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05a903c3-fdd9-4405-9c26-5b9db38f4a83
                stepCounter: 5a57eae7-8ae4-4d54-9902-57eb38afec2c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4348b516-4921-4358-80aa-48b5e7dd9b5e
          stepCounter: b727f66f-95e4-4d4d-9254-780d6569fd69
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: INLIER_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ecadb44-9c4e-44da-8b1b-648c293a7124
                stepCounter: 5a57eae7-8ae4-4d54-9902-57eb38afec2c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6dbda341-c830-4cae-89f1-18c06521b166
          stepCounter: b727f66f-95e4-4d4d-9254-780d6569fd69
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: HIGH_OUTLIER_PER_DIEM_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea2f0f69-3fea-4da8-b42b-ffa2f6d62484
                stepCounter: 5a57eae7-8ae4-4d54-9902-57eb38afec2c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6f7cae8-3bb7-49bd-a30b-5b192511454b
          stepCounter: b727f66f-95e4-4d4d-9254-780d6569fd69
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: LOW_OUTLIER_PER_DIEM_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b27936c-7479-41f2-a7e6-5e6eb171baa9
                stepCounter: 5a57eae7-8ae4-4d54-9902-57eb38afec2c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef19a941-76db-4caa-9deb-f2f6916b296d
          stepCounter: b727f66f-95e4-4d4d-9254-780d6569fd69
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: SAME_DAY_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 95f883ae-d02d-421d-9bd4-c9798571a75d
                stepCounter: 5a57eae7-8ae4-4d54-9902-57eb38afec2c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: acab38fd-a0bb-46d4-8b45-dbc1b555ce44
          stepCounter: b727f66f-95e4-4d4d-9254-780d6569fd69
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: ONE_DAY_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07acc0c2-6f45-4b56-b631-1e376e8f3d31
                stepCounter: 5a57eae7-8ae4-4d54-9902-57eb38afec2c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9bd8f8c5-43d4-4888-92aa-dc17aa17e183
          stepCounter: b727f66f-95e4-4d4d-9254-780d6569fd69
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: CO_ELIGIBILITY_IND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ca3e014-b01d-4de5-aa14-ac3be190d84d
                stepCounter: 5a57eae7-8ae4-4d54-9902-57eb38afec2c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4530b254-5d8e-4858-bf92-f29032e0a664
          stepCounter: b727f66f-95e4-4d4d-9254-780d6569fd69
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WIES_VALIDITY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59b86429-6083-413a-bcae-426aa2bc20bd
                stepCounter: 5a57eae7-8ae4-4d54-9902-57eb38afec2c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ca92b14-c269-42a9-90cc-5a360d8c3861
          stepCounter: b727f66f-95e4-4d4d-9254-780d6569fd69
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WIES_VALIDITY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5a66951-a770-40c0-a722-8551f5df1281
                stepCounter: 5a57eae7-8ae4-4d54-9902-57eb38afec2c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a48c1f84-13ad-4280-a097-091160a1f3ee
          stepCounter: b727f66f-95e4-4d4d-9254-780d6569fd69
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          L_MAPPINGS_DRG_FAMILY: 9d694bc2-0925-4e08-8e34-6f26a08c5a5e
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: L_REFERENCE_MOH_WIES
          - locationName: TGT
            nodeName: L_MAPPINGS_DRG_FAMILY
        join:
          joinCondition: |-
            FROM l_reference_MOH_WIES
              LEFT OUTER JOIN {{ ref('TGT','L_MAPPINGS_DRG_FAMILY') }}
                ON l_reference_MOH_WIES.drg = l_mappings_DRG_Family.DRG
        name: S_DRG_CODE_1
        noLinkRefs: []
  name: S_DRG_CODE_1
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
