fileVersion: 1
id: 333721c2-a1de-446b-b0d6-a040d92f3a17
name: S_CONTRACT_ACTIVITY_MH_V
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 540f6392-ee31-4092-8a14-fc13af7ca9c1
          stepCounter: 333721c2-a1de-446b-b0d6-a040d92f3a17
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PROVIDER_FUNDER_SPLIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3317c990-d32e-4abf-8e36-a351bfaadf1e
                stepCounter: b9264eae-b318-4ace-9d1e-91b0604916d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54158a96-341d-4a7b-8db3-ae2d5133a159
          stepCounter: 333721c2-a1de-446b-b0d6-a040d92f3a17
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PUC_MAP_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 12da3c25-9c1c-41b2-a31d-5261b7b21281
          stepCounter: 333721c2-a1de-446b-b0d6-a040d92f3a17
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: RESPONSIBILITY_CENTRE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52cb89e7-4461-4ce0-bbad-a0c72d3f7ec1
                stepCounter: b9264eae-b318-4ace-9d1e-91b0604916d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2104a4e6-9e3e-40a2-a794-5716ad43ad78
          stepCounter: 333721c2-a1de-446b-b0d6-a040d92f3a17
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: health_specialty_code
        name: HEALTH_SPECIALTY_CODE
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1803c6ba-3be9-4e71-9efa-f8bff9faca99
          stepCounter: 333721c2-a1de-446b-b0d6-a040d92f3a17
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FACILITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '1021'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5ac0468-6e6f-44d3-84e4-c57d6df9dd96
          stepCounter: 333721c2-a1de-446b-b0d6-a040d92f3a17
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REPORTING_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ab37125-73dd-49e4-81a8-9c155d00e4db
                stepCounter: b9264eae-b318-4ace-9d1e-91b0604916d4
            transform: EOMonth(cast(contract_reporting_date AS date))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6c2462e-8ff1-406b-a528-f9eec8cd5e49
          stepCounter: 333721c2-a1de-446b-b0d6-a040d92f3a17
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SOURCE_ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1fe70792-97aa-41ba-9c39-dac2fae2eb90
                stepCounter: b9264eae-b318-4ace-9d1e-91b0604916d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 85497e7b-e2a5-4508-a928-31f64c146367
          stepCounter: 333721c2-a1de-446b-b0d6-a040d92f3a17
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FUNDED_EVENT_ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1fe70792-97aa-41ba-9c39-dac2fae2eb90
                stepCounter: b9264eae-b318-4ace-9d1e-91b0604916d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4196c4d8-5c53-4491-9c1a-88ce3462304f
          stepCounter: 333721c2-a1de-446b-b0d6-a040d92f3a17
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Dummy encounter for Mental Health FTE based purchase units
        name: EVENT_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2a00047e-55cd-42ce-8df5-4cfc516137f6
                stepCounter: b9264eae-b318-4ace-9d1e-91b0604916d4
            transform: "'MH_FTE'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 28c8a865-c7a5-4a03-8da4-7ffc7bf19dab
          stepCounter: 333721c2-a1de-446b-b0d6-a040d92f3a17
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: dummy NHI for Mental Health FTE based purchase units
        name: NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2a00047e-55cd-42ce-8df5-4cfc516137f6
                stepCounter: b9264eae-b318-4ace-9d1e-91b0604916d4
            transform: "'MHS1234'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fca75e84-3de7-4e78-a607-698ad2cc288d
          stepCounter: 333721c2-a1de-446b-b0d6-a040d92f3a17
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Artificial dim_patient_key for FTE based Mental Health purhcase unit volumes
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55efc8d2-8304-4f88-8358-fca0d9b77585
          stepCounter: 333721c2-a1de-446b-b0d6-a040d92f3a17
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Artificial admin_category_reference_no for FTE based Mental Health purhcase unit volumes
        name: ADMIN_CATEGORY_REFERENCE_NO
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d059f92-1dcb-4ef5-8624-7063808a8cf5
          stepCounter: 333721c2-a1de-446b-b0d6-a040d92f3a17
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: dummy field for MH contract admit type. This should always have the value "OTHER"
        name: CONTRACT_ADMIT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea83b1b5-8603-4b64-a777-84cd270c5113
                stepCounter: b9264eae-b318-4ace-9d1e-91b0604916d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f7ce083-9af9-4c78-85d4-80d2fb337123
          stepCounter: 333721c2-a1de-446b-b0d6-a040d92f3a17
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: dummy field for MH contract admit type. T
        name: ADMISSION_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be998326-fa6c-4f3e-a18f-dfd8a920e28a
          stepCounter: 333721c2-a1de-446b-b0d6-a040d92f3a17
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: dummy IDF Class for Mental Volume
        name: IDF_CLASS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 85b3d85b-eb55-4cf3-9205-b1269d5b7d30
                stepCounter: b9264eae-b318-4ace-9d1e-91b0604916d4
            transform: |-
              CASE WHEN s_contract_volume_MH_phased.IDF_Class = 'Unknown' THEN 'Non-IDF'
                          ELSE s_contract_volume_MH_phased.IDF_Class
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3823623e-7a24-4d91-bdaa-0305f4e1e411
          stepCounter: 333721c2-a1de-446b-b0d6-a040d92f3a17
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: dummy domicile
        name: DOMICILE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 85b3d85b-eb55-4cf3-9205-b1269d5b7d30
                stepCounter: b9264eae-b318-4ace-9d1e-91b0604916d4
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e384fcda-7aa0-4a56-a15e-e81e1b5b5a69
          stepCounter: 333721c2-a1de-446b-b0d6-a040d92f3a17
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2a00047e-55cd-42ce-8df5-4cfc516137f6
                stepCounter: b9264eae-b318-4ace-9d1e-91b0604916d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab93b335-c6f1-4a97-bac5-9695e54a274c
          stepCounter: 333721c2-a1de-446b-b0d6-a040d92f3a17
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: purchase unit volume ased on average FTE
        name: PURCHASE_UNIT_VOLUME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51381f93-29b5-4bff-9ef7-0dbe09734ee0
                stepCounter: b9264eae-b318-4ace-9d1e-91b0604916d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ad50ee9-f4a3-45d1-a458-7dfda9ef2514
          stepCounter: 333721c2-a1de-446b-b0d6-a040d92f3a17
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: ESTIMATED_PURCHASE_UNIT_VOLUME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0b8e267-dbf8-465c-99af-6345c47e6823
          stepCounter: 333721c2-a1de-446b-b0d6-a040d92f3a17
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: dummy dim_age_group_key as this data is based on budgeted FTE not individuals
        name: DIM_AGE_GROUP_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8576e002-bae6-496c-9a84-c01951ea192a
          stepCounter: 333721c2-a1de-446b-b0d6-a040d92f3a17
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_PLANNED_CARE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 896ffb86-ccca-472c-b902-cd1a2d298fe6
          stepCounter: 333721c2-a1de-446b-b0d6-a040d92f3a17
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: DRG_CODE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba278e29-97d0-4cc2-baed-30c414925976
          stepCounter: 333721c2-a1de-446b-b0d6-a040d92f3a17
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Artificial admin_category_reference_no for FTE based Mental Health purhcase unit volumes
        name: CLINICIAN_REFERENCE_NO
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db3385ac-665a-49a2-9a5c-dcbe95e2f6be
          stepCounter: 333721c2-a1de-446b-b0d6-a040d92f3a17
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: source_system
        name: SOURCE_SYSTEM
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "'Mental Health'"
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_CONTRACT_VOLUME_MH_PHASED: b9264eae-b318-4ace-9d1e-91b0604916d4
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_CONTRACT_VOLUME_MH_PHASED
        join:
          joinCondition: FROM {{ ref('TGT','S_CONTRACT_VOLUME_MH_PHASED') }}
        name: S_CONTRACT_ACTIVITY_MH_V
        noLinkRefs: []
  name: S_CONTRACT_ACTIVITY_MH_V
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
