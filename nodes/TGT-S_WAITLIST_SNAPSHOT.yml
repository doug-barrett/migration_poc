fileVersion: 1
id: afdc7b93-0295-4b5a-9dc5-342789cac8bc
name: S_WAITLIST_SNAPSHOT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c80721f-c748-4326-9748-8ab0f5b9d623
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date the snapshot of Open Waitlists was run
        isBusinessKey: true
        name: SNAPSHOTDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bad0f0b2-4563-465b-8dcb-797058e2041a
                stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 789e947d-e84e-42c0-ac8b-6b85de4d682f
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: WAITLIST_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11c12bb8-ea3c-4474-abfd-16738967cf09
                stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2656bee-1300-4f62-b4cd-a36c6a705d4b
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ESPI_COMPLIANT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: baf4fe7e-830a-4aec-b8bc-faef2ae2330a
                stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6fcd814-beb4-4bb3-b1da-f517bd27a501
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITLIST_CLOCK_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 732fc434-0f79-4103-bbfa-32f912fd2f5f
                stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b9e3f91f-da94-4160-b52c-16408af2ad8b
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITING_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47269a5a-c751-422b-ba0d-5123cc8dd07f
                stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d4442c3-a377-49d6-bc09-47667c43d810
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITLIST_DUE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d354a2c-24e5-41d1-89e8-c14c8c4c2b8c
                stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69e550e0-6ebe-43ff-85ff-10b50eb04a54
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: OUTPATIENT_APPOINTMENT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b3bdf2e2-ea5a-4180-a3b8-346af6c313f3
                stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2960f9ca-3f74-4d4f-a4c3-d4a2bd9df54b
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4072825f-c26f-4a65-9ea6-011fd96c4038
                stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b0b67d7-9f46-45bb-ba2a-8c60b22b9f20
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 119e37f9-94f6-41df-a8ef-01a2b84b03da
                stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79e0b90a-82c6-4841-8929-6f57de2270d7
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: VARCHAR(2000)
        defaultValue: ""
        description: ""
        name: WAITLIST_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 018bee13-0f52-47db-aac4-edcfe9e87048
                stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 015240d6-11a5-4b0b-87ad-168c181bb00d
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CERTAINTY_GIVEN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4301eab4-864e-4a5c-b8ca-90056b5e7fe0
                stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 531dd935-4b6e-4dae-b929-0b0168771c86
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Days waited at the end of the current month, if waitlist still open
        name: WAITLIST_WAITING_MONTHEND_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2e7ac777-f629-4e1a-af33-f4c942cc70fb
                stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 373fd074-36f2-4126-8d8d-a9368cc99cb6
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: PIMS Speciality Reference Number
        name: WAITLIST_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84b2ac55-e522-4d62-a88b-fe0585979b5b
                stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea56b0e9-3d80-4e97-bb6e-dc491f33eaf1
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Specialty Code
        name: WAITLIST_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2c4f89e-a39c-4dd2-bc6c-f40529389b64
                stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b75a620-48b7-48c2-a567-cafdd900495a
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Specialty Description
        name: WAITLIST_SPECIALTY_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c3376233-e937-4a2d-85d4-04dfb753bfe8
                stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 28fa33d2-86c9-4224-980a-89ab4c860d79
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LOCAL_CATEGORY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf3d65e4-c8e8-47d9-a85b-83fd29d3cd0b
                stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a583c046-3bed-4123-9a23-923d91c53d8c
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LOCAL_CATEGORY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ca4545ba-c8c5-4e58-b999-6b8c3040ef20
                stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f010e57e-2f2c-46b8-b991-162d9c9a4c32
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: LOCAL_CATEGORY_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02dd162f-fa91-4ad6-8e8c-c52f062647a9
                stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 012b42ef-741b-4235-ae56-cc46a535081a
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: LOCAL_CATEGORY_SUBSPECIALTY_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8db434f9-1933-40b5-bad5-4a63942522d0
                stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14c27562-3230-41c8-95a4-3550ce7f4f27
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: ESPI_TYPE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0491a54c-deec-4b10-8fdc-164166c26252
                stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 788455f9-25b1-4c5a-8dac-42256fc48549
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: referral_priority_desc
        name: WAITLIST_PRIORITY_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 133235a9-752b-40e9-8ac5-9562a6107649
                stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 282627f9-fb8c-4c1e-8cab-6553127a08ed
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LIST_NAME_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72004be9-3bec-4d51-aeca-d14b38b1935f
                stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5beef2fa-cd7c-47a5-9555-ac0c5b652eef
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LIST_NAME_SPECIALTY_FACILITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5667489-0fa9-4771-a59b-fc6010d8ae80
                stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95e1ea74-3dba-40af-bdab-1ed75b1bc627
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Healthcare_Professional_Reference_Number
        name: WAITLIST_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2da4f821-6637-46b2-af21-be76d6e066f6
                stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 582093ae-cae9-43b8-9120-7043536d30fe
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Healthcare_Professional_Code
        name: WAITLIST_CLINICIAN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0473b699-88aa-4bf7-8ee4-bf054f2a6aca
                stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ceaeb30-33f0-4658-8603-0416f7c8362a
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: healthcare_professional_fullname
        name: WAITLIST_CLINICIAN_FULLNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 63b84977-de9b-40bb-905b-7e42b3750490
                stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb4998f4-eb24-43d0-845c-26fad78e33c7
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: WAITLIST_BOOKING_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1912c716-f250-43cd-a8c3-ddd0cfc74754
                stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ed9ad6c-1460-4cf7-aafa-20216c5342ed
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: BOOKED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d67c824a-ec2b-4e22-9c65-761071370de9
                stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8e487a8-b26f-4a1f-9e30-7ab2e9010fe9
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: WAITLIST_REMOVAL_REASON_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 234a8e91-f857-4144-93f2-21c16c0fc332
                stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb6ed176-f596-4089-a9e3-170768ebb6a1
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_waitlist_snapshot.patient_reference_no=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9962a01b-5f3d-4c1a-b371-997edef38d0f
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3a55e63-69b0-42de-8bb2-3bfe1081c0a0
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_WAITLIST_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dcac1c0d-bdd1-4fc8-bc8e-5ddf9246393d
                stepCounter: 19000cde-0ad8-4d32-812e-f0fec7243d19
            transform: IFNULL(dim_waitlist_clinician.dim_waitlist_clinician_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16b9d9de-0652-4106-980f-9fbd705b2988
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_waitlist_snapshot.waitlist_specialty_reference_no=dim_waitlist_specialty.waitlist_specialty_reference_no
        name: DIM_WAITLIST_SPECIALTY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7079b2ef-9f2e-4032-99ec-75819d9db993
                stepCounter: 37897fcd-5ea0-47ee-96e7-b3f1f8b36d87
            transform: IFNULL(dim_waitlist_specialty.dim_waitlist_specialty_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33589214-7d22-4e6a-9556-de110e55bc9b
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_waitlist_snapshot.waitlist_booking_status=dim_waitlist_booked_status.waitlist_booking_status
        name: DIM_WAITLIST_BOOKED_STATUS_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b679af36-25ad-4416-8470-1dc2e15dfd20
                stepCounter: 9fba35bf-0cfe-4408-842d-7613e3ae7895
            transform: IFNULL(dim_waitlist_booked_status.dim_waitlist_booked_status_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2825a6ac-df0b-453c-af96-d3a60d38f636
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_WAITLIST_REMOVAL_REASON_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 65994591-0a22-424f-ab4b-0571e7000955
                stepCounter: c39228fd-cafe-41e2-93c8-28669128f12b
            transform: IFNULL(dim_waitlist_removal_reason.dim_waitlist_removal_reason_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92b3b515-7072-426f-8f8c-2e0d2416fa06
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_WAITLIST_PRIORITY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d5d3320e-8dee-425b-b8a6-f51afefb4ad4
                stepCounter: 44358bb9-9c05-480c-80fc-1195de9552b3
            transform: IFNULL(dim_waitlist_priority.dim_waitlist_priority_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 65e99c3a-d2b5-4707-a7d9-fe34944c9787
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LIST_NAME_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fdb3912a-f8d8-4d6b-bece-bf3c6be3e112
                stepCounter: dadb2ec5-9218-4b98-83b9-011c7f4f1cb6
            transform: IFNULL(dim_list_name.dim_list_name_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15d52ae2-b181-4ad3-b004-142b6c373570
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_ESPI_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8338b9c1-afad-4fb8-bacd-c0938f44ba56
                stepCounter: fa4aa4f0-f734-4a9b-bf53-ca1e2647b7b0
            transform: IFNULL(dim_ESPI_type.dim_ESPI_type_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 630e3dc7-321a-48a9-9816-5f9b7d3d2729
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_LOCAL_CATEGORY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 105edc79-535c-4421-a4ad-bdc7bac7a44a
                stepCounter: 8b5331a4-4c77-49a3-bec1-72b8ba71cae8
            transform: IFNULL(dim_local_category.dim_local_category_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c0b144b-7105-4ef5-8ff9-723c4ef1a73a
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SURGICAL_THEATRE_BOOKING_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7003b21f-043b-4ed9-bb22-c342ad2bc086
                stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33909218-e91c-4edc-a4d2-9fafebf51ddc
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: TCI_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5604f541-f6b3-4929-847f-59da4eed7950
                stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1369fe96-a12c-4ac2-9a96-85554e56d5a4
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Is the patient currently admitted for theis waitlist episode
        name: CURRENT_INPATIENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 43f684d1-c219-4ec9-9f30-50ae9d6111df
                stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 397759e8-718b-4c13-977e-a399c9fa99d5
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_waitlist_snapshot.waitlist_type_reference_no=dim_waitlist_type.waitlist_type_reference_no
        name: DIM_WAITLIST_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0262e650-13e9-4c2c-9e12-83091a68a73f
                stepCounter: be8cd5e0-3def-42d2-83c0-8edb9de13deb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45ede4c4-b7c6-4877-9b49-3e3e11c89bee
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a9c38c89-c6d3-4330-bc5a-fc411ec993a1
                stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ce50e1c-e6ce-41a1-adb2-5fb5e75e58f9
          stepCounter: afdc7b93-0295-4b5a-9dc5-342789cac8bc
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DS_WAITLIST_SNAPSHOT: 094c4583-7743-4ae0-9df4-7b84c010808b
          DIM_WAITLIST_REMOVAL_REASON: c39228fd-cafe-41e2-93c8-28669128f12b
          DIM_ESPI_TYPE: fa4aa4f0-f734-4a9b-bf53-ca1e2647b7b0
          DIM_WAITLIST_PRIORITY: 44358bb9-9c05-480c-80fc-1195de9552b3
          DIM_WAITLIST_CLINICIAN: 19000cde-0ad8-4d32-812e-f0fec7243d19
          DIM_LIST_NAME: dadb2ec5-9218-4b98-83b9-011c7f4f1cb6
          DIM_LOCAL_CATEGORY: 8b5331a4-4c77-49a3-bec1-72b8ba71cae8
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_WAITLIST_SNAPSHOT
          - locationName: TGT
            nodeName: DIM_WAITLIST_REMOVAL_REASON
          - locationName: TGT
            nodeName: DIM_ESPI_TYPE
          - locationName: TGT
            nodeName: DIM_WAITLIST_PRIORITY
          - locationName: TGT
            nodeName: DIM_WAITLIST_CLINICIAN
          - locationName: TGT
            nodeName: DIM_LIST_NAME
          - locationName: TGT
            nodeName: DIM_LOCAL_CATEGORY
        join:
          joinCondition: |-
            FROM {{ ref('TGT','DS_WAITLIST_SNAPSHOT') }} ds_waitlist_snapshot
              JOIN {{ ref('TGT','DIM_WAITLIST_REMOVAL_REASON') }} dim_waitlist_removal_reason
                ON ds_waitlist_snapshot.waitlist_removal_reason_desc = dim_waitlist_removal_reason.waitlist_removal_reason_desc
              JOIN {{ ref('TGT','DIM_ESPI_TYPE') }} dim_ESPI_type
                ON ds_waitlist_snapshot.ESPI_type_desc = dim_ESPI_type.ESPI_type_desc
              JOIN {{ ref('TGT','DIM_WAITLIST_PRIORITY') }} dim_waitlist_priority
                ON ds_waitlist_snapshot.waitlist_priority_desc = dim_waitlist_priority.waitlist_priority_desc
              LEFT JOIN {{ ref('TGT','DIM_WAITLIST_CLINICIAN') }} dim_waitlist_clinician
                ON ds_waitlist_snapshot.waitlist_clinician_reference_no = dim_waitlist_clinician.waitlist_clinician_reference_no
               AND dim_waitlist_clinician.dss_current_flag = 'Y'
              LEFT JOIN {{ ref('TGT','DIM_LIST_NAME') }} dim_list_name
                ON ds_waitlist_snapshot.list_name_reference_no = dim_list_name.list_name_reference_no
               AND dim_list_name.dss_current_flag = 'Y'
              LEFT JOIN {{ ref('TGT','DIM_LOCAL_CATEGORY') }} dim_local_category
                ON ds_waitlist_snapshot.local_category_reference_no = dim_local_category.local_category_reference_no
               AND dim_local_category.dss_current_flag = 'Y'
        name: S_WAITLIST_SNAPSHOT
        noLinkRefs: []
  name: S_WAITLIST_SNAPSHOT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
