fileVersion: 1
id: 1250c506-744c-47b3-af58-4941d8e7123d
name: S_ICD_CODE_1
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "International Diagnostic Codes"
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 734c3f8c-7ec9-431a-ad97-cf4bb625a4a3
          stepCounter: 1250c506-744c-47b3-af58-4941d8e7123d
        config: {}
        dataType: VARCHAR(7)
        defaultValue: ""
        description: ""
        name: ICD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f93cd08-b0f3-48ec-9dcd-e51bc1524e92
                stepCounter: db5ba25c-e027-48bb-a231-26590189c636
            transform: IFNULL(NULLIF(l_reference_ICD_Codes.localcode,''),'UNKWN')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7829a84b-f8ab-486f-96af-65bf06cd2ed1
          stepCounter: 1250c506-744c-47b3-af58-4941d8e7123d
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: ICD_SHORT_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78d9afba-7777-4aac-97f2-488fd41e236f
                stepCounter: db5ba25c-e027-48bb-a231-26590189c636
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e095cef-991f-4779-a77e-575b2dce417a
          stepCounter: 1250c506-744c-47b3-af58-4941d8e7123d
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: ICD_FULL_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9b54a41d-05f0-417b-9d48-58769c0659f9
                stepCounter: db5ba25c-e027-48bb-a231-26590189c636
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c61e3ac5-88c1-4687-aab4-dfe3253ff1d4
          stepCounter: 1250c506-744c-47b3-af58-4941d8e7123d
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ICD_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a769d861-e588-4aae-b899-6b11a3a3afe3
                stepCounter: db5ba25c-e027-48bb-a231-26590189c636
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59fd735f-4d64-46ca-aa89-4d6e4a25d95d
          stepCounter: 1250c506-744c-47b3-af58-4941d8e7123d
        config: {}
        dataType: NVARCHAR(255)
        defaultValue: ""
        description: ""
        name: ICD_CODE_TYPE_DESCR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 08b829d7-a5bd-4bd0-89dc-f3a05d2efc96
                stepCounter: 05166df4-e143-49e7-b12a-a126d23d65bc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 85cfe0e3-7a07-4e3e-bb6d-0e4c5cdb4780
          stepCounter: 1250c506-744c-47b3-af58-4941d8e7123d
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: ICD_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cf6bf6a4-d11c-4352-a794-4c4eba3f1557
                stepCounter: db5ba25c-e027-48bb-a231-26590189c636
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 19c204ee-e1c6-4b20-b273-ae55c7ed74cd
          stepCounter: 1250c506-744c-47b3-af58-4941d8e7123d
        config: {}
        dataType: DECIMAL(5,2)
        defaultValue: ""
        description: ""
        name: ICD_VERSION_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cf6bf6a4-d11c-4352-a794-4c4eba3f1557
                stepCounter: db5ba25c-e027-48bb-a231-26590189c636
            transform: CONVERT(decimal(5,2),REPLACE(l_reference_ICD_codes.version,'_','.'))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1b8a6f8-1fa6-4743-b1ef-bb0b9bf285d2
          stepCounter: 1250c506-744c-47b3-af58-4941d8e7123d
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PARTIALCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 82e86d51-234b-4db3-9fb1-941b4d27da6b
                stepCounter: db5ba25c-e027-48bb-a231-26590189c636
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d06354b-0f1e-48a4-bcdd-effdf0248c50
          stepCounter: 1250c506-744c-47b3-af58-4941d8e7123d
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: MOREPARTIALCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 889ec984-4952-4aa8-ba5e-899fe254e789
                stepCounter: db5ba25c-e027-48bb-a231-26590189c636
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c46d17a-fc69-4fe5-9b21-526c317fe1e9
          stepCounter: 1250c506-744c-47b3-af58-4941d8e7123d
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: BLOCKCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a7d3a7b-306c-4cf5-8596-39bc963090e2
                stepCounter: db5ba25c-e027-48bb-a231-26590189c636
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98f45c1c-09b9-4a25-ac31-efe8ee4c9724
          stepCounter: 1250c506-744c-47b3-af58-4941d8e7123d
        config: {}
        dataType: BIT
        defaultValue: ""
        description: ""
        name: NEW
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6ce0083-905b-420f-b150-f2668a0fa998
                stepCounter: db5ba25c-e027-48bb-a231-26590189c636
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94af935e-d539-4e4b-a4c3-b51d05b9f46f
          stepCounter: 1250c506-744c-47b3-af58-4941d8e7123d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1449eea7-d305-412b-9c21-d55fe232f75c
                stepCounter: db5ba25c-e027-48bb-a231-26590189c636
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6609f4e5-5751-4ee5-8ed7-d53bdcc25c83
          stepCounter: 1250c506-744c-47b3-af58-4941d8e7123d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 36e12d89-97ea-4c47-b014-95a0d0cc270a
                stepCounter: db5ba25c-e027-48bb-a231-26590189c636
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 738d5140-f1be-4642-9c70-4d79dc8bccf0
          stepCounter: 1250c506-744c-47b3-af58-4941d8e7123d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ICD_ROW_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ROW_NUMBER() OVER (PARTITION BY l_reference_ICD_codes.localcode ORDER BY VERSION DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 552f7e5e-14e1-418e-a4dd-cbb022ce5e9a
          stepCounter: 1250c506-744c-47b3-af58-4941d8e7123d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ICD_DUP_ROW_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ROW_NUMBER() OVER (PARTITION BY l_reference_ICD_codes.localcode, l_reference_ICD_codes.version ORDER BY VERSION DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b3876e61-e578-4a05-9ad1-931285a85f31
          stepCounter: 1250c506-744c-47b3-af58-4941d8e7123d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          L_REFERENCE_ICD_CODES: db5ba25c-e027-48bb-a231-26590189c636
          L_REFERENCE_MOH_CLINICAL_CODE_TYPE: 05166df4-e143-49e7-b12a-a126d23d65bc
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: L_REFERENCE_ICD_CODES
          - locationName: TGT
            nodeName: L_REFERENCE_MOH_CLINICAL_CODE_TYPE
        join:
          joinCondition: |-
            FROM {{ ref('TGT','L_REFERENCE_ICD_CODES') }} l_reference_ICD_Codes
              LEFT JOIN {{ ref('TGT','L_REFERENCE_MOH_CLINICAL_CODE_TYPE') }} l_reference_MOH_clinical_code_type
                ON l_reference_ICD_Codes.grouping = l_reference_MOH_clinical_code_type.clinical_code_table_type
        name: S_ICD_CODE_1
        noLinkRefs: []
  name: S_ICD_CODE_1
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
