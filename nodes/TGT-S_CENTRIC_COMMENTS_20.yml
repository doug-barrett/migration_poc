fileVersion: 1
id: a6dae28f-2628-448c-abb8-f5edbf0a742e
name: S_CENTRIC_COMMENTS_20
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48f724a9-4657-481b-a604-59465ae757e0
          stepCounter: a6dae28f-2628-448c-abb8-f5edbf0a742e
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: STREAM_USED
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN previous_stream IS NULL   THEN 1
                          WHEN previous_stream <> stream THEN 1
                          ELSE 0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b8dcd9a-28bb-40c6-bf65-6ef5db262872
          stepCounter: a6dae28f-2628-448c-abb8-f5edbf0a742e
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 702dfc9d-df5e-42d8-86f8-9e68f29c462c
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e6f0e10-2174-42f4-b719-e9b9fe535a35
          stepCounter: a6dae28f-2628-448c-abb8-f5edbf0a742e
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: STREAM_USED_ED
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN previous_stream_ED IS NULL   THEN 1
                          WHEN previous_stream_ED <> stream THEN 1
                          ELSE 0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a29176ff-dc40-4eb7-9897-00c913a75668
          stepCounter: a6dae28f-2628-448c-abb8-f5edbf0a742e
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd639e47-2bda-43ab-bdd6-8ccb7832d4e1
                stepCounter: 0d7f9003-15a5-4132-9bb4-9030b6a90a6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 351d00bb-0cec-4107-849a-4b13aeb2fcf2
          stepCounter: a6dae28f-2628-448c-abb8-f5edbf0a742e
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ATTENDANCE_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2a5a83f6-fd27-4864-8df8-8939aa863abe
                stepCounter: 0d7f9003-15a5-4132-9bb4-9030b6a90a6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8656aa0-2074-4db6-ba94-b5338321ef62
          stepCounter: a6dae28f-2628-448c-abb8-f5edbf0a742e
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: STREAM_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 99afd648-54fd-4849-8d7a-1e6ff695716d
                stepCounter: 0d7f9003-15a5-4132-9bb4-9030b6a90a6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7df01ce-d7ca-43e4-89ac-ff79448e9ae3
          stepCounter: a6dae28f-2628-448c-abb8-f5edbf0a742e
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: STREAM_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 594b7728-df51-4c14-9fc0-e7e15d4bdd6b
                stepCounter: 0d7f9003-15a5-4132-9bb4-9030b6a90a6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f188fd7e-0deb-449e-bcc7-3fab1a7380cf
          stepCounter: a6dae28f-2628-448c-abb8-f5edbf0a742e
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f13515a7-2078-4967-aa67-a1a245c5d599
                stepCounter: 0d7f9003-15a5-4132-9bb4-9030b6a90a6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8889c29b-4e03-44e5-94d0-81d09a3f392b
          stepCounter: a6dae28f-2628-448c-abb8-f5edbf0a742e
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: ""
        name: TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d4e8dc86-1924-42ad-ae41-317b8a833305
                stepCounter: 0d7f9003-15a5-4132-9bb4-9030b6a90a6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c559679-08ea-4c80-83b5-6ae5b5c886e8
          stepCounter: a6dae28f-2628-448c-abb8-f5edbf0a742e
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 271c71d7-6ce8-4f33-b2f8-d2d006e13e6f
                stepCounter: 0d7f9003-15a5-4132-9bb4-9030b6a90a6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c26b73d6-54bb-4029-ab9f-2f94e67fce15
          stepCounter: a6dae28f-2628-448c-abb8-f5edbf0a742e
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PREVIOUS_STREAM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4d84de7-a84f-4079-86f0-ed396d56ffbf
                stepCounter: 0d7f9003-15a5-4132-9bb4-9030b6a90a6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a12bc6a9-dadc-4587-988e-587faf4c4264
          stepCounter: a6dae28f-2628-448c-abb8-f5edbf0a742e
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4f97a7e-049a-45f9-900c-dbdcfa9627bd
                stepCounter: 0d7f9003-15a5-4132-9bb4-9030b6a90a6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e84fc0e6-3e0c-4061-9322-ed20e8096871
          stepCounter: a6dae28f-2628-448c-abb8-f5edbf0a742e
        config: {}
        dataType: NVARCHAR(MAX)
        defaultValue: ""
        description: ""
        name: STREAM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dd039675-e20e-41e8-9c18-601ca5de2556
                stepCounter: 0d7f9003-15a5-4132-9bb4-9030b6a90a6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82d74a3f-d41d-4550-bc94-74a4ac52a663
          stepCounter: a6dae28f-2628-448c-abb8-f5edbf0a742e
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: CREATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5b85da2c-161d-4d23-a540-3d233e192013
                stepCounter: 0d7f9003-15a5-4132-9bb4-9030b6a90a6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 409d78c5-38be-46f6-9951-a8c48d7f599d
          stepCounter: a6dae28f-2628-448c-abb8-f5edbf0a742e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5b8e88d-87cf-4b00-8c32-a7e16a55b0fd
                stepCounter: 0d7f9003-15a5-4132-9bb4-9030b6a90a6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d4b0d56-c634-4275-9a8d-544d834c14b0
          stepCounter: a6dae28f-2628-448c-abb8-f5edbf0a742e
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DELETED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: af645e18-ac16-422d-8b8a-ec1c19cafb4c
                stepCounter: 0d7f9003-15a5-4132-9bb4-9030b6a90a6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f25d9cb4-58d4-4c37-984c-260181c72e47
          stepCounter: a6dae28f-2628-448c-abb8-f5edbf0a742e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DELETED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ee4d16f-504f-42d6-83f8-70532d1e23fd
                stepCounter: 0d7f9003-15a5-4132-9bb4-9030b6a90a6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b2d9335-d629-4ec1-8515-2e856a0b6d4d
          stepCounter: a6dae28f-2628-448c-abb8-f5edbf0a742e
        config: {}
        dataType: BIT
        defaultValue: ""
        description: ""
        name: DEPRECATED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d6602c5-0b3e-49bc-ae47-42f959debab7
                stepCounter: 0d7f9003-15a5-4132-9bb4-9030b6a90a6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d576a512-72ad-487d-946e-564b11efc3ce
          stepCounter: a6dae28f-2628-448c-abb8-f5edbf0a742e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_CENTRIC_COMMENTS_10: 0d7f9003-15a5-4132-9bb4-9030b6a90a6b
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_CENTRIC_COMMENTS_10
        join:
          joinCondition: |-
            FROM {{ ref('TGT','S_CENTRIC_COMMENTS_10') }} s_centric_comments_10
              LEFT JOIN dim.dim_patient
                ON s_centric_comments_10.patient_NHI =dim.dim_patient.patient_NHI
               AND NHI_sequence=1
        name: S_CENTRIC_COMMENTS_20
        noLinkRefs: []
  name: S_CENTRIC_COMMENTS_20
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
