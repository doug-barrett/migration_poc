fileVersion: 1
id: 917569ee-7b85-4cfd-9c40-e43a1070e14a
name: S_ED_ATTENDANCE_05_V
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: "Combine all source data required to build the ED Attendance Fact"
  isMultisource: false
  locationName: TGT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 695b99ad-5036-4cf5-9ff0-3ac938099aa3
          stepCounter: 917569ee-7b85-4cfd-9c40-e43a1070e14a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Encounter unique identifier
        name: IDENTIFIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 98e7bbf9-19d9-4ad3-9762-fc48190944fa
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 865108a0-47e9-480f-bc10-b73483dc6dd4
          stepCounter: 917569ee-7b85-4cfd-9c40-e43a1070e14a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Attendance ref no.
        isBusinessKey: true
        name: AEATT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f105f398-1042-471d-ba39-935c000ef834
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce23da33-b40d-4870-b454-8a04f19cb542
          stepCounter: 917569ee-7b85-4cfd-9c40-e43a1070e14a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: PIMS health organisation ref no
        name: HEORG_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 607e1d92-8895-4962-a382-8f9bf18d0d79
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dfe8a3e2-8b2b-4d54-8ce9-adbafe139382
          stepCounter: 917569ee-7b85-4cfd-9c40-e43a1070e14a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: PIMS service point ref no
        name: SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d738d0ff-4a44-4a6f-8113-fe1750dbf3df
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a500d242-35ca-475c-8fae-6b9208029614
          stepCounter: 917569ee-7b85-4cfd-9c40-e43a1070e14a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Service_Point_Code
        name: SERVICE_POINT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7e926bf-5c30-4064-a2df-9b2fd69159e4
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74c5961d-d8a3-4369-b594-e9da4c0bcd0f
          stepCounter: 917569ee-7b85-4cfd-9c40-e43a1070e14a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: health_org_code
        name: HEALTH_ORG_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91ffbce1-63b0-4fc6-accb-79ec28037c7b
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d80429a-ed5c-4252-9079-27a025618819
          stepCounter: 917569ee-7b85-4cfd-9c40-e43a1070e14a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Intended specialty ref no.
        name: INTEND_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0193af51-0c9d-40d9-9fa5-472f8d2e60f8
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8f78cc3-12b0-4b8f-8f67-4015361636c7
          stepCounter: 917569ee-7b85-4cfd-9c40-e43a1070e14a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Referral ref no.
        name: REFRL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 662697ec-c773-4224-a540-21a14bd62d2b
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7c95eac-b3a8-4eee-b4b3-0a62fed97cff
          stepCounter: 917569ee-7b85-4cfd-9c40-e43a1070e14a
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Referral date and time.
        name: REFERRAL_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a89deb48-364c-4f53-bdc5-442e98eea59d
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9438f991-fab6-47fc-a054-38efe6ca8ccb
          stepCounter: 917569ee-7b85-4cfd-9c40-e43a1070e14a
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Visit date and time.
        name: ARRIVED_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50f8e45e-6bbe-4ab4-b10f-c2c21a2fabfb
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 123b7c8d-e8b7-4b2d-9973-29c01c47c326
          stepCounter: 917569ee-7b85-4cfd-9c40-e43a1070e14a
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time patient discharged.
        name: DEPARTED_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7336d1a4-8c0b-4d69-aea3-ab2ed99d57ba
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6de05ce0-b2f9-43d9-ae0b-37a8fbd0b013
          stepCounter: 917569ee-7b85-4cfd-9c40-e43a1070e14a
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Medical discharge date.
        name: MED_DISCH_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e9e2a84-16db-47bb-a1bb-92e7d30ebd75
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b438971e-95c1-4769-9157-8519fdb855ac
          stepCounter: 917569ee-7b85-4cfd-9c40-e43a1070e14a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: discharge_destination_reference_no
        name: DISDE_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 32018e16-9ee3-494b-b6ab-38dc3895bd62
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e4305917-7d16-4cd8-a0f1-1fd0fa73da8e
          stepCounter: 917569ee-7b85-4cfd-9c40-e43a1070e14a
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: Discharge destination.
        name: DISCHARGE_DESTINATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2c7c6bf-5e4a-4ec9-b130-7a472baaa347
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64a003e8-6a24-43ea-8659-3e5f12751709
          stepCounter: 917569ee-7b85-4cfd-9c40-e43a1070e14a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: discharge_reason_reference_no
        name: ATDIS_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91000b7b-f068-46df-b7be-2c4a334d77ee
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 921b3b30-3376-4e21-b4ea-cb039a31add0
          stepCounter: 917569ee-7b85-4cfd-9c40-e43a1070e14a
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: Reason for discharge code
        name: DISCHARGE_REASON_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b156df08-0e30-4854-bba4-931d0fc0cff8
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dd112a65-4733-4174-b085-4771011796f1
          stepCounter: 917569ee-7b85-4cfd-9c40-e43a1070e14a
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: YN flag indicating whether patient self-discharged.
        name: SELF_DISCHARGE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a3deb8f-3a25-4751-8212-95b137edb182
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c19f995-a95e-4326-884a-734ebf4500f9
          stepCounter: 917569ee-7b85-4cfd-9c40-e43a1070e14a
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: ARMOD_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2beab26-6243-4755-a444-086415723d37
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b64a2098-793f-4a45-a57e-2072722b3fbb
          stepCounter: 917569ee-7b85-4cfd-9c40-e43a1070e14a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Attendance category ref no
        name: ATCAT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 31987dac-3d20-4035-a638-3bd5fd234123
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72f54848-8682-4392-8362-4fef8e63c218
          stepCounter: 917569ee-7b85-4cfd-9c40-e43a1070e14a
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: attendance_category code.
        name: ATTENDANCE_CATEGORY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8d7a970-eb27-4711-8daf-ad9ac97a9c2b
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9442b168-87eb-4f6c-b32e-038a2dd80b6e
          stepCounter: 917569ee-7b85-4cfd-9c40-e43a1070e14a
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Y/N flag indicating whether this is a planned return visit.
        name: PLANNED_RETURN_VISIT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: adfdd7f9-db8a-4012-bd5e-53d8bf74dcd9
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee812662-ec8f-4985-9109-abd89b9c7635
          stepCounter: 917569ee-7b85-4cfd-9c40-e43a1070e14a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Patient ref no.
        name: PATNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ccc5b70b-93b2-4083-8a6a-640bcf63f44e
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 90b9c203-a619-4a75-818b-841fbb7c560d
          stepCounter: 917569ee-7b85-4cfd-9c40-e43a1070e14a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2a4df437-3fd4-444d-9f8a-48fd0fe237e7
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5322a53-8c83-4320-97ff-8939c4e9dadc
          stepCounter: 917569ee-7b85-4cfd-9c40-e43a1070e14a
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Patient_Date_Of_Birth
        name: PATIENT_DATE_OF_BIRTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27f35118-9dcf-4971-8a3e-92c55c31efab
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 041f16e3-b090-43d3-9441-43f4751afa7a
          stepCounter: 917569ee-7b85-4cfd-9c40-e43a1070e14a
        config: {}
        dataType: NVARCHAR(30)
        defaultValue: ""
        description: ""
        name: DOMICILE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9953158b-3969-40a6-aaba-022c192d5ce7
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 35f31516-71c7-42a8-a674-d61b13b44a3a
          stepCounter: 917569ee-7b85-4cfd-9c40-e43a1070e14a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: patient_age_on_arrival_years
        name: PATIENT_AGE_ON_ARRIVAL_YEARS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6894a960-4b85-4ac3-8b77-c4bd4dcb2031
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3df2b208-2328-4f4d-9834-7c0992fd5803
          stepCounter: 917569ee-7b85-4cfd-9c40-e43a1070e14a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: patient_age_on_arrival_months
        name: PATIENT_AGE_ON_ARRIVAL_MONTHS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec05f7c5-f602-4bf4-b814-e6b5bb95b71f
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c11aea5c-b54d-4ce4-9995-5b4e8341dbc5
          stepCounter: 917569ee-7b85-4cfd-9c40-e43a1070e14a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: patient_visit_num
        name: PATIENT_VISIT_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84c63b0a-4b04-4cbd-88d1-fd5535971698
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 367e4ddd-43a1-46e2-8ded-0f126c5f1e16
          stepCounter: 917569ee-7b85-4cfd-9c40-e43a1070e14a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: patient_visit_count
        name: PATIENT_VISIT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4626c56b-2c1b-4ac2-8b22-646265b31c6d
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3bd10734-e590-4ffe-bcbd-1d017d736f86
          stepCounter: 917569ee-7b85-4cfd-9c40-e43a1070e14a
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2040732b-30a6-4967-9684-d0565f6f4b79
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae6c7a5f-4497-4dfd-9f51-a26fc3f2574b
          stepCounter: 917569ee-7b85-4cfd-9c40-e43a1070e14a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: USER_CREATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 550d8577-9040-4bdb-b6fd-5386704a08b0
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9762b11-5073-440e-aa30-e3ad85bfc2ea
          stepCounter: 917569ee-7b85-4cfd-9c40-e43a1070e14a
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIF_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0af3e531-c057-445b-9e6a-87a64f3b4547
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01ae4182-602d-4956-a7fe-8503e83cd541
          stepCounter: 917569ee-7b85-4cfd-9c40-e43a1070e14a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: USER_MODIF
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 899d6141-3a92-4863-9440-2bbfdacea541
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72275bc8-12cd-4589-9feb-d9e6eb279921
          stepCounter: 917569ee-7b85-4cfd-9c40-e43a1070e14a
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: NURSE_SEEN_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c2ef785c-5d49-4249-80f2-fd340593073b
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2dc58e3e-f513-472b-83c2-f092a5e9b842
          stepCounter: 917569ee-7b85-4cfd-9c40-e43a1070e14a
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NURSE_SEEN_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a89ce6d-3364-4983-8aee-4f640fe6733c
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8090498b-a80d-47de-8ecb-d575cacae275
          stepCounter: 917569ee-7b85-4cfd-9c40-e43a1070e14a
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: NEREF_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19db2258-194b-49e3-b2a6-c5c14d37a95c
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae25a4a2-8cca-4b5f-a985-91bb97c17b71
          stepCounter: 917569ee-7b85-4cfd-9c40-e43a1070e14a
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52131d11-59bf-4611-ada0-39abd05f9d21
                stepCounter: 94527cff-ab41-440e-8de3-e7da6726bc81
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DS_SHARED_ED_ATTENDANCE: 94527cff-ab41-440e-8de3-e7da6726bc81
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_SHARED_ED_ATTENDANCE
        join:
          joinCondition: |-
            FROM {{ ref('TGT','DS_SHARED_ED_ATTENDANCE') }}
             WHERE ds_shared_ed_ATTENDANCE.dss_update_time > CONVERT(datetime,'{{ parameters.pa_ED_Incremental_Store }}',120)
        name: S_ED_ATTENDANCE_05_V
        noLinkRefs: []
  name: S_ED_ATTENDANCE_05_V
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
