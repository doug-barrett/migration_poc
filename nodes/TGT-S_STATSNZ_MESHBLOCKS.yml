fileVersion: 1
id: 29b3e52d-0479-4d6c-b955-053ce900d23f
name: S_STATSNZ_MESHBLOCKS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05d237d1-2127-451f-8ad0-dc52652fae96
          stepCounter: 29b3e52d-0479-4d6c-b955-053ce900d23f
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: ""
        name: MB_VERSION_REV_SEQ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07cf485f-916d-4269-9a89-66b85b2ad184
                stepCounter: 416d601f-ec0a-45c0-9ef5-be8f40bef828
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1bf59b0c-bb4d-4a31-b144-01368a0139f8
          stepCounter: 29b3e52d-0479-4d6c-b955-053ce900d23f
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: FILE_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b1b31e6-f0f8-4c32-88f3-3b2722a9a90f
                stepCounter: 416d601f-ec0a-45c0-9ef5-be8f40bef828
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04d0101a-f508-4c31-b881-b01f16e15ad8
          stepCounter: 29b3e52d-0479-4d6c-b955-053ce900d23f
        config: {}
        dataType: NVARCHAR(128)
        defaultValue: ""
        description: ""
        name: MB_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1a83659-43b8-49ba-822f-171f4af51c11
                stepCounter: 416d601f-ec0a-45c0-9ef5-be8f40bef828
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9ceeb5b-e630-451e-a9aa-2db58bc3668d
          stepCounter: 29b3e52d-0479-4d6c-b955-053ce900d23f
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: MB_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4d1e77f8-b5cb-4f51-97e4-26cbd1e024b1
                stepCounter: 416d601f-ec0a-45c0-9ef5-be8f40bef828
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e59f90c0-34cb-41ef-9018-eb414b240baf
          stepCounter: 29b3e52d-0479-4d6c-b955-053ce900d23f
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: DOMICILE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a6ff4da5-6780-417d-8673-6bfc073c2da4
                stepCounter: 416d601f-ec0a-45c0-9ef5-be8f40bef828
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c038075-1c62-4c66-9766-a777428e68cc
          stepCounter: 29b3e52d-0479-4d6c-b955-053ce900d23f
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: DHB_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3179485b-578c-4718-9cd0-7e12fdf7339e
                stepCounter: 416d601f-ec0a-45c0-9ef5-be8f40bef828
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a7103c7-d6d2-42ab-8b9a-61ca9bdf78a5
          stepCounter: 29b3e52d-0479-4d6c-b955-053ce900d23f
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: DHB_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c556299-456e-4f92-aa7f-3256ed08a00b
                stepCounter: 416d601f-ec0a-45c0-9ef5-be8f40bef828
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 529bc505-e90a-472a-a993-c637b09dd6eb
          stepCounter: 29b3e52d-0479-4d6c-b955-053ce900d23f
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: URBAN_RURAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1f66a0d-1a94-4021-8a0f-ec250484fc4d
                stepCounter: 416d601f-ec0a-45c0-9ef5-be8f40bef828
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 60fb194c-4603-4210-9fb4-17237d04d696
          stepCounter: 29b3e52d-0479-4d6c-b955-053ce900d23f
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: URBAN_RURAL_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4491e979-a198-4e44-b9d8-7e4179241711
                stepCounter: 416d601f-ec0a-45c0-9ef5-be8f40bef828
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d7bbebf-1958-4dbf-9a86-c8d841a350b4
          stepCounter: 29b3e52d-0479-4d6c-b955-053ce900d23f
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: URBAN_RURAL_INDICATOR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e3726989-cdb4-4cc2-a604-4e086f133ede
                stepCounter: 416d601f-ec0a-45c0-9ef5-be8f40bef828
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2765ab63-2b37-4090-aaf2-9438d91d678d
          stepCounter: 29b3e52d-0479-4d6c-b955-053ce900d23f
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: URBAN_RURAL_INDICATOR_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6bc1088d-f828-4c26-9429-62e5ecd2562c
                stepCounter: 416d601f-ec0a-45c0-9ef5-be8f40bef828
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 08d46542-a2f5-4dd5-8ce3-60a8e78713b1
          stepCounter: 29b3e52d-0479-4d6c-b955-053ce900d23f
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: TERRITORIAL_AUTHORITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8a55be3f-2dcc-417c-a336-56890282a685
                stepCounter: 416d601f-ec0a-45c0-9ef5-be8f40bef828
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3bbe782e-4bb2-4efe-9146-0fc14a3ea509
          stepCounter: 29b3e52d-0479-4d6c-b955-053ce900d23f
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: TERRITORIAL_AUTHORITY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a5c3b5c-d8fb-4709-bc81-f7c8c4989e5a
                stepCounter: 416d601f-ec0a-45c0-9ef5-be8f40bef828
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34c19943-61fa-4eca-bb2f-a9790fa93776
          stepCounter: 29b3e52d-0479-4d6c-b955-053ce900d23f
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: WARD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d448a40-f153-40a8-9c5c-2234711ad2b9
                stepCounter: 416d601f-ec0a-45c0-9ef5-be8f40bef828
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0728742d-8713-4b15-8a5c-b1a689640a0b
          stepCounter: 29b3e52d-0479-4d6c-b955-053ce900d23f
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: WARD_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 030a23ea-8fe7-4886-a360-c8bcb039524e
                stepCounter: 416d601f-ec0a-45c0-9ef5-be8f40bef828
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39612d72-e29d-4614-b3a9-668ba8068561
          stepCounter: 29b3e52d-0479-4d6c-b955-053ce900d23f
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: COMMUNITY_BOARD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c11654a-687a-43c4-987c-eab801dcf654
                stepCounter: 416d601f-ec0a-45c0-9ef5-be8f40bef828
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f228ba8-d521-44d9-a2bd-0f575d37ab10
          stepCounter: 29b3e52d-0479-4d6c-b955-053ce900d23f
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: COMMUNITY_BOARD_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 49f046fa-a8f7-47da-836e-256c744ca1fa
                stepCounter: 416d601f-ec0a-45c0-9ef5-be8f40bef828
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df5185b2-36ca-4da4-897a-2ff77d146196
          stepCounter: 29b3e52d-0479-4d6c-b955-053ce900d23f
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: TERRITORIAL_AUTHORITY_SUB_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78347a47-2c34-4a08-9d32-b9beccce3848
                stepCounter: 416d601f-ec0a-45c0-9ef5-be8f40bef828
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98d2751b-bf31-4316-a069-be3098fa2c74
          stepCounter: 29b3e52d-0479-4d6c-b955-053ce900d23f
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: TERRITORIAL_AUTHORITY_SUB_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec0a6942-22af-404d-b14a-fa94d1a57cc0
                stepCounter: 416d601f-ec0a-45c0-9ef5-be8f40bef828
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 043a2684-4af9-4cb1-89aa-6de545950fae
          stepCounter: 29b3e52d-0479-4d6c-b955-053ce900d23f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: NZ_DEPRIVATION_DECILE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 25206a54-47fe-4d35-9424-746a68a62535
                stepCounter: 416d601f-ec0a-45c0-9ef5-be8f40bef828
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0af08f9c-29d8-41ad-b013-6092209c37c0
          stepCounter: 29b3e52d-0479-4d6c-b955-053ce900d23f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: NZ_DEPRIVATION_QUINTILE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 25206a54-47fe-4d35-9424-746a68a62535
                stepCounter: 416d601f-ec0a-45c0-9ef5-be8f40bef828
            transform: |-
              CASE WHEN l_reference_STATSNZ_MeshBlocks.NZ_deprivation_decile IN (1,2)  THEN 1
                          WHEN l_reference_STATSNZ_MeshBlocks.NZ_deprivation_decile IN (3,4)  THEN 2
                          WHEN l_reference_STATSNZ_MeshBlocks.NZ_deprivation_decile IN (5,6)  THEN 3
                          WHEN l_reference_STATSNZ_MeshBlocks.NZ_deprivation_decile IN (7,8)  THEN 4
                          WHEN l_reference_STATSNZ_MeshBlocks.NZ_deprivation_decile IN (9,10) THEN 5
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 43e43bb6-519e-47ee-9319-b3de1189cc4c
          stepCounter: 29b3e52d-0479-4d6c-b955-053ce900d23f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: NZ_DEPRIVATION_SCORE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c284ffb-f8b9-423c-b38f-249a9d513bd4
                stepCounter: 416d601f-ec0a-45c0-9ef5-be8f40bef828
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f2b98b5-0835-484c-9750-266c0624840b
          stepCounter: 29b3e52d-0479-4d6c-b955-053ce900d23f
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: NZ_DEPRIVATION_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f094d4c-296b-40a8-899c-7be9198b8094
                stepCounter: 416d601f-ec0a-45c0-9ef5-be8f40bef828
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6efb1ef2-fbae-4b56-96e7-16bb8b190804
          stepCounter: 29b3e52d-0479-4d6c-b955-053ce900d23f
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: ODS_CURRENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9f7850a5-0d12-4b11-beb1-3aaca2929aee
                stepCounter: 416d601f-ec0a-45c0-9ef5-be8f40bef828
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a92b66a-4252-4b2b-b6f6-61ec70626d50
          stepCounter: 29b3e52d-0479-4d6c-b955-053ce900d23f
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Record source.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d8fc335f-956c-497e-a79c-c9db2c2bfb72
                stepCounter: 416d601f-ec0a-45c0-9ef5-be8f40bef828
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f267461-c874-48a3-b0a0-b24c94580359
          stepCounter: 29b3e52d-0479-4d6c-b955-053ce900d23f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Load date.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e1e1b5c-f885-4bd5-9f5a-7142cd73693e
                stepCounter: 416d601f-ec0a-45c0-9ef5-be8f40bef828
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1214ac28-c7c0-44af-bcdd-412155bdc44d
          stepCounter: 29b3e52d-0479-4d6c-b955-053ce900d23f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          L_REFERENCE_STATSNZ_MESHBLOCKS: 416d601f-ec0a-45c0-9ef5-be8f40bef828
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: L_REFERENCE_STATSNZ_MESHBLOCKS
        join:
          joinCondition: FROM {{ ref('TGT','L_REFERENCE_STATSNZ_MESHBLOCKS') }} l_reference_STATSNZ_MeshBlocks
        name: S_STATSNZ_MESHBLOCKS
        noLinkRefs: []
  name: S_STATSNZ_MESHBLOCKS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
