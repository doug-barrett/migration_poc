fileVersion: 1
id: f1cce021-533c-4ae8-a40b-c8671fb6993f
name: S_LKP_MCC_MASTERCARD_MROC_CURRENT
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DATAVAULT_BUSINESS_VAULT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69de6dd1-815f-47a3-9701-e1557878c686
          stepCounter: f1cce021-533c-4ae8-a40b-c8671fb6993f
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: ""
        name: HK_H_LKP_MCC_MASTERCARD
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e926f79b-e1da-42c1-b9ab-28f85001c9d7
                stepCounter: 2125f912-d1e5-42c2-91ac-bb6a445b4ae3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab976f58-bf72-4148-a4b2-8a567159ff95
          stepCounter: f1cce021-533c-4ae8-a40b-c8671fb6993f
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: MCC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed238143-4899-4434-a2e6-475823dba1c4
                stepCounter: 2125f912-d1e5-42c2-91ac-bb6a445b4ae3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b2e2930-73f3-411c-ace5-661749981a17
          stepCounter: f1cce021-533c-4ae8-a40b-c8671fb6993f
        config: {}
        dataType: VARCHAR(200)
        defaultValue: ""
        description: ""
        name: ISO_RANGE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d26017a9-76e8-4e92-9a68-b71c69cac5df
                stepCounter: 2125f912-d1e5-42c2-91ac-bb6a445b4ae3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50f91adc-1895-4b93-9610-3d5c7d2feb8f
          stepCounter: f1cce021-533c-4ae8-a40b-c8671fb6993f
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: ISO_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a4de054-86f3-49bb-9264-6ade128abbfd
                stepCounter: 2125f912-d1e5-42c2-91ac-bb6a445b4ae3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc32d6d6-a159-458c-a185-e4be63b12001
          stepCounter: f1cce021-533c-4ae8-a40b-c8671fb6993f
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: MASTER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c4b4abc-0f8e-47f9-99ca-77a77ba184aa
                stepCounter: 2125f912-d1e5-42c2-91ac-bb6a445b4ae3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d6387f9-d06a-446d-9a29-4caed2e570c9
          stepCounter: f1cce021-533c-4ae8-a40b-c8671fb6993f
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: MASTER_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fdfb1913-171e-42f5-9aca-394b1664880b
                stepCounter: 2125f912-d1e5-42c2-91ac-bb6a445b4ae3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fef632d9-6947-42b4-9452-e509416cb614
          stepCounter: f1cce021-533c-4ae8-a40b-c8671fb6993f
        config: {}
        dataType: VARCHAR(400)
        defaultValue: ""
        description: ""
        name: TCC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 018d30ed-0b38-4e11-a624-b8f53fbbce74
                stepCounter: 2125f912-d1e5-42c2-91ac-bb6a445b4ae3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0316d739-6f01-4392-9931-38062c7d20ad
          stepCounter: f1cce021-533c-4ae8-a40b-c8671fb6993f
        config: {}
        dataType: VARCHAR(200)
        defaultValue: ""
        description: ""
        name: TCC_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8d51d17f-a27b-4012-987a-a3632a95c156
                stepCounter: 2125f912-d1e5-42c2-91ac-bb6a445b4ae3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e345d453-b74d-409e-9eb5-84fc5c23e677
          stepCounter: f1cce021-533c-4ae8-a40b-c8671fb6993f
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: TCC_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48741787-8347-47e0-903a-32560d721af6
                stepCounter: 2125f912-d1e5-42c2-91ac-bb6a445b4ae3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 065d3f6a-67bc-4200-9e87-3c4a5a169190
          stepCounter: f1cce021-533c-4ae8-a40b-c8671fb6993f
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: MASTER_MCC_CATEG_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00980b53-741b-4441-82af-4abb9761c1ac
                stepCounter: 2125f912-d1e5-42c2-91ac-bb6a445b4ae3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 289773c6-9f2a-4562-a5dd-b1a646004286
          stepCounter: f1cce021-533c-4ae8-a40b-c8671fb6993f
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: MASTER_MCC_CATEG_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77ecd231-9ea7-42e9-972c-2f2a65392892
                stepCounter: 2125f912-d1e5-42c2-91ac-bb6a445b4ae3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1918bb31-0278-447c-bdf4-940466610d84
          stepCounter: f1cce021-533c-4ae8-a40b-c8671fb6993f
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: GEOGRAPHY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9f91047b-0e14-42b1-9e90-5b541b259cc2
                stepCounter: 2125f912-d1e5-42c2-91ac-bb6a445b4ae3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df93b74b-a219-4de1-a449-6e0a59ce6c75
          stepCounter: f1cce021-533c-4ae8-a40b-c8671fb6993f
        config: {}
        dataType: VARCHAR(200)
        defaultValue: ""
        description: ""
        name: COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a8fc3c6-3237-418e-8169-06338af81ed9
                stepCounter: 2125f912-d1e5-42c2-91ac-bb6a445b4ae3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 947ad3e0-b67e-44bf-814d-fb82b2dd0ba5
          stepCounter: f1cce021-533c-4ae8-a40b-c8671fb6993f
        config: {}
        dataType: VARCHAR(4000)
        defaultValue: ""
        description: ""
        name: COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c1cc21cc-328d-43ea-a577-e6010a394c81
                stepCounter: 2125f912-d1e5-42c2-91ac-bb6a445b4ae3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78bec892-362f-4b39-98a3-8f23c7b479ca
          stepCounter: f1cce021-533c-4ae8-a40b-c8671fb6993f
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: The changing hash
        name: DSS_CHANGE_HASH
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf4cfd19-b0d0-4602-8f92-090404b46886
                stepCounter: 2125f912-d1e5-42c2-91ac-bb6a445b4ae3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 73dcd1df-4150-4039-a0d2-b7c4e6faf516
          stepCounter: f1cce021-533c-4ae8-a40b-c8671fb6993f
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Record source
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: abc0b0c7-0e58-41f6-8422-6a755e9183c7
                stepCounter: 2125f912-d1e5-42c2-91ac-bb6a445b4ae3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f60cf0b-1e23-464b-b6be-c47243e1a746
          stepCounter: f1cce021-533c-4ae8-a40b-c8671fb6993f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was loaded in the data vault
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03f9ec64-6a5d-4795-8c21-ed2e627e668b
                stepCounter: 2125f912-d1e5-42c2-91ac-bb6a445b4ae3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 113ebe4d-eaf4-4011-9f92-432c449c687d
          stepCounter: f1cce021-533c-4ae8-a40b-c8671fb6993f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row started in the data vault
        isSystemStartDate: true
        name: DSS_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 258e42e3-aef9-4ffc-8970-d2206ba82262
                stepCounter: 2125f912-d1e5-42c2-91ac-bb6a445b4ae3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2aafeb9a-3108-4dd2-9c8e-cf1609d03cce
          stepCounter: f1cce021-533c-4ae8-a40b-c8671fb6993f
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: Version number of a business key in the data vault
        isSurrogateKey: true
        isSystemVersion: true
        name: DSS_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d29308b-7da9-477d-8279-d35a8eb15f4d
                stepCounter: 2125f912-d1e5-42c2-91ac-bb6a445b4ae3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5c46b27-6ae8-4ad9-b546-737879163af8
          stepCounter: f1cce021-533c-4ae8-a40b-c8671fb6993f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was inserted in the data vault
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 273cc89b-3d77-4a5f-ac23-2caff5a51939
                stepCounter: 2125f912-d1e5-42c2-91ac-bb6a445b4ae3
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_LKP_MCC_MASTERCARD_MROC: 2125f912-d1e5-42c2-91ac-bb6a445b4ae3
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATAVAULT_RAW_VAULT
            nodeName: S_LKP_MCC_MASTERCARD_MROC
        join:
          joinCondition: |-
            FROM {{ ref('DATAVAULT_RAW_VAULT','S_LKP_MCC_MASTERCARD_MROC') }} s_lkp_mcc_mastercard_mroc
             INNER JOIN (
                    SELECT hk_h_lkp_mcc_mastercard,
                           MAX(dss_start_date) AS dss_start_date
                      FROM {{ ref('DATAVAULT_RAW_VAULT','S_LKP_MCC_MASTERCARD_MROC') }}
                     GROUP BY hk_h_lkp_mcc_mastercard
                   ) curr
                ON curr.hk_h_lkp_mcc_mastercard = s_lkp_mcc_mastercard_mroc.hk_h_lkp_mcc_mastercard
               AND curr.dss_start_date = s_lkp_mcc_mastercard_mroc.dss_start_date
        name: S_LKP_MCC_MASTERCARD_MROC_CURRENT
        noLinkRefs: []
  name: S_LKP_MCC_MASTERCARD_MROC_CURRENT
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
