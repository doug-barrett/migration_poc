fileVersion: 1
id: 0d3be1f5-675e-492d-8cac-d482806092c7
name: STAGE_LO_SAP_15B
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb83da7d-f96c-484b-aacc-07406431b584
          stepCounter: 0d3be1f5-675e-492d-8cac-d482806092c7
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEDGER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1db22d5-5e46-4e2c-8d0c-d5bfdf605777
                stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
            transform: TARGET.DIM_LEDGER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c86c0a7b-bd1f-4033-85bf-8dbcae1ae1ac
          stepCounter: 0d3be1f5-675e-492d-8cac-d482806092c7
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACTVY_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8193b01f-e40e-4db2-8ff3-c7775b217cb8
                stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
            transform: TARGET.DIM_ACTVY_PER_DATE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a2fca9c-aa50-4424-b6ff-f5ee57a3dd5e
          stepCounter: 0d3be1f5-675e-492d-8cac-d482806092c7
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACCT_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 484c6ec4-6008-4bd0-97a2-ba19273f4b4a
                stepCounter: f83a9760-1bbb-4a44-a7d2-0cdf1547a22f
            transform: TARGET.DIM_ACCT_PER_DATE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6d76b0d-c499-414d-a125-bc39e85fd20f
          stepCounter: 0d3be1f5-675e-492d-8cac-d482806092c7
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_COST_CENTER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03503a7f-e4f0-424d-8af3-434c35b6599b
                stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
            transform: TARGET.DIM_COST_CENTER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1692a208-aeba-4323-87a6-007971c34742
          stepCounter: 0d3be1f5-675e-492d-8cac-d482806092c7
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5151e4dd-9383-4ee1-872c-225d06516bb9
          stepCounter: 0d3be1f5-675e-492d-8cac-d482806092c7
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_DEST_ORGANIZATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 12c86ebe-b44a-470e-b08d-b175595c14a7
                stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
            transform: TARGET.DIM_DEST_ORGANIZATION_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16f29fee-1b36-4ccb-802f-a120a81632d6
          stepCounter: 0d3be1f5-675e-492d-8cac-d482806092c7
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GL_ACCOUNT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b241599e-5dfc-4134-b038-df0bfeca6250
          stepCounter: 0d3be1f5-675e-492d-8cac-d482806092c7
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de3e86c2-c67e-4c1b-b821-a70d916205ab
                stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
            transform: TARGET.DIM_GROSS_NET_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa2fbc92-3685-400a-9e52-4d87abccc6de
          stepCounter: 0d3be1f5-675e-492d-8cac-d482806092c7
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_HIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21fac97a-151e-4cc2-8783-56a1148d309b
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8866fc6-fc89-479a-91fa-6c80e24ea8df
          stepCounter: 0d3be1f5-675e-492d-8cac-d482806092c7
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_VERSION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 20dcf7e7-b707-4054-bfb2-34ced4cc43a4
                stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
            transform: TARGET.DIM_LEASE_OPS_VERSION_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06df1d51-48ee-440f-9e29-50e37ceffc98
          stepCounter: 0d3be1f5-675e-492d-8cac-d482806092c7
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LINE_ITEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1cd56252-10c7-4c13-af84-639a65784195
          stepCounter: 0d3be1f5-675e-492d-8cac-d482806092c7
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_VOUCHER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 13eba653-897e-45ce-a29f-a0fc6073441c
          stepCounter: 0d3be1f5-675e-492d-8cac-d482806092c7
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 247e50ce-ea23-48c6-916b-3693db8c8f49
          stepCounter: 0d3be1f5-675e-492d-8cac-d482806092c7
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_INVOICE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e068e1a8-93ef-42ff-8cd9-5586725894ec
          stepCounter: 0d3be1f5-675e-492d-8cac-d482806092c7
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_PRODUCT_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4fc8c6c-8c1d-4c20-a2de-240a72bcbb84
          stepCounter: 0d3be1f5-675e-492d-8cac-d482806092c7
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1a83d4b-9af5-4a64-b5b2-f6f811cf7698
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d61fd4d8-630b-4c38-916a-dfe64521829c
          stepCounter: 0d3be1f5-675e-492d-8cac-d482806092c7
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6065c38-088c-451a-a686-8e195a0acd4a
          stepCounter: 0d3be1f5-675e-492d-8cac-d482806092c7
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff4575ba-0570-41aa-a85a-0344184e2aca
          stepCounter: 0d3be1f5-675e-492d-8cac-d482806092c7
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: 'Gross Line Item Net Op Amount '
        name: NET_OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 968139c8-9e8e-4de8-b4d3-c81c9c92fbc4
          stepCounter: 0d3be1f5-675e-492d-8cac-d482806092c7
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: LI_VOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a5d9a18a-880d-43f1-8836-ccee12626cc3
                stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
            transform: SUM(DECODE(TARGET.LINE_NO, '15.1',TARGET.LI_VOL ,-TARGET.LI_VOL))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b76a42c0-5c9a-414e-8f96-d678f7c8e151
          stepCounter: 0d3be1f5-675e-492d-8cac-d482806092c7
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in cubic meters (m3)
        name: LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fecb7829-9e41-48de-859d-9e0ddb2be738
                stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
            transform: SUM(DECODE(TARGET.LINE_NO, '15.1',TARGET.LI_VOL_M3 ,-TARGET.LI_VOL_M3))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6813938-9693-4c4f-be5b-5356a19abad1
          stepCounter: 0d3be1f5-675e-492d-8cac-d482806092c7
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in imperial measurement
        name: LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1cd8d772-47c7-46e4-ad7d-fccf00a35696
                stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
            transform: SUM(DECODE(TARGET.LINE_NO, '15.1',TARGET.LI_VOL_IMPERIAL ,-TARGET.LI_VOL_IMPERIAL))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bdad5e71-63da-4233-87f8-4111bd0ba09b
          stepCounter: 0d3be1f5-675e-492d-8cac-d482806092c7
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in BOE (Barrel of Oil Equivalent)
        name: LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b3a293af-146f-4106-8c00-7d2b69c45771
                stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
            transform: SUM(DECODE(TARGET.LINE_NO, '15.1',TARGET.LI_VOL_BOE ,-TARGET.LI_VOL_BOE))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81f5bea0-15f4-4c36-b51f-48f30a7f2a17
          stepCounter: 0d3be1f5-675e-492d-8cac-d482806092c7
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in normalized cubic meters (nm3)
        name: LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a36e59dd-8370-4e78-a3e1-7605b892e5ba
                stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
            transform: SUM(DECODE(TARGET.LINE_NO, '15.1',TARGET.LI_VOL_NM3 ,-TARGET.LI_VOL_NM3))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82223307-2662-47b3-99cc-55d93f4bc1c8
          stepCounter: 0d3be1f5-675e-492d-8cac-d482806092c7
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: ""
        name: EXCHANGE_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ac47fe4-70bb-4d6d-b8c6-5e0fcbc81f90
                stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
            transform: TARGET.EXCHANGE_RATE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55b3dd54-64fc-449e-a60c-ac51347f63bf
          stepCounter: 0d3be1f5-675e-492d-8cac-d482806092c7
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f25767a-6588-4195-b83e-c23e25573e74
                stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
            transform: TARGET.OP_CURR_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce939943-510e-43b8-a4bb-5495d1c47838
          stepCounter: 0d3be1f5-675e-492d-8cac-d482806092c7
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Indicates amounts are gross or net.
        name: GROSS_OR_NET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 08b2c59f-d0c2-4d83-86b7-2f12ddcd0783
                stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
            transform: TARGET.GROSS_OR_NET_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2fb54ea3-3e82-4a0c-a622-f2cd30c08cbb
          stepCounter: 0d3be1f5-675e-492d-8cac-d482806092c7
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: LINE_NO_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4460264-eeac-48f7-bae2-1748cdbcf9cb
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf13060d-11d6-4bce-a29d-c16056212325
          stepCounter: 0d3be1f5-675e-492d-8cac-d482806092c7
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: OP_NONOP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19e6aac2-a837-4990-866b-0eea355fbe9d
                stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
            transform: TARGET.OP_NONOP
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a41633e4-2abb-4597-8d2c-6b1deadc1291
          stepCounter: 0d3be1f5-675e-492d-8cac-d482806092c7
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PROD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_LO_SAP_15: fe17c64f-c293-4956-b465-84809fca2e22
          STAGE_LO_SAP_15A: f83a9760-1bbb-4a44-a7d2-0cdf1547a22f
          DIM_LO_SAP_LEASE_OPS_HIER: 82938641-7c51-4aff-ad3a-c7a56af30c01
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_15
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_15A
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_HIER
        join:
          joinCondition: |-
            FROM (
                    SELECT STAGE_LO_SAP_15.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_15') }} STAGE_LO_SAP_15
                     WHERE STAGE_LO_SAP_15.LINE_NO = '15.1'
                 UNION ALL SELECT STAGE_LO_SAP_15A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_15A') }} STAGE_LO_SAP_15A
                   ) TARGET
             CROSS JOIN (
                    SELECT DIM_LEASE_OPS_HIER_KEY,
                           LINE_NO,
                           LINE_NO_GROUP
                      FROM {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_HIER') }}
                     WHERE DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO = '15B'
                   ) DIM_LO_SAP_LEASE_OPS_HIER
             GROUP BY TARGET.DIM_LEDGER_KEY,
                      TARGET.DIM_ACTVY_PER_DATE_KEY,
                      TARGET.DIM_ACCT_PER_DATE_KEY,
                      TARGET.DIM_COST_CENTER_KEY,
                      TARGET.DIM_DEST_ORGANIZATION_KEY,
                      TARGET.DIM_GROSS_NET_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.DIM_LEASE_OPS_HIER_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO_GROUP,
                      TARGET.DIM_LEASE_OPS_VERSION_KEY,
                      TARGET.EXCHANGE_RATE,
                      TARGET.OP_CURR_CODE,
                      TARGET.GROSS_OR_NET_CODE,
                      TARGET.OP_NONOP
        name: STAGE_LO_SAP_15B
        noLinkRefs: []
  name: STAGE_LO_SAP_15B
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
