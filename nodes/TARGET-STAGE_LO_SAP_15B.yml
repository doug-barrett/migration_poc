fileVersion: 1
id: 7eb74db0-c750-45dd-85ba-a2b1d8ebdfd3
name: STAGE_LO_SAP_15B
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c885842-07e3-4a00-8610-f6753acc3478
          stepCounter: 7eb74db0-c750-45dd-85ba-a2b1d8ebdfd3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEDGER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a25f1320-04c1-4195-83b0-50ce0e1dd9ae
                stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
            transform: TARGET.DIM_LEDGER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d42a3ab9-d9bc-4f4d-b16a-b03ab74f86a1
          stepCounter: 7eb74db0-c750-45dd-85ba-a2b1d8ebdfd3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACTVY_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b0f22ba-a334-46c3-90b8-9090c6ab9f7e
                stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
            transform: TARGET.DIM_ACTVY_PER_DATE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e93e7ff-4bb7-42bd-b9e9-f47320bda429
          stepCounter: 7eb74db0-c750-45dd-85ba-a2b1d8ebdfd3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACCT_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 101ab02f-d2eb-4d38-9118-b87e6ce2c0d1
                stepCounter: 9c387db6-c6b3-4d56-a117-02ca7b4183d3
            transform: TARGET.DIM_ACCT_PER_DATE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 13c59aa9-a06e-4d59-b873-fb2349e653e5
          stepCounter: 7eb74db0-c750-45dd-85ba-a2b1d8ebdfd3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_COST_CENTER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6247bfc9-4073-4c6e-b9a3-e16acb859943
                stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
            transform: TARGET.DIM_COST_CENTER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a6a1801-10a0-413d-a059-a1680f4ece0e
          stepCounter: 7eb74db0-c750-45dd-85ba-a2b1d8ebdfd3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b227868e-ba07-4901-9f1d-c8f48fc59e43
          stepCounter: 7eb74db0-c750-45dd-85ba-a2b1d8ebdfd3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_DEST_ORGANIZATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: be907ce7-6f60-455d-8139-e022112cf81c
                stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
            transform: TARGET.DIM_DEST_ORGANIZATION_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 459a2aa4-45e7-483b-b002-8a26900593a6
          stepCounter: 7eb74db0-c750-45dd-85ba-a2b1d8ebdfd3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GL_ACCOUNT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33e0f0d2-f4f1-4b27-9ed0-d0dcd9731266
          stepCounter: 7eb74db0-c750-45dd-85ba-a2b1d8ebdfd3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 96314d4e-38c1-4642-972d-0174f4208ace
                stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
            transform: TARGET.DIM_GROSS_NET_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed09b3cb-588c-445a-b6f7-c0babecbd687
          stepCounter: 7eb74db0-c750-45dd-85ba-a2b1d8ebdfd3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_HIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03094dcc-28c0-4fee-b106-8de0eba3539c
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0359ad14-b9b6-4e2f-b992-04c533f1cbc6
          stepCounter: 7eb74db0-c750-45dd-85ba-a2b1d8ebdfd3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_VERSION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8a3d0d93-b6c5-45e3-ab16-15e854989f29
                stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
            transform: TARGET.DIM_LEASE_OPS_VERSION_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ea97043-9a1a-4b68-96c4-d285756fa424
          stepCounter: 7eb74db0-c750-45dd-85ba-a2b1d8ebdfd3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LINE_ITEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a03ff9e6-a046-4dfd-9d65-e2ac1b6b3b41
          stepCounter: 7eb74db0-c750-45dd-85ba-a2b1d8ebdfd3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_VOUCHER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d643b749-8f2f-4534-a1d2-6d7e7ecede4d
          stepCounter: 7eb74db0-c750-45dd-85ba-a2b1d8ebdfd3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f87990a-7d7a-4e57-a906-41d9ca0d7f58
          stepCounter: 7eb74db0-c750-45dd-85ba-a2b1d8ebdfd3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_INVOICE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a2a5f95-f228-4cd2-ad7b-0e6296177dc8
          stepCounter: 7eb74db0-c750-45dd-85ba-a2b1d8ebdfd3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_PRODUCT_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa6ecbc3-d75a-42c2-949a-694191342015
          stepCounter: 7eb74db0-c750-45dd-85ba-a2b1d8ebdfd3
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3f84c21-4ee9-4cae-88e0-9ce9656d3204
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9de9088-1ced-4ebc-b271-917fd685c4c3
          stepCounter: 7eb74db0-c750-45dd-85ba-a2b1d8ebdfd3
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 62dce326-123f-4bf5-b6c3-aa51d3fd328d
          stepCounter: 7eb74db0-c750-45dd-85ba-a2b1d8ebdfd3
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70e22a77-117e-46b0-92bb-7b7551f33599
          stepCounter: 7eb74db0-c750-45dd-85ba-a2b1d8ebdfd3
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: 'Gross Line Item Net Op Amount '
        name: NET_OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57d520a5-16ac-40de-ac99-2235eda18d91
          stepCounter: 7eb74db0-c750-45dd-85ba-a2b1d8ebdfd3
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: LI_VOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2b672022-bcef-47cd-9532-1043ad7371da
                stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
            transform: SUM(DECODE(TARGET.LINE_NO, '15.1',TARGET.LI_VOL ,-TARGET.LI_VOL))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3dd54da2-c49e-4b33-aa55-01e3bff8744a
          stepCounter: 7eb74db0-c750-45dd-85ba-a2b1d8ebdfd3
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in cubic meters (m3)
        name: LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 17bf2517-0733-4980-ac47-9105cf9fbffc
                stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
            transform: SUM(DECODE(TARGET.LINE_NO, '15.1',TARGET.LI_VOL_M3 ,-TARGET.LI_VOL_M3))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e1cf13d-9873-400b-9710-dd51dc8e84dd
          stepCounter: 7eb74db0-c750-45dd-85ba-a2b1d8ebdfd3
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in imperial measurement
        name: LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a0667a1-803e-410b-b330-7ac1d219886b
                stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
            transform: SUM(DECODE(TARGET.LINE_NO, '15.1',TARGET.LI_VOL_IMPERIAL ,-TARGET.LI_VOL_IMPERIAL))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 76bda32c-93b4-4ebe-ba6d-ddc3d79d57d7
          stepCounter: 7eb74db0-c750-45dd-85ba-a2b1d8ebdfd3
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in BOE (Barrel of Oil Equivalent)
        name: LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: def05348-01f9-42cb-a070-ae3675956558
                stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
            transform: SUM(DECODE(TARGET.LINE_NO, '15.1',TARGET.LI_VOL_BOE ,-TARGET.LI_VOL_BOE))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b738854-8dc5-452f-9ee9-15d74652ba10
          stepCounter: 7eb74db0-c750-45dd-85ba-a2b1d8ebdfd3
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in normalized cubic meters (nm3)
        name: LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 499a1a63-0cac-41ad-81a8-408887649563
                stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
            transform: SUM(DECODE(TARGET.LINE_NO, '15.1',TARGET.LI_VOL_NM3 ,-TARGET.LI_VOL_NM3))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33abe088-74d5-4860-a2ea-c3dced8c954a
          stepCounter: 7eb74db0-c750-45dd-85ba-a2b1d8ebdfd3
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: ""
        name: EXCHANGE_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2e4f1ee9-966a-48d3-b3fb-25781fd2cc7f
                stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
            transform: TARGET.EXCHANGE_RATE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5550ef3f-4a54-4db5-a435-67248ac48d02
          stepCounter: 7eb74db0-c750-45dd-85ba-a2b1d8ebdfd3
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b3d6b9eb-d0d8-4343-ad0e-22e3c0d28e7e
                stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
            transform: TARGET.OP_CURR_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 19a751f0-daef-423b-b207-34c054dac4f3
          stepCounter: 7eb74db0-c750-45dd-85ba-a2b1d8ebdfd3
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Indicates amounts are gross or net.
        name: GROSS_OR_NET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef8a6afe-85b5-42b9-b4fe-8d1fc5cfc541
                stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
            transform: TARGET.GROSS_OR_NET_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 510bc140-f6d2-47ee-8bc7-d8d47b2bba05
          stepCounter: 7eb74db0-c750-45dd-85ba-a2b1d8ebdfd3
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: LINE_NO_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4607c855-a49d-4eb4-bbf8-11be2b047885
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04a4e028-d1f3-4af5-8f33-e8c02580a9f0
          stepCounter: 7eb74db0-c750-45dd-85ba-a2b1d8ebdfd3
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: OP_NONOP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b0c80882-0dab-44bf-9506-16b825b7215a
                stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
            transform: TARGET.OP_NONOP
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57026002-055d-4757-b8dd-fe89567c6062
          stepCounter: 7eb74db0-c750-45dd-85ba-a2b1d8ebdfd3
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PROD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_LO_SAP_15: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
          STAGE_LO_SAP_15A: 9c387db6-c6b3-4d56-a117-02ca7b4183d3
          DIM_LO_SAP_LEASE_OPS_HIER: e0b535c4-f94e-4ac1-b685-dfdff6293176
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_15
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_15A
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_HIER
        join:
          joinCondition: |-
            FROM (
                    SELECT STAGE_LO_SAP_15.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_15') }} STAGE_LO_SAP_15
                     WHERE STAGE_LO_SAP_15.LINE_NO = '15.1'
                 UNION ALL SELECT STAGE_LO_SAP_15A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_15A') }} STAGE_LO_SAP_15A
                   ) TARGET
             CROSS JOIN (
                    SELECT DIM_LEASE_OPS_HIER_KEY,
                           LINE_NO,
                           LINE_NO_GROUP
                      FROM {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_HIER') }}
                     WHERE DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO = '15B'
                   ) DIM_LO_SAP_LEASE_OPS_HIER
             GROUP BY TARGET.DIM_LEDGER_KEY,
                      TARGET.DIM_ACTVY_PER_DATE_KEY,
                      TARGET.DIM_ACCT_PER_DATE_KEY,
                      TARGET.DIM_COST_CENTER_KEY,
                      TARGET.DIM_DEST_ORGANIZATION_KEY,
                      TARGET.DIM_GROSS_NET_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.DIM_LEASE_OPS_HIER_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO_GROUP,
                      TARGET.DIM_LEASE_OPS_VERSION_KEY,
                      TARGET.EXCHANGE_RATE,
                      TARGET.OP_CURR_CODE,
                      TARGET.GROSS_OR_NET_CODE,
                      TARGET.OP_NONOP
        name: STAGE_LO_SAP_15B
        noLinkRefs: []
  name: STAGE_LO_SAP_15B
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
