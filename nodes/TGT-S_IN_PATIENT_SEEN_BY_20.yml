fileVersion: 1
id: a88457f4-5cc2-424f-bcf8-634a5f345581
name: S_IN_PATIENT_SEEN_BY_20
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75a9aea9-4e9d-4c4d-9f7f-d80a6f9d1c8a
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 73cbe14a-af0f-454c-af21-34ea11476724
                stepCounter: 1e35a775-a397-48bc-8506-7f4c875e53c1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 52a470b3-e75a-4464-aaef-1dfd98bdf175
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c6ce352-b33e-4e91-a560-44e80fda5ff6
                stepCounter: 1e35a775-a397-48bc-8506-7f4c875e53c1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba44bd20-1371-4928-aac1-d23fb137e8d0
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3860e4a3-f294-49a8-9d2b-3a72d1270bfd
                stepCounter: 1e35a775-a397-48bc-8506-7f4c875e53c1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06fb8b47-504f-43b6-98c5-eee49d435d35
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_seen_by_20.event_encounter_type_code=dim_encounter_type.encounter_type_code
        name: DIM_ENCOUNTER_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3ba8df3-db2e-40a1-97dc-d5ad6a5186a7
                stepCounter: 1d0ea6a1-9563-4fb3-a1fa-9d43dbdf296e
            transform: IFNULL(dim_encounter_type.dim_encounter_type_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17322adc-3457-4a26-9121-a5bc04534a4a
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_SEEN_BY_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d972cc14-cdd9-44c6-a899-32854306607a
                stepCounter: 1e35a775-a397-48bc-8506-7f4c875e53c1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06c699bb-33df-4ff5-95a2-8476b54d3f74
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_SEEN_BY_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56a74b85-c014-4a84-b5a5-30010b205c72
                stepCounter: 1e35a775-a397-48bc-8506-7f4c875e53c1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34c169fd-daf9-4852-8de9-271293acf3d6
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMISSION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ffb9a26a-1116-432d-8539-c2347aa10b60
                stepCounter: 1e35a775-a397-48bc-8506-7f4c875e53c1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9eea6943-95f1-4c10-a9fd-c7c6e17b62c6
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: INT
        defaultValue: ""
        description: s_in_patient_seen_by_20.CONVERT(date,admit_date)=dim_admission_date.admission_calendar_date
        name: DIM_ADMISSION_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b402ec63-d2cf-47e5-ab27-e5c03a6296f4
                stepCounter: 9996feda-efbd-41f4-8569-36f5c8b63c75
            transform: IFNULL(dim_admission_date.dim_admission_date_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd77718d-d576-477a-8117-62c4bc86ef8e
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 85ca8297-c43c-4197-9e5e-b04584a9ef0b
                stepCounter: 1e35a775-a397-48bc-8506-7f4c875e53c1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14f77aea-5ed2-428a-9e5d-822e137575e9
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: INT
        defaultValue: ""
        description: s_in_patient_seen_by_20.CONVERT(date,disch_date)=dim_discharge_date.discharge_calendar_date
        name: DIM_DISCHARGE_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 985b56af-022e-46b3-82b0-51ae204ca926
                stepCounter: 45fbd3a8-64d0-4be6-b03a-8d128a18b549
            transform: IFNULL(dim_discharge_date.dim_discharge_date_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b59d037-644c-4de3-a95c-8f201ab69052
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MEDICAL_DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 909b5346-4293-45a9-a0f8-f2eefa4ed922
                stepCounter: 1e35a775-a397-48bc-8506-7f4c875e53c1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72b94059-3e2a-4f10-92f3-528aff7fa01d
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e10df6da-d3a9-4755-89b3-f831c32b5f68
                stepCounter: 1e35a775-a397-48bc-8506-7f4c875e53c1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a68269a-5b01-4265-a57e-8087f216de58
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ae09416f-9a56-40ee-97ac-5b13adfe8c4c
                stepCounter: 1e35a775-a397-48bc-8506-7f4c875e53c1
            transform: "'R'+CONVERT(varchar,s_in_patient_seen_by_10.seen_by_referral_refno)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 65dd261e-f60b-4dda-85fb-7d99a1ce3242
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: WAITLIST_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ad3cbe0d-ca81-4930-80f1-a88dcf3dbfa8
                stepCounter: 1e35a775-a397-48bc-8506-7f4c875e53c1
            transform: "'W'+CONVERT(varchar,s_in_patient_seen_by_10.waitlist_reference_no)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef602b27-3adf-42c4-8e48-613a88c0863d
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: STAY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e3d7ffcb-910a-4ff0-bd14-c55663c21d99
                stepCounter: 1e35a775-a397-48bc-8506-7f4c875e53c1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c3ed6c1-5025-484e-88bb-40e303082d4f
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: STAY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9e65b329-0c57-4efa-9fc4-fece16f2187b
                stepCounter: 1e35a775-a397-48bc-8506-7f4c875e53c1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 307ccb1f-37d9-4c2b-8c1e-dce734c1fd9c
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: STAY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dd5c7782-32a8-46c8-b791-3a593042d14c
                stepCounter: 1e35a775-a397-48bc-8506-7f4c875e53c1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 19958953-2285-41f2-916e-d9ed28b8ed05
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea0320c1-f046-4714-9530-1dcad7396062
                stepCounter: 1e35a775-a397-48bc-8506-7f4c875e53c1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5d72bc6-fca7-4d08-828c-378c40d47a22
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 985f0ba0-97cf-4152-a49b-7e86cb71409e
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7091786a-a4de-4216-b811-7694e5af9ef7
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_seen_by_20.patient_reference_no=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9962a01b-5f3d-4c1a-b371-997edef38d0f
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: IFNULL(dim_patient.dim_patient_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47464ba4-64ab-4c90-9538-bfa2f775c3b7
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bba83b98-6285-455b-a478-fa9f9dc264d6
                stepCounter: 1e35a775-a397-48bc-8506-7f4c875e53c1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb8fd8d7-5c30-4f46-ad39-8ac1bab4cc6d
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_seen_by_20.ward_reference_no=dim_ward.ward_reference_no
        name: DIM_WARD_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6aa5e7b8-4dc5-4b87-a4c2-5013db0e1dfc
                stepCounter: 50c31151-9204-4154-9caf-5d28244bde1a
            transform: IFNULL(dim_ward.dim_ward_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1a93319-d309-495b-8455-726c73d60264
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 73d06e9d-e14e-4906-8cfc-9f568bb86d3a
                stepCounter: 1e35a775-a397-48bc-8506-7f4c875e53c1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 56323dc7-4282-4c8d-b2ed-291ff7305a49
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_seen_by_20.clinician_reference_no=dim_clinician.clinician_reference_no
        name: DIM_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 911a8788-86e5-4a5c-a00a-a957d59070b8
                stepCounter: e8e4a684-3ef8-4076-846f-48d5689e824f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c0fca22-3a22-4564-abf3-7fe12b3a29b0
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eaa92fbb-d07c-43d9-beb3-7d54eb24c7eb
                stepCounter: 1e35a775-a397-48bc-8506-7f4c875e53c1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 714d9337-754e-4fb3-8439-110f48526ef2
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_in_patient_seen_by_20.specialty_reference_no=dim_specialty.specialty_reference_no
        name: DIM_SPECIALTY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79aee918-ff6f-4b0a-a656-000827899f3e
                stepCounter: 4182a75e-d07b-4637-97fa-4c01e2878360
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3507cd74-8864-432a-b011-bdd17a1d6e27
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CLINICIAN_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e6131973-4cf3-4157-b438-659114c8e49f
                stepCounter: 1e35a775-a397-48bc-8506-7f4c875e53c1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ac288b1-422e-4e6d-9b0f-c0463c1a4f84
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: INT
        defaultValue: ""
        description: s_in_patient_seen_by_20.clinician_start_date=dim_clinician_start_date.clinician_start_date
        name: DIM_CLINICIAN_START_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e6cff007-49e1-40c9-97b7-677a8e493923
                stepCounter: c00a5228-016f-45f3-9c61-593b0d92cfe0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1487fa2-a76a-4e9a-a819-34430180fce9
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CLINICIAN_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3882e6b3-7853-4c65-b67f-2e838aaf8e14
                stepCounter: 1e35a775-a397-48bc-8506-7f4c875e53c1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 908e49aa-41c5-4181-b65b-ed74516f8894
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: INT
        defaultValue: ""
        description: s_in_patient_seen_by_20.clinician_end_date=dim_clinician_end_date.clinician_end_date
        name: DIM_CLINICIAN_END_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 93a32d2b-5700-418e-9c98-adc15b6d3783
                stepCounter: 21c61485-f91b-4d89-95d8-866d85275376
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 822d580b-f894-466c-9c88-e5a66cbc1287
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMISSION_METHOD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f44d74f-4d04-4838-8d12-c9e44e48ad12
                stepCounter: 1e35a775-a397-48bc-8506-7f4c875e53c1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af00ee07-c8db-4fe5-909f-3e92916e2885
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_in_patient_seen_by_20.admission_method_reference_no=dim_admission_method.admission_method_reference_no
        name: DIM_ADMISSION_METHOD_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f228ac9a-42c6-489f-bcad-ee502f61a194
                stepCounter: 469bfd7a-0084-4352-8ef5-69fd15a77ed4
            transform: IFNULL(dim_admission_method.dim_admission_method_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df89530f-17fc-41db-8f6d-7e0117110f46
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREVIOUS_SEEN_BY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0a72b11e-6963-4bbb-b538-313527f0c9bb
                stepCounter: 1e35a775-a397-48bc-8506-7f4c875e53c1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d87fdd21-b444-4605-be0c-c62d6e4af13d
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PREVIOUS_SEEN_BY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b49c304-1bbc-4299-ae46-9d53a8de2bbf
                stepCounter: 1e35a775-a397-48bc-8506-7f4c875e53c1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 63f1ac1f-6c0f-4db8-8a08-c0c817192249
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PREVIOUS_SEEN_BY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3dc74cf6-47e3-4a3d-b9e5-8684bdd5a29d
                stepCounter: 1e35a775-a397-48bc-8506-7f4c875e53c1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 30d09ac2-2256-4bf7-a8a6-6b18fda9254d
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREVIOUS_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 513c0b1f-7570-4b4a-9bf9-263cf4313d84
                stepCounter: 1e35a775-a397-48bc-8506-7f4c875e53c1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 90ae9149-158d-46d1-882d-b705be196556
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: previous_clinician_code
        name: PREVIOUS_CLINICIAN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d4086ea-cfb6-40e3-8c8b-fadd321173bc
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREVIOUS_WARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d062e36c-1890-4bc8-ba23-49fe3e9fc810
                stepCounter: 1e35a775-a397-48bc-8506-7f4c875e53c1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab0d0034-d60c-428b-b66d-df1506ab90bf
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: previous_ward_code
        name: PREVIOUS_WARD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42921104-23a7-4b92-951c-bc19c8c40536
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREVIOUS_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b169f46e-3b6a-44d0-a7e0-f61c77309565
                stepCounter: 1e35a775-a397-48bc-8506-7f4c875e53c1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 040b822e-7fa4-4bde-887a-9309768b3540
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: previous_health_specialty_code
        name: PREVIOUS_HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 60d0a375-f6c7-45de-8cf4-27537eb545d4
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NEXT_SEEN_BY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8b3ec26-09c9-482b-9255-81e9504ee2d9
                stepCounter: 1e35a775-a397-48bc-8506-7f4c875e53c1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: adb9fb6b-b8f6-4f55-84b4-653229a50e0a
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NEXT_SEEN_BY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7326ce42-c6e6-4c89-9ba0-e37f4360c5f7
                stepCounter: 1e35a775-a397-48bc-8506-7f4c875e53c1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e1edec0-239f-4890-9c4f-c188527f7aed
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NEXT_SEEN_BY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 112108f8-e757-4373-b755-03f009d6df59
                stepCounter: 1e35a775-a397-48bc-8506-7f4c875e53c1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67ef81b0-c1f6-4154-acfc-9b260bbdba90
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NEXT_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c80e601-c418-4482-a48c-12c6dd7966da
                stepCounter: 1e35a775-a397-48bc-8506-7f4c875e53c1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38264064-9a2c-4e3e-8d7d-45516093e256
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: next_clinician_code
        name: NEXT_CLINICIAN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5963eb2a-d884-4e34-9662-588d5ae44f9f
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NEXT_WARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0630d52d-7f50-472a-be5a-be7f8980eead
                stepCounter: 1e35a775-a397-48bc-8506-7f4c875e53c1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4bc9cd2-3dc1-40d1-b9cd-744858fe1d7e
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: next_ward_code
        name: NEXT_WARD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a276b205-8470-4b57-ab0b-758db3e9e5e5
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NEXT_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 97682086-c631-4203-9195-a48935df12a2
                stepCounter: 1e35a775-a397-48bc-8506-7f4c875e53c1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5b36e56-8e4c-4f6d-b1fb-b08cbe440331
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: next_health_specialty_code
        name: NEXT_HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc5ccabd-661a-492e-aedb-20beb9495af0
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: duration_unit
        name: DURATION_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'minute'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 605b09da-a296-490b-8ad8-812d0ad345ea
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: event_seen_by_total_duration
        name: EVENT_SEEN_BY_TOTAL_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: IFNULL(DATEDIFF(mi,seen_by_start_date,seen_by_end_date),0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b663a582-0a58-4bfb-9efd-514f204e126b
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: previous_to_current_seen_by_duration
        name: PREVIOUS_TO_CURRENT_SEEN_BY_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: IFNULL(DATEDIFF(mi,previous_seen_by_end_date,seen_by_start_date),0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 321ee616-7122-4e75-8eac-d292238995bf
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: current_to_next_seen_by_duration
        name: CURRENT_TO_NEXT_SEEN_BY_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: IFNULL(DATEDIFF(mi,seen_by_end_date,next_seen_by_start_date),0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c35ece2-a199-48a6-acca-9c0f38a2991e
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: dss_data_quality_code
        name: DSS_DATA_QUALITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: caa9241b-5acf-40d2-8bac-188e2aa7b6a8
                stepCounter: 1e35a775-a397-48bc-8506-7f4c875e53c1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a590a135-996f-4f26-a1ca-e03358d941db
          stepCounter: a88457f4-5cc2-424f-bcf8-634a5f345581
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_IN_PATIENT_SEEN_BY_10
        join:
          joinCondition: FROM s_in_patient_seen_by_10 -- 14-Apr-2023 Commented out, not referenced  --join s_in_patient_event_stays_specialty_path_10_v   --on s_in_patient_seen_by_10.event_encounter_id=s_in_patient_event_stays_specialty_path_10_v.event_encounter_id    LEFT OUTER JOIN dim.dim_ward    ON s_in_patient_seen_by_10.seen_by_spont_refno = dim_ward.ward_reference_no    AND IFNULL(dim_ward.dss_start_date, GETDATE()-10000) <= s_in_patient_seen_by_10.admit_date    AND IFNULL(dim_ward.dss_end_date, GETDATE()+10000) >= s_in_patient_seen_by_10.admit_date      LEFT OUTER JOIN dim.dim_healthcare_professional dim_healthcare_professional_previous     ON s_in_patient_seen_by_10.previous_healthcare_professional_reference_no = dim_healthcare_professional_previous.healthcare_professional_reference_no    AND IFNULL(dim_healthcare_professional_previous.dss_start_date, GETDATE()-10000) <= s_in_patient_seen_by_10.admit_date    AND IFNULL(dim_healthcare_professional_previous.dss_end_date, GETDATE()+10000) >= s_in_patient_seen_by_10.admit_date      LEFT OUTER JOIN dim.dim_service_point dim_service_point_previous     ON s_in_patient_seen_by_10.previous_service_point_reference_no = dim_service_point_previous.service_point_reference_no    AND IFNULL(dim_service_point_previous.dss_start_date, GETDATE()-10000) <= s_in_patient_seen_by_10.admit_date    AND IFNULL(dim_service_point_previous.dss_end_date, GETDATE()+10000) >= s_in_patient_seen_by_10.admit_date      LEFT OUTER JOIN dim.dim_specialty dim_specialty_previous    ON s_in_patient_seen_by_10.previous_specialty_reference_no = dim_specialty_previous.specialty_reference_no     AND IFNULL(dim_specialty_previous.dss_start_date, GETDATE()-10000) <= s_in_patient_seen_by_10.admit_date    AND IFNULL(dim_specialty_previous.dss_end_date, GETDATE()+10000) >= s_in_patient_seen_by_10.admit_date      LEFT OUTER JOIN dim.dim_healthcare_professional dim_healthcare_professional_next     ON s_in_patient_seen_by_10.next_healthcare_professional_reference_no = dim_healthcare_professional_next.healthcare_professional_reference_no    AND IFNULL(dim_healthcare_professional_next.dss_start_date, GETDATE()-10000) <= s_in_patient_seen_by_10.admit_date    AND IFNULL(dim_healthcare_professional_next.dss_end_date, GETDATE()+10000) >= s_in_patient_seen_by_10.admit_date      LEFT OUTER JOIN dim.dim_service_point dim_service_point_next     ON s_in_patient_seen_by_10.next_service_point_reference_no = dim_service_point_next.service_point_reference_no    AND IFNULL(dim_service_point_next.dss_start_date, GETDATE()-10000) <= s_in_patient_seen_by_10.admit_date    AND IFNULL(dim_service_point_next.dss_end_date, GETDATE()+10000) >= s_in_patient_seen_by_10.admit_date      LEFT OUTER JOIN dim.dim_specialty dim_specialty_next    ON s_in_patient_seen_by_10.next_specialty_reference_no = dim_specialty_next.specialty_reference_no     AND IFNULL(dim_specialty_next.dss_start_date, GETDATE()-10000) <= s_in_patient_seen_by_10.admit_date    AND IFNULL(dim_specialty_next.dss_end_date, GETDATE()+10000) >= s_in_patient_seen_by_10.admit_date
        name: S_IN_PATIENT_SEEN_BY_20
        noLinkRefs: []
  name: S_IN_PATIENT_SEEN_BY_20
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
