fileVersion: 1
id: 3555cdf1-2218-434f-ab88-eecd78acad03
name: S_CONTRACT_ACTIVITY_CONTACTS_V
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8efb42d4-7cf9-40e7-a9c9-a8047fb6a995
          stepCounter: 3555cdf1-2218-434f-ab88-eecd78acad03
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PROVIDER_FUNDER_SPLIT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "'provider'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e39466f-9d9b-4669-b29e-4451062a3814
          stepCounter: 3555cdf1-2218-434f-ab88-eecd78acad03
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: the mapping rule applied for purchase unit allocation
        name: PUC_MAP_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 54701289-ab40-42e5-affc-bc4860625055
                stepCounter: 362b44bb-785a-498d-85df-af738c6bd145
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32e0a21b-2c72-4ec5-89df-16f6fefb3439
          stepCounter: 3555cdf1-2218-434f-ab88-eecd78acad03
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: RESPONSIBILITY_CENTRE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 99523b0f-1459-445e-811f-aa12c1080104
                stepCounter: 362b44bb-785a-498d-85df-af738c6bd145
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ae5dae4-26eb-401e-948e-79238e21706b
          stepCounter: 3555cdf1-2218-434f-ab88-eecd78acad03
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: health_specialty_code
        name: HEALTH_SPECIALTY_CODE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 42bc0c75-78c9-49b3-878d-b526add4cde3
                stepCounter: fb328a6d-3898-4cf6-8e25-617f72d19d80
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e94df98-b0d7-498e-b5b0-4338670e26d4
          stepCounter: 3555cdf1-2218-434f-ab88-eecd78acad03
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: facility_code
        name: FACILITY_CODE
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e4854a00-b216-4f7d-9fb3-f19dece582ee
          stepCounter: 3555cdf1-2218-434f-ab88-eecd78acad03
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REPORTING_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 31bdcc07-3cbd-4892-b925-a54327323eb9
                stepCounter: 362b44bb-785a-498d-85df-af738c6bd145
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9da44752-4b72-4b22-93d9-8a7305e6fa1c
          stepCounter: 3555cdf1-2218-434f-ab88-eecd78acad03
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SOURCE_ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2c36879-2050-4ecd-9c5c-6fa7c8f05bcb
                stepCounter: 362b44bb-785a-498d-85df-af738c6bd145
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c410156-3ccc-474c-a43c-6929f86e4a17
          stepCounter: 3555cdf1-2218-434f-ab88-eecd78acad03
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FUNDED_EVENT_ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2c36879-2050-4ecd-9c5c-6fa7c8f05bcb
                stepCounter: 362b44bb-785a-498d-85df-af738c6bd145
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c3be5a9-b9ae-4d41-a5db-b4e8d9d062a5
          stepCounter: 3555cdf1-2218-434f-ab88-eecd78acad03
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1edf01f5-b580-4750-8a75-2bca38bb2dfa
                stepCounter: 362b44bb-785a-498d-85df-af738c6bd145
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6a0bbfe-04ff-4177-9e40-b679e01c1e02
          stepCounter: 3555cdf1-2218-434f-ab88-eecd78acad03
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c9d661a-047f-4130-8a58-e4cb7822245d
                stepCounter: 362b44bb-785a-498d-85df-af738c6bd145
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e1cca63-713e-4b8d-8f18-8bffb87198cd
          stepCounter: 3555cdf1-2218-434f-ab88-eecd78acad03
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_contact_20.patient_reference_no=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 410b9de5-62df-492e-90d1-070aa501f2ee
                stepCounter: 362b44bb-785a-498d-85df-af738c6bd145
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bfafefb5-919f-439b-a238-c32a7a5e3dbd
          stepCounter: 3555cdf1-2218-434f-ab88-eecd78acad03
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ADMIN_CATEGORY_REFERENCE_NO
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7cdb7899-f623-446e-a197-8d5c98929b50
                stepCounter: 362b44bb-785a-498d-85df-af738c6bd145
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dbb7e408-4aca-4a16-8e4e-93b36a80a845
          stepCounter: 3555cdf1-2218-434f-ab88-eecd78acad03
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: CONTRACT_ADMIT_TYPE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "'OTHER'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e90a0551-2231-4ab7-8c21-6007563f45af
          stepCounter: 3555cdf1-2218-434f-ab88-eecd78acad03
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: ADMISSION_TYPE_CODE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f111b7ea-1f9f-485a-a635-9573db663fca
          stepCounter: 3555cdf1-2218-434f-ab88-eecd78acad03
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: IDF_CLASS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 070c54dc-4ee1-42a4-86c0-f077dec0cc41
                stepCounter: 362b44bb-785a-498d-85df-af738c6bd145
            transform: |-
              CASE WHEN s_contact_20.IDF_class IS NULL THEN 'Non-IDF'
                          ELSE s_contact_20.IDF_class
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b65d9cf1-42be-470e-be4e-6d0419968930
          stepCounter: 3555cdf1-2218-434f-ab88-eecd78acad03
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DOMICILE_CODE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f60484a5-5e5f-40d4-a94e-d025c117d6f2
                stepCounter: 362b44bb-785a-498d-85df-af738c6bd145
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ba0d9de-aea0-4935-afb6-d1d195d12b1f
          stepCounter: 3555cdf1-2218-434f-ab88-eecd78acad03
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0188da3e-219a-453e-a566-396f73868741
                stepCounter: 362b44bb-785a-498d-85df-af738c6bd145
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ef71f55-83bd-4aaa-a8c6-69808eda70d8
          stepCounter: 3555cdf1-2218-434f-ab88-eecd78acad03
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_VOLUME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec2f17a2-373e-4372-bb61-e5031d44c806
                stepCounter: 362b44bb-785a-498d-85df-af738c6bd145
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45620f5a-e656-4194-bc15-b4f29ae0c91f
          stepCounter: 3555cdf1-2218-434f-ab88-eecd78acad03
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ESTIMATED_PURCHASE_UNIT_VOLUME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e220137a-069e-4fc2-9d12-d5fa698892e6
                stepCounter: 362b44bb-785a-498d-85df-af738c6bd145
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d749acf8-3b0e-4362-9fe7-7c055c3e533e
          stepCounter: 3555cdf1-2218-434f-ab88-eecd78acad03
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AGE_GROUP_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a482903e-b072-48a1-97d2-bbec7fda5f89
                stepCounter: 362b44bb-785a-498d-85df-af738c6bd145
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a21fab1-a61c-4ee2-b4e8-07b7b7d2230e
          stepCounter: 3555cdf1-2218-434f-ab88-eecd78acad03
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_PLANNED_CARE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a482903e-b072-48a1-97d2-bbec7fda5f89
                stepCounter: 362b44bb-785a-498d-85df-af738c6bd145
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a3fb685-a3cd-4bfb-af74-5f3567099961
          stepCounter: 3555cdf1-2218-434f-ab88-eecd78acad03
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: DRG_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77c490ff-e163-4641-a336-e7cda66cda82
          stepCounter: 3555cdf1-2218-434f-ab88-eecd78acad03
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: contact clinician reference no from iPM
        name: CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e220137a-069e-4fc2-9d12-d5fa698892e6
                stepCounter: 362b44bb-785a-498d-85df-af738c6bd145
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c8bd8e2-bfa5-4b06-b7ae-c01256c108b8
          stepCounter: 3555cdf1-2218-434f-ab88-eecd78acad03
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: source_system
        name: SOURCE_SYSTEM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "'iPM-Contacts'"
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_CONTACT_20: 362b44bb-785a-498d-85df-af738c6bd145
          DIM_CONTACT_SPECIALTY: fb328a6d-3898-4cf6-8e25-617f72d19d80
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_CONTACT_20
          - locationName: TGT
            nodeName: DIM_CONTACT_SPECIALTY
        join:
          joinCondition: FROM {{ ref('TGT','S_CONTACT_20') }} --LEFT OUTER JOIN {{ ref('TGT','DIM_CONTACT_SPECIALTY') }}  --ON s_contact_20.contact_specialty_reference_no = --dim_contact_specialty.contact_specialty_reference_no    WHERE contact_start_date < cast(getdate() as date)
        name: S_CONTRACT_ACTIVITY_CONTACTS_V
        noLinkRefs: []
  name: S_CONTRACT_ACTIVITY_CONTACTS_V
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
