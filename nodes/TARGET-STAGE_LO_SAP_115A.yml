fileVersion: 1
id: 7776d7fc-7fd9-40e0-b05a-360307d0deed
name: STAGE_LO_SAP_115A
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3bdb6bef-5be9-4f02-9c3d-e039c985a0b8
          stepCounter: 7776d7fc-7fd9-40e0-b05a-360307d0deed
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEDGER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: df6dbf03-09d3-478c-b2db-f0667509561a
                stepCounter: 1a2bbe7e-f71d-4334-a551-7dc9775d90f0
            transform: TARGET.DIM_LEDGER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77782fc9-9ba1-44a6-9304-c24b57a36d75
          stepCounter: 7776d7fc-7fd9-40e0-b05a-360307d0deed
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACTVY_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe8b295b-7243-4f80-88b8-d34a2336354c
                stepCounter: 1a2bbe7e-f71d-4334-a551-7dc9775d90f0
            transform: TARGET.DIM_ACTVY_PER_DATE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f1bd648-b659-4d18-ad23-bdaa31959977
          stepCounter: 7776d7fc-7fd9-40e0-b05a-360307d0deed
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACCT_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4f53a02e-a030-4a2b-b219-5266f3e4210b
                stepCounter: 75cb1780-f127-4024-8ca3-17dc64fc59fe
            transform: TARGET.DIM_ACCT_PER_DATE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d30169a3-5d58-4d01-afb7-ca97d2be912d
          stepCounter: 7776d7fc-7fd9-40e0-b05a-360307d0deed
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_COST_CENTER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bff7566e-a98e-4c0f-b807-5b7b1d2df28b
                stepCounter: 4f15b373-e6ab-42f2-b514-4d94fb8e7849
            transform: TARGET.DIM_COST_CENTER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f600cf5-adcc-4892-b447-c1b76b1a94c7
          stepCounter: 7776d7fc-7fd9-40e0-b05a-360307d0deed
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 99e86598-4b97-4ddb-861d-1545b5d5ca36
          stepCounter: 7776d7fc-7fd9-40e0-b05a-360307d0deed
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_DEST_ORGANIZATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 258019b2-4d6b-4011-b24e-7944ba1dd809
                stepCounter: 1a2bbe7e-f71d-4334-a551-7dc9775d90f0
            transform: TARGET.DIM_DEST_ORGANIZATION_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d7a7b8e-7c70-47a3-89d4-0daf1620c964
          stepCounter: 7776d7fc-7fd9-40e0-b05a-360307d0deed
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GL_ACCOUNT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1221ea4-b520-4b1c-84ae-37a2d912d051
          stepCounter: 7776d7fc-7fd9-40e0-b05a-360307d0deed
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f5c0a33-fca3-4f32-b681-68a74f3d1f56
                stepCounter: 1a2bbe7e-f71d-4334-a551-7dc9775d90f0
            transform: TARGET.DIM_GROSS_NET_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e0a23bf-0b77-45c1-b8c5-598ba0ccda4c
          stepCounter: 7776d7fc-7fd9-40e0-b05a-360307d0deed
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_HIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03094dcc-28c0-4fee-b106-8de0eba3539c
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7441aba3-697d-4afd-a1fb-9200b4a967fb
          stepCounter: 7776d7fc-7fd9-40e0-b05a-360307d0deed
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_VERSION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c3222eec-324e-4dbe-86e1-c08659d193e1
                stepCounter: 1a2bbe7e-f71d-4334-a551-7dc9775d90f0
            transform: TARGET.DIM_LEASE_OPS_VERSION_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 845513dc-6d83-4315-a6a9-05bb0241f015
          stepCounter: 7776d7fc-7fd9-40e0-b05a-360307d0deed
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LINE_ITEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38a8bd44-9c83-4afe-96ab-77245fccad8d
          stepCounter: 7776d7fc-7fd9-40e0-b05a-360307d0deed
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_VOUCHER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e94d203d-fb97-43fe-abd5-d82c6e7a69d9
          stepCounter: 7776d7fc-7fd9-40e0-b05a-360307d0deed
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b03ed353-6500-4944-b78b-e8f7d5618037
          stepCounter: 7776d7fc-7fd9-40e0-b05a-360307d0deed
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_INVOICE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5fa5260-2c8a-4c6f-a819-eb845c98ad65
          stepCounter: 7776d7fc-7fd9-40e0-b05a-360307d0deed
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_PRODUCT_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b7246c5-ddda-4734-b705-8a68d13ff00c
          stepCounter: 7776d7fc-7fd9-40e0-b05a-360307d0deed
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3f84c21-4ee9-4cae-88e0-9ce9656d3204
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a856d921-7f1e-4486-98c7-b047caf5cfc9
          stepCounter: 7776d7fc-7fd9-40e0-b05a-360307d0deed
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b09844f0-adf0-4272-b445-4bc758fc3535
                stepCounter: 1a2bbe7e-f71d-4334-a551-7dc9775d90f0
            transform: SUM(OP_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5625ae85-5dd9-4645-999a-a85b10f10dbc
          stepCounter: 7776d7fc-7fd9-40e0-b05a-360307d0deed
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f79c4dc8-18c2-4725-b8f9-9fad22b9a819
                stepCounter: 1a2bbe7e-f71d-4334-a551-7dc9775d90f0
            transform: SUM(CAD_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2abae582-d30e-4424-b92d-da2d0753903d
          stepCounter: 7776d7fc-7fd9-40e0-b05a-360307d0deed
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: 'Gross Line Item Net Op Amount '
        name: NET_OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 893c95d3-b8d1-422b-9375-2f4f4d0a3bfa
                stepCounter: 1a2bbe7e-f71d-4334-a551-7dc9775d90f0
            transform: SUM(NET_OP_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 368391c0-74ee-4994-9f33-3622c4b75f21
          stepCounter: 7776d7fc-7fd9-40e0-b05a-360307d0deed
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: LI_VOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ba6c63e8-4f33-47e7-b4bd-b7b00f57f484
                stepCounter: 1a2bbe7e-f71d-4334-a551-7dc9775d90f0
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b313ada-c453-46a8-9206-3c9502f2be42
          stepCounter: 7776d7fc-7fd9-40e0-b05a-360307d0deed
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in cubic meters (m3)
        name: LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ba29d5c4-a99e-4a82-9eb4-e616290e5c82
                stepCounter: 1a2bbe7e-f71d-4334-a551-7dc9775d90f0
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5cb5ea7-1f77-460d-ae07-73020874883e
          stepCounter: 7776d7fc-7fd9-40e0-b05a-360307d0deed
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in imperial measurement
        name: LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7fd58c1e-21e6-4ea1-bef2-aaf53d98808e
                stepCounter: 1a2bbe7e-f71d-4334-a551-7dc9775d90f0
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8022958-07af-46ac-8a2e-9415cdf620d1
          stepCounter: 7776d7fc-7fd9-40e0-b05a-360307d0deed
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in BOE (Barrel of Oil Equivalent)
        name: LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c418c58-6b71-4848-af0a-ed28a007a0eb
                stepCounter: 1a2bbe7e-f71d-4334-a551-7dc9775d90f0
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 179f2618-09e4-4edb-b913-ac44a581da36
          stepCounter: 7776d7fc-7fd9-40e0-b05a-360307d0deed
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in normalized cubic meters (nm3)
        name: LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 479c14ae-9c09-4d8c-8bc6-be15ed5081e8
                stepCounter: 1a2bbe7e-f71d-4334-a551-7dc9775d90f0
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2936bd1c-7a78-46a3-af5b-29a2901b464f
          stepCounter: 7776d7fc-7fd9-40e0-b05a-360307d0deed
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: ""
        name: EXCHANGE_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aaa47567-637c-407a-97bb-1a5f034a199a
                stepCounter: 1a2bbe7e-f71d-4334-a551-7dc9775d90f0
            transform: TARGET.EXCHANGE_RATE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd2f1f36-e72a-47b0-ae3c-139aadb10d60
          stepCounter: 7776d7fc-7fd9-40e0-b05a-360307d0deed
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2a2ff14-ad2e-466f-a320-022ab52f2c97
                stepCounter: 1a2bbe7e-f71d-4334-a551-7dc9775d90f0
            transform: TARGET.OP_CURR_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 499d4e33-b3d4-48b2-9b63-8355d8d19212
          stepCounter: 7776d7fc-7fd9-40e0-b05a-360307d0deed
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Indicates amounts are gross or net.
        name: GROSS_OR_NET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 54774ed1-603d-421b-b965-dfd81f64fea7
                stepCounter: 1a2bbe7e-f71d-4334-a551-7dc9775d90f0
            transform: TARGET.GROSS_OR_NET_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b468759-5d36-483c-9a31-95aa208cfb75
          stepCounter: 7776d7fc-7fd9-40e0-b05a-360307d0deed
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: LINE_NO_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4607c855-a49d-4eb4-bbf8-11be2b047885
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f160402-7ba5-44b9-a59d-32c3ea330647
          stepCounter: 7776d7fc-7fd9-40e0-b05a-360307d0deed
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: OP_NONOP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 788bbbcb-0aaf-451b-9092-b4db99966254
                stepCounter: 1a2bbe7e-f71d-4334-a551-7dc9775d90f0
            transform: TARGET.OP_NONOP
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e883f41-0e9c-4aef-99f8-2ef125fe2f07
          stepCounter: 7776d7fc-7fd9-40e0-b05a-360307d0deed
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PROD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_LO_SAP_105A: 1a2bbe7e-f71d-4334-a551-7dc9775d90f0
          STAGE_LO_SAP_110A: 75cb1780-f127-4024-8ca3-17dc64fc59fe
          STAGE_LO_SAP_111A: 4f15b373-e6ab-42f2-b514-4d94fb8e7849
          DIM_LO_SAP_LEASE_OPS_HIER: e0b535c4-f94e-4ac1-b685-dfdff6293176
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_105A
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_110A
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_111A
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_HIER
        join:
          joinCondition: |-
            FROM (
                    SELECT STAGE_LO_SAP_105A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_105A') }} STAGE_LO_SAP_105A
                 UNION ALL SELECT STAGE_LO_SAP_110A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_110A') }} STAGE_LO_SAP_110A
                 UNION ALL SELECT STAGE_LO_SAP_111A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_111A') }} STAGE_LO_SAP_111A
                   ) TARGET
             CROSS JOIN (
                    SELECT DIM_LEASE_OPS_HIER_KEY,
                           LINE_NO,
                           LINE_NO_GROUP
                      FROM {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_HIER') }}
                     WHERE DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO = '115A'
                   ) DIM_LO_SAP_LEASE_OPS_HIER
             GROUP BY TARGET.DIM_LEDGER_KEY,
                      TARGET.DIM_ACTVY_PER_DATE_KEY,
                      TARGET.DIM_ACCT_PER_DATE_KEY,
                      TARGET.DIM_COST_CENTER_KEY,
                      TARGET.DIM_DEST_ORGANIZATION_KEY,
                      TARGET.DIM_GROSS_NET_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.DIM_LEASE_OPS_HIER_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO_GROUP,
                      TARGET.DIM_LEASE_OPS_VERSION_KEY,
                      TARGET.EXCHANGE_RATE,
                      TARGET.OP_CURR_CODE,
                      TARGET.GROSS_OR_NET_CODE,
                      TARGET.OP_NONOP
        name: STAGE_LO_SAP_115A
        noLinkRefs: []
  name: STAGE_LO_SAP_115A
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
