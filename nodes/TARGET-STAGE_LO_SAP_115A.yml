fileVersion: 1
id: 6e51d19c-6595-41a0-9a74-29a93e678845
name: STAGE_LO_SAP_115A
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 36ff784e-4c4e-49f6-b599-fe72a90569cd
          stepCounter: 6e51d19c-6595-41a0-9a74-29a93e678845
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEDGER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67f350a1-cf50-4099-baec-5bf0529b8be9
                stepCounter: b8190c7e-238c-42f2-a6b7-dc0f8593f039
            transform: TARGET.DIM_LEDGER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf6c2bea-8c39-469e-886e-8a5493a4bba2
          stepCounter: 6e51d19c-6595-41a0-9a74-29a93e678845
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACTVY_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 426630d1-3e6c-49d2-b5d6-9e6d30d22d39
                stepCounter: b8190c7e-238c-42f2-a6b7-dc0f8593f039
            transform: TARGET.DIM_ACTVY_PER_DATE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9faf320-abef-4879-bf37-09b7fc64b599
          stepCounter: 6e51d19c-6595-41a0-9a74-29a93e678845
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACCT_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a864a3f0-507c-4c08-9b17-e2ef7a3a359f
                stepCounter: de9ddde4-4f46-4a1f-ab3a-a0a8a5edc7da
            transform: TARGET.DIM_ACCT_PER_DATE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: acbd3a6b-de1d-4b63-a70e-5a7e09f236b8
          stepCounter: 6e51d19c-6595-41a0-9a74-29a93e678845
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_COST_CENTER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b5886245-73b0-4e33-8093-eed141af1424
                stepCounter: 31fe5344-ca1b-402b-8cde-18d8fed52e7a
            transform: TARGET.DIM_COST_CENTER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f85149db-2694-4f53-bd25-9174162d6e93
          stepCounter: 6e51d19c-6595-41a0-9a74-29a93e678845
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8086542-4ed1-4289-be73-19caf00c5285
          stepCounter: 6e51d19c-6595-41a0-9a74-29a93e678845
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_DEST_ORGANIZATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: af7f3fee-6fb1-4bd8-9f40-5353ae236ffb
                stepCounter: b8190c7e-238c-42f2-a6b7-dc0f8593f039
            transform: TARGET.DIM_DEST_ORGANIZATION_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de56ec47-0d4e-404f-a7b9-8b2c89395d4e
          stepCounter: 6e51d19c-6595-41a0-9a74-29a93e678845
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GL_ACCOUNT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e9611c9-c5cf-4178-b91a-328b66f67c99
          stepCounter: 6e51d19c-6595-41a0-9a74-29a93e678845
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 98ee3ea8-ab6b-4581-9073-f23b72ec1f35
                stepCounter: b8190c7e-238c-42f2-a6b7-dc0f8593f039
            transform: TARGET.DIM_GROSS_NET_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 73567757-56cb-4d64-a843-4e2fb994e0d8
          stepCounter: 6e51d19c-6595-41a0-9a74-29a93e678845
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_HIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21fac97a-151e-4cc2-8783-56a1148d309b
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9b508d5-a2ee-49c4-b592-5402edc7479b
          stepCounter: 6e51d19c-6595-41a0-9a74-29a93e678845
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_VERSION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ebcc3ed6-072d-46a1-b9bf-99623e966a5e
                stepCounter: b8190c7e-238c-42f2-a6b7-dc0f8593f039
            transform: TARGET.DIM_LEASE_OPS_VERSION_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77df873f-439c-4e39-9cf6-3c0e46174838
          stepCounter: 6e51d19c-6595-41a0-9a74-29a93e678845
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LINE_ITEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53335574-84c1-4ef8-9ecf-1db88793d523
          stepCounter: 6e51d19c-6595-41a0-9a74-29a93e678845
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_VOUCHER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c54a8bdf-3e9f-4c8d-ac76-a365b40ce759
          stepCounter: 6e51d19c-6595-41a0-9a74-29a93e678845
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4034eb44-4f32-474f-832b-1be8755cf856
          stepCounter: 6e51d19c-6595-41a0-9a74-29a93e678845
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_INVOICE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5119916b-77a0-411b-8954-b4279427d587
          stepCounter: 6e51d19c-6595-41a0-9a74-29a93e678845
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_PRODUCT_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17477dad-758f-46c6-aab3-057ab55eea4f
          stepCounter: 6e51d19c-6595-41a0-9a74-29a93e678845
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1a83d4b-9af5-4a64-b5b2-f6f811cf7698
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5aa746f6-9308-4b5b-8628-4600f6047df9
          stepCounter: 6e51d19c-6595-41a0-9a74-29a93e678845
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd10027d-d1f0-4d2e-ba82-97f92e4fd6fd
                stepCounter: b8190c7e-238c-42f2-a6b7-dc0f8593f039
            transform: SUM(OP_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3dc8417d-d9e1-4b5c-a4a9-841d74be9d7c
          stepCounter: 6e51d19c-6595-41a0-9a74-29a93e678845
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 750a5ba3-cccc-4dc2-8a14-219108e48deb
                stepCounter: b8190c7e-238c-42f2-a6b7-dc0f8593f039
            transform: SUM(CAD_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 63130c37-a526-476b-b862-1b027113a395
          stepCounter: 6e51d19c-6595-41a0-9a74-29a93e678845
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: 'Gross Line Item Net Op Amount '
        name: NET_OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d17cdc7f-8bbb-4e2c-bbae-bcf1fdf4a11e
                stepCounter: b8190c7e-238c-42f2-a6b7-dc0f8593f039
            transform: SUM(NET_OP_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a7b5915-8cf0-4684-ae4f-f92c151ae98c
          stepCounter: 6e51d19c-6595-41a0-9a74-29a93e678845
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: LI_VOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 505d11b6-6529-4dd8-9ab9-7e01ade04595
                stepCounter: b8190c7e-238c-42f2-a6b7-dc0f8593f039
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da6b9c86-e353-4412-8228-2d94df1e1097
          stepCounter: 6e51d19c-6595-41a0-9a74-29a93e678845
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in cubic meters (m3)
        name: LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5271c12-b8b6-4d6e-9590-75528bfa54c0
                stepCounter: b8190c7e-238c-42f2-a6b7-dc0f8593f039
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e209ca8-b37a-473c-b366-ddb758e8236a
          stepCounter: 6e51d19c-6595-41a0-9a74-29a93e678845
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in imperial measurement
        name: LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fcec1300-d8a7-42b9-9856-031a82eb175f
                stepCounter: b8190c7e-238c-42f2-a6b7-dc0f8593f039
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9d25503-e773-4c16-9273-35ea1c168eda
          stepCounter: 6e51d19c-6595-41a0-9a74-29a93e678845
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in BOE (Barrel of Oil Equivalent)
        name: LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8430be7d-3c1b-477e-b25a-23424d2d5091
                stepCounter: b8190c7e-238c-42f2-a6b7-dc0f8593f039
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8075486a-f2e7-454e-a10b-ed99948cf06f
          stepCounter: 6e51d19c-6595-41a0-9a74-29a93e678845
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in normalized cubic meters (nm3)
        name: LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ecabd305-2d4b-49d4-a624-9017c1f5fe0e
                stepCounter: b8190c7e-238c-42f2-a6b7-dc0f8593f039
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ffc543ef-7f4b-440e-9d55-9ed2f4d5960f
          stepCounter: 6e51d19c-6595-41a0-9a74-29a93e678845
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: ""
        name: EXCHANGE_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9b3f986-af6b-4b4b-98f3-dc22f3ed9bc9
                stepCounter: b8190c7e-238c-42f2-a6b7-dc0f8593f039
            transform: TARGET.EXCHANGE_RATE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 191b929b-55c3-4db8-bdc8-cf76dc1998c9
          stepCounter: 6e51d19c-6595-41a0-9a74-29a93e678845
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1085d11-0dbd-44a1-9ecb-6b60b509041e
                stepCounter: b8190c7e-238c-42f2-a6b7-dc0f8593f039
            transform: TARGET.OP_CURR_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7f27c93-3211-4823-89a3-d469c5b7bb39
          stepCounter: 6e51d19c-6595-41a0-9a74-29a93e678845
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Indicates amounts are gross or net.
        name: GROSS_OR_NET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03ce309c-ce93-4603-aea8-a0a76b8f0754
                stepCounter: b8190c7e-238c-42f2-a6b7-dc0f8593f039
            transform: TARGET.GROSS_OR_NET_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2925ed42-32b1-42c0-9164-c9fb79abcdf5
          stepCounter: 6e51d19c-6595-41a0-9a74-29a93e678845
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: LINE_NO_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4460264-eeac-48f7-bae2-1748cdbcf9cb
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cafe1b70-d99a-488d-b7cd-3ee922e44358
          stepCounter: 6e51d19c-6595-41a0-9a74-29a93e678845
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: OP_NONOP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd329e2b-7051-4ae4-a37e-f229f635f81c
                stepCounter: b8190c7e-238c-42f2-a6b7-dc0f8593f039
            transform: TARGET.OP_NONOP
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f06fd4f-c904-4d22-87dd-c3adb269ea5e
          stepCounter: 6e51d19c-6595-41a0-9a74-29a93e678845
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PROD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_LO_SAP_105A: b8190c7e-238c-42f2-a6b7-dc0f8593f039
          STAGE_LO_SAP_110A: de9ddde4-4f46-4a1f-ab3a-a0a8a5edc7da
          STAGE_LO_SAP_111A: 31fe5344-ca1b-402b-8cde-18d8fed52e7a
          DIM_LO_SAP_LEASE_OPS_HIER: 82938641-7c51-4aff-ad3a-c7a56af30c01
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_105A
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_110A
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_111A
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_HIER
        join:
          joinCondition: |-
            FROM (
                    SELECT STAGE_LO_SAP_105A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_105A') }} STAGE_LO_SAP_105A
                 UNION ALL SELECT STAGE_LO_SAP_110A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_110A') }} STAGE_LO_SAP_110A
                 UNION ALL SELECT STAGE_LO_SAP_111A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_111A') }} STAGE_LO_SAP_111A
                   ) TARGET
             CROSS JOIN (
                    SELECT DIM_LEASE_OPS_HIER_KEY,
                           LINE_NO,
                           LINE_NO_GROUP
                      FROM {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_HIER') }}
                     WHERE DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO = '115A'
                   ) DIM_LO_SAP_LEASE_OPS_HIER
             GROUP BY TARGET.DIM_LEDGER_KEY,
                      TARGET.DIM_ACTVY_PER_DATE_KEY,
                      TARGET.DIM_ACCT_PER_DATE_KEY,
                      TARGET.DIM_COST_CENTER_KEY,
                      TARGET.DIM_DEST_ORGANIZATION_KEY,
                      TARGET.DIM_GROSS_NET_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.DIM_LEASE_OPS_HIER_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO_GROUP,
                      TARGET.DIM_LEASE_OPS_VERSION_KEY,
                      TARGET.EXCHANGE_RATE,
                      TARGET.OP_CURR_CODE,
                      TARGET.GROSS_OR_NET_CODE,
                      TARGET.OP_NONOP
        name: STAGE_LO_SAP_115A
        noLinkRefs: []
  name: STAGE_LO_SAP_115A
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
