fileVersion: 1
id: 69c06b9c-7e3a-43e6-b267-6669bcd021f0
name: STAGE_LO_SAP_100A
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1ce5608-2f01-44f1-ad99-2126f2fedc11
          stepCounter: 69c06b9c-7e3a-43e6-b267-6669bcd021f0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEDGER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 004b7fe6-5547-474f-a08e-b1177be6c44c
                stepCounter: 9b303f66-9e5d-463f-a7c1-acb9d898a0c0
            transform: TARGET.DIM_LEDGER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5172705a-2e7c-462c-aeaf-5e619380da2c
          stepCounter: 69c06b9c-7e3a-43e6-b267-6669bcd021f0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACTVY_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d6073b63-3483-4a80-8343-82132d5ce84d
                stepCounter: 9b303f66-9e5d-463f-a7c1-acb9d898a0c0
            transform: TARGET.DIM_ACTVY_PER_DATE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eca2037b-aa28-4b82-a00e-b1111fbdcff3
          stepCounter: 69c06b9c-7e3a-43e6-b267-6669bcd021f0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACCT_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 545b9e23-5f85-4427-9bfb-45868b03df29
                stepCounter: cb0bb7ea-9a7c-494f-bcc2-88d9df6d3acc
            transform: TARGET.DIM_ACCT_PER_DATE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a49123d8-0d1e-4520-8211-a8a0b96cd7f5
          stepCounter: 69c06b9c-7e3a-43e6-b267-6669bcd021f0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_COST_CENTER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 15ea8d3e-8ff8-46a8-ad7f-8832d0dd76ad
                stepCounter: 21adef72-fe99-493c-aa73-eef647719526
            transform: TARGET.DIM_COST_CENTER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2dccc29-3476-4fa8-a380-de75370183b4
          stepCounter: 69c06b9c-7e3a-43e6-b267-6669bcd021f0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e2befef-3308-4146-8363-3d093068c79d
          stepCounter: 69c06b9c-7e3a-43e6-b267-6669bcd021f0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_DEST_ORGANIZATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e8bd2570-5a50-48d3-acd0-ee3dcf246a83
                stepCounter: 9b303f66-9e5d-463f-a7c1-acb9d898a0c0
            transform: TARGET.DIM_DEST_ORGANIZATION_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1fa06a20-8916-487a-88d4-98e121724751
          stepCounter: 69c06b9c-7e3a-43e6-b267-6669bcd021f0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GL_ACCOUNT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6f06896-0efb-442f-89fa-6e349b0baa57
          stepCounter: 69c06b9c-7e3a-43e6-b267-6669bcd021f0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 452139c2-114b-4242-a38d-fd69fae67a42
                stepCounter: 9b303f66-9e5d-463f-a7c1-acb9d898a0c0
            transform: TARGET.DIM_GROSS_NET_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04e44954-e27d-45d9-97e3-bb167f0c32b3
          stepCounter: 69c06b9c-7e3a-43e6-b267-6669bcd021f0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_HIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21fac97a-151e-4cc2-8783-56a1148d309b
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f4e8517-d7f0-4c64-a23f-39bad82b87f6
          stepCounter: 69c06b9c-7e3a-43e6-b267-6669bcd021f0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_VERSION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 452fae5c-2fcb-4cf9-bbf5-f8f8073e0d2a
                stepCounter: 9b303f66-9e5d-463f-a7c1-acb9d898a0c0
            transform: TARGET.DIM_LEASE_OPS_VERSION_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0a7d7ef-73eb-4336-b311-b091ffe2d30f
          stepCounter: 69c06b9c-7e3a-43e6-b267-6669bcd021f0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LINE_ITEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3bb4c9c4-c8e3-49a9-9c32-1bb640b0befe
          stepCounter: 69c06b9c-7e3a-43e6-b267-6669bcd021f0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_VOUCHER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 926f2ee6-ad65-479c-bbd3-54c0bdfd266b
          stepCounter: 69c06b9c-7e3a-43e6-b267-6669bcd021f0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1a1606d-10d0-48b6-8019-c27ddcf6296e
          stepCounter: 69c06b9c-7e3a-43e6-b267-6669bcd021f0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_INVOICE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 866d0424-e24c-4e54-a643-1d7e374a2322
          stepCounter: 69c06b9c-7e3a-43e6-b267-6669bcd021f0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_PRODUCT_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 00e95fcd-b278-4977-824b-1fc332e2a285
          stepCounter: 69c06b9c-7e3a-43e6-b267-6669bcd021f0
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1a83d4b-9af5-4a64-b5b2-f6f811cf7698
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f96e4d4-709d-49c5-a407-b2a8b74c5a6f
          stepCounter: 69c06b9c-7e3a-43e6-b267-6669bcd021f0
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5015a2a2-6315-4134-b732-5381c5b8a638
                stepCounter: 9b303f66-9e5d-463f-a7c1-acb9d898a0c0
            transform: SUM(OP_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a25676c-86f1-47c2-b00d-190d1f6256b7
          stepCounter: 69c06b9c-7e3a-43e6-b267-6669bcd021f0
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 343b40ee-adc5-4f0a-8563-1895f3edf047
                stepCounter: 9b303f66-9e5d-463f-a7c1-acb9d898a0c0
            transform: SUM(CAD_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4f44a65-f0ca-44a8-b503-8d3e5c5df609
          stepCounter: 69c06b9c-7e3a-43e6-b267-6669bcd021f0
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: 'Gross Line Item Net Op Amount '
        name: NET_OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d173afd-ce9f-4c14-a825-5351d3d81423
                stepCounter: 9b303f66-9e5d-463f-a7c1-acb9d898a0c0
            transform: SUM(NET_OP_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 177a2d1b-0a3b-4ebe-953f-be944b117ee5
          stepCounter: 69c06b9c-7e3a-43e6-b267-6669bcd021f0
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: LI_VOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7118bde8-6b39-47e0-bfd0-810c505d6fc7
                stepCounter: 9b303f66-9e5d-463f-a7c1-acb9d898a0c0
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7785502b-69b2-4773-b07d-12af8ed06f6a
          stepCounter: 69c06b9c-7e3a-43e6-b267-6669bcd021f0
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in cubic meters (m3)
        name: LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2221934-2edd-4d22-99ca-75e5ee0c457a
                stepCounter: 9b303f66-9e5d-463f-a7c1-acb9d898a0c0
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27f2cff4-6d9e-43df-96fd-ee661c19b917
          stepCounter: 69c06b9c-7e3a-43e6-b267-6669bcd021f0
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in imperial measurement
        name: LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9edf5058-97c6-46c0-8aae-777141b80a57
                stepCounter: 9b303f66-9e5d-463f-a7c1-acb9d898a0c0
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f1610eab-c3c7-4919-9690-5949540ead14
          stepCounter: 69c06b9c-7e3a-43e6-b267-6669bcd021f0
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in BOE (Barrel of Oil Equivalent)
        name: LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 37a2b50b-5d9a-4138-beb5-d1b0784d16b0
                stepCounter: 9b303f66-9e5d-463f-a7c1-acb9d898a0c0
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e30be80d-d14e-4a6d-bdfb-d89801eff98b
          stepCounter: 69c06b9c-7e3a-43e6-b267-6669bcd021f0
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in normalized cubic meters (nm3)
        name: LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fdee0a3a-0052-4298-9e0b-f5573c83bdf3
                stepCounter: 9b303f66-9e5d-463f-a7c1-acb9d898a0c0
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa8cc456-87dc-4b4c-927a-dde6b6a0de4f
          stepCounter: 69c06b9c-7e3a-43e6-b267-6669bcd021f0
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: ""
        name: EXCHANGE_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 55d87c39-0123-4dd2-b2cc-0b0ffd588e4b
                stepCounter: 9b303f66-9e5d-463f-a7c1-acb9d898a0c0
            transform: TARGET.EXCHANGE_RATE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82e1a345-7a7e-4fba-9326-eac4ee836c47
          stepCounter: 69c06b9c-7e3a-43e6-b267-6669bcd021f0
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56ef3e04-fdd5-4807-8d06-c7fa21ff0d2e
                stepCounter: 9b303f66-9e5d-463f-a7c1-acb9d898a0c0
            transform: TARGET.OP_CURR_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4965ef35-7dbc-46d0-be3e-193af9bd708d
          stepCounter: 69c06b9c-7e3a-43e6-b267-6669bcd021f0
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Indicates amounts are gross or net.
        name: GROSS_OR_NET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5457ec5e-b64b-4283-94b5-5b3670ee4335
                stepCounter: 9b303f66-9e5d-463f-a7c1-acb9d898a0c0
            transform: TARGET.GROSS_OR_NET_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a68d2e2a-5a97-496e-9915-cf157e5475f0
          stepCounter: 69c06b9c-7e3a-43e6-b267-6669bcd021f0
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: LINE_NO_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4460264-eeac-48f7-bae2-1748cdbcf9cb
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50d04dd4-c3bf-4e05-8f1f-c339f53e82a7
          stepCounter: 69c06b9c-7e3a-43e6-b267-6669bcd021f0
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: OP_NONOP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2fa1dc1e-4987-4fbd-8f52-47bacc1d1fb7
                stepCounter: 9b303f66-9e5d-463f-a7c1-acb9d898a0c0
            transform: TARGET.OP_NONOP
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e833ce0a-1c65-4e12-bd63-4f074103210a
          stepCounter: 69c06b9c-7e3a-43e6-b267-6669bcd021f0
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PROD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_LO_SAP_85A: 9b303f66-9e5d-463f-a7c1-acb9d898a0c0
          STAGE_LO_SAP_90A: cb0bb7ea-9a7c-494f-bcc2-88d9df6d3acc
          STAGE_LO_SAP_95A: 21adef72-fe99-493c-aa73-eef647719526
          DIM_LO_SAP_LEASE_OPS_HIER: 82938641-7c51-4aff-ad3a-c7a56af30c01
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_85A
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_90A
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_95A
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_HIER
        join:
          joinCondition: |-
            FROM (
                    SELECT STAGE_LO_SAP_85A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_85A') }} STAGE_LO_SAP_85A
                 UNION ALL SELECT STAGE_LO_SAP_90A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_90A') }} STAGE_LO_SAP_90A
                 UNION ALL SELECT STAGE_LO_SAP_95A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_95A') }} STAGE_LO_SAP_95A
                   ) TARGET
             CROSS JOIN (
                    SELECT DIM_LEASE_OPS_HIER_KEY,
                           LINE_NO,
                           LINE_NO_GROUP
                      FROM {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_HIER') }}
                     WHERE DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO = '100A'
                   ) DIM_LO_SAP_LEASE_OPS_HIER
             GROUP BY TARGET.DIM_LEDGER_KEY,
                      TARGET.DIM_ACTVY_PER_DATE_KEY,
                      TARGET.DIM_ACCT_PER_DATE_KEY,
                      TARGET.DIM_COST_CENTER_KEY,
                      TARGET.DIM_DEST_ORGANIZATION_KEY,
                      TARGET.DIM_GROSS_NET_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.DIM_LEASE_OPS_HIER_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO_GROUP,
                      TARGET.DIM_LEASE_OPS_VERSION_KEY,
                      TARGET.EXCHANGE_RATE,
                      TARGET.OP_CURR_CODE,
                      TARGET.GROSS_OR_NET_CODE,
                      TARGET.OP_NONOP
        name: STAGE_LO_SAP_100A
        noLinkRefs: []
  name: STAGE_LO_SAP_100A
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
