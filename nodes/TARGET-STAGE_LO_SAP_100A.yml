fileVersion: 1
id: fa8bab81-e98e-4dee-966c-d25cfe351824
name: STAGE_LO_SAP_100A
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9219f7e0-e6c9-4c1f-96a0-5a429e1484b0
          stepCounter: fa8bab81-e98e-4dee-966c-d25cfe351824
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEDGER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 17f7b3e5-0e5f-4b67-a7cb-9a570be15ef0
                stepCounter: fc1d38d2-ad9f-4ee9-98f3-41bad06a7c8d
            transform: TARGET.DIM_LEDGER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc371fb6-254f-40e9-ace9-aeeafaa45da6
          stepCounter: fa8bab81-e98e-4dee-966c-d25cfe351824
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACTVY_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7619a215-a64d-4190-bbf4-4bc9421173f1
                stepCounter: fc1d38d2-ad9f-4ee9-98f3-41bad06a7c8d
            transform: TARGET.DIM_ACTVY_PER_DATE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 76b38573-fd21-4981-aba2-84467cd44ffc
          stepCounter: fa8bab81-e98e-4dee-966c-d25cfe351824
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACCT_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 30f4bd08-4d08-4b47-b00f-1b27b5034806
                stepCounter: 0bf5a02b-e7b4-4257-a8fb-bfae27fbb43e
            transform: TARGET.DIM_ACCT_PER_DATE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b92cbd57-f709-485b-9b30-3b0314aa9c4e
          stepCounter: fa8bab81-e98e-4dee-966c-d25cfe351824
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_COST_CENTER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 12940d5a-f125-4de4-8e2a-378d8d2e3a54
                stepCounter: 8d2223a6-10c7-4fe0-85d7-6f22d3f666b8
            transform: TARGET.DIM_COST_CENTER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 537c869f-f126-4659-97e7-8df895c57372
          stepCounter: fa8bab81-e98e-4dee-966c-d25cfe351824
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c74f258-a852-42e3-b234-1dc6db0819a3
          stepCounter: fa8bab81-e98e-4dee-966c-d25cfe351824
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_DEST_ORGANIZATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64920077-8a61-4d65-b94f-19fa0eb9f5ff
                stepCounter: fc1d38d2-ad9f-4ee9-98f3-41bad06a7c8d
            transform: TARGET.DIM_DEST_ORGANIZATION_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e34a8282-a27e-486b-8e04-ede9051ea3e9
          stepCounter: fa8bab81-e98e-4dee-966c-d25cfe351824
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GL_ACCOUNT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b03ca09a-d557-4ca5-8d44-2ef6f3cf0e05
          stepCounter: fa8bab81-e98e-4dee-966c-d25cfe351824
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59a1bd8e-286b-4e22-9bbb-d1d37f9b67e4
                stepCounter: fc1d38d2-ad9f-4ee9-98f3-41bad06a7c8d
            transform: TARGET.DIM_GROSS_NET_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 325502f7-25d7-436a-aa12-b3aa8f283607
          stepCounter: fa8bab81-e98e-4dee-966c-d25cfe351824
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_HIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03094dcc-28c0-4fee-b106-8de0eba3539c
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d2d3249-34cd-454c-b254-35cdb8eedf3d
          stepCounter: fa8bab81-e98e-4dee-966c-d25cfe351824
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_VERSION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed1441ae-652d-4a63-bd07-a696a870e2ea
                stepCounter: fc1d38d2-ad9f-4ee9-98f3-41bad06a7c8d
            transform: TARGET.DIM_LEASE_OPS_VERSION_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95a60e21-f8b3-4664-8361-a35cd31baaf7
          stepCounter: fa8bab81-e98e-4dee-966c-d25cfe351824
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LINE_ITEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 134e74f0-2bb1-4c5c-994e-4973c6b22986
          stepCounter: fa8bab81-e98e-4dee-966c-d25cfe351824
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_VOUCHER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ded02d7-c52c-4bdb-b4e7-95c1640333a3
          stepCounter: fa8bab81-e98e-4dee-966c-d25cfe351824
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb735ef3-c2ae-41dd-b563-218f8533e68d
          stepCounter: fa8bab81-e98e-4dee-966c-d25cfe351824
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_INVOICE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8bd6b3e6-3a79-4157-90aa-720721e19d7f
          stepCounter: fa8bab81-e98e-4dee-966c-d25cfe351824
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_PRODUCT_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b338d745-9b6a-435b-9c27-5924d6d66cd8
          stepCounter: fa8bab81-e98e-4dee-966c-d25cfe351824
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3f84c21-4ee9-4cae-88e0-9ce9656d3204
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 879c856c-d172-4412-9c02-572ff31f635c
          stepCounter: fa8bab81-e98e-4dee-966c-d25cfe351824
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56084152-9bc0-4e8d-97a3-4ceb85577e1a
                stepCounter: fc1d38d2-ad9f-4ee9-98f3-41bad06a7c8d
            transform: SUM(OP_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc1496bc-4e7c-4ac5-b6bd-277d5785541e
          stepCounter: fa8bab81-e98e-4dee-966c-d25cfe351824
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33940450-0823-46f6-aba4-8c6bcc77c652
                stepCounter: fc1d38d2-ad9f-4ee9-98f3-41bad06a7c8d
            transform: SUM(CAD_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87c861ab-67bc-40ce-bfcf-69f157630b60
          stepCounter: fa8bab81-e98e-4dee-966c-d25cfe351824
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: 'Gross Line Item Net Op Amount '
        name: NET_OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ce753fb-b8a7-4ee1-a6e6-0b50a31a345b
                stepCounter: fc1d38d2-ad9f-4ee9-98f3-41bad06a7c8d
            transform: SUM(NET_OP_AMT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11be5dea-3dfa-4b70-877f-abca666b4f5e
          stepCounter: fa8bab81-e98e-4dee-966c-d25cfe351824
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: LI_VOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c08a691d-72f7-49b9-a09c-2cca660a5d94
                stepCounter: fc1d38d2-ad9f-4ee9-98f3-41bad06a7c8d
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a74697f-8ab5-465d-9bba-46694c9de211
          stepCounter: fa8bab81-e98e-4dee-966c-d25cfe351824
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in cubic meters (m3)
        name: LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a18e3f8f-b4f1-44c2-a7a8-017e3a50256f
                stepCounter: fc1d38d2-ad9f-4ee9-98f3-41bad06a7c8d
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2da8f1a9-d739-4ac9-9648-0cd2731259bd
          stepCounter: fa8bab81-e98e-4dee-966c-d25cfe351824
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in imperial measurement
        name: LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7dbabf5e-42cd-4b58-92ef-c1dd5869fe83
                stepCounter: fc1d38d2-ad9f-4ee9-98f3-41bad06a7c8d
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c6437cb-998a-4de4-b863-dee5ac4619ed
          stepCounter: fa8bab81-e98e-4dee-966c-d25cfe351824
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in BOE (Barrel of Oil Equivalent)
        name: LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2567cb65-ab43-48ed-8828-fc7d5a1b2cc5
                stepCounter: fc1d38d2-ad9f-4ee9-98f3-41bad06a7c8d
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0da4cac2-5f6d-4405-a235-e3f464434a56
          stepCounter: fa8bab81-e98e-4dee-966c-d25cfe351824
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in normalized cubic meters (nm3)
        name: LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cf2c0603-b87b-49e7-ba53-2e0025511937
                stepCounter: fc1d38d2-ad9f-4ee9-98f3-41bad06a7c8d
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bc5a9b12-0d60-4930-8ee4-9808375f0f9c
          stepCounter: fa8bab81-e98e-4dee-966c-d25cfe351824
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: ""
        name: EXCHANGE_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 094184dd-0c39-4086-a043-462d48e42fec
                stepCounter: fc1d38d2-ad9f-4ee9-98f3-41bad06a7c8d
            transform: TARGET.EXCHANGE_RATE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f494cc3-258c-44a9-8c2a-230829d80799
          stepCounter: fa8bab81-e98e-4dee-966c-d25cfe351824
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 40660abf-9a15-4db6-a795-e406a3bf09b0
                stepCounter: fc1d38d2-ad9f-4ee9-98f3-41bad06a7c8d
            transform: TARGET.OP_CURR_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47cf4602-de49-4add-94e8-e5ba8808bed6
          stepCounter: fa8bab81-e98e-4dee-966c-d25cfe351824
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Indicates amounts are gross or net.
        name: GROSS_OR_NET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ff30bd8-9474-4d9e-9bae-e01064170dd4
                stepCounter: fc1d38d2-ad9f-4ee9-98f3-41bad06a7c8d
            transform: TARGET.GROSS_OR_NET_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 430b6a5d-a4fe-4c93-9de9-1041fc7a44b5
          stepCounter: fa8bab81-e98e-4dee-966c-d25cfe351824
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: LINE_NO_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4607c855-a49d-4eb4-bbf8-11be2b047885
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a9f84a1-17a2-4db1-afec-9f3e477b8bc9
          stepCounter: fa8bab81-e98e-4dee-966c-d25cfe351824
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: OP_NONOP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8faa1264-7a2e-44fd-a48b-abdc383bb03f
                stepCounter: fc1d38d2-ad9f-4ee9-98f3-41bad06a7c8d
            transform: TARGET.OP_NONOP
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05df94f2-9cca-45ce-a9df-ce16993d9c41
          stepCounter: fa8bab81-e98e-4dee-966c-d25cfe351824
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PROD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_LO_SAP_85A: fc1d38d2-ad9f-4ee9-98f3-41bad06a7c8d
          STAGE_LO_SAP_90A: 0bf5a02b-e7b4-4257-a8fb-bfae27fbb43e
          STAGE_LO_SAP_95A: 8d2223a6-10c7-4fe0-85d7-6f22d3f666b8
          DIM_LO_SAP_LEASE_OPS_HIER: e0b535c4-f94e-4ac1-b685-dfdff6293176
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_85A
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_90A
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_95A
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_HIER
        join:
          joinCondition: |-
            FROM (
                    SELECT STAGE_LO_SAP_85A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_85A') }} STAGE_LO_SAP_85A
                 UNION ALL SELECT STAGE_LO_SAP_90A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_90A') }} STAGE_LO_SAP_90A
                 UNION ALL SELECT STAGE_LO_SAP_95A.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_95A') }} STAGE_LO_SAP_95A
                   ) TARGET
             CROSS JOIN (
                    SELECT DIM_LEASE_OPS_HIER_KEY,
                           LINE_NO,
                           LINE_NO_GROUP
                      FROM {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_HIER') }}
                     WHERE DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO = '100A'
                   ) DIM_LO_SAP_LEASE_OPS_HIER
             GROUP BY TARGET.DIM_LEDGER_KEY,
                      TARGET.DIM_ACTVY_PER_DATE_KEY,
                      TARGET.DIM_ACCT_PER_DATE_KEY,
                      TARGET.DIM_COST_CENTER_KEY,
                      TARGET.DIM_DEST_ORGANIZATION_KEY,
                      TARGET.DIM_GROSS_NET_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.DIM_LEASE_OPS_HIER_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO_GROUP,
                      TARGET.DIM_LEASE_OPS_VERSION_KEY,
                      TARGET.EXCHANGE_RATE,
                      TARGET.OP_CURR_CODE,
                      TARGET.GROSS_OR_NET_CODE,
                      TARGET.OP_NONOP
        name: STAGE_LO_SAP_100A
        noLinkRefs: []
  name: STAGE_LO_SAP_100A
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
