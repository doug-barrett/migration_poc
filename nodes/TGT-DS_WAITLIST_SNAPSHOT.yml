fileVersion: 1
id: 094c4583-7743-4ae0-9df4-7b84c010808b
name: DS_WAITLIST_SNAPSHOT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Only has a custom procedure to ensure that there is only one snapshoit a day and only 150 days maximum of snapshots"
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bad0f0b2-4563-465b-8dcb-797058e2041a
          stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date the snapshot of Open Waitlists was run
        isBusinessKey: true
        name: SNAPSHOTDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: Convert(datetime,cast(getdate() AS date),120)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11c12bb8-ea3c-4474-abfd-16738967cf09
          stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: WAITLIST_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 62aa4dac-2134-4f46-90ef-6a291e98b0d5
                stepCounter: 2d2f3784-984c-4c2c-b38e-84c531dd087a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: baf4fe7e-830a-4aec-b8bc-faef2ae2330a
          stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ESPI_COMPLIANT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a45cef6-e79c-40e1-a8f0-c948f48ba3b7
                stepCounter: 2d2f3784-984c-4c2c-b38e-84c531dd087a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 732fc434-0f79-4103-bbfa-32f912fd2f5f
          stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITLIST_CLOCK_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9b26bbc-1fe3-4b0f-a773-887a2251a498
                stepCounter: 2d2f3784-984c-4c2c-b38e-84c531dd087a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47269a5a-c751-422b-ba0d-5123cc8dd07f
          stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITING_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23cf36ea-7290-45d6-8536-ea128a8bc051
                stepCounter: 2d2f3784-984c-4c2c-b38e-84c531dd087a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d354a2c-24e5-41d1-89e8-c14c8c4c2b8c
          stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITLIST_DUE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 35dcc9f0-42ca-4dfd-a936-0ca5d624de43
                stepCounter: 2d2f3784-984c-4c2c-b38e-84c531dd087a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b3bdf2e2-ea5a-4180-a3b8-346af6c313f3
          stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: OUTPATIENT_APPOINTMENT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd6a2b7f-5e9c-4e01-ab2b-208db4fba495
                stepCounter: 2d2f3784-984c-4c2c-b38e-84c531dd087a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4072825f-c26f-4a65-9ea6-011fd96c4038
          stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d4ef9c81-4f83-4438-a1f5-a0065b085a05
                stepCounter: 2d2f3784-984c-4c2c-b38e-84c531dd087a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 119e37f9-94f6-41df-a8ef-01a2b84b03da
          stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c1092deb-7a92-44d1-9aac-9d57ba1c1432
                stepCounter: 2d2f3784-984c-4c2c-b38e-84c531dd087a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 018bee13-0f52-47db-aac4-edcfe9e87048
          stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
        config: {}
        dataType: VARCHAR(2000)
        defaultValue: ""
        description: ""
        name: WAITLIST_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 043b22b9-1a16-44af-a7eb-6bc3f7b80d9f
                stepCounter: 2d2f3784-984c-4c2c-b38e-84c531dd087a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4301eab4-864e-4a5c-b8ca-90056b5e7fe0
          stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CERTAINTY_GIVEN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9e90a9af-f96c-44e7-87d6-f615b194e6fc
                stepCounter: 2d2f3784-984c-4c2c-b38e-84c531dd087a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e7ac777-f629-4e1a-af33-f4c942cc70fb
          stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Days waited at the end of the current month, if waitlist still open
        name: WAITLIST_WAITING_MONTHEND_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 280751bc-f0df-4519-8505-13f196f391e9
                stepCounter: 2d2f3784-984c-4c2c-b38e-84c531dd087a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 84b2ac55-e522-4d62-a88b-fe0585979b5b
          stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: PIMS Speciality Reference Number
        name: WAITLIST_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f810fff1-666c-4b23-a93f-a9b765d8cf87
                stepCounter: 37897fcd-5ea0-47ee-96e7-b3f1f8b36d87
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2c4f89e-a39c-4dd2-bc6c-f40529389b64
          stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Specialty Code
        name: WAITLIST_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 204930da-0f13-4bc7-b24a-9ebf5d444e85
                stepCounter: 37897fcd-5ea0-47ee-96e7-b3f1f8b36d87
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3376233-e937-4a2d-85d4-04dfb753bfe8
          stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Specialty Description
        name: WAITLIST_SPECIALTY_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d7f3542d-7fa5-4427-ae95-5907b1f2675a
                stepCounter: 37897fcd-5ea0-47ee-96e7-b3f1f8b36d87
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf3d65e4-c8e8-47d9-a85b-83fd29d3cd0b
          stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LOCAL_CATEGORY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 01e84721-7cd7-4cf6-bb9c-6580a7b1cc48
                stepCounter: 8b5331a4-4c77-49a3-bec1-72b8ba71cae8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca4545ba-c8c5-4e58-b999-6b8c3040ef20
          stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LOCAL_CATEGORY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5402f1ba-06bd-4f4b-8cc2-fa645a2e13b0
                stepCounter: 8b5331a4-4c77-49a3-bec1-72b8ba71cae8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02dd162f-fa91-4ad6-8e8c-c52f062647a9
          stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: LOCAL_CATEGORY_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d085a3ef-4764-4aed-8095-ff6bb502c3c3
                stepCounter: 8b5331a4-4c77-49a3-bec1-72b8ba71cae8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8db434f9-1933-40b5-bad5-4a63942522d0
          stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: LOCAL_CATEGORY_SUBSPECIALTY_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c856716c-fe0d-49dc-a1d2-130c85672674
                stepCounter: 8b5331a4-4c77-49a3-bec1-72b8ba71cae8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0491a54c-deec-4b10-8fdc-164166c26252
          stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: ESPI_TYPE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b3889974-4600-4076-a241-8a14d2b1dc05
                stepCounter: fa4aa4f0-f734-4a9b-bf53-ca1e2647b7b0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 133235a9-752b-40e9-8ac5-9562a6107649
          stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: referral_priority_desc
        name: WAITLIST_PRIORITY_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2557d357-1ca5-4f1f-88f1-dbd62871c27e
                stepCounter: 44358bb9-9c05-480c-80fc-1195de9552b3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72004be9-3bec-4d51-aeca-d14b38b1935f
          stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LIST_NAME_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 53c4e99f-ac33-48f0-872d-06f37fa652a1
                stepCounter: dadb2ec5-9218-4b98-83b9-011c7f4f1cb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5667489-0fa9-4771-a59b-fc6010d8ae80
          stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LIST_NAME_SPECIALTY_FACILITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d8b471d8-f3fc-48bc-a1fb-cc5ab122d7ba
                stepCounter: dadb2ec5-9218-4b98-83b9-011c7f4f1cb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2da4f821-6637-46b2-af21-be76d6e066f6
          stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Healthcare_Professional_Reference_Number
        name: WAITLIST_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48cd5c1c-68d8-4492-a227-b0a9a2aa0d2f
                stepCounter: 19000cde-0ad8-4d32-812e-f0fec7243d19
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0473b699-88aa-4bf7-8ee4-bf054f2a6aca
          stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Healthcare_Professional_Code
        name: WAITLIST_CLINICIAN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27226f26-3d0d-46ca-9beb-e1cba454f794
                stepCounter: 19000cde-0ad8-4d32-812e-f0fec7243d19
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 63b84977-de9b-40bb-905b-7e42b3750490
          stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: healthcare_professional_fullname
        name: WAITLIST_CLINICIAN_FULLNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 61734ab7-c200-4857-9877-cc85ed22724b
                stepCounter: 19000cde-0ad8-4d32-812e-f0fec7243d19
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1912c716-f250-43cd-a8c3-ddd0cfc74754
          stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: WAITLIST_BOOKING_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 53563a38-c1cc-48e4-bad9-05098b9de3e2
                stepCounter: 9fba35bf-0cfe-4408-842d-7613e3ae7895
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d67c824a-ec2b-4e22-9c65-761071370de9
          stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: BOOKED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b34340e5-54c8-4bfb-aa9a-2769ac5bf8e4
                stepCounter: 9fba35bf-0cfe-4408-842d-7613e3ae7895
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 234a8e91-f857-4144-93f2-21c16c0fc332
          stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: WAITLIST_REMOVAL_REASON_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c3b478c1-93e6-4d56-bba0-f0e8b023fda9
                stepCounter: c39228fd-cafe-41e2-93c8-28669128f12b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7003b21f-043b-4ed9-bb22-c342ad2bc086
          stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SURGICAL_THEATRE_BOOKING_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ac557800-c379-4611-a85f-22292d73ab28
                stepCounter: 2d2f3784-984c-4c2c-b38e-84c531dd087a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5604f541-f6b3-4929-847f-59da4eed7950
          stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: TCI_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 336738c1-29f9-44b9-a1eb-5921d5bdcb00
                stepCounter: 2d2f3784-984c-4c2c-b38e-84c531dd087a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 43f684d1-c219-4ec9-9f30-50ae9d6111df
          stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Is the patient currently admitted for theis waitlist episode
        name: CURRENT_INPATIENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4655da0e-5d66-42d3-9f61-e429ba1b6196
                stepCounter: 2d2f3784-984c-4c2c-b38e-84c531dd087a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9c38c89-c6d3-4330-bc5a-fc411ec993a1
          stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 14736a11-65bf-44a8-9b4c-42ff8e142e03
                stepCounter: 2d2f3784-984c-4c2c-b38e-84c531dd087a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 119b7415-67bf-4a7b-8f6c-834133d0167d
          stepCounter: 094c4583-7743-4ae0-9df4-7b84c010808b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_WAITLIST_50: 2d2f3784-984c-4c2c-b38e-84c531dd087a
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_WAITLIST_50
        join:
          joinCondition: |-
            FROM {{ ref('TGT','S_WAITLIST_50') }} s_waitlist_50
              JOIN dim.dim_waitlist_specialty dim_waitlist_specialty
                ON s_waitlist_50.dim_waitlist_specialty_key = dim_waitlist_specialty.dim_waitlist_specialty_key
              JOIN dim.dim_local_category dim_local_category
                ON s_waitlist_50.dim_local_category_key = dim_local_category.dim_local_category_key
              JOIN dim.dim_ESPI_type dim_ESPI_type
                ON s_waitlist_50.dim_ESPI_type_key = dim_ESPI_type.dim_ESPI_type_key
              JOIN dim.dim_waitlist_priority dim_waitlist_priority
                ON s_waitlist_50.dim_waitlist_priority_key = dim_waitlist_priority.dim_waitlist_priority_key
              JOIN dim.dim_list_name dim_list_name
                ON s_waitlist_50.dim_list_name_key = dim_list_name.dim_list_name_key
              JOIN dim.dim_waitlist_clinician dim_waitlist_clinician
                ON s_waitlist_50.dim_waitlist_clinician_key = dim_waitlist_Clinician.dim_waitlist_clinician_key
              JOIN dim.dim_waitlist_booked_status dim_waitlist_booked_status
                ON s_waitlist_50.dim_waitlist_booked_status_key = dim_waitlist_booked_status.dim_waitlist_booked_status_key
              JOIN dim.dim_waitlist_removal_reason dim_waitlist_removal_reason
                ON s_waitlist_50.dim_waitlist_removal_reason_key = dim_waitlist_removal_reason.dim_waitlist_removal_reason_key
        name: DS_WAITLIST_SNAPSHOT
        noLinkRefs: []
  name: DS_WAITLIST_SNAPSHOT
  overrideSQL: false
  schema: ""
  sqlType: '38'
  type: sql
  version: 1
type: Node
