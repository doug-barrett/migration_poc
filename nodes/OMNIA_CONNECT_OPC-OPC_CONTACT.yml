fileVersion: 1
id: 5ab249f8-2a40-4889-8d00-8cb5efbc2076
name: OPC_CONTACT
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: OMNIA_CONNECT_OPC
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 52eb88a2-7adb-4ec8-8523-526a96ccad67
          stepCounter: 5ab249f8-2a40-4889-8d00-8cb5efbc2076
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: CONTACTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dcf5f781-2b00-4e01-9503-c981ed1ab780
                stepCounter: 4015cdd7-ddd6-45b0-996c-53903de48f6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dcb2b83a-d9ea-4c69-b2f3-6ac51a533393
          stepCounter: 5ab249f8-2a40-4889-8d00-8cb5efbc2076
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CONTACTSALESFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 97f1cc42-fc30-4e45-9035-fb88e27a8d58
                stepCounter: 4015cdd7-ddd6-45b0-996c-53903de48f6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29f4ba07-922d-458e-bd8c-efa61c7f70a1
          stepCounter: 5ab249f8-2a40-4889-8d00-8cb5efbc2076
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE HIGHEST-LEVEL OF HIERARCHY FOR AN ACCOUNT
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24c11b53-2f2c-48cc-9031-2c18c5cba232
                stepCounter: 4015cdd7-ddd6-45b0-996c-53903de48f6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 790ff0b1-c222-4e79-aee1-176590ae7b46
          stepCounter: 5ab249f8-2a40-4889-8d00-8cb5efbc2076
        config: {}
        dataType: INT
        defaultValue: ""
        description: UNIQUE IDENTIFIER FOR AN ACCOUNT. COMMONLY CALLED THE "FORCE ID"
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9e8ac381-63d2-42f8-a72e-d899cbe4b5e7
                stepCounter: 4015cdd7-ddd6-45b0-996c-53903de48f6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b5a63d3-5960-475d-8a66-415e7ac6b1d8
          stepCounter: 5ab249f8-2a40-4889-8d00-8cb5efbc2076
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ACCOUNTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ff038ec-5945-4fe6-a37e-095c43c1e3c2
                stepCounter: 4015cdd7-ddd6-45b0-996c-53903de48f6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 935cd2e6-4347-4f6b-8275-4499a56f20a7
          stepCounter: 5ab249f8-2a40-4889-8d00-8cb5efbc2076
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: DEPARTMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8fdecc29-b03a-4446-a253-9a7f12e37a1e
                stepCounter: 4015cdd7-ddd6-45b0-996c-53903de48f6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d1b8eb59-fc2f-4d76-8014-d0406a03b63f
          stepCounter: 5ab249f8-2a40-4889-8d00-8cb5efbc2076
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TITLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 363c83be-1d6c-4008-8044-b7a1d97942c1
                stepCounter: 4015cdd7-ddd6-45b0-996c-53903de48f6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da3488b9-17b4-4701-a3cf-9445f5f2d38b
          stepCounter: 5ab249f8-2a40-4889-8d00-8cb5efbc2076
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SALUTATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e8c559e-dbd9-4849-a352-d3566909622c
                stepCounter: 4015cdd7-ddd6-45b0-996c-53903de48f6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6513cd9-448d-4e86-8ed2-26fd71d6be1d
          stepCounter: 5ab249f8-2a40-4889-8d00-8cb5efbc2076
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: FIRSTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d603031-c0b3-4083-ab85-d7233156044e
                stepCounter: 4015cdd7-ddd6-45b0-996c-53903de48f6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7b607dc-6bff-49e1-b515-569798a3dc5b
          stepCounter: 5ab249f8-2a40-4889-8d00-8cb5efbc2076
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: LASTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fece3057-0a58-40ae-89ce-e051788f1776
                stepCounter: 4015cdd7-ddd6-45b0-996c-53903de48f6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 62cb8825-e16e-4082-bbb8-1b2ecba59b17
          stepCounter: 5ab249f8-2a40-4889-8d00-8cb5efbc2076
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: EMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aad7e8ca-1c14-4eca-b511-9212b2360106
                stepCounter: 4015cdd7-ddd6-45b0-996c-53903de48f6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4aa687af-20e7-41e3-9b60-1081b797f0b8
          stepCounter: 5ab249f8-2a40-4889-8d00-8cb5efbc2076
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PHONE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ae981418-0240-4e82-8893-d6bbef72d9e9
                stepCounter: 4015cdd7-ddd6-45b0-996c-53903de48f6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f8fa6e9-0514-4481-8d77-80ed1397d66c
          stepCounter: 5ab249f8-2a40-4889-8d00-8cb5efbc2076
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: MAILINGSTREET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c403e0e7-7e50-4564-a55d-f6751b5482df
                stepCounter: 4015cdd7-ddd6-45b0-996c-53903de48f6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e788bdf-5d7b-4045-a61d-41f38001d46d
          stepCounter: 5ab249f8-2a40-4889-8d00-8cb5efbc2076
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: MAILINGCITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 878b8660-0f32-48a2-8784-847f4932ca60
                stepCounter: 4015cdd7-ddd6-45b0-996c-53903de48f6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16352df4-3b65-4f06-af29-344d9ae5afd6
          stepCounter: 5ab249f8-2a40-4889-8d00-8cb5efbc2076
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: MAILINGSTATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 204a0ea5-2dd7-4a1b-a91c-8402bed817ae
                stepCounter: 4015cdd7-ddd6-45b0-996c-53903de48f6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1febeb3-696f-4b92-b188-2029b5f2b714
          stepCounter: 5ab249f8-2a40-4889-8d00-8cb5efbc2076
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: MAILINGPOSTALCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc51da0b-588d-4336-93af-41112f92f078
                stepCounter: 4015cdd7-ddd6-45b0-996c-53903de48f6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d6eb7f9-166b-4928-bbb6-d97367592994
          stepCounter: 5ab249f8-2a40-4889-8d00-8cb5efbc2076
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: MAILINGCOUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 46fab719-ae41-425d-8b95-aa642e1ea463
                stepCounter: 4015cdd7-ddd6-45b0-996c-53903de48f6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de2726f3-69b8-42f7-a6e4-7bb7f933160b
          stepCounter: 5ab249f8-2a40-4889-8d00-8cb5efbc2076
        config: {}
        dataType: DATE
        defaultValue: ""
        description: CONTACT CREATED IN MONTH
        name: CREATED_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09a9b6e5-141a-4004-b39e-545ef064c7da
                stepCounter: 4015cdd7-ddd6-45b0-996c-53903de48f6b
            transform: LAST_DAY(CONTACT.CREATEDDATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6795067-271a-4dde-a91c-5c62374d970f
          stepCounter: 5ab249f8-2a40-4889-8d00-8cb5efbc2076
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: LASTACTIVITYDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bcb2294a-2fc0-40d9-b94e-8a3b344faeb0
                stepCounter: 4015cdd7-ddd6-45b0-996c-53903de48f6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4398c08-8fb4-42c8-b24f-64e27caa08f4
          stepCounter: 5ab249f8-2a40-4889-8d00-8cb5efbc2076
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: LASTACTIVE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bcb2294a-2fc0-40d9-b94e-8a3b344faeb0
                stepCounter: 4015cdd7-ddd6-45b0-996c-53903de48f6b
            transform: CASE \NWHEN LASTACTIVITYDATE IS NULL THEN '' \N \NWHEN LASTACTIVITYDATE =CURRENT_DATE THEN 'TODAY' \N \NWHEN DATEDIFF('DAYS',LASTACTIVITYDATE,CURRENT_DATE)=1 THEN 'YESTERDAY' \N \NWHEN DATEDIFF('DAYS',LASTACTIVITYDATE,CURRENT_DATE)< 0 THEN 'UNKNOWN' \N \NWHEN DATEDIFF('MONTHS',LASTACTIVITYDATE,CURRENT_DATE)= 0 THEN \N(\NCONCAT \N(\NTO_VARCHAR(DATEDIFF('DAYS',LASTACTIVITYDATE,CURRENT_DATE)) ,'D', \N' AGO' \N) \N) \N \NWHEN DATEDIFF('MONTHS',LASTACTIVITYDATE,CURRENT_DATE)>= 24 THEN \N(CONCAT(\NTO_VARCHAR(DATEDIFF('YEAR',LASTACTIVITYDATE,CURRENT_DATE)) , 'Y', \N' AGO')) \NELSE \N(CONCAT(\NTO_VARCHAR(DATEDIFF('MONTHS',LASTACTIVITYDATE,CURRENT_DATE)) ,'MO', \N' AGO')) \NEND
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5450cb78-4d0f-4f05-915d-651028694214
          stepCounter: 5ab249f8-2a40-4889-8d00-8cb5efbc2076
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CREATEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09a9b6e5-141a-4004-b39e-545ef064c7da
                stepCounter: 4015cdd7-ddd6-45b0-996c-53903de48f6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4dc707d2-2b58-4340-ac4a-ec638ecf30c8
          stepCounter: 5ab249f8-2a40-4889-8d00-8cb5efbc2076
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf2ed580-6d25-4a27-902b-1498103cbb78
                stepCounter: 4015cdd7-ddd6-45b0-996c-53903de48f6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa4f588d-6f6b-45c2-b05c-3c76397496a3
          stepCounter: 5ab249f8-2a40-4889-8d00-8cb5efbc2076
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        name: PURCHASING_INFLUENCER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5eeceea-9444-4faa-b4c8-84d9c980e70e
                stepCounter: 4015cdd7-ddd6-45b0-996c-53903de48f6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a34e8280-5f02-4f26-926a-6f4de8acaeff
          stepCounter: 5ab249f8-2a40-4889-8d00-8cb5efbc2076
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        name: PURCHASING_DECISION_MAKER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4488007-e7d7-4f8f-9dab-075b771dda77
                stepCounter: 4015cdd7-ddd6-45b0-996c-53903de48f6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1a9e975-a1d1-4d04-991d-98b909c4fb03
          stepCounter: 5ab249f8-2a40-4889-8d00-8cb5efbc2076
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: DEPARTMENT_AI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9563f7e7-266f-476d-b74c-aa86a1db6a86
                stepCounter: 4015cdd7-ddd6-45b0-996c-53903de48f6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 874c912b-9350-4859-bf13-d56284cb843c
          stepCounter: 5ab249f8-2a40-4889-8d00-8cb5efbc2076
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: AREAS_OF_INTEREST_AI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bd8bc3d9-3b43-4211-91a5-4455380ed30f
                stepCounter: 4015cdd7-ddd6-45b0-996c-53903de48f6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af583988-0182-4721-974b-f761f08ca253
          stepCounter: 5ab249f8-2a40-4889-8d00-8cb5efbc2076
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: LAST_VALIDATED_AI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6379fcca-41ba-402e-93e6-f2ceb4fa316e
                stepCounter: 4015cdd7-ddd6-45b0-996c-53903de48f6b
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          CONTACT: 4015cdd7-ddd6-45b0-996c-53903de48f6b
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: CONTACT
        join:
          joinCondition: |-
            FROM {{ ref('DIM','CONTACT') }}
             WHERE NOT (CONTACT.LEVEL1FORCEID IS NULL OR CONTACT.NAME = 'NATIONAL IPA' OR CONTACT.FIRSTNAME LIKE '%UNKNOWN%' OR CONTACT.FIRSTNAME LIKE '%OMNIA%' OR CONTACT.LASTNAME LIKE '%UNKNOWN%' OR CONTACT.LASTNAME LIKE '%OMNIA%' OR CONTACT.DONOTEMAILFLAG = TRUE OR CONTACT.MARKETINGMAILOPTOUT = TRUE OR CONTACT.ISEMAILBOUNCED = TRUE OR CONTACT.ISDELETED = TRUE)
               AND CONTACT.STATUS = 'ACTIVE'
        name: OPC_CONTACT
        noLinkRefs: []
  name: OPC_CONTACT
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
