fileVersion: 1
id: 6db9032b-30b6-4aa9-9e62-5a123b1d1532
name: OPC_CONTACT
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: OMNIA_CONNECT_OPC
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7701507e-0aea-401a-870c-9994ad66d048
          stepCounter: 6db9032b-30b6-4aa9-9e62-5a123b1d1532
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CONTACTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a73af37f-395a-43e2-ad1e-46c2fedc925a
                stepCounter: e165c76e-6a45-4567-817a-c8ecf377ecd2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ec219dc-61db-4622-a5f4-9b8d85b6ebe8
          stepCounter: 6db9032b-30b6-4aa9-9e62-5a123b1d1532
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CONTACTSALESFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4f05b65-711b-4a81-8191-e1b528cdf088
                stepCounter: e165c76e-6a45-4567-817a-c8ecf377ecd2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b0d8323-f457-4452-8be1-e72960d54a74
          stepCounter: 6db9032b-30b6-4aa9-9e62-5a123b1d1532
        config: {}
        dataType: INT
        defaultValue: ""
        description: is the highest-level of hierarchy for an account
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1bb20aea-4980-4d8f-93a3-66a207e9c5ba
                stepCounter: e165c76e-6a45-4567-817a-c8ecf377ecd2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f397598d-f4e8-4182-b0b3-a6356399d05b
          stepCounter: 6db9032b-30b6-4aa9-9e62-5a123b1d1532
        config: {}
        dataType: INT
        defaultValue: ""
        description: Unique identifier for an account. Commonly called the "Force Id"
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f6c470f6-e66b-4455-91e1-406df534467f
                stepCounter: e165c76e-6a45-4567-817a-c8ecf377ecd2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 522aef85-3a6d-4fc5-8732-649ac84c3467
          stepCounter: 6db9032b-30b6-4aa9-9e62-5a123b1d1532
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ACCOUNTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c1e59330-361b-4472-ac4e-b70073683d10
                stepCounter: e165c76e-6a45-4567-817a-c8ecf377ecd2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce3e7752-9b91-4900-8ba0-4d8127e83284
          stepCounter: 6db9032b-30b6-4aa9-9e62-5a123b1d1532
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DEPARTMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 055d65fd-c58a-4b66-8ec1-f4bcb6dd1d21
                stepCounter: e165c76e-6a45-4567-817a-c8ecf377ecd2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 910090e0-3d3d-4019-a974-410b075b254d
          stepCounter: 6db9032b-30b6-4aa9-9e62-5a123b1d1532
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TITLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5fa2cecb-4181-416d-b4ed-d3a023eb5f11
                stepCounter: e165c76e-6a45-4567-817a-c8ecf377ecd2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 767ab3ed-14e3-41e8-ae6e-66a673721c52
          stepCounter: 6db9032b-30b6-4aa9-9e62-5a123b1d1532
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SALUTATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6dead25c-10c4-47ea-9b23-f339ebf5128c
                stepCounter: e165c76e-6a45-4567-817a-c8ecf377ecd2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78f497c6-f02f-4cfd-b131-effa476ddb65
          stepCounter: 6db9032b-30b6-4aa9-9e62-5a123b1d1532
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: FIRSTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 911b8382-5eb0-4310-8c44-be50882442ea
                stepCounter: e165c76e-6a45-4567-817a-c8ecf377ecd2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3eb7d824-ee26-49b9-aada-8beb3383801f
          stepCounter: 6db9032b-30b6-4aa9-9e62-5a123b1d1532
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LASTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3c9eccd-7869-48a6-bc66-6d0063a01e83
                stepCounter: e165c76e-6a45-4567-817a-c8ecf377ecd2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f5e6ec5-fa3a-482b-9007-2de191ba4f80
          stepCounter: 6db9032b-30b6-4aa9-9e62-5a123b1d1532
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: EMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d7e778b-f5d6-4ab7-96b8-dc405c19137b
                stepCounter: e165c76e-6a45-4567-817a-c8ecf377ecd2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1eb44cc8-e4bf-4e99-a499-f0d7e4e8ef0d
          stepCounter: 6db9032b-30b6-4aa9-9e62-5a123b1d1532
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PHONE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 700f4a47-3bb7-4d9e-a9b3-613036128fac
                stepCounter: e165c76e-6a45-4567-817a-c8ecf377ecd2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3ed7a9b-d1cc-4a7c-9c42-c5af9f6b029c
          stepCounter: 6db9032b-30b6-4aa9-9e62-5a123b1d1532
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: MAILINGSTREET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ce39f71-bfea-41d9-a08f-fd5acf74dacf
                stepCounter: e165c76e-6a45-4567-817a-c8ecf377ecd2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a401b1ee-20ad-4c16-8a75-decff2e11f1c
          stepCounter: 6db9032b-30b6-4aa9-9e62-5a123b1d1532
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: MAILINGCITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: af7364ae-823f-4668-921c-96c6018db255
                stepCounter: e165c76e-6a45-4567-817a-c8ecf377ecd2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8a2062f-d398-4bf2-8736-c912fec7293c
          stepCounter: 6db9032b-30b6-4aa9-9e62-5a123b1d1532
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: MAILINGSTATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: af33ec22-7857-4957-8a90-bf2592944a48
                stepCounter: e165c76e-6a45-4567-817a-c8ecf377ecd2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef47a139-6bef-44c8-9326-d2f5a4dd4469
          stepCounter: 6db9032b-30b6-4aa9-9e62-5a123b1d1532
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: MAILINGPOSTALCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 37ce93ab-5d20-4a8c-959d-90569e92855b
                stepCounter: e165c76e-6a45-4567-817a-c8ecf377ecd2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9230ae6-b032-4814-a2d8-5d501762adea
          stepCounter: 6db9032b-30b6-4aa9-9e62-5a123b1d1532
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: MAILINGCOUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2405efa5-691f-4479-8df4-5b5ada12e246
                stepCounter: e165c76e-6a45-4567-817a-c8ecf377ecd2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0eda3740-64c7-4fc6-b8c5-c32e5e59a79a
          stepCounter: 6db9032b-30b6-4aa9-9e62-5a123b1d1532
        config: {}
        dataType: DATE
        defaultValue: ""
        description: Contact Created in Month
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CREATED_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e1258f2-c401-4c2b-8cf9-9da939938f21
                stepCounter: e165c76e-6a45-4567-817a-c8ecf377ecd2
            transform: LAST_DAY(Contact.CreatedDate)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2cdccbf-3e58-4c46-b118-9153b238edfc
          stepCounter: 6db9032b-30b6-4aa9-9e62-5a123b1d1532
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LASTACTIVITYDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f0008085-55e7-41a9-8eff-3b5da3a92db2
                stepCounter: e165c76e-6a45-4567-817a-c8ecf377ecd2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 909eac39-6c33-471c-9eed-920e76a2a5c0
          stepCounter: 6db9032b-30b6-4aa9-9e62-5a123b1d1532
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LASTACTIVE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f0008085-55e7-41a9-8eff-3b5da3a92db2
                stepCounter: e165c76e-6a45-4567-817a-c8ecf377ecd2
            transform: |-
              CASE WHEN LASTACTIVITYDATE IS NULL                              THEN ''
                          WHEN LASTACTIVITYDATE =CURRENT_DATE                       THEN 'Today'
                          WHEN DATEDIFF('DAYS',LASTACTIVITYDATE,CURRENT_DATE)=1      THEN 'Yesterday'
                          WHEN DATEDIFF('DAYS',LASTACTIVITYDATE,CURRENT_DATE)< 0     THEN 'Unknown'
                          WHEN DATEDIFF('MONTHS',LASTACTIVITYDATE,CURRENT_DATE)= 0   THEN (CONCAT (TO_VARCHAR(DATEDIFF('DAYS',LASTACTIVITYDATE,CURRENT_DATE)),'d', ' ago'))
                          WHEN DATEDIFF('MONTHS',LASTACTIVITYDATE,CURRENT_DATE)>= 24 THEN (CONCAT(TO_VARCHAR(DATEDIFF('YEAR',LASTACTIVITYDATE,CURRENT_DATE)), 'y', ' ago'))
                          ELSE (CONCAT(TO_VARCHAR(DATEDIFF('MONTHS',LASTACTIVITYDATE,CURRENT_DATE)),'mo', ' ago'))
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 73f3fd63-cd1c-428c-8b26-cf827b474f19
          stepCounter: 6db9032b-30b6-4aa9-9e62-5a123b1d1532
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CREATEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e1258f2-c401-4c2b-8cf9-9da939938f21
                stepCounter: e165c76e-6a45-4567-817a-c8ecf377ecd2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1a51781-df2d-4ec9-956a-31c6f69055c8
          stepCounter: 6db9032b-30b6-4aa9-9e62-5a123b1d1532
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90de7990-63f5-4f9b-b96a-9b336ab0ec09
                stepCounter: e165c76e-6a45-4567-817a-c8ecf377ecd2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ea448c6-f936-4e8b-ad06-0d6267188fef
          stepCounter: 6db9032b-30b6-4aa9-9e62-5a123b1d1532
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PURCHASING_INFLUENCER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dfb852f9-dd39-49af-aa0d-fe06dd60a9fe
                stepCounter: e165c76e-6a45-4567-817a-c8ecf377ecd2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d52eae0-da98-44b0-ba92-7c866c80a7d3
          stepCounter: 6db9032b-30b6-4aa9-9e62-5a123b1d1532
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PURCHASING_DECISION_MAKER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1a3c2333-4b27-4840-9ed2-17d5b3945edd
                stepCounter: e165c76e-6a45-4567-817a-c8ecf377ecd2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98ee8ec2-a8df-41a1-8746-2a7e86580a16
          stepCounter: 6db9032b-30b6-4aa9-9e62-5a123b1d1532
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DEPARTMENT_AI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2563aeb3-14b1-4c9a-8537-53473da437a1
                stepCounter: e165c76e-6a45-4567-817a-c8ecf377ecd2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3746f1c-0185-4831-8a34-01a2859ab46a
          stepCounter: 6db9032b-30b6-4aa9-9e62-5a123b1d1532
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: AREAS_OF_INTEREST_AI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f09c5f7f-da08-4397-a2c5-9f3310979949
                stepCounter: e165c76e-6a45-4567-817a-c8ecf377ecd2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 89d02ca1-75fb-4487-8b6d-a4455e5ee1c5
          stepCounter: 6db9032b-30b6-4aa9-9e62-5a123b1d1532
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LAST_VALIDATED_AI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 679a331d-064c-469c-be11-376d6155f6f7
                stepCounter: e165c76e-6a45-4567-817a-c8ecf377ecd2
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          CONTACT: e165c76e-6a45-4567-817a-c8ecf377ecd2
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: CONTACT
        join:
          joinCondition: |-
            FROM {{ ref('DIM','CONTACT') }}
             WHERE NOT (Contact.Level1ForceId IS NULL OR Contact.Name = 'National IPA' OR Contact.FirstName like '%unknown%' OR Contact.FirstName like '%omnia%' OR Contact.LastName like '%unknown%' OR Contact.LastName like '%omnia%' OR Contact.DoNotEmailFlag = TRUE OR Contact.MarketingMailOptOut = TRUE OR Contact.IsEmailBounced = TRUE OR Contact.IsDeleted = TRUE)
               AND Contact.Status = 'Active'
        name: OPC_CONTACT
        noLinkRefs: []
  name: OPC_CONTACT
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
