fileVersion: 1
id: f3d3b8e2-c41d-436e-b46d-37b8a5e21f31
name: OPC_CONTACT
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: OMNIA_CONNECT_OPC
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 134008eb-42f4-4c6f-882a-d53bdc616905
          stepCounter: f3d3b8e2-c41d-436e-b46d-37b8a5e21f31
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: CONTACTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83cf9f2b-90d3-43c6-a6b1-c06956fa7f02
                stepCounter: 35f8d78b-6e7b-4fb6-a9b9-11bebbacf1ea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0018eddd-194e-4e63-a16d-b5db68a8317d
          stepCounter: f3d3b8e2-c41d-436e-b46d-37b8a5e21f31
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CONTACTSALESFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a1bca9c-fcac-43e4-afc3-4a7f6f1ff76b
                stepCounter: 35f8d78b-6e7b-4fb6-a9b9-11bebbacf1ea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86a8bbf6-0e7f-44fe-8f19-f050cbbfc3ee
          stepCounter: f3d3b8e2-c41d-436e-b46d-37b8a5e21f31
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE HIGHEST-LEVEL OF HIERARCHY FOR AN ACCOUNT
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c4577c8-36b8-49f1-8a25-2e8ce2febf3e
                stepCounter: 35f8d78b-6e7b-4fb6-a9b9-11bebbacf1ea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 504e8147-c63f-4963-b5c4-b12c755f9d5f
          stepCounter: f3d3b8e2-c41d-436e-b46d-37b8a5e21f31
        config: {}
        dataType: INT
        defaultValue: ""
        description: UNIQUE IDENTIFIER FOR AN ACCOUNT. COMMONLY CALLED THE "FORCE ID"
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c42be968-2f47-4770-993c-426ae69377c6
                stepCounter: 35f8d78b-6e7b-4fb6-a9b9-11bebbacf1ea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0eb72c0-1579-4d35-b9a9-0654a90c1f53
          stepCounter: f3d3b8e2-c41d-436e-b46d-37b8a5e21f31
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ACCOUNTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b79e4b7a-765b-421b-a5d9-930d2d829231
                stepCounter: 35f8d78b-6e7b-4fb6-a9b9-11bebbacf1ea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a45983f-e083-4bce-919f-265c9a9ba4de
          stepCounter: f3d3b8e2-c41d-436e-b46d-37b8a5e21f31
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: DEPARTMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9f683467-99eb-4337-ba28-3e3e4571e724
                stepCounter: 35f8d78b-6e7b-4fb6-a9b9-11bebbacf1ea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 51294cf0-49b8-4585-a0dc-d47518244dba
          stepCounter: f3d3b8e2-c41d-436e-b46d-37b8a5e21f31
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TITLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 41df8186-a570-44dd-beff-6858df1cbfca
                stepCounter: 35f8d78b-6e7b-4fb6-a9b9-11bebbacf1ea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86058450-dd77-4aa4-a022-b55c5ce49695
          stepCounter: f3d3b8e2-c41d-436e-b46d-37b8a5e21f31
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SALUTATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47a66388-5b48-497d-9bd1-d8a1aa9125a6
                stepCounter: 35f8d78b-6e7b-4fb6-a9b9-11bebbacf1ea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c34cffd-f9ba-4de7-9df1-e4daaa58cf8c
          stepCounter: f3d3b8e2-c41d-436e-b46d-37b8a5e21f31
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: FIRSTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf98ec72-b55a-4aa8-9b97-b78157a35d52
                stepCounter: 35f8d78b-6e7b-4fb6-a9b9-11bebbacf1ea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6ee235c-1eff-4b6a-8958-3af1b599154b
          stepCounter: f3d3b8e2-c41d-436e-b46d-37b8a5e21f31
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: LASTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 237a2e31-1337-4bb3-ad0f-0c8085efa332
                stepCounter: 35f8d78b-6e7b-4fb6-a9b9-11bebbacf1ea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b73d7ad4-2191-4afc-9aa6-366dfdcdf8c6
          stepCounter: f3d3b8e2-c41d-436e-b46d-37b8a5e21f31
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: EMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd3714cd-9e6c-4cb3-a559-f1f7edb62ca2
                stepCounter: 35f8d78b-6e7b-4fb6-a9b9-11bebbacf1ea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b4a02a6-9f61-45dc-8154-a82f7bd2ac26
          stepCounter: f3d3b8e2-c41d-436e-b46d-37b8a5e21f31
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PHONE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90d09a5b-76d3-4b9d-8d41-fa745b6a15fb
                stepCounter: 35f8d78b-6e7b-4fb6-a9b9-11bebbacf1ea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29aea54a-0c4b-4b63-a139-4b5f504e4678
          stepCounter: f3d3b8e2-c41d-436e-b46d-37b8a5e21f31
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: MAILINGSTREET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 82dfbcf4-fbd1-4151-887a-ad71dac4585a
                stepCounter: 35f8d78b-6e7b-4fb6-a9b9-11bebbacf1ea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: afa1595c-3588-4351-a80e-e09f20dcbd8e
          stepCounter: f3d3b8e2-c41d-436e-b46d-37b8a5e21f31
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: MAILINGCITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ca8298e4-4c1f-430c-acaf-34b393b4ece8
                stepCounter: 35f8d78b-6e7b-4fb6-a9b9-11bebbacf1ea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dfb6fcfb-b385-4118-987c-d879589e9d77
          stepCounter: f3d3b8e2-c41d-436e-b46d-37b8a5e21f31
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: MAILINGSTATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 651a016f-ffdc-450c-9f38-bd8a6b03c124
                stepCounter: 35f8d78b-6e7b-4fb6-a9b9-11bebbacf1ea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2b70f46-567f-4e90-99d6-0b62839fa88e
          stepCounter: f3d3b8e2-c41d-436e-b46d-37b8a5e21f31
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: MAILINGPOSTALCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 691686b7-072b-48d7-a926-f480fc9bfefe
                stepCounter: 35f8d78b-6e7b-4fb6-a9b9-11bebbacf1ea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca8c8133-b702-43f6-8b0e-ed3d7a0b8b24
          stepCounter: f3d3b8e2-c41d-436e-b46d-37b8a5e21f31
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: MAILINGCOUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c2e3a82-ddb6-4d36-b75f-349f8ae832a8
                stepCounter: 35f8d78b-6e7b-4fb6-a9b9-11bebbacf1ea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e2c0cc4-323b-4093-b463-6f5e755f8f3c
          stepCounter: f3d3b8e2-c41d-436e-b46d-37b8a5e21f31
        config: {}
        dataType: DATE
        defaultValue: ""
        description: CONTACT CREATED IN MONTH
        name: CREATED_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b542acc6-d3a4-4159-b475-8506cfef4d20
                stepCounter: 35f8d78b-6e7b-4fb6-a9b9-11bebbacf1ea
            transform: LAST_DAY(CONTACT.CREATEDDATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 778f189d-3493-4e1e-932e-770de1579ebc
          stepCounter: f3d3b8e2-c41d-436e-b46d-37b8a5e21f31
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: LASTACTIVITYDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9815b207-f5fe-4be6-8903-d3fde7c2e0ef
                stepCounter: 35f8d78b-6e7b-4fb6-a9b9-11bebbacf1ea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97bce277-589a-4e62-91e8-aee48229534d
          stepCounter: f3d3b8e2-c41d-436e-b46d-37b8a5e21f31
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: LASTACTIVE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9815b207-f5fe-4be6-8903-d3fde7c2e0ef
                stepCounter: 35f8d78b-6e7b-4fb6-a9b9-11bebbacf1ea
            transform: CASE \NWHEN LASTACTIVITYDATE IS NULL THEN '' \N \NWHEN LASTACTIVITYDATE =CURRENT_DATE THEN 'TODAY' \N \NWHEN DATEDIFF('DAYS',LASTACTIVITYDATE,CURRENT_DATE)=1 THEN 'YESTERDAY' \N \NWHEN DATEDIFF('DAYS',LASTACTIVITYDATE,CURRENT_DATE)< 0 THEN 'UNKNOWN' \N \NWHEN DATEDIFF('MONTHS',LASTACTIVITYDATE,CURRENT_DATE)= 0 THEN \N(\NCONCAT \N(\NTO_VARCHAR(DATEDIFF('DAYS',LASTACTIVITYDATE,CURRENT_DATE)) ,'D', \N' AGO' \N) \N) \N \NWHEN DATEDIFF('MONTHS',LASTACTIVITYDATE,CURRENT_DATE)>= 24 THEN \N(CONCAT(\NTO_VARCHAR(DATEDIFF('YEAR',LASTACTIVITYDATE,CURRENT_DATE)) , 'Y', \N' AGO')) \NELSE \N(CONCAT(\NTO_VARCHAR(DATEDIFF('MONTHS',LASTACTIVITYDATE,CURRENT_DATE)) ,'MO', \N' AGO')) \NEND
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 824e32b2-afdc-4a9c-81b0-aa7d2cf36a86
          stepCounter: f3d3b8e2-c41d-436e-b46d-37b8a5e21f31
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CREATEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b542acc6-d3a4-4159-b475-8506cfef4d20
                stepCounter: 35f8d78b-6e7b-4fb6-a9b9-11bebbacf1ea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 328a4f78-5683-477c-b4eb-bbc086077aeb
          stepCounter: f3d3b8e2-c41d-436e-b46d-37b8a5e21f31
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05b521d8-681a-4b30-92e9-ed38e8107748
                stepCounter: 35f8d78b-6e7b-4fb6-a9b9-11bebbacf1ea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ed68940-2009-4c8b-99ff-1519f376034c
          stepCounter: f3d3b8e2-c41d-436e-b46d-37b8a5e21f31
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        name: PURCHASING_INFLUENCER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d7530129-4207-4207-adf0-3796326ccfc4
                stepCounter: 35f8d78b-6e7b-4fb6-a9b9-11bebbacf1ea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d59cd3ff-d30d-43b8-9d09-98fe20a82215
          stepCounter: f3d3b8e2-c41d-436e-b46d-37b8a5e21f31
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        name: PURCHASING_DECISION_MAKER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8aed0d28-65b4-486e-a7f3-3ec24046ddb5
                stepCounter: 35f8d78b-6e7b-4fb6-a9b9-11bebbacf1ea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 774c0744-663a-4f3f-a149-120ca53e2783
          stepCounter: f3d3b8e2-c41d-436e-b46d-37b8a5e21f31
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: DEPARTMENT_AI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 42f5278c-af4b-446c-ab74-b3febaced0bf
                stepCounter: 35f8d78b-6e7b-4fb6-a9b9-11bebbacf1ea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4b67e09-9696-489c-88f0-48b4dad96034
          stepCounter: f3d3b8e2-c41d-436e-b46d-37b8a5e21f31
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: AREAS_OF_INTEREST_AI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7de38db3-3a55-461d-ba8d-0e201aab2735
                stepCounter: 35f8d78b-6e7b-4fb6-a9b9-11bebbacf1ea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe4d0371-24bc-4206-bf88-e399c31204c6
          stepCounter: f3d3b8e2-c41d-436e-b46d-37b8a5e21f31
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: LAST_VALIDATED_AI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f391f909-423c-4965-9390-ddc6a31db554
                stepCounter: 35f8d78b-6e7b-4fb6-a9b9-11bebbacf1ea
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          CONTACT: 35f8d78b-6e7b-4fb6-a9b9-11bebbacf1ea
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: CONTACT
        join:
          joinCondition: |-
            FROM {{ ref('DIM','CONTACT') }}
             WHERE NOT (CONTACT.LEVEL1FORCEID IS NULL OR CONTACT.NAME = 'NATIONAL IPA' OR CONTACT.FIRSTNAME LIKE '%UNKNOWN%' OR CONTACT.FIRSTNAME LIKE '%OMNIA%' OR CONTACT.LASTNAME LIKE '%UNKNOWN%' OR CONTACT.LASTNAME LIKE '%OMNIA%' OR CONTACT.DONOTEMAILFLAG = TRUE OR CONTACT.MARKETINGMAILOPTOUT = TRUE OR CONTACT.ISEMAILBOUNCED = TRUE OR CONTACT.ISDELETED = TRUE)
               AND CONTACT.STATUS = 'ACTIVE'
        name: OPC_CONTACT
        noLinkRefs: []
  name: OPC_CONTACT
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
