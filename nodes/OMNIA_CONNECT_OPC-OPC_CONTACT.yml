fileVersion: 1
id: 28721dac-e29a-40c5-b877-35a708551ae3
name: OPC_CONTACT
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: OMNIA_CONNECT_OPC
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dcc5d56c-4003-406b-8b0c-37bc936af9e9
          stepCounter: 28721dac-e29a-40c5-b877-35a708551ae3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: CONTACTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 976b3ce8-1550-4210-b1a5-ca1733e41661
                stepCounter: 48094b19-3332-40c8-a5ed-b656d7687e09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae219de3-83ff-49bc-b2bc-18a8014304e2
          stepCounter: 28721dac-e29a-40c5-b877-35a708551ae3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CONTACTSALESFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07fabe49-ee7f-49bf-aca3-c31f557cb1bb
                stepCounter: 48094b19-3332-40c8-a5ed-b656d7687e09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1aa4b8d5-47cb-46c1-8773-5543f72316c8
          stepCounter: 28721dac-e29a-40c5-b877-35a708551ae3
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE HIGHEST-LEVEL OF HIERARCHY FOR AN ACCOUNT
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 97c66c94-93e4-4b21-af67-0992ccdf46e1
                stepCounter: 48094b19-3332-40c8-a5ed-b656d7687e09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c53737b-411f-40eb-a181-2cd8238360df
          stepCounter: 28721dac-e29a-40c5-b877-35a708551ae3
        config: {}
        dataType: INT
        defaultValue: ""
        description: UNIQUE IDENTIFIER FOR AN ACCOUNT. COMMONLY CALLED THE "FORCE ID"
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 31f63067-57a3-41c3-8bea-5e9d0baf26c3
                stepCounter: 48094b19-3332-40c8-a5ed-b656d7687e09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: caa93aa1-9e4b-4ddb-801b-fa4ec9c3e961
          stepCounter: 28721dac-e29a-40c5-b877-35a708551ae3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ACCOUNTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 38fc7dd1-a4b3-4791-893e-3f6a29b1e906
                stepCounter: 48094b19-3332-40c8-a5ed-b656d7687e09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50c5765c-e744-43aa-ae50-11b6199e8f54
          stepCounter: 28721dac-e29a-40c5-b877-35a708551ae3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: DEPARTMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d993a675-ac37-4694-ae63-ce21385a70e5
                stepCounter: 48094b19-3332-40c8-a5ed-b656d7687e09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04b24dc1-7b86-4f86-b58c-25e75f0a6d63
          stepCounter: 28721dac-e29a-40c5-b877-35a708551ae3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TITLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48724d03-b87c-4ab8-b194-9144b8b844a5
                stepCounter: 48094b19-3332-40c8-a5ed-b656d7687e09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1f53ba1-dfce-42ad-a6a9-04d3b6c7c930
          stepCounter: 28721dac-e29a-40c5-b877-35a708551ae3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SALUTATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e69a82a-1100-4c49-aa88-66bede53ac98
                stepCounter: 48094b19-3332-40c8-a5ed-b656d7687e09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7612b39a-a3f8-4d4d-b94b-d8eb82b6a4dc
          stepCounter: 28721dac-e29a-40c5-b877-35a708551ae3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: FIRSTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f6027851-ce61-4ab1-9cbb-f593176c581c
                stepCounter: 48094b19-3332-40c8-a5ed-b656d7687e09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b0fb320-b0bf-4c41-ad56-075596c2cd6f
          stepCounter: 28721dac-e29a-40c5-b877-35a708551ae3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: LASTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00997b6e-2478-4d2d-bfc1-cf457c76a74d
                stepCounter: 48094b19-3332-40c8-a5ed-b656d7687e09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d87fe8b4-ce08-4c82-a9d8-0ad1b5301123
          stepCounter: 28721dac-e29a-40c5-b877-35a708551ae3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: EMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7fb064d4-5184-4a84-a8e0-cd18009a8cd5
                stepCounter: 48094b19-3332-40c8-a5ed-b656d7687e09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2fa8b74d-6be7-40d5-a430-56891361682e
          stepCounter: 28721dac-e29a-40c5-b877-35a708551ae3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PHONE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f509c701-d3f0-4f58-a46c-83671559e591
                stepCounter: 48094b19-3332-40c8-a5ed-b656d7687e09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b6cdf90-4059-49a1-a5b0-2605d9563d69
          stepCounter: 28721dac-e29a-40c5-b877-35a708551ae3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: MAILINGSTREET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ac63c437-a8a2-4959-a5fd-7235020f0d4a
                stepCounter: 48094b19-3332-40c8-a5ed-b656d7687e09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5d33e0d-02da-4e46-a937-f057d6e423a6
          stepCounter: 28721dac-e29a-40c5-b877-35a708551ae3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: MAILINGCITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d1989c05-4bd9-41cf-a66f-e0e71bedb918
                stepCounter: 48094b19-3332-40c8-a5ed-b656d7687e09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 253b0efc-a742-4a05-bc3c-1281e96dc2ef
          stepCounter: 28721dac-e29a-40c5-b877-35a708551ae3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: MAILINGSTATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 49dd7fc3-c762-4ae3-8148-9ab11a1b6d21
                stepCounter: 48094b19-3332-40c8-a5ed-b656d7687e09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dac5f6aa-48f4-4470-8f41-7938f5f746cf
          stepCounter: 28721dac-e29a-40c5-b877-35a708551ae3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: MAILINGPOSTALCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e9416885-d287-4755-9d50-ff1d40226a81
                stepCounter: 48094b19-3332-40c8-a5ed-b656d7687e09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 52c19bc5-0969-43b4-9cd7-2124c297b0fc
          stepCounter: 28721dac-e29a-40c5-b877-35a708551ae3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: MAILINGCOUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39dc4f21-fbfa-4088-bfca-9926550dceb0
                stepCounter: 48094b19-3332-40c8-a5ed-b656d7687e09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f8a2070-ac7b-444e-a410-212426aebd84
          stepCounter: 28721dac-e29a-40c5-b877-35a708551ae3
        config: {}
        dataType: DATE
        defaultValue: ""
        description: CONTACT CREATED IN MONTH
        name: CREATED_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a0d3f84d-843b-4c92-8541-c07dab559a13
                stepCounter: 48094b19-3332-40c8-a5ed-b656d7687e09
            transform: LAST_DAY(CONTACT.CREATEDDATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01e54494-22c5-4af5-8f31-eb3401ba70a5
          stepCounter: 28721dac-e29a-40c5-b877-35a708551ae3
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: LASTACTIVITYDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 840ea023-7abd-4d4c-ad38-d9eb47c3625d
                stepCounter: 48094b19-3332-40c8-a5ed-b656d7687e09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e070845f-3859-4fab-9135-6d9d4a60581e
          stepCounter: 28721dac-e29a-40c5-b877-35a708551ae3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: LASTACTIVE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 840ea023-7abd-4d4c-ad38-d9eb47c3625d
                stepCounter: 48094b19-3332-40c8-a5ed-b656d7687e09
            transform: CASE \NWHEN LASTACTIVITYDATE IS NULL THEN '' \N \NWHEN LASTACTIVITYDATE =CURRENT_DATE THEN 'TODAY' \N \NWHEN DATEDIFF('DAYS',LASTACTIVITYDATE,CURRENT_DATE)=1 THEN 'YESTERDAY' \N \NWHEN DATEDIFF('DAYS',LASTACTIVITYDATE,CURRENT_DATE)< 0 THEN 'UNKNOWN' \N \NWHEN DATEDIFF('MONTHS',LASTACTIVITYDATE,CURRENT_DATE)= 0 THEN \N(\NCONCAT \N(\NTO_VARCHAR(DATEDIFF('DAYS',LASTACTIVITYDATE,CURRENT_DATE)) ,'D', \N' AGO' \N) \N) \N \NWHEN DATEDIFF('MONTHS',LASTACTIVITYDATE,CURRENT_DATE)>= 24 THEN \N(CONCAT(\NTO_VARCHAR(DATEDIFF('YEAR',LASTACTIVITYDATE,CURRENT_DATE)) , 'Y', \N' AGO')) \NELSE \N(CONCAT(\NTO_VARCHAR(DATEDIFF('MONTHS',LASTACTIVITYDATE,CURRENT_DATE)) ,'MO', \N' AGO')) \NEND
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64c4d63a-b054-4a93-aacc-b7d3e0e00c5a
          stepCounter: 28721dac-e29a-40c5-b877-35a708551ae3
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CREATEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a0d3f84d-843b-4c92-8541-c07dab559a13
                stepCounter: 48094b19-3332-40c8-a5ed-b656d7687e09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 723240c8-8e94-4d80-ae66-584b4d3c94cd
          stepCounter: 28721dac-e29a-40c5-b877-35a708551ae3
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 99eec098-4bd9-479c-b8bd-5c83a0f61136
                stepCounter: 48094b19-3332-40c8-a5ed-b656d7687e09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4891241d-e5ad-48ca-a2c4-9fb49e57ee8e
          stepCounter: 28721dac-e29a-40c5-b877-35a708551ae3
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        name: PURCHASING_INFLUENCER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3fe0f7f8-c82b-463b-8b14-640348c38ff4
                stepCounter: 48094b19-3332-40c8-a5ed-b656d7687e09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79c59fa8-dfb4-4987-80c5-ad9a8109458f
          stepCounter: 28721dac-e29a-40c5-b877-35a708551ae3
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        name: PURCHASING_DECISION_MAKER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1108d735-e364-4408-9fa5-7a84d5b1b7d6
                stepCounter: 48094b19-3332-40c8-a5ed-b656d7687e09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c75fbd8-1d0d-4c1a-a9ff-90da0c2e59cb
          stepCounter: 28721dac-e29a-40c5-b877-35a708551ae3
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: DEPARTMENT_AI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f92f3c78-ce2c-46ee-ad4e-e1493b2e1f4c
                stepCounter: 48094b19-3332-40c8-a5ed-b656d7687e09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2ba3ca2-bcbf-4f32-b264-0798e9ca5e17
          stepCounter: 28721dac-e29a-40c5-b877-35a708551ae3
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: AREAS_OF_INTEREST_AI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 35945b52-07f6-44d8-8f82-55b272ed2708
                stepCounter: 48094b19-3332-40c8-a5ed-b656d7687e09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 498571bd-a66a-493c-8975-d2f8e74deb27
          stepCounter: 28721dac-e29a-40c5-b877-35a708551ae3
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: LAST_VALIDATED_AI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48cd3a27-e81e-4286-9f30-71424d556c2f
                stepCounter: 48094b19-3332-40c8-a5ed-b656d7687e09
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          CONTACT: 48094b19-3332-40c8-a5ed-b656d7687e09
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: CONTACT
        join:
          joinCondition: |-
            FROM {{ ref('DIM','CONTACT') }}
             WHERE NOT (CONTACT.LEVEL1FORCEID IS NULL OR CONTACT.NAME = 'NATIONAL IPA' OR CONTACT.FIRSTNAME LIKE '%UNKNOWN%' OR CONTACT.FIRSTNAME LIKE '%OMNIA%' OR CONTACT.LASTNAME LIKE '%UNKNOWN%' OR CONTACT.LASTNAME LIKE '%OMNIA%' OR CONTACT.DONOTEMAILFLAG = TRUE OR CONTACT.MARKETINGMAILOPTOUT = TRUE OR CONTACT.ISEMAILBOUNCED = TRUE OR CONTACT.ISDELETED = TRUE)
               AND CONTACT.STATUS = 'ACTIVE'
        name: OPC_CONTACT
        noLinkRefs: []
  name: OPC_CONTACT
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
