fileVersion: 1
id: 23d8ce4c-b671-4cd3-b4d8-9d58c6e0961c
name: OPC_CONTACT
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: OMNIA_CONNECT_OPC
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 973b4831-dd80-4df7-a5e5-cf70ab7cb29c
          stepCounter: 23d8ce4c-b671-4cd3-b4d8-9d58c6e0961c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: CONTACTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3f8b0170-7680-48a3-8b6d-02c5d2e7d012
                stepCounter: 69bed407-4a56-4539-a027-399a1d5dc1bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2e093ab-f090-42c4-9485-171a10a0041d
          stepCounter: 23d8ce4c-b671-4cd3-b4d8-9d58c6e0961c
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CONTACTSALESFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a9536ce-9a84-40fd-8772-d597725d5d6d
                stepCounter: 69bed407-4a56-4539-a027-399a1d5dc1bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6927a0b5-96fb-443a-922c-7c71973973ce
          stepCounter: 23d8ce4c-b671-4cd3-b4d8-9d58c6e0961c
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE HIGHEST-LEVEL OF HIERARCHY FOR AN ACCOUNT
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cc2a7be2-846f-4396-8940-afd691677164
                stepCounter: 69bed407-4a56-4539-a027-399a1d5dc1bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a791b6e-e5e3-448b-8095-4be7a6fa7207
          stepCounter: 23d8ce4c-b671-4cd3-b4d8-9d58c6e0961c
        config: {}
        dataType: INT
        defaultValue: ""
        description: UNIQUE IDENTIFIER FOR AN ACCOUNT. COMMONLY CALLED THE "FORCE ID"
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 82582111-ec07-4b8d-9351-3383ee0a602a
                stepCounter: 69bed407-4a56-4539-a027-399a1d5dc1bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 115ba5c2-9e97-4eda-9b5e-62cc696ad785
          stepCounter: 23d8ce4c-b671-4cd3-b4d8-9d58c6e0961c
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ACCOUNTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0dd9eef5-adb6-481a-8faa-a02f4564e15a
                stepCounter: 69bed407-4a56-4539-a027-399a1d5dc1bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98dee3f3-165c-4cd1-8f77-32301b2ece7e
          stepCounter: 23d8ce4c-b671-4cd3-b4d8-9d58c6e0961c
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: DEPARTMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 961fc98d-68e8-441b-a066-cf808d195d49
                stepCounter: 69bed407-4a56-4539-a027-399a1d5dc1bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8cf5b06-6b70-4826-b8f5-5dcbdb39cb42
          stepCounter: 23d8ce4c-b671-4cd3-b4d8-9d58c6e0961c
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TITLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8be92793-c706-497d-8200-9f020e8361f5
                stepCounter: 69bed407-4a56-4539-a027-399a1d5dc1bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 658b740a-1ce3-4881-a954-196c62523874
          stepCounter: 23d8ce4c-b671-4cd3-b4d8-9d58c6e0961c
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SALUTATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ca6a1e9-9869-4c92-8ed6-8416cfec2505
                stepCounter: 69bed407-4a56-4539-a027-399a1d5dc1bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 874dd69f-ee07-486b-9e55-55c4cd0e0626
          stepCounter: 23d8ce4c-b671-4cd3-b4d8-9d58c6e0961c
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: FIRSTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2782d4f9-750d-4401-9d8d-7ad947e1e92e
                stepCounter: 69bed407-4a56-4539-a027-399a1d5dc1bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d085107-0119-4970-ae37-df60568af7a2
          stepCounter: 23d8ce4c-b671-4cd3-b4d8-9d58c6e0961c
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: LASTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19448420-939f-49eb-8ace-ad9759a165f3
                stepCounter: 69bed407-4a56-4539-a027-399a1d5dc1bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 08d5b303-1757-4d7b-bcaf-5fd7834cfa74
          stepCounter: 23d8ce4c-b671-4cd3-b4d8-9d58c6e0961c
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: EMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6089659e-e00e-400e-8d19-352dd7237997
                stepCounter: 69bed407-4a56-4539-a027-399a1d5dc1bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aefd31de-2c4e-41c5-9b49-b881b2607c55
          stepCounter: 23d8ce4c-b671-4cd3-b4d8-9d58c6e0961c
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PHONE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7a50ab5-9f78-4d73-b0d1-33094d5f4b91
                stepCounter: 69bed407-4a56-4539-a027-399a1d5dc1bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af9128ab-f9ca-4e72-ab11-885620ecbd67
          stepCounter: 23d8ce4c-b671-4cd3-b4d8-9d58c6e0961c
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: MAILINGSTREET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e6c497bf-9982-426d-8c34-6815f94d21d8
                stepCounter: 69bed407-4a56-4539-a027-399a1d5dc1bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d179a71f-f7e0-402d-8068-ec1e03e56fa3
          stepCounter: 23d8ce4c-b671-4cd3-b4d8-9d58c6e0961c
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: MAILINGCITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e0b10139-b5e8-47d9-bde0-6d29ee613588
                stepCounter: 69bed407-4a56-4539-a027-399a1d5dc1bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a160b54-08d3-4957-833a-cbd4bce5d0cb
          stepCounter: 23d8ce4c-b671-4cd3-b4d8-9d58c6e0961c
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: MAILINGSTATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a73db234-9166-4d09-992f-94c199c3bb10
                stepCounter: 69bed407-4a56-4539-a027-399a1d5dc1bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5de2b91a-cb45-4593-8f61-ac85bd0a112c
          stepCounter: 23d8ce4c-b671-4cd3-b4d8-9d58c6e0961c
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: MAILINGPOSTALCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e957e94c-195e-4e78-a6d6-40bc8ade1426
                stepCounter: 69bed407-4a56-4539-a027-399a1d5dc1bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bef8a55a-565b-4c55-bca2-5247bb7a2255
          stepCounter: 23d8ce4c-b671-4cd3-b4d8-9d58c6e0961c
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: MAILINGCOUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 71c50083-1edb-48c6-9d4e-931c3e3050e8
                stepCounter: 69bed407-4a56-4539-a027-399a1d5dc1bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b20abbdf-6203-48f9-a596-6037aa46549a
          stepCounter: 23d8ce4c-b671-4cd3-b4d8-9d58c6e0961c
        config: {}
        dataType: DATE
        defaultValue: ""
        description: CONTACT CREATED IN MONTH
        name: CREATED_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6fb9aa8c-91cb-4ca6-83c7-800ced066a3a
                stepCounter: 69bed407-4a56-4539-a027-399a1d5dc1bb
            transform: LAST_DAY(CONTACT.CREATEDDATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 56cec2b9-fb29-4b65-a30a-5022dbc1eee9
          stepCounter: 23d8ce4c-b671-4cd3-b4d8-9d58c6e0961c
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: LASTACTIVITYDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dbef8da1-9bca-4bdc-b952-b8d7c7615e53
                stepCounter: 69bed407-4a56-4539-a027-399a1d5dc1bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86f3da56-0106-4b7f-ab4c-0ee9a86c1f31
          stepCounter: 23d8ce4c-b671-4cd3-b4d8-9d58c6e0961c
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: LASTACTIVE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dbef8da1-9bca-4bdc-b952-b8d7c7615e53
                stepCounter: 69bed407-4a56-4539-a027-399a1d5dc1bb
            transform: CASE \NWHEN LASTACTIVITYDATE IS NULL THEN '' \N \NWHEN LASTACTIVITYDATE =CURRENT_DATE THEN 'TODAY' \N \NWHEN DATEDIFF('DAYS',LASTACTIVITYDATE,CURRENT_DATE)=1 THEN 'YESTERDAY' \N \NWHEN DATEDIFF('DAYS',LASTACTIVITYDATE,CURRENT_DATE)< 0 THEN 'UNKNOWN' \N \NWHEN DATEDIFF('MONTHS',LASTACTIVITYDATE,CURRENT_DATE)= 0 THEN \N(\NCONCAT \N(\NTO_VARCHAR(DATEDIFF('DAYS',LASTACTIVITYDATE,CURRENT_DATE)) ,'D', \N' AGO' \N) \N) \N \NWHEN DATEDIFF('MONTHS',LASTACTIVITYDATE,CURRENT_DATE)>= 24 THEN \N(CONCAT(\NTO_VARCHAR(DATEDIFF('YEAR',LASTACTIVITYDATE,CURRENT_DATE)) , 'Y', \N' AGO')) \NELSE \N(CONCAT(\NTO_VARCHAR(DATEDIFF('MONTHS',LASTACTIVITYDATE,CURRENT_DATE)) ,'MO', \N' AGO')) \NEND
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 68067bcc-e436-4d80-b4a9-c0b4a1bc7034
          stepCounter: 23d8ce4c-b671-4cd3-b4d8-9d58c6e0961c
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CREATEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6fb9aa8c-91cb-4ca6-83c7-800ced066a3a
                stepCounter: 69bed407-4a56-4539-a027-399a1d5dc1bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 58089d9d-2b8d-4447-9704-f29c8ad8938c
          stepCounter: 23d8ce4c-b671-4cd3-b4d8-9d58c6e0961c
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 69af93f6-bcc4-407c-9232-73b9fcdefba4
                stepCounter: 69bed407-4a56-4539-a027-399a1d5dc1bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8eec266-1674-4bb4-a7d4-38b2b6f32bc9
          stepCounter: 23d8ce4c-b671-4cd3-b4d8-9d58c6e0961c
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        name: PURCHASING_INFLUENCER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e859f324-329a-42b6-8da7-ca600dd03a1d
                stepCounter: 69bed407-4a56-4539-a027-399a1d5dc1bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 23425a4b-4f5f-4708-8928-da11cec90849
          stepCounter: 23d8ce4c-b671-4cd3-b4d8-9d58c6e0961c
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        name: PURCHASING_DECISION_MAKER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3043d8dc-4389-45db-b8ec-2797bcb741f5
                stepCounter: 69bed407-4a56-4539-a027-399a1d5dc1bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 059fa95c-830a-421f-85f9-f7add41ffda9
          stepCounter: 23d8ce4c-b671-4cd3-b4d8-9d58c6e0961c
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: DEPARTMENT_AI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c77d2bd-b5e3-42e1-892b-63918380c9aa
                stepCounter: 69bed407-4a56-4539-a027-399a1d5dc1bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39260c8c-be88-45bf-90f2-87d54b61df34
          stepCounter: 23d8ce4c-b671-4cd3-b4d8-9d58c6e0961c
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: AREAS_OF_INTEREST_AI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d981dbe1-fb4a-4dd2-a831-261a17ed85c1
                stepCounter: 69bed407-4a56-4539-a027-399a1d5dc1bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6fd2d9c-2d2b-4051-ad68-68460a4d1631
          stepCounter: 23d8ce4c-b671-4cd3-b4d8-9d58c6e0961c
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: LAST_VALIDATED_AI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 30e706e8-c157-4882-af37-c7406d8b3d94
                stepCounter: 69bed407-4a56-4539-a027-399a1d5dc1bb
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          CONTACT: 69bed407-4a56-4539-a027-399a1d5dc1bb
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: CONTACT
        join:
          joinCondition: |-
            FROM {{ ref('DIM','CONTACT') }}
             WHERE NOT (CONTACT.LEVEL1FORCEID IS NULL OR CONTACT.NAME = 'NATIONAL IPA' OR CONTACT.FIRSTNAME LIKE '%UNKNOWN%' OR CONTACT.FIRSTNAME LIKE '%OMNIA%' OR CONTACT.LASTNAME LIKE '%UNKNOWN%' OR CONTACT.LASTNAME LIKE '%OMNIA%' OR CONTACT.DONOTEMAILFLAG = TRUE OR CONTACT.MARKETINGMAILOPTOUT = TRUE OR CONTACT.ISEMAILBOUNCED = TRUE OR CONTACT.ISDELETED = TRUE)
               AND CONTACT.STATUS = 'ACTIVE'
        name: OPC_CONTACT
        noLinkRefs: []
  name: OPC_CONTACT
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
