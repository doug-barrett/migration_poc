fileVersion: 1
id: 1db5ca58-6f1b-403c-b508-e87100b14abf
name: OPC_CONTACT
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: OMNIA_CONNECT_OPC
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21125b7b-6474-4816-b0c6-b646b2e13c1f
          stepCounter: 1db5ca58-6f1b-403c-b508-e87100b14abf
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CONTACTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c6c95a9-173a-41a1-8a25-a73143fcc576
                stepCounter: 5fa12080-8040-4cbf-96f4-8e9c84eee853
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f02ce28-f5bd-4300-8c4a-57677941e008
          stepCounter: 1db5ca58-6f1b-403c-b508-e87100b14abf
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CONTACTSALESFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a8c3e98-e162-40d1-a998-58014b01e24e
                stepCounter: 5fa12080-8040-4cbf-96f4-8e9c84eee853
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3aced3ed-f18f-4d5a-8af3-92fd19f4f24b
          stepCounter: 1db5ca58-6f1b-403c-b508-e87100b14abf
        config: {}
        dataType: INT
        defaultValue: ""
        description: is the highest-level of hierarchy for an account
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3096de5d-e6d9-4031-bbd1-3c871b09c3ae
                stepCounter: 5fa12080-8040-4cbf-96f4-8e9c84eee853
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15a59472-0c23-43e7-8127-9c1a99fc16dc
          stepCounter: 1db5ca58-6f1b-403c-b508-e87100b14abf
        config: {}
        dataType: INT
        defaultValue: ""
        description: Unique identifier for an account. Commonly called the "Force Id"
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 08544ea8-40e1-424e-b45c-62cc5f49d036
                stepCounter: 5fa12080-8040-4cbf-96f4-8e9c84eee853
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 46031451-0ce0-47cb-b73f-427572e9f30a
          stepCounter: 1db5ca58-6f1b-403c-b508-e87100b14abf
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ACCOUNTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3fd64cf4-a3de-4df4-83b9-11ff5f912629
                stepCounter: 5fa12080-8040-4cbf-96f4-8e9c84eee853
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5ce3567-efc1-4be3-a5f8-8c9d8a5af00e
          stepCounter: 1db5ca58-6f1b-403c-b508-e87100b14abf
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DEPARTMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a380c79d-fa4e-4d50-a037-1cb79c7b7ff2
                stepCounter: 5fa12080-8040-4cbf-96f4-8e9c84eee853
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5269b28-d49b-4e38-a64d-7dacf81435ed
          stepCounter: 1db5ca58-6f1b-403c-b508-e87100b14abf
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TITLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f84eed0-ae89-44c0-af30-e2fb5ef8d6c7
                stepCounter: 5fa12080-8040-4cbf-96f4-8e9c84eee853
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 776f72ed-e7b0-4505-a51e-9cb41f7853d0
          stepCounter: 1db5ca58-6f1b-403c-b508-e87100b14abf
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SALUTATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e68d9634-1e15-4a03-8cea-64fafcb5b8a7
                stepCounter: 5fa12080-8040-4cbf-96f4-8e9c84eee853
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0fc63501-22e2-4e85-825d-cbf33887f056
          stepCounter: 1db5ca58-6f1b-403c-b508-e87100b14abf
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: FIRSTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 97b61b4b-1b5f-4604-be05-eb4512087137
                stepCounter: 5fa12080-8040-4cbf-96f4-8e9c84eee853
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3751d0e6-3308-42db-acb7-7397af6ef19e
          stepCounter: 1db5ca58-6f1b-403c-b508-e87100b14abf
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LASTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3fdfb706-dafc-4abe-9744-04619a4942be
                stepCounter: 5fa12080-8040-4cbf-96f4-8e9c84eee853
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe6878fa-da4a-4f2f-bb87-2a2a71f5d5a3
          stepCounter: 1db5ca58-6f1b-403c-b508-e87100b14abf
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: EMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d688d6c-0813-4f08-8829-60eede76e5c7
                stepCounter: 5fa12080-8040-4cbf-96f4-8e9c84eee853
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8dbe081-5174-4b5b-859d-8ba65e129ff8
          stepCounter: 1db5ca58-6f1b-403c-b508-e87100b14abf
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PHONE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: be92cca3-1cb1-463a-9015-94a25d749b0b
                stepCounter: 5fa12080-8040-4cbf-96f4-8e9c84eee853
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27587c7a-50e7-488f-99af-b58505b67129
          stepCounter: 1db5ca58-6f1b-403c-b508-e87100b14abf
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: MAILINGSTREET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cdb0f9f7-7a1d-4b51-912e-050fd7544769
                stepCounter: 5fa12080-8040-4cbf-96f4-8e9c84eee853
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d3640a7-592f-4bbe-98aa-d35a16897e03
          stepCounter: 1db5ca58-6f1b-403c-b508-e87100b14abf
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: MAILINGCITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18d7d71a-3777-4663-af69-6ac91136c1f9
                stepCounter: 5fa12080-8040-4cbf-96f4-8e9c84eee853
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2fd9a748-c966-4712-948b-7ba5f92a74ce
          stepCounter: 1db5ca58-6f1b-403c-b508-e87100b14abf
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: MAILINGSTATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5b671585-2485-4b0e-9ab0-134c463d9077
                stepCounter: 5fa12080-8040-4cbf-96f4-8e9c84eee853
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4c2b977-5fe3-4df7-a2eb-10df1136887f
          stepCounter: 1db5ca58-6f1b-403c-b508-e87100b14abf
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: MAILINGPOSTALCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d578880e-d831-4f55-97eb-65c8fcc1d6aa
                stepCounter: 5fa12080-8040-4cbf-96f4-8e9c84eee853
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c04e350b-9248-493a-b41a-05539bb6ba5c
          stepCounter: 1db5ca58-6f1b-403c-b508-e87100b14abf
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: MAILINGCOUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: efa44851-060d-45f8-9ed2-5588772f5414
                stepCounter: 5fa12080-8040-4cbf-96f4-8e9c84eee853
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6d4b6aa-cf64-4904-90b3-b53ea5cf8ceb
          stepCounter: 1db5ca58-6f1b-403c-b508-e87100b14abf
        config: {}
        dataType: DATE
        defaultValue: ""
        description: Contact Created in Month
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CREATED_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 34ac7852-c5d8-4520-aba6-9e40858781e4
                stepCounter: 5fa12080-8040-4cbf-96f4-8e9c84eee853
            transform: LAST_DAY(Contact.CreatedDate)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad098db0-4022-47b1-8c3d-77cbd8c33ce2
          stepCounter: 1db5ca58-6f1b-403c-b508-e87100b14abf
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LASTACTIVITYDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d6e8b76-2530-4f28-b00e-1594c33d8de6
                stepCounter: 5fa12080-8040-4cbf-96f4-8e9c84eee853
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c542c618-f7f4-45a2-88f2-022e8c563b46
          stepCounter: 1db5ca58-6f1b-403c-b508-e87100b14abf
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LASTACTIVE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d6e8b76-2530-4f28-b00e-1594c33d8de6
                stepCounter: 5fa12080-8040-4cbf-96f4-8e9c84eee853
            transform: |-
              CASE WHEN LASTACTIVITYDATE IS NULL                              THEN ''
                          WHEN LASTACTIVITYDATE =CURRENT_DATE                       THEN 'Today'
                          WHEN DATEDIFF('DAYS',LASTACTIVITYDATE,CURRENT_DATE)=1      THEN 'Yesterday'
                          WHEN DATEDIFF('DAYS',LASTACTIVITYDATE,CURRENT_DATE)< 0     THEN 'Unknown'
                          WHEN DATEDIFF('MONTHS',LASTACTIVITYDATE,CURRENT_DATE)= 0   THEN (CONCAT (TO_VARCHAR(DATEDIFF('DAYS',LASTACTIVITYDATE,CURRENT_DATE)),'d', ' ago'))
                          WHEN DATEDIFF('MONTHS',LASTACTIVITYDATE,CURRENT_DATE)>= 24 THEN (CONCAT(TO_VARCHAR(DATEDIFF('YEAR',LASTACTIVITYDATE,CURRENT_DATE)), 'y', ' ago'))
                          ELSE (CONCAT(TO_VARCHAR(DATEDIFF('MONTHS',LASTACTIVITYDATE,CURRENT_DATE)),'mo', ' ago'))
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5d3c276-1a23-4f67-a345-f73af5ed797a
          stepCounter: 1db5ca58-6f1b-403c-b508-e87100b14abf
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CREATEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 34ac7852-c5d8-4520-aba6-9e40858781e4
                stepCounter: 5fa12080-8040-4cbf-96f4-8e9c84eee853
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e579568-cde0-4d0f-b186-47089c1e2241
          stepCounter: 1db5ca58-6f1b-403c-b508-e87100b14abf
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4504f551-9404-4bff-b832-2c4b7f7f6238
                stepCounter: 5fa12080-8040-4cbf-96f4-8e9c84eee853
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b07ede0-bb17-4810-918b-39d89a85c851
          stepCounter: 1db5ca58-6f1b-403c-b508-e87100b14abf
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PURCHASING_INFLUENCER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8d05c219-a83c-4ce8-9fc9-10cff1b8801b
                stepCounter: 5fa12080-8040-4cbf-96f4-8e9c84eee853
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c49df5a5-2e31-4478-adda-1864a2bb5a1a
          stepCounter: 1db5ca58-6f1b-403c-b508-e87100b14abf
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PURCHASING_DECISION_MAKER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 203ca0c4-d778-4f7f-b510-38adb6d58324
                stepCounter: 5fa12080-8040-4cbf-96f4-8e9c84eee853
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 335a1784-8c2c-4f0f-ba6f-fd4e16b392f4
          stepCounter: 1db5ca58-6f1b-403c-b508-e87100b14abf
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DEPARTMENT_AI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1711054e-9dfa-415a-a276-df96b55476e4
                stepCounter: 5fa12080-8040-4cbf-96f4-8e9c84eee853
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bfcc0a9e-d844-4bb0-b2b5-f2b741875239
          stepCounter: 1db5ca58-6f1b-403c-b508-e87100b14abf
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: AREAS_OF_INTEREST_AI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b1a7fe2-b848-4fdb-a58e-d17cbf69f7d0
                stepCounter: 5fa12080-8040-4cbf-96f4-8e9c84eee853
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b440201d-e951-43b6-84b3-7fe749fdb501
          stepCounter: 1db5ca58-6f1b-403c-b508-e87100b14abf
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LAST_VALIDATED_AI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48a87f99-e509-4242-b95e-71b9bfc378a6
                stepCounter: 5fa12080-8040-4cbf-96f4-8e9c84eee853
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          CONTACT: 5fa12080-8040-4cbf-96f4-8e9c84eee853
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: CONTACT
        join:
          joinCondition: |-
            FROM {{ ref('DIM','CONTACT') }}
             WHERE NOT (Contact.Level1ForceId IS NULL OR Contact.Name = 'National IPA' OR Contact.FirstName like '%unknown%' OR Contact.FirstName like '%omnia%' OR Contact.LastName like '%unknown%' OR Contact.LastName like '%omnia%' OR Contact.DoNotEmailFlag = TRUE OR Contact.MarketingMailOptOut = TRUE OR Contact.IsEmailBounced = TRUE OR Contact.IsDeleted = TRUE)
               AND Contact.Status = 'Active'
        name: OPC_CONTACT
        noLinkRefs: []
  name: OPC_CONTACT
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
