fileVersion: 1
id: 8e988627-6ca1-417a-b943-bc702d732ad4
name: VIEW_PVIEW_VRL_XSPOC_TESTS_VW
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8618734a-0c8c-4304-b8dc-05cd06b70ac8
          stepCounter: 8e988627-6ca1-417a-b943-bc702d732ad4
        config: {}
        dataType: VARCHAR(305)
        defaultValue: ""
        description: ""
        name: UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7014a46b-a09f-4d32-ae9a-66b516c1d8d6
                stepCounter: b2609f15-a93c-4c5d-b86e-0898ad7558d0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c022affb-0b2e-4c3d-8752-1c4ec4d2e053
          stepCounter: 8e988627-6ca1-417a-b943-bc702d732ad4
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: WELLNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50ee8568-df75-439d-b90f-a59a0ac2027c
                stepCounter: d554b1ad-15ef-40f5-8fff-8a730cc8b68e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 449ed935-70d7-4deb-b03c-1820b0e9074d
          stepCounter: 8e988627-6ca1-417a-b943-bc702d732ad4
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: TESTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f836d015-9378-425e-8356-2fad77845465
                stepCounter: 929b3978-fa1e-46f0-a399-b19f4cc78214
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 62fbaab5-5d6e-470c-a52a-56c957566f9a
          stepCounter: 8e988627-6ca1-417a-b943-bc702d732ad4
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: HRS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b488d42d-d4df-4e9a-a596-51cb3f74b49a
                stepCounter: 929b3978-fa1e-46f0-a399-b19f4cc78214
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dd5f7071-f5fd-4ca5-9dfa-9c5d6c334fa4
          stepCounter: 8e988627-6ca1-417a-b943-bc702d732ad4
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: OIL_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cde26852-da4b-4409-b964-d67547252bd0
                stepCounter: 929b3978-fa1e-46f0-a399-b19f4cc78214
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 944d6975-e359-4554-8ce0-51d944a5eefb
          stepCounter: 8e988627-6ca1-417a-b943-bc702d732ad4
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: WATER_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 263d4d12-6681-4030-8904-8114afa08fe8
                stepCounter: 929b3978-fa1e-46f0-a399-b19f4cc78214
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 99e7c21c-9807-40a6-8ba5-c84356fb481b
          stepCounter: 8e988627-6ca1-417a-b943-bc702d732ad4
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: GAS_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3cae0d90-ee7c-4e1d-af6b-89280fcbe098
                stepCounter: 929b3978-fa1e-46f0-a399-b19f4cc78214
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 65652d59-16c5-41e0-8ff4-7ec3e5f26c1b
          stepCounter: 8e988627-6ca1-417a-b943-bc702d732ad4
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: BU_SF_ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 748cdf05-5750-44bd-bb7a-77b0769f897d
                stepCounter: bd388a52-3d72-4c70-833d-7de7c6a8abd1
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_PVIEW_VRL_XSPOC_TESTS_VW: 8e988627-6ca1-417a-b943-bc702d732ad4
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_PVIEW_VRL_XSPOC_TESTS_VW') }} AS SELECT DECODE(IS_REAL(TO_VARIANT(substring(c.wellidregulatory,1,1))), TRUE, substring(c.wellidregulatory,1,3)||'/'||substring(c.wellidregulatory,4,2)||'-'||substring(c.wellidregulatory,6,2)||'-'||substring(c.wellidregulatory,8,3)||'-'||substring(c.wellidregulatory,11,4)||'/'||substring(c.wellidregulatory,15,2) ,c.wellidregulatory) AS uwi,
                   u.name AS wellname,
                   t.dttm AS testdate,
                   round(t.durtest*24,2) AS hrs,
                   round(t.ratehcliqcalc*6.29287,5) AS oil_rate,
                   round(t.ratewatercalc*6.29287,5) AS water_rate,
                   round((t.ratetotalgascalc/1000) *35.49373,5) AS gas_rate,
                   WS_EDW.PVIEW_SYSSECURITYTYP_VET_BU_ROLE(h.SYSSECURITYTYP) AS BU_SF_ROLE
              FROM DS_PRODVIEW.PVT_pvunit u
             INNER JOIN DS_PRODVIEW.PVT_pvunitcomp c
                ON c.idrecparent = u.idrec
             INNER JOIN DS_PRODVIEW.PVT_pvunitcomptest t
                ON t.idrecparent = c.idrec
             INNER JOIN DS_PRODVIEW.PVT_pvflownetheader h
                ON h.idflownet = u.idflownet
        dependencies:
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITCOMP
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITCOMP') }}
        name: VIEW_PVIEW_VRL_XSPOC_TESTS_VW
        noLinkRefs: []
  name: VIEW_PVIEW_VRL_XSPOC_TESTS_VW
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
