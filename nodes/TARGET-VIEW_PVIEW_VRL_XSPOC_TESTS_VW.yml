fileVersion: 1
id: c9b8d8a8-afac-4154-9dfe-59413c8235c4
name: VIEW_PVIEW_VRL_XSPOC_TESTS_VW
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1723ab23-5efe-4c65-b4a2-6999c253489b
          stepCounter: c9b8d8a8-afac-4154-9dfe-59413c8235c4
        config: {}
        dataType: VARCHAR(305)
        defaultValue: ""
        description: ""
        name: UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 295d169a-8764-40e9-9347-7e6746bb1d69
                stepCounter: 81e6b0b1-1728-45bf-932d-6356544cf13a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 89251d3b-19af-412e-914b-3bb2c48dd1cd
          stepCounter: c9b8d8a8-afac-4154-9dfe-59413c8235c4
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: WELLNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9e45b75-8378-4fd7-9c3e-10eaca2bddf8
                stepCounter: e5728334-2b6e-40fb-ae5e-e78da1de0994
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 266ea08b-fb8b-4ddf-86fd-fc890efcd78b
          stepCounter: c9b8d8a8-afac-4154-9dfe-59413c8235c4
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: TESTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4af52595-84cb-4015-9b7d-71cd8287ad95
                stepCounter: c90d88ea-3fe2-4276-a045-9d96c5346b01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9f0d9c1-b5f4-4796-bc2d-1c01664bf4db
          stepCounter: c9b8d8a8-afac-4154-9dfe-59413c8235c4
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: HRS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84b5a54d-0ac8-4ef8-bd09-b6c7b1181d67
                stepCounter: c90d88ea-3fe2-4276-a045-9d96c5346b01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4f02aad-ac96-42aa-8dfb-75d3e74c4ff7
          stepCounter: c9b8d8a8-afac-4154-9dfe-59413c8235c4
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: OIL_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: df972ffa-374c-4b51-a9ab-f05fe8e9a22d
                stepCounter: c90d88ea-3fe2-4276-a045-9d96c5346b01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5ea3a7c-32b1-4f88-b615-3d348573cebc
          stepCounter: c9b8d8a8-afac-4154-9dfe-59413c8235c4
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: WATER_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c0157618-ad60-44e0-8f3e-b49ad806bf04
                stepCounter: c90d88ea-3fe2-4276-a045-9d96c5346b01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b93318c-c2ab-43c3-84f7-87a800a8e2fd
          stepCounter: c9b8d8a8-afac-4154-9dfe-59413c8235c4
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: GAS_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 44753af8-03a4-4b1d-b4a9-9c2f40d494f0
                stepCounter: c90d88ea-3fe2-4276-a045-9d96c5346b01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80da2fc2-2764-41a4-961c-1de9bffb148a
          stepCounter: c9b8d8a8-afac-4154-9dfe-59413c8235c4
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: BU_SF_ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2461b3f-8900-4460-9da7-dc1b4d0593bc
                stepCounter: a23239e4-617a-4ab9-a42c-1fd9220b7fb3
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_PVIEW_VRL_XSPOC_TESTS_VW: c9b8d8a8-afac-4154-9dfe-59413c8235c4
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_PVIEW_VRL_XSPOC_TESTS_VW') }} AS SELECT DECODE(IS_REAL(TO_VARIANT(substring(c.wellidregulatory,1,1))), TRUE, substring(c.wellidregulatory,1,3)||'/'||substring(c.wellidregulatory,4,2)||'-'||substring(c.wellidregulatory,6,2)||'-'||substring(c.wellidregulatory,8,3)||'-'||substring(c.wellidregulatory,11,4)||'/'||substring(c.wellidregulatory,15,2) ,c.wellidregulatory) AS uwi,
                   u.name AS wellname,
                   t.dttm AS testdate,
                   round(t.durtest*24,2) AS hrs,
                   round(t.ratehcliqcalc*6.29287,5) AS oil_rate,
                   round(t.ratewatercalc*6.29287,5) AS water_rate,
                   round((t.ratetotalgascalc/1000) *35.49373,5) AS gas_rate,
                   WS_EDW.PVIEW_SYSSECURITYTYP_VET_BU_ROLE(h.SYSSECURITYTYP) AS BU_SF_ROLE
              FROM DS_PRODVIEW.PVT_pvunit u
             INNER JOIN DS_PRODVIEW.PVT_pvunitcomp c
                ON c.idrecparent = u.idrec
             INNER JOIN DS_PRODVIEW.PVT_pvunitcomptest t
                ON t.idrecparent = c.idrec
             INNER JOIN DS_PRODVIEW.PVT_pvflownetheader h
                ON h.idflownet = u.idflownet
        dependencies:
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITCOMP
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITCOMP') }}
        name: VIEW_PVIEW_VRL_XSPOC_TESTS_VW
        noLinkRefs: []
  name: VIEW_PVIEW_VRL_XSPOC_TESTS_VW
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
