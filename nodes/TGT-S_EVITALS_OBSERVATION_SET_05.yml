fileVersion: 1
id: bfd4242b-abac-4ad8-b7e2-7c4fdd6d1836
name: S_EVITALS_OBSERVATION_SET_05
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Remove any duplicated observation sets i.e. those that have been joined to multiple IP or ED stays."
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af5f6500-08b3-4522-9700-4dde1904085f
          stepCounter: bfd4242b-abac-4ad8-b7e2-7c4fdd6d1836
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6de54df8-ed23-4f2c-963e-6c6d111c3d74
                stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cbfa30fe-0883-4ddf-a0d3-a18f80d37219
          stepCounter: bfd4242b-abac-4ad8-b7e2-7c4fdd6d1836
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: 'Internal unique identifier for a patient from the Patient Management System '
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60451795-af65-443c-b576-e9f2f65cc24d
                stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57f0ba55-fcb9-490a-87dd-62128dbee199
          stepCounter: bfd4242b-abac-4ad8-b7e2-7c4fdd6d1836
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: Not the original inpatient encounter from PatienTrack as that loses some integrity. Applied based on some matching logic.
        name: MATCHED_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7cd41fec-ba62-4c4a-a367-1f576ab2373d
                stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3da02b4-4121-4c48-9121-15d1d7ec166f
          stepCounter: bfd4242b-abac-4ad8-b7e2-7c4fdd6d1836
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23eebd64-a492-45af-adfc-a14b18a60a74
                stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df2b4a59-e8ab-449d-8af5-98768ac6bc9b
          stepCounter: bfd4242b-abac-4ad8-b7e2-7c4fdd6d1836
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ADMISSION_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b553899-09a6-4a62-8f11-381338999d2c
                stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3037e527-dc92-4610-837b-13b13721b388
          stepCounter: bfd4242b-abac-4ad8-b7e2-7c4fdd6d1836
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: OBSERVATION_SET_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d138cc62-2d33-4fa6-9b26-139b0a7bce44
                stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8ea4a28-8a36-4597-b4af-e18bbb371e5f
          stepCounter: bfd4242b-abac-4ad8-b7e2-7c4fdd6d1836
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: OBSERVATION_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7c03362-e736-4b7f-94e9-a86823c14a9e
                stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d190c5de-299c-4a4a-8b94-380f0c60ae4f
          stepCounter: bfd4242b-abac-4ad8-b7e2-7c4fdd6d1836
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time when the observation measure was due.
        name: OBSERVATION_DUE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c613573-67d6-4d2e-bc58-95138567e0f1
                stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7bb12290-0646-4a10-9de9-e55060061e81
          stepCounter: bfd4242b-abac-4ad8-b7e2-7c4fdd6d1836
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: 'Date and time when the observation measure was taken. '
        name: OBSERVATION_TAKEN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9467d3be-1a62-4f48-a082-be17d587bf03
                stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 528db457-bc1a-488d-9084-900fdd391389
          stepCounter: bfd4242b-abac-4ad8-b7e2-7c4fdd6d1836
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: ""
        name: EWS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2735ed0b-bbc3-459c-bd8b-121a641a3454
                stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f3a7cddb-df5e-4c34-b958-814668947216
          stepCounter: bfd4242b-abac-4ad8-b7e2-7c4fdd6d1836
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: ""
        name: EWS_ALERT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 68fc62aa-5dd8-4f0d-9121-040f2bc66321
                stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02baacad-7cf9-447c-aa94-0ae1e0b32a2a
          stepCounter: bfd4242b-abac-4ad8-b7e2-7c4fdd6d1836
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Set to 1 if the regime for the observation set is set to anything other than NEWS.
        name: EWS_MODIFIED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3cefebdf-6800-4540-8c5b-caeb7216060e
                stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c52a2ff5-b659-4f59-a703-e87cacc15b42
          stepCounter: bfd4242b-abac-4ad8-b7e2-7c4fdd6d1836
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: REGIME_MOD_REASON_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8d7bef01-cd1a-4912-b687-590274f4e7be
                stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 409a0b22-52db-4253-b523-0ea9b9a4659c
          stepCounter: bfd4242b-abac-4ad8-b7e2-7c4fdd6d1836
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: WARD_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 81022571-4233-4aa5-a132-c17550a7180f
                stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 756c1e0c-020b-4fc1-9dab-6409ea13591f
          stepCounter: bfd4242b-abac-4ad8-b7e2-7c4fdd6d1836
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: WARD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 151a38f9-686e-47da-b328-77abda0932fd
                stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a5929c2-59df-4986-a1e3-6e9c5304726e
          stepCounter: bfd4242b-abac-4ad8-b7e2-7c4fdd6d1836
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SPECIALTY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0055e85a-5183-4eef-be35-54b1a5857588
                stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b88109c6-f8ea-4192-9fb3-798677a9d86e
          stepCounter: bfd4242b-abac-4ad8-b7e2-7c4fdd6d1836
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 611d6232-281a-40b7-9837-e84c2fa3a148
                stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a605f91-f21c-479f-8da1-f0f1be168616
          stepCounter: bfd4242b-abac-4ad8-b7e2-7c4fdd6d1836
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c748caef-b840-4617-b295-41a1bff6e689
                stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
            transform: COALESCE(ip_spont_refno, ed_spont_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5178963a-5bbe-4fd7-ae8b-c76d6d72f607
          stepCounter: bfd4242b-abac-4ad8-b7e2-7c4fdd6d1836
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1dbb8c21-4799-4a7b-93a3-86711919b7c0
                stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
            transform: COALESCE(ip_proca_refno, ed_proca_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aed15021-9415-45d2-90c0-a72ff3b5b316
          stepCounter: bfd4242b-abac-4ad8-b7e2-7c4fdd6d1836
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: IP_SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c748caef-b840-4617-b295-41a1bff6e689
                stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c806a95-d7d2-4d2f-bec1-16b58c541dca
          stepCounter: bfd4242b-abac-4ad8-b7e2-7c4fdd6d1836
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: IP_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1dbb8c21-4799-4a7b-93a3-86711919b7c0
                stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1fbf4783-1988-4740-9e25-8d5b8dfe7a68
          stepCounter: bfd4242b-abac-4ad8-b7e2-7c4fdd6d1836
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: PIMS service point ref no
        name: ED_SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cf0bac42-f8ca-42eb-b103-c8eb355cd810
                stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c036868-d6e5-4769-b2f6-5a65870f5117
          stepCounter: bfd4242b-abac-4ad8-b7e2-7c4fdd6d1836
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ED_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d5f217c6-e669-40c5-a159-04d551794e3d
                stepCounter: 6488d3da-36bc-4366-9fe7-fe1c85ba6d28
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d1926b64-787a-4491-a83a-6a84343f7255
          stepCounter: bfd4242b-abac-4ad8-b7e2-7c4fdd6d1836
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_EVITALS_OBSERVATION_SET_03
        join:
          joinCondition: |-
            FROM s_eVitals_observation_set_03
             WHERE stay_row_num = 1
        name: S_EVITALS_OBSERVATION_SET_05
        noLinkRefs: []
  name: S_EVITALS_OBSERVATION_SET_05
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
