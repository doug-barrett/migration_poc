fileVersion: 1
id: 2934c8f9-92ce-4073-b48f-39ce7c46812f
name: STAGEVIZIENTSALES_1
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "PART 1 ADDS MISSING CONTRACT COLUMNS FROM THE STAGING TABLE STAGE.VIZIENTCONTRACTS. THIS IS THE 1ST STAGING TABLE FOR VIZIENT SALES & REVENUE"
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf59e1cf-8ec3-40cf-a1d8-a2a45b807de0
          stepCounter: 2934c8f9-92ce-4073-b48f-39ce7c46812f
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 49457e27-fbfe-4f6c-b91c-de53ef184183
                stepCounter: 7b4f7e54-b332-4fb0-8cc1-a9398e017a89
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be14a090-8d83-466d-abbf-ba1a6ee61036
          stepCounter: 2934c8f9-92ce-4073-b48f-39ce7c46812f
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: TRANSACTIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cfbdeb6e-5ceb-42e6-a8db-73caeb5b86b1
                stepCounter: fe1c9188-cae3-48e9-9acb-b402a49e08fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ab0ecb5-4da7-4644-9427-30eb748e8d1b
          stepCounter: 2934c8f9-92ce-4073-b48f-39ce7c46812f
        config: {}
        dataType: INT
        defaultValue: ""
        description: UNIQUE IDENTIFIER FOR AN ACCOUNT. COMMONLY CALLED THE "FORCE ID"
        name: ACCOUNTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e9124360-2a69-4106-a3de-91865cbc5499
                stepCounter: 6aa2fc81-8ab0-4d41-a4e7-0a25bcb1176a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 85fbe837-1d40-4ed5-8692-00b8180806ce
          stepCounter: 2934c8f9-92ce-4073-b48f-39ce7c46812f
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: REGISTRATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1a8e6c38-a14c-4494-b350-726fb84b793b
                stepCounter: 7b4f7e54-b332-4fb0-8cc1-a9398e017a89
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba145dde-1ea7-47e5-a6d7-24c82a1f6751
          stepCounter: 2934c8f9-92ce-4073-b48f-39ce7c46812f
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: REPORTINGCUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7d61452-2ff4-4e59-beee-5792476c6ef8
                stepCounter: 7b4f7e54-b332-4fb0-8cc1-a9398e017a89
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0da1e96e-5424-44e2-8263-88eb309d07dc
          stepCounter: 2934c8f9-92ce-4073-b48f-39ce7c46812f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CONTRACTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1146b2b5-0101-4c38-a5d4-aa3bd7ed114d
                stepCounter: fe1c9188-cae3-48e9-9acb-b402a49e08fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eea55e08-1ca8-4c47-a311-134dfd9c2686
          stepCounter: 2934c8f9-92ce-4073-b48f-39ce7c46812f
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: RECEIPTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ee2d5fd-0ac6-4501-9eea-5e6899dd4c97
                stepCounter: fe1c9188-cae3-48e9-9acb-b402a49e08fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf5dc60f-56b8-4663-aa28-a99cbe5b89cd
          stepCounter: 2934c8f9-92ce-4073-b48f-39ce7c46812f
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: TRANSACTIONDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e8ca285-ba41-40da-962d-f955e287f6a6
                stepCounter: fe1c9188-cae3-48e9-9acb-b402a49e08fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f1ab574b-a7d4-4e76-a34d-e78b6322aafc
          stepCounter: 2934c8f9-92ce-4073-b48f-39ce7c46812f
        config: {}
        dataType: NUMERIC(19,4)
        defaultValue: ""
        description: ""
        name: SALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 30bb0de4-cf98-4552-a1c7-4f3327978d9d
                stepCounter: fe1c9188-cae3-48e9-9acb-b402a49e08fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5de9d7c8-b11e-4c44-a54d-98f590cea63b
          stepCounter: 2934c8f9-92ce-4073-b48f-39ce7c46812f
        config: {}
        dataType: NUMERIC(19,4)
        defaultValue: ""
        description: ""
        name: REVENUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: df0ee8cd-d03f-4324-aa61-5bbe70c4cd9e
                stepCounter: fe1c9188-cae3-48e9-9acb-b402a49e08fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d63f026-9b7a-44e8-8b69-6a94f14974dd
          stepCounter: 2934c8f9-92ce-4073-b48f-39ce7c46812f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: COMPANYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb1f78ad-58f8-46d0-a860-06bb8247b4c3
                stepCounter: fe1c9188-cae3-48e9-9acb-b402a49e08fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75ff7173-ad05-472f-9498-23e8fe8391ea
          stepCounter: 2934c8f9-92ce-4073-b48f-39ce7c46812f
        config: {}
        dataType: INT
        defaultValue: ""
        description: THE ORIGINAL CUSTOMER ID ASSOCIATED WITH A TRANSACTION.
        name: ORIGINALCUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 877de22c-1d6c-4630-8a86-f762e7669c2a
                stepCounter: fe1c9188-cae3-48e9-9acb-b402a49e08fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b7ef4d4-6aa2-488d-a3e5-2cc24801b387
          stepCounter: 2934c8f9-92ce-4073-b48f-39ce7c46812f
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LOFFICEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e987e67-6684-4fb1-a0e3-e894826810f9
                stepCounter: fe1c9188-cae3-48e9-9acb-b402a49e08fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ddef4212-a5d2-417d-b064-a5e227a60822
          stepCounter: 2934c8f9-92ce-4073-b48f-39ce7c46812f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: LOFFICENAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8a647fc2-3a76-40d3-b0a6-d7d94f8dfdfb
                stepCounter: fe1c9188-cae3-48e9-9acb-b402a49e08fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26d2cc48-c43d-45e8-b5ce-0fb382271bf8
          stepCounter: 2934c8f9-92ce-4073-b48f-39ce7c46812f
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SYSTEMID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 37c86ac3-d601-45cb-b352-8d6cf4d43ec4
                stepCounter: fe1c9188-cae3-48e9-9acb-b402a49e08fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6037e835-1ac5-483c-b928-b880e13fcd8d
          stepCounter: 2934c8f9-92ce-4073-b48f-39ce7c46812f
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        name: ____END_COMMON_COLUMNS____
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea27394d-12b5-4998-9b91-1f2f379086ae
          stepCounter: 2934c8f9-92ce-4073-b48f-39ce7c46812f
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39c8217f-763a-4e0a-b156-453182d7597c
                stepCounter: 7b4f7e54-b332-4fb0-8cc1-a9398e017a89
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1be021b1-459e-4455-baca-627dc0700bd1
          stepCounter: 2934c8f9-92ce-4073-b48f-39ce7c46812f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b5b78b78-9d44-4d58-8828-88813fd92019
                stepCounter: 3e7ce061-7f8c-45d4-9572-2f212aa40761
            transform: COALESCE(DSSFDCSUPPLIER.SUPPLIERID,LOADVIZIENTSALES.VENDOR_ID)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d201af6-c4f1-45f4-99ae-7634d9991799
          stepCounter: 2934c8f9-92ce-4073-b48f-39ce7c46812f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SUPPLIERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f896112d-a7b3-4521-b07a-cc2ef0824bb3
                stepCounter: 3e7ce061-7f8c-45d4-9572-2f212aa40761
            transform: COALESCE(DSSFDCSUPPLIER.SUPPLIERNAME,LOADVIZIENTSALES.VENDOR_NAME)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3746e8a9-a516-42fd-99cf-09104df39624
          stepCounter: 2934c8f9-92ce-4073-b48f-39ce7c46812f
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ISDIRECT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48951d58-697b-4983-9bfc-dcec48c260df
          stepCounter: 2934c8f9-92ce-4073-b48f-39ce7c46812f
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TERRITORYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dd4be554-0f0a-4da8-aff2-5ee341a66565
                stepCounter: 7b4f7e54-b332-4fb0-8cc1-a9398e017a89
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69ee8940-8005-440b-b388-e70f318f6429
          stepCounter: 2934c8f9-92ce-4073-b48f-39ce7c46812f
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TERRITORYIDFINANCIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 766cbea5-49cd-44df-bc9f-b634a6f64524
                stepCounter: 7b4f7e54-b332-4fb0-8cc1-a9398e017a89
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0eb09b63-84db-4492-8bac-69395148e2a7
          stepCounter: 2934c8f9-92ce-4073-b48f-39ce7c46812f
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TERRITORYIDDIRECT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3089c19a-c6e9-4608-9904-07324b9c2e74
                stepCounter: 7b4f7e54-b332-4fb0-8cc1-a9398e017a89
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 353429c9-62ff-4d49-b5c2-cbf75adc07fa
          stepCounter: 2934c8f9-92ce-4073-b48f-39ce7c46812f
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        name: ____END_APPENDED_BIZ_KEY_COLUMNS____
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27ce379b-8237-4e74-b414-18b16e4199f7
          stepCounter: 2934c8f9-92ce-4073-b48f-39ce7c46812f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: NON CONFORMED DIMENSION KEY
        isSurrogateKey: true
        name: DSS_SOURCE_SYSTEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: df883d72-00ff-41e1-aaa8-95a127005caa
                stepCounter: fe1c9188-cae3-48e9-9acb-b402a49e08fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21bf6860-45c0-40e3-bcd1-7ec4731c0601
          stepCounter: 2934c8f9-92ce-4073-b48f-39ce7c46812f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9b20eda5-90c6-4a83-8316-86bf0ec2b031
                stepCounter: fe1c9188-cae3-48e9-9acb-b402a49e08fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1aa8ffa6-f2df-41ac-ad99-07d2bd69a4ff
          stepCounter: 2934c8f9-92ce-4073-b48f-39ce7c46812f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9e76161f-1b7e-4f1e-95ee-f503ae1b706e
                stepCounter: fe1c9188-cae3-48e9-9acb-b402a49e08fd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f2e0ad0-0a8e-42ae-aa12-e9ab880318cb
          stepCounter: 2934c8f9-92ce-4073-b48f-39ce7c46812f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f599fede-ff58-4830-9d12-2913005dd654
          stepCounter: 2934c8f9-92ce-4073-b48f-39ce7c46812f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOADVIZIENTSALES: fe1c9188-cae3-48e9-9acb-b402a49e08fd
          DSSFDCSUPPLIER: 3e7ce061-7f8c-45d4-9572-2f212aa40761
          DSCUSTOMERSEXTERNALIDXREF: 6aa2fc81-8ab0-4d41-a4e7-0a25bcb1176a
          DSACCOUNT: 7b4f7e54-b332-4fb0-8cc1-a9398e017a89
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOADVIZIENTSALES
          - locationName: ODS
            nodeName: DSACCOUNT
          - locationName: ODS
            nodeName: DSCUSTOMERSEXTERNALIDXREF
          - locationName: ODS
            nodeName: DSSFDCSUPPLIER
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOADVIZIENTSALES') }} LOADVIZIENTSALES
              LEFT JOIN {{ ref('ODS','DSSFDCSUPPLIER') }} DSSFDCSUPPLIER
                ON LOADVIZIENTSALES.VENDOR_ID = DSSFDCSUPPLIER.VIZIENTSUPPLIERID
              LEFT JOIN {{ ref('ODS','DSCUSTOMERSEXTERNALIDXREF') }} DSCUSTOMERSEXTERNALIDXREF
                ON LOADVIZIENTSALES.MEMBER_ID = DSCUSTOMERSEXTERNALIDXREF.EXTERNALCUSTOMERID
              LEFT JOIN {{ ref('ODS','DSACCOUNT') }} DSACCOUNT
                ON DSCUSTOMERSEXTERNALIDXREF.CUSTOMERID = DSACCOUNT.FORCEID
             WHERE DSCUSTOMERSEXTERNALIDXREF.SOURCEENTITY = 3 --PROCESS FOR ONLY VIZIENT SOURCE ENTITY
        name: STAGEVIZIENTSALES_1
        noLinkRefs: []
  name: STAGEVIZIENTSALES_1
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
