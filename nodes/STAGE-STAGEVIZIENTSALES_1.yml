fileVersion: 1
id: 6076c690-b2f3-42c4-87c5-7859dec652cc
name: STAGEVIZIENTSALES_1
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "PART 1 ADDS MISSING CONTRACT COLUMNS FROM THE STAGING TABLE STAGE.VIZIENTCONTRACTS. THIS IS THE 1ST STAGING TABLE FOR VIZIENT SALES & REVENUE"
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0fa326af-bea3-4fb8-bfbe-73014d7cbdee
          stepCounter: 6076c690-b2f3-42c4-87c5-7859dec652cc
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a40246c-6b0e-46f2-ae0e-ca6cf509508d
                stepCounter: 9fc74c81-b3bd-4ccd-a3b7-f339a07a7bcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6441685e-76e0-4bd4-8762-b45fc42975d2
          stepCounter: 6076c690-b2f3-42c4-87c5-7859dec652cc
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: TRANSACTIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f24df7c-de9b-4005-b852-b89c0b208177
                stepCounter: b6a7445b-dde4-4f25-8364-dd42780f84a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9eb87a1-9f56-4d9c-8e09-c70946c738e0
          stepCounter: 6076c690-b2f3-42c4-87c5-7859dec652cc
        config: {}
        dataType: INT
        defaultValue: ""
        description: UNIQUE IDENTIFIER FOR AN ACCOUNT. COMMONLY CALLED THE "FORCE ID"
        name: ACCOUNTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 342d0acd-b7b2-4ea3-b54c-4f7a0438b903
                stepCounter: c469096a-ee50-4a55-962a-26ea2580760b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3bbee78-1de1-4928-95a3-0b6f4729fea9
          stepCounter: 6076c690-b2f3-42c4-87c5-7859dec652cc
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: REGISTRATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4435d74a-fce0-441a-abe4-4ccc7df099b0
                stepCounter: 9fc74c81-b3bd-4ccd-a3b7-f339a07a7bcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a25e229-9a57-4177-a3e9-ff6d4af7ab69
          stepCounter: 6076c690-b2f3-42c4-87c5-7859dec652cc
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: REPORTINGCUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c9d8f3a-cff3-44f5-a198-223c77ab8e8e
                stepCounter: 9fc74c81-b3bd-4ccd-a3b7-f339a07a7bcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86dd03fe-fade-4457-9ffd-9577250473b7
          stepCounter: 6076c690-b2f3-42c4-87c5-7859dec652cc
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CONTRACTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0e3eeceb-98a3-4675-a114-e9b98ab1d143
                stepCounter: b6a7445b-dde4-4f25-8364-dd42780f84a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fef5bed6-5407-4162-b77e-c914c1f21ebf
          stepCounter: 6076c690-b2f3-42c4-87c5-7859dec652cc
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: RECEIPTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 721b9ef6-6c09-4d43-9503-232f3598ecf7
                stepCounter: b6a7445b-dde4-4f25-8364-dd42780f84a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 160f31f4-1e4f-4f23-a064-d9698a790fef
          stepCounter: 6076c690-b2f3-42c4-87c5-7859dec652cc
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: TRANSACTIONDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddbb9969-e5d8-490e-b300-2b3b25c87f64
                stepCounter: b6a7445b-dde4-4f25-8364-dd42780f84a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 477ea5b7-7e75-4042-9baf-b2f3c686fb64
          stepCounter: 6076c690-b2f3-42c4-87c5-7859dec652cc
        config: {}
        dataType: NUMERIC(19,4)
        defaultValue: ""
        description: ""
        name: SALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d68337a2-7c29-4add-85af-d4d7c4acd25e
                stepCounter: b6a7445b-dde4-4f25-8364-dd42780f84a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb210f3d-afaa-4df8-b249-7d8c7328a133
          stepCounter: 6076c690-b2f3-42c4-87c5-7859dec652cc
        config: {}
        dataType: NUMERIC(19,4)
        defaultValue: ""
        description: ""
        name: REVENUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e54128d6-559b-4589-8633-ada855077144
                stepCounter: b6a7445b-dde4-4f25-8364-dd42780f84a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e2ead7b-c64e-49e8-99ed-5eb9e3d65c6f
          stepCounter: 6076c690-b2f3-42c4-87c5-7859dec652cc
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: COMPANYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9852976b-e721-4144-90f0-5b85146dedf1
                stepCounter: b6a7445b-dde4-4f25-8364-dd42780f84a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7739f5ce-160e-4a98-b7f5-3724be69c8cb
          stepCounter: 6076c690-b2f3-42c4-87c5-7859dec652cc
        config: {}
        dataType: INT
        defaultValue: ""
        description: THE ORIGINAL CUSTOMER ID ASSOCIATED WITH A TRANSACTION.
        name: ORIGINALCUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a7baef1-264e-4a93-b8dd-133ed5a34eaf
                stepCounter: b6a7445b-dde4-4f25-8364-dd42780f84a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e58b47e-1d87-4f43-89c3-915b03b77cd9
          stepCounter: 6076c690-b2f3-42c4-87c5-7859dec652cc
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LOFFICEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02a4968f-24f7-4b0d-a828-e50ad7b2c2de
                stepCounter: b6a7445b-dde4-4f25-8364-dd42780f84a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69c3f9de-c003-441d-aef0-6bea90e521a7
          stepCounter: 6076c690-b2f3-42c4-87c5-7859dec652cc
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: LOFFICENAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 990bbb81-3417-4741-a7e1-3496c22ae7bc
                stepCounter: b6a7445b-dde4-4f25-8364-dd42780f84a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3a3c283-283b-41fc-9d53-7c0952d0d6c0
          stepCounter: 6076c690-b2f3-42c4-87c5-7859dec652cc
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SYSTEMID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c388600f-eb4e-4a89-80c7-f26e392d3ec6
                stepCounter: b6a7445b-dde4-4f25-8364-dd42780f84a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d082652-0db2-4aec-8ea7-4b7d024544f2
          stepCounter: 6076c690-b2f3-42c4-87c5-7859dec652cc
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        name: ____END_COMMON_COLUMNS____
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f90d710e-4ffa-42b5-98f6-5b069c3394ea
          stepCounter: 6076c690-b2f3-42c4-87c5-7859dec652cc
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 449345ce-fd04-4c42-bbf9-155aeba0948a
                stepCounter: 9fc74c81-b3bd-4ccd-a3b7-f339a07a7bcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38b1cc69-2dc4-4d0f-8033-7c1eef5f6e80
          stepCounter: 6076c690-b2f3-42c4-87c5-7859dec652cc
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b95b02cd-34e1-4708-857f-8ef69a3118c1
                stepCounter: aafdc852-0334-419c-8531-09ecf0fdb7d0
            transform: COALESCE(DSSFDCSUPPLIER.SUPPLIERID,LOADVIZIENTSALES.VENDOR_ID)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da71e0c1-5274-44c5-96de-7e5865181e7d
          stepCounter: 6076c690-b2f3-42c4-87c5-7859dec652cc
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SUPPLIERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3f1bfd6b-d377-4cb6-956e-5bc78b4275bb
                stepCounter: aafdc852-0334-419c-8531-09ecf0fdb7d0
            transform: COALESCE(DSSFDCSUPPLIER.SUPPLIERNAME,LOADVIZIENTSALES.VENDOR_NAME)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3fc7f291-441d-448a-a7d7-5ac799915ac3
          stepCounter: 6076c690-b2f3-42c4-87c5-7859dec652cc
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ISDIRECT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d1905f46-063b-4f42-88aa-2e6460c6388d
          stepCounter: 6076c690-b2f3-42c4-87c5-7859dec652cc
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TERRITORYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4cb30105-d86f-4ba3-9bf6-85ffd696517e
                stepCounter: 9fc74c81-b3bd-4ccd-a3b7-f339a07a7bcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3986dee4-ad55-461f-a853-3de09d74134f
          stepCounter: 6076c690-b2f3-42c4-87c5-7859dec652cc
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TERRITORYIDFINANCIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 029b4211-5efb-4f15-8390-69ca8a08c307
                stepCounter: 9fc74c81-b3bd-4ccd-a3b7-f339a07a7bcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6450846a-c87d-4f75-b4ce-e116d3226146
          stepCounter: 6076c690-b2f3-42c4-87c5-7859dec652cc
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TERRITORYIDDIRECT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 14e58fe4-8a95-46a3-b85d-0842e87ef7ed
                stepCounter: 9fc74c81-b3bd-4ccd-a3b7-f339a07a7bcc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 44850ada-c773-4a8f-9349-a3074d9155b2
          stepCounter: 6076c690-b2f3-42c4-87c5-7859dec652cc
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        name: ____END_APPENDED_BIZ_KEY_COLUMNS____
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a27afd1-2f58-4d0a-af14-98ef781c481c
          stepCounter: 6076c690-b2f3-42c4-87c5-7859dec652cc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: NON CONFORMED DIMENSION KEY
        isSurrogateKey: true
        name: DSS_SOURCE_SYSTEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f6b3a73-cf04-4517-bdda-bc443fd3ce1f
                stepCounter: b6a7445b-dde4-4f25-8364-dd42780f84a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cab00de7-ec65-4787-8611-ff7bf8da6005
          stepCounter: 6076c690-b2f3-42c4-87c5-7859dec652cc
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a602f074-55fa-491b-a3ae-13974ebd6d01
                stepCounter: b6a7445b-dde4-4f25-8364-dd42780f84a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34e9758b-9218-45b9-8387-5905795390ce
          stepCounter: 6076c690-b2f3-42c4-87c5-7859dec652cc
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 53283f9a-05ad-492b-af95-dc022d6e5a9d
                stepCounter: b6a7445b-dde4-4f25-8364-dd42780f84a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 549813a1-a708-4046-bb67-1169f24757bc
          stepCounter: 6076c690-b2f3-42c4-87c5-7859dec652cc
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50238583-540c-4830-ad4b-a6b142d985b4
          stepCounter: 6076c690-b2f3-42c4-87c5-7859dec652cc
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOADVIZIENTSALES: b6a7445b-dde4-4f25-8364-dd42780f84a3
          DSSFDCSUPPLIER: aafdc852-0334-419c-8531-09ecf0fdb7d0
          DSCUSTOMERSEXTERNALIDXREF: c469096a-ee50-4a55-962a-26ea2580760b
          DSACCOUNT: 9fc74c81-b3bd-4ccd-a3b7-f339a07a7bcc
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOADVIZIENTSALES
          - locationName: ODS
            nodeName: DSACCOUNT
          - locationName: ODS
            nodeName: DSCUSTOMERSEXTERNALIDXREF
          - locationName: ODS
            nodeName: DSSFDCSUPPLIER
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOADVIZIENTSALES') }} LOADVIZIENTSALES
              LEFT JOIN {{ ref('ODS','DSSFDCSUPPLIER') }} DSSFDCSUPPLIER
                ON LOADVIZIENTSALES.VENDOR_ID = DSSFDCSUPPLIER.VIZIENTSUPPLIERID
              LEFT JOIN {{ ref('ODS','DSCUSTOMERSEXTERNALIDXREF') }} DSCUSTOMERSEXTERNALIDXREF
                ON LOADVIZIENTSALES.MEMBER_ID = DSCUSTOMERSEXTERNALIDXREF.EXTERNALCUSTOMERID
              LEFT JOIN {{ ref('ODS','DSACCOUNT') }} DSACCOUNT
                ON DSCUSTOMERSEXTERNALIDXREF.CUSTOMERID = DSACCOUNT.FORCEID
             WHERE DSCUSTOMERSEXTERNALIDXREF.SOURCEENTITY = 3 --PROCESS FOR ONLY VIZIENT SOURCE ENTITY
        name: STAGEVIZIENTSALES_1
        noLinkRefs: []
  name: STAGEVIZIENTSALES_1
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
