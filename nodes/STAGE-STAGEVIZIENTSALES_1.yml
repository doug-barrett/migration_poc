fileVersion: 1
id: ed0ade3d-3579-48d9-8f6e-fc7f36490c05
name: STAGEVIZIENTSALES_1
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "Part 1 adds missing contract columns from the staging table Stage.VizientContracts. This is the 1st staging table for Vizient sales & revenue"
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b347a88-102c-490c-98fd-669a6e4659e4
          stepCounter: ed0ade3d-3579-48d9-8f6e-fc7f36490c05
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 73cdaf7f-0bce-40f2-9a05-f903db2a33d2
                stepCounter: a469a6bb-bb97-426f-8702-f8f76f3abfb3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c13f9b4c-4b96-4f38-bccd-02f2b97726af
          stepCounter: ed0ade3d-3579-48d9-8f6e-fc7f36490c05
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: TRANSACTIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f10442c-81ed-4818-8d52-c11a6d324e24
                stepCounter: a372dc5f-8256-4a9e-96a0-f35156f4a595
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b89dfe4-268a-46b8-bb2d-80405b964890
          stepCounter: ed0ade3d-3579-48d9-8f6e-fc7f36490c05
        config: {}
        dataType: INT
        defaultValue: ""
        description: Unique identifier for an account. Commonly called the "Force Id"
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ACCOUNTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c3c4d02e-da0a-40a4-b2fd-8ba3617ac049
                stepCounter: 1144b488-2822-40d3-a44f-c94bb7fdf159
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 797a1167-da0a-4e84-af43-af24b226fcb8
          stepCounter: ed0ade3d-3579-48d9-8f6e-fc7f36490c05
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: REGISTRATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4d844fd8-b2a9-4897-9791-96051497ec77
                stepCounter: a469a6bb-bb97-426f-8702-f8f76f3abfb3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db6f5804-b388-4e38-ab89-17ed9ac4f1ef
          stepCounter: ed0ade3d-3579-48d9-8f6e-fc7f36490c05
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: REPORTINGCUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e59c892c-9aa1-481d-b865-433bac4f8bfc
                stepCounter: a469a6bb-bb97-426f-8702-f8f76f3abfb3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 027b323e-10e3-4bf3-9c8e-5d3d11d0c9e5
          stepCounter: ed0ade3d-3579-48d9-8f6e-fc7f36490c05
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CONTRACTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 87867b42-b3ec-47e5-82c7-65af059b5a55
                stepCounter: a372dc5f-8256-4a9e-96a0-f35156f4a595
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 199026e6-5f70-459e-b936-7dacddee85f3
          stepCounter: ed0ade3d-3579-48d9-8f6e-fc7f36490c05
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: RECEIPTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3ed7e5c2-d27d-43ab-888d-c1d4d71d39f1
                stepCounter: a372dc5f-8256-4a9e-96a0-f35156f4a595
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be1c8fab-ff29-41ff-9a70-1d8f9187a10a
          stepCounter: ed0ade3d-3579-48d9-8f6e-fc7f36490c05
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TRANSACTIONDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 859b1252-13d4-426a-9213-90fc3230f773
                stepCounter: a372dc5f-8256-4a9e-96a0-f35156f4a595
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5753078d-33a9-4af1-a828-ef3267c49e14
          stepCounter: ed0ade3d-3579-48d9-8f6e-fc7f36490c05
        config: {}
        dataType: NUMERIC(19,4)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7037f4b8-48d7-42eb-aa86-0337ee5f9953
                stepCounter: a372dc5f-8256-4a9e-96a0-f35156f4a595
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a4b9e35e-25db-4f80-8b6a-d3ff128eaf7d
          stepCounter: ed0ade3d-3579-48d9-8f6e-fc7f36490c05
        config: {}
        dataType: NUMERIC(19,4)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: REVENUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f4a06d1c-89ec-4b34-b013-65adccac848e
                stepCounter: a372dc5f-8256-4a9e-96a0-f35156f4a595
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c663ea06-d809-4ffb-8ec6-e5d60cb6913d
          stepCounter: ed0ade3d-3579-48d9-8f6e-fc7f36490c05
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: COMPANYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f2558edb-aa1e-47fd-a673-798318c1f4f0
                stepCounter: a372dc5f-8256-4a9e-96a0-f35156f4a595
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70a9e9fc-0efd-433d-a0e9-f60fdeb5bdb2
          stepCounter: ed0ade3d-3579-48d9-8f6e-fc7f36490c05
        config: {}
        dataType: INT
        defaultValue: ""
        description: The original customer id associated with a transaction.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ORIGINALCUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d0f7a8a8-57d3-409c-9c70-1618b259f778
                stepCounter: a372dc5f-8256-4a9e-96a0-f35156f4a595
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd66971f-04ab-4c2d-9af7-4208b2e577c1
          stepCounter: ed0ade3d-3579-48d9-8f6e-fc7f36490c05
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LOFFICEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7f7a012-5820-4c45-90fb-f62d89de8bd5
                stepCounter: a372dc5f-8256-4a9e-96a0-f35156f4a595
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a2e253e-d5b0-43ef-8a01-b37d48282cb6
          stepCounter: ed0ade3d-3579-48d9-8f6e-fc7f36490c05
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LOFFICENAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f7ddbd7-f921-4e85-a927-783ec3a22f2a
                stepCounter: a372dc5f-8256-4a9e-96a0-f35156f4a595
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80d6d30f-5c81-4767-b820-2694616449bd
          stepCounter: ed0ade3d-3579-48d9-8f6e-fc7f36490c05
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SYSTEMID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ba833517-d6f6-451a-ab6b-d2df5dba5223
                stepCounter: a372dc5f-8256-4a9e-96a0-f35156f4a595
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e6d89cf-7d59-4033-8197-c019bbac273e
          stepCounter: ed0ade3d-3579-48d9-8f6e-fc7f36490c05
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ____END_COMMON_COLUMNS____
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f99e49e5-8824-4f41-bfee-4817476cf14f
          stepCounter: ed0ade3d-3579-48d9-8f6e-fc7f36490c05
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6b9f7d5f-6b2c-4986-9349-d1fff4deab68
                stepCounter: a469a6bb-bb97-426f-8702-f8f76f3abfb3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d7f22b6-db61-400d-94ce-612299ec0de4
          stepCounter: ed0ade3d-3579-48d9-8f6e-fc7f36490c05
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab1f2735-200c-4cc3-9f65-7eb9807948d8
                stepCounter: 0c18e30d-f552-43a2-9f9a-8926dbc6ca57
            transform: COALESCE(DsSFDCSupplier.SupplierId,LoadVizientSales.VENDOR_ID)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a3e6bbe-9edc-4532-b950-4824814b1e4c
          stepCounter: ed0ade3d-3579-48d9-8f6e-fc7f36490c05
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SUPPLIERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 41b908d9-d317-4d4c-a052-b822e61c7c64
                stepCounter: 0c18e30d-f552-43a2-9f9a-8926dbc6ca57
            transform: COALESCE(DsSFDCSupplier.SupplierName,LoadVizientSales.VENDOR_NAME)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8d4db27-073f-4748-b84e-0b06f793d4c6
          stepCounter: ed0ade3d-3579-48d9-8f6e-fc7f36490c05
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ISDIRECT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e355e13-74a4-4e98-98ea-73b279fec909
          stepCounter: ed0ade3d-3579-48d9-8f6e-fc7f36490c05
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 66faf782-c7dd-43ed-9a38-72906390176a
                stepCounter: a469a6bb-bb97-426f-8702-f8f76f3abfb3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6f4577a-6870-4cb4-9f09-fb8c66dbb0d0
          stepCounter: ed0ade3d-3579-48d9-8f6e-fc7f36490c05
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYIDFINANCIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 82c53ada-08d1-460b-a2f6-c69ac52bc670
                stepCounter: a469a6bb-bb97-426f-8702-f8f76f3abfb3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5bfec006-5214-4e5f-9224-e82eacc1a97c
          stepCounter: ed0ade3d-3579-48d9-8f6e-fc7f36490c05
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYIDDIRECT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 617b08c5-0ced-4c90-a279-2f40ba32e0b1
                stepCounter: a469a6bb-bb97-426f-8702-f8f76f3abfb3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b456abb-0d0e-43a5-9a96-43713dff3723
          stepCounter: ed0ade3d-3579-48d9-8f6e-fc7f36490c05
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ____END_APPENDED_BIZ_KEY_COLUMNS____
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e4edf90f-94d0-4b66-a2bf-a720e506794f
          stepCounter: ed0ade3d-3579-48d9-8f6e-fc7f36490c05
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: non conformed dimension key
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isSurrogateKey: true
        name: DSS_SOURCE_SYSTEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 26ed091f-7d6a-4556-8927-407c48a5512a
                stepCounter: a372dc5f-8256-4a9e-96a0-f35156f4a595
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d1f33dc4-1a43-493b-ac28-245597bddf85
          stepCounter: ed0ade3d-3579-48d9-8f6e-fc7f36490c05
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Record source.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1740bac0-e6e7-4952-8e2a-dc6b90ce911b
                stepCounter: a372dc5f-8256-4a9e-96a0-f35156f4a595
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4485684-1a22-4786-8524-8e3d9ed2be3c
          stepCounter: ed0ade3d-3579-48d9-8f6e-fc7f36490c05
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Load date.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c6b3759-22f8-4d81-9515-d40797a7c012
                stepCounter: a372dc5f-8256-4a9e-96a0-f35156f4a595
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f144246-709e-4051-93b0-f307716c4d66
          stepCounter: ed0ade3d-3579-48d9-8f6e-fc7f36490c05
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4f58f7f-8bb5-4d5f-9244-3573241de190
          stepCounter: ed0ade3d-3579-48d9-8f6e-fc7f36490c05
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOADVIZIENTSALES: a372dc5f-8256-4a9e-96a0-f35156f4a595
          DSSFDCSUPPLIER: 0c18e30d-f552-43a2-9f9a-8926dbc6ca57
          DSCUSTOMERSEXTERNALIDXREF: 1144b488-2822-40d3-a44f-c94bb7fdf159
          DSACCOUNT: a469a6bb-bb97-426f-8702-f8f76f3abfb3
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOADVIZIENTSALES
          - locationName: ODS
            nodeName: DSACCOUNT
          - locationName: ODS
            nodeName: DSCUSTOMERSEXTERNALIDXREF
          - locationName: ODS
            nodeName: DSSFDCSUPPLIER
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOADVIZIENTSALES') }} LoadVizientSales
              LEFT JOIN {{ ref('ODS','DSSFDCSUPPLIER') }} DsSFDCSupplier
                ON LoadVizientSales.VENDOR_ID = DsSFDCSupplier.VizientSupplierId
              LEFT JOIN {{ ref('ODS','DSCUSTOMERSEXTERNALIDXREF') }} DsCustomersExternalIdXref
                ON LoadVizientSales.Member_ID = DsCustomersExternalIdXref.ExternalCustomerId
              LEFT JOIN {{ ref('ODS','DSACCOUNT') }} DsAccount
                ON DsCustomersExternalIdXref.CustomerId = DsAccount.ForceId
             WHERE DsCustomersExternalIdXref.SourceEntity = 3 --Process for only Vizient Source Entity
        name: STAGEVIZIENTSALES_1
        noLinkRefs: []
  name: STAGEVIZIENTSALES_1
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
