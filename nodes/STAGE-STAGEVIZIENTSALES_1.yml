fileVersion: 1
id: 1dee9eb5-1836-41ce-840a-005897d34a48
name: STAGEVIZIENTSALES_1
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "Part 1 adds missing contract columns from the staging table Stage.VizientContracts. This is the 1st staging table for Vizient sales & revenue"
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0049c7c9-6e81-4b27-9d8d-2ee7949e2e56
          stepCounter: 1dee9eb5-1836-41ce-840a-005897d34a48
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b0a0980b-9c7f-4f5f-9bf3-b9a7f6dc1aad
                stepCounter: 6f39653f-adac-49a6-a921-6213b9e0a6bf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4db40121-3d83-43e8-a2f0-e740766985bf
          stepCounter: 1dee9eb5-1836-41ce-840a-005897d34a48
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: TRANSACTIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ccfce006-2ae6-4ebd-96be-a71cf3a552d6
                stepCounter: 9890df29-7a5a-4ff7-8568-dd95246cef39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6d337d3-69e3-4969-866a-554b1645a2ad
          stepCounter: 1dee9eb5-1836-41ce-840a-005897d34a48
        config: {}
        dataType: INT
        defaultValue: ""
        description: Unique identifier for an account. Commonly called the "Force Id"
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ACCOUNTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e210d40c-c226-45e6-9372-4eb8ec5c7fd2
                stepCounter: 3ce28632-5a8f-4cd8-83eb-f7c7877c08e2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4ef18b7-998a-448e-8a39-a5b682c2b97f
          stepCounter: 1dee9eb5-1836-41ce-840a-005897d34a48
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: REGISTRATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7327a8a4-aa13-46b4-8229-51c5411c624a
                stepCounter: 6f39653f-adac-49a6-a921-6213b9e0a6bf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2cb42431-4825-4fed-bd56-89945be5632c
          stepCounter: 1dee9eb5-1836-41ce-840a-005897d34a48
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: REPORTINGCUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f9a6c5a7-e4ac-4fc4-a34d-68beb45fa07e
                stepCounter: 6f39653f-adac-49a6-a921-6213b9e0a6bf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a4abc097-12d9-4eaa-8edf-949178116fce
          stepCounter: 1dee9eb5-1836-41ce-840a-005897d34a48
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CONTRACTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83134ad9-d51c-4a27-bd01-b1610cd100e0
                stepCounter: 9890df29-7a5a-4ff7-8568-dd95246cef39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1323f2cb-8690-41db-9f0f-f7e348bc0e41
          stepCounter: 1dee9eb5-1836-41ce-840a-005897d34a48
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: RECEIPTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 133fde2a-692d-452b-b8be-731ce6cfd683
                stepCounter: 9890df29-7a5a-4ff7-8568-dd95246cef39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 887ba56e-bc2c-41e7-8ea8-41d3719e6ee4
          stepCounter: 1dee9eb5-1836-41ce-840a-005897d34a48
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TRANSACTIONDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd6aa743-5e64-4e00-92dd-24a52e395d78
                stepCounter: 9890df29-7a5a-4ff7-8568-dd95246cef39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e70b489-1392-4fad-bc03-ba79ec9625ec
          stepCounter: 1dee9eb5-1836-41ce-840a-005897d34a48
        config: {}
        dataType: NUMERIC(19,4)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bb876a0d-0121-4646-a406-c1d34a3a8b30
                stepCounter: 9890df29-7a5a-4ff7-8568-dd95246cef39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 756dc4e6-d9c4-46bf-a62b-498c0b8dc363
          stepCounter: 1dee9eb5-1836-41ce-840a-005897d34a48
        config: {}
        dataType: NUMERIC(19,4)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: REVENUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d299c070-5308-405d-8f16-95c1cdebe28d
                stepCounter: 9890df29-7a5a-4ff7-8568-dd95246cef39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03b9615b-7b55-4d8e-8d5b-f46a4872ab52
          stepCounter: 1dee9eb5-1836-41ce-840a-005897d34a48
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: COMPANYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f1a0d011-05d5-4d10-a991-1ba231d9c827
                stepCounter: 9890df29-7a5a-4ff7-8568-dd95246cef39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 697ca0aa-1db6-4848-a601-a424c40c55c7
          stepCounter: 1dee9eb5-1836-41ce-840a-005897d34a48
        config: {}
        dataType: INT
        defaultValue: ""
        description: The original customer id associated with a transaction.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ORIGINALCUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b54b4f5-04d4-4c1c-b7df-5486b97898a5
                stepCounter: 9890df29-7a5a-4ff7-8568-dd95246cef39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8f7365a-2375-475d-89d4-52f1705743e6
          stepCounter: 1dee9eb5-1836-41ce-840a-005897d34a48
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LOFFICEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: efa426af-25e3-4a37-86aa-cacd98c40b45
                stepCounter: 9890df29-7a5a-4ff7-8568-dd95246cef39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d7c4a55-2912-4708-b8b3-7b4dc5fb832f
          stepCounter: 1dee9eb5-1836-41ce-840a-005897d34a48
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LOFFICENAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 45c8f198-e4b9-4db8-a62d-856bcf0ad1a9
                stepCounter: 9890df29-7a5a-4ff7-8568-dd95246cef39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cee1ab04-07dd-4935-9b9e-f10c260cc4f7
          stepCounter: 1dee9eb5-1836-41ce-840a-005897d34a48
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SYSTEMID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 880f2512-aa2d-41a9-879f-9b694e3b2a40
                stepCounter: 9890df29-7a5a-4ff7-8568-dd95246cef39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80db7dce-38ad-417e-9895-2121749b93c3
          stepCounter: 1dee9eb5-1836-41ce-840a-005897d34a48
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ____END_COMMON_COLUMNS____
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54957acc-1d44-463f-bf1c-3775725ee145
          stepCounter: 1dee9eb5-1836-41ce-840a-005897d34a48
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 109e6ba9-9374-4c1b-852c-f882d0c64606
                stepCounter: 6f39653f-adac-49a6-a921-6213b9e0a6bf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57e264f9-bc7b-469b-b2ce-a26de21d5976
          stepCounter: 1dee9eb5-1836-41ce-840a-005897d34a48
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1fb0c95c-7606-4512-820e-1c6876cf6a53
                stepCounter: f8acd650-b20c-407f-b2bf-537a81240fbb
            transform: COALESCE(DsSFDCSupplier.SupplierId,LoadVizientSales.VENDOR_ID)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c8c65ad-0cd5-4028-a2bc-08048575147b
          stepCounter: 1dee9eb5-1836-41ce-840a-005897d34a48
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SUPPLIERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0185169a-28e1-4132-80b6-025dfe397b8c
                stepCounter: f8acd650-b20c-407f-b2bf-537a81240fbb
            transform: COALESCE(DsSFDCSupplier.SupplierName,LoadVizientSales.VENDOR_NAME)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ba7b987-7290-42d7-82c2-25a2fd813350
          stepCounter: 1dee9eb5-1836-41ce-840a-005897d34a48
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ISDIRECT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f40b9541-a4c0-4918-8836-ae4823138c35
          stepCounter: 1dee9eb5-1836-41ce-840a-005897d34a48
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3880a196-4dca-4394-9fc6-c142b5e4e852
                stepCounter: 6f39653f-adac-49a6-a921-6213b9e0a6bf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0947b30e-5751-430f-bffe-b4e77d4c0e5f
          stepCounter: 1dee9eb5-1836-41ce-840a-005897d34a48
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYIDFINANCIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 370a6463-291a-467f-9b90-387e0987cd43
                stepCounter: 6f39653f-adac-49a6-a921-6213b9e0a6bf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2596e4ce-964e-432d-b993-8436197e3c05
          stepCounter: 1dee9eb5-1836-41ce-840a-005897d34a48
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TERRITORYIDDIRECT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: debf08df-af72-48a5-82f8-925cd0b293b0
                stepCounter: 6f39653f-adac-49a6-a921-6213b9e0a6bf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: acb52f18-571e-4cd8-ba28-e9d34a840263
          stepCounter: 1dee9eb5-1836-41ce-840a-005897d34a48
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ____END_APPENDED_BIZ_KEY_COLUMNS____
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8edb0f4f-56f8-4eb8-a511-7da2f9b92234
          stepCounter: 1dee9eb5-1836-41ce-840a-005897d34a48
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: non conformed dimension key
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isSurrogateKey: true
        name: DSS_SOURCE_SYSTEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9e8058e9-9209-44ae-9f92-50bf30caa10c
                stepCounter: 9890df29-7a5a-4ff7-8568-dd95246cef39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7cc8a342-a004-419d-9379-aa422a4260ef
          stepCounter: 1dee9eb5-1836-41ce-840a-005897d34a48
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Record source.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c05b3b6-ee2b-4bcb-9b4c-d81a5fda5eab
                stepCounter: 9890df29-7a5a-4ff7-8568-dd95246cef39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 690670d7-3125-430b-8d03-a9bdc474aae4
          stepCounter: 1dee9eb5-1836-41ce-840a-005897d34a48
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Load date.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3917cc2f-d69d-41ac-9d63-6511c34fd375
                stepCounter: 9890df29-7a5a-4ff7-8568-dd95246cef39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4adc1ef4-6d09-4dc4-a51e-0dc9892677cd
          stepCounter: 1dee9eb5-1836-41ce-840a-005897d34a48
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d294ac19-d078-407f-9ecd-824130de4a0d
          stepCounter: 1dee9eb5-1836-41ce-840a-005897d34a48
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOADVIZIENTSALES: 9890df29-7a5a-4ff7-8568-dd95246cef39
          DSSFDCSUPPLIER: f8acd650-b20c-407f-b2bf-537a81240fbb
          DSCUSTOMERSEXTERNALIDXREF: 3ce28632-5a8f-4cd8-83eb-f7c7877c08e2
          DSACCOUNT: 6f39653f-adac-49a6-a921-6213b9e0a6bf
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOADVIZIENTSALES
          - locationName: ODS
            nodeName: DSACCOUNT
          - locationName: ODS
            nodeName: DSCUSTOMERSEXTERNALIDXREF
          - locationName: ODS
            nodeName: DSSFDCSUPPLIER
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOADVIZIENTSALES') }} LoadVizientSales
              LEFT JOIN {{ ref('ODS','DSSFDCSUPPLIER') }} DsSFDCSupplier
                ON LoadVizientSales.VENDOR_ID = DsSFDCSupplier.VizientSupplierId
              LEFT JOIN {{ ref('ODS','DSCUSTOMERSEXTERNALIDXREF') }} DsCustomersExternalIdXref
                ON LoadVizientSales.Member_ID = DsCustomersExternalIdXref.ExternalCustomerId
              LEFT JOIN {{ ref('ODS','DSACCOUNT') }} DsAccount
                ON DsCustomersExternalIdXref.CustomerId = DsAccount.ForceId
             WHERE DsCustomersExternalIdXref.SourceEntity = 3 --Process for only Vizient Source Entity
        name: STAGEVIZIENTSALES_1
        noLinkRefs: []
  name: STAGEVIZIENTSALES_1
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
