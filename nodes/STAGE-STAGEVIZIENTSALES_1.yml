fileVersion: 1
id: 1eb53d1f-9a77-4b77-ab95-ce75a047d3d3
name: STAGEVIZIENTSALES_1
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "PART 1 ADDS MISSING CONTRACT COLUMNS FROM THE STAGING TABLE STAGE.VIZIENTCONTRACTS. THIS IS THE 1ST STAGING TABLE FOR VIZIENT SALES & REVENUE"
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1323c741-d5f7-433c-a5b2-33db555cfefd
          stepCounter: 1eb53d1f-9a77-4b77-ab95-ce75a047d3d3
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ae2e091-efb6-4c4e-a237-f603387c8a57
                stepCounter: 481418c2-007e-4e8f-b442-6c9359132342
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee53955e-d36c-46de-a3ff-a0bf75895e24
          stepCounter: 1eb53d1f-9a77-4b77-ab95-ce75a047d3d3
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: TRANSACTIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e8f97a0-0499-4492-9372-4afc5d58b480
                stepCounter: ec945a18-eb03-46c3-a3c7-c13652388ed6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 176d4fc5-a73e-4a06-91e2-39a7ed09a6b6
          stepCounter: 1eb53d1f-9a77-4b77-ab95-ce75a047d3d3
        config: {}
        dataType: INT
        defaultValue: ""
        description: UNIQUE IDENTIFIER FOR AN ACCOUNT. COMMONLY CALLED THE "FORCE ID"
        name: ACCOUNTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e4bbbdc2-d7db-48d5-a8ae-a473c9271cd7
                stepCounter: 8840e232-c82c-4a75-95c6-1af3014ad535
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5f49876-bfea-4943-b183-96850e11c95f
          stepCounter: 1eb53d1f-9a77-4b77-ab95-ce75a047d3d3
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: REGISTRATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9ba590d8-e3a9-4b5a-9cc4-6c4df0415547
                stepCounter: 481418c2-007e-4e8f-b442-6c9359132342
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 56f20daf-7508-4941-b44b-16728154c225
          stepCounter: 1eb53d1f-9a77-4b77-ab95-ce75a047d3d3
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: REPORTINGCUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b8bfc4ea-0bd1-4b49-85f4-b329a38dd43e
                stepCounter: 481418c2-007e-4e8f-b442-6c9359132342
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ee9391e-803c-422b-bc1d-1048f974c5d1
          stepCounter: 1eb53d1f-9a77-4b77-ab95-ce75a047d3d3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CONTRACTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b5702bd9-0383-427f-b589-13af9a07fe8e
                stepCounter: ec945a18-eb03-46c3-a3c7-c13652388ed6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86c774ac-0e14-4744-919e-aab5120e34f1
          stepCounter: 1eb53d1f-9a77-4b77-ab95-ce75a047d3d3
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: RECEIPTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94f11cfb-3dfd-4ebf-961f-7c480445660d
                stepCounter: ec945a18-eb03-46c3-a3c7-c13652388ed6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c702a7d-4207-49de-b6af-04f5cc611985
          stepCounter: 1eb53d1f-9a77-4b77-ab95-ce75a047d3d3
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: TRANSACTIONDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 937176ed-bad7-4e67-b735-81ed143dd598
                stepCounter: ec945a18-eb03-46c3-a3c7-c13652388ed6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 63d56ad2-abaa-42b1-b877-e6e0f4a118fe
          stepCounter: 1eb53d1f-9a77-4b77-ab95-ce75a047d3d3
        config: {}
        dataType: NUMERIC(19,4)
        defaultValue: ""
        description: ""
        name: SALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0e601ea6-be01-4c08-99eb-daad15bcfad6
                stepCounter: ec945a18-eb03-46c3-a3c7-c13652388ed6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dcfbcd27-e7db-4915-9cb5-ed0c80d5b419
          stepCounter: 1eb53d1f-9a77-4b77-ab95-ce75a047d3d3
        config: {}
        dataType: NUMERIC(19,4)
        defaultValue: ""
        description: ""
        name: REVENUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7daf715-5b0c-418c-9726-1f3a185bfed3
                stepCounter: ec945a18-eb03-46c3-a3c7-c13652388ed6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e2c7deb-66b3-46a0-9496-9aa77b600d4d
          stepCounter: 1eb53d1f-9a77-4b77-ab95-ce75a047d3d3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: COMPANYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 82e05a80-886a-4c8e-bf7b-501c7697be4f
                stepCounter: ec945a18-eb03-46c3-a3c7-c13652388ed6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8642664d-db8b-4a23-8742-c1c24a29c88d
          stepCounter: 1eb53d1f-9a77-4b77-ab95-ce75a047d3d3
        config: {}
        dataType: INT
        defaultValue: ""
        description: THE ORIGINAL CUSTOMER ID ASSOCIATED WITH A TRANSACTION.
        name: ORIGINALCUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 55877bf3-bd56-4a7c-859f-ad89d8ec4397
                stepCounter: ec945a18-eb03-46c3-a3c7-c13652388ed6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d891d2d-23b5-4a7d-a04d-f276d78725d2
          stepCounter: 1eb53d1f-9a77-4b77-ab95-ce75a047d3d3
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LOFFICEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e09659a1-2b92-4cef-b792-62c3f9f55c39
                stepCounter: ec945a18-eb03-46c3-a3c7-c13652388ed6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7047526e-514e-47a8-9766-8a7624c9857d
          stepCounter: 1eb53d1f-9a77-4b77-ab95-ce75a047d3d3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: LOFFICENAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5af0ceae-1eaa-4ffb-bcac-c2e926396c95
                stepCounter: ec945a18-eb03-46c3-a3c7-c13652388ed6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29fa94b1-3ece-4900-a9c0-29d699619017
          stepCounter: 1eb53d1f-9a77-4b77-ab95-ce75a047d3d3
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SYSTEMID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 87c67952-3c5c-4ce6-acde-843f8e1bb99c
                stepCounter: ec945a18-eb03-46c3-a3c7-c13652388ed6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb814a39-75c7-4a8f-aa3f-09d544b5839b
          stepCounter: 1eb53d1f-9a77-4b77-ab95-ce75a047d3d3
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        name: ____END_COMMON_COLUMNS____
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8422036e-a9ed-478b-80bb-4588ecfe9efc
          stepCounter: 1eb53d1f-9a77-4b77-ab95-ce75a047d3d3
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b8a4e3a1-de3c-4895-bf8a-c155c4afcbd7
                stepCounter: 481418c2-007e-4e8f-b442-6c9359132342
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8afc62e0-40e1-457c-a9d0-cb4a76967188
          stepCounter: 1eb53d1f-9a77-4b77-ab95-ce75a047d3d3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 32f30b5f-f375-499e-948e-4b620253f023
                stepCounter: e8e98280-cc02-44fc-bddd-4668f722a450
            transform: COALESCE(DSSFDCSUPPLIER.SUPPLIERID,LOADVIZIENTSALES.VENDOR_ID)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59d8d4d5-7ccc-4478-b81e-7df177a4e586
          stepCounter: 1eb53d1f-9a77-4b77-ab95-ce75a047d3d3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SUPPLIERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 70494a49-5075-49ca-9fe4-2d83fc7a4eb3
                stepCounter: e8e98280-cc02-44fc-bddd-4668f722a450
            transform: COALESCE(DSSFDCSUPPLIER.SUPPLIERNAME,LOADVIZIENTSALES.VENDOR_NAME)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3411f76a-3861-4a19-b2bb-cfa74e39acff
          stepCounter: 1eb53d1f-9a77-4b77-ab95-ce75a047d3d3
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ISDIRECT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fbd7d362-fffc-4058-b2ee-3da9b0d231ce
          stepCounter: 1eb53d1f-9a77-4b77-ab95-ce75a047d3d3
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TERRITORYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: efd0dfc7-1581-47b2-ad6f-ef1f57440a48
                stepCounter: 481418c2-007e-4e8f-b442-6c9359132342
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e07999c8-2c9c-4193-b35c-8bf1fab317b1
          stepCounter: 1eb53d1f-9a77-4b77-ab95-ce75a047d3d3
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TERRITORYIDFINANCIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c380d1f5-3097-4ee2-8155-3083f8ddb01f
                stepCounter: 481418c2-007e-4e8f-b442-6c9359132342
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 247333ef-a147-4603-8381-55b9ff3ce648
          stepCounter: 1eb53d1f-9a77-4b77-ab95-ce75a047d3d3
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TERRITORYIDDIRECT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dbc4354e-9511-4b6e-9f0d-1cc2bff60aad
                stepCounter: 481418c2-007e-4e8f-b442-6c9359132342
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8015cff7-c999-433e-9837-2962f7b2d692
          stepCounter: 1eb53d1f-9a77-4b77-ab95-ce75a047d3d3
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        name: ____END_APPENDED_BIZ_KEY_COLUMNS____
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f3b32a8-47ce-4cd3-ac19-dd5bf2ead7ea
          stepCounter: 1eb53d1f-9a77-4b77-ab95-ce75a047d3d3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: NON CONFORMED DIMENSION KEY
        isSurrogateKey: true
        name: DSS_SOURCE_SYSTEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fbeb2ba6-2b88-45a4-afc6-7029ac5fb6cb
                stepCounter: ec945a18-eb03-46c3-a3c7-c13652388ed6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed05fac7-c2c8-4871-b66d-ca16ca11939a
          stepCounter: 1eb53d1f-9a77-4b77-ab95-ce75a047d3d3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c1abbf85-354c-45c7-8508-c222ea5cc6bc
                stepCounter: ec945a18-eb03-46c3-a3c7-c13652388ed6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 384f13c6-d352-4d16-ba99-427124b17f1a
          stepCounter: 1eb53d1f-9a77-4b77-ab95-ce75a047d3d3
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a0fe0363-902d-482a-8b8a-649460a2756e
                stepCounter: ec945a18-eb03-46c3-a3c7-c13652388ed6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 257f135a-5f0d-41ee-9e44-fbe730d320da
          stepCounter: 1eb53d1f-9a77-4b77-ab95-ce75a047d3d3
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0276962-778d-4f02-ba9d-e536ae51baff
          stepCounter: 1eb53d1f-9a77-4b77-ab95-ce75a047d3d3
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOADVIZIENTSALES: ec945a18-eb03-46c3-a3c7-c13652388ed6
          DSSFDCSUPPLIER: e8e98280-cc02-44fc-bddd-4668f722a450
          DSCUSTOMERSEXTERNALIDXREF: 8840e232-c82c-4a75-95c6-1af3014ad535
          DSACCOUNT: 481418c2-007e-4e8f-b442-6c9359132342
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOADVIZIENTSALES
          - locationName: ODS
            nodeName: DSACCOUNT
          - locationName: ODS
            nodeName: DSCUSTOMERSEXTERNALIDXREF
          - locationName: ODS
            nodeName: DSSFDCSUPPLIER
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOADVIZIENTSALES') }} LOADVIZIENTSALES
              LEFT JOIN {{ ref('ODS','DSSFDCSUPPLIER') }} DSSFDCSUPPLIER
                ON LOADVIZIENTSALES.VENDOR_ID = DSSFDCSUPPLIER.VIZIENTSUPPLIERID
              LEFT JOIN {{ ref('ODS','DSCUSTOMERSEXTERNALIDXREF') }} DSCUSTOMERSEXTERNALIDXREF
                ON LOADVIZIENTSALES.MEMBER_ID = DSCUSTOMERSEXTERNALIDXREF.EXTERNALCUSTOMERID
              LEFT JOIN {{ ref('ODS','DSACCOUNT') }} DSACCOUNT
                ON DSCUSTOMERSEXTERNALIDXREF.CUSTOMERID = DSACCOUNT.FORCEID
             WHERE DSCUSTOMERSEXTERNALIDXREF.SOURCEENTITY = 3 --PROCESS FOR ONLY VIZIENT SOURCE ENTITY
        name: STAGEVIZIENTSALES_1
        noLinkRefs: []
  name: STAGEVIZIENTSALES_1
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
