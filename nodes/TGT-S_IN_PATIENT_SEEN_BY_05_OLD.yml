fileVersion: 1
id: e0911b7e-e614-4d4a-b501-02a6c20542a3
name: S_IN_PATIENT_SEEN_BY_05_OLD
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "In-Patient Seen-By events"
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d0988be5-5caa-455e-9a96-3d21bd478906
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59d3088d-97f2-4c53-9ebc-ae021c7b49e2
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03740918-337c-445e-8b20-6305e1c23442
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PREVIOUS_SPEC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 970fe96c-6638-4194-abeb-4d1c9450301c
                stepCounter: 4182a75e-d07b-4637-97fa-4c01e2878360
            transform: lag(dim.dim_specialty.specialty_desc) OVER (PARTITION BY ds_pims_provider_spells.prvsp_refno ORDER BY ds_pims_prof_carer_episodes.prcae_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6bdc0d1c-9063-4306-accc-045cc3f2a1d1
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59d3088d-97f2-4c53-9ebc-ae021c7b49e2
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: "'H'+CONVERT(varchar,ds_pims_provider_spells.prvsp_refno)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f8651b2a-6978-4374-bafa-5a19aff01356
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'H'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce96cd7e-eb87-4d89-b93a-4b190f6c38cc
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72c532b7-79a7-49aa-8bc0-c737daef331d
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9e9c546-f065-49d5-8b9b-d92a70db0107
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11ba3682-5d1a-4a53-bfaf-b4b646e6c99f
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a61eb17-c75e-46e2-8efa-44f669a3157f
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: SPECIALTY_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 970fe96c-6638-4194-abeb-4d1c9450301c
                stepCounter: 4182a75e-d07b-4637-97fa-4c01e2878360
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d15fa58-d22a-462c-8fd8-ce73e4fefa56
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a06254d-d86c-4cf5-ab17-b37af0d69b0a
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1b5568a-d893-4c99-b1b1-a46f153daa5f
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DISDE_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3f097725-1edd-4539-b340-14de489b6fa2
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 10167634-0e18-424c-a630-01a2b6a0dbb3
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADCAT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4414ecc-4c91-49ec-a055-6affc8dbde9a
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e1bad87-ec87-41d5-bca3-0e44915facc4
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DISMT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a2db989-19c9-48be-ab15-47452de5e290
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de3e6aff-2f34-4f26-b18f-ecc10796f227
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_PATNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f7b850f-ce72-4e87-b4f3-6e2838f4dd0a
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 763168e8-0a03-4d5b-90c2-f132b47243ba
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SPELL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 393b69e1-de21-4623-b7d7-6f2de29ab3bd
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d65691f-a4f9-4e6b-b38a-ac7abc61d94f
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DISCH_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 86ed21a6-3045-4fea-965e-c903428d0444
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0749a5d1-55bc-4c64-a183-7f3d01e2c4a8
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1125cf7f-7027-45ac-acc8-b3a92505c4da
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: |-
              CASE WHEN ds_pims_provider_spells.admit_dttm IS NULL OR ds_pims_provider_spells.admit_dttm <= '1990-01-01' OR ds_pims_provider_spells.admit_dttm > GETDATE() OR ds_pims_provider_spells.admit_dttm > ds_pims_provider_spells.disch_dttm THEN ds_pims_provider_spells.disch_dttm
                          ELSE ds_pims_provider_spells.admit_dttm
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33d172d5-1f77-4b99-863b-7c71ea4ccb94
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMIT_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1125cf7f-7027-45ac-acc8-b3a92505c4da
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 65d983de-568d-4e9a-9572-3ea8cf638404
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCH_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee3a67e8-1a53-44ab-aa64-cafc588de09c
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: |-
              CASE WHEN ds_pims_provider_spells.disch_dttm IS NULL OR ds_pims_provider_spells.disch_dttm <= '1990-01-01' OR ds_pims_provider_spells.disch_dttm > GETDATE() OR ds_pims_provider_spells.disch_dttm < ds_pims_provider_spells.admit_dttm THEN ds_pims_provider_spells.admit_dttm
                          ELSE ds_pims_provider_spells.disch_dttm
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9689e1ec-2439-492b-92e8-87f2b1065a90
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCH_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee3a67e8-1a53-44ab-aa64-cafc588de09c
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c36a00e4-375b-4f73-a55e-1a65a7fa7d78
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PROVD_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d90bc76-0f51-4903-8d16-26dce7e20db9
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 13a648b8-a088-414b-90e9-e3189ced9dc9
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_REFERRAL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 80e5eecf-b3fb-4fc8-b661-b39389f47738
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 292484d2-2480-499d-9abe-4f48d079912e
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: AEATT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3d60c752-dcc2-482d-b5d3-e8c11f77a74f
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd200a7a-cfa9-4b37-8d2a-134198f5e3da
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRIOR_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e99f6379-a2f9-4541-ad7d-af5e85d509d9
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aded370a-def7-41a1-9fd8-678bdf1aecc0
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: IDENTIFIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e7ce674-a689-4f6e-b177-025b020aa1ad
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b1293f4-7673-474e-8f55-68f194546286
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CNTCT_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3dfd02a9-1ba2-4aa2-808e-04d07280dc1b
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5957fd9b-8bdc-47b9-a220-8931bc4e22e8
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MED_DISCH_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: adf2c303-3c4f-4246-a72c-d79692864825
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0790bfd2-7d08-43eb-83a1-59ed4a7a7aa5
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: CONSENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 300e2654-6b58-4cf5-879e-85f966675fb4
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0aa29e6a-1b44-4dd9-8e1d-0e69276f746a
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7fb57b5-409b-4f23-8347-fe2e72525181
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a095c023-0ede-406e-aee5-d7270192fe23
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WLIST_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f993f650-d845-4c5d-be64-636ff53122f0
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9eb1f97-d24d-40a3-b601-900c0afb46ba
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAY_REFNO_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16d423a4-16bd-4684-97f3-70f79fa12fa7
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c17634c-5ddc-4ed1-99a0-7e6e0a5e1d53
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24eeb20d-18d1-4bd8-8f55-2f75643a24d3
                stepCounter: 33fe902a-f28a-4da8-b9d5-2e4311242008
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95a33469-64e1-4c88-ba5d-d7a12ed7b191
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAY_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0e8e5a25-8c99-4435-a738-7db597df5a77
                stepCounter: 33fe902a-f28a-4da8-b9d5-2e4311242008
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5850b39-2c40-4059-8be6-86033899627b
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAY_SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a8068fd6-788f-4dde-953e-deec013a0316
                stepCounter: 33fe902a-f28a-4da8-b9d5-2e4311242008
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 51b07d13-b753-4ea3-ae07-8aadbcd8114a
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 95f730b4-8836-4243-82a9-11a2c4d5e0db
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: COALESCE(ds_pims_prof_carer_episodes.spont_refno,ds_pims_service_point_stays.spont_refno,ds_pims_provider_spells.spont_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c65ea5f3-3e33-4937-bb55-b21180574655
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_PROVD_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50e23f81-7a9f-4d70-83ad-bd3cc0768dee
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a70002d-b74d-4187-8ddf-dbe8ee61e25a
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5df95c6a-a9b3-4e52-9bf7-c316ce10aff4
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: IFNULL(ds_pims_prof_carer_episodes.spect_refno,ds_pims_provider_spells.spect_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5459478f-0467-43c4-812b-c579b2a3de4e
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_PURCH_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2733244a-25cd-466c-9d45-3f334086e8b6
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03b1209a-464f-4435-bea0-a75fc8db4a55
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SORRF_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c548a454-c868-4703-93b4-5e9da8a5d9d1
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d92f836-5526-4461-bf85-413c19c5487e
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EPISO_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 857a547e-f122-4836-a5a7-237331561a7f
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a977db2-ce25-4477-82dd-b663ea023dab
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_INMGT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8be9e4ed-efbe-4ac5-b2b9-e6443b734ffa
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9943932b-c3da-49ca-990f-8cc64377c267
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_ADCAT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0be86cd3-a6cf-44e9-8243-0dae101cdee3
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96defcc0-5da9-441c-ab95-78ff19073fdb
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EPTYP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd43b3f1-5287-493e-8728-41cf83b7582e
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d79d38d9-1480-4a84-8530-7ef382c7002c
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: MENCT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7fdba339-43c8-485a-a6cd-fc7fc00b5368
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f972e2e-a771-4df2-b23b-4101611f6a41
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_CONTR_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 41d0af3a-b91c-43b4-9ff8-07ab4c3099c2
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53638271-4a54-4509-842a-49b87aa6e187
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ATTND_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e9f18893-1090-43fc-a289-8e34deb2508a
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b76ef62f-8468-4758-bd5e-f91814d0c736
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_PATCL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 171c69d1-dfdd-4cb8-95ce-f2ca8d4dd2fb
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47074edc-0776-4e37-81ba-c52c7afac81a
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CEOCM_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 37c6568a-2041-4be3-acb2-4c317fab46eb
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0eae5a4a-f105-4fad-84c6-7f346fb7ad7d
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: INLOC_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b765a0df-5c49-4e86-b12a-c662c8da46f9
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5e5e25d-4c40-4561-b376-5a1bfb53b178
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PAGRP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b0c9ed79-2673-402d-bbac-4546ac7bb430
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7337c3b-5c27-4534-af8a-5ba70a77e07d
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_REFERRAL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c5dbb1a-c387-47be-aa77-4bee40dc904a
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: IFNULL(ds_pims_prof_carer_episodes.refrl_refno,ds_pims_provider_spells.refrl_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1cfe5d8c-17d9-4942-abbf-7ecc3c372d4e
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LEGSC_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d7b3a087-ebc4-40d6-a750-4aa1d650538f
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0bb7721-752e-4ba7-9d20-b4664c9134ba
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09efde33-abec-4420-a141-695ceb3a0225
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: COALESCE(ds_pims_prof_carer_episodes.proca_refno,ds_pims_service_point_stays.proca_refno,ds_pims_provider_spells.proca_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 668a1fb8-39f9-4c98-800e-c9c77cf30bc6
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_PATNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f29f62d-c302-4832-a62a-256fea3df895
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: IFNULL(ds_pims_prof_carer_episodes.patnt_refno,ds_pims_provider_spells.patnt_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca4fa7dd-9e3b-4113-a5a7-704574b78eae
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PAYMT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f7c471d-488d-4fec-ad7a-d04a6688be5c
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cbd78491-4463-4120-a86c-00f7fb6c306d
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: VISIT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3c2792e6-229f-401c-a1f1-1c83ffe0efd9
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e835b166-57a4-41ad-aaa2-5f70427cb043
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SEEN_BY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9b69ca26-6ec2-45d1-b0dc-8b4d97fd2184
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: |-
              CASE WHEN ds_pims_prof_carer_episodes.start_dttm IS NULL OR ds_pims_prof_carer_episodes.start_dttm <= '1990-01-01' OR ds_pims_prof_carer_episodes.start_dttm > GETDATE() OR ds_pims_prof_carer_episodes.start_dttm > ds_pims_prof_carer_episodes.end_dttm OR ds_pims_prof_carer_episodes.start_dttm < CASE WHEN ds_pims_provider_spells.admit_dttm IS NULL OR ds_pims_provider_spells.admit_dttm <= '1990-01-01' OR ds_pims_provider_spells.admit_dttm > GETDATE() THEN ds_pims_provider_spells.disch_dttm ELSE ds_pims_provider_spells.admit_dttm END THEN CASE WHEN ds_pims_provider_spells.admit_dttm IS NULL OR ds_pims_provider_spells.admit_dttm <= '1990-01-01' OR ds_pims_provider_spells.admit_dttm > GETDATE() THEN ds_pims_provider_spells.disch_dttm ELSE ds_pims_provider_spells.admit_dttm END
                          ELSE ds_pims_prof_carer_episodes.start_dttm
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ac7592f-b29f-4bd4-ba5f-bed07fbbf408
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SEEN_BY_START_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9b69ca26-6ec2-45d1-b0dc-8b4d97fd2184
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1673d54-3fe9-4d34-8a31-a5f8d59d9b1b
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: STAY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d98e645e-b2cf-4f8d-95d1-1d45aaa6fcce
                stepCounter: 33fe902a-f28a-4da8-b9d5-2e4311242008
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77fe7b9d-7242-4702-979e-9366aa3a4436
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SEEN_BY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 571e3286-f148-494c-9acc-fd1901a5dcd5
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: |-
              CASE WHEN ds_pims_prof_carer_episodes.end_dttm IS NULL OR ds_pims_prof_carer_episodes.end_dttm >= '1990-01-01' OR ds_pims_prof_carer_episodes.end_dttm > GETDATE() OR ds_pims_prof_carer_episodes.end_dttm < ds_pims_prof_carer_episodes.start_dttm OR ds_pims_prof_carer_episodes.end_dttm > CASE WHEN ds_pims_provider_spells.disch_dttm IS NULL OR ds_pims_provider_spells.disch_dttm <= '1990-01-01' OR ds_pims_provider_spells.disch_dttm > GETDATE() THEN ds_pims_provider_spells.admit_dttm ELSE ds_pims_provider_spells.disch_dttm END THEN CASE WHEN ds_pims_prof_carer_episodes.end_dttm IS NULL OR ds_pims_prof_carer_episodes.end_dttm <= '1990-01-01' OR ds_pims_prof_carer_episodes.end_dttm > GETDATE() THEN ds_pims_provider_spells.disch_dttm ELSE ds_pims_prof_carer_episodes.end_dttm END
                          ELSE ds_pims_prof_carer_episodes.end_dttm
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7aaf661-7554-4758-81cb-dde6a90e4228
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SEEN_BY_END_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 571e3286-f148-494c-9acc-fd1901a5dcd5
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d43d3f81-d2f2-403f-9fd3-d2ef8b067be1
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: STAY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b3b399b6-cd48-42b7-8d10-914fd8747ca8
                stepCounter: 33fe902a-f28a-4da8-b9d5-2e4311242008
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9859459-65d9-4b9b-aff7-d24284e93439
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DNARS_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f02f529-96b1-4611-a705-98e30c190e6e
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc20792e-2950-41b7-8fbf-55c9be252eb2
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_ADMET_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c811f91-5f46-485d-943e-60ab6cc737dd
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e46f9630-409e-470f-8add-8f09d2e50378
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_PRIOR_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2905698d-4365-4866-ae32-58d57032ba46
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2fc9d17-3983-4b94-a3f4-1d3426fa1737
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SPXRL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d72a677-d668-4f8f-816a-ed394c255be6
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5523dba0-8aa5-4574-ab9a-cc8074a42c74
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e7fca8c-f656-4f26-b20d-acf3708f6dd8
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 887b9a45-961b-415a-9be3-fad24267e63c
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SEEN_BY_CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50cb1693-a588-4a97-8ee6-d089e4723e45
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 46bec591-c2e0-4548-a45c-58ac8fa60391
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SEEN_BY_MODIF_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c19caa38-78b0-432a-90d0-59283bb0136f
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d38d70a-25a8-4fe7-9fca-8e355ecba16c
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SEEN_BY_USER_CREATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f3b7b05-c886-444a-90cc-2a902a67222e
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77a607bf-ac03-4e40-89b0-70aa58b0a93a
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SEEN_BY_USER_MODIF
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 363593b7-908b-4ec0-bca1-ded19c717458
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a025be15-0881-425f-8054-450848875f61
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: CODING_COMPLETE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6472ed1f-efd5-4571-b463-5a31dda28d94
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 111af7c6-c712-4100-aa62-89a023f29655
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: HRG_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e8e4ed53-0a94-4613-abfb-7473a885a64b
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5fa590e5-2261-4906-839e-bc4a8fd9b1f2
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CTRSV_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23134338-52c9-49bc-bd5d-f602d45e6746
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 68ff884a-0f70-4632-a3fa-d141f20e0385
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ALLCN_OVERRIDE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75226df5-d2f4-49c6-bf95-ad9161d26c82
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 37d72cdd-e1f5-4621-9900-acd98d990279
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: SUMMARY_COMPLETE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c2b33cb8-a958-4483-93fc-fe5794daf717
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02fae29a-1e43-42d2-8132-b7f353bde404
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: PRVSN_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc31a4a1-ca80-43d5-b3c5-750ef805a4b4
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a0dc8109-1121-4067-b4c5-76fee858929b
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: RECTR_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ccf606de-565f-4142-9b50-7ccb6bec99eb
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0e96083-c648-4aec-a96b-3dd94645c63a
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CSTAT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5785730d-7e35-4482-a6cc-0a66afe53994
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0919ce5b-ec9e-40dd-86a5-1e59dffd1e9c
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: COD_AUTH_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 373c3487-4692-47e7-bb66-406174432097
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b80b7428-b55d-4fcc-bde7-51b7b0fa586f
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: COD_AUTH_USER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ea9321a-8fa6-4542-9784-38cdcccdb6df
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14d5a488-65fa-450a-80a0-6ca21289a601
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: COD_AUTH_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11a695e5-bc93-4f46-bbe9-f36cc89532da
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78f19128-4e7e-44cb-bf94-fcdc6e60a4de
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: LATCH_AUTH_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 20ba3440-9db0-40cb-9b8a-5e120340af56
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6bf2c860-2fa7-42f8-b94f-6accb7b93865
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: INVOICE_TAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce6b12d6-3ce9-41d7-bac8-dc195b145dd5
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b3866aa-ee5f-461b-82e3-51043037c404
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SVCAT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: addca18e-9495-4343-8ec9-10b4e6081b92
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a21c228-7fb3-4b3a-a60a-c147f2787005
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PTCLS_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7bb1558c-3d77-44bb-9c36-1f53b31203e8
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f3074032-f463-4535-8271-44fd56564230
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: RESET_PTCLS_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 53f25096-e29a-4bce-8ef1-07c8b6967e89
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41d6798f-cedb-4f9f-b41c-ac33619700e6
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRIOR_PTCLS_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1247a0e-94df-49e1-9376-0039249f282f
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3048d992-95dc-423d-9c54-8aef3869680a
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PALST_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 623ed9cb-20c2-4dc6-a934-db48bc94a5d6
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2465ca98-1b49-4916-9d35-d1020f213d82
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DGPRO_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 96f1aab2-38cf-4178-91ad-69b8ae8d37e2
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 35a9f72e-9692-4fc5-941f-e524e6e2b439
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: DECIMAL(9,4)
        defaultValue: ""
        description: ""
        name: WIES_CMX_VALUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 29fc2d57-ff52-4400-83c6-f1936f3daef2
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d448827-ee9c-483c-8518-1129a911d002
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: PTCLS_MANUAL_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6eeb05cc-a690-4f18-97c0-cb60928351eb
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e85165ce-f8e5-4921-98b5-fa56395808c8
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: SORCE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ac453d64-f01c-4eb4-8fde-ce0c48acc60b
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e278d5f5-5f07-42eb-9931-06b11bfdb4cc
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SORCE_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22b0090c-80d2-4909-9a3c-584727deac64
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 12071bab-73dc-49d2-97e8-56bd5ffe0026
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PALCA_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea9662b2-5276-4a07-a20f-f79b374762a0
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca2fc789-b51d-4502-a8f4-cd68de3aa214
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_SEEN_BY_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59d3088d-97f2-4c53-9ebc-ae021c7b49e2
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ROW_NUMBER() OVER (PARTITION BY ds_pims_provider_spells.prvsp_refno ORDER BY ds_pims_prof_carer_episodes.prcae_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 786c1233-03a2-4920-8f75-3ccead8c28f7
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_SEEN_BY_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59d3088d-97f2-4c53-9ebc-ae021c7b49e2
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: COUNT(1) OVER (PARTITION BY ds_pims_provider_spells.prvsp_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57796b32-9ba6-4f87-b071-e924e835c54c
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: dss_data_quality_code
        name: DSS_DATA_QUALITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'NONE'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27acb359-f4c8-4427-a057-69b4fce45dde
          stepCounter: e0911b7e-e614-4d4a-b501-02a6c20542a3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_PIMS_PROVIDER_SPELLS
        join:
          joinCondition: |-
            FROM ds_pims_prof_carer_episodes
              JOIN ds_pims_provider_spells
                ON ds_pims_provider_spells.prvsp_refno = ds_pims_prof_carer_episodes.prvsp_refno
              LEFT OUTER JOIN (SELECT MAX(sstay_refno) sstay_refno,
                   MAX(spont_refno) spont_refno,
                   MAX(proca_refno) proca_refno,
                   MAX(start_dttm) start_dttm,
                   MAX(end_dttm) end_dttm,
                   prvsp_refno --, patnt_refno     FROM ds_pims_service_point_stays GROUP BY prvsp_refno) ds_pims_service_point_stays    ON  ds_pims_prof_carer_episodes.prvsp_refno = ds_pims_service_point_stays.prvsp_refno     --AND ds_pims_prof_carer_episodes.patnt_refno = ds_pims_provider_spells.patnt_refno     AND (CONVERT(date,ds_pims_prof_carer_episodes.start_dttm) BETWEEN CONVERT(date,ds_pims_service_point_stays.start_dttm-1) AND CONVERT(date,ds_pims_service_point_stays.end_dttm+1)     OR COALESCE(CONVERT(date,ds_pims_prof_carer_episodes.end_dttm),GETDATE()) BETWEEN CONVERT(date,ds_pims_service_point_stays.start_dttm-1) AND COALESCE(CONVERT(date,ds_pims_service_point_stays.end_dttm+1),GETDATE()))  LEFT OUTER JOIN dim.dim_specialty        ON IFNULL(ds_pims_prof_carer_episodes.spect_refno,ds_pims_provider_spells.spect_refno)  = dim_specialty.specialty_reference_no        AND dim_specialty.dss_current_flag = @v_dss_current_flag     where ds_pims_provider_spells.prvsn_start_flag = 'N'
        name: S_IN_PATIENT_SEEN_BY_05_OLD
        noLinkRefs: []
  name: S_IN_PATIENT_SEEN_BY_05_OLD
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
