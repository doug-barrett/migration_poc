fileVersion: 1
id: 4b1d171d-a11a-44de-a63a-c852dfdf7724
name: S_ED_STAY_50
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Dimension key lookups for fact_ed_stay"
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dbbeb4e9-78bc-4983-a012-a7df5851b198
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: attendance (Encounter) unique identifier
        name: ATTENDANCE_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cbfb9466-e50f-415e-8ca8-a785709a808a
                stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 259a9267-730e-4d57-9aeb-9d0741869637
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: first character of the attendance_encounter_type_code (A, H, etc...)
        name: ATTENDANCE_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb3e52f3-41e8-48dc-b999-1a78c859b944
                stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a800def5-d5ef-48ba-a375-d5e2ac161185
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_stay_50.attendance_encounter_type_code=dim_encounter_type.encounter_type_code
        name: DIM_ENCOUNTER_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3ba8df3-db2e-40a1-97dc-d5ad6a5186a7
                stepCounter: 1d0ea6a1-9563-4fb3-a1fa-9d43dbdf296e
            transform: IFNULL(dim_encounter_type.dim_encounter_type_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e9800f6-666d-4f0a-a63e-030f58c1a06d
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: attendance_reference_no
        name: ATTENDANCE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d237967a-c07f-4f90-9450-5bffee55b5ac
                stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0894a965-5265-42ea-9a1e-4324e02068a4
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Event number for the attendance/encounter in ascending order
        name: ATTENDANCE_STAY_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d29d4ce5-422e-40ae-b361-73a10402f28c
                stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f4b850ce-cbd9-4d68-b11a-e110d97cb600
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Number of stays in the attendance/encounter
        name: ATTENDANCE_STAY_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02e8ad7e-5c60-4e80-9a35-f599b1f8538c
                stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01a9c1a9-ed80-4d53-8330-16a9f7319b07
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time patient arrived
        name: ATTENDANCE_ARRIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dea1d911-8a0f-41ae-8230-e197e47c5d9a
                stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e5c39f8-e442-41e9-9cc3-31227fabf116
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MIN_SEEN_DATE_WB
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c17daf7a-9eba-4ba0-9d07-a4390b92e695
                stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a618023-ba47-4e6d-b295-054b4f894e89
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: INT
        defaultValue: ""
        description: min_attendance_stay_seq_num
        name: MIN_ATTENDANCE_STAY_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 334b688a-5b04-44c9-8ba1-5f695613e7fb
                stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f43ee42-b187-45d8-80e5-4429c29d1b62
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time patient departed
        name: ATTENDANCE_DEPARTED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6677be08-23ee-49b1-94c9-7dddbef87479
                stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 62a07c88-bb73-488a-8a4d-6bf74c1865ee
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: attendance_first_stay_flag
        name: ATTENDANCE_FIRST_STAY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN s_ed_stay_40.row_num = 1 -- CASE WHEN s_ed_stay_40.arrived_date = s_ed_stay_40.start_date
               THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7887713-adff-4da2-b61b-d9c1e2eca510
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: attendance_last_stay_flag
        name: ATTENDANCE_LAST_STAY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN s_ed_stay_40.row_num = s_ed_stay_40.row_count -- CASE WHEN IFNULL(s_ed_stay_40.departed_date, s_ed_stay_40.arrived_date) = IFNULL(s_ed_stay_40.end_date, s_ed_stay_40.seen_date)
               THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0ed880a-1b17-4bf8-b096-3a5602185065
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: PIMS ward stay ref no
        name: STAY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 712fcf63-ef24-490f-a3c7-64f7d39b9748
                stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7fa53686-cdc0-429c-a873-2e2f0d32d6a7
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Encounter start date and time
        name: STAY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a06a29e-7103-4941-9cfd-40aabdafaaa9
                stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c4192ca-e6ba-4ded-acf1-2d5761a887db
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Stay_Start_Financial_Month
        name: STAY_START_FINANCIAL_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8770437c-df0e-4bf6-9847-2eb89c0a0567
                stepCounter: f6a5fae2-5a40-4523-824d-c265ca1bc409
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50a2220e-e5e2-47bd-9a15-60d41f8a04ae
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_ED_STAY_START_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b442fea-c72d-4a06-ba4d-ed4b58ee5dbb
                stepCounter: f6a5fae2-5a40-4523-824d-c265ca1bc409
            transform: IFNULL(dim_stay_start_date.dim_stay_start_date_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5342ff7b-5910-4d30-935b-215f7bac4a25
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_CENTRIC_SEENBY_CLINICIAN_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 49d06b24-a461-451c-9665-8dd59b4821ed
                stepCounter: 150d67fe-6f3e-4546-9cd2-7fdb5d005ff0
            transform: IFNULL(dim_centric_seenby_clinician.dim_centric_seenby_clinician_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d81dd41-162b-4ccf-89fa-b77d260dc2d7
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_USER_LOGIN_CONCERTO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16f2ac98-6185-439c-9a15-757698e43d58
                stepCounter: 4bf64241-1d0b-4a30-8919-350bb5d33ed1
            transform: ISNULL (dim_user_login_concerto_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a220ad29-fca9-4771-9e2b-d08a896749e3
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Encounter end date and time
        name: STAY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 58e42b68-94b7-4b59-a2d5-892baa6ffe7b
                stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3248d87-5b87-4ca9-9cb3-b74637140df1
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Stay_End_Financial_Month
        name: STAY_END_FINANCIAL_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 55c037c3-453b-4f8f-b974-19c4aec60722
                stepCounter: 2d82251b-b816-4891-b02b-7b0b9160306d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3b7f5be-6565-42fb-845f-da7f8c52bdfa
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_ED_STAY_END_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8c85017-50dd-42e9-aadb-9f1aa7ee54d3
                stepCounter: 2d82251b-b816-4891-b02b-7b0b9160306d
            transform: IFNULL(dim_stay_end_date.dim_stay_end_date_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2d7e745-244e-45c9-8e4b-d7c894a80b90
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Code for reason why stay started; A=arrival, S=specialty change, P=prof carer change, T=transfer
        name: STAY_START_REASON_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 850827d6-6b6d-4b9c-a315-3e4ba3dd526d
                stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db916384-a122-467b-9f56-198936db8b87
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: s_ed_location_stay_5.change_type_in_code=dim_change_type_in.change_type_in_code
        name: STAY_START_REASON_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE s_ed_stay_40.stay_start_reason_code
                          WHEN 'A'                            THEN 'Arrival'
                          WHEN 'D'                            THEN 'Departure'
                          WHEN 'P'                            THEN 'Clinician'
                          WHEN 'S'                            THEN 'Specialty'
                          WHEN 'PS'                           THEN 'Clinician and Specialty'
                          WHEN 'T'                            THEN 'Transfer Location'
                          WHEN 'TP'                           THEN 'Transfer Location and Clinician'
                          WHEN 'TS'                           THEN 'Transfer Location and Specialty'
                          WHEN 'TPS'                          THEN 'Transfer Location, Clinician and Specialty'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e1a4385-5763-46f8-b5a9-697c7e25bf74
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_stay_50.stay_start_reason_code=dim_ed_stay_start_reason.stay_start_reason_code
        name: DIM_ED_STAY_START_REASON_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a40e1fa-c536-4e1a-a7dd-3ec870d8e361
                stepCounter: c2d3dc73-a281-408e-a336-458f454bede0
            transform: IFNULL(dim_ed_stay_start_reason.dim_ed_stay_start_reason_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab0de609-6220-44aa-a374-7d44d291a607
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Code for reason why stay ended; D=discharge, S=specialty change, P=prof carer change, T=transfer
        name: STAY_END_REASON_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dfa5e6be-9dde-4e6a-a2a2-d17234909867
                stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88dd63e8-8837-4dd1-bcbf-e8af3679caec
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: s_ed_location_stay_5.change_type_out_code=dim_change_type_out.change_type_out_code
        name: STAY_END_REASON_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE s_ed_stay_40.stay_end_reason_code
                          WHEN 'A'                          THEN 'Arrival'
                          WHEN 'D'                          THEN 'Departure'
                          WHEN 'P'                          THEN 'Clinician'
                          WHEN 'S'                          THEN 'Specialty'
                          WHEN 'PS'                         THEN 'Clinician and Specialty'
                          WHEN 'T'                          THEN 'Transfer Location'
                          WHEN 'TP'                         THEN 'Transfer Location and Clinician'
                          WHEN 'TS'                         THEN 'Transfer Location and Specialty'
                          WHEN 'TPS'                        THEN 'Transfer Location, Clinician and Specialty'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c342d43-83f2-44a5-824c-5d88d246fe4d
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_ed_stay_50.stay_end_reason_code=dim_ed_stay_end_reason.stay_end_reason_code
        name: DIM_ED_STAY_END_REASON_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c470298e-889d-4d0b-a4d3-3605d8b00abd
                stepCounter: 854f1a04-a25e-4f35-b8cc-4b455d4ca210
            transform: IFNULL(dim_ed_stay_end_reason.dim_ed_stay_end_reason_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 936d57dd-a025-461c-b911-feca264a78c5
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: PIMS service point ref no
        name: EMERGENCY_DEPARTMENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc721afb-7295-49a6-80d5-d2f3f877688d
                stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
            transform: IFNULL(s_ed_stay_40.service_point_reference_no,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 262c1af9-9944-4bb5-9294-cfa27e5ee6f5
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Location of ward stay.
        name: EMERGENCY_DEPARTMENT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d6b5fa7f-cd78-41ac-b54a-c2f458bff17a
                stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a40cb08-9ea3-4703-86e0-527ca25c121b
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ED_location_responsibility_centre_code
        name: ED_LOCATION_RESPONSIBILITY_CENTRE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 01a66a63-b609-40d7-9c63-e4713b553ddd
                stepCounter: 795c21ea-1da9-4519-8c1b-1e9f6f1a9458
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae658dd8-22ba-4edb-adc3-88d57a37fa92
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ED_location_health_org_code
        name: ED_LOCATION_HEALTH_ORG_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2a39df96-0329-4811-b7a7-1c0fa7aee592
                stepCounter: 795c21ea-1da9-4519-8c1b-1e9f6f1a9458
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b5400187-e030-49c0-bcc4-3baf04c3b21e
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_ed_stay_50.emergency_department_reference_no=dim_ED_location.ED_location_reference_no
        name: DIM_ED_LOCATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bab06ecd-8e25-475a-8a41-940ce0a7b207
                stepCounter: 795c21ea-1da9-4519-8c1b-1e9f6f1a9458
            transform: IFNULL(dim_ED_location.dim_ED_location_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f276383-c43f-4007-b40b-a678dc345a83
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_ed_stay_50.replace(dim_ED_location.responsibility_centre_code,'-','')=dim_responsibility_centre_service_point.responsibility_centre_code
        name: DIM_RESPONSIBILITY_CENTRE_SERVICE_POINT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6bb45be4-2fcd-460c-bbc5-2061ceae830f
                stepCounter: 3e4f2d4b-769d-416e-8e99-cc5dc3e4ffa3
            transform: IFNULL(dim_responsibility_centre_service_point.dim_responsibility_centre_service_point_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f414e66d-7b6f-4fd8-90e6-3288089867b5
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Patient ref no.
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 625e4c14-dc17-49a7-ae57-0b12324253b6
                stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
            transform: IFNULL(s_ed_stay_40.patnt_refno,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a34677e8-ebda-4d73-96a2-2586a6930751
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient_National_Health_Index
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 985f0ba0-97cf-4152-a49b-7e86cb71409e
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d883936-f41e-4291-80f6-a1fd615df9d3
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_ed_stay_50.patient_reference_no=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9962a01b-5f3d-4c1a-b371-997edef38d0f
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: IFNULL(dim_patient.dim_patient_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0abead96-aa3c-45ab-855a-24ae1f7e5d47
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Profession carer ref no.
        name: CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 042df74b-0f87-47b1-aff9-658bf93fbb84
                stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
            transform: IFNULL(s_ed_stay_40.healthcare_professional_reference_no,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 935aec9f-2fa3-45c4-9a30-dabb0a4ca6ce
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Clinician associated with the stay
        name: CLINICIAN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c1c3316-680a-4cb0-90d3-8e75965cab55
                stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 484ba25b-f4f5-4317-82ce-6b83d827f37b
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Healthcare_Professional_Type_Code
        name: CLINICIAN_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51920329-f486-456e-b70d-d2c93777e3dd
                stepCounter: 293e84bb-0ad7-4a27-96ab-0a0cb38c50c5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48b0ad8c-0745-4d29-88d9-b081d0731b58
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time seen by clinician
        name: CLINICIAN_SEEN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72b89aed-da76-4fb1-b8bb-d1e2431dfbd4
                stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57450173-a6bc-438a-ab2c-8034e83a59dc
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_ed_stay_50.s_ed_stay_40.healthcare_professional_reference_no=dim_seen_by_clinician.seen_by_clinician_reference_no
        name: DIM_SEEN_BY_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6980c5e-497d-45d3-854e-f5d17228ad86
                stepCounter: 293e84bb-0ad7-4a27-96ab-0a0cb38c50c5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 294f0a72-9f7a-47c7-a375-7fff3f67042c
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: PIMS specialty reference number
        name: SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 46cfe18b-0a71-4324-85cb-c5831621e603
                stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
            transform: IFNULL(s_ed_stay_40.specialty_reference_no,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0871ef54-26e0-4abf-b36e-822d5cc800ce
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Stay specialty.
        name: SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 655f6704-08de-4088-a693-da30564dd3a2
                stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b5539074-2ef6-4717-92b0-7f7474f9ab5d
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: speciality_responsibility_centre_code
        name: SPECIALITY_RESPONSIBILITY_CENTRE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5522d7f-7010-49dc-8ec1-9e42f9114870
                stepCounter: 4182a75e-d07b-4637-97fa-4c01e2878360
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e02fa7b6-4ed3-494c-818a-263a4fa11261
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Health_Specialty_Code
        name: HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab525339-3f36-4625-ba0c-d207897f094b
                stepCounter: 4182a75e-d07b-4637-97fa-4c01e2878360
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dba96f50-1ef4-4f5c-a2e6-739b71952788
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time patient transferred to a new specialty
        name: SPECIALTY_TRANSFER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f3ff6175-b4e4-40b8-b691-8b868bf25d21
                stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e837741-7769-4820-9ecd-64f2cc4fdf60
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_ed_stay_50.specialty_reference_no=dim_specialty.specialty_reference_no
        name: DIM_SPECIALTY_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79aee918-ff6f-4b0a-a656-000827899f3e
                stepCounter: 4182a75e-d07b-4637-97fa-4c01e2878360
            transform: IFNULL(dim_specialty.dim_specialty_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f02a0e1-8528-4b71-83d5-525c408c2ddb
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_ed_stay_50.replace(dim_specialty.responsibility_centre_code,'-','')=dim_responsibility_centre_specialty.responsibility_centre_code
        name: DIM_RESPONSIBILITY_CENTRE_SPECIALTY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 727b5f77-7407-470e-a41a-e4d927c97a4c
                stepCounter: 379bd581-3e19-433f-82c3-5615877ed6c5
            transform: IFNULL(dim_responsibility_centre_specialty.dim_responsibility_centre_specialty_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c7656568-d91d-4b35-be4d-8cc9f1e0999d
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: NUMERIC(10)
        defaultValue: ""
        description: ""
        name: PREVIOUS_STAY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c21872de-ecf1-4d7f-a879-64a651899e27
                stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b938cda1-2adf-4d4a-92b9-b44b2241018b
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PREVIOUS_STAY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a195b0f-d141-454b-9b58-cace6b75e4d1
                stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f71ce158-9788-445e-ae83-bd65e84ebd77
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: NEXT_STAY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 38f61996-8a99-4f7b-9786-4635353fbda7
                stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 858df220-edd9-4676-94c6-233650464595
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NEXT_STAY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a5f08dc8-8756-4b94-832e-db77e37e5c78
                stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c1dff43-eed8-44a0-a0b1-945e36cc29f2
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Flag used for costing feeders. Y if stay is greater than 10 minutes in duration, N if not
        name: ED_STAY_OVER_10_MIN_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e5484c9-d2bd-4b28-a679-1da29c0a62e5
                stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0464ea3-6b3a-4469-8786-9f7b3d2f3a88
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Flag used for costing feeders. Y if stay is greater than 10 minutes in duration, N if not
        name: ED_STAY_OVER_10_MIN_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e55398d-a5b3-44ca-b1ab-c6f5e222afdd
                stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf820fdb-95bd-4846-8fdd-a7f833ec86f0
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Flag used for costing feeders. Y if stay is greater than 10 minutes in duration in ADU, N if not
        name: ADU_STAY_OVER_10_MIN_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2c3e259-f8d9-4904-8c4c-af9a2ad2c868
                stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 89f1c42f-be2f-4345-a0fc-feb1d9baad9b
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Flag used for costing feeders. Y if stay is greater than 10 minutes in duration, N if not
        name: ADU_STAY_OVER_10_MIN_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c2fb7c2-7e0e-44ea-9e10-cd603fe41e79
                stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 669a1e87-b342-429e-929d-9d4418b7d39e
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: duration_unit (minutes)
        name: DURATION_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a6de61d-6897-4cba-be98-6c5601ed41a9
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Duration between start and end date of Stay
        name: LENGTH_OF_STAY_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: edcb9061-a611-42a6-affd-4dbb66473b23
                stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0465272-ba74-4a9a-b5b8-218fdb151465
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: previous_to_current_stay_duration
        name: PREVIOUS_TO_CURRENT_STAY_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59ea6d17-4acd-4af5-908c-2b59a905cb19
                stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d1fe2bf2-bd61-43b1-81fc-5e7aea3b910a
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: current_to_next_stay_duration
        name: CURRENT_TO_NEXT_STAY_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f2354d55-ce44-4125-ba6a-61d03943f87a
                stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d9917be-70d7-42ef-a263-4be3d6009828
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Duration of change between locations
        name: LOCATION_CHANGE_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02b59a35-cc65-4293-baef-4cdbb18821aa
                stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1eabfd6d-4d3c-4968-9613-6b97c48ee39e
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Duration of change between clinicians
        name: CLINICIAN_CHANGE_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e8ac955-6feb-462a-90d9-0626883a6672
                stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 13bd072c-adb4-4e7e-8dd5-f4fbcee8816b
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Duration of change between specialty's
        name: SPECIALTY_CHANGE_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7aef5357-8dc6-4e3d-ba8e-99cb708b03a2
                stepCounter: 6e53d33b-f72a-46b0-85eb-c895bd24da69
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f317894-731f-49a1-9476-60c90564d41a
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: stay_count
        name: STAY_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '1'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 23a4c972-ac65-442b-8c79-118eec5d311f
          stepCounter: 4b1d171d-a11a-44de-a63a-c852dfdf7724
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_ED_STAY_40
        join:
          joinCondition: |-
            FROM s_ed_stay_40
              LEFT OUTER JOIN dim.dim_stay_start_date dim_stay_start_date
                ON CONVERT(date,s_ed_stay_40.start_date) = dim_stay_start_date.stay_start_calendar_date
              LEFT OUTER JOIN dim.dim_stay_end_date dim_stay_end_date
                ON CONVERT(date,s_ed_stay_40.end_date) = dim_stay_end_date.stay_end_calendar_date --added on 21.03.2024 --SR  left join (select *, row_number() over (partition by encounter, refno order by encounter, refno, createdDTTM desc) rn  from ds_centric_Patient_Status ) ds_centric_Patient_Status    on s_ed_stay_40.aesty_refno= ds_centric_Patient_Status.refno   and 'A' + convert (varchar(100),s_ed_stay_40.aeatt_refno)= ds_centric_Patient_Status.encounter    and ds_centric_Patient_Status.deletedBy is null    and ds_centric_Patient_Status.rn=1    left join (select *, row_number() over (partition by encounter, aesty_refno order by encounter, aesty_refno, modifDTTM   desc) rn from ds_centric_Patient_Location) ds_centric_Patient_Location        on s_ed_stay_40.aesty_refno= ds_centric_Patient_Location.aesty_refno  and 'A' + convert (varchar(100),aeatt_refno)= ds_centric_Patient_Location.encounter    and ds_centric_Patient_Location.deletedBy is null    and ds_centric_Patient_Location.rn=1     left join dim.dim_user_login_concerto    on IFNULL(ds_centric_Patient_Status.createdBy,ds_centric_Patient_Location.userModif) = dim_user_login_concerto.user_name    and IFNULL(ds_centric_Patient_Status.createdDTTM, startDTTM) between validity_start_date and validity_end_date    LEFT OUTER JOIN(select *, row_number() over (partition by healthcare_professional_reference_no order by user_full_name,healthcare_professional_reference_no, dss_start_date desc    , dss_end_date desc) rn   from     dim.[dim_centric_seenby_clinician]   --where healthcare_professional_reference_no is not NULL   --AND dim_centric_seenby_clinician.dss_current_flag = 'y'   ) [dim_centric_seenby_clinician]      ON s_ed_stay_40.healthcare_professional_reference_no = dim_centric_seenby_clinician.healthcare_professional_reference_no     -- AND dim_centric_seenby_clinician.dss_current_flag = 'y'   and dim_centric_seenby_clinician.rn=1      ------------------------
        name: S_ED_STAY_50
        noLinkRefs: []
  name: S_ED_STAY_50
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
