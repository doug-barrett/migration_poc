fileVersion: 1
id: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
name: S_OUTPATIENT_APPOINTMENT_20
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01026408-0678-4d18-8b55-55770f6e93d3
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ACC_FUNDED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 95cf969a-fa25-4fcc-9756-f37030fe6de2
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a0fed561-efb8-44e8-9471-69f1bdb9645d
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: NUMERIC(15,2)
        defaultValue: ""
        description: Actual cost from costing system
        name: ACTUAL_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8393566-f54f-44dd-9fc9-60a319344307
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMIN_CATEGORY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ad209f06-4a48-485c-8e50-47c207f73318
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 63050ccd-8849-4a2f-914f-997332b311bc
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ANAESTHETIC_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: da1200e3-21f4-43a5-87c4-e06918835681
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6b4e8f0-af74-4d30-8447-d7fe2fac6736
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTED_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 224beca2-8103-4b0b-872a-96dbb7c26df5
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c36a36f0-4d0e-42b3-8df6-39771c13da5e
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: APPOINTMENT_CALLED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b7f3cbbd-f894-4983-a303-6a599a002a42
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 238b11cf-22c9-4f6f-bd2d-dbddce0862d6
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_CHANGE_REQUEST_BY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b926c16-9e8c-47ca-9155-1014c3b75c63
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9209a2f3-cfef-4238-8b0e-b788f2e977b0
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: appointment_contact_status_code, "A=Actual", "P=Planned", "C=Cancelled"
        name: APPOINTMENT_CONTACT_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a299d07d-107a-49b2-ac0d-3ab19daba02f
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f4e95685-1885-45fd-ae2c-69766f50dbb0
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c48e144-6851-45f1-824d-fbf5c4eb7658
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7cc35cae-3989-43e9-9167-c1c0be573058
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_DURATION_ARRIVED_TO_DEPARTED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0825651f-7720-462e-9078-04ec8fcc2bb1
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: abe38741-115f-43bd-bee6-b28da9fa9728
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: APPOINTMENT_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d4e33f6-4655-459d-84f5-cc27f77b6358
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bdf4ca99-a099-4236-b30a-9c71dea9d79f
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: APPOINTMENT_MOVEMENT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 92bc025a-c26f-490e-af79-a014f19747a0
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dbbb7ec8-ea14-4ef8-9045-9597ab52beed
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_MOVEMENT_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1a43ece3-a700-4ba5-a3f5-d90306d2e695
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 703b4e18-a3c1-4622-88ee-6384de87b3a5
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_OUTCOME_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 65490aa3-67b4-4b8e-99b7-2ec0190023da
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ebb831a-590f-48e1-a6b0-ecba5dbd0e3b
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: APPOINTMENT_REQUEST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ca9f7998-b87c-479b-8b13-b4134b518b31
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96103c89-cd3d-4476-8727-b6a02af93a4f
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: APPOINTMENT_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 412e3380-9c89-49a5-94c8-2ab3b14dce21
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b86fcee3-4d4c-4b86-a11a-f93252d68711
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: APPOINTMENT_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ff377334-b1b4-45e2-91ed-94002b3e6110
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9cbd498f-df14-404d-9224-6c9d13b938f7
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 634dc1eb-bcd3-416f-956e-b2367558e675
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d31d6957-10c0-4012-87a8-57aac0072ba3
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: appointment_status_type_code, "A=Actual", "P=Planned", "C=Cancelled"
        name: APPOINTMENT_STATUS_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eb7b5c7a-e724-4b00-a53d-fd32298da37f
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6811f9d0-fc78-4f71-a6ca-597234e735c8
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: appointment_theatre_status_code, "A=Actual", "P=Planned", "C=Cancelled"
        name: APPOINTMENT_THEATRE_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 923c6e7a-ce35-4ee9-9906-fd9fd2c57787
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d67e67f-313c-40fe-be79-ea7ed39b105e
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed428f34-f8f4-4ee1-85d7-07e2800a8e5c
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da183d75-5ba0-462a-9caa-5111cf90ab26
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: APPROXIMATE_SCHEDULE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 93dd2c18-d46a-4898-b920-12c4b57be866
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa6a63dc-1041-4c99-8e41-29bdbb726761
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: ATTENDANCE_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19391b24-4f02-48e4-bfe9-9ab6aa29fe27
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3fe3b466-3d15-491d-9f72-070ed96a6c75
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ATTENDANCE_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4dfcec8d-12fe-4319-9ac4-b41e04cf917d
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cea30b27-117e-4a6e-88c6-3fd37ab915c4
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: BOOKING_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 49ed887d-66ed-4512-867e-a8824067d291
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c31b3198-a2fc-4312-b576-5b46c997ed1f
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CANCELLATION_BY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76fdc772-d0a4-4cbe-8506-8221a1da1ec1
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b805415-a87d-45f8-8873-edf9b43e87c1
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: cancellation_Reason_Code
        name: CANCELLATION_REASON_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 364af149-774b-49c5-ac99-29d328b0a1ee
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8a215d3-3999-4dc5-8bb8-f38969fae925
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CANCELLATION_REASON_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3ae36fdd-b316-41bd-8a25-a49943f8e0c7
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb988749-d029-4735-b67c-e34ddf2eb2e4
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CANCELLATION_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03403329-d387-4b1d-a838-c5dbd85ab748
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ffb6e88-262c-487d-a611-792ba4cbf400
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CODING_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c6ca73a9-73cd-4fcc-8bb6-6c397aff078a
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9adfa37-5bfb-46a1-bbf6-f81fa61baee5
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: VARCHAR(MAX)
        defaultValue: ""
        description: ""
        name: COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a317e1d1-37e0-41c8-8778-6b746918390c
                stepCounter: 804e4481-4b5b-4b0c-ad30-4660d2191e3c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95a6a179-bcb1-4898-9419-a6de7eb6b2c4
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CONTACT_PURPOSE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d8b6d346-0b08-465c-b250-e41ae07b40e2
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74c6d2dc-c853-427d-af16-16e12a58a3b8
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CONTACT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 85b4ef45-6757-44df-b251-10419caf23d6
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2682223-e460-4956-a99b-2865f8ea89d9
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: COSTED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'N'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: afb4460b-3d54-4f38-add1-92a8940c17e3
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 35c79218-3b1e-4483-87b3-ce2542c2848e
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 863dc3e6-5336-4586-94a0-9b1a13452282
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ae9f965-c4c3-488c-879d-e97023644477
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac221626-9586-46f7-aecb-6e716ed788d7
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CURRENT_TO_NEXT_APPOINTMENT_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d4e33f6-4655-459d-84f5-cc27f77b6358
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: DATEDIFF(mi,s_outpatient_appointment_10.appointment_end_date,s_outpatient_appointment_prev_next.next_appointment_start_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1246b1d2-900b-4092-927a-f8654d8fe296
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: DEFAULT_PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f3d1d9d-4ccc-48a9-a73b-c35cfe7f7a5a
                stepCounter: 466266f9-cfe7-48ca-b9cb-2bf4d4396d12
            transform: |-
              CASE WHEN s_outpatient_appointment_10.patient_age_on_arrival_years >= 65 AND ds_mappings_PurchaseUnit_IPM_Outpatients_RC.[default_purchase_unit_code_over_65] IS NOT NULL THEN ds_mappings_PurchaseUnit_IPM_Outpatients_RC.[default_purchase_unit_code_over_65]
                          ELSE ds_mappings_PurchaseUnit_IPM_Outpatients_rc.[default_purchase_unit_code]
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1246b1b1-90d8-4bd2-8479-a67191871867
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DEFAULT_RC_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c61acad1-fdef-4f11-8eca-6727ad2602ee
                stepCounter: 466266f9-cfe7-48ca-b9cb-2bf4d4396d12
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4e0f5b2-cb7d-496b-81ad-2c969d840bad
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DID_NOT_ATTEND_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6459487f-8d26-4370-821d-c1384e5818c9
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c37b2d68-606f-4c4a-862f-65eb918510ac
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: Domilce code as at visit date
        name: DOMICILE_CODE
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1efe6b8c-3615-44c8-a51c-23f0c50cc21f
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DSS_DATA_QUALITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e14fa85c-244d-444b-b5ab-51f16bf28d8f
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 890a9aaf-a992-400a-8754-c810dfaf3a31
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 617f5093-af97-4b6e-a019-be9b854175dd
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DURATION_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'minute'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09abfcf9-1933-4a56-af5c-aa72af1432af
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: FIRST_APPOINTED_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 866c4830-c248-48df-83ba-1edfab58ebec
                stepCounter: 57db832a-db28-4adf-885a-63956799151c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d4a2896-d553-4cdb-83d7-0e6f5f5c0e93
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_APPOINTMENT_ARRIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 58e678a7-6cae-4830-8187-13eb6a3cf52e
                stepCounter: 57db832a-db28-4adf-885a-63956799151c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9108d606-cb74-4f7c-95fb-6e5883cf5b61
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_APPOINTMENT_SEEN_BY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 920b7e42-6b5c-4fc6-80df-226935c9551d
                stepCounter: 57db832a-db28-4adf-885a-63956799151c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9a30daf-fad7-4339-93d9-62493df50d23
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FIRST_OUTPATIENT_APPOINTMENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa22b3ef-6055-4cfb-b9aa-1b34aee41c0d
                stepCounter: 57db832a-db28-4adf-885a-63956799151c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6972060-8be2-4d68-b39b-740e1c6eac1f
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: FIRST_OUTPATIENT_CLINIC_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 15ae9c1e-32d3-4bb1-a6c0-dd04d73f3e0c
                stepCounter: 57db832a-db28-4adf-885a-63956799151c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67345f07-0d1b-4a07-8c58-a55ba2730690
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: FIRST_OUTPATIENT_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c74b8f0c-06b0-4722-8234-85a1184f074d
                stepCounter: 57db832a-db28-4adf-885a-63956799151c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a0a4f544-dd72-41c2-9d93-87ae7fd01789
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: FIRST_REFERRAL_APPOINTMENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 674586f2-94ef-497f-b189-593bfcd56a13
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a8837b4-e231-47c1-b846-f373f3aff3fd
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FOLLOWUP_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d10d8efb-e751-4ff2-af15-e2057bba20da
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d24569c7-4c0f-4c23-a26f-75d246532325
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FUNDING_ARRANGEMENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7acfb701-705c-46a5-82c0-ad3df96578f4
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41c9e9e9-c94c-4280-8aa9-c2c02b87b784
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: HAC_DNA_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f9ab0f92-59b0-4b35-8eca-3b58df39d7fc
                stepCounter: 466266f9-cfe7-48ca-b9cb-2bf4d4396d12
            transform: |-
              CASE WHEN cast(s_outpatient_appointment_10.appointment_start_date AS date) <= cast(getdate() AS date) AND s_outpatient_appointment_10.appointment_status_code = 'BOOKD' THEN IFNULL(ds_reference_IPM_Outpatient_PU.HAC_DNA_Flag, ds_mappings_PurchaseUnit_IPM_Outpatients_RC.HAC_DNA_flag)
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97bfe012-0850-4bb0-9175-5ab613955e7a
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: IP_EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4f81c010-a7d2-413f-a005-fa17b6dff5f5
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f37f4fb2-9a99-419b-8670-040f048e5665
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: IP_WARD_STAY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de48dc3b-6f67-48ae-a37e-7378afb017be
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ed2215d-8d4f-4c3f-a3d2-c16c2c476319
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LAST_APPOINTED_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dee6f24c-4779-4300-a67d-2192e8d026b1
                stepCounter: 57db832a-db28-4adf-885a-63956799151c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5fe5beba-1683-4b59-a712-13ffc4c8797e
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_APPOINTMENT_DEPARTED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5508bd3b-8d19-4314-8a11-f9aa51bb3b6f
                stepCounter: 57db832a-db28-4adf-885a-63956799151c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5638fce8-175d-434c-921b-fd0538998ae7
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ONLINE_BOOKING_REQUESTED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ba757834-6161-4217-933d-68a84d993e41
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a79f3ce-6515-44cf-9720-d2e3535b400d
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_APPOINTMENT_SEEN_BY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 066ada29-c987-4594-a94d-97e23e614ce1
                stepCounter: 57db832a-db28-4adf-885a-63956799151c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 674cc1c5-ad85-4932-821b-d711e21522ff
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LAST_OUTPATIENT_APPOINTMENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 180b8de1-0917-492f-a67b-1517ab446613
                stepCounter: 57db832a-db28-4adf-885a-63956799151c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b02078da-e5b0-4488-86d9-836cebfe25c8
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LAST_OUTPATIENT_CLINIC_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9b86a1af-9483-4f59-94bc-41d052d2b091
                stepCounter: 57db832a-db28-4adf-885a-63956799151c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 556ce5b3-6b2e-45a4-b941-bf000c302d23
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LAST_OUTPATIENT_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e20712e-c195-4a14-b131-f3c050b9d875
                stepCounter: 57db832a-db28-4adf-885a-63956799151c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e969d04-db76-4ad3-91c5-0bc806e3a787
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: MAP_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e2f6a74-753b-48b8-9b91-7bbb4256d481
                stepCounter: 466266f9-cfe7-48ca-b9cb-2bf4d4396d12
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ad0df87-dad6-46f7-a5ee-9a5c20faea40
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIFY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a7573c7c-d4bd-4d2a-b692-4c9183a28ed6
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b50c0b0a-30d9-48f5-8ab9-7b0f8ba69c59
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MODIFY_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7df2d645-f729-4965-8bdd-ecb45a6991e8
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d88f9054-b868-4d0a-821c-41a50b2ae3df
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: NEXT_APPOINTED_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e6dacad5-8dfe-4e0e-9df1-a3c3e4e2df09
                stepCounter: 57db832a-db28-4adf-885a-63956799151c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1e1c342-b88b-40d3-a6f8-c5419f86b5a6
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NEXT_APPOINTMENT_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d1b189ea-1934-4d71-88d6-efb90cb0f0d3
                stepCounter: 57db832a-db28-4adf-885a-63956799151c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49bd9674-0505-4dbd-a1fe-b08cf97a64d5
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NEXT_OUTPATIENT_APPOINTMENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1dc41b67-f13d-415d-ae6a-1da193cf25f8
                stepCounter: 57db832a-db28-4adf-885a-63956799151c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18fb9639-2f0b-4b83-911f-6ea6ea21d8da
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: NEXT_OUTPATIENT_CLINIC_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3446f2c7-dc4f-4023-97af-8520776a1e12
                stepCounter: 57db832a-db28-4adf-885a-63956799151c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fccec24a-11e7-4545-80cc-43b861e633ca
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: NEXT_OUTPATIENT_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e9cd6010-3540-4775-a9d0-a98d86902e8c
                stepCounter: 57db832a-db28-4adf-885a-63956799151c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 99e223e0-6665-4f02-b257-bdebfb85c6ef
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Is this referral an National patient flow referral, Note this rule is the ESPI1 rule plus Surveillance
        name: NPF_PRESENTING_REFERRAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f93b099-8ec0-48ef-acb8-b3ef58e70dbf
                stepCounter: 32661289-2246-4a7c-a2ad-9907fdccd6ac
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 65294666-e59f-4461-a417-c6ca32f64f1f
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OPERATION_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 61f004f1-5c66-4513-bb21-91ad9b36a159
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48b707dc-4c45-43f0-a314-9c50d80f105e
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: OUTPATIENT_APPOINTMENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c80e9823-9b77-407b-9b3d-7d1e717f6567
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7478d16-24ac-4d6b-b3e4-1d09e1f7a6c5
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: OUTPATIENT_APPOINTMENT_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'T'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01af9aa2-a2a9-4ce9-81be-63866e47ce4f
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OUTPATIENT_APPOINTMENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b0ac545-d89b-4695-ba3d-63fe35c2f488
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 187f82dc-bde5-48d3-8dc5-530c8a9630f8
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OUTPATIENT_CLINIC_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f9c03773-b9cf-448d-9734-c0065b3a90e2
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d52f0dab-407a-418d-9301-aa20ffa72173
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Health Specialty Code
        name: OUTPATIENT_HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2e3ba2f-de6d-40c4-9153-31d74afaf5d9
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54a2759d-5dce-4cf6-aec8-fcb52bebd369
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OUTPATIENT_SESSION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33ec140d-8ef2-4805-939f-bd6f6d116528
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: |-
              CASE WHEN 200828 = s_outpatient_appointment_10.appointment_status_reference_no THEN NULL --planned appointments retain the session they are booked from in the past

                          ELSE s_outpatient_appointment_10.outpatient_session_reference_no
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 548069af-2f4a-49ce-bf84-d2d29e1ce10d
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OUTPATIENT_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52cde62f-bb34-4059-943b-cd89e05e1357
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dea9df4e-31c0-4dcb-af1a-6403d85c0709
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: OVERBOOKED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 42586f93-59d5-4151-9cf5-4ca7698db8e3
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc83e06a-0ed3-4c0f-b6c5-aa90b15e92ad
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PARENT_OUTPATIENT_APPOINTMENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7955cb9a-c1c3-44bc-af26-9a43c843b7ae
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 89488409-e62e-4d6e-8f3b-028253066905
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_AGE_ON_ARRIVAL_YEARS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ace792d4-c56d-4bce-a237-760e416a0e7f
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ca0991b-e813-4364-8543-8ef23bab286b
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_APPOINTMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 466eafb3-4076-4d42-916d-47c6f7f6b1de
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4b225f4-ab09-4619-9f13-fe6331096f11
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_APPOINTMENT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e4c5ea1-12cf-4982-b474-5c417cd979d8
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86404ff4-1899-4246-ab33-ab94a4a6c8c1
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PATIENT_ARRIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5dc8f95b-ce3b-4208-ae26-5475e033c636
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 543ff86a-b7f2-4852-8537-4d4596cb037d
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_CONFIRMATION_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9bd68d2a-2c7f-443b-a370-10f250e43aef
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b902a1d-5918-4b7a-b33c-c947843e0fe9
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PATIENT_DEPARTED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e775217d-96cf-4add-9d62-825a7df86579
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7bc0c12-f669-4b1a-95ee-7f81774f2402
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ee4b93d-e76b-49a0-9928-970a1f7472b4
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: efb476e0-2b6c-4a90-b3a4-4faa5b257f99
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8a6b5beb-58fc-426f-b455-6c53d329dda6
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8b2f8e5-9c85-4a61-9cbc-a1dbc371d818
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PATIENT_SEEN_BY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb2e5d2b-e950-45f5-9e66-7a2331652c66
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa351e69-0d78-411b-8106-1bc3a2287db4
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Session from which a planned appointment was booked.  This is not populated once booked.
        name: PLANNED_OUTPATIENT_SESSION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33ec140d-8ef2-4805-939f-bd6f6d116528
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: |-
              CASE WHEN 200828 <> s_outpatient_appointment_10.appointment_status_reference_no THEN NULL --planned appointments retain the session they are booked from in the past

                          ELSE s_outpatient_appointment_10.outpatient_session_reference_no
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec20b225-b315-4d69-a390-303b7f6f820c
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PREV_APPOINTED_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a0b265d1-2fdb-4996-bd86-eb54f24e21a1
                stepCounter: 57db832a-db28-4adf-885a-63956799151c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 425cc7b8-8be0-4b56-8eb2-d7dde693dde2
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PREV_APPOINTMENT_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7cc3ef90-9ba8-4bf6-8d80-7ab785b06a84
                stepCounter: 57db832a-db28-4adf-885a-63956799151c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04eb80b9-8668-4510-b01a-88c9d8edcb25
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PREV_OUTPATIENT_APPOINTMENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9e4a0c1-f558-447e-b1d3-b5594372eb44
                stepCounter: 57db832a-db28-4adf-885a-63956799151c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ebc35bb-f6e3-4d24-b7f7-99579be84fb2
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PREV_OUTPATIENT_CLINIC_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b868fd78-aa9f-4ca7-bf26-d5dcf32ea952
                stepCounter: 57db832a-db28-4adf-885a-63956799151c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a8ca929-89d2-42a7-b51c-9b6c2d3b948b
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PREV_OUTPATIENT_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e5b00b4-409d-45db-a3fe-7b5ceae91dec
                stepCounter: 57db832a-db28-4adf-885a-63956799151c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de9e676d-9f99-4bd9-93b4-8e3c035e4578
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREVIOUS_TO_CURRENT_APPOINTMENT_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 412e3380-9c89-49a5-94c8-2ab3b14dce21
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: DATEDIFF(mi,s_outpatient_appointment_prev_next.prev_appointment_end_date,s_outpatient_appointment_10.appointment_start_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c7dba21-e1ca-40f3-b029-b4baba81b614
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PRIMARY_PROCEDURE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f46b6d1-0294-44a8-ab6a-97305ff2621d
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69afea51-a3fe-46f2-ad06-776478d2b31f
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: PRIMARY_PROCEDURE_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 06bdabfc-ae53-4e51-884b-217ab04a97cb
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1eef6b5d-fe3b-4473-a948-425d00231d54
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRIMARY_PROCEDURE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa7aa97d-c599-4935-af68-72a6abd25fbd
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 899fb995-5b56-4994-a122-8d27fb00b9aa
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PRINCIPAL_DIAGNOSIS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 99fad353-43a5-47f2-815b-89cfd52769cd
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a1c8984-3459-4348-a809-8b9bf5831761
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: PRINCIPAL_DIAGNOSIS_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4ef0ff3-5d22-4311-be37-197d43657f75
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b67dc01-a866-4ca4-9536-018f87e93123
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRINCIPAL_DIAGNOSIS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76b8107b-904a-4fd4-8a12-e609fada2eaf
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16509d3d-6a87-4bd7-b0b1-5b5fe7cfec97
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRIORITY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 499ed45e-72c3-4fbf-a9c7-95074612f52f
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87b06b55-4860-4cf8-ae9a-c14a92c47272
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INT
        defaultValue: ""
        description: staging field only to help identify mapping issues
        name: PUC_MAP_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e2f6a74-753b-48b8-9b91-7bbb4256d481
                stepCounter: 466266f9-cfe7-48ca-b9cb-2bf4d4396d12
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa5f32ea-2bc5-4e60-b2c3-3196b5e2d2d6
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_CODE_POST_01_07_2014
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f3d1d9d-4ccc-48a9-a73b-c35cfe7f7a5a
                stepCounter: 466266f9-cfe7-48ca-b9cb-2bf4d4396d12
            transform: |-
              CASE WHEN s_outpatient_appointment_10.patient_age_on_arrival_years >= 65 AND ds_mappings_PurchaseUnit_IPM_Outpatients_RC.default_purchase_unit_code_over_65 IS NOT NULL THEN REPLACE(ds_mappings_PurchaseUnit_IPM_Outpatients_RC.default_purchase_unit_code_over_65,'.','0')
                          ELSE REPLACE(ds_mappings_PurchaseUnit_IPM_Outpatients_RC.default_purchase_unit_code,'.','0')
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9538ac00-311d-4f6d-864f-dd1fe0335ea4
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_CODE_PRE_01_07_2014
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3d7f9a4-8474-4cdc-9d81-5c3b841619a1
                stepCounter: 5fde45ea-fc34-4939-97a8-e8a440c479a7
            transform: REPLACE(ds_reference_IPM_Outpatient_PU.purchaseunit,'.','0')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c7c7328-2113-4de7-8314-b7eaf2e413fb
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: REASN_COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 29d7fea9-c0d1-49b6-a016-baab882a8677
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 604ecbb7-54df-4046-a900-4c071b7792b2
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_APPOINTMENT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ac63d0ac-0708-4aa5-951d-e28d942274c4
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 402b8a50-9b12-4316-94e6-1ffba82c462c
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c9c0b32-8e44-41f3-ab7c-0d81809f5ac7
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9753d978-a65b-4d20-bd99-3277d20f6ff4
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c3f04f3-6f74-4395-917f-255635db9695
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0590f476-03c3-4fc9-86b1-4022ceaa765e
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_SCHEDULE_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ae2e53ed-2fda-4d06-b761-bfa6d826eb7b
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b35328d-342b-4fb4-8bdb-e38035df5eb5
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_SOURCE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94754094-77b0-4ce4-90d4-993efc26b132
                stepCounter: 32661289-2246-4a7c-a2ad-9907fdccd6ac
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9544a9b2-1975-40c7-96d7-13e1db388d74
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: RESPONSIBILITY_CENTRE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c61acad1-fdef-4f11-8eca-6727ad2602ee
                stepCounter: 466266f9-cfe7-48ca-b9cb-2bf4d4396d12
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d44d64c0-4122-41b1-8e8a-7ff1f26d5a31
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: SCHDL_COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c3417df9-5c24-4350-9905-e00956c9b7e3
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e5a2ff0-a71b-4111-b25e-482fd8bb33b1
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: number of time the appointment has been rescheduled
        name: SCHEDULE_MOVEMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d7354236-9f2e-4235-950d-d71b4bc54977
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41c2eaa2-a42c-4b9c-9d00-ccd11191f64d
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SECONDARY_DIAGNOSIS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7dec07f-01e7-4416-b45c-ece78a8eabdf
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b9cdd32d-6c6c-4f7c-8432-d4809bce52e2
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: SECONDARY_DIAGNOSIS_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e6f6eaa-5273-421a-b225-1bd260cf56b1
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 058f7f4c-b77c-4dea-97fe-f2fe5d7a27d9
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SECONDARY_DIAGNOSIS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a8996fcd-c6bd-45f6-a899-0ae687c41791
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf9d52cd-63e0-4035-b876-d26c35a591da
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SECONDARY_PROCEDURE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 93452370-3e92-4fb6-8a62-f2edcb5f6857
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d77bdf8-4025-426e-a9db-4431aeb2361d
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: SECONDARY_PROCEDURE_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 177055f5-27d1-4032-818e-40f1ed88a3d2
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 60a2fc88-ef01-46fb-8406-d37828989f2c
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SECONDARY_PROCEDURE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ac2d3910-e7f8-4218-bdbc-924762b64b3c
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dcf14305-2840-45eb-8ada-8eeeabf2a1ac
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ca69a25-9d37-4dfd-b6ae-4ed9d9f5b399
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 943297e8-b3a2-4f64-b3fc-67fd96711da0
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_APPOINTMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d21f1922-b6cb-4665-b985-5fe3ad863a62
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0fd20499-3fce-4e3e-a46c-e3276d5c2579
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_APPOINTMENT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ce93c72-d072-4cd2-a21f-7e480843b0b4
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11bc5796-f453-40f7-86b7-319bc31ce89c
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: NUMERIC(15,2)
        defaultValue: ""
        description: budget cost from costing system
        name: STANDARD_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d1202718-b7c8-4007-b2fa-f51b1f39d083
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: TRANSPORT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e29a4692-5245-49cd-91ff-87612dbe7c18
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d424928-e32a-42d3-a374-2315df7643aa
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: TREATMENT_DECISION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 363a2116-bdd6-4f23-9e46-67e0c88786be
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0edd2048-646d-49d6-b4a2-edb2032f948f
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: TREATMENT_DELAY_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cdc016fd-456f-4b30-86c4-5af7bd461af9
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67355a7d-320f-484b-8500-e07697f95506
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: UNPLANNED_RETURN_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c947a78f-6b66-4134-a808-011e07d41899
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3110de1-4967-498a-9cbd-5127103c2ce6
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: URGENCY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 32ac48a6-35b2-4532-bc91-0ab8f28a555d
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fffb65be-864e-474e-99d0-b65112dc3a4d
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: VIRTUAL_APPT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: coalesce(ds_reference_IPM_Outpatient_PU.Virtual_Appt_Flag, ds_mappings_PurchaseUnit_IPM_Outpatients_RC.virtual_appointment_flag,'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01b2048c-0bb4-4557-a3c2-f76f617c1154
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: VISIT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9bf9be5e-cc5a-470a-b202-6dc146abbfcd
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae4de60b-c8c7-4917-a80f-aa00f833e966
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4fbdddf2-1bb9-426d-9347-78afff65528c
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 84ee41a1-435e-4966-ae22-b305891c1ad1
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Sequence for appointment within waitlist ordered from most recent to oldest
        name: WAITLIST_SCHEDULE_REV_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3142888f-0fdc-4b9a-8b5f-fa4920056c1f
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34a963bb-267e-46c1-9447-2ad561520889
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INT
        defaultValue: ""
        description: Sequence for appointment within waitlist ordered from oldest to most recent
        name: WAITLIST_SCHEDULE_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 526238c6-c644-4f16-88f0-e0adfe524919
                stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57c3ad6d-ee09-4c25-8d4c-c01888f3cfc8
          stepCounter: 554f7086-6a92-44d8-b38b-e6c0cfd8284e
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ACCINDICATORID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IFNULL(ACC.localcode,0)
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_OUTPATIENT_COMMENT_NOTE: 804e4481-4b5b-4b0c-ad30-4660d2191e3c
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_OUTPATIENT_APPOINTMENT_10
          - locationName: UNKNOWN
            nodeName: FACT_COST_ENCOUNTER
          - locationName: TGT
            nodeName: S_OUTPATIENT_COMMENT_NOTE
        join:
          joinCondition: |-
            EXTENDED
              FROM s_outpatient_appointment_10 s_outpatient_appointment_10
              LEFT OUTER JOIN s_outpatient_appointment_prev_next
                ON s_outpatient_appointment_10.outpatient_appointment_reference_no = s_outpatient_appointment_prev_next.curr_outpatient_appointment_reference_no
              LEFT OUTER JOIN ds_reference_IPM_Outpatient_PU
                ON s_outpatient_appointment_10.outpatient_appointment_encounter_id = ds_reference_IPM_Outpatient_PU.encounter
              LEFT OUTER JOIN ds_shared_referral
                ON ds_shared_referral.refrl_refno = s_outpatient_appointment_10.referral_reference_no
              LEFT OUTER JOIN dbo.s_healthcare_professional
                ON s_healthcare_professional.healthcare_professional_reference_no = IFNULL(s_outpatient_appointment_10.appointed_clinician_reference_no,s_outpatient_appointment_10.parent_appointed_clinician_reference_no)
              LEFT JOIN {{ ref('UNKNOWN','FACT_COST_ENCOUNTER') }}
                ON s_outpatient_appointment_10.outpatient_appointment_encounter_id = fact_cost_encounter.encounter_id
              LEFT OUTER JOIN {{ ref('TGT','S_OUTPATIENT_COMMENT_NOTE') }}
                ON s_outpatient_appointment_10.outpatient_appointment_reference_no = s_outpatient_comment_note.sorce_refno
               AND s_outpatient_comment_note.row_num = 1
              LEFT OUTER JOIN (
                    SELECT a.localcode,
                           b.encounter_id
                      FROM s_outpatient_ACCIndicators a
                      JOIN s_outpatient_acc_calc b
                        ON a.VisitGT7DaysPostRef = b.VisitGT7DaysPostRef
                       AND a.AdmittedToHospital = b.AdmittedToHospital
                       AND a.AdmittedToday = b.AdmittedToday
                       AND a.FirstVisit = b.FirstVisit
                       AND a.IPWithin42Days = b.IPEventWithin42Days
                       AND a.IPOver42Days = b.IPEventOver42Days
                       AND a.EDWithin42Days = b.EDEventWithin42Days
                       AND a.EDOver42Days = b.EDEventOver42Days
                   ) ACC
                ON s_outpatient_appointment_10.outpatient_appointment_encounter_id = acc.encounter_id
              LEFT OUTER JOIN [dim].[dim_outpatient_clinic]
                ON s_outpatient_appointment_10.outpatient_clinic_reference_no = dim_outpatient_clinic.outpatient_clinic_reference_no
               AND dim_outpatient_clinic.dss_current_flag = 'Y'
              LEFT OUTER JOIN dbo.[ds_mappings_PurchaseUnit_IPM_Outpatients_RC]
                ON ds_mappings_PurchaseUnit_IPM_Outpatients_RC.admin_category_reference_no = s_outpatient_appointment_10.admin_category_reference_no
               AND ds_mappings_PurchaseUnit_IPM_Outpatients_RC.booking_type_reference_no = s_outpatient_appointment_10.booking_type_reference_no
               AND ds_mappings_PurchaseUnit_IPM_Outpatients_RC.service_point_reference_no = s_outpatient_appointment_10.outpatient_clinic_reference_no
               AND IFNULL(ds_mappings_PurchaseUnit_IPM_Outpatients_RC.primary_procedure_reference_no,-1) = IFNULL(s_outpatient_appointment_10.primary_procedure_reference_no,-1)
               AND IFNULL(ds_mappings_PurchaseUnit_IPM_Outpatients_RC.secondary_procedure_reference_no,-1) = IFNULL(s_outpatient_appointment_10.secondary_procedure_reference_no,-1) -- AND ds_mappings_PurchaseUnit_IPM_Outpatients_RC.health_specialty_code = s_outpatient_appointment_10.outpatient_health_specialty_code  AND ds_mappings_PurchaseUnit_IPM_Outpatients_RC.specialty_reference_no = IFNULL(s_outpatient_appointment_10.outpatient_specialty_reference_no,dim_outpatient_clinic.specialty_reference_no)  --AND ds_mappings_PurchaseUnit_IPM_Outpatients_RC.specialty_reference_no = s_outpatient_appointment_10.outpatient_specialty_reference_no    AND ds_mappings_PurchaseUnit_IPM_Outpatients_RC.visit_type_reference_no = s_outpatient_appointment_10.visit_type_reference_no    AND ds_mappings_PurchaseUnit_IPM_Outpatients_RC.provider_type_reference_no = s_healthcare_professional.healthcare_professional_type_reference_no    AND ds_mappings_PurchaseUnit_IPM_Outpatients_RC.professional_carer_reference_no = IFNULL(s_outpatient_appointment_10.appointed_clinician_reference_no,s_outpatient_appointment_10.parent_appointed_clinician_reference_no)    AND IFNULL(ds_mappings_PurchaseUnit_IPM_Outpatients_RC.referral_reason_reference_no,-1) = IFNULL(ds_shared_referral.reasn_refno,-1)    AND IFNULL(ds_mappings_PurchaseUnit_IPM_Outpatients_RC.primary_diagnosis_reference_no,-1) = IFNULL(
        name: S_OUTPATIENT_APPOINTMENT_20
        noLinkRefs: []
  name: S_OUTPATIENT_APPOINTMENT_20
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
