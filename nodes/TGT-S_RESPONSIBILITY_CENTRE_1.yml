fileVersion: 1
id: bc6807c7-48cb-4166-971a-2001e2ddca25
name: S_RESPONSIBILITY_CENTRE_1
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Responsibility Centre stage table 1"
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a75a5e0-df96-43a1-acfb-b19f7da137fe
          stepCounter: bc6807c7-48cb-4166-971a-2001e2ddca25
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: RC Hierarchy Level Number
        name: RC_HIERARCHY_LEVEL_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5cc182eb-3d86-4451-910d-97567bfad528
                stepCounter: a6685900-7c8f-4342-93c8-c18f2a128717
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d346e51-7717-4bd2-8f0b-aa02b23bcb46
          stepCounter: bc6807c7-48cb-4166-971a-2001e2ddca25
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: RC Hierarchy Level Name
        name: RC_HIERARCHY_LEVEL_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE l_reference_responsibility_centres.level
                          WHEN 1                                   THEN 'Organisation'
                          WHEN 2                                   THEN 'Provider-Funder'
                          WHEN 3                                   THEN 'Operation Group'
                          WHEN 4                                   THEN 'Service'
                          WHEN 5                                   THEN 'Service Unit'
                          WHEN 6                                   THEN 'Responsibility Centre Code'
                          WHEN 7                                   THEN 'Responsibility Centre Description'
                          ELSE 'Undefined'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3cdd3fdd-e0e2-461b-9ac2-435e91eb9f9b
          stepCounter: bc6807c7-48cb-4166-971a-2001e2ddca25
        config: {}
        dataType: HIERARCHYID
        defaultValue: ""
        description: RC Hierarchy Node Id
        name: RC_HIERARCHY_NODE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb8222bc-d776-433c-81b5-fbf724caaaf6
                stepCounter: a6685900-7c8f-4342-93c8-c18f2a128717
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7bf52f53-e70e-4698-9986-f2401ebb510f
          stepCounter: bc6807c7-48cb-4166-971a-2001e2ddca25
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Responsibility Centre Id
        name: RESPONSIBILITY_CENTRE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4d62c43-54a0-4c45-b907-673e83c58f20
                stepCounter: a6685900-7c8f-4342-93c8-c18f2a128717
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c91b9ab1-7a58-4ce8-a122-e132b0d49158
          stepCounter: bc6807c7-48cb-4166-971a-2001e2ddca25
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Responsibility Centre Parent Id
        name: RESPONSIBILITY_CENTRE_PARENT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 74c2fbef-c4db-40ce-9cae-d1e72a4fb823
                stepCounter: a6685900-7c8f-4342-93c8-c18f2a128717
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9d8fbd2-3a11-408d-b2c7-c45b9a2c29f3
          stepCounter: bc6807c7-48cb-4166-971a-2001e2ddca25
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: Company Code
        name: COMPANY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b5d55a1-cd96-4077-8f3f-59ab485ab488
                stepCounter: a6685900-7c8f-4342-93c8-c18f2a128717
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 56e1d5e5-51d5-4706-a94c-4855784a07d2
          stepCounter: bc6807c7-48cb-4166-971a-2001e2ddca25
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: Responsibility Centre Group Code
        name: RESPONSIBILITY_CENTRE_GROUP_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f72c096-c28f-4998-a1cd-28c9f0d88c70
          stepCounter: bc6807c7-48cb-4166-971a-2001e2ddca25
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Responsibility Centre Group Desc
        name: RESPONSIBILITY_CENTRE_GROUP_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8205054-a157-4ab7-b40e-9482d40b4623
          stepCounter: bc6807c7-48cb-4166-971a-2001e2ddca25
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: Responsibility Centre Code
        isBusinessKey: true
        name: RESPONSIBILITY_CENTRE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d02defc1-93c5-4ae6-9276-8375760b04be
                stepCounter: a6685900-7c8f-4342-93c8-c18f2a128717
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a35952f-ad30-4de5-997a-3faf6acd4e69
          stepCounter: bc6807c7-48cb-4166-971a-2001e2ddca25
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Responsibility Centre Description
        name: RESPONSIBILITY_CENTRE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e538e8eb-c777-48d7-a9e8-182dfd36a33b
                stepCounter: a6685900-7c8f-4342-93c8-c18f2a128717
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d237ad27-cf28-4515-a60b-3dc26e63a372
          stepCounter: bc6807c7-48cb-4166-971a-2001e2ddca25
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Responsibility Centre Short Description
        name: RESPONSIBILITY_CENTRE_SHORT_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 669a7dfc-8438-401f-9d9e-ff3792042f2c
                stepCounter: a6685900-7c8f-4342-93c8-c18f2a128717
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e9c9ae4-7342-4aa0-ba40-0754c8e195a4
          stepCounter: bc6807c7-48cb-4166-971a-2001e2ddca25
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Responsibility Centre Alt Desc
        name: RESPONSIBILITY_CENTRE_ALT_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e01c0ea2-4f83-4d0e-bb27-06ac3f4e1982
                stepCounter: a6685900-7c8f-4342-93c8-c18f2a128717
            transform: IFNULL(ffars_desc,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59de1e0a-9bba-4f20-8062-12f957f133e7
          stepCounter: bc6807c7-48cb-4166-971a-2001e2ddca25
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: RC Effective From Date
        name: RC_EFFECTIVE_FROM_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8a8e80c8-57fc-4ee7-9632-61e9ce5b468e
                stepCounter: a6685900-7c8f-4342-93c8-c18f2a128717
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 90937ae1-a0f6-4f34-9105-5396ced0b138
          stepCounter: bc6807c7-48cb-4166-971a-2001e2ddca25
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: RC Effective To Date
        name: RC_EFFECTIVE_TO_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d55b7628-6e50-4b2f-a955-c56cab942f06
                stepCounter: a6685900-7c8f-4342-93c8-c18f2a128717
            transform: IFNULL(enddate,CONVERT(datetime,'20440630'))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5613e933-85d8-4b92-94db-9241a74e2ed8
          stepCounter: bc6807c7-48cb-4166-971a-2001e2ddca25
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: RC New Ind
        name: RC_NEW_IND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed6e7d08-6f1c-46dc-8673-715ecde92d9d
                stepCounter: a6685900-7c8f-4342-93c8-c18f2a128717
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aca287d8-5a3a-41bd-a885-ae1e2baa6378
          stepCounter: bc6807c7-48cb-4166-971a-2001e2ddca25
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: RC Version Number
        name: RC_VERSION_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0fe801ef-3401-45da-bd12-7d2ca2f0fe94
                stepCounter: a6685900-7c8f-4342-93c8-c18f2a128717
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9520265e-4063-439b-9a54-cc20d406a690
          stepCounter: bc6807c7-48cb-4166-971a-2001e2ddca25
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: OldCode
        name: OLDCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3f8926ea-27eb-4b18-a50a-14e73027559c
                stepCounter: a6685900-7c8f-4342-93c8-c18f2a128717
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aedf7f63-e975-4d4c-bf3e-33fd56249988
          stepCounter: bc6807c7-48cb-4166-971a-2001e2ddca25
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: L_REFERENCE_RESPONSIBILITY_CENTRES
        join:
          joinCondition: FROM l_reference_responsibility_centres
        name: S_RESPONSIBILITY_CENTRE_1
        noLinkRefs: []
  name: S_RESPONSIBILITY_CENTRE_1
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
