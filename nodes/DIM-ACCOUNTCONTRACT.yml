fileVersion: 1
id: 147673a3-f209-4d2c-a618-df104f7e91c2
name: ACCOUNTCONTRACT
operation:
  config:
    distinct: true
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DIM
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41c093c8-282d-40aa-b4cd-a42ab0a2f769
          stepCounter: 147673a3-f209-4d2c-a618-df104f7e91c2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        isSurrogateKey: true
        name: ACCOUNTCONTRACTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3ef0008-fef7-4ba8-92a3-ebe610276098
          stepCounter: 147673a3-f209-4d2c-a618-df104f7e91c2
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: CONTRACT_SALESFORCE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8fe9cffe-e7b3-4863-8ec7-df240d35e2de
                stepCounter: 60020837-4bf1-4091-8a6f-ae27608f4230
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4625d6eb-2af4-4447-b06f-ca6b0848b52a
          stepCounter: 147673a3-f209-4d2c-a618-df104f7e91c2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: ACCOUNTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 42cd9710-6035-4a60-9292-10b02e8c8cdd
                stepCounter: 60020837-4bf1-4091-8a6f-ae27608f4230
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aed7826c-f97f-4a08-8a0f-c39f4e1912de
          stepCounter: 147673a3-f209-4d2c-a618-df104f7e91c2
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE PREFERRED NAME (NOT NECESSARILY THE LEGAL NAME) FOR AN ACCOUNT
        name: ACCOUNT_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7a34674-be0b-4d1c-b1e6-1a0234f02474
                stepCounter: 60020837-4bf1-4091-8a6f-ae27608f4230
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b7faff5-6fe8-4fc9-ac2f-745d01ea4616
          stepCounter: 147673a3-f209-4d2c-a618-df104f7e91c2
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CONTRACT_MANAGER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 97c76300-9d53-4d56-b7db-b6c73bc57c24
                stepCounter: 60020837-4bf1-4091-8a6f-ae27608f4230
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c759d0c9-9404-40be-8007-553215e51bc7
          stepCounter: 147673a3-f209-4d2c-a618-df104f7e91c2
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CONTRACT_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e9d01d3-41b9-456b-9fc2-a5fa3846de39
                stepCounter: 60020837-4bf1-4091-8a6f-ae27608f4230
            transform: IFNULL(STAGECONTRACT_ADDKEYS.CONTRACTNUMBER,STAGECONTRACT_ADDKEYS.SALESFORCECONTRACTNUMBER)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 114bb42d-d133-4495-bc76-e043c8ff856b
          stepCounter: 147673a3-f209-4d2c-a618-df104f7e91c2
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CONTRACT_TITLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9de42ba8-be1e-4562-a122-e3034943ebed
                stepCounter: 60020837-4bf1-4091-8a6f-ae27608f4230
            transform: IFNULL(STAGECONTRACT_ADDKEYS.CONTRACTNAME,STAGECONTRACT_ADDKEYS.PPACONTRACTTITLE) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 679cd755-9ca1-4964-95c6-88fe6b213a98
          stepCounter: 147673a3-f209-4d2c-a618-df104f7e91c2
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CONTRACT_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2a8fa852-3978-4c11-a64c-ae99c0cc78ea
                stepCounter: 60020837-4bf1-4091-8a6f-ae27608f4230
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f820eee5-a249-4ae7-8746-d1582d5d9d5b
          stepCounter: 147673a3-f209-4d2c-a618-df104f7e91c2
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CONTRACT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb9d5592-6aab-4993-b319-8e0ae4a8d302
                stepCounter: 60020837-4bf1-4091-8a6f-ae27608f4230
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 477853c0-9912-4db4-8f86-56be1f93a389
          stepCounter: 147673a3-f209-4d2c-a618-df104f7e91c2
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CONTRACT_RECORD_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c3023f4-e28e-468e-9ef6-345c94de8808
                stepCounter: 60020837-4bf1-4091-8a6f-ae27608f4230
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7292bf97-a782-46d2-b278-72e14073f7c1
          stepCounter: 147673a3-f209-4d2c-a618-df104f7e91c2
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CONTRACT_PUBLIC_OR_PRIVATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c5df44a-96b2-4c3c-932f-68a75b783188
                stepCounter: 60020837-4bf1-4091-8a6f-ae27608f4230
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 003fd959-2070-4583-85d7-30ef6dca6ac9
          stepCounter: 147673a3-f209-4d2c-a618-df104f7e91c2
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CONTRACT_AWARD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d06da28-48db-4ade-998d-21df00a35ed6
                stepCounter: 60020837-4bf1-4091-8a6f-ae27608f4230
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f539c171-5063-45f9-9410-3a11253e5475
          stepCounter: 147673a3-f209-4d2c-a618-df104f7e91c2
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: IS THE REBATE LANGUAGE FOR CONTRACTS IN THE PARTICIPANT REBATE AGREEMENT RECORD TYPE ONLY.
        name: CONTRACT_REBATE_LANGUAGE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 54c0ae3a-c0b9-4567-bbea-cca445c30df9
                stepCounter: 60020837-4bf1-4091-8a6f-ae27608f4230
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0d31846-2865-414f-bc34-83992ec6ad70
          stepCounter: 147673a3-f209-4d2c-a618-df104f7e91c2
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CONTRACT_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23bee9f7-f3b6-4098-9cbc-81cd643b0957
                stepCounter: 60020837-4bf1-4091-8a6f-ae27608f4230
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 85157006-73a6-4826-96bb-45e8d4d5ef84
          stepCounter: 147673a3-f209-4d2c-a618-df104f7e91c2
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CONTRACT_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c073029d-a793-44ea-8585-68aa91ed6e9c
                stepCounter: 60020837-4bf1-4091-8a6f-ae27608f4230
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a39b2ffe-c1fd-4e60-a2a9-122c900b7df0
          stepCounter: 147673a3-f209-4d2c-a618-df104f7e91c2
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CONTRACT_TERM_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56094d2d-9ed0-4704-a712-5be180bac9f3
                stepCounter: 60020837-4bf1-4091-8a6f-ae27608f4230
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa92e375-4b6a-4f4d-8f0a-82a21786dcfe
          stepCounter: 147673a3-f209-4d2c-a618-df104f7e91c2
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CONTRACT_CREATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47b201a8-a533-4258-a37d-17187d2662fd
                stepCounter: 60020837-4bf1-4091-8a6f-ae27608f4230
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7136fb2-6d53-463d-816a-62ff5816b4d1
          stepCounter: 147673a3-f209-4d2c-a618-df104f7e91c2
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CONTRACT_CREATED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: edbedc10-cce3-477d-9077-57c503a8fab4
                stepCounter: 60020837-4bf1-4091-8a6f-ae27608f4230
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2bebb1b8-69bf-425d-a4d0-bd185620f5e1
          stepCounter: 147673a3-f209-4d2c-a618-df104f7e91c2
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CONTRACT_LAST_MODIFIED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bdc067d3-95f8-439a-a894-bf1088d2ad69
                stepCounter: 60020837-4bf1-4091-8a6f-ae27608f4230
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: edba6d86-692d-40ed-99a5-32e3d01d7628
          stepCounter: 147673a3-f209-4d2c-a618-df104f7e91c2
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CONTRACT_LAST_MODIFIED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5805c1a0-3d68-4ebb-9928-5b7f1dfd18aa
                stepCounter: 60020837-4bf1-4091-8a6f-ae27608f4230
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c988f557-3b94-4066-92b7-fee56cab6290
          stepCounter: 147673a3-f209-4d2c-a618-df104f7e91c2
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0abe2088-bd4d-4d23-ae27-00ced318f8d3
          stepCounter: 147673a3-f209-4d2c-a618-df104f7e91c2
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_CONTRACT_ADDKEYS: 60020837-4bf1-4091-8a6f-ae27608f4230
          ACCOUNT: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: STAGE
            nodeName: STAGE_CONTRACT_ADDKEYS
          - locationName: DIM
            nodeName: ACCOUNT
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','STAGE_CONTRACT_ADDKEYS') }} STAGE_CONTRACT_ADDKEYS
              LEFT JOIN {{ ref('DIM','ACCOUNT') }} ACCOUNT
                ON STAGE_CONTRACT_ADDKEYS.CONTRACTACCOUNTID = ACCOUNT.SALESFORCEID
             WHERE STAGE_CONTRACT_ADDKEYS.ACCOUNTKEY>0
        name: ACCOUNTCONTRACT
        noLinkRefs: []
  name: ACCOUNTCONTRACT
  overrideSQL: false
  schema: ""
  sqlType: Dimension
  type: sql
  version: 1
type: Node
