fileVersion: 1
id: a283a327-cea8-40b2-8acb-19c561fb29da
name: S_CENTRIC_VIEW_USER_IDENTITY_DETAILED_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06d6ce46-a585-460a-a476-cbfb1632740e
          stepCounter: a283a327-cea8-40b2-8acb-19c561fb29da
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: USERIDENTITY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 45209a85-3b20-4f30-ba84-a9410a8c1785
                stepCounter: 7ec3d3e0-9809-4b3a-8962-26004f260272
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc7955ce-6306-48c9-8aac-5bbbfef73ae7
          stepCounter: a283a327-cea8-40b2-8acb-19c561fb29da
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: HEALTHCARE_PROFESSIONAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 95b9c79d-b802-48f2-afa0-003b971ec1e1
                stepCounter: 2b7fcd6a-6a5f-4454-9d5e-f87e946f60fa
            transform: IFNULL(dim_healthcare_professional.healthcare_professional_reference_no,dim_healthcare_professional1.healthcare_professional_reference_no)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 90e7436f-3ad6-4b50-971b-0b0320f8310b
          stepCounter: a283a327-cea8-40b2-8acb-19c561fb29da
        config: {}
        dataType: VARCHAR(16)
        defaultValue: ""
        description: ""
        name: USER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ed68119-222c-4912-8c0c-99117e6f503c
                stepCounter: 7ec3d3e0-9809-4b3a-8962-26004f260272
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e4252b3b-64e9-4257-abeb-d38edb2d4835
          stepCounter: a283a327-cea8-40b2-8acb-19c561fb29da
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_centric_view_user_identity_detailed_10.user_name=dim_first_seenby_clinician.user_name
        name: DIM_FIRST_SEENBY_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: IFNULL(dim_first_seenby_clinician.dim_first_seenby_clinician_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d7f7e85-611d-41bd-8882-1ab05548b22f
          stepCounter: a283a327-cea8-40b2-8acb-19c561fb29da
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: DOMAIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1be6185-01b8-4d03-a980-04c02997060c
                stepCounter: 7ec3d3e0-9809-4b3a-8962-26004f260272
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74e4d871-17e9-4be9-9d3b-303164dcecdd
          stepCounter: a283a327-cea8-40b2-8acb-19c561fb29da
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DATE_UPDATED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 15ca5d2b-4c88-49fd-a15d-72eca9fd38e5
                stepCounter: 7ec3d3e0-9809-4b3a-8962-26004f260272
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 37bc0866-dc2a-4637-8b32-a40a16a46345
          stepCounter: a283a327-cea8-40b2-8acb-19c561fb29da
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TITLE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 287baaa8-7575-43cb-a369-5ee55c310f49
                stepCounter: 7ec3d3e0-9809-4b3a-8962-26004f260272
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b1bd39d-e05a-4c42-974d-5a37f377b270
          stepCounter: a283a327-cea8-40b2-8acb-19c561fb29da
        config: {}
        dataType: NVARCHAR(255)
        defaultValue: ""
        description: ""
        name: TITLE_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ac73e44f-9678-49da-aea2-e3305718618f
                stepCounter: 7ec3d3e0-9809-4b3a-8962-26004f260272
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0208ed22-372e-4b71-80ed-7d3bd8b6e063
          stepCounter: a283a327-cea8-40b2-8acb-19c561fb29da
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ROLE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c51e9696-a52e-4a24-9053-0e944a3f0202
                stepCounter: 7ec3d3e0-9809-4b3a-8962-26004f260272
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0cf11146-6efc-4f83-80aa-3f445867f991
          stepCounter: a283a327-cea8-40b2-8acb-19c561fb29da
        config: {}
        dataType: NVARCHAR(255)
        defaultValue: ""
        description: ""
        name: ROLE_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9e74c371-9b36-4594-addf-e048d1373cd1
                stepCounter: 7ec3d3e0-9809-4b3a-8962-26004f260272
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c72e31e0-a85c-4eb2-b5d8-2ff2a79f5750
          stepCounter: a283a327-cea8-40b2-8acb-19c561fb29da
        config: {}
        dataType: NVARCHAR(100)
        defaultValue: ""
        description: ""
        name: DISCIPLINE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 497981ac-c53e-4253-9d45-8afe7a655298
                stepCounter: 7ec3d3e0-9809-4b3a-8962-26004f260272
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 89f1db89-6e82-4a89-a75b-3e651a88e1a4
          stepCounter: a283a327-cea8-40b2-8acb-19c561fb29da
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SERVICE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fcb37ad8-b0b2-496d-84e0-7a6c853ec5ee
                stepCounter: 7ec3d3e0-9809-4b3a-8962-26004f260272
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae7e71da-87e3-4d5a-8e81-19cb41a7ccb3
          stepCounter: a283a327-cea8-40b2-8acb-19c561fb29da
        config: {}
        dataType: NVARCHAR(255)
        defaultValue: ""
        description: ""
        name: SERVICE_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9cbc0089-1ed5-40e8-a4f2-94bc98b137d5
                stepCounter: 7ec3d3e0-9809-4b3a-8962-26004f260272
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d9b1f07-2779-44e7-ba7b-804a95eebb83
          stepCounter: a283a327-cea8-40b2-8acb-19c561fb29da
        config: {}
        dataType: VARCHAR(256)
        defaultValue: ""
        description: ""
        name: FIRST_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8021f400-fda0-4755-af5e-7d5b0b6788f7
                stepCounter: 7ec3d3e0-9809-4b3a-8962-26004f260272
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 113bbd81-cfc0-46e3-93f6-6cf693051797
          stepCounter: a283a327-cea8-40b2-8acb-19c561fb29da
        config: {}
        dataType: VARCHAR(256)
        defaultValue: ""
        description: ""
        name: LAST_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab7bb990-c528-476d-92f1-6d003c64428e
                stepCounter: 7ec3d3e0-9809-4b3a-8962-26004f260272
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a89aab1-811a-48a1-b08e-307a093d2046
          stepCounter: a283a327-cea8-40b2-8acb-19c561fb29da
        config: {}
        dataType: VARCHAR(256)
        defaultValue: ""
        description: ""
        name: CONTACT_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c016bb64-fcd3-459f-8b25-89755a0cfcf7
                stepCounter: 7ec3d3e0-9809-4b3a-8962-26004f260272
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11b8a082-549f-473c-8f64-3e6542ff85ce
          stepCounter: a283a327-cea8-40b2-8acb-19c561fb29da
        config: {}
        dataType: VARCHAR(256)
        defaultValue: ""
        description: ""
        name: EMPLOYEE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f35e64f3-f576-47d6-a4b3-d1f7834b71d1
                stepCounter: 7ec3d3e0-9809-4b3a-8962-26004f260272
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 73237edf-b2fd-49ef-a4b6-e03a2873334f
          stepCounter: a283a327-cea8-40b2-8acb-19c561fb29da
        config: {}
        dataType: VARCHAR(256)
        defaultValue: ""
        description: ""
        name: REG_BODY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ca42d0ca-5635-4200-b342-afb66026c9d3
                stepCounter: 7ec3d3e0-9809-4b3a-8962-26004f260272
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8eb5a33-b7f8-4021-81be-7acec5310ed6
          stepCounter: a283a327-cea8-40b2-8acb-19c561fb29da
        config: {}
        dataType: VARCHAR(256)
        defaultValue: ""
        description: ""
        name: REG_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c92129b5-b56f-46fe-8e0e-fd7acb47dd50
                stepCounter: 7ec3d3e0-9809-4b3a-8962-26004f260272
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d21e79e0-b8a7-4ee4-ad49-b46a5b9f0cb5
          stepCounter: a283a327-cea8-40b2-8acb-19c561fb29da
        config: {}
        dataType: VARCHAR(256)
        defaultValue: ""
        description: ""
        name: ON_CALL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5472246-2cd0-42d1-b041-7da926ee6fb9
                stepCounter: 7ec3d3e0-9809-4b3a-8962-26004f260272
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70d45fbb-cb49-4b0f-85b7-7c97ced2bde5
          stepCounter: a283a327-cea8-40b2-8acb-19c561fb29da
        config: {}
        dataType: BIT
        defaultValue: ""
        description: ""
        name: IS_SMO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64e086ef-9c6d-48fa-b2fe-d8543e65850f
                stepCounter: 7ec3d3e0-9809-4b3a-8962-26004f260272
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 590645b6-924d-4b03-a4e9-195cf2e33b3c
          stepCounter: a283a327-cea8-40b2-8acb-19c561fb29da
        config: {}
        dataType: BIT
        defaultValue: ""
        description: ""
        name: CAN_USE_AEDO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67fd5752-51c2-43bf-8f2c-0e89aa118554
                stepCounter: 7ec3d3e0-9809-4b3a-8962-26004f260272
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c9e94f6-01ea-44ca-a44b-b6d865982979
          stepCounter: a283a327-cea8-40b2-8acb-19c561fb29da
        config: {}
        dataType: BIT
        defaultValue: ""
        description: ""
        name: CAN_PRESCRIBE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1ca7524-831c-4122-b5eb-3055ff161d3f
                stepCounter: 7ec3d3e0-9809-4b3a-8962-26004f260272
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 293c8cdc-f22e-401c-9f40-aa946170344e
          stepCounter: a283a327-cea8-40b2-8acb-19c561fb29da
        config: {}
        dataType: BIT
        defaultValue: ""
        description: ""
        name: CLINICIAN_ACCESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 036388f2-40af-4505-b65b-f6baedd3ccb7
                stepCounter: 7ec3d3e0-9809-4b3a-8962-26004f260272
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c39d4e8-7ec5-4bca-b2be-dcebc48e3da6
          stepCounter: a283a327-cea8-40b2-8acb-19c561fb29da
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: ""
        name: ACCESS_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab758506-d937-463b-ae2e-11a0834f77fc
                stepCounter: 7ec3d3e0-9809-4b3a-8962-26004f260272
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2c3942b-f676-4527-a842-0e4e09d24c44
          stepCounter: a283a327-cea8-40b2-8acb-19c561fb29da
        config: {}
        dataType: VARCHAR(256)
        defaultValue: ""
        description: ""
        name: TEAM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e388264c-11f7-4325-88b3-470ef47ecb84
                stepCounter: 7ec3d3e0-9809-4b3a-8962-26004f260272
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91b0dc9e-b3e3-4e4c-819b-bff7e178ceaa
          stepCounter: a283a327-cea8-40b2-8acb-19c561fb29da
        config: {}
        dataType: VARCHAR(256)
        defaultValue: ""
        description: ""
        name: USER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b939aade-2df6-4076-b9e7-f622018b61f4
                stepCounter: 7ec3d3e0-9809-4b3a-8962-26004f260272
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5b25f22-3dff-47e9-a5b0-1a935f9a1a10
          stepCounter: a283a327-cea8-40b2-8acb-19c561fb29da
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: s_centric_view_user_identity_detailed_10.user_name=dim_first_seenby_clinician.user_name
        name: SMT_FINALISE_USER_ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bfb9dc8f-2beb-4b6b-b2d7-c5a3a7bbcd01
                stepCounter: 8ca266c0-24ba-48be-a7c0-2aadc70ef16e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7df28ba3-4034-40af-bb0f-cda3e710dd47
          stepCounter: a283a327-cea8-40b2-8acb-19c561fb29da
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: s_centric_view_user_identity_detailed_10.user_name=dim_first_seenby_clinician.user_name
        name: USER_FULL_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a85488b7-94da-46f1-9c5a-7b1c09dfc799
                stepCounter: 8ca266c0-24ba-48be-a7c0-2aadc70ef16e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3815e83-d023-40c7-8553-977340af290e
          stepCounter: a283a327-cea8-40b2-8acb-19c561fb29da
        config: {}
        dataType: VARCHAR(7)
        defaultValue: ""
        description: s_centric_view_user_identity_detailed_10.user_name=dim_first_seenby_clinician.user_name
        name: SOURCE_NAMESPACE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 87321d25-2772-4599-842f-910df45d71c0
                stepCounter: 8ca266c0-24ba-48be-a7c0-2aadc70ef16e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 90873f92-a4fa-49a1-941f-4c21b2b97e9a
          stepCounter: a283a327-cea8-40b2-8acb-19c561fb29da
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: s_centric_view_user_identity_detailed_10.user_name=dim_first_seenby_clinician.user_name
        name: USER_EMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b534902-346c-440a-aa93-79ffcd6b0c14
                stepCounter: 8ca266c0-24ba-48be-a7c0-2aadc70ef16e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0e01140-6d27-488e-b917-36f00f4ff91b
          stepCounter: a283a327-cea8-40b2-8acb-19c561fb29da
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: s_centric_view_user_identity_detailed_10.user_name=dim_first_seenby_clinician.user_name
        name: USER_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b7114ce8-3a93-4f47-834d-4861b47fefd4
                stepCounter: 8ca266c0-24ba-48be-a7c0-2aadc70ef16e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bc01a2d2-406a-4ce9-b1cd-9daf6ec4a823
          stepCounter: a283a327-cea8-40b2-8acb-19c561fb29da
        config: {}
        dataType: INT
        defaultValue: ""
        description: s_centric_view_user_identity_detailed_10.user_name=dim_first_seenby_clinician.user_name
        name: VERSION_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ace5f40-1338-43cb-9ec5-4a1bec578c70
                stepCounter: 8ca266c0-24ba-48be-a7c0-2aadc70ef16e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6c932cb-2350-409d-97d0-5e7b87378428
          stepCounter: a283a327-cea8-40b2-8acb-19c561fb29da
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_centric_view_user_identity_detailed_10.user_name=dim_first_seenby_clinician.user_name
        name: USER_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52fb0017-f2ba-4703-9735-ec477ed0e255
                stepCounter: 8ca266c0-24ba-48be-a7c0-2aadc70ef16e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 986a5ffc-3865-4725-b46e-c9d51e8deae9
          stepCounter: a283a327-cea8-40b2-8acb-19c561fb29da
        config: {}
        dataType: VARCHAR(128)
        defaultValue: ""
        description: s_centric_view_user_identity_detailed_10.user_name=dim_first_seenby_clinician.user_name
        name: USERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 322c4cef-3809-4ee9-ba63-a0c5e3c81374
                stepCounter: 8ca266c0-24ba-48be-a7c0-2aadc70ef16e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96457f3f-703d-4eae-82d2-ddf060f4d9a2
          stepCounter: a283a327-cea8-40b2-8acb-19c561fb29da
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: s_centric_view_user_identity_detailed_10.user_name=dim_first_seenby_clinician.user_name
        name: VALIDITY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fbf3e11d-54d9-4736-9742-1b16825b66e7
                stepCounter: 8ca266c0-24ba-48be-a7c0-2aadc70ef16e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72a366ff-dc10-48cb-b485-5696b8194895
          stepCounter: a283a327-cea8-40b2-8acb-19c561fb29da
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: s_centric_view_user_identity_detailed_10.user_name=dim_first_seenby_clinician.user_name
        name: VALIDITY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b07cde97-3ad5-4444-a85a-bd186f5c4a1a
                stepCounter: 8ca266c0-24ba-48be-a7c0-2aadc70ef16e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0363a545-bb2a-4e54-b30e-be751132d9fd
          stepCounter: a283a327-cea8-40b2-8acb-19c561fb29da
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: min(DateCreated)
        name: START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07fa57dd-1ba9-47a2-b4ad-f990b59ef3d2
          stepCounter: a283a327-cea8-40b2-8acb-19c561fb29da
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: max(DateCreated)
        name: END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 003a752f-fdd7-4b79-9a18-c8bacdd48ff0
          stepCounter: a283a327-cea8-40b2-8acb-19c561fb29da
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: RN
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: row_number () OVER (PARTITION BY l_centric_view_user_identity_detailed.userid ORDER BY l_centric_view_user_identity_detailed.DateUpdated DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7c3354c-df36-4c3e-860b-c9d5b7d51bd4
          stepCounter: a283a327-cea8-40b2-8acb-19c561fb29da
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          L_CENTRIC_VIEW_USER_IDENTITY_DETAILED: 7ec3d3e0-9809-4b3a-8962-26004f260272
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: L_CENTRIC_VIEW_USER_IDENTITY_DETAILED
        join:
          joinCondition: |-
            FROM {{ ref('TGT','L_CENTRIC_VIEW_USER_IDENTITY_DETAILED') }} l_centric_view_user_identity_detailed
              LEFT JOIN dim.dim_first_seenby_clinician
                ON l_centric_view_user_identity_detailed.userid= dim_first_seenby_clinician.user_name
               AND dim_first_seenby_clinician.validity_end_date > getdate()
              LEFT JOIN (SELECT UserIdentityid,
                   min(DateCreated) start_date,
                   max(DateCreated) end_date
              FROM l_centric_UserIdentity_Audit --WHERE UserIdentityid=10019   group by UserIdentityid) l_centric_UserIdentity_Audit  on l_centric_UserIdentity_Audit.UserIdentityid =l_centric_view_user_identity_detailed.UserIdentityid    left join (select clinical_portal_username,healthcare_professional_reference_no,row_number() over(partition by clinical_portal_username order by dss_start_date desc,  dss_end_date desc) rn from dim.dim_healthcare_professional   where 1=1  and dss_current_flag='Y'  )dim_healthcare_professional  on l_centric_view_user_identity_detailed.userid= dim_healthcare_professional.clinical_portal_username  and dim_healthcare_professional.rn=1    left join (select healthcare_professional_fullname,healthcare_professional_reference_no,row_number() over(partition by healthcare_professional_fullname order by dss_start_date desc,    dss_end_date desc) rn from dim.dim_healthcare_professional     where 1=1    and dss_current_flag='Y'    )dim_healthcare_professional1    on dim_first_seenby_clinician.user_full_name= dim_healthcare_professional1.healthcare_professional_fullname    and dim_healthcare_professional1.rn=1  where 1=1
        name: S_CENTRIC_VIEW_USER_IDENTITY_DETAILED_10
        noLinkRefs: []
  name: S_CENTRIC_VIEW_USER_IDENTITY_DETAILED_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
