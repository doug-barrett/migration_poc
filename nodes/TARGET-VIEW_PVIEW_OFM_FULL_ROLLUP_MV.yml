fileVersion: 1
id: 586d4725-62a6-490e-a84b-73c36b98bc67
name: VIEW_PVIEW_OFM_FULL_ROLLUP_MV
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d104080-375e-40c9-b26f-6dae3809fad2
          stepCounter: 586d4725-62a6-490e-a84b-73c36b98bc67
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: SITE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b4bd8ce-88c6-4b3a-a9d0-58aa9aac6d67
                stepCounter: e5728334-2b6e-40fb-ae5e-e78da1de0994
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38ccc011-0c11-4258-8c83-22f5f2babccf
          stepCounter: 586d4725-62a6-490e-a84b-73c36b98bc67
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SITE_UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8b96ba6-fa62-4c0f-b013-fdbeffce9ce2
                stepCounter: 81e6b0b1-1728-45bf-932d-6356544cf13a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b120a9dd-40fb-49b7-8dca-81b9a86e0c51
          stepCounter: 586d4725-62a6-490e-a84b-73c36b98bc67
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: RAW_UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d5e40fd0-90ca-4e1a-af76-c2351d769584
                stepCounter: 81e6b0b1-1728-45bf-932d-6356544cf13a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ef35280-9df4-49e3-a645-9a56e0b7df70
          stepCounter: 586d4725-62a6-490e-a84b-73c36b98bc67
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: PROD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 883278c2-c9fe-40da-a9ff-06574b718c78
                stepCounter: acfa00f8-2a04-428b-95fe-92ae401c3e38
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 600d1c7f-317b-4751-a2c4-ca89bed13624
          stepCounter: 586d4725-62a6-490e-a84b-73c36b98bc67
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2074750-19de-4f74-8818-8d81f35001aa
                stepCounter: acfa00f8-2a04-428b-95fe-92ae401c3e38
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 583cedc5-21f2-418c-a0b1-a900188ca2b1
          stepCounter: 586d4725-62a6-490e-a84b-73c36b98bc67
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: OIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75825876-26fe-4d1e-a0f2-150ccc500e54
                stepCounter: acfa00f8-2a04-428b-95fe-92ae401c3e38
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e01d0e9-28fc-4902-9b48-0394c8ee5386
          stepCounter: 586d4725-62a6-490e-a84b-73c36b98bc67
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: WATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c050bca-b399-4cdf-be8e-a94b81ffca8b
                stepCounter: acfa00f8-2a04-428b-95fe-92ae401c3e38
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8bc73eee-89ef-4961-bd67-1fc13bf105cf
          stepCounter: 586d4725-62a6-490e-a84b-73c36b98bc67
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bdc9ff99-2ae1-4699-8927-8326c247f718
                stepCounter: acfa00f8-2a04-428b-95fe-92ae401c3e38
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9a80670-5eed-4ef4-b855-272666b5a155
          stepCounter: 586d4725-62a6-490e-a84b-73c36b98bc67
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: CONDENSATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 099ba779-d476-495b-a2f6-b68b56bf4570
                stepCounter: acfa00f8-2a04-428b-95fe-92ae401c3e38
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4c2e9ba-6c55-4a1a-b6fa-08dfd6d557ca
          stepCounter: 586d4725-62a6-490e-a84b-73c36b98bc67
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: PDOIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d7210e0-3722-4455-b723-f2b1e381aad8
          stepCounter: 586d4725-62a6-490e-a84b-73c36b98bc67
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: PDWATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c97b613-0304-4aa8-b81a-dc2cdcfd5881
          stepCounter: 586d4725-62a6-490e-a84b-73c36b98bc67
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: PDGAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d9c0b3b-e9e7-4d41-9ae5-33fcbe934f48
          stepCounter: 586d4725-62a6-490e-a84b-73c36b98bc67
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: PDCON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c383bb4c-93c0-43c0-9a45-9437a7444f03
          stepCounter: 586d4725-62a6-490e-a84b-73c36b98bc67
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: INJ_PROD_WATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c0c7076-3308-4af8-a348-4d57d3727289
          stepCounter: 586d4725-62a6-490e-a84b-73c36b98bc67
        config: {}
        dataType: NUMBER(1)
        defaultValue: ""
        description: ""
        name: INJ_SOURCE_WATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54512ad7-aba2-40ad-b8f4-84728ae02486
          stepCounter: 586d4725-62a6-490e-a84b-73c36b98bc67
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: INJ_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 19db7b09-5a07-439e-ada1-17670db863ee
          stepCounter: 586d4725-62a6-490e-a84b-73c36b98bc67
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: TUBING_PRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ee6f2c1-12c9-4465-b37b-154bba143d3c
                stepCounter: 9108fb02-8d09-48b3-ba27-88a8ce494c39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a4744eb-0410-4932-9dff-39bbc1e44889
          stepCounter: 586d4725-62a6-490e-a84b-73c36b98bc67
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: CASING_PRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1cc4c5c0-41bd-4baf-9231-65a7b10166d3
                stepCounter: 9108fb02-8d09-48b3-ba27-88a8ce494c39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a40a7ab2-ae05-4847-bab8-22c320e63617
          stepCounter: 586d4725-62a6-490e-a84b-73c36b98bc67
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: CASING_FLUID_LEVEL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 006faeee-cbb4-4e73-b56b-d37002a64e15
                stepCounter: b76e9fdd-13c2-4431-a7d7-a3691e2e7d6c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9511f01a-fe92-4129-b2dc-9a35d383a1e7
          stepCounter: 586d4725-62a6-490e-a84b-73c36b98bc67
        config: {}
        dataType: NUMBER(2)
        defaultValue: ""
        description: ""
        name: CAL_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 883278c2-c9fe-40da-a9ff-06574b718c78
                stepCounter: acfa00f8-2a04-428b-95fe-92ae401c3e38
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20d4719d-b8f6-4ee0-ac04-054d8959881d
          stepCounter: 586d4725-62a6-490e-a84b-73c36b98bc67
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: BU_SF_ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2461b3f-8900-4460-9da7-dc1b4d0593bc
                stepCounter: a23239e4-617a-4ab9-a42c-1fd9220b7fb3
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_PVIEW_OFM_FULL_ROLLUP_MV: 586d4725-62a6-490e-a84b-73c36b98bc67
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_PVIEW_OFM_FULL_ROLLUP_MV') }} AS SELECT u.keymigrationsource SITE_ID,
                   c.completionname SITE_UWI,
                   c.compida RAW_UWI,
                   a.dttmend PROD_DATE,
                   a.durop * 24 HOURS,
                   a.volnewprodallochcliq OIL,
                   a.volnewprodallocwater WATER,
                   a.volnewprodallocgas GAS,
                   a.volnewprodalloccond CONDENSATE,
                   CASE WHEN a.durop = 0 THEN 0
                        ELSE a.volnewprodallochcliq / a.durop
                         END PDOIL,
                   CASE WHEN a.durop = 0 THEN 0
                        ELSE a.volnewprodallocwater / a.durop
                         END PDWATER,
                   CASE WHEN a.durop = 0 THEN 0
                        ELSE a.volnewprodallocgas / a.durop
                         END PDGAS,
                   CASE WHEN a.durop = 0 THEN 0
                        ELSE a.volnewprodalloccond / a.durop
                         END PDCON,
                   CASE WHEN a.volinjectwater IS NULL THEN 0
                        ELSE a.volinjectwater
                         END INJ_PROD_WATER,
                   0 INJ_SOURCE_WATER,
                   CASE WHEN a.volinjectgas IS NULL THEN 0
                        ELSE a.volinjectgas
                         END INJ_GAS,
                   p.prestub TUBING_PRESS,
                   p.prescas CASING_PRESS,
                   l.jointstofluid CASING_FLUID_LEVEL,
                   day(a.dttmend) CAL_DAYS,
                   WS_EDW.PVIEW_SYSSECURITYTYP_VET_BU_ROLE(h.SYSSECURITYTYP) AS BU_SF_ROLE
              FROM DS_PRODVIEW.PVT_pvunitallocmonth a
             INNER JOIN DS_PRODVIEW.PVT_pvunit u
                ON u.idrec = a.idrecparent
             INNER JOIN DS_PRODVIEW.PVT_pvunitcomp c
                ON c.idrec = a.idreccomp
              LEFT JOIN DS_PRODVIEW.PVT_pvunitcompparam p
                ON p.idrec = a.idrecparam
              LEFT JOIN DS_PRODVIEW.PVT_pvunitcompfluidlevel l
                ON l.idrec = a.idrecfluidlevel
             INNER JOIN DS_PRODVIEW.PVT_pvflownetheader h
                ON h.idflownet = a.idflownet
             WHERE UPPER(h.usertxt2) = 'FRANCE'
        dependencies:
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNIT
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_PVIEW_PVT_PVUNIT') }}
        name: VIEW_PVIEW_OFM_FULL_ROLLUP_MV
        noLinkRefs: []
  name: VIEW_PVIEW_OFM_FULL_ROLLUP_MV
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
