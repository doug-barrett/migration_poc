fileVersion: 1
id: 80c3049f-8835-4b1f-9328-04d4fa6b9ddf
name: VIEW_PVIEW_OFM_FULL_ROLLUP_MV
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 826d16f4-9103-4bef-abee-6ee8eb8db57d
          stepCounter: 80c3049f-8835-4b1f-9328-04d4fa6b9ddf
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: SITE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6080c576-952c-4684-91e6-1e372c19c09d
                stepCounter: d554b1ad-15ef-40f5-8fff-8a730cc8b68e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 794b35b5-de29-4da2-b85f-dcefed3b461c
          stepCounter: 80c3049f-8835-4b1f-9328-04d4fa6b9ddf
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SITE_UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47f8a18b-1555-41b2-9a09-2de136944f7f
                stepCounter: b2609f15-a93c-4c5d-b86e-0898ad7558d0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11aa1d49-480c-4da5-9771-bc7eb442eae3
          stepCounter: 80c3049f-8835-4b1f-9328-04d4fa6b9ddf
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: RAW_UWI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1290f71-9e1a-4a4f-96e7-54d805d250ef
                stepCounter: b2609f15-a93c-4c5d-b86e-0898ad7558d0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d21a6e7-f377-4260-86f8-05dc28961253
          stepCounter: 80c3049f-8835-4b1f-9328-04d4fa6b9ddf
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: PROD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: af2c3c1c-891e-4cce-abc5-4aac164e6d4d
                stepCounter: 2b7597c9-141d-4225-b959-04fb950e44fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d551f0d-b522-4fa6-958f-09e7518b8d1e
          stepCounter: 80c3049f-8835-4b1f-9328-04d4fa6b9ddf
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a392e2cf-c86e-4c61-baa9-c3d127bfac71
                stepCounter: 2b7597c9-141d-4225-b959-04fb950e44fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ace6bff0-e876-4998-8b71-4fc6ad0611a5
          stepCounter: 80c3049f-8835-4b1f-9328-04d4fa6b9ddf
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: OIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9059c589-5724-46f3-b8fa-b033e93bc313
                stepCounter: 2b7597c9-141d-4225-b959-04fb950e44fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0f4c045-2b97-4fba-a63d-0e816fbfdd8e
          stepCounter: 80c3049f-8835-4b1f-9328-04d4fa6b9ddf
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: WATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dad01c04-ad7b-4039-84c1-65f69cff93af
                stepCounter: 2b7597c9-141d-4225-b959-04fb950e44fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1ed3737-2ee9-4a34-8da1-e2d077bc5070
          stepCounter: 80c3049f-8835-4b1f-9328-04d4fa6b9ddf
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4412f92a-ebe1-4607-8c9e-8439b94fd0a0
                stepCounter: 2b7597c9-141d-4225-b959-04fb950e44fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 027e6388-8b81-4fca-90aa-9af538717bbd
          stepCounter: 80c3049f-8835-4b1f-9328-04d4fa6b9ddf
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: CONDENSATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d1ea8f7-9c0b-4875-b0be-056c0cd26d90
                stepCounter: 2b7597c9-141d-4225-b959-04fb950e44fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64bfea25-dec9-48d4-b6a9-4e39b3fe9336
          stepCounter: 80c3049f-8835-4b1f-9328-04d4fa6b9ddf
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: PDOIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8d58ed9-d601-4da5-adcb-0b23b7c72cd1
          stepCounter: 80c3049f-8835-4b1f-9328-04d4fa6b9ddf
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: PDWATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2c3cf80-b6d5-4760-98e2-6e041bfb3ac9
          stepCounter: 80c3049f-8835-4b1f-9328-04d4fa6b9ddf
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: PDGAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b9b42b1-f87a-4cd4-a82e-5ec16713ebc0
          stepCounter: 80c3049f-8835-4b1f-9328-04d4fa6b9ddf
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: PDCON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f1c78bc2-2dce-497e-9a73-eaa3924e65fb
          stepCounter: 80c3049f-8835-4b1f-9328-04d4fa6b9ddf
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: INJ_PROD_WATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e026628-96e8-49e2-9f1c-b2d6ba0a189c
          stepCounter: 80c3049f-8835-4b1f-9328-04d4fa6b9ddf
        config: {}
        dataType: NUMBER(1)
        defaultValue: ""
        description: ""
        name: INJ_SOURCE_WATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d769f73-5cb5-40aa-bdb9-554a0c413dd9
          stepCounter: 80c3049f-8835-4b1f-9328-04d4fa6b9ddf
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: INJ_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 999f9cb1-ab05-41c7-b998-badba3a18be2
          stepCounter: 80c3049f-8835-4b1f-9328-04d4fa6b9ddf
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: TUBING_PRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c10af379-bdbe-42bc-b41b-1fb7bb49e843
                stepCounter: 3c6f5981-3218-423d-b012-74039f0258fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 093b2355-f233-4f8d-a243-f26e6788548f
          stepCounter: 80c3049f-8835-4b1f-9328-04d4fa6b9ddf
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: CASING_PRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f47f5cce-108b-472c-a43a-5bc2d2562aa3
                stepCounter: 3c6f5981-3218-423d-b012-74039f0258fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df7a5405-e0ea-4d89-ba48-0aa470320bc8
          stepCounter: 80c3049f-8835-4b1f-9328-04d4fa6b9ddf
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: CASING_FLUID_LEVEL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bcc0e615-ed25-4200-93e5-01ee581adff2
                stepCounter: 9e06fc76-3384-44e3-a094-eb3f74a386c0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f89b6cb8-dfa6-4bb6-b6af-7d072361aaf4
          stepCounter: 80c3049f-8835-4b1f-9328-04d4fa6b9ddf
        config: {}
        dataType: NUMBER(2)
        defaultValue: ""
        description: ""
        name: CAL_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: af2c3c1c-891e-4cce-abc5-4aac164e6d4d
                stepCounter: 2b7597c9-141d-4225-b959-04fb950e44fb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a908053b-b924-4210-8068-6221a82498b9
          stepCounter: 80c3049f-8835-4b1f-9328-04d4fa6b9ddf
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: BU_SF_ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 748cdf05-5750-44bd-bb7a-77b0769f897d
                stepCounter: bd388a52-3d72-4c70-833d-7de7c6a8abd1
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_PVIEW_OFM_FULL_ROLLUP_MV: 80c3049f-8835-4b1f-9328-04d4fa6b9ddf
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_PVIEW_OFM_FULL_ROLLUP_MV') }} AS SELECT u.keymigrationsource SITE_ID,
                   c.completionname SITE_UWI,
                   c.compida RAW_UWI,
                   a.dttmend PROD_DATE,
                   a.durop * 24 HOURS,
                   a.volnewprodallochcliq OIL,
                   a.volnewprodallocwater WATER,
                   a.volnewprodallocgas GAS,
                   a.volnewprodalloccond CONDENSATE,
                   CASE WHEN a.durop = 0 THEN 0
                        ELSE a.volnewprodallochcliq / a.durop
                         END PDOIL,
                   CASE WHEN a.durop = 0 THEN 0
                        ELSE a.volnewprodallocwater / a.durop
                         END PDWATER,
                   CASE WHEN a.durop = 0 THEN 0
                        ELSE a.volnewprodallocgas / a.durop
                         END PDGAS,
                   CASE WHEN a.durop = 0 THEN 0
                        ELSE a.volnewprodalloccond / a.durop
                         END PDCON,
                   CASE WHEN a.volinjectwater IS NULL THEN 0
                        ELSE a.volinjectwater
                         END INJ_PROD_WATER,
                   0 INJ_SOURCE_WATER,
                   CASE WHEN a.volinjectgas IS NULL THEN 0
                        ELSE a.volinjectgas
                         END INJ_GAS,
                   p.prestub TUBING_PRESS,
                   p.prescas CASING_PRESS,
                   l.jointstofluid CASING_FLUID_LEVEL,
                   day(a.dttmend) CAL_DAYS,
                   WS_EDW.PVIEW_SYSSECURITYTYP_VET_BU_ROLE(h.SYSSECURITYTYP) AS BU_SF_ROLE
              FROM DS_PRODVIEW.PVT_pvunitallocmonth a
             INNER JOIN DS_PRODVIEW.PVT_pvunit u
                ON u.idrec = a.idrecparent
             INNER JOIN DS_PRODVIEW.PVT_pvunitcomp c
                ON c.idrec = a.idreccomp
              LEFT JOIN DS_PRODVIEW.PVT_pvunitcompparam p
                ON p.idrec = a.idrecparam
              LEFT JOIN DS_PRODVIEW.PVT_pvunitcompfluidlevel l
                ON l.idrec = a.idrecfluidlevel
             INNER JOIN DS_PRODVIEW.PVT_pvflownetheader h
                ON h.idflownet = a.idflownet
             WHERE UPPER(h.usertxt2) = 'FRANCE'
        dependencies:
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNIT
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_PVIEW_PVT_PVUNIT') }}
        name: VIEW_PVIEW_OFM_FULL_ROLLUP_MV
        noLinkRefs: []
  name: VIEW_PVIEW_OFM_FULL_ROLLUP_MV
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
