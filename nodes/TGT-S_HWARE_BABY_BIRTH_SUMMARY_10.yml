fileVersion: 1
id: 7f43e1fe-5cb9-4edb-802c-7d797066b8f1
name: S_HWARE_BABY_BIRTH_SUMMARY_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Summarises baby birth event from health ware to match to inpatient events"
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 63756623-7653-4460-b030-27eb29ef345c
          stepCounter: 7f43e1fe-5cb9-4edb-802c-7d797066b8f1
        config: {}
        dataType: NVARCHAR(12)
        defaultValue: ""
        description: ""
        name: BABY_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15dd176c-319c-452f-a171-0856fd8e711a
          stepCounter: 7f43e1fe-5cb9-4edb-802c-7d797066b8f1
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: GESTATION
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ROUND((280 + DATEDIFF(dd, EDD_best_s88, l_hware_labour_and_delivery_baby.Delivery_time)) / 7, 2)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4ba7d11-65b4-4d82-8249-156856b4b1f6
          stepCounter: 7f43e1fe-5cb9-4edb-802c-7d797066b8f1
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: BABY_LAST_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f561c84-eb3b-42e3-8301-5884dc313a3d
          stepCounter: 7f43e1fe-5cb9-4edb-802c-7d797066b8f1
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: BABY_GIVEN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d1f3319-07dc-493d-ae74-75b4db81dc94
          stepCounter: 7f43e1fe-5cb9-4edb-802c-7d797066b8f1
        config: {}
        dataType: NVARCHAR(12)
        defaultValue: ""
        description: ""
        name: MOTHER_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a6dc234-eaf3-4e80-bbce-292cf5751722
          stepCounter: 7f43e1fe-5cb9-4edb-802c-7d797066b8f1
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: BABY_SID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f84d2e5-4219-44fc-b311-7ce895da177d
          stepCounter: 7f43e1fe-5cb9-4edb-802c-7d797066b8f1
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: MOTHER_SID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d306733-b27f-4f39-85dc-ac0fcb96219a
          stepCounter: 7f43e1fe-5cb9-4edb-802c-7d797066b8f1
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: BIRTH_WEIGHT_S88
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 540d1d3a-c9c8-4bed-906b-3e2624f25e78
                stepCounter: 8ad992ce-5191-47ab-b42a-9d73b3bed8db
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69410645-de04-4c62-a0c6-ac3b6f9a3fc2
          stepCounter: 7f43e1fe-5cb9-4edb-802c-7d797066b8f1
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DELIVERY_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5610aad3-ddc5-40bf-8d4f-ac417eda9452
                stepCounter: 52852c74-7696-4b46-a47f-65082dc90399
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3173f360-cad0-46f8-90b3-329b3e153a21
          stepCounter: 7f43e1fe-5cb9-4edb-802c-7d797066b8f1
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: EDD_BEST_S88
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3742aa5a-10c6-4655-bba8-fb8de105856e
                stepCounter: d333693e-f74b-4412-bda8-86f9a1230d0d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d543039b-e67f-4d0d-b335-616be1dff363
          stepCounter: 7f43e1fe-5cb9-4edb-802c-7d797066b8f1
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: inaptient admission relating to the birth event
        name: IP_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 98c9bdfa-1455-4c81-8336-1fc71694c387
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: BABY
        join:
          joinCondition: |-
            FROM [l_hware_Pat] AS mother
             INNER JOIN [l_hware_Pregnancy_episode]
                ON mother.SID = [l_hware_Pregnancy_episode].SID
             INNER JOIN [l_hware_Labour_and_delivery_baby]
                ON [l_hware_Pregnancy_episode].SID = [l_hware_Labour_and_delivery_baby].SID
               AND [l_hware_Pregnancy_episode].EID = [l_hware_Labour_and_delivery_baby].EPI
             INNER JOIN [l_hware_Pat] AS baby
                ON [l_hware_Labour_and_delivery_baby].Baby_NHI = Baby.PatID
             INNER JOIN [l_hware_Birth_exam]
                ON baby.SID = l_hware_Birth_exam.SID
              LEFT JOIN s_in_patient_event_05
                ON baby.patid = s_in_patient_event_05.patient_NHI
               AND l_hware_Labour_and_delivery_baby.delivery_time BETWEEN admit_date AND IFNULL(disch_date,getdate())
             WHERE LEFT(Mother.PatID, 1) <> '#'
        name: S_HWARE_BABY_BIRTH_SUMMARY_10
        noLinkRefs: []
  name: S_HWARE_BABY_BIRTH_SUMMARY_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
