fileVersion: 1
id: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
name: S_CPAC_EVENT_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79e3f1a1-e468-4023-a866-e3459f92e9da
          stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CPAC_EVENT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3086021f-d64a-4da6-a558-056ae4f20c19
                stepCounter: 1343b5a7-50ea-4f52-89e2-52311143b1c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d0bd7a00-d1fc-41a2-896b-c24832511e54
          stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: OVERRIDE_REASON
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98136fb7-6d90-4356-b01e-a467c5af6aca
          stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ADMISSION_SEQ_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ROW_NUMBER() OVER(PARTITION BY nhi ORDER BY created_dttm DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f3e60ddf-f190-4e5d-9549-0d5a52bd7297
          stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ADMISSION_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: COUNT(1) OVER(PARTITION BY nhi)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3cf1751a-951b-42ff-9461-e410f5c12f91
          stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
        config: {}
        dataType: NVARCHAR(10)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79f7dc52-aa49-4e61-9870-b9cbaf4b487d
                stepCounter: 1343b5a7-50ea-4f52-89e2-52311143b1c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c7ccd20-17ad-4644-9cec-61d06223dfd4
          stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: BOOKING_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e72ab77-ae6b-46d3-b3e6-a3ec158106b9
                stepCounter: 1343b5a7-50ea-4f52-89e2-52311143b1c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3889f21-7b26-43b1-a728-c6a2073eeb33
          stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: BOOKING_STATUS_STRING
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 73d8526c-71b1-4a09-96a8-44221c943403
                stepCounter: 1343b5a7-50ea-4f52-89e2-52311143b1c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e4cea539-6b39-4949-bad6-820ba4c0d94a
          stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: CALCULATED_BOOKING_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd38bcac-9d80-44ca-8dff-b9547d303f15
                stepCounter: 1343b5a7-50ea-4f52-89e2-52311143b1c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf85524d-a4b4-429d-9dcd-fec608cadfcb
          stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: CALCULATED_BOOKING_STATUS_STRING
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3363c355-fc65-4fb4-ab2f-a8990c6fa18e
                stepCounter: 1343b5a7-50ea-4f52-89e2-52311143b1c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b5e2388b-d3da-4fe8-a8bb-e097277b3fb4
          stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CLINICALLY_APPROPRIATE_TIME_FRAME_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 076a55d6-0fc3-43d9-8012-58f748ab23f5
                stepCounter: 1343b5a7-50ea-4f52-89e2-52311143b1c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2913014e-89b4-4fb7-87b3-ecd16b46c665
          stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: CLINICIAN_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 85f242d7-c25d-4071-89b4-2c695a24bbec
                stepCounter: 1343b5a7-50ea-4f52-89e2-52311143b1c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 119c265d-d209-4b5c-947b-b670582ff3b5
          stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: IS_DUAL_SCORED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 224b93e0-a879-4d59-a100-187072b6d781
                stepCounter: 1343b5a7-50ea-4f52-89e2-52311143b1c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6e73ac6-4ba6-4508-a605-6a3311fac68b
          stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: IS_OVERRIDABLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 657afcdf-9718-4d60-8572-17ca07d7d97f
                stepCounter: 1343b5a7-50ea-4f52-89e2-52311143b1c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4225063d-c837-47fc-9c2b-090946e84108
          stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: IS_OVERRIDDEN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe3fe462-b06e-493d-a164-34b7e013880c
                stepCounter: 1343b5a7-50ea-4f52-89e2-52311143b1c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: abbaebeb-c7ba-45ea-bbd9-e4597088e800
          stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: CPAC_SCORING_CATEGORY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8238f25e-bc0e-489a-83f1-05c2e7daa7a4
                stepCounter: 1343b5a7-50ea-4f52-89e2-52311143b1c2
            transform: substring(ScoringToolID,charindex('(', [ScoringToolID])+1,charindex(')', [ScoringToolID])-3-charindex('(', [ScoringToolID])+1)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 922ad30b-384b-4fc2-8942-4374c5ed110a
          stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SCORE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9125bc57-5efe-4d72-b20d-2ef9cdbbba0f
                stepCounter: 1343b5a7-50ea-4f52-89e2-52311143b1c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da6e8cb6-f510-4d16-bcdd-f09e0b4f1b0a
          stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: TIME_STAMP_LOCAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3eb8cee9-0166-4a56-b960-99bb2efbf3d4
                stepCounter: 1343b5a7-50ea-4f52-89e2-52311143b1c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8861dda9-1adb-4da2-a09f-5c1233befe4c
          stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: TIME_STAMP_UTC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 29c91d99-5c7b-4b4d-a1b4-720ae8d3623c
                stepCounter: 1343b5a7-50ea-4f52-89e2-52311143b1c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 646f4033-28bd-4cf0-9e3d-ae35d2224bf2
          stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: TOOL_PART
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2511c328-8d70-4644-be72-0b52861c75b7
                stepCounter: 1343b5a7-50ea-4f52-89e2-52311143b1c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6e703f5-4ff0-419c-afae-b6379cdfc142
          stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: CLINICIAN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 800c3cb1-0f19-4dd5-8e73-eaf259626b1b
                stepCounter: 1343b5a7-50ea-4f52-89e2-52311143b1c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a0892ca-a12d-4042-bfa3-090d5ffd350b
          stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SPECIALTY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2f7f674d-5f9b-4f2f-88a0-cb535bd59b98
                stepCounter: 1343b5a7-50ea-4f52-89e2-52311143b1c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0dd48da-e059-45e1-8f04-c6431e034220
          stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TOOL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a99a0de6-2ca3-4af0-9073-f17931ccd268
                stepCounter: 1343b5a7-50ea-4f52-89e2-52311143b1c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1fa5960c-0471-4839-97ad-843359edee21
          stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
        config: {}
        dataType: SMALLDATETIME
        defaultValue: ""
        description: ""
        name: CREATED_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b0369844-cf94-450a-9b6f-f79863b5759a
                stepCounter: 1343b5a7-50ea-4f52-89e2-52311143b1c2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0223aef1-8994-4a18-8939-d2b23f6f4bef
          stepCounter: 7e23a285-13fa-43a3-bcb0-50d2f160ca9b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          L_CPAC_EVENT: 1343b5a7-50ea-4f52-89e2-52311143b1c2
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: L_CPAC_EVENT
        join:
          joinCondition: |-
            FROM {{ ref('TGT','L_CPAC_EVENT') }} l_cpac_event
              LEFT JOIN l_reference_testpatients AS t
                ON l_cpac_event.NHI = t.NMPI
             WHERE t.NMPI IS NULL
               AND l_cpac_event.nhi like '[A-Z][A-Z][A-Z][0-9][0-9][0-9][0-9]'
        name: S_CPAC_EVENT_10
        noLinkRefs: []
  name: S_CPAC_EVENT_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
