fileVersion: 1
id: 98b5c4ee-40a6-4c2e-973c-7500faeb6317
name: AGGACCOUNTCURR12MOSTATS_COPY
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: REPORTS
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96504ac7-4f77-468c-9469-585ef8ea79af
          stepCounter: 98b5c4ee-40a6-4c2e-973c-7500faeb6317
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "StageSalesMerge_AddKeys.OrganizationId=Account.OrganizationId\nStageSalesMerge_AddKeys.ReportingCustomerId=Account.ForceId"
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ACCOUNTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 142e5dc4-d508-469e-862b-8ad4d3c7b053
                stepCounter: c278473c-12f0-41e1-b65b-faa4b3c2a978
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e160ab5-ae93-4447-96e9-a5e0edbf0aef
          stepCounter: 98b5c4ee-40a6-4c2e-973c-7500faeb6317
        config: {}
        dataType: INT
        defaultValue: ""
        description: Number of suppliers used in the most recent 12 month period. The count is based upon the field FinancialReportingSupplierName.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CURR12MONUMOFSUPPLIERSUSED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d4db8c9-7a53-4192-b3af-ef6cf2e4b27a
                stepCounter: a48d4109-5650-474d-a2f0-c43a0593bcac
            transform: COUNT (DISTINCT SupplierId)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f535e9e-50a6-4a61-bc54-4164275c7429
          stepCounter: 98b5c4ee-40a6-4c2e-973c-7500faeb6317
        config: {}
        dataType: INT
        defaultValue: ""
        description: Number of contracts used in the most recent 12 months. Count is based on PPAContractNumber
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CURR12MONUMOFCONTRACTSUSED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4d9b7ac5-95c8-45cd-88a6-206803d1ba22
                stepCounter: a48d4109-5650-474d-a2f0-c43a0593bcac
            transform: COUNT (DISTINCT ContractId)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f71590b9-1c2d-4264-9cf8-26e11a256796
          stepCounter: 98b5c4ee-40a6-4c2e-973c-7500faeb6317
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Last transaction date for account.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CURR12MOLASTTRANSACTIONDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8428ca08-5bf4-4f4f-b6fc-f643a5e9c980
                stepCounter: a48d4109-5650-474d-a2f0-c43a0593bcac
            transform: MAX(TransactionDate)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bbb74f52-d63f-4e48-a834-00e271bac634
          stepCounter: 98b5c4ee-40a6-4c2e-973c-7500faeb6317
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Last transaction date for account.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LASTTRANSACTIONDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e4bcc192-463f-4b5a-8a96-b3c639a87885
                stepCounter: a48d4109-5650-474d-a2f0-c43a0593bcac
            transform: MAX(ReceiptDate)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c67cdda8-787e-4318-821a-c3fba1b6c109
          stepCounter: 98b5c4ee-40a6-4c2e-973c-7500faeb6317
        config: {}
        dataType: INT
        defaultValue: ""
        description: Last transaction date for account.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: MONTHSSINCELASTTRANSACTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e4bcc192-463f-4b5a-8a96-b3c639a87885
                stepCounter: a48d4109-5650-474d-a2f0-c43a0593bcac
            transform: DATEDIFF(MONTH, MAX(TransactionDate), MAX(MaxReceiptDate))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 10d5627d-ebed-496a-b7f2-f15f57995e64
          stepCounter: 98b5c4ee-40a6-4c2e-973c-7500faeb6317
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: Sum of Sales for the last 12 months
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CURR12MOSALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2410812-846e-49a6-8cf0-938dc4d0de17
                stepCounter: a48d4109-5650-474d-a2f0-c43a0593bcac
            transform: SUM(Sales)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ddc21f63-8a2e-4661-b3f7-e6105449dcf3
          stepCounter: 98b5c4ee-40a6-4c2e-973c-7500faeb6317
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: Sum of Revenue for last 12 months
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CURR12MOREVENUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c15a6239-54bc-439b-be0c-970122f29022
                stepCounter: a48d4109-5650-474d-a2f0-c43a0593bcac
            transform: SUM(Revenue)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53c16ebc-216c-48c6-a660-1fa0871195d0
          stepCounter: 98b5c4ee-40a6-4c2e-973c-7500faeb6317
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 73d3da7e-440a-4960-a6b2-23a15be9c8c7
          stepCounter: 98b5c4ee-40a6-4c2e-973c-7500faeb6317
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ACCOUNT: c278473c-12f0-41e1-b65b-faa4b3c2a978
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: FACT
            nodeName: SALESANDREVENUE
        join:
          joinCondition: FROM {{ ref('DIM','ACCOUNT') }}
        name: AGGACCOUNTCURR12MOSTATS_COPY
        noLinkRefs: []
  name: AGGACCOUNTCURR12MOSTATS_COPY
  overrideSQL: false
  schema: ""
  sqlType: Fact
  type: sql
  version: 1
type: Node
