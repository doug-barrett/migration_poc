fileVersion: 1
id: e18448f7-5174-4642-9626-3a7daf279648
name: AGGACCOUNTCURR12MOSTATS_COPY
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: REPORTS
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff2a562e-9c30-4403-8dd9-9ce659618f12
          stepCounter: e18448f7-5174-4642-9626-3a7daf279648
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "StageSalesMerge_AddKeys.OrganizationId=Account.OrganizationId\nStageSalesMerge_AddKeys.ReportingCustomerId=Account.ForceId"
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ACCOUNTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 923f9154-d06b-4433-99fd-95c767283389
                stepCounter: a594f58e-2240-453f-a570-12719830e3d0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 30bcc81d-cea3-41cd-a64c-0d647d67149a
          stepCounter: e18448f7-5174-4642-9626-3a7daf279648
        config: {}
        dataType: INT
        defaultValue: ""
        description: Number of suppliers used in the most recent 12 month period. The count is based upon the field FinancialReportingSupplierName.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CURR12MONUMOFSUPPLIERSUSED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 239237a8-cddb-40c8-8adf-89b0bc5cc6d0
                stepCounter: 79e76231-b280-4362-a8fa-68215a84f788
            transform: COUNT (DISTINCT SupplierId)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9637580a-a8e3-4b63-bc7d-82afcb898dba
          stepCounter: e18448f7-5174-4642-9626-3a7daf279648
        config: {}
        dataType: INT
        defaultValue: ""
        description: Number of contracts used in the most recent 12 months. Count is based on PPAContractNumber
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CURR12MONUMOFCONTRACTSUSED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c2d00818-99e6-4971-8255-693660a1bb28
                stepCounter: 79e76231-b280-4362-a8fa-68215a84f788
            transform: COUNT (DISTINCT ContractId)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0847a4e6-1eb2-4961-aff0-ff985adbbb46
          stepCounter: e18448f7-5174-4642-9626-3a7daf279648
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Last transaction date for account.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CURR12MOLASTTRANSACTIONDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 42e1ad29-8632-489a-befb-2f398f4a9df5
                stepCounter: 79e76231-b280-4362-a8fa-68215a84f788
            transform: MAX(TransactionDate)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 777447f5-9cc7-4da0-a78d-5807051f4dbd
          stepCounter: e18448f7-5174-4642-9626-3a7daf279648
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Last transaction date for account.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LASTTRANSACTIONDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c319f81c-0a11-4cd6-839d-c77c347ff764
                stepCounter: 79e76231-b280-4362-a8fa-68215a84f788
            transform: MAX(ReceiptDate)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21906137-4731-44ec-b2ff-bed877a56ddd
          stepCounter: e18448f7-5174-4642-9626-3a7daf279648
        config: {}
        dataType: INT
        defaultValue: ""
        description: Last transaction date for account.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: MONTHSSINCELASTTRANSACTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c319f81c-0a11-4cd6-839d-c77c347ff764
                stepCounter: 79e76231-b280-4362-a8fa-68215a84f788
            transform: DATEDIFF(MONTH, MAX(TransactionDate), MAX(MaxReceiptDate))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f4394bab-c9c3-46b4-ad50-4750cba31ea8
          stepCounter: e18448f7-5174-4642-9626-3a7daf279648
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: Sum of Sales for the last 12 months
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CURR12MOSALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f4a71e14-54d2-4ee3-88da-c8c95b56c2c7
                stepCounter: 79e76231-b280-4362-a8fa-68215a84f788
            transform: SUM(Sales)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a297da3e-41e7-46db-95d1-1b431261e654
          stepCounter: e18448f7-5174-4642-9626-3a7daf279648
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: Sum of Revenue for last 12 months
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CURR12MOREVENUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2098b7a3-a5c3-4180-b722-2fa84cd3e787
                stepCounter: 79e76231-b280-4362-a8fa-68215a84f788
            transform: SUM(Revenue)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d1716ac-9ff0-42dc-91cf-a290fc175ffc
          stepCounter: e18448f7-5174-4642-9626-3a7daf279648
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: afeb9444-5694-4b94-848c-4ed8d1f85804
          stepCounter: e18448f7-5174-4642-9626-3a7daf279648
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ACCOUNT: a594f58e-2240-453f-a570-12719830e3d0
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: FACT
            nodeName: SALESANDREVENUE
        join:
          joinCondition: FROM {{ ref('DIM','ACCOUNT') }}
        name: AGGACCOUNTCURR12MOSTATS_COPY
        noLinkRefs: []
  name: AGGACCOUNTCURR12MOSTATS_COPY
  overrideSQL: false
  schema: ""
  sqlType: Fact
  type: sql
  version: 1
type: Node
