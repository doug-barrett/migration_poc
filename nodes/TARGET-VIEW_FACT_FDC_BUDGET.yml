fileVersion: 1
id: 2405228b-f300-432d-b51a-70efcb01a966
name: VIEW_FACT_FDC_BUDGET
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: edb4cafd-3201-4151-9d20-02a504ebf2c2
          stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
        config: {}
        dataType: VARCHAR(13)
        defaultValue: ""
        description: ""
        name: ENTITY_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: edb4cafd-3201-4151-9d20-02a504ebf2c2
                stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8ee7af9-9f85-4679-bdae-504174d5bc5f
          stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SCENARIO_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b8ee7af9-9f85-4679-bdae-504174d5bc5f
                stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33dc0241-3e47-4bc4-9be0-cd4a650bbcc8
          stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
        config: {}
        dataType: NUMBER(1)
        defaultValue: ""
        description: ""
        name: GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33dc0241-3e47-4bc4-9be0-cd4a650bbcc8
                stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b59215e0-0418-45b7-a1a2-4b2fc709ba37
          stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: ACTIVITY_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b59215e0-0418-45b7-a1a2-4b2fc709ba37
                stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 131a7824-fa41-4a2b-87bb-bc8c56765865
          stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: ACTIVITY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 131a7824-fa41-4a2b-87bb-bc8c56765865
                stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67805f90-46f9-471d-a2ad-0f7c51b81200
          stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
        config: {}
        dataType: NUMBER(1)
        defaultValue: ""
        description: ""
        name: NORMALIZED_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67805f90-46f9-471d-a2ad-0f7c51b81200
                stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a9bf885-88e2-4413-8bf7-1c2191f58af3
          stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
        config: {}
        dataType: NUMBER(1)
        defaultValue: ""
        description: ""
        name: PRODUCING_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0a9bf885-88e2-4413-8bf7-1c2191f58af3
                stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b404e63f-12f1-4334-b1fa-442ff90e7f38
          stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
        config: {}
        dataType: NUMBER(1)
        defaultValue: ""
        description: ""
        name: ON_PROD_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b404e63f-12f1-4334-b1fa-442ff90e7f38
                stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72bdd088-a171-4abf-bed4-bb29e2fcc61e
          stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72bdd088-a171-4abf-bed4-bb29e2fcc61e
                stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6c5a380-93f2-4a04-810b-a3d1897d6d9d
          stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
        config: {}
        dataType: NUMBER(38,8)
        defaultValue: ""
        description: ""
        name: OIL_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a6c5a380-93f2-4a04-810b-a3d1897d6d9d
                stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa3f980d-93c9-458f-b1d4-419de6d3e62f
          stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: OIL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa3f980d-93c9-458f-b1d4-419de6d3e62f
                stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4565e3ab-86fd-4c96-b197-46806943c022
          stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: OIL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4565e3ab-86fd-4c96-b197-46806943c022
                stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2fe5b20d-3059-434a-8250-255f45468a01
          stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
        config: {}
        dataType: NUMBER(38,8)
        defaultValue: ""
        description: ""
        name: CONDENSATE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2fe5b20d-3059-434a-8250-255f45468a01
                stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11e1ccfc-d830-41c5-991e-c7450946dc73
          stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: CONDENSATE_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11e1ccfc-d830-41c5-991e-c7450946dc73
                stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 676af4a4-02ac-4286-8ca3-1c182492bb00
          stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: CONDENSATE_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 676af4a4-02ac-4286-8ca3-1c182492bb00
                stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 344a65c9-fe00-45ca-b5b9-0a74e4e64cde
          stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
        config: {}
        dataType: NUMBER(38,8)
        defaultValue: ""
        description: ""
        name: NGL_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 344a65c9-fe00-45ca-b5b9-0a74e4e64cde
                stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8cf1d503-e15a-491e-8f3e-2c544f4c46b7
          stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: NGL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8cf1d503-e15a-491e-8f3e-2c544f4c46b7
                stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91332837-1425-4e81-9574-2c97df81f7e3
          stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: NGL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91332837-1425-4e81-9574-2c97df81f7e3
                stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e476de6-fa30-46c0-857e-87608568ec86
          stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
        config: {}
        dataType: NUMBER(38,8)
        defaultValue: ""
        description: ""
        name: GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e476de6-fa30-46c0-857e-87608568ec86
                stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9fa8c50d-3d04-4dd7-8918-b2f39e14182e
          stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: GAS_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9fa8c50d-3d04-4dd7-8918-b2f39e14182e
                stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ecb8852-33f6-4e45-ad0e-5bc93e50d52c
          stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: GAS_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ecb8852-33f6-4e45-ad0e-5bc93e50d52c
                stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 269ab78c-0e5b-4ba0-acf9-1be538adc4c8
          stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: RAW_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 269ab78c-0e5b-4ba0-acf9-1be538adc4c8
                stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e310ade-6523-4abf-879a-510e6d26c1f4
          stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: RAW_GAS_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e310ade-6523-4abf-879a-510e6d26c1f4
                stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aad65f30-e7fe-47fc-a412-d6b9f0292321
          stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: RAW_GAS_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aad65f30-e7fe-47fc-a412-d6b9f0292321
                stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f7556b3-7861-4342-8c1f-0cec9c198182
          stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
        config: {}
        dataType: NUMBER(38,8)
        defaultValue: ""
        description: ""
        name: WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2f7556b3-7861-4342-8c1f-0cec9c198182
                stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d57061c-7bf8-4d6a-9dfe-837f4243d650
          stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: WATER_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8d57061c-7bf8-4d6a-9dfe-837f4243d650
                stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0af16592-8a19-493c-afc6-5d02d1819e06
          stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: WATER_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0af16592-8a19-493c-afc6-5d02d1819e06
                stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a4be188-a389-4871-a88e-67c33e5a8616
          stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
        config: {}
        dataType: NUMBER(38,8)
        defaultValue: ""
        description: ""
        name: ETHANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a4be188-a389-4871-a88e-67c33e5a8616
                stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0ec29e5-61e1-424c-b1f7-ccc58a29015b
          stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: ETHANE_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e0ec29e5-61e1-424c-b1f7-ccc58a29015b
                stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 154254a5-f069-4c6e-8302-88aef59e3f67
          stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: ETHANE_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 154254a5-f069-4c6e-8302-88aef59e3f67
                stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40894585-bdc3-428c-81d4-27d64a6c464c
          stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
        config: {}
        dataType: NUMBER(38,8)
        defaultValue: ""
        description: ""
        name: PROPANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 40894585-bdc3-428c-81d4-27d64a6c464c
                stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc414b00-4ebf-47a0-a096-28e125e65081
          stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: PROPANE_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cc414b00-4ebf-47a0-a096-28e125e65081
                stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e8a38b0-e049-460b-8fa6-e4038d0adcc6
          stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: PROPANE_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e8a38b0-e049-460b-8fa6-e4038d0adcc6
                stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 84a034f5-be77-4a0c-8e94-a606b410e2fa
          stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
        config: {}
        dataType: NUMBER(38,8)
        defaultValue: ""
        description: ""
        name: BUTANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84a034f5-be77-4a0c-8e94-a606b410e2fa
                stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6261dd75-d70e-4267-a1d3-d438423f2305
          stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: BUTANE_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6261dd75-d70e-4267-a1d3-d438423f2305
                stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 278c4ce7-39c0-4e2a-9f9d-c8c0dd575f3a
          stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: BUTANE_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 278c4ce7-39c0-4e2a-9f9d-c8c0dd575f3a
                stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1554b9cf-8985-48a4-a16d-012ca80190c5
          stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
        config: {}
        dataType: NUMBER(38,8)
        defaultValue: ""
        description: ""
        name: PENTANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1554b9cf-8985-48a4-a16d-012ca80190c5
                stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 506d3003-9b62-451c-8510-978b559f5293
          stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: PENTANE_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 506d3003-9b62-451c-8510-978b559f5293
                stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 84fd7d75-a0b4-420f-842d-c5c4676bf3b5
          stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
        config: {}
        dataType: NUMBER(38,12)
        defaultValue: ""
        description: ""
        name: PENTANE_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84fd7d75-a0b4-420f-842d-c5c4676bf3b5
                stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 10ad64d4-af7f-422a-a5e5-0990589ab518
          stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: COMMENT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 10ad64d4-af7f-422a-a5e5-0990589ab518
                stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bfca92fd-82b1-4aeb-8950-2e5e9ad4f05a
          stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bfca92fd-82b1-4aeb-8950-2e5e9ad4f05a
                stepCounter: 2405228b-f300-432d-b51a-70efcb01a966
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_FACT_FDC_BUDGET: 2405228b-f300-432d-b51a-70efcb01a966
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_FACT_FDC_BUDGET') }} AS -- DAILY VALUES
            SELECT CASE WHEN CC_NUM IS NULL THEN '-1'
                        ELSE 'CC-' || CC_NUM
                         END AS ENTITY_KEY,
                   CAST(SCENARIO_KEY AS VARCHAR(50)) AS SCENARIO_KEY,
                   GROSS_NET_KEY,
                   ACTIVITY_DATE_KEY,
                   FULL_DATE AS ACTIVITY_DATE, - 1 AS NORMALIZED_DATE_KEY, - 1 AS PRODUCING_DATE_KEY,
                   TO_VARCHAR(ON_PROD_DATE, 'YYYYMMDD') AS ON_PROD_DATE_KEY,
                   CC_NUM AS CC_NUM,
                   SUM("'OIL'") AS OIL_METRIC,
                   SUM("'OIL'") * OIL_SI_TO_IMP_RATE AS OIL_IMPERIAL,
                   SUM("'OIL'") * OIL_SI_TO_IMP_RATE AS OIL_BOE,
                   SUM("'CON'") AS CONDENSATE_METRIC,
                   SUM("'CON'") * OIL_SI_TO_IMP_RATE AS CONDENSATE_IMPERIAL,
                   SUM("'CON'") * OIL_SI_TO_IMP_RATE AS CONDENSATE_BOE,
                   SUM("'NGL'") AS NGL_METRIC,
                   SUM("'NGL'") * NGL_SI_TO_IMP_RATE AS NGL_IMPERIAL,
                   SUM("'NGL'") * NGL_SI_TO_IMP_RATE AS NGL_BOE,
                   SUM("'GAS'") AS GAS_METRIC,
                   SUM("'GAS'") * GAS_SI_TO_IMP_RATE AS GAS_IMPERIAL,
                   SUM("'GAS'") * GAS_BOE_THERMAL_RATE AS GAS_BOE,
                   NULL AS RAW_GAS_METRIC,
                   NULL AS RAW_GAS_IMPERIAL,
                   NULL AS RAW_GAS_BOE,
                   SUM("'WAT'") AS WATER_METRIC,
                   SUM("'WAT'") * OIL_SI_TO_IMP_RATE AS WATER_IMPERIAL,
                   SUM("'WAT'") * OIL_SI_TO_IMP_RATE AS WATER_BOE,
                   SUM("'ETH'") AS ETHANE_METRIC,
                   SUM("'ETH'") * NGL_SI_TO_IMP_RATE AS ETHANE_IMPERIAL,
                   SUM("'ETH'") * NGL_SI_TO_IMP_RATE AS ETHANE_BOE,
                   SUM("'PRO'") AS PROPANE_METRIC,
                   SUM("'PRO'") * NGL_SI_TO_IMP_RATE AS PROPANE_IMPERIAL,
                   SUM("'PRO'") * NGL_SI_TO_IMP_RATE AS PROPANE_BOE,
                   SUM("'BUT'") AS BUTANE_METRIC,
                   SUM("'BUT'") * NGL_SI_TO_IMP_RATE AS BUTANE_IMPERIAL,
                   SUM("'BUT'") * NGL_SI_TO_IMP_RATE AS BUTANE_BOE,
                   SUM("'PEN'") AS PENTANE_METRIC,
                   SUM("'PEN'") * NGL_SI_TO_IMP_RATE AS PENTANE_IMPERIAL,
                   SUM("'PEN'") * NGL_SI_TO_IMP_RATE AS PENTANE_BOE,
                   NULL AS COMMENT_TYPE,
                   NULL AS COMMENT
              FROM(
                    SELECT *
                      FROM (
                            SELECT D.ACTIVITY_DATE_KEY,
                                   F.DIM_COST_CENTER_KEY,
                                   A.PROD_CODE,
                                   D.FULL_DATE,
                                   F.DIM_BUDGET_VERSION_KEY AS SCENARIO_KEY,
                                   D.NUM_OF_DAYS,
                                   CASE WHEN F.GROSS_OR_NET_CODE = 'G' THEN 1
                                        ELSE 2
                                         END AS GROSS_NET_KEY,
                                   SUM(F.LI_VOL_M3) * -1 / NUM_OF_DAYS AS VOL,
                                   CC.CC_NUM AS CC_NUM,
                                   W.ON_PROD_DATE
                              FROM WS_EDW.FACT_LO_SAP_BUDGET F
                              JOIN WS_EDW.DIM_LO_SAP_GL_ACCOUNT A
                                ON F.DIM_GL_ACCOUNT_KEY = A.DIM_GL_ACCOUNT_KEY
                              JOIN WS_EDW.DIM_LO_SAP_COST_CENTER CC
                                ON F.DIM_COST_CENTER_KEY = CC.DIM_COST_CENTER_KEY
                              JOIN WS_EDW.DIM_LO_SAP_PRODUCT_TYPE PROD
                                ON A.PROD_CODE = PROD.PROD_CODE
                              JOIN (
                                    SELECT DIM_ACTIVITY_PERIOD_DATE_KEY AS ACTIVITY_DATE_KEY,
                                           FULL_DATE,
                                           TO_CHAR(DATE_TRUNC(MONTH, FULL_DATE), 'YYYYMMDD') AS FIRST_DATE_KEY,
                                           TO_NUMBER(DAY(LAST_DAY(FULL_DATE))) AS NUM_OF_DAYS
                                      FROM WS_EDW.DIM_FDC_ACTIVITY_PERIOD_DATE
                                   ) D
                                ON TO_CHAR(DATE_TRUNC(MONTH, F.DIM_ACTVY_PER_DATE), 'YYYYMMDD') = D.FIRST_DATE_KEY
                              LEFT JOIN WS_EDW.DIM_FDC_WELL W
                                ON CC.UWI = W.UWI
                               AND W.SOURCE = 'PRODVIEW'
                             WHERE NVL(F.LI_VOL, 0) != 0
                             GROUP BY F.DIM_ACTVY_PER_DATE_KEY,
                                      F.DIM_COST_CENTER_KEY,
                                      A.PROD_CODE,
                                      D.ACTIVITY_DATE_KEY,
                                      D.FULL_DATE,
                                      D.NUM_OF_DAYS,
                                      F.GROSS_OR_NET_CODE,
                                      CC.CC_NUM,
                                      F.DIM_BUDGET_VERSION_KEY,
                                      W.ON_PROD_DATE
                           ) ACT PIVOT(SUM(VOL) FOR PROD_CODE IN ('GAS', 'NGL', 'CON', 'OIL', 'PEN', 'PRO', 'BUT', 'WAT', 'ETH')) AS PVT
                   ) SRC
              JOIN (
                    SELECT *
                      FROM WS_STAGE_BT.STAGE_QBYTE_PRODUCTS
                   ) CF
                ON 1 = 1
             GROUP BY CC_NUM,
                      SCENARIO_KEY,
                      GROSS_NET_KEY,
                      ACTIVITY_DATE_KEY,
                      ON_PROD_DATE,
                      FULL_DATE,
                      NGL_SI_TO_IMP_RATE,
                      GAS_SI_TO_IMP_RATE,
                      GAS_BOE_THERMAL_RATE,
                      OIL_SI_TO_IMP_RATE
        dependencies:
          - locationName: TARGET
            nodeName: VIEW_FACT_FDC_BUDGET
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','VIEW_FACT_FDC_BUDGET') }}
        name: VIEW_FACT_FDC_BUDGET
        noLinkRefs: []
  name: VIEW_FACT_FDC_BUDGET
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
