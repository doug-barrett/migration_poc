fileVersion: 1
id: 9c387db6-c6b3-4d56-a117-02ca7b4183d3
name: STAGE_LO_SAP_15A
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce136df7-b67d-4438-9a85-d36ee5a29166
          stepCounter: 9c387db6-c6b3-4d56-a117-02ca7b4183d3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEDGER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a25f1320-04c1-4195-83b0-50ce0e1dd9ae
                stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57addd33-aee5-45a6-9a7c-f5cc8ead9831
          stepCounter: 9c387db6-c6b3-4d56-a117-02ca7b4183d3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACTVY_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b0f22ba-a334-46c3-90b8-9090c6ab9f7e
                stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 101ab02f-d2eb-4d38-9118-b87e6ce2c0d1
          stepCounter: 9c387db6-c6b3-4d56-a117-02ca7b4183d3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACCT_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0eab9d81-c65b-4449-aeae-ec07d2e01e0b
                stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a6c5a7f-b762-48ad-9c82-483a717e1984
          stepCounter: 9c387db6-c6b3-4d56-a117-02ca7b4183d3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_COST_CENTER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6247bfc9-4073-4c6e-b9a3-e16acb859943
                stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9e01ba3-e0a0-4990-95f9-61e87edcc975
          stepCounter: 9c387db6-c6b3-4d56-a117-02ca7b4183d3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bba168a8-e08f-456b-b58d-c18325b3edb8
          stepCounter: 9c387db6-c6b3-4d56-a117-02ca7b4183d3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_DEST_ORGANIZATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: be907ce7-6f60-455d-8139-e022112cf81c
                stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fcb8f0f6-f6db-4d62-b6ae-f90cff4a8bad
          stepCounter: 9c387db6-c6b3-4d56-a117-02ca7b4183d3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GL_ACCOUNT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39e08de9-6416-4abb-b3dd-5c47ac27574e
          stepCounter: 9c387db6-c6b3-4d56-a117-02ca7b4183d3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 96314d4e-38c1-4642-972d-0174f4208ace
                stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c7587ea-22d0-4bff-8ab8-48dd4cb2762c
          stepCounter: 9c387db6-c6b3-4d56-a117-02ca7b4183d3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_HIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03094dcc-28c0-4fee-b106-8de0eba3539c
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 83bcde4c-e4ca-480f-8d81-82f0b71e3b11
          stepCounter: 9c387db6-c6b3-4d56-a117-02ca7b4183d3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_VERSION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8a3d0d93-b6c5-45e3-ab16-15e854989f29
                stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 927d97ed-12b4-4ffc-b9af-a2153e71810a
          stepCounter: 9c387db6-c6b3-4d56-a117-02ca7b4183d3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LINE_ITEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e209dec-083b-40ea-af4f-2b02f0c5d1cb
          stepCounter: 9c387db6-c6b3-4d56-a117-02ca7b4183d3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_VOUCHER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef8313c5-6c1e-4b8e-ad43-5c88788cef04
          stepCounter: 9c387db6-c6b3-4d56-a117-02ca7b4183d3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d52e93c8-3d2d-4b99-938a-3c2e53f1f071
          stepCounter: 9c387db6-c6b3-4d56-a117-02ca7b4183d3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_INVOICE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 65118823-5791-4630-9598-7054ab126396
          stepCounter: 9c387db6-c6b3-4d56-a117-02ca7b4183d3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_PRODUCT_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0a5d447-ee71-4958-9725-7159bae190d3
          stepCounter: 9c387db6-c6b3-4d56-a117-02ca7b4183d3
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3f84c21-4ee9-4cae-88e0-9ce9656d3204
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20d13c31-9f0a-405a-991e-7377b7565e5c
          stepCounter: 9c387db6-c6b3-4d56-a117-02ca7b4183d3
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a4a6bfde-8ebc-42af-a4c7-210e8a7cc8b3
          stepCounter: 9c387db6-c6b3-4d56-a117-02ca7b4183d3
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38ef8264-4482-47f5-a142-44e32f1bcedf
          stepCounter: 9c387db6-c6b3-4d56-a117-02ca7b4183d3
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: 'Gross Line Item Net Op Amount '
        name: NET_OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 470a38f4-93f2-4804-aaa0-b7af1f648b86
          stepCounter: 9c387db6-c6b3-4d56-a117-02ca7b4183d3
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: LI_VOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2b672022-bcef-47cd-9532-1043ad7371da
                stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
            transform: SUM(DECODE(STAGE_LO_SAP_15.LINE_NO, '15.2',STAGE_LO_SAP_15.LI_VOL, -STAGE_LO_SAP_15.LI_VOL))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea6059e5-c824-4705-a355-4c8882ba4961
          stepCounter: 9c387db6-c6b3-4d56-a117-02ca7b4183d3
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in cubic meters (m3)
        name: LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 17bf2517-0733-4980-ac47-9105cf9fbffc
                stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
            transform: SUM(DECODE(STAGE_LO_SAP_15.LINE_NO, '15.2',STAGE_LO_SAP_15.LI_VOL_M3, -STAGE_LO_SAP_15.LI_VOL_M3))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3b3f60d-af42-4ce2-af3e-32da75a70bdb
          stepCounter: 9c387db6-c6b3-4d56-a117-02ca7b4183d3
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in imperial measurement
        name: LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a0667a1-803e-410b-b330-7ac1d219886b
                stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
            transform: SUM(DECODE(STAGE_LO_SAP_15.LINE_NO, '15.2',STAGE_LO_SAP_15.LI_VOL_IMPERIAL, -STAGE_LO_SAP_15.LI_VOL_IMPERIAL))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb6d74f4-9cd9-42d4-ac2f-9b3ee0dcc1af
          stepCounter: 9c387db6-c6b3-4d56-a117-02ca7b4183d3
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in BOE (Barrel of Oil Equivalent)
        name: LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: def05348-01f9-42cb-a070-ae3675956558
                stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
            transform: SUM(DECODE(STAGE_LO_SAP_15.LINE_NO, '15.2',STAGE_LO_SAP_15.LI_VOL_BOE, -STAGE_LO_SAP_15.LI_VOL_BOE))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59d825e1-7736-4d72-8b87-e308086a8f26
          stepCounter: 9c387db6-c6b3-4d56-a117-02ca7b4183d3
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in normalized cubic meters (nm3)
        name: LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 499a1a63-0cac-41ad-81a8-408887649563
                stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
            transform: SUM(DECODE(STAGE_LO_SAP_15.LINE_NO, '15.2',STAGE_LO_SAP_15.LI_VOL_NM3, -STAGE_LO_SAP_15.LI_VOL_NM3))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5cfb421f-dbfb-4465-9eeb-38262c4920c4
          stepCounter: 9c387db6-c6b3-4d56-a117-02ca7b4183d3
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: ""
        name: EXCHANGE_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2e4f1ee9-966a-48d3-b3fb-25781fd2cc7f
                stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34af85c9-ce87-4e96-a8ec-270e5c3f61b2
          stepCounter: 9c387db6-c6b3-4d56-a117-02ca7b4183d3
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b3d6b9eb-d0d8-4343-ad0e-22e3c0d28e7e
                stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 508b1423-5891-4644-813a-db17aa00f205
          stepCounter: 9c387db6-c6b3-4d56-a117-02ca7b4183d3
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Indicates amounts are gross or net.
        name: GROSS_OR_NET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef8a6afe-85b5-42b9-b4fe-8d1fc5cfc541
                stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea1fb425-afaa-46de-801f-3df3cf15b00a
          stepCounter: 9c387db6-c6b3-4d56-a117-02ca7b4183d3
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: LINE_NO_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4607c855-a49d-4eb4-bbf8-11be2b047885
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64afaf2f-7934-4fc8-988c-bd6b151f5823
          stepCounter: 9c387db6-c6b3-4d56-a117-02ca7b4183d3
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: OP_NONOP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b0c80882-0dab-44bf-9506-16b825b7215a
                stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e089f13e-16ce-4c12-84a0-2ba918c0f7b6
          stepCounter: 9c387db6-c6b3-4d56-a117-02ca7b4183d3
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PROD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_LO_SAP_15: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
          DIM_LO_SAP_LEASE_OPS_HIER: e0b535c4-f94e-4ac1-b685-dfdff6293176
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_15
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_HIER
        join:
          joinCondition: |-
            FROM {{ ref('TARGET','STAGE_LO_SAP_15') }} STAGE_LO_SAP_15
             CROSS JOIN (
                    SELECT DIM_LEASE_OPS_HIER_KEY,
                           LINE_NO,
                           LINE_NO_GROUP
                      FROM {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_HIER') }}
                     WHERE DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO = '15A'
                   ) DIM_LO_SAP_LEASE_OPS_HIER
             WHERE STAGE_LO_SAP_15.LINE_NO IN ('15.2','15.3')
             GROUP BY STAGE_LO_SAP_15.DIM_LEDGER_KEY,
                      STAGE_LO_SAP_15.DIM_ACTVY_PER_DATE_KEY,
                      STAGE_LO_SAP_15.DIM_ACCT_PER_DATE_KEY,
                      STAGE_LO_SAP_15.DIM_COST_CENTER_KEY,
                      STAGE_LO_SAP_15.DIM_DEST_ORGANIZATION_KEY,
                      STAGE_LO_SAP_15.DIM_GROSS_NET_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.DIM_LEASE_OPS_HIER_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO_GROUP,
                      STAGE_LO_SAP_15.DIM_LEASE_OPS_VERSION_KEY,
                      STAGE_LO_SAP_15.EXCHANGE_RATE,
                      STAGE_LO_SAP_15.OP_CURR_CODE,
                      STAGE_LO_SAP_15.GROSS_OR_NET_CODE,
                      STAGE_LO_SAP_15.OP_NONOP
        name: STAGE_LO_SAP_15A
        noLinkRefs: []
  name: STAGE_LO_SAP_15A
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
