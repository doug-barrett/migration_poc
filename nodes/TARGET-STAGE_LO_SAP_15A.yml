fileVersion: 1
id: f83a9760-1bbb-4a44-a7d2-0cdf1547a22f
name: STAGE_LO_SAP_15A
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40e65369-023f-41d1-9616-13a2c4c28278
          stepCounter: f83a9760-1bbb-4a44-a7d2-0cdf1547a22f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEDGER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1db22d5-5e46-4e2c-8d0c-d5bfdf605777
                stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a7755e6-4a56-47d7-9541-6cb648833819
          stepCounter: f83a9760-1bbb-4a44-a7d2-0cdf1547a22f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACTVY_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8193b01f-e40e-4db2-8ff3-c7775b217cb8
                stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 484c6ec4-6008-4bd0-97a2-ba19273f4b4a
          stepCounter: f83a9760-1bbb-4a44-a7d2-0cdf1547a22f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACCT_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d9b308f0-be1b-4a34-9232-5aa003e320eb
                stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e0bf433-b4ab-4e3a-ac3d-921eb034bb32
          stepCounter: f83a9760-1bbb-4a44-a7d2-0cdf1547a22f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_COST_CENTER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03503a7f-e4f0-424d-8af3-434c35b6599b
                stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3021a687-3150-4d25-9117-e90f82efa58a
          stepCounter: f83a9760-1bbb-4a44-a7d2-0cdf1547a22f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 688e2617-5674-43d4-b8f2-36e4789f2124
          stepCounter: f83a9760-1bbb-4a44-a7d2-0cdf1547a22f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_DEST_ORGANIZATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 12c86ebe-b44a-470e-b08d-b175595c14a7
                stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6fea098-7bf8-46b7-ad01-cf9ca66c1a76
          stepCounter: f83a9760-1bbb-4a44-a7d2-0cdf1547a22f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GL_ACCOUNT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21c6f871-ae8c-4a68-8ab7-fa00a82a8b8a
          stepCounter: f83a9760-1bbb-4a44-a7d2-0cdf1547a22f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de3e86c2-c67e-4c1b-b821-a70d916205ab
                stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 10432e48-6ed0-4077-af37-513b8ca824dc
          stepCounter: f83a9760-1bbb-4a44-a7d2-0cdf1547a22f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_HIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21fac97a-151e-4cc2-8783-56a1148d309b
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bed06333-5022-4315-a626-12c16b06d01d
          stepCounter: f83a9760-1bbb-4a44-a7d2-0cdf1547a22f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_VERSION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 20dcf7e7-b707-4054-bfb2-34ced4cc43a4
                stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d7ee500-de3f-4c79-a37e-3ce89aca67e2
          stepCounter: f83a9760-1bbb-4a44-a7d2-0cdf1547a22f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LINE_ITEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1075e26b-ca43-4d5b-85de-27dee16eb151
          stepCounter: f83a9760-1bbb-4a44-a7d2-0cdf1547a22f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_VOUCHER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f402a48-3a1f-4a77-8d77-c514a8ff0d60
          stepCounter: f83a9760-1bbb-4a44-a7d2-0cdf1547a22f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8237e502-029f-41ff-a9f9-3accd7bfaf1f
          stepCounter: f83a9760-1bbb-4a44-a7d2-0cdf1547a22f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_INVOICE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 626a1c4f-d9e9-44a9-b6e4-b1156e4622bd
          stepCounter: f83a9760-1bbb-4a44-a7d2-0cdf1547a22f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_PRODUCT_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9404b216-1f89-41c9-948f-a81ae6cd8d54
          stepCounter: f83a9760-1bbb-4a44-a7d2-0cdf1547a22f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1a83d4b-9af5-4a64-b5b2-f6f811cf7698
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42a0cd03-62cc-4d8a-a07a-7effd1f74c4a
          stepCounter: f83a9760-1bbb-4a44-a7d2-0cdf1547a22f
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fbde51c8-6058-473e-97a9-1af0de7f58a4
          stepCounter: f83a9760-1bbb-4a44-a7d2-0cdf1547a22f
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3819bd0c-5808-4a27-a132-a17c447a4269
          stepCounter: f83a9760-1bbb-4a44-a7d2-0cdf1547a22f
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: 'Gross Line Item Net Op Amount '
        name: NET_OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92b34d29-addc-4615-beb0-ad47f3420568
          stepCounter: f83a9760-1bbb-4a44-a7d2-0cdf1547a22f
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: LI_VOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a5d9a18a-880d-43f1-8836-ccee12626cc3
                stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
            transform: SUM(DECODE(STAGE_LO_SAP_15.LINE_NO, '15.2',STAGE_LO_SAP_15.LI_VOL, -STAGE_LO_SAP_15.LI_VOL))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a63b2f21-4bdd-4bdb-a5a2-ab2e46f041b3
          stepCounter: f83a9760-1bbb-4a44-a7d2-0cdf1547a22f
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in cubic meters (m3)
        name: LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fecb7829-9e41-48de-859d-9e0ddb2be738
                stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
            transform: SUM(DECODE(STAGE_LO_SAP_15.LINE_NO, '15.2',STAGE_LO_SAP_15.LI_VOL_M3, -STAGE_LO_SAP_15.LI_VOL_M3))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac7e5016-1440-413f-a687-6a42b808a0a3
          stepCounter: f83a9760-1bbb-4a44-a7d2-0cdf1547a22f
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in imperial measurement
        name: LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1cd8d772-47c7-46e4-ad7d-fccf00a35696
                stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
            transform: SUM(DECODE(STAGE_LO_SAP_15.LINE_NO, '15.2',STAGE_LO_SAP_15.LI_VOL_IMPERIAL, -STAGE_LO_SAP_15.LI_VOL_IMPERIAL))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5026fd54-b096-4cc3-955f-1822f9748b4e
          stepCounter: f83a9760-1bbb-4a44-a7d2-0cdf1547a22f
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in BOE (Barrel of Oil Equivalent)
        name: LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b3a293af-146f-4106-8c00-7d2b69c45771
                stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
            transform: SUM(DECODE(STAGE_LO_SAP_15.LINE_NO, '15.2',STAGE_LO_SAP_15.LI_VOL_BOE, -STAGE_LO_SAP_15.LI_VOL_BOE))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: faca286c-c78f-4080-9095-e3163b716946
          stepCounter: f83a9760-1bbb-4a44-a7d2-0cdf1547a22f
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in normalized cubic meters (nm3)
        name: LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a36e59dd-8370-4e78-a3e1-7605b892e5ba
                stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
            transform: SUM(DECODE(STAGE_LO_SAP_15.LINE_NO, '15.2',STAGE_LO_SAP_15.LI_VOL_NM3, -STAGE_LO_SAP_15.LI_VOL_NM3))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d5d705d-8a71-4cbc-8dc4-70315bad7bb3
          stepCounter: f83a9760-1bbb-4a44-a7d2-0cdf1547a22f
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: ""
        name: EXCHANGE_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ac47fe4-70bb-4d6d-b8c6-5e0fcbc81f90
                stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f89c51c0-0061-46f0-9e05-895e01057717
          stepCounter: f83a9760-1bbb-4a44-a7d2-0cdf1547a22f
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f25767a-6588-4195-b83e-c23e25573e74
                stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f0eca74-7458-41cd-9081-2ea7735f9e08
          stepCounter: f83a9760-1bbb-4a44-a7d2-0cdf1547a22f
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Indicates amounts are gross or net.
        name: GROSS_OR_NET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 08b2c59f-d0c2-4d83-86b7-2f12ddcd0783
                stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 538da769-d06e-41f9-9920-ac67401638a9
          stepCounter: f83a9760-1bbb-4a44-a7d2-0cdf1547a22f
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: LINE_NO_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4460264-eeac-48f7-bae2-1748cdbcf9cb
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6ddf222-e49f-495d-8984-31400171d8ba
          stepCounter: f83a9760-1bbb-4a44-a7d2-0cdf1547a22f
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: OP_NONOP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19e6aac2-a837-4990-866b-0eea355fbe9d
                stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67fa51da-1d8c-4c89-bd85-bbd8d37b0678
          stepCounter: f83a9760-1bbb-4a44-a7d2-0cdf1547a22f
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PROD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_LO_SAP_15: fe17c64f-c293-4956-b465-84809fca2e22
          DIM_LO_SAP_LEASE_OPS_HIER: 82938641-7c51-4aff-ad3a-c7a56af30c01
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_15
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_HIER
        join:
          joinCondition: |-
            FROM {{ ref('TARGET','STAGE_LO_SAP_15') }} STAGE_LO_SAP_15
             CROSS JOIN (
                    SELECT DIM_LEASE_OPS_HIER_KEY,
                           LINE_NO,
                           LINE_NO_GROUP
                      FROM {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_HIER') }}
                     WHERE DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO = '15A'
                   ) DIM_LO_SAP_LEASE_OPS_HIER
             WHERE STAGE_LO_SAP_15.LINE_NO IN ('15.2','15.3')
             GROUP BY STAGE_LO_SAP_15.DIM_LEDGER_KEY,
                      STAGE_LO_SAP_15.DIM_ACTVY_PER_DATE_KEY,
                      STAGE_LO_SAP_15.DIM_ACCT_PER_DATE_KEY,
                      STAGE_LO_SAP_15.DIM_COST_CENTER_KEY,
                      STAGE_LO_SAP_15.DIM_DEST_ORGANIZATION_KEY,
                      STAGE_LO_SAP_15.DIM_GROSS_NET_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.DIM_LEASE_OPS_HIER_KEY,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO,
                      DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO_GROUP,
                      STAGE_LO_SAP_15.DIM_LEASE_OPS_VERSION_KEY,
                      STAGE_LO_SAP_15.EXCHANGE_RATE,
                      STAGE_LO_SAP_15.OP_CURR_CODE,
                      STAGE_LO_SAP_15.GROSS_OR_NET_CODE,
                      STAGE_LO_SAP_15.OP_NONOP
        name: STAGE_LO_SAP_15A
        noLinkRefs: []
  name: STAGE_LO_SAP_15A
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
