fileVersion: 1
id: 701ce1eb-1c7b-4458-8400-6b7a48465109
name: S_PIMS_PATIENT_ASSESSMENTS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4687552f-c1bb-4543-8dc3-d5581080dfef
          stepCounter: 701ce1eb-1c7b-4458-8400-6b7a48465109
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: PATIENT_ASSESSMENTS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc62803f-3409-49a6-b0d0-0dc764c4e1a5
                stepCounter: d98b3515-26e6-4c2e-906a-1757a7e83db4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3fb50a1f-12e2-4da5-bc01-b89c785cce51
          stepCounter: 701ce1eb-1c7b-4458-8400-6b7a48465109
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c308ea46-4fd6-4f68-93e7-ab9f888e023b
                stepCounter: d98b3515-26e6-4c2e-906a-1757a7e83db4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a0ba7b96-635a-46ba-936e-4b8fe72c97c4
          stepCounter: 701ce1eb-1c7b-4458-8400-6b7a48465109
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cdc420d2-e316-41de-93f1-07a1c477f3d9
                stepCounter: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57a56273-3346-498d-8393-9a3e3488be2f
          stepCounter: 701ce1eb-1c7b-4458-8400-6b7a48465109
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: REFERRAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f498fa62-1e90-479d-9a6a-acb7566b467a
                stepCounter: d98b3515-26e6-4c2e-906a-1757a7e83db4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f800dbc-3d4d-489b-ad9d-c57bb1eba643
          stepCounter: 701ce1eb-1c7b-4458-8400-6b7a48465109
        config: {}
        dataType: VARCHAR(16)
        defaultValue: ""
        description: ""
        name: REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f498fa62-1e90-479d-9a6a-acb7566b467a
                stepCounter: d98b3515-26e6-4c2e-906a-1757a7e83db4
            transform: "'R' + cast(ds_pims_patient_assessments.REFRL_REFNO AS varchar)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69ed1d63-ef8b-4fd2-bf18-8cc61fb5c6ec
          stepCounter: 701ce1eb-1c7b-4458-8400-6b7a48465109
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: PROFESIONAL_CARER_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d17cc4c-5d9b-44cf-9541-8cae45bd7f93
                stepCounter: d98b3515-26e6-4c2e-906a-1757a7e83db4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bbbf24b6-3300-4d9a-aa28-0b34612aab99
          stepCounter: 701ce1eb-1c7b-4458-8400-6b7a48465109
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ASSESSMENT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d291d5a-c3ed-4e0f-acec-c9939e8ccca9
                stepCounter: d98b3515-26e6-4c2e-906a-1757a7e83db4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0b80610-a5c7-4845-92b8-de96774dfe1d
          stepCounter: 701ce1eb-1c7b-4458-8400-6b7a48465109
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: LOCATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c8e1925-ff56-4acf-b10d-f662ade4ad3c
                stepCounter: d98b3515-26e6-4c2e-906a-1757a7e83db4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 549e9f3f-a5e1-4059-ba77-805caf26dcff
          stepCounter: 701ce1eb-1c7b-4458-8400-6b7a48465109
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: LOCATION_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cf37e117-bd41-41f0-8282-675021a46ca3
                stepCounter: d98b3515-26e6-4c2e-906a-1757a7e83db4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce8af99b-ddb6-4034-9969-a0b555746a94
          stepCounter: 701ce1eb-1c7b-4458-8400-6b7a48465109
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LOCATION_HEALTH_ORG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8bbad92c-fa80-4e3f-9885-7922b1f4ea24
                stepCounter: 4dbeb7b4-8557-4965-a256-fab03c67ecf4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 585b50a9-5bbd-48b0-b4b1-65ffccc6e5ba
          stepCounter: 701ce1eb-1c7b-4458-8400-6b7a48465109
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: LOCATION_HEALTH_ORGANISATION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 43539ae5-c3c3-4c09-8966-106fdf3fd63d
                stepCounter: d98b3515-26e6-4c2e-906a-1757a7e83db4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa1c7f08-3fa0-4969-a013-b2e0fd68b3ff
          stepCounter: 701ce1eb-1c7b-4458-8400-6b7a48465109
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_pims_patient_assessments.location_health_organisation_reference_no=dim_health_organisation.health_org_reference_no
        name: DIM_HEALTH_ORG_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78290bb6-3cd5-4503-8179-d1f65525ba15
                stepCounter: 0790fdf4-e815-4587-a9cd-954ea13f53c6
            transform: IFNULL(dim_health_organisation.dim_health_org_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 508b2bd1-915a-435e-829d-289712ab576c
          stepCounter: 701ce1eb-1c7b-4458-8400-6b7a48465109
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: ASSESSMENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c0ab4eb-ec8a-4389-a16f-4a4ac514ac7a
                stepCounter: d98b3515-26e6-4c2e-906a-1757a7e83db4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66a1e707-7975-4c1b-84fb-25e0e5c7b388
          stepCounter: 701ce1eb-1c7b-4458-8400-6b7a48465109
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_pims_patient_assessments.LOTYP_REFNO=dim_location_type.location_type_reference_no
        name: DIM_LOCATION_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f179948f-b577-483b-9219-5236062f466d
                stepCounter: b23344cb-e6bd-4b5a-9000-05243340fe5e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d52623cb-8fc3-43df-bd2a-6a16cabaaa5d
          stepCounter: 701ce1eb-1c7b-4458-8400-6b7a48465109
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_pims_patient_assessments.profesional_carer_reference_no=dim_healthcare_professional.healthcare_professional_reference_no
        name: DIM_HEALTHCARE_PROFESSIONAL_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b3b22451-95b4-47f3-b7c1-48136447e09b
                stepCounter: 2b7fcd6a-6a5f-4454-9d5e-f87e946f60fa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 683638a8-209b-4878-9602-b16024de083e
          stepCounter: 701ce1eb-1c7b-4458-8400-6b7a48465109
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_pims_patient_assessments.patient_reference_no=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9962a01b-5f3d-4c1a-b371-997edef38d0f
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0251b674-8b4a-4ce2-9f0b-8c4c6b91d6c8
          stepCounter: 701ce1eb-1c7b-4458-8400-6b7a48465109
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_ASSESSMENT_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef921611-2c78-4cbb-8447-1d0e322c787d
                stepCounter: c626769f-9349-49e6-8362-0ed3a3608b79
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8756d0a-609f-4f38-958f-6b6ee8ca3e0f
          stepCounter: 701ce1eb-1c7b-4458-8400-6b7a48465109
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DS_PIMS_PATIENT_ASSESSMENTS: d98b3515-26e6-4c2e-906a-1757a7e83db4
          L_PIMS_ASSESSMENTS: 146b999f-eab7-437b-a1bd-a1a616ab1426
          DS_PIMS_REFERENCE_VALUES: 06fa4241-360c-43d0-8e4a-8b860f92fc09
          S_HEALTH_ORG_2: 4dbeb7b4-8557-4965-a256-fab03c67ecf4
          DIM_ASSESSMENT_DATE: c626769f-9349-49e6-8362-0ed3a3608b79
          S_PATIENT_1: 590fceed-a2ea-4910-9a43-8a71b8bd95b7
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_PIMS_PATIENT_ASSESSMENTS
          - locationName: TGT
            nodeName: L_PIMS_ASSESSMENTS
          - locationName: TGT
            nodeName: DS_PIMS_REFERENCE_VALUES
          - locationName: TGT
            nodeName: S_HEALTH_ORG_2
          - locationName: TGT
            nodeName: DIM_ASSESSMENT_DATE
          - locationName: TGT
            nodeName: S_PATIENT_1
        join:
          joinCondition: |-
            FROM {{ ref('TGT','DS_PIMS_PATIENT_ASSESSMENTS') }}
              JOIN {{ ref('TGT','L_PIMS_ASSESSMENTS') }}
                ON ds_pims_patient_assessments.ASSES_REFNO = l_pims_assessments.ASSES_REFNO
              LEFT OUTER JOIN {{ ref('TGT','DS_PIMS_REFERENCE_VALUES') }}
                ON ds_pims_patient_assessments.LOTYP_REFNO = ds_pims_reference_values.rfval_refno
              LEFT OUTER JOIN {{ ref('TGT','S_HEALTH_ORG_2') }}
                ON ds_pims_patient_assessments.LOTYP_HEORG_REFNO = s_health_org_2.health_org_reference_no
              LEFT OUTER JOIN {{ ref('TGT','DIM_ASSESSMENT_DATE') }}
                ON cast(ds_pims_patient_assessments.ASSESS_DTTM AS date) = dim_assessment_date.assessment_calendar_date
              LEFT OUTER JOIN {{ ref('TGT','S_PATIENT_1') }}
                ON ds_pims_patient_assessments.PATNT_REFNO = s_patient_1.patient_reference_no
        name: S_PIMS_PATIENT_ASSESSMENTS
        noLinkRefs: []
  name: S_PIMS_PATIENT_ASSESSMENTS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
