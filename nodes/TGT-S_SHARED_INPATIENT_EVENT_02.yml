fileVersion: 1
id: 2a3b82f3-2367-4939-b85e-6a8241240890
name: S_SHARED_INPATIENT_EVENT_02
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Get details of specialties associated with each event."
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 08098d16-c514-4407-ad42-5d2df1c825c6
          stepCounter: 2a3b82f3-2367-4939-b85e-6a8241240890
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PRVSP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fcb83293-4177-4b5a-b412-5f68e99e5381
                stepCounter: 5874cd83-f58c-44fe-92e0-b83d47d22bab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9834a237-5647-4077-bd26-c817c21d1bfa
          stepCounter: 2a3b82f3-2367-4939-b85e-6a8241240890
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: EVENT_STAY_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce2b81d5-3cf6-43a6-b0bf-184e3981d68e
                stepCounter: 3574e047-03db-4aba-af69-06f8858b99cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6aba43e2-f012-484a-bce2-3dee4d7a213b
          stepCounter: 2a3b82f3-2367-4939-b85e-6a8241240890
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: EVENT_STAY_TOTAL_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c4fb921-43d6-4838-a161-a8cafae8ce6b
                stepCounter: 3574e047-03db-4aba-af69-06f8858b99cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9703ea97-8a05-480b-b411-35d03984f060
          stepCounter: 2a3b82f3-2367-4939-b85e-6a8241240890
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: EVENT_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 929758e5-8bef-4646-a44e-56be06c19e74
                stepCounter: 3574e047-03db-4aba-af69-06f8858b99cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04f4bc14-e53a-459b-a29d-19488d964e73
          stepCounter: 2a3b82f3-2367-4939-b85e-6a8241240890
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: EPISODE_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d6778215-5c9c-43ca-b5fe-709ad49869dc
                stepCounter: 3574e047-03db-4aba-af69-06f8858b99cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03ac8d34-fd6e-4e08-9807-14ab46af9787
          stepCounter: 2a3b82f3-2367-4939-b85e-6a8241240890
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LAST_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d6778215-5c9c-43ca-b5fe-709ad49869dc
                stepCounter: 3574e047-03db-4aba-af69-06f8858b99cd
            transform: COALESCE(ds_shared_inpatient_stay.episode_spect_refno, ds_shared_inpatient_stay.event_spect_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7d99023-91e0-40cb-a020-ce08e643f9f3
          stepCounter: 2a3b82f3-2367-4939-b85e-6a8241240890
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Health Specialty Code
        name: DISCHARGE_HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 567bbd76-4341-4956-be24-c4e752cc1ea9
                stepCounter: 19f323a9-95a3-4efc-bdc1-7adc75cffc2a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc786b93-e13d-48f2-8960-881c2faaee7c
          stepCounter: 2a3b82f3-2367-4939-b85e-6a8241240890
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_SHARED_INPATIENT_EVENT_01
        join:
          joinCondition: |-
            FROM s_shared_inpatient_event_01
              JOIN ds_shared_inpatient_stay
                ON s_shared_inpatient_event_01.prvsp_refno = ds_shared_inpatient_stay.prvsp_refno
              LEFT OUTER JOIN s_specialty_1
                ON ds_shared_inpatient_stay.episode_spect_refno = s_specialty_1.specialty_reference_no
             WHERE s_shared_inpatient_event_01.event_seq_num = 1 -- Prevents duplicated events  AND ds_shared_inpatient_stay.event_stay_seq_num = ds_shared_inpatient_stay.event_stay_count
        name: S_SHARED_INPATIENT_EVENT_02
        noLinkRefs: []
  name: S_SHARED_INPATIENT_EVENT_02
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
