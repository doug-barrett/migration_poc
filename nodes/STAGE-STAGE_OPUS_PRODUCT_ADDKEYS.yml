fileVersion: 1
id: a2c58740-7b75-48de-85cb-8242c33efe65
name: STAGE_OPUS_PRODUCT_ADDKEYS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6bd020cb-8eb3-4c7d-8038-7d8eaa6f9121
          stepCounter: a2c58740-7b75-48de-85cb-8242c33efe65
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEOPUS_PRODUCT_ADDKEYS.SUPPLIERFORCEID=SUPPLIER.SUPPLIERID
        name: SUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2f4e397-bd41-483f-976a-9ed99246bd6e
                stepCounter: 470235be-2b1f-4c18-8481-f03bb4bed667
            transform: COALESCE(SUPPLIER.SUPPLIERKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4b209d0-ef1f-408c-af44-7b2bc820489b
          stepCounter: a2c58740-7b75-48de-85cb-8242c33efe65
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SUPPLIERFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0971a177-9fb3-4639-8d2b-f49f82d6a4c9
                stepCounter: 29cd28a2-5cad-4431-a31a-20a847ec67a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 217c147c-0109-4ce1-b4b6-d98a393d0a36
          stepCounter: a2c58740-7b75-48de-85cb-8242c33efe65
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PRODUCTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d345cb30-bfda-49c9-afdc-30a28ef8dcbe
                stepCounter: 29cd28a2-5cad-4431-a31a-20a847ec67a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b7fbdd0-f964-401b-8c90-f06e89092233
          stepCounter: a2c58740-7b75-48de-85cb-8242c33efe65
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 20e880ba-dc0c-43d4-a27a-58f964b2ca81
                stepCounter: 29cd28a2-5cad-4431-a31a-20a847ec67a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3e43f6b-9bd7-4e6c-9386-3e0efad04350
          stepCounter: a2c58740-7b75-48de-85cb-8242c33efe65
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: SKU
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1410020-db1f-433a-98a6-18a6c47b6831
                stepCounter: 29cd28a2-5cad-4431-a31a-20a847ec67a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 902b64f9-b760-46fb-a67c-82c9223cc17c
          stepCounter: a2c58740-7b75-48de-85cb-8242c33efe65
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c84fd95-38d8-4d6b-96db-499ced26908d
                stepCounter: 29cd28a2-5cad-4431-a31a-20a847ec67a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3314559-79cd-4644-8703-0812141374ab
          stepCounter: a2c58740-7b75-48de-85cb-8242c33efe65
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: IMAGE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec769ac1-dc88-473e-82cf-574a6e4eafc5
                stepCounter: 29cd28a2-5cad-4431-a31a-20a847ec67a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3db4acf4-27aa-4a6b-8586-f805e35c5734
          stepCounter: a2c58740-7b75-48de-85cb-8242c33efe65
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: UNSPC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f243cfd-54d9-4d91-8abc-f75f63e0647a
                stepCounter: 29cd28a2-5cad-4431-a31a-20a847ec67a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d72c906a-178b-4643-90c9-33a19e93309f
          stepCounter: a2c58740-7b75-48de-85cb-8242c33efe65
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: MODIFIEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a9f88ff5-69eb-4120-ac1e-f2fb37994983
                stepCounter: 29cd28a2-5cad-4431-a31a-20a847ec67a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 19b44bcf-66f9-4b6c-9884-862f18985dd1
          stepCounter: a2c58740-7b75-48de-85cb-8242c33efe65
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e619f1e-9dd8-42c1-8b03-3a693db8b890
                stepCounter: 29cd28a2-5cad-4431-a31a-20a847ec67a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a97b84f-83ea-4964-a1f6-daeeb35f7618
          stepCounter: a2c58740-7b75-48de-85cb-8242c33efe65
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LATESTPRODUCT
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ROW_NUMBER() OVER (PARTITION BY LOADOPUS_PRODUCT.SKU ORDER BY LOADOPUS_PRODUCT.MODIFIEDDATE DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 245179fd-aaf9-4952-a7df-1dc7fe6b565d
          stepCounter: a2c58740-7b75-48de-85cb-8242c33efe65
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1245aae8-e70b-48c8-a66e-52106f57d7c2
                stepCounter: 29cd28a2-5cad-4431-a31a-20a847ec67a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 23bdb6b3-3c09-4d11-b176-919eaf34de65
          stepCounter: a2c58740-7b75-48de-85cb-8242c33efe65
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88a20307-2cd1-4ceb-914a-1697f5ad04d3
          stepCounter: a2c58740-7b75-48de-85cb-8242c33efe65
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          SUPPLIER: 470235be-2b1f-4c18-8481-f03bb4bed667
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: SUPPLIER
          - locationName: LOAD
            nodeName: LOAD_OPUS_PRODUCT
          - locationName: UNKNOWN
            nodeName: LOADOPUS_PRODUCT
        join:
          joinCondition: |-
            FROM {{ ref('UNKNOWN','LOADOPUS_PRODUCT') }} LOADOPUS_PRODUCT
              LEFT JOIN {{ ref('DIM','SUPPLIER') }} SUPPLIER
                ON LOADOPUS_PRODUCT.SUPPLIERFORCEID = SUPPLIER.SUPPLIERID
        name: STAGEOPUS_PRODUCT_ADDKEYS
        noLinkRefs: []
  name: STAGE_OPUS_PRODUCT_ADDKEYS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
