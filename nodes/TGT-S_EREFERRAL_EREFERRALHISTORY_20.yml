fileVersion: 1
id: 746fb1b4-9fbf-454c-8b83-4e0d393576cf
name: S_EREFERRAL_EREFERRALHISTORY_20
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Onle first row from when ststus changing first time  first_status_change =1"
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ee2c5af-8943-422f-b645-faf8b13a0ed2
          stepCounter: 746fb1b4-9fbf-454c-8b83-4e0d393576cf
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: EXTERNAL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 790b49c5-ddbd-4340-87dc-a681bd36c4ca
                stepCounter: dd5b66f7-3ac1-46a7-9c48-b1cb63d42993
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48b4806b-b200-4709-a755-2c2c5659b2bd
          stepCounter: 746fb1b4-9fbf-454c-8b83-4e0d393576cf
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: COMPLETE_CYCLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9f45c190-849b-4398-b549-ace4af617e37
                stepCounter: dd5b66f7-3ac1-46a7-9c48-b1cb63d42993
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4831107f-7bbf-4144-b601-776b472ec00c
          stepCounter: 746fb1b4-9fbf-454c-8b83-4e0d393576cf
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64a5294e-1463-4638-a949-55079ec5d12d
                stepCounter: dd5b66f7-3ac1-46a7-9c48-b1cb63d42993
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66ebe220-9e61-4cee-94db-5720c16ff9d3
          stepCounter: 746fb1b4-9fbf-454c-8b83-4e0d393576cf
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SUBMISSION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24966c04-dcd7-40bb-8ed5-7c378e28d4ab
                stepCounter: dd5b66f7-3ac1-46a7-9c48-b1cb63d42993
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41ebfc61-8510-4f84-8333-787d070b66e3
          stepCounter: 746fb1b4-9fbf-454c-8b83-4e0d393576cf
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a043224-b7af-4e85-9926-ef00ac55a719
                stepCounter: dd5b66f7-3ac1-46a7-9c48-b1cb63d42993
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d8f4009-7d07-4bf2-a3c4-fb9ec051f185
          stepCounter: 746fb1b4-9fbf-454c-8b83-4e0d393576cf
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: FIRST_STATUS_CHANGED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 43f2bdd6-f92f-4b85-a523-c2b9b22f2461
                stepCounter: dd5b66f7-3ac1-46a7-9c48-b1cb63d42993
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed1e58a3-a983-4a88-bcb0-f64ffa29dcd3
          stepCounter: 746fb1b4-9fbf-454c-8b83-4e0d393576cf
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: REFERRER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18bb720e-9e7d-42a1-b16a-fd2d3e422289
                stepCounter: dd5b66f7-3ac1-46a7-9c48-b1cb63d42993
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dac577bf-f3ff-4711-831e-ebfa9c00e6f1
          stepCounter: 746fb1b4-9fbf-454c-8b83-4e0d393576cf
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d6b7fe7b-72df-4e10-b27e-706670e4fe81
                stepCounter: dd5b66f7-3ac1-46a7-9c48-b1cb63d42993
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 832c0d44-0def-44e9-b7fa-363cde88dfa9
          stepCounter: 746fb1b4-9fbf-454c-8b83-4e0d393576cf
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: UPDATE_DATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a038dd7c-4cdd-4739-aa5f-6bfdac139b42
                stepCounter: dd5b66f7-3ac1-46a7-9c48-b1cb63d42993
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 254b84e6-765c-4f07-929c-34f9328f68d5
          stepCounter: 746fb1b4-9fbf-454c-8b83-4e0d393576cf
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: HISTORY_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 96a55858-27d4-4327-8d44-75b234bdc13f
                stepCounter: dd5b66f7-3ac1-46a7-9c48-b1cb63d42993
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d567a82e-ca2c-4407-b835-41f2a83ffa2c
          stepCounter: 746fb1b4-9fbf-454c-8b83-4e0d393576cf
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SERVICE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 86b8395a-730f-462f-ad3a-ef8a26b5b6e8
                stepCounter: dd5b66f7-3ac1-46a7-9c48-b1cb63d42993
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba6a39d6-3666-492e-be10-082a70729e78
          stepCounter: 746fb1b4-9fbf-454c-8b83-4e0d393576cf
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: STATUS_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18d2ae4f-c37a-42d0-b30c-df29f269cde0
                stepCounter: dd5b66f7-3ac1-46a7-9c48-b1cb63d42993
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17d6a09f-fbff-4f73-af33-80d50dc763c9
          stepCounter: 746fb1b4-9fbf-454c-8b83-4e0d393576cf
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: REASON_FOR_ACTION_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 715d2fe9-06da-4185-a389-dbb83a951963
                stepCounter: dd5b66f7-3ac1-46a7-9c48-b1cb63d42993
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b235351-ea05-44e9-9e45-0474b5f5613a
          stepCounter: 746fb1b4-9fbf-454c-8b83-4e0d393576cf
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SUBSERVICE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5167a7c6-49b4-44dc-8bd1-6021bae086e6
                stepCounter: dd5b66f7-3ac1-46a7-9c48-b1cb63d42993
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d85aa3d7-5bba-48cf-92de-49d484c3f85e
          stepCounter: 746fb1b4-9fbf-454c-8b83-4e0d393576cf
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_EREFERRAL_EREFERRALHISTORY_10
        join:
          joinCondition: |-
            FROM s_eReferral_eReferralHistory_10
             WHERE first_status_changed=1
        name: S_EREFERRAL_EREFERRALHISTORY_20
        noLinkRefs: []
  name: S_EREFERRAL_EREFERRALHISTORY_20
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
