fileVersion: 1
id: a897fff0-7b74-4ac0-a946-ac1ae26faebc
name: S_SHARED_ED_ATTENDANCE_05
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Combine all source data required to build the ED Attendance Fact"
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77e99427-5fe6-4e97-8940-b4f48534d3e9
          stepCounter: a897fff0-7b74-4ac0-a946-ac1ae26faebc
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Encounter unique identifier
        name: ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3490906-6f48-4084-913d-5535ca85a478
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b4ce3fc-9b06-4f16-961b-09e89a07736d
          stepCounter: a897fff0-7b74-4ac0-a946-ac1ae26faebc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Attendance ref no.
        name: AEATT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90278006-085a-412c-b7a3-41a56a0153fc
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b0d135f-2378-46af-a734-b70da817bcf3
          stepCounter: a897fff0-7b74-4ac0-a946-ac1ae26faebc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: PIMS health organisation ref no
        name: HEORG_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 089d34fd-031f-458a-96f3-a58591547a3b
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e9fb673-2020-4949-b948-255a77f54a4f
          stepCounter: a897fff0-7b74-4ac0-a946-ac1ae26faebc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: PIMS service point ref no
        name: SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b1ed2cd-9eed-4d07-bf9c-05c4958ce7d9
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 556cb63b-5b2f-42e6-834b-231c5323e462
          stepCounter: a897fff0-7b74-4ac0-a946-ac1ae26faebc
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Service_Point_Code
        name: SERVICE_POINT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd8b5dc7-5f8d-48f1-96e5-e9f85b2dc97c
                stepCounter: 331048bb-7ff9-400f-b8c4-4ac7cc91d7e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e837b65-a18e-4fbb-a9e4-12533669fb04
          stepCounter: a897fff0-7b74-4ac0-a946-ac1ae26faebc
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: health_org_code
        name: HEALTH_ORG_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a695067b-41a5-45f5-9479-aad869885f1e
                stepCounter: 331048bb-7ff9-400f-b8c4-4ac7cc91d7e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 030df6b6-77ba-4d04-a7e9-a736e4a93ebc
          stepCounter: a897fff0-7b74-4ac0-a946-ac1ae26faebc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Intended specialty ref no.
        name: INTENDED_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94774b5f-b417-4a66-83dc-520b353cfdaf
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c464b9e5-d7eb-45aa-bf7f-c2358b2a6bc5
          stepCounter: a897fff0-7b74-4ac0-a946-ac1ae26faebc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Referral ref no.
        name: REFRL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d4546568-c664-4b6e-9234-cf6684196b10
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6924d954-18b4-44aa-a6de-0fcabdcbec43
          stepCounter: a897fff0-7b74-4ac0-a946-ac1ae26faebc
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Referral date and time.
        name: REFERRAL_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d1d761e5-2a79-4e24-8644-333c311598eb
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9202bec5-11bd-4833-8326-4cf968fd2e2b
          stepCounter: a897fff0-7b74-4ac0-a946-ac1ae26faebc
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Visit date and time.
        name: ARRIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d1d761e5-2a79-4e24-8644-333c311598eb
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92fce85f-60cc-4c42-bdaa-cedd07a813a5
          stepCounter: a897fff0-7b74-4ac0-a946-ac1ae26faebc
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time patient discharged.
        name: DEPARTED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6cfdbc61-95a7-4bf6-b56e-cb882fd0daee
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e83e1ee-9673-4787-9b7e-1d45c2b1e12f
          stepCounter: a897fff0-7b74-4ac0-a946-ac1ae26faebc
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Medical discharge date.
        name: MEDICAL_DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16a63032-3f00-40bb-ad05-c545bbb88f61
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ff847ca-ab81-4273-a005-e4331771f7a1
          stepCounter: a897fff0-7b74-4ac0-a946-ac1ae26faebc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: discharge_destination_reference_no
        name: DISCHARGE_DESTINATION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c343d736-18b8-4916-a2c3-e1d69547cc8a
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6bc997da-a105-48c9-ac11-8fa533e0503f
          stepCounter: a897fff0-7b74-4ac0-a946-ac1ae26faebc
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: Discharge destination.
        name: DISCHARGE_DESTINATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd1e2093-af53-430f-9415-7cdc97855d61
                stepCounter: a05a4266-44b7-4574-abee-00c3094cf764
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e45c79d-39ae-4dcd-9308-934bb93e742b
          stepCounter: a897fff0-7b74-4ac0-a946-ac1ae26faebc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: discharge_reason_reference_no
        name: DISCHARGE_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 62983923-810a-4b4f-88ea-43aba04ee0b0
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06634be7-d15c-4f82-a4ca-6302635121e5
          stepCounter: a897fff0-7b74-4ac0-a946-ac1ae26faebc
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: Reason for discharge code
        name: DISCHARGE_REASON_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6c760a8-963a-401f-be66-041a533500a7
                stepCounter: 9bacfc57-3a94-40a0-99e8-44500f0ad467
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: abb11e74-897a-410f-bfd2-b0cdc99b5248
          stepCounter: a897fff0-7b74-4ac0-a946-ac1ae26faebc
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: YN flag indicating whether patient self-discharged.
        name: SELF_DISCHARGE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 566743e6-e728-494e-ae51-d3c1280ff6fa
                stepCounter: 9bacfc57-3a94-40a0-99e8-44500f0ad467
            transform: IFNULL(dim_discharge_reason.self_discharge_flag,'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ae9a696-220d-4683-8777-566869b662a1
          stepCounter: a897fff0-7b74-4ac0-a946-ac1ae26faebc
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: ARMOD_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03582478-04df-49db-b89e-9002aa6286ea
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c685b58-e537-4a96-8960-77555b90ddf5
          stepCounter: a897fff0-7b74-4ac0-a946-ac1ae26faebc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Attendance category ref no
        name: ATCAT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f35ab7e2-0e96-41a0-80c2-95b0e564a430
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b615b71-59df-4e9e-9da4-6124b816c1ba
          stepCounter: a897fff0-7b74-4ac0-a946-ac1ae26faebc
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: attendance_category code.
        name: ATTENDANCE_CATEGORY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bda3664e-5811-4a6b-bba4-4b3feb819f26
                stepCounter: 9b9c79c3-de71-43ad-9a4a-a1bbef0d1a2a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 28db4c6e-a35b-4dce-ab72-d7ab8e8f47f6
          stepCounter: a897fff0-7b74-4ac0-a946-ac1ae26faebc
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Y/N flag indicating whether this is a planned return visit.
        name: PLANNED_RETURN_VISIT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f35ab7e2-0e96-41a0-80c2-95b0e564a430
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: |-
              CASE WHEN dim_ed_attendance_category.attendance_category_code IN ('PLRET','FUPPL') THEN 'Y'
                          ELSE 'N'
                           END -- Planned Return/Follow-Up
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b8b329b-57a3-42c0-b8d9-e2789f196cf7
          stepCounter: a897fff0-7b74-4ac0-a946-ac1ae26faebc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Patient ref no.
        name: PATNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5575a982-f3a4-441e-be84-490232d53b24
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d43ebf7-e3ec-4774-8097-dd3dc2143801
          stepCounter: a897fff0-7b74-4ac0-a946-ac1ae26faebc
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 985f0ba0-97cf-4152-a49b-7e86cb71409e
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f73c69d3-f37c-4aa4-9267-226eb3d6149c
          stepCounter: a897fff0-7b74-4ac0-a946-ac1ae26faebc
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Patient_Date_Of_Birth
        name: PATIENT_DATE_OF_BIRTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f201416-ac35-4870-a0c1-0836d1b9e5b7
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42f1c104-0a0c-4b5e-9385-0970390acd4f
          stepCounter: a897fff0-7b74-4ac0-a946-ac1ae26faebc
        config: {}
        dataType: NVARCHAR(30)
        defaultValue: ""
        description: ""
        name: DOMICILE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 13e3f44a-7125-438f-b00f-42c54a307c05
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5df147c0-3c53-404f-ba6e-3dc28bcab084
          stepCounter: a897fff0-7b74-4ac0-a946-ac1ae26faebc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: patient_age_on_arrival_years
        name: PATIENT_AGE_ON_ARRIVAL_YEARS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE WHEN DATEDIFF(mm, dim_patient.patient_date_of_birth, IFNULL(dim_patient.patient_date_of_death,ds_pims_ae_attendances.arrived_dttm)) > 0 THEN CONVERT(integer,DATEDIFF(mm, dim_patient.patient_date_of_birth, IFNULL(dim_patient.patient_date_of_death,ds_pims_ae_attendances.arrived_dttm)) / 12)
                          ELSE 0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b650e703-ac2e-4304-ac19-325472f51f1a
          stepCounter: a897fff0-7b74-4ac0-a946-ac1ae26faebc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: patient_age_on_arrival_months
        name: PATIENT_AGE_ON_ARRIVAL_MONTHS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE WHEN DATEDIFF(mm, dim_patient.patient_date_of_birth, IFNULL(dim_patient.patient_date_of_death,ds_pims_ae_attendances.arrived_dttm)) > 0 THEN CONVERT(integer,DATEDIFF(mm, dim_patient.patient_date_of_birth, IFNULL(dim_patient.patient_date_of_death,ds_pims_ae_attendances.arrived_dttm)) % 12)
                          ELSE 0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b393a2e-0879-4185-8815-2a53f96be07a
          stepCounter: a897fff0-7b74-4ac0-a946-ac1ae26faebc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: patient_visit_num
        name: PATIENT_VISIT_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ROW_NUMBER() OVER (PARTITION BY ds_pims_ae_attendances.patnt_refno ORDER BY ds_pims_ae_attendances.arrived_dttm)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40528882-a89f-4db1-8532-83981d9d83fa
          stepCounter: a897fff0-7b74-4ac0-a946-ac1ae26faebc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: patient_visit_count
        name: PATIENT_VISIT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: COUNT(1) OVER (PARTITION BY ds_pims_ae_attendances.patnt_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31f8df92-c116-4401-a1dd-fcc177d3cdc3
          stepCounter: a897fff0-7b74-4ac0-a946-ac1ae26faebc
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b12eb2ec-6237-4d6c-b1df-0e3c607c88c5
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ad95b25-5d9f-4687-830e-316c75a61b00
          stepCounter: a897fff0-7b74-4ac0-a946-ac1ae26faebc
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: USER_CREATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9f66e85e-521b-4270-9e0a-ae7b9748eae6
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02d36cc6-740b-4321-8173-179bda70a4c2
          stepCounter: a897fff0-7b74-4ac0-a946-ac1ae26faebc
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIF_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b8b2cd15-bade-49fe-93e1-3dd4f2d07cb0
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c5b286f-bdba-41ff-8938-5b09ca5367b2
          stepCounter: a897fff0-7b74-4ac0-a946-ac1ae26faebc
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: USER_MODIF
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 55f1c329-3207-4429-b129-eed9b100b703
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74190e44-8392-4264-9ed6-586436641c62
          stepCounter: a897fff0-7b74-4ac0-a946-ac1ae26faebc
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: NURSE_SEEN_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 920219bf-cb24-4ce8-9190-3ca2338556bb
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07dbe8df-239b-4f94-924c-6238ed8ad5c4
          stepCounter: a897fff0-7b74-4ac0-a946-ac1ae26faebc
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NURSE_SEEN_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 243c3752-6809-498d-9386-a09a302b87a7
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd308b41-816b-4693-9c33-0578276dd633
          stepCounter: a897fff0-7b74-4ac0-a946-ac1ae26faebc
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: NEREF_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d6715fcc-021b-4218-b4f2-367e4238bb9a
                stepCounter: d1b2a933-ea11-4091-ae32-42bf938c7dca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2c10af3-74cb-4f34-aee5-7189d3a60f95
          stepCounter: a897fff0-7b74-4ac0-a946-ac1ae26faebc
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_PIMS_AE_ATTENDANCES
        join:
          joinCondition: |-
            FROM ds_pims_ae_attendances
              JOIN dim.dim_patient
                ON ds_pims_ae_attendances.patnt_refno = dim_patient.patient_reference_no
              LEFT OUTER JOIN dim.dim_discharge_destination
                ON ds_pims_ae_attendances.disde_refno = dim_discharge_destination.discharge_destination_reference_no
               AND ds_pims_ae_attendances.arrived_dttm BETWEEN dim_discharge_destination.dss_start_date AND dim_discharge_destination.dss_end_date
              LEFT OUTER JOIN dim.dim_ed_attendance_category
                ON ds_pims_ae_attendances.atcat_refno = dim_ed_attendance_category.attendance_category_reference_no
               AND ds_pims_ae_attendances.arrived_dttm BETWEEN dim_ed_attendance_category.dss_start_date AND dim_ed_attendance_category.dss_end_date
              LEFT OUTER JOIN dim.dim_discharge_reason
                ON ds_pims_ae_attendances.atdis_refno = dim_discharge_reason.discharge_reason_reference_no
               AND ds_pims_ae_attendances.arrived_dttm BETWEEN dim_discharge_reason.dss_start_date AND dim_discharge_reason.dss_end_date
              LEFT OUTER JOIN dim.dim_service_point
                ON ds_pims_ae_attendances.spont_refno = dim_service_point.service_point_reference_no
               AND ds_pims_ae_attendances.arrived_dttm BETWEEN dim_service_point.dss_start_date AND dim_service_point.dss_end_date
             WHERE ds_pims_ae_attendances.modif_dttm > @v_pa_shared_incremental
                OR ds_pims_ae_attendances.dss_update_time > @v_pa_shared_incremental
        name: S_SHARED_ED_ATTENDANCE_05
        noLinkRefs: []
  name: S_SHARED_ED_ATTENDANCE_05
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
