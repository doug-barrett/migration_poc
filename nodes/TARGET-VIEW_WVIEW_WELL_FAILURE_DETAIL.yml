fileVersion: 1
id: 936302b8-b465-4841-90c3-bee5a35ad798
name: VIEW_WVIEW_WELL_FAILURE_DETAIL
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac404641-fed3-43c2-91a3-7c79be405094
          stepCounter: 936302b8-b465-4841-90c3-bee5a35ad798
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: IDREC
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a81088ad-e721-4f8e-bb81-4400162c2bc1
                stepCounter: 1109d571-cb76-4447-b415-2933e1c36690
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a83ce541-1943-475f-a9c0-edfcd2ebb685
          stepCounter: 936302b8-b465-4841-90c3-bee5a35ad798
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: IDWELL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7aefb1d-be6d-4af1-abbd-2a1583fd2287
                stepCounter: 1109d571-cb76-4447-b415-2933e1c36690
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf4aaaf0-fa23-4fcb-8e84-db6b15bf1c63
          stepCounter: 936302b8-b465-4841-90c3-bee5a35ad798
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: WVTYP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 82b3faef-25b4-4b78-b9d6-4a0322e8754c
                stepCounter: 1109d571-cb76-4447-b415-2933e1c36690
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41888372-bd71-4748-bf15-e27c1f81a71d
          stepCounter: 936302b8-b465-4841-90c3-bee5a35ad798
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: JOBTYP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a69ba6e2-371a-4497-8d05-9054d618db4a
                stepCounter: 1109d571-cb76-4447-b415-2933e1c36690
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: acb0ba5e-e964-455c-bbb2-762434ed9e99
          stepCounter: 936302b8-b465-4841-90c3-bee5a35ad798
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: JOB_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fdede347-b2fc-448b-afc1-ff1886f88a3a
          stepCounter: 936302b8-b465-4841-90c3-bee5a35ad798
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: JOB_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 131899e8-4855-47d6-9243-664c268ebccb
          stepCounter: 936302b8-b465-4841-90c3-bee5a35ad798
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: AFE_SUPP_AMT_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 30bf63fb-a421-4a8a-bb99-bf1c95c1a1db
          stepCounter: 936302b8-b465-4841-90c3-bee5a35ad798
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: REPAIR_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16fe0ee4-799f-4456-972d-6328e50052e8
          stepCounter: 936302b8-b465-4841-90c3-bee5a35ad798
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: FIELDNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9630f959-8724-4ee6-8bce-003dc0b5dc75
                stepCounter: 83eb9dbf-0b83-4bd9-916d-e4c3098394aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd935911-0123-4ca1-8811-747778bf4171
          stepCounter: 936302b8-b465-4841-90c3-bee5a35ad798
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: WELLIDA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 954a79ba-5989-4e9d-bbba-7323d6ab5d28
                stepCounter: 83eb9dbf-0b83-4bd9-916d-e4c3098394aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b3069c72-ed05-4d09-9634-6b7ceb24ebfe
          stepCounter: 936302b8-b465-4841-90c3-bee5a35ad798
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: STATEPROV
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 34eadc10-5ac0-4841-8cd9-5465677d1549
                stepCounter: 83eb9dbf-0b83-4bd9-916d-e4c3098394aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 938477f9-aade-49c6-a6d3-9278fae80e2f
          stepCounter: 936302b8-b465-4841-90c3-bee5a35ad798
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e8c75fdd-b264-42a8-a26d-f89dd534c9f1
                stepCounter: 83eb9dbf-0b83-4bd9-916d-e4c3098394aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a58722e3-c5d3-4b75-8b8e-c9341b82fb07
          stepCounter: 936302b8-b465-4841-90c3-bee5a35ad798
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fbb1bfb8-5429-49fd-86ed-567f04a20186
                stepCounter: 83eb9dbf-0b83-4bd9-916d-e4c3098394aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b82d6bfa-b64f-41fd-9845-a344a681b8f4
          stepCounter: 936302b8-b465-4841-90c3-bee5a35ad798
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: RR_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df6bdf24-ffa3-434a-b04b-97dfab24734b
          stepCounter: 936302b8-b465-4841-90c3-bee5a35ad798
        config: {}
        dataType: VARCHAR(200)
        defaultValue: ""
        description: ""
        name: AFENUMBERCALC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 886e8087-9da9-41f1-9905-14cfafba0eb8
                stepCounter: 1109d571-cb76-4447-b415-2933e1c36690
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8636f5a1-af2d-4db5-87e5-52cb0341e751
          stepCounter: 936302b8-b465-4841-90c3-bee5a35ad798
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: ACTUAL_FAILURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bc5a0c8c-26c0-4e77-babc-8fe07d1d05e8
          stepCounter: 936302b8-b465-4841-90c3-bee5a35ad798
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: FAILED_COMPONENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2dc7b304-2aa9-453d-b573-2725b1e7ce2a
                stepCounter: c36ecf1e-15a0-405d-953b-9014403b9b52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f987aa0-209d-4d7f-aa27-869420a672b4
          stepCounter: 936302b8-b465-4841-90c3-bee5a35ad798
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: AREA_FAILED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70df5053-e9e1-43dc-a03b-187d2bb01587
          stepCounter: 936302b8-b465-4841-90c3-bee5a35ad798
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FAILED_PART_COMPONENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd00c62d-fb89-464a-8343-502e30c8dc41
          stepCounter: 936302b8-b465-4841-90c3-bee5a35ad798
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: STRING_PULLDATE_RUNDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e5847f0-e2c0-40fc-8678-8d308422f4c6
          stepCounter: 936302b8-b465-4841-90c3-bee5a35ad798
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: DURATION_FAILURE_RUNDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da6f306b-ba68-46c1-a6e8-2f86fdb04af1
          stepCounter: 936302b8-b465-4841-90c3-bee5a35ad798
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: EQUIPMENT_LIFE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 962ed428-c032-4ec1-919d-b5275b331dbf
          stepCounter: 936302b8-b465-4841-90c3-bee5a35ad798
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: RUN_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2845b98a-e68c-4fa7-b123-95588678ad24
          stepCounter: 936302b8-b465-4841-90c3-bee5a35ad798
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: FAILURE_CATEGORY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 81c52e56-5514-4497-b7d8-1786afccd690
                stepCounter: a6b6d757-4e9f-478b-8d79-fc353d8cfbc8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 00a14e5f-44d7-4f6b-ad89-1e0d250dedc3
          stepCounter: 936302b8-b465-4841-90c3-bee5a35ad798
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: FAILED_COMPONENT_REVIEW
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ccc5d3f-1b5d-428e-b31c-301ec9534d63
          stepCounter: 936302b8-b465-4841-90c3-bee5a35ad798
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: TOP_DEPTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c46b8eb-8497-4bc3-a13f-dbe0d18d7b57
          stepCounter: 936302b8-b465-4841-90c3-bee5a35ad798
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: TOPDEPTH_TVD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f3c4819d-a4a9-45aa-a9cb-cb561d9bceeb
          stepCounter: 936302b8-b465-4841-90c3-bee5a35ad798
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: BOTTOM_DEPTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 479a9784-ac87-44c8-9691-49d7d52a3a3f
          stepCounter: 936302b8-b465-4841-90c3-bee5a35ad798
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: BOTTOM_DEPTH_DVD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe5f3aea-4d28-47c6-8107-0ea63d7d3d6c
          stepCounter: 936302b8-b465-4841-90c3-bee5a35ad798
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: MAKE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ddef0d36-f6f0-4243-85f0-5a2b76d262ae
          stepCounter: 936302b8-b465-4841-90c3-bee5a35ad798
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: MODEL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41dfabfd-e564-45f5-8e2b-a77e46388c39
          stepCounter: 936302b8-b465-4841-90c3-bee5a35ad798
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: TOP_INCLINATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 934a5e25-cbe0-4008-b3ff-809865ada329
          stepCounter: 936302b8-b465-4841-90c3-bee5a35ad798
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: BOTTOM_INCLINATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4af94da2-0aa3-40ec-8a82-bb0e31abfb7a
          stepCounter: 936302b8-b465-4841-90c3-bee5a35ad798
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: MAX_INCLINATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7efdbb2-e362-4dd6-889e-26c7875fbf33
          stepCounter: 936302b8-b465-4841-90c3-bee5a35ad798
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: ROOT_CAUSE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eafb20a0-9358-44a0-984c-7a941458b338
          stepCounter: 936302b8-b465-4841-90c3-bee5a35ad798
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: PART_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 766e3113-1cb6-4929-a240-b9ab07722983
          stepCounter: 936302b8-b465-4841-90c3-bee5a35ad798
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: PART_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f1ab86b2-ed2b-4900-a0b9-685f32883fb4
          stepCounter: 936302b8-b465-4841-90c3-bee5a35ad798
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: METALLURGY_FAILED_PART
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a2f7b9d-af2e-42ad-a83b-4549d8c6ca78
          stepCounter: 936302b8-b465-4841-90c3-bee5a35ad798
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: PART_LIFE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c53c97f2-39e8-4e18-b0e9-420c87905d28
          stepCounter: 936302b8-b465-4841-90c3-bee5a35ad798
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: MATERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 899baa41-1262-4bfc-9333-fd9e425aa45a
                stepCounter: d013a564-b547-41b9-9729-990b085f4aed
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eeba75c8-bb79-4ece-9463-b1ec9e1c4317
          stepCounter: 936302b8-b465-4841-90c3-bee5a35ad798
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: OPEX_CAPEX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_WVIEW_WELL_FAILURE_DETAIL: 936302b8-b465-4841-90c3-bee5a35ad798
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_WVIEW_WELL_FAILURE_DETAIL') }} AS SELECT WVJOB.IDREC,
                   WVJOB.IDWELL,
                   WVJOB.WVTYP,
                   WVJOB.JOBTYP,
                   WVJOB.DTTMEND AS JOB_END_DATE,
                   WVJOB.DTTMSTART AS JOB_START_DATE,
                   WVJOB.AFETOTALCALC AS AFE_SUPP_AMT_COST,
                   WVJOB.COSTTOTALCALC AS REPAIR_COST,
                   WVWELLHEADER.FIELDNAME,
                   WVWELLHEADER.WELLIDA,
                   WVWELLHEADER.STATEPROV,
                   WVWELLHEADER.AREA,
                   WVWELLHEADER.COUNTRY,
                   WVWELLHEADER.DTTMRR AS RR_DATE,
                   WVJOB.AFENUMBERCALC,
                   WVPROBLEM.IDRECJOB AS ACTUAL_FAILURE,
                   WVPROBLEMDETAIL.IDRECFAILEDITEM AS FAILED_COMPONENT,
                   WVPROBLEMDETAIL.AREAFAILED AS AREA_FAILED,
                   WVPROBLEMDETAIL.SUBITEM AS FAILED_PART_COMPONENT,
                   WVPROBLEMDETAIL.DUREQUIPCALC AS STRING_PULLDATE_RUNDATE,
                   WVPROBLEMDETAIL.DURSTARTTORUNCALC AS DURATION_FAILURE_RUNDATE,
                   WVPROBLEMDETAIL.DUREQUIPINSERVICE AS EQUIPMENT_LIFE,
                   WVPROBLEMDETAIL.DURRUN AS RUN_HOURS,
                   WVPROBLEM.TYP AS FAILURE_CATEGORY,
                   WVPROBLEMDETAIL.DESCOMPCALC AS FAILED_COMPONENT_REVIEW,
                   WVPROBLEMDETAIL.DEPTHTOPCALC AS TOP_DEPTH,
                   WVPROBLEMDETAIL.DEPTHTVDTOPCALC AS TOPDEPTH_TVD,
                   WVPROBLEMDETAIL.DEPTHBTMCALC AS BOTTOM_DEPTH,
                   WVPROBLEMDETAIL.DEPTHTVDBTMCALC AS BOTTOM_DEPTH_DVD,
                   WVPROBLEMDETAIL.MAKECALC AS MAKE,
                   WVPROBLEMDETAIL.MODELCALC AS MODEL,
                   WVPROBLEMDETAIL.INCLTOPCALC AS TOP_INCLINATION,
                   WVPROBLEMDETAIL.inclbtmcalc AS BOTTOM_INCLINATION,
                   WVPROBLEMDETAIL.INCLMAXCALC AS MAX_INCLINATION,
                   WVPROBLEMDETAILANALYSIS.ROOTCAUSE1 AS ROOT_CAUSE,
                   WVPROBLEMDETAILANALYSIS.PARTDES AS PART_DESCRIPTION,
                   WVPROBLEMDETAILANALYSIS.PARTCOST AS PART_COST,
                   WVPROBLEMDETAILANALYSIS.METALLURGY AS METALLURGY_FAILED_PART,
                   WVPROBLEMDETAILANALYSIS.DUREQUIP AS PART_LIFE,
                   WVPROBLEMDETAILANALYSIS.MATERIAL AS MATERIAL,
                   CASE WHEN LEFT(WVJOB.AFENUMBERCALC, 2) = 'CW' THEN 'OPTI'
                        WHEN LEFT(WVJOB.AFENUMBERCALC, 2) = 'WO' THEN 'OPTI'
                        WHEN LEFT(WVJOB.AFENUMBERCALC, 2) = 'CM' THEN 'CAPEX'
                        WHEN LEFT(WVJOB.AFENUMBERCALC, 2) = 'SM' THEN 'CAPEX'
                        ELSE 'OPEX'
                         END AS OPEX_CAPEX
              FROM WS_DATA_STORE.ODS_WVIEW_WVT_WVJOB WVJOB
              LEFT JOIN WS_DATA_STORE.ODS_WVIEW_WVT_WVWELLHEADER WVWELLHEADER
                ON WVJOB.IDWELL = WVWELLHEADER.IDWELL
               AND WVWELLHEADER.DSS_CURRENT_FLAG = 'Y'
               AND WVWELLHEADER.DSS_DELETE_FLAG != 'Y'
              LEFT JOIN WS_DATA_STORE.ODS_WVIEW_WVT_WVPROBLEM WVPROBLEM
                ON WVJOB.IDREC = WVPROBLEM.IDRECJOB
               AND WVPROBLEM.DSS_CURRENT_FLAG = 'Y'
               AND WVPROBLEM.DSS_DELETE_FLAG != 'Y'
              FULL JOIN WS_DATA_STORE.ODS_WVIEW_WVT_WVPROBLEMDETAIL WVPROBLEMDETAIL
                ON WVJOB.IDWELL = WVPROBLEMDETAIL.IDWELL
               AND WVPROBLEMDETAIL.DSS_CURRENT_FLAG = 'Y'
               AND WVPROBLEMDETAIL.DSS_DELETE_FLAG != 'Y'
              FULL JOIN WS_DATA_STORE.ODS_WVIEW_WVT_WVPROBLEMDETAILANALYSIS WVPROBLEMDETAILANALYSIS
                ON WVPROBLEMDETAIL.IDREC = WVPROBLEMDETAILANALYSIS.IDRECPARENT
               AND WVPROBLEMDETAILANALYSIS.DSS_CURRENT_FLAG = 'Y'
               AND WVPROBLEMDETAILANALYSIS.DSS_DELETE_FLAG != 'Y'
             WHERE WVJOB.DSS_CURRENT_FLAG = 'Y'
               AND WVJOB.DSS_DELETE_FLAG != 'Y'
        dependencies:
          - locationName: TARGET
            nodeName: ODS_WVIEW_WVT_WVJOB
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_WVIEW_WVT_WVJOB') }}
        name: VIEW_WVIEW_WELL_FAILURE_DETAIL
        noLinkRefs: []
  name: VIEW_WVIEW_WELL_FAILURE_DETAIL
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
