fileVersion: 1
id: 614f102e-023d-4551-896b-069607296b61
name: VIEW_WVIEW_WELL_FAILURE_DETAIL
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb35e7af-d1c2-449b-b331-2dbac18516fd
          stepCounter: 614f102e-023d-4551-896b-069607296b61
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: IDREC
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f9948b3b-6c16-4330-acb1-e3fec12a6462
                stepCounter: 7c248ee4-f77a-41a5-b013-1f6873af6670
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1d2c3ef-382b-4d31-9f77-b8bedb8fc4d0
          stepCounter: 614f102e-023d-4551-896b-069607296b61
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: IDWELL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a16e385d-148d-4624-92f6-363d10b46434
                stepCounter: 7c248ee4-f77a-41a5-b013-1f6873af6670
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b1b386d-63fd-4f90-a6f7-28698ca126af
          stepCounter: 614f102e-023d-4551-896b-069607296b61
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: WVTYP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4d61d9a1-2ab2-43a6-bb0f-0cd571701133
                stepCounter: 7c248ee4-f77a-41a5-b013-1f6873af6670
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95db03ac-2b8d-4b6e-86d7-4975aef93d12
          stepCounter: 614f102e-023d-4551-896b-069607296b61
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: JOBTYP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ad3ebed5-d875-4d65-86b3-da802299b6f9
                stepCounter: 7c248ee4-f77a-41a5-b013-1f6873af6670
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b828da7-b1b4-478e-9ca9-479d038060a0
          stepCounter: 614f102e-023d-4551-896b-069607296b61
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: JOB_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ee492ce-7a73-46d1-a24b-488238fc871e
          stepCounter: 614f102e-023d-4551-896b-069607296b61
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: JOB_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd854ed0-d15c-44f8-b324-bcdb1c632af9
          stepCounter: 614f102e-023d-4551-896b-069607296b61
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: AFE_SUPP_AMT_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8793a132-c170-4593-9cce-3510fad355b1
          stepCounter: 614f102e-023d-4551-896b-069607296b61
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: REPAIR_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03f18902-ddd9-47af-b8e0-da15abe7f89f
          stepCounter: 614f102e-023d-4551-896b-069607296b61
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: FIELDNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3411379-2ad9-41a7-b7ae-3fe13ce6a6c5
                stepCounter: 916c650e-a994-4ba8-998d-0998ffdbd809
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d543bb6c-115e-4724-a0e2-fcfe332726bb
          stepCounter: 614f102e-023d-4551-896b-069607296b61
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: WELLIDA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: da563a90-940a-4dc1-9fb1-9f8c27e248af
                stepCounter: 916c650e-a994-4ba8-998d-0998ffdbd809
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: abca88cd-71f1-45b1-86bd-9f1747cb83dd
          stepCounter: 614f102e-023d-4551-896b-069607296b61
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: STATEPROV
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8a52f42e-a679-4d33-ae9f-5da112af0b45
                stepCounter: 916c650e-a994-4ba8-998d-0998ffdbd809
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20d49881-db64-4caf-ba87-15c273cefb12
          stepCounter: 614f102e-023d-4551-896b-069607296b61
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09538a62-a873-47f0-b4ab-c28463fd6327
                stepCounter: 916c650e-a994-4ba8-998d-0998ffdbd809
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8f79ff0-7697-4c4d-92f9-061913d57838
          stepCounter: 614f102e-023d-4551-896b-069607296b61
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 724f25c5-4574-4dcf-b2d3-2bb52ec595cc
                stepCounter: 916c650e-a994-4ba8-998d-0998ffdbd809
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 52cdaecf-e4e7-4225-937d-62a0c8a0b5b7
          stepCounter: 614f102e-023d-4551-896b-069607296b61
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: RR_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6b7c5e5-94ff-4f77-801b-6550feb05913
          stepCounter: 614f102e-023d-4551-896b-069607296b61
        config: {}
        dataType: VARCHAR(200)
        defaultValue: ""
        description: ""
        name: AFENUMBERCALC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2e088063-93bc-4d6d-92d3-be1b6c2896e1
                stepCounter: 7c248ee4-f77a-41a5-b013-1f6873af6670
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b0b712c-1bb1-48f6-968c-d9424e1017e0
          stepCounter: 614f102e-023d-4551-896b-069607296b61
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: ACTUAL_FAILURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef571eda-c0ef-42c9-91cd-2bbfa1b9dcc7
          stepCounter: 614f102e-023d-4551-896b-069607296b61
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: FAILED_COMPONENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dfe36b00-71d1-4fcb-9aa5-9ea6f4a2246e
                stepCounter: c3f17df7-6dda-41c4-8dc1-97c00cdf940e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c22ff6d9-0184-4c13-acf2-867d8d5a1a04
          stepCounter: 614f102e-023d-4551-896b-069607296b61
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: AREA_FAILED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 192156c1-7075-46df-a450-25c71101cc43
          stepCounter: 614f102e-023d-4551-896b-069607296b61
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FAILED_PART_COMPONENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6db9b0ae-b1b4-4adf-8a7d-ef290e641a41
          stepCounter: 614f102e-023d-4551-896b-069607296b61
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: STRING_PULLDATE_RUNDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 44a77c5a-bd1b-4f95-a89a-5babc253d533
          stepCounter: 614f102e-023d-4551-896b-069607296b61
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: DURATION_FAILURE_RUNDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0825649d-aac1-438e-8269-e09b8e5024cf
          stepCounter: 614f102e-023d-4551-896b-069607296b61
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: EQUIPMENT_LIFE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77e2aa3e-3aae-4863-8b83-14ac0c9dc66b
          stepCounter: 614f102e-023d-4551-896b-069607296b61
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: RUN_HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 948b2db7-81f0-491c-ace7-62c2d1de1ca6
          stepCounter: 614f102e-023d-4551-896b-069607296b61
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: FAILURE_CATEGORY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 933edb42-2614-4f1e-9dce-2dbaae56221a
                stepCounter: 34ef7d4b-bb80-476c-a567-c77e2e94fb86
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a71503e7-4f10-4c4b-8d47-85ed51572343
          stepCounter: 614f102e-023d-4551-896b-069607296b61
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: FAILED_COMPONENT_REVIEW
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91b805c2-d11e-4609-a6b2-c8213cea9762
          stepCounter: 614f102e-023d-4551-896b-069607296b61
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: TOP_DEPTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a4b5d7f2-91bc-4333-9299-94617edd7bb5
          stepCounter: 614f102e-023d-4551-896b-069607296b61
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: TOPDEPTH_TVD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7da25d7e-8b01-4591-ac12-f27e9d67eed9
          stepCounter: 614f102e-023d-4551-896b-069607296b61
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: BOTTOM_DEPTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cafb8902-b316-4ec5-8cd3-2f10b3d1a2d8
          stepCounter: 614f102e-023d-4551-896b-069607296b61
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: BOTTOM_DEPTH_DVD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c47f811-a2d5-472d-9aab-31c7fdf8997b
          stepCounter: 614f102e-023d-4551-896b-069607296b61
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: MAKE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8cdee19c-0a1a-41e4-a1e0-5df3c5a5eb19
          stepCounter: 614f102e-023d-4551-896b-069607296b61
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: MODEL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 962b2d1d-1d2c-4723-9bcb-fa32e192102a
          stepCounter: 614f102e-023d-4551-896b-069607296b61
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: TOP_INCLINATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39d1c7a0-3ff1-45f6-bab3-db34e4bc391b
          stepCounter: 614f102e-023d-4551-896b-069607296b61
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: BOTTOM_INCLINATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67752e27-7522-47f1-8995-c73e8e9b2ec9
          stepCounter: 614f102e-023d-4551-896b-069607296b61
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: MAX_INCLINATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42f880ad-2e86-40df-b533-0f31d1bf3d9e
          stepCounter: 614f102e-023d-4551-896b-069607296b61
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: ROOT_CAUSE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 23efab57-35ea-41b7-9eb2-53f6d5219323
          stepCounter: 614f102e-023d-4551-896b-069607296b61
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: PART_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3cd83d84-1c1c-40c5-93ce-21d114df16de
          stepCounter: 614f102e-023d-4551-896b-069607296b61
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: PART_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff537582-d1a6-426d-abf3-80c809ad8186
          stepCounter: 614f102e-023d-4551-896b-069607296b61
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: METALLURGY_FAILED_PART
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2bb469a-11e7-49b1-876e-86a52b824898
          stepCounter: 614f102e-023d-4551-896b-069607296b61
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: PART_LIFE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74784230-a24f-448e-acaf-d9259ea0cc2e
          stepCounter: 614f102e-023d-4551-896b-069607296b61
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: MATERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ad581c5c-d02d-4fe8-875c-357808c324f3
                stepCounter: 76cfde31-18ee-4f82-a9da-4b2e85805363
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ebe835c-2d95-448f-81e4-a987e67d7ed0
          stepCounter: 614f102e-023d-4551-896b-069607296b61
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: OPEX_CAPEX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_WVIEW_WELL_FAILURE_DETAIL: 614f102e-023d-4551-896b-069607296b61
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_WVIEW_WELL_FAILURE_DETAIL') }} AS SELECT WVJOB.IDREC,
                   WVJOB.IDWELL,
                   WVJOB.WVTYP,
                   WVJOB.JOBTYP,
                   WVJOB.DTTMEND AS JOB_END_DATE,
                   WVJOB.DTTMSTART AS JOB_START_DATE,
                   WVJOB.AFETOTALCALC AS AFE_SUPP_AMT_COST,
                   WVJOB.COSTTOTALCALC AS REPAIR_COST,
                   WVWELLHEADER.FIELDNAME,
                   WVWELLHEADER.WELLIDA,
                   WVWELLHEADER.STATEPROV,
                   WVWELLHEADER.AREA,
                   WVWELLHEADER.COUNTRY,
                   WVWELLHEADER.DTTMRR AS RR_DATE,
                   WVJOB.AFENUMBERCALC,
                   WVPROBLEM.IDRECJOB AS ACTUAL_FAILURE,
                   WVPROBLEMDETAIL.IDRECFAILEDITEM AS FAILED_COMPONENT,
                   WVPROBLEMDETAIL.AREAFAILED AS AREA_FAILED,
                   WVPROBLEMDETAIL.SUBITEM AS FAILED_PART_COMPONENT,
                   WVPROBLEMDETAIL.DUREQUIPCALC AS STRING_PULLDATE_RUNDATE,
                   WVPROBLEMDETAIL.DURSTARTTORUNCALC AS DURATION_FAILURE_RUNDATE,
                   WVPROBLEMDETAIL.DUREQUIPINSERVICE AS EQUIPMENT_LIFE,
                   WVPROBLEMDETAIL.DURRUN AS RUN_HOURS,
                   WVPROBLEM.TYP AS FAILURE_CATEGORY,
                   WVPROBLEMDETAIL.DESCOMPCALC AS FAILED_COMPONENT_REVIEW,
                   WVPROBLEMDETAIL.DEPTHTOPCALC AS TOP_DEPTH,
                   WVPROBLEMDETAIL.DEPTHTVDTOPCALC AS TOPDEPTH_TVD,
                   WVPROBLEMDETAIL.DEPTHBTMCALC AS BOTTOM_DEPTH,
                   WVPROBLEMDETAIL.DEPTHTVDBTMCALC AS BOTTOM_DEPTH_DVD,
                   WVPROBLEMDETAIL.MAKECALC AS MAKE,
                   WVPROBLEMDETAIL.MODELCALC AS MODEL,
                   WVPROBLEMDETAIL.INCLTOPCALC AS TOP_INCLINATION,
                   WVPROBLEMDETAIL.inclbtmcalc AS BOTTOM_INCLINATION,
                   WVPROBLEMDETAIL.INCLMAXCALC AS MAX_INCLINATION,
                   WVPROBLEMDETAILANALYSIS.ROOTCAUSE1 AS ROOT_CAUSE,
                   WVPROBLEMDETAILANALYSIS.PARTDES AS PART_DESCRIPTION,
                   WVPROBLEMDETAILANALYSIS.PARTCOST AS PART_COST,
                   WVPROBLEMDETAILANALYSIS.METALLURGY AS METALLURGY_FAILED_PART,
                   WVPROBLEMDETAILANALYSIS.DUREQUIP AS PART_LIFE,
                   WVPROBLEMDETAILANALYSIS.MATERIAL AS MATERIAL,
                   CASE WHEN LEFT(WVJOB.AFENUMBERCALC, 2) = 'CW' THEN 'OPTI'
                        WHEN LEFT(WVJOB.AFENUMBERCALC, 2) = 'WO' THEN 'OPTI'
                        WHEN LEFT(WVJOB.AFENUMBERCALC, 2) = 'CM' THEN 'CAPEX'
                        WHEN LEFT(WVJOB.AFENUMBERCALC, 2) = 'SM' THEN 'CAPEX'
                        ELSE 'OPEX'
                         END AS OPEX_CAPEX
              FROM WS_DATA_STORE.ODS_WVIEW_WVT_WVJOB WVJOB
              LEFT JOIN WS_DATA_STORE.ODS_WVIEW_WVT_WVWELLHEADER WVWELLHEADER
                ON WVJOB.IDWELL = WVWELLHEADER.IDWELL
               AND WVWELLHEADER.DSS_CURRENT_FLAG = 'Y'
               AND WVWELLHEADER.DSS_DELETE_FLAG != 'Y'
              LEFT JOIN WS_DATA_STORE.ODS_WVIEW_WVT_WVPROBLEM WVPROBLEM
                ON WVJOB.IDREC = WVPROBLEM.IDRECJOB
               AND WVPROBLEM.DSS_CURRENT_FLAG = 'Y'
               AND WVPROBLEM.DSS_DELETE_FLAG != 'Y'
              FULL JOIN WS_DATA_STORE.ODS_WVIEW_WVT_WVPROBLEMDETAIL WVPROBLEMDETAIL
                ON WVJOB.IDWELL = WVPROBLEMDETAIL.IDWELL
               AND WVPROBLEMDETAIL.DSS_CURRENT_FLAG = 'Y'
               AND WVPROBLEMDETAIL.DSS_DELETE_FLAG != 'Y'
              FULL JOIN WS_DATA_STORE.ODS_WVIEW_WVT_WVPROBLEMDETAILANALYSIS WVPROBLEMDETAILANALYSIS
                ON WVPROBLEMDETAIL.IDREC = WVPROBLEMDETAILANALYSIS.IDRECPARENT
               AND WVPROBLEMDETAILANALYSIS.DSS_CURRENT_FLAG = 'Y'
               AND WVPROBLEMDETAILANALYSIS.DSS_DELETE_FLAG != 'Y'
             WHERE WVJOB.DSS_CURRENT_FLAG = 'Y'
               AND WVJOB.DSS_DELETE_FLAG != 'Y'
        dependencies:
          - locationName: TARGET
            nodeName: ODS_WVIEW_WVT_WVJOB
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_WVIEW_WVT_WVJOB') }}
        name: VIEW_WVIEW_WELL_FAILURE_DETAIL
        noLinkRefs: []
  name: VIEW_WVIEW_WELL_FAILURE_DETAIL
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
