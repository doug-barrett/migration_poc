fileVersion: 1
id: e3badc19-dedf-4f71-907b-7e2597633054
name: S_USER_LOGIN_PIMS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bdded21d-c50b-45f7-a067-e19fb2fa8737
          stepCounter: e3badc19-dedf-4f71-907b-7e2597633054
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: USER_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60968723-384a-4a8e-8339-6241b18e94da
                stepCounter: a42e6ddb-5f83-4a7a-a2ca-d60d63e1ba34
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8930a6a9-0bdd-475b-82e0-3e8c380a009e
          stepCounter: e3badc19-dedf-4f71-907b-7e2597633054
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ac90a650-f85d-4db0-8899-d4216cf336d8
                stepCounter: a42e6ddb-5f83-4a7a-a2ca-d60d63e1ba34
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa908c8b-d334-4b8c-87c1-eb3933028ce3
          stepCounter: e3badc19-dedf-4f71-907b-7e2597633054
        config: {}
        dataType: VARCHAR(35)
        defaultValue: ""
        description: ""
        name: USER_FULL_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c387d5f-55fa-42ab-889c-dea874da26f8
                stepCounter: a42e6ddb-5f83-4a7a-a2ca-d60d63e1ba34
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69017393-0f2b-4580-85fc-1a335d54bcdd
          stepCounter: e3badc19-dedf-4f71-907b-7e2597633054
        config: {}
        dataType: VARCHAR(35)
        defaultValue: ""
        description: ""
        name: USER_FIRSTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c387d5f-55fa-42ab-889c-dea874da26f8
                stepCounter: a42e6ddb-5f83-4a7a-a2ca-d60d63e1ba34
            transform: |-
              CASE WHEN CHARINDEX(',',ds_pims_users.user_name) > 0 THEN RTRIM(RIGHT(ds_pims_users.user_name,LEN(ds_pims_users.user_name)-CHARINDEX(',',ds_pims_users.user_name)))
                          ELSE ds_pims_users.user_name
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c778df8-9c0c-4b15-bb9b-6e38c79c8180
          stepCounter: e3badc19-dedf-4f71-907b-7e2597633054
        config: {}
        dataType: VARCHAR(35)
        defaultValue: ""
        description: ""
        name: USER_SURNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c387d5f-55fa-42ab-889c-dea874da26f8
                stepCounter: a42e6ddb-5f83-4a7a-a2ca-d60d63e1ba34
            transform: |-
              CASE WHEN CHARINDEX(',',ds_pims_users.user_name) > 0 THEN RTRIM(LEFT(ds_pims_users.user_name,CHARINDEX(',',ds_pims_users.user_name)-1))
                          ELSE ds_pims_users.user_name
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53b899e9-975d-4513-84b5-ef70d6689c72
          stepCounter: e3badc19-dedf-4f71-907b-7e2597633054
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: USER_EMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d1bf3ea-1374-408b-912b-a3e1340566eb
                stepCounter: a42e6ddb-5f83-4a7a-a2ca-d60d63e1ba34
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d43a5f3-2c98-4d83-8ea7-c8fce0298940
          stepCounter: e3badc19-dedf-4f71-907b-7e2597633054
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: USER_PHONE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0776443b-72ab-4587-b43c-4e9152a3cc4f
                stepCounter: a42e6ddb-5f83-4a7a-a2ca-d60d63e1ba34
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bdf9aab9-2f8d-463a-a747-01804b0d1ee5
          stepCounter: e3badc19-dedf-4f71-907b-7e2597633054
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: USER_DEPARTMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 95b12d98-4736-4fea-a47c-66cea08c7814
                stepCounter: a42e6ddb-5f83-4a7a-a2ca-d60d63e1ba34
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb57fb41-3ca8-4e74-979a-382e3ce5f93f
          stepCounter: e3badc19-dedf-4f71-907b-7e2597633054
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ef99857-d99e-4c99-a933-f435baadfc4a
                stepCounter: a42e6ddb-5f83-4a7a-a2ca-d60d63e1ba34
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 057815dd-dd3d-418d-9898-d16cb7e97160
          stepCounter: e3badc19-dedf-4f71-907b-7e2597633054
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EXTERNAL_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 916cfd98-d565-4ae4-b10a-58ae14fae140
                stepCounter: a42e6ddb-5f83-4a7a-a2ca-d60d63e1ba34
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff1cf1e0-1ffe-411c-9a7c-e876f2e42448
          stepCounter: e3badc19-dedf-4f71-907b-7e2597633054
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_LOGON_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 294c5942-837b-4c79-9191-d6b8aa52ea5f
                stepCounter: a42e6ddb-5f83-4a7a-a2ca-d60d63e1ba34
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91838cf9-8ad2-4c6f-81c7-9d5f477a1215
          stepCounter: e3badc19-dedf-4f71-907b-7e2597633054
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LOGGED_ON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b0ecfe6c-8054-43af-8cf7-7a112c8af24c
                stepCounter: a42e6ddb-5f83-4a7a-a2ca-d60d63e1ba34
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f96570a-9cb4-4768-ad43-ae747dcb85e3
          stepCounter: e3badc19-dedf-4f71-907b-7e2597633054
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: LOCKED_COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5132a28f-7eac-4401-b4b5-574617f444bc
                stepCounter: a42e6ddb-5f83-4a7a-a2ca-d60d63e1ba34
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cab3547e-6db5-4711-acca-69170e71000f
          stepCounter: e3badc19-dedf-4f71-907b-7e2597633054
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: LOCKED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e0ef983e-b98a-4361-9133-f79d82c5acce
                stepCounter: a42e6ddb-5f83-4a7a-a2ca-d60d63e1ba34
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 818a9883-cfef-4b01-b953-8e0f38090af2
          stepCounter: e3badc19-dedf-4f71-907b-7e2597633054
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: INACTIVE_STATUS_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 62d44ac3-4428-47aa-818f-147e14bda053
                stepCounter: a42e6ddb-5f83-4a7a-a2ca-d60d63e1ba34
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7820c566-8dfc-4f6b-b0f7-38ceafdadeaa
          stepCounter: e3badc19-dedf-4f71-907b-7e2597633054
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: CHANGE_PASSWORD_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc31ac6f-e545-408a-8e29-35e7350d0232
                stepCounter: a42e6ddb-5f83-4a7a-a2ca-d60d63e1ba34
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f3e2ff3f-e4c6-4621-bd47-b92f0bbadade
          stepCounter: e3badc19-dedf-4f71-907b-7e2597633054
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: EVENTS_EXIST_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 477f0f20-4e36-4842-9e0f-425930b32cb3
                stepCounter: a42e6ddb-5f83-4a7a-a2ca-d60d63e1ba34
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a05fc6a-47e3-4438-a22e-89d9b397c7c6
          stepCounter: e3badc19-dedf-4f71-907b-7e2597633054
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACLEV_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 046a2209-5b31-4b0e-9c7b-e8fcbeab7ae8
                stepCounter: a42e6ddb-5f83-4a7a-a2ca-d60d63e1ba34
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c8d957c-19ab-420d-83ce-c064b20736be
          stepCounter: e3badc19-dedf-4f71-907b-7e2597633054
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STRAN_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eeb6b465-5534-4ec0-98e4-f88311be68de
                stepCounter: a42e6ddb-5f83-4a7a-a2ca-d60d63e1ba34
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b061da62-f68a-473f-95a2-ff9044e1b34c
          stepCounter: e3badc19-dedf-4f71-907b-7e2597633054
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OWNER_HEORG_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6fa7a89d-e42b-4846-b373-478888b03850
                stepCounter: a42e6ddb-5f83-4a7a-a2ca-d60d63e1ba34
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80f8449c-3d53-47d4-8028-2839bbd907fc
          stepCounter: e3badc19-dedf-4f71-907b-7e2597633054
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: USER_CREATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 20bb2d67-664d-49e8-9c7c-1894d42d60ff
                stepCounter: a42e6ddb-5f83-4a7a-a2ca-d60d63e1ba34
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 860085ae-bd96-4895-b5bd-086b08ce5928
          stepCounter: e3badc19-dedf-4f71-907b-7e2597633054
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: USER_MODIF
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e4d535da-a3a6-4474-b415-afbb5051b185
                stepCounter: a42e6ddb-5f83-4a7a-a2ca-d60d63e1ba34
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb09ad19-b81b-430d-bf0c-16863263c358
          stepCounter: e3badc19-dedf-4f71-907b-7e2597633054
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ac14db19-78b7-4c34-a4eb-e1626d2d1620
                stepCounter: a42e6ddb-5f83-4a7a-a2ca-d60d63e1ba34
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b9cc38b-a1b7-4bd7-95f4-22283854bcbb
          stepCounter: e3badc19-dedf-4f71-907b-7e2597633054
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIF_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9e294f42-b8d1-4922-a145-391b0d857f7d
                stepCounter: a42e6ddb-5f83-4a7a-a2ca-d60d63e1ba34
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17e8aa64-638a-41a3-aded-7638867ac958
          stepCounter: e3badc19-dedf-4f71-907b-7e2597633054
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ALTER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7fe27f93-087d-47a1-9e21-6d085b0bb9a3
                stepCounter: a42e6ddb-5f83-4a7a-a2ca-d60d63e1ba34
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 93e2b8c0-d6aa-4c01-8078-67a0a963c08a
          stepCounter: e3badc19-dedf-4f71-907b-7e2597633054
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ARCHV_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3057b75-7dc8-4f09-bc93-f094e3e46b63
                stepCounter: a42e6ddb-5f83-4a7a-a2ca-d60d63e1ba34
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bccc1af4-5b71-4947-9a3e-b96b9ae0da2e
          stepCounter: e3badc19-dedf-4f71-907b-7e2597633054
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_PIMS_USERS
        join:
          joinCondition: |-
            FROM l_pims_users
             INNER JOIN (
                    SELECT MAX(users_refno) users_refno
                      FROM l_pims_users
                     GROUP BY code
                   ) l_pims_users2
                ON l_pims_users.users_refno = l_pims_users2.users_refno
        name: S_USER_LOGIN_PIMS
        noLinkRefs: []
  name: S_USER_LOGIN_PIMS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
