fileVersion: 1
id: 69cfb682-3521-4e02-831b-fd85cb9c3678
name: S_PIMS_PATIENT_PROF_CARERS_30
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87b5bf66-b90a-441b-9bfc-c6d76d00c6c0
          stepCounter: 69cfb682-3521-4e02-831b-fd85cb9c3678
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: PATIENT_PROF_CARERS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 63499194-af47-483e-93c1-86a9bb9db447
                stepCounter: 7ed66403-af99-4a60-804e-96e3ed2bd730
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98cdb9af-e07f-4830-8d50-9cb192239cad
          stepCounter: 69cfb682-3521-4e02-831b-fd85cb9c3678
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d6fd2f66-d304-4da2-8b23-a96e421c84e7
                stepCounter: 7ed66403-af99-4a60-804e-96e3ed2bd730
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5447a27b-821c-41b2-b58a-3e6bbf95951e
          stepCounter: 69cfb682-3521-4e02-831b-fd85cb9c3678
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_pims_patient_prof_carers_30.PATNT_REFNO=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9962a01b-5f3d-4c1a-b371-997edef38d0f
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f07056d-6b76-469e-be25-38c21231628b
          stepCounter: 69cfb682-3521-4e02-831b-fd85cb9c3678
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: 'The NHI is a unique 7-character identification number assigned to a healthcare user by the National Health Index (NHI) database.   There is a verification algorithm which ensures that the NHI number is in the correct format and is valid.     Also known as National Health Index, HCU identifier, NHI, HCU, HCU Number, Healthcare User identifier,   HCU identification number, NMPI number, Hospital Number, Patient Number.     '
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 985f0ba0-97cf-4152-a49b-7e86cb71409e
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d806193-eda3-49da-8bd4-50b1913c7ccb
          stepCounter: 69cfb682-3521-4e02-831b-fd85cb9c3678
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: PROF_CARER_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f485f2cb-95d2-46a4-a541-36ad724b7a19
                stepCounter: 7ed66403-af99-4a60-804e-96e3ed2bd730
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c27076e-8ace-4813-9a85-670c05664bf2
          stepCounter: 69cfb682-3521-4e02-831b-fd85cb9c3678
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_pims_patient_prof_carers_30.prof_carer_reference_no=dim_patient_professional_carer.healthcare_professional_reference_no
        name: DIM_PATIENT_PROFESSIONAL_CARER_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a021b222-60ec-44b0-ae90-2de3b5b48c29
                stepCounter: 195dfc0c-1916-4aa6-81b8-e0febbc5d9fa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c5b987f-8558-42ae-a07b-29d0a47c9684
          stepCounter: 69cfb682-3521-4e02-831b-fd85cb9c3678
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: PROF_CARER_ROLE_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a59b8e6d-e234-4ef4-b2a5-2679ee85e6e0
                stepCounter: 7ed66403-af99-4a60-804e-96e3ed2bd730
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1a3c922-ce4a-4ffe-8205-23eac62333f2
          stepCounter: 69cfb682-3521-4e02-831b-fd85cb9c3678
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_pims_patient_prof_carers_30.prof_carer_role_type_reference_no=dim_professional_carer_role_type.professional_carer_role_type_reference_no
        name: DIM_PROFESSIONAL_CARER_ROLE_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2df6e3ed-1251-4ece-b75f-db4fc8f04ba3
                stepCounter: a2a7bc07-fa86-4e50-b74d-1153ccc69da7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 273e8756-fb10-44eb-ad6d-840fa055cec5
          stepCounter: 69cfb682-3521-4e02-831b-fd85cb9c3678
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: HEALTH_ORGANISATION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f520fe7c-9d44-4272-bbd3-de2b595e9006
                stepCounter: 7ed66403-af99-4a60-804e-96e3ed2bd730
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07391c1f-6c4e-4807-8842-c61bbf149293
          stepCounter: 69cfb682-3521-4e02-831b-fd85cb9c3678
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_pims_patient_prof_carers_30.health_organisation_reference_no=dim_health_organisation.health_org_reference_no
        name: DIM_HEALTH_ORG_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78290bb6-3cd5-4503-8179-d1f65525ba15
                stepCounter: 0790fdf4-e815-4587-a9cd-954ea13f53c6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5feada08-1aef-446c-bbd3-64b37baca074
          stepCounter: 69cfb682-3521-4e02-831b-fd85cb9c3678
        config: {}
        dataType: DATETIME2
        defaultValue: ""
        description: ""
        name: PATIENT_PROFESSIONAL_CARER_PERIOD_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d4f2b9f8-3f5d-45be-8fb8-4f471ef7c140
                stepCounter: 7ed66403-af99-4a60-804e-96e3ed2bd730
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec861bf9-b44c-46bf-8e0e-ccbc31026c8d
          stepCounter: 69cfb682-3521-4e02-831b-fd85cb9c3678
        config: {}
        dataType: DATETIME2
        defaultValue: ""
        description: ""
        name: PATIENT_PROFESSIONAL_CARER_PERIOD_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 940bb3cb-9152-43ff-a328-37ee365a433f
                stepCounter: 7ed66403-af99-4a60-804e-96e3ed2bd730
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e049157b-b259-419f-9e87-2698143448d3
          stepCounter: 69cfb682-3521-4e02-831b-fd85cb9c3678
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: HEORG_REFNO2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 143d5bea-7910-47ff-960e-f5b53740ff18
                stepCounter: 17c84dce-a03b-4c07-9d04-50059451ddd4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74943f9a-03d5-487f-8522-fefa4a9005a9
          stepCounter: 69cfb682-3521-4e02-831b-fd85cb9c3678
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: HEORG_START_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 37648fec-6d76-46f4-b187-2659bed808a7
                stepCounter: 17c84dce-a03b-4c07-9d04-50059451ddd4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 142af6ab-f651-447b-986d-9e07feda5505
          stepCounter: 69cfb682-3521-4e02-831b-fd85cb9c3678
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: HEORG_END_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4db678da-315f-4b1e-9eaa-677842e45490
                stepCounter: 17c84dce-a03b-4c07-9d04-50059451ddd4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d614c88-0d56-400b-b928-017ba8df6288
          stepCounter: 69cfb682-3521-4e02-831b-fd85cb9c3678
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94cef180-84bd-4860-90c1-5c9f2654d5f0
                stepCounter: 4f45d370-f46b-4d30-8837-83a353835394
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16ca8971-d79b-4327-9710-55aa07074d2f
          stepCounter: 69cfb682-3521-4e02-831b-fd85cb9c3678
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: LINE1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77ac4d23-904e-4722-8c85-b8601b2032b1
                stepCounter: eab2966a-ecca-4216-8448-50bff4ac8448
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42997dd5-3f61-44b0-a3ef-941b6a259c0a
          stepCounter: 69cfb682-3521-4e02-831b-fd85cb9c3678
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: LINE2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4faff0b2-80fd-4262-a296-a7a2c33d8921
                stepCounter: eab2966a-ecca-4216-8448-50bff4ac8448
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b318dd47-1f43-467e-b585-8213d4e14d0f
          stepCounter: 69cfb682-3521-4e02-831b-fd85cb9c3678
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: LINE3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8437e06b-b820-4ca2-85e8-99c6df35732b
                stepCounter: eab2966a-ecca-4216-8448-50bff4ac8448
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bec68410-3f48-42b9-ba61-4ead1c5af09b
          stepCounter: 69cfb682-3521-4e02-831b-fd85cb9c3678
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: LINE4
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4d7d795d-569e-43e2-bf0d-e240b2a31faf
                stepCounter: eab2966a-ecca-4216-8448-50bff4ac8448
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a46b447-01ec-4ce9-87d2-a23c6a7dc3be
          stepCounter: 69cfb682-3521-4e02-831b-fd85cb9c3678
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PHONE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9865e955-7ff1-4f1f-a324-9524b1bfe3d4
                stepCounter: 46e38d59-f2b3-442a-b66d-77cc64a7186e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0df58938-ef96-4167-ba3a-18ffe140a50d
          stepCounter: 69cfb682-3521-4e02-831b-fd85cb9c3678
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_PIMS_PATIENT_PROF_CARERS_15
        join:
          joinCondition: |-
            FROM s_pims_patient_prof_carers_15
              LEFT JOIN [dbo].[ds_pims_prof_carer_health_orgs]
                ON s_pims_patient_prof_carers_15.PROCA_REFNO = ds_pims_prof_carer_health_orgs.proca_refno
               AND s_pims_patient_prof_carers_15.HEORG_REFNO = ds_pims_prof_carer_health_orgs.heorg_refno
               AND s_pims_patient_prof_carers_15.START_DTTM BETWEEN ds_pims_prof_carer_health_orgs.start_dttm AND IFNULL(ds_pims_prof_carer_health_orgs.end_dttm,getdate())
               AND [ds_pims_prof_carer_health_orgs].archv_flag = 'N'
              LEFT JOIN [dbo].[ds_pims_health_organisations]
                ON ds_pims_prof_carer_health_orgs.heorg_refno = ds_pims_health_organisations.heorg_refno
               AND [ds_pims_health_organisations].archv_flag = 'N'
              LEFT JOIN [dbo].[s_pims_heorg_address_Postal_v]
                ON ds_pims_health_organisations.heorg_refno = s_pims_heorg_address_Postal_v.heorg_refno
               AND [s_pims_heorg_address_Postal_v].end_dttm IS NULL
              LEFT JOIN [dbo].[s_pims_heorg_address_Phone]
                ON ds_pims_health_organisations.heorg_refno = s_pims_heorg_address_Phone.heorg_refno
               AND [s_pims_heorg_address_Phone].end_dttm IS NULL
             WHERE 1 = 1
        name: S_PIMS_PATIENT_PROF_CARERS_30
        noLinkRefs: []
  name: S_PIMS_PATIENT_PROF_CARERS_30
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
