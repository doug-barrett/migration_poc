fileVersion: 1
id: 0dc48950-1618-4745-850e-0a75f39c5800
name: STAGE_OPUS_ORDER_ADDKEYS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cefbe11a-6af2-45e9-82ba-34cd6f6e77f9
          stepCounter: 0dc48950-1618-4745-850e-0a75f39c5800
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: OPUS_CONTACTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a6f9af9-be7f-4d21-8fa2-113279b41bca
                stepCounter: 92b541a9-bde9-4589-83f2-dc55c69a0757
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74aa1e46-3574-48ff-8bc7-e48886eb9a86
          stepCounter: 0dc48950-1618-4745-850e-0a75f39c5800
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: OPUSPRODUCTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a7284217-1be5-4550-b871-d3c057a5c106
                stepCounter: d63040c1-6075-45f1-a723-d8667ae09cf5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb22eb90-c805-4f8a-9445-de8be75093ff
          stepCounter: 0dc48950-1618-4745-850e-0a75f39c5800
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: OPUSCARTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cae767ad-0afc-4d05-903e-a6adc43c6805
                stepCounter: 27724535-d1fa-4df2-8b8f-280e8b1e9538
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1687b9a7-e639-4999-bac0-73d280f5c882
          stepCounter: 0dc48950-1618-4745-850e-0a75f39c5800
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: OPUSBILLINGADDRESSKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 87f4c965-1d95-4404-a621-bd156a5dd99c
                stepCounter: 230d9cd3-04bc-474c-a776-2f893e7e8579
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4cc646d-8c80-4a62-a402-e629527d5c0a
          stepCounter: 0dc48950-1618-4745-850e-0a75f39c5800
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: OPUSPAYMENTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ea1a43e-c4a3-4236-afdb-136af1f9fd8b
                stepCounter: 08ff0943-6f6b-4f8d-b315-564fe921ef0d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9862075f-d287-4c00-9623-ef7808ae436e
          stepCounter: 0dc48950-1618-4745-850e-0a75f39c5800
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEOPUS_ORDER_ADDKEYS.SUPPLIERID=OPUS_SUPPLIER.SUPPLIEROPUSID
        name: OPUSSUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11f9a13a-8aa9-47bc-81b6-a5a6d4d0ee80
                stepCounter: 9a72d1e4-1aba-4fd2-8b64-b6f16fb0a880
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d35ea5c-286d-485d-8ff1-08a8136d00ae
          stepCounter: 0dc48950-1618-4745-850e-0a75f39c5800
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: OPUSSHIPPINGADDRESSKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a347783-af26-47ea-8669-4182a26555c5
                stepCounter: d6d1db90-9b75-456d-9c43-379d7ef17bfa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b64ce178-6ebb-4863-9691-eab958bbf1ef
          stepCounter: 0dc48950-1618-4745-850e-0a75f39c5800
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: DIMCONTACTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83cf9f2b-90d3-43c6-a6b1-c06956fa7f02
                stepCounter: 35f8d78b-6e7b-4fb6-a9b9-11bebbacf1ea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cec41757-12bd-4c28-912b-9a58f2d6bd97
          stepCounter: 0dc48950-1618-4745-850e-0a75f39c5800
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: ACCOUNTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9809deca-da5b-4fe0-a80a-ab6cafa8782e
                stepCounter: 745ecacb-59f4-457a-9a6f-e827d225494e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 167b27f6-c768-4559-b57c-57ec26b91d6a
          stepCounter: 0dc48950-1618-4745-850e-0a75f39c5800
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED KEY FOR THE DATE DIMENSION. NOMINAL FORMAT IS YYYYMMDD, BUT DD EQUAL TO 0 AND GREATER THAN 31 PERMITED FOR SPECIAL DATE HANDLING.
        name: OPUSORDERDATEKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9bf2faeb-061d-4126-8500-e6433f0425da
                stepCounter: ac4a8f4b-4184-402f-9d4b-cf2f82eb58c8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c43f6ff0-60b8-4a15-8aa2-65bec2b1f05d
          stepCounter: 0dc48950-1618-4745-850e-0a75f39c5800
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PARENTORDERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d545f6ec-8e4c-47f6-ac2c-2427ff611c57
                stepCounter: 3996dc18-98cd-47aa-91ce-503f195bdf56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf899b22-a9cc-4b0d-b68a-1d2b9b21f3fb
          stepCounter: 0dc48950-1618-4745-850e-0a75f39c5800
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PARENTORDERNUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9888a8db-0d0f-4048-b3ca-2f3467d3af87
                stepCounter: 3996dc18-98cd-47aa-91ce-503f195bdf56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bbbda9ae-055f-46b6-a53e-34ff92718dfc
          stepCounter: 0dc48950-1618-4745-850e-0a75f39c5800
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SUPPLIERFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4f0297e-fa6c-47ad-a92b-176b626a7804
                stepCounter: 9a72d1e4-1aba-4fd2-8b64-b6f16fb0a880
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c540dabf-e9fb-41cb-bbeb-517782681d7e
          stepCounter: 0dc48950-1618-4745-850e-0a75f39c5800
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORDERNUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c37a019-3507-47ed-89aa-4f6e8b9bb016
                stepCounter: 3996dc18-98cd-47aa-91ce-503f195bdf56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 439d0a16-2959-433a-964a-527bdd2acfbc
          stepCounter: 0dc48950-1618-4745-850e-0a75f39c5800
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: ORDERDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 949f6680-f988-44dd-9407-2c229eb9a5c8
                stepCounter: 3996dc18-98cd-47aa-91ce-503f195bdf56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 35924c49-dbf0-479c-9f93-7d8190c761b5
          stepCounter: 0dc48950-1618-4745-850e-0a75f39c5800
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CARTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3ab84ace-e3a1-4e40-a0c8-348cd489a016
                stepCounter: 3996dc18-98cd-47aa-91ce-503f195bdf56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95efea7a-6f79-4b0c-846f-661e0b4d66c5
          stepCounter: 0dc48950-1618-4745-850e-0a75f39c5800
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: ORDERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 55c3e269-7729-4b1e-8812-5d3aa546a510
                stepCounter: 3996dc18-98cd-47aa-91ce-503f195bdf56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 496688dd-fc62-4c20-a03a-50e5ca02f8e3
          stepCounter: 0dc48950-1618-4745-850e-0a75f39c5800
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3d9524a2-77f9-4fc4-85ba-b1cdf2831d2e
                stepCounter: 3996dc18-98cd-47aa-91ce-503f195bdf56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0b8467d-74d8-44f6-8e2c-c347af949cca
          stepCounter: 0dc48950-1618-4745-850e-0a75f39c5800
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORDERSTATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0fca1b8f-a7bd-415e-ae6a-9fe570389b21
                stepCounter: 3996dc18-98cd-47aa-91ce-503f195bdf56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cfa6101c-c5ea-45db-9063-3dfd7dabdef3
          stepCounter: 0dc48950-1618-4745-850e-0a75f39c5800
        config: {}
        dataType: NUMBER(38,4)
        defaultValue: ""
        description: ""
        name: PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ad96ae73-c8c3-43c7-8f75-348fee0e3887
                stepCounter: 3996dc18-98cd-47aa-91ce-503f195bdf56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd5a7d99-4f60-4ee5-852b-42002fce53b9
          stepCounter: 0dc48950-1618-4745-850e-0a75f39c5800
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: QUANTITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b576989-69e6-4344-8880-38553a699fcf
                stepCounter: 3996dc18-98cd-47aa-91ce-503f195bdf56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 61f842b9-5cb3-43c2-a807-d6b8af1b6904
          stepCounter: 0dc48950-1618-4745-850e-0a75f39c5800
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PRODUCTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f04ad50d-d952-4bfb-b6eb-685fef887d78
                stepCounter: 3996dc18-98cd-47aa-91ce-503f195bdf56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d37aa33b-f932-4707-82a3-29cea5512290
          stepCounter: 0dc48950-1618-4745-850e-0a75f39c5800
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77d25daa-948a-440f-b372-7efe0cda8e03
                stepCounter: 3996dc18-98cd-47aa-91ce-503f195bdf56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c750e860-1fab-4974-9670-b10f5f9f9fa0
          stepCounter: 0dc48950-1618-4745-850e-0a75f39c5800
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e800191e-d347-4cb9-9972-902eab32e7dd
                stepCounter: 3996dc18-98cd-47aa-91ce-503f195bdf56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f08412a5-440b-442a-a0a9-2ada146f59bf
          stepCounter: 0dc48950-1618-4745-850e-0a75f39c5800
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PAYMENTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24113732-37b0-40d0-b598-98379dfd57d4
                stepCounter: 3996dc18-98cd-47aa-91ce-503f195bdf56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f0b26e8-eda7-47e7-a136-ca94447b681d
          stepCounter: 0dc48950-1618-4745-850e-0a75f39c5800
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: BILLINGADDRESSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1c698c2-6fc1-46f4-80b5-efb8f680d860
                stepCounter: 3996dc18-98cd-47aa-91ce-503f195bdf56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5555a87-ae9a-45c9-9a18-6a36c3727048
          stepCounter: 0dc48950-1618-4745-850e-0a75f39c5800
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: SHIPPINGADDRESSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e9be249-141b-4964-8059-a0e8287b0b8d
                stepCounter: 3996dc18-98cd-47aa-91ce-503f195bdf56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 880f2a8a-a700-45fd-a49b-36fc14ba7964
          stepCounter: 0dc48950-1618-4745-850e-0a75f39c5800
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c87bfbd4-7f9c-461c-9450-a83dce85de90
                stepCounter: 3996dc18-98cd-47aa-91ce-503f195bdf56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2aa3b140-5f94-46b1-a8f9-3db75c60af15
          stepCounter: 0dc48950-1618-4745-850e-0a75f39c5800
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 123361c8-59ce-4939-b1a5-8083019e23d4
                stepCounter: 3996dc18-98cd-47aa-91ce-503f195bdf56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0b4a2a6-4e1e-49bf-ac70-b40aa08f69d5
          stepCounter: 0dc48950-1618-4745-850e-0a75f39c5800
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc5b0092-4ce0-4e97-a8d7-2fe2ae3586e3
          stepCounter: 0dc48950-1618-4745-850e-0a75f39c5800
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          OPUS_PRODUCT: d63040c1-6075-45f1-a723-d8667ae09cf5
          OPUS_CART: 27724535-d1fa-4df2-8b8f-280e8b1e9538
          OPUS_BILLING_ADDRESS: 230d9cd3-04bc-474c-a776-2f893e7e8579
          OPUS_PAYMENT: 08ff0943-6f6b-4f8d-b315-564fe921ef0d
          OPUS_SHIPPING_ADDRESS: d6d1db90-9b75-456d-9c43-379d7ef17bfa
          CONTACT: 35f8d78b-6e7b-4fb6-a9b9-11bebbacf1ea
          ACCOUNT: 745ecacb-59f4-457a-9a6f-e827d225494e
          OPUS_CONTACT: 92b541a9-bde9-4589-83f2-dc55c69a0757
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: DIM
            nodeName: CONTACT
          - locationName: DIM
            nodeName: OPUS_BILLING_ADDRESS
          - locationName: DIM
            nodeName: OPUS_CART
          - locationName: DIM
            nodeName: OPUS_CONTACT
          - locationName: DIM
            nodeName: OPUS_PAYMENT
          - locationName: DIM
            nodeName: OPUS_PRODUCT
          - locationName: DIM
            nodeName: OPUS_SHIPPING_ADDRESS
          - locationName: DIM
            nodeName: OPUS_SUPPLIER
          - locationName: DIM
            nodeName: VW_OPUS_ORDER_DATE
          - locationName: STAGE
            nodeName: STAGE_FACT_OPUS_ORDER
          - locationName: UNKNOWN
            nodeName: STAGEFACT_OPUS_ORDER
          - locationName: UNKNOWN
            nodeName: VWOPUS_ORDER_DATE
        join:
          joinCondition: |-
            FROM {{ ref('UNKNOWN','STAGEFACT_OPUS_ORDER') }} STAGEFACT_OPUS_ORDER
              LEFT JOIN {{ ref('DIM','OPUS_PRODUCT') }} OPUS_PRODUCT
                ON STAGEFACT_OPUS_ORDER.PRODUCTID = OPUS_PRODUCT.PRODUCTID
              LEFT JOIN {{ ref('DIM','OPUS_CART') }} OPUS_CART
                ON STAGEFACT_OPUS_ORDER.CARTID = OPUS_CART.CARTID
              LEFT JOIN {{ ref('DIM','OPUS_BILLING_ADDRESS') }} OPUS_BILLING_ADDRESS
                ON STAGEFACT_OPUS_ORDER.BILLINGADDRESSID = OPUS_BILLING_ADDRESS.BILLINGADDRESSID
               AND STAGEFACT_OPUS_ORDER.ORGANIZATIONID = OPUS_BILLING_ADDRESS.ORGANIZATIONID
              LEFT JOIN {{ ref('DIM','OPUS_PAYMENT') }} OPUS_PAYMENT
                ON STAGEFACT_OPUS_ORDER.PAYMENTID = OPUS_PAYMENT.PAYMENTID
              LEFT JOIN {{ ref('DIM','OPUS_SHIPPING_ADDRESS') }} OPUS_SHIPPING_ADDRESS
                ON STAGEFACT_OPUS_ORDER.SHIPPINGADDRESSID = OPUS_SHIPPING_ADDRESS.SHIPPINGADDRESSID
               AND STAGEFACT_OPUS_ORDER.ORGANIZATIONID = OPUS_SHIPPING_ADDRESS.ORGANIZATIONID
              LEFT JOIN {{ ref('DIM','CONTACT') }} CONTACT
                ON STAGEFACT_OPUS_ORDER.CUSTOMERID = CONTACT.OPUS_CUSTOMER_ID
              LEFT JOIN {{ ref('DIM','ACCOUNT') }} ACCOUNT
                ON STAGEFACT_OPUS_ORDER.ORGANIZATIONID = ACCOUNT.OPUS_ORGANIZATION_ID
              LEFT JOIN {{ ref('UNKNOWN','VWOPUS_ORDER_DATE') }} VWOPUS_ORDER_DATE
                ON STAGEFACT_OPUS_ORDER.ORDERDATE = VWOPUS_ORDER_DATE.OPUS_ORDER_CALENDAR_DATE
              LEFT JOIN {{ ref('DIM','OPUS_CONTACT') }} OPUS_CONTACT
                ON STAGEFACT_OPUS_ORDER.CUSTOMERID = OPUS_CONTACT.CUSTOMERID
               AND STAGEFACT_OPUS_ORDER.ORGANIZATIONID = OPUS_CONTACT.ORGANIZATIONID
        name: STAGEOPUS_ORDER_ADDKEYS
        noLinkRefs: []
  name: STAGE_OPUS_ORDER_ADDKEYS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
