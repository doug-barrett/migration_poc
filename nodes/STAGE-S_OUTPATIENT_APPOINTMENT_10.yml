fileVersion: 1
id: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
name: S_OUTPATIENT_APPOINTMENT_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: false
  description: "Outpatients are Schedules of \"schedule_type_code\"  \"OTPAT\"   (\"Outpatients Schedules\" )  "
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8fa01baa-6dba-4928-a84b-2a1e3b8099ae
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ACC_FUNDED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN ds_shared_schedule.admin_category_reference_no = 1000000046 THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c5d1361-cf3c-478d-a6f8-40bad7e902a8
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMIN_CATEGORY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6c388e2-f768-471e-9bc6-3cd483eed0a4
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ANAESTHETIC_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c0974fe-2cfd-427a-a593-d767ba5e4ae8
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTED_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ISNULL(ds_shared_schedule.clinician_reference_no,ds_shared_schedule_parent.clinician_reference_no)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b84b1d0f-64ed-4718-9151-351aa6a53c79
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: APPOINTMENT_CALLED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c7f36502-1313-4ea2-9a2c-710f395be713
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_CHANGE_REQUEST_BY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42d5d71b-356e-455f-88da-c2702ea62bea
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: appointment_contact_status_code, "A=Actual", "P=Planned", "C=Cancelled"
        name: APPOINTMENT_CONTACT_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87f4a8ce-589e-49a4-8ba4-3cdf4585ca8c
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8202ac76-8874-4a8c-bea0-2a794913e3fb
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_DURATION_ARRIVED_TO_DEPARTED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e252c6ba-ed9e-404b-939e-4960342eb303
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: APPOINTMENT_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df63d84d-254e-47b5-86da-58c3944a11fc
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: APPOINTMENT_MOVEMENT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1bdb6fef-59bf-4b7f-b85b-12c538ec1f68
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_MOVEMENT_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: baa52063-0d59-43fb-acb5-8e932666cb0a
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_OUTCOME_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d624fdcb-3df3-4ed8-811e-f513c6cb4999
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: APPOINTMENT_REQUEST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96361c36-3b2a-4180-bca9-9b3281c8c903
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: appointment_status_type_code, "A=Actual", "P=Planned", "C=Cancelled"
        name: APPOINTMENT_STATUS_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6373d92-1032-475e-a490-cfab1a021141
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: APPROXIMATE_SCHEDULE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4159112-9ebc-4978-83a0-3e6f0ce68967
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: ATTENDANCE_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1c7f2cc-f2bc-4c16-966a-a7bc11f15c00
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ATTENDANCE_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b51a1bb-f978-4d49-b298-0ea4c1313fd1
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: BOOKING_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c7c05cc-2c0e-4d00-b539-2a9b53360f0f
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CANCELLATION_BY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb6b5dcf-8f13-4c22-a76a-d31f2d16fa1f
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: cancellation_Reason_Code
        name: CANCELLATION_REASON_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59362a45-a75c-46e5-9757-a944116e71e4
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CANCELLATION_REASON_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86259c59-8996-42c4-90d1-ff782d5394da
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CANCELLATION_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 737cbded-0bd1-4b92-8441-b1e7dc4066e8
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CODING_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eceafed1-6455-4a16-a5e5-d6cf82211c89
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CONTACT_PURPOSE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1681cd4c-52af-4e7f-9ffa-e9a68486d784
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CONTACT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b81906e8-f79e-4107-ad55-3e9bad5adba1
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2e3aac4-f584-4a56-beb3-b7f24ffdb916
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69f349ed-89f7-4b95-bd39-23a73193dd5f
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DID_NOT_ATTEND_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 61a40f1b-93e5-4260-83dd-3bdae89e3848
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DSS_DATA_QUALITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE WHEN ISNULL(ds_shared_schedule.service_point_session_reference_no,ds_shared_schedule_parent.service_point_session_reference_no) IS NULL THEN CASE WHEN ds_shared_schedule.dss_data_quality_code IS NULL THEN 'SESSN' ELSE ds_shared_schedule.dss_data_quality_code + ',SESSN' END
                          ELSE ds_shared_schedule.dss_data_quality_code
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1dd48ee-53bc-45a8-83f3-9e650aa7d1a8
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0382e669-c1b3-43b3-ba68-aae901ca0044
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ED_ATTENDANCE_REFERENCE_NO_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34f024b6-5cda-45f4-a851-7fd411b8dae1
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: 'The first appointment on a referral. Used for setting purhcase unit business rules. '
        name: FIRST_REFERRAL_APPOINTMENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64f44b9b-dbaf-457a-877d-2619f7231f07
                stepCounter: 89a3d047-ef50-4c61-b03b-096d3b4777fb
            transform: |-
              --  CASE WHEN  ROW_NUMBER() OVER (PARTITION BY ds_shared_schedule.referral_reference_no
              --                 ORDER BY ds_shared_schedule.start_date) = 1 THEN 'Y' ELSE 'N' END
              CASE WHEN s_outpatient_appointment_08.referral_appointment_seq_num = 1 THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a4ad4453-19f7-4f3d-bf79-956e7379f129
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FOLLOWUP_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d4e5c70-1c37-4499-98c5-389731f200f4
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FUNDING_ARRANGEMENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6768a348-1d5b-4675-a12e-81cc2e9bc9ee
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: IP_EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'H' + cast(ds_shared_schedule.prvsp_refno AS varchar(20))"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f435511-c267-49b3-afe4-c42bbe0050e2
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: IP_WARD_STAY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 129738a1-ba48-4c86-8efa-c3d898653b07
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIFY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d118896-2191-4549-bcd1-2d173e3b0fbd
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MODIFY_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 28eb88c1-5d08-4e1a-af19-6ef5a39fc36b
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OLD_APPOINTMENT_OUTCOME_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c836f4b4-ab4b-43ef-a4fe-70b925bdd87c
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OPERATION_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 986676d1-b588-42be-9e20-86e201ffe160
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: OUTPATIENT_APPOINTMENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "'T'+CONVERT(varchar,ds_shared_schedule.schedule_reference_no)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 993d30d4-f859-4dd2-b485-5f0e4a938d85
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: APPOINTMENT_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9528ffe5-f032-45d9-831f-d2059d65e6c8
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2c800f9-cacf-4e42-b363-72397db30eba
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: appointment_theatre_status_code, "A=Actual", "P=Planned", "C=Cancelled"
        name: APPOINTMENT_THEATRE_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab97b5f1-e9ff-4b81-bad4-aab9a49a0a3d
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Health Specialty Code
        name: OUTPATIENT_HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ISNULL(ds_shared_schedule.health_specialty_code,ds_shared_schedule_parent.health_specialty_code)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ef4a228-ebbe-499f-b70e-ab39162648d7
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: SCHEDULE_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25537e70-cb09-4fa0-bdc8-d2c2dc5e4a3f
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42982985-585f-47f2-9360-ba89bdacaebc
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: OVERBOOKED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bacf04c9-44f6-4e09-91bc-8c154c5ca255
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PARENT_SEEN_BY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 036cc7bb-bf9a-4dc2-b196-511dfe4c8b1c
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PARENT_APPOINTED_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75b1c79f-25f2-447b-82ab-e1d8bcf9a6e1
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ISNULL(ds_shared_schedule.seen_by_clinician_reference_no,ds_shared_schedule_parent.seen_by_clinician_reference_no)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b546e427-aa7e-45e9-b2ba-3d887df55087
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PATIENT_SEEN_BY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df7e6de9-0a21-485c-8199-2c5e705c31d1
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PARENT_OUTPATIENT_APPOINTMENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a7aba77-6473-499c-a987-7087af601008
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OUTPATIENT_SESSION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ISNULL(ds_shared_schedule.service_point_session_reference_no,ds_shared_schedule_parent.service_point_session_reference_no)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 166fe798-e58f-4186-9499-d9f416a359c8
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PARENT_OUTPATIENT_SESSION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a4028ed-b439-49e2-8ac4-af5e125a4d64
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_APPOINTMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9e4cd755-abb9-41a1-a595-19d057fa0872
                stepCounter: 89a3d047-ef50-4c61-b03b-096d3b4777fb
            transform: --COUNT(1) OVER (PARTITION BY ds_shared_schedule.service_point_session_reference_no)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0a40752-5176-4e08-af1a-080a5e22287e
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_APPOINTMENT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9980a5da-f471-48d2-9658-eb5abb0f74ef
                stepCounter: 89a3d047-ef50-4c61-b03b-096d3b4777fb
            transform: |-
              --ROW_NUMBER() OVER (PARTITION BY ds_shared_schedule.service_point_session_reference_no
              --ORDER BY ds_shared_schedule.start_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd2057ef-c59c-44d7-b4bc-0ac41d287146
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_AGE_ON_ARRIVAL_YEARS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: FLOOR(DATEDIFF(dd,dim_patient.patient_date_of_birth, CASE WHEN ISNULL(dim_patient.patient_date_of_death,ds_shared_schedule.start_date) < ds_shared_schedule.start_date THEN ISNULL(dim_patient.patient_date_of_death,ds_shared_schedule.start_date) ELSE ds_shared_schedule.start_date END) / 365.25)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24f85e66-f719-4971-be6f-aee66dc624d4
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OUTPATIENT_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ISNULL(ds_shared_schedule.specialty_reference_no,ds_shared_schedule_parent.specialty_reference_no)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0807d8d6-a8f9-4915-b87a-03b0969d99a1
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_APPOINTMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d7f12f50-0be3-403e-94b4-d831e16022a5
                stepCounter: 89a3d047-ef50-4c61-b03b-096d3b4777fb
            transform: --COUNT(1) OVER (PARTITION BY ds_shared_schedule.patient_reference_no)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0fdcdbcd-c884-4f34-b851-b7640973e4f6
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PARENT_OUTPATIENT_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f0f54ec-4442-4129-abe8-690d77d774e8
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: APPOINTMENT_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3e1fd63-84b2-4a27-b4ab-8cd1364754bc
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_APPOINTMENT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8631c6a-1f22-4971-8d20-be29ce918076
                stepCounter: 89a3d047-ef50-4c61-b03b-096d3b4777fb
            transform: |-
              --ROW_NUMBER() OVER (PARTITION BY ds_shared_schedule.patient_reference_no
              --ORDER BY ds_shared_schedule.start_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 13aaf69f-8490-443b-bdbe-ee5ec1754afb
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: TRANSPORT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a566422-0c54-49b9-b366-d0106d4ee16d
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PATIENT_ARRIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 757cd397-2218-49e2-8263-6017efc3f66f
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_CONFIRMATION_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e8c8c0d-48dd-4d70-b4d8-312fd3287e00
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: TREATMENT_DECISION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7c2dcae-ab2a-4b3c-a58b-49742a80f022
                stepCounter: ade37d4e-d83f-4407-b139-f5f8d334d5ea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9b704ea-ee41-4e0c-a0c6-40321b72398a
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: TREATMENT_DELAY_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 95343780-cbd2-4bea-a071-24f2b6dd0726
                stepCounter: ade37d4e-d83f-4407-b139-f5f8d334d5ea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4035386e-b955-4ea3-b3a4-164c88ff4b65
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Patient_Date_Of_Birth
        name: PATIENT_DATE_OF_BIRTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bfa6022f-b8fe-4731-ba13-98bc0c2ac06a
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: OLB_REQUESTED_DTTM
        name: OLB_REQUESTED_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 753cc377-03a6-4308-9d3a-a3f233be5e64
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Patient_Date_Of_Death
        name: PATIENT_DATE_OF_DEATH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 44f8d969-c59b-42d6-84fb-a093899fea00
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: UNPLANNED_RETURN_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc5a1562-fedb-4c61-9088-6ec158a7d61b
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PATIENT_DEPARTED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e083d04-5d3b-4b0b-a2bf-83e74bfa3bc0
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: URGENCY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55550ff2-d886-4b90-9017-6a027540efe7
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: VISIT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 108064b1-1a63-4ba9-8426-1b5529cec42d
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b6ea91c-fdd3-4239-8a0a-1877df991a14
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9ffe493-f986-4786-bf44-069b4ad5dff2
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3452b29-c0cd-425a-9d1d-71e6d86d015f
                stepCounter: f11a6090-a295-49e8-9ae4-052de05fcf53
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41120955-abcf-4914-8096-18dc14715900
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Sequence for appointment within waitlist ordered from most recent to oldest
        name: WAITLIST_SCHEDULE_REV_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: efc87a00-429a-4c47-bab4-98ffabb64e89
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Sequence for appointment within waitlist ordered from oldest to most recent
        name: WAITLIST_SCHEDULE_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 56d3f88b-a898-41ed-8c25-408bc3fb4d99
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREVIOUS_APPOINTMENT_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a4866898-5862-4ceb-b82d-b4f0df7b8948
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OUTPATIENT_CLINIC_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ISNULL(ds_shared_schedule.ward_reference_no,ds_shared_schedule_parent.ward_reference_no)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4adf693e-92d4-48f4-8074-ca8624ec65cc
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PRIMARY_PROCEDURE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b314205-2748-42d5-8078-03c39489c590
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRIMARY_PROCEDURE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 826017b4-b245-467c-9fb1-a9bdad6bf9ed
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PARENT_OUTPATIENT_CLINIC_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 348da2ca-9ded-451d-a5d1-542826113b9d
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: PRIMARY_PROCEDURE_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d316a6a-6e65-41a7-bda5-84c0f0962175
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PRINCIPAL_DIAGNOSIS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE WHEN s_outpatient_diagnosis_procedure_d1.diagnosis_procedure_code IN ('','-1') THEN NULL
                          ELSE s_outpatient_diagnosis_procedure_d1.diagnosis_procedure_code
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b57b418-4592-4522-9f90-c67ba8e5ebeb
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OUTPATIENT_APPOINTMENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14a44ab9-7d5a-4388-88fa-195a71a4692c
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRINCIPAL_DIAGNOSIS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a4aead8c-6114-4281-859b-aec32996ca68
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: PRINCIPAL_DIAGNOSIS_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4547ca44-b410-4b3e-a20d-6f82c5bd15d1
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRIORITY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b3e2d73-35da-461f-ab2c-c94c3748cb75
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: REASN_COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21429860-03f9-48b4-b85a-253d79693e44
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_APPOINTMENT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64f44b9b-dbaf-457a-877d-2619f7231f07
                stepCounter: 89a3d047-ef50-4c61-b03b-096d3b4777fb
            transform: |-
              --ROW_NUMBER() OVER (PARTITION BY ds_shared_schedule.referral_reference_no
              --ORDER BY ds_shared_schedule.start_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 13c59989-bdff-42eb-b584-3c115a7bf74f
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd35d17f-4e4f-4d25-87b6-840bfba80ebf
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3bd5f356-9c51-4ee4-9447-0a7a26561c4e
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_SCHEDULE_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a111072-c33e-429a-a74a-bcfeff965ad1
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: SCHDL_COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e625a210-2242-466d-9cbd-c4b421868461
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: number of time the appointment has been rescheduled
        name: SCHEDULE_MOVEMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f283e69a-236a-4327-a3d9-5f99bd5c2fdb
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SCHEDULE_MOVEMENT_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06adbc55-77c4-4e61-8c68-153287408f99
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SECONDARY_DIAGNOSIS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d8c480c-60e2-4a85-8e3a-3e9de5ce267e
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SECONDARY_DIAGNOSIS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fdeff383-d0bd-4a34-b567-3504f89fcea6
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: SECONDARY_DIAGNOSIS_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ad87052-abe5-4b95-bf78-4eefad8aba8c
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SECONDARY_PROCEDURE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6408f1d-1bd1-44a6-9e65-731e8d1af61c
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SECONDARY_PROCEDURE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bec6b52d-66a1-4602-a91d-7a7249639180
          stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: SECONDARY_PROCEDURE_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies: []
        join:
          joinCondition: |-
            FROM s_outpatient_appointment_05
              JOIN ds_shared_schedule
                ON ds_shared_schedule.patient_reference_no = s_outpatient_appointment_05.patient_reference_no -- and isnull(ds_shared_schedule.service_point_session_reference_no,0) = isnull(s_outpatient_appointment_05.service_point_session_reference_no,0)     INNER JOIN dim.dim_patient    ON ds_shared_schedule.patient_reference_no = dim.dim_patient.patient_reference_no      LEFT OUTER JOIN ds_shared_schedule ds_shared_schedule_parent     ON ds_shared_schedule.parent_schedule_reference_no IS NOT NULL     AND ds_shared_schedule.parent_schedule_reference_no = ds_shared_schedule_parent.schedule_reference_no       LEFT OUTER JOIN ds_outpatient_diagnosis_procedure s_outpatient_diagnosis_procedure_d1    ON ds_shared_schedule.schedule_reference_no = s_outpatient_diagnosis_procedure_d1.outpatient_reference_no    AND s_outpatient_diagnosis_procedure_d1.diagnosis_procedure_type_code = 'DIAGN'    AND s_outpatient_diagnosis_procedure_d1.medical_problem_level_no = 1 -- 'PRIME'      LEFT OUTER JOIN ds_outpatient_diagnosis_procedure s_outpatient_diagnosis_procedure_d2    ON ds_shared_schedule.schedule_reference_no = s_outpatient_diagnosis_procedure_d2.outpatient_reference_no    AND s_outpatient_diagnosis_procedure_d2.diagnosis_procedure_type_code = 'DIAGN'    AND s_outpatient_diagnosis_procedure_d2.medical_problem_level_no = 2 -- 'SECND'      LEFT OUTER JOIN ds_outpatient_diagnosis_procedure s_outpatient_diagnosis_procedure_p1    ON ds_shared_schedule.schedule_reference_no = s_outpatient_diagnosis_procedure_p1.outpatient_reference_no    AND s_outpatient_diagnosis_procedure_p1.diagnosis_procedure_type_code = 'PROCE'    AND s_outpatient_diagnosis_procedure_p1.medical_problem_level_no = 1 -- 'PRIME'      LEFT OUTER JOIN ds_outpatient_diagnosis_procedure s_outpatient_diagnosis_procedure_p2    ON ds_shared_schedule.schedule_reference_no = s_outpatient_diagnosis_procedure_p2.outpatient_reference_no    AND s_outpatient_diagnosis_procedure_p2.diagnosis_procedure_type_code = 'PROCE'    AND s_outpatient_diagnosis_procedure_p2.medical_problem_level_no = 2 -- 'SECND'      LEFT OUTER JOIN s_outpatient_ldd_data_value    ON ds_shared_schedule.schedule_reference_no = s_outpatient_ldd_data_value.schedule_reference_no      LEFT OUTER JOIN s_outpatient_appointment_08    ON ds_shared_schedule.schedule_reference_no = s_outpatient_appointment_08.schedule_reference_no    --5261169    --4915019    left join (select OLB_REQUESTED_DTTM,SORCE_REFNO from l_pims_OBOOKING_OLB_OFFER_STAGE olb                 WHERE   1=1                AND OLB.SORCE_CODE = 'SCHDL'              AND OLB.OLB_REQUESTED_FLAG = 'Y'               AND OLB.OLB_REQUESTED_DTTM IS NOT NULL               AND isnull (OLB.ARCHV_FLAG, 'N') = 'N'             AND OLB.NEW_SCHDL_REFNO IS NULL  )l_pims_OBOOKING_OLB_OFFER_STAGE    on ds_shared_schedule.schedule_reference_no = l_pims_OBOOKING_OLB_OFFER_STAGE.SORCE_REFNO   WHERE ds_shared_schedule.schedule_type_code = 'OTPAT' -- Outpatient
        name: S_OUTPATIENT_APPOINTMENT_10
        noLinkRefs: []
  name: S_OUTPATIENT_APPOINTMENT_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
