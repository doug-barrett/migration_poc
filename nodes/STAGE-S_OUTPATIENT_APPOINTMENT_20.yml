fileVersion: 1
id: b53b4d60-f49a-4251-a3ac-196984981a97
name: S_OUTPATIENT_APPOINTMENT_20
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06695644-137c-467e-a143-2588518f66b3
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ACC_FUNDED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8fa01baa-6dba-4928-a84b-2a1e3b8099ae
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05cbdd73-ea66-46c6-a524-ac8d5f58556c
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: NUMERIC(15,2)
        defaultValue: ""
        description: Actual cost from costing system
        name: ACTUAL_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cac9ace6-f1a1-4f02-8ec5-bed48dfd9ec9
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMIN_CATEGORY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3c5d1361-cf3c-478d-a6f8-40bad7e902a8
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5994072c-3776-4150-bb1b-cd3cc164e41d
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ANAESTHETIC_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c6c388e2-f768-471e-9bc6-3cd483eed0a4
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0560ed61-96fe-44a0-a972-7676078e3e92
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTED_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c0974fe-2cfd-427a-a593-d767ba5e4ae8
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1245c48a-231d-4318-a850-635d36331057
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: APPOINTMENT_CALLED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b84b1d0f-64ed-4718-9151-351aa6a53c79
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7218736-5cee-4f6b-81d8-ee0f37ddb436
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_CHANGE_REQUEST_BY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7f36502-1313-4ea2-9a2c-710f395be713
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8dea624c-90e7-46ad-9dc4-db7b291fa8ea
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: appointment_contact_status_code, "A=Actual", "P=Planned", "C=Cancelled"
        name: APPOINTMENT_CONTACT_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 42d5d71b-356e-455f-88da-c2702ea62bea
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6118edce-4ce0-45f3-89fa-ae11973e2b0c
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 87f4a8ce-589e-49a4-8ba4-3cdf4585ca8c
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae79b56e-7912-46c0-bf55-d96841813520
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_DURATION_ARRIVED_TO_DEPARTED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8202ac76-8874-4a8c-bea0-2a794913e3fb
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ce8e776-e19d-4e61-80f5-73d940e72fb6
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: APPOINTMENT_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e252c6ba-ed9e-404b-939e-4960342eb303
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9e7f7bd-e411-494e-a072-19e47e99f7c5
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: APPOINTMENT_MOVEMENT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: df63d84d-254e-47b5-86da-58c3944a11fc
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c97b2fa0-e2e4-40a5-b5c2-ab17a7c6e493
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_MOVEMENT_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1bdb6fef-59bf-4b7f-b85b-12c538ec1f68
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c82e4700-09d2-4133-bc37-14423f9d6849
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_OUTCOME_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: baa52063-0d59-43fb-acb5-8e932666cb0a
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 161d53a3-7291-486d-aa4b-99cad9d63ca5
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: APPOINTMENT_REQUEST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d624fdcb-3df3-4ed8-811e-f513c6cb4999
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 145ed7f7-7549-4696-b6d0-ec8a121d6aad
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: APPOINTMENT_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2f0f54ec-4442-4129-abe8-690d77d774e8
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3181d17-f08b-49cb-8c50-94b48158885b
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: APPOINTMENT_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 993d30d4-f859-4dd2-b485-5f0e4a938d85
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef10869b-d2aa-46bb-99fb-51495a3b0475
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9528ffe5-f032-45d9-831f-d2059d65e6c8
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a080cd2-42f3-4a4d-b77b-ee806a8520a5
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: appointment_status_type_code, "A=Actual", "P=Planned", "C=Cancelled"
        name: APPOINTMENT_STATUS_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 96361c36-3b2a-4180-bca9-9b3281c8c903
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d86368c-3073-478e-9d2c-df1831db6475
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: appointment_theatre_status_code, "A=Actual", "P=Planned", "C=Cancelled"
        name: APPOINTMENT_THEATRE_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2c800f9-cacf-4e42-b363-72397db30eba
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40c023d0-9463-453b-92ed-23714cb3e994
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 25537e70-cb09-4fa0-bdc8-d2c2dc5e4a3f
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 56cf0c6b-dc9c-45b2-bb25-47d6e95439e4
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: APPROXIMATE_SCHEDULE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a6373d92-1032-475e-a490-cfab1a021141
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 948ed0fe-3cad-4fd5-b840-607c64937af0
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: ATTENDANCE_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d4159112-9ebc-4978-83a0-3e6f0ce68967
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a40a5145-d9f8-4372-b9a4-b5712fa6b53c
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ATTENDANCE_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1c7f2cc-f2bc-4c16-966a-a7bc11f15c00
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 623befd5-a9e9-443f-9f81-27ce3a9c6a91
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: BOOKING_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b51a1bb-f978-4d49-b298-0ea4c1313fd1
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e72169c-ac34-4d6f-ab2c-14a48ff5de43
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CANCELLATION_BY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c7c05cc-2c0e-4d00-b539-2a9b53360f0f
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 159a571e-f6df-4302-b6d7-5cc613e6d4d5
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: cancellation_Reason_Code
        name: CANCELLATION_REASON_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb6b5dcf-8f13-4c22-a76a-d31f2d16fa1f
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c00b85f6-64eb-4da3-83fd-d690da244b5b
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CANCELLATION_REASON_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59362a45-a75c-46e5-9757-a944116e71e4
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: adf5360d-9785-4f72-b7cc-bef43b164b34
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CANCELLATION_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 86259c59-8996-42c4-90d1-ff782d5394da
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29bd9acb-4613-4ee9-a4e3-db25b8840d0c
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CODING_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 737cbded-0bd1-4b92-8441-b1e7dc4066e8
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f37486f4-7eb7-45a2-a188-a7c904fe535a
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: VARCHAR(MAX)
        defaultValue: ""
        description: ""
        name: COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ffb3145-140e-4bf2-a1cf-f4485dbbfe52
                stepCounter: 035e1bf5-96f7-4e2d-a6b9-8b524cf18c1e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 090895c6-38e2-436e-9a42-5e92b53b2f87
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CONTACT_PURPOSE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eceafed1-6455-4a16-a5e5-d6cf82211c89
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4182f86a-fd89-41f1-a3a5-db0cdd73c09b
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CONTACT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1681cd4c-52af-4e7f-9ffa-e9a68486d784
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ca9ff54-7877-4c31-8cee-382c61a8e42f
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: COSTED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'N'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47a4e912-7067-4313-a5e0-927277249ca7
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b81906e8-f79e-4107-ad55-3e9bad5adba1
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5fc6b884-1b69-4055-99b4-d76c93a4ee03
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2e3aac4-f584-4a56-beb3-b7f24ffdb916
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e68b3a4-2e12-44d3-a0d6-de7d46cd5d6c
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CURRENT_TO_NEXT_APPOINTMENT_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e252c6ba-ed9e-404b-939e-4960342eb303
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: DATEDIFF(mi,s_outpatient_appointment_10.appointment_end_date,s_outpatient_appointment_prev_next.next_appointment_start_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e7028ab-7071-451f-aaac-f2759b7dc13f
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: DEFAULT_PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa787dea-ef65-42d4-9e95-8db1f3dd72d4
                stepCounter: 1c24214a-aac0-49a5-a589-934f2afadcfc
            transform: |-
              CASE WHEN s_outpatient_appointment_10.patient_age_on_arrival_years >= 65 AND ds_mappings_PurchaseUnit_IPM_Outpatients_RC.[default_purchase_unit_code_over_65] IS NOT NULL THEN ds_mappings_PurchaseUnit_IPM_Outpatients_RC.[default_purchase_unit_code_over_65]
                          ELSE ds_mappings_PurchaseUnit_IPM_Outpatients_rc.[default_purchase_unit_code]
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf73ebc6-9a21-4f6c-9cf4-e3d2f5333318
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DEFAULT_RC_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c2a3b5c2-4af0-413e-804c-7981982790a9
                stepCounter: 1c24214a-aac0-49a5-a589-934f2afadcfc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42071788-bd0f-47b9-a83e-a3b4e51b1324
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DID_NOT_ATTEND_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 69f349ed-89f7-4b95-bd39-23a73193dd5f
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fefbd959-1bf5-4db8-a413-db849c1ba99b
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: Domilce code as at visit date
        name: DOMICILE_CODE
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e184db59-4bbb-4b99-af1f-917f2f645541
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DSS_DATA_QUALITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 61a40f1b-93e5-4260-83dd-3bdae89e3848
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 721b668c-1934-4840-b88a-ff3823981df0
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d564dbf-9c6f-44e0-958f-0e6552b493a9
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DURATION_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'minute'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 323c5852-4a4e-4ad2-b945-45b09fc65680
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: FIRST_APPOINTED_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dfbfaf8f-4683-4731-aa85-01f7b1aa5f8c
                stepCounter: fa6209e9-8a2c-4e8d-9c31-ec58ab029953
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd28b1ff-8ed9-419b-82cf-c71372db3378
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_APPOINTMENT_ARRIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5a84a7c-02c0-4b1a-8a57-94303884ef3a
                stepCounter: fa6209e9-8a2c-4e8d-9c31-ec58ab029953
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98e70ef6-7df9-4981-96cf-fb35d076a0e7
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_APPOINTMENT_SEEN_BY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 760d81b6-d423-45fb-829f-bec4841b0ed3
                stepCounter: fa6209e9-8a2c-4e8d-9c31-ec58ab029953
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4235b44-5ae1-46f4-ac65-2c7fb920e4e1
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FIRST_OUTPATIENT_APPOINTMENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 854e2fc9-33ec-40e1-ac69-f816b8c26f31
                stepCounter: fa6209e9-8a2c-4e8d-9c31-ec58ab029953
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca074d03-5196-449f-af9e-161c6ae40c7c
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: FIRST_OUTPATIENT_CLINIC_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5c05886-97bd-47ee-9fb7-89636f5f3c85
                stepCounter: fa6209e9-8a2c-4e8d-9c31-ec58ab029953
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55a173c3-8943-4b5a-909f-04e0c61790d2
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: FIRST_OUTPATIENT_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4eb582d1-b4d7-49e2-89cf-52fcb9227ee4
                stepCounter: fa6209e9-8a2c-4e8d-9c31-ec58ab029953
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b4f1f04-065f-45a3-89c2-b4e57568f064
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: FIRST_REFERRAL_APPOINTMENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 34f024b6-5cda-45f4-a851-7fd411b8dae1
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 13746378-0ad6-406b-a545-24fa12d2c040
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FOLLOWUP_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4ad4453-19f7-4f3d-bf79-956e7379f129
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6dab76f-513f-411f-9e04-6d254198e20c
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FUNDING_ARRANGEMENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0d4e5c70-1c37-4499-98c5-389731f200f4
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2215a719-65c5-478d-934c-ebf79207fac8
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: HAC_DNA_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5991893d-ff3c-4ffe-bd47-90f7c925f9c0
                stepCounter: 1c24214a-aac0-49a5-a589-934f2afadcfc
            transform: |-
              CASE WHEN cast(s_outpatient_appointment_10.appointment_start_date AS date) <= cast(getdate() AS date) AND s_outpatient_appointment_10.appointment_status_code = 'BOOKD' THEN isnull(ds_reference_IPM_Outpatient_PU.HAC_DNA_Flag, ds_mappings_PurchaseUnit_IPM_Outpatients_RC.HAC_DNA_flag)
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a488b3c-d04a-4f7a-8f81-77b38a42e539
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: IP_EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6768a348-1d5b-4675-a12e-81cc2e9bc9ee
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 43a04798-6128-4373-8fcd-5b2055999a97
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: IP_WARD_STAY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f435511-c267-49b3-afe4-c42bbe0050e2
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2c97b4a-4c62-42c3-9a30-ef13f64cb1d5
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LAST_APPOINTED_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d584cbe-8082-4eaf-abfe-3fb84b694866
                stepCounter: fa6209e9-8a2c-4e8d-9c31-ec58ab029953
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75a387af-ca4f-4a7e-8c45-94799e53a4e1
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_APPOINTMENT_DEPARTED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1bf16ecb-b8e9-45ae-8294-9c59939ce84e
                stepCounter: fa6209e9-8a2c-4e8d-9c31-ec58ab029953
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eddcd273-c71d-448e-8b16-f124e2b1769f
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_APPOINTMENT_SEEN_BY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b1ad208-384c-472e-896d-b440faf826f2
                stepCounter: fa6209e9-8a2c-4e8d-9c31-ec58ab029953
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b772a93-fa52-483e-86a5-98eb16acecaf
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ONLINE_BOOKING_REQUESTED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bfa6022f-b8fe-4731-ba13-98bc0c2ac06a
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f0bda4b-de3a-4afa-9d24-6832a1ab2e9a
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LAST_OUTPATIENT_APPOINTMENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 36ce2def-daad-4201-9e51-dda551cf7e7a
                stepCounter: fa6209e9-8a2c-4e8d-9c31-ec58ab029953
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33010c5e-508d-44a2-8423-918f5bc7ef77
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LAST_OUTPATIENT_CLINIC_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59cfd2c1-b1ad-4b39-ac1d-927c03937d2a
                stepCounter: fa6209e9-8a2c-4e8d-9c31-ec58ab029953
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 395a17a9-ab1f-4295-822c-140516164dc4
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LAST_OUTPATIENT_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e8ee744f-746e-4056-9b73-a7a49956dc5b
                stepCounter: fa6209e9-8a2c-4e8d-9c31-ec58ab029953
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cec1abff-8d2b-485e-a4ff-d1f82cce74d8
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: MAP_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 707aa187-aa41-4a19-a951-bba98aa176ed
                stepCounter: 1c24214a-aac0-49a5-a589-934f2afadcfc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e22f763a-1142-4764-8e32-aacd54939262
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIFY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 129738a1-ba48-4c86-8efa-c3d898653b07
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5ebba5c-293e-4016-b180-146fa412574d
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MODIFY_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d118896-2191-4549-bcd1-2d173e3b0fbd
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7bcfe7da-9d14-4ffa-83fa-52812faad503
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: NEXT_APPOINTED_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c6fd600-1656-4a7b-b1f1-8b31f3a6d54e
                stepCounter: fa6209e9-8a2c-4e8d-9c31-ec58ab029953
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6235c6d-1fc7-478f-8749-488eb5a4ca82
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NEXT_APPOINTMENT_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cba7d495-f147-44d7-b99c-657ae3a926fc
                stepCounter: fa6209e9-8a2c-4e8d-9c31-ec58ab029953
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9cb73e3-e174-4a7c-86af-83bf6ee522a5
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NEXT_OUTPATIENT_APPOINTMENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4743e632-64ee-489b-bec3-2f9a153dad36
                stepCounter: fa6209e9-8a2c-4e8d-9c31-ec58ab029953
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d12958a-d201-4703-9074-aadbc347ffbe
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: NEXT_OUTPATIENT_CLINIC_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f6bdd786-4230-47d4-a236-685f3b1d3f37
                stepCounter: fa6209e9-8a2c-4e8d-9c31-ec58ab029953
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 725e85a3-d0be-4eb9-8b19-0952a7dfb778
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: NEXT_OUTPATIENT_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c79efef0-75c9-444a-aede-ffa33509630c
                stepCounter: fa6209e9-8a2c-4e8d-9c31-ec58ab029953
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da19b59d-2251-4f61-81fb-9563dedb7887
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Is this referral an National patient flow referral, Note this rule is the ESPI1 rule plus Surveillance
        name: NPF_PRESENTING_REFERRAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3af73cd8-89fd-4e35-b16d-23a5c34671df
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OPERATION_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c836f4b4-ab4b-43ef-a4fe-70b925bdd87c
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7324d402-3af1-42a1-91de-d1141256e4bf
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: OUTPATIENT_APPOINTMENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 986676d1-b588-42be-9e20-86e201ffe160
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e78eacda-3878-4446-9c76-84b2f78c03bd
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: OUTPATIENT_APPOINTMENT_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'T'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18f964f3-d9ea-4689-b592-7fc7f2ab5404
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OUTPATIENT_APPOINTMENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5b57b418-4592-4522-9f90-c67ba8e5ebeb
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e608bda2-ac53-4d00-a7c8-d5586df6dbdb
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OUTPATIENT_CLINIC_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4866898-5862-4ceb-b82d-b4f0df7b8948
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 99c840df-d007-4996-a77b-03b0436c3da0
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Health Specialty Code
        name: OUTPATIENT_HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab97b5f1-e9ff-4b81-bad4-aab9a49a0a3d
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e875d43-86b1-411e-a018-f2c18a234f9f
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OUTPATIENT_SESSION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a7aba77-6473-499c-a987-7087af601008
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: |-
              CASE WHEN 200828 = s_outpatient_appointment_10.appointment_status_reference_no THEN NULL --planned appointments retain the session they are booked from in the past

                          ELSE s_outpatient_appointment_10.outpatient_session_reference_no
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05dd629c-cc05-4507-921d-d8b208f7b13a
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OUTPATIENT_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24f85e66-f719-4971-be6f-aee66dc624d4
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9a2932d-09f4-4a7a-a88c-a675d01d05ff
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: OVERBOOKED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 42982985-585f-47f2-9360-ba89bdacaebc
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ecc39cc2-9412-4d74-a08e-1a89266bc708
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PARENT_OUTPATIENT_APPOINTMENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: df7e6de9-0a21-485c-8199-2c5e705c31d1
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e1468c7-4bb8-41c1-9698-d36ace5338b0
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_AGE_ON_ARRIVAL_YEARS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bd2057ef-c59c-44d7-b4bc-0ac41d287146
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 990c1980-3b2e-47f5-9f8d-f92825835549
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_APPOINTMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0807d8d6-a8f9-4915-b87a-03b0969d99a1
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9434ee7d-3aea-45a1-84c4-01c95c22c3c8
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_APPOINTMENT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c3e1fd63-84b2-4a27-b4ab-8cd1364754bc
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5f9975d-ade3-4012-b1e7-88ddc8802f03
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PATIENT_ARRIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0a566422-0c54-49b9-b366-d0106d4ee16d
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6bc45882-a920-4ab4-8a54-a504d4e223d8
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_CONFIRMATION_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 757cd397-2218-49e2-8263-6017efc3f66f
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0e21035-0d89-4b25-bf97-823d020ced40
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PATIENT_DEPARTED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc5a1562-fedb-4c61-9088-6ec158a7d61b
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b827678-736c-47b3-9287-71ab49a8626c
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 108064b1-1a63-4ba9-8426-1b5529cec42d
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5937816-a669-4a81-8144-a039893a0c79
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d9ffe493-f986-4786-bf44-069b4ad5dff2
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bcd48c84-537c-4abe-99c3-ffe7ef69bbc0
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PATIENT_SEEN_BY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b546e427-aa7e-45e9-b2ba-3d887df55087
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 36fbec21-e91d-48c3-b893-3845fa4faa15
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Session from which a planned appointment was booked.  This is not populated once booked.
        name: PLANNED_OUTPATIENT_SESSION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a7aba77-6473-499c-a987-7087af601008
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: |-
              CASE WHEN 200828 <> s_outpatient_appointment_10.appointment_status_reference_no THEN NULL --planned appointments retain the session they are booked from in the past

                          ELSE s_outpatient_appointment_10.outpatient_session_reference_no
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b881e144-1bf9-4aa5-865a-f98ff264b376
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PREV_APPOINTED_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2b0beb0-01af-4842-b00f-067883d35fbe
                stepCounter: fa6209e9-8a2c-4e8d-9c31-ec58ab029953
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da58dfcb-7699-4d02-b023-e51581992fff
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PREV_APPOINTMENT_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 42799346-42c5-42af-9d75-8efe2e34dc60
                stepCounter: fa6209e9-8a2c-4e8d-9c31-ec58ab029953
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ccb605e-be9a-47d4-be47-b53a13ba98cf
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PREV_OUTPATIENT_APPOINTMENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 89a96f31-1845-4cda-9a00-33e8cc391802
                stepCounter: fa6209e9-8a2c-4e8d-9c31-ec58ab029953
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3753e9c2-4528-4d84-8df0-6a671ce4f7e6
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PREV_OUTPATIENT_CLINIC_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 74bbb4af-102d-4add-b078-3ff5ce524060
                stepCounter: fa6209e9-8a2c-4e8d-9c31-ec58ab029953
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66f12894-6a0f-46e3-a038-4d5f2eec9b63
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PREV_OUTPATIENT_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce9f5c5b-7dbe-4561-a6c4-831d76f5851d
                stepCounter: fa6209e9-8a2c-4e8d-9c31-ec58ab029953
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8742d7d3-3c5d-445c-8c50-f9d6aad25436
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREVIOUS_TO_CURRENT_APPOINTMENT_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2f0f54ec-4442-4129-abe8-690d77d774e8
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: DATEDIFF(mi,s_outpatient_appointment_prev_next.prev_appointment_end_date,s_outpatient_appointment_10.appointment_start_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3048885d-3c83-47d7-bb4f-9a9b49e99ce2
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PRIMARY_PROCEDURE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4adf693e-92d4-48f4-8074-ca8624ec65cc
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 642ce08f-8d65-44d8-85ef-f1935d6cfff0
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: PRIMARY_PROCEDURE_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 348da2ca-9ded-451d-a5d1-542826113b9d
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f19380e-05f6-4b3d-9a32-e0629b1de290
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRIMARY_PROCEDURE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b314205-2748-42d5-8078-03c39489c590
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5111bbcb-d41f-4c7e-896a-927536375902
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PRINCIPAL_DIAGNOSIS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d316a6a-6e65-41a7-bda5-84c0f0962175
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1af973e1-d603-4868-a11f-73e372bc5622
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: PRINCIPAL_DIAGNOSIS_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4aead8c-6114-4281-859b-aec32996ca68
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c985baca-6aaf-488f-8c01-cd63513faeb6
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRINCIPAL_DIAGNOSIS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 14a44ab9-7d5a-4388-88fa-195a71a4692c
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25a479ed-7e86-42d5-a573-e92f2ff37d90
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRIORITY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4547ca44-b410-4b3e-a20d-6f82c5bd15d1
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ccf5e5d2-a5d2-4a09-9339-25c320596197
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INT
        defaultValue: ""
        description: staging field only to help identify mapping issues
        name: PUC_MAP_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 707aa187-aa41-4a19-a951-bba98aa176ed
                stepCounter: 1c24214a-aac0-49a5-a589-934f2afadcfc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 328185cc-641e-474c-a136-0208f1378448
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_CODE_POST_01_07_2014
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa787dea-ef65-42d4-9e95-8db1f3dd72d4
                stepCounter: 1c24214a-aac0-49a5-a589-934f2afadcfc
            transform: |-
              CASE WHEN s_outpatient_appointment_10.patient_age_on_arrival_years >= 65 AND ds_mappings_PurchaseUnit_IPM_Outpatients_RC.default_purchase_unit_code_over_65 IS NOT NULL THEN REPLACE(ds_mappings_PurchaseUnit_IPM_Outpatients_RC.default_purchase_unit_code_over_65,'.','0')
                          ELSE REPLACE(ds_mappings_PurchaseUnit_IPM_Outpatients_RC.default_purchase_unit_code,'.','0')
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc7aba65-1b4c-4bf9-bd55-7694eb67308e
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_CODE_PRE_01_07_2014
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7fd8aaf5-7d19-4af5-bf07-a6d33bc38e33
                stepCounter: 69a14309-0d7d-4f70-b80d-8dda23ce749c
            transform: REPLACE(ds_reference_IPM_Outpatient_PU.purchaseunit,'.','0')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 567f0d1e-c836-4e0c-98fe-5cf5b35ea0f1
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: REASN_COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5b3e2d73-35da-461f-ab2c-c94c3748cb75
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2eb90e1b-ed40-453d-bc67-300cb7b324e6
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_APPOINTMENT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21429860-03f9-48b4-b85a-253d79693e44
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16e5aa67-0461-4f82-92be-9e6e781517ee
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 13c59989-bdff-42eb-b584-3c115a7bf74f
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a77a3387-2e4e-48bd-a9d8-a23b1db1c7d3
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd35d17f-4e4f-4d25-87b6-840bfba80ebf
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa14c107-451a-4549-ae23-508bf0b57567
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_SCHEDULE_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3bd5f356-9c51-4ee4-9447-0a7a26561c4e
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d27d27d-4d3d-4c94-acf0-177f9d88f6c1
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_SOURCE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 619292ab-f560-4f15-ab7b-78e0961a3ef2
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: RESPONSIBILITY_CENTRE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c2a3b5c2-4af0-413e-804c-7981982790a9
                stepCounter: 1c24214a-aac0-49a5-a589-934f2afadcfc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7b7fda0-7826-4679-be0f-229f52344626
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: SCHDL_COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a111072-c33e-429a-a74a-bcfeff965ad1
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 368ed41c-baab-4d91-bb12-82fb27069f29
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: number of time the appointment has been rescheduled
        name: SCHEDULE_MOVEMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e625a210-2242-466d-9cbd-c4b421868461
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d99f982-2609-41f1-8036-85dd3a91fe42
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SECONDARY_DIAGNOSIS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 06adbc55-77c4-4e61-8c68-153287408f99
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 84aa7e90-74cd-48ac-9795-2d8eb56f4569
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: SECONDARY_DIAGNOSIS_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fdeff383-d0bd-4a34-b567-3504f89fcea6
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d82bfeb-09b5-4e24-998c-4dbcbaa0bac8
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SECONDARY_DIAGNOSIS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4d8c480c-60e2-4a85-8e3a-3e9de5ce267e
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 200c982e-5a75-4d3a-b7c5-d31c9aae3be1
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SECONDARY_PROCEDURE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ad87052-abe5-4b95-bf78-4eefad8aba8c
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75035d76-8fb2-4250-9daa-c5fbc940c347
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: SECONDARY_PROCEDURE_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bec6b52d-66a1-4602-a91d-7a7249639180
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce90f14e-f991-4a32-b828-bbe268875fed
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SECONDARY_PROCEDURE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e6408f1d-1bd1-44a6-9e65-731e8d1af61c
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2fa57ed-b622-4de8-88c8-df9b20a241a9
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75b1c79f-25f2-447b-82ab-e1d8bcf9a6e1
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 85469401-8ed6-44ab-b3e3-03e4dd29d4c3
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_APPOINTMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a4028ed-b439-49e2-8ac4-af5e125a4d64
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a4ff245d-4d26-4831-9946-0e1e08f94cc0
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_APPOINTMENT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c0a40752-5176-4e08-af1a-080a5e22287e
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 295873af-f5b0-4ff7-8e76-bf23f4248fed
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: NUMERIC(15,2)
        defaultValue: ""
        description: budget cost from costing system
        name: STANDARD_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 330ef2a7-84e5-4e0b-9df4-f33815859205
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: TRANSPORT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 13aaf69f-8490-443b-bdbe-ee5ec1754afb
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 58e19f8a-27e5-4065-9c3f-db74de4541d1
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: TREATMENT_DECISION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e8c8c0d-48dd-4d70-b4d8-312fd3287e00
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 794f1ece-7e75-4e8f-9c4a-5e977c0d5349
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: TREATMENT_DELAY_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c9b704ea-ee41-4e0c-a0c6-40321b72398a
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ce11555-5235-427a-b326-8718ca2ea4b7
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: UNPLANNED_RETURN_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 44f8d969-c59b-42d6-84fb-a093899fea00
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb0ba7cf-dc00-410a-8f9d-d08f498815e4
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: URGENCY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0e083d04-5d3b-4b0b-a2bf-83e74bfa3bc0
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17652cc3-ffda-4a9d-abe2-65a1c27b254b
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: VIRTUAL_APPT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: coalesce(ds_reference_IPM_Outpatient_PU.Virtual_Appt_Flag, ds_mappings_PurchaseUnit_IPM_Outpatients_RC.virtual_appointment_flag,'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a932dd33-a3e3-40d3-8f1d-5b1b6e9d56f9
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: VISIT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 55550ff2-d886-4b90-9017-6a027540efe7
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4450971-99fd-41f2-ac8a-34f8acd21620
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b6ea91c-fdd3-4239-8a0a-1877df991a14
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a1e8e71-cb90-4424-9377-f2a5d18063b1
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Sequence for appointment within waitlist ordered from most recent to oldest
        name: WAITLIST_SCHEDULE_REV_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 41120955-abcf-4914-8096-18dc14715900
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3fa44fad-0a6d-4f55-a423-d8d25f477d32
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INT
        defaultValue: ""
        description: Sequence for appointment within waitlist ordered from oldest to most recent
        name: WAITLIST_SCHEDULE_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: efc87a00-429a-4c47-bab4-98ffabb64e89
                stepCounter: cc06fa8f-18b5-4191-a0d3-87fb6b43f1dd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54c012c3-5403-4a55-83c5-28d05d8aa857
          stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ACCINDICATORID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ISNULL(ACC.localcode,0)
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_OUTPATIENT_COMMENT_NOTE: 035e1bf5-96f7-4e2d-a6b9-8b524cf18c1e
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: STAGE
            nodeName: S_OUTPATIENT_APPOINTMENT_10
          - locationName: UNKNOWN
            nodeName: FACT_COST_ENCOUNTER
          - locationName: STAGE
            nodeName: S_OUTPATIENT_COMMENT_NOTE
        join:
          joinCondition: |-
            EXTENDED
              FROM s_outpatient_appointment_10 s_outpatient_appointment_10
              LEFT OUTER JOIN s_outpatient_appointment_prev_next
                ON s_outpatient_appointment_10.outpatient_appointment_reference_no = s_outpatient_appointment_prev_next.curr_outpatient_appointment_reference_no
              LEFT OUTER JOIN ds_reference_IPM_Outpatient_PU
                ON s_outpatient_appointment_10.outpatient_appointment_encounter_id = ds_reference_IPM_Outpatient_PU.encounter
              LEFT OUTER JOIN ds_shared_referral
                ON ds_shared_referral.refrl_refno = s_outpatient_appointment_10.referral_reference_no
              LEFT OUTER JOIN dbo.s_healthcare_professional
                ON s_healthcare_professional.healthcare_professional_reference_no = ISNULL(s_outpatient_appointment_10.appointed_clinician_reference_no,s_outpatient_appointment_10.parent_appointed_clinician_reference_no)
              LEFT JOIN {{ ref('UNKNOWN','FACT_COST_ENCOUNTER') }}
                ON s_outpatient_appointment_10.outpatient_appointment_encounter_id = fact_cost_encounter.encounter_id
              LEFT OUTER JOIN {{ ref('STAGE','S_OUTPATIENT_COMMENT_NOTE') }}
                ON s_outpatient_appointment_10.outpatient_appointment_reference_no = s_outpatient_comment_note.sorce_refno
               AND s_outpatient_comment_note.row_num = 1
              LEFT OUTER JOIN (
                    SELECT a.localcode,
                           b.encounter_id
                      FROM s_outpatient_ACCIndicators a
                      JOIN s_outpatient_acc_calc b
                        ON a.VisitGT7DaysPostRef = b.VisitGT7DaysPostRef
                       AND a.AdmittedToHospital = b.AdmittedToHospital
                       AND a.AdmittedToday = b.AdmittedToday
                       AND a.FirstVisit = b.FirstVisit
                       AND a.IPWithin42Days = b.IPEventWithin42Days
                       AND a.IPOver42Days = b.IPEventOver42Days
                       AND a.EDWithin42Days = b.EDEventWithin42Days
                       AND a.EDOver42Days = b.EDEventOver42Days
                   ) ACC
                ON s_outpatient_appointment_10.outpatient_appointment_encounter_id = acc.encounter_id
              LEFT OUTER JOIN [dim].[dim_outpatient_clinic]
                ON s_outpatient_appointment_10.outpatient_clinic_reference_no = dim_outpatient_clinic.outpatient_clinic_reference_no
               AND dim_outpatient_clinic.dss_current_flag = 'Y'
              LEFT OUTER JOIN dbo.[ds_mappings_PurchaseUnit_IPM_Outpatients_RC]
                ON ds_mappings_PurchaseUnit_IPM_Outpatients_RC.admin_category_reference_no = s_outpatient_appointment_10.admin_category_reference_no
               AND ds_mappings_PurchaseUnit_IPM_Outpatients_RC.booking_type_reference_no = s_outpatient_appointment_10.booking_type_reference_no
               AND ds_mappings_PurchaseUnit_IPM_Outpatients_RC.service_point_reference_no = s_outpatient_appointment_10.outpatient_clinic_reference_no
               AND isnull(ds_mappings_PurchaseUnit_IPM_Outpatients_RC.primary_procedure_reference_no,-1) = isnull(s_outpatient_appointment_10.primary_procedure_reference_no,-1)
               AND isnull(ds_mappings_PurchaseUnit_IPM_Outpatients_RC.secondary_procedure_reference_no,-1) = isnull(s_outpatient_appointment_10.secondary_procedure_reference_no,-1) -- AND ds_mappings_PurchaseUnit_IPM_Outpatients_RC.health_specialty_code = s_outpatient_appointment_10.outpatient_health_specialty_code  AND ds_mappings_PurchaseUnit_IPM_Outpatients_RC.specialty_reference_no = isnull(s_outpatient_appointment_10.outpatient_specialty_reference_no,dim_outpatient_clinic.specialty_reference_no)  --AND ds_mappings_PurchaseUnit_IPM_Outpatients_RC.specialty_reference_no = s_outpatient_appointment_10.outpatient_specialty_reference_no    AND ds_mappings_PurchaseUnit_IPM_Outpatients_RC.visit_type_reference_no = s_outpatient_appointment_10.visit_type_reference_no    AND ds_mappings_PurchaseUnit_IPM_Outpatients_RC.provider_type_reference_no = s_healthcare_professional.healthcare_professional_type_reference_no    AND ds_mappings_PurchaseUnit_IPM_Outpatients_RC.professional_carer_reference_no = ISNULL(s_outpatient_appointment_10.appointed_clinician_reference_no,s_outpatient_appointment_10.parent_appointed_clinician_reference_no)    AND isnull(ds_mappings_PurchaseUnit_IPM_Outpatients_RC.referral_reason_reference_no,-1) = isnull(ds_shared_referral.reasn_refno,-1)    AND isnull(ds_mappings_PurchaseUnit_IPM_Outpatients_RC.primary_diagnosis_reference_no,-1) = isnull(
        name: S_OUTPATIENT_APPOINTMENT_20
        noLinkRefs: []
  name: S_OUTPATIENT_APPOINTMENT_20
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
