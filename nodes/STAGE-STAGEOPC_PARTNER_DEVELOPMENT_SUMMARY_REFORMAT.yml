fileVersion: 1
id: b612a6b8-0fa3-4a42-a6fc-ac373c17f336
name: STAGEOPC_PARTNER_DEVELOPMENT_SUMMARY_REFORMAT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 734e888a-16a5-4e97-9b4d-fae5ca6ded4f
          stepCounter: b612a6b8-0fa3-4a42-a6fc-ac373c17f336
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ACCOUNT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39999ab8-1491-4f98-abb9-af02cfb16166
          stepCounter: b612a6b8-0fa3-4a42-a6fc-ac373c17f336
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79e06918-fba0-4af9-a3ae-19fa414815cd
                stepCounter: 2b30bf9e-ff63-4444-8fc3-ce700cc33efc
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_PD_SUMMARY_GA4.DATE),'YYYYMMDD')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b2115037-ea4c-4eba-bb52-36d92f64ec61
          stepCounter: b612a6b8-0fa3-4a42-a6fc-ac373c17f336
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: GA_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79e06918-fba0-4af9-a3ae-19fa414815cd
                stepCounter: 2b30bf9e-ff63-4444-8fc3-ce700cc33efc
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_PD_SUMMARY_GA4.DATE),'YYYYMMDD') \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ab10216-849e-436d-a729-cff09e3e2554
          stepCounter: b612a6b8-0fa3-4a42-a6fc-ac373c17f336
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: USER ID
        name: GA_DIMENSION10
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8cb51f6a-d7e7-4f19-8543-e0ba52aa0006
                stepCounter: 2b30bf9e-ff63-4444-8fc3-ce700cc33efc
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c158db4-baad-4256-bd99-8d9f5e82a311
          stepCounter: b612a6b8-0fa3-4a42-a6fc-ac373c17f336
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: USER NAME
        name: GA_DIMENSION11
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a0c04455-fe2f-418d-b5dc-5ab39910eebe
                stepCounter: 08571f1f-4edf-4c3d-b7a0-d9134984c33e
            transform: INITCAP(CONCAT(LOADOPCUSERS.FIRSTNAME,' ',LOADOPCUSERS.LASTNAME))
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: INITCAP(CONCAT(LOADOPCUSERS.FIRSTNAME,' ',LOADOPCUSERS.LASTNAME))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54703aae-8071-4767-8659-e508b74f4141
          stepCounter: b612a6b8-0fa3-4a42-a6fc-ac373c17f336
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER ID - SUPPLIER NAME
        name: GA_DIMENSION12
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ba85d6c-d620-4e66-9a50-2a0de468b081
                stepCounter: 2b30bf9e-ff63-4444-8fc3-ce700cc33efc
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe979d73-4cac-469a-b0c3-29914e898105
          stepCounter: b612a6b8-0fa3-4a42-a6fc-ac373c17f336
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER ID
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ba85d6c-d620-4e66-9a50-2a0de468b081
                stepCounter: 2b30bf9e-ff63-4444-8fc3-ce700cc33efc
            transform: SPLIT_PART(LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO.USER_SUPPLIER,'-',1) \N \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: SPLIT_PART(LOADGA_OPC_PD_SUMMARY_GA4.USER_SUPPLIER,'-',1) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d1d0eb6-3b4a-4954-b433-e2aac6af22e0
          stepCounter: b612a6b8-0fa3-4a42-a6fc-ac373c17f336
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER NAME
        name: SUPPLIER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ba85d6c-d620-4e66-9a50-2a0de468b081
                stepCounter: 2b30bf9e-ff63-4444-8fc3-ce700cc33efc
            transform: INITCAP(SPLIT_PART(LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO.USER_SUPPLIER,'-',2)) \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: INITCAP(SPLIT_PART(LOADGA_OPC_PD_SUMMARY_GA4.USER_SUPPLIER,'-',2))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ab46467-d47c-4b76-87f3-adecc6428eea
          stepCounter: b612a6b8-0fa3-4a42-a6fc-ac373c17f336
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: SEARCHES
        name: GA_METRIC3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 694ca943-9b66-4954-a73a-f20ba2b65bbd
                stepCounter: 2b30bf9e-ff63-4444-8fc3-ce700cc33efc
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 411b3531-439f-4dbb-aad9-59a24482be48
          stepCounter: b612a6b8-0fa3-4a42-a6fc-ac373c17f336
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: CONTACT INVOKES
        name: GA_METRIC4
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b05dce70-fbe6-4239-854c-7a58b4974c5c
                stepCounter: 2b30bf9e-ff63-4444-8fc3-ce700cc33efc
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7cee05a0-675c-427b-a2ee-f3da4957338a
          stepCounter: b612a6b8-0fa3-4a42-a6fc-ac373c17f336
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: EXPORTS
        name: GA_METRIC5
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8385567e-3ddc-4fa2-829e-171a14055268
                stepCounter: 2b30bf9e-ff63-4444-8fc3-ce700cc33efc
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e76cb5cb-5575-4a33-a434-f616c1e28532
          stepCounter: b612a6b8-0fa3-4a42-a6fc-ac373c17f336
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: FIRST LOGINS
        name: GA_METRIC6
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed041c24-29e3-4915-ac38-4724f12f273f
                stepCounter: 2b30bf9e-ff63-4444-8fc3-ce700cc33efc
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6de3c9e-cc34-4945-a71e-357354ceeec0
          stepCounter: b612a6b8-0fa3-4a42-a6fc-ac373c17f336
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: GA_SESSIONS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 99a55231-acd3-4427-a8e0-f91bb0d84663
                stepCounter: 2b30bf9e-ff63-4444-8fc3-ce700cc33efc
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: COALESCE(LOADGA_OPC_PD_SUMMARY_GA4.LOGINS,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2a46eb3-351f-4bb9-babe-570ce1d9cbe2
          stepCounter: b612a6b8-0fa3-4a42-a6fc-ac373c17f336
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PROFILE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8e22d88-b409-48ab-87fd-1c9bda52dc82
          stepCounter: b612a6b8-0fa3-4a42-a6fc-ac373c17f336
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79e06918-fba0-4af9-a3ae-19fa414815cd
                stepCounter: 2b30bf9e-ff63-4444-8fc3-ce700cc33efc
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_PD_SUMMARY_GA4.DATE),'YYYYMMDD') \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 224daaf3-59d3-49d5-af8d-f4c509d760db
          stepCounter: b612a6b8-0fa3-4a42-a6fc-ac373c17f336
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: WEB_PROPERTY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bfd504cd-3faa-41da-8ab9-c1fb68f2965e
          stepCounter: b612a6b8-0fa3-4a42-a6fc-ac373c17f336
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_BATCHED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fdf43728-872f-4fe3-a8f3-626be5adf138
                stepCounter: 2b30bf9e-ff63-4444-8fc3-ce700cc33efc
            transform: TO_TIMESTAMP(LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO.__HEVO__LOADED_AT,3)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_PD_SUMMARY_GA4.__HEVO__LOADED_AT,3)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f511b39-c249-40d6-8631-3bcc8fd294d9
          stepCounter: b612a6b8-0fa3-4a42-a6fc-ac373c17f336
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_EXTRACTED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83d34845-f1ad-4a15-aa89-d4dd5cabd461
                stepCounter: 2b30bf9e-ff63-4444-8fc3-ce700cc33efc
            transform: TO_TIMESTAMP(LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO.__HEVO__LOADED_AT,3) \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_PD_SUMMARY_GA4.__HEVO__INGESTED_AT,3)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 438794b2-8064-45a2-9ebc-2371f2664b66
          stepCounter: b612a6b8-0fa3-4a42-a6fc-ac373c17f336
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_RECEIVED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fdf43728-872f-4fe3-a8f3-626be5adf138
                stepCounter: 2b30bf9e-ff63-4444-8fc3-ce700cc33efc
            transform: TO_TIMESTAMP(LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO.__HEVO__LOADED_AT,3) \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_PD_SUMMARY_GA4.__HEVO__LOADED_AT,3)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 43fe1a2d-80aa-47a7-996f-b46fd658951f
          stepCounter: b612a6b8-0fa3-4a42-a6fc-ac373c17f336
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: _SDC_RECORD_HASH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a4c5d8d-d42b-44e6-bff7-d338584b8665
                stepCounter: 2b30bf9e-ff63-4444-8fc3-ce700cc33efc
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be68e2cb-1443-4b40-b050-17adf529d718
          stepCounter: b612a6b8-0fa3-4a42-a6fc-ac373c17f336
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: _SDC_SEQUENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02766b57-7edd-45ac-a2dc-ea6f4de04961
          stepCounter: b612a6b8-0fa3-4a42-a6fc-ac373c17f336
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: _SDC_TABLE_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95a26343-6236-4186-8928-02f445ba81bb
          stepCounter: b612a6b8-0fa3-4a42-a6fc-ac373c17f336
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: HOSTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 972d1017-50e8-41e5-913c-407e0057db87
                stepCounter: 2b30bf9e-ff63-4444-8fc3-ce700cc33efc
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5334e55-c569-4558-b313-cc30366f3432
          stepCounter: b612a6b8-0fa3-4a42-a6fc-ac373c17f336
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: THIS FIELD WILL BE USED TO FILTER WHICH OPC ENVIRONMENT THIS GA RECORD WILL BE SHOWN.
        name: FILTER_DATABASE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 972d1017-50e8-41e5-913c-407e0057db87
                stepCounter: 2b30bf9e-ff63-4444-8fc3-ce700cc33efc
            transform: CASE HOSTNAME \N WHEN 'OPC-SCUS-SVC-WEB-DEV.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_DEV' \N WHEN 'LOCALHOST' \N THEN 'OMNIACONNECT_DEV' \N WHEN'OPC-SCUS-SVC-WEB-QA.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA' \N WHEN 'OPC-SCUS-SVC-WEB-PROD-STAGING.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA' \N WHEN 'OPC-SCUS-SVC-WEB-UAT.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_UAT' \N WHEN 'OMNIACONNECT.OMNIAPARTNERS.COM' \N THEN 'OMNIACONNECT' \N ELSE NULL \NEND \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: CASE HOSTNAME \N WHEN 'OPC-SCUS-SVC-WEB-DEV.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_DEV' \N WHEN 'LOCALHOST' \N THEN 'OMNIACONNECT_DEV' \N WHEN'OPC-SCUS-SVC-WEB-QA.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA' \N WHEN 'OPC-SCUS-SVC-WEB-PROD-STAGING.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA' \N WHEN 'OPC-SCUS-SVC-WEB-UAT.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_UAT' \N WHEN 'OMNIACONNECT.OMNIAPARTNERS.COM' \N THEN 'OMNIACONNECT' \N ELSE NULL \NEND \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1644b992-c6ab-474b-b79b-2ebed10f2bcd
          stepCounter: b612a6b8-0fa3-4a42-a6fc-ac373c17f336
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0d95276f-6800-4fc7-9986-18084d5846c8
                stepCounter: 2b30bf9e-ff63-4444-8fc3-ce700cc33efc
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 633405ec-b2c7-4fe9-9b0d-3f9dfae2cf55
          stepCounter: b612a6b8-0fa3-4a42-a6fc-ac373c17f336
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eaa5500e-a6f2-4ba7-831a-74907ee4aa98
                stepCounter: 2b30bf9e-ff63-4444-8fc3-ce700cc33efc
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de2b0910-5c89-4bb9-be40-d61c8f18aad2
          stepCounter: b612a6b8-0fa3-4a42-a6fc-ac373c17f336
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a186db87-5634-4a0a-9d8c-b72591f298d1
          stepCounter: b612a6b8-0fa3-4a42-a6fc-ac373c17f336
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO: 2b30bf9e-ff63-4444-8fc3-ce700cc33efc
          LOADOPCUSERS: 08571f1f-4edf-4c3d-b7a0-d9134984c33e
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOADOPCUSERS
          - locationName: LOAD
            nodeName: LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO') }} LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO
              LEFT JOIN {{ ref('LOAD','LOADOPCUSERS') }} LOADOPCUSERS
                ON LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO.USER_ID = LOADOPCUSERS.IDENTITYUSERID
        name: SRC_STAGEOPC_PARTNER_DEVELOPMENT_SUMMARY_GA3
        noLinkRefs: []
  name: STAGEOPC_PARTNER_DEVELOPMENT_SUMMARY_REFORMAT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
