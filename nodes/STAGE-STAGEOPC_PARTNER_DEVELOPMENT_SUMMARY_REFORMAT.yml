fileVersion: 1
id: 4b946bcc-a1db-4e23-9fca-13ea0c278f89
name: STAGEOPC_PARTNER_DEVELOPMENT_SUMMARY_REFORMAT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 65d01913-232b-4f41-ad1b-258728fb9b62
          stepCounter: 4b946bcc-a1db-4e23-9fca-13ea0c278f89
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ACCOUNT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b1b34d1-4ec4-48db-af75-166ee37540bf
          stepCounter: 4b946bcc-a1db-4e23-9fca-13ea0c278f89
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 86d3c90c-aafd-483d-8cc2-a210741ae22d
                stepCounter: 68be9c7a-659c-43a3-8e89-a32c81a76a46
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_PD_SUMMARY_GA4.DATE),'YYYYMMDD')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 93ebe827-fb81-4500-aea9-a088c35d2ff8
          stepCounter: 4b946bcc-a1db-4e23-9fca-13ea0c278f89
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: GA_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 86d3c90c-aafd-483d-8cc2-a210741ae22d
                stepCounter: 68be9c7a-659c-43a3-8e89-a32c81a76a46
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_PD_SUMMARY_GA4.DATE),'YYYYMMDD') \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 468f1403-adc8-4749-aa24-5849aed21c38
          stepCounter: 4b946bcc-a1db-4e23-9fca-13ea0c278f89
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: USER ID
        name: GA_DIMENSION10
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72b815de-348b-4cb0-a008-d0aa05bdee8c
                stepCounter: 68be9c7a-659c-43a3-8e89-a32c81a76a46
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7076d2d1-2085-45e8-b5de-97c55be7bebd
          stepCounter: 4b946bcc-a1db-4e23-9fca-13ea0c278f89
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: USER NAME
        name: GA_DIMENSION11
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 69a1ff9c-e85c-47f1-9907-758bf09d3550
                stepCounter: 49f597cd-01c4-4b23-b4e3-5dc2bc13c14c
            transform: INITCAP(CONCAT(LOADOPCUSERS.FIRSTNAME,' ',LOADOPCUSERS.LASTNAME))
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: INITCAP(CONCAT(LOADOPCUSERS.FIRSTNAME,' ',LOADOPCUSERS.LASTNAME))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5482fc59-b86a-4d16-8341-4a2b1c563b4c
          stepCounter: 4b946bcc-a1db-4e23-9fca-13ea0c278f89
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER ID - SUPPLIER NAME
        name: GA_DIMENSION12
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6e1a90a-33d5-4f42-a14b-d1b2cc721f76
                stepCounter: 68be9c7a-659c-43a3-8e89-a32c81a76a46
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 73d68fff-0a26-4f61-b8aa-f9731ba88caa
          stepCounter: 4b946bcc-a1db-4e23-9fca-13ea0c278f89
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER ID
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6e1a90a-33d5-4f42-a14b-d1b2cc721f76
                stepCounter: 68be9c7a-659c-43a3-8e89-a32c81a76a46
            transform: SPLIT_PART(LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO.USER_SUPPLIER,'-',1) \N \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: SPLIT_PART(LOADGA_OPC_PD_SUMMARY_GA4.USER_SUPPLIER,'-',1) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4887b423-9852-4d7f-a519-89c08860640f
          stepCounter: 4b946bcc-a1db-4e23-9fca-13ea0c278f89
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER NAME
        name: SUPPLIER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6e1a90a-33d5-4f42-a14b-d1b2cc721f76
                stepCounter: 68be9c7a-659c-43a3-8e89-a32c81a76a46
            transform: INITCAP(SPLIT_PART(LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO.USER_SUPPLIER,'-',2)) \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: INITCAP(SPLIT_PART(LOADGA_OPC_PD_SUMMARY_GA4.USER_SUPPLIER,'-',2))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 429df17f-248b-48d4-8945-88738ea71bc5
          stepCounter: 4b946bcc-a1db-4e23-9fca-13ea0c278f89
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: SEARCHES
        name: GA_METRIC3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5c8a437-1246-4b3c-bf1d-bbb98cbf9514
                stepCounter: 68be9c7a-659c-43a3-8e89-a32c81a76a46
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 809961b1-679c-429c-a656-cad0a528e5e7
          stepCounter: 4b946bcc-a1db-4e23-9fca-13ea0c278f89
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: CONTACT INVOKES
        name: GA_METRIC4
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f12ae02d-5a95-4869-a9e4-f0a31d30264e
                stepCounter: 68be9c7a-659c-43a3-8e89-a32c81a76a46
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01c1e769-3f61-4725-bbdf-2c484c5e9989
          stepCounter: 4b946bcc-a1db-4e23-9fca-13ea0c278f89
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: EXPORTS
        name: GA_METRIC5
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d9d74aa3-b874-4d11-9302-63b6f5c5167a
                stepCounter: 68be9c7a-659c-43a3-8e89-a32c81a76a46
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d52f6cb-a061-49ff-b12c-d090c41a1089
          stepCounter: 4b946bcc-a1db-4e23-9fca-13ea0c278f89
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: FIRST LOGINS
        name: GA_METRIC6
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 434aa7be-1f4c-4fef-b4c5-a41b1556de40
                stepCounter: 68be9c7a-659c-43a3-8e89-a32c81a76a46
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 489c6146-b2fa-4759-b04a-c9bf2933f296
          stepCounter: 4b946bcc-a1db-4e23-9fca-13ea0c278f89
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: GA_SESSIONS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 130ba9e6-cc51-488b-92bb-deab3b7d5cbd
                stepCounter: 68be9c7a-659c-43a3-8e89-a32c81a76a46
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: COALESCE(LOADGA_OPC_PD_SUMMARY_GA4.LOGINS,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e8c75a6-5ead-4b70-8fae-a9c48d5f194f
          stepCounter: 4b946bcc-a1db-4e23-9fca-13ea0c278f89
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PROFILE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3516411c-51b5-4365-b257-4ea38df3c12a
          stepCounter: 4b946bcc-a1db-4e23-9fca-13ea0c278f89
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 86d3c90c-aafd-483d-8cc2-a210741ae22d
                stepCounter: 68be9c7a-659c-43a3-8e89-a32c81a76a46
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_PD_SUMMARY_GA4.DATE),'YYYYMMDD') \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ff0b486-fceb-4f69-91a5-c183889cd586
          stepCounter: 4b946bcc-a1db-4e23-9fca-13ea0c278f89
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: WEB_PROPERTY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3214d167-0bf6-4c8e-b4f1-6f3ea66087bd
          stepCounter: 4b946bcc-a1db-4e23-9fca-13ea0c278f89
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_BATCHED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d88d12ef-e84a-4e7b-a914-2c0682adcc28
                stepCounter: 68be9c7a-659c-43a3-8e89-a32c81a76a46
            transform: TO_TIMESTAMP(LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO.__HEVO__LOADED_AT,3)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_PD_SUMMARY_GA4.__HEVO__LOADED_AT,3)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 373aaff1-163a-4968-964e-adea4d8b5a19
          stepCounter: 4b946bcc-a1db-4e23-9fca-13ea0c278f89
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_EXTRACTED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 74e4f700-d982-456c-af18-22a0cb431895
                stepCounter: 68be9c7a-659c-43a3-8e89-a32c81a76a46
            transform: TO_TIMESTAMP(LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO.__HEVO__LOADED_AT,3) \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_PD_SUMMARY_GA4.__HEVO__INGESTED_AT,3)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e50fc3d5-13e2-492f-97ac-42cc0afe9d91
          stepCounter: 4b946bcc-a1db-4e23-9fca-13ea0c278f89
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_RECEIVED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d88d12ef-e84a-4e7b-a914-2c0682adcc28
                stepCounter: 68be9c7a-659c-43a3-8e89-a32c81a76a46
            transform: TO_TIMESTAMP(LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO.__HEVO__LOADED_AT,3) \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_PD_SUMMARY_GA4.__HEVO__LOADED_AT,3)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70c24829-8e87-4b21-84fb-19f47a2240c2
          stepCounter: 4b946bcc-a1db-4e23-9fca-13ea0c278f89
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: _SDC_RECORD_HASH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c36a979a-cd9e-4a2b-84c9-016a29b0e428
                stepCounter: 68be9c7a-659c-43a3-8e89-a32c81a76a46
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b36b428d-a9e4-401e-a495-b181b6c22701
          stepCounter: 4b946bcc-a1db-4e23-9fca-13ea0c278f89
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: _SDC_SEQUENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 809edf70-d60b-437a-b79d-309be6ecca5c
          stepCounter: 4b946bcc-a1db-4e23-9fca-13ea0c278f89
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: _SDC_TABLE_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e093068f-dec7-4946-9e5f-beac19526cd1
          stepCounter: 4b946bcc-a1db-4e23-9fca-13ea0c278f89
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: HOSTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e6a8925-0d66-428f-92a1-3b0e9e418e97
                stepCounter: 68be9c7a-659c-43a3-8e89-a32c81a76a46
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92ae6fcc-888d-4734-a21d-36d8e09bbde0
          stepCounter: 4b946bcc-a1db-4e23-9fca-13ea0c278f89
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: THIS FIELD WILL BE USED TO FILTER WHICH OPC ENVIRONMENT THIS GA RECORD WILL BE SHOWN.
        name: FILTER_DATABASE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e6a8925-0d66-428f-92a1-3b0e9e418e97
                stepCounter: 68be9c7a-659c-43a3-8e89-a32c81a76a46
            transform: CASE HOSTNAME \N WHEN 'OPC-SCUS-SVC-WEB-DEV.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_DEV' \N WHEN 'LOCALHOST' \N THEN 'OMNIACONNECT_DEV' \N WHEN'OPC-SCUS-SVC-WEB-QA.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA' \N WHEN 'OPC-SCUS-SVC-WEB-PROD-STAGING.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA' \N WHEN 'OPC-SCUS-SVC-WEB-UAT.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_UAT' \N WHEN 'OMNIACONNECT.OMNIAPARTNERS.COM' \N THEN 'OMNIACONNECT' \N ELSE NULL \NEND \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: CASE HOSTNAME \N WHEN 'OPC-SCUS-SVC-WEB-DEV.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_DEV' \N WHEN 'LOCALHOST' \N THEN 'OMNIACONNECT_DEV' \N WHEN'OPC-SCUS-SVC-WEB-QA.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA' \N WHEN 'OPC-SCUS-SVC-WEB-PROD-STAGING.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA' \N WHEN 'OPC-SCUS-SVC-WEB-UAT.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_UAT' \N WHEN 'OMNIACONNECT.OMNIAPARTNERS.COM' \N THEN 'OMNIACONNECT' \N ELSE NULL \NEND \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9052195-5e83-4fc6-a05f-8197d283f32b
          stepCounter: 4b946bcc-a1db-4e23-9fca-13ea0c278f89
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cfdbf964-e1c6-45e7-850b-db4f9c79bf3d
                stepCounter: 68be9c7a-659c-43a3-8e89-a32c81a76a46
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc437293-b1af-4167-b9ca-4c17008ea162
          stepCounter: 4b946bcc-a1db-4e23-9fca-13ea0c278f89
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3ac1af35-3c2b-44be-8e4c-1557bd94831b
                stepCounter: 68be9c7a-659c-43a3-8e89-a32c81a76a46
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6d1e2ab-4e5d-44dd-84d6-3d46182a72d6
          stepCounter: 4b946bcc-a1db-4e23-9fca-13ea0c278f89
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c63dc16-728b-40c1-8ada-d228d9143dae
          stepCounter: 4b946bcc-a1db-4e23-9fca-13ea0c278f89
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO: 68be9c7a-659c-43a3-8e89-a32c81a76a46
          LOADOPCUSERS: 49f597cd-01c4-4b23-b4e3-5dc2bc13c14c
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOADOPCUSERS
          - locationName: LOAD
            nodeName: LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO') }} LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO
              LEFT JOIN {{ ref('LOAD','LOADOPCUSERS') }} LOADOPCUSERS
                ON LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO.USER_ID = LOADOPCUSERS.IDENTITYUSERID
        name: SRC_STAGEOPC_PARTNER_DEVELOPMENT_SUMMARY_GA3
        noLinkRefs: []
  name: STAGEOPC_PARTNER_DEVELOPMENT_SUMMARY_REFORMAT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
