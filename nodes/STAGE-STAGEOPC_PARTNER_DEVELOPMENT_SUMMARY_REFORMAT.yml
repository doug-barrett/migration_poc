fileVersion: 1
id: 76ded912-7bb2-4d3d-ba9a-f4c0665b40db
name: STAGEOPC_PARTNER_DEVELOPMENT_SUMMARY_REFORMAT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18f6763c-efa3-486f-9998-0a1b0df359a4
          stepCounter: 76ded912-7bb2-4d3d-ba9a-f4c0665b40db
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ACCOUNT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a64a9f4e-8391-4230-894d-c5b3022230f3
          stepCounter: 76ded912-7bb2-4d3d-ba9a-f4c0665b40db
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a61f0be0-23b6-48c9-9a6a-9493c0e6dbd2
                stepCounter: 5d43a8ed-f399-4e73-bd5a-10a1164c33e7
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_PD_SUMMARY_GA4.DATE),'YYYYMMDD')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f2b6e10-e51b-4d65-84c3-5987a42b3fef
          stepCounter: 76ded912-7bb2-4d3d-ba9a-f4c0665b40db
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: GA_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a61f0be0-23b6-48c9-9a6a-9493c0e6dbd2
                stepCounter: 5d43a8ed-f399-4e73-bd5a-10a1164c33e7
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_PD_SUMMARY_GA4.DATE),'YYYYMMDD') \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8891a47b-502f-4d93-990e-e9caa0c6a5a1
          stepCounter: 76ded912-7bb2-4d3d-ba9a-f4c0665b40db
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: USER ID
        name: GA_DIMENSION10
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 440ae38f-dac4-4010-9c69-6c80120e1ec3
                stepCounter: 5d43a8ed-f399-4e73-bd5a-10a1164c33e7
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3cf3e685-8b81-4cff-8f26-01d4a99b5d36
          stepCounter: 76ded912-7bb2-4d3d-ba9a-f4c0665b40db
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: USER NAME
        name: GA_DIMENSION11
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21f68dd2-1aa1-4538-a3ec-d6bdc4a25783
                stepCounter: 7ff10df4-fea2-4cfc-bb85-2391fa82b725
            transform: INITCAP(CONCAT(LOADOPCUSERS.FIRSTNAME,' ',LOADOPCUSERS.LASTNAME))
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: INITCAP(CONCAT(LOADOPCUSERS.FIRSTNAME,' ',LOADOPCUSERS.LASTNAME))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94075dcd-fd88-44f6-a62c-c87d3ff0aa6a
          stepCounter: 76ded912-7bb2-4d3d-ba9a-f4c0665b40db
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER ID - SUPPLIER NAME
        name: GA_DIMENSION12
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c5315bb-edff-4e25-81af-6d2d8fd5d852
                stepCounter: 5d43a8ed-f399-4e73-bd5a-10a1164c33e7
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8557819-a0a3-41ce-a827-4642f93575ef
          stepCounter: 76ded912-7bb2-4d3d-ba9a-f4c0665b40db
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER ID
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c5315bb-edff-4e25-81af-6d2d8fd5d852
                stepCounter: 5d43a8ed-f399-4e73-bd5a-10a1164c33e7
            transform: SPLIT_PART(LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO.USER_SUPPLIER,'-',1) \N \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: SPLIT_PART(LOADGA_OPC_PD_SUMMARY_GA4.USER_SUPPLIER,'-',1) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5feb7232-72d0-4e02-8b83-ffa56a1272b8
          stepCounter: 76ded912-7bb2-4d3d-ba9a-f4c0665b40db
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER NAME
        name: SUPPLIER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c5315bb-edff-4e25-81af-6d2d8fd5d852
                stepCounter: 5d43a8ed-f399-4e73-bd5a-10a1164c33e7
            transform: INITCAP(SPLIT_PART(LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO.USER_SUPPLIER,'-',2)) \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: INITCAP(SPLIT_PART(LOADGA_OPC_PD_SUMMARY_GA4.USER_SUPPLIER,'-',2))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb371750-e0a7-4bea-b336-47eb6a779ad8
          stepCounter: 76ded912-7bb2-4d3d-ba9a-f4c0665b40db
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: SEARCHES
        name: GA_METRIC3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e01bfc20-13e9-49fe-b33a-a437f758e0ab
                stepCounter: 5d43a8ed-f399-4e73-bd5a-10a1164c33e7
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 983cddf4-8aae-40e0-90c4-9cf57d51f7ab
          stepCounter: 76ded912-7bb2-4d3d-ba9a-f4c0665b40db
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: CONTACT INVOKES
        name: GA_METRIC4
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce4479ea-7a01-48d5-a83b-76f20f54f1a8
                stepCounter: 5d43a8ed-f399-4e73-bd5a-10a1164c33e7
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 52a4b591-f5b2-4747-a0ee-e93a5a80ecf7
          stepCounter: 76ded912-7bb2-4d3d-ba9a-f4c0665b40db
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: EXPORTS
        name: GA_METRIC5
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 89392695-c20a-4784-9a22-667529f89965
                stepCounter: 5d43a8ed-f399-4e73-bd5a-10a1164c33e7
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d39a27c-5797-4d55-b854-45d8de7a5f8d
          stepCounter: 76ded912-7bb2-4d3d-ba9a-f4c0665b40db
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: FIRST LOGINS
        name: GA_METRIC6
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b33ba0fc-4fa2-4fcc-8097-3834dee4e2e9
                stepCounter: 5d43a8ed-f399-4e73-bd5a-10a1164c33e7
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17c461e2-c9df-4e9f-8be8-cc36a26e0d4b
          stepCounter: 76ded912-7bb2-4d3d-ba9a-f4c0665b40db
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: GA_SESSIONS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c01f008d-1167-48c8-8d67-9752a6a820d3
                stepCounter: 5d43a8ed-f399-4e73-bd5a-10a1164c33e7
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: COALESCE(LOADGA_OPC_PD_SUMMARY_GA4.LOGINS,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 002eb318-8e41-4b11-a363-1f5695ac6e4b
          stepCounter: 76ded912-7bb2-4d3d-ba9a-f4c0665b40db
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PROFILE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d413d597-05d0-4b22-822f-c06abd854263
          stepCounter: 76ded912-7bb2-4d3d-ba9a-f4c0665b40db
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a61f0be0-23b6-48c9-9a6a-9493c0e6dbd2
                stepCounter: 5d43a8ed-f399-4e73-bd5a-10a1164c33e7
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_PD_SUMMARY_GA4.DATE),'YYYYMMDD') \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 257ba7c2-c91a-4b53-96e0-f06219d1142a
          stepCounter: 76ded912-7bb2-4d3d-ba9a-f4c0665b40db
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: WEB_PROPERTY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1be48f4-2e6b-42a6-852f-17969cbc08f9
          stepCounter: 76ded912-7bb2-4d3d-ba9a-f4c0665b40db
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_BATCHED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3b50ed0-963e-4e9a-a281-75efdb7d3c81
                stepCounter: 5d43a8ed-f399-4e73-bd5a-10a1164c33e7
            transform: TO_TIMESTAMP(LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO.__HEVO__LOADED_AT,3)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_PD_SUMMARY_GA4.__HEVO__LOADED_AT,3)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9cf5905-0227-4a4a-b387-171d3f149679
          stepCounter: 76ded912-7bb2-4d3d-ba9a-f4c0665b40db
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_EXTRACTED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 636e28b0-6a05-463e-8535-b3ce10e82235
                stepCounter: 5d43a8ed-f399-4e73-bd5a-10a1164c33e7
            transform: TO_TIMESTAMP(LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO.__HEVO__LOADED_AT,3) \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_PD_SUMMARY_GA4.__HEVO__INGESTED_AT,3)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45b56f4f-41f9-45c5-9a00-91a2512c7025
          stepCounter: 76ded912-7bb2-4d3d-ba9a-f4c0665b40db
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_RECEIVED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3b50ed0-963e-4e9a-a281-75efdb7d3c81
                stepCounter: 5d43a8ed-f399-4e73-bd5a-10a1164c33e7
            transform: TO_TIMESTAMP(LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO.__HEVO__LOADED_AT,3) \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_PD_SUMMARY_GA4.__HEVO__LOADED_AT,3)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50b82d28-c626-434e-aa09-8b2feb787840
          stepCounter: 76ded912-7bb2-4d3d-ba9a-f4c0665b40db
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: _SDC_RECORD_HASH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9b115974-3e57-4d89-909a-f35fafb26b73
                stepCounter: 5d43a8ed-f399-4e73-bd5a-10a1164c33e7
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f10237b7-e4ee-4242-93ce-ee1bf10a7a76
          stepCounter: 76ded912-7bb2-4d3d-ba9a-f4c0665b40db
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: _SDC_SEQUENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 046cf579-e2ca-4143-9090-1179b8e25cd3
          stepCounter: 76ded912-7bb2-4d3d-ba9a-f4c0665b40db
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: _SDC_TABLE_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b94028fd-1208-4a51-a8b3-6e28f7eca0b1
          stepCounter: 76ded912-7bb2-4d3d-ba9a-f4c0665b40db
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: HOSTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 579ba501-f000-42b2-9436-642339915071
                stepCounter: 5d43a8ed-f399-4e73-bd5a-10a1164c33e7
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7fdc30fa-821a-4550-8e48-cf50e5cd6bea
          stepCounter: 76ded912-7bb2-4d3d-ba9a-f4c0665b40db
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: THIS FIELD WILL BE USED TO FILTER WHICH OPC ENVIRONMENT THIS GA RECORD WILL BE SHOWN.
        name: FILTER_DATABASE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 579ba501-f000-42b2-9436-642339915071
                stepCounter: 5d43a8ed-f399-4e73-bd5a-10a1164c33e7
            transform: CASE HOSTNAME \N WHEN 'OPC-SCUS-SVC-WEB-DEV.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_DEV' \N WHEN 'LOCALHOST' \N THEN 'OMNIACONNECT_DEV' \N WHEN'OPC-SCUS-SVC-WEB-QA.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA' \N WHEN 'OPC-SCUS-SVC-WEB-PROD-STAGING.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA' \N WHEN 'OPC-SCUS-SVC-WEB-UAT.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_UAT' \N WHEN 'OMNIACONNECT.OMNIAPARTNERS.COM' \N THEN 'OMNIACONNECT' \N ELSE NULL \NEND \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: CASE HOSTNAME \N WHEN 'OPC-SCUS-SVC-WEB-DEV.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_DEV' \N WHEN 'LOCALHOST' \N THEN 'OMNIACONNECT_DEV' \N WHEN'OPC-SCUS-SVC-WEB-QA.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA' \N WHEN 'OPC-SCUS-SVC-WEB-PROD-STAGING.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA' \N WHEN 'OPC-SCUS-SVC-WEB-UAT.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_UAT' \N WHEN 'OMNIACONNECT.OMNIAPARTNERS.COM' \N THEN 'OMNIACONNECT' \N ELSE NULL \NEND \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 898ae8be-e704-4b8a-a980-a4fc718a9e9b
          stepCounter: 76ded912-7bb2-4d3d-ba9a-f4c0665b40db
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee0d5c25-979f-4457-a5ed-4ee7256be6aa
                stepCounter: 5d43a8ed-f399-4e73-bd5a-10a1164c33e7
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 399234c9-b673-422b-a899-5700aba5cc6b
          stepCounter: 76ded912-7bb2-4d3d-ba9a-f4c0665b40db
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 941387b2-a0d6-44ef-a590-f719896a0d27
                stepCounter: 5d43a8ed-f399-4e73-bd5a-10a1164c33e7
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1bd22b2-e5dc-4871-a1de-938504162ed6
          stepCounter: 76ded912-7bb2-4d3d-ba9a-f4c0665b40db
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f57616fc-4a5e-4c3f-bc92-733034804a8e
          stepCounter: 76ded912-7bb2-4d3d-ba9a-f4c0665b40db
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO: 5d43a8ed-f399-4e73-bd5a-10a1164c33e7
          LOADOPCUSERS: 7ff10df4-fea2-4cfc-bb85-2391fa82b725
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOADOPCUSERS
          - locationName: LOAD
            nodeName: LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO') }} LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO
              LEFT JOIN {{ ref('LOAD','LOADOPCUSERS') }} LOADOPCUSERS
                ON LOADOPC_PARTNER_DEVELOPMENT_SUMMARY_HEVO.USER_ID = LOADOPCUSERS.IDENTITYUSERID
        name: SRC_STAGEOPC_PARTNER_DEVELOPMENT_SUMMARY_GA3
        noLinkRefs: []
  name: STAGEOPC_PARTNER_DEVELOPMENT_SUMMARY_REFORMAT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
