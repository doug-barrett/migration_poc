fileVersion: 1
id: 1ad894ee-8ec3-455a-a9b7-a00006a4f62f
name: S_OUTPATIENT_APPOINTMENT_SUMMARY
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Outpatient Appointment summaries for a Outpatient Session facts"
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e139fe7-1074-499b-bc78-8a5525534b51
          stepCounter: 1ad894ee-8ec3-455a-a9b7-a00006a4f62f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OUTPATIENT_SESSION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d600e497-6475-4456-bc99-f0b83cf0a491
                stepCounter: 95548c6d-4b83-4d1b-a940-eb0a38b41205
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dd4fcab2-73cd-4d0b-8ae7-c795c7358f59
          stepCounter: 1ad894ee-8ec3-455a-a9b7-a00006a4f62f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENTS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: SUM(CASE WHEN ds_outpatient_appointment_30.appointment_status_type_code ='A' THEN 1 ELSE 0 END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88313705-9a14-4f82-8807-f1bf9222334c
          stepCounter: 1ad894ee-8ec3-455a-a9b7-a00006a4f62f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NEW_ATTENDS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa14d061-c0e4-4572-98e8-dc7df2ecf3e4
                stepCounter: 95548c6d-4b83-4d1b-a940-eb0a38b41205
            transform: SUM(CASE WHEN ds_outpatient_appointment_30.new_attend_flag = 'Y' AND ds_outpatient_appointment_30.DNA_flag = 'N' AND ds_outpatient_appointment_30.appointment_status_type_code='A' THEN 1 ELSE 0 END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6e77555-d16d-4a20-b5db-c247fb67f121
          stepCounter: 1ad894ee-8ec3-455a-a9b7-a00006a4f62f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NEW_DNA_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 336d4503-08b4-4387-9c64-e921fe2f354a
                stepCounter: 95548c6d-4b83-4d1b-a940-eb0a38b41205
            transform: SUM(CASE WHEN ds_outpatient_appointment_30.new_attend_flag = 'Y' AND ds_outpatient_appointment_30.DNA_flag = 'Y' THEN 1 ELSE 0 END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 407dc504-3659-416d-8c72-2c8ba28736d4
          stepCounter: 1ad894ee-8ec3-455a-a9b7-a00006a4f62f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NEW_INCOMPLETE_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa14d061-c0e4-4572-98e8-dc7df2ecf3e4
                stepCounter: 95548c6d-4b83-4d1b-a940-eb0a38b41205
            transform: SUM(CASE WHEN ds_outpatient_appointment_30.new_attend_flag = 'Y' AND ds_outpatient_appointment_30.appointment_status_type_code='A' AND NULLIF(ds_outpatient_appointment_30.appointment_outcome_reference_no,11586) IS NULL AND COALESCE(ds_outpatient_appointment_30.appointment_start_date,ds_outpatient_appointment_30.patient_arrived_date,ds_outpatient_appointment_30.patient_seen_by_date) < getdate() THEN 1 ELSE 0 END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de779436-e179-4a50-bfbf-dd3169626608
          stepCounter: 1ad894ee-8ec3-455a-a9b7-a00006a4f62f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FUP_ATTENDS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a364cf54-e0cf-4c7b-a14f-4fe1a0f5a381
                stepCounter: 95548c6d-4b83-4d1b-a940-eb0a38b41205
            transform: SUM(CASE WHEN ds_outpatient_appointment_30.FUP_attend_flag = 'Y' AND ds_outpatient_appointment_30.DNA_flag = 'N' AND ds_outpatient_appointment_30.appointment_status_type_code ='A' THEN 1 ELSE 0 END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88afcfb9-5177-4394-8d2f-6c56d0056269
          stepCounter: 1ad894ee-8ec3-455a-a9b7-a00006a4f62f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FUP_DNA_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 336d4503-08b4-4387-9c64-e921fe2f354a
                stepCounter: 95548c6d-4b83-4d1b-a940-eb0a38b41205
            transform: SUM(CASE WHEN ds_outpatient_appointment_30.FUP_attend_flag = 'Y' AND ds_outpatient_appointment_30.DNA_flag = 'Y' THEN 1 ELSE 0 END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b6957cb-f4c3-4e16-b4ef-7d3b0bb2a548
          stepCounter: 1ad894ee-8ec3-455a-a9b7-a00006a4f62f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FUP_INCOMPLETE_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a364cf54-e0cf-4c7b-a14f-4fe1a0f5a381
                stepCounter: 95548c6d-4b83-4d1b-a940-eb0a38b41205
            transform: SUM(CASE WHEN ds_outpatient_appointment_30.FUP_attend_flag = 'Y' AND NULLIF(ds_outpatient_appointment_30.appointment_outcome_reference_no,11586) IS NULL AND ds_outpatient_appointment_30.appointment_status_type_code='A' AND COALESCE(ds_outpatient_appointment_30.appointment_start_date,ds_outpatient_appointment_30.patient_arrived_date,ds_outpatient_appointment_30.patient_seen_by_date) < getdate() THEN 1 ELSE 0 END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef07e33c-8e29-4504-b4ca-39c48ed92c14
          stepCounter: 1ad894ee-8ec3-455a-a9b7-a00006a4f62f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: first_patient_start_date
        name: FIRST_PATIENT_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47c20252-59a5-46ea-9875-330372630f94
                stepCounter: 95548c6d-4b83-4d1b-a940-eb0a38b41205
            transform: MIN(ISNULL(ds_outpatient_appointment_30.patient_seen_by_date,ds_outpatient_appointment_30.patient_arrived_date))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df55735e-f3cb-4247-9a30-93c838c46c87
          stepCounter: 1ad894ee-8ec3-455a-a9b7-a00006a4f62f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: last_patient_end_date
        name: LAST_PATIENT_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 079e8b5e-4956-40d0-bfe0-a968d6987fa1
                stepCounter: 95548c6d-4b83-4d1b-a940-eb0a38b41205
            transform: MAX(ISNULL(ds_outpatient_appointment_30.patient_departed_date,ds_outpatient_appointment_30.patient_departed_date))
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: STAGE
            nodeName: DS_OUTPATIENT_APPOINTMENT_30
        join:
          joinCondition: |-
            FROM ds_outpatient_appointment_30
             GROUP BY outpatient_session_reference_no
        name: S_OUTPATIENT_APPOINTMENT_SUMMARY
        noLinkRefs: []
  name: S_OUTPATIENT_APPOINTMENT_SUMMARY
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
