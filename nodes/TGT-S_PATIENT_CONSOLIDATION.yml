fileVersion: 1
id: df9ea28f-65df-42d4-a6db-0f86dc5cfb39
name: S_PATIENT_CONSOLIDATION
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 28dbde4a-fef6-4246-9991-2f476671ff8c
          stepCounter: df9ea28f-65df-42d4-a6db-0f86dc5cfb39
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e73b486-d476-44c7-a897-a1cf4644c1ce
                stepCounter: bf1fae08-34d0-48b2-bec2-0d1f4aa380bd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0caacdd-61bd-4ec8-b88a-f7ef2dcac6af
          stepCounter: df9ea28f-65df-42d4-a6db-0f86dc5cfb39
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4523affd-6b1c-42a1-97a2-39457fc5c638
                stepCounter: bf1fae08-34d0-48b2-bec2-0d1f4aa380bd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e15cede3-4a2f-484b-ae03-206bb956e5ae
          stepCounter: df9ea28f-65df-42d4-a6db-0f86dc5cfb39
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FUNDED_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a8a0cf40-5c4d-4cc1-92bd-4a25ff4ba65a
                stepCounter: bf1fae08-34d0-48b2-bec2-0d1f4aa380bd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1fd8e56-5369-49ea-9bc5-b2d05f16b15c
          stepCounter: df9ea28f-65df-42d4-a6db-0f86dc5cfb39
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4f04d204-d490-4bac-b816-1ebb17810901
                stepCounter: bf1fae08-34d0-48b2-bec2-0d1f4aa380bd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1783059-26de-492e-8e1b-290acb37e1bc
          stepCounter: df9ea28f-65df-42d4-a6db-0f86dc5cfb39
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d1f8524-6a4c-429e-8523-b86e498bd2b4
                stepCounter: bf1fae08-34d0-48b2-bec2-0d1f4aa380bd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a4c7e07a-08d4-4a7d-b846-02cd8142a5f9
          stepCounter: df9ea28f-65df-42d4-a6db-0f86dc5cfb39
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: START_DATE_ONLY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5451d217-ff57-46c0-b73d-be179bcb5ff7
                stepCounter: bf1fae08-34d0-48b2-bec2-0d1f4aa380bd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c428eaa5-546e-4368-87b4-c946925fdcdd
          stepCounter: df9ea28f-65df-42d4-a6db-0f86dc5cfb39
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: END_DATE_ONLY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd09645b-6682-4f24-8ad3-f874ce74dc05
                stepCounter: bf1fae08-34d0-48b2-bec2-0d1f4aa380bd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40208e60-b581-48bd-a051-36fa6fd6bcd4
          stepCounter: df9ea28f-65df-42d4-a6db-0f86dc5cfb39
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7de995d8-99bb-462f-94d6-30efebace0ad
                stepCounter: bf1fae08-34d0-48b2-bec2-0d1f4aa380bd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 61b0789c-8559-460c-b4bf-834c95d42917
          stepCounter: df9ea28f-65df-42d4-a6db-0f86dc5cfb39
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: WAITLIST_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 49a5b943-c32b-416b-9067-5c05682d3e88
                stepCounter: bf1fae08-34d0-48b2-bec2-0d1f4aa380bd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e9ca820-28d6-4a61-9785-de68a54e3e8f
          stepCounter: df9ea28f-65df-42d4-a6db-0f86dc5cfb39
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: HOSPITAL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 692c7e6a-499c-4685-bec5-86831ce4744a
                stepCounter: bf1fae08-34d0-48b2-bec2-0d1f4aa380bd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dfb729e0-453e-4042-a70b-e8e17db7038f
          stepCounter: df9ea28f-65df-42d4-a6db-0f86dc5cfb39
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: DIM_PURCHASE_UNIT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 88092bbf-f5a2-4820-af73-35c695c3e868
                stepCounter: bf1fae08-34d0-48b2-bec2-0d1f4aa380bd
            transform: IFNULL(s_consolidate_1.dim_purchase_unit_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d8c2902-8830-4eb7-a775-48ec7996f0f3
          stepCounter: df9ea28f-65df-42d4-a6db-0f86dc5cfb39
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 087ac9d4-7b92-4b6c-9e0f-e9affe42cd99
                stepCounter: bf1fae08-34d0-48b2-bec2-0d1f4aa380bd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8001293a-1679-4807-b8cf-67cf8a541ad4
          stepCounter: df9ea28f-65df-42d4-a6db-0f86dc5cfb39
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: PATIENT_TYPE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a5a0d144-488b-424c-95d8-708763fd40cd
                stepCounter: bf1fae08-34d0-48b2-bec2-0d1f4aa380bd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8baf84d5-899a-4151-835c-cb92133f8063
          stepCounter: df9ea28f-65df-42d4-a6db-0f86dc5cfb39
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a0ee388f-62be-4a70-843d-8fac5b1947cd
                stepCounter: bf1fae08-34d0-48b2-bec2-0d1f4aa380bd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e3efdeb-a914-4e04-8da2-866661e3cb6b
          stepCounter: df9ea28f-65df-42d4-a6db-0f86dc5cfb39
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SOURCE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: facbdc2e-0fcb-4f8e-99c9-3672e1e5a2fa
                stepCounter: bf1fae08-34d0-48b2-bec2-0d1f4aa380bd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 089ab10b-ed4a-4b82-b791-34501d49d1ce
          stepCounter: df9ea28f-65df-42d4-a6db-0f86dc5cfb39
        config: {}
        dataType: BIT
        defaultValue: ""
        description: Was this a visit that has occured
        name: ATTENDED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 932166a2-054c-4d99-bfb9-45f71f0e0ef9
                stepCounter: bf1fae08-34d0-48b2-bec2-0d1f4aa380bd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed719e00-02e1-44ce-8e4d-0d4216413b78
          stepCounter: df9ea28f-65df-42d4-a6db-0f86dc5cfb39
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_CONSOLIDATE_1: bf1fae08-34d0-48b2-bec2-0d1f4aa380bd
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_CONSOLIDATE_1
        join:
          joinCondition: FROM {{ ref('TGT','S_CONSOLIDATE_1') }} s_consolidate_1
        name: S_PATIENT_CONSOLIDATION
        noLinkRefs: []
  name: S_PATIENT_CONSOLIDATION
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
