fileVersion: 1
id: 675fa23a-f49b-45f5-82ba-37ab1e268455
name: S_EVITALS_FORM_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Bring together from Patientrack load tables all the required eVitals form data."
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed3a450a-8bf0-4a40-9762-586fb7ed7b3a
          stepCounter: 675fa23a-f49b-45f5-82ba-37ab1e268455
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: ""
        name: FORM_INSTANCE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9e0260dc-78c4-40b2-8e85-cecbe21ca9a3
                stepCounter: b874b9f2-8057-4368-8eff-5c5db098a802
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7a3f2dc-c721-4342-afec-c004563bb5f4
          stepCounter: 675fa23a-f49b-45f5-82ba-37ab1e268455
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23d10545-f608-4e35-b605-4c01adc85d66
                stepCounter: b874b9f2-8057-4368-8eff-5c5db098a802
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 418bacdf-d0b1-4f6b-8f37-05812a0cbc7e
          stepCounter: 675fa23a-f49b-45f5-82ba-37ab1e268455
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ADMISSION_WARD_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c0ea741e-b9c4-4ab6-81f7-a1e78200d01a
                stepCounter: b874b9f2-8057-4368-8eff-5c5db098a802
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 13459a32-2dd9-4287-9558-54a6bf78d14b
          stepCounter: 675fa23a-f49b-45f5-82ba-37ab1e268455
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: WARD_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56931e17-4bd0-4c4e-ba7f-835c7f568b8f
                stepCounter: b874b9f2-8057-4368-8eff-5c5db098a802
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15d1ff58-ed9d-4845-996e-cef86f428c7d
          stepCounter: 675fa23a-f49b-45f5-82ba-37ab1e268455
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: ""
        name: FORM_DEFINITION_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e0fe04a2-534d-4cfe-a3fb-58c68a42e329
                stepCounter: 9cc58f84-f106-402f-96ab-293efcfe84ca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2f4582e-355a-449c-9edb-b5131ef894c3
          stepCounter: 675fa23a-f49b-45f5-82ba-37ab1e268455
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FORM_CREATED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b208477c-b8ea-4b96-ac01-4b0d196ea2fd
                stepCounter: 9cc58f84-f106-402f-96ab-293efcfe84ca
            transform: dbo.fn_convert_utc_datetime2(ds_Patientrack_FORM_INSTANCE.CREATE_DTTM)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 436eecf1-7b8b-4c78-b917-281507280e62
          stepCounter: 675fa23a-f49b-45f5-82ba-37ab1e268455
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: FORM_CREATED_USER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b457d3fb-5adc-4c51-9995-16c947dcb9a4
                stepCounter: 9cc58f84-f106-402f-96ab-293efcfe84ca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff8bc3e2-5596-4ce7-b00e-0b573acad937
          stepCounter: 675fa23a-f49b-45f5-82ba-37ab1e268455
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FORM_MODIFIED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec7241b5-c215-400f-86a9-3da27b4d4593
                stepCounter: 9cc58f84-f106-402f-96ab-293efcfe84ca
            transform: dbo.fn_convert_utc_datetime2(ds_Patientrack_FORM_INSTANCE.MODIF_DTTM)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7fca7456-a538-42d4-90c4-f9648c443548
          stepCounter: 675fa23a-f49b-45f5-82ba-37ab1e268455
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: FORM_MODIFIED_USER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a105ca61-b638-4ad1-8a45-e7394afd254a
                stepCounter: 9cc58f84-f106-402f-96ab-293efcfe84ca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e58db0f0-55d0-4119-906a-cb1cde7e8549
          stepCounter: 675fa23a-f49b-45f5-82ba-37ab1e268455
        config: {}
        dataType: CHAR(10)
        defaultValue: ""
        description: ""
        name: SORCE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d5c8fb4-e6da-4a5f-9fd4-0df21c19dc66
                stepCounter: 9cc58f84-f106-402f-96ab-293efcfe84ca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2db04490-d1bd-4de1-bba3-237fa1c15386
          stepCounter: 675fa23a-f49b-45f5-82ba-37ab1e268455
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FORM_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 06106a02-aca4-4285-a494-84c7c36b7dbd
                stepCounter: e984f273-ad66-4d24-a2be-8f366e99713d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6822f037-6162-42bf-b048-89326eeb2874
          stepCounter: 675fa23a-f49b-45f5-82ba-37ab1e268455
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ADMISSION_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 585eb4aa-5380-4f45-9ddf-e2b67adb3ca1
                stepCounter: a8e499ca-300b-48a9-9045-922a42433271
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7316e24b-d4d9-48ed-b257-4feff4bea171
          stepCounter: 675fa23a-f49b-45f5-82ba-37ab1e268455
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMISSION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 42867c9a-5954-44f5-b872-5769615dc474
                stepCounter: a8e499ca-300b-48a9-9045-922a42433271
            transform: dbo.fn_convert_utc_datetime2(ds_Patientrack_EPISODE.ADMISSION_DTTM)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cacdc958-8e43-41c7-ba0e-e945cbf10f9a
          stepCounter: 675fa23a-f49b-45f5-82ba-37ab1e268455
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 358be7ab-ae47-4f66-8400-773a47d32093
                stepCounter: a8e499ca-300b-48a9-9045-922a42433271
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee2dfd9c-2484-4a61-a3fc-ad7ce73fe46c
          stepCounter: 675fa23a-f49b-45f5-82ba-37ab1e268455
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Alphanumeric code that uniquely identifies a ward in Patientrack.
        name: WARD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c30e7937-2552-497e-8ce0-84326aa36f1f
                stepCounter: fd33378b-8099-40d2-8fbf-bd76e1f3e2a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd51947b-ffb1-4635-9a23-94ca65993914
          stepCounter: 675fa23a-f49b-45f5-82ba-37ab1e268455
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: 'Internal unique identifier for a patient from the Patient Management System '
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 702dfc9d-df5e-42d8-86f8-9e68f29c462c
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 295b70f3-094d-459d-a90f-2b9946395c02
          stepCounter: 675fa23a-f49b-45f5-82ba-37ab1e268455
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_EVITALS_FORM_04
        join:
          joinCondition: |-
            FROM s_eVitals_form_04
              JOIN ds_Patientrack_FORM_INSTANCE
                ON s_eVitals_form_04.form_instance_id = ds_Patientrack_FORM_INSTANCE.form_instance_id
              JOIN l_Patientrack_FORM_DEFINITION
                ON ds_Patientrack_FORM_INSTANCE.form_definition_id = l_Patientrack_FORM_DEFINITION.form_definition_id
              JOIN ds_Patientrack_episode
                ON ds_Patientrack_episode.epsde_PK = ds_Patientrack_FORM_INSTANCE.ADMSN_PK
              LEFT OUTER JOIN s_eVitals_ward
                ON s_eVitals_ward.ward_id = s_eVitals_form_04.ward_id
              LEFT OUTER JOIN dim.dim_patient
                ON dim_patient.patient_NHI = s_eVitals_form_04.patient_NHI
               AND dim_patient.NHI_sequence = 1
             WHERE s_eVitals_form_04.ward_row_num = 1 -- Return only 1 row per form_instance_id
        name: S_EVITALS_FORM_10
        noLinkRefs: []
  name: S_EVITALS_FORM_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
