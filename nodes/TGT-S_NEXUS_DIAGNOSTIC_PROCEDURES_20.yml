fileVersion: 1
id: 195c7d3c-b034-4e39-8d7b-6884478bd8f1
name: S_NEXUS_DIAGNOSTIC_PROCEDURES_20
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8b57704-de08-4427-b570-d75e4ba7c222
          stepCounter: 195c7d3c-b034-4e39-8d7b-6884478bd8f1
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SCHEDULE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24591a72-cd5f-47f2-9188-774e988170e9
                stepCounter: 46f11841-9f37-4506-96bc-f77bdb3eef6a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 959b440f-53b9-4a86-bfa0-7614113f0cd2
          stepCounter: 195c7d3c-b034-4e39-8d7b-6884478bd8f1
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: THEATRE_VISIT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cfe9542f-5b65-428f-a349-67902477fa90
                stepCounter: 46f11841-9f37-4506-96bc-f77bdb3eef6a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d9a5de4-0c88-43cb-822e-c93972c0e98f
          stepCounter: 195c7d3c-b034-4e39-8d7b-6884478bd8f1
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: VISIT_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc694249-5d7a-486b-9697-6b82006b767f
                stepCounter: 46f11841-9f37-4506-96bc-f77bdb3eef6a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a76cf654-6ceb-4cb4-a4d7-5d4592c4fbc2
          stepCounter: 195c7d3c-b034-4e39-8d7b-6884478bd8f1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated key for the date dimension. Nominal format is YYYYMMDD, but DD equal to 0 and greater than 31 permited for special date handling.
        name: DIM_VISIT_START_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b892e72c-60e7-4470-beca-334f7956098c
                stepCounter: 46f11841-9f37-4506-96bc-f77bdb3eef6a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6d937e6-324d-4362-baf6-070fbbc3244f
          stepCounter: 195c7d3c-b034-4e39-8d7b-6884478bd8f1
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: VISIT_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ca362772-f0af-4d90-b1ac-564583bf0591
                stepCounter: 46f11841-9f37-4506-96bc-f77bdb3eef6a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 386a7bab-4fb4-40f7-a9dd-c55ce9b763d0
          stepCounter: 195c7d3c-b034-4e39-8d7b-6884478bd8f1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated key for the date dimension. Nominal format is YYYYMMDD, but DD equal to 0 and greater than 31 permited for special date handling.
        name: DIM_VISIT_END_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94822fbc-63ab-420b-8a71-efd45b6f011b
                stepCounter: 46f11841-9f37-4506-96bc-f77bdb3eef6a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 00a9aaf3-a112-4ec9-a3ce-be59507f37e8
          stepCounter: 195c7d3c-b034-4e39-8d7b-6884478bd8f1
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CODING_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 89c921ff-10c2-431e-8a23-074734bd33d9
                stepCounter: 46f11841-9f37-4506-96bc-f77bdb3eef6a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b161bd0-c405-4a37-9048-d07dded89460
          stepCounter: 195c7d3c-b034-4e39-8d7b-6884478bd8f1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: 'Internal unique identifier for a patient from the Patient Management System '
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 702dfc9d-df5e-42d8-86f8-9e68f29c462c
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d9e1ef8-b1cb-4567-8280-78ba189db234
          stepCounter: 195c7d3c-b034-4e39-8d7b-6884478bd8f1
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94553827-78dd-4f51-819a-1ea1fec24594
                stepCounter: 46f11841-9f37-4506-96bc-f77bdb3eef6a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b87ab135-0f50-4449-8675-fd8388bf0242
          stepCounter: 195c7d3c-b034-4e39-8d7b-6884478bd8f1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_nexus_diagnostic_procedures_20.patient_reference_no=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9962a01b-5f3d-4c1a-b371-997edef38d0f
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: IFNULL(dim_patient.dim_patient_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9986b556-1ac6-4d03-80b7-3d429f55c177
          stepCounter: 195c7d3c-b034-4e39-8d7b-6884478bd8f1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: MEDICAL_PROBLEM_LEVEL_NO
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1465450c-96ab-4e4b-9fc7-1486fdcf8c20
                stepCounter: 46f11841-9f37-4506-96bc-f77bdb3eef6a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d146032-5f13-4c8b-9776-1e66552aa1b4
          stepCounter: 195c7d3c-b034-4e39-8d7b-6884478bd8f1
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: MEDICAL_PROBLEM_LEVEL_CODE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c30e85b-7f72-4ea4-89dd-2efe05691702
                stepCounter: 46f11841-9f37-4506-96bc-f77bdb3eef6a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c495c639-e54d-4207-901a-04a876f14e7a
          stepCounter: 195c7d3c-b034-4e39-8d7b-6884478bd8f1
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_TYPE_CODE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 80429aa8-67af-4499-99db-8009cfc629b7
                stepCounter: 46f11841-9f37-4506-96bc-f77bdb3eef6a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9caefeeb-bac8-479b-bee0-b99baf34f628
          stepCounter: 195c7d3c-b034-4e39-8d7b-6884478bd8f1
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_SUBTYPE_CODE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eb44f881-fca0-4bfc-a502-7dcbac763898
                stepCounter: 46f11841-9f37-4506-96bc-f77bdb3eef6a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24ff07fc-5f98-411c-92c1-a1295a4a0845
          stepCounter: 195c7d3c-b034-4e39-8d7b-6884478bd8f1
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: CLINICAL_CLASSIFICATION_XREF_CODE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c429804-2db3-4001-90b8-8d963600cb6b
                stepCounter: 46f11841-9f37-4506-96bc-f77bdb3eef6a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6cd9a15d-9859-40ab-b1c5-47efa8c4fe05
          stepCounter: 195c7d3c-b034-4e39-8d7b-6884478bd8f1
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: CLINICAL_CLASSIFICATION_XREF_DESC
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b7b57bad-d676-48e3-862b-b3899ae2f6e8
                stepCounter: 46f11841-9f37-4506-96bc-f77bdb3eef6a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 306b69a0-8734-4a6a-9c70-f78f7fd965b3
          stepCounter: 195c7d3c-b034-4e39-8d7b-6884478bd8f1
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48e189ad-dc4a-418f-a588-5d6230ecbcb9
                stepCounter: 46f11841-9f37-4506-96bc-f77bdb3eef6a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3be5cbf9-e7a3-4e56-bdd3-26456aedf21c
          stepCounter: 195c7d3c-b034-4e39-8d7b-6884478bd8f1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_THEATRE_PROCEDURE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b506453d-2bda-4692-851c-c6e5fb0325cd
                stepCounter: 46f11841-9f37-4506-96bc-f77bdb3eef6a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e04a557-663c-4ba6-8825-5ef8f6bc7f7e
          stepCounter: 195c7d3c-b034-4e39-8d7b-6884478bd8f1
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PATIENT_DIAGNOSIS_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75e86a4c-2284-43f4-8df3-3f1a344f293f
                stepCounter: 46f11841-9f37-4506-96bc-f77bdb3eef6a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b48ff537-6583-4b4d-89c1-3da12634f930
          stepCounter: 195c7d3c-b034-4e39-8d7b-6884478bd8f1
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PATIENT_DIAGNOSIS_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48b48001-92af-402c-bbaf-659f20f0348e
                stepCounter: 46f11841-9f37-4506-96bc-f77bdb3eef6a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 84ab4a5b-cb36-4b46-b957-a1063928262d
          stepCounter: 195c7d3c-b034-4e39-8d7b-6884478bd8f1
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PATIENT_PROCEDURE_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ae3d72bf-f74a-4ba3-8de4-6d07ab017d60
                stepCounter: 46f11841-9f37-4506-96bc-f77bdb3eef6a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9643bc34-1395-430b-b48e-992ece4a747c
          stepCounter: 195c7d3c-b034-4e39-8d7b-6884478bd8f1
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PATIENT_PROCEDURE_COUNT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ce2e8dd-7360-499d-8705-343f1f1bc545
                stepCounter: 46f11841-9f37-4506-96bc-f77bdb3eef6a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d749942-71c3-465d-aa35-149edca0b3c1
          stepCounter: 195c7d3c-b034-4e39-8d7b-6884478bd8f1
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a4fcfc0-cb53-459b-9f73-83f2fa0888ef
                stepCounter: 46f11841-9f37-4506-96bc-f77bdb3eef6a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f95587a-eded-4abc-bbcd-cdec5b216205
          stepCounter: 195c7d3c-b034-4e39-8d7b-6884478bd8f1
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8179c86e-9fb1-4c4f-93c9-8caa544938a2
                stepCounter: 46f11841-9f37-4506-96bc-f77bdb3eef6a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2063f3fb-41ae-40e0-8fc7-18f242f90c51
          stepCounter: 195c7d3c-b034-4e39-8d7b-6884478bd8f1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_nexus_diagnostic_procedures_20.create_user_login_code=dim_create_user_login.create_user_login_code
        name: DIM_CREATE_USER_LOGIN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2dfe5e14-cc2f-4748-8352-a6d1621289af
                stepCounter: 70bd6ed5-e21b-440f-9079-7fe305bc4f30
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 607be30c-3afa-4316-9633-f674bafa5f25
          stepCounter: 195c7d3c-b034-4e39-8d7b-6884478bd8f1
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIFY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 162a3175-70d7-49a2-844a-6c627c04905d
                stepCounter: 46f11841-9f37-4506-96bc-f77bdb3eef6a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2fe94dcd-c9d9-448f-976b-edcb7d7de9cd
          stepCounter: 195c7d3c-b034-4e39-8d7b-6884478bd8f1
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: OUTPATIENT_COUNT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f30cf8e-6602-46e5-85f3-39dd2ac6a243
                stepCounter: 46f11841-9f37-4506-96bc-f77bdb3eef6a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 788ebf62-d4e6-43b5-9fa6-a3216233887e
          stepCounter: 195c7d3c-b034-4e39-8d7b-6884478bd8f1
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: MODIFY_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c865367b-7e3d-41a1-b95f-f1f04446ab56
                stepCounter: 46f11841-9f37-4506-96bc-f77bdb3eef6a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4db3e610-cc82-4e0d-942d-3a444a05a5d6
          stepCounter: 195c7d3c-b034-4e39-8d7b-6884478bd8f1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_nexus_diagnostic_procedures_20.modify_user_login_code=dim_modify_user_login.modify_user_login_code
        name: DIM_MODIFY_USER_LOGIN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ceaa34a6-dd0b-40fb-bc61-9df93cc05e7b
                stepCounter: bef0768d-dddb-4d02-af8d-03160de42b62
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 492cec47-ec82-4824-9905-52cb943d09c7
          stepCounter: 195c7d3c-b034-4e39-8d7b-6884478bd8f1
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_NEXUS_DIAGNOSTIC_PROCEDURES_10: 46f11841-9f37-4506-96bc-f77bdb3eef6a
          DIM_PATIENT: d52dd438-7899-4242-9e38-539d2a1447df
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_NEXUS_DIAGNOSTIC_PROCEDURES_10
          - locationName: TGT
            nodeName: DIM_PATIENT
        join:
          joinCondition: |-
            FROM {{ ref('TGT','S_NEXUS_DIAGNOSTIC_PROCEDURES_10') }}
              LEFT JOIN {{ ref('TGT','DIM_PATIENT') }}
                ON s_nexus_diagnostic_procedures_10.patient_NHI = dim_patient.patient_NHI
               AND dim_patient.NHI_sequence = 1
        name: S_NEXUS_DIAGNOSTIC_PROCEDURES_20
        noLinkRefs: []
  name: S_NEXUS_DIAGNOSTIC_PROCEDURES_20
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
