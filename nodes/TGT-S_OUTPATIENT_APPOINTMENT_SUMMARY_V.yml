fileVersion: 1
id: 00f153d5-b2da-4d99-b747-0b83119eb4db
name: S_OUTPATIENT_APPOINTMENT_SUMMARY_V
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26cdecbe-b404-4fc6-80c8-7d9d9b598eca
          stepCounter: 00f153d5-b2da-4d99-b747-0b83119eb4db
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: OUTPATIENT_SESSION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1eaf2554-222f-42c2-a8c7-a69a672ad50f
                stepCounter: 93c63ba9-752b-4aed-8129-37fe9d2a3fea
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dd701644-eb8f-4efb-80e6-238805c3d580
          stepCounter: 00f153d5-b2da-4d99-b747-0b83119eb4db
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENTS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: SUM(CASE WHEN ds_outpatient_appointment_30.appointment_status_type_code ='A' THEN 1 ELSE 0 END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a43004f8-e53d-46a3-9f96-13a990b1f8d3
          stepCounter: 00f153d5-b2da-4d99-b747-0b83119eb4db
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NEW_ATTENDS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: SUM(CASE WHEN ds_outpatient_appointment_30.new_attend_flag = 'Y' AND ds_outpatient_appointment_30.DNA_flag = 'N' AND ds_outpatient_appointment_30.appointment_status_type_code='A' THEN 1 ELSE 0 END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 37183bf1-97c2-41ca-9112-7e75049302da
          stepCounter: 00f153d5-b2da-4d99-b747-0b83119eb4db
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NEW_DNA_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: SUM(CASE WHEN ds_outpatient_appointment_30.new_attend_flag = 'Y' AND ds_outpatient_appointment_30.DNA_flag = 'Y' THEN 1 ELSE 0 END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39efc295-5e79-4f6f-8925-94fe63d0e797
          stepCounter: 00f153d5-b2da-4d99-b747-0b83119eb4db
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: NEW_INCOMPLETE_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: SUM(CASE WHEN ds_outpatient_appointment_30.new_attend_flag = 'Y' AND ds_outpatient_appointment_30.appointment_status_type_code='A' AND NULLIF(ds_outpatient_appointment_30.appointment_outcome_reference_no,11586) IS NULL AND COALESCE(ds_outpatient_appointment_30.appointment_start_date,ds_outpatient_appointment_30.patient_arrived_date,ds_outpatient_appointment_30.patient_seen_by_date) < getdate() THEN 1 ELSE 0 END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81e151e8-2529-48b2-ac72-3e9ad78f5e46
          stepCounter: 00f153d5-b2da-4d99-b747-0b83119eb4db
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FUP_ATTENDS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: SUM(CASE WHEN ds_outpatient_appointment_30.FUP_attend_flag = 'Y' AND ds_outpatient_appointment_30.DNA_flag = 'N' AND ds_outpatient_appointment_30.appointment_status_type_code ='A' THEN 1 ELSE 0 END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e0c0265-b64a-45ed-b7f7-567c08e0ed6f
          stepCounter: 00f153d5-b2da-4d99-b747-0b83119eb4db
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FUP_DNA_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: SUM(CASE WHEN ds_outpatient_appointment_30.FUP_attend_flag = 'Y' AND ds_outpatient_appointment_30.DNA_flag = 'Y' THEN 1 ELSE 0 END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 73d7030a-8ad0-4e44-bdf8-6e0b6e53da4f
          stepCounter: 00f153d5-b2da-4d99-b747-0b83119eb4db
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FUP_INCOMPLETE_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: SUM(CASE WHEN ds_outpatient_appointment_30.FUP_attend_flag = 'Y' AND NULLIF(ds_outpatient_appointment_30.appointment_outcome_reference_no,11586) IS NULL AND ds_outpatient_appointment_30.appointment_status_type_code='A' AND COALESCE(ds_outpatient_appointment_30.appointment_start_date,ds_outpatient_appointment_30.patient_arrived_date,ds_outpatient_appointment_30.patient_seen_by_date) < getdate() THEN 1 ELSE 0 END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ade0787-e1c4-4674-bb95-87cf380625ba
          stepCounter: 00f153d5-b2da-4d99-b747-0b83119eb4db
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_PATIENT_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: MIN(IFNULL(ds_outpatient_appointment_30.patient_seen_by_date,ds_outpatient_appointment_30.patient_arrived_date))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4535b50f-9aa3-477d-9fc2-8e07b3067d30
          stepCounter: 00f153d5-b2da-4d99-b747-0b83119eb4db
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_PATIENT_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: MAX(IFNULL(ds_outpatient_appointment_30.patient_departed_date,ds_outpatient_appointment_30.patient_departed_date))
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DS_OUTPATIENT_APPOINTMENT_30: 93c63ba9-752b-4aed-8129-37fe9d2a3fea
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_OUTPATIENT_APPOINTMENT_30
        join:
          joinCondition: |-
            FROM {{ ref('TGT','DS_OUTPATIENT_APPOINTMENT_30') }}
             GROUP BY outpatient_session_reference_no
        name: S_OUTPATIENT_APPOINTMENT_SUMMARY_V
        noLinkRefs: []
  name: S_OUTPATIENT_APPOINTMENT_SUMMARY_V
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
