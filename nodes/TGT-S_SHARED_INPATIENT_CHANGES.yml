fileVersion: 1
id: 3e756094-7e86-4086-a4af-59124cd9e961
name: S_SHARED_INPATIENT_CHANGES
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Contains all events for each NHI where at least one event has changed.  Custom proc will insert a row for all events so that tables can be fully loaded."
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e5d1eba-8e50-4f3c-b18d-5c67c57404e8
          stepCounter: 3e756094-7e86-4086-a4af-59124cd9e961
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: PATNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a6e93b2-c03e-4539-aefa-b495cdda9d72
                stepCounter: f76e0ff7-f671-4ed5-aa55-e0ba3c97c1c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd338d02-eac7-4d45-806a-1831b0f3775b
          stepCounter: 3e756094-7e86-4086-a4af-59124cd9e961
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: PRVSP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59d3088d-97f2-4c53-9ebc-ae021c7b49e2
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b8270b7-e4fd-4836-8b33-94dda623a185
          stepCounter: 3e756094-7e86-4086-a4af-59124cd9e961
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Set to 1 if the event has changed. Set to 0 if the event hasn't changed but another of the patient's events has changed.
        name: EVENT_CHANGED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a6e93b2-c03e-4539-aefa-b495cdda9d72
                stepCounter: f76e0ff7-f671-4ed5-aa55-e0ba3c97c1c9
            transform: IIF(changes2.prvsp_refno IS NULL, 0, 1)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75cbb90b-9c92-4225-966e-4730e84c7a47
          stepCounter: 3e756094-7e86-4086-a4af-59124cd9e961
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc28819c-55e3-49c8-b08c-b1de8ea0eb0d
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: IIF(changes2.prvsp_refno IS NULL, NULL, ds_pims_provider_spells.encounter_id)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 460d0e39-fc04-4c04-a64d-2e7edfbbf343
          stepCounter: 3e756094-7e86-4086-a4af-59124cd9e961
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: INMGT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76ce2d66-f620-4545-bd3f-71d1e5604f03
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: IIF(changes2.prvsp_refno IS NULL, NULL, ds_pims_provider_spells.inmgt_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0622c80-8b01-4995-92da-bff20153c491
          stepCounter: 3e756094-7e86-4086-a4af-59124cd9e961
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: ADMET_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b9fc1ad-a8cc-4c29-bd6b-b55c9007f7ce
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f94c459e-2205-401e-be0c-c4d032f87726
          stepCounter: 3e756094-7e86-4086-a4af-59124cd9e961
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMIT_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1125cf7f-7027-45ac-acc8-b3a92505c4da
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 60430c75-c9f0-465e-8837-a00ec8295a02
          stepCounter: 3e756094-7e86-4086-a4af-59124cd9e961
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCH_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee3a67e8-1a53-44ab-aa64-cafc588de09c
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e22db0a1-631c-404c-b2e7-e6374d9badde
          stepCounter: 3e756094-7e86-4086-a4af-59124cd9e961
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_SHARED_INPATIENT_CHANGES_10
        join:
          joinCondition: |-
            FROM s_shared_inpatient_changes_10
              JOIN ds_pims_provider_spells
                ON s_shared_inpatient_changes_10.patnt_refno = ds_pims_provider_spells.patnt_refno
              LEFT OUTER JOIN s_shared_inpatient_changes_10 changes2
                ON changes2.prvsp_refno = ds_pims_provider_spells.prvsp_refno
               AND changes2.prvsp_rownum = 1
             WHERE s_shared_inpatient_changes_10.patnt_rownum = 1
        name: S_SHARED_INPATIENT_CHANGES
        noLinkRefs: []
  name: S_SHARED_INPATIENT_CHANGES
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
