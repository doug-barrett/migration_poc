fileVersion: 1
id: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
name: S_OUTPATIENT_APPOINTMENT_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Outpatients are Schedules of \"schedule_type_code\"  \"OTPAT\"   (\"Outpatients Schedules\" )  "
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95cf969a-fa25-4fcc-9756-f37030fe6de2
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ACC_FUNDED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN ds_shared_schedule.admin_category_reference_no = 1000000046 THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad209f06-4a48-485c-8e50-47c207f73318
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMIN_CATEGORY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ae7dfbb-dc40-4f7c-9f5a-b788b88563e5
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da1200e3-21f4-43a5-87c4-e06918835681
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ANAESTHETIC_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b38b8829-adb7-43da-9d4a-5c2fbcc4acf6
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 224beca2-8103-4b0b-872a-96dbb7c26df5
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTED_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d776af83-fe76-4f76-bc5a-8372bdcf71e6
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: IFNULL(ds_shared_schedule.clinician_reference_no,ds_shared_schedule_parent.clinician_reference_no)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7f3cbbd-f894-4983-a303-6a599a002a42
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: APPOINTMENT_CALLED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a95ad01f-2f78-4d7d-a11d-9fdd9dbe6608
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b926c16-9e8c-47ca-9155-1014c3b75c63
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_CHANGE_REQUEST_BY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 57edebe8-64c9-46c4-8514-7c0dfa31160b
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a299d07d-107a-49b2-ac0d-3ab19daba02f
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: appointment_contact_status_code, "A=Actual", "P=Planned", "C=Cancelled"
        name: APPOINTMENT_CONTACT_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 14512279-1aca-455e-8d73-c7d3ed087cbe
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c48e144-6851-45f1-824d-fbf5c4eb7658
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c98eef5-d50b-493c-b886-1dc843ad1024
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0825651f-7720-462e-9078-04ec8fcc2bb1
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_DURATION_ARRIVED_TO_DEPARTED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3301a6bc-9ebe-4acf-a2ea-b048cbb68ba9
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d4e33f6-4655-459d-84f5-cc27f77b6358
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: APPOINTMENT_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d6cdf7cd-bfe6-460c-90a7-a303cd644d98
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92bc025a-c26f-490e-af79-a014f19747a0
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: APPOINTMENT_MOVEMENT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2dd073a1-5ae2-4c28-959a-d076139bfc39
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a43ece3-a700-4ba5-a3f5-d90306d2e695
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_MOVEMENT_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aac5fe14-13a0-4f9a-948c-70712410b7e1
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 65490aa3-67b4-4b8e-99b7-2ec0190023da
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_OUTCOME_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23e62f2f-5384-42ef-b2df-d4f19fd18444
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca9f7998-b87c-479b-8b13-b4134b518b31
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: APPOINTMENT_REQUEST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2afda9b-da93-4f59-a908-a56f368840c1
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb7b5c7a-e724-4b00-a53d-fd32298da37f
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: appointment_status_type_code, "A=Actual", "P=Planned", "C=Cancelled"
        name: APPOINTMENT_STATUS_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1261b0f6-260d-4565-8200-5bfb81c20f9b
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 93dd2c18-d46a-4898-b920-12c4b57be866
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: APPROXIMATE_SCHEDULE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 381aa668-4a68-45cd-8396-63d1ac65bbf4
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 19391b24-4f02-48e4-bfe9-9ab6aa29fe27
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: ATTENDANCE_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03363045-4135-4c69-b185-a6cc497b85d5
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4dfcec8d-12fe-4319-9ac4-b41e04cf917d
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ATTENDANCE_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2f35a93-7938-42ea-b619-705f4f811e79
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49ed887d-66ed-4512-867e-a8824067d291
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: BOOKING_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 722fe546-b8d7-4832-b3f8-a6120a2776af
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 76fdc772-d0a4-4cbe-8506-8221a1da1ec1
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CANCELLATION_BY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a767a04-ff6f-4b1a-91e7-318958d51c5d
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 364af149-774b-49c5-ac99-29d328b0a1ee
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: cancellation_Reason_Code
        name: CANCELLATION_REASON_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4db38472-9ad2-4e0c-952a-5ad5b6e44e66
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ae36fdd-b316-41bd-8a25-a49943f8e0c7
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CANCELLATION_REASON_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 326060df-62a4-4a5c-b2f1-9c654da29678
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03403329-d387-4b1d-a838-c5dbd85ab748
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CANCELLATION_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb218224-7237-49e1-b68f-6d3e505ca227
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6ca73a9-73cd-4fcc-8bb6-6c397aff078a
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CODING_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f7c0500-6ced-430f-89ad-304fc06a07cf
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8b6d346-0b08-465c-b250-e41ae07b40e2
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CONTACT_PURPOSE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 425b5d66-db64-48b8-811a-5a17c6da1437
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 85b4ef45-6757-44df-b251-10419caf23d6
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CONTACT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7aa817a5-552e-4bb4-867f-c33524288a9c
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 35c79218-3b1e-4483-87b3-ce2542c2848e
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 460a8c3e-4f2f-471a-8118-88b604924ac2
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ae9f965-c4c3-488c-879d-e97023644477
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18fbe20f-ee1e-4fa5-a405-14e78126e1ec
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6459487f-8d26-4370-821d-c1384e5818c9
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DID_NOT_ATTEND_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef40764f-4222-4788-9132-5a4c0bdeefe6
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e14fa85c-244d-444b-b5ab-51f16bf28d8f
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DSS_DATA_QUALITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ae11f3e-6c31-4631-9871-99d986cadc58
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: |-
              CASE WHEN IFNULL(ds_shared_schedule.service_point_session_reference_no,ds_shared_schedule_parent.service_point_session_reference_no) IS NULL THEN CASE WHEN ds_shared_schedule.dss_data_quality_code IS NULL THEN 'SESSN' ELSE ds_shared_schedule.dss_data_quality_code + ',SESSN' END
                          ELSE ds_shared_schedule.dss_data_quality_code
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d688d6d-b00c-4579-8b81-b689d1640a16
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6cc91efa-f88f-41d9-8f72-a663496ad59a
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 13e54acb-8f8e-4523-94cd-9427bf10d23b
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ED_ATTENDANCE_REFERENCE_NO_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e0dbec11-9030-4b2b-9366-79978d0e3c0c
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 674586f2-94ef-497f-b189-593bfcd56a13
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: 'The first appointment on a referral. Used for setting purhcase unit business rules. '
        name: FIRST_REFERRAL_APPOINTMENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ebc6080f-ee41-4e73-b42f-f10ca8cdea26
                stepCounter: 89c4702d-3f68-4007-a433-03e787a257ff
            transform: |-
              --  CASE WHEN  ROW_NUMBER() OVER (PARTITION BY ds_shared_schedule.referral_reference_no
              --                 ORDER BY ds_shared_schedule.start_date) = 1 THEN 'Y' ELSE 'N' END
              CASE WHEN s_outpatient_appointment_08.referral_appointment_seq_num = 1 THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d10d8efb-e751-4ff2-af15-e2057bba20da
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FOLLOWUP_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 028fa767-1626-41c3-9359-ad01f66edc12
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7acfb701-705c-46a5-82c0-ad3df96578f4
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FUNDING_ARRANGEMENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 265b30f4-137b-48bf-9e14-e113d76af250
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f81c010-a7d2-413f-a005-fa17b6dff5f5
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: IP_EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'H' + cast(ds_shared_schedule.prvsp_refno AS varchar(20))"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de48dc3b-6f67-48ae-a37e-7378afb017be
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: IP_WARD_STAY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ad1a6b74-f694-4070-8df5-99af8afee91d
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7573c7c-d4bd-4d2a-b692-4c9183a28ed6
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIFY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb42bb1b-c5b3-4090-8338-7431c15a65d3
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7df2d645-f729-4965-8bdd-ecb45a6991e8
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MODIFY_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 89117979-e8a8-4f95-a70b-be39e1d68a90
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ffb8540-8594-4ea0-a07c-9df90be368c3
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OLD_APPOINTMENT_OUTCOME_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ee0cb99-e6ba-412d-9820-21f9790f3118
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 61f004f1-5c66-4513-bb21-91ad9b36a159
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OPERATION_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f5da6a84-a3ed-4696-beb7-513328c57d4a
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c80e9823-9b77-407b-9b3d-7d1e717f6567
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: OUTPATIENT_APPOINTMENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 73522497-b3f9-4b96-9c59-36a707f27842
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: "'T'+CONVERT(varchar,ds_shared_schedule.schedule_reference_no)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff377334-b1b4-45e2-91ed-94002b3e6110
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: APPOINTMENT_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa414684-191a-4206-a8fe-3e901333e22a
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 634dc1eb-bcd3-416f-956e-b2367558e675
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8a3c4441-9e5a-40ce-9445-aaa469eb89f6
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 923c6e7a-ce35-4ee9-9906-fd9fd2c57787
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: appointment_theatre_status_code, "A=Actual", "P=Planned", "C=Cancelled"
        name: APPOINTMENT_THEATRE_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c20b30fc-fa85-4f66-8657-baa44ddfc4eb
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2e3ba2f-de6d-40c4-9153-31d74afaf5d9
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Health Specialty Code
        name: OUTPATIENT_HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5841cbd-487b-4a50-be8a-1f994aa73e7b
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: IFNULL(ds_shared_schedule.health_specialty_code,ds_shared_schedule_parent.health_specialty_code)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8649eff4-65ed-459e-9d27-8101aa9f0c52
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: SCHEDULE_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 232cb164-41b5-421f-8189-6db893efe5be
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed428f34-f8f4-4ee1-85d7-07e2800a8e5c
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: af77e829-d775-4e7c-8a87-0f1c2a055f0f
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42586f93-59d5-4151-9cf5-4ca7698db8e3
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: OVERBOOKED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 80fb1245-87ec-40ab-b9c5-e90390eb4871
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 604cf21a-c4e0-4069-a1de-ba9fbe00b245
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PARENT_SEEN_BY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f9291ad-1ff9-4bef-bd07-9a22b25008e7
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PARENT_APPOINTED_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ca69a25-9d37-4dfd-b6ae-4ed9d9f5b399
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84916099-8867-48ae-9395-3f5c498e0910
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: IFNULL(ds_shared_schedule.seen_by_clinician_reference_no,ds_shared_schedule_parent.seen_by_clinician_reference_no)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb2e5d2b-e950-45f5-9e66-7a2331652c66
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PATIENT_SEEN_BY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6bf30bc1-3c2f-4481-a861-63f9a78f11d4
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7955cb9a-c1c3-44bc-af26-9a43c843b7ae
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PARENT_OUTPATIENT_APPOINTMENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 82c43813-ab5d-4483-9fc4-7c8106848c82
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33ec140d-8ef2-4805-939f-bd6f6d116528
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OUTPATIENT_SESSION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 73f114e0-536a-40f1-94a8-14b175e3b926
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: IFNULL(ds_shared_schedule.service_point_session_reference_no,ds_shared_schedule_parent.service_point_session_reference_no)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f96b34a-3d64-4534-96c9-3fad12d81eeb
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PARENT_OUTPATIENT_SESSION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d21f1922-b6cb-4665-b985-5fe3ad863a62
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_APPOINTMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5cd246b5-e808-450f-b7b5-338594903afa
                stepCounter: 89c4702d-3f68-4007-a433-03e787a257ff
            transform: --COUNT(1) OVER (PARTITION BY ds_shared_schedule.service_point_session_reference_no)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ce93c72-d072-4cd2-a21f-7e480843b0b4
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_APPOINTMENT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c981e28-0e63-45dd-a4bc-781c9d1768a6
                stepCounter: 89c4702d-3f68-4007-a433-03e787a257ff
            transform: |-
              --ROW_NUMBER() OVER (PARTITION BY ds_shared_schedule.service_point_session_reference_no
              --ORDER BY ds_shared_schedule.start_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ace792d4-c56d-4bce-a237-760e416a0e7f
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_AGE_ON_ARRIVAL_YEARS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f201416-ac35-4870-a0c1-0836d1b9e5b7
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: FLOOR(DATEDIFF(dd,dim_patient.patient_date_of_birth, CASE WHEN IFNULL(dim_patient.patient_date_of_death,ds_shared_schedule.start_date) < ds_shared_schedule.start_date THEN IFNULL(dim_patient.patient_date_of_death,ds_shared_schedule.start_date) ELSE ds_shared_schedule.start_date END) / 365.25)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 52cde62f-bb34-4059-943b-cd89e05e1357
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OUTPATIENT_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: adc294a0-0082-4ea0-9887-74b91b85a68c
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: IFNULL(ds_shared_schedule.specialty_reference_no,ds_shared_schedule_parent.specialty_reference_no)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 466eafb3-4076-4d42-916d-47c6f7f6b1de
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_APPOINTMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e70af18-f8ec-4af2-a6d1-fe7c28ca5182
                stepCounter: 89c4702d-3f68-4007-a433-03e787a257ff
            transform: --COUNT(1) OVER (PARTITION BY ds_shared_schedule.patient_reference_no)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9363994b-c479-41c4-a789-0ffc635175a2
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PARENT_OUTPATIENT_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e4c5ea1-12cf-4982-b474-5c417cd979d8
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_APPOINTMENT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 04c2e79f-ba1a-4063-9648-66a950eba3d1
                stepCounter: 89c4702d-3f68-4007-a433-03e787a257ff
            transform: |-
              --ROW_NUMBER() OVER (PARTITION BY ds_shared_schedule.patient_reference_no
              --ORDER BY ds_shared_schedule.start_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 412e3380-9c89-49a5-94c8-2ab3b14dce21
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: APPOINTMENT_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cc35ef61-dc52-49a2-ad90-fd31dd905d53
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5dc8f95b-ce3b-4208-ae26-5475e033c636
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PATIENT_ARRIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 573ccf60-a373-4c03-8a3a-fbb207611e22
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e29a4692-5245-49cd-91ff-87612dbe7c18
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: TRANSPORT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 46406df3-8e8c-4ef3-8056-790cced4849b
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9bd68d2a-2c7f-443b-a370-10f250e43aef
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_CONFIRMATION_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 850c899d-6935-4365-be96-1073c25540aa
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 363a2116-bdd6-4f23-9e46-67e0c88786be
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: TREATMENT_DECISION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 255ea9ca-43b3-462d-babf-d73f12b33528
                stepCounter: a95cb6e7-b222-4a40-a8c3-434f8956c450
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cdc016fd-456f-4b30-86c4-5af7bd461af9
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: TREATMENT_DELAY_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e402ecd6-7068-4036-8258-d2b4271f507d
                stepCounter: a95cb6e7-b222-4a40-a8c3-434f8956c450
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6af94837-ffdc-4490-a91b-78b963aa9d43
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Patient_Date_Of_Birth
        name: PATIENT_DATE_OF_BIRTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f201416-ac35-4870-a0c1-0836d1b9e5b7
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba757834-6161-4217-933d-68a84d993e41
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: OLB_REQUESTED_DTTM
        name: OLB_REQUESTED_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f209bd89-5d13-4166-934a-90d8381bdd1c
                stepCounter: 43b94be5-8689-4ebd-a7a4-f04730fb326e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 37c1a453-291e-492c-9bb0-05daccdfb8d0
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Patient_Date_Of_Death
        name: PATIENT_DATE_OF_DEATH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b5c2ff38-a66e-4814-80ba-d041584351af
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c947a78f-6b66-4134-a808-011e07d41899
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: UNPLANNED_RETURN_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: acd6976e-cf5c-4e97-9df1-4592505bea79
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e775217d-96cf-4add-9d62-825a7df86579
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PATIENT_DEPARTED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa7b89e4-8770-4913-8506-3536b4ab16c0
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32ac48a6-35b2-4532-bc91-0ab8f28a555d
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: URGENCY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ccad3d1a-33eb-4325-afcd-fbdb4494d505
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9bf9be5e-cc5a-470a-b202-6dc146abbfcd
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: VISIT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d1d8cbf-b4ee-4f30-aca9-8af8827fd54c
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ee4b93d-e76b-49a0-9928-970a1f7472b4
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 985f0ba0-97cf-4152-a49b-7e86cb71409e
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4fbdddf2-1bb9-426d-9347-78afff65528c
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 45a963e3-5f77-48e7-9494-661302be3933
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a6b5beb-58fc-426f-b455-6c53d329dda6
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 217d64d0-ff42-40ce-9a5b-c131a56c0cc9
                stepCounter: a5230ba8-6681-4435-a758-af859a35676c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3142888f-0fdc-4b9a-8b5f-fa4920056c1f
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Sequence for appointment within waitlist ordered from most recent to oldest
        name: WAITLIST_SCHEDULE_REV_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab403b70-80b1-47e5-8ac9-03f3c3faa344
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 526238c6-c644-4f16-88f0-e0adfe524919
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Sequence for appointment within waitlist ordered from oldest to most recent
        name: WAITLIST_SCHEDULE_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 96ff1c9f-37f7-4005-8807-741c25144139
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82b8e412-1474-4f66-bf1c-de553bd769ad
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREVIOUS_APPOINTMENT_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8fb0daf0-ebd9-46ce-8188-f7c9c4683c17
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9c03773-b9cf-448d-9734-c0065b3a90e2
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OUTPATIENT_CLINIC_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fdd88f8a-1df2-42d2-aade-3a87e03830f4
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: IFNULL(ds_shared_schedule.ward_reference_no,ds_shared_schedule_parent.ward_reference_no)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f46b6d1-0294-44a8-ab6a-97305ff2621d
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PRIMARY_PROCEDURE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 541f13e1-e64d-491f-9ae6-9098f9f84095
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PARENT_OUTPATIENT_CLINIC_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06bdabfc-ae53-4e51-884b-217ab04a97cb
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: PRIMARY_PROCEDURE_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa7aa97d-c599-4935-af68-72a6abd25fbd
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRIMARY_PROCEDURE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 99fad353-43a5-47f2-815b-89cfd52769cd
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PRINCIPAL_DIAGNOSIS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE WHEN s_outpatient_diagnosis_procedure_d1.diagnosis_procedure_code IN ('','-1') THEN NULL
                          ELSE s_outpatient_diagnosis_procedure_d1.diagnosis_procedure_code
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b0ac545-d89b-4695-ba3d-63fe35c2f488
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OUTPATIENT_APPOINTMENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 73522497-b3f9-4b96-9c59-36a707f27842
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 76b8107b-904a-4fd4-8a12-e609fada2eaf
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRINCIPAL_DIAGNOSIS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4ef0ff3-5d22-4311-be37-197d43657f75
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: PRINCIPAL_DIAGNOSIS_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 499ed45e-72c3-4fbf-a9c7-95074612f52f
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRIORITY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79932197-1ef5-4d96-bc23-57b90a9ac863
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29d7fea9-c0d1-49b6-a016-baab882a8677
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: REASN_COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 69e65ab9-0728-46c4-ad6e-454fc2b6d30b
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac63d0ac-0708-4aa5-951d-e28d942274c4
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_APPOINTMENT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ebc6080f-ee41-4e73-b42f-f10ca8cdea26
                stepCounter: 89c4702d-3f68-4007-a433-03e787a257ff
            transform: |-
              --ROW_NUMBER() OVER (PARTITION BY ds_shared_schedule.referral_reference_no
              --ORDER BY ds_shared_schedule.start_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c9c0b32-8e44-41f3-ab7c-0d81809f5ac7
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc6da06a-6c36-41eb-9c24-39c0e4a6cd42
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c3f04f3-6f74-4395-917f-255635db9695
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b544a4f0-a08e-49bd-9a27-8ff4618bae60
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae2e53ed-2fda-4d06-b761-bfa6d826eb7b
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_SCHEDULE_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5545a1fc-7216-40ac-97d3-7e9c19443f13
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3417df9-5c24-4350-9905-e00956c9b7e3
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: SCHDL_COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8a0fbc8f-5e29-4167-818d-03d996c3c3b5
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7354236-9f2e-4235-950d-d71b4bc54977
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: number of time the appointment has been rescheduled
        name: SCHEDULE_MOVEMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dbb011c2-42e6-4a67-b57d-84c6f8767f7a
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54352d72-5b6e-4530-aaf6-e283918e5992
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SCHEDULE_MOVEMENT_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aac5fe14-13a0-4f9a-948c-70712410b7e1
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7dec07f-01e7-4416-b45c-ece78a8eabdf
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SECONDARY_DIAGNOSIS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8996fcd-c6bd-45f6-a899-0ae687c41791
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SECONDARY_DIAGNOSIS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e6f6eaa-5273-421a-b225-1bd260cf56b1
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: SECONDARY_DIAGNOSIS_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 93452370-3e92-4fb6-8a62-f2edcb5f6857
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SECONDARY_PROCEDURE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac2d3910-e7f8-4218-bdbc-924762b64b3c
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SECONDARY_PROCEDURE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 177055f5-27d1-4032-818e-40f1ed88a3d2
          stepCounter: ecb0ff31-ea29-42f7-a062-3ae9a37954cd
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: SECONDARY_PROCEDURE_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies: []
        join:
          joinCondition: |-
            FROM s_outpatient_appointment_05
              JOIN ds_shared_schedule
                ON ds_shared_schedule.patient_reference_no = s_outpatient_appointment_05.patient_reference_no -- and IFNULL(ds_shared_schedule.service_point_session_reference_no,0) = IFNULL(s_outpatient_appointment_05.service_point_session_reference_no,0)     INNER JOIN dim.dim_patient    ON ds_shared_schedule.patient_reference_no = dim.dim_patient.patient_reference_no      LEFT OUTER JOIN ds_shared_schedule ds_shared_schedule_parent     ON ds_shared_schedule.parent_schedule_reference_no IS NOT NULL     AND ds_shared_schedule.parent_schedule_reference_no = ds_shared_schedule_parent.schedule_reference_no       LEFT OUTER JOIN ds_outpatient_diagnosis_procedure s_outpatient_diagnosis_procedure_d1    ON ds_shared_schedule.schedule_reference_no = s_outpatient_diagnosis_procedure_d1.outpatient_reference_no    AND s_outpatient_diagnosis_procedure_d1.diagnosis_procedure_type_code = 'DIAGN'    AND s_outpatient_diagnosis_procedure_d1.medical_problem_level_no = 1 -- 'PRIME'      LEFT OUTER JOIN ds_outpatient_diagnosis_procedure s_outpatient_diagnosis_procedure_d2    ON ds_shared_schedule.schedule_reference_no = s_outpatient_diagnosis_procedure_d2.outpatient_reference_no    AND s_outpatient_diagnosis_procedure_d2.diagnosis_procedure_type_code = 'DIAGN'    AND s_outpatient_diagnosis_procedure_d2.medical_problem_level_no = 2 -- 'SECND'      LEFT OUTER JOIN ds_outpatient_diagnosis_procedure s_outpatient_diagnosis_procedure_p1    ON ds_shared_schedule.schedule_reference_no = s_outpatient_diagnosis_procedure_p1.outpatient_reference_no    AND s_outpatient_diagnosis_procedure_p1.diagnosis_procedure_type_code = 'PROCE'    AND s_outpatient_diagnosis_procedure_p1.medical_problem_level_no = 1 -- 'PRIME'      LEFT OUTER JOIN ds_outpatient_diagnosis_procedure s_outpatient_diagnosis_procedure_p2    ON ds_shared_schedule.schedule_reference_no = s_outpatient_diagnosis_procedure_p2.outpatient_reference_no    AND s_outpatient_diagnosis_procedure_p2.diagnosis_procedure_type_code = 'PROCE'    AND s_outpatient_diagnosis_procedure_p2.medical_problem_level_no = 2 -- 'SECND'      LEFT OUTER JOIN s_outpatient_ldd_data_value    ON ds_shared_schedule.schedule_reference_no = s_outpatient_ldd_data_value.schedule_reference_no      LEFT OUTER JOIN s_outpatient_appointment_08    ON ds_shared_schedule.schedule_reference_no = s_outpatient_appointment_08.schedule_reference_no    --5261169    --4915019    left join (select OLB_REQUESTED_DTTM,SORCE_REFNO from l_pims_OBOOKING_OLB_OFFER_STAGE olb                 WHERE   1=1                AND OLB.SORCE_CODE = 'SCHDL'              AND OLB.OLB_REQUESTED_FLAG = 'Y'               AND OLB.OLB_REQUESTED_DTTM IS NOT NULL               AND isnull (OLB.ARCHV_FLAG, 'N') = 'N'             AND OLB.NEW_SCHDL_REFNO IS NULL  )l_pims_OBOOKING_OLB_OFFER_STAGE    on ds_shared_schedule.schedule_reference_no = l_pims_OBOOKING_OLB_OFFER_STAGE.SORCE_REFNO   WHERE ds_shared_schedule.schedule_type_code = 'OTPAT' -- Outpatient
        name: S_OUTPATIENT_APPOINTMENT_10
        noLinkRefs: []
  name: S_OUTPATIENT_APPOINTMENT_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
