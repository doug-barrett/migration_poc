fileVersion: 1
id: 77908805-72eb-4c85-a359-689a7e8e3afe
name: S_WAITLIST_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 873b192b-86a0-4370-8061-5472660d9e1b
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: WAITLIST_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e19e745-6656-4e44-9e16-fd64e5ceeaf8
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 541b1bae-a9ac-4f16-bc1e-b823e64832bc
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: WAITLIST_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ce55418-735d-4257-9078-776e86450dc5
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c69fabd2-f9d8-49ea-93af-9e4eda621f22
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ec8272b-f72d-4ecf-aa7b-a61679fff722
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 89896bb3-200b-4b13-997a-8ce7afe5dae7
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITLIST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 14f37cc5-d767-4d8e-aacb-36d40ec21c67
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1af8cb29-7de1-4333-958a-cc859695caab
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITING_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ebdac18c-0122-4fa0-a15d-b88b72ec1d49
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: IFNULL(s_waitlist_09.waiting_start_date,GETDATE())
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bde1e7eb-4de5-4d63-82f5-84c6f361b0d4
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITING_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c7ed5db-cd52-4934-8600-628d67cf6caf
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: |-
              --IFNULL(s_waitlist_09.remvl_date,DATEADD(s,-1,DATEADD(mm,DATEDIFF(m,0,GETDATE())+1,0)))
               s_waitlist_09.remvl_date
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1496dce0-79a2-4901-96cf-2708fdfb072a
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Removal Date or Last Day of Current Month
        name: ESPI_COMPLIANCE_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c7ed5db-cd52-4934-8600-628d67cf6caf
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45814d7e-3d7a-44c9-8cc5-c95e72db55e6
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMISSION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 69fd4edc-f21b-4c04-a7ee-c7d3b798b48e
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 147fe194-4ce0-4123-a5b3-69e1b8e86368
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITLIST_ACKNOWLEDGEMENT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 32d085ae-349c-495f-8947-74aba5a46943
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 275b0357-d863-4566-ba6b-8a19fcbf7d0a
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITLIST_REMOVAL_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c7ed5db-cd52-4934-8600-628d67cf6caf
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bed6c6d7-c43a-4c2e-8280-577aab59a712
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REFERRAL_RECEIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ee6c211-3c0d-4072-ad72-b4bdd5514563
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b57c6de-0e7c-4f21-8151-347a4fea3609
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7779e65-bbcb-4c34-b75e-86f50fc42392
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96ad0c0e-5a7b-47e2-89a0-3a59cf5448c3
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRED_BY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f0acdd99-8549-494c-92b2-08e911d278df
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d31ee08-892d-4bf0-9a5c-9cba7fe00b8c
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRED_BY_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b77de1d9-035f-408c-8e02-00b819af21bc
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5810a0bc-c56a-4bfd-8986-cb21429c78eb
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRED_TO_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8884cef9-b2f9-48b2-94ca-870fca924b9e
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 89b40142-217a-4e84-ad51-3b06d4636e30
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRED_TO_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51724c6e-facb-47be-bc16-45c983fa9e5f
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e18599d-f751-4184-9908-6fe712a2cc20
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_RULE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 70827d30-0753-42c3-ba1b-72410220df11
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d0634a2d-d921-4719-a1f1-7c3fa7578091
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: WAITLIST_SPECIALTY_FACILITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d8b471d8-f3fc-48bc-a1fb-cc5ab122d7ba
                stepCounter: dadb2ec5-9218-4b98-83b9-011c7f4f1cb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 65bf5eea-e51f-4ae4-bfa8-d695c611e720
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: P1_BOOK_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a23534b6-f779-49a7-9ec4-066a8af8897a
                stepCounter: 8b5331a4-4c77-49a3-bec1-72b8ba71cae8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5dc2f9b6-8345-4b8d-a330-92e9b0c85d86
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: P2_BOOK_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f5da5022-b7fa-462e-b65d-99704a5261bd
                stepCounter: 8b5331a4-4c77-49a3-bec1-72b8ba71cae8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59317736-baba-471b-887b-51ba3deac896
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: P3_BOOK_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 691745e9-bb10-43fe-89e1-01c45e14a892
                stepCounter: 8b5331a4-4c77-49a3-bec1-72b8ba71cae8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aafeb4c0-d6f6-4991-bd5f-aa3c48a713c8
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_LOCAL_RULE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e398769-6b0a-4453-8c57-9c130352bf9a
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e82b8b0e-c31f-4356-839d-87a72600aa93
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: WAITLIST_LOCAL_SPECIALTY_FACILITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5402f1ba-06bd-4f4b-8cc2-fa645a2e13b0
                stepCounter: 8b5331a4-4c77-49a3-bec1-72b8ba71cae8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be7a6859-a7e5-439e-8ba6-b196c3e1eade
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b59cd48-f131-4fe2-8cd6-622d788fd9f5
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0df5cd3e-6802-4b16-b494-0c307882f412
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_HEALTHCARE_PROFESSIONAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d65a91b8-c05c-49cc-a11b-b84431101b76
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50b33d01-903c-4048-89af-a4744e35b96c
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ad5ab1f5-2557-4f35-b397-40e09f40bd06
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9f67f30-1ea0-4255-9ff5-a8b259a878bc
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_PREVIOUS_WAITLIST_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 490d5521-440f-40a9-98c5-e942e9677b45
                stepCounter: 4130bba1-aeb1-44fc-a666-3f6b57411418
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb914ace-b753-4712-96ba-262274c158a6
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PATIENT_PREVIOUS_WAITLIST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 712b8ed8-1940-42cf-b25e-3e8297ebb3d2
                stepCounter: 4130bba1-aeb1-44fc-a666-3f6b57411418
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9246e566-fb40-4446-a208-8df3ea89afc1
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_PREVIOUS_REFERRAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: edb185ec-4ce0-44f0-bcf6-37ee16d83786
                stepCounter: 4130bba1-aeb1-44fc-a666-3f6b57411418
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b452151e-8f23-4d16-9e70-0738c7dfe808
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_PREVIOUS_WAITLIST_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05bc1569-8ee7-453c-a3c5-6c26b12d2468
                stepCounter: 4130bba1-aeb1-44fc-a666-3f6b57411418
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4c05bb0-6d2e-4d29-abb9-7b541adc91d3
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_PREVIOUS_WAITLIST_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2ad8345-ece6-400d-99eb-5b64196cf235
                stepCounter: 4130bba1-aeb1-44fc-a666-3f6b57411418
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f78f9b80-3b5b-4f15-9382-e79319c77044
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_NEXT_WAITLIST_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23961abd-8304-414b-b05b-1c1999061160
                stepCounter: 4130bba1-aeb1-44fc-a666-3f6b57411418
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 420475cc-8ea6-4a6c-805f-2832f852d142
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PATIENT_NEXT_WAITLIST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7645a27b-a74a-4dc1-85f6-c5f44ad7564d
                stepCounter: 4130bba1-aeb1-44fc-a666-3f6b57411418
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c367a790-a0fc-4472-9376-7beb92b94ee9
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_NEXT_REFERRAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 58359467-8ab8-4354-82ef-d30a757326fb
                stepCounter: 4130bba1-aeb1-44fc-a666-3f6b57411418
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 166ba7d9-8e21-44d7-9137-8f9284b731b9
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_NEXT_WAITLIST_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f80c4d5-90ad-4bdd-838d-16113c296672
                stepCounter: 4130bba1-aeb1-44fc-a666-3f6b57411418
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd0c6d2b-3a7e-41d2-a01f-2ecc176dae71
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_NEXT_WAITLIST_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3dcf522b-7c15-4cf6-970b-aea1b7e5b495
                stepCounter: 4130bba1-aeb1-44fc-a666-3f6b57411418
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: acedcffb-7ecb-4b24-b5fd-fc70496bddbd
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREV_SUSPENSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e26f4c9e-126e-4929-8616-83e23607e3f4
                stepCounter: 4130bba1-aeb1-44fc-a666-3f6b57411418
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02132240-5c69-4452-8b36-0ebd182e18e0
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Clinical Priority Assessment Criteria reference_no
        name: CPAC_SCORING_CATEGORY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 92b2d0a3-74a4-47e4-b1be-e247032c210c
                stepCounter: 7eeb535e-2058-4cb0-951f-2a4671be90a0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 166eba81-ebfb-474a-beb7-a51a204aef46
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Clinical Priority Assessment Criteria Assessing Clinician
        name: CPAC_ASSESSING_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a44d0fd5-d8ef-4ea1-853c-5f902843572a
                stepCounter: 7eeb535e-2058-4cb0-951f-2a4671be90a0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 520f4bda-eb66-4f92-b2a8-79c4018e1fa3
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Clinical Priority Assessment Criteria assessment_date
        name: CPAC_ASSESSMENT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 114548c1-4544-45cd-a5e4-d20384a8c86e
                stepCounter: 7eeb535e-2058-4cb0-951f-2a4671be90a0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 56607510-2b34-4a8c-909d-19b64dec3aa8
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Clinical Priority Assessment Criteria Score
        name: CPAC_SCORE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c450b079-9e0c-44eb-b515-6f3a522ebc0d
                stepCounter: 7eeb535e-2058-4cb0-951f-2a4671be90a0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 392f31c6-063f-44e3-8c59-c1881c6f6044
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMISSION_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7be8f5f0-f541-43a4-8906-4a009ef40ebf
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3208699c-ff57-4840-ae5a-b01027aea96f
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMIN_CATEGORY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7453076b-f667-4487-b58f-45e57588d85d
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9d46f46-8483-4c26-922c-69e56660dd92
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMISSION_DECISION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a25b67c5-46e3-4dcc-9fca-9d373546a6bc
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6ad31ce-e2fe-4490-abde-d662c71270b8
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_MANAGEMENT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b19b6776-f2f9-4644-b3d2-441146247571
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 464f979c-d2a5-4821-96af-5ced23031b8c
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_PRIORITY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76d14593-24a7-4e1d-8f1b-6130909047e1
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e55de186-e560-4e4b-90f4-855e0d0bbae8
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: acbd4c85-189a-478d-844d-43ce66f957e6
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec869db8-8be3-4da7-b31a-a72c30044207
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_WARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b628aab-768b-4d67-9638-41c48ee3ea3c
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f8904e81-438b-4340-86f5-7abfa63e4b27
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_TRANFER_WARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 32a32b47-2e41-46c3-8f3e-c0ebbc6472d8
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b568d517-a6db-453e-9197-5be6ede740f8
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_CONSULTANT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dbd56f6b-385c-4c24-9e9a-df927d210de0
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4aae2a1c-43fa-4844-8454-4b672a72ae27
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_REMOVAL_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 262ed4ea-3201-4bb6-bc29-892a2be458d7
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad99da1f-fb3d-43da-8239-cbcd79a4ca31
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_COMPLETION_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b09fd92d-0131-4c80-9475-88a90025ff60
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9fcbf1f-9418-4299-b724-1fc6a0d47215
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ANAESTHETIC_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f57fc59-f763-4f56-ab32-3436cf6f3afe
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: deb507d3-215c-4822-9ea9-c7d8232fc56c
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_BOOKING_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 149e7871-5eeb-49cd-960f-b0e2cb0f8fbb
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 392a3ce5-0a03-4256-b4ed-9df91f7af28f
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITLIST_BOOKING_STATUS_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0aa005a4-5003-4426-9d1f-6d18761a1d77
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 147bde53-498b-40a2-bbc9-c71b5207fd68
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_PROCEDURE_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7605e36-9d68-441e-b624-468ee279d22d
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b14eb08-ac26-4f8d-aaf5-b99cc54fdec5
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_MODE_OF_DELIVERY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 517906bd-f312-43ad-8cc8-ed017fac4ed1
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9af70bc-6da3-4b53-8c39-68c99008335d
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: PLANNED_PROCEDURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f94a4d0a-986f-4dac-8202-81d122972e31
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8119a21-cc44-4db9-a8e8-4783a1558285
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CERTAINTY_GIVEN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e6077ca-bfb7-4c3b-a9b9-8960351d3e93
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32cd97c9-410f-4d0d-b29b-cc930e1d9247
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CARE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9fbb02e2-e840-47a3-9e1d-a40adac8073c
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 151fbae4-b594-417b-af1b-028982a03418
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FSA_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b1776c1-cee1-4653-be46-4dde57f3ccd6
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f55c0660-f5d0-431e-b4f5-c9e4b0b83971
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ADMISSION_READY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56718b84-4099-4f72-8bfc-0362aede9668
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66e6d3cf-c472-46ea-8305-22873e083f86
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: SHORT_NOTICE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f84510b5-055a-4779-a537-911a27c3de07
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a271a877-00ef-412d-91ac-bbe5be1f73b8
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: WAITLIST_SUSPENSION_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a5ff11ca-c8fd-46d3-b4f9-3345406d90db
                stepCounter: a4c83cc6-133c-4dfe-8a46-8928097c96e5
            transform: |-
              CASE WHEN s_waitlist_09.remvl_date IS NOT NULL THEN 'N'
                          ELSE IFNULL(s_waitlist_suspension_summary_v.suspended,'N')
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b792e81-6c0e-42e6-9ca6-4c346cd4e0eb
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ESPI_TYPE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e0e07d6a-9854-4d42-b3ea-637fbb1385c4
                stepCounter: 933afa12-2b57-4515-bf24-0dd38100df6b
            transform: IFNULL(s_waitlist_ESPI_map.espi_type,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a56bce1-5ca9-414d-a8bb-ef26522ae2e7
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DATA_QUALITY_ISSUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: abe9dd07-6dd5-496e-9041-11481b7d0191
                stepCounter: 933afa12-2b57-4515-bf24-0dd38100df6b
            transform: IFNULL(s_waitlist_ESPI_map.data_quality_issue,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a5ae8c6-6302-4875-bd71-ea53adf1723f
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: PROVISIONAL_ESPI_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d5efd256-e1c1-45c6-8b88-6bd9a5f0e5dd
                stepCounter: 933afa12-2b57-4515-bf24-0dd38100df6b
            transform: |-
              CASE WHEN s_waitlist_ESPI_map.mapped= 1 THEN 'N'
                          ELSE 'Y'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5042f4c4-e515-4fed-84a2-7e7860c0ab0b
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INT
        defaultValue: ""
        description: Suspension waitlists generate additional NPF Prioritisation and notifications
        name: NPF_SUSPENSION_EXCEPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 25e05034-3a54-44ba-992d-9ee3239a8b28
                stepCounter: 933afa12-2b57-4515-bf24-0dd38100df6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea56d0c3-ec91-42bc-9b31-3c6c3f95e84e
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACTIVE_INDICATOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64aebf48-10fb-4315-8dee-aebea9103726
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb531148-9b3b-46de-abe5-83532adf3b8d
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SURGICAL_THEATRE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24b9517e-3a9f-4e43-8242-5c190ad39756
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c4b9224-78dc-43da-8962-ff2b08939ae4
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_SUSPENSION_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c847703d-af57-4622-96ca-f2e09161bd5e
                stepCounter: a4c83cc6-133c-4dfe-8a46-8928097c96e5
            transform: IFNULL(total_waitlist_suspension_days,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 191a8924-dbd5-4454-a09b-fc5a27eb92ee
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: 'Days that the wailist has been suspended including any future suspension period '
        name: WAITLIST_SUSPENSION_DAYS_PLANNED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ccde3dee-ee04-4eba-89bd-7f1ba4514587
                stepCounter: a4c83cc6-133c-4dfe-8a46-8928097c96e5
            transform: IFNULL(total_waitlist_suspension_days_planned,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05c293b8-e646-46ff-baf0-669b27b19071
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_WAITING_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e19e745-6656-4e44-9e16-fd64e5ceeaf8
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3fbb7012-88cb-406f-b1fd-1f49e7b10091
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: HOSPITAL_LENGTH_OF_STAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e6e50a27-4cf9-493c-846a-8b92fcd55391
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 84ee99b1-d976-4d61-8bc0-c3be2974eb57
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Days waited at the end of the current month, if waitlist still open
        name: WAITLIST_WAITING_MONTHEND_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e19e745-6656-4e44-9e16-fd64e5ceeaf8
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: '0'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5113eb73-f576-41fe-bdd1-1aa7ad86bf30
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Sequence of the waitlist withing a referral
        name: PATIENT_REFERRAL_WAITLIST_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02bce8c8-80e4-4456-b941-204c9d3cc9b3
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 83ce3dab-0cfc-4014-bfb6-90921036c6db
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_WAITLIST_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ae0ac2ce-e578-452c-ac53-2e12e16c2f46
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb0b6743-e8b3-4da1-97bc-fb011e826be4
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Is this referral an National patient flow referral, Note this rule is currently the same as the ESPI1 rule over time it will evolve to include more data than ESPI 1.
        name: NPF_REFERRAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f93b099-8ec0-48ef-acb8-b3ef58e70dbf
                stepCounter: 32661289-2246-4a7c-a2ad-9907fdccd6ac
            transform: |-
              CASE WHEN NPF_presenting_referral = 'N' AND s_waitlist_09.create_date > '01-Oct-2015' --and getdate()
               -- and s_waitlist_05.patient_referral_waitlist_seq_num <> 1
               AND s_waitlist_ESPI_map.ESPI_type NOT IN (1,0) AND s_waitlist_ESPI_map.ESPI_type IN (2,5,6,7,8,9,11,13,12,14,15) THEN 'Y'
                          ELSE IFNULL(NPF_presenting_referral,'N')
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 46aab946-a4fb-4109-83fb-498843c96ef5
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Is this referral an National patient flow related referral.  Related referrals are any waitlists subsequent to the first waitlist on a referral.
        name: NPF_RELATED_REFERRAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f93b099-8ec0-48ef-acb8-b3ef58e70dbf
                stepCounter: 32661289-2246-4a7c-a2ad-9907fdccd6ac
            transform: |-
              CASE WHEN NPF_presenting_referral = 'Y' AND s_ESPI_type.waitlist_group = 'ESPI 2 (FSAs)' AND s_waitlist_09.create_date >= '01-Jul-2014' AND s_waitlist_09.patient_referral_waitlist_seq_num <> 1                                                                                         THEN 'Y'
                          WHEN NPF_presenting_referral = 'Y' AND s_waitlist_09.create_date BETWEEN '01-Oct-2015' AND getdate() AND s_waitlist_09.patient_referral_waitlist_seq_num <> 1 AND s_waitlist_ESPI_map.ESPI_type NOT IN (1,0,23)-- unclassifed or suspended
                                                      THEN 'Y'
                          WHEN NPF_presenting_referral = 'N' AND s_waitlist_09.create_date > '01-Oct-2015' --and getdate()
               --  and s_waitlist_05.patient_referral_waitlist_seq_num <> 1
               AND s_waitlist_ESPI_map.ESPI_type NOT IN (1,0) AND s_waitlist_ESPI_map.ESPI_type IN (2,5,6,7,8,9,11,13,12,14,15) THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c99c2922-825f-45b6-8ba8-0e09c92fb8f7
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INT
        defaultValue: ""
        description: Sequence to show reverse order of waitlist types within a referral.  Needed for NPF to identify the last FSA waitlist.
        name: NPF_SEQ_REV_ESPI_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f93b099-8ec0-48ef-acb8-b3ef58e70dbf
                stepCounter: 32661289-2246-4a7c-a2ad-9907fdccd6ac
            transform: ROW_NUMBER() OVER (PARTITION BY s_waitlist_09.refrl_refno, s_waitlist_ESPI_map.ESPI_type ORDER BY s_waitlist_09.waiting_start_date DESC, s_waitlist_09.wlist_refno DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80a2d0c1-5235-49ee-8a47-7865df65ded5
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: WAITLIST_APPOINTMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5a2091b-874e-41db-8b9c-8005979edc27
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b55e4453-d52e-422a-a68f-53aa9d7975a7
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: SERVICE_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 588f0244-ec58-41f8-8228-dcd25375841a
                stepCounter: 933afa12-2b57-4515-bf24-0dd38100df6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 89c49489-6347-4e49-b02b-dd0c3873e8e8
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: CHAR(4)
        defaultValue: ""
        description: ""
        name: SERVICE_SUB_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dcaf7a85-76c4-4d61-8fa9-4c5aebc5ecef
                stepCounter: 933afa12-2b57-4515-bf24-0dd38100df6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94958a58-2ffc-4989-a7d0-82ac68361f79
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ENCOUNTER_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b73fe3af-315c-4e4e-8b90-df68e87da33e
                stepCounter: 933afa12-2b57-4515-bf24-0dd38100df6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 891a05ef-aa7f-4638-b86b-826a652cc17d
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: WAITLIST_MAPPINGS_ROWID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd2cff5d-3bf8-440c-8cf4-ef22e75372d7
                stepCounter: 933afa12-2b57-4515-bf24-0dd38100df6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1bb4a64-f73a-45dc-a797-daa87380576a
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: WAITLIST_ADMISSION_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c037f1c-5393-4e56-b270-36c991734dc0
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7eba8dbf-7855-4b11-a471-56b64cee0ac9
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: WAITLIST_ATTENDED_APPOINTMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21b13830-e17c-455b-8d53-dcbd22f69997
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70bcd0f7-523e-43c9-8601-ade5641a7aa1
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: AUTHR_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9b347b94-7d1c-40ef-883a-eee03fd0c9c1
                stepCounter: 32661289-2246-4a7c-a2ad-9907fdccd6ac
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26f49f3e-ae46-4f36-a661-16f8e596f49f
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_WAITLIST_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1978d1d4-260c-450f-ba3d-b1e41016b78c
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31c49e8c-74d1-42af-92bf-72225f194ec9
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94ecc8e5-9974-4b22-b3cf-c6fc21f414df
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11c34ffb-994b-456f-a88b-6896698611d1
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48c3064d-86ec-4839-874a-37e7c57b4474
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ba6ac2e-ecdb-4509-b6a6-6e7c5938412d
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIFY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dcd59355-0de8-4ff5-86a6-6b8eb407a33f
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb73680a-75b8-47ce-a6ea-1d4526e392d2
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MODIFY_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b3a3b635-f6d4-4a8c-8d5e-87b7d6513168
                stepCounter: 0e59e3db-b31a-4a51-a1c6-783b4fb7ebb6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 109fb318-ef36-47c2-aca2-253cfc5f3784
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: Grouping of ESPI types into a group representing the measure
        name: WAITLIST_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 97418544-8b68-4184-9460-f94f1de63a29
                stepCounter: 0d8d1060-c7a7-4682-9491-5558dfc36fab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fdc91542-2052-4313-b834-0f6adff24d8c
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INT
        defaultValue: ""
        description: Time from clock start to desired waiting time end.  Period type indicates if this number indicates days or months
        name: PERIOD_TO_BOOK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9a670c6-7fd7-4154-a7e1-53a6967bfa45
                stepCounter: 0d8d1060-c7a7-4682-9491-5558dfc36fab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1cae6654-dac6-40fa-8221-4a03eb0a7ced
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Indicates if the period to book is in days or months
        name: PERIOD_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3c24c0e4-af28-4ae9-9d86-421b33f0ce52
                stepCounter: 0d8d1060-c7a7-4682-9491-5558dfc36fab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6879663f-3d94-4ad9-981f-01ab3026e78f
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Y/N flag does the due date get calculated at the end oy the month as in EPSI 2 and 5
        name: DUE_DATE_AT_END_OF_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0e483b82-01b3-4218-9f49-c8b53a7d5468
                stepCounter: 0d8d1060-c7a7-4682-9491-5558dfc36fab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4aeacdbc-6150-4c9c-a658-0e2733a488cd
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: INT
        defaultValue: ""
        description: A value is required here if the lead in time for booking is greater than the period of time to book
        name: ADVANCE_ALERT_FOR_BOOKING_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ca22526-b6f7-48f0-b87e-fdf98d411c86
                stepCounter: 0d8d1060-c7a7-4682-9491-5558dfc36fab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3f10297-bfbf-434d-811b-ff053d6fcbba
          stepCounter: 77908805-72eb-4c85-a359-689a7e8e3afe
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DS_SHARED_REFERRAL: 32661289-2246-4a7c-a2ad-9907fdccd6ac
          S_WAITLIST_SUSPENSION_SUMMARY_V: a4c83cc6-133c-4dfe-8a46-8928097c96e5
          S_ESPI_TYPE: 0d8d1060-c7a7-4682-9491-5558dfc36fab
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_WAITLIST_09
          - locationName: TGT
            nodeName: DS_SHARED_REFERRAL
          - locationName: TGT
            nodeName: S_WAITLIST_SUSPENSION_SUMMARY_V
          - locationName: TGT
            nodeName: S_ESPI_TYPE
        join:
          joinCondition: |-
            FROM s_waitlist_09
              LEFT OUTER JOIN s_shared_waitlist_prev_next
                ON s_waitlist_09.wlist_refno = s_shared_waitlist_prev_next.waitlist_reference_no
              LEFT OUTER JOIN s_NBRS_detail
                ON s_waitlist_09.wlist_refno = s_NBRS_detail.waitlist_reference_no
               AND waitlist_assessment_seq_num = 1
              LEFT OUTER JOIN dim.dim_list_name
                ON s_waitlist_09.local_wlrul_refno = dim_list_name.list_name_reference_no
               AND dim_list_name.dss_current_flag = 'Y'
              LEFT OUTER JOIN dim.dim_local_category
                ON s_waitlist_09.local_wlrul_refno = dim_local_category.local_category_reference_no
               AND dim_local_category.dss_current_flag = 'Y'
              LEFT OUTER JOIN s_waitlist_ESPI_map
                ON s_waitlist_09.adcat_refno = s_waitlist_ESPI_map.adcat_refno
               AND s_waitlist_09.proca_refno = CASE WHEN s_waitlist_ESPI_map.proca_refno = 1999999999 THEN s_waitlist_09.proca_refno
                        ELSE s_waitlist_ESPI_map.proca_refno
                         END
               AND s_waitlist_09.spect_refno = s_waitlist_ESPI_map.spect_refno
               AND IFNULL(s_waitlist_09.acprt_refno,1) = s_waitlist_ESPI_map.procedure_type
               AND s_waitlist_09.svtyp_refno = s_waitlist_ESPI_map.svtyp_refno
               AND s_waitlist_09.prity_refno = s_waitlist_ESPI_map.prity_refno
               AND s_waitlist_09.local_wlrul_refno = s_waitlist_ESPI_map.local_category_refno -- removed CBS 13-10-2023 AND s_waitlist_09.waiting_start_date between   AND IFNULL(s_waitlist_09.remvl_date,getdate()) between s_waitlist_ESPI_map.start_date and IFNULL(s_waitlist_ESPI_map.end_date,'01-Jul-2040')    LEFT OUTER JOIN {{ ref('TGT','DS_SHARED_REFERRAL') }}  ON ds_shared_referral.refrl_refno = s_waitlist_09.refrl_refno    LEFT OUTER JOIN {{ ref('TGT','S_WAITLIST_SUSPENSION_SUMMARY_V') }}  ON s_waitlist_09.wlist_refno = s_waitlist_suspension_summary_v.waitlist_reference_no    LEFT OUTER JOIN {{ ref('TGT','S_ESPI_TYPE') }}  ON s_waitlist_ESPI_map.ESPI_type = s_ESPI_type.ESPI_type_no    Where s_waitlist_09.dss_update_time > @v_pa_main_incremental
        name: S_WAITLIST_10
        noLinkRefs: []
  name: S_WAITLIST_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
