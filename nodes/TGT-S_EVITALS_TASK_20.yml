fileVersion: 1
id: 3499df46-16c7-4a29-be4e-937c5282b5f6
name: S_EVITALS_TASK_20
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Dimension key look up."
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 10ded32f-47f7-49c2-8f7b-25cc8163b436
          stepCounter: 3499df46-16c7-4a29-be4e-937c5282b5f6
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: ""
        name: TASK_DEFINITION_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 45237cdc-5e6a-41a9-88cf-a319ac512e2c
                stepCounter: dbf723f8-7da4-4b3b-951d-d8678527a4e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 831b9a98-7581-46ba-97f9-056ff35b86b1
          stepCounter: 3499df46-16c7-4a29-be4e-937c5282b5f6
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: ""
        name: TASK_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a0aa8f2c-a3a1-490a-82dd-336f1c301511
                stepCounter: dbf723f8-7da4-4b3b-951d-d8678527a4e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24fe6b14-f235-45b2-bfac-2fd606568f09
          stepCounter: 3499df46-16c7-4a29-be4e-937c5282b5f6
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: OBSERVATION_SET_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84831c0d-4807-48c8-8f01-c9a146b2a5f9
                stepCounter: dbf723f8-7da4-4b3b-951d-d8678527a4e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a807012-3b6a-441e-8661-df35f667d6be
          stepCounter: 3499df46-16c7-4a29-be4e-937c5282b5f6
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CURRENT_OBSERVATION_SET_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e015294c-af63-4558-87b4-953d25f3fdab
                stepCounter: dbf723f8-7da4-4b3b-951d-d8678527a4e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a559ec5e-8275-4654-86e3-4ec28b616b30
          stepCounter: 3499df46-16c7-4a29-be4e-937c5282b5f6
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e341e773-4a38-4474-ae5f-f3c9c63f2f78
                stepCounter: dbf723f8-7da4-4b3b-951d-d8678527a4e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1de1dc9d-2522-49e2-ad8e-eb89fead7fdf
          stepCounter: 3499df46-16c7-4a29-be4e-937c5282b5f6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f408d13b-7207-4741-8bee-8ff5a4ce4754
                stepCounter: dbf723f8-7da4-4b3b-951d-d8678527a4e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e506f997-2b88-42ba-be34-6284c21d0998
          stepCounter: 3499df46-16c7-4a29-be4e-937c5282b5f6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: TASK_DUE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a514ea1-0979-4be8-8628-3a55ddf1809a
                stepCounter: dbf723f8-7da4-4b3b-951d-d8678527a4e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9f1de82-b2a0-41f6-b246-caf6881e7ba6
          stepCounter: 3499df46-16c7-4a29-be4e-937c5282b5f6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: TASK_CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dee577fc-16e3-4fe2-94ca-e80ac8504c85
                stepCounter: dbf723f8-7da4-4b3b-951d-d8678527a4e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3d1a3c4-4564-4609-b18f-41a022a42c20
          stepCounter: 3499df46-16c7-4a29-be4e-937c5282b5f6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: TASK_COMPLETED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 92fcaf91-4979-496d-8c05-d781e1427c44
                stepCounter: dbf723f8-7da4-4b3b-951d-d8678527a4e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d4873ed-bc31-4884-a81c-50d89e9fa435
          stepCounter: 3499df46-16c7-4a29-be4e-937c5282b5f6
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: ""
        name: SOURCE_ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e3b85fd-2d8e-4051-8437-d3f50e74f4ef
                stepCounter: dbf723f8-7da4-4b3b-951d-d8678527a4e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5be23c4d-4708-4018-9cdd-01f6aeecb01d
          stepCounter: 3499df46-16c7-4a29-be4e-937c5282b5f6
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: SOURCE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aff153bb-493c-41cd-ba5a-c5b98c2eb89d
                stepCounter: dbf723f8-7da4-4b3b-951d-d8678527a4e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae9786e7-d43f-4ee8-89f6-4e9e0ae99029
          stepCounter: 3499df46-16c7-4a29-be4e-937c5282b5f6
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: Integer ID that uniquely identifies the instance of the form holding the task.
        name: FORM_INSTANCE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60eda427-5515-4c04-948c-8148929c004b
                stepCounter: dbf723f8-7da4-4b3b-951d-d8678527a4e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 932b7fa5-7ee5-40fc-80ac-a17d23bdf65c
          stepCounter: 3499df46-16c7-4a29-be4e-937c5282b5f6
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: ""
        name: FORM_DEFINITION_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 88e26939-52a9-47e9-a43e-6739b9908b88
                stepCounter: dbf723f8-7da4-4b3b-951d-d8678527a4e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04903f6a-f016-4c17-904f-b925084fae7d
          stepCounter: 3499df46-16c7-4a29-be4e-937c5282b5f6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FORM_DEFINITION_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dd43f38f-1681-4a7a-8808-f8dfe52312ff
                stepCounter: dbf723f8-7da4-4b3b-951d-d8678527a4e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f3c7abc-3807-4370-95c4-af866d40851f
          stepCounter: 3499df46-16c7-4a29-be4e-937c5282b5f6
        config: {}
        dataType: VARCHAR(22)
        defaultValue: ""
        description: ""
        name: TASK_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b7ae48e-4bdc-434b-9bd8-669a74fdf98b
                stepCounter: dbf723f8-7da4-4b3b-951d-d8678527a4e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de7c1876-94ab-474f-92f3-9aa21b414cd1
          stepCounter: 3499df46-16c7-4a29-be4e-937c5282b5f6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: TASK_MODIFIED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c9edf8b5-ad01-4441-8ba4-39a54b70dea0
                stepCounter: dbf723f8-7da4-4b3b-951d-d8678527a4e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ead58696-5e69-47d1-9b4a-175393388f21
          stepCounter: 3499df46-16c7-4a29-be4e-937c5282b5f6
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TASK_STATE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 01290f3c-3a05-4944-8777-3b1532791b46
                stepCounter: dbf723f8-7da4-4b3b-951d-d8678527a4e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cbd610d1-169c-4903-bb2b-20c3b9348e9d
          stepCounter: 3499df46-16c7-4a29-be4e-937c5282b5f6
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PRIORITY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f98ff13-0a09-4b1a-92e1-65f4180af5be
                stepCounter: dbf723f8-7da4-4b3b-951d-d8678527a4e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 35225bb0-8aef-4f35-891f-6ecbc5e64af4
          stepCounter: 3499df46-16c7-4a29-be4e-937c5282b5f6
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SENIORITY_LEVEL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50db86c3-f173-4614-b1dd-b15678fecdb0
                stepCounter: dbf723f8-7da4-4b3b-951d-d8678527a4e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa9717dc-211b-4543-926e-393e13915167
          stepCounter: 3499df46-16c7-4a29-be4e-937c5282b5f6
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ACTIVITY_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 26333dd8-4dd1-4154-b5d7-1481259aa865
                stepCounter: dbf723f8-7da4-4b3b-951d-d8678527a4e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 652c645d-65a8-456d-961b-ee7789d5239d
          stepCounter: 3499df46-16c7-4a29-be4e-937c5282b5f6
        config: {}
        dataType: BIT
        defaultValue: ""
        description: ""
        name: TASK_DELETED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79fa9a87-5c19-4500-811f-d8e3422ba1a2
                stepCounter: dbf723f8-7da4-4b3b-951d-d8678527a4e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cdd9c8b4-a405-47eb-947b-c2476c5a43d6
          stepCounter: 3499df46-16c7-4a29-be4e-937c5282b5f6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9962a01b-5f3d-4c1a-b371-997edef38d0f
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: IFNULL(dim_patient.dim_patient_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1319dda4-4daf-4364-8dad-0f21bdcd7f96
          stepCounter: 3499df46-16c7-4a29-be4e-937c5282b5f6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_eVitals_task_20.priority_reference_no=dim_eVitals_task_priority.reference_value_id
        name: DIM_EVITALS_TASK_PRIORITY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5405845e-f118-42f7-8fab-7b3f4cc9eb58
                stepCounter: 6b0f772a-f667-407a-8cc8-6d8a81f111f9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 61c02c48-8c64-4147-b2f8-05e9294d5fe3
          stepCounter: 3499df46-16c7-4a29-be4e-937c5282b5f6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_eVitals_task_20.task_state_reference_no=dim_eVitals_task_state.reference_value_id
        name: DIM_EVITALS_TASK_STATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 812a9bff-746d-461e-a21f-d407cabf6bcb
                stepCounter: 3c125184-e001-4a25-bcf6-12661a7327e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e92a28d-5bdc-400c-833a-293aeffc791a
          stepCounter: 3499df46-16c7-4a29-be4e-937c5282b5f6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_eVitals_task_20.task_code=dim_eVitals_task_definition.task_code
        name: DIM_EVITALS_TASK_DEFINITION_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ee30e24-23bc-445b-9d15-da329314bfa0
                stepCounter: 10ac0fb5-1767-4519-9614-c16b2e0f971f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7f735f4-54dd-41bd-8f8c-350b9cce15f1
          stepCounter: 3499df46-16c7-4a29-be4e-937c5282b5f6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_eVitals_task_20.form_definition_id=dim_eVitals_form.form_definition_id
        name: DIM_EVITALS_FORM_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 87547d20-aed0-478f-941b-314359cdb75e
                stepCounter: e80c53d8-6caa-491d-be7a-428dc8e68f53
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a2d4e28-310e-4a9a-aa63-ddd96fb31164
          stepCounter: 3499df46-16c7-4a29-be4e-937c5282b5f6
        config: {}
        dataType: INT
        defaultValue: ""
        description: Generated artificial key
        name: DIM_EVITALS_TASK_DUE_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 35b4e381-9741-4fc6-aec4-2b29d91ab017
                stepCounter: 5e3fb2a8-0132-423f-8bac-48d5a76cc15e
            transform: IFNULL(dim_eVitals_task_due_date.dim_eVitals_task_due_date_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6051cbc7-0d59-471a-bd4d-49f99a90effb
          stepCounter: 3499df46-16c7-4a29-be4e-937c5282b5f6
        config: {}
        dataType: INT
        defaultValue: ""
        description: Generated artificial key
        name: DIM_EVITALS_TASK_COMPLETION_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8a19031c-e007-4e7b-b977-b5f936a6ff01
                stepCounter: 12e70673-8feb-4b6f-ba56-1f5e5fcc8e19
            transform: IFNULL(dim_eVitals_task_completion_date.dim_eVitals_task_completion_date_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 217075ba-db05-468f-b932-4e0f34a59c1a
          stepCounter: 3499df46-16c7-4a29-be4e-937c5282b5f6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_EVITALS_TASK_10: dbf723f8-7da4-4b3b-951d-d8678527a4e8
          DIM_PATIENT: d52dd438-7899-4242-9e38-539d2a1447df
          DIM_EVITALS_TASK_DUE_DATE: 5e3fb2a8-0132-423f-8bac-48d5a76cc15e
          DIM_EVITALS_TASK_COMPLETION_DATE: 12e70673-8feb-4b6f-ba56-1f5e5fcc8e19
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_EVITALS_TASK_10
          - locationName: TGT
            nodeName: DIM_PATIENT
          - locationName: TGT
            nodeName: DIM_EVITALS_TASK_DUE_DATE
          - locationName: TGT
            nodeName: DIM_EVITALS_TASK_COMPLETION_DATE
        join:
          joinCondition: |-
            FROM {{ ref('TGT','S_EVITALS_TASK_10') }}
              LEFT OUTER JOIN {{ ref('TGT','DIM_PATIENT') }}
                ON s_eVitals_task_10.patient_NHI = dim_patient.patient_NHI
               AND dim_patient.NHI_sequence = 1
              LEFT JOIN {{ ref('TGT','DIM_EVITALS_TASK_DUE_DATE') }}
                ON cast(s_eVitals_task_10.task_due_date AS date) = dim_eVitals_task_due_date.calendar_date
              LEFT JOIN {{ ref('TGT','DIM_EVITALS_TASK_COMPLETION_DATE') }}
                ON cast(s_eVitals_task_10.task_completed_date AS date) = dim_eVitals_task_completion_date.calendar_date
        name: S_EVITALS_TASK_20
        noLinkRefs: []
  name: S_EVITALS_TASK_20
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
