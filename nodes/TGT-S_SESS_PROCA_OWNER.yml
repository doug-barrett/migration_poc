fileVersion: 1
id: 291fe56f-033b-4e3d-8fab-b966d1913743
name: S_SESS_PROCA_OWNER
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f6621e9-2e6f-4e46-b856-a148da5f5e4b
          stepCounter: 291fe56f-033b-4e3d-8fab-b966d1913743
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: RNPRIM
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: row_number() over(PARTITION BY ds_pims_prof_carer_map.spssn_refno,ds_pims_staff_teams.code ORDER BY ds_pims_prof_carer_map.start_dttm DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe81ca09-0074-4925-8d9d-ebcf7406f075
          stepCounter: 291fe56f-033b-4e3d-8fab-b966d1913743
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: SPSSN_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dbcfa55c-5fab-442b-b496-ea9084670e30
                stepCounter: 3f7e4431-5c07-47a3-b850-49b3af652a4b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c90dc5b8-1a24-4025-91a3-b57610bba09e
          stepCounter: 291fe56f-033b-4e3d-8fab-b966d1913743
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 455d7269-34d2-440e-b123-0e7ff8fe8978
                stepCounter: 3f7e4431-5c07-47a3-b850-49b3af652a4b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5178e84-623e-4225-8fa1-db2e49d77344
          stepCounter: 291fe56f-033b-4e3d-8fab-b966d1913743
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24376428-5a3b-4af4-a1bb-b4296f57b95b
                stepCounter: 64dbb92c-5b21-4d0f-9709-89050a8e1d72
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 913632db-c3d5-42b0-8c8f-a6640d738df0
          stepCounter: 291fe56f-033b-4e3d-8fab-b966d1913743
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DS_PIMS_PROF_CARER_MAP: 3f7e4431-5c07-47a3-b850-49b3af652a4b
          DS_PIMS_STAFF_TEAMS: 64dbb92c-5b21-4d0f-9709-89050a8e1d72
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_PIMS_PROF_CARER_MAP
          - locationName: TGT
            nodeName: DS_PIMS_STAFF_TEAMS
        join:
          joinCondition: |-
            FROM {{ ref('TGT','DS_PIMS_PROF_CARER_MAP') }}
              JOIN {{ ref('TGT','DS_PIMS_STAFF_TEAMS') }}
                ON ds_pims_prof_carer_map.steam_refno = ds_pims_staff_teams.steam_refno
             WHERE 1 = 1
               AND ds_pims_prof_carer_map.spssn_refno IS NOT NULL
               AND ds_pims_prof_carer_map.archv_flag = 'N'
               AND ds_pims_staff_teams.sttyp_refno = 203733
        name: S_SESS_PROCA_OWNER
        noLinkRefs: []
  name: S_SESS_PROCA_OWNER
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
