fileVersion: 1
id: 9e3233f8-a56e-4302-820d-7a31b2b9dd21
name: S_COMMUNITY_DATA_TYPE
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Information about the data types (i.e. fields) found on each SWE form. Source table for dim_community_data_type."
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d081887f-b22e-462b-958d-ddb2cbd3a95a
          stepCounter: 9e3233f8-a56e-4302-820d-7a31b2b9dd21
        config: {}
        dataType: NUMERIC(18)
        defaultValue: ""
        description: ""
        name: DATA_TYPE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: df26d7c0-b3f5-414c-8e8b-82ace707befe
                stepCounter: a0551e43-8b4a-47d3-98bb-4901d2751478
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 965478dd-7ffc-4fcd-962b-3e7a731e534c
          stepCounter: 9e3233f8-a56e-4302-820d-7a31b2b9dd21
        config: {}
        dataType: NUMERIC(18)
        defaultValue: ""
        description: Will be populated if data_type_id is from a child form.
        name: PARENT_DATA_TYPE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f0d388f7-0ac2-4862-bbfa-809be5b11c7e
                stepCounter: 4517bf5e-2d08-4cf9-bc8e-2a656128a72c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b6d8f5f-c8cb-4580-a6ec-346d9605313c
          stepCounter: 9e3233f8-a56e-4302-820d-7a31b2b9dd21
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Set to Y if the data type is on a child form.
        name: CHILD_DATA_TYPE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f0d388f7-0ac2-4862-bbfa-809be5b11c7e
                stepCounter: 4517bf5e-2d08-4cf9-bc8e-2a656128a72c
            transform: |-
              CASE WHEN l_cdsswe_table_child_data.parent_id IS NULL THEN 'N'
                          ELSE 'Y'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95f2e2e8-9486-429f-bf2a-a2a2b72ce9c7
          stepCounter: 9e3233f8-a56e-4302-820d-7a31b2b9dd21
        config: {}
        dataType: VARCHAR(200)
        defaultValue: ""
        description: ""
        name: DATA_TYPE_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab9fa8a6-e633-4b71-8023-6f611063389f
                stepCounter: dab02aa8-85dd-4a28-9b0b-c79c6ada8efa
            transform: COALESCE(l_cdsswe_datatype.name, l_cdsswe_Table_Child_Data.name)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32c0ca50-1381-4a0e-995a-5bc1d7b83c6e
          stepCounter: 9e3233f8-a56e-4302-820d-7a31b2b9dd21
        config: {}
        dataType: VARCHAR(5000)
        defaultValue: ""
        description: ""
        name: DATA_TYPE_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 57146dac-f54e-4f80-941a-9a7b0fb2500a
                stepCounter: dab02aa8-85dd-4a28-9b0b-c79c6ada8efa
            transform: COALESCE(l_cdsswe_datatype.description, l_cdsswe_Table_Child_Data.description)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98698549-27f0-4305-ba7b-2ec258fdf1b5
          stepCounter: 9e3233f8-a56e-4302-820d-7a31b2b9dd21
        config: {}
        dataType: VARCHAR(200)
        defaultValue: ""
        description: ""
        name: DATA_TYPE_DISPLAY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21f77a31-5433-424c-8e37-d942dad95936
                stepCounter: dab02aa8-85dd-4a28-9b0b-c79c6ada8efa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9172182d-d413-4fb5-a755-4b2f0607c88d
          stepCounter: 9e3233f8-a56e-4302-820d-7a31b2b9dd21
        config: {}
        dataType: NUMERIC(18)
        defaultValue: ""
        description: ""
        name: FORM_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d86a406-c5bd-4e5d-ba13-c5c476af635a
                stepCounter: 6928f64b-d328-4dbf-95ce-ef9257b344c5
            transform: COALESCE(l_cdsswe_FormDataType.form_id, fdt2.form_id)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b65165fc-9616-4745-a7a6-a7313000925b
          stepCounter: 9e3233f8-a56e-4302-820d-7a31b2b9dd21
        config: {}
        dataType: VARCHAR(200)
        defaultValue: ""
        description: ""
        name: FORM_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: efa0fd1e-b7dd-49ee-a3b5-ca2cdf096cab
                stepCounter: 386fb5c2-4fa8-4e07-85e4-2490ff707b77
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d8a2db2-732b-4f81-9326-db02742efe15
          stepCounter: 9e3233f8-a56e-4302-820d-7a31b2b9dd21
        config: {}
        dataType: VARCHAR(200)
        defaultValue: ""
        description: ""
        name: FORM_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7dd2536e-1a2b-424c-8e83-efe5aed609db
                stepCounter: 386fb5c2-4fa8-4e07-85e4-2490ff707b77
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a936a74-f917-4b61-ab4b-238b4a8c11d0
          stepCounter: 9e3233f8-a56e-4302-820d-7a31b2b9dd21
        config: {}
        dataType: VARCHAR(400)
        defaultValue: ""
        description: ""
        name: FORM_DISPLAY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5abd8138-6c75-4679-9307-08f56da669b0
                stepCounter: 386fb5c2-4fa8-4e07-85e4-2490ff707b77
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 758f3b27-40d3-46ef-9419-f79a2b1dedda
          stepCounter: 9e3233f8-a56e-4302-820d-7a31b2b9dd21
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: L_MAPPINGS_CDSSWE_DATAITEMS
        join:
          joinCondition: |-
            FROM l_mappings_CDSSWE_DataItems
              LEFT OUTER JOIN l_cdsswe_datatype
                ON l_mappings_CDSSWE_DataItems.datatype_id = l_cdsswe_datatype.datatype_id
              LEFT OUTER JOIN l_cdsswe_FormDataType
                ON l_cdsswe_datatype.datatype_id = l_cdsswe_FormDataType.data_type_id
              LEFT OUTER JOIN l_cdsswe_Table_Child_Data
                ON l_mappings_CDSSWE_DataItems.datatype_id = l_cdsswe_Table_Child_Data.table_child_data_id
              LEFT OUTER JOIN l_cdsswe_datatype dt2
                ON l_cdsswe_Table_Child_Data.parent_id = dt2.datatype_id
              LEFT OUTER JOIN l_cdsswe_FormDataType fdt2
                ON dt2.datatype_id = fdt2.data_type_id
              LEFT OUTER JOIN l_cdsswe_form
                ON l_cdsswe_form.form_id = COALESCE(l_cdsswe_FormDataType.form_id, fdt2.form_id)
        name: S_COMMUNITY_DATA_TYPE
        noLinkRefs: []
  name: S_COMMUNITY_DATA_TYPE
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
