fileVersion: 1
id: 0b146547-5e0e-4fd4-9968-56c2470f05e2
name: STAGE_RES_MANUAL_PRICING
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "Manual pricing transformed from VET_REF source and representing all ACCT_PER_DATE values between effective and expiry dates in source."
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f19a6eab-efc8-4ec1-bd26-f4bd95b4a611
          stepCounter: 0b146547-5e0e-4fd4-9968-56c2470f05e2
        config: {}
        dataType: VARCHAR(259)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ffcf930-c778-4a40-a8ec-0de99afb7881
                stepCounter: 5d104afa-878f-4f1f-b149-f46ca97ba7a5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad5ecd2f-2958-4d29-9957-3863b9cc3cdc
          stepCounter: 0b146547-5e0e-4fd4-9968-56c2470f05e2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGE_RES_MANUAL_PRICING.CALENDAR_DATE=DIM_DATE.CALENDAR_DATE
        isBusinessKey: true
        name: DIM_ACCT_PER_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f10c496e-43e4-4922-b52a-6ad1c4ad8e74
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: NVL(DIM_DATE.DIM_DATE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c88769e6-aa45-410b-a446-62ab5861b3b8
          stepCounter: 0b146547-5e0e-4fd4-9968-56c2470f05e2
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        isBusinessKey: true
        name: DIM_UOM_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9b3e3e2e-3218-4408-aa97-e792c8153299
                stepCounter: f0e180d9-ef3f-4224-9cf5-3357b905ad07
            transform: NVL(DIM_RES_UOM.DIM_UOM_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 563c80dd-b441-45a2-935d-f9e968688447
          stepCounter: 0b146547-5e0e-4fd4-9968-56c2470f05e2
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: PRODUCT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 479b9cab-cad6-434f-8513-bb6fbb6f1fa3
                stepCounter: 5d104afa-878f-4f1f-b149-f46ca97ba7a5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8e77d99-72c8-4158-9abd-231abe244175
          stepCounter: 0b146547-5e0e-4fd4-9968-56c2470f05e2
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: STREAM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 96374955-7c3b-4e37-a314-89f191d38bf1
                stepCounter: 5d104afa-878f-4f1f-b149-f46ca97ba7a5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 44af7948-63e5-4145-af87-ac3180bf73ac
          stepCounter: 0b146547-5e0e-4fd4-9968-56c2470f05e2
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: EFFECTIVE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83005751-87ff-4b8e-9f2e-4b791c5f48d3
                stepCounter: 5d104afa-878f-4f1f-b149-f46ca97ba7a5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ede9fc7f-92b6-4ab9-a6ae-c4bbc408262a
          stepCounter: 0b146547-5e0e-4fd4-9968-56c2470f05e2
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Accounting Period Date
        name: ACCT_PER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22fc0aa6-a875-4164-ab11-fd35b6a269ec
                stepCounter: 514e5b21-eab9-4985-9a00-e22a0e84a361
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f221fd3-8520-4d0a-abf2-446521ff0c76
          stepCounter: 0b146547-5e0e-4fd4-9968-56c2470f05e2
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: EXPIRY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4af1ccb4-84c4-4878-b013-82881db1eac2
                stepCounter: 5d104afa-878f-4f1f-b149-f46ca97ba7a5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a743f900-575d-48a0-ab42-2b7718d07630
          stepCounter: 0b146547-5e0e-4fd4-9968-56c2470f05e2
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Currency Code. One of VET_RES_UOM.UOM_CODE
        name: CURRENCY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d6e86808-b3a7-42a8-9e43-83bd1da4d0a4
                stepCounter: 5d104afa-878f-4f1f-b149-f46ca97ba7a5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53bd1bfc-0732-4656-b51f-1151f11a8744
          stepCounter: 0b146547-5e0e-4fd4-9968-56c2470f05e2
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: UOM_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db586e31-8835-4e8f-aed3-c115818ecf1a
                stepCounter: f0e180d9-ef3f-4224-9cf5-3357b905ad07
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c697202d-a38d-498c-9565-7016b9b9b1d2
          stepCounter: 0b146547-5e0e-4fd4-9968-56c2470f05e2
        config: {}
        dataType: NUMBER(38,8)
        defaultValue: ""
        description: ""
        name: PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: da2f5a1b-6b06-4c08-a405-e6092d04bd9a
                stepCounter: 5d104afa-878f-4f1f-b149-f46ca97ba7a5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 849c69ee-e295-4ed4-8197-cc91035ea923
          stepCounter: 0b146547-5e0e-4fd4-9968-56c2470f05e2
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: badd5dae-6855-4807-817b-848774b337f6
          stepCounter: 0b146547-5e0e-4fd4-9968-56c2470f05e2
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOAD_VET_RES_MANUAL_PRICING: 5d104afa-878f-4f1f-b149-f46ca97ba7a5
          DIM_DATE: 514e5b21-eab9-4985-9a00-e22a0e84a361
          DIM_RES_UOM: f0e180d9-ef3f-4224-9cf5-3357b905ad07
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: LOAD_VET_RES_MANUAL_PRICING
          - locationName: TARGET
            nodeName: DIM_DATE
          - locationName: TARGET
            nodeName: DIM_RES_UOM
        join:
          joinCondition: |-
            FROM {{ ref('TARGET','LOAD_VET_RES_MANUAL_PRICING') }} LOAD_VET_RES_MANUAL_PRICING
             INNER JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','DIM_DATE') }}
                     WHERE CALENDAR_DATE = LAST_DAY(CALENDAR_DATE)
                   ) DIM_DATE
                ON (DIM_DATE.CALENDAR_DATE >= LOAD_VET_RES_MANUAL_PRICING.EFFECTIVE_DATE AND DIM_DATE.CALENDAR_DATE <= LOAD_VET_RES_MANUAL_PRICING.EXPIRY_DATE)
              LEFT JOIN {{ ref('TARGET','DIM_RES_UOM') }} DIM_RES_UOM
                ON (DIM_RES_UOM.UOM_CODE = LOAD_VET_RES_MANUAL_PRICING.CURRENCY)
        name: STAGE_RES_MANUAL_PRICING
        noLinkRefs: []
  name: STAGE_RES_MANUAL_PRICING
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
