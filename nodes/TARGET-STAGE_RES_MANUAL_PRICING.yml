fileVersion: 1
id: 0558ef54-099b-48f7-ab1d-5cd5320d448d
name: STAGE_RES_MANUAL_PRICING
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "Manual pricing transformed from VET_REF source and representing all ACCT_PER_DATE values between effective and expiry dates in source."
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3d0c384-d35a-4419-8750-2261dc450b42
          stepCounter: 0558ef54-099b-48f7-ab1d-5cd5320d448d
        config: {}
        dataType: VARCHAR(259)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab43ba71-5398-44bf-9c13-4926d3ee8501
                stepCounter: 9ce99e5c-265c-4140-bc5a-3c68170eb839
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20b72c2c-e29b-4718-ace1-649ba10ed5cc
          stepCounter: 0558ef54-099b-48f7-ab1d-5cd5320d448d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGE_RES_MANUAL_PRICING.CALENDAR_DATE=DIM_DATE.CALENDAR_DATE
        isBusinessKey: true
        name: DIM_ACCT_PER_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d67dd194-392b-41c2-a867-1d286b03a749
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: NVL(DIM_DATE.DIM_DATE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3e571b4-13da-4ae1-bfef-572105916327
          stepCounter: 0558ef54-099b-48f7-ab1d-5cd5320d448d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        isBusinessKey: true
        name: DIM_UOM_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6716d591-8b39-4193-91b5-0cb1e141b3aa
                stepCounter: dedd823c-0562-4243-bfc9-1a49f49322d4
            transform: NVL(DIM_RES_UOM.DIM_UOM_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8634918-e158-4d73-92e0-dd7660c0cbae
          stepCounter: 0558ef54-099b-48f7-ab1d-5cd5320d448d
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: PRODUCT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1ae1a58-f936-4755-9157-bb42059b6bdc
                stepCounter: 9ce99e5c-265c-4140-bc5a-3c68170eb839
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 775eb8da-5bc7-4ed9-a7f9-1b797f2da63d
          stepCounter: 0558ef54-099b-48f7-ab1d-5cd5320d448d
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: STREAM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0d82daeb-6c6f-406c-9707-6293ae2bfde9
                stepCounter: 9ce99e5c-265c-4140-bc5a-3c68170eb839
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8459a4f5-b532-4b2f-8050-a13446206607
          stepCounter: 0558ef54-099b-48f7-ab1d-5cd5320d448d
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: EFFECTIVE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e12a8d0-7ec1-4782-b31e-aaeded9dcf7a
                stepCounter: 9ce99e5c-265c-4140-bc5a-3c68170eb839
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 449a3457-d795-4650-959a-99addd966883
          stepCounter: 0558ef54-099b-48f7-ab1d-5cd5320d448d
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Accounting Period Date
        name: ACCT_PER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9cafcfb4-e64b-48a7-a8b7-ac2946945d8c
                stepCounter: e36e3241-fb91-480b-b6e9-be9a8d12930f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0db66003-e22d-403b-bbd3-a051567e6b28
          stepCounter: 0558ef54-099b-48f7-ab1d-5cd5320d448d
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: EXPIRY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 68617a92-4841-48a1-ad55-26a22219cd1e
                stepCounter: 9ce99e5c-265c-4140-bc5a-3c68170eb839
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de6e3c25-5c8f-4d22-99ba-e66d7b90586c
          stepCounter: 0558ef54-099b-48f7-ab1d-5cd5320d448d
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Currency Code. One of VET_RES_UOM.UOM_CODE
        name: CURRENCY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c9ba551-1948-474a-ba17-13e774f6a37e
                stepCounter: 9ce99e5c-265c-4140-bc5a-3c68170eb839
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6cdbef9a-6812-4bb6-ab8a-f7c3d17a63bf
          stepCounter: 0558ef54-099b-48f7-ab1d-5cd5320d448d
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: UOM_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9f5e26fb-6495-4a64-922d-a754c0091dac
                stepCounter: dedd823c-0562-4243-bfc9-1a49f49322d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 85dc67e7-613d-4d88-af2f-7b13558d3c1f
          stepCounter: 0558ef54-099b-48f7-ab1d-5cd5320d448d
        config: {}
        dataType: NUMBER(38,8)
        defaultValue: ""
        description: ""
        name: PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 06befd6c-8230-4fa4-9c1b-691557118cb1
                stepCounter: 9ce99e5c-265c-4140-bc5a-3c68170eb839
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e2b0848-f236-49b1-937e-0391bb86f920
          stepCounter: 0558ef54-099b-48f7-ab1d-5cd5320d448d
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78ca66ad-ac2e-4ade-b99e-127330d5cce3
          stepCounter: 0558ef54-099b-48f7-ab1d-5cd5320d448d
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOAD_VET_RES_MANUAL_PRICING: 9ce99e5c-265c-4140-bc5a-3c68170eb839
          DIM_DATE: e36e3241-fb91-480b-b6e9-be9a8d12930f
          DIM_RES_UOM: dedd823c-0562-4243-bfc9-1a49f49322d4
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: LOAD_VET_RES_MANUAL_PRICING
          - locationName: TARGET
            nodeName: DIM_DATE
          - locationName: TARGET
            nodeName: DIM_RES_UOM
        join:
          joinCondition: |-
            FROM {{ ref('TARGET','LOAD_VET_RES_MANUAL_PRICING') }} LOAD_VET_RES_MANUAL_PRICING
             INNER JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','DIM_DATE') }}
                     WHERE CALENDAR_DATE = LAST_DAY(CALENDAR_DATE)
                   ) DIM_DATE
                ON (DIM_DATE.CALENDAR_DATE >= LOAD_VET_RES_MANUAL_PRICING.EFFECTIVE_DATE AND DIM_DATE.CALENDAR_DATE <= LOAD_VET_RES_MANUAL_PRICING.EXPIRY_DATE)
              LEFT JOIN {{ ref('TARGET','DIM_RES_UOM') }} DIM_RES_UOM
                ON (DIM_RES_UOM.UOM_CODE = LOAD_VET_RES_MANUAL_PRICING.CURRENCY)
        name: STAGE_RES_MANUAL_PRICING
        noLinkRefs: []
  name: STAGE_RES_MANUAL_PRICING
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
