fileVersion: 1
id: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
name: STAGE_LO_SAP_15
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a25f1320-04c1-4195-83b0-50ce0e1dd9ae
          stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEDGER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e9ed435e-4790-41d8-856f-c94685de8f41
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: TARGET.DIM_LEDGER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b0f22ba-a334-46c3-90b8-9090c6ab9f7e
          stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACTVY_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e4c3a825-a088-4705-91dd-badf6129e0ed
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: TARGET.DIM_ACTVY_PER_DATE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0eab9d81-c65b-4449-aeae-ec07d2e01e0b
          stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACCT_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9ed788e7-ce47-4741-a23f-bdfb436b4d80
                stepCounter: 40764d1e-e2ad-4c5a-9e2e-3f4cba8d0397
            transform: TARGET.DIM_ACCT_PER_DATE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6247bfc9-4073-4c6e-b9a3-e16acb859943
          stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_COST_CENTER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4762df3f-c36c-4c05-b4c3-532f1ce7edb7
                stepCounter: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
            transform: TARGET.DIM_COST_CENTER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 246349f5-5faf-4610-9e96-c40ae5adae77
          stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4109c70b-6276-4581-8de8-5ced46b1a3f4
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: TARGET.DIM_AFE_TYPE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be907ce7-6f60-455d-8139-e022112cf81c
          stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_DEST_ORGANIZATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e0110b8-67b4-4c60-948f-6e22a8dd52bc
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: TARGET.DIM_DEST_ORGANIZATION_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca46b5e6-b9e8-4c60-85f1-e03a81c6c9e6
          stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GL_ACCOUNT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 32b933c2-409f-45ad-8868-e4ac49483cfa
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: TARGET.DIM_GL_ACCOUNT_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96314d4e-38c1-4642-972d-0174f4208ace
          stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 648cb97f-b285-44e5-8566-ae0083165f64
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: TARGET.DIM_GROSS_NET_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27d31988-e656-4fb1-95f3-7b4b4aecc6f1
          stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_HIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03094dcc-28c0-4fee-b106-8de0eba3539c
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a3d0d93-b6c5-45e3-ab16-15e854989f29
          stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_VERSION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 847bf9cb-e6f3-43a9-be76-4a7a91df50f6
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: TARGET.DIM_LEASE_OPS_VERSION_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96753d84-8bb3-45ef-b6e0-a079e0b5e955
          stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LINE_ITEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91f293ee-f924-4f88-8c41-1ddd63c8ba4e
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: TARGET.DIM_LINE_ITEM_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33c55bfa-b9c9-4491-b986-8f773ea40571
          stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_VOUCHER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09b3f06c-70c8-413a-9ba9-9786907e41c0
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: TARGET.DIM_VOUCHER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d694944-429b-4327-87c0-537928a34f19
          stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 01b22ce5-9ca6-4010-8477-458b45d60eb8
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: TARGET.DIM_AFE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a0f60cc1-10cb-4482-bbce-5f374add234e
          stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_INVOICE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d63b69e4-342d-4d52-a423-410f5e9e66d0
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: TARGET.DIM_INVOICE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f55cc00-002d-4e22-b723-5a87a85457b7
          stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_PRODUCT_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 08c9b83a-c44c-4b51-87c4-9c84136d7593
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: TARGET.DIM_PRODUCT_TYPE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75e28167-e6c8-46c9-938a-c81c08df281c
          stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3f84c21-4ee9-4cae-88e0-9ce9656d3204
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ebab2bc2-3674-4432-bb2e-e85e4a06ebf3
          stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ee27029-0bec-4e87-b054-ae8be92517a4
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d011ab89-6b51-4fa1-8d35-363de4235288
          stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d8cf4072-997e-443a-a921-1d6dd51eac73
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a92383e-dc8c-44d5-99c2-3c1ddfbd99e3
          stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: 'Gross Line Item Net Op Amount '
        name: NET_OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33964490-8b05-4fd0-b8dd-a78920056994
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b672022-bcef-47cd-9532-1043ad7371da
          stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: LI_VOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2f1ec9de-5b18-4c27-ba1f-253b791ebcb5
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: TARGET.LI_VOL
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17bf2517-0733-4980-ac47-9105cf9fbffc
          stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in cubic meters (m3)
        name: LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 920f1bdb-c209-4b3f-ab74-3a8b86214c49
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: TARGET.LI_VOL_M3
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a0667a1-803e-410b-b330-7ac1d219886b
          stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in imperial measurement
        name: LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 535b6bef-33b6-4de3-aa28-466df068d500
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: TARGET.LI_VOL_IMPERIAL
      - appliedColumnTests: {}
        columnReference:
          columnCounter: def05348-01f9-42cb-a070-ae3675956558
          stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in BOE (Barrel of Oil Equivalent)
        name: LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a712ddf9-5278-4a3c-b8d7-d056033adad4
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: TARGET.LI_VOL_BOE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 499a1a63-0cac-41ad-81a8-408887649563
          stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in normalized cubic meters (nm3)
        name: LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d48944be-32e7-41cc-bdf2-291d10895988
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: TARGET.LI_VOL_NM3
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e4f1ee9-966a-48d3-b3fb-25781fd2cc7f
          stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: ""
        name: EXCHANGE_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f2a080f-4186-4393-b739-0193ea4cb5a4
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: TARGET.EXCHANGE_RATE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b3d6b9eb-d0d8-4343-ad0e-22e3c0d28e7e
          stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7fa94291-9657-4a60-a7a7-edc20424da73
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: TARGET.OP_CURR_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef8a6afe-85b5-42b9-b4fe-8d1fc5cfc541
          stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Indicates amounts are gross or net.
        name: GROSS_OR_NET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 85a07a99-e64f-48c4-9aed-08cc628abc54
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: TARGET.GROSS_OR_NET_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6b176d4-a27e-4b9a-a32d-531c3c1a508c
          stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: LINE_NO_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4607c855-a49d-4eb4-bbf8-11be2b047885
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0c80882-0dab-44bf-9506-16b825b7215a
          stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: OP_NONOP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4f02d163-a5e8-4937-9cec-b7c41704b5a2
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: TARGET.OP_NONOP
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05f2be2c-e6c1-4d34-9a77-f42ec038b0bd
          stepCounter: a36cc7a8-9ec5-434b-ab66-9f7a59c389eb
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PROD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 95dfac1f-9fd0-411d-a4e4-7c2bd684d81c
                stepCounter: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
            transform: TARGET.PROD_CODE
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_LO_SAP_10: 40764d1e-e2ad-4c5a-9e2e-3f4cba8d0397
          STAGE_LO_SAP_13: ec5920d5-3fd2-44a9-a6dd-2e2fda544f10
          STAGE_LO_SAP_FIRST_PASS: 3b621d50-7d60-41cf-9d9c-4a8d2a662597
          DIM_LO_SAP_LINE_ITEM: d0ab4a94-a909-487b-8651-345f5baff59d
          DIM_LO_SAP_ACTVY_PER_DATE: f8e715c1-87e2-4cc6-a839-d0b610927a6b
          DIM_LO_SAP_ACCT_PER_DATE: 030f9454-0584-4b79-8319-768ccf1fc4ab
          DIM_LO_SAP_LEASE_OPS_HIER: e0b535c4-f94e-4ac1-b685-dfdff6293176
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_FIRST_PASS
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_10
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_13
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LINE_ITEM
          - locationName: TARGET
            nodeName: DIM_LO_SAP_ACTVY_PER_DATE
          - locationName: TARGET
            nodeName: DIM_LO_SAP_ACCT_PER_DATE
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_HIER
        join:
          joinCondition: |-
            FROM (
                    SELECT STAGE_LO_SAP_10.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_10') }} STAGE_LO_SAP_10
                     WHERE STAGE_LO_SAP_10.LINE_NO='10.1'
                 UNION ALL SELECT STAGE_LO_SAP_13.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_13') }} STAGE_LO_SAP_13
                     WHERE STAGE_LO_SAP_13.LINE_NO='13.1'
                 UNION ALL SELECT STAGE_LO_SAP_FIRST_PASS.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_FIRST_PASS') }} STAGE_LO_SAP_FIRST_PASS
                      JOIN {{ ref('TARGET','DIM_LO_SAP_LINE_ITEM') }} DIM_LO_SAP_LINE_ITEM
                        ON (STAGE_LO_SAP_FIRST_PASS.DIM_LINE_ITEM_KEY = DIM_LO_SAP_LINE_ITEM.DIM_LINE_ITEM_KEY AND DIM_LO_SAP_LINE_ITEM.ACCT_GROUP_CODE = 'LOCAM')
                      JOIN {{ ref('TARGET','DIM_LO_SAP_ACTVY_PER_DATE') }} DIM_LO_SAP_ACTVY_PER_DATE
                        ON (STAGE_LO_SAP_FIRST_PASS.DIM_ACTVY_PER_DATE_KEY = DIM_LO_SAP_ACTVY_PER_DATE.DIM_ACTVY_PER_DATE_KEY)
                      JOIN {{ ref('TARGET','DIM_LO_SAP_ACCT_PER_DATE') }} DIM_LO_SAP_ACCT_PER_DATE
                        ON (STAGE_LO_SAP_FIRST_PASS.DIM_ACCT_PER_DATE_KEY = DIM_LO_SAP_ACCT_PER_DATE.DIM_ACCT_PER_DATE_KEY)
                     WHERE DIM_LO_SAP_ACCT_PER_DATE.DATE <> DIM_LO_SAP_ACTVY_PER_DATE.DATE
                   ) TARGET
              JOIN {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_HIER') }} DIM_LO_SAP_LEASE_OPS_HIER
                ON (DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO = DECODE(TARGET.LINE_NO, '10.1','15.2', '13.1','15.3', '15.1'))
        name: STAGE_LO_SAP_15
        noLinkRefs: []
  name: STAGE_LO_SAP_15
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
