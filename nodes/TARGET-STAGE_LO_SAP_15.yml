fileVersion: 1
id: fe17c64f-c293-4956-b465-84809fca2e22
name: STAGE_LO_SAP_15
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1db22d5-5e46-4e2c-8d0c-d5bfdf605777
          stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEDGER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3d15d52d-aa78-4a52-95d1-a4ad5c668dee
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: TARGET.DIM_LEDGER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8193b01f-e40e-4db2-8ff3-c7775b217cb8
          stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACTVY_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 54526b1e-45d8-48aa-bb3b-bfef2e8ff111
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: TARGET.DIM_ACTVY_PER_DATE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9b308f0-be1b-4a34-9232-5aa003e320eb
          stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: date as integer
        name: DIM_ACCT_PER_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed153bb2-007b-4e88-8f6d-53b6df77792a
                stepCounter: 586a89ed-3877-4311-b120-e8c408fcbbbb
            transform: TARGET.DIM_ACCT_PER_DATE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03503a7f-e4f0-424d-8af3-434c35b6599b
          stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_COST_CENTER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d1128cbc-db73-42b6-8ca1-8c8b5bffe357
                stepCounter: e3ca2bdf-749f-464d-b297-6fea2ed2a20c
            transform: TARGET.DIM_COST_CENTER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a52df9f1-7f81-42ad-8be9-b5856e8dc57f
          stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec389d53-6581-4b6d-aa98-762d53c5aee4
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: TARGET.DIM_AFE_TYPE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 12c86ebe-b44a-470e-b08d-b175595c14a7
          stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_DEST_ORGANIZATION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 62f1e7a5-2cf8-4b1e-a279-743f79de109b
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: TARGET.DIM_DEST_ORGANIZATION_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bbbfec51-e5b2-4256-a90b-8626df1d5d1d
          stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GL_ACCOUNT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b3eee47-9239-408b-8dd8-c70ea98c5af3
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: TARGET.DIM_GL_ACCOUNT_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de3e86c2-c67e-4c1b-b821-a70d916205ab
          stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 154068f9-4120-427b-9543-030412be64f4
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: TARGET.DIM_GROSS_NET_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 35119654-24db-4127-8afd-930d51e94a09
          stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_HIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21fac97a-151e-4cc2-8783-56a1148d309b
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20dcf7e7-b707-4054-bfb2-34ced4cc43a4
          stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEASE_OPS_VERSION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5bac2b5d-65d6-45f4-b87f-59ea54635d37
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: TARGET.DIM_LEASE_OPS_VERSION_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb85a312-bf04-4174-9e56-8ef0626975e1
          stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LINE_ITEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a38e2a1f-fc5e-4c3e-b3ee-918fd8e715ea
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: TARGET.DIM_LINE_ITEM_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 565fe88d-d241-4549-a0ab-92b931cdd618
          stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_VOUCHER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6410658d-ee93-46a9-9b43-e51ba4044476
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: TARGET.DIM_VOUCHER_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c025dd34-c2d1-4431-8b74-3b37efdf6508
          stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79f0c691-6e9d-476d-b7dc-11207d4ffd5e
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: TARGET.DIM_AFE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb9fc073-9259-4bf1-a342-3d60bf7f787c
          stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_INVOICE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c720c959-a12b-4fd8-b12b-1cca9d613b94
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: TARGET.DIM_INVOICE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8258990-daca-44a5-a789-7916eb86cb97
          stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_PRODUCT_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3933b1e5-6132-4961-8d98-bdcbf5304485
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: TARGET.DIM_PRODUCT_TYPE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b735374-7074-48d3-b698-f13609b58816
          stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1a83d4b-9af5-4a64-b5b2-f6f811cf7698
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 93cd230e-5d82-48ec-9fb4-5ac59b5b54a4
          stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6316db0f-0ffe-4164-b4f0-ee82cf5a4f2e
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c621ab8-5c0c-46ce-856c-3a2390c731a1
          stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8193d3fc-ef33-46f0-8de4-59ce89ac19a1
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57b6e139-99ba-47aa-bc67-07b7876f5ea5
          stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: 'Gross Line Item Net Op Amount '
        name: NET_OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33f00836-a784-43e0-8c43-37f890b196b6
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5d9a18a-880d-43f1-8836-ccee12626cc3
          stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: LI_VOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24e990a3-fd59-4608-9c40-4f07d5c0acfa
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: TARGET.LI_VOL
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fecb7829-9e41-48de-859d-9e0ddb2be738
          stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in cubic meters (m3)
        name: LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91df505d-670d-4080-82b4-c2135a4c8e29
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: TARGET.LI_VOL_M3
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1cd8d772-47c7-46e4-ad7d-fccf00a35696
          stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in imperial measurement
        name: LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e9be255-7a00-4d64-9245-87e8580d76df
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: TARGET.LI_VOL_IMPERIAL
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b3a293af-146f-4106-8c00-7d2b69c45771
          stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in BOE (Barrel of Oil Equivalent)
        name: LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 455f1e13-fd1c-4b60-8d28-b1e065f6dc16
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: TARGET.LI_VOL_BOE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a36e59dd-8370-4e78-a3e1-7605b892e5ba
          stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: Line item Volume in normalized cubic meters (nm3)
        name: LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b3902e89-72c5-46f5-b553-e54f82534123
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: TARGET.LI_VOL_NM3
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ac47fe4-70bb-4d6d-b8c6-5e0fcbc81f90
          stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: ""
        name: EXCHANGE_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 066b21ad-5d5f-4b6a-9764-68487cc90eb2
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: TARGET.EXCHANGE_RATE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f25767a-6588-4195-b83e-c23e25573e74
          stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f51c159-b610-41c4-999c-06d6d16fe1a7
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: TARGET.OP_CURR_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 08b2c59f-d0c2-4d83-86b7-2f12ddcd0783
          stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Indicates amounts are gross or net.
        name: GROSS_OR_NET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 201dfbac-08f1-41ae-8696-1029994419d9
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: TARGET.GROSS_OR_NET_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 754371c6-0e65-4ce2-b9f3-d69ffcf13a01
          stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: LINE_NO_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4460264-eeac-48f7-bae2-1748cdbcf9cb
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 19e6aac2-a837-4990-866b-0eea355fbe9d
          stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: OP_NONOP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a2fd8fa-b76c-431e-8314-a93c76526811
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: TARGET.OP_NONOP
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a06d3108-552a-47d6-a10a-f2e02b1d56c1
          stepCounter: fe17c64f-c293-4956-b465-84809fca2e22
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PROD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6839cbc3-c956-480f-a1bc-ca7ecf77a159
                stepCounter: 7f87de3d-bdfa-4c2a-af50-4179beced526
            transform: TARGET.PROD_CODE
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_LO_SAP_10: 586a89ed-3877-4311-b120-e8c408fcbbbb
          STAGE_LO_SAP_13: e3ca2bdf-749f-464d-b297-6fea2ed2a20c
          STAGE_LO_SAP_FIRST_PASS: 7f87de3d-bdfa-4c2a-af50-4179beced526
          DIM_LO_SAP_LINE_ITEM: 6d556ec5-1a14-4fec-b7c2-d8beb2ab5abd
          DIM_LO_SAP_ACTVY_PER_DATE: 2dd43a82-d1cd-4faa-9896-f735a52c38e7
          DIM_LO_SAP_ACCT_PER_DATE: 16046caa-0e21-4501-abd9-fc6a817b0803
          DIM_LO_SAP_LEASE_OPS_HIER: 82938641-7c51-4aff-ad3a-c7a56af30c01
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_FIRST_PASS
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_10
          - locationName: TARGET
            nodeName: STAGE_LO_SAP_13
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LINE_ITEM
          - locationName: TARGET
            nodeName: DIM_LO_SAP_ACTVY_PER_DATE
          - locationName: TARGET
            nodeName: DIM_LO_SAP_ACCT_PER_DATE
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_HIER
        join:
          joinCondition: |-
            FROM (
                    SELECT STAGE_LO_SAP_10.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_10') }} STAGE_LO_SAP_10
                     WHERE STAGE_LO_SAP_10.LINE_NO='10.1'
                 UNION ALL SELECT STAGE_LO_SAP_13.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_13') }} STAGE_LO_SAP_13
                     WHERE STAGE_LO_SAP_13.LINE_NO='13.1'
                 UNION ALL SELECT STAGE_LO_SAP_FIRST_PASS.*
                      FROM {{ ref('TARGET','STAGE_LO_SAP_FIRST_PASS') }} STAGE_LO_SAP_FIRST_PASS
                      JOIN {{ ref('TARGET','DIM_LO_SAP_LINE_ITEM') }} DIM_LO_SAP_LINE_ITEM
                        ON (STAGE_LO_SAP_FIRST_PASS.DIM_LINE_ITEM_KEY = DIM_LO_SAP_LINE_ITEM.DIM_LINE_ITEM_KEY AND DIM_LO_SAP_LINE_ITEM.ACCT_GROUP_CODE = 'LOCAM')
                      JOIN {{ ref('TARGET','DIM_LO_SAP_ACTVY_PER_DATE') }} DIM_LO_SAP_ACTVY_PER_DATE
                        ON (STAGE_LO_SAP_FIRST_PASS.DIM_ACTVY_PER_DATE_KEY = DIM_LO_SAP_ACTVY_PER_DATE.DIM_ACTVY_PER_DATE_KEY)
                      JOIN {{ ref('TARGET','DIM_LO_SAP_ACCT_PER_DATE') }} DIM_LO_SAP_ACCT_PER_DATE
                        ON (STAGE_LO_SAP_FIRST_PASS.DIM_ACCT_PER_DATE_KEY = DIM_LO_SAP_ACCT_PER_DATE.DIM_ACCT_PER_DATE_KEY)
                     WHERE DIM_LO_SAP_ACCT_PER_DATE.DATE <> DIM_LO_SAP_ACTVY_PER_DATE.DATE
                   ) TARGET
              JOIN {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_HIER') }} DIM_LO_SAP_LEASE_OPS_HIER
                ON (DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO = DECODE(TARGET.LINE_NO, '10.1','15.2', '13.1','15.3', '15.1'))
        name: STAGE_LO_SAP_15
        noLinkRefs: []
  name: STAGE_LO_SAP_15
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
