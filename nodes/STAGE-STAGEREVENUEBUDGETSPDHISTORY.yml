fileVersion: 1
id: b3c77b0d-093f-40e9-9d14-8f36e962edfe
name: STAGEREVENUEBUDGETSPDHISTORY
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "SEE NOTES"
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d8a74e2-715b-485a-82a4-877374611a69
          stepCounter: b3c77b0d-093f-40e9-9d14-8f36e962edfe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: SUPPLIERPDHISTORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a918e37-e982-432b-bdc3-dbcb243fc253
                stepCounter: 71807e89-8703-45b6-b51b-ceb31814f994
            transform: IFNULL(SUPPLIERPDHISTORY.SUPPLIERPDHISTORYKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0746590-b35c-486e-a36d-75c1955d5fe8
          stepCounter: b3c77b0d-093f-40e9-9d14-8f36e962edfe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGECONTRACT_ADDKEYS.SUPPLIERID=SUPPLIER.SUPPLIERID
        name: SUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 63de3923-ac93-4f74-bdaf-fba1a1c87ff6
                stepCounter: 59cadb79-2e03-4a1c-9c6e-7e6588e89674
            transform: IFNULL(CONTRACT.SUPPLIERKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d36eb2a-1543-4a11-a90f-6aaf2ee9ae05
          stepCounter: b3c77b0d-093f-40e9-9d14-8f36e962edfe
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02728bac-9bb3-4dc7-a7c5-c7c3f1b083d3
                stepCounter: 59cadb79-2e03-4a1c-9c6e-7e6588e89674
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 83a1a900-a60c-425a-be81-466a3578dcb8
          stepCounter: b3c77b0d-093f-40e9-9d14-8f36e962edfe
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SUPPLIERNAMESFDC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1dfef313-2014-420c-b1fd-fbae046208f1
                stepCounter: 71807e89-8703-45b6-b51b-ceb31814f994
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25f6fe50-be0f-4188-9e0e-bf1db8a6091c
          stepCounter: b3c77b0d-093f-40e9-9d14-8f36e962edfe
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE NAME OF A SUPPLIER WHO OWNS A CONTRACT, AS IT EXISTS FROM THE SOURCE SYSTEM. YOU PROBABLY WANT TO USE REPORTINGSUPPLIERNAME INSTEAD.
        name: SUPPLIERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ea48c1b-c631-424b-8736-a19579a43b89
                stepCounter: f82e9572-e5ea-45e1-991d-83ad35997403
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 282745eb-e515-49ef-aeb1-f8237e249ac4
          stepCounter: b3c77b0d-093f-40e9-9d14-8f36e962edfe
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE PREFERRED, CLEANED UP NAME OF THE SUPPLIER. THIS IS THE ONE YOU WANT TO USE FOR REPORTS
        name: REPORTINGSUPPLIERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 420f43fd-4935-4703-8b0c-a99c9f011eec
                stepCounter: f82e9572-e5ea-45e1-991d-83ad35997403
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f3893ccb-3f5c-412c-a909-25fa2f5588f5
          stepCounter: b3c77b0d-093f-40e9-9d14-8f36e962edfe
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PD_VP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 14ea8c30-2d16-409e-8667-3f2cad984235
                stepCounter: 71807e89-8703-45b6-b51b-ceb31814f994
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b1c61c4-8e1a-4fff-b700-923afe8f5afc
          stepCounter: b3c77b0d-093f-40e9-9d14-8f36e962edfe
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PD_DIRECTOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 874460e2-1db1-4250-9244-5d09513d70f4
                stepCounter: 71807e89-8703-45b6-b51b-ceb31814f994
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ea70499-6feb-4fcd-8797-a73c63a736a2
          stepCounter: b3c77b0d-093f-40e9-9d14-8f36e962edfe
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: CONTRACTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9eecd6c8-6720-4938-83f9-9ebbd7c72ec7
                stepCounter: 59cadb79-2e03-4a1c-9c6e-7e6588e89674
            transform: IFNULL(CONTRACT.CONTRACTKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb5772cc-592c-41b9-b985-3238e0b172a8
          stepCounter: b3c77b0d-093f-40e9-9d14-8f36e962edfe
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CONTRACTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 037ae52e-be27-483f-8e1d-d6648369bcdb
                stepCounter: c0a62499-7c2f-424a-ac6b-1c51df4e0ae4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 60b4ba00-7bc8-4484-a1b8-d5b6efc8e80c
          stepCounter: b3c77b0d-093f-40e9-9d14-8f36e962edfe
        config: {}
        dataType: INT
        defaultValue: ""
        description: STAGEREVENUEBUDGETSPDHISTORY.BUDGETDATE=DIMBUDGETDATE.BUDGETDATE
        name: BUDGETDATEKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c42f4c59-0fc8-49d9-82dd-50d19823c0b6
                stepCounter: a902137c-8d54-45f8-853b-239442cd36bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa41256c-4681-48b5-b922-888dd3eef392
          stepCounter: b3c77b0d-093f-40e9-9d14-8f36e962edfe
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: BUDGETDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24f4b11f-75a4-4597-9b89-0576d3ccd96a
                stepCounter: c0a62499-7c2f-424a-ac6b-1c51df4e0ae4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 998f2631-e65d-4346-b5bf-111ff4fa5b58
          stepCounter: b3c77b0d-093f-40e9-9d14-8f36e962edfe
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BUDGETSALESAMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1a3a4c5d-d10c-4ed4-a663-ff0bdfba8936
                stepCounter: c0a62499-7c2f-424a-ac6b-1c51df4e0ae4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66b4ceac-96db-46bd-b1e7-93269585a7e4
          stepCounter: b3c77b0d-093f-40e9-9d14-8f36e962edfe
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BUDGETREVENUEAMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8d7cfd03-9fb9-44b4-b998-79603939dd29
                stepCounter: c0a62499-7c2f-424a-ac6b-1c51df4e0ae4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dbf5c698-0b15-4613-b514-324d61916d4f
          stepCounter: b3c77b0d-093f-40e9-9d14-8f36e962edfe
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e220f94-a73b-4276-971b-be1837ee3ff2
                stepCounter: c0a62499-7c2f-424a-ac6b-1c51df4e0ae4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 943f9e0e-6ffe-401b-871e-ff10256cc588
          stepCounter: b3c77b0d-093f-40e9-9d14-8f36e962edfe
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea80b47b-f975-4cbf-b463-a1862fecf0bf
                stepCounter: c0a62499-7c2f-424a-ac6b-1c51df4e0ae4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01be4752-5c54-4576-850f-163b3acdb810
          stepCounter: b3c77b0d-093f-40e9-9d14-8f36e962edfe
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f17bd65a-2b0f-433f-8eca-e0fb25a4753d
          stepCounter: b3c77b0d-093f-40e9-9d14-8f36e962edfe
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOADREVENUEBUDGETSPD: c0a62499-7c2f-424a-ac6b-1c51df4e0ae4
          CONTRACT: 59cadb79-2e03-4a1c-9c6e-7e6588e89674
          SUPPLIER: f82e9572-e5ea-45e1-991d-83ad35997403
          SUPPLIERPDHISTORY: 71807e89-8703-45b6-b51b-ceb31814f994
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: CONTRACT
          - locationName: DIM
            nodeName: DIMBUDGETDATE
          - locationName: DIM
            nodeName: SUPPLIER
          - locationName: DIM
            nodeName: SUPPLIERPDHISTORY
          - locationName: LOAD
            nodeName: LOADREVENUEBUDGETSPD
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOADREVENUEBUDGETSPD') }} LOADREVENUEBUDGETSPD
              LEFT JOIN {{ ref('DIM','CONTRACT') }} CONTRACT
                ON LOADREVENUEBUDGETSPD.CONTRACTID = CONTRACT.CONTRACTID
              LEFT JOIN {{ ref('DIM','SUPPLIER') }} SUPPLIER
                ON CONTRACT.SUPPLIERKEY = SUPPLIER.SUPPLIERKEY
              LEFT JOIN {{ ref('DIM','SUPPLIERPDHISTORY') }} SUPPLIERPDHISTORY
                ON CONTRACT.SUPPLIERKEY = SUPPLIERPDHISTORY.SUPPLIERKEY
               AND LOADREVENUEBUDGETSPD.BUDGETDATE BETWEEN SUPPLIERPDHISTORY.STARTDATE AND SUPPLIERPDHISTORY.ENDDATE
        name: STAGEREVENUEBUDGETSPDHISTORY
        noLinkRefs: []
  name: STAGEREVENUEBUDGETSPDHISTORY
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
