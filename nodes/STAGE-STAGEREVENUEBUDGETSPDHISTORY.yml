fileVersion: 1
id: 07bc9f05-0a79-4594-8f34-6fb60d9fe84a
name: STAGEREVENUEBUDGETSPDHISTORY
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "See Notes"
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26639a14-f480-4073-a904-cb3f0bdd648e
          stepCounter: 07bc9f05-0a79-4594-8f34-6fb60d9fe84a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SUPPLIERPDHISTORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a9992a53-d801-41c5-b0e9-625fa2cb36f6
                stepCounter: e53301c5-2f91-495d-bc86-434a6bd64fcf
            transform: IFNULL(SupplierPDHistory.SupplierPDHistoryKey,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fefdcbf1-ac6b-4569-96c4-d75d1f0f5fa8
          stepCounter: 07bc9f05-0a79-4594-8f34-6fb60d9fe84a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: StageContract_AddKeys.SupplierId=Supplier.SupplierId
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 651b2502-6437-43f9-be30-5cd0c3a311cc
                stepCounter: c745f44c-5c71-4400-897b-ff90a502a9cb
            transform: IFNULL(Contract.SupplierKey,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dd5abe59-28da-4c39-ab19-cf266f33eb97
          stepCounter: 07bc9f05-0a79-4594-8f34-6fb60d9fe84a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03ce18f0-4550-48bd-a446-0f49c08d8754
                stepCounter: c745f44c-5c71-4400-897b-ff90a502a9cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9615fdf-6574-4c2c-be02-bbcc7aecbd47
          stepCounter: 07bc9f05-0a79-4594-8f34-6fb60d9fe84a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SUPPLIERNAMESFDC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4dfccb50-befa-4f46-b9fe-ee7ff34290e8
                stepCounter: e53301c5-2f91-495d-bc86-434a6bd64fcf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f35c97cd-0539-40f0-96bc-3eb22a330c6d
          stepCounter: 07bc9f05-0a79-4594-8f34-6fb60d9fe84a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the name of a supplier who owns a contract, as it exists from the source system. You probably want to use ReportingSupplierName instead.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SUPPLIERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56db3b0d-de25-4323-9fa5-ad64aee25d2b
                stepCounter: 4f59fbc0-7b06-498c-b967-f551d35c31c4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71aec90c-40db-40d7-9a90-41cb6315ad3a
          stepCounter: 07bc9f05-0a79-4594-8f34-6fb60d9fe84a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the preferred, cleaned up name of the supplier. This is the one you want to use for reports
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: REPORTINGSUPPLIERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77ae6e90-7353-49fa-afec-de241698e34d
                stepCounter: 4f59fbc0-7b06-498c-b967-f551d35c31c4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d47062b-51dc-4114-a8e9-abcec5afdd42
          stepCounter: 07bc9f05-0a79-4594-8f34-6fb60d9fe84a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PD_VP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47e72d38-ff4a-4524-8136-9a470d974125
                stepCounter: e53301c5-2f91-495d-bc86-434a6bd64fcf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f955aa7-e911-437e-91bc-3536a2f37f38
          stepCounter: 07bc9f05-0a79-4594-8f34-6fb60d9fe84a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PD_DIRECTOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ead5f27f-05c0-4ad2-b6a9-00520f3e5fd9
                stepCounter: e53301c5-2f91-495d-bc86-434a6bd64fcf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49244a8d-0e21-4098-ba74-15e6047bb06e
          stepCounter: 07bc9f05-0a79-4594-8f34-6fb60d9fe84a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CONTRACTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 06359440-091b-417e-8827-e3b22e452e17
                stepCounter: c745f44c-5c71-4400-897b-ff90a502a9cb
            transform: IFNULL(Contract.ContractKey,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad4b2f88-6a08-4ce1-9316-285e22f965ec
          stepCounter: 07bc9f05-0a79-4594-8f34-6fb60d9fe84a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CONTRACTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3eb834f4-4772-4206-b232-a63bb490baa6
                stepCounter: 40d90aaa-80df-46d9-9df7-cef170255f07
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 306af8e9-727e-4a99-af21-a83e12a74176
          stepCounter: 07bc9f05-0a79-4594-8f34-6fb60d9fe84a
        config: {}
        dataType: INT
        defaultValue: ""
        description: StageRevenueBudgetsPDHistory.BudgetDate=DimBudgetDate.BudgetDate
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: BUDGETDATEKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7cb00172-db06-4a0a-a70c-39d4297b703c
                stepCounter: 5a652858-1d0d-4737-b9f7-a8788ecd3fca
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66646707-3fc6-424a-ac36-e7f3536b010e
          stepCounter: 07bc9f05-0a79-4594-8f34-6fb60d9fe84a
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: BUDGETDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4f9fbd29-c493-4292-abb2-f96a5f75f713
                stepCounter: 40d90aaa-80df-46d9-9df7-cef170255f07
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd37b444-5a22-4b83-b59a-f4251f3f3048
          stepCounter: 07bc9f05-0a79-4594-8f34-6fb60d9fe84a
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: BUDGETSALESAMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ed2f906-4ec3-42ce-93d5-d86d2458dfa3
                stepCounter: 40d90aaa-80df-46d9-9df7-cef170255f07
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e3b69e3-57ca-4b44-91a3-23f1dad4f118
          stepCounter: 07bc9f05-0a79-4594-8f34-6fb60d9fe84a
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: BUDGETREVENUEAMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c918450-bf26-4e29-93cd-a07f7b1e1f4d
                stepCounter: 40d90aaa-80df-46d9-9df7-cef170255f07
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df081a16-b33b-4f4b-a328-f35dbe0848a0
          stepCounter: 07bc9f05-0a79-4594-8f34-6fb60d9fe84a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Record source.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc9f37a1-f4ab-4d1d-a1e9-4a5b8061d550
                stepCounter: 40d90aaa-80df-46d9-9df7-cef170255f07
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98d8aa40-a5a0-4fc0-ba5e-12b9205304a4
          stepCounter: 07bc9f05-0a79-4594-8f34-6fb60d9fe84a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Load date.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2f23b200-bc97-417c-b731-fa2313119062
                stepCounter: 40d90aaa-80df-46d9-9df7-cef170255f07
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1fc4158e-8137-4b47-be69-ef1db37f0f50
          stepCounter: 07bc9f05-0a79-4594-8f34-6fb60d9fe84a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a6076b1-4966-473e-aa9c-036c2726ec59
          stepCounter: 07bc9f05-0a79-4594-8f34-6fb60d9fe84a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOADREVENUEBUDGETSPD: 40d90aaa-80df-46d9-9df7-cef170255f07
          CONTRACT: c745f44c-5c71-4400-897b-ff90a502a9cb
          SUPPLIER: 4f59fbc0-7b06-498c-b967-f551d35c31c4
          SUPPLIERPDHISTORY: e53301c5-2f91-495d-bc86-434a6bd64fcf
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: CONTRACT
          - locationName: DIM
            nodeName: DIMBUDGETDATE
          - locationName: DIM
            nodeName: SUPPLIER
          - locationName: DIM
            nodeName: SUPPLIERPDHISTORY
          - locationName: LOAD
            nodeName: LOADREVENUEBUDGETSPD
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOADREVENUEBUDGETSPD') }} LoadRevenueBudgetsPD
              LEFT JOIN {{ ref('DIM','CONTRACT') }} Contract
                ON LoadRevenueBudgetsPD.ContractId = Contract.ContractId
              LEFT JOIN {{ ref('DIM','SUPPLIER') }} Supplier
                ON Contract.SupplierKey = Supplier.SupplierKey
              LEFT JOIN {{ ref('DIM','SUPPLIERPDHISTORY') }} SupplierPDHistory
                ON Contract.SupplierKey = SupplierPDHistory.SupplierKey
               AND LoadRevenueBudgetsPD.BudgetDate BETWEEN SupplierPDHistory.StartDate AND SupplierPDHistory.EndDate
        name: STAGEREVENUEBUDGETSPDHISTORY
        noLinkRefs: []
  name: STAGEREVENUEBUDGETSPDHISTORY
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
