fileVersion: 1
id: fabd623b-0439-485a-9b0c-0ac9218af576
name: STAGEREVENUEBUDGETSPDHISTORY
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "SEE NOTES"
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d73fd5ce-b168-424d-ab1c-8b5491e3449e
          stepCounter: fabd623b-0439-485a-9b0c-0ac9218af576
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: SUPPLIERPDHISTORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a18f34c3-25fe-41ef-8c03-35b6a51b9f11
                stepCounter: 686cf0f3-ef09-4b57-9acb-b85b99509720
            transform: IFNULL(SUPPLIERPDHISTORY.SUPPLIERPDHISTORYKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 544c9f9f-2598-4a32-be8d-f4db96ad8cdc
          stepCounter: fabd623b-0439-485a-9b0c-0ac9218af576
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGECONTRACT_ADDKEYS.SUPPLIERID=SUPPLIER.SUPPLIERID
        name: SUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9413a045-b4a9-4f1c-ba16-9b40f8665929
                stepCounter: ab16115a-f5c7-4d24-bca6-41c596634f50
            transform: IFNULL(CONTRACT.SUPPLIERKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48a14bca-b3b8-4733-9df6-fb20e1da4497
          stepCounter: fabd623b-0439-485a-9b0c-0ac9218af576
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94ba4ddd-fc01-4bc3-b77b-803c039646b1
                stepCounter: ab16115a-f5c7-4d24-bca6-41c596634f50
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f08b9822-a9d5-4b1a-aa2a-6d0e861b9e83
          stepCounter: fabd623b-0439-485a-9b0c-0ac9218af576
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SUPPLIERNAMESFDC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23999f8e-4d46-4b06-adf0-16a643730fba
                stepCounter: 686cf0f3-ef09-4b57-9acb-b85b99509720
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c2c42bf-0b21-46bf-825a-756b2a033254
          stepCounter: fabd623b-0439-485a-9b0c-0ac9218af576
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE NAME OF A SUPPLIER WHO OWNS A CONTRACT, AS IT EXISTS FROM THE SOURCE SYSTEM. YOU PROBABLY WANT TO USE REPORTINGSUPPLIERNAME INSTEAD.
        name: SUPPLIERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf00d963-cc2c-49cd-8121-fe70c8d213af
                stepCounter: 8d733483-4c1e-4c52-8f3e-9f99b8022f6d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8fa23e3f-7201-4b06-8608-f147cb80f811
          stepCounter: fabd623b-0439-485a-9b0c-0ac9218af576
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE PREFERRED, CLEANED UP NAME OF THE SUPPLIER. THIS IS THE ONE YOU WANT TO USE FOR REPORTS
        name: REPORTINGSUPPLIERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4bae49f-4046-468f-b6f5-58dbc6854b64
                stepCounter: 8d733483-4c1e-4c52-8f3e-9f99b8022f6d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab7548a3-790b-4fd0-820d-316c8ce9b725
          stepCounter: fabd623b-0439-485a-9b0c-0ac9218af576
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PD_VP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d9550aa9-4a26-42e9-aca0-76d18bea585d
                stepCounter: 686cf0f3-ef09-4b57-9acb-b85b99509720
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2942f72d-a0fc-4149-9ef4-5b7be291dbb7
          stepCounter: fabd623b-0439-485a-9b0c-0ac9218af576
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PD_DIRECTOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7923f478-92ef-45b7-bedd-899211873dad
                stepCounter: 686cf0f3-ef09-4b57-9acb-b85b99509720
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1d1a693-8d5b-4a14-87eb-c2d01f674a09
          stepCounter: fabd623b-0439-485a-9b0c-0ac9218af576
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: CONTRACTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52c7aa26-2ad9-4bd6-9ffc-9fc8c0ecb6dc
                stepCounter: ab16115a-f5c7-4d24-bca6-41c596634f50
            transform: IFNULL(CONTRACT.CONTRACTKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cbce819a-c9bf-47b7-8481-672e45a1bad7
          stepCounter: fabd623b-0439-485a-9b0c-0ac9218af576
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CONTRACTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 55dfeb4c-7541-41d1-a0c8-f1247dc670fa
                stepCounter: b3b77140-90db-44ba-bbe4-a62a41089f66
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 61a58b68-903e-4dfe-94a9-45f0c04432aa
          stepCounter: fabd623b-0439-485a-9b0c-0ac9218af576
        config: {}
        dataType: INT
        defaultValue: ""
        description: STAGEREVENUEBUDGETSPDHISTORY.BUDGETDATE=DIMBUDGETDATE.BUDGETDATE
        name: BUDGETDATEKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 764d6832-2e15-4af0-b7cf-63416d29597c
                stepCounter: 8bc1c3e8-3761-4925-beac-685184de97ac
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 83a5cc4a-f4ee-4901-a0eb-bb8d13a5d1b2
          stepCounter: fabd623b-0439-485a-9b0c-0ac9218af576
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: BUDGETDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9423448c-ff04-48ce-9cde-7299d6f36e06
                stepCounter: b3b77140-90db-44ba-bbe4-a62a41089f66
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9ee347c-977f-4758-8e02-5ca0c203bda1
          stepCounter: fabd623b-0439-485a-9b0c-0ac9218af576
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BUDGETSALESAMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ee757b9-6a9b-4ebf-bccb-9c7a6698b45f
                stepCounter: b3b77140-90db-44ba-bbe4-a62a41089f66
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 00caa785-acda-4fc8-951e-4b93c676e088
          stepCounter: fabd623b-0439-485a-9b0c-0ac9218af576
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BUDGETREVENUEAMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: edc96216-7207-4dd7-ba71-33713aaa825d
                stepCounter: b3b77140-90db-44ba-bbe4-a62a41089f66
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ada0bb4-2685-4a26-a483-f2af8ff855b7
          stepCounter: fabd623b-0439-485a-9b0c-0ac9218af576
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c096ddc4-8a60-451e-b081-04b7085216b6
                stepCounter: b3b77140-90db-44ba-bbe4-a62a41089f66
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9bd96616-23ca-4e64-b8b1-07e034ea83c5
          stepCounter: fabd623b-0439-485a-9b0c-0ac9218af576
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b55425d7-1b79-4967-92cb-4c560ac2cf2d
                stepCounter: b3b77140-90db-44ba-bbe4-a62a41089f66
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b3a68278-42ae-4e08-8b22-305f24f4101e
          stepCounter: fabd623b-0439-485a-9b0c-0ac9218af576
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c5f837e-8438-4df3-9391-6a309a90b40b
          stepCounter: fabd623b-0439-485a-9b0c-0ac9218af576
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOADREVENUEBUDGETSPD: b3b77140-90db-44ba-bbe4-a62a41089f66
          CONTRACT: ab16115a-f5c7-4d24-bca6-41c596634f50
          SUPPLIER: 8d733483-4c1e-4c52-8f3e-9f99b8022f6d
          SUPPLIERPDHISTORY: 686cf0f3-ef09-4b57-9acb-b85b99509720
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: CONTRACT
          - locationName: DIM
            nodeName: DIMBUDGETDATE
          - locationName: DIM
            nodeName: SUPPLIER
          - locationName: DIM
            nodeName: SUPPLIERPDHISTORY
          - locationName: LOAD
            nodeName: LOADREVENUEBUDGETSPD
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOADREVENUEBUDGETSPD') }} LOADREVENUEBUDGETSPD
              LEFT JOIN {{ ref('DIM','CONTRACT') }} CONTRACT
                ON LOADREVENUEBUDGETSPD.CONTRACTID = CONTRACT.CONTRACTID
              LEFT JOIN {{ ref('DIM','SUPPLIER') }} SUPPLIER
                ON CONTRACT.SUPPLIERKEY = SUPPLIER.SUPPLIERKEY
              LEFT JOIN {{ ref('DIM','SUPPLIERPDHISTORY') }} SUPPLIERPDHISTORY
                ON CONTRACT.SUPPLIERKEY = SUPPLIERPDHISTORY.SUPPLIERKEY
               AND LOADREVENUEBUDGETSPD.BUDGETDATE BETWEEN SUPPLIERPDHISTORY.STARTDATE AND SUPPLIERPDHISTORY.ENDDATE
        name: STAGEREVENUEBUDGETSPDHISTORY
        noLinkRefs: []
  name: STAGEREVENUEBUDGETSPDHISTORY
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
