fileVersion: 1
id: 5ed7c73b-12ed-435b-bc09-3a714f35135f
name: STAGEREVENUEBUDGETSPDHISTORY
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "See Notes"
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94ffbb39-5872-4bc9-88bd-ae001f97fee3
          stepCounter: 5ed7c73b-12ed-435b-bc09-3a714f35135f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SUPPLIERPDHISTORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b7670123-1c98-49fa-a7c2-a20a7d6354ae
                stepCounter: c7a2f9ae-61f5-41f3-8e70-0eab0ad393d6
            transform: IFNULL(SupplierPDHistory.SupplierPDHistoryKey,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b4a46e9-1db1-4b43-81b2-8d7896ab50a6
          stepCounter: 5ed7c73b-12ed-435b-bc09-3a714f35135f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: StageContract_AddKeys.SupplierId=Supplier.SupplierId
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7716f78-2fd0-4067-989c-7cafdab51b5f
                stepCounter: 60b39932-2692-4360-ae42-25e43379d6f6
            transform: IFNULL(Contract.SupplierKey,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 494ba663-e8a4-41d0-b8bf-e10f3fed6f68
          stepCounter: 5ed7c73b-12ed-435b-bc09-3a714f35135f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 171a7c38-4b55-4440-a5e6-5d26fc45fdc1
                stepCounter: 60b39932-2692-4360-ae42-25e43379d6f6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0886cb77-2e69-4b51-85fc-24393961bc96
          stepCounter: 5ed7c73b-12ed-435b-bc09-3a714f35135f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SUPPLIERNAMESFDC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 71e7d75f-ddcc-4b4c-b8f7-4743f71f733b
                stepCounter: c7a2f9ae-61f5-41f3-8e70-0eab0ad393d6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53051d70-6968-49e5-99a5-6716f57b6087
          stepCounter: 5ed7c73b-12ed-435b-bc09-3a714f35135f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the name of a supplier who owns a contract, as it exists from the source system. You probably want to use ReportingSupplierName instead.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SUPPLIERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 272a5c1c-6c39-4b59-ac18-359ec8775e06
                stepCounter: 9f5fdf04-d6f5-421b-90d1-773791a249c8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74547c3d-c372-4e8e-b7f5-c08094f65681
          stepCounter: 5ed7c73b-12ed-435b-bc09-3a714f35135f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the preferred, cleaned up name of the supplier. This is the one you want to use for reports
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: REPORTINGSUPPLIERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e87ede00-fc9f-4c9c-adbc-10805a02a046
                stepCounter: 9f5fdf04-d6f5-421b-90d1-773791a249c8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98dab9db-1a42-45fe-bbc8-a12f666e96e8
          stepCounter: 5ed7c73b-12ed-435b-bc09-3a714f35135f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PD_VP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 766730b2-6e02-464c-8eea-59041ad51901
                stepCounter: c7a2f9ae-61f5-41f3-8e70-0eab0ad393d6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c171c554-ad3e-47c7-8e20-ee01485a39f7
          stepCounter: 5ed7c73b-12ed-435b-bc09-3a714f35135f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PD_DIRECTOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7dd0833-6434-4700-8795-484b2845af68
                stepCounter: c7a2f9ae-61f5-41f3-8e70-0eab0ad393d6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38f875cd-9e81-4b8c-9633-6a689f70f527
          stepCounter: 5ed7c73b-12ed-435b-bc09-3a714f35135f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CONTRACTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4bef7e9c-11e5-4a1d-9e73-36f1757fdb54
                stepCounter: 60b39932-2692-4360-ae42-25e43379d6f6
            transform: IFNULL(Contract.ContractKey,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5cc4602-50dd-4251-b349-51e4202e23e6
          stepCounter: 5ed7c73b-12ed-435b-bc09-3a714f35135f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CONTRACTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 14562d41-7e91-47d4-aeb7-ab975af22fd0
                stepCounter: 7039146a-a34d-4da0-ab22-92e04fd3548b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 43ad01db-ac78-49a7-9958-c353032bca72
          stepCounter: 5ed7c73b-12ed-435b-bc09-3a714f35135f
        config: {}
        dataType: INT
        defaultValue: ""
        description: StageRevenueBudgetsPDHistory.BudgetDate=DimBudgetDate.BudgetDate
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: BUDGETDATEKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48601cdc-c1a2-4a30-87f6-4533985e72cf
                stepCounter: 608b285a-dc6a-4014-ae23-f707a432945a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 507f0180-fc25-48df-88df-b44fca0be85f
          stepCounter: 5ed7c73b-12ed-435b-bc09-3a714f35135f
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: BUDGETDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 690b0665-d569-4717-a91e-606f31c911e5
                stepCounter: 7039146a-a34d-4da0-ab22-92e04fd3548b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 018bdf9f-9e34-44ea-b0d0-fbac6668de26
          stepCounter: 5ed7c73b-12ed-435b-bc09-3a714f35135f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: BUDGETSALESAMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6666f98a-8d84-4ba5-8f9f-7bcbe1b1317c
                stepCounter: 7039146a-a34d-4da0-ab22-92e04fd3548b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86f80cd8-1f04-40e5-a7b6-a75e328c8a16
          stepCounter: 5ed7c73b-12ed-435b-bc09-3a714f35135f
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: BUDGETREVENUEAMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d602296-55d3-4aa0-ada1-760e801b1d00
                stepCounter: 7039146a-a34d-4da0-ab22-92e04fd3548b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d32a321-300a-4500-87fc-7ae72fea5511
          stepCounter: 5ed7c73b-12ed-435b-bc09-3a714f35135f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Record source.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f1f1207-8006-4f93-9f3b-e96dd56e90b4
                stepCounter: 7039146a-a34d-4da0-ab22-92e04fd3548b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 383f81ce-534d-4171-95f8-544d7f189a12
          stepCounter: 5ed7c73b-12ed-435b-bc09-3a714f35135f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Load date.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 881095d8-a4e2-43fd-a434-d7ee5ae9bd7d
                stepCounter: 7039146a-a34d-4da0-ab22-92e04fd3548b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 046ec05a-a41f-455e-8bcf-5f1eb7cb88d4
          stepCounter: 5ed7c73b-12ed-435b-bc09-3a714f35135f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b384f24-bcea-447c-a136-49d7b6569b90
          stepCounter: 5ed7c73b-12ed-435b-bc09-3a714f35135f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOADREVENUEBUDGETSPD: 7039146a-a34d-4da0-ab22-92e04fd3548b
          CONTRACT: 60b39932-2692-4360-ae42-25e43379d6f6
          SUPPLIER: 9f5fdf04-d6f5-421b-90d1-773791a249c8
          SUPPLIERPDHISTORY: c7a2f9ae-61f5-41f3-8e70-0eab0ad393d6
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: CONTRACT
          - locationName: DIM
            nodeName: DIMBUDGETDATE
          - locationName: DIM
            nodeName: SUPPLIER
          - locationName: DIM
            nodeName: SUPPLIERPDHISTORY
          - locationName: LOAD
            nodeName: LOADREVENUEBUDGETSPD
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOADREVENUEBUDGETSPD') }} LoadRevenueBudgetsPD
              LEFT JOIN {{ ref('DIM','CONTRACT') }} Contract
                ON LoadRevenueBudgetsPD.ContractId = Contract.ContractId
              LEFT JOIN {{ ref('DIM','SUPPLIER') }} Supplier
                ON Contract.SupplierKey = Supplier.SupplierKey
              LEFT JOIN {{ ref('DIM','SUPPLIERPDHISTORY') }} SupplierPDHistory
                ON Contract.SupplierKey = SupplierPDHistory.SupplierKey
               AND LoadRevenueBudgetsPD.BudgetDate BETWEEN SupplierPDHistory.StartDate AND SupplierPDHistory.EndDate
        name: STAGEREVENUEBUDGETSPDHISTORY
        noLinkRefs: []
  name: STAGEREVENUEBUDGETSPDHISTORY
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
