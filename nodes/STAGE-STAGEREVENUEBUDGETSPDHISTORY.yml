fileVersion: 1
id: a71a244b-c214-4546-8e6b-1f1ea6729cf3
name: STAGEREVENUEBUDGETSPDHISTORY
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "SEE NOTES"
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 504d8f21-febb-4e85-88c8-3675f7e4de55
          stepCounter: a71a244b-c214-4546-8e6b-1f1ea6729cf3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: SUPPLIERPDHISTORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: babfa943-fc52-448c-bece-56a1674be119
                stepCounter: ba839dcf-ee77-4903-a823-892e62b3e7d1
            transform: IFNULL(SUPPLIERPDHISTORY.SUPPLIERPDHISTORYKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dbf1a14e-ba49-4a8a-bc4e-bc2883a957fa
          stepCounter: a71a244b-c214-4546-8e6b-1f1ea6729cf3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGECONTRACT_ADDKEYS.SUPPLIERID=SUPPLIER.SUPPLIERID
        name: SUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ddcfa98-9457-429a-934c-5d263e6bb527
                stepCounter: 930a330f-3276-4f21-bd05-9ed55fd63528
            transform: IFNULL(CONTRACT.SUPPLIERKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b2ab472-02ab-4609-9ec9-741a1eb94c28
          stepCounter: a71a244b-c214-4546-8e6b-1f1ea6729cf3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e720d4e6-cec9-4e42-a4b7-e293f66612b1
                stepCounter: 930a330f-3276-4f21-bd05-9ed55fd63528
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6795f5e-6b18-4eaf-b6e3-97d7d7da8250
          stepCounter: a71a244b-c214-4546-8e6b-1f1ea6729cf3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SUPPLIERNAMESFDC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9b9e0a05-cda0-47d6-b744-2fabb43b94ad
                stepCounter: ba839dcf-ee77-4903-a823-892e62b3e7d1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54111a4f-18bf-410c-a8c7-02c935750559
          stepCounter: a71a244b-c214-4546-8e6b-1f1ea6729cf3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE NAME OF A SUPPLIER WHO OWNS A CONTRACT, AS IT EXISTS FROM THE SOURCE SYSTEM. YOU PROBABLY WANT TO USE REPORTINGSUPPLIERNAME INSTEAD.
        name: SUPPLIERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f50c6b22-26f9-48a3-87d3-a5cbd15e3146
                stepCounter: 46ab7310-f206-4d38-93fc-0dcfb497301d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27527485-d665-49e1-ad60-d59f911cd444
          stepCounter: a71a244b-c214-4546-8e6b-1f1ea6729cf3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE PREFERRED, CLEANED UP NAME OF THE SUPPLIER. THIS IS THE ONE YOU WANT TO USE FOR REPORTS
        name: REPORTINGSUPPLIERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 31c1b4fe-3d3b-4797-a3f6-bcbe9f79c947
                stepCounter: 46ab7310-f206-4d38-93fc-0dcfb497301d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a7568ee-5016-4276-8bf2-4dd4648acb0d
          stepCounter: a71a244b-c214-4546-8e6b-1f1ea6729cf3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PD_VP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c33338c-6966-4e61-b24a-8e473b82dff3
                stepCounter: ba839dcf-ee77-4903-a823-892e62b3e7d1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ed6fd4a-693c-4d3f-bff9-1bf4861ee47e
          stepCounter: a71a244b-c214-4546-8e6b-1f1ea6729cf3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PD_DIRECTOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dbab0063-7324-43b6-9a84-77cff0346328
                stepCounter: ba839dcf-ee77-4903-a823-892e62b3e7d1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7befe5f0-4dde-428b-b5c5-af51fda9c74e
          stepCounter: a71a244b-c214-4546-8e6b-1f1ea6729cf3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: CONTRACTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 012a8445-b992-4874-a802-ad1b6196a28d
                stepCounter: 930a330f-3276-4f21-bd05-9ed55fd63528
            transform: IFNULL(CONTRACT.CONTRACTKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee0e3dd3-66d5-4a36-ba4e-0a166fa3e5d2
          stepCounter: a71a244b-c214-4546-8e6b-1f1ea6729cf3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CONTRACTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3c9d8246-1c7f-43a6-a0e2-bad656a1a5c0
                stepCounter: 83f1dc59-e567-4e87-a238-9428e10feadf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 36a679ac-c478-4d8a-9353-54f3a3c58d39
          stepCounter: a71a244b-c214-4546-8e6b-1f1ea6729cf3
        config: {}
        dataType: INT
        defaultValue: ""
        description: STAGEREVENUEBUDGETSPDHISTORY.BUDGETDATE=DIMBUDGETDATE.BUDGETDATE
        name: BUDGETDATEKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7b85210-6802-44d7-b3cd-d4123f77ad4e
                stepCounter: 64797b99-919d-44e8-9897-e768b1d377bc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf9fcc3b-2767-4683-9a68-f7e6bdfab3e8
          stepCounter: a71a244b-c214-4546-8e6b-1f1ea6729cf3
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: BUDGETDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9fabaedf-774d-4f55-b524-8151210b05c8
                stepCounter: 83f1dc59-e567-4e87-a238-9428e10feadf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 856fcd43-a546-4a09-b96a-2c14af43e048
          stepCounter: a71a244b-c214-4546-8e6b-1f1ea6729cf3
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BUDGETSALESAMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc5af8e2-7111-48e4-88a4-7932ec53d698
                stepCounter: 83f1dc59-e567-4e87-a238-9428e10feadf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 150880b3-c7f6-4889-a149-0e9ea35efca1
          stepCounter: a71a244b-c214-4546-8e6b-1f1ea6729cf3
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: BUDGETREVENUEAMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e910df0-f1fe-4adb-8396-1a69ba947204
                stepCounter: 83f1dc59-e567-4e87-a238-9428e10feadf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d0fdd96-8434-4dab-9104-8235b5f125d0
          stepCounter: a71a244b-c214-4546-8e6b-1f1ea6729cf3
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4015c7e-9680-4577-b328-c1f58297d4e3
                stepCounter: 83f1dc59-e567-4e87-a238-9428e10feadf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f222fea-2a06-4d27-a06a-92c0ef01cc14
          stepCounter: a71a244b-c214-4546-8e6b-1f1ea6729cf3
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2e5b883f-d317-48a1-b543-0059e3238cfc
                stepCounter: 83f1dc59-e567-4e87-a238-9428e10feadf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d5c622b-9e44-41cb-9c0d-8d801a60ac72
          stepCounter: a71a244b-c214-4546-8e6b-1f1ea6729cf3
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fdacca03-a935-47e8-a0b2-07dc8b808224
          stepCounter: a71a244b-c214-4546-8e6b-1f1ea6729cf3
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOADREVENUEBUDGETSPD: 83f1dc59-e567-4e87-a238-9428e10feadf
          CONTRACT: 930a330f-3276-4f21-bd05-9ed55fd63528
          SUPPLIER: 46ab7310-f206-4d38-93fc-0dcfb497301d
          SUPPLIERPDHISTORY: ba839dcf-ee77-4903-a823-892e62b3e7d1
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: CONTRACT
          - locationName: DIM
            nodeName: DIMBUDGETDATE
          - locationName: DIM
            nodeName: SUPPLIER
          - locationName: DIM
            nodeName: SUPPLIERPDHISTORY
          - locationName: LOAD
            nodeName: LOADREVENUEBUDGETSPD
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOADREVENUEBUDGETSPD') }} LOADREVENUEBUDGETSPD
              LEFT JOIN {{ ref('DIM','CONTRACT') }} CONTRACT
                ON LOADREVENUEBUDGETSPD.CONTRACTID = CONTRACT.CONTRACTID
              LEFT JOIN {{ ref('DIM','SUPPLIER') }} SUPPLIER
                ON CONTRACT.SUPPLIERKEY = SUPPLIER.SUPPLIERKEY
              LEFT JOIN {{ ref('DIM','SUPPLIERPDHISTORY') }} SUPPLIERPDHISTORY
                ON CONTRACT.SUPPLIERKEY = SUPPLIERPDHISTORY.SUPPLIERKEY
               AND LOADREVENUEBUDGETSPD.BUDGETDATE BETWEEN SUPPLIERPDHISTORY.STARTDATE AND SUPPLIERPDHISTORY.ENDDATE
        name: STAGEREVENUEBUDGETSPDHISTORY
        noLinkRefs: []
  name: STAGEREVENUEBUDGETSPDHISTORY
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
