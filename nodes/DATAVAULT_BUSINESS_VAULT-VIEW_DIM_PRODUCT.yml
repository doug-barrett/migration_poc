fileVersion: 1
id: ca82f1d4-e43d-49d1-930a-d00694eed8b5
name: VIEW_DIM_PRODUCT
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DATAVAULT_BUSINESS_VAULT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49a1649e-7d5a-4e66-9b0b-c470af0bba09
          stepCounter: ca82f1d4-e43d-49d1-930a-d00694eed8b5
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PRODUCT_NK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: efe5c794-fed1-4406-8c0c-ff6ec4a76f5b
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41b580ff-6ae8-4822-ad2d-58a33cd87c43
          stepCounter: ca82f1d4-e43d-49d1-930a-d00694eed8b5
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PRODUCT_PREFIX_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: efe5c794-fed1-4406-8c0c-ff6ec4a76f5b
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57f3447c-ac7e-477a-8841-c0e276b3cdcb
          stepCounter: ca82f1d4-e43d-49d1-930a-d00694eed8b5
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: PRODUCT_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90b9804a-64fd-4ff1-94cc-a038e0a9d084
                stepCounter: e71cd662-66e1-41df-87d8-3956421a8a55
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74dfd6cd-59ec-4424-af52-e14c044291e0
          stepCounter: ca82f1d4-e43d-49d1-930a-d00694eed8b5
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: PRODUCT_LEGACY_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9eddfaea-a450-4b73-8e35-014df78e5093
                stepCounter: a7b71ff1-4cf2-4634-be64-da33a08caffd
            transform: NVL(pls.product_legacy_status, '-1')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e20337cf-7f32-4558-b114-acbc54ee3f11
          stepCounter: ca82f1d4-e43d-49d1-930a-d00694eed8b5
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: PRODUCT_PLATFORM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c8cd5e9-49ef-47d5-a396-7c2d8797fa76
                stepCounter: a7a0d476-8fae-4b75-ab88-2fcaecbb8118
            transform: |-
              CASE WHEN LEFT(dms.terminal_id,2) = '66' THEN 'VIRTUAL'
                          ELSE 'PHYSICAL'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff07361a-040d-4ee7-98ff-4bf92baef63a
          stepCounter: ca82f1d4-e43d-49d1-930a-d00694eed8b5
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: PRODUCT_TYPE
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 528077a8-cede-46aa-b688-5b2f54e9ef43
          stepCounter: ca82f1d4-e43d-49d1-930a-d00694eed8b5
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        name: TMS_ENABLED
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7afbe687-0359-43a8-9e19-62a2717ac554
          stepCounter: ca82f1d4-e43d-49d1-930a-d00694eed8b5
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: DCC_SUPPORTED
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'Logic TBC'"
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_POS_TYPE_MROC: e71cd662-66e1-41df-87d8-3956421a8a55
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATAVAULT_BUSINESS_VAULT
            nodeName: REF_PRODUCT_LEGACY_STATUS
          - locationName: DATAVAULT_RAW_VAULT
            nodeName: S_DMS_TERMINAL_ALLOCATION_LOG_MROC
          - locationName: DATAVAULT_RAW_VAULT
            nodeName: S_POS_TYPE_MROC
        join:
          joinCondition: FROM {{ ref('DATAVAULT_RAW_VAULT','S_POS_TYPE_MROC') }}
        name: VIEW_DIM_PRODUCT
        noLinkRefs: []
  name: VIEW_DIM_PRODUCT
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
