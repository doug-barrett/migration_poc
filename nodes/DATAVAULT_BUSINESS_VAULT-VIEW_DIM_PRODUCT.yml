fileVersion: 1
id: 3e862ca1-d10b-437c-a046-e9698b3a4b07
name: VIEW_DIM_PRODUCT
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DATAVAULT_BUSINESS_VAULT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b84c2ead-ef21-4da7-aea9-0acccfe00925
          stepCounter: 3e862ca1-d10b-437c-a046-e9698b3a4b07
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PRODUCT_NK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c1af8595-0c16-46e0-814d-6832a61d57d5
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05a78393-eea1-4c73-9361-afdbda6258c6
          stepCounter: 3e862ca1-d10b-437c-a046-e9698b3a4b07
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PRODUCT_PREFIX_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c1af8595-0c16-46e0-814d-6832a61d57d5
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f63e1855-c9e8-436a-82d1-b3771061d52d
          stepCounter: 3e862ca1-d10b-437c-a046-e9698b3a4b07
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: PRODUCT_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d85751b5-1328-4f11-9c8a-47c1c7453227
                stepCounter: 60a7d36a-d509-4601-b614-5f984e74d7f4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80066ce6-b030-40e3-98b8-58792f621d80
          stepCounter: 3e862ca1-d10b-437c-a046-e9698b3a4b07
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: PRODUCT_LEGACY_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4cb0fbd3-ed04-46b3-bf58-c5d8e9277909
                stepCounter: f3c501ab-743f-4501-b4c0-c339ef675328
            transform: NVL(pls.product_legacy_status, '-1')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74313d6e-2a6a-491b-913a-f5179a9cdb18
          stepCounter: 3e862ca1-d10b-437c-a046-e9698b3a4b07
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: PRODUCT_PLATFORM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2a6d477f-cb58-45bb-a4b0-e242e60b4faf
                stepCounter: e6bdec0f-b788-47ba-8325-a1d65d457ad9
            transform: |-
              CASE WHEN LEFT(dms.terminal_id,2) = '66' THEN 'VIRTUAL'
                          ELSE 'PHYSICAL'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79441147-7513-41f6-83d0-be457b0ce00f
          stepCounter: 3e862ca1-d10b-437c-a046-e9698b3a4b07
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: PRODUCT_TYPE
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b3d5c2c1-29cb-4898-8ee5-c2d0e46b45d6
          stepCounter: 3e862ca1-d10b-437c-a046-e9698b3a4b07
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        name: TMS_ENABLED
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e98fa66-8b8f-4a59-9eb3-34d14e22c2c5
          stepCounter: 3e862ca1-d10b-437c-a046-e9698b3a4b07
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: DCC_SUPPORTED
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'Logic TBC'"
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_POS_TYPE_MROC: 60a7d36a-d509-4601-b614-5f984e74d7f4
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATAVAULT_BUSINESS_VAULT
            nodeName: REF_PRODUCT_LEGACY_STATUS
          - locationName: DATAVAULT_RAW_VAULT
            nodeName: S_DMS_TERMINAL_ALLOCATION_LOG_MROC
          - locationName: DATAVAULT_RAW_VAULT
            nodeName: S_POS_TYPE_MROC
        join:
          joinCondition: FROM {{ ref('DATAVAULT_RAW_VAULT','S_POS_TYPE_MROC') }}
        name: VIEW_DIM_PRODUCT
        noLinkRefs: []
  name: VIEW_DIM_PRODUCT
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
