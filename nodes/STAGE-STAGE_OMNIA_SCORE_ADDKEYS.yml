fileVersion: 1
id: 5474caad-d682-4700-a383-c44766ffe14a
name: STAGE_OMNIA_SCORE_ADDKEYS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "THIS STAGE FILTERS OUT THE INACTIVE OMNIA SCORE RECORDS USING CONDITION BELOW.\n\nWHERE DSOMNIA_SCORE.MAXRECEIPTDATE = '$ACTIVEDATEFOROMNIASCORE'\n"
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7b90d2a-9524-4cae-a3ee-9bedb32505eb
          stepCounter: 5474caad-d682-4700-a383-c44766ffe14a
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 80b781f1-5417-4505-9ec7-3723e83e70e2
                stepCounter: 21dc5769-5992-4d41-ae94-340c857ac487
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1326d3c9-e680-4bd1-ae76-a53a35d7cfc2
          stepCounter: 5474caad-d682-4700-a383-c44766ffe14a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: OMNIA_SCORE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9727ec3e-caed-4e64-b9a0-2232dc1d1b7d
                stepCounter: 21dc5769-5992-4d41-ae94-340c857ac487
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9aad301c-9d46-4daf-a4b5-5ecf271b1f3b
          stepCounter: 5474caad-d682-4700-a383-c44766ffe14a
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: MAXRECEIPTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5658d4a8-a83c-4829-965a-6e2ef7921b99
                stepCounter: 21dc5769-5992-4d41-ae94-340c857ac487
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 838ae064-5425-4cfc-8f13-40e0257c9b0a
          stepCounter: 5474caad-d682-4700-a383-c44766ffe14a
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4d704439-5fcc-413f-8a19-290cc0dcc9df
                stepCounter: 21dc5769-5992-4d41-ae94-340c857ac487
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07ab20dc-ce2a-4c80-bc6d-09393e51941c
          stepCounter: 5474caad-d682-4700-a383-c44766ffe14a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a0c3e82b-406a-4b72-ad41-2ee63d8b7dc7
                stepCounter: 21dc5769-5992-4d41-ae94-340c857ac487
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d5b11fe-f6d0-43e7-98f7-5a0b79d3a529
          stepCounter: 5474caad-d682-4700-a383-c44766ffe14a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEOMNIA_SCORE_ADDKEYS.LEVEL1FORCEID=ACCOUNT.FORCEID
        name: ACCOUNTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b17fba0-9db5-4ba8-9eeb-d24027f151eb
                stepCounter: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c8b98e8-4e94-4802-abb0-53dd79fa7931
          stepCounter: 5474caad-d682-4700-a383-c44766ffe14a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c4f38ea-5fc9-4929-bb7c-2b8cd9d3544e
          stepCounter: 5474caad-d682-4700-a383-c44766ffe14a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DS_OMNIA_SCORE: 21dc5769-5992-4d41-ae94-340c857ac487
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: ODS
            nodeName: DS_OMNIA_SCORE
        join:
          joinCondition: |-
            FROM {{ ref('ODS','DS_OMNIA_SCORE') }} DS_OMNIA_SCORE
             WHERE DS_OMNIA_SCORE.MAXRECEIPTDATE = '$ACTIVEDATEFOROMNIASCORE'
        name: STAGEOMNIA_SCORE_ADDKEYS
        noLinkRefs: []
  name: STAGE_OMNIA_SCORE_ADDKEYS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
