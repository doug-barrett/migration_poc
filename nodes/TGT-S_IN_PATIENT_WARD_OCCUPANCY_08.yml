fileVersion: 1
id: b73d77ff-a7bc-4519-8dd3-2538e3b3242a
name: S_IN_PATIENT_WARD_OCCUPANCY_08
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Materialise s_inpatient_ward_occupancy_v for those stay dates found in s_inpatient_changes."
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59f516c1-5535-4e79-ad91-d755275e0b22
          stepCounter: b73d77ff-a7bc-4519-8dd3-2538e3b3242a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: fact_inpatient_stay_detail.stay_ward_code=dim_ward.ward_code
        name: DIM_WARD_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e227c78d-00f9-440a-8fa2-b6722dfd06f5
                stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7b74e69-e5e0-4089-9f7d-9b58af27e9d6
          stepCounter: b73d77ff-a7bc-4519-8dd3-2538e3b3242a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: fact_inpatient_stay_detail.CONVERT(date,stay_calendar_date)=dim_date.calendar_date
        name: DIM_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc2fb2ed-9dce-4df2-ba18-a995a106bb6f
                stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d34afe1-d3be-424d-a50d-63fea0837bc9
          stepCounter: b73d77ff-a7bc-4519-8dd3-2538e3b3242a
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 12am (00:00:00)
        name: OCCUPANCY_TIME_SLOT_00
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8cfcebe7-6728-4d85-9990-69dfdd18b271
                stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ab7a670-3428-467c-ab03-20a881a1d78d
          stepCounter: b73d77ff-a7bc-4519-8dd3-2538e3b3242a
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 1am
        name: OCCUPANCY_TIME_SLOT_01
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24557891-e38c-4c29-8f04-52b7c2997562
                stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 749f1d30-7056-4f7e-9057-878fb7c2ea9e
          stepCounter: b73d77ff-a7bc-4519-8dd3-2538e3b3242a
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 2am
        name: OCCUPANCY_TIME_SLOT_02
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f2b32cc-b90b-49c4-9406-086a7f068f30
                stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 177082af-68b1-4430-9fe6-13607df556ed
          stepCounter: b73d77ff-a7bc-4519-8dd3-2538e3b3242a
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 3am
        name: OCCUPANCY_TIME_SLOT_03
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83058298-4a53-4cb0-a0de-e5e78c9f393f
                stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be2f28dd-b4d9-4c60-9104-20f07d6578ee
          stepCounter: b73d77ff-a7bc-4519-8dd3-2538e3b3242a
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 4am
        name: OCCUPANCY_TIME_SLOT_04
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91c382ce-547c-479d-a4c3-57ae93a1783e
                stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e302ebc0-3339-44be-b0dc-2f2054c6701c
          stepCounter: b73d77ff-a7bc-4519-8dd3-2538e3b3242a
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 5am
        name: OCCUPANCY_TIME_SLOT_05
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5b7e67dc-97dd-430d-b888-dcaa4f698509
                stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72ee61c4-d2ea-4ade-8ba1-52b8014822b3
          stepCounter: b73d77ff-a7bc-4519-8dd3-2538e3b3242a
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 6am
        name: OCCUPANCY_TIME_SLOT_06
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2762251d-086c-4113-beb6-0b19b1729066
                stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3d77240-22b6-4b58-96d2-14720dee0780
          stepCounter: b73d77ff-a7bc-4519-8dd3-2538e3b3242a
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 7am
        name: OCCUPANCY_TIME_SLOT_07
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f86a17d7-4539-4c48-87ac-0b1770ad1726
                stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f514cd2-2362-42bb-acbd-cfe05b24b446
          stepCounter: b73d77ff-a7bc-4519-8dd3-2538e3b3242a
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 8am
        name: OCCUPANCY_TIME_SLOT_08
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dd36560d-82c0-47a9-aa4a-df29b578f449
                stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b92190b1-8ce0-436a-94ea-66e0693e258a
          stepCounter: b73d77ff-a7bc-4519-8dd3-2538e3b3242a
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 9am
        name: OCCUPANCY_TIME_SLOT_09
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ab5ddd5-2906-4b7f-93ae-63af1d202b01
                stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7c183c8-6eeb-4133-96ff-9f6c608e6e86
          stepCounter: b73d77ff-a7bc-4519-8dd3-2538e3b3242a
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 10am
        name: OCCUPANCY_TIME_SLOT_10
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e32d5a6a-5dfc-45d3-9d9d-af7a0285c024
                stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc2c9828-8e60-41f6-a858-0b0a46ecbb56
          stepCounter: b73d77ff-a7bc-4519-8dd3-2538e3b3242a
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 11am
        name: OCCUPANCY_TIME_SLOT_11
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2e13ff2f-774d-471a-b3b3-60d84a017011
                stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f95d4f11-bea0-4c21-bd50-4a2cf29fa631
          stepCounter: b73d77ff-a7bc-4519-8dd3-2538e3b3242a
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 12pm (12:00:00)
        name: OCCUPANCY_TIME_SLOT_12
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9aea7d95-62c6-40e9-b45e-ad24c3ccb918
                stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e5f3642-96b7-4bf6-a49f-94eec651b3ce
          stepCounter: b73d77ff-a7bc-4519-8dd3-2538e3b3242a
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 1pm
        name: OCCUPANCY_TIME_SLOT_13
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e162ca1-2d38-4ccf-bbd7-b57eba5d05a7
                stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba58cda8-d4d9-4f2c-9039-0aa248bd40d5
          stepCounter: b73d77ff-a7bc-4519-8dd3-2538e3b3242a
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 2pm
        name: OCCUPANCY_TIME_SLOT_14
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1662ed26-757e-4af0-a055-d5e482d4b1f0
                stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5746f7f-d852-4e80-acd4-b4357f80f502
          stepCounter: b73d77ff-a7bc-4519-8dd3-2538e3b3242a
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 3pm
        name: OCCUPANCY_TIME_SLOT_15
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 373dc638-b788-4ab8-ac2c-bbe236a15bae
                stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eeee79ef-3351-481b-a4bc-b2c262ac69f7
          stepCounter: b73d77ff-a7bc-4519-8dd3-2538e3b3242a
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 4pm
        name: OCCUPANCY_TIME_SLOT_16
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c6610f2-ad53-4e06-b3f2-87f649b7b4bd
                stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 947d093d-8eac-4f99-9cf5-c6b07c6022b1
          stepCounter: b73d77ff-a7bc-4519-8dd3-2538e3b3242a
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 5pm
        name: OCCUPANCY_TIME_SLOT_17
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 583b9797-0602-4bb5-9274-1d94a4156649
                stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3f48309-a73d-4bca-af22-4112a609ff43
          stepCounter: b73d77ff-a7bc-4519-8dd3-2538e3b3242a
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 6pm
        name: OCCUPANCY_TIME_SLOT_18
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3305cd8-b554-4b0d-b9ee-6de994cc2b19
                stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 312ccc60-9971-48cc-afd0-8650d75834f5
          stepCounter: b73d77ff-a7bc-4519-8dd3-2538e3b3242a
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 7pm
        name: OCCUPANCY_TIME_SLOT_19
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: df182a36-c5ec-4240-b044-40fb995d75cf
                stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0aaafb74-262d-44b2-b37c-a6d98ec49c68
          stepCounter: b73d77ff-a7bc-4519-8dd3-2538e3b3242a
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 8pm
        name: OCCUPANCY_TIME_SLOT_20
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76d28660-7ea3-4b10-9009-7c966b70c769
                stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55a07707-7e92-4c9e-9284-327470929e60
          stepCounter: b73d77ff-a7bc-4519-8dd3-2538e3b3242a
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 9pm
        name: OCCUPANCY_TIME_SLOT_21
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 897f871c-32ad-43cb-9b84-7cb9209fc8cc
                stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8de34ba-fe21-448f-a78e-2724cbcaf848
          stepCounter: b73d77ff-a7bc-4519-8dd3-2538e3b3242a
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 10pm
        name: OCCUPANCY_TIME_SLOT_22
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a7e8fd0a-3ac9-4b90-8db4-5238accb02eb
                stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e10b7abb-3c72-4335-acc7-9d7ea650c207
          stepCounter: b73d77ff-a7bc-4519-8dd3-2538e3b3242a
        config: {}
        dataType: INT
        defaultValue: ""
        description: 1 if the patient was in this location at 11pm
        name: OCCUPANCY_TIME_SLOT_23
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3bfb08fb-5369-4fa9-bea0-bf47314a26bf
                stepCounter: 0566bce5-6569-488d-8b3b-85b7aa421840
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b930f3cb-1b34-4776-a131-508c2e0c2cf2
          stepCounter: b73d77ff-a7bc-4519-8dd3-2538e3b3242a
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_INPATIENT_WARD_OCCUPANCY_V
        join:
          joinCondition: |-
            FROM s_Inpatient_Ward_Occupancy_v
             WHERE dim_date_key >= (
                    SELECT CONVERT(int, CONVERT(varchar, MIN(start_dttm), 112))
                      FROM ds_pims_service_point_stays
                     WHERE dss_update_time > @v_pa_inpatient_incremental
                   )
        name: S_IN_PATIENT_WARD_OCCUPANCY_08
        noLinkRefs: []
  name: S_IN_PATIENT_WARD_OCCUPANCY_08
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
