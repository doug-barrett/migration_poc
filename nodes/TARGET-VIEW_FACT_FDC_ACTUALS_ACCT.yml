fileVersion: 1
id: fc829100-0893-490d-967c-0b85a7779d98
name: VIEW_FACT_FDC_ACTUALS_ACCT
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9d81463-2612-4d6c-8930-ce2b9b63ffc6
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: ENTITY_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ab7b78f-8306-4e4d-962d-04858bd9df7d
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SCENARIO_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64505e7a-e03d-4e48-b3e0-087271adbf1d
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: NUMBER(1)
        defaultValue: ""
        description: ""
        name: GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e3b1d18-6f7b-4541-9bad-b47fd340c293
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACTIVITY_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 624d7ab7-ebea-4269-bbad-d431fe085816
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: ACTIVITY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1dfb754c-62ae-472e-b448-d3b588e25c31
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NORMALIZED_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55a28181-bf24-4df9-b400-04bee1ee7fe3
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRODUCING_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 297b0066-8eeb-4774-a4ca-6d78eef4a4ca
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ON_PROD_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3ef37d6-3fd6-4a22-962f-a31390fbd2e2
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59ca9e4b-0e45-4abb-a413-20fbafb6fd32
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: HOURS_ON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b45156db-b771-43c8-acf6-952ad4597a40
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: HOURS_DOWN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd676e97-3c49-4e74-8b4d-6062fae1b338
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: HCLIQ_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88fbab0e-3bba-45ff-be8b-2f0ce34d14bb
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: OIL_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aef3d6d4-4ec8-4b47-9717-15cbbb765bf8
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: OIL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d1e78151-fb20-47db-9bd2-7a7d5cc1c31c
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: OIL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 210db754-d8b9-492f-b87e-73a75f10eadb
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: CONDENSATE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b5292d7-a7e0-4236-8cbd-2569ebaaea51
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: CONDENSATE_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e79276c-b74f-4588-8eef-e7a0718ec90c
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: CONDENSATE_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dbe482fe-ce25-4ad4-a96a-76152d54b2e9
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: NGL_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06f738b5-0ffe-4405-a5bf-2a499e907d1a
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: NGL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9363e92e-6102-4356-a3de-5c6f6e9a105b
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: NGL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b421e293-ef36-486f-a543-5009d2dc689a
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb901e80-dcdb-46ca-9904-a4279b8ce9dd
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: GAS_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5482ada-00e0-4260-b4cf-0d140cf31871
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: GAS_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02f00a0f-4d27-49c8-9bf9-1ff9edbd91fa
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: GAS_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e17437c9-575f-4692-89ca-65dbd674cf7a
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bba2b94c-cf5d-444a-bd13-7a412c98fa30
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WATER_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15545182-cf96-4deb-ad57-39c19209eb78
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WATER_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18cc20aa-bf30-4ae8-8755-6747977b411a
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: SAND_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c68d73ab-3692-4fdc-8ec2-b2043c4ef79c
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5654062-3c7f-4ec1-a3d3-3f362e233400
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_HCLIQ_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e5c7f15-1da2-45ad-a4ea-2eafb2b2d06c
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_SAND_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b525a83-931c-4ec7-a105-ea4536615d53
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31716649-789b-491b-8d7e-5600d295099b
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: RECOVERED_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5980873-7301-4a28-b7dc-99c7d3ada35b
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: RECOVERED_HCLIQ_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 58968c83-7d8e-4639-9e3e-aacaa26988af
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: RECOVERED_SAND_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 156ec5a8-41ec-45af-8027-549f8112aadd
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: RECOVERED_WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 820721dc-e94c-43eb-bdb5-2929e932151f
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: REMAINING_LIFT_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2daacc5-afc7-4e35-9b71-a81354cdd8f4
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: REMAINING_LOAD_HCLIQ_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f8cd9e3-f4f4-4d6f-a070-767d89628595
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: REMAINING_LOAD_WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d88d70fa-adf7-496b-ac7a-a1d29a914e56
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: REMAINING_LOAD_SAND_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98ff1bc9-fefb-442f-a0ee-df4a90e75912
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: METHANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0138eb2-dfb6-45f6-a3a7-753d01125d17
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: METHANE_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab727ddb-9ff4-45ec-a5ac-ef86b724e42f
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: METHANE_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2243299-eba4-4f44-9c9e-e6b0a3db9643
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: ETHANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a4c8cb6-aa9f-420a-a25f-e6ba14f87c93
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: ETHANE_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0737822-0fbd-410f-9dc0-3a1e9f68d8ff
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: ETHANE_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95612e17-0e29-4deb-8ab6-23d2a3517f55
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: PROPANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb533989-7857-4a9e-aeba-5ef8788c4277
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: PROPANE_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb7e5d8b-f604-419d-95ed-2f417a8fa7ee
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: PROPANE_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 669ced49-700f-41fd-9e15-7f54a8d98aba
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: BUTANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6da9ef51-ae3a-43b9-93be-b06b1df4a30a
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: BUTANE_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de3771a9-f9c7-4399-9002-adcbcdcff1ae
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: BUTANE_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 971b7977-0d03-40cf-8223-48654df8bbf2
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: PENTANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ed25fb2-3471-491c-9e11-076b8da5f58d
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: PENTANE_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2de91211-d437-4fc7-8ced-898ccb1e6dc7
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: PENTANE_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ac015d7-7919-4a4c-be5f-3e3c42dc2e6e
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: FLAREGAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f681f6c8-ca8a-45f4-a10d-820adb3f104a
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: VENTGAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed438caa-2f63-4f4c-8900-205ae50978b4
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: FUELGAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7982463-6da1-4491-8507-c3819cc8131f
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WIGAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd49e254-ec3e-48f5-b57c-df2686fc11b0
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WIHCLIQ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f015fe39-9601-40c7-a0d8-214949463ce1
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WIWATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e504d4cb-609f-41a6-a6eb-5732f1974ead
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WISAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 619762ad-66ed-4489-945a-9cdfc4d67c8b
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: BAT_PRO_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 937894b7-90dd-44ba-83fa-18af15b7a0f5
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: BAT_PRO_GAS_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad31b329-d16f-4bb0-80d7-ad0a8c9d8995
          stepCounter: fc829100-0893-490d-967c-0b85a7779d98
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: BAT_PRO_GAS_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_FACT_FDC_ACTUALS_ACCT: fc829100-0893-490d-967c-0b85a7779d98
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_FACT_FDC_ACTUALS_ACCT') }} AS WITH PRODUCTS AS (
                    SELECT '20.1' AS GLOP_LINE_NO,
                           'OIL' AS PRODUCT
                 UNION ALL SELECT '20.2' AS GLOP_LINE_NO,
                           'CON' AS PRODUCT
                 UNION ALL SELECT '20.3' AS GLOP_LINE_NO,
                           'NGL' AS PRODUCT
                 UNION ALL SELECT '20.4' AS GLOP_LINE_NO,
                           'GAS' AS PRODUCT
                   ),
                   VOL AS (
                    SELECT DD.DIM_DATE_KEY AS DIM_ACTVY_PER_DATE_KEY,
                           DD.FULL_DATE AS DIM_ACTVY_PER_DATE,
                           F.DIM_COST_CENTER_KEY,
                           F.DIM_PRODUCT_TYPE_KEY,
                           CASE WHEN F.GROSS_OR_NET_CODE = 'G' THEN 1
                                ELSE 2
                                 END AS GROSS_NET_KEY,
                           (SUM(F.LI_VOL_M3) / DAY(LAST_DAY(DD.FULL_DATE))) * -1 AS VOL,
                           P.PRODUCT || '_METRIC' AS PRODUCT,
                           CC.CC_NUM AS CC_NUM
                      FROM WS_EDW.FACT_LO_QB_ACTUALS F
                      LEFT JOIN WS_EDW.DIM_LO_QB_PRODUCT_TYPE PROD
                        ON F.DIM_PRODUCT_TYPE_KEY = PROD.DIM_PRODUCT_TYPE_KEY
                      LEFT JOIN WS_EDW.DIM_LO_QB_COST_CENTER CC
                        ON F.DIM_COST_CENTER_KEY = CC.DIM_COST_CENTER_KEY
                      JOIN PRODUCTS P
                        ON F.GLOP_LINE_NO = P.GLOP_LINE_NO
                      JOIN (
                            SELECT DIM_ACTIVITY_PERIOD_DATE_KEY AS DIM_DATE_KEY ,
                                   FULL_DATE ,
                                   TO_CHAR(LAST_DAY(DATE_TRUNC(MONTH, FULL_DATE)), 'YYYYMMDD') AS FIRST_DATE_KEY
                              FROM WS_EDW.DIM_FDC_ACTIVITY_PERIOD_DATE
                           ) DD
                        ON TO_CHAR(F.DIM_ACCT_PER_DATE, 'YYYYMMDD') = DD.FIRST_DATE_KEY
                     WHERE NVL(F.LI_VOL, 0) != 0
                       AND F.DIM_PRODUCT_TYPE_KEY != 0
                       AND F.DIM_ACCT_PER_DATE IS NOT NULL
                     GROUP BY DD.DIM_DATE_KEY,
                              DD.FULL_DATE,
                              F.DIM_COST_CENTER_KEY,
                              F.DIM_PRODUCT_TYPE_KEY,
                              F.DIM_ACCT_PER_DATE,
                              F.GROSS_OR_NET_CODE,
                              P.PRODUCT,
                              CC.CC_NUM
                 UNION ALL SELECT DD.DIM_DATE_KEY AS DIM_ACTVY_PER_DATE_KEY,
                           DD.FULL_DATE AS DIM_ACTVY_PER_DATE,
                           F.DIM_COST_CENTER_KEY,
                           F.DIM_PRODUCT_TYPE_KEY,
                           CASE WHEN F.GROSS_OR_NET_CODE = 'G' THEN 1
                                ELSE 2
                                 END AS GROSS_NET_KEY,
                           (SUM(F.LI_VOL_M3) / DAY(LAST_DAY(DD.FULL_DATE))) * -1 AS VOL,
                           PROD.PROD_CODE || '_METRIC' AS PRODUCT,
                           CC.CC_NUM AS CC_NUM
                      FROM WS_EDW.FACT_LO_QB_ACTUALS F
                      LEFT JOIN WS_EDW.DIM_LO_QB_PRODUCT_TYPE PROD
                        ON F.DIM_PRODUCT_TYPE_KEY = PROD.DIM_PRODUCT_TYPE_KEY
                      LEFT JOIN WS_EDW.DIM_LO_QB_COST_CENTER CC
                        ON F.DIM_COST_CENTER_KEY = CC.DIM_COST_CENTER_KEY
                      JOIN PRODUCTS P
                        ON F.GLOP_LINE_NO = P.GLOP_LINE_NO
                      JOIN (
                            SELECT DIM_ACTIVITY_PERIOD_DATE_KEY AS DIM_DATE_KEY ,
                                   FULL_DATE ,
                                   TO_CHAR(LAST_DAY(DATE_TRUNC(MONTH, FULL_DATE)), 'YYYYMMDD') AS FIRST_DATE_KEY
                              FROM WS_EDW.DIM_FDC_ACTIVITY_PERIOD_DATE
                           ) DD
                        ON TO_CHAR(F.DIM_ACCT_PER_DATE, 'YYYYMMDD') = DD.FIRST_DATE_KEY
                     WHERE NVL(F.LI_VOL, 0) != 0
                       AND F.DIM_PRODUCT_TYPE_KEY != 0
                       AND PROD.PROD_CODE IN ('BUT', 'ETH', 'H20', 'PRO', 'PEN')
                       AND F.DIM_ACCT_PER_DATE IS NOT NULL
                     GROUP BY DD.DIM_DATE_KEY,
                              DD.FULL_DATE,
                              F.DIM_COST_CENTER_KEY,
                              F.DIM_PRODUCT_TYPE_KEY,
                              F.DIM_ACCT_PER_DATE,
                              F.GROSS_OR_NET_CODE,
                              CC.CC_NUM,
                              PROD.PROD_CODE
                 UNION ALL SELECT DD.DIM_DATE_KEY AS DIM_ACTVY_PER_DATE_KEY,
                           DD.FULL_DATE AS DIM_ACTVY_PER_DATE,
                           F.DIM_COST_CENTER_KEY,
                           F.DIM_PRODUCT_TYPE_KEY,
                           CASE WHEN F.GROSS_OR_NET_CODE = 'G' THEN 1
                                ELSE 2
                                 END AS GROSS_NET_KEY,
                           (SUM(F.LI_VOL_IMPERIAL) / DAY(LAST_DAY(DD.FULL_DATE))) * -1 AS VOL,
                           P.PRODUCT || '_IMPERIAL' AS PRODUCT,
                           CC.CC_NUM AS CC_NUM
                      FROM WS_EDW.FACT_LO_QB_ACTUALS F
                      LEFT JOIN WS_EDW.DIM_LO_QB_PRODUCT_TYPE PROD
                        ON F.DIM_PRODUCT_TYPE_KEY = PROD.DIM_PRODUCT_TYPE_KEY
                      LEFT JOIN WS_EDW.DIM_LO_QB_COST_CENTER CC
                        ON F.DIM_COST_CENTER_KEY = CC.DIM_COST_CENTER_KEY
                      JOIN PRODUCTS P
                        ON F.GLOP_LINE_NO = P.GLOP_LINE_NO
                      JOIN (
                            SELECT DIM_ACTIVITY_PERIOD_DATE_KEY AS DIM_DATE_KEY ,
                                   FULL_DATE ,
                                   TO_CHAR(LAST_DAY(DATE_TRUNC(MONTH, FULL_DATE)), 'YYYYMMDD') AS FIRST_DATE_KEY
                              FROM WS_EDW.DIM_FDC_ACTIVITY_PERIOD_DATE
                           ) DD
                        ON TO_CHAR(F.DIM_ACCT_PER_DATE, 'YYYYMMDD') = DD.FIRST_DATE_KEY
                     WHERE NVL(F.LI_VOL, 0) != 0
                       AND F.DIM_PRODUCT_TYPE_KEY != 0
                       AND F.DIM_ACCT_PER_DATE IS NOT NULL
                     GROUP BY DD.DIM_DATE_KEY,
                              DD.FULL_DATE,
                              F.DIM_COST_CENTER_KEY,
                              F.DIM_PRODUCT_TYPE_KEY,
                              F.DIM_ACCT_PER_DATE,
                              F.GROSS_OR_NET_CODE,
                              P.PRODUCT,
                              CC.CC_NUM
                 UNION ALL SELECT DD.DIM_DATE_KEY AS DIM_ACTVY_PER_DATE_KEY,
                           DD.FULL_DATE AS DIM_ACTVY_PER_DATE,
                           F.DIM_COST_CENTER_KEY,
                           F.DIM_PRODUCT_TYPE_KEY,
                           CASE WHEN F.GROSS_OR_NET_CODE = 'G' THEN 1
                                ELSE 2
                                 END AS GROSS_NET_KEY,
                           (SUM(F.LI_VOL_IMPERIAL) / DAY(LAST_DAY(DD.FULL_DATE))) * -1 AS VOL,
                           PROD.PROD_CODE || '_IMPERIAL' AS PRODUCT,
                           CC.CC_NUM AS CC_NUM
                      FROM WS_EDW.FACT_LO_QB_ACTUALS F
                      LEFT JOIN WS_EDW.DIM_LO_QB_PRODUCT_TYPE PROD
                        ON F.DIM_PRODUCT_TYPE_KEY = PROD.DIM_PRODUCT_TYPE_KEY
                      LEFT JOIN WS_EDW.DIM_LO_QB_COST_CENTER CC
                        ON F.DIM_COST_CENTER_KEY = CC.DIM_COST_CENTER_KEY
                      JOIN PRODUCTS P
                        ON F.GLOP_LINE_NO = P.GLOP_LINE_NO
                      JOIN (
                            SELECT DIM_ACTIVITY_PERIOD_DATE_KEY AS DIM_DATE_KEY ,
                                   FULL_DATE ,
                                   TO_CHAR(LAST_DAY(DATE_TRUNC(MONTH, FULL_DATE)), 'YYYYMMDD') AS FIRST_DATE_KEY
                              FROM WS_EDW.DIM_FDC_ACTIVITY_PERIOD_DATE
                           ) DD
                        ON TO_CHAR(F.DIM_ACCT_PER_DATE, 'YYYYMMDD') = DD.FIRST_DATE_KEY
                     WHERE NVL(F.LI_VOL, 0) != 0
                       AND F.DIM_PRODUCT_TYPE_KEY != 0
                       AND PROD.PROD_CODE IN ('BUT', 'ETH', 'H20', 'PRO', 'PEN')
                       AND F.DIM_ACCT_PER_DATE IS NOT NULL
                     GROUP BY DD.DIM_DATE_KEY,
                              DD.FULL_DATE,
                              F.DIM_COST_CENTER_KEY,
                              F.DIM_PRODUCT_TYPE_KEY,
                              F.DIM_ACCT_PER_DATE,
                              F.GROSS_OR_NET_CODE,
                              CC.CC_NUM,
                              PROD.PROD_CODE
                 UNION ALL SELECT DD.DIM_DATE_KEY AS DIM_ACTVY_PER_DATE_KEY,
                           DD.FULL_DATE AS DIM_ACTVY_PER_DATE,
                           F.DIM_COST_CENTER_KEY,
                           F.DIM_PRODUCT_TYPE_KEY,
                           CASE WHEN F.GROSS_OR_NET_CODE = 'G' THEN 1
                                ELSE 2
                                 END AS GROSS_NET_KEY,
                           (SUM(F.LI_VOL_BOE) / DAY(LAST_DAY(DD.FULL_DATE))) * -1 AS VOL,
                           P.PRODUCT || '_BOE' AS PRODUCT,
                           CC.CC_NUM AS CC_NUM
                      FROM WS_EDW.FACT_LO_QB_ACTUALS F
                      LEFT JOIN WS_EDW.DIM_LO_QB_PRODUCT_TYPE PROD
                        ON F.DIM_PRODUCT_TYPE_KEY = PROD.DIM_PRODUCT_TYPE_KEY
                      LEFT JOIN WS_EDW.DIM_LO_QB_COST_CENTER CC
                        ON F.DIM_COST_CENTER_KEY = CC.DIM_COST_CENTER_KEY
                      JOIN PRODUCTS P
                        ON F.GLOP_LINE_NO = P.GLOP_LINE_NO
                      JOIN (
                            SELECT DIM_ACTIVITY_PERIOD_DATE_KEY AS DIM_DATE_KEY ,
                                   FULL_DATE ,
                                   TO_CHAR(LAST_DAY(DATE_TRUNC(MONTH, FULL_DATE)), 'YYYYMMDD') AS FIRST_DATE_KEY
                              FROM WS_EDW.DIM_FDC_ACTIVITY_PERIOD_DATE
                           ) DD
                        ON TO_CHAR(F.DIM_ACCT_PER_DATE, 'YYYYMMDD') = DD.FIRST_DATE_KEY
                     WHERE NVL(F.LI_VOL, 0) != 0
                       AND F.DIM_PRODUCT_TYPE_KEY != 0
                       AND F.DIM_ACCT_PER_DATE IS NOT NULL
                     GROUP BY DD.DIM_DATE_KEY,
                              DD.FULL_DATE,
                              F.DIM_COST_CENTER_KEY,
                              F.DIM_PRODUCT_TYPE_KEY,
                              F.DIM_ACCT_PER_DATE,
                              F.GROSS_OR_NET_CODE,
                              P.PRODUCT,
                              CC.CC_NUM
                 UNION ALL SELECT DD.DIM_DATE_KEY AS DIM_ACTVY_PER_DATE_KEY,
                           DD.FULL_DATE AS DIM_ACTVY_PER_DATE,
                           F.DIM_COST_CENTER_KEY,
                           F.DIM_PRODUCT_TYPE_KEY,
                           CASE WHEN F.GROSS_OR_NET_CODE = 'G' THEN 1
                                ELSE 2
                                 END AS GROSS_NET_KEY,
                           (SUM(F.LI_VOL_BOE) / DAY(LAST_DAY(DD.FULL_DATE))) * -1 AS VOL,
                           PROD.PROD_CODE || '_BOE' AS PRODUCT,
                           CC.CC_NUM AS CC_NUM
                      FROM WS_EDW.FACT_LO_QB_ACTUALS F
                      LEFT JOIN WS_EDW.DIM_LO_QB_PRODUCT_TYPE PROD
                        ON F.DIM_PRODUCT_TYPE_KEY = PROD.DIM_PRODUCT_TYPE_KEY
                      LEFT JOIN WS_EDW.DIM_LO_QB_COST_CENTER CC
                        ON F.DIM_COST_CENTER_KEY = CC.DIM_COST_CENTER_KEY
                      JOIN PRODUCTS P
                        ON F.GLOP_LINE_NO = P.GLOP_LINE_NO
                      JOIN (
                            SELECT DIM_ACTIVITY_PERIOD_DATE_KEY AS DIM_DATE_KEY ,
                                   FULL_DATE ,
                                   TO_CHAR(LAST_DAY(DATE_TRUNC(MONTH, FULL_DATE)), 'YYYYMMDD') AS FIRST_DATE_KEY
                              FROM WS_EDW.DIM_FDC_ACTIVITY_PERIOD_DATE
                           ) DD
                        ON TO_CHAR(F.DIM_ACCT_PER_DATE, 'YYYYMMDD') = DD.FIRST_DATE_KEY
                     WHERE NVL(F.LI_VOL, 0) != 0
                       AND F.DIM_PRODUCT_TYPE_KEY != 0
                       AND PROD.PROD_CODE IN ('BUT', 'ETH', 'H20', 'PRO', 'PEN')
                       AND F.DIM_ACCT_PER_DATE IS NOT NULL
                     GROUP BY DD.DIM_DATE_KEY,
                              DD.FULL_DATE,
                              F.DIM_COST_CENTER_KEY,
                              F.DIM_PRODUCT_TYPE_KEY,
                              F.DIM_ACCT_PER_DATE,
                              F.GROSS_OR_NET_CODE,
                              CC.CC_NUM,
                              PROD.PROD_CODE
                 UNION ALL SELECT DD.DIM_DATE_KEY AS DIM_ACTVY_PER_DATE_KEY,
                           DD.FULL_DATE AS DIM_ACTVY_PER_DATE,
                           F.DIM_COST_CENTER_KEY,
                           F.DIM_PRODUCT_TYPE_KEY,
                           CASE WHEN F.GROSS_OR_NET_CODE = 'G' THEN 1
                                ELSE 2
                                 END AS GROSS_NET_KEY,
                           (SUM(F.LI_VOL_NM3) / DAY(LAST_DAY(DD.FULL_DATE))) * -1 AS VOL,
                           P.PRODUCT || '_NM3' AS PRODUCT,
                           CC.CC_NUM AS CC_NUM
                      FROM WS_EDW.FACT_LO_QB_ACTUALS F
                      LEFT JOIN WS_EDW.DIM_LO_QB_PRODUCT_TYPE PROD
                        ON F.DIM_PRODUCT_TYPE_KEY = PROD.DIM_PRODUCT_TYPE_KEY
                      LEFT JOIN WS_EDW.DIM_LO_QB_COST_CENTER CC
                        ON F.DIM_COST_CENTER_KEY = CC.DIM_COST_CENTER_KEY
                      JOIN PRODUCTS P
                        ON F.GLOP_LINE_NO = P.GLOP_LINE_NO
                      JOIN (
                            SELECT DIM_ACTIVITY_PERIOD_DATE_KEY AS DIM_DATE_KEY ,
                                   FULL_DATE ,
                                   TO_CHAR(LAST_DAY(DATE_TRUNC(MONTH, FULL_DATE)), 'YYYYMMDD') AS FIRST_DATE_KEY
                              FROM WS_EDW.DIM_FDC_ACTIVITY_PERIOD_DATE
                           ) DD
                        ON TO_CHAR(F.DIM_ACCT_PER_DATE, 'YYYYMMDD') = DD.FIRST_DATE_KEY
                     WHERE NVL(F.LI_VOL, 0) != 0
                       AND F.DIM_PRODUCT_TYPE_KEY != 0
                       AND F.DIM_ACCT_PER_DATE IS NOT NULL
                     GROUP BY DD.DIM_DATE_KEY,
                              DD.FULL_DATE,
                              F.DIM_COST_CENTER_KEY,
                              F.DIM_PRODUCT_TYPE_KEY,
                              F.DIM_ACCT_PER_DATE,
                              F.GROSS_OR_NET_CODE,
                              P.PRODUCT,
                              CC.CC_NUM
                 UNION ALL SELECT DD.DIM_DATE_KEY AS DIM_ACTVY_PER_DATE_KEY,
                           DD.FULL_DATE AS DIM_ACTVY_PER_DATE,
                           F.DIM_COST_CENTER_KEY,
                           F.DIM_PRODUCT_TYPE_KEY,
                           CASE WHEN F.GROSS_OR_NET_CODE = 'G' THEN 1
                                ELSE 2
                                 END AS GROSS_NET_KEY,
                           (SUM(F.LI_VOL_NM3) / DAY(LAST_DAY(DD.FULL_DATE))) * -1 AS VOL,
                           PROD.PROD_CODE || '_NM3' AS PRODUCT,
                           CC.CC_NUM AS CC_NUM
                      FROM WS_EDW.FACT_LO_QB_ACTUALS F
                      LEFT JOIN WS_EDW.DIM_LO_QB_PRODUCT_TYPE PROD
                        ON F.DIM_PRODUCT_TYPE_KEY = PROD.DIM_PRODUCT_TYPE_KEY
                      LEFT JOIN WS_EDW.DIM_LO_QB_COST_CENTER CC
                        ON F.DIM_COST_CENTER_KEY = CC.DIM_COST_CENTER_KEY
                      JOIN PRODUCTS P
                        ON F.GLOP_LINE_NO = P.GLOP_LINE_NO
                      JOIN (
                            SELECT DIM_ACTIVITY_PERIOD_DATE_KEY AS DIM_DATE_KEY ,
                                   FULL_DATE ,
                                   TO_CHAR(LAST_DAY(DATE_TRUNC(MONTH, FULL_DATE)), 'YYYYMMDD') AS FIRST_DATE_KEY
                              FROM WS_EDW.DIM_FDC_ACTIVITY_PERIOD_DATE
                           ) DD
                        ON TO_CHAR(F.DIM_ACCT_PER_DATE, 'YYYYMMDD') = DD.FIRST_DATE_KEY
                     WHERE NVL(F.LI_VOL, 0) != 0
                       AND F.DIM_PRODUCT_TYPE_KEY != 0
                       AND PROD.PROD_CODE IN ('BUT', 'ETH', 'H20', 'PRO', 'PEN')
                       AND F.DIM_ACCT_PER_DATE IS NOT NULL
                     GROUP BY DD.DIM_DATE_KEY,
                              DD.FULL_DATE,
                              F.DIM_COST_CENTER_KEY,
                              F.DIM_PRODUCT_TYPE_KEY,
                              F.DIM_ACCT_PER_DATE,
                              F.GROSS_OR_NET_CODE,
                              CC.CC_NUM,
                              PROD.PROD_CODE
                   ) SELECT CASE WHEN PVT.CC_NUM IS NULL THEN '-1'
                        ELSE 'CC-' || PVT.CC_NUM
                         END AS ENTITY_KEY ,
                   'qbyte_sales_acct' AS SCENARIO_KEY ,
                   GROSS_NET_KEY ,
                   DIM_ACTVY_PER_DATE_KEY AS ACTIVITY_DATE_KEY ,
                   DIM_ACTVY_PER_DATE AS ACTIVITY_DATE ,
                   -1 AS NORMALIZED_DATE_KEY ,
                   -1 AS PRODUCING_DATE_KEY ,
                   -1 AS ON_PROD_DATE_KEY ,
                   PVT.CC_NUM AS CC_NUM ,
                   NULL AS HOURS_ON ,
                   NULL AS HOURS_DOWN ,
                   NULL AS HCLIQ_METRIC ,
                   SUM(PVT."'OIL_METRIC'") AS OIL_METRIC ,
                   SUM(PVT."'OIL_IMPERIAL'") AS OIL_IMPERIAL ,
                   SUM(PVT."'OIL_BOE'") AS OIL_BOE ,
                   NULLIF(NVL(SUM(PVT."'CON_METRIC'"), 0) - NVL(SUM(PVT."'PEN_METRIC'"), 0), 0) AS CONDENSATE_METRIC ,
                   NULLIF(NVL(SUM(PVT."'CON_IMPERIAL'"), 0) - NVL(SUM(PVT."'PEN_IMPERIAL'"), 0), 0) AS CONDENSATE_IMPERIAL ,
                   NULLIF(NVL(SUM(PVT."'CON_BOE'"), 0) - NVL(SUM(PVT."'PEN_BOE'"), 0), 0) AS CONDENSATE_BOE ,
                   NULLIF(NVL(SUM(PVT."'NGL_METRIC'"), 0) + NVL(SUM(PVT."'PEN_METRIC'"), 0), 0) AS NGL_METRIC ,
                   NULLIF(NVL(SUM(PVT."'NGL_IMPERIAL'"), 0) + NVL(SUM(PVT."'PEN_IMPERIAL'"), 0), 0) AS NGL_IMPERIAL ,
                   NULLIF(NVL(SUM(PVT."'NGL_BOE'"), 0) + NVL(SUM(PVT."'PEN_BOE'"), 0), 0) AS NGL_BOE ,
                   SUM(PVT."'GAS_METRIC'") AS GAS_METRIC ,
                   SUM(PVT."'GAS_IMPERIAL'") AS GAS_IMPERIAL ,
                   CASE WHEN W.COUNTRY_NAME IN ('GERMANY', 'NETHERLANDS') THEN SUM(PVT."'GAS_BOE'") / 1000
                        ELSE SUM(PVT."'GAS_BOE'")
                         END AS GAS_BOE ,
                   SUM(PVT."'GAS_NM3'") AS GAS_NM3 ,
                   SUM(PVT."'H20_METRIC'") AS WATER_METRIC ,
                   SUM(PVT."'H20_IMPERIAL'") AS WATER_IMPERIAL ,
                   SUM(PVT."'H20_BOE'") AS WATER_BOE ,
                   NULL AS SAND_METRIC ,
                   NULL AS INJECTED_GAS_METRIC ,
                   NULL AS INJECTED_HCLIQ_METRIC ,
                   NULL AS INJECTED_SAND_METRIC ,
                   NULL AS INJECTED_WATER_METRIC ,
                   NULL AS RECOVERED_GAS_METRIC ,
                   NULL AS RECOVERED_HCLIQ_METRIC ,
                   NULL AS RECOVERED_SAND_METRIC ,
                   NULL AS RECOVERED_WATER_METRIC ,
                   NULL AS REMAINING_LIFT_GAS_METRIC ,
                   NULL AS REMAINING_LOAD_HCLIQ_METRIC ,
                   NULL AS REMAINING_LOAD_WATER_METRIC ,
                   NULL AS REMAINING_LOAD_SAND_METRIC ,
                   NULL AS METHANE_METRIC ,
                   NULL AS METHANE_IMPERIAL ,
                   NULL AS METHANE_BOE ,
                   SUM(PVT."'ETH_METRIC'") AS ETHANE_METRIC ,
                   SUM(PVT."'ETH_IMPERIAL'") AS ETHANE_IMPERIAL ,
                   SUM(PVT."'ETH_BOE'") AS ETHANE_BOE ,
                   SUM(PVT."'PRO_METRIC'") AS PROPANE_METRIC ,
                   SUM(PVT."'PRO_IMPERIAL'") AS PROPANE_IMPERIAL ,
                   SUM(PVT."'PRO_BOE'") AS PROPANE_BOE ,
                   SUM(PVT."'BUT_METRIC'") AS BUTANE_METRIC ,
                   SUM(PVT."'BUT_IMPERIAL'") AS BUTANE_IMPERIAL ,
                   SUM(PVT."'BUT_BOE'") AS BUTANE_BOE ,
                   SUM(PVT."'PEN_METRIC'") AS PENTANE_METRIC ,
                   SUM(PVT."'PEN_IMPERIAL'") AS PENTANE_IMPERIAL ,
                   SUM(PVT."'PEN_BOE'") AS PENTANE_BOE ,
                   NULL AS FLAREGAS_METRIC ,
                   NULL AS VENTGAS_METRIC ,
                   NULL AS FUELGAS_METRIC ,
                   NULL AS WIGAS ,
                   NULL AS WIHCLIQ ,
                   NULL AS WIWATER ,
                   NULL AS WISAND ,
                   NULL AS BAT_PRO_GAS_METRIC ,
                   NULL AS BAT_PRO_GAS_IMPERIAL ,
                   NULL AS BAT_PRO_GAS_BOE ,
                   NULL AS INJECTED_LIFT_GAS_METRIC ,
                   NULL AS INJECTED_LIFT_GAS_IMPERIAL ,
                   NULL AS INJECTED_LIFT_GAS_BOE
              FROM VOL F PIVOT(SUM(VOL) FOR PRODUCT IN ('OIL_IMPERIAL', 'OIL_METRIC', 'OIL_BOE', 'OIL_NM3', 'GAS_IMPERIAL', 'GAS_METRIC', 'GAS_BOE', 'GAS_NM3' , 'CON_IMPERIAL', 'CON_METRIC', 'CON_BOE', 'CON_NM3', 'NGL_IMPERIAL', 'NGL_METRIC', 'NGL_BOE', 'NGL_NM3' , 'H20_IMPERIAL', 'H20_METRIC', 'H20_BOE', 'H20_NM3', 'BUT_IMPERIAL', 'BUT_METRIC', 'BUT_BOE', 'BUT_NM3' , 'ETH_IMPERIAL', 'ETH_METRIC', 'ETH_BOE', 'ETH_NM3', 'PEN_IMPERIAL', 'PEN_METRIC', 'PEN_BOE', 'PEN_NM3' , 'PRO_IMPERIAL', 'PRO_METRIC', 'PRO_BOE', 'PRO_NM3')) AS PVT
              LEFT JOIN WS_EDW.DIM_FDC_WELL W
                ON 'CC-' || PVT.CC_NUM = W.DIM_WELL_KEY
             GROUP BY GROSS_NET_KEY,
                      DIM_ACTVY_PER_DATE_KEY,
                      DIM_ACTVY_PER_DATE,
                      PVT.CC_NUM,
                      W.COUNTRY_NAME
        dependencies:
          - locationName: TARGET
            nodeName: VIEW_FACT_FDC_ACTUALS
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','VIEW_FACT_FDC_ACTUALS') }}
        name: VIEW_FACT_FDC_ACTUALS_ACCT
        noLinkRefs: []
  name: VIEW_FACT_FDC_ACTUALS_ACCT
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
