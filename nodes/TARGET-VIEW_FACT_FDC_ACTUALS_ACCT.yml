fileVersion: 1
id: 37a2c84e-d560-4766-a224-6fa4839876d5
name: VIEW_FACT_FDC_ACTUALS_ACCT
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aaad1615-229d-4de8-b1cc-522c68e50165
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: ENTITY_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14a52e78-0488-4f72-ac61-27aeb896ef34
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SCENARIO_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d5bd483-402d-4b08-a7b2-be0d22a5be0e
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: NUMBER(1)
        defaultValue: ""
        description: ""
        name: GROSS_NET_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55aa086b-7a84-4d97-ad27-95b69839cbad
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACTIVITY_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c199702f-e252-4dbf-a769-33858435ea21
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: ACTIVITY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64ec07c2-270f-43be-8d37-b5d347601623
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NORMALIZED_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 049b3cd1-fd80-4401-b83a-d86a0ed442a0
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRODUCING_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ca21e95-5752-4770-831b-16aa649ebec2
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ON_PROD_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c18bc4c-6a4c-4cb9-ab63-b4e64111ae96
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3cec682f-251b-4268-8742-147c1173e7a3
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: HOURS_ON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15e58008-3fc6-44b8-b400-941f5e8e7c07
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: HOURS_DOWN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0fddc4ed-e2ba-4799-b94b-6723c7fc8df2
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: HCLIQ_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 316d9265-a839-4bd2-a609-33e18dfe654a
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: OIL_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cec6594f-b8b0-46a1-b728-30cc27eb09ac
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: OIL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f448564a-51df-4dd0-a6e2-18f66792787b
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: OIL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bcb91f60-98d1-40e2-a40d-f1e5abbb524c
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: CONDENSATE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 51b6c47a-626c-4c04-804b-7b3f9080b6db
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: CONDENSATE_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b0ca9a7-2ae5-44c4-99df-f4abce72375b
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: CONDENSATE_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 758c5538-bf6c-4713-8acb-8a76d1806af3
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: NGL_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 544f24a0-158a-4f7b-8bf7-ae48f7ff107d
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: NGL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bac6d91f-fb16-4d43-83c8-39c4c54840c5
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: NGL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: abbd3e21-1ed3-4fd9-bb7f-5067a31a1c83
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5043a752-76a4-4dde-9b34-96a346ab394b
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: GAS_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 12027326-7dd4-4456-ac69-b989b00c06fa
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: GAS_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f21a333d-98f0-474b-a0e0-f48dd9a7e844
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: GAS_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bbb533df-1036-4a8b-aa8d-787da94633db
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c2fafb6-e14b-4102-992e-56ae57f29ff5
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WATER_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7908192-1993-43d1-98ee-c973f7a34962
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WATER_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 414055ef-cf9c-4fca-bfd9-12916d23fad8
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: SAND_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5fa32e73-bf8e-45e9-9ed9-4483e31fce56
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7e03788-d4ee-4c7e-a2e7-4e43fa098743
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_HCLIQ_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66ff1332-e492-4624-a64a-950bbd4fec61
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_SAND_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: acb4dc8a-f3bb-4a34-a1c3-937b3f7d8cb2
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a0a60c96-2315-48c8-9647-22dcd268f755
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: RECOVERED_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f30a6ca-c876-4dba-bc15-56554b3fca25
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: RECOVERED_HCLIQ_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: efa32fcc-ed8d-4569-811d-f1ad4a9c50ed
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: RECOVERED_SAND_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fed312e7-bdf6-42f2-9de1-87649cde5dea
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: RECOVERED_WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 787c509f-b4f3-42f1-8cc2-59ebd8847f27
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: REMAINING_LIFT_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9a7c692-b024-46ca-bae7-75c2d40fcac7
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: REMAINING_LOAD_HCLIQ_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77873e23-e99c-46a4-b9a7-648854d6676f
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: REMAINING_LOAD_WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6839cab-9cfa-4327-98af-58efb814d09a
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: REMAINING_LOAD_SAND_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ece6f9e-07b7-434d-a06d-ae291af119f4
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: METHANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 233aada6-9646-45f1-896a-a1434f65df13
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: METHANE_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f93c5caa-14e0-4dec-b9b5-f5091239d3f0
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: METHANE_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 909f9cf6-79fd-4394-b84d-08066744e0a4
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: ETHANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e150b4f-7911-428e-a8c2-0bcaf05b3ed9
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: ETHANE_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95077c5a-e724-45fc-b10a-7c97a2a39215
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: ETHANE_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e80fd093-f9f5-4bbd-9c8c-c22dd1a021ed
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: PROPANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ecf2a4f4-6012-4b5c-85f6-4f5cca8ea955
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: PROPANE_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f690c7a-c0d0-439b-8573-75bc19085b83
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: PROPANE_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed2242c0-e755-4b46-a608-f3fd22d54a14
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: BUTANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05bb97ab-3cdc-4d51-b98b-7bca533e2dcf
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: BUTANE_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67889d91-41e7-48f3-b122-2993fabdf259
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: BUTANE_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6cdb2dc-e288-45bf-9fb3-61ae26d09241
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: PENTANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f98b842-5ca9-41f0-ba57-8a320e97c2ef
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: PENTANE_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bdcacb83-db3d-4ce7-a869-87925e1944e2
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: PENTANE_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e669b26a-b9fb-4295-990a-a978652f3f37
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: FLAREGAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8f0dfa3-990b-41f3-9809-93c6b7365069
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: VENTGAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9dd7a73a-6645-458f-b750-d2936b1d6634
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: FUELGAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f70481d5-63e6-407f-a903-54d14af02b0f
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WIGAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c2753b4-898f-4f26-94da-1fca791d96bd
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WIHCLIQ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e64abaf0-4d71-47de-881b-f550448f219d
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WIWATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb79613b-6bc7-4cbe-81fd-bee8a579d535
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WISAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 302e668a-1cb3-4211-981a-b8044ae39e50
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: BAT_PRO_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aba17d64-712b-4622-95e7-8e62ffd2ecc9
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: BAT_PRO_GAS_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ede3b09e-ad5c-416b-af22-a7b27056540b
          stepCounter: 37a2c84e-d560-4766-a224-6fa4839876d5
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: BAT_PRO_GAS_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_FACT_FDC_ACTUALS_ACCT: 37a2c84e-d560-4766-a224-6fa4839876d5
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_FACT_FDC_ACTUALS_ACCT') }} AS WITH PRODUCTS AS (
                    SELECT '20.1' AS GLOP_LINE_NO,
                           'OIL' AS PRODUCT
                 UNION ALL SELECT '20.2' AS GLOP_LINE_NO,
                           'CON' AS PRODUCT
                 UNION ALL SELECT '20.3' AS GLOP_LINE_NO,
                           'NGL' AS PRODUCT
                 UNION ALL SELECT '20.4' AS GLOP_LINE_NO,
                           'GAS' AS PRODUCT
                   ),
                   VOL AS (
                    SELECT DD.DIM_DATE_KEY AS DIM_ACTVY_PER_DATE_KEY,
                           DD.FULL_DATE AS DIM_ACTVY_PER_DATE,
                           F.DIM_COST_CENTER_KEY,
                           F.DIM_PRODUCT_TYPE_KEY,
                           CASE WHEN F.GROSS_OR_NET_CODE = 'G' THEN 1
                                ELSE 2
                                 END AS GROSS_NET_KEY,
                           (SUM(F.LI_VOL_M3) / DAY(LAST_DAY(DD.FULL_DATE))) * -1 AS VOL,
                           P.PRODUCT || '_METRIC' AS PRODUCT,
                           CC.CC_NUM AS CC_NUM
                      FROM WS_EDW.FACT_LO_QB_ACTUALS F
                      LEFT JOIN WS_EDW.DIM_LO_QB_PRODUCT_TYPE PROD
                        ON F.DIM_PRODUCT_TYPE_KEY = PROD.DIM_PRODUCT_TYPE_KEY
                      LEFT JOIN WS_EDW.DIM_LO_QB_COST_CENTER CC
                        ON F.DIM_COST_CENTER_KEY = CC.DIM_COST_CENTER_KEY
                      JOIN PRODUCTS P
                        ON F.GLOP_LINE_NO = P.GLOP_LINE_NO
                      JOIN (
                            SELECT DIM_ACTIVITY_PERIOD_DATE_KEY AS DIM_DATE_KEY ,
                                   FULL_DATE ,
                                   TO_CHAR(LAST_DAY(DATE_TRUNC(MONTH, FULL_DATE)), 'YYYYMMDD') AS FIRST_DATE_KEY
                              FROM WS_EDW.DIM_FDC_ACTIVITY_PERIOD_DATE
                           ) DD
                        ON TO_CHAR(F.DIM_ACCT_PER_DATE, 'YYYYMMDD') = DD.FIRST_DATE_KEY
                     WHERE NVL(F.LI_VOL, 0) != 0
                       AND F.DIM_PRODUCT_TYPE_KEY != 0
                       AND F.DIM_ACCT_PER_DATE IS NOT NULL
                     GROUP BY DD.DIM_DATE_KEY,
                              DD.FULL_DATE,
                              F.DIM_COST_CENTER_KEY,
                              F.DIM_PRODUCT_TYPE_KEY,
                              F.DIM_ACCT_PER_DATE,
                              F.GROSS_OR_NET_CODE,
                              P.PRODUCT,
                              CC.CC_NUM
                 UNION ALL SELECT DD.DIM_DATE_KEY AS DIM_ACTVY_PER_DATE_KEY,
                           DD.FULL_DATE AS DIM_ACTVY_PER_DATE,
                           F.DIM_COST_CENTER_KEY,
                           F.DIM_PRODUCT_TYPE_KEY,
                           CASE WHEN F.GROSS_OR_NET_CODE = 'G' THEN 1
                                ELSE 2
                                 END AS GROSS_NET_KEY,
                           (SUM(F.LI_VOL_M3) / DAY(LAST_DAY(DD.FULL_DATE))) * -1 AS VOL,
                           PROD.PROD_CODE || '_METRIC' AS PRODUCT,
                           CC.CC_NUM AS CC_NUM
                      FROM WS_EDW.FACT_LO_QB_ACTUALS F
                      LEFT JOIN WS_EDW.DIM_LO_QB_PRODUCT_TYPE PROD
                        ON F.DIM_PRODUCT_TYPE_KEY = PROD.DIM_PRODUCT_TYPE_KEY
                      LEFT JOIN WS_EDW.DIM_LO_QB_COST_CENTER CC
                        ON F.DIM_COST_CENTER_KEY = CC.DIM_COST_CENTER_KEY
                      JOIN PRODUCTS P
                        ON F.GLOP_LINE_NO = P.GLOP_LINE_NO
                      JOIN (
                            SELECT DIM_ACTIVITY_PERIOD_DATE_KEY AS DIM_DATE_KEY ,
                                   FULL_DATE ,
                                   TO_CHAR(LAST_DAY(DATE_TRUNC(MONTH, FULL_DATE)), 'YYYYMMDD') AS FIRST_DATE_KEY
                              FROM WS_EDW.DIM_FDC_ACTIVITY_PERIOD_DATE
                           ) DD
                        ON TO_CHAR(F.DIM_ACCT_PER_DATE, 'YYYYMMDD') = DD.FIRST_DATE_KEY
                     WHERE NVL(F.LI_VOL, 0) != 0
                       AND F.DIM_PRODUCT_TYPE_KEY != 0
                       AND PROD.PROD_CODE IN ('BUT', 'ETH', 'H20', 'PRO', 'PEN')
                       AND F.DIM_ACCT_PER_DATE IS NOT NULL
                     GROUP BY DD.DIM_DATE_KEY,
                              DD.FULL_DATE,
                              F.DIM_COST_CENTER_KEY,
                              F.DIM_PRODUCT_TYPE_KEY,
                              F.DIM_ACCT_PER_DATE,
                              F.GROSS_OR_NET_CODE,
                              CC.CC_NUM,
                              PROD.PROD_CODE
                 UNION ALL SELECT DD.DIM_DATE_KEY AS DIM_ACTVY_PER_DATE_KEY,
                           DD.FULL_DATE AS DIM_ACTVY_PER_DATE,
                           F.DIM_COST_CENTER_KEY,
                           F.DIM_PRODUCT_TYPE_KEY,
                           CASE WHEN F.GROSS_OR_NET_CODE = 'G' THEN 1
                                ELSE 2
                                 END AS GROSS_NET_KEY,
                           (SUM(F.LI_VOL_IMPERIAL) / DAY(LAST_DAY(DD.FULL_DATE))) * -1 AS VOL,
                           P.PRODUCT || '_IMPERIAL' AS PRODUCT,
                           CC.CC_NUM AS CC_NUM
                      FROM WS_EDW.FACT_LO_QB_ACTUALS F
                      LEFT JOIN WS_EDW.DIM_LO_QB_PRODUCT_TYPE PROD
                        ON F.DIM_PRODUCT_TYPE_KEY = PROD.DIM_PRODUCT_TYPE_KEY
                      LEFT JOIN WS_EDW.DIM_LO_QB_COST_CENTER CC
                        ON F.DIM_COST_CENTER_KEY = CC.DIM_COST_CENTER_KEY
                      JOIN PRODUCTS P
                        ON F.GLOP_LINE_NO = P.GLOP_LINE_NO
                      JOIN (
                            SELECT DIM_ACTIVITY_PERIOD_DATE_KEY AS DIM_DATE_KEY ,
                                   FULL_DATE ,
                                   TO_CHAR(LAST_DAY(DATE_TRUNC(MONTH, FULL_DATE)), 'YYYYMMDD') AS FIRST_DATE_KEY
                              FROM WS_EDW.DIM_FDC_ACTIVITY_PERIOD_DATE
                           ) DD
                        ON TO_CHAR(F.DIM_ACCT_PER_DATE, 'YYYYMMDD') = DD.FIRST_DATE_KEY
                     WHERE NVL(F.LI_VOL, 0) != 0
                       AND F.DIM_PRODUCT_TYPE_KEY != 0
                       AND F.DIM_ACCT_PER_DATE IS NOT NULL
                     GROUP BY DD.DIM_DATE_KEY,
                              DD.FULL_DATE,
                              F.DIM_COST_CENTER_KEY,
                              F.DIM_PRODUCT_TYPE_KEY,
                              F.DIM_ACCT_PER_DATE,
                              F.GROSS_OR_NET_CODE,
                              P.PRODUCT,
                              CC.CC_NUM
                 UNION ALL SELECT DD.DIM_DATE_KEY AS DIM_ACTVY_PER_DATE_KEY,
                           DD.FULL_DATE AS DIM_ACTVY_PER_DATE,
                           F.DIM_COST_CENTER_KEY,
                           F.DIM_PRODUCT_TYPE_KEY,
                           CASE WHEN F.GROSS_OR_NET_CODE = 'G' THEN 1
                                ELSE 2
                                 END AS GROSS_NET_KEY,
                           (SUM(F.LI_VOL_IMPERIAL) / DAY(LAST_DAY(DD.FULL_DATE))) * -1 AS VOL,
                           PROD.PROD_CODE || '_IMPERIAL' AS PRODUCT,
                           CC.CC_NUM AS CC_NUM
                      FROM WS_EDW.FACT_LO_QB_ACTUALS F
                      LEFT JOIN WS_EDW.DIM_LO_QB_PRODUCT_TYPE PROD
                        ON F.DIM_PRODUCT_TYPE_KEY = PROD.DIM_PRODUCT_TYPE_KEY
                      LEFT JOIN WS_EDW.DIM_LO_QB_COST_CENTER CC
                        ON F.DIM_COST_CENTER_KEY = CC.DIM_COST_CENTER_KEY
                      JOIN PRODUCTS P
                        ON F.GLOP_LINE_NO = P.GLOP_LINE_NO
                      JOIN (
                            SELECT DIM_ACTIVITY_PERIOD_DATE_KEY AS DIM_DATE_KEY ,
                                   FULL_DATE ,
                                   TO_CHAR(LAST_DAY(DATE_TRUNC(MONTH, FULL_DATE)), 'YYYYMMDD') AS FIRST_DATE_KEY
                              FROM WS_EDW.DIM_FDC_ACTIVITY_PERIOD_DATE
                           ) DD
                        ON TO_CHAR(F.DIM_ACCT_PER_DATE, 'YYYYMMDD') = DD.FIRST_DATE_KEY
                     WHERE NVL(F.LI_VOL, 0) != 0
                       AND F.DIM_PRODUCT_TYPE_KEY != 0
                       AND PROD.PROD_CODE IN ('BUT', 'ETH', 'H20', 'PRO', 'PEN')
                       AND F.DIM_ACCT_PER_DATE IS NOT NULL
                     GROUP BY DD.DIM_DATE_KEY,
                              DD.FULL_DATE,
                              F.DIM_COST_CENTER_KEY,
                              F.DIM_PRODUCT_TYPE_KEY,
                              F.DIM_ACCT_PER_DATE,
                              F.GROSS_OR_NET_CODE,
                              CC.CC_NUM,
                              PROD.PROD_CODE
                 UNION ALL SELECT DD.DIM_DATE_KEY AS DIM_ACTVY_PER_DATE_KEY,
                           DD.FULL_DATE AS DIM_ACTVY_PER_DATE,
                           F.DIM_COST_CENTER_KEY,
                           F.DIM_PRODUCT_TYPE_KEY,
                           CASE WHEN F.GROSS_OR_NET_CODE = 'G' THEN 1
                                ELSE 2
                                 END AS GROSS_NET_KEY,
                           (SUM(F.LI_VOL_BOE) / DAY(LAST_DAY(DD.FULL_DATE))) * -1 AS VOL,
                           P.PRODUCT || '_BOE' AS PRODUCT,
                           CC.CC_NUM AS CC_NUM
                      FROM WS_EDW.FACT_LO_QB_ACTUALS F
                      LEFT JOIN WS_EDW.DIM_LO_QB_PRODUCT_TYPE PROD
                        ON F.DIM_PRODUCT_TYPE_KEY = PROD.DIM_PRODUCT_TYPE_KEY
                      LEFT JOIN WS_EDW.DIM_LO_QB_COST_CENTER CC
                        ON F.DIM_COST_CENTER_KEY = CC.DIM_COST_CENTER_KEY
                      JOIN PRODUCTS P
                        ON F.GLOP_LINE_NO = P.GLOP_LINE_NO
                      JOIN (
                            SELECT DIM_ACTIVITY_PERIOD_DATE_KEY AS DIM_DATE_KEY ,
                                   FULL_DATE ,
                                   TO_CHAR(LAST_DAY(DATE_TRUNC(MONTH, FULL_DATE)), 'YYYYMMDD') AS FIRST_DATE_KEY
                              FROM WS_EDW.DIM_FDC_ACTIVITY_PERIOD_DATE
                           ) DD
                        ON TO_CHAR(F.DIM_ACCT_PER_DATE, 'YYYYMMDD') = DD.FIRST_DATE_KEY
                     WHERE NVL(F.LI_VOL, 0) != 0
                       AND F.DIM_PRODUCT_TYPE_KEY != 0
                       AND F.DIM_ACCT_PER_DATE IS NOT NULL
                     GROUP BY DD.DIM_DATE_KEY,
                              DD.FULL_DATE,
                              F.DIM_COST_CENTER_KEY,
                              F.DIM_PRODUCT_TYPE_KEY,
                              F.DIM_ACCT_PER_DATE,
                              F.GROSS_OR_NET_CODE,
                              P.PRODUCT,
                              CC.CC_NUM
                 UNION ALL SELECT DD.DIM_DATE_KEY AS DIM_ACTVY_PER_DATE_KEY,
                           DD.FULL_DATE AS DIM_ACTVY_PER_DATE,
                           F.DIM_COST_CENTER_KEY,
                           F.DIM_PRODUCT_TYPE_KEY,
                           CASE WHEN F.GROSS_OR_NET_CODE = 'G' THEN 1
                                ELSE 2
                                 END AS GROSS_NET_KEY,
                           (SUM(F.LI_VOL_BOE) / DAY(LAST_DAY(DD.FULL_DATE))) * -1 AS VOL,
                           PROD.PROD_CODE || '_BOE' AS PRODUCT,
                           CC.CC_NUM AS CC_NUM
                      FROM WS_EDW.FACT_LO_QB_ACTUALS F
                      LEFT JOIN WS_EDW.DIM_LO_QB_PRODUCT_TYPE PROD
                        ON F.DIM_PRODUCT_TYPE_KEY = PROD.DIM_PRODUCT_TYPE_KEY
                      LEFT JOIN WS_EDW.DIM_LO_QB_COST_CENTER CC
                        ON F.DIM_COST_CENTER_KEY = CC.DIM_COST_CENTER_KEY
                      JOIN PRODUCTS P
                        ON F.GLOP_LINE_NO = P.GLOP_LINE_NO
                      JOIN (
                            SELECT DIM_ACTIVITY_PERIOD_DATE_KEY AS DIM_DATE_KEY ,
                                   FULL_DATE ,
                                   TO_CHAR(LAST_DAY(DATE_TRUNC(MONTH, FULL_DATE)), 'YYYYMMDD') AS FIRST_DATE_KEY
                              FROM WS_EDW.DIM_FDC_ACTIVITY_PERIOD_DATE
                           ) DD
                        ON TO_CHAR(F.DIM_ACCT_PER_DATE, 'YYYYMMDD') = DD.FIRST_DATE_KEY
                     WHERE NVL(F.LI_VOL, 0) != 0
                       AND F.DIM_PRODUCT_TYPE_KEY != 0
                       AND PROD.PROD_CODE IN ('BUT', 'ETH', 'H20', 'PRO', 'PEN')
                       AND F.DIM_ACCT_PER_DATE IS NOT NULL
                     GROUP BY DD.DIM_DATE_KEY,
                              DD.FULL_DATE,
                              F.DIM_COST_CENTER_KEY,
                              F.DIM_PRODUCT_TYPE_KEY,
                              F.DIM_ACCT_PER_DATE,
                              F.GROSS_OR_NET_CODE,
                              CC.CC_NUM,
                              PROD.PROD_CODE
                 UNION ALL SELECT DD.DIM_DATE_KEY AS DIM_ACTVY_PER_DATE_KEY,
                           DD.FULL_DATE AS DIM_ACTVY_PER_DATE,
                           F.DIM_COST_CENTER_KEY,
                           F.DIM_PRODUCT_TYPE_KEY,
                           CASE WHEN F.GROSS_OR_NET_CODE = 'G' THEN 1
                                ELSE 2
                                 END AS GROSS_NET_KEY,
                           (SUM(F.LI_VOL_NM3) / DAY(LAST_DAY(DD.FULL_DATE))) * -1 AS VOL,
                           P.PRODUCT || '_NM3' AS PRODUCT,
                           CC.CC_NUM AS CC_NUM
                      FROM WS_EDW.FACT_LO_QB_ACTUALS F
                      LEFT JOIN WS_EDW.DIM_LO_QB_PRODUCT_TYPE PROD
                        ON F.DIM_PRODUCT_TYPE_KEY = PROD.DIM_PRODUCT_TYPE_KEY
                      LEFT JOIN WS_EDW.DIM_LO_QB_COST_CENTER CC
                        ON F.DIM_COST_CENTER_KEY = CC.DIM_COST_CENTER_KEY
                      JOIN PRODUCTS P
                        ON F.GLOP_LINE_NO = P.GLOP_LINE_NO
                      JOIN (
                            SELECT DIM_ACTIVITY_PERIOD_DATE_KEY AS DIM_DATE_KEY ,
                                   FULL_DATE ,
                                   TO_CHAR(LAST_DAY(DATE_TRUNC(MONTH, FULL_DATE)), 'YYYYMMDD') AS FIRST_DATE_KEY
                              FROM WS_EDW.DIM_FDC_ACTIVITY_PERIOD_DATE
                           ) DD
                        ON TO_CHAR(F.DIM_ACCT_PER_DATE, 'YYYYMMDD') = DD.FIRST_DATE_KEY
                     WHERE NVL(F.LI_VOL, 0) != 0
                       AND F.DIM_PRODUCT_TYPE_KEY != 0
                       AND F.DIM_ACCT_PER_DATE IS NOT NULL
                     GROUP BY DD.DIM_DATE_KEY,
                              DD.FULL_DATE,
                              F.DIM_COST_CENTER_KEY,
                              F.DIM_PRODUCT_TYPE_KEY,
                              F.DIM_ACCT_PER_DATE,
                              F.GROSS_OR_NET_CODE,
                              P.PRODUCT,
                              CC.CC_NUM
                 UNION ALL SELECT DD.DIM_DATE_KEY AS DIM_ACTVY_PER_DATE_KEY,
                           DD.FULL_DATE AS DIM_ACTVY_PER_DATE,
                           F.DIM_COST_CENTER_KEY,
                           F.DIM_PRODUCT_TYPE_KEY,
                           CASE WHEN F.GROSS_OR_NET_CODE = 'G' THEN 1
                                ELSE 2
                                 END AS GROSS_NET_KEY,
                           (SUM(F.LI_VOL_NM3) / DAY(LAST_DAY(DD.FULL_DATE))) * -1 AS VOL,
                           PROD.PROD_CODE || '_NM3' AS PRODUCT,
                           CC.CC_NUM AS CC_NUM
                      FROM WS_EDW.FACT_LO_QB_ACTUALS F
                      LEFT JOIN WS_EDW.DIM_LO_QB_PRODUCT_TYPE PROD
                        ON F.DIM_PRODUCT_TYPE_KEY = PROD.DIM_PRODUCT_TYPE_KEY
                      LEFT JOIN WS_EDW.DIM_LO_QB_COST_CENTER CC
                        ON F.DIM_COST_CENTER_KEY = CC.DIM_COST_CENTER_KEY
                      JOIN PRODUCTS P
                        ON F.GLOP_LINE_NO = P.GLOP_LINE_NO
                      JOIN (
                            SELECT DIM_ACTIVITY_PERIOD_DATE_KEY AS DIM_DATE_KEY ,
                                   FULL_DATE ,
                                   TO_CHAR(LAST_DAY(DATE_TRUNC(MONTH, FULL_DATE)), 'YYYYMMDD') AS FIRST_DATE_KEY
                              FROM WS_EDW.DIM_FDC_ACTIVITY_PERIOD_DATE
                           ) DD
                        ON TO_CHAR(F.DIM_ACCT_PER_DATE, 'YYYYMMDD') = DD.FIRST_DATE_KEY
                     WHERE NVL(F.LI_VOL, 0) != 0
                       AND F.DIM_PRODUCT_TYPE_KEY != 0
                       AND PROD.PROD_CODE IN ('BUT', 'ETH', 'H20', 'PRO', 'PEN')
                       AND F.DIM_ACCT_PER_DATE IS NOT NULL
                     GROUP BY DD.DIM_DATE_KEY,
                              DD.FULL_DATE,
                              F.DIM_COST_CENTER_KEY,
                              F.DIM_PRODUCT_TYPE_KEY,
                              F.DIM_ACCT_PER_DATE,
                              F.GROSS_OR_NET_CODE,
                              CC.CC_NUM,
                              PROD.PROD_CODE
                   ) SELECT CASE WHEN PVT.CC_NUM IS NULL THEN '-1'
                        ELSE 'CC-' || PVT.CC_NUM
                         END AS ENTITY_KEY ,
                   'qbyte_sales_acct' AS SCENARIO_KEY ,
                   GROSS_NET_KEY ,
                   DIM_ACTVY_PER_DATE_KEY AS ACTIVITY_DATE_KEY ,
                   DIM_ACTVY_PER_DATE AS ACTIVITY_DATE ,
                   -1 AS NORMALIZED_DATE_KEY ,
                   -1 AS PRODUCING_DATE_KEY ,
                   -1 AS ON_PROD_DATE_KEY ,
                   PVT.CC_NUM AS CC_NUM ,
                   NULL AS HOURS_ON ,
                   NULL AS HOURS_DOWN ,
                   NULL AS HCLIQ_METRIC ,
                   SUM(PVT."'OIL_METRIC'") AS OIL_METRIC ,
                   SUM(PVT."'OIL_IMPERIAL'") AS OIL_IMPERIAL ,
                   SUM(PVT."'OIL_BOE'") AS OIL_BOE ,
                   NULLIF(NVL(SUM(PVT."'CON_METRIC'"), 0) - NVL(SUM(PVT."'PEN_METRIC'"), 0), 0) AS CONDENSATE_METRIC ,
                   NULLIF(NVL(SUM(PVT."'CON_IMPERIAL'"), 0) - NVL(SUM(PVT."'PEN_IMPERIAL'"), 0), 0) AS CONDENSATE_IMPERIAL ,
                   NULLIF(NVL(SUM(PVT."'CON_BOE'"), 0) - NVL(SUM(PVT."'PEN_BOE'"), 0), 0) AS CONDENSATE_BOE ,
                   NULLIF(NVL(SUM(PVT."'NGL_METRIC'"), 0) + NVL(SUM(PVT."'PEN_METRIC'"), 0), 0) AS NGL_METRIC ,
                   NULLIF(NVL(SUM(PVT."'NGL_IMPERIAL'"), 0) + NVL(SUM(PVT."'PEN_IMPERIAL'"), 0), 0) AS NGL_IMPERIAL ,
                   NULLIF(NVL(SUM(PVT."'NGL_BOE'"), 0) + NVL(SUM(PVT."'PEN_BOE'"), 0), 0) AS NGL_BOE ,
                   SUM(PVT."'GAS_METRIC'") AS GAS_METRIC ,
                   SUM(PVT."'GAS_IMPERIAL'") AS GAS_IMPERIAL ,
                   CASE WHEN W.COUNTRY_NAME IN ('GERMANY', 'NETHERLANDS') THEN SUM(PVT."'GAS_BOE'") / 1000
                        ELSE SUM(PVT."'GAS_BOE'")
                         END AS GAS_BOE ,
                   SUM(PVT."'GAS_NM3'") AS GAS_NM3 ,
                   SUM(PVT."'H20_METRIC'") AS WATER_METRIC ,
                   SUM(PVT."'H20_IMPERIAL'") AS WATER_IMPERIAL ,
                   SUM(PVT."'H20_BOE'") AS WATER_BOE ,
                   NULL AS SAND_METRIC ,
                   NULL AS INJECTED_GAS_METRIC ,
                   NULL AS INJECTED_HCLIQ_METRIC ,
                   NULL AS INJECTED_SAND_METRIC ,
                   NULL AS INJECTED_WATER_METRIC ,
                   NULL AS RECOVERED_GAS_METRIC ,
                   NULL AS RECOVERED_HCLIQ_METRIC ,
                   NULL AS RECOVERED_SAND_METRIC ,
                   NULL AS RECOVERED_WATER_METRIC ,
                   NULL AS REMAINING_LIFT_GAS_METRIC ,
                   NULL AS REMAINING_LOAD_HCLIQ_METRIC ,
                   NULL AS REMAINING_LOAD_WATER_METRIC ,
                   NULL AS REMAINING_LOAD_SAND_METRIC ,
                   NULL AS METHANE_METRIC ,
                   NULL AS METHANE_IMPERIAL ,
                   NULL AS METHANE_BOE ,
                   SUM(PVT."'ETH_METRIC'") AS ETHANE_METRIC ,
                   SUM(PVT."'ETH_IMPERIAL'") AS ETHANE_IMPERIAL ,
                   SUM(PVT."'ETH_BOE'") AS ETHANE_BOE ,
                   SUM(PVT."'PRO_METRIC'") AS PROPANE_METRIC ,
                   SUM(PVT."'PRO_IMPERIAL'") AS PROPANE_IMPERIAL ,
                   SUM(PVT."'PRO_BOE'") AS PROPANE_BOE ,
                   SUM(PVT."'BUT_METRIC'") AS BUTANE_METRIC ,
                   SUM(PVT."'BUT_IMPERIAL'") AS BUTANE_IMPERIAL ,
                   SUM(PVT."'BUT_BOE'") AS BUTANE_BOE ,
                   SUM(PVT."'PEN_METRIC'") AS PENTANE_METRIC ,
                   SUM(PVT."'PEN_IMPERIAL'") AS PENTANE_IMPERIAL ,
                   SUM(PVT."'PEN_BOE'") AS PENTANE_BOE ,
                   NULL AS FLAREGAS_METRIC ,
                   NULL AS VENTGAS_METRIC ,
                   NULL AS FUELGAS_METRIC ,
                   NULL AS WIGAS ,
                   NULL AS WIHCLIQ ,
                   NULL AS WIWATER ,
                   NULL AS WISAND ,
                   NULL AS BAT_PRO_GAS_METRIC ,
                   NULL AS BAT_PRO_GAS_IMPERIAL ,
                   NULL AS BAT_PRO_GAS_BOE ,
                   NULL AS INJECTED_LIFT_GAS_METRIC ,
                   NULL AS INJECTED_LIFT_GAS_IMPERIAL ,
                   NULL AS INJECTED_LIFT_GAS_BOE
              FROM VOL F PIVOT(SUM(VOL) FOR PRODUCT IN ('OIL_IMPERIAL', 'OIL_METRIC', 'OIL_BOE', 'OIL_NM3', 'GAS_IMPERIAL', 'GAS_METRIC', 'GAS_BOE', 'GAS_NM3' , 'CON_IMPERIAL', 'CON_METRIC', 'CON_BOE', 'CON_NM3', 'NGL_IMPERIAL', 'NGL_METRIC', 'NGL_BOE', 'NGL_NM3' , 'H20_IMPERIAL', 'H20_METRIC', 'H20_BOE', 'H20_NM3', 'BUT_IMPERIAL', 'BUT_METRIC', 'BUT_BOE', 'BUT_NM3' , 'ETH_IMPERIAL', 'ETH_METRIC', 'ETH_BOE', 'ETH_NM3', 'PEN_IMPERIAL', 'PEN_METRIC', 'PEN_BOE', 'PEN_NM3' , 'PRO_IMPERIAL', 'PRO_METRIC', 'PRO_BOE', 'PRO_NM3')) AS PVT
              LEFT JOIN WS_EDW.DIM_FDC_WELL W
                ON 'CC-' || PVT.CC_NUM = W.DIM_WELL_KEY
             GROUP BY GROSS_NET_KEY,
                      DIM_ACTVY_PER_DATE_KEY,
                      DIM_ACTVY_PER_DATE,
                      PVT.CC_NUM,
                      W.COUNTRY_NAME
        dependencies:
          - locationName: TARGET
            nodeName: VIEW_FACT_FDC_ACTUALS
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','VIEW_FACT_FDC_ACTUALS') }}
        name: VIEW_FACT_FDC_ACTUALS_ACCT
        noLinkRefs: []
  name: VIEW_FACT_FDC_ACTUALS_ACCT
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
