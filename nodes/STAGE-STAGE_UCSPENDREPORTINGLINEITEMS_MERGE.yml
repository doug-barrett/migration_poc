fileVersion: 1
id: c366230e-d21e-4164-902c-10bc6c0509c0
name: STAGE_UCSPENDREPORTINGLINEITEMS_MERGE
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 497240f5-81b6-4754-86f9-b3a4fba84d83
          stepCounter: c366230e-d21e-4164-902c-10bc6c0509c0
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: SPENDREPORTINGLINEITEMSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3e931aa-c342-4880-8489-3e5b1f38d3d8
                stepCounter: 1e251560-2444-4214-b6c1-8665564f3527
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4660e3b-2c5b-4c29-a98e-d44c0a4f4772
          stepCounter: c366230e-d21e-4164-902c-10bc6c0509c0
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SUPPLIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56a529c0-4a89-429f-b8fc-bba50ecd833f
                stepCounter: 1e251560-2444-4214-b6c1-8665564f3527
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: abeba6f1-2018-4d10-9a12-b3b504517e9b
          stepCounter: c366230e-d21e-4164-902c-10bc6c0509c0
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CATEGORY_LEVEL_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a28feb19-642e-41c7-894c-b4871b62dcc4
                stepCounter: 1e251560-2444-4214-b6c1-8665564f3527
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a79e3b34-3937-4665-9a3a-cd6dced092b0
          stepCounter: c366230e-d21e-4164-902c-10bc6c0509c0
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CATEGORY_LEVEL_2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cee73f5b-3a1c-43fd-a17c-f170328b704e
                stepCounter: 1e251560-2444-4214-b6c1-8665564f3527
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86102670-cb22-4760-88cc-ff8d7d8c0fb8
          stepCounter: c366230e-d21e-4164-902c-10bc6c0509c0
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CATEGORY_LEVEL_3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 542043a8-aeed-45a8-999f-d7e0555d9918
                stepCounter: 1e251560-2444-4214-b6c1-8665564f3527
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d50219d-932e-4bc3-92b7-0338a324e0c0
          stepCounter: c366230e-d21e-4164-902c-10bc6c0509c0
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CATEGORY_LEVEL_4
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90ffb23e-6306-4836-ac53-8d7424ad2ab3
                stepCounter: 1e251560-2444-4214-b6c1-8665564f3527
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9bf90beb-19c6-409d-9867-85984241f7a4
          stepCounter: c366230e-d21e-4164-902c-10bc6c0509c0
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: UC_TIER_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00eadf05-465c-4807-95d8-5650bf3b147f
                stepCounter: 1e251560-2444-4214-b6c1-8665564f3527
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a629539a-c736-4eac-9d9a-70b934f12b59
          stepCounter: c366230e-d21e-4164-902c-10bc6c0509c0
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: UC_TIER_2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3090caba-e0a9-4960-a35e-9f779705b8e6
                stepCounter: 1e251560-2444-4214-b6c1-8665564f3527
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1728e5c-3264-4d9a-923b-4685f1162a52
          stepCounter: c366230e-d21e-4164-902c-10bc6c0509c0
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: UC_TIER_3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a7fdef5-30f7-45df-a097-d9f202ed199a
                stepCounter: 1e251560-2444-4214-b6c1-8665564f3527
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4fab2792-982d-4187-a4c9-7f6cc8fb3f71
          stepCounter: c366230e-d21e-4164-902c-10bc6c0509c0
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: OBJECT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 630cc6dc-6138-47fd-bf01-1bb1e0c66275
                stepCounter: 1e251560-2444-4214-b6c1-8665564f3527
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa4f96ca-1d6a-4220-ad91-539dffcb07fd
          stepCounter: c366230e-d21e-4164-902c-10bc6c0509c0
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PO_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 943d6320-c67e-4df2-8a50-18b1b6b7a6b7
                stepCounter: 1e251560-2444-4214-b6c1-8665564f3527
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 881d312c-7fed-4060-9ed1-2be865c18151
          stepCounter: c366230e-d21e-4164-902c-10bc6c0509c0
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PAYMENT_METHOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db23e81e-4eea-4d2a-85ae-984e9b664c4e
                stepCounter: 1e251560-2444-4214-b6c1-8665564f3527
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20ab11c1-6a76-48b3-a773-a78dbdf321c7
          stepCounter: c366230e-d21e-4164-902c-10bc6c0509c0
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: LINEDESCCARD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05b4cc7e-edaf-4a3d-8a31-c129f74216ad
                stepCounter: 1e251560-2444-4214-b6c1-8665564f3527
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5242d628-de86-4e82-b7c2-61690594de33
          stepCounter: c366230e-d21e-4164-902c-10bc6c0509c0
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: LINEDESCINVOICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7126560b-77cb-4d70-99de-e5e00836ca55
                stepCounter: 1e251560-2444-4214-b6c1-8665564f3527
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d69c0eee-20d4-4bf1-941a-057e02050cf9
          stepCounter: c366230e-d21e-4164-902c-10bc6c0509c0
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: LINEDESCPO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2774f853-2b69-4b97-bbcd-062e50240ed5
                stepCounter: 1e251560-2444-4214-b6c1-8665564f3527
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae3b2df8-4c5d-40ab-9be9-b783d464971a
          stepCounter: c366230e-d21e-4164-902c-10bc6c0509c0
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: UNITPRICEINVOICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a6171920-299f-4592-9cf9-bf080508d6b4
                stepCounter: 1e251560-2444-4214-b6c1-8665564f3527
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 153020f3-2b33-4c69-9c83-18ba0a8a361b
          stepCounter: c366230e-d21e-4164-902c-10bc6c0509c0
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CAMPUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b738845e-fa16-4261-9b66-3111aa65eaff
                stepCounter: 1e251560-2444-4214-b6c1-8665564f3527
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8399e55e-1560-48b0-8502-844806504deb
          stepCounter: c366230e-d21e-4164-902c-10bc6c0509c0
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: UCSPEND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6fce9804-7cf2-4ca5-8f6b-4def27121e8c
                stepCounter: 1e251560-2444-4214-b6c1-8665564f3527
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e724c082-24ea-4a6e-aece-346045e4b9eb
          stepCounter: c366230e-d21e-4164-902c-10bc6c0509c0
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: FILENAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4275e0bb-0f72-415c-aa8f-8bb319ea9192
                stepCounter: 1e251560-2444-4214-b6c1-8665564f3527
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 85f41165-4d75-48a5-aff4-f85227aae8f2
          stepCounter: c366230e-d21e-4164-902c-10bc6c0509c0
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8157ea0-ddbf-4684-824f-ec2aaa15970c
                stepCounter: 1e251560-2444-4214-b6c1-8665564f3527
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9ca3276-b9dd-4ded-8978-526f6d932435
          stepCounter: c366230e-d21e-4164-902c-10bc6c0509c0
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 53f7359f-4896-40d9-a10d-9d0f7630fc7c
                stepCounter: 1e251560-2444-4214-b6c1-8665564f3527
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f846312-1234-4593-93b4-d5f669396186
          stepCounter: c366230e-d21e-4164-902c-10bc6c0509c0
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: TRANSACTIONDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8802121-649a-4b7a-9e13-8c004d028a66
                stepCounter: 1e251560-2444-4214-b6c1-8665564f3527
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8218495e-be67-44c4-aadd-e8b769f4f021
          stepCounter: c366230e-d21e-4164-902c-10bc6c0509c0
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: UCCOMPONENTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d8138fd3-3ee0-49cf-bfaf-2db9fe32f7d5
                stepCounter: 378d18bf-01a0-4245-9507-b0b40ee80a28
            transform: IFNULL(UCCOMPONENT.UCCOMPONENTKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d99fa034-4239-422f-9b4f-a3a223318ce0
          stepCounter: c366230e-d21e-4164-902c-10bc6c0509c0
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: OPCONTRACTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07b79b47-4a73-48b1-8e7e-0318fa8441fe
                stepCounter: 378d18bf-01a0-4245-9507-b0b40ee80a28
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d405249-00c8-43c3-b14b-91ca85dfffaa
          stepCounter: c366230e-d21e-4164-902c-10bc6c0509c0
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: OPCONTRACTNUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e6ca395-0207-46ab-af61-8b48b16c1a3a
                stepCounter: 378d18bf-01a0-4245-9507-b0b40ee80a28
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e68f3efb-3b13-44bd-82af-aaf676777e01
          stepCounter: c366230e-d21e-4164-902c-10bc6c0509c0
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SUPPLIERMATCHTYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b52e8542-04fb-4f6a-80ce-4499d25fca1e
                stepCounter: 378d18bf-01a0-4245-9507-b0b40ee80a28
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5179136-7cdb-49dd-b6d1-52cdb8201c4b
          stepCounter: c366230e-d21e-4164-902c-10bc6c0509c0
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: UCCOMPONENTMATCHINGOMNIASUPPLIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 582f3678-127c-429f-8d2a-fd9ae9b717e3
                stepCounter: 378d18bf-01a0-4245-9507-b0b40ee80a28
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 288ea819-7360-4014-b546-4db62a0ad760
          stepCounter: c366230e-d21e-4164-902c-10bc6c0509c0
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: OPCONTRACTMAPPINGSTATUSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05bd1df3-f8b1-4ed3-82fe-1f8c087c051d
                stepCounter: 378d18bf-01a0-4245-9507-b0b40ee80a28
            transform: IFNULL(UCCOMPONENT.OPCONTRACTMAPPINGSTATUSID,4)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0877c99f-7b86-41e8-a1bd-d1cc9e87a74b
          stepCounter: c366230e-d21e-4164-902c-10bc6c0509c0
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b4f27c8-5954-48c2-b495-76d33270a2bd
          stepCounter: c366230e-d21e-4164-902c-10bc6c0509c0
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_UCSPENDREPORTINGLINEITEMS: 1e251560-2444-4214-b6c1-8665564f3527
          UCCOMPONENT: 378d18bf-01a0-4245-9507-b0b40ee80a28
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: UCCOMPONENT
          - locationName: STAGE
            nodeName: STAGE_UCSPENDREPORTINGLINEITEMS
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','STAGE_UCSPENDREPORTINGLINEITEMS') }} STAGE_UCSPENDREPORTINGLINEITEMS
              LEFT JOIN {{ ref('DIM','UCCOMPONENT') }} UCCOMPONENT
                ON STAGE_UCSPENDREPORTINGLINEITEMS.CAMPUS = UCCOMPONENT.UCCOMPONENTCAMPUS
               AND STAGE_UCSPENDREPORTINGLINEITEMS.CATEGORY_LEVEL_4 = UCCOMPONENT.UCCOMPONENTLEVEL4CATEGORY
               AND STAGE_UCSPENDREPORTINGLINEITEMS.SUPPLIER = UCCOMPONENT.UCCOMPONENTUCSUPPLIERNAME
        name: STAGEUCSPENDREPORTINGLINEITEMS_MERGE
        noLinkRefs: []
  name: STAGE_UCSPENDREPORTINGLINEITEMS_MERGE
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
