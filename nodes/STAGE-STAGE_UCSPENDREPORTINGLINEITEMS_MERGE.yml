fileVersion: 1
id: e1ae9991-45c3-48cc-be9d-97eb746816a4
name: STAGE_UCSPENDREPORTINGLINEITEMS_MERGE
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 68dc1dec-933b-49fc-833e-ad42e830aff4
          stepCounter: e1ae9991-45c3-48cc-be9d-97eb746816a4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: SPENDREPORTINGLINEITEMSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 01ddb460-b752-4873-bf85-c0b0cf5a811d
                stepCounter: c14c3ac1-f6d4-489f-81e8-f473a3de42c6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 399c854f-a55d-47a7-984f-d59d1bb5b6f4
          stepCounter: e1ae9991-45c3-48cc-be9d-97eb746816a4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SUPPLIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e4559983-f506-4829-a1e2-bbb3eb25d40a
                stepCounter: c14c3ac1-f6d4-489f-81e8-f473a3de42c6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe8f1048-4286-4212-9028-af70e59a15a6
          stepCounter: e1ae9991-45c3-48cc-be9d-97eb746816a4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CATEGORY_LEVEL_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ff97e663-b162-4c30-864f-cbbe651086be
                stepCounter: c14c3ac1-f6d4-489f-81e8-f473a3de42c6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5718a208-7336-492e-8ba5-c773125af720
          stepCounter: e1ae9991-45c3-48cc-be9d-97eb746816a4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CATEGORY_LEVEL_2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7f6110e-358d-473d-8366-2cff1c9d68a4
                stepCounter: c14c3ac1-f6d4-489f-81e8-f473a3de42c6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b2c5b72-f656-4a3b-b81f-bb359fcdd73b
          stepCounter: e1ae9991-45c3-48cc-be9d-97eb746816a4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CATEGORY_LEVEL_3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50ac8790-3a40-4e68-8024-e6c1faca52ed
                stepCounter: c14c3ac1-f6d4-489f-81e8-f473a3de42c6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0c5ee06-f2f2-4e3d-8efa-0769c5318241
          stepCounter: e1ae9991-45c3-48cc-be9d-97eb746816a4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CATEGORY_LEVEL_4
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 45c96234-1dcd-4431-a5f6-06bba8ef5790
                stepCounter: c14c3ac1-f6d4-489f-81e8-f473a3de42c6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e20564eb-39de-4b06-a188-f22b35a57cc9
          stepCounter: e1ae9991-45c3-48cc-be9d-97eb746816a4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: UC_TIER_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 55f43a93-f502-4ba1-a123-5b3d16666a19
                stepCounter: c14c3ac1-f6d4-489f-81e8-f473a3de42c6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a67e077-7fb7-4500-8b10-b86b9e7fb512
          stepCounter: e1ae9991-45c3-48cc-be9d-97eb746816a4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: UC_TIER_2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: deb4b91e-3001-4b4e-aceb-d6f99ccd0017
                stepCounter: c14c3ac1-f6d4-489f-81e8-f473a3de42c6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32bce2f8-aca2-4924-a167-dcee53645ead
          stepCounter: e1ae9991-45c3-48cc-be9d-97eb746816a4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: UC_TIER_3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 508667c2-f6f7-47af-a057-838bce838ad7
                stepCounter: c14c3ac1-f6d4-489f-81e8-f473a3de42c6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ea87163-9de6-47d1-9892-a0ff9e8f2285
          stepCounter: e1ae9991-45c3-48cc-be9d-97eb746816a4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: OBJECT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 895416ee-d354-4bc3-8db0-60aea38bdea0
                stepCounter: c14c3ac1-f6d4-489f-81e8-f473a3de42c6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14d65bae-df8a-4d6f-a815-3cc8277cb843
          stepCounter: e1ae9991-45c3-48cc-be9d-97eb746816a4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PO_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1394821c-85d0-43a8-9617-734c215da42e
                stepCounter: c14c3ac1-f6d4-489f-81e8-f473a3de42c6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b64f735f-bfef-4958-aabb-537686c2dafe
          stepCounter: e1ae9991-45c3-48cc-be9d-97eb746816a4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PAYMENT_METHOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7774a09c-bb51-44f5-9e99-7eb8bfa17fd5
                stepCounter: c14c3ac1-f6d4-489f-81e8-f473a3de42c6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 343a399f-f6a5-4c15-8198-0c8ca8be1059
          stepCounter: e1ae9991-45c3-48cc-be9d-97eb746816a4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: LINEDESCCARD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: deb812ae-5df3-46ae-86c5-02082d4fefa6
                stepCounter: c14c3ac1-f6d4-489f-81e8-f473a3de42c6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: deb35309-bfe7-4e56-b939-b8fbba9b713a
          stepCounter: e1ae9991-45c3-48cc-be9d-97eb746816a4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: LINEDESCINVOICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c1c87b0-df9c-4418-a032-c224ec1424a1
                stepCounter: c14c3ac1-f6d4-489f-81e8-f473a3de42c6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d154166-de29-466b-b42f-e0679ae18cce
          stepCounter: e1ae9991-45c3-48cc-be9d-97eb746816a4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: LINEDESCPO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79c66232-f605-4dab-a70e-533294d95a86
                stepCounter: c14c3ac1-f6d4-489f-81e8-f473a3de42c6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91569c66-ab89-4083-93c6-9b1533d5222d
          stepCounter: e1ae9991-45c3-48cc-be9d-97eb746816a4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: UNITPRICEINVOICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ff01242-a78b-40b6-93db-203b16e3777c
                stepCounter: c14c3ac1-f6d4-489f-81e8-f473a3de42c6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed941a9b-4778-4ed1-81d5-8600b9ae53ad
          stepCounter: e1ae9991-45c3-48cc-be9d-97eb746816a4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CAMPUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 288d6922-4cfb-48c2-b212-2a0a0a071878
                stepCounter: c14c3ac1-f6d4-489f-81e8-f473a3de42c6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9f84de5-ba9c-47ad-a8d6-2e15f0b9b2bd
          stepCounter: e1ae9991-45c3-48cc-be9d-97eb746816a4
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: UCSPEND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eedf0016-51a2-4e17-8866-88fa42926a48
                stepCounter: c14c3ac1-f6d4-489f-81e8-f473a3de42c6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bded8904-a9d2-41d9-9239-e1e3c5c7e8fb
          stepCounter: e1ae9991-45c3-48cc-be9d-97eb746816a4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: FILENAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a1b8df0-80e1-4cda-9902-71b2ad62f05b
                stepCounter: c14c3ac1-f6d4-489f-81e8-f473a3de42c6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 979eafe3-b026-47d4-a083-91438c8397bc
          stepCounter: e1ae9991-45c3-48cc-be9d-97eb746816a4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e18f7204-3124-4953-9d2f-50f748b59b6d
                stepCounter: c14c3ac1-f6d4-489f-81e8-f473a3de42c6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b7253db-eecd-4545-b647-1a22144aad8f
          stepCounter: e1ae9991-45c3-48cc-be9d-97eb746816a4
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf038cea-1367-4bb6-8d2f-66dc924ac6d3
                stepCounter: c14c3ac1-f6d4-489f-81e8-f473a3de42c6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3517fe9f-4b28-44fa-90c2-750d9ff90213
          stepCounter: e1ae9991-45c3-48cc-be9d-97eb746816a4
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: TRANSACTIONDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 221ba688-e647-4cf5-bfca-97eb0298feda
                stepCounter: c14c3ac1-f6d4-489f-81e8-f473a3de42c6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 814d07cc-d9c4-49db-9abf-4bd8c4b1c300
          stepCounter: e1ae9991-45c3-48cc-be9d-97eb746816a4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: UCCOMPONENTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ca073a05-918e-439f-8d5a-a063fcb1c314
                stepCounter: e06591b6-a45d-4723-86fa-b5f973be3e28
            transform: IFNULL(UCCOMPONENT.UCCOMPONENTKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d43313b-e130-4ccc-8479-1182e5fd187c
          stepCounter: e1ae9991-45c3-48cc-be9d-97eb746816a4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: OPCONTRACTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8d470704-7441-49e1-9279-74c14b4ec767
                stepCounter: e06591b6-a45d-4723-86fa-b5f973be3e28
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b117146b-1490-4cb6-a592-d0cd0e5bcfbe
          stepCounter: e1ae9991-45c3-48cc-be9d-97eb746816a4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: OPCONTRACTNUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9cfb417a-bb1f-47df-9fed-bedeba9e96ff
                stepCounter: e06591b6-a45d-4723-86fa-b5f973be3e28
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2050b32-2718-4fa9-9c43-4466ee37e0e5
          stepCounter: e1ae9991-45c3-48cc-be9d-97eb746816a4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SUPPLIERMATCHTYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ff3c1a81-a68e-461c-a21e-04de52779d37
                stepCounter: e06591b6-a45d-4723-86fa-b5f973be3e28
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe8c476f-fa78-4585-b6f7-e86bc319c69d
          stepCounter: e1ae9991-45c3-48cc-be9d-97eb746816a4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: UCCOMPONENTMATCHINGOMNIASUPPLIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd31d893-b2a7-4a8c-bea6-68158a6165df
                stepCounter: e06591b6-a45d-4723-86fa-b5f973be3e28
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d87146e-c148-41be-97f1-f07ccb270d91
          stepCounter: e1ae9991-45c3-48cc-be9d-97eb746816a4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: OPCONTRACTMAPPINGSTATUSID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2fb71e3d-f372-46f8-9678-84d44420c1b3
                stepCounter: e06591b6-a45d-4723-86fa-b5f973be3e28
            transform: IFNULL(UCCOMPONENT.OPCONTRACTMAPPINGSTATUSID,4)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ad74fb4-1fc0-4683-ad9b-41fcd90c418e
          stepCounter: e1ae9991-45c3-48cc-be9d-97eb746816a4
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96feae15-a7e9-4cb7-96a5-05cac6a08695
          stepCounter: e1ae9991-45c3-48cc-be9d-97eb746816a4
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          UCCOMPONENT: e06591b6-a45d-4723-86fa-b5f973be3e28
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: UCCOMPONENT
          - locationName: STAGE
            nodeName: STAGE_UCSPENDREPORTINGLINEITEMS
          - locationName: UNKNOWN
            nodeName: STAGEUCSPENDREPORTINGLINEITEMS
        join:
          joinCondition: |-
            FROM {{ ref('UNKNOWN','STAGEUCSPENDREPORTINGLINEITEMS') }} STAGEUCSPENDREPORTINGLINEITEMS
              LEFT JOIN {{ ref('DIM','UCCOMPONENT') }} UCCOMPONENT
                ON STAGEUCSPENDREPORTINGLINEITEMS.CAMPUS = UCCOMPONENT.UCCOMPONENTCAMPUS
               AND STAGEUCSPENDREPORTINGLINEITEMS.CATEGORY_LEVEL_4 = UCCOMPONENT.UCCOMPONENTLEVEL4CATEGORY
               AND STAGEUCSPENDREPORTINGLINEITEMS.SUPPLIER = UCCOMPONENT.UCCOMPONENTUCSUPPLIERNAME
        name: STAGEUCSPENDREPORTINGLINEITEMS_MERGE
        noLinkRefs: []
  name: STAGE_UCSPENDREPORTINGLINEITEMS_MERGE
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
