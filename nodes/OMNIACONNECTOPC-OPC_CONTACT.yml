fileVersion: 1
id: b8caacbd-c3b6-40a2-af74-8baa85417b06
name: OPC_CONTACT
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: OMNIACONNECT.OPC
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7da62cc4-4c77-42d1-ba16-653ec92fb015
          stepCounter: b8caacbd-c3b6-40a2-af74-8baa85417b06
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: CONTACTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dcf753c9-6ce6-4287-960d-d7a6b21b22fc
                stepCounter: d056aba3-a0b9-4509-9a27-e51f9da7fe1b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a96cc33-89c4-4235-a431-b7fe0fc69506
          stepCounter: b8caacbd-c3b6-40a2-af74-8baa85417b06
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CONTACTSALESFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2a0e7bf5-9534-4809-a6d5-ec9bd11dad65
                stepCounter: d056aba3-a0b9-4509-9a27-e51f9da7fe1b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71eb0004-a455-4b60-85f0-07c66ce8e15c
          stepCounter: b8caacbd-c3b6-40a2-af74-8baa85417b06
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE HIGHEST-LEVEL OF HIERARCHY FOR AN ACCOUNT
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2e4b84b-05ef-47d3-a83d-7153f6369b20
                stepCounter: d056aba3-a0b9-4509-9a27-e51f9da7fe1b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88048b75-4b2d-4e1f-a655-e3997b782ae1
          stepCounter: b8caacbd-c3b6-40a2-af74-8baa85417b06
        config: {}
        dataType: INT
        defaultValue: ""
        description: UNIQUE IDENTIFIER FOR AN ACCOUNT. COMMONLY CALLED THE "FORCE ID"
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec98b9df-b5a4-4716-b590-e18bb6492bee
                stepCounter: d056aba3-a0b9-4509-9a27-e51f9da7fe1b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7af90890-fc23-4a9a-8044-403e83a52444
          stepCounter: b8caacbd-c3b6-40a2-af74-8baa85417b06
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ACCOUNTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ec93dd8-589d-4364-9f92-38bb6a6f81ec
                stepCounter: d056aba3-a0b9-4509-9a27-e51f9da7fe1b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5251c4c-883c-4a0a-b87e-99298b0210ba
          stepCounter: b8caacbd-c3b6-40a2-af74-8baa85417b06
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: DEPARTMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22ccf2af-2703-4815-830c-5cbf7ff7fde0
                stepCounter: d056aba3-a0b9-4509-9a27-e51f9da7fe1b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81754f10-959f-4704-8f46-00175af9af99
          stepCounter: b8caacbd-c3b6-40a2-af74-8baa85417b06
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TITLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3f262c74-761b-43e0-93c9-43781e75b39a
                stepCounter: d056aba3-a0b9-4509-9a27-e51f9da7fe1b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9aecfb86-1955-44c2-b3e3-86727e5bb08d
          stepCounter: b8caacbd-c3b6-40a2-af74-8baa85417b06
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SALUTATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a5bbb9e-1d3e-4f78-97d0-123728c1fa8d
                stepCounter: d056aba3-a0b9-4509-9a27-e51f9da7fe1b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0575c646-90d8-4bb3-acf9-cf167e344523
          stepCounter: b8caacbd-c3b6-40a2-af74-8baa85417b06
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: FIRSTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2cbb6454-6a30-4326-93df-2d645d2fdc2c
                stepCounter: d056aba3-a0b9-4509-9a27-e51f9da7fe1b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: abb93daf-97ff-4cfb-87e1-fd84d7d1a249
          stepCounter: b8caacbd-c3b6-40a2-af74-8baa85417b06
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: LASTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 40fa88ea-3594-47f9-a05c-6a52c6b5107e
                stepCounter: d056aba3-a0b9-4509-9a27-e51f9da7fe1b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11761fb6-c653-495e-a721-14645e7420b9
          stepCounter: b8caacbd-c3b6-40a2-af74-8baa85417b06
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: EMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f497161e-1e96-4ba8-84b9-36d799f33b98
                stepCounter: d056aba3-a0b9-4509-9a27-e51f9da7fe1b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 980e9025-9599-4f75-8d8f-46cbf893ab3a
          stepCounter: b8caacbd-c3b6-40a2-af74-8baa85417b06
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PHONE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5addaa4b-b941-48ce-992e-3b6412fcc8aa
                stepCounter: d056aba3-a0b9-4509-9a27-e51f9da7fe1b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b9681dff-8514-4a54-912e-c4b443b48a87
          stepCounter: b8caacbd-c3b6-40a2-af74-8baa85417b06
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: MAILINGSTREET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8be975a7-7c1a-480d-adef-6998dd404985
                stepCounter: d056aba3-a0b9-4509-9a27-e51f9da7fe1b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 164c2219-f0e7-4ba3-8cf3-a1921ef900e1
          stepCounter: b8caacbd-c3b6-40a2-af74-8baa85417b06
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: MAILINGCITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7aab3804-597f-424f-b7fb-3752190a2c94
                stepCounter: d056aba3-a0b9-4509-9a27-e51f9da7fe1b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb726135-0fdc-4bbc-965d-cd851516787d
          stepCounter: b8caacbd-c3b6-40a2-af74-8baa85417b06
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: MAILINGSTATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1cc1e004-08ca-4aeb-808f-343daebee72d
                stepCounter: d056aba3-a0b9-4509-9a27-e51f9da7fe1b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f02c517-1ee8-41ee-b0a1-bfc92365c7f2
          stepCounter: b8caacbd-c3b6-40a2-af74-8baa85417b06
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: MAILINGPOSTALCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f6cc4523-b81f-40af-8925-72e2bad1b5a1
                stepCounter: d056aba3-a0b9-4509-9a27-e51f9da7fe1b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d28afa8d-948d-4d6b-a38d-92dfd5fc42bf
          stepCounter: b8caacbd-c3b6-40a2-af74-8baa85417b06
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: MAILINGCOUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8818ab6e-5952-4696-902a-6fcfd855d5a1
                stepCounter: d056aba3-a0b9-4509-9a27-e51f9da7fe1b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50bf59a3-e479-4c64-aa70-932b6f7f0637
          stepCounter: b8caacbd-c3b6-40a2-af74-8baa85417b06
        config: {}
        dataType: DATE
        defaultValue: ""
        description: CONTACT CREATED IN MONTH
        name: CREATED_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1db0bb4f-3ddb-4500-ab8f-9c02030ca362
                stepCounter: d056aba3-a0b9-4509-9a27-e51f9da7fe1b
            transform: LAST_DAY(CONTACT.CREATEDDATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 500dbf09-f402-456a-b204-911a7a899804
          stepCounter: b8caacbd-c3b6-40a2-af74-8baa85417b06
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: LASTACTIVITYDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6aeee3f2-9799-4a95-86d3-148756fa2d4d
                stepCounter: d056aba3-a0b9-4509-9a27-e51f9da7fe1b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40f59b8f-f9c9-4878-8fe4-c145b9a1c8a0
          stepCounter: b8caacbd-c3b6-40a2-af74-8baa85417b06
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: LASTACTIVE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6aeee3f2-9799-4a95-86d3-148756fa2d4d
                stepCounter: d056aba3-a0b9-4509-9a27-e51f9da7fe1b
            transform: CASE \NWHEN LASTACTIVITYDATE IS NULL THEN '' \N \NWHEN LASTACTIVITYDATE =CURRENT_DATE THEN 'TODAY' \N \NWHEN DATEDIFF('DAYS',LASTACTIVITYDATE,CURRENT_DATE)=1 THEN 'YESTERDAY' \N \NWHEN DATEDIFF('DAYS',LASTACTIVITYDATE,CURRENT_DATE)< 0 THEN 'UNKNOWN' \N \NWHEN DATEDIFF('MONTHS',LASTACTIVITYDATE,CURRENT_DATE)= 0 THEN \N(\NCONCAT \N(\NTO_VARCHAR(DATEDIFF('DAYS',LASTACTIVITYDATE,CURRENT_DATE)) ,'D', \N' AGO' \N) \N) \N \NWHEN DATEDIFF('MONTHS',LASTACTIVITYDATE,CURRENT_DATE)>= 24 THEN \N(CONCAT(\NTO_VARCHAR(DATEDIFF('YEAR',LASTACTIVITYDATE,CURRENT_DATE)) , 'Y', \N' AGO')) \NELSE \N(CONCAT(\NTO_VARCHAR(DATEDIFF('MONTHS',LASTACTIVITYDATE,CURRENT_DATE)) ,'MO', \N' AGO')) \NEND
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 142b8cba-6e8e-4ffa-b6e7-ccb64e7b9401
          stepCounter: b8caacbd-c3b6-40a2-af74-8baa85417b06
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CREATEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1db0bb4f-3ddb-4500-ab8f-9c02030ca362
                stepCounter: d056aba3-a0b9-4509-9a27-e51f9da7fe1b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1951a1f1-3630-448f-9a54-52d31cc0e168
          stepCounter: b8caacbd-c3b6-40a2-af74-8baa85417b06
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: df07f73a-d6bc-47ab-bd8a-196ef1857d2e
                stepCounter: d056aba3-a0b9-4509-9a27-e51f9da7fe1b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 131272f3-9863-4523-82ec-22a77af266b8
          stepCounter: b8caacbd-c3b6-40a2-af74-8baa85417b06
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        name: PURCHASING_INFLUENCER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d084a48c-c843-4c25-8271-be565f1b3ece
                stepCounter: d056aba3-a0b9-4509-9a27-e51f9da7fe1b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d20c120a-d517-41cf-9d7c-97cfbf9b931e
          stepCounter: b8caacbd-c3b6-40a2-af74-8baa85417b06
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        name: PURCHASING_DECISION_MAKER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 427d04a0-3ae0-404b-9feb-75b502552ddd
                stepCounter: d056aba3-a0b9-4509-9a27-e51f9da7fe1b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0887b762-217e-4750-8319-0a5cd697fba8
          stepCounter: b8caacbd-c3b6-40a2-af74-8baa85417b06
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: DEPARTMENT_AI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4c4c148-40d5-41c3-92ef-86ee77b0e8f2
                stepCounter: d056aba3-a0b9-4509-9a27-e51f9da7fe1b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f1de0ce-df56-463c-afea-61798908c027
          stepCounter: b8caacbd-c3b6-40a2-af74-8baa85417b06
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: AREAS_OF_INTEREST_AI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b92bc0a1-87a6-4f77-b55d-ac45dcc01e08
                stepCounter: d056aba3-a0b9-4509-9a27-e51f9da7fe1b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b741069d-9941-4bea-84f6-231b9d79d8e0
          stepCounter: b8caacbd-c3b6-40a2-af74-8baa85417b06
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: LAST_VALIDATED_AI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e69eeae1-415d-4678-896c-30493d036c1f
                stepCounter: d056aba3-a0b9-4509-9a27-e51f9da7fe1b
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          CONTACT: d056aba3-a0b9-4509-9a27-e51f9da7fe1b
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: CONTACT
        join:
          joinCondition: |-
            FROM {{ ref('DIM','CONTACT') }}
             WHERE NOT (CONTACT.LEVEL1FORCEID IS NULL OR CONTACT.NAME = 'NATIONAL IPA' OR CONTACT.FIRSTNAME LIKE '%UNKNOWN%' OR CONTACT.FIRSTNAME LIKE '%OMNIA%' OR CONTACT.LASTNAME LIKE '%UNKNOWN%' OR CONTACT.LASTNAME LIKE '%OMNIA%' OR CONTACT.DONOTEMAILFLAG = TRUE OR CONTACT.MARKETINGMAILOPTOUT = TRUE OR CONTACT.ISEMAILBOUNCED = TRUE OR CONTACT.ISDELETED = TRUE)
               AND CONTACT.STATUS = 'ACTIVE'
        name: OPC_CONTACT
        noLinkRefs: []
  name: OPC_CONTACT
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
