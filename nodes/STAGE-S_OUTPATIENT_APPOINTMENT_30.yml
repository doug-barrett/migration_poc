fileVersion: 1
id: 8f406b93-230e-4ca7-9b71-7b9b61be080b
name: S_OUTPATIENT_APPOINTMENT_30
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: false
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f61d4530-ad0a-4cd4-965a-a9a751cd2e55
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.outpatient_appointment_encounter_type_code=dim_encounter_type.encounter_type_code
        name: DIM_ENCOUNTER_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b653376-5881-4193-88b5-bcee5bce8195
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.outpatient_clinic_reference_no=dim_outpatient_clinic.outpatient_clinic_reference_no
        name: DIM_OUTPATIENT_CLINIC_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c98b92de-f3f6-4f75-9f28-39c14d26d388
                stepCounter: e0a63ed9-23e0-4e07-aea6-1cdf8a17c767
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fbe64d5f-b72c-4131-b9fa-37c79bfbba6b
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: s_outpatient_appointment_30.outpatient_clinic_reference_no=dim_outpatient_clinic.outpatient_clinic_reference_no
        name: HOSPITAL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e8220b6-8501-44ba-b93b-5f73c1744094
                stepCounter: e0a63ed9-23e0-4e07-aea6-1cdf8a17c767
            transform: isnull(dim_outpatient_clinic.hospital_id,'1021')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d168f1b-dfad-4108-a230-93dc2372285d
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.outpatient_specialty_reference_no=dim_outpatient_specialty.outpatient_specialty_reference_no
        name: DIM_OUTPATIENT_SPECIALTY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90198e6f-73c4-4e11-ba4a-5c00a8648821
                stepCounter: 61d55fca-0a5d-4c05-92b7-1f83a1343ff9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03a65bac-bdef-46b4-bfac-50eee4a07f62
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTED_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0560ed61-96fe-44a0-a972-7676078e3e92
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc4b942c-0a02-4562-866f-75ff54a7575f
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.appointed_clinician_reference_no=dim_outpatient_clinician.outpatient_clinician_reference_no
        name: DIM_OUTPATIENT_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d4aa20fe-51a6-442f-927f-3be5d0254eaa
                stepCounter: 6175f12d-c1fa-42b6-a9a6-811b027ccf26
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a5babcc-0538-46e3-b877-6e4635eccf9f
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 40c023d0-9463-453b-92ed-23714cb3e994
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a6cc3c7-33bd-483c-838a-306f45190370
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.appointment_type_reference_no=dim_appointment_type.appointment_type_reference_no
        name: DIM_APPOINTMENT_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 112f6e6a-8633-48e4-b9ca-3073898e8983
                stepCounter: 7176ae2f-e1ec-4006-a7fb-bab199d1be08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d43f5cbf-c02d-4bcc-b32c-4759e81f785f
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: APPOINTMENT_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3181d17-f08b-49cb-8c50-94b48158885b
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7069f725-6002-44ab-bd5e-a741733eba1c
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef10869b-d2aa-46bb-99fb-51495a3b0475
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d6c5cd1-26f8-4587-ab1f-4e6b6ad72e19
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: BOOKING_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 623befd5-a9e9-443f-9f81-27ce3a9c6a91
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a4ecd8ff-fc63-4eb6-b19d-b6d0c1eb9661
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_outpatient_appointment_30.booking_type_reference_no=dim_booking_type.booking_type_reference_no
        name: DIM_BOOKING_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f065774-99dc-4944-a361-cde512ebae8b
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.appointment_status_reference_no=dim_appointment_status.appointment_status_reference_no
        name: DIM_APPOINTMENT_STATUS_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e94fc6b7-4c88-4112-bb6e-267b88019650
                stepCounter: f3b1e17d-8b67-4b08-b342-7a2c0e29b656
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33efaa29-2f60-4e72-bc3a-d90f4fd4c89a
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ONLINE_BOOKING_REQUESTED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b772a93-fa52-483e-86a5-98eb16acecaf
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f89da04-19f1-472a-8d63-c1ffb6d1da52
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: APPOINTMENT_REQUEST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 161d53a3-7291-486d-aa4b-99cad9d63ca5
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ffc7963-0782-4906-9f7f-9a7014c71e32
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: APPOINTMENT_CALLED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1245c48a-231d-4318-a850-635d36331057
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3019d903-6931-404b-b91d-b058481918b0
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: APPOINTMENT_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 145ed7f7-7549-4696-b6d0-ec8a121d6aad
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 89736bab-e0bc-4a0d-9baa-7396e48ea36c
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_outpatient_appointment_30.CONVERT(date,s_outpatient_appointment_20.appointment_start_date)=dim_appointment_start_date.appointment_start_calendar_date
        name: DIM_APPOINTMENT_START_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e39fe92-294b-4bd0-843e-017031fa7a1c
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_PLANNED_CARE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: isnull(dim_planned_care.dim_planned_care_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c2add60-933c-45b2-9add-8856c4e7c75f
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: APPOINTMENT_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ce8e776-e19d-4e61-80f5-73d940e72fb6
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ff6fe90-1514-44e5-9794-b47bfc14cf25
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: FIRST_REFERRAL_APPOINTMENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b4f1f04-065f-45a3-89c2-b4e57568f064
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a407b64-5cb1-4a69-a260-3b3d1a4da39c
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_outpatient_appointment_30.CONVERT(date,s_outpatient_appointment_20.appointment_end_date)=dim_appointment_end_date.appointment_end_calendar_date
        name: DIM_APPOINTMENT_END_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a30f78d2-fafc-4eb4-abe2-5b9b0b9fcb39
                stepCounter: 2bab711e-f733-4be5-b16f-9da45619c711
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d1eff5c-903b-47ad-9e07-ca1c4ef04fec
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: APPOINTMENT_MOVEMENT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c9e7f7bd-e411-494e-a072-19e47e99f7c5
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70061d14-12b3-4f95-80bb-3355b7e37b19
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_MOVEMENT_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c97b2fa0-e2e4-40a5-b5c2-ab17a7c6e493
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e936e892-eaac-4ba0-ba66-2a0dfc2b2ea0
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_outpatient_appointment_30.appointment_movement_reason_reference_no=dim_appointment_movement_reason.appointment_movement_reason_reference_no
        name: DIM_APPOINTMENT_MOVEMENT_REASON_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d59e458b-e36a-4513-af65-dc087868eded
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INT
        defaultValue: ""
        description: Number of times this appointment has been moved
        name: APPOINTMENT_RESCHEDULE_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 368ed41c-baab-4d91-bb12-82fb27069f29
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 055ad49e-765d-498b-b6cd-011c3c41042e
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INT
        defaultValue: ""
        description: staging field only to help identify mapping issues
        name: PUC_MAP_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ccf5e5d2-a5d2-4a09-9339-25c320596197
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26494d26-1780-42d5-af5e-e13aac23f72b
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.patient_reference_no=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 672e250b-9774-4b10-b37e-97e3dd0f1d99
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: Domilce code as at visit date
        name: DOMICILE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fefbd959-1bf5-4db8-a413-db849c1ba99b
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32164c42-d821-4504-a228-8fdd380c6e1e
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_outpatient_appointment_30.domicile_code=dim_domicile.domicile_code
        name: DIM_DOMICILE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 310e6b62-9db4-4317-9267-8fd23abdd761
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.patient_age_on_arrival_years=dim_age_group.age_years
        name: DIM_AGE_GROUP_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d562754-6763-48f1-be0a-eece97ec4838
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_outpatient_appointment_30.CONVERT(date,s_outpatient_appointment_20.patient_seen_by_date)=dim_seen_by_date.seen_by_calendar_date
        name: DIM_SEEN_BY_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee0b16f4-187c-4e44-a69c-8b1b5823c2d1
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: The aggregated encounter id that corresponds to the funded event. When outpatient events are captured during and inpatient event they are rolled up to the inpatient encounter ID
        name: FUNDED_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a488b3c-d04a-4f7a-8f81-77b38a42e539
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: isnull(s_outpatient_appointment_20.IP_event_encounter_id ,s_outpatient_appointment_20.outpatient_appointment_encounter_id)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b05b4559-300a-464e-82b2-ffadde4b5a5f
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: IP_EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a488b3c-d04a-4f7a-8f81-77b38a42e539
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32442fc9-461f-4ae2-b6bd-23be77c5d80d
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.principal_diagnosis_reference_no=dim_principal_diagnosis.principal_diagnosis_code
        name: DIM_PRINCIPAL_DIAGNOSIS_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ISNULL(dim_principal_diagnosis.dim_principal_diagnosis_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d6e6b2c-9def-4ac9-929f-f2bfb4203eb2
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.secondary_diagnosis_reference_no=dim_secondary_diagnosis.secondary_diagnosis_reference_no
        name: DIM_SECONDARY_DIAGNOSIS_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 822b9c65-3ebf-4311-acd4-8bb4f64176e1
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.primary_procedure_reference_no=dim_primary_procedure.primary_procedure_reference_no
        name: DIM_PRIMARY_PROCEDURE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c372a4b-8fd4-4c9e-bed2-745cf047f4b6
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.secondary_procedure_reference_no=dim_secondary_procedure.secondary_procedure_reference_no
        name: DIM_SECONDARY_PROCEDURE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2525dfc9-6311-4da6-b9cc-cf6a550494a9
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_OUTCOME_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c82e4700-09d2-4133-bc37-14423f9d6849
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e3bc27b-f9a3-4c54-a781-45fa615b0330
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.appointment_outcome_reference_no=dim_appointment_outcome.appointment_outcome_reference_no
        name: DIM_APPOINTMENT_OUTCOME_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da94b0cc-d0eb-4587-850c-873b90e34306
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: appointment_status_type_code, "A=Actual", "P=Planned", "C=Cancelled"
        name: APPOINTMENT_STATUS_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a080cd2-42f3-4a4d-b77b-ee806a8520a5
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bc34314c-bc09-4841-aba6-9907e6e2585e
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: appointment_contact_status_code, "A=Actual", "P=Planned", "C=Cancelled"
        name: APPOINTMENT_CONTACT_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8dea624c-90e7-46ad-9dc4-db7b291fa8ea
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5612f63e-2fe6-4307-9f21-e4f9659539c7
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: appointment_theatre_status_code, "A=Actual", "P=Planned", "C=Cancelled"
        name: APPOINTMENT_THEATRE_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d86368c-3073-478e-9d2c-df1831db6475
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d90c4d2e-8672-4fa8-860d-6d97e3a3dffc
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CANCELLATION_REASON_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c00b85f6-64eb-4da3-83fd-d690da244b5b
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 246406de-bba1-4701-9c88-3271b01e7d09
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CANCELLATION_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: adf5360d-9785-4f72-b7cc-bef43b164b34
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e256557-175d-4517-b8da-49e5aac23132
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: cancellation_Reason_Code
        name: CANCELLATION_REASON_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 159a571e-f6df-4302-b6d7-5cc613e6d4d5
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 176aadca-1fe1-4cfe-8ee2-bfeaaaef1a05
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.cancellation_reason_reference_no=dim_cancellation_reason.cancellation_reason_reference_no
        name: DIM_CANCELLATION_REASON_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb968bbe-baf6-4661-ba29-67164b47c6e3
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CANCELLATION_BY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0e72169c-ac34-4d6f-ab2c-14a48ff5de43
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55d19417-347f-40ce-b8bf-a3e52ce8fb9b
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.cancellation_by_reference_no=dim_cancellation_by.cancellation_by_reference_no
        name: DIM_CANCELLATION_BY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04059264-42bf-4261-8049-d765983f8f87
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.treatment_delay_reason_reference_no=dim_treatment_delay_reason.treatment_delay_reason_reference_no
        name: DIM_TREATMENT_DELAY_REASON_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86b1b6f4-f7fd-4f33-a153-5dd9e3bc2c78
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: FUP_ATTEND_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cfeaa7e7-8294-4683-8029-8d74f4e01db1
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.visit_type_reference_no=dim_visit_type.visit_type_reference_no
        name: DIM_VISIT_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e3a11e9-60ae-4a69-a74e-6eade6e20fda
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_URGENCY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bb0ba7cf-dc00-410a-8f9d-d08f498815e4
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 51330947-c4fb-4588-a4af-0b840ef19546
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.appointment_urgency_reference_no=dim_appointment_urgency.appointment_urgency_reference_no
        name: DIM_APPOINTMENT_URGENCY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4efd06ca-4aab-4b96-8be7-a8189bbe1c2d
                stepCounter: cad4e9bc-e2a6-4f01-95a2-e7de9a59f2c6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fddee233-a032-4b89-a9b1-64c27d518c6e
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_PRIORITY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 25a479ed-7e86-42d5-a573-e92f2ff37d90
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ae23412-37c4-4ab9-8c28-103e4c986446
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.appointment_priority_reference_no=dim_appointment_priority.appointment_priority_reference_no
        name: DIM_APPOINTMENT_PRIORITY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 99a95614-a517-4a9f-af70-d7764496df1a
                stepCounter: bdbb1bb6-7ef6-4b6f-8952-1f0428e20e66
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96b1f40b-3523-4b01-8cb6-fbeb0b46432d
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.transport_type_reference_no=dim_transport_type.transport_type_reference_no
        name: DIM_TRANSPORT_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1c597fe-6fa0-47fb-bcca-f91370e300d3
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ATTENDANCE_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a40a5145-d9f8-4372-b9a4-b5712fa6b53c
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a9bb113-353b-43e4-830d-6d33879fec50
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: ATTENDANCE_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 948ed0fe-3cad-4fd5-b840-607c64937af0
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5493674e-58ae-48c6-ba42-1d2c747448e8
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: DNA_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3dfbfc38-f6da-4f44-8dbf-bf9247c623c5
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INT
        defaultValue: ""
        description: Count of appointments where the patient Did Not Attend
        name: DNA_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE WHEN DNA_flag = 'Y' THEN 1
                          ELSE 0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6879213a-868c-494c-b396-baf5626bbb0c
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: first and subsequent specialist appointments  where the patient Did Not Attend. USed in the Hospital Advisory Committe KPI reporting.
        name: HAC_DNA_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2215a719-65c5-478d-934c-ebf79207fac8
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f0ffd35-7540-4714-a4a3-5d1afb133663
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INT
        defaultValue: ""
        description: Count of first and subsequent specialist appointments  where the patient Did Not Attend. USed in the Hospital Advisory Committe KPI reporting.
        name: HAC_DNA_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2215a719-65c5-478d-934c-ebf79207fac8
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: |-
              CASE WHEN s_outpatient_appointment_20.HAC_DNA_Flag = 'Y' AND DNA_flag = 'Y' THEN 1
                          ELSE 0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d4fec85-250a-41ab-9ab6-1fdf7e22eafc
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.attendance_status_reference_no=dim_attendance_status.attendance_status_reference_no
        name: DIM_ATTENDANCE_STATUS_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab84acce-4057-4ee5-a251-3f1868cbf85b
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DID_NOT_ATTEND_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 42071788-bd0f-47b9-a83e-a3b4e51b1324
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f569ce0a-7cac-4089-9751-7164aca30e25
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INT
        defaultValue: ""
        description: s_outpatient_appointment_30.did_not_attend_reason_reference_no=dim_DNA_reason.DNA_reason_reference_no
        name: DIM_DNA_REASON_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f832f68-2426-4f6c-82f4-d8013f52b4b7
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMIN_CATEGORY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cac9ace6-f1a1-4f02-8ec5-bed48dfd9ec9
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b75ac9b-6d6d-4c35-b62f-8e229fe8a7cd
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.admin_category_reference_no=dim_outpatient_admin_category.outpatient_admin_category_reference_no
        name: DIM_OUTPATIENT_ADMIN_CATEGORY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b0337513-1edc-4fef-a87e-4283243b5aa1
                stepCounter: da430422-115d-4e6b-8643-5f575efa48de
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e4df1a6-7f33-47f1-8092-b1db89f8da12
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_CHANGE_REQUEST_BY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7218736-5cee-4f6b-81d8-ee0f37ddb436
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 83bb8b41-8b5d-490b-9658-b2a3f2b55cbb
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.appointment_change_request_by_reference_no=dim_appointment_change_request_by.appointment_change_request_by_reference_no
        name: DIM_APPOINTMENT_CHANGE_REQUEST_BY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc4a2cf5-8f3e-4709-8587-4d038409f329
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CODING_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 29bd9acb-4613-4ee9-a4e3-db25b8840d0c
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f4648d0-a2ed-4eeb-bb36-269f18291751
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.coding_status_reference_no=dim_coding_status.coding_status_reference_no
        name: DIM_CODING_STATUS_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66440825-b229-4cac-af27-7864441cd87e
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.patient_confirmation_status_reference_no=dim_patient_confirmation_status.patient_confirmation_status_reference_no
        name: DIM_PATIENT_CONFIRMATION_STATUS_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 375864a2-7619-46e6-a0c7-391326f0074d
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.replace(s_outpatient_appointment_20.responsibility_centre_code,'-','')=dim_responsibility_centre.responsibility_centre_code  s_outpatient_appointment_30.'120'=dim_responsibility_centre.company_code
        name: DIM_RESPONSIBILITY_CENTRE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: isnull(dim_responsibility_centre_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 803d93f6-b1a3-4d46-b386-4fc5d4f1a4e2
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.purchase_unit_code=dim_purchase_unit.purchase_unit_code
        name: DIM_PURCHASE_UNIT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: isnull(dim_purchase_unit_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45acea22-222f-4d3a-8c8d-c2e2b7b1e54d
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ACC_FUNDED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 06695644-137c-467e-a143-2588518f66b3
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f5177f2-b110-4686-b09d-d326f7911eb2
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: APPROXIMATE_SCHEDULE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56cf0c6b-dc9c-45b2-bb25-47d6e95439e4
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59cc0b96-3d5b-4442-a4f1-2d801aaa4f3c
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FIRST_OUTPATIENT_APPOINTMENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4235b44-5ae1-46f4-ac65-2c7fb920e4e1
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 056af67a-d869-411e-b099-af1664a5a8be
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_APPOINTMENT_ARRIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd28b1ff-8ed9-419b-82cf-c71372db3378
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3d23df6-12c8-4b7a-91b8-ac38945abf5c
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_APPOINTMENT_SEEN_BY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 98e70ef6-7df9-4981-96cf-fb35d076a0e7
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ede90d71-9eca-47cf-8ef8-dda4583e9c76
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LAST_OUTPATIENT_APPOINTMENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f0bda4b-de3a-4afa-9d24-6832a1ab2e9a
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c1c0fc4-04f9-4446-b487-61082fdcf3b9
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_APPOINTMENT_SEEN_BY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eddcd273-c71d-448e-8b16-f124e2b1769f
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae0b27de-5f66-4b79-83c1-d7877d8c6a82
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_APPOINTMENT_DEPARTED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75a387af-ca4f-4a7e-8c45-94799e53a4e1
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c5082a4-b9ee-4f70-88ce-3fc62c2ef520
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: NUMERIC(15,2)
        defaultValue: ""
        description: ""
        name: ACTUAL_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05cbdd73-ea66-46c6-a524-ac8d5f58556c
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38a755dd-45ea-40ba-9c21-103060a25608
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: NUMERIC(15,2)
        defaultValue: ""
        description: ""
        name: BUDGET_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 295873af-f5b0-4ff7-8e76-bf23f4248fed
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d455d796-bffb-4fc4-a22b-07672d93357e
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DURATION_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d564dbf-9c6f-44e0-958f-0e6552b493a9
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a8f4f2e-e506-4495-8788-ea86431a9b29
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6118edce-4ce0-45f3-89fa-ae11973e2b0c
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29d19c1a-5969-431c-9755-0cf2136fee1e
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_DURATION_ARRIVED_TO_DEPARTED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ae79b56e-7912-46c0-bf55-d96841813520
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15c347b7-6620-4e86-9313-83d39e4dd7b5
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CURRENT_TO_NEXT_APPOINTMENT_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e68b3a4-2e12-44d3-a0d6-de7d46cd5d6c
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97247c1f-6b12-4dad-9d5b-a20fdae96d22
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FOLLOWUP_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 13746378-0ad6-406b-a545-24fa12d2c040
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8031a12-7f28-4dda-86ee-29dd5d06ce50
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ATTENDED_APPOINTMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN s_outpatient_appointment_20.attendance_status_code IN ('5','6','W') THEN 1
                          ELSE 0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 400199f6-7700-44c9-8328-c2466de6f865
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CANCELLED_APPOINTMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN s_outpatient_appointment_20.cancellation_reason_date IS NOT NULL THEN 1
                          ELSE 0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f89e092-5fa3-466d-b012-1bc2fb031ce6
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: APPOINTMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '1'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02b894b1-aa4c-4384-89a0-054b4ac53427
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47a4e912-7067-4313-a5e0-927277249ca7
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6edc24fe-634b-4a4d-9f57-9e268e819394
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5fc6b884-1b69-4055-99b4-d76c93a4ee03
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6b21393-be19-449c-92d6-8dc46fb4a5ea
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.create_user_login_code=dim_create_user_login.create_user_login_code
        name: DIM_CREATE_USER_LOGIN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f66fe8c-53f2-4535-9c8f-d5283175f8e6
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIFY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e22f763a-1142-4764-8e32-aacd54939262
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aec57dc6-fbbe-4686-b158-a76c018275c4
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: NEW_ATTEND_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba501a4a-5b4b-4987-a99c-33c17a27d223
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_appointment_30.modify_user_login_code=dim_modify_user_login.modify_user_login_code
        name: DIM_MODIFY_USER_LOGIN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8069fc5d-d399-4f0d-a8b9-0af860e81a17
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NEXT_OUTPATIENT_APPOINTMENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d9cb73e3-e174-4a7c-86af-83bf6ee522a5
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c1d07f0-edbb-431f-ae0b-d21cba307298
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DSS_DATA_QUALITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e184db59-4bbb-4b99-af1f-917f2f645541
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e92556cf-d690-483b-ae89-669e58a4946d
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: is the appointment outcome qualified as an NPF exception
        name: NPF_EXCEPTION_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE WHEN dim_appointment_outcome.exception_outcome_code IS NOT NULL AND appointment_start_date > '01-Jul-2014' THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d57e797-18ef-43b0-bbd4-f93fc265af54
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: OUTPATIENT_APPOINTMENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7324d402-3af1-42a1-91de-d1141256e4bf
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7daba009-029c-4683-9e5f-5f2df0c95e5b
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: OUTPATIENT_APPOINTMENT_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e78eacda-3878-4446-9c76-84b2f78c03bd
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29a641fa-f87a-454b-bc22-3bbacdbf5f98
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OUTPATIENT_APPOINTMENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18f964f3-d9ea-4689-b592-7fc7f2ab5404
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2d424cd-2a64-42ae-afff-bff5edc2f8e8
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OUTPATIENT_CLINIC_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e608bda2-ac53-4d00-a7c8-d5586df6dbdb
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2b7cfcf-823b-4758-b924-1612503fb818
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Health Specialty Code
        name: OUTPATIENT_HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 99c840df-d007-4996-a77b-03b0436c3da0
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3600e500-14f7-4a8c-add9-50c646590d4a
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OUTPATIENT_SESSION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e875d43-86b1-411e-a018-f2c18a234f9f
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 240fbfac-259f-4f74-ad35-8a69f83824d0
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Session from which a planned appointment was booked.  This is not populated once booked.
        name: PLANNED_FROM_OUTPATIENT_SESSION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 36fbec21-e91d-48c3-b893-3845fa4faa15
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5789907-1f23-476e-bb8f-982bf61caaee
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OUTPATIENT_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05dd629c-cc05-4507-921d-d8b208f7b13a
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf69de91-e29b-4020-997d-714275c32ad0
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: OVERBOOKED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d9a2932d-09f4-4a7a-a88c-a675d01d05ff
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42fe42bb-2cc2-419d-a2d2-b354fb1c9443
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PARENT_OUTPATIENT_APPOINTMENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ecc39cc2-9412-4d74-a08e-1a89266bc708
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05272eb0-1e75-4274-97b6-4cd0d87ed305
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_AGE_ON_ARRIVAL_YEARS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9e1468c7-4bb8-41c1-9698-d36ace5338b0
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66b4cc8a-4e4d-4b65-9052-2c4fea909121
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_APPOINTMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 990c1980-3b2e-47f5-9f8d-f92825835549
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ab630db-6471-4b0d-a2df-c42bb3b13cf2
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_APPOINTMENT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9434ee7d-3aea-45a1-84c4-01c95c22c3c8
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ecd5eb0-b482-4ff3-b17b-fe300722d558
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PATIENT_ARRIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5f9975d-ade3-4012-b1e7-88ddc8802f03
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3081ffdc-62fa-4b9e-9eaa-30084e189b00
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_CONFIRMATION_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6bc45882-a920-4ab4-8a54-a504d4e223d8
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5af7bee0-8a8c-46ea-94fc-a4c8930e5d1b
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PATIENT_DEPARTED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b0e21035-0d89-4b25-bf97-823d020ced40
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4304c60-2749-4049-8c46-1d4427c4aa30
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b827678-736c-47b3-9287-71ab49a8626c
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e529234-c9f2-4f34-8677-e6ad88d20e79
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5937816-a669-4a81-8144-a039893a0c79
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 90041e3d-9e2a-4f30-b85c-6abf9bd2f4e5
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PATIENT_SEEN_BY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bcd48c84-537c-4abe-99c3-ffe7ef69bbc0
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f05eb76-3631-4feb-a01f-a70c5d7b0d45
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PREV_OUTPATIENT_APPOINTMENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ccb605e-be9a-47d4-be47-b53a13ba98cf
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bcbd4902-32f3-445a-80fd-663fc0a1c033
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREVIOUS_TO_CURRENT_APPOINTMENT_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8742d7d3-3c5d-445c-8c50-f9d6aad25436
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7589c5ec-3563-4d09-b4b3-603341bb5b0e
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PRIMARY_PROCEDURE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3048885d-3c83-47d7-bb4f-9a9b49e99ce2
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ae4fe89-1220-42c8-8965-94fd577e3722
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRIMARY_PROCEDURE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f19380e-05f6-4b3d-9a32-e0629b1de290
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db981af9-68c1-4faa-8676-e2309cf3cf70
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PRINCIPAL_DIAGNOSIS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5111bbcb-d41f-4c7e-896a-927536375902
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2da8ca92-a324-4f30-a3a2-694d1d85132f
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRINCIPAL_DIAGNOSIS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c985baca-6aaf-488f-8c01-cd63513faeb6
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41eb0654-1bc0-4a66-b53b-f342d6f51dc9
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 328185cc-641e-474c-a136-0208f1378448
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ISNULL(CASE WHEN len(s_outpatient_appointment_20.purchase_unit_code_pre_01_07_2014)=0 THEN NULL ELSE s_outpatient_appointment_20.purchase_unit_code_pre_01_07_2014 END , purchase_unit_code_post_01_07_2014)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4395c1e-8621-49c9-b410-3778b8d382b2
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Excludes any DNAs and multiplies appointments by any RVU to give the purchase unit volume submitted to NNPAC
        name: PURCHASE_UNIT_VOLUME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 990c1980-3b2e-47f5-9f8d-f92825835549
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: |-
              CASE WHEN appointment_start_date >= dateadd(DAY,1,cast(getdate() AS date)) OR DNA_Flag = 'Y' OR s_outpatient_appointment_20.attendance_status_reference_no IN (11301, -- DNA
              11540, -- Not Specified
              1000010399, --cancelled
              1000010400, --Cancelled or Postponed
              1000010402, -- Patient Arrived Late and Could not be Seen
              1000010403, -- Unable to Attend
              1000010404, -- Did Not Attend
              1400017621 -- Did Not Wait
              ) OR s_outpatient_appointment_20.IP_event_encounter_id IS NOT NULL OR s_outpatient_appointment_20.cancellation_reason_date IS NOT NULL OR s_outpatient_appointment_20.ACC_funded_flag = 'Y' THEN 0
                          WHEN isnull(s_outpatient_appointment_20.purchase_unit_code_pre_01_07_2014, s_outpatient_appointment_20.purchase_unit_code_post_01_07_2014) like 'OT05001%'                                                                                                                                                                                                                                                                                                                                                                                                                                                           THEN cast(s_outpatient_appointment_20.appointment_duration_arrived_to_departed AS MONEY)/60
                          ELSE 1
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eff7c130-de47-4b99-8e29-f18340a58e76
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a77a3387-2e4e-48bd-a9d8-a23b1db1c7d3
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: "'R'+CONVERT(varchar,s_outpatient_appointment_20.referral_reference_no)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8af63674-e35e-4402-975b-56c7fd74d3e2
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: RESPONSIBILITY_CENTRE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 619292ab-f560-4f15-ab7b-78e0961a3ef2
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 949dfbc4-0abe-4b54-bbff-67d3cf6223d8
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SECONDARY_DIAGNOSIS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d99f982-2609-41f1-8036-85dd3a91fe42
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa882fac-1b1b-42db-a29e-cccb1d8f7d3c
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SECONDARY_DIAGNOSIS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d82bfeb-09b5-4e24-998c-4dbcbaa0bac8
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2eb2aa75-0b7c-4dbd-b6b7-a2211956e277
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SECONDARY_PROCEDURE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 200c982e-5a75-4d3a-b7c5-d31c9aae3be1
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c1debf9-1762-4b2b-997e-816c5014de3f
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SECONDARY_PROCEDURE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce90f14e-f991-4a32-b828-bbe268875fed
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 745374b6-bcec-4961-a3a9-97679e787479
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f2fa57ed-b622-4de8-88c8-df9b20a241a9
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1fe54980-7a26-490f-b5c5-6e1e57847ea8
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_APPOINTMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 85469401-8ed6-44ab-b3e3-03e4dd29d4c3
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 159ace7a-be50-47f0-aa7e-ee38db4d7262
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_APPOINTMENT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4ff245d-4d26-4831-9946-0e1e08f94cc0
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7be0575-8740-4e04-a759-22c535939fcf
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: TRANSPORT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 330ef2a7-84e5-4e0b-9df4-f33815859205
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a36fccfb-0392-449d-aae4-72f442fe74c9
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: TREATMENT_DECISION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 58e19f8a-27e5-4065-9c3f-db74de4541d1
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48784cfc-9c4e-4a3e-b744-f5489326da8d
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: TREATMENT_DELAY_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 794f1ece-7e75-4e8f-9c4a-5e977c0d5349
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0162400-3450-4524-b095-1120f69fafdc
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: UNPLANNED_RETURN_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ce11555-5235-427a-b326-8718ca2ea4b7
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7fcdd3e-21d4-4aca-962e-a440f22450fe
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: VIRTUAL_APPT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 17652cc3-ffda-4a9d-abe2-65a1c27b254b
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1634838-e432-4ab4-bbb7-1e00ea9842ea
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: VISIT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a932dd33-a3e3-40d3-8f1d-5b1b6e9d56f9
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11a51381-9084-416a-9907-f69b5e36d748
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: WAITLIST_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4450971-99fd-41f2-ac8a-34f8acd21620
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: "'W'+CONVERT(varchar,s_outpatient_appointment_20.waitlist_reference_no)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2f0b763-c232-4b19-b8ef-219f589ba531
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Sequence for appointment within waitlist ordered from most recent to oldest
        name: WAITLIST_SCHEDULE_REV_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2a1e8e71-cb90-4424-9377-f2a5d18063b1
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ed7622e-00d5-4e30-b3ab-05f8bd141d0a
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_APPOINTMENT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2eb90e1b-ed40-453d-bc67-300cb7b324e6
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 527b8c64-0452-4949-bb14-efa35ee36f2b
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_SCHEDULE_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa14c107-451a-4549-ae23-508bf0b57567
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f484b98-1dd8-4f50-b13b-ad6aed1da332
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INT
        defaultValue: ""
        description: Sequence for appointment within waitlist ordered from oldest to most recent
        name: WAITLIST_SCHEDULE_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3fa44fad-0a6d-4f55-a423-d8d25f477d32
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f42d0848-0650-4aa0-a4a7-42f4538bcc73
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MODIFY_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5ebba5c-293e-4016-b180-146fa412574d
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b567bed1-0edb-4639-b0b0-d2ac01c7bfd9
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Is this referral an National patient flow referral, Note this rule is the ESPI1 rule plus Surveillance
        name: NPF_PRESENTING_REFERRAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: da19b59d-2251-4f61-81fb-9563dedb7887
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 024386ef-46a5-4cb8-b0f6-a93eb860878e
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: 'Is this appointment on a National patient flow referral but not associated with a waitlist?  If so we send it as an activity and activity outcome  '
        name: NPF_NON_WAITLIST_ACTIVITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: da19b59d-2251-4f61-81fb-9563dedb7887
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: |-
              CASE WHEN s_outpatient_appointment_20.NPF_presenting_referral = 'Y' AND s_outpatient_appointment_20.waitlist_reference_no IS NULL THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8678e46-df3c-4f07-815f-ae4bf91f013c
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: VARCHAR(MAX)
        defaultValue: ""
        description: ""
        name: COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f37486f4-7eb7-45a2-a188-a7c904fe535a
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c794f2b1-be29-4b17-9a50-8900e05de8f6
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: SCHDL_COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a7b7fda0-7826-4679-be0f-229f52344626
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c029cb49-2c4e-4d68-a385-3031d89292fd
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: REASN_COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 567f0d1e-c836-4e0c-98fe-5cf5b35ea0f1
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77c3a67f-3dcf-456a-9331-524dc7f9d808
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ACCINDICATORID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 54c012c3-5403-4a55-83c5-28d05d8aa857
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5bf3eab8-8b53-40bb-a34b-68e3e8540b92
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_outpatient_appointment_30.ACCIndicatorID=dim_Outpatient_ACCIndicators.LocalCode
        name: DIM_OUTPATIENT_ACCINDICATORS_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ad6b93b6-25dc-4e89-9e88-a9e71d329e7c
                stepCounter: f2ba5841-b995-4f4e-9d22-63c680d9d243
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a55c0fb-71f9-4979-a5e2-9cf8433beab6
          stepCounter: 8f406b93-230e-4ca7-9b71-7b9b61be080b
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 721b668c-1934-4840-b88a-ff3823981df0
                stepCounter: b53b4d60-f49a-4251-a3ac-196984981a97
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_OUTPATIENT_APPOINTMENT_20: b53b4d60-f49a-4251-a3ac-196984981a97
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: UNKNOWN
            nodeName: DIM_ENCOUNTER_TYPE
          - locationName: STAGE
            nodeName: S_OUTPATIENT_APPOINTMENT_20
          - locationName: UNKNOWN
            nodeName: DIM_PRINCIPAL_DIAGNOSIS
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','S_OUTPATIENT_APPOINTMENT_20') }} s_outpatient_appointment_20
              LEFT JOIN {{ ref('UNKNOWN','DIM_PRINCIPAL_DIAGNOSIS') }} dim_principal_diagnosis
                ON s_outpatient_appointment_20.principal_diagnosis_reference_no = dim_principal_diagnosis.principal_diagnosis_reference_no
               AND ISNULL(dim_principal_diagnosis.dss_start_date, GETDATE()-10000) <= s_outpatient_appointment_20.appointment_start_date
               AND ISNULL(dim_principal_diagnosis.dss_end_date, GETDATE()+10000) >= s_outpatient_appointment_20.appointment_start_date
              LEFT OUTER JOIN [dim].[dim_purchase_unit]
                ON ISNULL(CASE WHEN len(s_outpatient_appointment_20.purchase_unit_code_pre_01_07_2014)=0 THEN NULL ELSE s_outpatient_appointment_20.purchase_unit_code_pre_01_07_2014 END , purchase_unit_code_post_01_07_2014) = dim_purchase_unit.purchase_unit_code
               AND ISNULL(dim_purchase_unit.validity_start_date, GETDATE()-10000) <= s_outpatient_appointment_20.appointment_start_date
               AND ISNULL(dim_purchase_unit.validity_end_date, GETDATE()+10000) >= s_outpatient_appointment_20.appointment_start_date
              LEFT JOIN l_mappings_planned_care_OP
                ON l_mappings_planned_care_OP.purchase_unit_code = ISNULL(CASE WHEN len(s_outpatient_appointment_20.purchase_unit_code_pre_01_07_2014)=0 THEN NULL ELSE s_outpatient_appointment_20.purchase_unit_code_pre_01_07_2014 END , purchase_unit_code_post_01_07_2014)
              LEFT JOIN dim.dim_planned_care
                ON dim_planned_care.planned_care_intervention_component = [l_mappings_planned_care_OP].planned_care_intervention_component
        name: S_OUTPATIENT_APPOINTMENT_30
        noLinkRefs: []
  name: S_OUTPATIENT_APPOINTMENT_30
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
