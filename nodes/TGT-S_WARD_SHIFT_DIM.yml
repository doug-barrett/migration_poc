fileVersion: 1
id: a18bc076-c380-4661-b7c4-e1b900547ff6
name: S_WARD_SHIFT_DIM
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9463a9d1-00c4-4383-a3e2-9260104211d8
          stepCounter: a18bc076-c380-4661-b7c4-e1b900547ff6
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: ""
        name: TRENDCARE_WARD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cc8688f4-65bc-4dfd-ac3b-4bfe55e5c075
                stepCounter: e09bdbcd-6149-4cdd-9077-83ff8568435b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6486678e-5f6d-4692-a0a9-045c22766223
          stepCounter: a18bc076-c380-4661-b7c4-e1b900547ff6
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: SHIFT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d9b26062-13c7-47c5-a909-a8e5f42a4424
                stepCounter: e09bdbcd-6149-4cdd-9077-83ff8568435b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eeca8f67-d892-4f03-898d-bc8240e9ddb1
          stepCounter: a18bc076-c380-4661-b7c4-e1b900547ff6
        config: {}
        dataType: NUMERIC(9,2)
        defaultValue: ""
        description: ""
        name: SHIFT_START_TIME_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f818f25d-6ad4-46f1-beee-8a97c36d3e53
                stepCounter: e09bdbcd-6149-4cdd-9077-83ff8568435b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 043da1e0-c3f7-4a46-98a1-d8a68749f5a4
          stepCounter: a18bc076-c380-4661-b7c4-e1b900547ff6
        config: {}
        dataType: NUMERIC(9,5)
        defaultValue: ""
        description: ""
        name: SHIFT_END_TIME_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 36dc1e38-2e3b-43d9-a9fa-ec210538eeef
                stepCounter: e09bdbcd-6149-4cdd-9077-83ff8568435b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78166e94-b02d-4ab3-86cd-04706479a731
          stepCounter: a18bc076-c380-4661-b7c4-e1b900547ff6
        config: {}
        dataType: NUMERIC(9,5)
        defaultValue: ""
        description: ""
        name: SHIFT_LENGTH_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a720e4d-ea47-4b23-a4b9-a3e3050ed623
                stepCounter: e09bdbcd-6149-4cdd-9077-83ff8568435b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b56924e1-3477-4ed8-bc44-d117139729a8
          stepCounter: a18bc076-c380-4661-b7c4-e1b900547ff6
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: SHIFT_START_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: RIGHT('0' + CONVERT(varchar, FLOOR(shift_start_time_num)), 2) + ':' + RIGHT('0' + CONVERT(varchar, CONVERT(int, (shift_start_time_num - FLOOR(shift_start_time_num)) * 60)), 2)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db272b50-9441-48cb-a077-8ff082806a08
          stepCounter: a18bc076-c380-4661-b7c4-e1b900547ff6
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: SHIFT_END_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: RIGHT('0' + CONVERT(varchar, FLOOR(shift_end_time_num)), 2) + ':' + RIGHT('0' + CONVERT(varchar, CONVERT(int, ROUND((shift_end_time_num - FLOOR(shift_end_time_num)) * 60, 0))), 2)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48f9415e-cb31-47eb-9ae6-ae8596b5f328
          stepCounter: a18bc076-c380-4661-b7c4-e1b900547ff6
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: SHIFT_LENGTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: CONVERT(varchar, FLOOR(shift_length_num)) + ':' + RIGHT('0' + CONVERT(varchar, CONVERT(int, CEILING((shift_length_num - FLOOR(shift_length_num)) * 60))), 2)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f46dc56-ff61-4acc-b73b-becd4f679757
          stepCounter: a18bc076-c380-4661-b7c4-e1b900547ff6
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Day, Evening or Night
        name: SHIFT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d9b26062-13c7-47c5-a909-a8e5f42a4424
                stepCounter: e09bdbcd-6149-4cdd-9077-83ff8568435b
            transform: |-
              CASE s_ward_shift_dim_10.shift_code
                          WHEN 'D'                       THEN 'Day'
                          WHEN 'E'                       THEN 'Evening'
                          WHEN 'N'                       THEN 'Night'
                          ELSE 'Unknown'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d427b6f8-539d-4413-81a7-bf590abd4177
          stepCounter: a18bc076-c380-4661-b7c4-e1b900547ff6
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PIMS_WARD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e0ef9ddb-0b61-487d-ab0d-ad159fdeed0e
                stepCounter: 1bd6e63a-9925-418b-9449-acaed616a7f0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 65baf514-8750-4e30-80ce-5f491362fa1c
          stepCounter: a18bc076-c380-4661-b7c4-e1b900547ff6
        config: {}
        dataType: INT
        defaultValue: ""
        description: Service_Point_Reference_Number
        name: WARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe4759bc-c968-4e0b-95f7-850118a3d88b
                stepCounter: 50c31151-9204-4154-9caf-5d28244bde1a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b221532-63fb-40ea-978c-1fbc4c6cca78
          stepCounter: a18bc076-c380-4661-b7c4-e1b900547ff6
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_WARD_SHIFT_DIM_10
        join:
          joinCondition: |-
            FROM s_ward_shift_dim_10
              LEFT OUTER JOIN l_mappings_WardsTC
                ON l_mappings_WardsTC.wdWardCode = s_ward_shift_dim_10.trendcare_ward_code
               AND l_mappings_WardsTC.End_Date IS NULL
              LEFT OUTER JOIN dim.dim_ward
                ON dim_ward.ward_code = l_mappings_WardsTC.PiMSWardCode
               AND dim_ward.dss_current_flag = 'Y'
               AND LEFT(dim_ward.ward_name, 3) <> 'XXX'
        name: S_WARD_SHIFT_DIM
        noLinkRefs: []
  name: S_WARD_SHIFT_DIM
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
