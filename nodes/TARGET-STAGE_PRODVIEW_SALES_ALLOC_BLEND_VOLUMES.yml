fileVersion: 1
id: 23118eed-02c2-490c-8b26-2aee26d1bdf6
name: STAGE_PRODVIEW_SALES_ALLOC_BLEND_VOLUMES
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "Prodview allocated volumes"
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8558a501-76fa-40e2-98c6-daaddf807dfd
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: IDRECUNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 850244b2-cf63-447e-9a9e-2898428215e9
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70f4c4f7-70a4-45bf-9472-d83a59103020
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: IDFLOWNET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e1da49e-8182-4861-8905-81254314693e
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c552c3c7-3956-4ad2-a8f9-c0a33f6771b2
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ENTITY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 772019ac-3ca7-4166-bac9-02765e1433aa
                stepCounter: a3aef473-15c0-437b-be53-6abfe8efbd45
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21fe9360-f9a9-4cbc-9ee3-8a83715f49ad
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SCENARIO_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: "'pv_sales_alloc_blend'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ea45135-a14d-4cb3-a873-1adeb4fc550e
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ACTIVITY_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f12a712-52a9-49bc-b9b3-9f6c776cada1
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: TO_VARCHAR(ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DTTM, 'YYYYMMDD')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64b7dac5-c781-484e-93e6-a40a1c594b65
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: ACTIVITY_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f12a712-52a9-49bc-b9b3-9f6c776cada1
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96e03c50-eddd-4b73-9c68-6d04682555a8
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: NORMALIZED_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1ad647c-d9d9-4a5e-a6cb-9b1d6b6dd6ec
                stepCounter: a3aef473-15c0-437b-be53-6abfe8efbd45
            transform: |-
              CASE WHEN STAGE_PRODVIEW_WELLS.ON_PROD_DATE IS NULL                                  THEN '-1'
                          WHEN STAGE_PRODVIEW_WELLS.ON_PROD_DATE > ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DTTM THEN '-1'
                          ELSE DATEDIFF(DAY, STAGE_PRODVIEW_WELLS.ON_PROD_DATE, ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DTTM) + 1
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7530d3c0-f9a9-46b2-a8e9-f4cb2f580faa
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PRODUCING_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed435aa9-8a64-4b90-a9f6-5ff1f2e3f88a
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ON_PROD_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: COALESCE(TO_VARCHAR(STAGE_PRODVIEW_WELLS.ON_PROD_DATE, 'YYYYMMDD'), '-1')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87cf8ccf-bef1-47d3-849f-a5096b180c31
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: The cost centre which the reporting entity is representing.
        name: CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3499517-4f35-4f0e-b240-2c09ebb060a0
                stepCounter: a3aef473-15c0-437b-be53-6abfe8efbd45
            transform: COALESCE(STAGE_PRODVIEW_WELLS.CC_NUM, '-1')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a408d38f-810a-496a-8660-d9ce62267bf2
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: HOURS_ON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 565c3190-bc88-4ecf-8f99-070028fb908c
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DUROP * 24
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42386cd0-0d75-4985-8d04-9facacbc8ea1
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: HOURS_DOWN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b51b4b24-93e1-450a-abda-190776b9def9
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DURDOWN * 24
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 508d9964-ac12-4db7-ba5c-8eff30693073
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: HCLIQ_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07b15b03-23c0-4b55-b2de-ce0997f6d260
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82244c54-9812-4a05-ab64-a27a7b995c6e
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: OIL_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84c2e90c-25c5-4b2c-a586-411562b4131d
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c05c11ef-f39e-4a99-8592-955108f59618
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: CONDENSATE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ccd7cb6f-3240-43b7-8466-e1f54574e4db
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d44cd4c-42b4-429d-b1f5-004082239702
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: NGL_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 962ca092-8160-49e1-bd11-5560781451af
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27e821e6-46ee-4b34-a0fd-312463af8551
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f96f380d-7eb3-47f2-975c-41a32d8492bb
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: |-
              CASE WHEN STAGE_PRODVIEW_WELLS.QBYTE_PROVINCE_DISTRICT = 'BRITISH COLUMBIA' THEN (ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.VOLDISPSALEGAS * COALESCE((ODS_PVIEW_PVT_PVUNITMETERRATEENTRY.RATE/100), 1))/1000
                          ELSE ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.VOLDISPSALEGAS/1000
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b921001c-469d-4f3c-a58b-3d339ccc4250
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1a8bf3e0-4605-42d8-952d-e12b80f99266
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59cc76ad-7ff9-4064-996e-3e68602fe271
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: SAND_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 04480156-6e75-432b-8d56-7ea513f7b123
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3bc8b4ae-a5e7-49a4-a22b-4b7b092901d0
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90040229-c62c-42c9-bb07-2139dea4c0cc
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.VOLINJECTGAS/1000
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 204cf80f-1163-4cc9-9787-c377b3e6f389
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_HCLIQ_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 34116b5d-1330-4ec3-b490-d09dd28cecb0
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e19e89c9-41c2-48ae-b55f-90341796699c
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_SAND_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c6d30d4-f340-47fe-a4a2-6e5cd2454c28
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f8ca4e46-13fc-44b0-af2e-68e4c41c40e9
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce8f6ae1-15cb-4bad-b309-5020a5336519
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55efb641-2f8b-4398-a0ca-0923e5cda613
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: RECOVERED_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dd33f6d1-2157-4ed6-a092-118da79149f6
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.VOLRECOVGAS/1000
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be9c6d1b-12b3-4149-997d-678e4121565f
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: RECOVERED_HCLIQ_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1ec5c6f-8d66-49f8-8623-abce9642c5be
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f37bda7c-6371-4472-bb6b-e4e4bdd215a5
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: RECOVERED_SAND_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 279634bf-cda5-473c-883b-eef6222d7b18
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a5a3ca5-fb74-452e-8ebe-0594afd17b8c
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: RECOVERED_WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa874acd-4dde-48fc-97a7-7ad5feb4a1ae
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1dee39a-94a2-4c6e-9ceb-1bf34ae8a31e
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: REMAINING_LIFT_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5da7e4e9-94b8-405f-833a-f6b400c2b553
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.VOLREMAINRECOVGAS/1000
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34b4c6d8-7fbe-4f88-8801-4e8fe6ca7f22
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: REMAINING_LOAD_HCLIQ_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f3695d77-a7ab-4bb0-a7e6-b02f8e5a856d
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a277309-4062-4356-876d-005cde5b1ab3
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: REMAINING_LOAD_WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 36ccb9b3-b958-4dad-9663-c4aa76c0124a
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7527bd78-3070-4486-b13e-31d757b29f83
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: REMAINING_LOAD_SAND_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: baeb581d-0e76-4af3-95ec-9fd0d745483d
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57c5f377-e4ee-4b9d-bcea-8d3deffbeca3
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: METHANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5678e20-fc15-4855-a809-3b0280d87694
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: ETHANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f95c27e-4e26-4e5b-a7ac-1a76dd702d70
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: PROPANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 737f5773-47d7-4015-8a4f-7131663e6db1
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: BUTANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cfab359e-c838-4284-88a4-3e5dfb5fa66e
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: PENTANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57883809-b598-420e-bebd-9966eb5d37ea
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WIGAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c20e0f47-3157-4ac3-b43f-71f5fe1a075d
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a3ea6ef-2f57-4dcf-abbf-cbb49cd4c592
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WIHCLIQ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56af0ab0-f80f-4382-9236-5939ab19ee61
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64f34968-7bd4-43c4-a9f6-15c0cb50aade
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WISAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc98fd8d-12e4-4909-875b-d54734241f4a
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e6b62c8-9e14-4e6e-b8b2-68f862494f20
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WIWATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60f030ec-4d2a-43f6-ab43-1b5e3ad5523b
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97d853b9-9913-4ed6-b798-5da3121a0d96
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: FLAREGAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bffe90e0-6fc0-43cf-a395-a3e9d7164881
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.VOLDISPFLAREGAS/1000
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 871a3182-8fdb-49d1-b8eb-12b1f9b88037
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: VENTGAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 61d4a818-4b9a-4202-bb5d-a0a3bc8f2248
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.VOLDISPVENTGAS/1000
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b26a8ae-63d1-4e6c-bccf-cd9ff3f5d16d
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: FUELGAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 42222f1f-b2db-4445-a83e-09824bf693e6
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.VOLDISPFUELGAS/1000
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9875d8ff-b01b-4abb-8edb-5d19a59fd19a
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: BAT_PRO_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 083648bd-112d-422a-8b71-d8f4e9d39bd3
                stepCounter: 42f768bb-fb2a-47f9-93bf-21ed4e6d6271
            transform: ODS_PVIEW_PVT_PVFACILITYMONTHDAYCALC.BALFACTGAS * ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.VOLPRODGATHGAS / 1000
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed67b279-f989-4afb-be73-4e8791962db7
          stepCounter: 23118eed-02c2-490c-8b26-2aee26d1bdf6
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_LIFT_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d9ad3a2d-08e8-4dd6-bf6c-8d17850c46c9
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.VOLINJECTRECOVGAS/1000
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY: b78e68df-21f7-427c-9ce7-426d1d304567
          STAGE_PRODVIEW_WELLS: a3aef473-15c0-437b-be53-6abfe8efbd45
          ODS_PVIEW_PVT_PVUNITDISPMONTHDAY: 1daa6538-d61f-42cb-8ade-361a2b4e661e
          ODS_PVIEW_PVT_PVUNITNODE: 41be665a-471a-4369-9504-43fe682f5f4f
          ODS_PVIEW_PVT_PVFACILITYMONTHDAYCALC: 42f768bb-fb2a-47f9-93bf-21ed4e6d6271
          ODS_PVIEW_PVT_PVFACILITYMONTHCALC: 45def000-6955-461f-81a5-4ee924b9500b
          ODS_PVIEW_PVT_PVFACILITY: 2069364e-b829-44bc-90fd-46cb967ac2ee
          ODS_PVIEW_PVT_PVUNITMETERRATEENTRY: e0f8bbf5-fbc2-4469-8dab-6c0f0e6dd206
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY
          - locationName: TARGET
            nodeName: STAGE_PRODVIEW_WELLS
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITDISPMONTHDAY
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITNODE
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVFACILITYMONTHDAYCALC
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVFACILITYMONTHCALC
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVFACILITY
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITMETERRATEENTRY
        join:
          joinCondition: |-
            EXTENDED
              FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY') }} ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY
              JOIN {{ ref('TARGET','STAGE_PRODVIEW_WELLS') }} STAGE_PRODVIEW_WELLS
                ON ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.IDFLOWNET = STAGE_PRODVIEW_WELLS.IDFLOWNET
               AND ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.IDRECUNIT = STAGE_PRODVIEW_WELLS.ENTITY_KEY
              LEFT JOIN (
                    SELECT ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDFLOWNET,
                           ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDRECUNIT,
                           ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.DTTM AS ACTIVITY_DATE,
                           SUM(NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLC1LIQ, 0)) AS METHANE_METRIC,
                           SUM(NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLC2LIQ, 0)) AS ETHANE_METRIC,
                           SUM(NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLC3LIQ, 0)) AS PROPANE_METRIC,
                           SUM(NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLIC4LIQ, 0) + NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLNC4LIQ, 0)) AS BUTANE_METRIC,
                           SUM(NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLIC5LIQ, 0) + NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLNC5LIQ, 0) + NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLC6LIQ, 0) + NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLC7LIQ, 0)) AS PENTANE_METRIC
                      FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITDISPMONTHDAY') }} ODS_PVIEW_PVT_PVUNITDISPMONTHDAY
                      LEFT JOIN {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITNODE') }} ODS_PVIEW_PVT_PVUNITNODE
                        ON ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDRECDISPUNITNODE = ODS_PVIEW_PVT_PVUNITNODE.IDREC
                       AND ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDFLOWNET = ODS_PVIEW_PVT_PVUNITNODE.IDFLOWNET
                       AND ODS_PVIEW_PVT_PVUNITNODE.DSS_CURRENT_FLAG = 'Y'
                       AND ODS_PVIEW_PVT_PVUNITNODE.DSS_DELETE_FLAG != 'Y'
                     WHERE ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.DSS_CURRENT_FLAG = 'Y'
                       AND ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.DSS_DELETE_FLAG != 'Y'
                       AND LOWER(ODS_PVIEW_PVT_PVUNITNODE.TYPDISPHCLIQ) = 'ngl'
                     GROUP BY ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDFLOWNET,
                              ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDRECUNIT,
                              ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.DTTM
                   ) ODS_PVIEW_PVT_PVUNITDISPMONTHDAY
                ON ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.IDRECUNIT = ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDRECUNIT
               AND ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DTTM = ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.ACTIVITY_DATE
               AND ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.IDFLOWNET = ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDFLOWNET
              LEFT JOIN (
                    SELECT ODS_PVIEW_PVT_PVFACILITYMONTHDAYCALC.BALFACTGAS,
                           ODS_PVIEW_PVT_PVFACILITY.IDREC AS IDRECFACILITY,
                           ODS_PVIEW_PVT_PVFACILITYMONTHDAYCALC.DTTM
                      FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVFACILITYMONTHDAYCALC') }} ODS_PVIEW_PVT_PVFACILITYMONTHDAYCALC
                      JOIN {{ ref('TARGET','ODS_PVIEW_PVT_PVFACILITYMONTHCALC') }} ODS_PVIEW_PVT_PVFACILITYMONTHCALC
                        ON ODS_PVIEW_PVT_PVFACILITYMONTHDAYCALC.IDRECPARENT = ODS_PVIEW_PVT_PVFACILITYMONTHCALC.IDREC
                       AND ODS_PVIEW_PVT_PVFACILITYMONTHCALC.DSS_CURRENT_FLAG = 'Y'
                       AND ODS_PVIEW_PVT_PVFACILITYMONTHCALC.DSS_DELETE_FLAG != 'Y'
                      JOIN {{ ref('TARGET','ODS_PVIEW_PVT_PVFACILITY') }} ODS_PVIEW_PVT_PVFACILITY
                        ON ODS_PVIEW_PVT_PVFACILITYMONTHCALC.IDRECPARENT = ODS_PVIEW_PVT_PVFACILITY.IDREC
                       AND ODS_PVIEW_PVT_PVFACILITY.DSS_CURRENT_FLAG = 'Y'
                       AND ODS_PVIEW_PVT_PVFACILITY.DSS_DELETE_FLAG != 'Y'
                     WHERE ODS_PVIEW_PVT_PVFACILITYMONTHDAYCALC.DSS_CURRENT_FLAG = 'Y'
                       AND ODS_PVIEW_PVT_PVFACILITYMONTHDAYCALC.DSS_DELETE_FLAG != 'Y'
                   ) ODS_PVIEW_PVT_PVFACILITYMONTHDAYCALC
                ON ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.IDRECFACILITY = ODS_PVIEW_PVT_PVFACILITYMONTHDAYCALC.IDRECFACILITY
               AND ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DTTM = ODS_PVIEW_PVT_PVFACILITYMONTHDAYCALC.DTTM
              LEFT JOIN (
                    SELECT DTTM AS START_DATE,
                           COALESCE(DATEADD(DAY, -1, LEAD(DTTM) OVER (ORDER BY DTTM)), '2999-12-31') AS END_DATE,
                           RATE
                      FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITMETERRATEENTRY') }} ODS_PVIEW_PVT_PVUNITMETERRATEENTRY
                     WHERE ODS_PVIEW_PVT_PVUNITMETERRATEENTRY.IDRECPARENT = 'B4E41CDA995F4FD0BDEF2233B7D9D8B8'
                       AND ODS_PVIEW_PVT_PVUNITMETERRATEENTRY.DSS_CURRENT_FLAG = 'Y'
                       AND ODS_PVIEW_PVT_PVUNITMETERRATEENTRY.DSS_DELETE_FLAG != 'Y'
                   ) ODS_PVIEW_PVT_PVUNITMETERRATEENTRY
                ON ODS
        name: STAGE_PRODVIEW_SALES_ALLOC_BLEND_VOLUMES
        noLinkRefs: []
  name: STAGE_PRODVIEW_SALES_ALLOC_BLEND_VOLUMES
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
