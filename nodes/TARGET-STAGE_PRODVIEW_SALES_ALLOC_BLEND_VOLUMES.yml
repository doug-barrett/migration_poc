fileVersion: 1
id: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
name: STAGE_PRODVIEW_SALES_ALLOC_BLEND_VOLUMES
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "Prodview allocated volumes"
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d512c78-528a-49d1-b2a9-0ed076cb9998
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: IDRECUNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52601fc0-68e1-4e5f-876a-00645d2f467e
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 346c1d96-b813-470f-a0d2-13908abe49f5
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: IDFLOWNET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e63ff1c0-dd08-4f41-8d3f-2e5a1b550560
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce59da61-76ee-4552-b3c9-e8ecf6bd8483
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ENTITY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 66fb5299-e0ba-46ea-9fd9-f602d14f76c8
                stepCounter: e3f3cfdf-bda2-498e-bd55-26e7262626ae
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1fdaae4c-c21a-449a-8d35-9af577f212da
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SCENARIO_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: "'pv_sales_alloc_blend'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 997b2ff2-20a2-4bbb-beba-8967aef1e6da
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ACTIVITY_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e23862e-5f1c-4ceb-9ed3-26e0c07e30fc
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: TO_VARCHAR(ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DTTM, 'YYYYMMDD')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2bc6c411-5d8b-4a22-bce3-c70ea41f738c
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: ACTIVITY_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e23862e-5f1c-4ceb-9ed3-26e0c07e30fc
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a2827fc-7078-418f-9e1f-fa737a786f59
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: NORMALIZED_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d0a1178d-0a76-4a6d-987d-882feb580e1c
                stepCounter: e3f3cfdf-bda2-498e-bd55-26e7262626ae
            transform: |-
              CASE WHEN STAGE_PRODVIEW_WELLS.ON_PROD_DATE IS NULL                                  THEN '-1'
                          WHEN STAGE_PRODVIEW_WELLS.ON_PROD_DATE > ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DTTM THEN '-1'
                          ELSE DATEDIFF(DAY, STAGE_PRODVIEW_WELLS.ON_PROD_DATE, ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DTTM) + 1
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 532e137b-3050-4579-8cf8-ae32b4d0b000
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PRODUCING_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 56716c78-7766-466c-bcf0-ee73406dec94
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ON_PROD_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: COALESCE(TO_VARCHAR(STAGE_PRODVIEW_WELLS.ON_PROD_DATE, 'YYYYMMDD'), '-1')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3a19f43-c47a-44bb-b926-a99a9d8d7939
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: The cost centre which the reporting entity is representing.
        name: CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cdb42138-383e-4153-8935-35b2b72dc8fe
                stepCounter: e3f3cfdf-bda2-498e-bd55-26e7262626ae
            transform: COALESCE(STAGE_PRODVIEW_WELLS.CC_NUM, '-1')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b9e1ff1-16e2-4e75-8fe3-8c11c2cca786
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: HOURS_ON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 81e344fc-8e1c-48b6-b2a3-4528e7962c25
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DUROP * 24
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a9416cb-6bd5-424f-8548-9112beb74684
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: HOURS_DOWN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 849b0441-aadd-4df8-aa0c-bef157b937d0
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DURDOWN * 24
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91defdcd-4a44-4081-a7a7-fbfcf01bd0ce
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: HCLIQ_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dac26252-e9d5-4ac8-995d-04e038fcf25b
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f28d5484-adfe-4a87-a2c2-45570bfc884b
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: OIL_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02e92701-932c-44a3-8a80-84585564dcb2
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ea05c4d-dd3e-4633-8586-cb85ef6fed34
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: CONDENSATE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5839b94-93f3-48a5-80b9-9758740db524
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 943fed53-d7dc-45ed-81c2-055cf973f1f8
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: NGL_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8fdfffed-e6ec-4c8d-806e-5228b53b4ba7
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: baa1dcdd-0c96-4384-9af8-98b89332282c
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d45c7338-2024-4d1a-8b92-7f44ab79633b
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: |-
              CASE WHEN STAGE_PRODVIEW_WELLS.QBYTE_PROVINCE_DISTRICT = 'BRITISH COLUMBIA' THEN (ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.VOLDISPSALEGAS * COALESCE((ODS_PVIEW_PVT_PVUNITMETERRATEENTRY.RATE/100), 1))/1000
                          ELSE ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.VOLDISPSALEGAS/1000
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3bf2ac74-674f-48ea-8ba5-cea88ca48c0c
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d150863-195c-46f9-b422-962623c38c57
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8d84b94-a4fd-4a95-a6b8-ca195f9bce37
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: SAND_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39ed43e7-d3df-47d9-b880-aade1e918595
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c455cea-bd09-4d40-b1d2-9d08eaa45413
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bdb6415a-5401-4be1-a750-7dc668fa02b5
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.VOLINJECTGAS/1000
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31376a84-0a37-4f24-a251-9304454fa2b2
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_HCLIQ_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a023fa13-1817-4634-af61-6d98694392fd
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb6299dc-a71e-4f32-9826-b59f459d5b8e
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_SAND_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 29854860-fe14-4cda-97a0-5483be341131
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cdc5ce76-af40-4537-b582-b76a84119c87
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7984656-93a2-45f4-8fc0-3e4f11df74e8
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec73b9a6-968f-4bb6-8cf8-d9032e8ddbfc
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: RECOVERED_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef77f574-47d5-4f15-8db6-c89138db81ff
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.VOLRECOVGAS/1000
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3be2f4e6-2d82-45a2-a8d3-6100bd480654
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: RECOVERED_HCLIQ_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f2ca6ac-6e3e-4294-b1ad-16c416934c41
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24e7a9d1-66c1-42dd-9241-a3d315b97687
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: RECOVERED_SAND_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b23f6646-acec-405b-a61e-a2c057d6a62c
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f792d6e7-5dc4-4453-9c7f-8e6cae875d28
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: RECOVERED_WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d41c00eb-e23d-4ce8-b357-f711e8a2822a
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8502fd3-81b2-4e51-9a23-152c034adf12
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: REMAINING_LIFT_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78487121-0a5b-4781-b76a-0f42d3e6ce1e
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.VOLREMAINRECOVGAS/1000
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 385b12e2-4c9c-4ccc-b358-a672ace80ef4
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: REMAINING_LOAD_HCLIQ_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 783591f3-5bd2-4764-8ee1-98483bd9d582
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f3379f6-45a3-42b2-b72a-29728ed21962
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: REMAINING_LOAD_WATER_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4671bc9b-fbbe-4132-bdc9-58ad4cec5fab
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a4047dc4-2eb3-4103-8e17-da5b8093a138
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: REMAINING_LOAD_SAND_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 86e0250f-1763-42b3-a702-5363892b35d7
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9c4798d-c2f0-4e63-bacd-1f8a8dddbc27
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: METHANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f1c7c601-1561-4df0-8ea5-7957dc9f521e
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: ETHANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 375929e2-0e0c-4717-865d-1ae51a79c02b
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: PROPANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39198862-a0a7-4a5d-ba3b-d851a23c0811
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: BUTANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75dcf0d9-195d-40b1-8975-5bd3f64a7808
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: PENTANE_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: efc2135e-6a50-46cb-8039-54f65c96dffa
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WIGAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef135fd3-29ca-4192-ae3c-b84d4a82b57c
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b694ac10-8e6f-4361-bb9e-1c7443b1208f
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WIHCLIQ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1025f801-aa3b-4996-9bb3-4e2358493c31
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f3458c2d-4c83-44fe-904c-8507cbfbb7fb
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WISAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e04651b-53ca-49bb-82ef-835c27428375
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c561fd38-7d7a-4025-bbe9-cef22a32ea73
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: WIWATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c2fb5b3-ff9c-4ae0-995e-e6dc900f95ec
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98894d81-bff4-4b01-8479-4e05df26a5cf
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: FLAREGAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d0b9d088-e51c-4c96-96bc-ae48fb24f98f
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.VOLDISPFLAREGAS/1000
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8632e59c-140b-40f6-87e3-b50a86aa5aeb
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: VENTGAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ce505dc-25e3-4eca-bd2d-ae970575ce99
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.VOLDISPVENTGAS/1000
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ff6beb5-256a-4a0c-acf7-5b5ca790328d
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: FUELGAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 664a90f2-f990-4f5d-86a6-f1ae3f70da24
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.VOLDISPFUELGAS/1000
      - appliedColumnTests: {}
        columnReference:
          columnCounter: daf7826c-72e5-47f7-8a17-fe2c14afdda3
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: BAT_PRO_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 68a81f6a-15c3-44c9-8148-d58d7d6739fd
                stepCounter: a393d66f-7099-44e9-a66c-d15b4dbc9f2e
            transform: ODS_PVIEW_PVT_PVFACILITYMONTHDAYCALC.BALFACTGAS * ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.VOLPRODGATHGAS / 1000
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aef0ce98-1a45-44ab-952c-e6ee69c14ba9
          stepCounter: 01ab9e3b-3cb5-42a2-85fd-a0dd7c35ec3c
        config: {}
        dataType: DECIMAL(24,8)
        defaultValue: ""
        description: ""
        name: INJECTED_LIFT_GAS_METRIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 13201972-914e-4ae8-92f5-f770d52c2ce8
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.VOLINJECTRECOVGAS/1000
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY: d08539ff-37af-4c21-9836-963dca56c39d
          STAGE_PRODVIEW_WELLS: e3f3cfdf-bda2-498e-bd55-26e7262626ae
          ODS_PVIEW_PVT_PVUNITDISPMONTHDAY: e1eaab03-46d0-47c5-afef-a1e386773c58
          ODS_PVIEW_PVT_PVUNITNODE: 0cc17ffa-ae19-4239-8958-77363f7b8a14
          ODS_PVIEW_PVT_PVFACILITYMONTHDAYCALC: a393d66f-7099-44e9-a66c-d15b4dbc9f2e
          ODS_PVIEW_PVT_PVFACILITYMONTHCALC: 03221994-956f-4c6c-9c4d-39e3f68e75c0
          ODS_PVIEW_PVT_PVFACILITY: 79f31973-c5e4-4ef7-b6f2-31ffbb792f36
          ODS_PVIEW_PVT_PVUNITMETERRATEENTRY: ee560145-11c8-45e0-a0b4-b9b7c78225d6
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY
          - locationName: TARGET
            nodeName: STAGE_PRODVIEW_WELLS
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITDISPMONTHDAY
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITNODE
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVFACILITYMONTHDAYCALC
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVFACILITYMONTHCALC
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVFACILITY
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITMETERRATEENTRY
        join:
          joinCondition: |-
            EXTENDED
              FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY') }} ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY
              JOIN {{ ref('TARGET','STAGE_PRODVIEW_WELLS') }} STAGE_PRODVIEW_WELLS
                ON ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.IDFLOWNET = STAGE_PRODVIEW_WELLS.IDFLOWNET
               AND ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.IDRECUNIT = STAGE_PRODVIEW_WELLS.ENTITY_KEY
              LEFT JOIN (
                    SELECT ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDFLOWNET,
                           ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDRECUNIT,
                           ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.DTTM AS ACTIVITY_DATE,
                           SUM(NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLC1LIQ, 0)) AS METHANE_METRIC,
                           SUM(NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLC2LIQ, 0)) AS ETHANE_METRIC,
                           SUM(NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLC3LIQ, 0)) AS PROPANE_METRIC,
                           SUM(NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLIC4LIQ, 0) + NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLNC4LIQ, 0)) AS BUTANE_METRIC,
                           SUM(NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLIC5LIQ, 0) + NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLNC5LIQ, 0) + NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLC6LIQ, 0) + NVL(ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.VOLC7LIQ, 0)) AS PENTANE_METRIC
                      FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITDISPMONTHDAY') }} ODS_PVIEW_PVT_PVUNITDISPMONTHDAY
                      LEFT JOIN {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITNODE') }} ODS_PVIEW_PVT_PVUNITNODE
                        ON ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDRECDISPUNITNODE = ODS_PVIEW_PVT_PVUNITNODE.IDREC
                       AND ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDFLOWNET = ODS_PVIEW_PVT_PVUNITNODE.IDFLOWNET
                       AND ODS_PVIEW_PVT_PVUNITNODE.DSS_CURRENT_FLAG = 'Y'
                       AND ODS_PVIEW_PVT_PVUNITNODE.DSS_DELETE_FLAG != 'Y'
                     WHERE ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.DSS_CURRENT_FLAG = 'Y'
                       AND ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.DSS_DELETE_FLAG != 'Y'
                       AND LOWER(ODS_PVIEW_PVT_PVUNITNODE.TYPDISPHCLIQ) = 'ngl'
                     GROUP BY ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDFLOWNET,
                              ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDRECUNIT,
                              ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.DTTM
                   ) ODS_PVIEW_PVT_PVUNITDISPMONTHDAY
                ON ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.IDRECUNIT = ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDRECUNIT
               AND ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DTTM = ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.ACTIVITY_DATE
               AND ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.IDFLOWNET = ODS_PVIEW_PVT_PVUNITDISPMONTHDAY.IDFLOWNET
              LEFT JOIN (
                    SELECT ODS_PVIEW_PVT_PVFACILITYMONTHDAYCALC.BALFACTGAS,
                           ODS_PVIEW_PVT_PVFACILITY.IDREC AS IDRECFACILITY,
                           ODS_PVIEW_PVT_PVFACILITYMONTHDAYCALC.DTTM
                      FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVFACILITYMONTHDAYCALC') }} ODS_PVIEW_PVT_PVFACILITYMONTHDAYCALC
                      JOIN {{ ref('TARGET','ODS_PVIEW_PVT_PVFACILITYMONTHCALC') }} ODS_PVIEW_PVT_PVFACILITYMONTHCALC
                        ON ODS_PVIEW_PVT_PVFACILITYMONTHDAYCALC.IDRECPARENT = ODS_PVIEW_PVT_PVFACILITYMONTHCALC.IDREC
                       AND ODS_PVIEW_PVT_PVFACILITYMONTHCALC.DSS_CURRENT_FLAG = 'Y'
                       AND ODS_PVIEW_PVT_PVFACILITYMONTHCALC.DSS_DELETE_FLAG != 'Y'
                      JOIN {{ ref('TARGET','ODS_PVIEW_PVT_PVFACILITY') }} ODS_PVIEW_PVT_PVFACILITY
                        ON ODS_PVIEW_PVT_PVFACILITYMONTHCALC.IDRECPARENT = ODS_PVIEW_PVT_PVFACILITY.IDREC
                       AND ODS_PVIEW_PVT_PVFACILITY.DSS_CURRENT_FLAG = 'Y'
                       AND ODS_PVIEW_PVT_PVFACILITY.DSS_DELETE_FLAG != 'Y'
                     WHERE ODS_PVIEW_PVT_PVFACILITYMONTHDAYCALC.DSS_CURRENT_FLAG = 'Y'
                       AND ODS_PVIEW_PVT_PVFACILITYMONTHDAYCALC.DSS_DELETE_FLAG != 'Y'
                   ) ODS_PVIEW_PVT_PVFACILITYMONTHDAYCALC
                ON ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.IDRECFACILITY = ODS_PVIEW_PVT_PVFACILITYMONTHDAYCALC.IDRECFACILITY
               AND ODS_PVIEW_PVT_PVUNITALLOCMONTHDAY.DTTM = ODS_PVIEW_PVT_PVFACILITYMONTHDAYCALC.DTTM
              LEFT JOIN (
                    SELECT DTTM AS START_DATE,
                           COALESCE(DATEADD(DAY, -1, LEAD(DTTM) OVER (ORDER BY DTTM)), '2999-12-31') AS END_DATE,
                           RATE
                      FROM {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITMETERRATEENTRY') }} ODS_PVIEW_PVT_PVUNITMETERRATEENTRY
                     WHERE ODS_PVIEW_PVT_PVUNITMETERRATEENTRY.IDRECPARENT = 'B4E41CDA995F4FD0BDEF2233B7D9D8B8'
                       AND ODS_PVIEW_PVT_PVUNITMETERRATEENTRY.DSS_CURRENT_FLAG = 'Y'
                       AND ODS_PVIEW_PVT_PVUNITMETERRATEENTRY.DSS_DELETE_FLAG != 'Y'
                   ) ODS_PVIEW_PVT_PVUNITMETERRATEENTRY
                ON ODS
        name: STAGE_PRODVIEW_SALES_ALLOC_BLEND_VOLUMES
        noLinkRefs: []
  name: STAGE_PRODVIEW_SALES_ALLOC_BLEND_VOLUMES
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
