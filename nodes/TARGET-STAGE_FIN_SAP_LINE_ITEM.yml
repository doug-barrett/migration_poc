fileVersion: 1
id: abe1491f-a53e-4c88-9504-53a30961fafd
name: STAGE_FIN_SAP_LINE_ITEM
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 353c3eb4-bb0b-4d5a-af3a-7c66f32af30c
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(38)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: LI_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc871783-9afd-4af5-8882-c179ca221817
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: ODS_SAP_ACDOCA.RLDNR|| ODS_SAP_ACDOCA.RBUKRS|| TO_CHAR(ODS_SAP_ACDOCA.GJAHR)|| ODS_SAP_ACDOCA.BELNR|| ODS_SAP_ACDOCA.DOCLN
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3dd1e4a2-d844-4e19-845e-080e66e8219e
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: Company Code
        name: DEST_ORG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 32cb7c18-5b8e-4f5e-9af7-b6de766ee127
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e88c8a9d-ac63-4446-83bf-01f0147f1801
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: Company Name
        name: DEST_ORG_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c88df64-0b02-454e-98bb-f429ee21f644
                stepCounter: 380b20ff-1088-454d-94c3-b7fc7688cca8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c45ca7d-7ca5-4d3b-a231-1cd88ba13d6b
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: Undefined in SAP Context
        name: GL_SUB_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc278114-b6df-4cda-8cb4-3aa95666442b
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: DATE
        defaultValue: ""
        description: Production Date
        name: ACTVY_PER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7189fc95-e60c-4e15-a56e-fed816268090
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: LAST_DAY(COALESCE(TO_DATE(PRODPER),BUDAT))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ef2512c-e4bc-454f-a4db-8ec4daf300d2
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: DATE
        defaultValue: ""
        description: Posting Date
        name: ACCT_PER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 35b171a8-acca-4445-9001-6b49423e50bb
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: LAST_DAY(BUDAT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3fe5c8f-ac8b-4eab-a25e-9062266eeef4
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: DATE
        defaultValue: ""
        description: Undefined in SAP Context
        name: ALLOC_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2977c84b-c0cc-49f8-bac8-77e790c86ec6
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: DATE
        defaultValue: ""
        description: Document Date
        name: BILLED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ab4098b-ce56-48d6-a1f9-66623603d141
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c41f1d79-507f-47b4-9462-5391af583ec3
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: NUMBER(10)
        defaultValue: ""
        description: Undefined in SAP Context
        name: GOVERN_AGR_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b9166d31-e2d6-47ca-9c4b-8ed5c30b4370
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: Recovery Indicator
        name: GOVERN_AGR_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a029b2a5-c179-4445-bae8-65b889978202
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07d69585-c7cb-466f-98dc-c23a8cfea499
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(72)
        defaultValue: ""
        description: Custom Text Field
        name: LI_REM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cfb69db0-2748-41a3-9522-37863beef436
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ac423f7-26d5-4c46-9c4b-d5f8a75b27a4
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Base Unit of Measure
        name: USER_DEFINED_TAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc737bdd-4300-45be-893b-6659b85f8f43
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: SUBSTR(ODS_SAP_ACDOCA.RUNIT,1,10)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2b94909-77da-4f1c-aca8-10b1215e0ec9
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Undefined in SAP Context
        name: GOVERN_AGR_OVERRIDE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 520320af-0d3d-4ad2-95a8-d83858bcfe06
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Undefined in SAP Context
        name: JIB_REVERSED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0da5b93b-5a81-4f52-9a96-742977e2f865
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Ledger
        name: LEDGER_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 171ea009-3752-4669-b30c-29761215d716
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a38990b4-c8fc-4a06-ac12-9728f3705539
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: NUMBER(4)
        defaultValue: ""
        description: Fiscal Year
        name: POSTING_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 01f3e8e9-ed07-4459-a39e-f70aa46e6158
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ddc50d37-373a-4a70-8b3a-d71ab62aabe1
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: Document Type Code
        name: DOCUMENT_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 931e4e48-a467-481f-81de-30b229d7a88f
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a94188c-5b63-4e89-940d-749f2dcff39c
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: Document Type
        name: DOCUMENT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76e56353-b57d-4458-8536-d29760de2a8f
                stepCounter: 4028fe37-da02-44aa-a813-94986ad0de40
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0f737a0-aad6-4dbe-8c3c-c7b1ed1ac1c2
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Document Number
        name: DOCUMENT_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc871783-9afd-4af5-8882-c179ca221817
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c74e5a3c-f147-4f06-afd0-aa4b5c8f0304
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Document Line Number
        name: DOCUMENT_LINE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f912b591-9265-4136-ad84-a50d638c79f2
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b39face-0540-49a7-ba2e-1d76b94b7082
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(35)
        defaultValue: ""
        description: Joint Venture
        name: JOINT_VENTURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 88d6749f-fe0a-4fda-821f-e385cc74fd92
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ead57ea8-dd63-4788-8dd3-01a6289c11f9
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Equity Type
        name: EQUITY_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2e89b311-73e3-4837-a551-4a8f1014f687
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 045b7834-5de4-459a-b053-28a288f39dee
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: Equity Group
        name: EQUITY_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e27c41ff-78d2-4442-9aca-a6a59f44bb24
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16be76eb-3acc-457d-b114-3e629d131c22
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Purchasing Document Number
        name: PURCHASING_DOCUMENT_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f34c5407-b7a7-415b-8341-3dd3f1ef13c5
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39494ca3-8585-4f8b-9414-97bfcaef2946
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Partner
        name: PARTNER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 324d2779-e5a5-498f-8881-26775eaec119
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f53801b-cf96-497b-a320-423cc87915c8
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Account Number
        name: ACCOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: abf94091-1801-475b-a751-8fa22b0a58e1
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: LTRIM(ODS_SAP_ACDOCA.RACCT,'0')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 335215c3-ff67-4f9c-a037-e7f96ae617ef
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(16)
        defaultValue: ""
        description: Functional Area
        name: FUNCTIONAL_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 97712f8b-67d7-4081-9205-d54b4e98bef4
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e56197f-6104-42bd-8b61-8e268309bfcc
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: Functional Area Name
        name: FUNCTIONAL_AREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f862aee-a2e0-462c-be94-281d06d5a42e
                stepCounter: deacf6ea-f8a6-4783-88a5-38cfcabbf1d3
            transform: ODS_SAP_TFKBT_LI.FKBTX
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fbea8184-133e-44cc-bf9e-69e7c8467a66
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(16)
        defaultValue: ""
        description: Cost Center
        name: CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a15c99c-5b7e-4b58-a296-93be2ff74593
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: NULLIF(TRIM(LTRIM(ODS_SAP_ACDOCA.RCNTR,'0'),' '),'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eba76129-007e-49d8-bcab-ca8b69477923
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(24)
        defaultValue: ""
        description: WBS Element
        name: AFE_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c7fec8c-4744-447e-ba8b-4c01b6fb22cf
                stepCounter: de47848d-954f-44ec-aa0e-4c963ecfcf9b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e79f5a1-4d81-422d-957e-8d4377c8c15f
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: WBS Functional Area
        name: AFE_FUNCTIONAL_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47c6e2f3-24e9-4eb2-ab26-8e35e2de3d2b
                stepCounter: de47848d-954f-44ec-aa0e-4c963ecfcf9b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87b7353f-466e-41f1-8473-4fcdda442264
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: WBS Functional Area Name
        name: AFE_FUNCTIONAL_AREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f862aee-a2e0-462c-be94-281d06d5a42e
                stepCounter: deacf6ea-f8a6-4783-88a5-38cfcabbf1d3
            transform: ODS_SAP_TFKBT_WBS.FKBTX
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5ba6376-7954-4780-b91c-d55b101f4013
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: WBS Requesting Cost Center
        name: AFE_CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 61baa464-9883-4373-ac38-1148438b5d9b
                stepCounter: de47848d-954f-44ec-aa0e-4c963ecfcf9b
            transform: NULLIF(TRIM(LTRIM(ODS_SAP_PRPS.AKSTL,'0'),' '),'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 359c87d1-b449-4939-b5c9-cac21c472a28
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: WBS Requesting Cost Center Functional Area
        name: AFE_CC_FUNCTIONAL_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 85c08796-52d2-417c-b319-f8f31abb7929
                stepCounter: 9b3a977a-eef0-47b3-a40e-a27ab9656405
            transform: ODS_SAP_CSKS_WBS.FUNC_AREA
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9379912f-94b5-4d11-9210-5e1cbb4a3588
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: WBS Requesting Cost Center Functional Area Name
        name: AFE_CC_FUNCTIONAL_AREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f862aee-a2e0-462c-be94-281d06d5a42e
                stepCounter: deacf6ea-f8a6-4783-88a5-38cfcabbf1d3
            transform: ODS_SAP_TFKBT_WBS_CC.FKBTX
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f9ce2df-6bf6-48e5-9c1f-38fe176a79b2
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(12)
        defaultValue: ""
        description: Order Number
        name: ORDER_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d5eba84-61c0-4e81-9683-052178189495
                stepCounter: d9804961-abf3-41ef-aae2-d16269ccb227
            transform: NULLIF(TRIM(LTRIM(ODS_SAP_ACDOCA.AUFNR,'0'),' '),'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a74fd763-4a0e-439f-91de-3416e4bac044
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(16)
        defaultValue: ""
        description: Order Functional Area
        name: ORDER_FUNCTIONAL_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 65502bdb-e5b3-49e0-ab20-b9585e1455cc
                stepCounter: d9804961-abf3-41ef-aae2-d16269ccb227
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 44bdf811-5d1a-4146-aae4-ae1af9ea647c
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: Order Functional Area Name
        name: ORDER_FUNCTIONAL_AREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f862aee-a2e0-462c-be94-281d06d5a42e
                stepCounter: deacf6ea-f8a6-4783-88a5-38cfcabbf1d3
            transform: ODS_SAP_TFKBT_ORDER.FKBTX
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a52813dc-7e64-427d-af62-42ae674b81e5
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Order Cost Center for Basic Settlement
        name: ORDER_CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 36ebdef7-e10e-455d-9285-63e28ad026bd
                stepCounter: d9804961-abf3-41ef-aae2-d16269ccb227
            transform: NULLIF(TRIM(LTRIM(ODS_SAP_AUFK.KOSTL,'0'),' '),'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b5f928dd-0c2a-4c3c-b8d2-bc6e6b2e865a
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Order Requesting Cost Center
        name: ORDER_REQ_CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 98c75685-695d-4f32-9897-b5263f06c02a
                stepCounter: d9804961-abf3-41ef-aae2-d16269ccb227
            transform: NULLIF(TRIM(LTRIM(ODS_SAP_AUFK.AKSTL,'0'),' '),'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ae03504-b139-43bd-88ed-88681c2b194e
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Order Responsible Cost Center
        name: ORDER_RESP_CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84e03a57-2bfa-4eaa-97c1-e678a4cafd18
                stepCounter: d9804961-abf3-41ef-aae2-d16269ccb227
            transform: NULLIF(TRIM(LTRIM(ODS_SAP_AUFK.KOSTV,'0'),' '),'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 08a59484-bbd7-4e3a-a9bf-6fc9edd90a66
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(16)
        defaultValue: ""
        description: Order Cost Center Functional Area
        name: ORDER_CC_FUNCTIONAL_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 85c08796-52d2-417c-b319-f8f31abb7929
                stepCounter: 9b3a977a-eef0-47b3-a40e-a27ab9656405
            transform: ODS_SAP_CSKS_ORDER.FUNC_AREA
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1da0941f-e402-4225-bc83-f8ebd8c1b2fa
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: Order Cost Center Functional Area Name
        name: ORDER_CC_FUNCTIONAL_AREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f862aee-a2e0-462c-be94-281d06d5a42e
                stepCounter: deacf6ea-f8a6-4783-88a5-38cfcabbf1d3
            transform: ODS_SAP_TFKBT_ORDER_CC.FKBTX
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 225ef824-adaf-4124-b68a-c3da65660d3b
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(24)
        defaultValue: ""
        description: Work breakdown structure element (WBS element)
        name: ORDER_AFE_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c7fec8c-4744-447e-ba8b-4c01b6fb22cf
                stepCounter: de47848d-954f-44ec-aa0e-4c963ecfcf9b
            transform: ODS_SAP_PRPS_ORDER.POSID
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f6c6842-5032-4a8d-b4bd-f879484e5731
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(16)
        defaultValue: ""
        description: Order WBS Functional Area
        name: ORDER_AFE_FUNCTIONAL_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 85c08796-52d2-417c-b319-f8f31abb7929
                stepCounter: 9b3a977a-eef0-47b3-a40e-a27ab9656405
            transform: ODS_SAP_PRPS_ORDER.FUNC_AREA
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f5600a1-d58a-401b-832c-6784dde832c8
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: Order WBS Functional Area Name
        name: ORDER_AFE_FUNCTIONAL_AREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f862aee-a2e0-462c-be94-281d06d5a42e
                stepCounter: deacf6ea-f8a6-4783-88a5-38cfcabbf1d3
            transform: ODS_SAP_TFKBT_ORDER_WBS.FKBTX
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 52e8c7cc-f102-4b7e-9f2b-862f02d5cede
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Order WBS Cost Center
        name: ORDER_AFE_CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 61baa464-9883-4373-ac38-1148438b5d9b
                stepCounter: de47848d-954f-44ec-aa0e-4c963ecfcf9b
            transform: NULLIF(TRIM(LTRIM(ODS_SAP_PRPS_ORDER.AKSTL,'0'),' '),'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1998a58-5636-43a5-905c-af1655be6a6c
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(16)
        defaultValue: ""
        description: Order WBS Cost Center Functional Area
        name: ORDER_AFE_CC_FUNCTIONAL_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 85c08796-52d2-417c-b319-f8f31abb7929
                stepCounter: 9b3a977a-eef0-47b3-a40e-a27ab9656405
            transform: ODS_SAP_CSKS_ORDER_WBS.FUNC_AREA
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 500d78da-05e4-46bb-acc6-b01d2ce0ed1c
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: Order WBS Cost Center Functional Area Name
        name: ORDER_AFE_CC_FUNCTIONAL_AREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f862aee-a2e0-462c-be94-281d06d5a42e
                stepCounter: deacf6ea-f8a6-4783-88a5-38cfcabbf1d3
            transform: ODS_SAP_TFKBT_ORDER_WBS_CC.FKBTX
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f693ab1-2f53-4757-8ca0-4927d33b775f
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Lease Ops Line Number via Account/Functional Area mapping
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f218625f-779b-419c-80d0-bfd386602b21
                stepCounter: 7daa3cf7-241d-4784-b533-ca2c1cdedb20
            transform: |-
              CASE --assign line no if Docment Type is not NULL and account >400000 XOR =120060 XOR <> 791000

                          WHEN NULLIF(ODS_SAP_ACDOCA.BLART,'') IS NULL                                                             THEN NULL
                          WHEN LTRIM(ODS_SAP_ACDOCA.RACCT,'0') = '791000'                                                          THEN NULL
                          WHEN TO_NUMBER(LTRIM(ODS_SAP_ACDOCA.RACCT,'0')) < 400000 AND LTRIM(ODS_SAP_ACDOCA.RACCT,'0') <> '120060' THEN NULL
                          ELSE CASE -- LI Order Reference
               WHEN NULLIF(TRIM(LTRIM(ODS_SAP_ACDOCA.AUFNR,'0'),' '),'') IS NOT NULL THEN CASE -- Order Non-Capital WBS Reference
               WHEN NVL(ODS_SAP_AUFK.PSPEL,0) <> 0 AND NVL(LOAD_VET_FIN_SAP_AFE_TYPE_ATTR_ORDER.NON_CAPITAL_FLAG,'Y') = 'Y' THEN COALESCE(LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER_WBS.LINE_NO, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER_WBS_CC.LINE_NO, LOAD_VET_FIN_SAP_LEASE_OPS_HIER_ORDER_FA.LINE_NO, LOAD_VET_FIN_SAP_LEASE_OPS_HIER_ORDER_CC_FA.LINE_NO, LOAD_VET_FIN_SAP_LEASE_OPS_HIER_ORDER_WBS_FA.LINE_NO, LOAD_VET_FIN_SAP_LEASE_OPS_HIER_ORDER_WBS_CC_FA.LINE_NO, LOAD_VET_FIN_SAP_LEASE_OPS_HIER_NO_FA.LINE_NO) -- Order Capital WBS Reference
               WHEN NVL(ODS_SAP_AUFK.PSPEL,0) <> 0 AND NVL(LOAD_VET_FIN_SAP_AFE_TYPE_ATTR_ORDER.NON_CAPITAL_FLAG,'Y') = 'N' THEN COALESCE(LOAD_VET_FIN_SAP_AFE_TYPE_ATTR_ORDER.LINE_NO, LOAD_VET_FIN_SAP_LEASE_OPS_HIER_ORDER_WBS_FA.LINE_NO, LOAD_VET_FIN_SAP_LEASE_OPS_HIER_NO_FA.LINE_NO) -- Order No WBS Reference
               ELSE COALESCE(LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER.LINE_NO, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER_CC.LINE_NO, LOAD_VET_FIN_SAP_LEASE_OPS_HIER_ORDER_FA.LINE_NO, LOAD_VET_FIN_SAP_LEASE_OPS_HIER_ORDER_CC_FA.LINE_NO, LOAD_VET_FIN_SAP_LEASE_OPS_HIER_NO_FA.LINE_NO) END -- No LI Order or WBS Reference AND Not Captial Inventory Account
               WHEN NULLIF(TRIM(LTRIM(ODS_SAP_ACDOCA.AUFNR,'0'),' '),'') IS NULL AND NVL(ODS_SAP_ACDOCA.PS_PSP_PNR,0) = 0 AND LTRIM(ODS_SAP_ACDOCA.RACCT,'0') <> '120060' THEN COALESCE(LOAD_VET_FIN_SAP_ACCOUNT_ATTR_LI.LINE_NO, LOAD_VET_FIN_SAP_LEASE_OPS_HIER_LI_FA.LINE_NO, LOAD_VET_FIN_SAP_LEASE_OPS_HIER_NO_FA.LINE_NO) -- No LI Order Reference, LI Non-Captial WBS Reference
               WHEN NULLIF(TRIM(LTRIM(ODS_SAP_ACDOCA.AUFNR,'0'),' '),'') IS NULL AND NVL(ODS_SAP_ACDOCA.PS_PSP_PNR,0) <> 0 AND NVL(LOAD_VET_FIN_SAP_AFE_TYPE_ATTR.NON_CAPITAL_FLAG,'Y') = 'Y' THEN COALESCE(LOAD_VET_FIN_SAP_ACCOUNT_ATTR_LI.LINE_NO, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_WBS.LINE_NO, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_WBS_CC.LINE_NO, LOAD_VET_FIN_SAP_LEASE_OPS_HIER_LI_FA.LINE_NO, LOAD_VET_FIN_SAP_LEASE_OPS_HIER_WBS_FA.LINE_NO, LOAD_VET_FIN_SAP_LEASE_OPS_HIER_WBS_CC_FA.LINE_NO, LOAD_VET_FIN_SAP_LEASE_OPS_HIER_NO_FA.LINE_NO) -- No LI Order Reference, LI Captial WBS Reference
               WHEN NULLIF(TRIM(LTRIM(ODS_SAP_ACDOCA.AUFNR,'0'),' '),'') IS NULL AND NVL(ODS_SAP_PRPS.PSPNR,0) <> 0 AND NVL(LOAD_VET_FIN_SAP_AFE_TYPE_ATTR.NON_CAPITAL_FLAG,'Y') = 'N' THEN COALESCE(LOAD_VET_FIN_SAP_AFE_TYPE_ATTR.LINE_NO, LOAD_VET_FIN_SAP_LEASE_OPS_HIER_WBS_FA.LINE_NO, LOAD_VET_FIN_SAP_LEASE_OPS_HIER_NO_FA.LINE_NO) END
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48102262-8aac-4883-b4cf-7939e9daa74a
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: Product Code via Account/Functional Area mapping
        name: PROD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c281e3c-599f-4197-9368-3ad9f09c050b
                stepCounter: 95e4d277-8530-4e7c-b5fc-957bab063b60
            transform: |-
              DECODE(NULLIF(TRIM(LTRIM(ODS_SAP_ACDOCA.AUFNR,'0'),' '),''), -- No LI Order Reference
               NULL, DECODE(NVL(ODS_SAP_ACDOCA.PS_PSP_PNR,0), -- No LI WBS Reference
               0, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_LI.PROD_CODE, -- LI WBS Reference
               DECODE(NVL(LOAD_VET_FIN_SAP_AFE_TYPE_ATTR.NON_CAPITAL_FLAG,'Y'), --Non-Capital Project Type
               'Y', COALESCE(LOAD_VET_FIN_SAP_ACCOUNT_ATTR_LI.PROD_CODE, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_WBS.PROD_CODE, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_WBS_CC.PROD_CODE), --Capital Project Type
               'N', NULL)), -- LI Order Reference
               DECODE(NVL(ODS_SAP_AUFK.PSPEL,0), -- No Order WBS Reference
               0, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER.PROD_CODE, -- Order WBS Reference
               DECODE(NVL(LOAD_VET_FIN_SAP_AFE_TYPE_ATTR_ORDER.NON_CAPITAL_FLAG,'Y'), --Non-Capital Project Type
               'Y', COALESCE(LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER.PROD_CODE, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER_WBS.PROD_CODE, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER_WBS_CC.PROD_CODE), --Capital Project Type
               'N', NULL)))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a16213c-3eea-4407-ad5c-afd46b9567ac
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: Account Group Code via Account/Functional Area mapping
        name: ACCT_GROUP_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4213f9b-3386-4dfb-9a42-60fadcc8d51e
                stepCounter: 95e4d277-8530-4e7c-b5fc-957bab063b60
            transform: |-
              DECODE(NULLIF(TRIM(LTRIM(ODS_SAP_ACDOCA.AUFNR,'0'),' '),''), -- No LI Order Reference
               NULL, DECODE(NVL(ODS_SAP_ACDOCA.PS_PSP_PNR,0), -- No LI WBS Reference
               0, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_LI.ACCT_GROUP_CODE, -- LI WBS Reference
               DECODE(NVL(LOAD_VET_FIN_SAP_AFE_TYPE_ATTR.NON_CAPITAL_FLAG,'Y'), --Non-Capital Project Type
               'Y', COALESCE(LOAD_VET_FIN_SAP_ACCOUNT_ATTR_LI.ACCT_GROUP_CODE, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_WBS.ACCT_GROUP_CODE, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_WBS_CC.ACCT_GROUP_CODE), --Capital Project Type
               'N', NULL)), -- LI Order Reference
               DECODE(NVL(ODS_SAP_AUFK.PSPEL,0), -- No Order WBS Reference
               0, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER.ACCT_GROUP_CODE, -- Order WBS Reference
               DECODE(NVL(LOAD_VET_FIN_SAP_AFE_TYPE_ATTR_ORDER.NON_CAPITAL_FLAG,'Y'), --Non-Capital Project Type
               'Y', COALESCE(LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER.ACCT_GROUP_CODE, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER_WBS.ACCT_GROUP_CODE, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER_WBS_CC.ACCT_GROUP_CODE), --Capital Project Type
               'N', NULL)))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14673f47-c4f0-411d-ab5a-b7b1815e8cee
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(18)
        defaultValue: ""
        description: Assignment
        name: ASSIGNMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 384cef84-0426-45f6-b60b-c9b7b96c247a
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 23692902-64a7-4c0c-8c3b-85b4661dd46f
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: NUMBER(6)
        defaultValue: ""
        description: Source Document Number
        name: SRC_DOCUMENT_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: afc5100e-62e8-4d09-be0e-91ed1bf38336
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c662ff22-3fcb-4075-97c2-fde878f71e22
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Source Document Line Item
        name: SRC_DOCUMENT_LINE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c50253dd-7d64-44d6-942c-145faf4d43bd
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eca010c4-5fa8-430e-9239-6b1860e2b774
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: Special G/L Indicator
        name: SPECIAL_GL_IND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: efbb00b2-6584-4b73-9610-aa35f6e3c914
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 401177f0-4a9c-4126-b02b-8aa9d94992b7
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: NUMBER(21)
        defaultValue: ""
        description: Cutback Run ID
        name: CUTBACK_RUN_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 97878efb-e7c8-465d-a65c-c4095339f86d
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18da293d-4add-40da-8393-4d78dbb8b6ac
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Offsetting Account
        name: OFFSET_ACCOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94e976a5-1030-4197-8cbb-63eb4506d833
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: LTRIM(ODS_SAP_ACDOCA.GKONT,'0')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 252ba209-aa89-4cac-90be-75aac786eb8f
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: G/L Account Long Text or Business Partner Name
        name: OFFSET_ACCOUNT_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d5332a2-159e-47cf-a4a3-e4a3dbf99efb
                stepCounter: 7f75087a-1b98-4094-93f8-7ddb6e8e93ee
            transform: |-
              CASE WHEN ODS_SAP_ACDOCA.GKOAR IN ('D','K') THEN COALESCE(NULLIF(NAME_ORG1,'') ,NULLIF(NAME1_TEXT,'') ,TRIM(NULLIF(NAME_FIRST,'')||' '||NULLIF(NAME_LAST,'')))
                          ELSE NULLIF(ODS_SAP_SKAT.TXT50,'')
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fadaa1db-8a6f-4236-bb2c-c5a71adf4274
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: Tax Code
        name: TAX_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4a1e5b0-ba59-4bdb-8b10-3d05a4246cdb
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 469265c5-75be-47e4-bc13-945e36db71a5
          stepCounter: abe1491f-a53e-4c88-9504-53a30961fafd
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: Reference Procedure
        name: REF_PROCEDURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f822c818-0829-4b3a-ac1d-4f9ae9c21660
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ODS_SAP_ACDOCA: 0f008214-d701-47dc-8dec-ed7f400b3d52
          ODS_SAP_T001: 380b20ff-1088-454d-94c3-b7fc7688cca8
          LOAD_VET_FIN_SAP_CAP_INV_ORG_AFE: ca8edbb6-9d04-4266-8545-d16b0230dfc8
          ODS_SAP_PRPS: de47848d-954f-44ec-aa0e-4c963ecfcf9b
          ODS_SAP_AUFK: d9804961-abf3-41ef-aae2-d16269ccb227
          LOAD_VET_FIN_SAP_ACCOUNT_ATTR: 95e4d277-8530-4e7c-b5fc-957bab063b60
          ODS_SAP_CSKS: 9b3a977a-eef0-47b3-a40e-a27ab9656405
          LOAD_VET_FIN_SAP_AFE_TYPE_ATTR: 89b6853d-ec92-4ce1-87b8-e50bebc37373
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: ODS_SAP_ACDOCA
          - locationName: TARGET
            nodeName: ODS_SAP_T001
          - locationName: TARGET
            nodeName: LOAD_VET_FIN_SAP_CAP_INV_ORG_AFE
          - locationName: TARGET
            nodeName: ODS_SAP_PRPS
          - locationName: TARGET
            nodeName: ODS_SAP_AUFK
          - locationName: TARGET
            nodeName: LOAD_VET_FIN_SAP_ACCOUNT_ATTR
          - locationName: TARGET
            nodeName: ODS_SAP_CSKS
          - locationName: TARGET
            nodeName: LOAD_VET_FIN_SAP_AFE_TYPE_ATTR
        join:
          joinCondition: |-
            EXTENDED
              FROM (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_ACDOCA') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) ODS_SAP_ACDOCA -- Company 	LEFT JOIN (SELECT * FROM {{ ref('TARGET','ODS_SAP_T001') }} WHERE DSS_CURRENT_FLAG = 'Y' AND DSS_DELETE_FLAG != 'Y') ODS_SAP_T001 	  ON ODS_SAP_ACDOCA.RBUKRS = ODS_SAP_T001.BUKRS 	-- Company default WBS Elements for Captial Inventory case 	LEFT JOIN {{ ref('TARGET','LOAD_VET_FIN_SAP_CAP_INV_ORG_AFE') }} LOAD_VET_FIN_SAP_CAP_INV_ORG_AFE 	  ON ODS_SAP_ACDOCA.RBUKRS = LOAD_VET_FIN_SAP_CAP_INV_ORG_AFE.ORG_ID AND LTRIM(ODS_SAP_ACDOCA.RACCT,'0') = '120060' 	LEFT JOIN (SELECT * FROM {{ ref('TARGET','ODS_SAP_PRPS') }} WHERE DSS_CURRENT_FLAG = 'Y' AND DSS_DELETE_FLAG != 'Y') ODS_SAP_PRPS_CAP_INV 	  ON LOAD_VET_FIN_SAP_CAP_INV_ORG_AFE.AFE_NUM = ODS_SAP_PRPS_CAP_INV.POSID   -- * LI Order Reference * -- 	LEFT JOIN (SELECT * FROM {{ ref('TARGET','ODS_SAP_AUFK') }} WHERE DSS_CURRENT_FLAG = 'Y' AND DSS_DELETE_FLAG != 'Y') ODS_SAP_AUFK         ON ODS_SAP_ACDOCA.AUFNR = ODS_SAP_AUFK.AUFNR	 	-- Order Account Attributes  	LEFT JOIN {{ ref('TARGET','LOAD_VET_FIN_SAP_ACCOUNT_ATTR') }} LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER 	  ON LTRIM(ODS_SAP_ACDOCA.RACCT,'0') = LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER.ACCOUNT AND ODS_SAP_AUFK.FUNC_AREA = LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER.FAREA 	-- Order Cost Center Account Attributes   	LEFT JOIN (SELECT * FROM {{ ref('TARGET','ODS_SAP_CSKS') }} WHERE DSS_CURRENT_FLAG = 'Y' AND DSS_DELETE_FLAG != 'Y') ODS_SAP_CSKS_ORDER 	  ON COALESCE(ODS_SAP_AUFK.KOSTL,ODS_SAP_AUFK.AKSTL,ODS_SAP_AUFK.KOSTV)  = ODS_SAP_CSKS_ORDER.KOSTL     	LEFT JOIN {{ ref('TARGET','LOAD_VET_FIN_SAP_ACCOUNT_ATTR') }} LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER_CC 	  ON LTRIM(ODS_SAP_ACDOCA.RACCT,'0') = LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER_CC.ACCOUNT AND ODS_SAP_CSKS_ORDER.FUNC_AREA = LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER_CC.FAREA 	-- Order WBS Elements 	LEFT JOIN (SELECT * FROM {{ ref('TARGET','ODS_SAP_PRPS') }} WHERE DSS_CURRENT_FLAG = 'Y' AND DSS_DELETE_FLAG != 'Y') ODS_SAP_PRPS_ORDER 	  ON NULLIF(ODS_SAP_AUFK.PSPEL,0) = ODS_SAP_PRPS_ORDER.PSPNR 	-- Order WBS Type Attributes 	LEFT JOIN {{ ref('TARGET','LOAD_VET_FIN_SAP_AFE_TYPE_ATTR') }} LOAD_VET_FIN_SAP_AFE_TYPE_ATTR_ORDER 	  ON ODS_SAP_PRPS_ORDER.PRART = LOAD_VET_FIN_SAP_AFE_TYPE_ATTR_ORDER.AFE_TYPE	 	-- Order WBS Non-Captial Account Attributes  	LEFT JOIN {{ ref('TARGET','LOAD_VET_FIN_SAP_ACCOUNT_ATTR') }} LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER_WBS 	  ON LTRIM(ODS_SAP_ACDOCA.RACCT,'0') = LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER_WBS.ACCOUNT  		AND ODS_SAP_PRPS_ORDER.FUNC_AREA = LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER_WBS.FAREA 	-- Order WBS Cost Center Account Attributes   	LEFT JOIN (SELECT * FROM {{ ref('TARGET','ODS_SAP_CSKS') }} WHERE DSS_CURRENT_FLAG = 'Y' AND DSS_DELETE_FLAG != 'Y') ODS_SAP_CSKS_ORDER_WBS 	  ON ODS_SAP_PRPS_ORDER.AKSTL = ODS_SAP_CSKS_ORDER_WBS.KOSTL     	LEFT JOIN {{ ref('TARGET','LOAD_VET_FIN_SAP_ACCOUNT_ATTR') }} LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER_WBS_CC 	  ON LTRIM(ODS_SAP_ACDOCA.RACCT,'0') = LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER_WBS_CC.ACCOUNT AND ODS_SAP_CSKS_ORDER_WBS.FUNC_AREA = LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER_WBS_CC.FAREA  		   -- * LI WBS Reference * --		 	-- WBS Elements (From LI or via Company default WBS when Captial Inventory case) 	LEFT JOIN (SELECT * FROM {{ ref('TARGET','ODS_SAP_PRPS') }} WHERE DSS_CURRENT_FLAG = 'Y' AND DSS_DELETE_FLAG != 'Y') ODS_SAP_PRPS 	  ON COALESCE(NULLIF(ODS_SAP_ACDOCA.PS_PSP_PNR,0),NULLIF(ODS_SAP_PRPS_CAP_INV.PSPNR,0)) = ODS_SAP_PRPS.PSPNR 	-- WBS Type Attributes 	LEFT JOIN {{ ref('TARGET','LOAD_VET_FIN_SAP_AFE_TYPE_ATTR') }} LOAD_VET_FIN_SAP_AFE_TYPE_ATTR 	  ON ODS_SAP_PRPS.PRART = LOAD_VET_FIN_SAP_AFE_TYPE_ATTR.AFE_TYPE 	-- WBS Non-Captial Account Attributes  	LEFT JOIN {{ ref('TARGET','LOAD_VET_FIN_SAP_ACCOUNT_ATTR') }} LOAD_VET_FIN_SAP_ACCOUNT_ATTR_WBS 	  ON LTRIM(ODS_SAP_ACDOCA.RACCT,'0') = LOAD_VET_FIN_SAP_ACCOUNT_ATTR_WBS.ACCOUNT  		AND ODS_SAP_PRPS.FUNC_AREA = LOAD_VET_FIN_SAP_ACCOUNT_ATTR_WBS.FAREA 	-- WBS Cost Center Account Attributes   	LEFT JOIN (SELECT *
        name: STAGE_FIN_SAP_LINE_ITEM
        noLinkRefs: []
  name: STAGE_FIN_SAP_LINE_ITEM
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
