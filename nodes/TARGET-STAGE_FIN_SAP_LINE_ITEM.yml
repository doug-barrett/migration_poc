fileVersion: 1
id: 28bb3eb1-eb1c-42be-9616-beacb93bde45
name: STAGE_FIN_SAP_LINE_ITEM
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b2515e42-d340-44f0-bddf-32683f1545c1
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(38)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: LI_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 087f18e3-3489-42af-a08a-e7544931ff30
                stepCounter: d310660d-8d8d-4155-898e-2bc2c935b749
            transform: ODS_SAP_ACDOCA.RLDNR|| ODS_SAP_ACDOCA.RBUKRS|| TO_CHAR(ODS_SAP_ACDOCA.GJAHR)|| ODS_SAP_ACDOCA.BELNR|| ODS_SAP_ACDOCA.DOCLN
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26960951-8493-4aae-aae5-3a4a7a5b2d08
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: Company Code
        name: DEST_ORG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ef3848d-ddce-442b-a5ee-f6b082df2138
                stepCounter: d310660d-8d8d-4155-898e-2bc2c935b749
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bce6e4e2-8e8f-4828-b375-917c60148b47
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: Company Name
        name: DEST_ORG_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e063e94c-f948-49aa-854c-1e1627c372f1
                stepCounter: 2c701d0c-4f6b-4d48-bf42-61b56bce4087
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e02e7ae4-0ff0-40c7-aaa5-cf1e652656dc
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: Undefined in SAP Context
        name: GL_SUB_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f7a4c4f-8608-4556-9a98-161a93a093a1
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: DATE
        defaultValue: ""
        description: Production Date
        name: ACTVY_PER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e8f3f4b9-6428-4b8f-a347-0bfd77b4aa90
                stepCounter: d310660d-8d8d-4155-898e-2bc2c935b749
            transform: LAST_DAY(COALESCE(TO_DATE(PRODPER),BUDAT))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3aaaa5ca-ebd8-4b89-bb78-a053c679a906
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: DATE
        defaultValue: ""
        description: Posting Date
        name: ACCT_PER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f6a58e88-219b-490c-b188-7d9cd9604206
                stepCounter: d310660d-8d8d-4155-898e-2bc2c935b749
            transform: LAST_DAY(BUDAT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 943b1d6a-f904-4cad-bcb4-5d93b2017c52
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: DATE
        defaultValue: ""
        description: Undefined in SAP Context
        name: ALLOC_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55e18a17-d814-4158-a5d0-ff0bee57acfe
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: DATE
        defaultValue: ""
        description: Document Date
        name: BILLED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 637dc3c6-f4ef-4fd0-b198-d8f84ac80f73
                stepCounter: d310660d-8d8d-4155-898e-2bc2c935b749
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c61e7ff-7276-4998-ba16-6e8bafc1c419
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: NUMBER(10)
        defaultValue: ""
        description: Undefined in SAP Context
        name: GOVERN_AGR_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fae2e73d-70c5-4f61-8016-0860e8db2f4d
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: Recovery Indicator
        name: GOVERN_AGR_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8d026c16-918e-4730-8f39-9daf133fa9cf
                stepCounter: d310660d-8d8d-4155-898e-2bc2c935b749
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d880d7d0-3b2f-4b0e-91d9-169ee9436199
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(72)
        defaultValue: ""
        description: Custom Text Field
        name: LI_REM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5aec3c1c-49a6-4256-a725-a3213d6f3828
                stepCounter: d310660d-8d8d-4155-898e-2bc2c935b749
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02f7d50f-ea97-4c23-a13a-b7a24d2d706b
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Base Unit of Measure
        name: USER_DEFINED_TAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11aee58a-4273-4a7c-acc9-bd625657cd63
                stepCounter: d310660d-8d8d-4155-898e-2bc2c935b749
            transform: SUBSTR(ODS_SAP_ACDOCA.RUNIT,1,10)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22692ca2-42e8-44e7-8d99-f7e52f680a12
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Undefined in SAP Context
        name: GOVERN_AGR_OVERRIDE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e4d00d2f-8620-44f1-ad9e-681753db91c4
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Undefined in SAP Context
        name: JIB_REVERSED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ad03394-7b9c-460e-8431-0b166506902d
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Ledger
        name: LEDGER_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f65b72a2-fbca-4864-b2e1-ebf99ee2ea96
                stepCounter: d310660d-8d8d-4155-898e-2bc2c935b749
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 437fb0b7-31fb-4708-8d30-09f83c63dfcc
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: NUMBER(4)
        defaultValue: ""
        description: Fiscal Year
        name: POSTING_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4105b24e-b318-468b-9ed3-ea1cbb497dd7
                stepCounter: d310660d-8d8d-4155-898e-2bc2c935b749
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d705a1b1-43d0-4b6c-bdc4-92bc0c57b9a1
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: Document Type Code
        name: DOCUMENT_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 99616118-8b27-4d99-b813-00a0a2b17310
                stepCounter: d310660d-8d8d-4155-898e-2bc2c935b749
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f40b8909-e766-4b64-aea4-e52ac65f2e7e
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: Document Type
        name: DOCUMENT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e7f66ba-ebd8-4e7b-832e-b49b98ef948f
                stepCounter: 0f52032b-04ab-4efe-83b9-5ac56fc37323
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 747f17f0-7bdd-4c2b-aa4f-95aece393c14
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Document Number
        name: DOCUMENT_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 087f18e3-3489-42af-a08a-e7544931ff30
                stepCounter: d310660d-8d8d-4155-898e-2bc2c935b749
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50fe41de-b9f0-4778-a25e-cec909b0ae1f
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Document Line Number
        name: DOCUMENT_LINE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8d3cf42c-578e-41ce-80d5-364961066dfb
                stepCounter: d310660d-8d8d-4155-898e-2bc2c935b749
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 422e65f4-8fd6-4b4d-9c57-a7ede44f8b68
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(35)
        defaultValue: ""
        description: Joint Venture
        name: JOINT_VENTURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 776138a4-f59d-4983-b3b9-46904daf9ce7
                stepCounter: d310660d-8d8d-4155-898e-2bc2c935b749
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72285707-86e8-4b0e-bf27-137d8c443252
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Equity Type
        name: EQUITY_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c9bf96a-2f2a-470e-b55c-8c4cb84f6728
                stepCounter: d310660d-8d8d-4155-898e-2bc2c935b749
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0be39dc8-a399-40a3-83a8-7322ae22d9c7
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: Equity Group
        name: EQUITY_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 524ee826-ca24-4969-a2a8-e0dc796363f2
                stepCounter: d310660d-8d8d-4155-898e-2bc2c935b749
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c8109e4-e048-4122-9c86-faee6fbae3e9
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Purchasing Document Number
        name: PURCHASING_DOCUMENT_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2f49f6c-5827-4b5e-a90c-30b195da23c5
                stepCounter: d310660d-8d8d-4155-898e-2bc2c935b749
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4bb90c62-84e0-4248-af94-029b7f46aa07
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Partner
        name: PARTNER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75388f30-16b9-42ed-91ae-8137b3e742ea
                stepCounter: d310660d-8d8d-4155-898e-2bc2c935b749
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf45c6df-6d40-45c4-9691-0871fe714562
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Account Number
        name: ACCOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bb0d5d58-d759-4f6c-8e7d-0c22e9bdb346
                stepCounter: d310660d-8d8d-4155-898e-2bc2c935b749
            transform: LTRIM(ODS_SAP_ACDOCA.RACCT,'0')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1217f61-e451-4dd7-9cb7-2a778bdcfc63
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(16)
        defaultValue: ""
        description: Functional Area
        name: FUNCTIONAL_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: efcdfb45-7364-4530-974c-bc250e4fff69
                stepCounter: d310660d-8d8d-4155-898e-2bc2c935b749
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 430e8b25-7bc5-4e39-85a3-755faa457c7e
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: Functional Area Name
        name: FUNCTIONAL_AREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b04d2b4d-12c4-487d-9c2f-e05dd85350f9
                stepCounter: 43c13db8-7f40-4ec6-b4cb-fb85c4f1f157
            transform: ODS_SAP_TFKBT_LI.FKBTX
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9a214a1-e9c4-4619-89e7-b814428526d6
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(16)
        defaultValue: ""
        description: Cost Center
        name: CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ba59809-29df-4510-a9a2-b094d947dcc4
                stepCounter: d310660d-8d8d-4155-898e-2bc2c935b749
            transform: NULLIF(TRIM(LTRIM(ODS_SAP_ACDOCA.RCNTR,'0'),' '),'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 292bb64b-ffcb-4981-b329-f9328e37c97e
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(24)
        defaultValue: ""
        description: WBS Element
        name: AFE_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3793af05-7532-4997-8f05-0bcdac878d0a
                stepCounter: 3582ff46-fac5-4ac0-9aa5-b3268952c703
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cba27fb9-088f-4518-b5c2-0dbb4eb5bd3b
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: WBS Functional Area
        name: AFE_FUNCTIONAL_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ad602cf-a1d3-4cd2-ba00-1b9eeeeb2cd3
                stepCounter: 3582ff46-fac5-4ac0-9aa5-b3268952c703
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34c48769-49ec-4432-a270-439b75761428
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: WBS Functional Area Name
        name: AFE_FUNCTIONAL_AREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b04d2b4d-12c4-487d-9c2f-e05dd85350f9
                stepCounter: 43c13db8-7f40-4ec6-b4cb-fb85c4f1f157
            transform: ODS_SAP_TFKBT_WBS.FKBTX
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 600d3d43-44c5-4753-9558-536c69eb0086
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: WBS Requesting Cost Center
        name: AFE_CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56e78e87-f44e-4a8b-a9d4-3c95884350e0
                stepCounter: 3582ff46-fac5-4ac0-9aa5-b3268952c703
            transform: NULLIF(TRIM(LTRIM(ODS_SAP_PRPS.AKSTL,'0'),' '),'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2fe7b40c-4fb2-4aba-bb20-2e9817f941e8
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: WBS Requesting Cost Center Functional Area
        name: AFE_CC_FUNCTIONAL_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9ffce451-e676-4bac-8b51-033436e1e7fe
                stepCounter: aa27980f-cc7c-4789-a145-f840ecccef05
            transform: ODS_SAP_CSKS_WBS.FUNC_AREA
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7d14b92-5cbc-43b9-8faf-aea83fe3e380
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: WBS Requesting Cost Center Functional Area Name
        name: AFE_CC_FUNCTIONAL_AREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b04d2b4d-12c4-487d-9c2f-e05dd85350f9
                stepCounter: 43c13db8-7f40-4ec6-b4cb-fb85c4f1f157
            transform: ODS_SAP_TFKBT_WBS_CC.FKBTX
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d933cbc-9a47-4114-90b0-9866cc53fa70
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(12)
        defaultValue: ""
        description: Order Number
        name: ORDER_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3f8117ae-2e88-4c6c-b40a-c63bef7c712b
                stepCounter: 52782c2c-549d-4460-9975-11ccecdb6158
            transform: NULLIF(TRIM(LTRIM(ODS_SAP_ACDOCA.AUFNR,'0'),' '),'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1454f8d6-d582-4ed6-b5ba-f768ec5e9abb
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(16)
        defaultValue: ""
        description: Order Functional Area
        name: ORDER_FUNCTIONAL_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2207e42-a0af-4bae-8870-9be97860fe1e
                stepCounter: 52782c2c-549d-4460-9975-11ccecdb6158
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4be7363c-687b-4908-9792-e02d756e3cdd
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: Order Functional Area Name
        name: ORDER_FUNCTIONAL_AREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b04d2b4d-12c4-487d-9c2f-e05dd85350f9
                stepCounter: 43c13db8-7f40-4ec6-b4cb-fb85c4f1f157
            transform: ODS_SAP_TFKBT_ORDER.FKBTX
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 073d6da1-1d74-4a19-9622-f9d0b7243996
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Order Cost Center for Basic Settlement
        name: ORDER_CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 73e5e004-28b9-45e0-9981-f3eb02a541c1
                stepCounter: 52782c2c-549d-4460-9975-11ccecdb6158
            transform: NULLIF(TRIM(LTRIM(ODS_SAP_AUFK.KOSTL,'0'),' '),'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bfdfb569-be61-41bf-a6d1-a645a797a0e7
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Order Requesting Cost Center
        name: ORDER_REQ_CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2f756e23-e820-4e93-9b45-3e3b33da7155
                stepCounter: 52782c2c-549d-4460-9975-11ccecdb6158
            transform: NULLIF(TRIM(LTRIM(ODS_SAP_AUFK.AKSTL,'0'),' '),'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4ccfc19-bd46-44c8-bcde-50f44887c78e
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Order Responsible Cost Center
        name: ORDER_RESP_CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2b7272f0-ffc7-448d-99bc-5f56e9f43ce7
                stepCounter: 52782c2c-549d-4460-9975-11ccecdb6158
            transform: NULLIF(TRIM(LTRIM(ODS_SAP_AUFK.KOSTV,'0'),' '),'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce3a1f65-7bbb-4647-a215-b8999bd81a39
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(16)
        defaultValue: ""
        description: Order Cost Center Functional Area
        name: ORDER_CC_FUNCTIONAL_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9ffce451-e676-4bac-8b51-033436e1e7fe
                stepCounter: aa27980f-cc7c-4789-a145-f840ecccef05
            transform: ODS_SAP_CSKS_ORDER.FUNC_AREA
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb1f3049-2c2b-4bfc-82ec-d67f9e8e232e
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: Order Cost Center Functional Area Name
        name: ORDER_CC_FUNCTIONAL_AREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b04d2b4d-12c4-487d-9c2f-e05dd85350f9
                stepCounter: 43c13db8-7f40-4ec6-b4cb-fb85c4f1f157
            transform: ODS_SAP_TFKBT_ORDER_CC.FKBTX
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3efae5fd-0ab4-49a6-bab0-afb42fc33d87
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(24)
        defaultValue: ""
        description: Work breakdown structure element (WBS element)
        name: ORDER_AFE_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3793af05-7532-4997-8f05-0bcdac878d0a
                stepCounter: 3582ff46-fac5-4ac0-9aa5-b3268952c703
            transform: ODS_SAP_PRPS_ORDER.POSID
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd5ed8f8-1ed0-4a50-baa9-50f346e1bdcb
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(16)
        defaultValue: ""
        description: Order WBS Functional Area
        name: ORDER_AFE_FUNCTIONAL_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9ffce451-e676-4bac-8b51-033436e1e7fe
                stepCounter: aa27980f-cc7c-4789-a145-f840ecccef05
            transform: ODS_SAP_PRPS_ORDER.FUNC_AREA
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 51af2535-8fbb-4a18-b775-0a456bd6f8d6
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: Order WBS Functional Area Name
        name: ORDER_AFE_FUNCTIONAL_AREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b04d2b4d-12c4-487d-9c2f-e05dd85350f9
                stepCounter: 43c13db8-7f40-4ec6-b4cb-fb85c4f1f157
            transform: ODS_SAP_TFKBT_ORDER_WBS.FKBTX
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 108578c5-58b1-4d57-b2f8-ef8424d466c3
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Order WBS Cost Center
        name: ORDER_AFE_CC_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56e78e87-f44e-4a8b-a9d4-3c95884350e0
                stepCounter: 3582ff46-fac5-4ac0-9aa5-b3268952c703
            transform: NULLIF(TRIM(LTRIM(ODS_SAP_PRPS_ORDER.AKSTL,'0'),' '),'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d17afcd3-8790-40c3-bfdb-071e77adc8dc
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(16)
        defaultValue: ""
        description: Order WBS Cost Center Functional Area
        name: ORDER_AFE_CC_FUNCTIONAL_AREA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9ffce451-e676-4bac-8b51-033436e1e7fe
                stepCounter: aa27980f-cc7c-4789-a145-f840ecccef05
            transform: ODS_SAP_CSKS_ORDER_WBS.FUNC_AREA
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4abcef5b-4f95-466d-bfe6-a8232ae14c6a
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: Order WBS Cost Center Functional Area Name
        name: ORDER_AFE_CC_FUNCTIONAL_AREA_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b04d2b4d-12c4-487d-9c2f-e05dd85350f9
                stepCounter: 43c13db8-7f40-4ec6-b4cb-fb85c4f1f157
            transform: ODS_SAP_TFKBT_ORDER_WBS_CC.FKBTX
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f152bf61-8abd-4756-b420-a8fe1a613eb3
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Lease Ops Line Number via Account/Functional Area mapping
        name: LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c02c4151-2808-440d-ad57-3d4f52333704
                stepCounter: 0f7c3247-c9eb-4614-9f5c-d10ca228a02b
            transform: |-
              CASE --assign line no if Docment Type is not NULL and account >400000 XOR =120060 XOR <> 791000

                          WHEN NULLIF(ODS_SAP_ACDOCA.BLART,'') IS NULL                                                             THEN NULL
                          WHEN LTRIM(ODS_SAP_ACDOCA.RACCT,'0') = '791000'                                                          THEN NULL
                          WHEN TO_NUMBER(LTRIM(ODS_SAP_ACDOCA.RACCT,'0')) < 400000 AND LTRIM(ODS_SAP_ACDOCA.RACCT,'0') <> '120060' THEN NULL
                          ELSE CASE -- LI Order Reference
               WHEN NULLIF(TRIM(LTRIM(ODS_SAP_ACDOCA.AUFNR,'0'),' '),'') IS NOT NULL THEN CASE -- Order Non-Capital WBS Reference
               WHEN NVL(ODS_SAP_AUFK.PSPEL,0) <> 0 AND NVL(LOAD_VET_FIN_SAP_AFE_TYPE_ATTR_ORDER.NON_CAPITAL_FLAG,'Y') = 'Y' THEN COALESCE(LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER_WBS.LINE_NO, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER_WBS_CC.LINE_NO, LOAD_VET_FIN_SAP_LEASE_OPS_HIER_ORDER_FA.LINE_NO, LOAD_VET_FIN_SAP_LEASE_OPS_HIER_ORDER_CC_FA.LINE_NO, LOAD_VET_FIN_SAP_LEASE_OPS_HIER_ORDER_WBS_FA.LINE_NO, LOAD_VET_FIN_SAP_LEASE_OPS_HIER_ORDER_WBS_CC_FA.LINE_NO, LOAD_VET_FIN_SAP_LEASE_OPS_HIER_NO_FA.LINE_NO) -- Order Capital WBS Reference
               WHEN NVL(ODS_SAP_AUFK.PSPEL,0) <> 0 AND NVL(LOAD_VET_FIN_SAP_AFE_TYPE_ATTR_ORDER.NON_CAPITAL_FLAG,'Y') = 'N' THEN COALESCE(LOAD_VET_FIN_SAP_AFE_TYPE_ATTR_ORDER.LINE_NO, LOAD_VET_FIN_SAP_LEASE_OPS_HIER_ORDER_WBS_FA.LINE_NO, LOAD_VET_FIN_SAP_LEASE_OPS_HIER_NO_FA.LINE_NO) -- Order No WBS Reference
               ELSE COALESCE(LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER.LINE_NO, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER_CC.LINE_NO, LOAD_VET_FIN_SAP_LEASE_OPS_HIER_ORDER_FA.LINE_NO, LOAD_VET_FIN_SAP_LEASE_OPS_HIER_ORDER_CC_FA.LINE_NO, LOAD_VET_FIN_SAP_LEASE_OPS_HIER_NO_FA.LINE_NO) END -- No LI Order or WBS Reference AND Not Captial Inventory Account
               WHEN NULLIF(TRIM(LTRIM(ODS_SAP_ACDOCA.AUFNR,'0'),' '),'') IS NULL AND NVL(ODS_SAP_ACDOCA.PS_PSP_PNR,0) = 0 AND LTRIM(ODS_SAP_ACDOCA.RACCT,'0') <> '120060' THEN COALESCE(LOAD_VET_FIN_SAP_ACCOUNT_ATTR_LI.LINE_NO, LOAD_VET_FIN_SAP_LEASE_OPS_HIER_LI_FA.LINE_NO, LOAD_VET_FIN_SAP_LEASE_OPS_HIER_NO_FA.LINE_NO) -- No LI Order Reference, LI Non-Captial WBS Reference
               WHEN NULLIF(TRIM(LTRIM(ODS_SAP_ACDOCA.AUFNR,'0'),' '),'') IS NULL AND NVL(ODS_SAP_ACDOCA.PS_PSP_PNR,0) <> 0 AND NVL(LOAD_VET_FIN_SAP_AFE_TYPE_ATTR.NON_CAPITAL_FLAG,'Y') = 'Y' THEN COALESCE(LOAD_VET_FIN_SAP_ACCOUNT_ATTR_LI.LINE_NO, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_WBS.LINE_NO, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_WBS_CC.LINE_NO, LOAD_VET_FIN_SAP_LEASE_OPS_HIER_LI_FA.LINE_NO, LOAD_VET_FIN_SAP_LEASE_OPS_HIER_WBS_FA.LINE_NO, LOAD_VET_FIN_SAP_LEASE_OPS_HIER_WBS_CC_FA.LINE_NO, LOAD_VET_FIN_SAP_LEASE_OPS_HIER_NO_FA.LINE_NO) -- No LI Order Reference, LI Captial WBS Reference
               WHEN NULLIF(TRIM(LTRIM(ODS_SAP_ACDOCA.AUFNR,'0'),' '),'') IS NULL AND NVL(ODS_SAP_PRPS.PSPNR,0) <> 0 AND NVL(LOAD_VET_FIN_SAP_AFE_TYPE_ATTR.NON_CAPITAL_FLAG,'Y') = 'N' THEN COALESCE(LOAD_VET_FIN_SAP_AFE_TYPE_ATTR.LINE_NO, LOAD_VET_FIN_SAP_LEASE_OPS_HIER_WBS_FA.LINE_NO, LOAD_VET_FIN_SAP_LEASE_OPS_HIER_NO_FA.LINE_NO) END
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e98d3af-8476-481d-ae4b-7ff7397712bd
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: Product Code via Account/Functional Area mapping
        name: PROD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a9735c6e-3acf-4cb3-9ad5-d21dfe0c8063
                stepCounter: 181145f3-06a6-4ad9-b836-9a574745c577
            transform: |-
              DECODE(NULLIF(TRIM(LTRIM(ODS_SAP_ACDOCA.AUFNR,'0'),' '),''), -- No LI Order Reference
               NULL, DECODE(NVL(ODS_SAP_ACDOCA.PS_PSP_PNR,0), -- No LI WBS Reference
               0, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_LI.PROD_CODE, -- LI WBS Reference
               DECODE(NVL(LOAD_VET_FIN_SAP_AFE_TYPE_ATTR.NON_CAPITAL_FLAG,'Y'), --Non-Capital Project Type
               'Y', COALESCE(LOAD_VET_FIN_SAP_ACCOUNT_ATTR_LI.PROD_CODE, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_WBS.PROD_CODE, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_WBS_CC.PROD_CODE), --Capital Project Type
               'N', NULL)), -- LI Order Reference
               DECODE(NVL(ODS_SAP_AUFK.PSPEL,0), -- No Order WBS Reference
               0, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER.PROD_CODE, -- Order WBS Reference
               DECODE(NVL(LOAD_VET_FIN_SAP_AFE_TYPE_ATTR_ORDER.NON_CAPITAL_FLAG,'Y'), --Non-Capital Project Type
               'Y', COALESCE(LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER.PROD_CODE, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER_WBS.PROD_CODE, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER_WBS_CC.PROD_CODE), --Capital Project Type
               'N', NULL)))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa1cff04-2d11-4081-bed1-8238585acfc1
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: Account Group Code via Account/Functional Area mapping
        name: ACCT_GROUP_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1688c7bb-3d0d-4a5c-90c0-e36aee96f970
                stepCounter: 181145f3-06a6-4ad9-b836-9a574745c577
            transform: |-
              DECODE(NULLIF(TRIM(LTRIM(ODS_SAP_ACDOCA.AUFNR,'0'),' '),''), -- No LI Order Reference
               NULL, DECODE(NVL(ODS_SAP_ACDOCA.PS_PSP_PNR,0), -- No LI WBS Reference
               0, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_LI.ACCT_GROUP_CODE, -- LI WBS Reference
               DECODE(NVL(LOAD_VET_FIN_SAP_AFE_TYPE_ATTR.NON_CAPITAL_FLAG,'Y'), --Non-Capital Project Type
               'Y', COALESCE(LOAD_VET_FIN_SAP_ACCOUNT_ATTR_LI.ACCT_GROUP_CODE, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_WBS.ACCT_GROUP_CODE, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_WBS_CC.ACCT_GROUP_CODE), --Capital Project Type
               'N', NULL)), -- LI Order Reference
               DECODE(NVL(ODS_SAP_AUFK.PSPEL,0), -- No Order WBS Reference
               0, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER.ACCT_GROUP_CODE, -- Order WBS Reference
               DECODE(NVL(LOAD_VET_FIN_SAP_AFE_TYPE_ATTR_ORDER.NON_CAPITAL_FLAG,'Y'), --Non-Capital Project Type
               'Y', COALESCE(LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER.ACCT_GROUP_CODE, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER_WBS.ACCT_GROUP_CODE, LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER_WBS_CC.ACCT_GROUP_CODE), --Capital Project Type
               'N', NULL)))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 778a2103-3f7f-406e-a52e-485ca835ba7e
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(18)
        defaultValue: ""
        description: Assignment
        name: ASSIGNMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c8d5273d-83ad-42d9-9c48-4b1f60aa39fc
                stepCounter: d310660d-8d8d-4155-898e-2bc2c935b749
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9fd5ee0c-480a-4fd8-9073-382efa3c8774
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: NUMBER(6)
        defaultValue: ""
        description: Source Document Number
        name: SRC_DOCUMENT_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c2936913-4dab-4eb0-a79b-e2211e71c171
                stepCounter: d310660d-8d8d-4155-898e-2bc2c935b749
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0016cac8-34d7-4d20-a1b1-ade2d69e1efb
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Source Document Line Item
        name: SRC_DOCUMENT_LINE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9db8cf93-f831-4fe6-b74f-fc74c77980ac
                stepCounter: d310660d-8d8d-4155-898e-2bc2c935b749
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5589402-5ebf-4aa6-824a-862283e25001
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: Special G/L Indicator
        name: SPECIAL_GL_IND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d1cb5af4-a737-456b-9245-c07341f0d55c
                stepCounter: d310660d-8d8d-4155-898e-2bc2c935b749
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 472fa38f-d9f4-4974-8884-280f4e35693c
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: NUMBER(21)
        defaultValue: ""
        description: Cutback Run ID
        name: CUTBACK_RUN_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e997391-04a4-458a-bf6b-4ba212fc8d76
                stepCounter: d310660d-8d8d-4155-898e-2bc2c935b749
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a329cce-d41b-4149-9a67-57f233dc2f84
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Offsetting Account
        name: OFFSET_ACCOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f03290d-d22a-4493-8d9d-cbcf11018fc7
                stepCounter: d310660d-8d8d-4155-898e-2bc2c935b749
            transform: LTRIM(ODS_SAP_ACDOCA.GKONT,'0')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a951d7c-d31c-45dc-8fe4-603578c4f53f
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: G/L Account Long Text or Business Partner Name
        name: OFFSET_ACCOUNT_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03191fa0-b453-4f65-884d-bd7427484f41
                stepCounter: 0916925b-ab25-46b1-ba79-1612daedec0e
            transform: |-
              CASE WHEN ODS_SAP_ACDOCA.GKOAR IN ('D','K') THEN COALESCE(NULLIF(NAME_ORG1,'') ,NULLIF(NAME1_TEXT,'') ,TRIM(NULLIF(NAME_FIRST,'')||' '||NULLIF(NAME_LAST,'')))
                          ELSE NULLIF(ODS_SAP_SKAT.TXT50,'')
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd4c33f3-00f0-4187-8bce-75185631972e
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: Tax Code
        name: TAX_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84c41e92-ede5-490a-843a-08d58abce754
                stepCounter: d310660d-8d8d-4155-898e-2bc2c935b749
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b695c89c-26ce-4a1c-a317-da4354456c7d
          stepCounter: 28bb3eb1-eb1c-42be-9616-beacb93bde45
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: Reference Procedure
        name: REF_PROCEDURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ccf3f8eb-a2ab-4425-8839-10112c82f91d
                stepCounter: d310660d-8d8d-4155-898e-2bc2c935b749
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ODS_SAP_ACDOCA: d310660d-8d8d-4155-898e-2bc2c935b749
          ODS_SAP_T001: 2c701d0c-4f6b-4d48-bf42-61b56bce4087
          LOAD_VET_FIN_SAP_CAP_INV_ORG_AFE: 182fc6a2-bd02-4b26-a6d3-3d1b48d8539e
          ODS_SAP_PRPS: 3582ff46-fac5-4ac0-9aa5-b3268952c703
          ODS_SAP_AUFK: 52782c2c-549d-4460-9975-11ccecdb6158
          LOAD_VET_FIN_SAP_ACCOUNT_ATTR: 181145f3-06a6-4ad9-b836-9a574745c577
          ODS_SAP_CSKS: aa27980f-cc7c-4789-a145-f840ecccef05
          LOAD_VET_FIN_SAP_AFE_TYPE_ATTR: 8702aa25-7591-4f91-9bfe-26019e5744dc
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: ODS_SAP_ACDOCA
          - locationName: TARGET
            nodeName: ODS_SAP_T001
          - locationName: TARGET
            nodeName: LOAD_VET_FIN_SAP_CAP_INV_ORG_AFE
          - locationName: TARGET
            nodeName: ODS_SAP_PRPS
          - locationName: TARGET
            nodeName: ODS_SAP_AUFK
          - locationName: TARGET
            nodeName: LOAD_VET_FIN_SAP_ACCOUNT_ATTR
          - locationName: TARGET
            nodeName: ODS_SAP_CSKS
          - locationName: TARGET
            nodeName: LOAD_VET_FIN_SAP_AFE_TYPE_ATTR
        join:
          joinCondition: |-
            EXTENDED
              FROM (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_ACDOCA') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) ODS_SAP_ACDOCA -- Company 	LEFT JOIN (SELECT * FROM {{ ref('TARGET','ODS_SAP_T001') }} WHERE DSS_CURRENT_FLAG = 'Y' AND DSS_DELETE_FLAG != 'Y') ODS_SAP_T001 	  ON ODS_SAP_ACDOCA.RBUKRS = ODS_SAP_T001.BUKRS 	-- Company default WBS Elements for Captial Inventory case 	LEFT JOIN {{ ref('TARGET','LOAD_VET_FIN_SAP_CAP_INV_ORG_AFE') }} LOAD_VET_FIN_SAP_CAP_INV_ORG_AFE 	  ON ODS_SAP_ACDOCA.RBUKRS = LOAD_VET_FIN_SAP_CAP_INV_ORG_AFE.ORG_ID AND LTRIM(ODS_SAP_ACDOCA.RACCT,'0') = '120060' 	LEFT JOIN (SELECT * FROM {{ ref('TARGET','ODS_SAP_PRPS') }} WHERE DSS_CURRENT_FLAG = 'Y' AND DSS_DELETE_FLAG != 'Y') ODS_SAP_PRPS_CAP_INV 	  ON LOAD_VET_FIN_SAP_CAP_INV_ORG_AFE.AFE_NUM = ODS_SAP_PRPS_CAP_INV.POSID   -- * LI Order Reference * -- 	LEFT JOIN (SELECT * FROM {{ ref('TARGET','ODS_SAP_AUFK') }} WHERE DSS_CURRENT_FLAG = 'Y' AND DSS_DELETE_FLAG != 'Y') ODS_SAP_AUFK         ON ODS_SAP_ACDOCA.AUFNR = ODS_SAP_AUFK.AUFNR	 	-- Order Account Attributes  	LEFT JOIN {{ ref('TARGET','LOAD_VET_FIN_SAP_ACCOUNT_ATTR') }} LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER 	  ON LTRIM(ODS_SAP_ACDOCA.RACCT,'0') = LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER.ACCOUNT AND ODS_SAP_AUFK.FUNC_AREA = LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER.FAREA 	-- Order Cost Center Account Attributes   	LEFT JOIN (SELECT * FROM {{ ref('TARGET','ODS_SAP_CSKS') }} WHERE DSS_CURRENT_FLAG = 'Y' AND DSS_DELETE_FLAG != 'Y') ODS_SAP_CSKS_ORDER 	  ON COALESCE(ODS_SAP_AUFK.KOSTL,ODS_SAP_AUFK.AKSTL,ODS_SAP_AUFK.KOSTV)  = ODS_SAP_CSKS_ORDER.KOSTL     	LEFT JOIN {{ ref('TARGET','LOAD_VET_FIN_SAP_ACCOUNT_ATTR') }} LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER_CC 	  ON LTRIM(ODS_SAP_ACDOCA.RACCT,'0') = LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER_CC.ACCOUNT AND ODS_SAP_CSKS_ORDER.FUNC_AREA = LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER_CC.FAREA 	-- Order WBS Elements 	LEFT JOIN (SELECT * FROM {{ ref('TARGET','ODS_SAP_PRPS') }} WHERE DSS_CURRENT_FLAG = 'Y' AND DSS_DELETE_FLAG != 'Y') ODS_SAP_PRPS_ORDER 	  ON NULLIF(ODS_SAP_AUFK.PSPEL,0) = ODS_SAP_PRPS_ORDER.PSPNR 	-- Order WBS Type Attributes 	LEFT JOIN {{ ref('TARGET','LOAD_VET_FIN_SAP_AFE_TYPE_ATTR') }} LOAD_VET_FIN_SAP_AFE_TYPE_ATTR_ORDER 	  ON ODS_SAP_PRPS_ORDER.PRART = LOAD_VET_FIN_SAP_AFE_TYPE_ATTR_ORDER.AFE_TYPE	 	-- Order WBS Non-Captial Account Attributes  	LEFT JOIN {{ ref('TARGET','LOAD_VET_FIN_SAP_ACCOUNT_ATTR') }} LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER_WBS 	  ON LTRIM(ODS_SAP_ACDOCA.RACCT,'0') = LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER_WBS.ACCOUNT  		AND ODS_SAP_PRPS_ORDER.FUNC_AREA = LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER_WBS.FAREA 	-- Order WBS Cost Center Account Attributes   	LEFT JOIN (SELECT * FROM {{ ref('TARGET','ODS_SAP_CSKS') }} WHERE DSS_CURRENT_FLAG = 'Y' AND DSS_DELETE_FLAG != 'Y') ODS_SAP_CSKS_ORDER_WBS 	  ON ODS_SAP_PRPS_ORDER.AKSTL = ODS_SAP_CSKS_ORDER_WBS.KOSTL     	LEFT JOIN {{ ref('TARGET','LOAD_VET_FIN_SAP_ACCOUNT_ATTR') }} LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER_WBS_CC 	  ON LTRIM(ODS_SAP_ACDOCA.RACCT,'0') = LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER_WBS_CC.ACCOUNT AND ODS_SAP_CSKS_ORDER_WBS.FUNC_AREA = LOAD_VET_FIN_SAP_ACCOUNT_ATTR_ORDER_WBS_CC.FAREA  		   -- * LI WBS Reference * --		 	-- WBS Elements (From LI or via Company default WBS when Captial Inventory case) 	LEFT JOIN (SELECT * FROM {{ ref('TARGET','ODS_SAP_PRPS') }} WHERE DSS_CURRENT_FLAG = 'Y' AND DSS_DELETE_FLAG != 'Y') ODS_SAP_PRPS 	  ON COALESCE(NULLIF(ODS_SAP_ACDOCA.PS_PSP_PNR,0),NULLIF(ODS_SAP_PRPS_CAP_INV.PSPNR,0)) = ODS_SAP_PRPS.PSPNR 	-- WBS Type Attributes 	LEFT JOIN {{ ref('TARGET','LOAD_VET_FIN_SAP_AFE_TYPE_ATTR') }} LOAD_VET_FIN_SAP_AFE_TYPE_ATTR 	  ON ODS_SAP_PRPS.PRART = LOAD_VET_FIN_SAP_AFE_TYPE_ATTR.AFE_TYPE 	-- WBS Non-Captial Account Attributes  	LEFT JOIN {{ ref('TARGET','LOAD_VET_FIN_SAP_ACCOUNT_ATTR') }} LOAD_VET_FIN_SAP_ACCOUNT_ATTR_WBS 	  ON LTRIM(ODS_SAP_ACDOCA.RACCT,'0') = LOAD_VET_FIN_SAP_ACCOUNT_ATTR_WBS.ACCOUNT  		AND ODS_SAP_PRPS.FUNC_AREA = LOAD_VET_FIN_SAP_ACCOUNT_ATTR_WBS.FAREA 	-- WBS Cost Center Account Attributes   	LEFT JOIN (SELECT *
        name: STAGE_FIN_SAP_LINE_ITEM
        noLinkRefs: []
  name: STAGE_FIN_SAP_LINE_ITEM
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
