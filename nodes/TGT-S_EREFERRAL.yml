fileVersion: 1
id: 44f1699c-35fd-4396-8e1b-aef04b23ff1d
name: S_EREFERRAL
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd4e2df4-5c9c-4cfa-a735-9d4803c8ca6f
          stepCounter: 44f1699c-35fd-4396-8e1b-aef04b23ff1d
        config: {}
        dataType: INT
        defaultValue: ""
        description: s_eReferral.specialty_reference_no=dim_specialty.specialty_reference_no
        name: DIM_SPECIALTY_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79aee918-ff6f-4b0a-a656-000827899f3e
                stepCounter: 4182a75e-d07b-4637-97fa-4c01e2878360
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2fb2e13d-b839-4ad0-89e2-8c970986dd58
          stepCounter: 44f1699c-35fd-4396-8e1b-aef04b23ff1d
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_eReferral.erefnhi=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9962a01b-5f3d-4c1a-b371-997edef38d0f
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eca557cc-cb92-4d99-97d9-eb00c7748b49
          stepCounter: 44f1699c-35fd-4396-8e1b-aef04b23ff1d
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: EREFUID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c072d235-0666-4ece-87ef-27ddbf575826
                stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d0a03f4-d12d-419a-bb88-e53490c73510
          stepCounter: 44f1699c-35fd-4396-8e1b-aef04b23ff1d
        config: {}
        dataType: NVARCHAR(15)
        defaultValue: ""
        description: ""
        name: NHI
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 211867f6-fe2f-4044-85fe-fc142af1bd57
                stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a981156d-6bb6-4a79-8f51-32785dee5623
          stepCounter: 44f1699c-35fd-4396-8e1b-aef04b23ff1d
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: EXTERNAL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9e10253f-9db1-4001-982a-8b88bc2fe85e
                stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1bf1c201-da6e-4d5d-b9b9-cbbbb7a98d0b
          stepCounter: 44f1699c-35fd-4396-8e1b-aef04b23ff1d
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b714c92b-021d-400a-94f4-e8598c7da80b
                stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fceb2dad-bdb8-46d7-b94e-b1dcabf013a5
          stepCounter: 44f1699c-35fd-4396-8e1b-aef04b23ff1d
        config: {}
        dataType: NVARCHAR(200)
        defaultValue: ""
        description: ""
        name: CURRENT_SERVICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 684bdfe3-76ec-4ff7-8d0b-ec1d86167e8a
                stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21e6b84b-0aca-493a-8bdd-19f497a61579
          stepCounter: 44f1699c-35fd-4396-8e1b-aef04b23ff1d
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: CURRENT_SERVICE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf2184cc-00a2-4989-98ab-0d1d56ed0df5
                stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2845b4c5-f92a-4566-9b2b-93fb0aac1ad8
          stepCounter: 44f1699c-35fd-4396-8e1b-aef04b23ff1d
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: EREFNHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b99cef9a-8bc5-4b4d-8ff0-12a0d9c6049d
                stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a815404-8bb2-410e-a5eb-3f17572b4124
          stepCounter: 44f1699c-35fd-4396-8e1b-aef04b23ff1d
        config: {}
        dataType: INT
        defaultValue: ""
        description: PIMS Speciality Reference Number
        name: SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c5177e8-2145-4117-95e6-12441980e2e4
                stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a14956e8-900f-4cdd-b29a-953646026d21
          stepCounter: 44f1699c-35fd-4396-8e1b-aef04b23ff1d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SUBMISSION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 87dbcaac-30bc-4abe-9eff-4fd66e6302de
                stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 739f2672-d87b-451d-9467-3cef0fd7fcd9
          stepCounter: 44f1699c-35fd-4396-8e1b-aef04b23ff1d
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e918f302-ee08-418c-bac3-0eaa3a7f631b
                stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b507b66-7e63-452c-945a-4387e116d117
          stepCounter: 44f1699c-35fd-4396-8e1b-aef04b23ff1d
        config: {}
        dataType: NVARCHAR(200)
        defaultValue: ""
        description: ""
        name: STATUS_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9aad4909-fa54-4ca6-a29a-58c6848a1de3
                stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dd5286c2-e0f7-4df8-9d74-a3c4f9157f28
          stepCounter: 44f1699c-35fd-4396-8e1b-aef04b23ff1d
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: RFA_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e26b3c84-52e4-4b92-9629-dff70637fabd
                stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 311fd708-7c1a-4be3-b92f-b689f773e67c
          stepCounter: 44f1699c-35fd-4396-8e1b-aef04b23ff1d
        config: {}
        dataType: NVARCHAR(200)
        defaultValue: ""
        description: ""
        name: RFA_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce1b6b5a-7c0d-4b8e-b92a-946e718ece3e
                stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5088f4f1-c0a5-4400-86cf-9422d4dbbcea
          stepCounter: 44f1699c-35fd-4396-8e1b-aef04b23ff1d
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: MATCH_REFERENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 101c1020-0656-4ebf-a926-cfd0059e95aa
                stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1ba9876-b29d-4f89-bee5-163b635b5f00
          stepCounter: 44f1699c-35fd-4396-8e1b-aef04b23ff1d
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: MATCH_CERTAINTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3847ccbd-59c6-4c3f-9c45-aa8863e27146
                stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb24d6d2-efca-4d51-b6ad-e6e58b5968f3
          stepCounter: 44f1699c-35fd-4396-8e1b-aef04b23ff1d
        config: {}
        dataType: NVARCHAR(5)
        defaultValue: ""
        description: ""
        name: MERGED_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22e84832-3213-4c48-855d-ee40a7c03c14
                stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6e000c3-3162-4c79-9b65-4f89768f4a86
          stepCounter: 44f1699c-35fd-4396-8e1b-aef04b23ff1d
        config: {}
        dataType: VARCHAR(200)
        defaultValue: ""
        description: ""
        name: MATCH_REASON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3deae3ce-b584-4f54-b78e-578568233150
                stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 61534499-4967-4698-9f09-d18c15177a8f
          stepCounter: 44f1699c-35fd-4396-8e1b-aef04b23ff1d
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PIMS_PATIENT_REFERENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76217a61-422a-4359-9d1f-b5f0d61afdd9
                stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3f681e7-4ff4-49a8-82c8-cabce6c79e1f
          stepCounter: 44f1699c-35fd-4396-8e1b-aef04b23ff1d
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PIMS_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea2edee7-7cbd-4061-b5f1-0c78c3ca303a
                stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db688c83-d912-4245-b1ed-912d10f1f60e
          stepCounter: 44f1699c-35fd-4396-8e1b-aef04b23ff1d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PIMS_REFERRAL_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1770b5be-4293-400c-9938-f988e68dc139
                stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b386b264-1b6f-4e85-824b-b1981e809962
          stepCounter: 44f1699c-35fd-4396-8e1b-aef04b23ff1d
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: DAYS_BETWEEN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 650aeff2-5b90-452a-a7ed-cf39640b0ca6
                stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2bf596a0-faff-44ae-b996-f73dcdb44b1b
          stepCounter: 44f1699c-35fd-4396-8e1b-aef04b23ff1d
        config: {}
        dataType: NVARCHAR(50)
        defaultValue: ""
        description: ""
        name: STATUS_CHANGED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 71302a4e-d4a6-4bad-9de7-ea5ad6d352ec
                stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d1b9665f-7671-48d2-9cb5-45ee15211b5c
          stepCounter: 44f1699c-35fd-4396-8e1b-aef04b23ff1d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REGISTERED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c01bb7ad-a6c9-4cd0-bab6-d9338afef4d5
                stepCounter: 10dda8e2-688e-4a23-9ca2-06986ffe7647
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6db9474-e88b-455a-bd21-7255dade1397
          stepCounter: 44f1699c-35fd-4396-8e1b-aef04b23ff1d
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_EREFERRAL_40: 10dda8e2-688e-4a23-9ca2-06986ffe7647
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DIM_SPECIALTY
          - locationName: TGT
            nodeName: S_EREFERRAL_40
        join:
          joinCondition: FROM {{ ref('TGT','S_EREFERRAL_40') }} s_eReferral_40
        name: S_EREFERRAL
        noLinkRefs: []
  name: S_EREFERRAL
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
