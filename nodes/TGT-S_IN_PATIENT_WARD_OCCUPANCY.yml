fileVersion: 1
id: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
name: S_IN_PATIENT_WARD_OCCUPANCY
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Custom procedure only to pre-populate ward occupancy and update fields"
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cde1ffd1-81c3-4ea2-93d2-18a473e39ac0
          stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_WARD_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6aa5e7b8-4dc5-4b87-a4c2-5013db0e1dfc
                stepCounter: 50c31151-9204-4154-9caf-5d28244bde1a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42978c1b-9c52-42ba-8f21-b443652b2ec1
          stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Service_Point_Reference_Number
        name: WARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe4759bc-c968-4e0b-95f7-850118a3d88b
                stepCounter: 50c31151-9204-4154-9caf-5d28244bde1a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2d7b3c5-63f0-4222-a0d2-b6f316e7d513
          stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e325898-55b4-4da5-b829-888e5823e2fc
                stepCounter: bc3fcb77-c0c4-477a-92d8-4db14f153b73
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26049080-be56-47cf-a911-790975d8b8a9
          stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_00
        name: OCCUPANCY_TIME_SLOT_00
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a569a73-316b-4ebb-b2b2-e3df19d639eb
          stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_01
        name: OCCUPANCY_TIME_SLOT_01
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f91c9cd-33a3-430e-a16b-d2c4ddc565dd
          stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_02
        name: OCCUPANCY_TIME_SLOT_02
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f4fc6f6-8f6e-407a-8db8-b590660187d1
          stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_03
        name: OCCUPANCY_TIME_SLOT_03
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5917d817-cc8b-40e7-aad8-5b10bd34f1dd
          stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_04
        name: OCCUPANCY_TIME_SLOT_04
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d762547-c899-4a48-b4aa-fd946f388df0
          stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_05
        name: OCCUPANCY_TIME_SLOT_05
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0932013a-9eaa-4c5b-91c2-ba052836dbc8
          stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_06
        name: OCCUPANCY_TIME_SLOT_06
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3d57c22-cc32-4b58-a95a-8efd84a59ac1
          stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_07
        name: OCCUPANCY_TIME_SLOT_07
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16c6c01f-ba57-4a29-b777-509ac5c7c555
          stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_08
        name: OCCUPANCY_TIME_SLOT_08
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1e1a76d-3df2-48d4-832d-f2dc88b15ae6
          stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_09
        name: OCCUPANCY_TIME_SLOT_09
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f3aa0aa-5774-4140-ae21-572ef9b4717a
          stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_10
        name: OCCUPANCY_TIME_SLOT_10
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f13574c9-9b20-4dc0-a34b-01f292bedb41
          stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_11
        name: OCCUPANCY_TIME_SLOT_11
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2160b95a-74f2-41ea-953d-976bb4e18829
          stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_12
        name: OCCUPANCY_TIME_SLOT_12
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9ddeb1b-9c71-4d42-8ac1-989c80a50763
          stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_13
        name: OCCUPANCY_TIME_SLOT_13
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02cda9b1-42a7-4a47-ad8f-ea05345113b0
          stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_14
        name: OCCUPANCY_TIME_SLOT_14
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98600e03-4a28-45f8-9d19-90b94918021f
          stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_15
        name: OCCUPANCY_TIME_SLOT_15
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96aebfc0-02cd-492b-84af-41fa7a6e458e
          stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_16
        name: OCCUPANCY_TIME_SLOT_16
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67742463-5978-46e4-bd28-818a2177367e
          stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_17
        name: OCCUPANCY_TIME_SLOT_17
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4deba310-fcdc-4aa1-b073-7df773497af0
          stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_18
        name: OCCUPANCY_TIME_SLOT_18
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6630305a-0a15-4f0c-8306-42f3faf7a971
          stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_19
        name: OCCUPANCY_TIME_SLOT_19
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c16067e-cd92-4dc2-aaf1-470aad1299c0
          stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_20
        name: OCCUPANCY_TIME_SLOT_20
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6cbfbfdc-1f98-445e-a92c-fa0b524c2464
          stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_21
        name: OCCUPANCY_TIME_SLOT_21
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8829f8f-8c1e-4a29-adde-b68206845b6a
          stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_22
        name: OCCUPANCY_TIME_SLOT_22
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5a7282e-5d3e-44b3-b376-fcd97fd0d9f2
          stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_time_slot_23
        name: OCCUPANCY_TIME_SLOT_23
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92889cd0-5fe0-4486-92d0-0b39e75c51a3
          stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_sum
        name: OCCUPANCY_SUM
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 08ee0762-c108-4cca-9f00-34cd4b1183c9
          stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_avg
        name: OCCUPANCY_AVG
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2ee8172-35cd-46e4-947e-4c9bfd6d1016
          stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_min
        name: OCCUPANCY_MIN
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f34fdcc-2226-4cfa-808c-4ba6274b81af
          stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: occupancy_min_time_slots
        name: OCCUPANCY_MIN_TIME_SLOTS
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eea43024-5f60-44a1-b157-e1f227e74e05
          stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: occupancy_max
        name: OCCUPANCY_MAX
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f1f1b9ae-889d-495c-8281-5773dcddd900
          stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: occupancy_max_time_slots
        name: OCCUPANCY_MAX_TIME_SLOTS
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5d10759-7f4c-41cc-bf67-b8734078f584
          stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: admission_transfer_in
        name: ADMISSION_TRANSFER_IN
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e94a1293-43ca-4427-8a54-4d99bc7f6c26
          stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: discharge_transfer_out
        name: DISCHARGE_TRANSFER_OUT
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96e4ee9b-c956-4114-8975-3903ddfa9d4a
          stepCounter: cfbc3c73-2603-4099-a5d3-30be5b48d5f9
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DIM_WARD
        join:
          joinCondition: |-
            FROM dim.dim_ward,
                   dim.dim_date
             WHERE 1=1
               AND dim.dim_date.calendar_date BETWEEN ward_validity_start_date AND ward_validity_end_date
               AND dim.dim_date.calendar_date BETWEEN CONVERT(datetime,CONVERT(varchar,DATEPART(YYYY,GETDATE()-11*365.25))+'-01-01') AND CONVERT(datetime,CONVERT(date,GETDATE()+1))-0.00000005
               AND dim.dim_ward.dss_current_flag = 'Y'
        name: S_IN_PATIENT_WARD_OCCUPANCY
        noLinkRefs: []
  name: S_IN_PATIENT_WARD_OCCUPANCY
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
