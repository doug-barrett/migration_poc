fileVersion: 1
id: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
name: S_SHARED_SCHEDULE_20
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Schedule Type (Code)   'CNTCT' = Contact  'NPBAC' = Contact (Non-Patient Based Activity)  'OTPAT' = Outpatient  'THEAT' = Surgical Theatre"
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9244de04-9088-4f3e-acde-b9c5e94de33d
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SCHEDULE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b5ab558-a34e-4fd8-9b8e-311c0d96346a
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 61cead64-0945-4f96-80ae-89e930104da6
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SCHEDULE_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8824d637-5987-4055-bb23-efe67780c146
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d70dbbc8-a8ab-498e-ab3a-1eefd3f5c604
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: SCHEDULE_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fbb01e3b-4612-47c8-9a4a-5d6abddc60ef
                stepCounter: 06fa4241-360c-43d0-8e4a-8b860f92fc09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb7dacc5-8a84-43e1-9746-e4fd7b887f41
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SCHEDULE_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b5ab558-a34e-4fd8-9b8e-311c0d96346a
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: "'T'+CONVERT(varchar,ds_pims_schedules.schdl_refno)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9131647-a954-479d-89a7-6a2bfd4e17cb
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PARENT_SCHEDULE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c5f73ea-acfb-4af5-820e-0e674c22c0ce
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e411ca63-1d79-46de-88f1-fd14c6ab5fa3
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b97bdc6-cf45-46a3-b6b6-36dca9fe2232
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: IFNULL(ds_pims_schedules.patnt_refno,ds_pims_schedules_p.patnt_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d9b26e5-0112-4476-88a2-7afb05cca063
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60bbe3fa-43fe-4657-ac28-76e533f4a346
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: IFNULL(ds_pims_schedules.spect_refno,ds_pims_schedules_p.spect_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 972502b5-10a3-4050-8210-8ccf65061f60
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Health Specialty Code
        name: HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eb9f10c2-27db-445e-baee-c136d6d85afd
                stepCounter: 810f0140-d555-4744-97b7-398fe4ee4d78
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82f3e24a-e911-4518-952c-ff33a3daa9ce
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0316b81f-4748-44f1-80f4-a91999ba799c
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: IFNULL(ds_pims_schedules.proca_refno,ds_pims_schedules_p.proca_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2697372e-a850-45b0-b7b7-9aa5de6f3ab0
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b113274-654e-463e-960f-6d804d4bea85
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: IFNULL(ds_pims_schedules.spont_refno,ds_pims_schedules_p.spont_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 654ff486-94ee-420e-9a18-97c83448a55b
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WARD_TRANSFER_TO_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab427a4c-65f5-4b0a-a128-a55ca053ea68
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a74eaab-3e51-4f10-ac3f-e0485c657121
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: baa08465-b3f2-4440-b391-88b5934cedf0
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f372e7c3-f635-4bae-9d60-4fd8b5684797
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3d5fad60-aeb3-445c-ac8a-50a6290df729
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9858dba1-85df-4a36-a2ba-ae67fa0ebbd1
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ED_ATTENDANCE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7be05faf-ca2a-4713-bbab-0b8120601801
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 423ba998-3349-4932-a624-47e5414e8483
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: IP_WARD_STAY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72335e71-39a5-4d6c-ab26-c3908b823fca
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 012f2c3f-807c-4b2e-9fb2-b47bb2a1dbe9
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REQUEST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc484e8b-5901-4477-9488-a4471434433e
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3c73a60-9c6a-4b92-91cd-d21bcee5cfc2
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec8fa2c5-ca35-4bea-9290-bc50185e05e7
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: COALESCE(ds_pims_schedules.start_dttm,ds_pims_schedules_p.start_dttm,CONVERT(datetime,'19840701'))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49c36972-96c6-4ac4-a5be-38872904bdb7
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47aba488-a08d-44c7-a39c-dff4d9faf905
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: COALESCE(ds_pims_schedules.end_dttm,ds_pims_schedules_p.end_dttm,CONVERT(datetime,'19840701'))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be6d94ba-4468-4034-a259-550aca344913
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CALLED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91773d76-de1a-4fa1-abbb-721a71e51e5f
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af96112b-8f8c-4172-a275-89b3f06ea6d7
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ARRIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 42dc6e15-0bae-4d3a-bc34-2382e756620e
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 022e3e01-012d-4829-8e8b-980edad5cc4c
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SEEN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05061787-8189-4211-8374-c5bda53d20cc
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5eb7945e-0d8d-4086-908f-4af52f07eb72
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DEPARTED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56262cc4-3c5d-4bb2-aff2-25f462272168
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e022eb57-f092-4dcc-adfe-053f43ad5dad
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CANCELLATION_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa7cb54b-d3ea-4367-8d24-8f4cb8e99a97
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 978f9899-83e0-4f01-b8da-d06af307c66f
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: CANCELLATION_REASON_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d07d57b-de1e-494e-9dda-66e5caef4b60
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CANCELLATION_BY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bb1921f3-2f31-47db-9efd-d5afb08e390c
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d21ad2b2-28dc-45e1-9176-bbace720bb6a
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CANCELLATION_REASON_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb2710e7-b881-4bb5-ae2b-0889a66f4b3a
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fdd80486-f4e4-4c21-b083-f4e6dbdf0463
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: INTO_THEATRE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c01145d-05ea-469e-a23e-c6e535beaa5f
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 441ac2e4-2528-4c19-bd06-54c714d5845a
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: INTO_POSTOP_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6729847a-5cf2-44b7-bdec-f6e832938444
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6dad4f95-1cbb-4be1-acb6-dda6b370f38e
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ANAESTHETIC_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3893369d-9605-4e98-b786-e0115a7c7f67
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39d28a92-a813-4e80-b8b9-cace9fbdcab4
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SCHEDULE_MOVEMENT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: afe920aa-72e2-4941-a599-c6672965acf6
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1510c8d3-dd08-4488-961e-8a2d4273fbb1
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: DECIMAL(4)
        defaultValue: ""
        description: ""
        name: MOVE_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5408f32c-36bf-41c5-9484-5e9fab4255ad
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c24b52a-72f2-46f8-b98c-c4a989f47f8f
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SCHEDULE_MOVEMENT_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a5adc512-d976-46a8-8907-62a6b8c198df
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb58cd18-4b3c-47a4-bd22-6cd76ed78510
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SCHEDULE_MOVEMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5408f32c-36bf-41c5-9484-5e9fab4255ad
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e5ef349-283d-40d6-9504-725556dcb8fb
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: schedule_theatre_status_code, "A=Actual", "P=Planned", "C=Cancelled"
        name: SCHEDULE_THEATRE_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb2710e7-b881-4bb5-ae2b-0889a66f4b3a
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: |-
              CASE WHEN ds_pims_schedules.cancr_dttm IS NOT NULL THEN 'C'
                          ELSE CASE WHEN ds_pims_schedules.start_dttm IS NOT NULL AND ds_pims_schedules.start_dttm > getdate() THEN 'P' ELSE 'A' END
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0bb8741a-7b81-4500-bc7a-61abd43f672b
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: schedule_outpatient_status_code, "A=Actual", "P=Planned", "C=Cancelled"
        name: SCHEDULE_OUTPATIENT_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb2710e7-b881-4bb5-ae2b-0889a66f4b3a
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: |-
              CASE WHEN ds_pims_schedules.cancr_dttm IS NOT NULL THEN 'C'
                          WHEN ds_pims_schedules.attnd_refno = 11540    THEN 'P'
                          ELSE 'A'
                           END -- Attendance "Not Specified"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95b4d1f9-070b-4392-b641-58237bf3efba
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: schedule_contact_status_code, "A=Actual", "P=Planned", "C=Cancelled"
        name: SCHEDULE_CONTACT_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb2710e7-b881-4bb5-ae2b-0889a66f4b3a
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: |-
              CASE WHEN ds_pims_schedules.cancr_dttm IS NOT NULL   THEN 'C'
                          WHEN ds_pims_schedules.arrived_dttm IS NOT NULL THEN 'A'
                          ELSE 'P'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae3f29c3-3bdd-4a76-8784-96da337db4b3
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SERVICE_POINT_SESSION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 849899d1-23c5-4751-9dee-2a919651f1c0
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 725c2371-5dfd-46dd-a63b-986c0b0ed603
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: VISIT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b31ae495-5e88-4319-b3c9-3653ea2f9a42
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b496f9f9-06ff-42c0-99d7-76dc4f56e9cf
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8e10c2e-ccfe-4c51-94e8-abc4fbb8b679
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9362a498-c659-47c4-b1cc-cac38927f57b
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: URGENCY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a8d6c8de-7add-4987-bb24-dd6698f67cd2
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f3a3296-3a07-4150-a0e1-2c63ca5b5742
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRIORITY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 179fdf92-2dcd-4095-b2ff-be7c86105e92
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e56a59fc-b5fa-4bf8-b449-740ef0d8761f
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: TRANSPORT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0fb8b748-1f90-4879-9661-408713a70c48
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2619ad5-b5d8-4ee0-990e-78585d76172e
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ATTENDANCE_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb36ef5c-1146-41cc-9fb4-99ce9ec5c8f4
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: afd7055d-ae7a-49fb-8508-4e6965de7c6b
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: ATTENDANCE_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c9c3b19-b97a-4675-bf21-c81a0c4f0b07
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DID_NOT_ATTEND_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02282144-ed5a-4b5b-83a8-cd1531fb8c5f
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3232523c-ddcc-43c6-9179-2272ee86a523
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SCHEDULE_OUTCOME_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e7f381e-95f6-4162-ba11-4ac5b6792701
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2aeb6fa5-1756-4344-9c6e-6d8e1fab2db7
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OLD_SCHEDULE_OUTCOME_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9ba7457d-72b1-4197-96e1-50c9e7bfb119
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6709edbb-2779-4046-8786-f647be170da8
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMIN_CATEGORY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e490f0c0-51ec-4d9d-af58-01a27d6592d5
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0a926e7-1e2a-484a-8050-d3bb8b3ff9cf
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LOCATION_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f51ea3f1-56a3-4096-8fc8-77254252a7c6
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24d2d7b1-bc6e-45fc-a8c9-737f23e6335b
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CONTACT_PURPOSE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c9731af4-7c21-49b1-8751-ea46d16e224c
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6dd4ce8e-dd8c-48c2-8b52-cb49217aaaf8
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CONTACT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 758cd941-37c1-4a16-a6e9-813afd680bf7
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06713769-c5ef-42f9-a525-d3f70acc0a2d
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: RESOURCE_UNIT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 42e1d653-e8dc-4312-9b0d-593b1312fd97
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7cf951dc-3c69-40ff-8a10-b893fad8a159
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAFF_ACTIVITY_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eae2a1cb-4910-4184-b584-1541090f5a5d
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c7c9c4b-6d68-4962-9d33-c7da66bb1a03
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SCHEDULE_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f83c923-15c2-4224-b229-e8a58310f5bf
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1e1b980-aa9d-4d03-9644-c9c8a3dca28b
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: SCHEDULE_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53602033-0696-4fd7-b3c8-3ef67fae9a86
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREVIOUS_SCHEDULE_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a87fc2c-684d-47ff-a301-1e941693ffe5
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ddf7931d-beae-4103-b747-049aac71a0ba
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: MOVE_REQUESTED_BY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2023145-1654-4335-ad0d-d59dfc921854
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8def59dd-f3ab-45a0-a35e-433d7620772c
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CODING_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3b36a00-c1c4-4013-b826-aee25f9e8008
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06a01e30-1c9e-4d12-952e-f7502b5b60c0
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_CONFIRMATION_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 735d23f9-51eb-4695-a648-33e61e958eee
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c65aa90f-4580-475e-819e-4f0c61ac1853
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ANAESTHETIC_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 28c67e03-c824-4763-9930-912a3cb988ca
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3f16be5-3fb4-4a32-9742-c548c7ccfc3b
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LATE_START_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5978ebcb-a002-4019-809e-f87146d1db75
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d71915a5-4c6d-4dda-a4db-0805e2bd496c
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 579a78b0-9f4b-4250-8c6b-24768c86b245
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c19eccf-4a85-4286-9d32-895e5af6f6e5
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ANAESTHETIC_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 658367a1-12a6-4e9f-a31d-34fbe7e3d413
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ca98692-cf94-46a9-bbe5-ddd2c870101d
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIETARY_REQUIREMENTS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb40ed2a-15a1-486b-9c10-e1e99d35431c
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3f52120-9622-4cd5-bb57-96f2ae29a047
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: BOOKING_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9342c83d-d32d-493b-83ad-0bde3045d3b9
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d906c9a6-e6cf-4c37-a197-7c431431eef7
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FUNDING_ARRANGEMENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5b535f9b-0436-4e00-8fef-4bfc27aa34b3
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b450145-9c00-45a8-a480-4af76f6e5c3a
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CONTACT_RESCHEDULE_BY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 878cbd8b-322d-4d1f-916c-4ec3dbc0ffa3
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a45d47c-d840-46e6-835a-369b4d1bb8a5
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CONTACT_RESCHEDULE_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddf1f2b9-6228-432f-b5aa-3d8ab1b0a787
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66f7cbec-8060-45a0-882b-3da18c1230e8
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: UNPLANNED_RETURN_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9288a8ba-19c0-405b-9241-dd7dc90e3276
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c0be2ba-75f1-4b78-8beb-50692ef6bda4
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: APPROXIMATE_SCHEDULE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 88bd02db-83d7-44c6-b737-f9a58f4368aa
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b7b506a-597e-4ab2-a416-3bc13ae92266
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: OVERBOOKED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c95b2f1-72cd-48ec-8e3d-69175a117c4e
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f91f284-9daf-4d40-8a6f-7c2923ecedfb
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FOLLOWUP_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd93f5f4-a9d9-41bd-b636-7caa753b0c62
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 740597d2-aac3-4e2a-b28e-8d30e8255806
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b70dea0e-01bd-4366-9db3-73d40d276084
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be8092cb-1535-4693-bb7f-bafa4e4b67d4
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: REASN_COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cda66633-23fe-4208-82fb-fcb1d9b4872e
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42014edf-302b-4f27-81cf-ffbdbb25b074
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SCHEDULE_DURATION_ARRIVED_TO_DEPARTED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4505ba62-c5e4-410e-98a4-e8c908b04229
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: DATEDIFF(mi,ds_pims_schedules.arrived_dttm,ds_pims_schedules.departed_dttm)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69fa2623-7d0d-4f09-9152-c65acbc5ad1e
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SCHEDULE_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4505ba62-c5e4-410e-98a4-e8c908b04229
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: IFNULL(CONVERT(integer,ds_pims_schedules.duration),DATEDIFF(mi,ds_pims_schedules.start_dttm,ds_pims_schedules.end_dttm))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03752996-2e86-4d6a-b661-9a2ff2feb81c
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OPERATION_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b62d30a-d15d-41bf-8fae-ac083bb84437
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5e536d6-2511-4aa4-bcf4-6ed737b9d351
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ANAESTHETIC_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f00fe29b-877b-4f34-a307-33f9f35b3833
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2f7fc61-ef3f-4c86-a9f1-967454b44ce3
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_SCHEDULE_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b97bdc6-cf45-46a3-b6b6-36dca9fe2232
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: |-
              CASE WHEN ds_pims_schedules.patnt_refno IS NOT NULL THEN (ROW_NUMBER() OVER (PARTITION BY ds_pims_schedules.patnt_refno, ds_pims_schedules.sctyp_refno ORDER BY IFNULL(ds_pims_schedules.start_dttm,getdate())))
                          ELSE 1
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4cc4a05a-4c74-47a2-980c-f133f49e3213
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_SCHEDULE_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b97bdc6-cf45-46a3-b6b6-36dca9fe2232
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: |-
              CASE WHEN ds_pims_schedules.patnt_refno IS NOT NULL THEN (COUNT(1) OVER (PARTITION BY ds_pims_schedules.patnt_refno,ds_pims_schedules.sctyp_refno))
                          ELSE 1
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c67e135-2a8b-42e6-8f10-d4363896dbb9
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Sequence for appointment within waitlist ordered from oldest to most recent
        name: WAITLIST_SCHEDULE_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b97bdc6-cf45-46a3-b6b6-36dca9fe2232
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ROW_NUMBER() OVER (PARTITION BY IFNULL(ds_pims_schedules.wlist_refno,ds_pims_schedules.refrl_refno) ORDER BY IFNULL(ds_pims_schedules.start_dttm,getdate())DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8491d23-ca48-438d-9ee5-3fa8892e69b8
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Sequence for appointment within waitlist ordered from most recent to oldest
        name: WAITLIST_SCHEDULE_REV_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b97bdc6-cf45-46a3-b6b6-36dca9fe2232
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ROW_NUMBER() OVER (PARTITION BY IFNULL(ds_pims_schedules.wlist_refno,ds_pims_schedules.refrl_refno) ORDER BY IFNULL(ds_pims_schedules.start_dttm,getdate())DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f0cf8cf-f1f8-4b04-8a48-0146be798e2a
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Count of appointments on this waitlist
        name: WAITLIST_APPOINTMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b97bdc6-cf45-46a3-b6b6-36dca9fe2232
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: count(*) OVER (PARTITION BY IFNULL(ds_pims_schedules.wlist_refno,ds_pims_schedules.refrl_refno) ORDER BY IFNULL(ds_pims_schedules.start_dttm,getdate())DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 683d70b5-928a-4a0e-94d0-95e2edba7144
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_SCHEDULE_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b97bdc6-cf45-46a3-b6b6-36dca9fe2232
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: |-
              CASE WHEN ds_pims_schedules.refrl_refno IS NOT NULL THEN (ROW_NUMBER() OVER (PARTITION BY ds_pims_schedules.refrl_refno ORDER BY IFNULL(ds_pims_schedules.start_dttm,getdate())DESC))
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a525d733-3dea-4e6a-925d-0297ff3fa78b
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_SCHEDULE_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b97bdc6-cf45-46a3-b6b6-36dca9fe2232
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: |-
              CASE WHEN ds_pims_schedules.refrl_refno IS NOT NULL THEN (COUNT(1) OVER (PARTITION BY ds_pims_schedules.refrl_refno))
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b3980778-93cb-478f-a4c5-8dd575a4df62
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: PRVSP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 55657448-be2f-4a2b-8320-a7b85d67d592
                stepCounter: 741f0f92-29c2-403f-b62f-c119050c2375
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c2f6f26-dcd0-472d-89e9-22987c598687
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea80fece-3c3c-4ae5-85de-0a3b4428f05d
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6d23e8f-3133-4cf8-95aa-15c9200a3af4
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2fac099-ecf1-4e68-938f-dc8ae0acfb1e
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 12405980-1487-4a77-8e2a-1e6b2ea9da9d
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIFY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 566905f2-228b-4771-b1c9-c34ac9cb9083
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02ec5b4f-5453-44f2-a676-0ccf2dc27add
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MODIFY_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d916717a-ff0c-4752-bc4f-86a55c06115e
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75f8351b-1b26-45b3-bd94-8eb65b9ad4c4
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DSS_DATA_QUALITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN ((ds_pims_schedules.start_dttm IS NULL AND ds_pims_schedules.end_dttm IS NOT NULL) OR ds_pims_schedules.start_dttm > ds_pims_schedules.end_dttm OR ds_pims_schedules.start_dttm < '1984-07-01') OR ((ds_pims_schedules.arrived_dttm IS NULL AND ds_pims_schedules.departed_dttm IS NOT NULL) OR ds_pims_schedules.arrived_dttm > ds_pims_schedules.departed_dttm) OR (ds_pims_schedules.reqst_dttm > ds_pims_schedules.start_dttm) THEN 'DT'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e662174-9d8c-4bc5-85a5-8e43caa74300
          stepCounter: 98f9006e-f7be-4d12-b0b6-3faeb88c3c0f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DS_PIMS_SERVICE_POINTS: 00ad68b8-b3a1-4406-bae4-ef41c7c67d56
          S_HEALTH_ORG_2: 4dbeb7b4-8557-4965-a256-fab03c67ecf4
          S_PIMS_PROVIDER_SPELLS: 741f0f92-29c2-403f-b62f-c119050c2375
          S_HEALTH_SPECIALTY_V: 810f0140-d555-4744-97b7-398fe4ee4d78
          DS_PIMS_REFERENCE_VALUES: 06fa4241-360c-43d0-8e4a-8b860f92fc09
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_PIMS_SCHEDULES
          - locationName: TGT
            nodeName: DS_PIMS_SERVICE_POINTS
          - locationName: TGT
            nodeName: S_HEALTH_ORG_2
          - locationName: TGT
            nodeName: S_PIMS_PROVIDER_SPELLS
          - locationName: TGT
            nodeName: S_HEALTH_SPECIALTY_V
          - locationName: TGT
            nodeName: DS_PIMS_REFERENCE_VALUES
        join:
          joinCondition: |-
            FROM s_shared_schedule_10
              JOIN ds_pims_schedules
                ON s_shared_schedule_10.patnt_refno= ds_pims_schedules.patnt_refno -- LEFT OUTER JOIN ds_pims_schedules ds_pims_schedules_parent     -- ON ds_pims_schedules.parnt_refno IS NOT NULL     -- AND ds_pims_schedules.parnt_refno = ds_pims_schedules_parent.schdl_refno       LEFT OUTER JOIN ds_pims_schedules ds_pims_schedules_p    ON ds_pims_schedules.parnt_refno IS NOT NULL AND ds_pims_schedules_p.schdl_refno = ds_pims_schedules.parnt_refno          LEFT OUTER JOIN dim.dim_schedule_status    ON ds_pims_schedules.scsda_refno = dim_schedule_status.schedule_status_reference_no    AND IFNULL(ds_pims_schedules.start_dttm,ds_pims_schedules.create_dttm) BETWEEN dim_schedule_status.dss_start_date AND dim_schedule_status.dss_end_date       LEFT OUTER JOIN dim.dim_cancellation_reason    ON ds_pims_schedules.cancr_refno = dim_cancellation_reason.cancellation_reason_reference_no    AND IFNULL(ds_pims_schedules.start_dttm,ds_pims_schedules.create_dttm) BETWEEN dim_cancellation_reason.dss_start_date AND dim_cancellation_reason.dss_end_date      LEFT OUTER JOIN dim.dim_attendance_status    ON ds_pims_schedules.attnd_refno = dim_attendance_status.attendance_status_reference_no     AND IFNULL(ds_pims_schedules.start_dttm,ds_pims_schedules.create_dttm) BETWEEN dim_attendance_status.dss_start_date AND dim_attendance_status.dss_end_date    LEFT OUTER JOIN {{ ref('TGT','DS_PIMS_SERVICE_POINTS') }}  ON ds_pims_schedules.spont_refno = ds_pims_service_points.spont_refno  LEFT OUTER JOIN {{ ref('TGT','S_HEALTH_ORG_2') }}  ON ds_pims_service_points.heorg_refno = s_health_org_2.health_org_reference_no    LEFT OUTER JOIN {{ ref('TGT','S_PIMS_PROVIDER_SPELLS') }}  ON ds_pims_schedules.patnt_refno = s_pims_provider_spells.patnt_refno      and ( COALESCE (ds_pims_schedules.into_theatre_dttm,ds_pims_Schedules.arrived_dttm,ds_pims_schedules.start_dttm)   between s_pims_provider_spells.admit_dttm and IFNULL(s_pims_provider_spells.disch_dttm,getdate())  or coalesce(ds_pims_Schedules.departed_dttm,ds_pims_schedules.end_dttm)  between s_pims_provider_spells.admit_dttm and IFNULL(s_pims_provider_spells.disch_dttm,getdate()))  and s_pims_provider_spells.hospital_id = s_health_org_2.hospital_id  LEFT OUTER JOIN {{ ref('TGT','S_HEALTH_SPECIALTY_V') }}  ON ds_pims_schedules.spect_refno = s_health_specialty_v.specialty_reference_no  LEFT OUTER JOIN {{ ref('TGT','DS_PIMS_REFERENCE_VALUES') }}  ON ds_pims_schedules.sctyp_refno = ds_pims_reference_values.rfval_refno  LEFT OUTER JOIN {{ ref('TGT','DS_PIMS_REFERENCE_VALUES') }} cancr  on ds_pims_schedules.cancr_refno = cancr.rfval_refno  LEFT OUTER JOIN {{ ref('TGT','DS_PIMS_REFERENCE_VALUES') }} attnd  on ds_pims_schedules.attnd_refno = attnd.rfval_refno  LEFT OUTER JOIN {{ ref('TGT','DS_PIMS_REFERENCE_VALUES') }} scsda  on ds_pims_schedules.scsda_refno = scsda.rfval_refno
        name: S_SHARED_SCHEDULE_20
        noLinkRefs: []
  name: S_SHARED_SCHEDULE_20
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
