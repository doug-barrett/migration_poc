fileVersion: 1
id: e59424eb-ec07-4f57-8a99-480cda649bc4
name: S_NEXUS_VISIT_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0b0a53b-b789-44ac-9b05-99a3577486fd
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: SCHEDULE_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN IFNULL(s_nexus_eventcode_v.eventcode,'EXIT') NOT IN('CANC','ABDN') THEN CASE WHEN ds_nexus_OPS.opdate > getdate() THEN 'Planned' ELSE 'Actual' END
                          ELSE 'Cancelled'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5661bc0c-1254-495e-88e4-6c72cc8028fb
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: support_anaesthetist
        name: SUPPORT_ANAESTHETIST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4aa139a-fab5-4d23-9627-43f961f44298
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Booked_start
        name: BOOKED_START
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f5f264c-6b30-450d-b01a-2e2e653591c4
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Booked_end
        name: BOOKED_END
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 788a30f4-d597-49bc-a3f2-a9a24e524442
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: INTHEATRECOMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f5018a69-a563-436a-a4f8-a9c307281c4e
                stepCounter: 7d48bfa2-a4a4-4d8a-b57c-9e6c069c485a
            transform: substring(ds_nexus_OPS_INFO.info,1,255)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 62e4217d-0c51-4314-97f7-cbc01f78c17d
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: IP_EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c9ad899a-02db-451e-9da1-16acf3035ba2
                stepCounter: 4eab76ba-7ed8-4976-a2a8-b2f9d2ba3cd5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 23dd7678-a0f1-4c83-8a13-df8a714837c0
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: technician_anaesthetist
        name: TECHNICIAN_ANAESTHETIST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 778b3cd8-0ec5-4c1d-8000-3e68a6cf01d0
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: VARCHAR(12)
        defaultValue: ""
        description: ""
        name: THEATRE_VISIT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 57c9c4f7-1da2-454b-b0cc-32a0c72d9198
                stepCounter: 86ac4af0-de3e-4f22-9a31-c3e62b75355a
            transform: "'NX'+cast(ds_nexus_OPS.opnumber AS varchar)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de732850-e908-458c-845c-5887ae8fcd7e
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: OPNUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 57c9c4f7-1da2-454b-b0cc-32a0c72d9198
                stepCounter: 86ac4af0-de3e-4f22-9a31-c3e62b75355a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f384447b-4b5a-4bf0-92a7-19ee56c41260
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SESSION_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b80f7694-b170-4808-a9bf-e5d64d58ef9c
                stepCounter: 4b43ba77-04db-48ba-a6bc-cb68f677d59a
            transform: ds_nexus_FLEXSESS.sessdate + ds_nexus_FLEXSESS.starttime
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4a2ab85-0d71-4497-8b89-354e03dc2eb6
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: VARCHAR(11)
        defaultValue: ""
        description: ""
        name: THEATRE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27a3a09d-3cab-40e7-a01e-d0604de461a1
                stepCounter: 71cbc210-e0db-418a-a4bb-72d460841789
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32aab115-b138-423a-bb40-9c9bfaa3e6cd
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: OPSESSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e61cb971-74f6-4bee-b30f-41d8e5ef1372
                stepCounter: 86ac4af0-de3e-4f22-9a31-c3e62b75355a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22657467-08c0-4738-8fe7-052195b4756b
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: OPSEQUENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a5e8547-3b61-4689-92cf-ae2a665f65c3
                stepCounter: 86ac4af0-de3e-4f22-9a31-c3e62b75355a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66d9a2cc-a1a3-46e8-8b78-60474a91cf4f
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: ""
        name: THEATRE_SESSION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: feb17060-c278-41ee-ac59-6afd1a6790bd
                stepCounter: 4b43ba77-04db-48ba-a6bc-cb68f677d59a
            transform: |-
              CASE WHEN s_nexus_Aud_SessCanc_v.cancelledreason = 'REINSTATED' THEN cast(cast(ds_nexus_FLEXSESS.flexsess_session AS varchar(2)) +cast(ds_nexus_FLEXSESS.theatre AS varchar(2)) +CONVERT(varchar(8),ds_nexus_FLEXSESS.sessdate,112) AS bigint)
                          ELSE cast(cast(ds_nexus_FLEXSESS.flexsess_session AS varchar(2)) +cast(ds_nexus_FLEXSESS.theatre AS varchar(2)) +CONVERT(varchar(8),ds_nexus_FLEXSESS.sessdate,112) +IFNULL(CAST(ds_nexus_SESSSTAT.reason AS varchar(3)),'') +IFNULL(cast(s_nexus_Aud_SessCanc_v.primkey AS varchar(5)),'')AS bigint)
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b5250082-1dd1-4179-8cae-66d2d61d9b6a
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd9087b0-e1c1-484b-8332-d6058069daf2
                stepCounter: 86ac4af0-de3e-4f22-9a31-c3e62b75355a
            transform: Upper(ds_nexus_OPS.hospnumber)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17004d36-3849-442d-b48b-9a68fb91e4a3
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: NVARCHAR(20)
        defaultValue: ""
        description: ""
        name: REFERRAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9b0685cc-bb08-49d7-bd66-27c69980a938
                stepCounter: 800cb33e-d887-4431-a386-d679d158123a
            transform: |-
              CASE WHEN ds_nexus_FSA.referralid = 1 THEN NULL
                          ELSE ds_nexus_FSA.referralid
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86b4dad7-0c18-4dc3-84e6-a649d3c24550
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: REFERRAL_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE WHEN refspec.SpecialtyCode = 'S60' THEN 'PLASU'
                          ELSE refspec.SpecialtyCode
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70da2c74-40e3-4185-a872-150229ea1749
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE WHEN sessspec.SpecialtyCode = 'S60' THEN 'PLASU'
                          ELSE sessspec.SpecialtyCode
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f3b165d7-a933-4dd0-a532-6283f044c591
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: SESSION_SPEC_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE WHEN sessspec.SpecialtyCode = 'S60' THEN 'PLASU'
                          ELSE sessspec.SpecialtyCode
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c49dd07a-f56c-4b5e-a627-5e04b02c6137
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CANCELLED_BY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a82fc240-1b3c-456c-9b0b-daf036ebdca5
                stepCounter: 1a501765-762b-424e-9006-f68ba91aae41
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c56b6a54-b51f-4239-8eba-a72bd35029c4
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CANCELCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8badc748-4764-4bc9-9146-a685f1844912
                stepCounter: 1a501765-762b-424e-9006-f68ba91aae41
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0dbd16f4-048c-4c2a-9df6-6d3f9e639072
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CANCELDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6444b6d7-9b07-4ef4-beb9-6673d335946e
                stepCounter: 6d1dc38c-89a2-4e1d-b021-d45af9cc7b8a
            transform: |-
              CASE WHEN s_nexus_eventcode_v.eventcode NOT IN('CANC','ABDN') THEN NULL
                          ELSE s_nexus_eventcode_v.eventdate
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bce6be80-8892-44c8-834f-521a5d427bb7
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: SESSIONOWNER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b1d5272-802f-45c6-8f33-b004d5d8f79e
                stepCounter: 0e5d1910-611d-4f26-a64a-4189199510be
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f69e462f-1f2c-4f67-bbaa-3f4a2d9cc3ed
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PATIENTOWNER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d484672-e9be-4e29-bb28-707da1f3c06b
                stepCounter: 86ac4af0-de3e-4f22-9a31-c3e62b75355a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f668e181-c210-4b5b-9973-2e44951785d7
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: theatre_clinician_reference_no
        name: THEATRE_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 17ee3590-ed47-4b73-b22e-a6494f78e113
                stepCounter: d42ee6db-29e1-4d7b-88a3-e45c058528e1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b7a3db8-af20-4a0a-be33-23f86ef37695
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PRIMARYSURGEON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IFNULL(supri.Code,ds_nexus_WL_PATIENT.conscode)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a14a088-5819-4d34-85d1-d75e37d40264
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PRIMARYANAESTHETIST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3fd4b61-8bcf-407e-b2d6-d1755692baca
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: ASSISTANTSURGEON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d13c2b9-e8e6-4487-a2b8-7977fd7aa890
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: SECONDARYSURGEON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa8ea814-e168-4a8c-b42d-0ae03b08f693
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: CANCELLED_SESSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 42cc16da-dfff-4f96-8bff-6df2dc4babfd
                stepCounter: b1b53e8a-b17f-4432-8478-a448c5ebd324
            transform: |-
              CASE WHEN ds_nexus_SESSSTAT.cancdate IS NULL THEN 'A'
                          ELSE CASE WHEN s_nexus_Aud_SessCanc_v.cancelledreason = 'REINSTATED' THEN 'A' ELSE 'C' END
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d9398b9-82e9-4e9d-9a51-386cf422748c
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: SESSION_CANCELLED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN s_nexus_Aud_SessCanc_v.cancelledreason = 'REINSTATED' THEN NULL
                          ELSE ds_nexus_SESSSTAT.cancdate
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1382a0cb-2fb2-4d5f-aac5-2791700e8081
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SESSION_CANCELLED_REASON
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN s_nexus_Aud_SessCanc_v.cancelledreason = 'REINSTATED' THEN ''
                          ELSE cast(ds_nexus_SESSSTAT.reason AS varchar(50))
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e043a0d4-45ba-4dbf-ba2e-a860fe4fa88a
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: VARCHAR(60)
        defaultValue: ""
        description: ""
        name: SCHEDULE_CANCELLED_REASON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cddeb946-0932-494f-83a8-66fb2c1ba0dc
                stepCounter: 1a501765-762b-424e-9006-f68ba91aae41
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba24c194-824e-4a76-bbe1-b3d031eed119
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: PRIMARY_PROCEDURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e776540-4764-4937-a8ac-6a8c287a929b
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: SECONDARY_PROCEDURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f26e3d51-ee34-4188-87e5-5037dd69b611
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: THIRD_PROCEDURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be15af8d-b042-48d3-a837-7e2e2d9cf7a1
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: FOURTH_PROCEDURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f2c41cf-e820-448c-b8f8-e5b59c5eef37
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: FIFTH_PROCEDURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 30b31cb9-599d-4183-b539-0ff56032add5
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: SIXTH_PROCEDURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86499e93-5898-4d7b-9cc8-5e03ec197a3d
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: SEVENTH_PROCEDURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 966778d4-d130-4204-a1cd-4101098694de
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: EIGHTH_PROCEDURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 478fafb7-cf9c-4c6a-9db8-ec525f01f4d2
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: NINTH_PROCEDURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fcd45c8c-3e99-45b8-90df-e27d744fc425
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: WARD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5da20b56-07c1-4dd2-8559-92ba9abe9d81
                stepCounter: 86ac4af0-de3e-4f22-9a31-c3e62b75355a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47d84dbe-497d-40bb-8278-8e597814d629
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: OPDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 931ef0a5-6a28-4d07-9324-d2ecbb30a708
                stepCounter: 86ac4af0-de3e-4f22-9a31-c3e62b75355a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: abb85c66-5ea2-4c2b-bbc1-ae080bd4a7f1
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SENT_FOR_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f932e21-c2aa-485d-b01a-b9261a1a12b8
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ARRIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1421f78b-72d0-4a02-a19a-8ba360f6767c
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SESSION_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b80f7694-b170-4808-a9bf-e5d64d58ef9c
                stepCounter: 4b43ba77-04db-48ba-a6bc-cb68f677d59a
            transform: ds_nexus_FLEXSESS.sessdate + ds_nexus_FLEXSESS.endtime
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f549256-975b-46da-bc48-f13d19921664
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: INTO_THEATRE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de1ca5c5-50dd-4a8b-ba52-f60db028247a
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ANAESTHETIC_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8453d136-bc51-467d-a579-96d26b4dcdf6
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SURGERY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d3063e5-e0c8-4f5a-aa71-c65cc503be50
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SURGERY_COMPLETION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1414077-38a4-48f3-b8d4-440ac31c8144
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: OUTOF_THEATRE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8aa82cb8-6d22-40e2-9a9c-471bf873194c
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: INTO_POSTOP_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e67509e7-fc0f-48c3-9aab-455873c39583
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SECOND_RECOVERY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25a6b28c-a492-47c7-9686-90abe37487c5
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PATIENT_READY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 08650836-2d86-49aa-a5c5-a21b9fae2deb
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: OUTOF_RECOVERY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 540e1cda-ff00-4373-bd4e-5d1a0c961da6
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WARD_PHONED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 948fd801-0956-478a-869b-1d756a0c18c3
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: URGENCY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2fd64da6-d5ec-44b9-b3bf-bc10dc72656e
                stepCounter: 6c0d79a0-eca9-4530-acdc-ba7fdf777ea0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04b04bfc-dd77-4ad3-8774-4da85df4e532
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: THEATRE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c8fb342a-29f8-4de8-81a0-b3c8d405c979
                stepCounter: 86ac4af0-de3e-4f22-9a31-c3e62b75355a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14b0132b-9fdd-468c-8191-9b1e97d702f2
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: OPTYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59b30c34-d74f-4eed-8684-669c0b599e8f
                stepCounter: 86ac4af0-de3e-4f22-9a31-c3e62b75355a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d25f4867-c33f-433e-a62e-cd4148699a20
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: AN_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27ee6bea-07e0-44d7-beee-720331930cbe
                stepCounter: 7d48bfa2-a4a4-4d8a-b57c-9e6c069c485a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea6b23b1-3963-4b1b-b380-8308c88196df
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: ASA_RATING
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a75684fa-de85-4c7e-a454-b47faed7843c
                stepCounter: 54b00669-aef0-4ec6-aab2-52b5399ed850
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49295549-0d71-4482-90c0-60780c797586
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: OP_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78621a51-c468-47de-9269-aa26626e7b9f
                stepCounter: 1fd9e1cd-d14b-459d-ae91-10d2e41413cb
            transform: IFNULL(ds_nexus_OperationType.OperationCode,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18d97857-2dc9-47be-9b17-3a87e0031683
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: OUTCOME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c04917fd-2067-49ef-a540-969652070a23
                stepCounter: 879abeb3-c561-4a6a-be93-894acfd36729
            transform: |-
              CASE s_nexus_outcome_v.eventcode
                          WHEN 'ABDN'                 THEN 'OA'
                          WHEN 'CANC'                 THEN 'CANCD'
                          WHEN 'ENSU'                 THEN 'OC'
                          ELSE 'NSP'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9cef2a69-87e9-4905-8bb0-451e009be070
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: OUTCOME_REASON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c04917fd-2067-49ef-a540-969652070a23
                stepCounter: 879abeb3-c561-4a6a-be93-894acfd36729
            transform: |-
              CASE s_nexus_outcome_v.eventcode
                          WHEN 'ABDN'                 THEN CASE WHEN s_nexus_outcome_v.reason <> 0 THEN 'NX'+cast(s_nexus_outcome_v.reason AS varchar) ELSE '' END
                          WHEN 'CANC'                 THEN 'CANCD'
                          WHEN 'ENSU'                 THEN 'NA'
                          ELSE ''
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78702f08-2ff7-4e1f-ae80-6e29bab8c917
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dab0ac6a-7cf8-47c6-a566-95405793439f
                stepCounter: da9b1eeb-57ac-43cf-abdd-8091b869da6f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6452bdc9-a9d0-4ba5-b6d1-0b4342ce9b75
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: USER_CREATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 634af1ef-eaeb-472e-adbf-affa09104571
                stepCounter: da9b1eeb-57ac-43cf-abdd-8091b869da6f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f76970c-00cc-40b4-b47f-b71fcdaab69f
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIF_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a9299356-d36b-413d-b45c-40d1bb381fc2
                stepCounter: 50d26640-0cb5-4660-9d6b-c83e70fae3d9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: feba32d0-38b6-4b96-bdb2-586aa498f325
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: USER_MODIF
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb3df518-af9b-42ba-a660-edbbe6ca092d
                stepCounter: 50d26640-0cb5-4660-9d6b-c83e70fae3d9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4088eaef-012d-438f-9a03-76bd6ba67612
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: THEATRE_COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 35e50e4f-d762-4190-8324-af085be37064
                stepCounter: 6d1dc38c-89a2-4e1d-b021-d45af9cc7b8a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8145d92f-bb13-4e2c-a944-89ecb0979ec5
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1958d786-6166-4568-b3db-d1ad03271667
                stepCounter: 86ac4af0-de3e-4f22-9a31-c3e62b75355a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a64ba902-0bb2-46c9-aac1-8699bfcfd096
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: ""
        name: TOPA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f49d93d6-d3bc-48be-aef7-5335916fe717
                stepCounter: 1dce5bbc-4b39-48c1-8f72-0775c2c6b209
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e647358b-bbf3-48f1-a9f2-6a538696ad32
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: CHAR
        defaultValue: ""
        description: ""
        name: SESSION_STATUS
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE ds_nexus_SESSSTAT.status
                          WHEN 'C'                 THEN 'C'
                          WHEN 'S'                 THEN 'C'
                          WHEN 'O'                 THEN CASE WHEN s_nexus_Aud_SessCanc_v.cancelledreason <> 'REINSTATED' THEN 'C' ELSE CASE WHEN ds_nexus_FLEXSESS.sessdate > convert(datetime,@v_ca_date,120) THEN 'P' ELSE 'A' END END
                          ELSE 'A'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a53cc1d2-ed1f-4518-ae05-8b31e7ae92d8
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: NUMERIC(10)
        defaultValue: ""
        description: ""
        name: WLIST_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f39a662c-8fac-468c-8231-30a8f88f1dc4
                stepCounter: ab9815f4-cd54-416c-9b1b-efae418ca980
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f949c7f3-5d14-4713-a770-2201a58b4426
          stepCounter: e59424eb-ec07-4f57-8a99-480cda649bc4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies: []
        join:
          joinCondition: |-
            EXTENDED
              FROM ds_nexus_OPS
              LEFT JOIN ds_nexus_WL_PATIENT
                ON ds_nexus_OPS.opnumber = ds_nexus_WL_PATIENT.opnumber
              LEFT JOIN ds_nexus_FSA
                ON ds_nexus_FSA.wlnumber = ds_nexus_WL_PATIENT.wlnumber
              LEFT OUTER JOIN ds_nexus_FLEXSESS
                ON ds_nexus_OPS.theatre = ds_nexus_FLEXSESS.theatre
               AND ds_nexus_OPS.opsession = ds_nexus_FLEXSESS.flexsess_session
               AND ds_nexus_OPS.opdate = ds_nexus_FLEXSESS.sessdate
              LEFT JOIN ds_nexus_THEATRE
                ON ds_nexus_OPS.theatre = ds_nexus_THEATRE.theatre_code
              LEFT OUTER JOIN s_nexus_Aud_SessCanc_v
                ON ds_nexus_FLEXSESS.flexsess_session = s_nexus_Aud_SessCanc_v.cancelledsession
               AND ds_nexus_FLEXSESS.theatre = s_nexus_Aud_SessCanc_v.cancelledtheatre
               AND ds_nexus_FLEXSESS.sessdate = s_nexus_Aud_SessCanc_v.cancelleddate
              LEFT OUTER JOIN ds_nexus_SESSSTAT
                ON ds_nexus_FLEXSESS.theatre = ds_nexus_SESSSTAT.theatre
               AND ds_nexus_FLEXSESS.flexsess_session = ds_nexus_SESSSTAT.sessstat_session
               AND ds_nexus_FLEXSESS.sessdate = ds_nexus_SESSSTAT.opdate
              LEFT OUTER JOIN ds_nexus_dbo_SPECIALTY refspec
                ON ds_nexus_FSA.specialty = refspec.theatrespecialtycode
              LEFT OUTER JOIN ds_nexus_dbo_SPECIALTY SessSpec
                ON ds_nexus_FLEXSESS.specialty = SessSpec.theatrespecialtycode
              LEFT OUTER JOIN s_nexus_eventcode_v
                ON ds_nexus_OPS.opnumber = s_nexus_eventcode_v.opnumber
              LEFT OUTER JOIN ds_nexus_FLEXCONS
                ON ds_nexus_FLEXSESS.theatre = ds_nexus_FLEXCONS.theatre
               AND ds_nexus_FLEXSESS.flexsess_session = ds_nexus_FLEXCONS.flexcons_session
               AND ds_nexus_FLEXSESS.sessdate = ds_nexus_FLEXCONS.sessdate
              LEFT OUTER JOIN s_nexus_Augmented_Staff supri
                ON ds_nexus_OPS.opnumber = supri.opnumber
               AND supri.swe_role = 'SUPRI'
              LEFT OUTER JOIN s_nexus_Augmented_Staff anaes
                ON ds_nexus_OPS.opnumber = anaes.opnumber
               AND anaes.swe_role = 'ANATH'
              LEFT OUTER JOIN s_nexus_Augmented_Staff surass
                ON ds_nexus_OPS.opnumber = surass.opnumber
               AND surass.swe_role = 'SURASS'
              LEFT OUTER JOIN s_nexus_Augmented_Staff sursec
                ON ds_nexus_OPS.opnumber = sursec.opnumber
               AND sursec.swe_role = 'SURSEC'
              LEFT OUTER JOIN s_nexus_Augmented_Staff anats
                ON ds_nexus_OPS.opnumber = sursec.opnumber
               AND sursec.swe_role = 'ANATS'
              LEFT OUTER JOIN s_nexus_Augmented_Staff anate
                ON ds_nexus_OPS.opnumber = sursec.opnumber
               AND sursec.swe_role = 'ANATE'
              LEFT OUTER JOIN (
                    SELECT opnumber,
                           max(eventdate) sfor_dttm
                      FROM s_nexus_eventcode
                     WHERE eventcode IN('SENT','SFOR')
                     GROUP BY opnumber
                   ) sfor
                ON ds_nexus_OPS.opnumber = sfor.opnumber
              LEFT OUTER JOIN (
                    SELECT opnumber,
                           max(eventdate) arrv_dttm
                      FROM s_nexus_eventcode
                     WHERE eventcode = 'ARRV'
                     GROUP BY opnumber
                   ) arrv
                ON ds_nexus_OPS.opnumber = arrv.opnumber
              LEFT OUTER JOIN (
                    SELECT opnumber,
                           max(eventdate) inth_dttm
                      FROM s_nexus_eventcode
                     WHERE eventcode = 'INTH'
                     GROUP BY opnumber
                   ) inth
                ON ds_nexus_OPS.opnumber = inth.opnumber
              LEFT OUTER JOIN (
                    SELECT opnumber,
                           max(eventdate) stan_dttm
                      FROM s_nexus_eventcode
                     WHERE eventcode = 'STAN'
                     GROUP BY opnumber
                   ) stan
                ON ds_nexus_OPS.opnumber = stan.opnumber
              LEFT OUTER JOIN (
                    SELECT opnumber,
                           max(eventdate) stsu_dttm
                      FROM s_nexus_eventcode
                     WHERE eventcode = 'STSU'
                     GROUP BY opnumber
                   ) stsu
                ON ds_nexus_OPS.opnumber = stsu.opnumber
              LEFT OUTER JOIN (
                    SELECT opnumber,
                           max(eventdate) ensu_dttm
                      FROM s_nexus_eventcode
                     WHERE eventcode = 'ENSU'
                     GROUP BY opnumber
                   ) ensu
                ON ds_nexus_OPS.opnumber = ensu.opnumber
              LEFT OUTER JOIN (
                    SELECT opnumber,
                           max(eventdate) rec1_dttm
                      FROM s_nexus_eventcode
                     WHERE eventcode = 'REC1'
                     GROUP BY opnumber
                   ) rec1
                ON ds_nexus_OPS.opnumber = rec1.opnumber
              LEFT OUTER JOIN (
                    SELECT opnumber,
                           max(eventdate) rec2_dttm
                      FROM s_nexus_eventcode
                     WHERE eventcode = 'EXIT'
                     GROUP BY opnumber
                   ) rec2
                ON ds_nexus_OPS.opnumber = rec2.opnumber
              LEFT OUTER JOIN (
                    SELECT opnumber,
                           max(eventdate) clpa_dttm
                      FROM s_nexus_eventcode
                     WHERE eventcode = 'CLPA'
                     GROUP BY opnumber
                   ) clpa
                ON ds_nexus_OPS.opnumber = clpa.opnumber
              LEFT OUTER JOIN (
                    SELECT opnumber,
                           max(eventdate) cwrd_dttm
                      FROM s_nexus_eventcode
                     WHERE eventcode = 'CWRD'
                     GROUP BY opnumber
                   ) cwrd
                ON ds_nexus_OPS.opnumber = cwrd.opnumber
        name: S_NEXUS_VISIT_10
        noLinkRefs: []
  name: S_NEXUS_VISIT_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
