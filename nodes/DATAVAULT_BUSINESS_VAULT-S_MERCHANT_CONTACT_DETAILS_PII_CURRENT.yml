fileVersion: 1
id: 8a6b5ddc-1cff-4536-8d16-61ede78dfcc5
name: S_MERCHANT_CONTACT_DETAILS_PII_CURRENT
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: "This entity holds the contact details for a given institution. The entity is effective dated so the contact details can be different for different time periods."
  isMultisource: false
  locationName: DATAVAULT_BUSINESS_VAULT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e1c45ad-77d5-45c6-bc04-3b5372605728
          stepCounter: 8a6b5ddc-1cff-4536-8d16-61ede78dfcc5
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: ""
        name: HK_H_MERCHANT_CONTACT_DETAILS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd7284aa-ced3-4157-9fb3-7295acf276fe
                stepCounter: 5fe956d8-2852-4bdc-85a1-0af493c3c6d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e918145-fcd0-49ac-b860-fcf94ab37342
          stepCounter: 8a6b5ddc-1cff-4536-8d16-61ede78dfcc5
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: contact identificaton number
        isBusinessKey: true
        name: CONTACT_IDENTIFICATION_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02528ab9-2541-4a95-889c-32051065355d
                stepCounter: 5fe956d8-2852-4bdc-85a1-0af493c3c6d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d1861132-8696-4cf8-af48-6032291e6e4b
          stepCounter: 8a6b5ddc-1cff-4536-8d16-61ede78dfcc5
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: The sequence number is part of the physical key together with Institution ID, Institution Contact Number. The currently effective instance is identified by the sequence number zero.
        isBusinessKey: true
        name: SEQUENCE_NUMBER_BK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 12cb362e-3b76-400d-9ca4-befcea88dbf2
                stepCounter: 5fe956d8-2852-4bdc-85a1-0af493c3c6d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04ff07e6-bf5c-45c3-aea2-1c9c77923a60
          stepCounter: 8a6b5ddc-1cff-4536-8d16-61ede78dfcc5
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: Identifies the forenames of the Contact for the Institution.
        name: CONTACT_NAME_TEXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 70c7dbab-8f8d-49a5-be08-c5c8b9551ba9
                stepCounter: 5fe956d8-2852-4bdc-85a1-0af493c3c6d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 44279cfa-e851-4a8a-9854-42dff0a73ce9
          stepCounter: 8a6b5ddc-1cff-4536-8d16-61ede78dfcc5
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: Identifies the surname of the Contact for the Institution.
        name: CONTACT_SURNAME_TEXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8bb690e-f38c-45a7-8105-230829f0fc66
                stepCounter: 5fe956d8-2852-4bdc-85a1-0af493c3c6d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 19bbc46a-7f62-4045-aba8-f9328a97eab9
          stepCounter: 8a6b5ddc-1cff-4536-8d16-61ede78dfcc5
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: Identifies the postal address by which the institution contact can be contacted.
        name: ADDRESS_LINE_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9a78946-ace1-45c7-bd15-e58435ea1fb9
                stepCounter: 5fe956d8-2852-4bdc-85a1-0af493c3c6d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b3ca1261-4e0f-4314-9b06-4ec60cbd6da4
          stepCounter: 8a6b5ddc-1cff-4536-8d16-61ede78dfcc5
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: Identifies the postal address by which the institution contact can be contacted.
        name: ADDRESS_LINE_2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e51f5b8-57e8-4d93-a0b5-495c011d5a1d
                stepCounter: 5fe956d8-2852-4bdc-85a1-0af493c3c6d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d664219-fcc9-459e-8d85-676064e6d570
          stepCounter: 8a6b5ddc-1cff-4536-8d16-61ede78dfcc5
        config: {}
        dataType: VARCHAR(60)
        defaultValue: ""
        description: Identifies the postal address by which the institution contact can be contacted.
        name: ADDRESS_LINE_3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 95b2787c-e4d4-4d9c-909a-8f97c2e6dee1
                stepCounter: 5fe956d8-2852-4bdc-85a1-0af493c3c6d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a8a4f4f-51c3-499f-afc6-0b262bd430d3
          stepCounter: 8a6b5ddc-1cff-4536-8d16-61ede78dfcc5
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Identifies the postal code of the Institution.
        name: ADDRESS_POSTAL_TEXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5ab65f5-f551-4bbf-a9c7-0fe8733b7147
                stepCounter: 5fe956d8-2852-4bdc-85a1-0af493c3c6d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53360d08-1b92-432d-a154-073cf146dfc2
          stepCounter: 8a6b5ddc-1cff-4536-8d16-61ede78dfcc5
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: Identifies the city in which the Institution is in.
        name: ADDRESS_CITY_TEXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c2f3e53-c512-44fc-8d25-c0189bfb6c16
                stepCounter: 5fe956d8-2852-4bdc-85a1-0af493c3c6d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0ef384e-bf86-47aa-9c80-d4a0ffda5e7b
          stepCounter: 8a6b5ddc-1cff-4536-8d16-61ede78dfcc5
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: Identifies the state in which the Institution is in.
        name: ADDRESS_STATE_TEXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2e9ce993-f7fb-4911-ba35-63387df88ce0
                stepCounter: 5fe956d8-2852-4bdc-85a1-0af493c3c6d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4cc8ea25-845f-4e6c-88cc-5f62dd2e03de
          stepCounter: 8a6b5ddc-1cff-4536-8d16-61ede78dfcc5
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: Identifies the country in which the Institution is in.
        name: ADDRESS_COUNTRY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e79521ab-cb2f-4ae8-a188-8089c74a611e
                stepCounter: 5fe956d8-2852-4bdc-85a1-0af493c3c6d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 61a1df41-edc8-408b-b61e-a7fa58e860c5
          stepCounter: 8a6b5ddc-1cff-4536-8d16-61ede78dfcc5
        config: {}
        dataType: VARCHAR(60)
        defaultValue: ""
        description: Identifies the Email address by which the Institution can be contacted.
        name: CONTACT_EMAIL_TEXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eb70ebdf-daf6-4e03-812f-bcfb1e2cf421
                stepCounter: 5fe956d8-2852-4bdc-85a1-0af493c3c6d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a2409b9-06ff-44a2-bedd-0908104845ba
          stepCounter: 8a6b5ddc-1cff-4536-8d16-61ede78dfcc5
        config: {}
        dataType: VARCHAR(60)
        defaultValue: ""
        description: Identifies the Internet address by which the Institution can be contacted.
        name: CONTACT_INTERNET_ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b383714a-e77a-4ee4-98a7-e00430047893
                stepCounter: 5fe956d8-2852-4bdc-85a1-0af493c3c6d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f90ccc67-4fb3-4ebc-b277-f4a4b5ada7dd
          stepCounter: 8a6b5ddc-1cff-4536-8d16-61ede78dfcc5
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Identifies the first phone number by which an Institution can be contacted.
        name: PRINCIPAL_CONTACT_PHONE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed2fc2e3-fb79-481b-a548-938bbcfcbc2c
                stepCounter: 5fe956d8-2852-4bdc-85a1-0af493c3c6d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 363c5677-c418-419b-bc66-3dd0cf3aa7d0
          stepCounter: 8a6b5ddc-1cff-4536-8d16-61ede78dfcc5
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Identifies an alternative phone number by which the Institution can be contacted.
        name: ALTERNATIVE_CONTACT_PHONE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02f94a14-c334-4735-85bc-88534f7594a9
                stepCounter: 5fe956d8-2852-4bdc-85a1-0af493c3c6d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 379b686d-6c7d-409f-a3be-b52de7178667
          stepCounter: 8a6b5ddc-1cff-4536-8d16-61ede78dfcc5
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Identifies the fax number by which the institution can be contacted.
        name: CONTACT_FAX_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 674c045b-5e03-4957-a0bf-d9836ec4a1e7
                stepCounter: 5fe956d8-2852-4bdc-85a1-0af493c3c6d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4bc72b7-c2eb-4fe5-8389-4165e06c042b
          stepCounter: 8a6b5ddc-1cff-4536-8d16-61ede78dfcc5
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: The Area code for this address
        name: ADDRESS_AREA_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9da57900-5bca-4adb-ab90-3b12847bdae4
                stepCounter: 5fe956d8-2852-4bdc-85a1-0af493c3c6d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cac7c7dc-a3eb-40fc-b844-fcbfa42e2e5b
          stepCounter: 8a6b5ddc-1cff-4536-8d16-61ede78dfcc5
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: LAST_UPDATE_USER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d0f5ec8-e186-4331-a079-53cb89199829
                stepCounter: 5fe956d8-2852-4bdc-85a1-0af493c3c6d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e1172a2-4597-437c-8c8d-c40c74c0dc6e
          stepCounter: 8a6b5ddc-1cff-4536-8d16-61ede78dfcc5
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: LAST_UPDATE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8a3c6e61-5b38-44ec-9f15-4e414e157253
                stepCounter: 5fe956d8-2852-4bdc-85a1-0af493c3c6d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 565a9741-ff8e-4310-9a50-818f7d9d34bd
          stepCounter: 8a6b5ddc-1cff-4536-8d16-61ede78dfcc5
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: The Area code for this address
        name: ADDRESS_STATE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 87416903-9126-4245-bf97-23ac882cb68f
                stepCounter: 5fe956d8-2852-4bdc-85a1-0af493c3c6d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e2bfeb0-669c-453b-822e-4b24bcbbda4f
          stepCounter: 8a6b5ddc-1cff-4536-8d16-61ede78dfcc5
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Holds the Tax ID or Social Security Number for the contact.
        name: CONTACT_SOCIAL_INSURANCE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 080ef181-ddf3-4851-a4f7-359e46fbec59
                stepCounter: 5fe956d8-2852-4bdc-85a1-0af493c3c6d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7446c75d-c026-4399-a97f-7c720f9f8654
          stepCounter: 8a6b5ddc-1cff-4536-8d16-61ede78dfcc5
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: DATE_OF_BIRTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b02d07d2-b158-4fe5-84c3-f0a58348ef36
                stepCounter: 5fe956d8-2852-4bdc-85a1-0af493c3c6d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2aa1278-db86-4b02-b53c-fa73caa1f9e4
          stepCounter: 8a6b5ddc-1cff-4536-8d16-61ede78dfcc5
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: The sequence number is part of the physical key together with Institution ID, Institution Contact Number. The currently effective instance is identified by the sequence number zero.
        name: SEQUENCE_NUMBER_PII
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f02420b8-a039-4ed1-b4c8-2666d682eb47
                stepCounter: 5fe956d8-2852-4bdc-85a1-0af493c3c6d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6680baf9-dbcc-4b23-a017-f31fbb3521d0
          stepCounter: 8a6b5ddc-1cff-4536-8d16-61ede78dfcc5
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: The changing hash
        name: DSS_CHANGE_HASH
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c4b0622-992f-4833-8abd-5aea84e5de4b
                stepCounter: 5fe956d8-2852-4bdc-85a1-0af493c3c6d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9aaac5c7-d38b-4e11-8deb-28d1c34fd88c
          stepCounter: 8a6b5ddc-1cff-4536-8d16-61ede78dfcc5
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Record source
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b56afd7-fdea-4bd0-95b3-3e36ea247478
                stepCounter: 5fe956d8-2852-4bdc-85a1-0af493c3c6d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5bc3e98c-9735-4474-a8bc-df9ef4fc4804
          stepCounter: 8a6b5ddc-1cff-4536-8d16-61ede78dfcc5
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was loaded in the data vault
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8190ef0-4919-4619-83df-b47dd59c607a
                stepCounter: 5fe956d8-2852-4bdc-85a1-0af493c3c6d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f8c94f65-a33a-42c7-ac51-24a26b0bcacf
          stepCounter: 8a6b5ddc-1cff-4536-8d16-61ede78dfcc5
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row started in the data vault
        isSystemStartDate: true
        name: DSS_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3d5f9ed0-0b83-46d6-8ea8-2317a37e33ca
                stepCounter: 5fe956d8-2852-4bdc-85a1-0af493c3c6d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8de4bd12-4fa5-423b-bf01-1e352335e941
          stepCounter: 8a6b5ddc-1cff-4536-8d16-61ede78dfcc5
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: Version number of a business key in the data vault
        isSurrogateKey: true
        isSystemVersion: true
        name: DSS_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c152a2b8-8a22-4685-ad5e-1fd36e74074f
                stepCounter: 5fe956d8-2852-4bdc-85a1-0af493c3c6d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 898e1ef6-2bfe-46bd-949b-3a440de201aa
          stepCounter: 8a6b5ddc-1cff-4536-8d16-61ede78dfcc5
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was inserted in the data vault
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dbf98f4a-b804-4f6f-82e8-882b0e574afe
                stepCounter: 5fe956d8-2852-4bdc-85a1-0af493c3c6d4
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_MERCHANT_CONTACT_DETAILS_PII: 5fe956d8-2852-4bdc-85a1-0af493c3c6d4
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATAVAULT_RAW_VAULT
            nodeName: S_MERCHANT_CONTACT_DETAILS_PII
        join:
          joinCondition: |-
            FROM {{ ref('DATAVAULT_RAW_VAULT','S_MERCHANT_CONTACT_DETAILS_PII') }} s_merchant_contact_details_pii
             INNER JOIN (
                    SELECT hk_h_merchant_contact_details,
                           MAX(dss_start_date) AS dss_start_date
                      FROM {{ ref('DATAVAULT_RAW_VAULT','S_MERCHANT_CONTACT_DETAILS_PII') }}
                     GROUP BY hk_h_merchant_contact_details
                   ) curr
                ON curr.hk_h_merchant_contact_details = s_merchant_contact_details_pii.hk_h_merchant_contact_details
               AND curr.dss_start_date = s_merchant_contact_details_pii.dss_start_date
        name: S_MERCHANT_CONTACT_DETAILS_PII_CURRENT
        noLinkRefs: []
  name: S_MERCHANT_CONTACT_DETAILS_PII_CURRENT
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
