fileVersion: 1
id: 599dda53-de86-414a-a6a2-52dff404c37f
name: S_PJ_RADIOLOGY_EVENT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Get all the radiology information required from the radiology fact tables."
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a985dc8-1b1b-428a-b3a2-eae5dc042fb5
          stepCounter: 599dda53-de86-414a-a6a2-52dff404c37f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75f749cd-1e4e-4f9b-9e9d-a80e134db430
          stepCounter: 599dda53-de86-414a-a6a2-52dff404c37f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: encounter unique identifier
        name: ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b8beeb5-90fb-48c2-afe8-9399b68ec225
          stepCounter: 599dda53-de86-414a-a6a2-52dff404c37f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: IP encounter unique identifier
        name: IP_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 44bca1a6-e316-4993-8d82-b41e82e756e7
                stepCounter: 04791d95-8803-45a7-84f5-7fe19c6545ae
            transform: IFNULL(s_PJ_ip_event.ip_encounter_id,s_PJ_ed_event.IP_encounter_id)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9eae1fc-3a4c-41f7-9251-ac2461203a63
          stepCounter: 599dda53-de86-414a-a6a2-52dff404c37f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ED Encounter unique identifier
        name: ED_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 04157529-10b2-479e-8d0d-a5e38b443ca2
                stepCounter: 1f888c0c-c0bc-4225-aebf-0a0cae18c7f0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70c8d374-9410-4aeb-b41b-cd57791368aa
          stepCounter: 599dda53-de86-414a-a6a2-52dff404c37f
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: OP encounter unique identifier
        name: OP_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e6e1ff32-ad09-4726-ac8f-a05ab6aacd43
                stepCounter: 94bd545f-efb2-49b0-ae84-d4fe3718383c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c9c3a92-4618-4a7c-9860-e370c1014caa
          stepCounter: 599dda53-de86-414a-a6a2-52dff404c37f
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ACCESSION_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5bf5e0ad-b356-41bf-ab76-ab78daa21910
          stepCounter: 599dda53-de86-414a-a6a2-52dff404c37f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: EXAM_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09a8d8d2-ae6f-47b8-9a1c-20124dc71f0f
          stepCounter: 599dda53-de86-414a-a6a2-52dff404c37f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_RIS_procedures_completed.perf_department=dim_radiology_exam_performed.performing_department  s_RIS_procedures_completed.procedure_exam_code=dim_radiology_exam_performed.performed_exam_code
        name: DIM_RADIOLOGY_EXAM_PERFORMED_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 68e17349-2a2e-47a4-994c-96a3ac80eca3
          stepCounter: 599dda53-de86-414a-a6a2-52dff404c37f
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: RADIOLOGY_EORDER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e90b88f1-c26f-4da0-8ad6-a18255612299
          stepCounter: 599dda53-de86-414a-a6a2-52dff404c37f
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: FACT_RIS_EXAM_COMPLETED
        join:
          joinCondition: |-
            FROM fact.fact_RIS_exam_completed
              JOIN fact.fact_RIS_referral
                ON fact_RIS_exam_completed.referral_id = fact_RIS_referral.referral_id
              LEFT OUTER JOIN s_PJ_ip_event
                ON fact_RIS_exam_completed.patient_nhi = s_PJ_ip_event.patient_nhi
               AND fact_RIS_exam_completed.exam_date BETWEEN s_PJ_ip_event.ip_admit_date AND s_PJ_ip_event.ip_discharge_date
              LEFT OUTER JOIN s_PJ_ed_event
                ON fact_RIS_exam_completed.patient_nhi = s_PJ_ed_event.patient_nhi
               AND fact_RIS_exam_completed.exam_date BETWEEN s_PJ_ed_event.ed_presentation_date AND s_PJ_ed_event.ed_discharge_date
              LEFT OUTER JOIN s_PJ_op_event
                ON fact_RIS_exam_completed.source_encounter_id = s_PJ_op_event.op_encounter_id
             WHERE LEFT(fact_RIS_exam_completed.source_encounter_id, 1) IN ('A','H','T') -- ED, IP, OP/Theatre  AND (s_PJ_ip_event.ip_encounter_id IS NOT NULL  OR   s_PJ_ed_event.ed_encounter_id IS NOT NULL  OR   s_PJ_op_event.op_encounter_id IS NOT NULL)
        name: S_PJ_RADIOLOGY_EVENT
        noLinkRefs: []
  name: S_PJ_RADIOLOGY_EVENT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
