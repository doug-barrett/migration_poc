fileVersion: 1
id: 98ad5dbf-b10b-4d5e-8141-11905bee5233
name: STAGE_OPC_PARTNER_DEVELOPMENT_EVENTS_REFORMAT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 44fb8f3e-f55a-48cb-87fd-2b5df8b49cb5
          stepCounter: 98ad5dbf-b10b-4d5e-8141-11905bee5233
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ACCOUNT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e948325a-c095-452a-9c25-08a1e4fc0cfa
          stepCounter: 98ad5dbf-b10b-4d5e-8141-11905bee5233
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd7db961-b398-4f8f-b1eb-51083a5b52ea
                stepCounter: 329f4eb5-3cdf-4a7d-8d15-a96bd46b13b8
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_PD_EVENTS_GA4.DATE),'YYYYMMDD') \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a0e3f78-c2a4-4275-88c4-ed50010865ee
          stepCounter: 98ad5dbf-b10b-4d5e-8141-11905bee5233
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: GA_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd7db961-b398-4f8f-b1eb-51083a5b52ea
                stepCounter: 329f4eb5-3cdf-4a7d-8d15-a96bd46b13b8
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_PD_EVENTS_GA4.DATE),'YYYYMMDD')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4439e651-a288-46bc-b8d6-766af63f3912
          stepCounter: 98ad5dbf-b10b-4d5e-8141-11905bee5233
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: USER ID
        name: GA_DIMENSION10
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f62f3a08-fd09-4b09-a905-bdf98309b98f
                stepCounter: 329f4eb5-3cdf-4a7d-8d15-a96bd46b13b8
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c953595-b663-4840-8558-226878e00a5d
          stepCounter: 98ad5dbf-b10b-4d5e-8141-11905bee5233
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: USER NAME
        name: GA_DIMENSION11
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ead2a564-9a42-4310-8495-4bfc4bd9e62e
                stepCounter: b7986fba-dcf2-476d-bb80-43b446548bce
            transform: INITCAP(CONCAT(LOADOPCUSERS.FIRSTNAME,' ',LOADOPCUSERS.LASTNAME))
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: INITCAP(CONCAT(LOADOPCUSERS.FIRSTNAME,' ',LOADOPCUSERS.LASTNAME))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd84b491-6cef-47ca-9dee-f96b77dec125
          stepCounter: 98ad5dbf-b10b-4d5e-8141-11905bee5233
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER ID - SUPPLIER NAME
        name: GA_DIMENSION12
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00b5ff7c-2038-478e-a4b1-b146733eabaf
                stepCounter: 329f4eb5-3cdf-4a7d-8d15-a96bd46b13b8
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b1e562e-3be9-41d6-82c4-967bcb431e1f
          stepCounter: 98ad5dbf-b10b-4d5e-8141-11905bee5233
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER ID
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00b5ff7c-2038-478e-a4b1-b146733eabaf
                stepCounter: 329f4eb5-3cdf-4a7d-8d15-a96bd46b13b8
            transform: SPLIT_PART(LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA.USER_SUPPLIER,'-',1) \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: SPLIT_PART(LOADGA_OPC_PD_EVENTS_GA4.USER_SUPPLIER,'-',1)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 364fff23-847a-4032-9d6f-c80b3c44c6b2
          stepCounter: 98ad5dbf-b10b-4d5e-8141-11905bee5233
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER NAME
        name: SUPPLIER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00b5ff7c-2038-478e-a4b1-b146733eabaf
                stepCounter: 329f4eb5-3cdf-4a7d-8d15-a96bd46b13b8
            transform: INITCAP(SPLIT_PART(LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA.USER_SUPPLIER,'-',2)) \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: INITCAP(SPLIT_PART(LOADGA_OPC_PD_EVENTS_GA4.USER_SUPPLIER,'-',2)) \N \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ddc9a341-1965-496a-a074-9300e9a95828
          stepCounter: 98ad5dbf-b10b-4d5e-8141-11905bee5233
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: GA_EVENTCATEGORY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4602e69c-27ff-4738-8b2c-191e6ffd1024
                stepCounter: 329f4eb5-3cdf-4a7d-8d15-a96bd46b13b8
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c70564e2-910c-4c1e-a190-7120b4405133
          stepCounter: 98ad5dbf-b10b-4d5e-8141-11905bee5233
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: GA_EVENTACTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8731f3e8-eae8-4124-bb8d-a380e39e45f5
                stepCounter: 329f4eb5-3cdf-4a7d-8d15-a96bd46b13b8
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7350026d-99bc-449c-add6-a6fee374b5f9
          stepCounter: 98ad5dbf-b10b-4d5e-8141-11905bee5233
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: GA_EVENTLABEL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f66c991-662f-4af7-9089-64c31e1270da
                stepCounter: 329f4eb5-3cdf-4a7d-8d15-a96bd46b13b8
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f9511d4-5f2b-4313-8d95-c57de0eda5b6
          stepCounter: 98ad5dbf-b10b-4d5e-8141-11905bee5233
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: GA_TOTALEVENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 659109e7-2e5e-4cb3-ab93-1b6e56fb83ab
                stepCounter: 329f4eb5-3cdf-4a7d-8d15-a96bd46b13b8
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5484516-4328-44a8-b5a3-c993ecab3685
          stepCounter: 98ad5dbf-b10b-4d5e-8141-11905bee5233
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: GA_UNIQUEEVENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 89d608a8-8d62-40be-a6b6-9d2e15097fa5
                stepCounter: 329f4eb5-3cdf-4a7d-8d15-a96bd46b13b8
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 151d1b1b-c144-4e70-b5f7-ad3eb3593493
          stepCounter: 98ad5dbf-b10b-4d5e-8141-11905bee5233
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PROFILE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fcf9bbc7-8f28-4999-a9f5-6d38e2c04e15
          stepCounter: 98ad5dbf-b10b-4d5e-8141-11905bee5233
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd7db961-b398-4f8f-b1eb-51083a5b52ea
                stepCounter: 329f4eb5-3cdf-4a7d-8d15-a96bd46b13b8
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_PD_EVENTS_GA4.DATE),'YYYYMMDD')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f3cd8fa4-f4a1-4cb1-86eb-d38c04441f3c
          stepCounter: 98ad5dbf-b10b-4d5e-8141-11905bee5233
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: WEB_PROPERTY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 00e1a903-2fe1-44ff-8f78-1bd0240ad9b4
          stepCounter: 98ad5dbf-b10b-4d5e-8141-11905bee5233
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_BATCHED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe12c566-3fb0-4f8a-82a4-17d28a527420
                stepCounter: 329f4eb5-3cdf-4a7d-8d15-a96bd46b13b8
            transform: TO_TIMESTAMP(LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA.__HEVO__LOADED_AT,3) \N \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_PD_EVENTS_GA4.__HEVO__LOADED_AT,3) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f8947f44-734a-4272-81ee-7df49cbcb26c
          stepCounter: 98ad5dbf-b10b-4d5e-8141-11905bee5233
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_EXTRACTED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5f19861-14b5-4688-8531-1c95e77a2428
                stepCounter: 329f4eb5-3cdf-4a7d-8d15-a96bd46b13b8
            transform: TO_TIMESTAMP(LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA.__HEVO__INGESTED_AT,3)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_PD_EVENTS_GA4.__HEVO__INGESTED_AT,3) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6a65ae8-1b95-4161-ab38-7c86f030ffd2
          stepCounter: 98ad5dbf-b10b-4d5e-8141-11905bee5233
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_RECEIVED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe12c566-3fb0-4f8a-82a4-17d28a527420
                stepCounter: 329f4eb5-3cdf-4a7d-8d15-a96bd46b13b8
            transform: TO_TIMESTAMP(LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA.__HEVO__LOADED_AT,3) \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_PD_EVENTS_GA4.__HEVO__LOADED_AT,3)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1b857dd-0b55-4060-adb8-222a91bd0df2
          stepCounter: 98ad5dbf-b10b-4d5e-8141-11905bee5233
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: _SDC_RECORD_HASH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c4c13ed-4040-422a-89e3-fcf68c4a01be
                stepCounter: 329f4eb5-3cdf-4a7d-8d15-a96bd46b13b8
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f976a892-6f05-4116-ae1a-5c7cdb02d5aa
          stepCounter: 98ad5dbf-b10b-4d5e-8141-11905bee5233
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: _SDC_SEQUENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 894fe704-e180-4700-887d-5ed38167e220
          stepCounter: 98ad5dbf-b10b-4d5e-8141-11905bee5233
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: _SDC_TABLE_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2bbc24f-ef93-4071-a67a-1b51603dde0f
          stepCounter: 98ad5dbf-b10b-4d5e-8141-11905bee5233
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: GA_HOSTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea04811f-b01c-48f1-8c28-53d479ec74f8
                stepCounter: 329f4eb5-3cdf-4a7d-8d15-a96bd46b13b8
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0190ff64-ef5a-4b16-a6cc-ba3885f847d3
          stepCounter: 98ad5dbf-b10b-4d5e-8141-11905bee5233
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: THIS FIELD WILL BE USED TO FILTER WHICH OPC ENVIRONMENT THIS GA RECORD WILL BE SHOWN.
        name: FILTER_DATABASE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea04811f-b01c-48f1-8c28-53d479ec74f8
                stepCounter: 329f4eb5-3cdf-4a7d-8d15-a96bd46b13b8
            transform: CASE HOSTNAME \N WHEN 'OPC-SCUS-SVC-WEB-DEV.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_DEV' \N WHEN 'LOCALHOST' \N THEN 'OMNIACONNECT_DEV' \N WHEN'OPC-SCUS-SVC-WEB-QA.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA' \N WHEN 'OPC-SCUS-SVC-WEB-PROD-STAGING.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA' \N WHEN 'OPC-SCUS-SVC-WEB-UAT.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_UAT' \N WHEN 'OMNIACONNECT.OMNIAPARTNERS.COM' \N THEN 'OMNIACONNECT' \N ELSE NULL \NEND \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: CASE HOSTNAME \N WHEN 'OPC-SCUS-SVC-WEB-DEV.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_DEV' \N WHEN 'LOCALHOST' \N THEN 'OMNIACONNECT_DEV' \N WHEN'OPC-SCUS-SVC-WEB-QA.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA' \N WHEN 'OPC-SCUS-SVC-WEB-PROD-STAGING.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA' \N WHEN 'OPC-SCUS-SVC-WEB-UAT.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_UAT' \N WHEN 'OMNIACONNECT.OMNIAPARTNERS.COM' \N THEN 'OMNIACONNECT' \N ELSE NULL \NEND \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2bede322-2aec-443e-b66a-7af24b73b5bf
          stepCounter: 98ad5dbf-b10b-4d5e-8141-11905bee5233
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b726c02d-8b41-429e-93c7-6f2154c9cdf0
                stepCounter: 329f4eb5-3cdf-4a7d-8d15-a96bd46b13b8
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a9a106b-29e3-4596-ab9b-e2f0270428c7
          stepCounter: 98ad5dbf-b10b-4d5e-8141-11905bee5233
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3685b9e-8caa-43da-901f-717a3046808c
                stepCounter: 329f4eb5-3cdf-4a7d-8d15-a96bd46b13b8
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 621af708-3c43-4b9e-9c4d-2e9950132d2a
          stepCounter: 98ad5dbf-b10b-4d5e-8141-11905bee5233
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 195a3924-9156-4025-9ead-9c07ca229ec6
          stepCounter: 98ad5dbf-b10b-4d5e-8141-11905bee5233
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOAD_OPC_PARTNER_DEVELOPMENT_EVENTS_GA: 329f4eb5-3cdf-4a7d-8d15-a96bd46b13b8
          LOAD_OPCUSERS: b7986fba-dcf2-476d-bb80-43b446548bce
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOAD_OPCUSERS
          - locationName: LOAD
            nodeName: LOAD_OPC_PARTNER_DEVELOPMENT_EVENTS_GA
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOAD_OPC_PARTNER_DEVELOPMENT_EVENTS_GA') }} LOAD_OPC_PARTNER_DEVELOPMENT_EVENTS_GA
              LEFT JOIN {{ ref('LOAD','LOAD_OPCUSERS') }} LOAD_OPCUSERS
                ON LOAD_OPC_PARTNER_DEVELOPMENT_EVENTS_GA.USER_ID = LOAD_OPCUSERS.IDENTITYUSERID
        name: SRC_STAGEOPC_PARTNER_DEVELOPMENT_EVENTS_GA3
        noLinkRefs: []
  name: STAGE_OPC_PARTNER_DEVELOPMENT_EVENTS_REFORMAT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
