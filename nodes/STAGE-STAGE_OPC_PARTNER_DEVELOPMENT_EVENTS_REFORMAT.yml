fileVersion: 1
id: a8a201d4-a110-4018-92f0-0f9aac1ef5b7
name: STAGE_OPC_PARTNER_DEVELOPMENT_EVENTS_REFORMAT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96e193c7-cabb-4ff5-af64-3acc8aec379c
          stepCounter: a8a201d4-a110-4018-92f0-0f9aac1ef5b7
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ACCOUNT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ce01a87-503d-4d72-94eb-626604dfeaa7
          stepCounter: a8a201d4-a110-4018-92f0-0f9aac1ef5b7
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c47be12-46e2-4bd6-adb0-fcec1426d103
                stepCounter: 6bc8ae80-0f3e-4849-a3b7-25a36a0cf37b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_PD_EVENTS_GA4.DATE),'YYYYMMDD') \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2ee6fa0-cb9a-459f-bbea-0dee7dc72c7f
          stepCounter: a8a201d4-a110-4018-92f0-0f9aac1ef5b7
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: GA_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c47be12-46e2-4bd6-adb0-fcec1426d103
                stepCounter: 6bc8ae80-0f3e-4849-a3b7-25a36a0cf37b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_PD_EVENTS_GA4.DATE),'YYYYMMDD')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33394662-f56f-4ff0-8314-2eab02d2a26b
          stepCounter: a8a201d4-a110-4018-92f0-0f9aac1ef5b7
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: USER ID
        name: GA_DIMENSION10
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3946839d-24d2-481a-963d-a60eaa6dbda0
                stepCounter: 6bc8ae80-0f3e-4849-a3b7-25a36a0cf37b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67062e08-210a-4fa9-ae2e-83139f974596
          stepCounter: a8a201d4-a110-4018-92f0-0f9aac1ef5b7
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: USER NAME
        name: GA_DIMENSION11
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c97f9234-e9fe-4c36-978f-5659f29c2202
                stepCounter: 8428b8a3-cdb3-4ef1-beff-8735fbf176bc
            transform: INITCAP(CONCAT(LOADOPCUSERS.FIRSTNAME,' ',LOADOPCUSERS.LASTNAME))
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: INITCAP(CONCAT(LOADOPCUSERS.FIRSTNAME,' ',LOADOPCUSERS.LASTNAME))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1615395a-012a-4a80-a0bb-cfd4341bd746
          stepCounter: a8a201d4-a110-4018-92f0-0f9aac1ef5b7
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER ID - SUPPLIER NAME
        name: GA_DIMENSION12
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5bc8c2a5-f351-4113-913e-770817c180f6
                stepCounter: 6bc8ae80-0f3e-4849-a3b7-25a36a0cf37b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8b45fbc-236a-4914-a994-704c339eab49
          stepCounter: a8a201d4-a110-4018-92f0-0f9aac1ef5b7
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER ID
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5bc8c2a5-f351-4113-913e-770817c180f6
                stepCounter: 6bc8ae80-0f3e-4849-a3b7-25a36a0cf37b
            transform: SPLIT_PART(LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA.USER_SUPPLIER,'-',1) \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: SPLIT_PART(LOADGA_OPC_PD_EVENTS_GA4.USER_SUPPLIER,'-',1)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8e89191-2beb-4ae3-beb4-a307e94dd462
          stepCounter: a8a201d4-a110-4018-92f0-0f9aac1ef5b7
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER NAME
        name: SUPPLIER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5bc8c2a5-f351-4113-913e-770817c180f6
                stepCounter: 6bc8ae80-0f3e-4849-a3b7-25a36a0cf37b
            transform: INITCAP(SPLIT_PART(LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA.USER_SUPPLIER,'-',2)) \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: INITCAP(SPLIT_PART(LOADGA_OPC_PD_EVENTS_GA4.USER_SUPPLIER,'-',2)) \N \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 60c2b9a3-968b-4eab-b4c1-8954835d83a5
          stepCounter: a8a201d4-a110-4018-92f0-0f9aac1ef5b7
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: GA_EVENTCATEGORY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 905be560-0095-42b7-a08a-261f282a0f99
                stepCounter: 6bc8ae80-0f3e-4849-a3b7-25a36a0cf37b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 84887bdc-8798-4311-92b0-1524d268d231
          stepCounter: a8a201d4-a110-4018-92f0-0f9aac1ef5b7
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: GA_EVENTACTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7aedd266-8f75-4a5e-b191-55717dc481fc
                stepCounter: 6bc8ae80-0f3e-4849-a3b7-25a36a0cf37b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba562bac-0556-4cd8-9ac0-3a60c57cb1ef
          stepCounter: a8a201d4-a110-4018-92f0-0f9aac1ef5b7
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: GA_EVENTLABEL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f2bb4b59-0226-4536-8f88-93943b24356d
                stepCounter: 6bc8ae80-0f3e-4849-a3b7-25a36a0cf37b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7dfab96-f151-4fa3-8b34-b056a740c4e1
          stepCounter: a8a201d4-a110-4018-92f0-0f9aac1ef5b7
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: GA_TOTALEVENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c26299be-a830-4394-bb46-d20e042e4a2e
                stepCounter: 6bc8ae80-0f3e-4849-a3b7-25a36a0cf37b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d5b6883-21f0-416a-a329-0f74a0de269c
          stepCounter: a8a201d4-a110-4018-92f0-0f9aac1ef5b7
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: GA_UNIQUEEVENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79808707-eb6e-4069-853d-62cd44b440a6
                stepCounter: 6bc8ae80-0f3e-4849-a3b7-25a36a0cf37b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81625ae4-f255-41f6-9ee2-bfbda35cc791
          stepCounter: a8a201d4-a110-4018-92f0-0f9aac1ef5b7
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PROFILE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e98e1196-de35-422e-bf70-8ee1ff516b57
          stepCounter: a8a201d4-a110-4018-92f0-0f9aac1ef5b7
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c47be12-46e2-4bd6-adb0-fcec1426d103
                stepCounter: 6bc8ae80-0f3e-4849-a3b7-25a36a0cf37b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(TO_CHAR(LOADGA_OPC_PD_EVENTS_GA4.DATE),'YYYYMMDD')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e42ef7e-6bd6-46e7-a836-1f2732d0a701
          stepCounter: a8a201d4-a110-4018-92f0-0f9aac1ef5b7
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: WEB_PROPERTY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82f993b0-cca8-40e2-bcfa-717b69327e00
          stepCounter: a8a201d4-a110-4018-92f0-0f9aac1ef5b7
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_BATCHED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1eb4f2c2-8088-44af-8745-430e319a20d1
                stepCounter: 6bc8ae80-0f3e-4849-a3b7-25a36a0cf37b
            transform: TO_TIMESTAMP(LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA.__HEVO__LOADED_AT,3) \N \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_PD_EVENTS_GA4.__HEVO__LOADED_AT,3) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3804a399-ff7e-4446-a79c-a3e70a5019fe
          stepCounter: a8a201d4-a110-4018-92f0-0f9aac1ef5b7
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_EXTRACTED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b77c5c7e-37b0-48e0-8473-6635b8200270
                stepCounter: 6bc8ae80-0f3e-4849-a3b7-25a36a0cf37b
            transform: TO_TIMESTAMP(LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA.__HEVO__INGESTED_AT,3)
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_PD_EVENTS_GA4.__HEVO__INGESTED_AT,3) \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c564f4c-c676-40c8-8ed4-25b923c0cf3b
          stepCounter: a8a201d4-a110-4018-92f0-0f9aac1ef5b7
        config: {}
        dataType: TIMESTAMP_TZ
        defaultValue: ""
        description: ""
        name: _SDC_RECEIVED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1eb4f2c2-8088-44af-8745-430e319a20d1
                stepCounter: 6bc8ae80-0f3e-4849-a3b7-25a36a0cf37b
            transform: TO_TIMESTAMP(LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA.__HEVO__LOADED_AT,3) \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: TO_TIMESTAMP(LOADGA_OPC_PD_EVENTS_GA4.__HEVO__LOADED_AT,3)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8cc1d2d1-3d0c-4f58-b6bd-c107c1077ca0
          stepCounter: a8a201d4-a110-4018-92f0-0f9aac1ef5b7
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: _SDC_RECORD_HASH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a96c25d3-ec7e-416b-80e5-3659259e21d0
                stepCounter: 6bc8ae80-0f3e-4849-a3b7-25a36a0cf37b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f085d2c-1373-4ed0-87e1-48252ba001c4
          stepCounter: a8a201d4-a110-4018-92f0-0f9aac1ef5b7
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: _SDC_SEQUENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04eed23f-4f78-4623-9127-8cb5251b9df3
          stepCounter: a8a201d4-a110-4018-92f0-0f9aac1ef5b7
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: _SDC_TABLE_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b24284e-3875-4298-9b8d-f4e8b2466a2a
          stepCounter: a8a201d4-a110-4018-92f0-0f9aac1ef5b7
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: GA_HOSTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a984e8c-f634-4e62-a264-7965150b357d
                stepCounter: 6bc8ae80-0f3e-4849-a3b7-25a36a0cf37b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4db16e1d-84a9-4e18-8181-d55ee35e19c5
          stepCounter: a8a201d4-a110-4018-92f0-0f9aac1ef5b7
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: THIS FIELD WILL BE USED TO FILTER WHICH OPC ENVIRONMENT THIS GA RECORD WILL BE SHOWN.
        name: FILTER_DATABASE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a984e8c-f634-4e62-a264-7965150b357d
                stepCounter: 6bc8ae80-0f3e-4849-a3b7-25a36a0cf37b
            transform: CASE HOSTNAME \N WHEN 'OPC-SCUS-SVC-WEB-DEV.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_DEV' \N WHEN 'LOCALHOST' \N THEN 'OMNIACONNECT_DEV' \N WHEN'OPC-SCUS-SVC-WEB-QA.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA' \N WHEN 'OPC-SCUS-SVC-WEB-PROD-STAGING.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA' \N WHEN 'OPC-SCUS-SVC-WEB-UAT.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_UAT' \N WHEN 'OMNIACONNECT.OMNIAPARTNERS.COM' \N THEN 'OMNIACONNECT' \N ELSE NULL \NEND \N
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: CASE HOSTNAME \N WHEN 'OPC-SCUS-SVC-WEB-DEV.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_DEV' \N WHEN 'LOCALHOST' \N THEN 'OMNIACONNECT_DEV' \N WHEN'OPC-SCUS-SVC-WEB-QA.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA' \N WHEN 'OPC-SCUS-SVC-WEB-PROD-STAGING.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_QA' \N WHEN 'OPC-SCUS-SVC-WEB-UAT.AZUREWEBSITES.NET' \N THEN 'OMNIACONNECT_UAT' \N WHEN 'OMNIACONNECT.OMNIAPARTNERS.COM' \N THEN 'OMNIACONNECT' \N ELSE NULL \NEND \N
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df3a7cf0-8170-4c47-ba44-052775a13825
          stepCounter: a8a201d4-a110-4018-92f0-0f9aac1ef5b7
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e7dbb92-7a01-4a81-b61d-4ac5f2d8e309
                stepCounter: 6bc8ae80-0f3e-4849-a3b7-25a36a0cf37b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6cc00cef-e247-4ac0-8b0d-9ac336ebe756
          stepCounter: a8a201d4-a110-4018-92f0-0f9aac1ef5b7
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b04d13b0-63e5-4d9f-a077-62864bcc1d8b
                stepCounter: 6bc8ae80-0f3e-4849-a3b7-25a36a0cf37b
            transform: ""
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e4621d9-1852-4578-9ce7-3e070e6baef4
          stepCounter: a8a201d4-a110-4018-92f0-0f9aac1ef5b7
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c112a961-bdf0-4827-9db1-dfa43c2ee1bb
          stepCounter: a8a201d4-a110-4018-92f0-0f9aac1ef5b7
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOAD_OPCUSERS
          - locationName: LOAD
            nodeName: LOAD_OPC_PARTNER_DEVELOPMENT_EVENTS_GA
          - locationName: UNKNOWN
            nodeName: LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA
          - locationName: UNKNOWN
            nodeName: LOADOPCUSERS
        join:
          joinCondition: |-
            FROM {{ ref('UNKNOWN','LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA') }} LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA
              LEFT JOIN {{ ref('UNKNOWN','LOADOPCUSERS') }} LOADOPCUSERS
                ON LOADOPC_PARTNER_DEVELOPMENT_EVENTS_GA.USER_ID = LOADOPCUSERS.IDENTITYUSERID
        name: SRC_STAGEOPC_PARTNER_DEVELOPMENT_EVENTS_GA3
        noLinkRefs: []
  name: STAGE_OPC_PARTNER_DEVELOPMENT_EVENTS_REFORMAT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
