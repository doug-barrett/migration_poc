fileVersion: 1
id: 3ca00b0d-3488-45ce-abe4-6da9228c4c36
name: S_PJ_PATHWAY_PROCEDURE_50
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Map events to pathways via theatre booking codes."
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 89b00dcd-6869-4a04-9b69-20f92fdc8942
          stepCounter: 3ca00b0d-3488-45ce-abe4-6da9228c4c36
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Unique ID for a patient journey
        name: JOURNEY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f7dd4ca-4b72-4471-8e15-dd1ec0a54c3c
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70e27bc7-46c5-4ac1-be90-4637d4a82927
          stepCounter: 3ca00b0d-3488-45ce-abe4-6da9228c4c36
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7f60003-b7a5-4f17-92d1-b8cb3e8fce89
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dbf376d4-0d14-424b-8525-bac0a9fca26f
          stepCounter: 3ca00b0d-3488-45ce-abe4-6da9228c4c36
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Journey number for the patient.
        name: JOURNEY_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e8017333-8bf1-48d8-ae28-60f8be1ba8fd
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bdc53da7-a24c-4ed0-877d-66a492693fa0
          stepCounter: 3ca00b0d-3488-45ce-abe4-6da9228c4c36
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PROCEDURE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e009f44-734a-4289-8221-7835e51a48eb
                stepCounter: 298d8144-7a9f-4d48-a62f-419b6da64625
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fdab5b20-8049-438d-a8f7-869372ed17d2
          stepCounter: 3ca00b0d-3488-45ce-abe4-6da9228c4c36
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ICD_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "''"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b90f6b9-2d5f-4e11-8151-ab2d796ec1d1
          stepCounter: 3ca00b0d-3488-45ce-abe4-6da9228c4c36
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: ICD_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "''"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7aefdb3a-aab0-4b93-aeea-417d18d3743f
          stepCounter: 3ca00b0d-3488-45ce-abe4-6da9228c4c36
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: PROCEDURE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f37fa669-d9db-433e-a2f9-3441aee8071c
                stepCounter: 298d8144-7a9f-4d48-a62f-419b6da64625
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2fadf62c-2051-4497-8505-c2e6b35a7b59
          stepCounter: 3ca00b0d-3488-45ce-abe4-6da9228c4c36
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: DRG_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8383a556-8736-456e-a56d-2852d4dbd9f3
          stepCounter: 3ca00b0d-3488-45ce-abe4-6da9228c4c36
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: DRG_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a515c09d-c28e-4d43-bd4f-fa7ba14c2265
          stepCounter: 3ca00b0d-3488-45ce-abe4-6da9228c4c36
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_ICD_CODE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eff866e0-ed9f-495d-9f71-87121d0dfd1d
          stepCounter: 3ca00b0d-3488-45ce-abe4-6da9228c4c36
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_DRG_CODE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ecda5b4-710d-401a-9b42-7d7dcdcee223
          stepCounter: 3ca00b0d-3488-45ce-abe4-6da9228c4c36
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_ED_TREATMENT_PROTOCOL_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6298ddf6-2d64-4bd7-a39e-620ad621a724
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 274b5d77-0cf3-4ec9-975a-88d836ae537e
          stepCounter: 3ca00b0d-3488-45ce-abe4-6da9228c4c36
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_THEATRE_BOOKING_PROCEDURE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3d8961f-c3ed-4a08-a15d-0d38d9c9ff64
          stepCounter: 3ca00b0d-3488-45ce-abe4-6da9228c4c36
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_THEATRE_PROCEDURE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 12182704-b1e5-4603-9d22-f964011b165d
          stepCounter: 3ca00b0d-3488-45ce-abe4-6da9228c4c36
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: CODE_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c73b2a9d-2c47-46ec-8c40-d62485371c8e
                stepCounter: 298d8144-7a9f-4d48-a62f-419b6da64625
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a83c7419-1817-45ec-8738-d786184d9917
          stepCounter: 3ca00b0d-3488-45ce-abe4-6da9228c4c36
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PATHWAY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eeb7b32b-8f2a-437f-8a26-00aa90fc341e
                stepCounter: 298d8144-7a9f-4d48-a62f-419b6da64625
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e527f7e-f4a3-4310-8836-3a0d7a3e6c6c
          stepCounter: 3ca00b0d-3488-45ce-abe4-6da9228c4c36
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PATHWAY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 822a56ac-8b7d-465d-a60d-afe98e705c59
                stepCounter: 298d8144-7a9f-4d48-a62f-419b6da64625
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c0888e8-ef70-4af3-be97-e8e7eadc9bfe
          stepCounter: 3ca00b0d-3488-45ce-abe4-6da9228c4c36
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f9c4f67-e8f2-4ec7-b342-4ffc0a502a3f
                stepCounter: 298d8144-7a9f-4d48-a62f-419b6da64625
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4360767e-38b9-46ce-b26c-48c24cd01cc4
          stepCounter: 3ca00b0d-3488-45ce-abe4-6da9228c4c36
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_SPECIALTY_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b85a1e98-f006-44f3-b271-293c15237feb
                stepCounter: 298d8144-7a9f-4d48-a62f-419b6da64625
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 844da177-4cc4-40ff-bd36-07a72d1e5963
          stepCounter: 3ca00b0d-3488-45ce-abe4-6da9228c4c36
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: TREATMENT_PROTOCOL_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3e009f44-734a-4289-8221-7835e51a48eb
                stepCounter: 298d8144-7a9f-4d48-a62f-419b6da64625
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf21f6eb-d9a8-4d12-863d-5323cb29a110
          stepCounter: 3ca00b0d-3488-45ce-abe4-6da9228c4c36
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_PJ_EVENT
        join:
          joinCondition: |-
            FROM s_PJ_event
              JOIN s_PJ_pathway_code_xref
                ON s_PJ_pathway_code_xref.treatment_protocol_no = s_PJ_event.treatment_protocol_no
               AND s_PJ_pathway_code_xref.code_source = 'EDProtocol'
             WHERE s_PJ_event.event_source = 'ED'
        name: S_PJ_PATHWAY_PROCEDURE_50
        noLinkRefs: []
  name: S_PJ_PATHWAY_PROCEDURE_50
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
