fileVersion: 1
id: 2530850b-8707-49c5-bbff-8f51937fdbd6
name: STAGE_PVIEW_MOSAIC_CDM_VOLS_ADHOC
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d559434-f773-4e85-acf9-f48b884e07bd
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: WELL_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 295d169a-8764-40e9-9347-7e6746bb1d69
                stepCounter: 81e6b0b1-1728-45bf-932d-6356544cf13a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 193529f0-e63f-47a1-89a4-84bf990d2a7d
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: PRODUCTION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e23862e-5f1c-4ceb-9ed3-26e0c07e30fc
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4a40f8b-ce5d-4b34-bb89-1251c47992fc
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PERIOD_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd1c009d-89d2-4e07-82ec-f217deb027c5
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 81e344fc-8e1c-48b6-b2a3-4528e7962c25
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 63bb633d-99f6-4edc-8bf4-d2df542034f5
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: HOURS_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 81e344fc-8e1c-48b6-b2a3-4528e7962c25
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a5d5918-7cd2-4e26-b426-166a351e3473
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02e92701-932c-44a3-8a80-84585564dcb2
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0bf6d1d-d08b-49b5-ba4d-82d2f6d1fdaf
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed079b9e-40b2-4ef1-a22a-2af799344a29
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 985b480d-4c48-4588-ba80-866be82f857e
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: GAS_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bdb6415a-5401-4be1-a750-7dc668fa02b5
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d521b140-6137-4efe-91c0-f83a254ef25d
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: GAS_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a9aa2ff-9528-4529-801b-e1972733f120
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: WATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d150863-195c-46f9-b422-962623c38c57
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32a1ce34-905a-442a-a104-c26f7d349a3f
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: WATER_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7984656-93a2-45f4-8fc0-3e4f11df74e8
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c184337b-846f-44b3-86f5-ae4e8f1bf83d
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: WATER_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69be5618-b769-474c-be48-37893c660624
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: FIELD_CONDENSATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c311994-be34-400f-b2ce-a2448419cc39
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ETHANE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f15152e-bf41-45a0-90f6-737ae442f2a9
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ETHANE_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9697e5b2-c2a8-45c0-8a43-8c33878b695a
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PROPANE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d1038a50-6746-4dfe-9625-acad27c12db4
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PROPANE_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1cd8dd1f-afee-4834-be17-ea789afa2bc4
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: BUTANE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d27efdf1-cbbf-456b-933a-63500e5a3133
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: BUTANE_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2dd4e4c4-13d1-4108-b100-8b3413dba75e
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PENTANE_PLUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5839b94-93f3-48a5-80b9-9758740db524
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 360db7d9-f867-4b91-9a70-67f2ab4a20e9
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PENTANE_PLUS_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec68efff-3633-4950-bda6-4a5a4c8d5b03
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SULPHUR
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03262ae3-09d3-4988-af44-f5fa2a4220c9
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: FLUID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d55d5ac-44b6-4940-92c4-98e0b68591ef
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: NGL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8fdfffed-e6ec-4c8d-806e-5228b53b4ba7
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9700504-1325-4f5f-9166-d330acf6fb23
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: HELIUM
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6530714f-3a15-47c8-a909-79ac02f5f72a
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: HELIUM_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f437677-516b-49e4-9926-475cca90ccf6
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: HELIUM_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a0fa7551-ada0-4f8e-88ca-8b4913ae499a
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CARBON_DIOXIDE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ed1b0d9-5ab0-4831-b11f-63f02b4016c4
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CARBON_DIOXIDE_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39bbb37e-6a95-45d0-b95d-e1b6597925be
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CARBON_DIOXIDE_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94cbb1ee-895e-4d52-8adc-b35d813aebb2
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SAND
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ce5bdb6-497b-4a7d-be2d-34d9792b733c
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SAND_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20cd2bf8-cb45-4be7-9f34-2870c5b5c75d
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: STEAM_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a0950a5-27e0-4fd4-991d-b5689a8485aa
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: POLYMER_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b32b8257-0c9e-4291-8c6f-109793326b8f
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SOLVENT_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f98322b-f8c7-46fd-87fc-46b05340c774
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ALKALI_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f010c997-feaf-4e2a-ad33-9d6c29c0ca84
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: DILUENT_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a7c789a-fc81-4775-bfe0-7990f30295e5
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: DILUENT_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c64b7dcf-cbc7-4e0f-b4d6-2540bb3abab4
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: FWHP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e39e0f91-da22-4c5f-a206-240e833d3a8f
                stepCounter: 9108fb02-8d09-48b3-ba27-88a8ce494c39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 653950e7-682c-4e57-8070-530b4e0efe0b
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: FBHP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1bf7a9b8-71d6-4610-bc03-2f8fcdae2a3e
                stepCounter: 9108fb02-8d09-48b3-ba27-88a8ce494c39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f860c53-130a-4dc2-a48d-d6167fd618d2
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: CASING_PRESSURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1cc4c5c0-41bd-4baf-9231-65a7b10166d3
                stepCounter: 9108fb02-8d09-48b3-ba27-88a8ce494c39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: efd39fd8-c404-4434-8c18-87ea8f58453f
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: TUBING_PRESSURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ee6f2c1-12c9-4465-b37b-154bba143d3c
                stepCounter: 9108fb02-8d09-48b3-ba27-88a8ce494c39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b61c9109-8335-4b56-a7de-ea9d5372d457
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: LINE_PRESSURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e8a8a322-d205-40f9-8a30-6c67d8cf8295
                stepCounter: 9108fb02-8d09-48b3-ba27-88a8ce494c39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a35ef7d-6ed9-439c-b2bc-b3c38a5375ce
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PERFORMANCE_INDEX
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5570cc90-1931-49d7-8143-167693ad77db
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: CHOKE_SIZE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e0cf42e-9f0f-4201-b634-280b4b6f36fa
                stepCounter: 9108fb02-8d09-48b3-ba27-88a8ce494c39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f00b0ef-62d0-4fd9-9eab-82ac0cca330b
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: WELL_IDREC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f76be576-f021-42f1-a5bc-c6dfa35d25fb
                stepCounter: 81e6b0b1-1728-45bf-932d-6356544cf13a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22edcc74-1d7e-4ea7-9f09-21a3d42c143b
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: DAY_IDREC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e85cf3cd-21cb-480f-91e9-89a679db2cc4
                stepCounter: d08539ff-37af-4c21-9836-963dca56c39d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ef16319-b94d-4fc1-8860-abe6b6759296
          stepCounter: 2530850b-8707-49c5-bbff-8f51937fdbd6
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_PVIEW_MOSAIC_CDM_VOLS_ADHOC: 2530850b-8707-49c5-bbff-8f51937fdbd6
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE VIEW {{ ref_no_link('TARGET','STAGE_PVIEW_MOSAIC_CDM_VOLS_ADHOC') }} AS WITH -- date filter
            dates AS(
                    SELECT '2024-01-01' AS start_date,
                           '2025-01-31' AS end_date
                   ), --
            GasVolumes AS(
                    SELECT p.dttm,
                           p.idflownet,
                           p.volnewprodallocgas,
                           p.idrec,
                           CASE WHEN p.idflownet = '966E2E4C11274A8E88B00B7D5E37FA4A' THEN (p.volnewprodallocgas * 1.0494811) / 1000
                                WHEN p.idflownet = 'D31DB03FC64C4413B39FEBBED5004D42' THEN (p.volnewprodallocgas * 1.0494811) / 1000
                                WHEN p.idflownet = 'E6FCADB21222494393E582D914245BBF' THEN (p.volnewprodallocgas * 1.0494811) / 1000
                                WHEN p.idflownet = '13520ED8659449F38B5085DA7F464CDB' THEN (p.volnewprodallocgas * 1.0494811) / 1000
                                WHEN upper(u.district) IN ('ALBERTA')                 THEN p.volprodgathgas / 1000
                                ELSE p.volnewprodallocgas / 1000
                                 END AS gas,
                           CASE WHEN p.idflownet = '966E2E4C11274A8E88B00B7D5E37FA4A' THEN (p.volinjectgas * 1.0494811) / 1000
                                ELSE p.volinjectgas / 1000
                                 END AS injgas
                      FROM DS_PRODVIEW.PVT_pvunitallocmonthday p
                     INNER JOIN DS_PRODVIEW.PVT_pvunit u
                        ON p.idrecunit = u.idrec
                     WHERE p.dttm BETWEEN (
                            SELECT start_date
                              FROM dates
                           ) AND (
                            SELECT end_date
                              FROM dates
                           )
                   ), -- Sask gas volumes are done by a stored procedure and written to other measurement points for every well
            saskGasVolumes AS(
                    SELECT fd.balfactgas,
                           f.idrec AS idrecfacility,
                           fd.dttm
                      FROM DS_PRODVIEW.pvt_pvfacilitymonthdaycalc fd
                      JOIN DS_PRODVIEW.pvt_pvfacilitymonthcalc fm
                        ON fd.idrecparent = fm.idrec
                      JOIN DS_PRODVIEW.pvt_pvfacility f
                        ON fm.idrecparent = f.idrec
                   ),
                   saskFacilities AS (
                    SELECT DISTINCT f.idrec
                      FROM DS_PRODVIEW.PVT_pvfacility f
                     WHERE typ2 = '322'
                       AND typregulatory = 'Crude Oil Multiwell Proration Battery'
                   ),
                   ab_bc_volumes AS (
                    SELECT d.idrec ,
                           d.dttm AS production_date ,
                           d.idflownet ,
                           d.idrecunit ,
                           d.idrecparam ,
                           d.durop * 24 AS hours ,
                           d.durop * 24 AS hours_inj ,
                           d.volprodgathgas / 1000 AS gas ,
                           d.volnewprodallocoil AS oil ,
                           d.volnewprodallocwater AS water ,
                           NULL AS ngl ,
                           d.volnewprodalloccond AS cond ,
                           d.volinjectgas / 1000 AS inj_gas ,
                           d.volinjectwater AS inj_water
                      FROM DS_PRODVIEW.PVT_pvunitallocmonthday d
                      JOIN DS_PRODVIEW.PVT_pvunit u
                        ON d.idrecunit = u.idrec
                     WHERE upper(u.district) IN ('ALBERTA')
                       AND d.dttm BETWEEN (
                            SELECT start_date
                              FROM dates
                           ) AND (
                            SELECT end_date
                              FROM dates
                           )
                   ),
                   ab_bc_ngls AS (
                    SELECT p.idflownet ,
                           p.idrecunit ,
                           p.dttm AS production_date ,
                           sum(coalesce(p.volc1liq, 0)) AS methane ,
                           sum(coalesce(p.volc2liq, 0)) AS ethane ,
                           sum(coalesce(p.volc3liq, 0)) AS propane ,
                           sum(coalesce(p.volic4liq, 0) + coalesce(p.volnc4liq, 0)) AS butane ,
                           sum(coalesce(p.volc6liq, 0) + coalesce(p.volc7liq, 0)) AS pentane ,
                           sum(coalesce(p.volic5liq, 0) + coalesce(p.volnc5liq, 0)) AS field_condensate
                      FROM DS_PRODVIEW.PVT_pvunitdispmonthday p
                      JOIN DS_PRODVIEW.PVT_pvunit u
                        ON p.idrecunit = u.idrec
                      LEFT JOIN DS_PRODVIEW.PVT_pvunitnode n
                        ON p.idrecdispunitnode = n.idrec
                     WHERE lower(n.typdisphcliq) = 'ngl'
                       AND upper(u.district) IN ('ALBERTA', 'BRITISH COLUMBIA')
                       AND p.dttm BETWEEN (
                            SELECT start_date
                              FROM dates
                           ) AND (
                            SELECT end_date
                              FROM dates
                           )
                     GROUP BY p.idflownet ,
                              p.idrecunit ,
                              p.dttm
                   ) -- Main Query
            SELECT CAST(w.wellidregulatory AS varchar(50)) AS well_name,
                   d.dttm AS production_date,
                   CAST('D' AS varchar(1)) AS period_type,
                   CAST((d.durop * 24) AS float) AS hours,
                   CAST((d.durop * 24) AS float) AS hours_inj,
                   CAST(d.volnewprodallocoil AS float) AS oil,
                   CAST(CASE WHEN d.idrecfacility IN (saskFacilities.idrec) THEN saskGasVolumes.balfactgas * d.volprodgathgas / 1000 ELSE GasVolumes.gas END AS float) AS gas,
                   CAST(GasVolumes.injgas AS float) AS gas_inj,
                   CAST(NULL AS float) AS gas_cost,
                   CAST(d.volnewprodallocwater AS float) AS water,
                   CAST(d.volinjectwater AS float) AS water_inj,
                   CAST(NULL AS float) AS water_cost,
                   CAST(abbcvol.cond AS float) AS field_condensate,
                   CAST(abbcngl.ethane AS float) AS ethane,
                   CAST(NULL AS float) AS ethane_inj,
                   CAST(abbcngl.propane AS float) AS propane,
                   CAST(NULL AS float) AS propane_inj,
                   CAST(abbcngl.butane AS float) AS butane,
                   CAST(NULL AS float) AS butane_inj,
                   CAST(CASE WHEN abbcngl.production_date IS NOT NULL THEN abbcngl.field_condensate ELSE d.volnewprodalloccond END AS float) AS pentane_plus,
                   CAST(NULL AS float) AS pentane_plus_inj,
                   CAST(NULL AS float) AS sulphur,
                   CAST(NULL AS float) AS fluid,
                   CAST(CASE WHEN u.division = 'UNITED STATES' THEN d.volnewprodallocngl ELSE NULL END AS float) AS ngl,
                   CAST(NULL AS float) AS helium,
                   CAST(NULL AS float) AS helium_inj,
                   CAST(NULL AS float) AS helium_cost,
                   CAST(NULL AS float) AS carbon_dioxide,
                   CAST(NULL AS float) AS carbon_dioxide_inj,
                   CAST(NULL AS float) AS carbon_dioxide_cost,
                   CAST(NULL AS float) AS sand,
                   CAST(NULL AS float) AS sand_inj,
                   CAST(NULL AS float) AS steam_inj,
                   CAST(NULL AS float) AS polymer_inj,
                   CAST(NULL AS float) AS solvent_inj,
                   CAST(NULL AS float) AS alkali_inj,
                   CAST(NULL AS float) AS diluent_inj,
                   CAST(NULL AS float) AS diluent_cost,
                   CAST(p.preswh AS float) AS fwhp,
                   CAST(p.presbh AS float) AS fbhp,
                   CAST(p.prescas AS float) AS casing_pressure,
                   CAST(p.prestub AS float) AS tubing_pressure,
                   CAST(p.presline AS float) AS line_pressure,
                   CAST(NULL AS float) AS performance_index,
                   CAST(p.szchoke AS float) AS choke_size,
                   CAST(w.idrec AS varchar(32)) well_idrec,
                   CAST(d.idrec AS varchar(32)) day_idrec,
                   CAST(current_timestamp() AS timestamp_ntz) AS DSS_LOAD_DATE
              FROM DS_PRODVIEW.PVT_pvunitcomp AS w
             INNER JOIN DS_PRODVIEW.PVT_pvunitallocmonth m
                ON w.idrecparent = m.idrecparent
             INNER JOIN DS_PRODVIEW.PVT_pvunitallocmonthday d
                ON d.idrecparent = m.idrec
             INNER JOIN DS_PRODVIEW.PVT_pvunit u
                ON d.idrecunit = u.idrec
              LEFT JOIN DS_PRODVIEW.PVT_pvUnitCompParam p
                ON d.idrecparam = p.idrec
             INNER JOIN GasVolumes
                ON GasVolumes.idrec = d.idrec
              LEFT JOIN saskGasVolumes
                ON (saskGasVolumes.idrecfacility = d.idrecfacility AND saskGasVolumes.dttm = d.dttm)
              LEFT JOIN saskFacilities
                ON saskFacilities.idrec = d.idrecfacility
              LEFT OUTER JOIN ab_bc_volumes abbcvol
                ON abbcvol.idrecunit = d.idrecunit
               AND abbcvol.production_date = d.dttm
              LEFT OUTER JOIN ab_bc_ngls abbcngl
                ON abbcngl.idrecunit = d.idrecunit
               AND abbcngl.production_date = d.dttm
             WHERE d.dttm BETWEEN (
                    SELECT start_date
                      FROM dates
                   ) AND (
                    SELECT end_date
                      FROM dates
                   )
               AND w.wellidregulatory IS NOT NULL
        dependencies:
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITCOMP
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITCOMP') }}
        name: STAGE_PVIEW_MOSAIC_CDM_VOLS_ADHOC
        noLinkRefs: []
  name: STAGE_PVIEW_MOSAIC_CDM_VOLS_ADHOC
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
