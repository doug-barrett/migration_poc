fileVersion: 1
id: ec0320e9-65b9-439d-9db3-4a7bcecc5096
name: STAGE_PVIEW_MOSAIC_CDM_VOLS_ADHOC
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ddd82728-293c-40ca-9f78-d69632b5bab8
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: WELL_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7014a46b-a09f-4d32-ae9a-66b516c1d8d6
                stepCounter: b2609f15-a93c-4c5d-b86e-0898ad7558d0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b2f905f4-5d9c-4c96-8dcc-0afa2ca50ddf
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: PRODUCTION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f12a712-52a9-49bc-b9b3-9f6c776cada1
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05ba609b-530e-4354-8050-4d00364074b1
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PERIOD_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e274bf1e-600b-464a-8921-8dfba26fdcf7
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: HOURS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 565c3190-bc88-4ecf-8f99-070028fb908c
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 316e9eab-23f0-49dc-99d3-82a24f6fa413
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: HOURS_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 565c3190-bc88-4ecf-8f99-070028fb908c
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80344801-a24b-44df-a647-db471f7f51cc
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84c2e90c-25c5-4b2c-a586-411562b4131d
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 588e217c-f91b-4d3f-98af-b93177562ae2
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f342daf-352b-4bba-8d23-2cb8e4272900
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c282c7a3-fedd-4cb7-99fe-7f669907cf28
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: GAS_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90040229-c62c-42c9-bb07-2139dea4c0cc
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a4f5e6e-9d8a-465b-8361-e6318efbfbc4
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: GAS_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c369cb7-3640-4cdd-91ee-f6fa5c449d3b
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: WATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1a8bf3e0-4605-42d8-952d-e12b80f99266
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b02bb19f-c4c6-4853-a11a-418371f68aa8
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: WATER_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce8f6ae1-15cb-4bad-b309-5020a5336519
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf7e12af-863c-4459-a66d-abd86e1bf720
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: WATER_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6471e33e-76ea-4a34-8677-f4cd6c37a937
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: FIELD_CONDENSATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53c0b21f-6369-4522-916b-9846d9f3d548
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ETHANE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75852768-86d7-4395-993e-dbf845997bed
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ETHANE_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e25ef13b-d40d-4011-ac1b-130a89b5cd51
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PROPANE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9603411b-b58d-46eb-a721-cc2d0e74bcce
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PROPANE_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9177c138-5cf4-4f84-acf8-a3485a7c15b3
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: BUTANE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f3d8b9d6-8731-4b31-9e81-070b494585d9
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: BUTANE_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f4a3179-e41c-4302-bedf-5568d90beed2
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: PENTANE_PLUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ccd7cb6f-3240-43b7-8466-e1f54574e4db
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31f65f29-a2df-46f3-bcb2-92365e597a9d
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PENTANE_PLUS_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a566a35-82b5-434c-8fb2-36d783c03ee2
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SULPHUR
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc6b246b-52dc-477f-b20a-b0b2c9d8467b
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: FLUID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d07ea6c4-fd83-4eea-a1a6-540d878e89d2
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: NGL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 962ca092-8160-49e1-bd11-5560781451af
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c912cf7c-99d5-42d8-a5ae-8fb9d1fe776c
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: HELIUM
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4fa6f93-8a67-437d-a5ec-fb4a3a006f5d
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: HELIUM_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b3d24238-c130-447b-a7aa-553029729fdf
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: HELIUM_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a059b541-2614-442b-a9df-6d4ab8af323e
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CARBON_DIOXIDE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d1abb45-7143-4c78-b034-17b6ff72d48a
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CARBON_DIOXIDE_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4443aa08-87c7-4d8a-8d16-7c25231ec96d
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CARBON_DIOXIDE_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8bc35b52-5c1f-4cf0-b683-fc87d134e825
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SAND
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f684f969-0213-4b6e-9c25-5af105eff417
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SAND_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b955372-c509-4a2f-9322-04e6739b2226
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: STEAM_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 83a876cb-fb39-445d-8c54-a095e5968963
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: POLYMER_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1be3d4bc-b395-4408-9cff-26464e22ba90
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SOLVENT_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8cd09722-7648-4d98-be45-ef9e1d2d2f26
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ALKALI_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d1a01ca-f5db-4883-9d0f-92405714b608
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: DILUENT_INJ
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a914358-7574-495e-980b-dced35aab126
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: DILUENT_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 93bc68a9-b76c-4555-ba8f-75351b91b30c
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: FWHP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e454f3a-d3f2-4583-b2cd-40ab96ad3ba4
                stepCounter: 3c6f5981-3218-423d-b012-74039f0258fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 853f2a26-6012-4703-8fe8-ffeb91f47f33
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: FBHP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b422fb5-c41f-49aa-ace2-91de27ece643
                stepCounter: 3c6f5981-3218-423d-b012-74039f0258fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 047fb25d-2a22-4c72-a2f4-caf00f0d4466
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: CASING_PRESSURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f47f5cce-108b-472c-a43a-5bc2d2562aa3
                stepCounter: 3c6f5981-3218-423d-b012-74039f0258fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6be9c2f0-0543-4465-8537-73b40b075462
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: TUBING_PRESSURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c10af379-bdbe-42bc-b41b-1fb7bb49e843
                stepCounter: 3c6f5981-3218-423d-b012-74039f0258fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7e380e8-1de2-4afe-99e2-ac234f7610d3
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: LINE_PRESSURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce930dfe-6b7d-4b90-9462-803e255a4b1c
                stepCounter: 3c6f5981-3218-423d-b012-74039f0258fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba99d33f-cfa5-4c88-898b-93a4f1b182c8
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: PERFORMANCE_INDEX
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 60de9dba-43dc-48d8-b592-a5b35fd6b1da
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: CHOKE_SIZE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83ea1ca3-6335-41e7-a9ea-5d9d9f134217
                stepCounter: 3c6f5981-3218-423d-b012-74039f0258fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b07df824-cd71-43dd-8ade-044558be8fa3
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: WELL_IDREC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9cf6aa8f-2e96-43a3-8472-6ee102299445
                stepCounter: b2609f15-a93c-4c5d-b86e-0898ad7558d0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 300175cc-144b-4ec6-bbc9-be18247c529b
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: DAY_IDREC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc92edc5-4035-449f-9e9f-17200a6bda5f
                stepCounter: b78e68df-21f7-427c-9ce7-426d1d304567
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39b6e8d3-bf70-467a-9ac0-bd68d00688c7
          stepCounter: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_PVIEW_MOSAIC_CDM_VOLS_ADHOC: ec0320e9-65b9-439d-9db3-4a7bcecc5096
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE VIEW {{ ref_no_link('TARGET','STAGE_PVIEW_MOSAIC_CDM_VOLS_ADHOC') }} AS WITH -- date filter
            dates AS(
                    SELECT '2024-01-01' AS start_date,
                           '2025-01-31' AS end_date
                   ), --
            GasVolumes AS(
                    SELECT p.dttm,
                           p.idflownet,
                           p.volnewprodallocgas,
                           p.idrec,
                           CASE WHEN p.idflownet = '966E2E4C11274A8E88B00B7D5E37FA4A' THEN (p.volnewprodallocgas * 1.0494811) / 1000
                                WHEN p.idflownet = 'D31DB03FC64C4413B39FEBBED5004D42' THEN (p.volnewprodallocgas * 1.0494811) / 1000
                                WHEN p.idflownet = 'E6FCADB21222494393E582D914245BBF' THEN (p.volnewprodallocgas * 1.0494811) / 1000
                                WHEN p.idflownet = '13520ED8659449F38B5085DA7F464CDB' THEN (p.volnewprodallocgas * 1.0494811) / 1000
                                WHEN upper(u.district) IN ('ALBERTA')                 THEN p.volprodgathgas / 1000
                                ELSE p.volnewprodallocgas / 1000
                                 END AS gas,
                           CASE WHEN p.idflownet = '966E2E4C11274A8E88B00B7D5E37FA4A' THEN (p.volinjectgas * 1.0494811) / 1000
                                ELSE p.volinjectgas / 1000
                                 END AS injgas
                      FROM DS_PRODVIEW.PVT_pvunitallocmonthday p
                     INNER JOIN DS_PRODVIEW.PVT_pvunit u
                        ON p.idrecunit = u.idrec
                     WHERE p.dttm BETWEEN (
                            SELECT start_date
                              FROM dates
                           ) AND (
                            SELECT end_date
                              FROM dates
                           )
                   ), -- Sask gas volumes are done by a stored procedure and written to other measurement points for every well
            saskGasVolumes AS(
                    SELECT fd.balfactgas,
                           f.idrec AS idrecfacility,
                           fd.dttm
                      FROM DS_PRODVIEW.pvt_pvfacilitymonthdaycalc fd
                      JOIN DS_PRODVIEW.pvt_pvfacilitymonthcalc fm
                        ON fd.idrecparent = fm.idrec
                      JOIN DS_PRODVIEW.pvt_pvfacility f
                        ON fm.idrecparent = f.idrec
                   ),
                   saskFacilities AS (
                    SELECT DISTINCT f.idrec
                      FROM DS_PRODVIEW.PVT_pvfacility f
                     WHERE typ2 = '322'
                       AND typregulatory = 'Crude Oil Multiwell Proration Battery'
                   ),
                   ab_bc_volumes AS (
                    SELECT d.idrec ,
                           d.dttm AS production_date ,
                           d.idflownet ,
                           d.idrecunit ,
                           d.idrecparam ,
                           d.durop * 24 AS hours ,
                           d.durop * 24 AS hours_inj ,
                           d.volprodgathgas / 1000 AS gas ,
                           d.volnewprodallocoil AS oil ,
                           d.volnewprodallocwater AS water ,
                           NULL AS ngl ,
                           d.volnewprodalloccond AS cond ,
                           d.volinjectgas / 1000 AS inj_gas ,
                           d.volinjectwater AS inj_water
                      FROM DS_PRODVIEW.PVT_pvunitallocmonthday d
                      JOIN DS_PRODVIEW.PVT_pvunit u
                        ON d.idrecunit = u.idrec
                     WHERE upper(u.district) IN ('ALBERTA')
                       AND d.dttm BETWEEN (
                            SELECT start_date
                              FROM dates
                           ) AND (
                            SELECT end_date
                              FROM dates
                           )
                   ),
                   ab_bc_ngls AS (
                    SELECT p.idflownet ,
                           p.idrecunit ,
                           p.dttm AS production_date ,
                           sum(coalesce(p.volc1liq, 0)) AS methane ,
                           sum(coalesce(p.volc2liq, 0)) AS ethane ,
                           sum(coalesce(p.volc3liq, 0)) AS propane ,
                           sum(coalesce(p.volic4liq, 0) + coalesce(p.volnc4liq, 0)) AS butane ,
                           sum(coalesce(p.volc6liq, 0) + coalesce(p.volc7liq, 0)) AS pentane ,
                           sum(coalesce(p.volic5liq, 0) + coalesce(p.volnc5liq, 0)) AS field_condensate
                      FROM DS_PRODVIEW.PVT_pvunitdispmonthday p
                      JOIN DS_PRODVIEW.PVT_pvunit u
                        ON p.idrecunit = u.idrec
                      LEFT JOIN DS_PRODVIEW.PVT_pvunitnode n
                        ON p.idrecdispunitnode = n.idrec
                     WHERE lower(n.typdisphcliq) = 'ngl'
                       AND upper(u.district) IN ('ALBERTA', 'BRITISH COLUMBIA')
                       AND p.dttm BETWEEN (
                            SELECT start_date
                              FROM dates
                           ) AND (
                            SELECT end_date
                              FROM dates
                           )
                     GROUP BY p.idflownet ,
                              p.idrecunit ,
                              p.dttm
                   ) -- Main Query
            SELECT CAST(w.wellidregulatory AS varchar(50)) AS well_name,
                   d.dttm AS production_date,
                   CAST('D' AS varchar(1)) AS period_type,
                   CAST((d.durop * 24) AS float) AS hours,
                   CAST((d.durop * 24) AS float) AS hours_inj,
                   CAST(d.volnewprodallocoil AS float) AS oil,
                   CAST(CASE WHEN d.idrecfacility IN (saskFacilities.idrec) THEN saskGasVolumes.balfactgas * d.volprodgathgas / 1000 ELSE GasVolumes.gas END AS float) AS gas,
                   CAST(GasVolumes.injgas AS float) AS gas_inj,
                   CAST(NULL AS float) AS gas_cost,
                   CAST(d.volnewprodallocwater AS float) AS water,
                   CAST(d.volinjectwater AS float) AS water_inj,
                   CAST(NULL AS float) AS water_cost,
                   CAST(abbcvol.cond AS float) AS field_condensate,
                   CAST(abbcngl.ethane AS float) AS ethane,
                   CAST(NULL AS float) AS ethane_inj,
                   CAST(abbcngl.propane AS float) AS propane,
                   CAST(NULL AS float) AS propane_inj,
                   CAST(abbcngl.butane AS float) AS butane,
                   CAST(NULL AS float) AS butane_inj,
                   CAST(CASE WHEN abbcngl.production_date IS NOT NULL THEN abbcngl.field_condensate ELSE d.volnewprodalloccond END AS float) AS pentane_plus,
                   CAST(NULL AS float) AS pentane_plus_inj,
                   CAST(NULL AS float) AS sulphur,
                   CAST(NULL AS float) AS fluid,
                   CAST(CASE WHEN u.division = 'UNITED STATES' THEN d.volnewprodallocngl ELSE NULL END AS float) AS ngl,
                   CAST(NULL AS float) AS helium,
                   CAST(NULL AS float) AS helium_inj,
                   CAST(NULL AS float) AS helium_cost,
                   CAST(NULL AS float) AS carbon_dioxide,
                   CAST(NULL AS float) AS carbon_dioxide_inj,
                   CAST(NULL AS float) AS carbon_dioxide_cost,
                   CAST(NULL AS float) AS sand,
                   CAST(NULL AS float) AS sand_inj,
                   CAST(NULL AS float) AS steam_inj,
                   CAST(NULL AS float) AS polymer_inj,
                   CAST(NULL AS float) AS solvent_inj,
                   CAST(NULL AS float) AS alkali_inj,
                   CAST(NULL AS float) AS diluent_inj,
                   CAST(NULL AS float) AS diluent_cost,
                   CAST(p.preswh AS float) AS fwhp,
                   CAST(p.presbh AS float) AS fbhp,
                   CAST(p.prescas AS float) AS casing_pressure,
                   CAST(p.prestub AS float) AS tubing_pressure,
                   CAST(p.presline AS float) AS line_pressure,
                   CAST(NULL AS float) AS performance_index,
                   CAST(p.szchoke AS float) AS choke_size,
                   CAST(w.idrec AS varchar(32)) well_idrec,
                   CAST(d.idrec AS varchar(32)) day_idrec,
                   CAST(current_timestamp() AS timestamp_ntz) AS DSS_LOAD_DATE
              FROM DS_PRODVIEW.PVT_pvunitcomp AS w
             INNER JOIN DS_PRODVIEW.PVT_pvunitallocmonth m
                ON w.idrecparent = m.idrecparent
             INNER JOIN DS_PRODVIEW.PVT_pvunitallocmonthday d
                ON d.idrecparent = m.idrec
             INNER JOIN DS_PRODVIEW.PVT_pvunit u
                ON d.idrecunit = u.idrec
              LEFT JOIN DS_PRODVIEW.PVT_pvUnitCompParam p
                ON d.idrecparam = p.idrec
             INNER JOIN GasVolumes
                ON GasVolumes.idrec = d.idrec
              LEFT JOIN saskGasVolumes
                ON (saskGasVolumes.idrecfacility = d.idrecfacility AND saskGasVolumes.dttm = d.dttm)
              LEFT JOIN saskFacilities
                ON saskFacilities.idrec = d.idrecfacility
              LEFT OUTER JOIN ab_bc_volumes abbcvol
                ON abbcvol.idrecunit = d.idrecunit
               AND abbcvol.production_date = d.dttm
              LEFT OUTER JOIN ab_bc_ngls abbcngl
                ON abbcngl.idrecunit = d.idrecunit
               AND abbcngl.production_date = d.dttm
             WHERE d.dttm BETWEEN (
                    SELECT start_date
                      FROM dates
                   ) AND (
                    SELECT end_date
                      FROM dates
                   )
               AND w.wellidregulatory IS NOT NULL
        dependencies:
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITCOMP
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITCOMP') }}
        name: STAGE_PVIEW_MOSAIC_CDM_VOLS_ADHOC
        noLinkRefs: []
  name: STAGE_PVIEW_MOSAIC_CDM_VOLS_ADHOC
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
