fileVersion: 1
id: e28bca93-1397-437f-a308-5cf09f7db2b6
name: S_LKP_EXT_MCC_CODE_MROC_HISTORY
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DATAVAULT_BUSINESS_VAULT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22e36cb0-588b-4758-8fee-88f0aebfafd7
          stepCounter: e28bca93-1397-437f-a308-5cf09f7db2b6
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: ""
        name: HK_H_LKP_EXT_MCC_CODE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f855c40b-958d-4dcc-b289-04366cb00a6c
                stepCounter: 88636911-e1bf-4db6-ab32-c06a1e2d7061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f1d146ad-a25c-4fdf-a388-179974c973f2
          stepCounter: e28bca93-1397-437f-a308-5cf09f7db2b6
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: EXT_MCC_CDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03dee078-0ec3-4b77-b345-f1b0286272e1
                stepCounter: 88636911-e1bf-4db6-ab32-c06a1e2d7061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72eb414a-13e3-4823-919f-3204a179be57
          stepCounter: e28bca93-1397-437f-a308-5cf09f7db2b6
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: FILLER_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 88815ec7-ab23-4b1b-8778-f38f1ee64486
                stepCounter: 88636911-e1bf-4db6-ab32-c06a1e2d7061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e34e570e-fa79-465f-affa-6a9f7c332ac8
          stepCounter: e28bca93-1397-437f-a308-5cf09f7db2b6
        config: {}
        dataType: VARCHAR(60)
        defaultValue: ""
        description: ""
        name: EXT_MCC_DES_TXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: af76c346-e8e6-4b26-aab5-cb4155453319
                stepCounter: 88636911-e1bf-4db6-ab32-c06a1e2d7061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07dbd479-dd74-4a5b-8886-1a6f5cd68034
          stepCounter: e28bca93-1397-437f-a308-5cf09f7db2b6
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: DEL_STS_IND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e3ee2a1-050e-4945-9700-be0ca95aaf8e
                stepCounter: 88636911-e1bf-4db6-ab32-c06a1e2d7061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8bd13129-02f1-4d4c-a467-85db67caade9
          stepCounter: e28bca93-1397-437f-a308-5cf09f7db2b6
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: LST_UPD_DTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 625b91a9-ffe3-40cc-b6f9-3f758c559eea
                stepCounter: 88636911-e1bf-4db6-ab32-c06a1e2d7061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b8fbac6-7559-4f4a-a025-7ea6dc63184c
          stepCounter: e28bca93-1397-437f-a308-5cf09f7db2b6
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: LST_UPD_TME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83681f0d-55e2-49ef-a9c5-54116ea33cb2
                stepCounter: 88636911-e1bf-4db6-ab32-c06a1e2d7061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fdab2f0a-4cbb-4a66-9c0d-ee7684a0f75c
          stepCounter: e28bca93-1397-437f-a308-5cf09f7db2b6
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: LST_UPD_UID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8300c258-a15f-4136-9dc9-5a9b4a9bc724
                stepCounter: 88636911-e1bf-4db6-ab32-c06a1e2d7061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9c958df-2319-4d83-80de-add752a3204b
          stepCounter: e28bca93-1397-437f-a308-5cf09f7db2b6
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: LST_UPD_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0a7eec7c-58d9-41f1-8b87-58ea646a3240
                stepCounter: 88636911-e1bf-4db6-ab32-c06a1e2d7061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da185e2f-377b-4aeb-b38d-bff71875c53f
          stepCounter: e28bca93-1397-437f-a308-5cf09f7db2b6
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CREATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0e84cae9-1f86-471f-8b97-2aca13690da9
                stepCounter: 88636911-e1bf-4db6-ab32-c06a1e2d7061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15e59cb8-16fa-4574-bf2c-9819abb968a0
          stepCounter: e28bca93-1397-437f-a308-5cf09f7db2b6
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: CREATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 125da6ea-d20c-4197-916b-4431b906551e
                stepCounter: 88636911-e1bf-4db6-ab32-c06a1e2d7061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2c006a8-c70c-43b8-bc80-e0497e54a6e9
          stepCounter: e28bca93-1397-437f-a308-5cf09f7db2b6
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: UPDATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d69bc9f3-3c85-49b6-9529-74169151b44a
                stepCounter: 88636911-e1bf-4db6-ab32-c06a1e2d7061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad4dd054-44e7-42f3-b3cb-8381313629d2
          stepCounter: e28bca93-1397-437f-a308-5cf09f7db2b6
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: UPDATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 982dba83-d091-4147-be69-fd0a38f33315
                stepCounter: 88636911-e1bf-4db6-ab32-c06a1e2d7061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e351e17e-b11a-4d8d-a266-4b1f83595e65
          stepCounter: e28bca93-1397-437f-a308-5cf09f7db2b6
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: RUN_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb74ae5e-76b1-410c-a8ae-c5700f9a45e5
                stepCounter: 88636911-e1bf-4db6-ab32-c06a1e2d7061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: adcb9710-9497-46ab-9300-e5ec289935d3
          stepCounter: e28bca93-1397-437f-a308-5cf09f7db2b6
        config: {}
        dataType: TIMESTAMP_NTZ(3)
        defaultValue: ""
        description: ""
        name: FILE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ecd63b10-0e5b-4c10-a6b7-6da401919135
                stepCounter: 88636911-e1bf-4db6-ab32-c06a1e2d7061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f6eb0ed-18bb-4469-9694-42bfe2956f4a
          stepCounter: e28bca93-1397-437f-a308-5cf09f7db2b6
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: The changing hash
        name: DSS_CHANGE_HASH
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cda33804-86a8-40f5-aa79-43624f748232
                stepCounter: 88636911-e1bf-4db6-ab32-c06a1e2d7061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: efef5ea1-3f36-43ea-91f5-3fcec8fbee0e
          stepCounter: e28bca93-1397-437f-a308-5cf09f7db2b6
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Record source
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d24439b2-4808-42a3-bdc1-b8b839353fa4
                stepCounter: 88636911-e1bf-4db6-ab32-c06a1e2d7061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5af47478-36d1-4671-adbb-c6edc2a654ff
          stepCounter: e28bca93-1397-437f-a308-5cf09f7db2b6
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was loaded in the data vault
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ff730450-d2fc-4144-b6d1-544ab99c5037
                stepCounter: 88636911-e1bf-4db6-ab32-c06a1e2d7061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 539afed4-5036-4d2d-ad46-c5fef4a6630c
          stepCounter: e28bca93-1397-437f-a308-5cf09f7db2b6
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row started in the data vault
        isSystemStartDate: true
        name: DSS_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db54c5e1-90fe-43aa-a78d-12cff2076c58
                stepCounter: 88636911-e1bf-4db6-ab32-c06a1e2d7061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb73a03c-40a7-4396-87c5-dae3df8cdc52
          stepCounter: e28bca93-1397-437f-a308-5cf09f7db2b6
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: Version number of a business key in the data vault
        isSurrogateKey: true
        isSystemVersion: true
        name: DSS_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 46118f7f-17fc-4621-a31f-561ed44c810a
                stepCounter: 88636911-e1bf-4db6-ab32-c06a1e2d7061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d7e6570-e7e6-4b55-a7bf-6adef9c5d5c9
          stepCounter: e28bca93-1397-437f-a308-5cf09f7db2b6
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was inserted in the data vault
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e90d6a9-ffa0-45a1-a460-7732bac44c4d
                stepCounter: 88636911-e1bf-4db6-ab32-c06a1e2d7061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06b81254-a554-4467-9e4a-a31e5cd52f6a
          stepCounter: e28bca93-1397-437f-a308-5cf09f7db2b6
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: End date determined by the next Satellite change record dss_start_date
        isSystemEndDate: true
        name: DSS_END_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: LEAD(dss_start_date, 1, '9999-12-31') OVER(PARTITION BY hk_h_lkp_ext_mcc_code ORDER BY dss_start_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e33a696e-6afd-443b-bb91-b4ce845be0f4
          stepCounter: e28bca93-1397-437f-a308-5cf09f7db2b6
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: CurrentFlag 'N' unless next Satellite change record dss_start_date is null, indicating this is the most current record.
        isSurrogateKey: true
        isSystemCurrentFlag: true
        name: DSS_CURRENT_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN LEAD(dss_start_date, 1, NULL) OVER(PARTITION BY hk_h_lkp_ext_mcc_code ORDER BY dss_start_date) IS NULL THEN 'Y'
                          ELSE 'N'
                           END
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_LKP_EXT_MCC_CODE_MROC: 88636911-e1bf-4db6-ab32-c06a1e2d7061
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATAVAULT_RAW_VAULT
            nodeName: S_LKP_EXT_MCC_CODE_MROC
        join:
          joinCondition: FROM {{ ref('DATAVAULT_RAW_VAULT','S_LKP_EXT_MCC_CODE_MROC') }} s_lkp_ext_mcc_code_mroc
        name: S_LKP_EXT_MCC_CODE_MROC_HISTORY
        noLinkRefs: []
  name: S_LKP_EXT_MCC_CODE_MROC_HISTORY
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
