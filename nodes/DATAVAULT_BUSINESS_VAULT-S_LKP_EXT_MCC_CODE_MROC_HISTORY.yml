fileVersion: 1
id: 849adc01-f4c4-4465-a921-d9ed03a84089
name: S_LKP_EXT_MCC_CODE_MROC_HISTORY
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DATAVAULT_BUSINESS_VAULT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6497f5bf-dec5-4b1a-aa11-ed5503978be1
          stepCounter: 849adc01-f4c4-4465-a921-d9ed03a84089
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: ""
        name: HK_H_LKP_EXT_MCC_CODE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90d5b609-8068-4588-aa00-dc56c2e3979a
                stepCounter: 32bbcc38-644a-4540-807d-ecfb91a6e063
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77fd6952-ce4f-4c1b-af3e-66397ed06446
          stepCounter: 849adc01-f4c4-4465-a921-d9ed03a84089
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: EXT_MCC_CDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7b80dcf-bc3a-411f-84e7-3e2169c00511
                stepCounter: 32bbcc38-644a-4540-807d-ecfb91a6e063
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55fd5236-9121-431f-8cc7-a3c7b12e1209
          stepCounter: 849adc01-f4c4-4465-a921-d9ed03a84089
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: FILLER_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8de28637-67d9-4e31-afa6-8818c82e811c
                stepCounter: 32bbcc38-644a-4540-807d-ecfb91a6e063
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d00db69-bba3-4b11-bbf7-c75f747cd0b0
          stepCounter: 849adc01-f4c4-4465-a921-d9ed03a84089
        config: {}
        dataType: VARCHAR(60)
        defaultValue: ""
        description: ""
        name: EXT_MCC_DES_TXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 98acb263-db87-4b91-b419-89701af0017e
                stepCounter: 32bbcc38-644a-4540-807d-ecfb91a6e063
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7322b0e1-b508-40e6-8e2a-634cf99b6693
          stepCounter: 849adc01-f4c4-4465-a921-d9ed03a84089
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: DEL_STS_IND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b59a91d7-7719-47e6-b1fb-5e2530214818
                stepCounter: 32bbcc38-644a-4540-807d-ecfb91a6e063
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7377a1d6-7dea-480b-8abd-693f8e06f856
          stepCounter: 849adc01-f4c4-4465-a921-d9ed03a84089
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: LST_UPD_DTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 900c4b16-bf17-4e9a-96b6-d5e34105b1f9
                stepCounter: 32bbcc38-644a-4540-807d-ecfb91a6e063
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: caefd355-aac7-4a91-bfae-a424efac1c3b
          stepCounter: 849adc01-f4c4-4465-a921-d9ed03a84089
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: LST_UPD_TME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dff4dfe6-156f-4b03-abcf-73f1cee31381
                stepCounter: 32bbcc38-644a-4540-807d-ecfb91a6e063
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3eb650b4-fb7e-4fa7-8170-ef73e73b279b
          stepCounter: 849adc01-f4c4-4465-a921-d9ed03a84089
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: LST_UPD_UID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a8942702-52c7-43ba-b67b-ac5e93da7272
                stepCounter: 32bbcc38-644a-4540-807d-ecfb91a6e063
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4bafd399-b628-4ef2-943a-5cca5be9dc09
          stepCounter: 849adc01-f4c4-4465-a921-d9ed03a84089
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        name: LST_UPD_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb67d6e3-9cbe-4e56-ac1e-1afef8d0e8db
                stepCounter: 32bbcc38-644a-4540-807d-ecfb91a6e063
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 498e788c-5cc7-436b-814e-cc5f6dfc2144
          stepCounter: 849adc01-f4c4-4465-a921-d9ed03a84089
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CREATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 132f826c-ea64-4c38-bc65-55d9453847d7
                stepCounter: 32bbcc38-644a-4540-807d-ecfb91a6e063
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d388e1a0-3934-46d8-b719-0b1d45dfc691
          stepCounter: 849adc01-f4c4-4465-a921-d9ed03a84089
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: CREATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5cae8c8d-d459-475c-8c30-35b78dde2479
                stepCounter: 32bbcc38-644a-4540-807d-ecfb91a6e063
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7308a20-941e-454d-899e-12c772c6568c
          stepCounter: 849adc01-f4c4-4465-a921-d9ed03a84089
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: UPDATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aaee2fd5-ca9d-4ad0-9925-5288696ff45b
                stepCounter: 32bbcc38-644a-4540-807d-ecfb91a6e063
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5929221c-d7ae-45ab-8da6-e50b4145916f
          stepCounter: 849adc01-f4c4-4465-a921-d9ed03a84089
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: UPDATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 817a893d-0f9b-4c02-b640-a8e432a29f4e
                stepCounter: 32bbcc38-644a-4540-807d-ecfb91a6e063
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f278137-fc56-4ad5-a39d-e1aaff689afb
          stepCounter: 849adc01-f4c4-4465-a921-d9ed03a84089
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: RUN_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 527e74fe-2157-4237-822f-1750eb86b585
                stepCounter: 32bbcc38-644a-4540-807d-ecfb91a6e063
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 12ddf085-ce4b-4eed-b1a3-d1a8dd2ab23b
          stepCounter: 849adc01-f4c4-4465-a921-d9ed03a84089
        config: {}
        dataType: TIMESTAMP_NTZ(3)
        defaultValue: ""
        description: ""
        name: FILE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e006d93-f0ab-4a4b-b19a-ea21250ecd6f
                stepCounter: 32bbcc38-644a-4540-807d-ecfb91a6e063
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6807798-0b6e-4866-a2a6-93fd149e9fa4
          stepCounter: 849adc01-f4c4-4465-a921-d9ed03a84089
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: The changing hash
        name: DSS_CHANGE_HASH
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 17ad0296-701f-480e-bc3f-7d74f6b3ae61
                stepCounter: 32bbcc38-644a-4540-807d-ecfb91a6e063
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a4edf91d-9165-4965-ab7a-f4839a233601
          stepCounter: 849adc01-f4c4-4465-a921-d9ed03a84089
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Record source
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3713ca29-2424-4114-b73c-e6542cb4c3dd
                stepCounter: 32bbcc38-644a-4540-807d-ecfb91a6e063
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7bbd04f0-67ef-47b6-963e-493f67e7daab
          stepCounter: 849adc01-f4c4-4465-a921-d9ed03a84089
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was loaded in the data vault
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb583a3e-c9f2-46ae-809a-148ae43493c4
                stepCounter: 32bbcc38-644a-4540-807d-ecfb91a6e063
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab640050-05b5-424c-9e00-c8b24c3f88a4
          stepCounter: 849adc01-f4c4-4465-a921-d9ed03a84089
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row started in the data vault
        isSystemStartDate: true
        name: DSS_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 53808523-3067-42ae-98bb-2701f3952b7c
                stepCounter: 32bbcc38-644a-4540-807d-ecfb91a6e063
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 44ae4dd1-4af9-4275-9e8d-f7721fab9308
          stepCounter: 849adc01-f4c4-4465-a921-d9ed03a84089
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: Version number of a business key in the data vault
        isSurrogateKey: true
        isSystemVersion: true
        name: DSS_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f4a042e-8889-4a40-bdad-f021510921da
                stepCounter: 32bbcc38-644a-4540-807d-ecfb91a6e063
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8a815cc-1188-4c44-8455-38963ed3b17b
          stepCounter: 849adc01-f4c4-4465-a921-d9ed03a84089
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was inserted in the data vault
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec28dd99-2791-4794-b229-b63134d6ec27
                stepCounter: 32bbcc38-644a-4540-807d-ecfb91a6e063
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9bb6e368-6d5a-4e5c-9744-e04dbfefd5a5
          stepCounter: 849adc01-f4c4-4465-a921-d9ed03a84089
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: End date determined by the next Satellite change record dss_start_date
        isSystemEndDate: true
        name: DSS_END_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: LEAD(dss_start_date, 1, '9999-12-31') OVER(PARTITION BY hk_h_lkp_ext_mcc_code ORDER BY dss_start_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8cefd7d-6f81-447e-aa9b-58e16386d281
          stepCounter: 849adc01-f4c4-4465-a921-d9ed03a84089
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: CurrentFlag 'N' unless next Satellite change record dss_start_date is null, indicating this is the most current record.
        isSurrogateKey: true
        isSystemCurrentFlag: true
        name: DSS_CURRENT_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN LEAD(dss_start_date, 1, NULL) OVER(PARTITION BY hk_h_lkp_ext_mcc_code ORDER BY dss_start_date) IS NULL THEN 'Y'
                          ELSE 'N'
                           END
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_LKP_EXT_MCC_CODE_MROC: 32bbcc38-644a-4540-807d-ecfb91a6e063
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATAVAULT_RAW_VAULT
            nodeName: S_LKP_EXT_MCC_CODE_MROC
        join:
          joinCondition: FROM {{ ref('DATAVAULT_RAW_VAULT','S_LKP_EXT_MCC_CODE_MROC') }} s_lkp_ext_mcc_code_mroc
        name: S_LKP_EXT_MCC_CODE_MROC_HISTORY
        noLinkRefs: []
  name: S_LKP_EXT_MCC_CODE_MROC_HISTORY
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
