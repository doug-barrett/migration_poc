fileVersion: 1
id: bce68d83-6566-4bab-ba63-16cd402d1cdc
name: S_SHARED_SCHEDULE_THEATRE_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 012d8e4e-320a-43fa-93c5-5b93a773d2d7
          stepCounter: bce68d83-6566-4bab-ba63-16cd402d1cdc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SCHEDULE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 73522497-b3f9-4b96-9c59-36a707f27842
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8f1ea97-9fc0-4d5d-9a66-c0de41b9649f
          stepCounter: bce68d83-6566-4bab-ba63-16cd402d1cdc
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SESSION_INTO_THEATRE_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN schedule_theatre_status_code <> 'C' AND into_theatre_date IS NOT NULL THEN ROW_NUMBER() OVER (PARTITION BY (CASE WHEN schedule_theatre_status_code <> 'C' AND into_theatre_date IS NOT NULL THEN ds_shared_schedule.service_point_session_reference_no ELSE NULL END) ORDER BY IFNULL(into_theatre_date,start_date),schedule_reference_no)
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1d1d835-3615-452e-b19b-62eae57c7d17
          stepCounter: bce68d83-6566-4bab-ba63-16cd402d1cdc
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SESSION_INTO_THEATRE_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN schedule_theatre_status_code <> 'C' AND into_theatre_date IS NOT NULL THEN COUNT(1) OVER (PARTITION BY (CASE WHEN schedule_theatre_status_code <> 'C' AND into_theatre_date IS NOT NULL THEN ds_shared_schedule.service_point_session_reference_no ELSE NULL END))
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1da7ae1c-8e52-4fb0-bd0b-f9aaf77560eb
          stepCounter: bce68d83-6566-4bab-ba63-16cd402d1cdc
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SERVICE_POINT_SESSION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 214b6ebf-b7b0-4ccb-b57d-18e6974a5a10
                stepCounter: b8407cc3-ddea-4d32-b1e2-dd88d647282f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 584ace70-7cb4-489a-9ecf-a57c3d8d8612
          stepCounter: bce68d83-6566-4bab-ba63-16cd402d1cdc
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: INTO_THEATRE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94f1bef3-23d3-4719-9909-9fe059faed43
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3a40e9e-a661-4603-9b26-ee548a6c7980
          stepCounter: bce68d83-6566-4bab-ba63-16cd402d1cdc
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: VISIT_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cc35ef61-dc52-49a2-ad90-fd31dd905d53
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 99f0db2a-036b-4103-969b-7fc8f880226d
          stepCounter: bce68d83-6566-4bab-ba63-16cd402d1cdc
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: OUT_OF_THEATRE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d1cc7e49-03a1-4b1a-91e6-bcd20f4aff6e
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59f679c2-5f56-47e3-b564-0647fb947d45
          stepCounter: bce68d83-6566-4bab-ba63-16cd402d1cdc
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: INTO_POSTOP_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d1cc7e49-03a1-4b1a-91e6-bcd20f4aff6e
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f125aa74-647c-4df2-83d7-c923690f9eed
          stepCounter: bce68d83-6566-4bab-ba63-16cd402d1cdc
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: VISIT_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d6cdf7cd-bfe6-460c-90a7-a303cd644d98
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11c32c88-e571-4e86-b7c5-01b37a824185
          stepCounter: bce68d83-6566-4bab-ba63-16cd402d1cdc
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DS_SHARED_SCHEDULE: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_SHARED_SCHEDULE
        join:
          joinCondition: |-
            FROM {{ ref('TGT','DS_SHARED_SCHEDULE') }} ds_shared_schedule
              JOIN s_shared_schedule_theatre_service_point_05
                ON s_shared_schedule_theatre_service_point_05.service_point_session_reference_no = ds_shared_schedule.service_point_session_reference_no
        name: S_SHARED_SCHEDULE_THEATRE_10
        noLinkRefs: []
  name: S_SHARED_SCHEDULE_THEATRE_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
