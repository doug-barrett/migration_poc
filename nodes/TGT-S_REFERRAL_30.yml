fileVersion: 1
id: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
name: S_REFERRAL_30
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "add dimension keys to Referrals stage "
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: abecc889-5337-4651-b864-d54896832dd4
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8be08d2a-f48f-430b-ba5e-6e6cc85b02a7
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 749b8b41-6b5c-4e54-a739-4428b4b056fb
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: REFERRAL_REFERENCE_DUP_ROW_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ROW_NUMBER() OVER (PARTITION BY s_referral_20.referral_encounter_id ORDER BY update_date DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5fd7a3fb-1c31-4701-b5ba-49835d0f3b64
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: REFERRAL_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c7e3a92-bd4e-490f-a7ca-ea204897579e
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4cf7f920-9eb4-469a-b8bb-f6ffc08042e7
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_referral_30.referral_encounter_type_code=dim_encounter_type.encounter_type_code
        name: DIM_ENCOUNTER_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3ba8df3-db2e-40a1-97dc-d5ad6a5186a7
                stepCounter: 1d0ea6a1-9563-4fb3-a1fa-9d43dbdf296e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bcd87a0f-b078-4ccc-ba19-80b6b9db5494
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 86145f93-9de1-4bab-b1cf-e143fdbca06c
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3d1567a-6de2-4115-a351-00a201b01262
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: ""
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b49e1f2b-139f-44a4-a3df-6b0ac5db36c7
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e22d64c-7e19-47ba-adfb-b67da88828c6
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 985f0ba0-97cf-4152-a49b-7e86cb71409e
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 891d1d09-4c05-4de3-a980-16f596831a9e
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_referral_30.patient_reference_no=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9962a01b-5f3d-4c1a-b371-997edef38d0f
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 714276bb-87cf-487e-96bd-c860ab220e72
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: patient_age_at_referral_years
        name: PATIENT_AGE_AT_REFERRAL_YEARS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dfbda7bd-2fef-4389-a0a8-be675fc8d2f5
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8463d6fc-393a-42cb-bf79-afb5f271be4c
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_referral_30.patient_age_at_referral_years=dim_age_group.age_years
        name: DIM_AGE_GROUP_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18bfabd7-19aa-4de0-9ce7-aa560645bce6
                stepCounter: 3d5ba8a8-80ec-4848-b58a-d31b34cc53ed
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7cc0487-ec90-43e5-b81d-3bd76e717cf4
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: ""
        name: REFERRAL_SOURCE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4e913f4-2eab-43eb-aa5b-24c369a7fd03
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ace51f3a-b385-4b20-a194-c1644d88508d
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_referral_30.referral_source_reference_no=dim_referral_source.referral_source_reference_no  s_referral_30.referral_received_date=dim_referral_source.mapping_start_date
        name: DIM_REFERRAL_SOURCE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 63be2b19-1d62-4e88-a2f2-365b81323561
                stepCounter: 2323317c-3e56-4756-b64a-c4a6f700726f
            transform: IFNULL(dim_referral_source.dim_referral_source_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c48a1ed3-21d6-4762-9fe4-6c3a8826c1fd
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: ""
        name: REFERRAL_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3bf3e97b-5e98-499a-9d6e-5e53d71ddb9f
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d13008e7-d4df-41d3-bf82-6d90531a799c
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_referral_30.referral_reason_reference_no=dim_referral_reason.referral_reason_reference_no
        name: DIM_REFERRAL_REASON_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c6f2ca6-e06c-4225-843a-591b918387de
                stepCounter: 7bf3d7ae-af0c-470e-8c4b-a5fcd8c9ac80
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d734766d-31d7-4b1d-8874-77dc282a6881
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_referral_30.referral_type_reference_no=dim_referral_type.referral_type_reference_no
        name: DIM_REFERRAL_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d0f126d-5562-437d-94ef-c47b53cd8651
                stepCounter: 98967b6a-61a3-4c8e-b291-6447cdf2fc9d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b56e4a9e-826b-4dd6-8a0b-0a7bd84a4250
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: ""
        name: REFERRAL_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5a53ed1-fd33-47de-b535-6894a375581b
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66c6c80d-f644-4571-93b0-a7f1ed6e753e
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: ""
        name: REFERRAL_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33434d10-e2ad-4ef6-8f95-b87e9226bf7f
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 965b31e5-3a2e-4943-8bc8-3ec3e4d81332
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_referral_30.referral_status_reference_no=dim_referral_status.referral_status_reference_no
        name: DIM_REFERRAL_STATUS_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cbf9eb0b-72a2-412c-9b17-8ba0a4bce8d3
                stepCounter: 6abb18ca-79da-4f03-98d9-18dc0bf8c1a0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b28d8ad3-c598-4098-b520-8a849efaf0fd
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: ""
        name: REFERRAL_PRIORITY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 61e4a8d9-0aee-4661-907c-6f59800249fa
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e318e1b-5cf8-43fe-8e18-fa4f0c41cda1
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_referral_30.referral_priority_reference_no=dim_referral_priority.referral_priority_reference_no
        name: DIM_REFERRAL_PRIORITY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 34d187bf-d185-44da-9793-d9ac1f5431cf
                stepCounter: 5e1f8f70-be33-44f6-b184-dc9633dc9972
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b59d29f-d76a-4a1e-98d4-bfc6ba9ab2d2
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CLINICAL_PRIORITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 344b85db-d49c-4375-b314-8d94cfef1f7b
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3cfbdbb-ad36-4890-8980-f957387f7ba2
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: ""
        name: ADMIN_CATEGORY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83a8e125-cc81-4339-b116-d5fe1e4e9907
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 12625c8f-65d8-4b2c-a2c7-c3aac6c91518
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_referral_30.admin_category_reference_no=dim_referral_admin_category.referral_admin_category_reference_no
        name: DIM_REFERRAL_ADMIN_CATEGORY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f9189db2-db59-40ab-a260-5e8337c2edb1
                stepCounter: 1e654fd9-a300-44dc-9b7d-54f1bb0466f3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40d706c2-eee8-4996-8b8d-69d90394b555
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REFERRAL_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5845f9a6-80fe-4aac-8540-51d53b8641d7
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: IFNULL(s_referral_20.referral_received_date,s_referral_20.referral_sent_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a78dd8fc-9b08-4d13-bb97-7dd5d2e720c0
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_referral_30.CONVERT(date,IFNULL(referral_received_date,referral_sent_date))=dim_referral_start_date.referral_start_calendar_date
        name: DIM_REFERRAL_START_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2d33e84-a1d1-4e1d-929d-ea2dbc38bd45
                stepCounter: 2f7e3e9b-04d2-4f1f-a2ac-cdfebc303d87
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 488089d6-e291-4318-b5a8-11c51c99f6f3
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REFERRAL_SENT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ae711ea-a996-40a6-825d-d3ef2d58755e
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec0c56aa-b953-4319-aba2-91d6efe1ff6a
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_referral_30.CONVERT(date,s_referral_20.referral_sent_date)=dim_referral_sent_date.referral_sent_calendar_date
        name: DIM_REFERRAL_SENT_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5dca6702-22e5-4e8a-9be1-fe76bc48d781
                stepCounter: 68087ddf-e4cf-4517-81ed-f29ce2fa7933
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6442e987-03ac-4204-b444-c81ac50367fc
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REFERRAL_RECEIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5845f9a6-80fe-4aac-8540-51d53b8641d7
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98cd3450-120d-4cbd-828b-ce19fdd99d87
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_referral_30.CONVERT(date,s_referral_20.referral_received_date)=dim_referral_received_date.referral_received_calendar_date
        name: DIM_REFERRAL_RECEIVED_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc304ff6-e51c-4892-805b-bebeaaaf465a
                stepCounter: 2039d8f6-8e40-418e-99bd-5f6ef6cede8a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b0d6ff5-32d1-4798-9e80-333b9761de09
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_MAPPING_ROW_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f12a598a-24f9-4f11-a1ab-b0bd553f7b61
                stepCounter: 090f1f29-4f87-4d93-89c1-01a6eae4f309
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bbc36420-c1b0-42bd-be72-0b638c91e265
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: DEFAULT_PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2b7b6c0-39b5-44c7-b77b-ff0ba3ca4d3f
                stepCounter: 090f1f29-4f87-4d93-89c1-01a6eae4f309
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d02c66a-cc89-40ac-a82e-4df6bc18964a
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: DEFAULT_PURCHASE_UNIT_CODE_OVER_65
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 89bb83a1-8f4b-4380-89aa-716feb36e3a3
                stepCounter: 090f1f29-4f87-4d93-89c1-01a6eae4f309
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a5cf57f-b3a0-40aa-b3e6-17aa8719a60d
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: DEFAULT_RC_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09a45c2e-8337-4b8a-849a-b4826d89b260
                stepCounter: 090f1f29-4f87-4d93-89c1-01a6eae4f309
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d1d7a17-6e1a-4bb7-81d9-15e41e4a9170
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REFERRAL_EXPIRY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 13623a68-2df3-4518-8958-045d5af87ec2
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e030fa57-5511-4cec-ad94-043d37b4e0ba
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: ""
        name: REFERRAL_AUTHORISATION_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67f3515f-6884-4651-b12b-40b56274a134
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 536541ef-ec50-43e2-8b4e-52e52a1b234e
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_referral_30.referral_authorisation_reason_reference_no=dim_referral_authorisation_reason.referral_authorisation_reason_reference_no
        name: DIM_REFERRAL_AUTHORISATION_REASON_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f9504f32-3f9a-42c5-a592-d198b7193cf5
                stepCounter: 0d55fc59-ab07-41e1-b7b0-b0c62bd14573
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2165adea-904b-4e61-b04e-8a6cb95008ba
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REFERRAL_AUTHORISATION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f96ad60-2d2c-4137-a34e-798b00ef4671
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7376f89-f88a-440c-82a6-2f14bd9e73da
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: REFERRAL_AUTHORISATION_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de8995d5-ed02-4601-95ce-9f649c00a9de
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01942150-45b3-4ef3-bd94-7d7da05b6cc4
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_AUTHORISATION_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 42c48c89-881f-427d-b570-d7a1c9643df6
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a96f4bd-076a-4703-8ada-0fd9931c52af
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_referral_30.referral_authorisation_clinician_reference_no=dim_authorising_clinician.authorising_clinician_reference_no
        name: DIM_AUTHORISING_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9405ea88-cfc9-4dcf-9a50-b2bbbb9af10b
                stepCounter: 4cf81867-cfd2-4de1-bfe0-c9b2e0541c85
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 097c1fcc-5424-4d8a-866e-b78f2752aa81
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REFERRAL_CANCELLATION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 549bcb21-6acb-4f6a-9b3f-b3417ad683c2
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27aa6cf1-6d77-43eb-8e12-be2ff92ced80
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: ""
        name: REFERRAL_CANCELLATION_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f590384c-b5fb-442f-8de8-623e2f3080dc
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 995b9808-52fe-45f7-8f94-c195a607a24d
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_referral_30.referral_cancellation_reason_reference_no=dim_referral_cancellation_reason.referral_cancellation_reason_reference_no
        name: DIM_REFERRAL_CANCELLATION_REASON_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6b96139c-2f96-455d-bc1d-b2f24e27dd6e
                stepCounter: 48e16d54-8e0e-4ee8-bb63-e628dd3d381e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a31b87a-75c1-40ed-bbd3-9e9194239c98
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REFERRAL_COMPLETION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d04133e2-6417-4925-8e03-eed377790ce1
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c6b41e5-20b9-49be-b2a3-a639ce5fb000
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INT
        defaultValue: ""
        description: s_referral_30.CONVERT(date,referral_completion_date)=dim_completion_date.completion_calendar_date
        name: DIM_COMPLETION_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 675fb547-70f5-4820-9f87-291bf09115a9
                stepCounter: 332230a8-5cf0-4082-ba7e-a8d114370055
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec2d5b02-4dff-4ae1-bf6e-ee9efd4fa93e
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_COMPLETION_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2e657bb9-4387-4a36-82dd-2d1381875827
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c7874f2f-f103-4062-b30a-bbbbfc9d7966
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_referral_30.referral_completion_reason_reference_no=dim_referral_completion_reason.referral_completion_reason_reference_no
        name: DIM_REFERRAL_COMPLETION_REASON_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e70427b1-a228-4ebc-bb6e-4e0871ca120c
                stepCounter: 5869a5b8-7044-46bc-9fc6-67f49dfa30ae
            transform: IFNULL(dim_referral_completion_reason.dim_referral_completion_reason_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3435dc2-f324-4f4c-8219-3cbc2089aa0c
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_referral_30.referral_rejection_reason_reference_no=dim_referral_rejection_reason.referral_rejection_reason_reference_no
        name: DIM_REFERRAL_REJECTION_REASON_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72e24489-782c-4745-8c12-326e72b9369d
                stepCounter: 52c9080b-2e55-444f-acb0-48707f5ae676
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d38bebba-6733-4f86-9c98-c8411e197844
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: The reason a referral was rejected, if the status is rejected
        name: REFERRAL_REJECTION_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1fed5b8-eda5-4470-aa72-9182bf42bd3c
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 12cc83cd-2c9e-4fa7-8739-328cc40847b3
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: ""
        name: REFERRED_BY_HEALTH_ORG_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 890bf436-ecbf-45f9-b550-47fd9fbf26b3
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b46471c-899f-4ae9-b854-2861a4151b56
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_referral_30.referred_by_health_org_reference_no=dim_referred_by_health_organisation.referred_by_health_org_reference_no
        name: DIM_REFERRED_BY_HEALTH_ORG_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: beb99ba7-0c4d-4bff-958f-57559877510d
                stepCounter: 95af9a88-9499-464e-8de2-81c8f274a2b2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4828498f-aedd-4710-be7f-990cf2bbaca9
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: ""
        name: REFERRED_BY_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c99e7823-2f39-4aa9-b6bc-58a236af38da
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d04f23e7-239c-42b2-b53d-1c34bdce1a14
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_referral_30.referred_by_specialty_reference_no=dim_referred_by_specialty.referred_by_specialty_reference_no
        name: DIM_REFERRED_BY_SPECIALTY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5828d4e8-80d5-452a-9532-dff1103e8323
                stepCounter: e415e3de-b985-40b9-ba95-2461cc5e63b4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: adaa9326-5646-4a7b-bce1-3ee93dab2a0a
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: ""
        name: REFERRED_BY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f5d604a-8d56-4340-9a9c-381fe2e8aa82
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6328600-6115-4739-b64c-d0791bd717cf
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_referral_30.referred_by_clinician_reference_no=dim_referred_by_clinician.referred_by_clinician_reference_no
        name: DIM_REFERRED_BY_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec6fac2d-9811-4421-813d-4bbef0bd3633
                stepCounter: 55bf85fd-0c5f-4597-9cf2-3e705d58e31f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b5d6f3e5-bc2d-4f01-9aea-b7981ed693b2
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: ""
        name: REFERRED_TO_HEALTH_ORG_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 421bc21b-797e-4d5d-9f35-dcc29b1b2fb5
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c802925-ab71-4c52-9522-e2173e9032c0
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_referral_30.referred_to_health_org_reference_no=dim_referred_to_health_organisation.referred_to_health_org_reference_no
        name: DIM_REFERRED_TO_HEALTH_ORG_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b0a180b5-22ed-4536-abb5-9b73918d8992
                stepCounter: 33952fce-0767-40f8-bc81-532b802ba28a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42e7d2d5-f0d9-4fc1-9b7f-6722091c5298
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRED_TO_STAFF_TEAM_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f4aea4b-cf31-428a-82d1-a9a38d69aff3
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32badc9b-21b2-4074-82d2-06838ec5240a
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_referral_30.referred_to_staff_team_reference_no=dim_staff_team.staff_team_reference_no
        name: DIM_STAFF_TEAM_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2030fa3c-65c8-49cd-8e31-7d93c4d3069f
                stepCounter: c2c00be3-5ba0-4886-830e-19251a8bd04b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd82ddfa-d7e1-4abf-8450-28160cc86726
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: ""
        name: REFERRED_TO_WARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6b54e1b1-a805-4329-a7c1-d6cca9e22406
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5eee62bf-4084-4df4-9c2f-5ce877731607
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: referred_to_ward_code
        name: REFERRED_TO_WARD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7dd8f5e-7451-462c-9678-195d83cf38bb
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 466bd0c6-a1c5-4668-bde7-02023c245745
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_referral_30.referred_to_ward_reference_no=dim_referred_to_ward.referred_to_ward_reference_no
        name: DIM_REFERRED_TO_WARD_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3f24e162-10e8-46c0-ba3d-af69cf87887e
                stepCounter: ecf44ca8-5733-4353-9c7f-30f09d4c232e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 087f9935-cd11-4946-844a-7bcb22bd6026
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: ""
        name: REFERRED_TO_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cf75a3f8-4f42-4472-9fc7-380601f5f8da
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6280863f-7448-4bcd-85ba-c673495f2fee
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: referred_to_specialty_code
        name: REFERRED_TO_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2262f7c8-c5ce-45a0-ad67-30e3bea3f1a2
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb5e4967-2873-4c19-84d8-be1396883d59
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_referral_30.referral_reason_reference_no=dim_CADS_caseteam.referral_reason_reference_no  s_referral_30.referred_to_health_org_reference_no=dim_CADS_caseteam.health_organisation_reference_no
        name: DIM_CADS_CASETEAM_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e51e3fa-c4b6-4367-9a7e-6ce4b851c92e
                stepCounter: fe7cff02-6589-45da-b0ba-c9b9a647e46e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95d4e848-8cdf-4255-bdb3-5cc0a0b3d4c1
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_referral_30.referred_to_specialty_reference_no=dim_referred_to_specialty.referred_to_specialty_reference_no
        name: DIM_REFERRED_TO_SPECIALTY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce861156-c605-4141-85aa-6a68ce6fdf3e
                stepCounter: 8cbba75c-bfb6-4f40-8f3c-ad41dfe782e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f3b511b5-9c4e-4ce7-95b2-cc16342a8478
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: ""
        name: REFERRED_TO_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7e84ba0-e159-4983-ab27-c2851cf14a08
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8cf693c0-a59b-4a53-ace9-adb26b64c6fe
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: referred_to_clinician_code
        name: REFERRED_TO_CLINICIAN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e6d6d38f-ff06-47c2-a6b1-eaa0315f5af9
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db0f9bd4-8499-416e-a9a8-38667ddb8ac4
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_referral_30.referred_to_clinician_reference_no=dim_referred_to_clinician.referred_to_clinician_reference_no
        name: DIM_REFERRED_TO_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67355985-4b51-4704-b62f-9c4bd6e8f701
                stepCounter: 29481079-6a75-49a5-90b6-5a62a9091370
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88887533-5cc7-4de2-b0be-1c0e61d42171
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PREV_REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f4e0c3de-c572-4940-8e3c-a7fab218968a
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: "'R'+CONVERT(varchar,s_referral_20.prev_referral_reference_no)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b0bd448-d31f-42a1-b6f4-52ab2c6b99e5
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREV_REFERRAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f4e0c3de-c572-4940-8e3c-a7fab218968a
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66c944cc-1c47-414c-ab98-e5beb7f13c82
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREV_REFERRED_TO_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5cb741b9-7147-4fce-81e8-aa7e472b058e
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a33bda21-eb51-4b95-ae6a-d65ea3c8119b
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PREV_REFERRED_TO_CLINICIAN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddd3d628-ee44-4873-ad85-9b45ada8eac7
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1710f46c-867a-40b8-a9e9-54e142a331ea
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NEXT_REFERRAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c696c57b-e6d2-4456-acd7-3a6bf1a69353
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a5f4398-4837-4742-96e5-bdc155ec4c2c
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NEXT_REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c696c57b-e6d2-4456-acd7-3a6bf1a69353
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: "'R'+CONVERT(varchar,s_referral_20.next_referral_reference_no)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9bdf63cf-57ae-4e34-9746-34bc5b0c0daa
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NEXT_REFERRED_TO_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d1de17c9-525f-454e-9fc4-2f9870d22e1f
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 737e5cb7-89b2-418e-8d2a-11564d4410d0
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NEXT_REFERRED_TO_CLINICIAN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6544aefc-d708-4111-89cd-9fb3e2f0dccb
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b50678c-59b9-4820-bfd7-5c6103455339
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PRINCIPAL_DIAGNOSIS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 10ff5392-c833-4d3c-991d-c88984c4012f
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86059284-421c-4c09-aad8-d328f8b3add1
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRINCIPAL_DIAGNOSIS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 457c55ce-3c70-4f9f-a2e1-551caa0453e4
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7ebe3c9-b1ec-46bf-adc9-d7602b2b2360
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_referral_30.principal_diagnosis_code=dim_principal_diagnosis.principal_diagnosis_code
        name: DIM_PRINCIPAL_DIAGNOSIS_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1a7261f-2942-445d-88b4-fe34e5a3929f
                stepCounter: 6a64703e-9924-4948-986a-0578fe6b91b7
            transform: IFNULL(dim_principal_diagnosis.dim_principal_diagnosis_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 493b3888-ca02-4c7e-ad66-c1d7b3067fca
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRIMARY_PROCEDURE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d96d02ed-76d9-432a-b85e-9c3fcdf4d95d
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4fa6d3f4-a95b-49fe-a1e5-a1a4ba010a94
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PRIMARY_PROCEDURE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d9eb27d9-a691-48dd-8832-fb5365f7b4aa
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2779d94d-7ce0-4f2a-a091-aa9e0bc20030
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACCIDENT_RELATED_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4938336-f4f3-4522-8302-432cf238f7be
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a12a39f1-cf26-46fe-8fea-219144f5a373
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_referral_30.accident_related_status_reference_no=dim_accident_related_status.accident_related_status_reference_no
        name: DIM_ACCIDENT_RELATED_STATUS_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d44a5efa-28c6-40a2-8449-d6c02f80b06e
                stepCounter: 14b2c337-f5d5-41f1-b697-4f53048b3627
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4f2c321-7118-4331-971f-1971c9460763
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACCIDENT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 96dc9104-cfed-46b8-8733-37c1f98d2cb5
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0bbaa45-b3c2-4929-ba48-05e63ca831eb
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_referral_30.accident_type_reference_no=dim_accident_type.accident_type_reference_no
        name: DIM_ACCIDENT_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d4f7ca3e-07bf-49bd-94f0-2de9c45f7139
                stepCounter: 11887a8a-0978-4774-9b71-5ad5ef30ae3e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9fed5478-80b4-4c8e-9373-505c6fb778e5
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACC_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e4ab9a04-234a-42e9-b5ac-d69915bd7e45
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 65cdc50b-5db1-41f1-93fe-5373e68b886d
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_referral_30.ACC_status_reference_no=dim_ACC_status.ACC_status_reference_no
        name: DIM_ACC_STATUS_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00cabaf7-26e1-466e-99e7-81411ecc051b
                stepCounter: ffd96bb3-9588-4000-8042-74fc56ae5537
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed04b80c-83bd-4adf-8567-3a806f873b1b
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ACC_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c86a3bc-54e1-4a8d-b4ec-4e8b6360adf0
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d47fa0d6-a0ff-443c-8cbd-0176385dc9c0
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ACC_NO_REPORTED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 14cbcc75-e81c-46dc-b7d6-d6c9a0656ee6
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b932ee19-3f13-40da-bcee-39868ad873cf
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ACC_VALID_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d6ecb860-e234-4141-8e7b-7679d7c1771f
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d75a586b-f295-46c3-9e69-4c8acde58e79
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ACC_CLAIM_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 081fab55-261f-4f1c-a7c2-dbd80017a30d
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d96873c-c229-4f2b-b1fa-08879f402515
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACC_INDICATORS_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 71477798-529b-4cf1-94ef-c62916248597
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75e49c4a-c1c8-4ff3-8f9d-21128c0c4b8f
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_referral_30.ACC_indicators_id=dim_referral_ACC_indicator.ACC_indicators_id
        name: DIM_REFERRAL_ACC_INDICATOR_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 63c3d63a-7dfa-42d6-87df-f5770df26df0
                stepCounter: fabaa6b0-7a9d-4c78-8fcf-156e7cc52485
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98a1acb0-ebfb-466a-ae0a-41c581b85fa8
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ACC45
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a147ca47-4611-4784-bbb4-5046f8f25bc4
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d47ca756-0be7-481f-846c-47df4ac13ac6
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: INJURY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e0a66afc-d947-4388-9096-28b423029303
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: adb9f75c-a1ac-4aee-b7fb-399a107d7f06
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DISABILITY_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d55498e0-0f89-45da-96f0-dd7d6ac97b92
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2215fa75-f7c0-47df-9294-5da4be5b56dd
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_referral_30.disability_type_reference_no=dim_disability_type.disability_type_reference_no
        name: DIM_DISABILITY_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bd5cf353-4141-41ac-834d-f69ab6f59426
                stepCounter: a2987c0b-caa4-41b2-9cea-2f7966ff11ed
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2315b9f6-0227-4205-8a8d-baa3b352b6b4
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: COURT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7eac172f-c288-4d56-993b-80b3597e2094
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 473f4048-b395-4a53-aedd-3528f6820ae2
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INT
        defaultValue: ""
        description: s_referral_30.court_reference_no=dim_MOJ_court.MOJ_court_reference_no
        name: DIM_MOJ_COURT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f16947b1-f2b9-4357-98c8-78f7c4998f80
                stepCounter: d4845386-d0fa-4d68-9241-a00d549edee7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb0d4ff7-1717-4eb9-8498-8819f4c6d64d
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRISON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03168649-7063-49bd-822c-3ab0d62721dc
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d08aaee8-bb10-4d85-a951-07f6c5fa55a0
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_referral_30.prison_reference_no=dim_prison.prison_reference_no
        name: DIM_PRISON_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8842bf0f-cd78-442c-9016-c8844cda7b63
                stepCounter: 14906556-6606-417e-8241-414d5bd76bae
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55709ebe-acca-4e45-a91e-b2698ad79d26
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRISON_LOCATION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 61256aa4-7c09-4010-bd6d-d01b77e20490
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 502b7855-3ea3-4d74-9cf0-5e0b13d054c9
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_referral_30.prison_location_reference_no=dim_prison_location.prison_location_reference_no
        name: DIM_PRISON_LOCATION_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 86a9a7ff-ba72-4996-ae6e-d13df4b88518
                stepCounter: 7f29a494-3650-4b65-af7e-508d8d0fc4ae
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3bab2769-58f6-43d1-8381-c643c95b3408
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Temporary LDDI transfer out Org for WDHB
        name: TRANSFER_OUT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c5254dd-7be2-418e-9319-e00c186d13bf
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2e82cf5-ea61-4cf6-84ae-b50d5d1928c3
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PARENT_REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 04c2d89f-c10b-42cf-9aa9-990b42d23db4
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: "'R'+CONVERT(varchar,s_referral_20.parent_referral_reference_no)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a177e80b-dc0e-491f-99a4-3d2bb5d76977
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PARENT_REFERRAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 04c2d89f-c10b-42cf-9aa9-990b42d23db4
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: afdf5271-326b-4e60-a20e-b295672768a2
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PARENT_REFERRAL_RECEIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23d31bf6-49bd-49f2-9f97-c3cb568082a4
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5d5772f-7b14-4f94-82c0-819df71ba40a
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PARENT_REFERRED_TO_WARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 36184bd5-f1a9-46db-9b9c-7060ceb5c453
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1cbe694c-a476-4424-a35c-846d003ae1aa
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PARENT_REFERRED_TO_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8a9c7a1-5465-4eba-a96e-8a59c5de5bcd
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3cad5bdd-cd3c-418a-96c9-a073ceba7485
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PARENT_REFERRED_TO_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2548f5b7-5937-44b9-a0bb-8253bd8bd124
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6b0837f-ef72-498c-bc60-62e700485353
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: patient_referral_seq_num
        name: PATIENT_REFERRAL_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d7063785-0aeb-4d08-9a49-b342a1ab38f6
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8a8af48-35a3-4dfa-9d53-7ff8e9244bc5
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: patient_referral_count
        name: PATIENT_REFERRAL_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cf587b3f-e625-4d47-b4e4-a1a4309b7ec5
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce4c14e0-8ec2-44b9-b0a0-b02c1fbc6362
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Waitlists associated with this referral
        name: REFERRAL_WAITLIST_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d206b89c-1560-4192-bfe8-1bc559c2a187
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71a5ec58-327f-4432-9cb1-d0e982d66668
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Emergency attendances associated with this referral
        name: REFERRAL_AE_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b63854c-2e32-41f1-ba1d-35e0b70d2edb
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3994fbad-b5b7-4b7a-9255-660eb5a54fc6
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Admissions associated with this referral
        name: REFERRAL_ADMISSION_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d26bbca5-afc4-475f-a8b2-9179e9ccdd65
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1fa22733-e18a-4dc3-96fb-ed422816d5cb
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Appointment (theatre/contacts/outpatients) associated with this referral
        name: REFERRAL_APPOINTMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07b84807-9f9d-4856-907e-e4a6423d9be9
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d64896a8-bcb1-4ec7-94b1-4aebad0d7230
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Excluded wailtists associated with this referral
        name: NPF_EXCLUDED_WAITLIST_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 13119132-6cd0-49b5-a802-701c2b6f5ee9
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b49d9e11-205d-46e6-ab2a-5b2db651381b
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Suspension wailtists associated with this referral
        name: NPF_SUSPENSION_EXCEPTION_WAITLIST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f6b04b8c-5270-4a92-a127-86e6ad9f93ed
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c868b366-5db0-4925-95b0-71573a4e6c35
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: CANCER_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4479eb4f-51c9-432a-9e27-50512f3beff2
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09c0fde6-f44b-4d93-9177-a259a5faa3da
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ELECTIVE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 178faeaf-6619-4796-9a30-51659d2b417a
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ed103c1-23d1-4301-9b98-ba437de37d0f
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ESPI1_ELIGIBLE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 28c15257-1d1b-4f49-b54b-4c31414175e8
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e90e972c-9678-4a2c-8427-5cc29e9b9ae0
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ESPI1_REJECTED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d80eb589-fdcc-406b-b968-d7a8987a802a
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2c8f0ae-dead-4159-ac68-e8d3f0b44c9d
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ESPI1_ACCEPTED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e8c2e2ea-f729-43bb-9798-878f22a22d59
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 44e123ec-c7bd-4ff1-9a94-7e9e599832c4
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ESPI1_AUTHORISED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bbd4d65b-fd45-479f-9a1f-1c56bed12fb1
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8b1236b-a2e0-4c88-88c1-352a0dbce8d6
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Is the referral accepted or rejected within the ESPI 1 time frame
        name: ESPI1_PROCESSED_IN_TIME_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN IFNULL(s_referral_20.referral_received_date,s_referral_20.referral_sent_date) < '01-Jul-2016' AND s_referral_20.ESPI1_wait_time_duration <= 10                THEN 'Y'
                          WHEN IFNULL(s_referral_20.referral_received_date,s_referral_20.referral_sent_date) >= '01-Jul-2016' AND s_referral_20.ESPI1_wait_time_duration_calendar_days <= 15 THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 625e3b98-74a2-4fd4-8cc9-fe3297ae5946
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: VARCHAR(31)
        defaultValue: ""
        description: Is the referral accepted or rejected within the ESPI 1 time frame
        name: ESPI1_RULE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN IFNULL(s_referral_20.referral_received_date,s_referral_20.referral_sent_date) < '01-Jul-2016'  THEN '10 Working Days'
                          WHEN IFNULL(s_referral_20.referral_received_date,s_referral_20.referral_sent_date) >= '01-Jul-2016' THEN '15 Calendar days'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 800e0a50-c76f-46cb-84ee-24d4362c944e
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ESPI1_WAIT_TIME_DURATION_CALENDAR_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 62ec6ce2-db85-43db-9377-a964b10ee85d
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6fad8cc7-e326-47ae-94c1-e2ba0093fbfb
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ESPI1_WAIT_TIME_DURATION_WORKING_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7592f0ae-197a-4f76-a2bc-c71d183e9e16
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be4f5ec7-41a9-4727-a0f0-772bb8a5c628
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ESPI1_WAIT_TIME_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7592f0ae-197a-4f76-a2bc-c71d183e9e16
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: |-
              CASE WHEN IFNULL(s_referral_20.referral_received_date,s_referral_20.referral_sent_date) < '01-Jul-2016'  THEN s_referral_20.ESPI1_wait_time_duration
                          WHEN IFNULL(s_referral_20.referral_received_date,s_referral_20.referral_sent_date) >= '01-Jul-2016' THEN s_referral_20.ESPI1_wait_time_duration_calendar_days
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc707b1d-e385-4878-b9f1-d2772f8c0fb3
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: duration_unit
        name: DURATION_UNIT
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: "'minute'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81b50ef1-2110-416a-af26-5c160664e883
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: NPF_PRESENTING_REFERRAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f017e9b0-c41a-4580-9277-281fe23ac0b9
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3f54f62-0334-4fc5-b754-c7888d4589b8
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: NPF_REJECTED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 472e507b-7c1c-4564-8e82-d3ae58ed8873
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f31ac487-4a9d-492a-b9a7-f3cb66989404
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: If an NPF referral is rejected it might be because the patient has opted not to be treated or the referral was mistakenly created.  These reason mean the referral is handled as an exception.
        name: NPF_EXCEPTION_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 472e507b-7c1c-4564-8e82-d3ae58ed8873
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: |-
              CASE WHEN NPF_rejected_flag = 'Y' AND dim_referral_rejection_reason.exception_outcome_code IS NOT NULL THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a4f919f-4bc6-4cf3-a8f4-22aad80fdf62
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: National Patient Flow processing indicator for NPF referrals closed with no activity
        name: NPF_CLOSED_NO_ACTIVITY
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN s_referral_20.NPF_presenting_referral = 'Y' AND (s_referral_20.referral_admission_count + s_referral_20.referral_AE_count + s_referral_20.referral_appointment_count + s_referral_20.referral_waitlist_count) = 0 THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 99d23768-0752-48f0-9889-4a766b8ea768
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: NPF ESPI 1 is measured on the date that the patient is notified.  The best proxy for this is the waitlist create date.
        name: NPF_ACKNOWLEDGEMENT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09f6305b-245d-4f43-b8be-4b734cb5c64a
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: |-
              CASE WHEN s_referral_20.referral_completion_date IS NOT NULL THEN IFNULL(s_referral_20.NPF_acknowledgement_date,s_referral_20.modify_date)
                          ELSE s_referral_20.NPF_acknowledgement_date
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d431f33-c98b-4ae5-94a9-b2e3d328dbb7
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Referrals with outpatient activity and no waitlists have this flag set to Y
        name: NPF_FOLLOW_UP_REFERRAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 697a76f1-cab4-4dd2-bf70-4f333eb280a4
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 543bf10b-9a5f-4a7c-b738-f3119ff16a9d
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Referrals no activity that are closed as transfered to another DHB have this flag set to Y
        name: NPF_TRANSFER
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN NPF_suspension_exception_waitlist = 0 AND referral_waitlist_count = 0 AND referral_appointment_count =0 AND referral_admission_count = 0 AND dim_referral_completion_reason.transfer_to_organisation_code IS NOT NULL AND NPF_presenting_referral = 'Y' THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c993a07-0350-42ff-ac1b-28dc2ba9f4c1
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b094d64-9cfd-4ef0-a810-2179ef206a38
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c27f03c-b585-48e4-b7b2-462073ea231d
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Clinician notes for the encounter.
        name: DISCHARGE_COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4be488c2-449b-418b-9158-ab1dce62f99b
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 653afcb7-e153-4600-b73a-eb97afe5e90c
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2dd9aff-24af-495a-814d-a7493c6ef9b7
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 822fd08c-3144-47aa-b148-0f8d76e01f13
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2fd31d7-4418-4f00-8989-9e9b352b65e4
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 103ae84a-aea9-4474-9afa-bf8665c8280c
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_referral_30.create_user_login_code=dim_create_user_login.create_user_login_code
        name: DIM_CREATE_USER_LOGIN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2dfe5e14-cc2f-4748-8352-a6d1621289af
                stepCounter: 70bd6ed5-e21b-440f-9079-7fe305bc4f30
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f289ccf-2be9-4071-af2d-fbaf62b54965
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIFY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db0265ba-adfb-4b39-95b6-b3023d3af1c2
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1cef60c-b1e0-42ad-8da0-709d591d46e9
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MODIFY_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1a5ceae7-a82f-4440-919a-8189bfe18daf
                stepCounter: 3f2053e5-a3d3-4a83-b312-9023276e13e7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed888b86-e63a-4dec-8fd9-d93329e94dd7
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_referral_30.modify_user_login_code=dim_modify_user_login.modify_user_login_code
        name: DIM_MODIFY_USER_LOGIN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ceaa34a6-dd0b-40fb-bc61-9df93cc05e7b
                stepCounter: bef0768d-dddb-4d02-af8d-03160de42b62
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee244599-1712-403d-b55b-a6796b9fdf84
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_referral_30.modify_user_login_code=dim_modify_user_login.modify_user_login_code
        name: REFERRAL_COUNT
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: '1'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70529502-3313-4520-9ddc-132dafe4d945
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: ACCCOMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 198f1bde-480f-459e-b63a-9c295e114f94
                stepCounter: a0666e75-2789-4493-a03d-93ff0b03a77e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d34b6972-4486-493f-952a-201f145f2425
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DATE_OF_CHANGE_FOR_CLAIM_LODGED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 46faf918-8e34-46de-bee2-630cd4892cc0
                stepCounter: 1e8759af-caab-4090-8fd9-97842a66b8e2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45ca43c3-efb8-4d45-aafc-b7e9b30f9aab
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: INJURYFLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b93cbd9-468a-4805-badc-0fd29ed461dd
                stepCounter: 2f91829c-b828-46dc-82a0-c18346ec81cf
            transform: |-
              CASE WHEN s_referral_Injury_Flag_v.description = 'Yes' THEN 'Y'
                          WHEN s_referral_Injury_Flag_v.description = 'No'  THEN 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 62de82d1-8d23-4c6f-a286-548c62351b85
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Populated when the MH referral was created for a team that replaces old teams that have been merged.
        name: MH_LINKED_REFERRAL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a027db66-87ce-4858-ae9f-b31f3ca2d12b
                stepCounter: d5a5d64a-e36a-4475-9bb8-b144e98abdc5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0bf52bfb-0509-458b-a489-ece80e015851
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Start date of the referral that was closed when MH teams were merged.
        name: MH_LINKED_REFERRAL_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c493c29-7616-446c-bcea-7e26d65f2abb
                stepCounter: d5a5d64a-e36a-4475-9bb8-b144e98abdc5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f597671c-e3bb-4644-a521-5ba165042d24
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DSS_DATA_QUALITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN s_referral_20.referral_sent_date > s_referral_20.referral_received_date OR s_referral_20.referral_received_date > COALESCE(s_referral_20.referral_completion_date,s_referral_20.referral_cancelled_date,s_referral_20.referral_expiry_date) THEN 'DT'
                          WHEN s_referral_20.patient_reference_no IS NULL AND s_referral_20.referral_sent_date > s_referral_20.referral_received_date                                                                                                                      THEN 'PATNT,DT'
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2d18344-d367-430c-abcf-af0f1ed52729
          stepCounter: aa6c1fa0-9008-489c-820a-ff5a35a3d0cb
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_ACCCOMMENTS_V: a0666e75-2789-4493-a03d-93ff0b03a77e
          S_REFERRAL_INJURY_FLAG_V: 2f91829c-b828-46dc-82a0-c18346ec81cf
          L_MAPPINGS_PURCHASEUNIT_IPM_REFERRALS: 090f1f29-4f87-4d93-89c1-01a6eae4f309
          DIM_PRINCIPAL_DIAGNOSIS: 6a64703e-9924-4948-986a-0578fe6b91b7
          DIM_REFERRAL_SOURCE: 2323317c-3e56-4756-b64a-c4a6f700726f
          DIM_REFERRAL_COMPLETION_REASON: 5869a5b8-7044-46bc-9fc6-67f49dfa30ae
          S_REFERRAL_22: d5a5d64a-e36a-4475-9bb8-b144e98abdc5
          S_REFERRAL_AUDIT_ACC_CLAIM: 1e8759af-caab-4090-8fd9-97842a66b8e2
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_REFERRAL_20
          - locationName: TGT
            nodeName: S_ACCCOMMENTS_V
          - locationName: TGT
            nodeName: S_REFERRAL_INJURY_FLAG_V
          - locationName: TGT
            nodeName: L_MAPPINGS_PURCHASEUNIT_IPM_REFERRALS
          - locationName: TGT
            nodeName: DIM_PRINCIPAL_DIAGNOSIS
          - locationName: TGT
            nodeName: DIM_REFERRAL_SOURCE
          - locationName: TGT
            nodeName: DIM_REFERRAL_COMPLETION_REASON
          - locationName: TGT
            nodeName: S_REFERRAL_22
          - locationName: TGT
            nodeName: S_REFERRAL_AUDIT_ACC_CLAIM
        join:
          joinCondition: |-
            FROM s_referral_20
              LEFT OUTER JOIN {{ ref('TGT','S_ACCCOMMENTS_V') }}
                ON s_referral_20.referral_reference_no = s_ACCComments_v.referral_reference_no
              LEFT OUTER JOIN {{ ref('TGT','S_REFERRAL_INJURY_FLAG_V') }}
                ON s_referral_20.referral_reference_no = s_referral_Injury_Flag_v.refrl_refno
              LEFT OUTER JOIN {{ ref('TGT','L_MAPPINGS_PURCHASEUNIT_IPM_REFERRALS') }}
                ON IFNULL(s_referral_20.referral_type_reference_no,1) = IFNULL(l_mappings_PurchaseUnit_IPM_Referrals.ref_type_reference_no,1)
               AND IFNULL(l_mappings_PurchaseUnit_IPM_Referrals.ref_source_reference_no,1) = IFNULL(s_referral_20.referral_source_reference_no,1)
               AND IFNULL(l_mappings_PurchaseUnit_IPM_Referrals.ref_reason_reference_no,1) = IFNULL(s_referral_20.referral_reason_reference_no,1)
               AND IFNULL(s_referral_20.admin_category_reference_no,1) = IFNULL(l_mappings_PurchaseUnit_IPM_Referrals.ref_administrative_category_reference_no,1)
               AND IFNULL(l_mappings_PurchaseUnit_IPM_Referrals.ref_to_spec_refno,1) = IFNULL(s_referral_20.referred_to_specialty_reference_no,1)
               AND IFNULL(s_referral_20.referred_to_health_org_reference_no,1) = IFNULL(l_mappings_PurchaseUnit_IPM_Referrals.ref_to_heorg_reference_no,1)
               AND IFNULL(s_referral_20.referral_status_reference_no,1) = IFNULL(l_mappings_PurchaseUnit_IPM_Referrals.ref_status_reference_no,1)
               AND IFNULL(s_referral_20.referral_authorisation_reason_reference_no,1) = IFNULL(l_mappings_PurchaseUnit_IPM_Referrals.authr_reason_reference_no,1)
               AND IFNULL(s_referral_20.referred_to_clinician_type_code,'x') = IFNULL(l_mappings_PurchaseUnit_IPM_Referrals.ref_to_proca_role_code,'x')
               AND IFNULL(s_referral_20.referred_by_clinician_type_code,'x') = IFNULL(l_mappings_PurchaseUnit_IPM_Referrals.ref_by_proca_role_code,'x')
               AND IFNULL(s_referral_20.accident_related_status_reference_no,1) = IFNULL(l_mappings_PurchaseUnit_IPM_Referrals.accident_related_reference_no,1)
              LEFT OUTER JOIN {{ ref('TGT','DIM_PRINCIPAL_DIAGNOSIS') }}
                ON s_referral_20.principal_diagnosis_reference_no = dim_principal_diagnosis.principal_diagnosis_reference_no
               AND IFNULL(dim_principal_diagnosis.dss_start_date, GETDATE()-10000) <= s_referral_20.referral_received_date
               AND IFNULL(dim_principal_diagnosis.dss_end_date, GETDATE()+10000) >= s_referral_20.referral_received_date
              LEFT OUTER JOIN {{ ref('TGT','DIM_REFERRAL_SOURCE') }}
                ON s_referral_20.referral_source_reference_no = dim_referral_source.referral_source_reference_no
               AND IFNULL(dim_referral_source.mapping_start_date, GETDATE()-10000) <= s_referral_20.referral_received_date
               AND IFNULL(dim_referral_source.mapping_end_date, GETDATE()+10000) >= s_referral_20.referral_received_date
              LEFT OUTER JOIN {{ ref('TGT','DIM_REFERRAL_COMPLETION_REASON') }}
                ON s_referral_20.referral_completion_reason_reference_no = dim_referral_completion_reason.referral_completion_reason_reference_no
               AND IFNULL(dim_referral_completion_reason.mapping_start_date, GETDATE()-10000) <= s_referral_20.referral_received_date
               AND IFNULL(dim_referral_completion_reason.mapping_end_date, GETDATE()+10000) >= s_referral_20.referral_received_date
              LEFT OUTER JOIN {{ ref('TGT','S_REFERRAL_22') }}
                ON s_referral_22.referral_encounter_id = s_referral_20.referral_encounter_id
               AND s_referral_22.row_num = 1
              LEFT OUTER JOIN {{ ref('TGT','S_REFERRAL_AUDIT_ACC_CLAIM') }}
                ON s_referral_audit_acc_claim.refrl_refno = s_referral_20.referral_reference_no
             WHERE referral_reference_dup_row_num=1
        name: S_REFERRAL_30
        noLinkRefs: []
  name: S_REFERRAL_30
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
