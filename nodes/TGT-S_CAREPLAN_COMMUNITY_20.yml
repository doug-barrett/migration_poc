fileVersion: 1
id: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
name: S_CAREPLAN_COMMUNITY_20
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33bd56ea-ae41-4931-9d1e-e450537221fd
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: TASK_REQUEST_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d219eafe-3079-409f-a407-4ff9368e018c
                stepCounter: 020905f4-c479-4f73-9624-e70ca6be9921
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a4ce8b13-7993-467b-b41f-1c014a1f7a4e
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: CONTACT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03c00af2-0406-4c75-873a-db42293708f3
                stepCounter: 020905f4-c479-4f73-9624-e70ca6be9921
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b06967c3-d4e7-4126-92d4-1e65e19eba95
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: CONTACT_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b5534306-02a8-43bd-879e-b13ea02b90f8
                stepCounter: 020905f4-c479-4f73-9624-e70ca6be9921
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2b27d17-f748-47b2-9eab-fac9b7dcb34a
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_careplan_community_20.contact_encounter_type_code=dim_encounter_type.encounter_type_code
        name: DIM_ENCOUNTER_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3ba8df3-db2e-40a1-97dc-d5ad6a5186a7
                stepCounter: 1d0ea6a1-9563-4fb3-a1fa-9d43dbdf296e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a39106c-c009-4163-806c-a435391491da
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: ""
        name: PROGRAMME_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cdce90fb-9d50-46e0-91b3-23500179b39a
                stepCounter: 020905f4-c479-4f73-9624-e70ca6be9921
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5cbffb7-3d43-4d9f-b29f-ca8818aa1a0b
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dd985656-85d9-4474-af29-598ab2e96f3c
                stepCounter: 020905f4-c479-4f73-9624-e70ca6be9921
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69c796c8-7fcc-48de-83d7-e278246da2b5
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: ""
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9962a01b-5f3d-4c1a-b371-997edef38d0f
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: IFNULL(dim_patient.dim_patient_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ea3df82-57b0-4dc1-9a07-26c49e5299c9
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_AGE_AT_CONTACT_YEARS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f201416-ac35-4870-a0c1-0836d1b9e5b7
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: FLOOR(DATEDIFF(dd,dim_patient.patient_date_of_birth, CASE WHEN IFNULL(dim_patient.patient_date_of_death,s_careplan_community_10.task_request_date) < s_careplan_community_10.task_request_date THEN IFNULL(dim_patient.patient_date_of_death,s_careplan_community_10.task_request_date) ELSE s_careplan_community_10.task_request_date END) / 365.25)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eed2bacc-3b9a-401f-9704-22836fce5723
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PATIENT_DATE_OF_DEATH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b5c2ff38-a66e-4814-80ba-d041584351af
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: patient_date_of_death
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29a2a628-747d-4e82-897c-24d937ed3381
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_careplan_community_20.patient_age_at_contact_years=dim_age_group.age_years
        name: DIM_AGE_GROUP_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18bfabd7-19aa-4de0-9ce7-aa560645bce6
                stepCounter: 3d5ba8a8-80ec-4848-b58a-d31b34cc53ed
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb0297d0-867b-4255-9bd4-6a9aac9a0427
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: DOMICILE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 13e3f44a-7125-438f-b00f-42c54a307c05
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aedef657-f21c-4ab7-bd6e-b08d3397f198
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_careplan_community_20.domicile_code=dim_domicile.domicile_code
        name: DIM_DOMICILE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e049fc8-a2a3-4bad-9b91-11b9d158b35e
                stepCounter: 330ad0aa-b8b1-4da9-ab37-b4fe8f889452
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15d7f47c-feb3-4f95-8990-e83e38e84930
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: IDF_CLASS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b013aae2-00f1-4e2e-89ce-cac5b973a1bd
                stepCounter: 330ad0aa-b8b1-4da9-ab37-b4fe8f889452
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 99640e93-62fe-456b-900c-97045cbd23b8
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7404fe64-ce49-4520-ac27-27c4d4e0236a
                stepCounter: 020905f4-c479-4f73-9624-e70ca6be9921
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 99fd7e04-28a5-4140-b0bd-30bef73705e8
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ROLE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6834a065-6a5c-4455-8745-3ada4fc22b09
                stepCounter: 020905f4-c479-4f73-9624-e70ca6be9921
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d83fcbb-6398-4a80-865a-72611c593698
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: DEPARTMENT_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 512f708b-cfc5-4496-a722-3ed9a51ecdc5
                stepCounter: 020905f4-c479-4f73-9624-e70ca6be9921
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e9b5ec6-1abf-4c64-94e4-ba4e38e7d250
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SERVICE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39d774a6-5664-4233-8497-0ed281347d94
                stepCounter: 020905f4-c479-4f73-9624-e70ca6be9921
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d699088-3168-4a73-8125-c7ea2f2382e4
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_careplan_community_20.role_code=dim_role_community.role_code
        name: DIM_ROLE_COMMUNITY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: acff4fff-07f1-43da-966d-53a96d429471
                stepCounter: ab48ab83-7613-4d28-acbd-ba81b413fe84
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8d9bdf9-8339-484b-9688-ae2db1ccf71c
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: SEEN_BY_CLINICIAN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 88473629-d1b3-44b3-8b90-77c6e7c42112
                stepCounter: 020905f4-c479-4f73-9624-e70ca6be9921
            transform: |-
              CASE WHEN ISNUMERIC(s_careplan_community_10.seen_by_clinician_reference_no) = 0 THEN s_careplan_community_10.seen_by_clinician_reference_no
                          ELSE dim_seen_by_clinician.seen_by_clinician_code
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82e0ebd9-3677-40c1-b528-4f2b6d6b9f04
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: SEEN_BY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 88473629-d1b3-44b3-8b90-77c6e7c42112
                stepCounter: 020905f4-c479-4f73-9624-e70ca6be9921
            transform: |-
              CASE WHEN ISNUMERIC(s_careplan_community_10.seen_by_clinician_reference_no) = 1 THEN s_careplan_community_10.seen_by_clinician_reference_no
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f61c0ca-e272-46c8-8ab6-2d0d3016adba
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_careplan_community_20.seen_by_clinician_reference_no=dim_seen_by_clinician.seen_by_clinician_reference_no
        name: DIM_SEEN_BY_CLINICIAN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6980c5e-497d-45d3-854e-f5d17228ad86
                stepCounter: 293e84bb-0ad7-4a27-96ab-0a0cb38c50c5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce647a12-1499-46d1-8311-737edeac8a46
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: TASK_REQUEST_FIRST_DUE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f0e67fbf-08fb-41bd-8050-2c3fa4937eeb
                stepCounter: 020905f4-c479-4f73-9624-e70ca6be9921
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9cafc97-94aa-4bae-93e2-475444d6bbe5
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: TASK_REQUEST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c0a20d89-7604-4fb0-bb13-2c0d42d8676d
                stepCounter: 020905f4-c479-4f73-9624-e70ca6be9921
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c33d1684-adfb-40b5-887d-20f13b67bd80
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PHASE_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f5e97e2-907c-46af-86c7-b855793d4c49
                stepCounter: 020905f4-c479-4f73-9624-e70ca6be9921
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b2bc1b1a-2d41-4ddc-a19e-2d349049b5ad
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_careplan_community_20.CONVERT(date,s_careplan_community_10.phase_start_date)=dim_phase_start_date.phase_start_calendar_date
        name: DIM_PHASE_START_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 521ab918-a1b5-40d2-b542-0cc20daa26e8
                stepCounter: 67e1740b-bbaf-447f-acfb-ec4b7dbe992b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f9bc836-e9d1-4a9b-987c-0a744f740cee
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PHASE_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8cc8046d-342d-45c3-a9f5-d5569df55973
                stepCounter: 020905f4-c479-4f73-9624-e70ca6be9921
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d0ee8778-6223-4db7-986c-8dc9cf3c108c
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_careplan_community_20.CONVERT(date,s_careplan_community_10.phase_end_date)=dim_phase_end_date.phase_end_calendar_date
        name: DIM_PHASE_END_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2288fa1d-2b8f-4266-b6b4-03612c120e5e
                stepCounter: d12e27b8-fe5a-44be-941c-5b269de0a5ee
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a874d32-e3e6-4fbf-9748-20adc04dfe8f
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d42b248-92d4-4798-af0b-ffab09ea9aa5
                stepCounter: 020905f4-c479-4f73-9624-e70ca6be9921
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4629a06c-e095-4d46-9c99-218bf9e3d76d
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_careplan_community_20.CONVERT(date,s_careplan_community_10.discharge_date)=dim_discharge_date.discharge_calendar_date
        name: DIM_DISCHARGE_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 985b56af-022e-46b3-82b0-51ae204ca926
                stepCounter: 45fbd3a8-64d0-4be6-b03a-8d128a18b549
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21273665-03d1-4569-b061-d20e1e9cb77f
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: REVIEW_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0644b927-49f0-44a7-8ef6-11caf0f2f16c
                stepCounter: 020905f4-c479-4f73-9624-e70ca6be9921
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be8b370c-2618-425a-b114-3e3a1de78b91
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CLIENT_STATED_GOAL_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5b7ec5f3-56c5-42bd-a44f-737c0b6f725f
                stepCounter: 020905f4-c479-4f73-9624-e70ca6be9921
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6eba2261-07cd-4064-9cfb-04fec9c22b45
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CLIENT_CATEGORY_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 58c566af-b143-4629-bf50-bc3b9ab79cc5
                stepCounter: 020905f4-c479-4f73-9624-e70ca6be9921
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 617ec436-c56e-4e2b-a17f-d10087674178
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PRESENTING_ISSUE_CATEGORY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 62805cc8-a033-4166-b6f3-cd1f31150fca
                stepCounter: 020905f4-c479-4f73-9624-e70ca6be9921
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05b34f0c-0d3b-4b52-99bb-8c7412fd0b79
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PRESENTING_ISSUE_CATEGORY_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f2fddb8-3655-4b7c-ae5b-f2dc159ae2ab
                stepCounter: 020905f4-c479-4f73-9624-e70ca6be9921
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1879f0d9-46cd-4bdd-aafa-7a7e6c1eb680
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: USUAL_LOCATION_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 208b62f3-66af-4605-bbd2-8991fa698858
                stepCounter: 020905f4-c479-4f73-9624-e70ca6be9921
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 012d2608-6d3f-4140-8d16-28753926c190
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PHASE_OBJECTIVE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 44abeb2b-25fb-4169-ad76-3de995bc407d
                stepCounter: 020905f4-c479-4f73-9624-e70ca6be9921
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48afae98-85c8-468c-9be2-98ddff2c4e2b
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PHASE_OUTCOME_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1766456e-5e6a-4288-a593-3780a0016433
                stepCounter: 020905f4-c479-4f73-9624-e70ca6be9921
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aad6e731-4262-43e7-8a39-682b641e2765
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CLINICAL_RISK_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 32b81682-11dc-4387-8d65-114359ec7bbd
                stepCounter: 020905f4-c479-4f73-9624-e70ca6be9921
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c1792f7-c22c-4a1a-87f4-02a43a051d13
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CASE_TYPE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2cf7195-dc0b-4914-9229-be57fa464523
                stepCounter: 020905f4-c479-4f73-9624-e70ca6be9921
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 031c26fe-9a41-4872-85c9-b81b94033933
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CASE_COMPLEXITY_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 82251dff-3b61-4f08-83c7-d48032c3328f
                stepCounter: 020905f4-c479-4f73-9624-e70ca6be9921
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb589e57-2bda-418f-99c7-e0e122cd70a9
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CARE_TYPE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52c9ccda-9b0d-4f7d-ae39-ac797f2fccf5
                stepCounter: 020905f4-c479-4f73-9624-e70ca6be9921
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 575eff8e-23d0-472c-a7dc-3397dec81cfe
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CARE_PHASE_TYPE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce8877a8-0a8a-43c6-a07e-bde00b6f401e
                stepCounter: 020905f4-c479-4f73-9624-e70ca6be9921
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8a2efe2-a761-4ec1-a1d5-a7b13b1fc678
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: INTENSITY_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67910ef7-6747-4911-acb8-ab3a43af5cd0
                stepCounter: 020905f4-c479-4f73-9624-e70ca6be9921
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86872a40-9275-4110-8068-a57ebcb7caa2
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CLOSE_PHASE_TYPE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 374860e6-fa6c-4feb-826e-b1875e9145fd
                stepCounter: 020905f4-c479-4f73-9624-e70ca6be9921
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14d6644b-8e91-423a-bf52-5d0ece237739
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CLOSURE_REASON_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b3e31dee-20ca-4fc1-b88f-4e2e3a683f2a
                stepCounter: 020905f4-c479-4f73-9624-e70ca6be9921
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1a51632-9ca3-4172-ab06-5e034c0d1696
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: FUNDER_CONTRACT_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9ae8b7c1-2077-431e-91b7-1500e7c6ecd6
                stepCounter: 020905f4-c479-4f73-9624-e70ca6be9921
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6030c0e-2979-4e22-8827-828b8fd609ef
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PURCHASER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf9b46e4-e653-42c5-8ee3-fa4996358a9f
                stepCounter: 020905f4-c479-4f73-9624-e70ca6be9921
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40bfb0f4-d939-4c45-8c1a-9998edafaeea
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: OBSERVATION_REPORT_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5b5acc71-264f-40b6-a1b3-e5ebd9607d67
                stepCounter: 020905f4-c479-4f73-9624-e70ca6be9921
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0824534-dbda-4d26-ac20-4405c3d3238c
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_careplan_community_20.client_category_desc=dim_careplan_community.client_category_desc  s_careplan_community_20.presenting_issue_category_code=dim_careplan_community.presenting_issue_category_code  s_careplan_community_20.presenting_issue_category_desc=dim_careplan_community.presenting_issue_category_desc  s_careplan_community_20.usual_location_desc=dim_careplan_community.usual_location_desc  s_careplan_community_20.phase_objective_desc=dim_careplan_community.phase_objective_desc  s_careplan_community_20.phase_outcome_desc=dim_careplan_community.phase_outcome_desc  s_careplan_community_20.clinical_risk_desc=dim_careplan_community.clinical_risk_desc  s_careplan_community_20.case_type_desc=dim_careplan_community.case_type_desc  s_careplan_community_20.case_complexity_desc=dim_careplan_community.case_complexity_desc  s_careplan_community_20.care_type_desc=dim_careplan_community.care_type_desc  s_careplan_community_20.care_phase_type_desc=dim_careplan_community.care_phase_type_desc  s_careplan_community_20.intensity_desc=dim_careplan_community.intensity_desc  s_careplan_community_20.close_phase_type_desc=dim_careplan_community.close_phase_type_desc  s_careplan_community_20.closure_reason_code=dim_careplan_community.closure_reason_desc  s_careplan_community_20.funder_contract_desc=dim_careplan_community.funder_contract_desc  s_careplan_community_20.observation_report_status=dim_careplan_community.observation_report_status
        name: DIM_CAREPLAN_COMMUNITY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72859722-771e-4ec4-99df-3dd6962513a2
                stepCounter: d8d5e71d-6cab-48b2-853c-7866e94aff3f
            transform: IFNULL(dim_careplan_community.dim_careplan_community_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 105d4b1e-2b10-4cf0-a17f-f7edd9d67f5c
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 70a280e4-f99e-4285-a0f9-d2942568e1e3
                stepCounter: 020905f4-c479-4f73-9624-e70ca6be9921
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97858595-9b09-4d95-b6fe-fb550a71fa19
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1f83b70-6d15-49e2-92f9-1f6a14e0dc01
                stepCounter: 020905f4-c479-4f73-9624-e70ca6be9921
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 038b10a0-925d-4dab-81cd-607e7e78c849
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_careplan_community_20.create_user_login_name=dim_user_login_concerto.user_name
        name: DIM_USER_LOGIN_CONCERTO_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16f2ac98-6185-439c-9a15-757698e43d58
                stepCounter: 4bf64241-1d0b-4a30-8919-350bb5d33ed1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9490741-0c55-497c-87d3-e38bb507c5f1
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ACTUAL_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0d9a4922-1701-4bff-b448-4e1708aea0d8
                stepCounter: 020905f4-c479-4f73-9624-e70ca6be9921
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1967fa9-bd57-4c04-8fe7-a1fab4facf80
          stepCounter: 3affb0b6-b82a-49e6-9618-2ac55d6794bd
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_CAREPLAN_COMMUNITY_10
        join:
          joinCondition: |-
            FROM s_careplan_community_10
              LEFT OUTER JOIN dim.dim_patient
                ON dim_patient.patient_NHI = s_careplan_community_10.patient_NHI
               AND dim_patient.NHI_sequence = 1
        name: S_CAREPLAN_COMMUNITY_20
        noLinkRefs: []
  name: S_CAREPLAN_COMMUNITY_20
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
