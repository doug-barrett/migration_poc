fileVersion: 1
id: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
name: S_ED_STAY_FIRST_LAST_V
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: "Details about the first and last stay for each encounter."
  isMultisource: false
  locationName: TGT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: baf4e367-c82a-4282-b612-9ee2709130eb
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ENCOUNTER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e08a28e-93fc-4605-85e2-0b787c491aed
                stepCounter: 19f97281-8cc4-4660-83be-6049689bc9c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 201a0b57-062d-45e3-8bcf-f7e6e8370392
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: AEATT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 32dc32a8-527a-4d9f-b8e6-ec44f2b05158
                stepCounter: 19f97281-8cc4-4660-83be-6049689bc9c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a47f6d9-3238-45ad-a986-9295fa5aeef1
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FIRST_STAY_AESTY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d325636b-232a-4db7-ac3c-646292081c56
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FIRST_STAY_PROCA_REFNO
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de1c57f2-d947-412f-9d40-5b164f36adbf
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FIRST_STAY_CLINICIAN
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c83512c-2fe4-4b3f-a97b-f758baa54bba
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FIRST_STAY_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e8c7497-cb87-4f85-a299-31e8b414fe02
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FIRST_STAY_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 85183e77-dbfe-487c-bedc-322aacb44aab
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FIRST_STAY_HEALTH_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c75823a-c7cd-4409-895c-f137b1942ec1
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FIRST_STAY_SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0df75437-d02e-4574-806b-324363ac8bff
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FIRST_STAY_SPONT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7c71cd0-cda9-46e5-843b-9f2943df3587
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: FIRST_STAY_ADU_LOCATION_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 525d2952-2e2f-40aa-a1de-4d42c1439d19
                stepCounter: 19f97281-8cc4-4660-83be-6049689bc9c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92c5e3e2-9753-426c-b8e1-be9d1c386934
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EARLIEST_START_AESTY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18e565a3-d6cf-4d22-967e-62398c9aab69
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EARLIEST_START_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86ad69bb-906f-45c9-911f-45d86e24abab
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EARLIEST_STAY_CLINICIAN
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06b009df-fd76-46a9-b76e-8a8c8e06590b
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EARLIEST_START_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd8b78ca-4e1a-4906-8d50-08824f382bae
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EARLIEST_START_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 452e0c54-317f-4ed6-b061-026e40b7bb34
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EARLIEST_START_HEALTH_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b67523d3-c5c1-4f37-9cd2-0452ac3c876b
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EARLIEST_START_SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 51ecfed7-0e76-4c31-ac8c-f26907373665
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EARLIEST_START_SPONT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81445edd-215d-4b1a-9545-cb596c54b929
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_SEEN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05d6dfa1-f671-44ea-bd24-9931e437b375
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FIRST_SEEN_AESTY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72c2b891-b107-4846-aa61-717e04288d3e
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FIRST_SEEN_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cba2fb6a-5d04-4f28-946c-ce2f49e8e673
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FIRST_SEEN_CLINICIAN
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53855a6c-353d-478a-91d2-68da62e264fa
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FIRST_SEEN_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0791e37e-c696-4903-be6a-d3be34b861b9
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FIRST_SEEN_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69076c47-5f2f-4db6-a549-aefd787135d4
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FIRST_SEEN_HEALTH_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bda18eb6-79e1-4ec4-96f2-1c71a11f022e
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FIRST_SEEN_SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db2b9dd1-4f99-4985-b108-e839fdebd6c1
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FIRST_SEEN_SPONT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ffcde35a-b129-4d29-b8e1-ebb95f364202
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_SEEN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6dd65709-26d6-4d60-984a-8c5d6af7c7db
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LAST_SEEN_AESTY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b447127c-075b-4e92-9def-720ae8210063
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LAST_SEEN_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a569f3f5-2e85-482b-822d-b0c6912a1cf2
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LAST_SEEN_CLINICIAN
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a656c05-96ba-4aac-8c57-906b6e83ba0e
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LAST_SEEN_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 10def976-5c4f-4ac0-b2cd-bfa013720d4e
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LAST_SEEN_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06375699-3a89-4c7f-8e7c-5d51383a32aa
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LAST_SEEN_HEALTH_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e5f49dc-aa4a-4eee-a3e1-00e2bf76277a
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LAST_SEEN_SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca30ca2e-02b6-4cf8-8e6b-3abf9fe4c6e9
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LAST_SEEN_SPONT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e23e70b1-c93c-4711-855c-8d081df2a147
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FIRST_NON_ED_AESTY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a82b0bc3-2cc9-4b70-a782-b23ebefd9fd0
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_NON_ED_SEEN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: facd73f8-95b9-472e-941a-ca778086312a
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FIRST_NON_ED_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af0a41d7-e6e5-469d-ac10-a872509dd96c
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FIRST_NON_ED_HEALTH_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7935b65-fe00-40d1-ac67-5745df4c9967
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LAST_STAY_AESTY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c7a0ae51-f8da-4cc8-9abb-46b20b5f4c16
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LAST_STAY_PROCA_REFNO
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29e2636e-db9f-4bcf-8569-b7f1454faab2
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LAST_STAY_CLINICIAN
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5eabb98f-5be7-4c25-90c9-f1b3236ad45b
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LAST_STAY_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f86cf522-41e0-46e5-a5ea-3fb55cce813f
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LAST_STAY_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f51604d3-d9fe-488d-9ab8-f8145983abc6
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LAST_STAY_HEALTH_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b9ee3523-3168-42fa-b5b5-b63cf188be6b
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LAST_STAY_SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb311c95-32f4-42e0-8b8e-d16169e29eb6
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LAST_STAY_SPONT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dbba932c-b977-4345-b76d-fc37eb4179ac
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: 'STOP_CLOCK_AESTY_REFNO '
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e7aae4e-4202-49f0-af0b-87a70aa61e42
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: STOP_CLOCK_STAY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 80781b01-0b6c-4ea2-9f31-653db2cbe745
                stepCounter: 19f97281-8cc4-4660-83be-6049689bc9c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5be99557-7a0a-4a5c-9ea1-069e7e4310ad
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: stop_clock_location_flag
        name: STOP_CLOCK_LOCATION_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 10b0d178-6bf2-4027-ba8a-f3f8fe911c29
                stepCounter: 19f97281-8cc4-4660-83be-6049689bc9c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82035f79-694e-4801-bed5-579ccd9a3961
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OBSERVATION_AESTY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17d7b271-5e7c-4aee-b115-10e1c452344c
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: OBS_admit_date
        name: OBS_ADMIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 80781b01-0b6c-4ea2-9f31-653db2cbe745
                stepCounter: 19f97281-8cc4-4660-83be-6049689bc9c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e868c47-ee51-4768-8ab5-5047e50c3dd6
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: observation_location_flag
        name: OBSERVATION_LOCATION_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f592126-3739-4b76-bc79-103f53ad4ae0
                stepCounter: 19f97281-8cc4-4660-83be-6049689bc9c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6c49445-2273-41c4-ae8f-b7189dffc5d7
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ADU_aesty_refno
        name: ADU_AESTY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 535ea75c-ea13-4a7d-ac25-aa43b23b0cce
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ADU_admit_date
        name: ADU_ADMIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f97ff77-8eab-4aa0-b4e0-3e21a883f265
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ADU_LOCATION_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 525d2952-2e2f-40aa-a1de-4d42c1439d19
                stepCounter: 19f97281-8cc4-4660-83be-6049689bc9c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da836a80-e4a5-4dd2-9cfb-8c148211eb2d
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: inappropriate_location_aesty_refno
        name: INAPPROPRIATE_LOCATION_AESTY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d950008c-cf9c-4874-99b1-bac458b4bf03
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: inappropriate_location_flag
        name: INAPPROPRIATE_LOCATION_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 13749428-a63d-4770-951c-c1b6ac9251f4
                stepCounter: 19f97281-8cc4-4660-83be-6049689bc9c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bff32558-5b5f-4b49-b8a8-0e424d4d8b91
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: non_EMMED_aesty_refno
        name: NON_EMMED_AESTY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c80255b8-b379-4628-89f8-4b80557b710e
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NON_EMMED_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c6d3d35-8f61-41c5-a5bd-85d1d7c725e6
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: non_EMMED_spect_refno
        name: NON_EMMED_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a1cc97f-8c64-46e6-b395-50400e280735
          stepCounter: 3a05468e-a7a1-494c-b943-5fe4a8c573a4
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: non_EMMED_health_specialty
        name: NON_EMMED_HEALTH_SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            SELECT t1.encounter encounter,
                   t1.aeatt_refno aeatt_refno,
                   t1.aesty_refno first_stay_aesty_refno,
                   t1.proca_refno first_stay_proca_refno,
                   t1.clinician first_stay_clinician,
                   t1.spect_refno first_stay_spect_refno,
                   t1.specialty first_stay_specialty,
                   t1.health_specialty first_stay_health_specialty,
                   t1.service_point_reference_no first_stay_spont_refno,
                   t1.location first_stay_spont_code,
                   t1.acute_diagnosis_unit_location_flag first_stay_ADU_location_flag,
                   t2.aesty_refno earliest_start_aesty_refno,
                   t2.proca_refno earliest_start_proca_refno,
                   t2.clinician earliest_stay_clinician,
                   t2.spect_refno earliest_start_spect_refno,
                   t2.specialty earliest_start_specialty,
                   t2.health_specialty earliest_start_health_specialty,
                   t2.service_point_reference_no earliest_start_spont_refno,
                   t2.location earliest_start_spont_code,
                   IFNULL(ts3.actiondttm, t3.seen_date) first_seen_date,
                   t3.aesty_refno first_seen_aesty_refno,
                   t3.proca_refno first_seen_proca_refno,
                   t3.clinician first_seen_clinician,
                   t3.spect_refno first_seen_spect_refno,
                   t3.specialty first_seen_specialty,
                   t3.health_specialty first_seen_health_specialty,
                   t3.service_point_reference_no first_seen_spont_refno,
                   t3.location first_seen_spont_code,
                   t4.seen_date last_seen_date,
                   t4.aesty_refno last_seen_aesty_refno,
                   t4.proca_refno last_seen_proca_refno,
                   t4.clinician last_seen_clinician,
                   t4.spect_refno last_seen_spect_refno,
                   t4.specialty last_seen_specialty,
                   t4.health_specialty last_seen_health_specialty,
                   t4.service_point_reference_no last_seen_spont_refno,
                   t4.location last_seen_spont_code,
                   t5.aesty_refno first_non_ed_aesty_refno,
                   t5.seen_date first_non_ed_seen_date,
                   t5.specialty first_non_ed_specialty,
                   t5.health_specialty first_non_ed_health_specialty,
                   t6.aesty_refno last_stay_aesty_refno,
                   t6.proca_refno last_stay_proca_refno,
                   t6.clinician last_stay_clinician,
                   t6.spect_refno last_stay_spect_refno,
                   t6.specialty last_stay_specialty,
                   t6.health_specialty last_stay_health_specialty,
                   t6.service_point_reference_no last_stay_spont_refno,
                   t6.location last_stay_spont_code,
                   t7.aesty_refno stop_clock_aesty_refno,
                   t7.start_date stop_clock_stay_start_date,
                   t7.stop_clock_location_flag stop_clock_location_flag,
                   t8.aesty_refno observation_aesty_refno,
                   t8.start_date OBS_admit_Date,
                   t8.observation_location_flag observation_location_flag,
                   t9.aesty_refno ADU_aesty_refno,
                   t9.start_date ADU_admit_Date,
                   t9.acute_diagnosis_unit_location_flag ADU_location_flag,
                   t10.aesty_refno inappropriate_location_aesty_refno,
                   t10.inappropriate_location_flag inappropriate_location_flag,
                   t11.aesty_refno non_EMMED_aesty_refno,
                   t11.start_date non_EMMED_start_date,
                   t11.aesty_refno non_EMMED_spect_refno,
                   t11.health_specialty non_EMMED_specialty
              FROM s_ed_stay_10 t1 -- First Stay for the encounter

              LEFT OUTER JOIN s_ed_stay_10 t2
                ON t2.encounter = t1.encounter
               AND t2.row_num4 = 1 -- Earliest start_date for the encounter

              LEFT OUTER JOIN s_ed_stay_20 t3
                ON t3.encounter = t1.encounter
               AND t3.seen_date_rank = 1 -- First seen_date for the encounter

              LEFT OUTER JOIN s_ed_seen_by_10 ts3
                ON ts3.encounter = t1.encounter
               AND seen_by_doctor_seq_num= 1
              LEFT OUTER JOIN s_ed_stay_10 t4
                ON t4.encounter = t1.encounter
               AND t4.seen_date_rank_descending = 1 -- Last seen_date for the encounter

              LEFT OUTER JOIN s_ed_stay_20 t5
                ON t5.encounter = t1.encounter
               AND t5.non_ed_stay_rank = 1 -- First non ED stay (if any) for the encounter

              LEFT OUTER JOIN s_ed_stay_10 t6
                ON t6.encounter = t1.encounter
               AND t6.row_num4 = t6.row_count -- Last stay (discharge) for the encounter

              LEFT OUTER JOIN s_ed_stay_20 t7
                ON t7.encounter = t1.encounter
               AND t7.stop_clock_stay_rank = 1 -- First Stop-Clock Location Stay for the encounter

              LEFT OUTER JOIN s_ed_stay_20 t8
                ON t8.encounter = t1.encounter
               AND t8.observation_stay_rank = 1 -- Observation stay (if any)for the encounter

              LEFT OUTER JOIN s_ed_stay_20 t9
                ON t9.encounter = t1.encounter
               AND t9.ADU_stay_rank = 1 -- ADU first stay for the encounter

              LEFT OUTER JOIN s_ed_stay_10 t10
                ON t10.encounter = t1.encounter
               AND t10.inappropriate_location_stay_rank = 1 -- Inappropriate Location stay (if any) for the encounter

              LEFT OUTER JOIN s_ed_stay_20 t11
                ON t11.encounter = t1.encounter
               AND t11.non_EMMED_stay_rank = 1 -- Non-EMMED Stay (if any) for the encounter

             WHERE t1.row_num1 = 1
        dependencies:
          - locationName: TGT
            nodeName: S_ED_STAY_10
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TGT','S_ED_STAY_10') }}
        name: S_ED_STAY_FIRST_LAST_V
        noLinkRefs: []
  name: S_ED_STAY_FIRST_LAST_V
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
