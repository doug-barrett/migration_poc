fileVersion: 1
id: e786a67b-ba21-4d00-b61f-7e47852e03ae
name: S_NEXUS_SESSION_20
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2fbd31f3-0141-425e-90fb-cdc1a6d320be
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: ""
        name: SESSION_REFNO
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aefdbf1d-316e-4dbb-ad5d-65c7fd3abb44
                stepCounter: a58537fc-7739-479c-b8bf-8a62ca55d0c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e9b3c82-bc21-4c66-9bbe-739d85f82ddd
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: DECIMAL(8,2)
        defaultValue: ""
        description: DAP_utilisation
        name: DAP_UTILISATION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN IFNULL(DATEDIFF(mi,s_nexus_Session_10.startdate,s_nexus_Session_10.enddate),0) > 0 THEN (DATEDIFF(mi,IFNULL(s_nexus_visit_summary.first_patient_ready_date,s_nexus_visit_summary.first_patient_into_theatre_date),IFNULL(s_nexus_visit_summary.last_patient_out_of_theatre_date,s_nexus_visit_summary.last_patient_into_postop_date)) * 100) / DATEDIFF(mi,s_nexus_Session_10.startdate,s_nexus_Session_10.enddate)
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af6e66b7-4cea-4255-bcf1-c958491cf32f
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SESSION_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21183c3a-1c5e-4083-afed-0ac33f46a2f9
                stepCounter: a58537fc-7739-479c-b8bf-8a62ca55d0c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3df98c5-f4c3-4e3c-8073-740d7fdf6ff7
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: STARTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bac714ce-118e-42d0-8595-98b0ef64b86f
                stepCounter: a58537fc-7739-479c-b8bf-8a62ca55d0c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 198a3ff6-873d-423b-92a4-9f05ac56954a
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ENDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2ec381e-baa4-4d87-b9f1-12eb7ae4de2c
                stepCounter: a58537fc-7739-479c-b8bf-8a62ca55d0c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 73485707-e061-4441-9832-6a3cb48e67ba
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: CANCELLED_SESSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e0ecb4d8-e024-4018-a4d9-8a72479cb3c0
                stepCounter: a58537fc-7739-479c-b8bf-8a62ca55d0c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 872d1e15-4a27-4710-a8d9-66dba3982b96
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: CANCELLED_REASON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1c330ac-9fd3-4f18-aecd-97beaf8cb53f
                stepCounter: a58537fc-7739-479c-b8bf-8a62ca55d0c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dbaec78b-d4b3-497a-9149-d6c38754347d
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_nexus_Session_20.sessdate=dim_date.calendar_date
        name: DIM_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e325898-55b4-4da5-b829-888e5823e2fc
                stepCounter: bc3fcb77-c0c4-477a-92d8-4db14f153b73
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 23538d72-ec0b-4671-9837-b08abb6211af
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: CR_COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 20157a79-cd7c-4398-8b9b-f82b2a85e66a
                stepCounter: a58537fc-7739-479c-b8bf-8a62ca55d0c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ed700f4-a6ce-467d-9ecc-2fd419948b65
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: SESSION_LATE_REASON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1a1347a-497c-4acd-bcb2-6858abfe7e76
                stepCounter: a58537fc-7739-479c-b8bf-8a62ca55d0c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 096a7272-f4bf-453b-a9fc-8394624398d7
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: SESSION_OWNER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 403eda27-311c-4124-a21b-eb4e3bd0de52
                stepCounter: a58537fc-7739-479c-b8bf-8a62ca55d0c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 352435b5-73b5-4632-b54e-2be01856fa5a
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: THEATRECODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4f8004a9-f86e-4eec-8eb3-216e6b2c501c
                stepCounter: a58537fc-7739-479c-b8bf-8a62ca55d0c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 553e8241-80d1-4aa2-bf18-47d399e6985e
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_SURGICAL_THEATRE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c1eddf8-a4ec-4d38-a1b0-32113ce70372
                stepCounter: 50d37543-6dd1-4ea0-bfe9-dc03dfc2dacc
            transform: IFNULL(dim_surgical_theatre.dim_surgical_theatre_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b16a657-d2c2-4de9-9b53-f981542169fc
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: SPECIALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1fd15f1-8911-48fd-8d7a-f27983f87705
                stepCounter: a58537fc-7739-479c-b8bf-8a62ca55d0c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb918111-f0a4-46aa-aa2d-a57454140eb7
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_SESSION_SPECIALTY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 36145fe6-b8a5-4622-989d-3aa6a94e82b6
                stepCounter: a0af56c4-d96c-4a0c-a112-b4ca3e6b911c
            transform: IFNULL(dim_session_specialty.dim_session_specialty_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db4ff057-03ee-4f1c-801c-ce9145ec1ca9
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: VARCHAR(24)
        defaultValue: ""
        description: ""
        name: SESSIONDESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6baf005f-a3d0-4597-9bb3-ef35eb07253a
                stepCounter: a58537fc-7739-479c-b8bf-8a62ca55d0c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5aef2e29-ea23-4a60-bf1c-3b1dba0bb00e
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SESSIONCANCELLEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 69bd2297-0512-434a-9b02-cc784c62a696
                stepCounter: a58537fc-7739-479c-b8bf-8a62ca55d0c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6c69b96-b091-42b4-8c41-2dc89ad5cc63
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SESSIONCODE
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              s_nexus_Session_10.theatrecode+'-'+ CASE ((DATEDIFF(wk,'2011-07-04',dim_date.calendar_date)+1)/4.0) - ((DATEDIFF(wk,'2011-07-04',dim_date.calendar_date)+1)/4)
                          WHEN 0.25                                                                                                             THEN 'WK1'
                          WHEN 0.50                                                                                                             THEN 'WK2'
                          WHEN 0.75                                                                                                             THEN 'WK3'
                          WHEN 0.00                                                                                                             THEN 'WK4'
                           END +'-'+upper(substring(datename(dw,s_nexus_Session_10.sessdate),1,3))+'-'+ CASE WHEN s_nexus_Session_10.flexsess_session = 1 AND s_nexus_Session_10.endtime < '13:00' THEN 'AM'
                          WHEN s_nexus_Session_10.flexsess_session = 2 AND s_nexus_Session_10.endtime > '13:00' THEN 'PM'
                          ELSE 'AD'
                           END+'-'+ cast(s_nexus_Session_10.flexsess_session AS varchar(2))+ cast(s_nexus_Session_10.theatre AS varchar(2))+ CONVERT(varchar(8),s_nexus_Session_10.sessdate,112)+ IFNULL(CAST(s_nexus_Session_10.CR_Comments AS VARCHAR(3)),'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9dce16bf-9526-42b4-8296-ca0d3a722423
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: SCHSTAFF_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7bc66a22-732b-4739-a239-30c0c4da1637
                stepCounter: a58537fc-7739-479c-b8bf-8a62ca55d0c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a561d1de-4e29-4811-86fb-2429a92b789b
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: CONSCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fef3756f-d130-4260-8b5d-19128deea01b
                stepCounter: a58537fc-7739-479c-b8bf-8a62ca55d0c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c57db22-081a-4307-8074-6e62cd5a1ec3
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: session_anaesthetist
        name: SESSION_ANAESTHETIST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0774f42a-fe48-41ae-9cc2-0e3242ca0895
                stepCounter: a58537fc-7739-479c-b8bf-8a62ca55d0c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b29eeb83-bfc3-4537-ba76-18eb41c61bf2
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SESSDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bfdc2d9f-00f8-41d1-9103-252a8b4c69ca
                stepCounter: a58537fc-7739-479c-b8bf-8a62ca55d0c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c6805b9-50bd-4087-ba8f-0a38b624b6c2
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_PATIENT_OUT_OF_THEATRE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e57a3f8b-38f0-467d-b0d5-8e7b31bd8d00
                stepCounter: 839e185e-0d30-4073-b55f-88b80bf051f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c542c6d6-d917-43d8-baa6-acd2a20a6cf5
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: AM_LONG_DELAY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3dd4a3d5-211a-4717-baba-89c0bf6fd860
                stepCounter: 839e185e-0d30-4073-b55f-88b80bf051f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 214bda64-5036-4ed1-b037-4e3a9e5997c4
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: VARCHAR(12)
        defaultValue: ""
        description: ""
        name: FIRST_THEATRE_VISIT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90ba4335-f9ef-4c11-95dc-abc1956852e2
                stepCounter: 839e185e-0d30-4073-b55f-88b80bf051f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06fde866-fddd-4e07-824c-1aa927226f81
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: ""
        name: THEATRE_SESSION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e56cd422-0d40-4973-af08-8e9e83cc4f46
                stepCounter: 839e185e-0d30-4073-b55f-88b80bf051f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fac8ca25-ef9c-4682-95e4-af23d9e4e8eb
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_BOOKED_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3199541e-2591-48fd-bdfc-297cb6cf328a
                stepCounter: 839e185e-0d30-4073-b55f-88b80bf051f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 464edffe-f227-4775-aee6-d659b9bb6e78
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_PATIENT_INTO_POSTOP_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0574515f-ddf9-4487-aee5-48762ebb97eb
                stepCounter: 839e185e-0d30-4073-b55f-88b80bf051f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6499d325-5890-4ad9-9fbe-af63aa070538
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_BOOKED_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50270067-768c-4b53-b00f-626e9509cf09
                stepCounter: 839e185e-0d30-4073-b55f-88b80bf051f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5281b50b-e6ec-407e-b40d-5c00470d0830
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_PATIENT_READY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d0144564-69ca-4fe8-83ba-bb1da6823574
                stepCounter: 839e185e-0d30-4073-b55f-88b80bf051f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6eccc0a-2e1a-4fcc-99ba-9d037089900e
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_PATIENT_INTO_THEATRE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f15bd786-290e-4fd5-a731-3a13291d2457
                stepCounter: 839e185e-0d30-4073-b55f-88b80bf051f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 381a3e26-547f-4e10-8640-afc6bd6027d2
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CANCELLED_OPERATIONS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a0b6a7bf-5db9-4bba-a22c-b044148b16bb
                stepCounter: 839e185e-0d30-4073-b55f-88b80bf051f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f74c2bca-36d6-4b3b-9b20-a2006981cb33
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: session_late_reason_notes
        name: SESSION_LATE_REASON_NOTES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3290d9ec-5117-4989-9aa9-bb969ec5b0d5
                stepCounter: a58537fc-7739-479c-b8bf-8a62ca55d0c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: acc82bf1-69c5-40b5-89a3-6d03cb45fc6b
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACTUAL_OPERATIONS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9dc2b60b-223b-4c5f-84ff-388ffdb35d17
                stepCounter: 839e185e-0d30-4073-b55f-88b80bf051f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b08ce9c5-edd1-4d1b-807d-46f85ea48ce8
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: VARCHAR(12)
        defaultValue: ""
        description: ""
        name: LAST_THEATRE_VISIT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f49586fc-07aa-432c-9f03-3ecbea90af2c
                stepCounter: 839e185e-0d30-4073-b55f-88b80bf051f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6323d2fd-56af-4fb8-83b4-3c10bf376e55
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PLANNED_OPERATIONS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cccbdcc6-f54c-4580-b22e-40e66af5b003
                stepCounter: 839e185e-0d30-4073-b55f-88b80bf051f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ae22a05-fdc5-4770-95c2-2eefc266e572
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LISTS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bac714ce-118e-42d0-8595-98b0ef64b86f
                stepCounter: a58537fc-7739-479c-b8bf-8a62ca55d0c9
            transform: |-
              CASE WHEN DATEDIFF(mi,s_nexus_Session_10.startdate, s_nexus_Session_10.enddate) < 360 THEN 1.0
                          ELSE 2.0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 579f4b6f-f685-4417-9b9b-a8b1a10da7bc
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: ""
        name: KNIFE_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8209517d-1798-450d-8626-c8ba9a2f2edb
                stepCounter: 839e185e-0d30-4073-b55f-88b80bf051f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec130b3b-1d02-4780-8c4b-0cd384a84a9a
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: ""
        name: IN_THEATRE_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e686239-95ae-4bdd-ab08-eb168cf58329
                stepCounter: 839e185e-0d30-4073-b55f-88b80bf051f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16960fd6-f041-4685-b313-065b364c1024
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: ""
        name: AVERAGE_TURNAROUND_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 663ef75f-f42c-4bae-bf0f-2c04e6096980
                stepCounter: 839e185e-0d30-4073-b55f-88b80bf051f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15a923a5-11fe-4159-9943-74b4ad2222bd
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: surgeon_duration
        name: SURGEON_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c1efedd-f65d-4de4-8162-5083dbd1de35
                stepCounter: 839e185e-0d30-4073-b55f-88b80bf051f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e47f3fd4-b683-4abe-846a-e1d5dd0e830e
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: session_duration
        name: SESSION_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: DATEDIFF(mi, s_nexus_Session_10.startdate,s_nexus_Session_10.enddate)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4903406d-ac7a-4846-a11a-6d26f7d40cc5
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_nexus_Session_20.session_status=dim_session_Status_Code.SessionStatusCode
        name: DIM_SESSION_STATUS_CODE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f63fd40c-747a-49ac-8718-ceb5d40e4227
                stepCounter: fb365075-c042-4627-a272-fdec881c147c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04930205-3907-4e27-bd3b-36bff6bb5231
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: SESSION_ACUTE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'N'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ec16d5f-77a1-4861-999c-c69b5d652ebe
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_nexus_Session_20.session_change_reason_reference_no=dim_session_change_reason.session_change_reason_reference_no
        name: DIM_SESSION_CHANGE_REASON_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 12aa1146-aa98-41ce-9547-d04f020ea41f
                stepCounter: 4f5cb566-54d2-47b1-ac8d-f2a5349c9dfb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e84471f7-35f2-4700-931c-3294a5551056
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_PATIENT_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f15bd786-290e-4fd5-a731-3a13291d2457
                stepCounter: 839e185e-0d30-4073-b55f-88b80bf051f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8771d030-7e93-4b62-af49-62987dea346f
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_PATIENT_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e57a3f8b-38f0-467d-b0d5-8e7b31bd8d00
                stepCounter: 839e185e-0d30-4073-b55f-88b80bf051f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 970a559b-68bd-44f5-b67a-0d18849d19b2
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: INT
        defaultValue: ""
        description: Default as Not Specified
        name: SESSION_CHANGE_REASON_REFERENCE_NO
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc6aa507-d7f9-41d1-a01b-b231f1bc10bc
                stepCounter: a58537fc-7739-479c-b8bf-8a62ca55d0c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49a75736-0dff-4a0e-a313-9c76dc962671
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: session_change_by_request_reference_no
        name: SESSION_CHANGE_BY_REQUEST_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5166ae28-045e-429a-bdc8-1441e019d042
                stepCounter: a58537fc-7739-479c-b8bf-8a62ca55d0c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3792488b-7c01-4db5-a05b-ed2ca76318ed
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_nexus_Session_20.session_change_by_request_reference_no=dim_session_change_request_by.session_change_request_by_reference_no
        name: DIM_SESSION_CHANGE_REQUEST_BY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 760341a7-371f-4ba2-8ef1-f31c1f1e7930
                stepCounter: 6da8a850-7aa5-4c45-b949-43a8f26e7679
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 947bde61-92f0-46ab-92f1-ef860b9e3969
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_CONSOLIDATE_SESSION_DELAY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b8ea767f-b9ca-4393-9508-732d3def4932
                stepCounter: a58537fc-7739-479c-b8bf-8a62ca55d0c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d63b390-6029-487e-8d11-4666257e71f0
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: create_date
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 985c7759-e8cf-4762-baf2-8a265f4720d2
                stepCounter: a58537fc-7739-479c-b8bf-8a62ca55d0c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7bfb0893-a6b8-4ac4-b73b-7f08e6cffbde
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: create_user_login_code
        name: CREATE_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7eb74ea4-b6ac-4223-9a5d-cbe79269fc20
                stepCounter: a58537fc-7739-479c-b8bf-8a62ca55d0c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2b82036-6ea6-457f-af77-e5235fb57c15
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIFY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 430f7f89-b8fd-4b04-9d24-3d35b4dc0c2b
                stepCounter: a58537fc-7739-479c-b8bf-8a62ca55d0c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc23acb8-f90b-410d-8e51-bc9f50a420a4
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: MODIFY_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3351f8ff-fa6f-4ae1-918d-41db3729d775
                stepCounter: a58537fc-7739-479c-b8bf-8a62ca55d0c9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ffee0c57-0cec-471b-b32e-df71d777d404
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: actual_session_time
        name: ACTUAL_SESSION_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN s_nexus_visit_summary.actual_operations_num > 0 AND s_nexus_Session_10.session_status = 'A' THEN DATEDIFF(mi,first_patient_into_theatre_date, last_patient_out_of_theatre_date)
                          ELSE 0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c6c5aff-6536-4ac3-81b3-5f6c9056a002
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: anaesthetic_duration
        name: ANAESTHETIC_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d4f85b2-b34e-4da8-b12f-4db94cba4998
                stepCounter: 839e185e-0d30-4073-b55f-88b80bf051f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c798384d-2f9c-4186-b769-2d4710272728
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_PRIMARY_SURGEON_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f6ab2957-a519-47f8-a879-654b61051ba3
                stepCounter: 8c462b09-f478-4ea0-81f8-b6dbe3fab303
            transform: IFNULL(dim_primary_surgeon.dim_primary_surgeon_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3f1e46c-df84-4552-94e2-93dd86578781
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_PRIMARY_ANAESTHETIST_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78ee8786-43e1-4e88-93c1-ec1c69fd8b19
                stepCounter: 6eb6705c-4746-482c-9832-9b9219afdbf0
            transform: IFNULL(dim_primary_anaesthetist.dim_primary_anaesthetist_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9081d259-649c-41c6-8836-95460bb9722e
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_THEATRE_SESSION_ANAESTHETIST_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 834809da-d74c-445c-b4c3-051be346070a
                stepCounter: 023d7582-8c0b-4c28-b4fd-9a357bc0472c
            transform: IFNULL(dim_theatre_session_Anaesthetist.dim_theatre_session_Anaesthetist_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9eaa41dc-9444-4be6-be13-a895e7f9ecab
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_THEATRE_SESSION_OWNER_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6bbe6370-abc6-4d4f-a13d-b642d3076342
                stepCounter: 9633fe26-97b6-4eeb-95f3-d0f08d8e21db
            transform: IFNULL(dim_theatre_session_owner.dim_theatre_session_owner_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ee6a114-8751-4812-b7c0-eb878144734c
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: CHAR
        defaultValue: ""
        description: a flag that states if a session is out of hours sessions e.g. sessions schedule to start at 00:00 and end before 08:30, as well as sessions starting from 16:30 and ending at 23:59 sessions.
        name: OUT_OF_HOURS_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN cast(startdate AS TIME) >= '00:00' AND cast(enddate AS TIME) <= '09:30' THEN 'Y'
                          WHEN cast(startdate AS TIME) >= '16:30' AND cast(enddate AS TIME) <= '23:59' THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9c87a0d-8d1e-4425-9cc7-bfdf857e8e0a
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: INT
        defaultValue: ""
        description: 'The diff. in minutes between ‚ÄúIFNULL(first patient ready, first_into_theatre)" and "last patient out of theatre" for a session (excluding early starts and late finishes).  Excluding out of hours sessions  '
        name: SESSION_UTILISATION_NUMERATOR
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db862a61-c38f-4b1a-9010-afbb403997c1
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: INT
        defaultValue: ""
        description: 'Elective - the scheduled theatre session minutes for sessions that have actual operations in them  Acute - the scheduled theatre session minutes for sessions that have actual operations in them.    Some sessions are set up as 00:00 to 23:59.    Can these sessions get their times adjusted to 8:30 am -> 10pm for the purpose of this calculation.  Excluding out of hours sessions  '
        name: SESSION_UTILISATION_DENOMINATOR
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bfc4d0a0-e632-40ed-8c92-f7e3088b08e7
          stepCounter: e786a67b-ba21-4d00-b61f-7e47852e03ae
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_NEXUS_SESSION_10: a58537fc-7739-479c-b8bf-8a62ca55d0c9
          DIM_ANAESTHETIST: e21b68a1-ddc0-4439-8606-f8b932ea6045
          S_NEXUS_VISIT_SUMMARY: 839e185e-0d30-4073-b55f-88b80bf051f1
          DIM_SESSION_SPECIALTY: a0af56c4-d96c-4a0c-a112-b4ca3e6b911c
          DIM_SURGICAL_THEATRE: 50d37543-6dd1-4ea0-bfe9-dc03dfc2dacc
          DIM_PRIMARY_SURGEON: 8c462b09-f478-4ea0-81f8-b6dbe3fab303
          DIM_PRIMARY_ANAESTHETIST: 6eb6705c-4746-482c-9832-9b9219afdbf0
          DIM_THEATRE_SESSION_OWNER: 9633fe26-97b6-4eeb-95f3-d0f08d8e21db
          DIM_THEATRE_SESSION_ANAESTHETIST: 023d7582-8c0b-4c28-b4fd-9a357bc0472c
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_NEXUS_SESSION_10
          - locationName: TGT
            nodeName: DIM_ANAESTHETIST
          - locationName: TGT
            nodeName: S_NEXUS_VISIT_SUMMARY
          - locationName: TGT
            nodeName: DIM_SESSION_SPECIALTY
          - locationName: TGT
            nodeName: DIM_SURGICAL_THEATRE
          - locationName: TGT
            nodeName: DIM_PRIMARY_SURGEON
          - locationName: TGT
            nodeName: DIM_PRIMARY_ANAESTHETIST
          - locationName: TGT
            nodeName: DIM_THEATRE_SESSION_OWNER
          - locationName: TGT
            nodeName: DIM_THEATRE_SESSION_ANAESTHETIST
        join:
          joinCondition: |-
            FROM {{ ref('TGT','S_NEXUS_SESSION_10') }}
              LEFT OUTER JOIN {{ ref('TGT','DIM_ANAESTHETIST') }}
                ON s_nexus_Session_10.session_anaesthetist = dim_anaesthetist.anaesthetist_code
               AND s_nexus_Session_10.startdate >= dim_anaesthetist.anaesthetist_validity_start_date
               AND s_nexus_Session_10.startdate <= dim_anaesthetist.anaesthetist_validity_end_date
               AND dim_anaesthetist.dss_current_flag = 'Y'
              LEFT OUTER JOIN {{ ref('TGT','S_NEXUS_VISIT_SUMMARY') }}
                ON s_nexus_Session_10.session_refno = s_nexus_visit_summary.theatre_session_reference_no
              LEFT OUTER JOIN {{ ref('TGT','DIM_SESSION_SPECIALTY') }}
                ON s_nexus_Session_10.specialty = dim_session_specialty.session_specialty_code
               AND dim_session_specialty.dss_current_flag ='Y'
              LEFT OUTER JOIN {{ ref('TGT','DIM_SURGICAL_THEATRE') }}
                ON s_nexus_Session_10.surgical_theatre_reference_no = dim_surgical_theatre.surgical_theatre_reference_no
              LEFT OUTER JOIN {{ ref('TGT','DIM_PRIMARY_SURGEON') }}
                ON s_nexus_Session_10.conscode = dim_primary_surgeon.primary_surgeon_code
               AND s_nexus_Session_10.startdate >= dim_primary_surgeon.primary_surgeon_validity_start_date
               AND s_nexus_Session_10.startdate <= dim_primary_surgeon.primary_surgeon_validity_end_date
               AND dim_primary_surgeon.dss_current_flag = 'Y'
              LEFT OUTER JOIN {{ ref('TGT','DIM_PRIMARY_ANAESTHETIST') }}
                ON s_nexus_Session_10.session_anaesthetist = dim_primary_anaesthetist.primary_anaesthetist_code
               AND s_nexus_Session_10.startdate >= dim_primary_anaesthetist.primary_anaesthetist_validity_start_date
               AND s_nexus_Session_10.startdate <= dim_primary_anaesthetist.primary_anaesthetist_validity_end_date
               AND dim_primary_anaesthetist.dss_current_flag = 'Y'
              LEFT OUTER JOIN {{ ref('TGT','DIM_THEATRE_SESSION_OWNER') }}
                ON s_nexus_Session_10.session_owner = dim_theatre_session_owner.healthcare_professional_code
               AND s_nexus_Session_10.startdate >= dim_theatre_session_owner.healthcare_professional_validity_start_date
               AND s_nexus_Session_10.startdate <= dim_theatre_session_owner.healthcare_professional_validity_end_date
               AND dim_theatre_session_owner.dss_current_flag = 'Y'
              LEFT OUTER JOIN {{ ref('TGT','DIM_THEATRE_SESSION_ANAESTHETIST') }}
                ON s_nexus_Session_10.session_anaesthetist = dim_theatre_session_Anaesthetist.healthcare_professional_code
               AND s_nexus_Session_10.startdate >= dim_theatre_session_Anaesthetist.Healthcare_professional_validity_start_date
               AND s_nexus_Session_10.startdate <= dim_theatre_session_Anaesthetist.Healthcare_professional_validity_end_date
               AND dim_theatre_session_Anaesthetist.dss_current_flag = 'Y'
        name: S_NEXUS_SESSION_20
        noLinkRefs: []
  name: S_NEXUS_SESSION_20
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
