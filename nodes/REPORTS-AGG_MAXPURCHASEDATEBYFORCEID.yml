fileVersion: 1
id: f489d235-5d76-48c2-9fac-ad4a07d6fb13
name: AGG_MAXPURCHASEDATEBYFORCEID
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: REPORTS
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0a3d767-5e20-4daa-af74-8cf9769ebff7
          stepCounter: f489d235-5d76-48c2-9fac-ad4a07d6fb13
        config: {}
        dataType: INT
        defaultValue: ""
        description: UNIQUE IDENTIFIER FOR AN ACCOUNT. COMMONLY CALLED THE "FORCE ID"
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a3160ab-05f3-4f3a-9c6b-05cb492a0191
                stepCounter: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 720050de-c58b-4c2a-8f57-118da6ee0c9b
          stepCounter: f489d235-5d76-48c2-9fac-ad4a07d6fb13
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c91b1397-e7de-4bdc-bf63-d9d8bbfb822e
                stepCounter: 600ce668-325b-49f6-8cab-2b74ee7ee57a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b1c89a6-855b-42d8-a155-14942506af97
          stepCounter: f489d235-5d76-48c2-9fac-ad4a07d6fb13
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: REGIONALMANAGER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72f394a3-e397-4dde-9ffd-dfd134601490
          stepCounter: f489d235-5d76-48c2-9fac-ad4a07d6fb13
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: TERRITORYGROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c2ea487-98f1-47c1-8d4e-7c5c3e33fcdb
          stepCounter: f489d235-5d76-48c2-9fac-ad4a07d6fb13
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: GROUPVPNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21334c52-3124-49c2-816b-973886959575
          stepCounter: f489d235-5d76-48c2-9fac-ad4a07d6fb13
        config: {}
        dataType: INT
        defaultValue: ""
        description: STAGEFACTSALESMERGE_1.TRANSACTIONDATE=DIMTRANSACTIONDATE.TRANSACTIONDATE
        name: TRANSACTIONDATEKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9633bd23-ea38-4260-9f7e-a79e3214fd0a
                stepCounter: 388d963b-7c6b-4464-a76a-4027878a166d
            transform: MAX(DIMTRANSACTIONDATE.TRANSACTIONDATEKEY)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f9ed15b-593b-4b0c-8bc0-f75d4f04edef
          stepCounter: f489d235-5d76-48c2-9fac-ad4a07d6fb13
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: TRANSACTIONDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cce7f7b6-81f8-4d2e-bf99-1e0a527a115f
                stepCounter: cd36f532-f0d8-47ba-b9d6-84ea35d998c4
            transform: MAX(SALESANDREVENUE.TRANSACTIONDATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c90a6abb-f5b9-4ed0-85f5-97f4d85b7675
          stepCounter: f489d235-5d76-48c2-9fac-ad4a07d6fb13
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92ca15c0-af56-46fc-9b63-9d2359a9281b
          stepCounter: f489d235-5d76-48c2-9fac-ad4a07d6fb13
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ACCOUNT: cf63e7ee-ad3f-42c5-9d06-e2eea3cdc91e
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: DIM
            nodeName: DIM_TRANSACTIONDATE
          - locationName: DIM
            nodeName: SALESTERRITORY
          - locationName: FACT
            nodeName: SALESANDREVENUE
        join:
          joinCondition: FROM {{ ref('DIM','ACCOUNT') }}
        name: AGGMAXPURCHASEDATEBYFORCEID
        noLinkRefs: []
  name: AGG_MAXPURCHASEDATEBYFORCEID
  overrideSQL: false
  schema: ""
  sqlType: Agreggate
  type: sql
  version: 1
type: Node
