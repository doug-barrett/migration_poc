fileVersion: 1
id: b764e1c7-67df-419b-8327-c2abd15cdfde
name: STAGEOPUS_PRODUCT_ADDKEYS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6e5eced-c46d-478f-9a44-97502d060966
          stepCounter: b764e1c7-67df-419b-8327-c2abd15cdfde
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: StageOPUS_PRODUCT_AddKeys.SupplierForceId=Supplier.SupplierId
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d8b7fec4-511c-4b4e-a9ac-e414b7ba81e0
                stepCounter: 9f5fdf04-d6f5-421b-90d1-773791a249c8
            transform: COALESCE(Supplier.SupplierKey,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b78bdc9-2bbd-48f4-b32b-2989cc8fe505
          stepCounter: b764e1c7-67df-419b-8327-c2abd15cdfde
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SUPPLIERFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18fcc58c-b08a-4647-b71f-ced862f3cbcc
                stepCounter: 195ef1ae-9579-4531-9c9e-c16db35f56fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3532b4c2-01ba-4975-9c49-b7522f1e649f
          stepCounter: b764e1c7-67df-419b-8327-c2abd15cdfde
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PRODUCTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f47331e2-436c-4938-9823-c8ebfb3892be
                stepCounter: 195ef1ae-9579-4531-9c9e-c16db35f56fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f867b6b3-a87f-472b-9695-4d7e6fa4728e
          stepCounter: b764e1c7-67df-419b-8327-c2abd15cdfde
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 32839a6f-e314-48c4-adf1-85874d803320
                stepCounter: 195ef1ae-9579-4531-9c9e-c16db35f56fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55c7a79f-baa5-4fb8-83c6-18a053b46382
          stepCounter: b764e1c7-67df-419b-8327-c2abd15cdfde
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SKU
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0595d933-990b-4ae8-84c3-60368fcf1928
                stepCounter: 195ef1ae-9579-4531-9c9e-c16db35f56fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9db15a48-53fd-4b93-a3b2-290e4f858007
          stepCounter: b764e1c7-67df-419b-8327-c2abd15cdfde
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c10d9313-2c89-45de-bf24-6ad0f5b6b651
                stepCounter: 195ef1ae-9579-4531-9c9e-c16db35f56fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f676bbef-d9f7-4804-b1ba-d9a381031d83
          stepCounter: b764e1c7-67df-419b-8327-c2abd15cdfde
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: IMAGE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a4a7bc2-0172-4bc1-b208-999d9e2827bb
                stepCounter: 195ef1ae-9579-4531-9c9e-c16db35f56fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8acfcb6-eb7a-4461-a532-f3227ed41d39
          stepCounter: b764e1c7-67df-419b-8327-c2abd15cdfde
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: UNSPC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7fb7fee-5dac-4128-aef8-0117126884c7
                stepCounter: 195ef1ae-9579-4531-9c9e-c16db35f56fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e4a9658-6f80-4e0b-a00d-fa542dfc51cb
          stepCounter: b764e1c7-67df-419b-8327-c2abd15cdfde
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: MODIFIEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7afaf9be-2ed2-4772-a778-a7199dac4b91
                stepCounter: 195ef1ae-9579-4531-9c9e-c16db35f56fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 339b9f52-ee1d-48cd-b0f1-331b3172a526
          stepCounter: b764e1c7-67df-419b-8327-c2abd15cdfde
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: Record source.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 975f6ef0-ace5-42a4-ae67-b075b15f9f48
                stepCounter: 195ef1ae-9579-4531-9c9e-c16db35f56fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f02fc7c8-4744-482a-ac33-ea9f2574ff82
          stepCounter: b764e1c7-67df-419b-8327-c2abd15cdfde
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LATESTPRODUCT
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ROW_NUMBER() OVER (PARTITION BY LoadOPUS_PRODUCT.SKU ORDER BY LoadOPUS_PRODUCT.MODIFIEDDATE DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71c861cb-835f-4fe7-9b3c-3445a8aa78ce
          stepCounter: b764e1c7-67df-419b-8327-c2abd15cdfde
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Load date.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84cfc3b2-adaf-4d9e-86ad-e34fa6e411c1
                stepCounter: 195ef1ae-9579-4531-9c9e-c16db35f56fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c554baf8-fb5d-4fe9-a7e5-ace86b14f94a
          stepCounter: b764e1c7-67df-419b-8327-c2abd15cdfde
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b127fc5a-e006-4056-a6ce-d11370557c50
          stepCounter: b764e1c7-67df-419b-8327-c2abd15cdfde
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOADOPUS_PRODUCT: 195ef1ae-9579-4531-9c9e-c16db35f56fc
          SUPPLIER: 9f5fdf04-d6f5-421b-90d1-773791a249c8
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: SUPPLIER
          - locationName: LOAD
            nodeName: LOADOPUS_PRODUCT
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOADOPUS_PRODUCT') }} LoadOPUS_PRODUCT
              LEFT JOIN {{ ref('DIM','SUPPLIER') }} Supplier
                ON LoadOPUS_PRODUCT.SupplierForceId = Supplier.SupplierId
        name: STAGEOPUS_PRODUCT_ADDKEYS
        noLinkRefs: []
  name: STAGEOPUS_PRODUCT_ADDKEYS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
