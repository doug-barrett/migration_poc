fileVersion: 1
id: f0be2dde-3940-421d-9f90-04013c7224fa
name: STAGEOPUS_PRODUCT_ADDKEYS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94e1b013-8478-46a2-a8d0-3dd9b954449d
          stepCounter: f0be2dde-3940-421d-9f90-04013c7224fa
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEOPUS_PRODUCT_ADDKEYS.SUPPLIERFORCEID=SUPPLIER.SUPPLIERID
        name: SUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0dbe6791-e486-4323-9105-61ec34f45e59
                stepCounter: 8d733483-4c1e-4c52-8f3e-9f99b8022f6d
            transform: COALESCE(SUPPLIER.SUPPLIERKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 427c88e9-a316-4bd9-b6db-be0804b12945
          stepCounter: f0be2dde-3940-421d-9f90-04013c7224fa
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SUPPLIERFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 20af34fa-1b19-4553-a100-fea4bff6b56b
                stepCounter: 1a817757-1a97-479d-b6e8-ba0a15984cd1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7858b0d-94c8-4bc7-9502-20cb09557bd2
          stepCounter: f0be2dde-3940-421d-9f90-04013c7224fa
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PRODUCTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 301bbbb7-0162-44c8-81a5-a215e1b46d5e
                stepCounter: 1a817757-1a97-479d-b6e8-ba0a15984cd1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 541b9795-8467-484f-a150-824e25399654
          stepCounter: f0be2dde-3940-421d-9f90-04013c7224fa
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7244fb25-d692-4bdd-bb41-670ba25b37fc
                stepCounter: 1a817757-1a97-479d-b6e8-ba0a15984cd1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6cd4872-b6d4-4c8c-91f1-f4764ad17583
          stepCounter: f0be2dde-3940-421d-9f90-04013c7224fa
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: SKU
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6fc34e57-fbe3-42dc-ba51-da6b3764b0c8
                stepCounter: 1a817757-1a97-479d-b6e8-ba0a15984cd1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40dfbe37-a919-43e7-b1a8-2b3f796b7569
          stepCounter: f0be2dde-3940-421d-9f90-04013c7224fa
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2e95ea0-a79d-46f2-805e-0eb66e1ecb5d
                stepCounter: 1a817757-1a97-479d-b6e8-ba0a15984cd1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 003fa319-cb3e-41d6-94ce-463830f72622
          stepCounter: f0be2dde-3940-421d-9f90-04013c7224fa
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: IMAGE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b65adf87-db86-45d0-aa0a-a105567ebdad
                stepCounter: 1a817757-1a97-479d-b6e8-ba0a15984cd1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c692f19-9aa5-4141-911a-d98c7ca26ba7
          stepCounter: f0be2dde-3940-421d-9f90-04013c7224fa
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: UNSPC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a8f28c75-8fc2-44c7-a4d0-7a6427a992b8
                stepCounter: 1a817757-1a97-479d-b6e8-ba0a15984cd1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 385b8104-6a87-4690-98b2-24fcf48aae1f
          stepCounter: f0be2dde-3940-421d-9f90-04013c7224fa
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: MODIFIEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd74d13f-cd7e-4725-bacf-01df261de56d
                stepCounter: 1a817757-1a97-479d-b6e8-ba0a15984cd1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e156d0b3-7acf-4fc7-a613-d62e48c052de
          stepCounter: f0be2dde-3940-421d-9f90-04013c7224fa
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 10fdd1fe-c5c2-497e-a888-74c6c0a536e0
                stepCounter: 1a817757-1a97-479d-b6e8-ba0a15984cd1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e8f1488-311e-4e81-a72d-28377a79aae5
          stepCounter: f0be2dde-3940-421d-9f90-04013c7224fa
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LATESTPRODUCT
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ROW_NUMBER() OVER (PARTITION BY LOADOPUS_PRODUCT.SKU ORDER BY LOADOPUS_PRODUCT.MODIFIEDDATE DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: afcf146f-a038-46cb-ab6c-ae818e7d4c69
          stepCounter: f0be2dde-3940-421d-9f90-04013c7224fa
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c874f509-4f46-4b24-86f8-920d61531092
                stepCounter: 1a817757-1a97-479d-b6e8-ba0a15984cd1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 485cf906-774c-4470-9d97-63a48a4cd753
          stepCounter: f0be2dde-3940-421d-9f90-04013c7224fa
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b01ec71-7ec0-4d0e-b72d-0db85e4f191f
          stepCounter: f0be2dde-3940-421d-9f90-04013c7224fa
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOADOPUS_PRODUCT: 1a817757-1a97-479d-b6e8-ba0a15984cd1
          SUPPLIER: 8d733483-4c1e-4c52-8f3e-9f99b8022f6d
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: SUPPLIER
          - locationName: LOAD
            nodeName: LOADOPUS_PRODUCT
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOADOPUS_PRODUCT') }} LOADOPUS_PRODUCT
              LEFT JOIN {{ ref('DIM','SUPPLIER') }} SUPPLIER
                ON LOADOPUS_PRODUCT.SUPPLIERFORCEID = SUPPLIER.SUPPLIERID
        name: STAGEOPUS_PRODUCT_ADDKEYS
        noLinkRefs: []
  name: STAGEOPUS_PRODUCT_ADDKEYS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
