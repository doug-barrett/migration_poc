fileVersion: 1
id: 91f446dd-4016-4505-9d8c-37d0d909d245
name: STAGEOPUS_PRODUCT_ADDKEYS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ed21a4b-635d-4ac6-b5e8-950ee19a23ed
          stepCounter: 91f446dd-4016-4505-9d8c-37d0d909d245
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEOPUS_PRODUCT_ADDKEYS.SUPPLIERFORCEID=SUPPLIER.SUPPLIERID
        name: SUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 29f4e3f6-d1f4-4347-909f-18969301d6f1
                stepCounter: f82e9572-e5ea-45e1-991d-83ad35997403
            transform: COALESCE(SUPPLIER.SUPPLIERKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8f5de8e-e6d2-4bf1-b65c-6993be70e522
          stepCounter: 91f446dd-4016-4505-9d8c-37d0d909d245
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SUPPLIERFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7979630-3df6-45c7-b57c-13ecc473804d
                stepCounter: 6f808e54-270e-4eee-b30a-5b14344f4038
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9cc3a205-fb61-43a5-af49-9725cf1b31c7
          stepCounter: 91f446dd-4016-4505-9d8c-37d0d909d245
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PRODUCTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4593dd25-93f0-44f0-b0c5-8c2aaa5b7905
                stepCounter: 6f808e54-270e-4eee-b30a-5b14344f4038
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f8f91642-1442-47d7-a0ea-e91c36623bde
          stepCounter: 91f446dd-4016-4505-9d8c-37d0d909d245
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0bebc713-280b-4fbe-a390-9e6b81f0fdb8
                stepCounter: 6f808e54-270e-4eee-b30a-5b14344f4038
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f78ee937-da3d-4b92-aee4-f1bd39bfe0c8
          stepCounter: 91f446dd-4016-4505-9d8c-37d0d909d245
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: SKU
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 32870a25-54d0-4e96-bed7-dfa6a528e6ec
                stepCounter: 6f808e54-270e-4eee-b30a-5b14344f4038
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe28723b-adb7-4fd5-9679-0d97cb3790ca
          stepCounter: 91f446dd-4016-4505-9d8c-37d0d909d245
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 344cf4c2-b241-4d63-9009-222a7b574d22
                stepCounter: 6f808e54-270e-4eee-b30a-5b14344f4038
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04b082e4-3c86-4bea-89f3-ce17e7f9cca2
          stepCounter: 91f446dd-4016-4505-9d8c-37d0d909d245
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: IMAGE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e9324ae5-7707-42da-b9c1-33069ec874e0
                stepCounter: 6f808e54-270e-4eee-b30a-5b14344f4038
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41f4b967-720b-4ba1-965d-a488e4afb2e5
          stepCounter: 91f446dd-4016-4505-9d8c-37d0d909d245
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: UNSPC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4fc4c5ff-54fb-4e4d-b63c-c99a2d7f64aa
                stepCounter: 6f808e54-270e-4eee-b30a-5b14344f4038
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b4695f5-3d41-4e39-8e0e-d6299ab2fe37
          stepCounter: 91f446dd-4016-4505-9d8c-37d0d909d245
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: MODIFIEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 55af4e9a-479f-4fb4-8213-9bb63b3933b4
                stepCounter: 6f808e54-270e-4eee-b30a-5b14344f4038
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9bf7848a-c23d-4d62-9464-1089247b4438
          stepCounter: 91f446dd-4016-4505-9d8c-37d0d909d245
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2a643324-4574-40c4-af59-b38d63cc1f93
                stepCounter: 6f808e54-270e-4eee-b30a-5b14344f4038
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 00a93ad1-c7d2-4357-b5ff-eb2a26f1622d
          stepCounter: 91f446dd-4016-4505-9d8c-37d0d909d245
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LATESTPRODUCT
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ROW_NUMBER() OVER (PARTITION BY LOADOPUS_PRODUCT.SKU ORDER BY LOADOPUS_PRODUCT.MODIFIEDDATE DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 999d9b04-e76d-4839-87f9-5fe4987fad64
          stepCounter: 91f446dd-4016-4505-9d8c-37d0d909d245
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 392c398d-f574-441f-b66d-7e030921775e
                stepCounter: 6f808e54-270e-4eee-b30a-5b14344f4038
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5e0a1d0-6e67-4fef-a829-825064ab4a22
          stepCounter: 91f446dd-4016-4505-9d8c-37d0d909d245
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e16179d8-ee07-41ad-8dc5-041966a3482f
          stepCounter: 91f446dd-4016-4505-9d8c-37d0d909d245
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOADOPUS_PRODUCT: 6f808e54-270e-4eee-b30a-5b14344f4038
          SUPPLIER: f82e9572-e5ea-45e1-991d-83ad35997403
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: SUPPLIER
          - locationName: LOAD
            nodeName: LOADOPUS_PRODUCT
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOADOPUS_PRODUCT') }} LOADOPUS_PRODUCT
              LEFT JOIN {{ ref('DIM','SUPPLIER') }} SUPPLIER
                ON LOADOPUS_PRODUCT.SUPPLIERFORCEID = SUPPLIER.SUPPLIERID
        name: STAGEOPUS_PRODUCT_ADDKEYS
        noLinkRefs: []
  name: STAGEOPUS_PRODUCT_ADDKEYS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
