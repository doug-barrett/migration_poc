fileVersion: 1
id: d540a073-ab9e-40a9-87c2-f1cf4039339c
name: S_SHARED_INPATIENT_SEEN_BY
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "In-Patient Seen-By events"
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b9c5537-9563-477d-a0e5-3fb9955c7a88
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: PRVSP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd338d02-eac7-4d45-806a-1831b0f3775b
                stepCounter: 3e756094-7e86-4086-a4af-59124cd9e961
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14fa0e83-c5e3-484d-9323-b6ca5d720f39
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59d3088d-97f2-4c53-9ebc-ae021c7b49e2
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31413a9b-9468-4e0e-aa34-55e92fa58423
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: PREVIOUS_SPEC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 970fe96c-6638-4194-abeb-4d1c9450301c
                stepCounter: 4182a75e-d07b-4637-97fa-4c01e2878360
            transform: lag(dim.dim_specialty.specialty_desc) OVER (PARTITION BY ds_pims_provider_spells.prvsp_refno ORDER BY ds_pims_prof_carer_episodes.prcae_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 160cbfc4-1003-4ba2-9860-c746f5cdcefd
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59d3088d-97f2-4c53-9ebc-ae021c7b49e2
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: "'H'+CONVERT(varchar,ds_pims_provider_spells.prvsp_refno)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2545432-5c6f-4b4e-a55d-fcbdd56ba2fd
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'H'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77270c65-b533-4f1c-a535-8d5f4d5bb350
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72c532b7-79a7-49aa-8bc0-c737daef331d
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 069d1727-fb31-4de6-8e20-b79c5c8c233d
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11ba3682-5d1a-4a53-bfaf-b4b646e6c99f
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d0d01cbd-cd96-4b93-a6c5-35ac5e4d31b9
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: SPECIALTY_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 970fe96c-6638-4194-abeb-4d1c9450301c
                stepCounter: 4182a75e-d07b-4637-97fa-4c01e2878360
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8958cdc1-7367-48df-a348-04ec10f909f7
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a06254d-d86c-4cf5-ab17-b37af0d69b0a
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d1d951fe-0150-42ef-87e3-719abbbe3868
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DISDE_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3f097725-1edd-4539-b340-14de489b6fa2
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 36a063ac-b163-4252-996a-d0eabe759080
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADCAT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4414ecc-4c91-49ec-a055-6affc8dbde9a
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4aaa9ac6-6cab-4e62-8844-ef289cbc18a2
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DISMT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a2db989-19c9-48be-ab15-47452de5e290
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95f174f0-8096-4f83-9db2-825c53aeebd8
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_PATNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f7b850f-ce72-4e87-b4f3-6e2838f4dd0a
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 99a313f2-ebff-49d1-838f-34d896ab7425
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SPELL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 393b69e1-de21-4623-b7d7-6f2de29ab3bd
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4deb524-5508-47c9-bb49-9040caa95e60
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DISCH_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 86ed21a6-3045-4fea-965e-c903428d0444
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2147fd1f-4fdb-49d6-a305-57b44b54c5fd
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1125cf7f-7027-45ac-acc8-b3a92505c4da
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: |-
              CASE WHEN ds_pims_provider_spells.admit_dttm IS NULL OR ds_pims_provider_spells.admit_dttm <= '1990-01-01' OR ds_pims_provider_spells.admit_dttm > GETDATE() OR ds_pims_provider_spells.admit_dttm > ds_pims_provider_spells.disch_dttm THEN ds_pims_provider_spells.disch_dttm
                          ELSE ds_pims_provider_spells.admit_dttm
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71b1fde1-ee88-450c-b058-1ea19b9f4a6c
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMIT_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1125cf7f-7027-45ac-acc8-b3a92505c4da
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 291bb67f-264d-4c7f-b1f6-1cbb3b864e58
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCH_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee3a67e8-1a53-44ab-aa64-cafc588de09c
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: |-
              CASE WHEN ds_pims_provider_spells.disch_dttm IS NULL OR ds_pims_provider_spells.disch_dttm <= '1990-01-01' OR ds_pims_provider_spells.disch_dttm > GETDATE() OR ds_pims_provider_spells.disch_dttm < ds_pims_provider_spells.admit_dttm THEN ds_pims_provider_spells.admit_dttm
                          ELSE ds_pims_provider_spells.disch_dttm
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8771667f-fc17-4840-aec8-8e48bf3f6b6b
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCH_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee3a67e8-1a53-44ab-aa64-cafc588de09c
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01da0e4b-e7be-447c-9b99-bb85f9ef37d9
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PROVD_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d90bc76-0f51-4903-8d16-26dce7e20db9
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71a1a5a2-c65c-4e0b-bd31-cd5677189098
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_REFERRAL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 80e5eecf-b3fb-4fc8-b661-b39389f47738
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 28d53307-d042-4756-8dc0-eddb03897035
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: AEATT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3d60c752-dcc2-482d-b5d3-e8c11f77a74f
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 824a23d2-fc94-496f-a75f-4af7b06d8099
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRIOR_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e99f6379-a2f9-4541-ad7d-af5e85d509d9
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cfa930ee-bd06-4485-97b2-bc4a1b0ada7c
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: IDENTIFIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e7ce674-a689-4f6e-b177-025b020aa1ad
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aab68aba-785b-4985-9503-eb79bc00a594
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CNTCT_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3dfd02a9-1ba2-4aa2-808e-04d07280dc1b
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e08d436-f7b8-47b7-b9e4-eaa252f2785a
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MED_DISCH_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: adf2c303-3c4f-4246-a72c-d79692864825
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a529c61d-8ece-48f1-9d72-648038f73290
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: CONSENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 300e2654-6b58-4cf5-879e-85f966675fb4
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de6af9a2-a76f-415f-98a9-833eb2d751f5
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7fb57b5-409b-4f23-8347-fe2e72525181
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed7290bc-3f7a-44d1-8d61-884b3ebc6c3b
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WLIST_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f993f650-d845-4c5d-be64-636ff53122f0
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 83e229d6-1bce-46c2-9a30-404047b93080
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAY_REFNO_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16d423a4-16bd-4684-97f3-70f79fa12fa7
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e5596f4-05eb-4a42-955c-704c72d0e9d1
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24eeb20d-18d1-4bd8-8f55-2f75643a24d3
                stepCounter: 33fe902a-f28a-4da8-b9d5-2e4311242008
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7f9040c-cb33-4b21-96d2-570de2835641
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAY_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0e8e5a25-8c99-4435-a738-7db597df5a77
                stepCounter: 33fe902a-f28a-4da8-b9d5-2e4311242008
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4da924b7-ac8b-4399-ba07-2df5fd4b7e2c
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAY_SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a8068fd6-788f-4dde-953e-deec013a0316
                stepCounter: 33fe902a-f28a-4da8-b9d5-2e4311242008
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6dfce59e-995e-4592-892c-e2d18c94683c
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 95f730b4-8836-4243-82a9-11a2c4d5e0db
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: COALESCE(ds_pims_prof_carer_episodes.spont_refno,ds_pims_service_point_stays.spont_refno,ds_pims_provider_spells.spont_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f60648b6-9633-4521-9d7e-5ae384fe0737
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_PROVD_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50e23f81-7a9f-4d70-83ad-bd3cc0768dee
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f63fb6b8-9eeb-477f-9018-cec0299addee
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5df95c6a-a9b3-4e52-9bf7-c316ce10aff4
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: IFNULL(ds_pims_prof_carer_episodes.spect_refno,ds_pims_provider_spells.spect_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e31a58cb-abad-4f3a-b406-63d518416bba
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_PURCH_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2733244a-25cd-466c-9d45-3f334086e8b6
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1faf7756-bd24-43de-9feb-dcd1d5be9862
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SORRF_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c548a454-c868-4703-93b4-5e9da8a5d9d1
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab87738c-025f-4da7-8d1b-d9d3c1f4a613
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EPISO_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 857a547e-f122-4836-a5a7-237331561a7f
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 395f3db2-e993-43a1-bb5e-67cd546f9f76
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_INMGT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8be9e4ed-efbe-4ac5-b2b9-e6443b734ffa
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c96b9ce0-9444-4245-b62a-891f58ad4e72
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_ADCAT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0be86cd3-a6cf-44e9-8243-0dae101cdee3
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a5509cd-fbbc-442e-b8b9-6106c8009534
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EPTYP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd43b3f1-5287-493e-8728-41cf83b7582e
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9871939a-7d9f-49e3-a623-788f85dba403
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: MENCT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7fdba339-43c8-485a-a6cd-fc7fc00b5368
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3711eee-42a5-4cbe-bdf7-1733ac825ba9
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_CONTR_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 41d0af3a-b91c-43b4-9ff8-07ab4c3099c2
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e2dc05b-4779-4012-b318-2dd676483052
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ATTND_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e9f18893-1090-43fc-a289-8e34deb2508a
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb97d8ca-2368-4a1d-9e7c-2dbac37227a0
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_PATCL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 171c69d1-dfdd-4cb8-95ce-f2ca8d4dd2fb
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fcdb7db0-c962-473d-b56d-09b225d413d8
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CEOCM_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 37c6568a-2041-4be3-acb2-4c317fab46eb
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69ec1f16-5f21-46bc-a33c-bf532c793776
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: INLOC_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b765a0df-5c49-4e86-b12a-c662c8da46f9
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88f5e464-4e85-4d28-9ede-4129374a3fac
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PAGRP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b0c9ed79-2673-402d-bbac-4546ac7bb430
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 73ef6202-a644-41e1-bb24-a2e335bd31c6
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_REFERRAL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c5dbb1a-c387-47be-aa77-4bee40dc904a
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: IFNULL(ds_pims_prof_carer_episodes.refrl_refno,ds_pims_provider_spells.refrl_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6278fea4-6ed0-44f5-80f7-ca071241e800
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LEGSC_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d7b3a087-ebc4-40d6-a750-4aa1d650538f
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9eff4cff-6692-4926-a01a-d6b33d46a04c
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09efde33-abec-4420-a141-695ceb3a0225
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: COALESCE(ds_pims_prof_carer_episodes.proca_refno,ds_pims_service_point_stays.proca_refno,ds_pims_provider_spells.proca_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1ab1344-0bdb-4cde-84de-ef59241b2223
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_PATNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f29f62d-c302-4832-a62a-256fea3df895
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: IFNULL(ds_pims_prof_carer_episodes.patnt_refno,ds_pims_provider_spells.patnt_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5478daf-cd44-41e3-809f-22743d78d800
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PAYMT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f7c471d-488d-4fec-ad7a-d04a6688be5c
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33cf6961-765b-4e66-9391-daedf1c48728
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: VISIT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3c2792e6-229f-401c-a1f1-1c83ffe0efd9
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 10a42cf7-15b2-410b-abb0-d3a1e6c15e08
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SEEN_BY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9b69ca26-6ec2-45d1-b0dc-8b4d97fd2184
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: |-
              CASE WHEN ds_pims_prof_carer_episodes.start_dttm IS NULL OR ds_pims_prof_carer_episodes.start_dttm <= '1990-01-01' OR ds_pims_prof_carer_episodes.start_dttm > GETDATE() OR ds_pims_prof_carer_episodes.start_dttm > ds_pims_prof_carer_episodes.end_dttm OR ds_pims_prof_carer_episodes.start_dttm < CASE WHEN ds_pims_provider_spells.admit_dttm IS NULL OR ds_pims_provider_spells.admit_dttm <= '1990-01-01' OR ds_pims_provider_spells.admit_dttm > GETDATE() THEN ds_pims_provider_spells.disch_dttm ELSE ds_pims_provider_spells.admit_dttm END THEN CASE WHEN ds_pims_provider_spells.admit_dttm IS NULL OR ds_pims_provider_spells.admit_dttm <= '1990-01-01' OR ds_pims_provider_spells.admit_dttm > GETDATE() THEN ds_pims_provider_spells.disch_dttm ELSE ds_pims_provider_spells.admit_dttm END
                          ELSE ds_pims_prof_carer_episodes.start_dttm
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ffddf7d0-eac5-4569-b89c-51b8763fddd5
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SEEN_BY_START_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9b69ca26-6ec2-45d1-b0dc-8b4d97fd2184
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8cca5004-5d12-45fc-9dab-3f59741be4a0
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: STAY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d98e645e-b2cf-4f8d-95d1-1d45aaa6fcce
                stepCounter: 33fe902a-f28a-4da8-b9d5-2e4311242008
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d3fe11d-a1e2-4dc8-8014-93cb3e7258f7
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SEEN_BY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 571e3286-f148-494c-9acc-fd1901a5dcd5
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: |-
              CASE WHEN ds_pims_prof_carer_episodes.end_dttm IS NULL OR ds_pims_prof_carer_episodes.end_dttm >= '1990-01-01' OR ds_pims_prof_carer_episodes.end_dttm > GETDATE() OR ds_pims_prof_carer_episodes.end_dttm < ds_pims_prof_carer_episodes.start_dttm OR ds_pims_prof_carer_episodes.end_dttm > CASE WHEN ds_pims_provider_spells.disch_dttm IS NULL OR ds_pims_provider_spells.disch_dttm <= '1990-01-01' OR ds_pims_provider_spells.disch_dttm > GETDATE() THEN ds_pims_provider_spells.admit_dttm ELSE ds_pims_provider_spells.disch_dttm END THEN CASE WHEN ds_pims_prof_carer_episodes.end_dttm IS NULL OR ds_pims_prof_carer_episodes.end_dttm <= '1990-01-01' OR ds_pims_prof_carer_episodes.end_dttm > GETDATE() THEN ds_pims_provider_spells.disch_dttm ELSE ds_pims_prof_carer_episodes.end_dttm END
                          ELSE ds_pims_prof_carer_episodes.end_dttm
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7fa617e4-437e-4444-b92f-71e266d11541
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SEEN_BY_END_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 571e3286-f148-494c-9acc-fd1901a5dcd5
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5127b584-3468-40b3-8a99-a83513cf7377
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: STAY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b3b399b6-cd48-42b7-8d10-914fd8747ca8
                stepCounter: 33fe902a-f28a-4da8-b9d5-2e4311242008
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 055cd78e-e69a-459b-86b1-c994110ec954
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DNARS_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f02f529-96b1-4611-a705-98e30c190e6e
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e70989b-5c54-4a08-af94-ca287d7f53bf
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_ADMET_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c811f91-5f46-485d-943e-60ab6cc737dd
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f98c80b-b029-438a-af2f-34b4e182ab65
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SEEN_BY_PRIOR_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2905698d-4365-4866-ae32-58d57032ba46
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c90ca1a-eaf1-4f19-b6c3-38dfb15995df
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SPXRL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d72a677-d668-4f8f-816a-ed394c255be6
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a68ac4b-2462-4a32-a3dc-d7f5e2a671a1
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e7fca8c-f656-4f26-b20d-acf3708f6dd8
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47e0e340-2c60-402c-9ae8-e01323a59c84
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SEEN_BY_CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50cb1693-a588-4a97-8ee6-d089e4723e45
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a683a380-3d9d-4c39-a998-525b3181fa7c
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SEEN_BY_MODIF_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c19caa38-78b0-432a-90d0-59283bb0136f
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41055719-dd7c-47d2-a20c-9777f40fe9c1
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SEEN_BY_USER_CREATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f3b7b05-c886-444a-90cc-2a902a67222e
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40f45e52-0fd1-490f-9e7d-e0307839a879
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SEEN_BY_USER_MODIF
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 363593b7-908b-4ec0-bca1-ded19c717458
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bfb9dcf1-f9dd-42cf-a612-fc5bfb082198
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: CODING_COMPLETE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6472ed1f-efd5-4571-b463-5a31dda28d94
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0baa3f09-cfd7-4b8c-bd60-307e1b85a46f
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: HRG_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e8e4ed53-0a94-4613-abfb-7473a885a64b
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ac2a233-ce6c-413b-920d-eff80d9c1111
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CTRSV_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23134338-52c9-49bc-bd5d-f602d45e6746
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9edf325-7102-4108-8ebb-37603c404fcc
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ALLCN_OVERRIDE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75226df5-d2f4-49c6-bf95-ad9161d26c82
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 90c69f04-6aa9-486b-a20d-6f53263f4a5d
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: SUMMARY_COMPLETE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c2b33cb8-a958-4483-93fc-fe5794daf717
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b26cbd77-fc1e-4d55-8fcc-a7176065abb1
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: PRVSN_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc31a4a1-ca80-43d5-b3c5-750ef805a4b4
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9829b511-d736-489f-8e84-77c65cfa47f3
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: RECTR_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ccf606de-565f-4142-9b50-7ccb6bec99eb
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f53eb0c-7ace-47a1-ba8b-dc95378171f8
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CSTAT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5785730d-7e35-4482-a6cc-0a66afe53994
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34ff5536-7814-46c4-ac0b-9f5828b8158b
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: COD_AUTH_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 373c3487-4692-47e7-bb66-406174432097
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 371c52ec-3be6-425c-ba84-b31057c09786
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: COD_AUTH_USER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ea9321a-8fa6-4542-9784-38cdcccdb6df
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03d7e653-476f-4548-a792-ed2b1bd02f24
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: COD_AUTH_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11a695e5-bc93-4f46-bbe9-f36cc89532da
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16bc795e-f70e-41f1-9e30-e972c0440cf3
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: LATCH_AUTH_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 20ba3440-9db0-40cb-9b8a-5e120340af56
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c5e48c1-2e85-40a1-9f6c-d092beb12d55
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: INVOICE_TAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce6b12d6-3ce9-41d7-bac8-dc195b145dd5
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ee51349-4894-4f8f-9bf8-72a2f027631b
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SVCAT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: addca18e-9495-4343-8ec9-10b4e6081b92
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70556a50-f43e-4909-84cb-8bd161d97415
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PTCLS_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7bb1558c-3d77-44bb-9c36-1f53b31203e8
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6124d2bd-ab9b-46f9-b172-98fef636d60d
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: RESET_PTCLS_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 53f25096-e29a-4bce-8ef1-07c8b6967e89
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fedf779e-e106-41f0-b876-249f16de25fa
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRIOR_PTCLS_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1247a0e-94df-49e1-9376-0039249f282f
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a61e6e32-3a53-4626-9ee0-b5e078ff2543
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PALST_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 623ed9cb-20c2-4dc6-a934-db48bc94a5d6
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f704da9-2b9e-47af-b894-7051b547f8a3
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DGPRO_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 96f1aab2-38cf-4178-91ad-69b8ae8d37e2
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f30c2635-f20f-4393-8fb3-4edcf381c44e
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: DECIMAL(9,4)
        defaultValue: ""
        description: ""
        name: WIES_CMX_VALUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 29fc2d57-ff52-4400-83c6-f1936f3daef2
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef59d8dc-b462-4e57-967e-d2b0011839e9
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: PTCLS_MANUAL_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6eeb05cc-a690-4f18-97c0-cb60928351eb
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a5b8861-6451-47e6-8ca0-ae84749b8f7d
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: SORCE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ac453d64-f01c-4eb4-8fde-ce0c48acc60b
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9edf1ab-d6af-4de1-85b9-99d8f5ca1d73
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SORCE_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22b0090c-80d2-4909-9a3c-584727deac64
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be95c230-fecd-4570-9d51-569a86915621
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PALCA_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea9662b2-5276-4a07-a20f-f79b374762a0
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 90ef2bd5-a585-463b-bfcd-fedc013897b6
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_SEEN_BY_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59d3088d-97f2-4c53-9ebc-ae021c7b49e2
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ROW_NUMBER() OVER (PARTITION BY ds_pims_provider_spells.prvsp_refno ORDER BY ds_pims_prof_carer_episodes.prcae_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: becfbcd3-525a-44ef-866d-b47bfb13b4c4
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_SEEN_BY_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59d3088d-97f2-4c53-9ebc-ae021c7b49e2
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: COUNT(1) OVER (PARTITION BY ds_pims_provider_spells.prvsp_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb90527e-f7ad-44fc-96db-ad0156a01281
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: dss_data_quality_code
        name: DSS_DATA_QUALITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'NONE'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a329a633-c0b5-4cda-9225-c78ad66f756a
          stepCounter: d540a073-ab9e-40a9-87c2-f1cf4039339c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_SHARED_INPATIENT_CHANGES
        join:
          joinCondition: |-
            FROM s_shared_inpatient_changes
              JOIN ds_pims_prof_carer_episodes
                ON s_shared_inpatient_changes.prvsp_refno = ds_pims_prof_carer_episodes.prvsp_refno
              JOIN ds_pims_provider_spells
                ON s_shared_inpatient_changes.prvsp_refno = ds_pims_provider_spells.prvsp_refno
              LEFT OUTER JOIN (
                    SELECT MAX(sstay_refno) sstay_refno,
                           MAX(spont_refno) spont_refno,
                           MAX(proca_refno) proca_refno,
                           MAX(start_dttm) start_dttm,
                           MAX(end_dttm) end_dttm,
                           prvsp_refno
                      FROM ds_pims_service_point_stays
                     GROUP BY prvsp_refno
                   ) ds_pims_service_point_stays
                ON ds_pims_prof_carer_episodes.prvsp_refno = ds_pims_service_point_stays.prvsp_refno
               AND (CONVERT(date, ds_pims_prof_carer_episodes.start_dttm) BETWEEN CONVERT(date, ds_pims_service_point_stays.start_dttm - 1) AND CONVERT(date, ds_pims_service_point_stays.end_dttm + 1) OR COALESCE(CONVERT(date, ds_pims_prof_carer_episodes.end_dttm), GETDATE()) BETWEEN CONVERT(date, ds_pims_service_point_stays.start_dttm - 1) AND COALESCE(CONVERT(date, ds_pims_service_point_stays.end_dttm + 1), GETDATE()))
              LEFT OUTER JOIN dim.dim_specialty
                ON IFNULL(ds_pims_prof_carer_episodes.spect_refno, ds_pims_provider_spells.spect_refno) = dim_specialty.specialty_reference_no
               AND dim_specialty.dss_current_flag = @v_dss_current_flag
             WHERE s_shared_inpatient_changes.event_changed_flag = 1
               AND ds_pims_provider_spells.prvsn_start_flag = 'N'
        name: S_SHARED_INPATIENT_SEEN_BY
        noLinkRefs: []
  name: S_SHARED_INPATIENT_SEEN_BY
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
