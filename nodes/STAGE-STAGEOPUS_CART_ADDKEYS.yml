fileVersion: 1
id: d4a6e528-8169-4137-8f52-1fa202da9ecb
name: STAGEOPUS_CART_ADDKEYS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64bb9e89-a97d-4ea1-b4a1-79a3cad964ac
          stepCounter: d4a6e528-8169-4137-8f52-1fa202da9ecb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DIMCONTACTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a73af37f-395a-43e2-ad1e-46c2fedc925a
                stepCounter: e165c76e-6a45-4567-817a-c8ecf377ecd2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5942d282-47e1-43ca-b824-a3b0a701e47d
          stepCounter: d4a6e528-8169-4137-8f52-1fa202da9ecb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: StageOPUS_CART_AddKeys.CARTID=OPUS_CART.CARTID
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPUSCARTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56b66edd-e082-4520-b0ec-0841a2804403
                stepCounter: bdadfb15-0110-46ae-8e30-70f653fd0c8a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a658b6a1-7e1f-47e1-9a56-6e1d687df425
          stepCounter: d4a6e528-8169-4137-8f52-1fa202da9ecb
        config: {}
        dataType: INT
        defaultValue: ""
        description: StageOPUS_CART_AddKeys.CustomerId=OPUS_CONTACT.CustomerId
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPUS_CONTACTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf8373b7-6487-4b03-82e7-7c357c7b7999
                stepCounter: a1714c53-65dc-4058-889d-a0edea7c661c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29795960-041a-47a2-8f40-b5f84e2b1971
          stepCounter: d4a6e528-8169-4137-8f52-1fa202da9ecb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: StageOPUS_CART_AddKeys.StageFACT_OPUS_CART.SupplierId=OPUS_SUPPLIER.SupplierOPUSId
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPUSSUPPLIERKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 92495bb3-216f-40b1-8389-02b19f311c56
                stepCounter: f4d3ca93-32bf-4539-9b82-c5c1d3869942
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae091e79-62cd-4e4c-aae8-28d2367a80cd
          stepCounter: d4a6e528-8169-4137-8f52-1fa202da9ecb
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SUPPLIERFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 82e1ae19-7206-44dd-a011-0dd68d117b88
                stepCounter: f4d3ca93-32bf-4539-9b82-c5c1d3869942
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf9c06f3-f616-4cf1-855d-77d73794cb9a
          stepCounter: d4a6e528-8169-4137-8f52-1fa202da9ecb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: StageOPUS_CART_AddKeys.PRODUCTID=OPUS_PRODUCT.PRODUCTID
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPUSPRODUCTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb5f1d8f-c184-4e6d-96e6-e0091c6e8092
                stepCounter: 601bd7d8-ec69-49fb-a0f1-9847c982e986
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 962311d5-4efa-4cd3-9ba2-67a89a09a12d
          stepCounter: d4a6e528-8169-4137-8f52-1fa202da9ecb
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ACCOUNTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 142e5dc4-d508-469e-862b-8ad4d3c7b053
                stepCounter: c278473c-12f0-41e1-b65b-faa4b3c2a978
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a360f1fa-0589-464a-ba6b-84a6a792acbc
          stepCounter: d4a6e528-8169-4137-8f52-1fa202da9ecb
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ITEMADDEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 13b38831-2108-49ba-9224-51d06ba26ef6
                stepCounter: fa1daac8-fbae-4593-bf65-5f3345c29d0f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6783d23-3839-4762-ab0e-319882634ec7
          stepCounter: d4a6e528-8169-4137-8f52-1fa202da9ecb
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ITEMMODIFIEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4642d938-274d-43d6-9125-1ca3970cc2fe
                stepCounter: fa1daac8-fbae-4593-bf65-5f3345c29d0f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d0303b21-7d43-4d10-8c2f-5f6f67adb363
          stepCounter: d4a6e528-8169-4137-8f52-1fa202da9ecb
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PRODUCTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 98f023fb-4fe2-4611-b6d0-a74cd614e50a
                stepCounter: fa1daac8-fbae-4593-bf65-5f3345c29d0f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb4fd8cb-8f3e-4760-9ad2-54a77843a380
          stepCounter: d4a6e528-8169-4137-8f52-1fa202da9ecb
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cfdf692f-2fbc-4865-b8ba-68b51035f7cd
                stepCounter: fa1daac8-fbae-4593-bf65-5f3345c29d0f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d6bc3b8-1428-486c-b472-730bda8f3f29
          stepCounter: d4a6e528-8169-4137-8f52-1fa202da9ecb
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c23ba507-1c6b-451a-9e64-8690dc720a22
                stepCounter: fa1daac8-fbae-4593-bf65-5f3345c29d0f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ecd1485-a5ac-4205-82ee-cb093236571f
          stepCounter: d4a6e528-8169-4137-8f52-1fa202da9ecb
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0745a689-dba2-49c4-946f-5977f456daca
                stepCounter: fa1daac8-fbae-4593-bf65-5f3345c29d0f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 810d9602-deb7-4423-88f5-8b5a12855a9c
          stepCounter: d4a6e528-8169-4137-8f52-1fa202da9ecb
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: CARTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d5a30a96-5c33-4433-88ed-8751cca3d0c9
                stepCounter: fa1daac8-fbae-4593-bf65-5f3345c29d0f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ee91a9d-f393-4914-ac41-5bd9a556593b
          stepCounter: d4a6e528-8169-4137-8f52-1fa202da9ecb
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: QUANTITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03d839b5-2061-4982-9d1e-2a2f311098be
                stepCounter: fa1daac8-fbae-4593-bf65-5f3345c29d0f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 127d2a1e-74c9-4c0c-8003-1eae8857eba8
          stepCounter: d4a6e528-8169-4137-8f52-1fa202da9ecb
        config: {}
        dataType: NUMBER(38,4)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eedb47c7-5aee-43a9-aacf-ebac3c5e0be1
                stepCounter: fa1daac8-fbae-4593-bf65-5f3345c29d0f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f692e879-d98e-4a10-be7e-91ef5178f624
          stepCounter: d4a6e528-8169-4137-8f52-1fa202da9ecb
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CARTSTATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe555c7b-b90b-497c-96e3-fc201757f451
                stepCounter: fa1daac8-fbae-4593-bf65-5f3345c29d0f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27b1a54e-2d1a-44c4-b854-d7bfa7814551
          stepCounter: d4a6e528-8169-4137-8f52-1fa202da9ecb
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: Record source.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f2f2b068-4a7b-47e3-971e-8dbf42fca0f5
                stepCounter: fa1daac8-fbae-4593-bf65-5f3345c29d0f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2aa49f22-20ff-4e6f-83c3-d8d7563e7694
          stepCounter: d4a6e528-8169-4137-8f52-1fa202da9ecb
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DIM_SUPPLIER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6fdeb66e-3a59-450f-9faa-5ea9e925bafd
                stepCounter: fa1daac8-fbae-4593-bf65-5f3345c29d0f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f216c3b7-d23c-4395-9c48-77fb4aab682e
          stepCounter: d4a6e528-8169-4137-8f52-1fa202da9ecb
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Load date.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84e0d352-41f5-40bb-aea3-c398976b8f03
                stepCounter: fa1daac8-fbae-4593-bf65-5f3345c29d0f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d85f784d-21d4-4fb2-9abb-319e7f6becda
          stepCounter: d4a6e528-8169-4137-8f52-1fa202da9ecb
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 132903a3-d7ef-495e-b077-2dbd98667b19
          stepCounter: d4a6e528-8169-4137-8f52-1fa202da9ecb
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGEFACT_OPUS_CART: fa1daac8-fbae-4593-bf65-5f3345c29d0f
          OPUS_CART: bdadfb15-0110-46ae-8e30-70f653fd0c8a
          CONTACT: e165c76e-6a45-4567-817a-c8ecf377ecd2
          OPUS_PRODUCT: 601bd7d8-ec69-49fb-a0f1-9847c982e986
          ACCOUNT: c278473c-12f0-41e1-b65b-faa4b3c2a978
          OPUS_CONTACT: a1714c53-65dc-4058-889d-a0edea7c661c
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: DIM
            nodeName: CONTACT
          - locationName: DIM
            nodeName: OPUS_CART
          - locationName: DIM
            nodeName: OPUS_CONTACT
          - locationName: DIM
            nodeName: OPUS_PRODUCT
          - locationName: DIM
            nodeName: OPUS_SUPPLIER
          - locationName: STAGE
            nodeName: STAGEFACT_OPUS_CART
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','STAGEFACT_OPUS_CART') }} StageFACT_OPUS_CART
              LEFT JOIN {{ ref('DIM','OPUS_CART') }} OPUS_CART
                ON StageFACT_OPUS_CART.CartId = OPUS_CART.CartId
              LEFT JOIN {{ ref('DIM','CONTACT') }} Contact
                ON StageFACT_OPUS_CART.CustomerId = Contact.OPUS_Customer_Id
              LEFT JOIN {{ ref('DIM','OPUS_PRODUCT') }} OPUS_PRODUCT
                ON StageFACT_OPUS_CART.ProductId = OPUS_PRODUCT.ProductId
              LEFT JOIN {{ ref('DIM','ACCOUNT') }} ACCOUNT
                ON StageFACT_OPUS_CART.OrganizationId = Account.OPUS_Organization_Id
              LEFT JOIN {{ ref('DIM','OPUS_CONTACT') }} OPUS_CONTACT
                ON StageFACT_OPUS_CART.CustomerId = OPUS_CONTACT.CustomerId
               AND StageFACT_OPUS_CART.OrganizationId=OPUS_CONTACT.OrganizationId
        name: STAGEOPUS_CART_ADDKEYS
        noLinkRefs: []
  name: STAGEOPUS_CART_ADDKEYS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
