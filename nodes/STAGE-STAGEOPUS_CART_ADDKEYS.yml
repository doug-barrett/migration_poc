fileVersion: 1
id: cf4355fd-8469-4542-a42c-12b393aab9c4
name: STAGEOPUS_CART_ADDKEYS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e29868fc-0ce1-4041-a568-d08b0dc74235
          stepCounter: cf4355fd-8469-4542-a42c-12b393aab9c4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DIMCONTACTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c6c95a9-173a-41a1-8a25-a73143fcc576
                stepCounter: 5fa12080-8040-4cbf-96f4-8e9c84eee853
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e393d27a-6387-4b67-aad0-f542c58ec29f
          stepCounter: cf4355fd-8469-4542-a42c-12b393aab9c4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: StageOPUS_CART_AddKeys.CARTID=OPUS_CART.CARTID
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPUSCARTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 184e306b-40e8-4457-bdf8-499065946a9f
                stepCounter: 910d8723-98c3-4495-b7d4-791e60bd1885
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a17d754a-c4fb-462b-8a37-502d628bcc1e
          stepCounter: cf4355fd-8469-4542-a42c-12b393aab9c4
        config: {}
        dataType: INT
        defaultValue: ""
        description: StageOPUS_CART_AddKeys.CustomerId=OPUS_CONTACT.CustomerId
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPUS_CONTACTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c8db74f0-c2b0-45f0-b327-a0a77a8872a9
                stepCounter: bc9fc8e9-df64-4382-9187-35501ef6eb51
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40294b9d-03b9-43ec-a947-739a129f491e
          stepCounter: cf4355fd-8469-4542-a42c-12b393aab9c4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: StageOPUS_CART_AddKeys.StageFACT_OPUS_CART.SupplierId=OPUS_SUPPLIER.SupplierOPUSId
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPUSSUPPLIERKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 603c3ffe-dae2-4135-b5c4-7fe690f68c0e
                stepCounter: 7fb2e9dd-f477-49a6-9807-bd5097b6a8f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d4e38ed-c441-42b0-8be7-20a30ff92cf0
          stepCounter: cf4355fd-8469-4542-a42c-12b393aab9c4
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SUPPLIERFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5cb3553c-0098-4df8-b603-f4b12feae885
                stepCounter: 7fb2e9dd-f477-49a6-9807-bd5097b6a8f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 220bbea2-5d9e-4407-a625-5c5b8dee07ac
          stepCounter: cf4355fd-8469-4542-a42c-12b393aab9c4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: StageOPUS_CART_AddKeys.PRODUCTID=OPUS_PRODUCT.PRODUCTID
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: OPUSPRODUCTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8fddb3a8-8581-47ad-8268-7ebe45a933fd
                stepCounter: 934f8229-8c20-4d10-8c23-f861076b653f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f6afc11-4ffb-478c-834f-f4bbdfcf4f11
          stepCounter: cf4355fd-8469-4542-a42c-12b393aab9c4
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ACCOUNTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 923f9154-d06b-4433-99fd-95c767283389
                stepCounter: a594f58e-2240-453f-a570-12719830e3d0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7a53d77-d680-49e7-9238-bf7b7e724060
          stepCounter: cf4355fd-8469-4542-a42c-12b393aab9c4
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ITEMADDEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6191da08-a2ab-4466-abf6-f458b2be46bc
                stepCounter: c73bf936-d4b4-4be5-b4ec-f8a065808a8b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ecf0bf3-7f2b-431d-8549-16a3beafa3fc
          stepCounter: cf4355fd-8469-4542-a42c-12b393aab9c4
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ITEMMODIFIEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d2e72db-c07c-4377-821b-20ce7f188782
                stepCounter: c73bf936-d4b4-4be5-b4ec-f8a065808a8b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 12c1bb10-49cd-47ba-8674-61ea26ba34a4
          stepCounter: cf4355fd-8469-4542-a42c-12b393aab9c4
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PRODUCTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d8513913-e864-4083-af04-adb0bab65e00
                stepCounter: c73bf936-d4b4-4be5-b4ec-f8a065808a8b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9e34168-deba-4a68-a924-66e2150beb03
          stepCounter: cf4355fd-8469-4542-a42c-12b393aab9c4
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 15dbf8da-5ef8-4858-bae7-13695f2b52ac
                stepCounter: c73bf936-d4b4-4be5-b4ec-f8a065808a8b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ada6a311-9609-47d5-bd2d-c779e92221a7
          stepCounter: cf4355fd-8469-4542-a42c-12b393aab9c4
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6430a7d8-db5f-45a6-a018-46d5d5755920
                stepCounter: c73bf936-d4b4-4be5-b4ec-f8a065808a8b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53d72604-2c68-4d9c-8e80-4ddfc8cd56a5
          stepCounter: cf4355fd-8469-4542-a42c-12b393aab9c4
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b54e3fc-e639-4260-b78c-77a3f0c60efa
                stepCounter: c73bf936-d4b4-4be5-b4ec-f8a065808a8b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 264b935f-578f-4dab-9941-974615200e58
          stepCounter: cf4355fd-8469-4542-a42c-12b393aab9c4
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: CARTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f63c0b27-86ae-4222-9749-7ce604760252
                stepCounter: c73bf936-d4b4-4be5-b4ec-f8a065808a8b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 89541533-a329-40bf-808a-cf53cbe2eea8
          stepCounter: cf4355fd-8469-4542-a42c-12b393aab9c4
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: QUANTITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e6c63415-1198-4c73-9485-103587614764
                stepCounter: c73bf936-d4b4-4be5-b4ec-f8a065808a8b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7a1e9af-aed0-46bd-bdb3-0e1693ef9716
          stepCounter: cf4355fd-8469-4542-a42c-12b393aab9c4
        config: {}
        dataType: NUMBER(38,4)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c782c90d-8c85-4dd4-8a94-ffc5c5625814
                stepCounter: c73bf936-d4b4-4be5-b4ec-f8a065808a8b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1602541f-3e65-4ea9-b15d-ad74cb09c3e8
          stepCounter: cf4355fd-8469-4542-a42c-12b393aab9c4
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CARTSTATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d74fbbb1-f15c-4220-917b-5728158fb031
                stepCounter: c73bf936-d4b4-4be5-b4ec-f8a065808a8b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d8bf1a4-cbbc-4140-9299-a6f87b2dcb16
          stepCounter: cf4355fd-8469-4542-a42c-12b393aab9c4
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: Record source.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 722b4aac-4efd-413f-8e78-331ea466ef95
                stepCounter: c73bf936-d4b4-4be5-b4ec-f8a065808a8b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d28b89c6-85bb-4a53-8297-b07d45832831
          stepCounter: cf4355fd-8469-4542-a42c-12b393aab9c4
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DIM_SUPPLIER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 889bb559-a29d-4518-8f3d-b55f49b6bbb2
                stepCounter: c73bf936-d4b4-4be5-b4ec-f8a065808a8b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 006f3f71-7bfd-4bc2-b2a7-7b30b98e6a39
          stepCounter: cf4355fd-8469-4542-a42c-12b393aab9c4
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Load date.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3680dcd2-4804-45aa-b186-e83e97abb780
                stepCounter: c73bf936-d4b4-4be5-b4ec-f8a065808a8b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b23e393a-6d42-4202-b587-2ba6faf98025
          stepCounter: cf4355fd-8469-4542-a42c-12b393aab9c4
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7cc1057b-e87e-4e7a-9154-ed25e5e8e1ab
          stepCounter: cf4355fd-8469-4542-a42c-12b393aab9c4
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGEFACT_OPUS_CART: c73bf936-d4b4-4be5-b4ec-f8a065808a8b
          OPUS_CART: 910d8723-98c3-4495-b7d4-791e60bd1885
          CONTACT: 5fa12080-8040-4cbf-96f4-8e9c84eee853
          OPUS_PRODUCT: 934f8229-8c20-4d10-8c23-f861076b653f
          ACCOUNT: a594f58e-2240-453f-a570-12719830e3d0
          OPUS_CONTACT: bc9fc8e9-df64-4382-9187-35501ef6eb51
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: DIM
            nodeName: CONTACT
          - locationName: DIM
            nodeName: OPUS_CART
          - locationName: DIM
            nodeName: OPUS_CONTACT
          - locationName: DIM
            nodeName: OPUS_PRODUCT
          - locationName: DIM
            nodeName: OPUS_SUPPLIER
          - locationName: STAGE
            nodeName: STAGEFACT_OPUS_CART
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','STAGEFACT_OPUS_CART') }} StageFACT_OPUS_CART
              LEFT JOIN {{ ref('DIM','OPUS_CART') }} OPUS_CART
                ON StageFACT_OPUS_CART.CartId = OPUS_CART.CartId
              LEFT JOIN {{ ref('DIM','CONTACT') }} Contact
                ON StageFACT_OPUS_CART.CustomerId = Contact.OPUS_Customer_Id
              LEFT JOIN {{ ref('DIM','OPUS_PRODUCT') }} OPUS_PRODUCT
                ON StageFACT_OPUS_CART.ProductId = OPUS_PRODUCT.ProductId
              LEFT JOIN {{ ref('DIM','ACCOUNT') }} ACCOUNT
                ON StageFACT_OPUS_CART.OrganizationId = Account.OPUS_Organization_Id
              LEFT JOIN {{ ref('DIM','OPUS_CONTACT') }} OPUS_CONTACT
                ON StageFACT_OPUS_CART.CustomerId = OPUS_CONTACT.CustomerId
               AND StageFACT_OPUS_CART.OrganizationId=OPUS_CONTACT.OrganizationId
        name: STAGEOPUS_CART_ADDKEYS
        noLinkRefs: []
  name: STAGEOPUS_CART_ADDKEYS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
