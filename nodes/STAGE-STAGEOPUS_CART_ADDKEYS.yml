fileVersion: 1
id: a5e2c3ab-f79a-429e-9d4d-f25db76ecf35
name: STAGEOPUS_CART_ADDKEYS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91fd2941-9916-4903-8819-2359f4565b46
          stepCounter: a5e2c3ab-f79a-429e-9d4d-f25db76ecf35
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: DIMCONTACTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3f8b0170-7680-48a3-8b6d-02c5d2e7d012
                stepCounter: 69bed407-4a56-4539-a027-399a1d5dc1bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a24c5e6-e735-4d0d-85d7-f42062a3885e
          stepCounter: a5e2c3ab-f79a-429e-9d4d-f25db76ecf35
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEOPUS_CART_ADDKEYS.CARTID=OPUS_CART.CARTID
        name: OPUSCARTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b0dd98e4-9e71-4732-8edd-ec24b56ccab3
                stepCounter: 06507037-35ca-47d4-a17f-3aa4490482f1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 52de561d-75c9-4be4-bdb1-b5b5d60818cd
          stepCounter: a5e2c3ab-f79a-429e-9d4d-f25db76ecf35
        config: {}
        dataType: INT
        defaultValue: ""
        description: STAGEOPUS_CART_ADDKEYS.CUSTOMERID=OPUS_CONTACT.CUSTOMERID
        name: OPUS_CONTACTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 25c9e286-e8b7-4519-9df4-4e5208ac087e
                stepCounter: 3988039f-a827-4207-aa98-2ae88da5c868
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a905de4b-a14d-491d-8e05-e9f1419c7c3d
          stepCounter: a5e2c3ab-f79a-429e-9d4d-f25db76ecf35
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEOPUS_CART_ADDKEYS.STAGEFACT_OPUS_CART.SUPPLIERID=OPUS_SUPPLIER.SUPPLIEROPUSID
        name: OPUSSUPPLIERKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 771e6817-e54a-430a-87a4-50ee15fb2d1c
                stepCounter: ee7f1895-c11d-4da2-81d2-a34aa558b65c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 37d9d757-bf4a-40e2-8336-56b49a57b750
          stepCounter: a5e2c3ab-f79a-429e-9d4d-f25db76ecf35
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SUPPLIERFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7fd1ecf6-b0a1-4a5f-a26e-3a1f505cb6c4
                stepCounter: ee7f1895-c11d-4da2-81d2-a34aa558b65c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f57387c-6b1d-42e5-b62d-bb2f4bfad25d
          stepCounter: a5e2c3ab-f79a-429e-9d4d-f25db76ecf35
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEOPUS_CART_ADDKEYS.PRODUCTID=OPUS_PRODUCT.PRODUCTID
        name: OPUSPRODUCTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 610408dc-08b7-46f2-83a2-edff23a9575a
                stepCounter: 3c136768-fb84-4332-a4df-1882e24f47c8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94669d51-f21c-457b-924c-69e7de35a5c6
          stepCounter: a5e2c3ab-f79a-429e-9d4d-f25db76ecf35
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: ACCOUNTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd325e05-7e18-499b-bd60-b3144ec04cb9
                stepCounter: e6f00723-a598-4272-b25a-ed544e4c0a06
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 35ec5a52-c037-4c5f-bfb6-367f1c685500
          stepCounter: a5e2c3ab-f79a-429e-9d4d-f25db76ecf35
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: ITEMADDEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9425a798-4ba8-48fe-88ae-23d5fa6f95a9
                stepCounter: f06e376b-94b8-4642-b335-90f19709ad22
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8772b7f-27bf-4a5f-981d-daaabbfb02c0
          stepCounter: a5e2c3ab-f79a-429e-9d4d-f25db76ecf35
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: ITEMMODIFIEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 593679cc-749c-433a-9a44-a0e07dacf61d
                stepCounter: f06e376b-94b8-4642-b335-90f19709ad22
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8966305c-478f-4c93-9d30-98cf64fb4318
          stepCounter: a5e2c3ab-f79a-429e-9d4d-f25db76ecf35
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PRODUCTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21e54389-c042-42ff-bce8-7ae77cd4182b
                stepCounter: f06e376b-94b8-4642-b335-90f19709ad22
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2201a876-124a-42f2-b08a-60106eb40e9b
          stepCounter: a5e2c3ab-f79a-429e-9d4d-f25db76ecf35
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0e5aef17-5444-4232-8f31-113106315241
                stepCounter: f06e376b-94b8-4642-b335-90f19709ad22
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6fb2106c-0123-4fab-a891-73375b098f95
          stepCounter: a5e2c3ab-f79a-429e-9d4d-f25db76ecf35
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee01acf4-e16f-48da-9c07-21ff41b9dcc7
                stepCounter: f06e376b-94b8-4642-b335-90f19709ad22
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 007d07ee-c5bd-4a8a-9e2e-aff2950d0dd6
          stepCounter: a5e2c3ab-f79a-429e-9d4d-f25db76ecf35
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c897d186-97a9-4b87-b05b-766713213802
                stepCounter: f06e376b-94b8-4642-b335-90f19709ad22
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1bd6ac37-c03f-4332-8ab3-d15587405855
          stepCounter: a5e2c3ab-f79a-429e-9d4d-f25db76ecf35
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: CARTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 62e081fd-7ce7-4b12-bb2c-9999f152b28c
                stepCounter: f06e376b-94b8-4642-b335-90f19709ad22
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: afaeb035-2b36-4e95-8942-f571688fc72e
          stepCounter: a5e2c3ab-f79a-429e-9d4d-f25db76ecf35
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: QUANTITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a8183c81-ad9b-43f0-b0de-55afa477b78f
                stepCounter: f06e376b-94b8-4642-b335-90f19709ad22
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 110ef6b1-609e-47c9-883a-a0ad32ac965b
          stepCounter: a5e2c3ab-f79a-429e-9d4d-f25db76ecf35
        config: {}
        dataType: NUMBER(38,4)
        defaultValue: ""
        description: ""
        name: PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 97a911a9-5f8c-4ce3-8630-d8027f326ef3
                stepCounter: f06e376b-94b8-4642-b335-90f19709ad22
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a0751d7d-4245-4779-aace-153dd993f3d7
          stepCounter: a5e2c3ab-f79a-429e-9d4d-f25db76ecf35
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CARTSTATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: da9b7e9f-db3c-485c-a645-68daed2970b1
                stepCounter: f06e376b-94b8-4642-b335-90f19709ad22
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7eaafc37-a809-441a-8017-791f1e882c37
          stepCounter: a5e2c3ab-f79a-429e-9d4d-f25db76ecf35
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec4548f6-86c8-46dd-9d91-f609dafac62e
                stepCounter: f06e376b-94b8-4642-b335-90f19709ad22
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fbae0db5-fbb5-44d6-a760-111e545783c1
          stepCounter: a5e2c3ab-f79a-429e-9d4d-f25db76ecf35
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: DIM_SUPPLIER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 68db792e-f167-471d-9bfa-cc8213fe1018
                stepCounter: f06e376b-94b8-4642-b335-90f19709ad22
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49c8e075-1cb4-45d6-a227-c67819a326fc
          stepCounter: a5e2c3ab-f79a-429e-9d4d-f25db76ecf35
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 359b4438-0df0-477c-929d-ec4d688e0c42
                stepCounter: f06e376b-94b8-4642-b335-90f19709ad22
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf8c90bc-49c6-44ab-ba94-e0e3e2e179c7
          stepCounter: a5e2c3ab-f79a-429e-9d4d-f25db76ecf35
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2692b9b0-c8bf-4740-97a8-19e8cab10948
          stepCounter: a5e2c3ab-f79a-429e-9d4d-f25db76ecf35
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGEFACT_OPUS_CART: f06e376b-94b8-4642-b335-90f19709ad22
          OPUS_CART: 06507037-35ca-47d4-a17f-3aa4490482f1
          CONTACT: 69bed407-4a56-4539-a027-399a1d5dc1bb
          OPUS_PRODUCT: 3c136768-fb84-4332-a4df-1882e24f47c8
          ACCOUNT: e6f00723-a598-4272-b25a-ed544e4c0a06
          OPUS_CONTACT: 3988039f-a827-4207-aa98-2ae88da5c868
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: DIM
            nodeName: CONTACT
          - locationName: DIM
            nodeName: OPUS_CART
          - locationName: DIM
            nodeName: OPUS_CONTACT
          - locationName: DIM
            nodeName: OPUS_PRODUCT
          - locationName: DIM
            nodeName: OPUS_SUPPLIER
          - locationName: STAGE
            nodeName: STAGEFACT_OPUS_CART
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','STAGEFACT_OPUS_CART') }} STAGEFACT_OPUS_CART
              LEFT JOIN {{ ref('DIM','OPUS_CART') }} OPUS_CART
                ON STAGEFACT_OPUS_CART.CARTID = OPUS_CART.CARTID
              LEFT JOIN {{ ref('DIM','CONTACT') }} CONTACT
                ON STAGEFACT_OPUS_CART.CUSTOMERID = CONTACT.OPUS_CUSTOMER_ID
              LEFT JOIN {{ ref('DIM','OPUS_PRODUCT') }} OPUS_PRODUCT
                ON STAGEFACT_OPUS_CART.PRODUCTID = OPUS_PRODUCT.PRODUCTID
              LEFT JOIN {{ ref('DIM','ACCOUNT') }} ACCOUNT
                ON STAGEFACT_OPUS_CART.ORGANIZATIONID = ACCOUNT.OPUS_ORGANIZATION_ID
              LEFT JOIN {{ ref('DIM','OPUS_CONTACT') }} OPUS_CONTACT
                ON STAGEFACT_OPUS_CART.CUSTOMERID = OPUS_CONTACT.CUSTOMERID
               AND STAGEFACT_OPUS_CART.ORGANIZATIONID=OPUS_CONTACT.ORGANIZATIONID
        name: STAGEOPUS_CART_ADDKEYS
        noLinkRefs: []
  name: STAGEOPUS_CART_ADDKEYS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
