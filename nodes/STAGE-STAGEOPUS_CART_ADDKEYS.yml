fileVersion: 1
id: febf1fad-781d-44c2-ad85-2e095d28777f
name: STAGEOPUS_CART_ADDKEYS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e3eb28b-3485-43d1-a35b-7f54fd00f8d1
          stepCounter: febf1fad-781d-44c2-ad85-2e095d28777f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: DIMCONTACTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dcf753c9-6ce6-4287-960d-d7a6b21b22fc
                stepCounter: d056aba3-a0b9-4509-9a27-e51f9da7fe1b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c7c74b84-9e10-44ef-8212-a1f6d5c9a3b5
          stepCounter: febf1fad-781d-44c2-ad85-2e095d28777f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEOPUS_CART_ADDKEYS.CARTID=OPUS_CART.CARTID
        name: OPUSCARTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3905c792-e1ba-409b-bf1f-38c663098a8d
                stepCounter: 625443fe-16ff-4435-ae20-b1b1c489bf1e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 792eb822-10ca-49b3-84d8-162bee28eecc
          stepCounter: febf1fad-781d-44c2-ad85-2e095d28777f
        config: {}
        dataType: INT
        defaultValue: ""
        description: STAGEOPUS_CART_ADDKEYS.CUSTOMERID=OPUS_CONTACT.CUSTOMERID
        name: OPUS_CONTACTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3434011d-d965-4acb-b578-87fe620ca288
                stepCounter: c0d5aa6a-a938-447b-8e2e-a1e53d310fc4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 206a1bd8-6d22-4a42-a8a6-0f9728dca022
          stepCounter: febf1fad-781d-44c2-ad85-2e095d28777f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEOPUS_CART_ADDKEYS.STAGEFACT_OPUS_CART.SUPPLIERID=OPUS_SUPPLIER.SUPPLIEROPUSID
        name: OPUSSUPPLIERKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3d1ff80d-7379-4792-8999-53104514e50f
                stepCounter: 433e71b5-067e-4283-a8d2-3f73351f62ac
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4c01d60-4727-4e2d-92e9-a1446ff1c68e
          stepCounter: febf1fad-781d-44c2-ad85-2e095d28777f
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SUPPLIERFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd45c1b3-f5f5-45aa-8b0d-4efefa0094a9
                stepCounter: 433e71b5-067e-4283-a8d2-3f73351f62ac
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 90089737-bf92-4906-8055-60c59fbd6068
          stepCounter: febf1fad-781d-44c2-ad85-2e095d28777f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEOPUS_CART_ADDKEYS.PRODUCTID=OPUS_PRODUCT.PRODUCTID
        name: OPUSPRODUCTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39cd8d04-a0c1-4570-af6a-3ef5193e0188
                stepCounter: f0f25bb4-d26f-4e2a-9e67-429aa61f0625
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b0c50dc-13f7-43b5-9c19-7e4b3e0a2311
          stepCounter: febf1fad-781d-44c2-ad85-2e095d28777f
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: ACCOUNTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bae9c318-63c2-4058-8e74-f5509f5b4522
                stepCounter: d5234d5a-eb19-45e2-9c42-47221579f347
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b610a031-5186-44fb-98cd-4c6d9dd098c9
          stepCounter: febf1fad-781d-44c2-ad85-2e095d28777f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: ITEMADDEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 86cc8ccb-af66-47bf-9337-133a6929df56
                stepCounter: fdb22d74-f80c-4cd8-856a-8d73a461a427
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 355ed3a0-15ba-4c77-8a2f-fe532f67db64
          stepCounter: febf1fad-781d-44c2-ad85-2e095d28777f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: ITEMMODIFIEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2e4faebd-d980-44da-8ad0-0cb5b1be5f1b
                stepCounter: fdb22d74-f80c-4cd8-856a-8d73a461a427
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f41efdad-cb41-46be-a85a-170f61153f25
          stepCounter: febf1fad-781d-44c2-ad85-2e095d28777f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PRODUCTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f75048ce-3b7e-475b-a2c6-54855e20d7f7
                stepCounter: fdb22d74-f80c-4cd8-856a-8d73a461a427
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 276e413c-aa55-4f9c-adc7-f526d98ad7f9
          stepCounter: febf1fad-781d-44c2-ad85-2e095d28777f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1de0105-7561-44c2-9c7b-aac218bd05d5
                stepCounter: fdb22d74-f80c-4cd8-856a-8d73a461a427
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3982944-6291-45ea-aa5f-7f85a5bd1cb7
          stepCounter: febf1fad-781d-44c2-ad85-2e095d28777f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8527e499-e612-4029-be2a-563ed454238c
                stepCounter: fdb22d74-f80c-4cd8-856a-8d73a461a427
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5773e4cb-d413-4401-aa87-e699d52a0826
          stepCounter: febf1fad-781d-44c2-ad85-2e095d28777f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8c5d212-e287-4acb-8bb9-190c33ba8ba6
                stepCounter: fdb22d74-f80c-4cd8-856a-8d73a461a427
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9997723-36ca-4434-8330-e410fcf96682
          stepCounter: febf1fad-781d-44c2-ad85-2e095d28777f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: CARTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cf05f650-c344-42f5-b34a-bc6ff8f0d8e8
                stepCounter: fdb22d74-f80c-4cd8-856a-8d73a461a427
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce7c327b-97c9-4846-80f7-ab58a791bd43
          stepCounter: febf1fad-781d-44c2-ad85-2e095d28777f
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: QUANTITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eb9349d7-850e-451c-8abb-93261f988664
                stepCounter: fdb22d74-f80c-4cd8-856a-8d73a461a427
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0cfd4d92-c174-4b80-a9b4-9e9182678d4d
          stepCounter: febf1fad-781d-44c2-ad85-2e095d28777f
        config: {}
        dataType: NUMBER(38,4)
        defaultValue: ""
        description: ""
        name: PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cdbc8569-4e0d-482d-9855-18b0c412ad17
                stepCounter: fdb22d74-f80c-4cd8-856a-8d73a461a427
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1c9f7cf-44ff-46c9-ba93-a89b018be40e
          stepCounter: febf1fad-781d-44c2-ad85-2e095d28777f
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CARTSTATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9ac5b398-b182-471e-9c16-4ae19223ae7f
                stepCounter: fdb22d74-f80c-4cd8-856a-8d73a461a427
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8056bd6c-a967-48b7-bb2c-bac99c3a368a
          stepCounter: febf1fad-781d-44c2-ad85-2e095d28777f
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3cbcca48-55fd-468f-8869-680120f04cf7
                stepCounter: fdb22d74-f80c-4cd8-856a-8d73a461a427
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 28da2999-528f-4e7c-a7dd-d9338fc53a26
          stepCounter: febf1fad-781d-44c2-ad85-2e095d28777f
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: DIM_SUPPLIER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f0230fa-043b-42e1-b055-6fff7c01784e
                stepCounter: fdb22d74-f80c-4cd8-856a-8d73a461a427
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 10f5ea2a-0f9e-4db9-93da-8dfbd0624784
          stepCounter: febf1fad-781d-44c2-ad85-2e095d28777f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19270a91-252a-42ff-85d0-ac89162648b3
                stepCounter: fdb22d74-f80c-4cd8-856a-8d73a461a427
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31158648-496d-421a-aec1-47cab67a684b
          stepCounter: febf1fad-781d-44c2-ad85-2e095d28777f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 280fc412-9968-4b33-887d-fd945a04d455
          stepCounter: febf1fad-781d-44c2-ad85-2e095d28777f
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGEFACT_OPUS_CART: fdb22d74-f80c-4cd8-856a-8d73a461a427
          OPUS_CART: 625443fe-16ff-4435-ae20-b1b1c489bf1e
          CONTACT: d056aba3-a0b9-4509-9a27-e51f9da7fe1b
          OPUS_PRODUCT: f0f25bb4-d26f-4e2a-9e67-429aa61f0625
          ACCOUNT: d5234d5a-eb19-45e2-9c42-47221579f347
          OPUS_CONTACT: c0d5aa6a-a938-447b-8e2e-a1e53d310fc4
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: DIM
            nodeName: CONTACT
          - locationName: DIM
            nodeName: OPUS_CART
          - locationName: DIM
            nodeName: OPUS_CONTACT
          - locationName: DIM
            nodeName: OPUS_PRODUCT
          - locationName: DIM
            nodeName: OPUS_SUPPLIER
          - locationName: STAGE
            nodeName: STAGEFACT_OPUS_CART
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','STAGEFACT_OPUS_CART') }} STAGEFACT_OPUS_CART
              LEFT JOIN {{ ref('DIM','OPUS_CART') }} OPUS_CART
                ON STAGEFACT_OPUS_CART.CARTID = OPUS_CART.CARTID
              LEFT JOIN {{ ref('DIM','CONTACT') }} CONTACT
                ON STAGEFACT_OPUS_CART.CUSTOMERID = CONTACT.OPUS_CUSTOMER_ID
              LEFT JOIN {{ ref('DIM','OPUS_PRODUCT') }} OPUS_PRODUCT
                ON STAGEFACT_OPUS_CART.PRODUCTID = OPUS_PRODUCT.PRODUCTID
              LEFT JOIN {{ ref('DIM','ACCOUNT') }} ACCOUNT
                ON STAGEFACT_OPUS_CART.ORGANIZATIONID = ACCOUNT.OPUS_ORGANIZATION_ID
              LEFT JOIN {{ ref('DIM','OPUS_CONTACT') }} OPUS_CONTACT
                ON STAGEFACT_OPUS_CART.CUSTOMERID = OPUS_CONTACT.CUSTOMERID
               AND STAGEFACT_OPUS_CART.ORGANIZATIONID=OPUS_CONTACT.ORGANIZATIONID
        name: STAGEOPUS_CART_ADDKEYS
        noLinkRefs: []
  name: STAGEOPUS_CART_ADDKEYS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
