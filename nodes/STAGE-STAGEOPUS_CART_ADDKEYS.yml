fileVersion: 1
id: f29a2ca1-e3fe-409e-b46a-8831ce5c9d64
name: STAGEOPUS_CART_ADDKEYS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8b79f88-62f3-4e8e-8be7-4bfe9f4365c7
          stepCounter: f29a2ca1-e3fe-409e-b46a-8831ce5c9d64
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: DIMCONTACTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dcf5f781-2b00-4e01-9503-c981ed1ab780
                stepCounter: 4015cdd7-ddd6-45b0-996c-53903de48f6b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 036b677c-042e-4b64-9b4a-c7d1935a27ab
          stepCounter: f29a2ca1-e3fe-409e-b46a-8831ce5c9d64
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEOPUS_CART_ADDKEYS.CARTID=OPUS_CART.CARTID
        name: OPUSCARTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d4ffa5b4-12a2-42c8-ac2f-58b4d0ef0638
                stepCounter: b82c2f85-3de1-4ac3-bf9e-379eb53cc591
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 942a8e25-2a7a-4c35-896a-ea99ccec8a5b
          stepCounter: f29a2ca1-e3fe-409e-b46a-8831ce5c9d64
        config: {}
        dataType: INT
        defaultValue: ""
        description: STAGEOPUS_CART_ADDKEYS.CUSTOMERID=OPUS_CONTACT.CUSTOMERID
        name: OPUS_CONTACTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b5116a58-7724-4f00-90f8-2b858596359a
                stepCounter: b85c7819-29df-44d8-8ca6-ce58cb2bf7ae
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ffe4c186-ebe4-443e-9d38-33e9d5a12318
          stepCounter: f29a2ca1-e3fe-409e-b46a-8831ce5c9d64
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEOPUS_CART_ADDKEYS.STAGEFACT_OPUS_CART.SUPPLIERID=OPUS_SUPPLIER.SUPPLIEROPUSID
        name: OPUSSUPPLIERKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: be905c6f-acd8-4701-8431-32f0def6ec2e
                stepCounter: 4a40fd64-d675-4ba5-9c42-93e3222d3fbd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae30d6b8-6448-431b-b6d1-fac9642da498
          stepCounter: f29a2ca1-e3fe-409e-b46a-8831ce5c9d64
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SUPPLIERFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1bcc706b-9e89-4fa7-8473-a804172084cb
                stepCounter: 4a40fd64-d675-4ba5-9c42-93e3222d3fbd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 849de88a-b43f-4ef0-8f41-fe936938efe1
          stepCounter: f29a2ca1-e3fe-409e-b46a-8831ce5c9d64
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEOPUS_CART_ADDKEYS.PRODUCTID=OPUS_PRODUCT.PRODUCTID
        name: OPUSPRODUCTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db8301c3-d64e-47ef-a3aa-ebca06657c4a
                stepCounter: ded28e11-487f-4827-943b-81fd3ec6c65e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee504a06-cccc-4290-bd81-54a1f2034d78
          stepCounter: f29a2ca1-e3fe-409e-b46a-8831ce5c9d64
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: GENERATED ARTIFICIAL KEY
        name: ACCOUNTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51242f2b-12a0-45ea-bdfb-000fdb4c550a
                stepCounter: 96e8695b-6733-4729-8797-91b12c74cb7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3a18dc8-6d55-4d8e-8309-94a843b21847
          stepCounter: f29a2ca1-e3fe-409e-b46a-8831ce5c9d64
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: ITEMADDEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6007a711-b4db-4cf8-91f3-5766a7fb76be
                stepCounter: 120c4c97-69d4-42a7-94e3-53c06431fd76
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b853f148-fcf8-4eaf-8ff7-60ef4eabacce
          stepCounter: f29a2ca1-e3fe-409e-b46a-8831ce5c9d64
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: ITEMMODIFIEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 85767cc6-2f8b-431f-a913-fec305e179bb
                stepCounter: 120c4c97-69d4-42a7-94e3-53c06431fd76
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1fd959c-de01-46f9-bdd0-b507a2e82ff2
          stepCounter: f29a2ca1-e3fe-409e-b46a-8831ce5c9d64
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PRODUCTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e8c234df-1d78-4c32-ab9e-bd6dcdf2e479
                stepCounter: 120c4c97-69d4-42a7-94e3-53c06431fd76
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ffcf2c90-98af-4dd4-b75a-14da98b7ea85
          stepCounter: f29a2ca1-e3fe-409e-b46a-8831ce5c9d64
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db3ba96d-41ea-41a9-99ed-0d4c9c18a350
                stepCounter: 120c4c97-69d4-42a7-94e3-53c06431fd76
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6464c4e7-1501-4672-95d6-674291280bdb
          stepCounter: f29a2ca1-e3fe-409e-b46a-8831ce5c9d64
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f1e4a2c-a549-44c2-8aec-769b746f7668
                stepCounter: 120c4c97-69d4-42a7-94e3-53c06431fd76
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe278b96-affe-412e-818f-8302d7be064a
          stepCounter: f29a2ca1-e3fe-409e-b46a-8831ce5c9d64
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db725b42-686f-4ba6-8c35-2a19e6a1b39e
                stepCounter: 120c4c97-69d4-42a7-94e3-53c06431fd76
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef226b87-5f04-4c89-9566-89c79142d467
          stepCounter: f29a2ca1-e3fe-409e-b46a-8831ce5c9d64
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: CARTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eed1d6ec-b09e-4158-b4b2-c354f2f52922
                stepCounter: 120c4c97-69d4-42a7-94e3-53c06431fd76
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2df758b2-4fe3-49c5-aa28-5d1d17418a3d
          stepCounter: f29a2ca1-e3fe-409e-b46a-8831ce5c9d64
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: ""
        name: QUANTITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 69d18327-86ed-45a7-b9b3-8796b98d5b18
                stepCounter: 120c4c97-69d4-42a7-94e3-53c06431fd76
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0757f40d-a0cf-409a-9fa7-126c57b0666a
          stepCounter: f29a2ca1-e3fe-409e-b46a-8831ce5c9d64
        config: {}
        dataType: NUMBER(38,4)
        defaultValue: ""
        description: ""
        name: PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c9bb163-4930-4e67-8e6b-981f614fab1a
                stepCounter: 120c4c97-69d4-42a7-94e3-53c06431fd76
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9da0de98-4c14-43e6-b1f3-077e36dce3e2
          stepCounter: f29a2ca1-e3fe-409e-b46a-8831ce5c9d64
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CARTSTATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33727927-8070-41a8-9253-d6d006cd69ef
                stepCounter: 120c4c97-69d4-42a7-94e3-53c06431fd76
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 58d449c5-795f-421b-9715-23ac11e54b95
          stepCounter: f29a2ca1-e3fe-409e-b46a-8831ce5c9d64
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1842bbba-37cd-4de6-9068-6879e7e0198c
                stepCounter: 120c4c97-69d4-42a7-94e3-53c06431fd76
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72e4f5be-8bc9-4ea6-bf36-86a80fe3c3e9
          stepCounter: f29a2ca1-e3fe-409e-b46a-8831ce5c9d64
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: DIM_SUPPLIER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 04c1956a-1eed-495c-8b7d-85f1baa6cbcb
                stepCounter: 120c4c97-69d4-42a7-94e3-53c06431fd76
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd58a29f-7b49-4910-8ae9-eeb6a4fbaa89
          stepCounter: f29a2ca1-e3fe-409e-b46a-8831ce5c9d64
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56ef9177-6f7e-4018-9e13-afe66b4f3dab
                stepCounter: 120c4c97-69d4-42a7-94e3-53c06431fd76
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ac03063-4066-4a71-a709-94824ef89554
          stepCounter: f29a2ca1-e3fe-409e-b46a-8831ce5c9d64
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb28d3c6-b556-4abc-b451-ce09a63640de
          stepCounter: f29a2ca1-e3fe-409e-b46a-8831ce5c9d64
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGEFACT_OPUS_CART: 120c4c97-69d4-42a7-94e3-53c06431fd76
          OPUS_CART: b82c2f85-3de1-4ac3-bf9e-379eb53cc591
          CONTACT: 4015cdd7-ddd6-45b0-996c-53903de48f6b
          OPUS_PRODUCT: ded28e11-487f-4827-943b-81fd3ec6c65e
          ACCOUNT: 96e8695b-6733-4729-8797-91b12c74cb7e
          OPUS_CONTACT: b85c7819-29df-44d8-8ca6-ce58cb2bf7ae
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: DIM
            nodeName: CONTACT
          - locationName: DIM
            nodeName: OPUS_CART
          - locationName: DIM
            nodeName: OPUS_CONTACT
          - locationName: DIM
            nodeName: OPUS_PRODUCT
          - locationName: DIM
            nodeName: OPUS_SUPPLIER
          - locationName: STAGE
            nodeName: STAGEFACT_OPUS_CART
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','STAGEFACT_OPUS_CART') }} STAGEFACT_OPUS_CART
              LEFT JOIN {{ ref('DIM','OPUS_CART') }} OPUS_CART
                ON STAGEFACT_OPUS_CART.CARTID = OPUS_CART.CARTID
              LEFT JOIN {{ ref('DIM','CONTACT') }} CONTACT
                ON STAGEFACT_OPUS_CART.CUSTOMERID = CONTACT.OPUS_CUSTOMER_ID
              LEFT JOIN {{ ref('DIM','OPUS_PRODUCT') }} OPUS_PRODUCT
                ON STAGEFACT_OPUS_CART.PRODUCTID = OPUS_PRODUCT.PRODUCTID
              LEFT JOIN {{ ref('DIM','ACCOUNT') }} ACCOUNT
                ON STAGEFACT_OPUS_CART.ORGANIZATIONID = ACCOUNT.OPUS_ORGANIZATION_ID
              LEFT JOIN {{ ref('DIM','OPUS_CONTACT') }} OPUS_CONTACT
                ON STAGEFACT_OPUS_CART.CUSTOMERID = OPUS_CONTACT.CUSTOMERID
               AND STAGEFACT_OPUS_CART.ORGANIZATIONID=OPUS_CONTACT.ORGANIZATIONID
        name: STAGEOPUS_CART_ADDKEYS
        noLinkRefs: []
  name: STAGEOPUS_CART_ADDKEYS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
