fileVersion: 1
id: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
name: S_IN_PATIENT_EVENT_PREV_NEXT_V
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a3374ce-175c-44d0-af98-601584ba1742
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 31275077-fdc5-4150-93e4-19d39242f442
                stepCounter: a7d7c8ec-88ee-49a8-b500-e3f4bce83e59
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a672d692-ac7e-40a3-91d7-87bdab645009
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 01c61f5c-21f8-498c-8a9a-3bf9fc714db7
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e502a774-6f65-4834-b106-179e80aae9b9
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CUR_PATIENT_VISIT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a922329a-2910-4468-886a-e58071bce6cb
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: CUR_EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7deec135-abb4-474c-b0ed-7c772ea7c41c
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CUR_EVENT_ADMISSION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26f69333-d591-470a-94be-1cf32d16816e
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CUR_EVENT_DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3afb8702-238e-403e-b333-ba0e70b2ad53
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: CUR_HEALTHCARE_PROFESSIONAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b576590-9b22-4831-a7b4-d48dd4b6b63c
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CUR_HEALTHCARE_PROFESSIONAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 416b8d16-1f78-4777-9795-539fcd54e323
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: CUR_SERVICE_POINT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b0df454-57cf-4357-aee1-cffad44a160b
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CUR_SERVICE_POINT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cabd98b0-770d-47ec-8170-f1ac9247342f
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: CUR_HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96a4b148-af85-4e19-8226-c067518c459e
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CUR_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e86edd6-a25c-441c-8f14-476b70e93287
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRV_PATIENT_VISIT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7123bebf-5582-4713-9470-e0e221201128
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PRV_EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa40e170-2988-49d3-a7e5-e6323622a448
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PRV_EVENT_ADMISSION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47038e4f-5bd8-4e5c-b10a-d1cfa0ccf5dd
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PRV_EVENT_DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0afd97f5-feb7-41b6-9fa0-e8e8c54cf03a
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PRV_HEALTHCARE_PROFESSIONAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c55f9489-a1d9-446e-9208-e595dbfb6d23
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRV_HEALTHCARE_PROFESSIONAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c93cb839-d4fe-4486-9c4b-d082d59ee165
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PRV_SERVICE_POINT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f37cf91-7ec2-4b04-b75c-b3e584830d97
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRV_SERVICE_POINT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5685a22-b87d-4ae5-97fc-90a07b8af636
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PRV_HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0401bf0f-0cf2-4783-b773-2da949d6950f
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRV_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 60b93216-990e-43f8-aa52-0101830ba9c5
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NXT_PATIENT_VISIT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d9afdca-2f9a-49ef-b13e-6f37759a931d
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NXT_EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9a733a4-498a-4be4-a53d-9a8a704d042b
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NXT_EVENT_ADMISSION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6830aace-cff4-437c-80f7-f24be98d7485
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NXT_EVENT_DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f459c837-dd22-4cba-a2a7-f1024d4c9e37
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NXT_HEALTHCARE_PROFESSIONAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a5c0125-84e4-4c55-a538-2dee67e53e65
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NXT_HEALTHCARE_PROFESSIONAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0fb87e8b-5cb4-43e2-8e0a-906e420350cc
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NXT_SERVICE_POINT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95b89779-877e-43c4-903f-71a238cf8d80
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NXT_SERVICE_POINT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11c9f67f-7136-42a2-9ac2-90fd5e4bcb6c
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NXT_HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee844d9f-22b6-4ce2-95cb-9cb711d7ec21
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NXT_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ebb603e-8108-4257-b9da-def852569320
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: NXT_ADMISSION_METHOD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f1bccc70-afad-441c-a6f9-e721817241ab
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3bac5ce7-7aa3-464e-bdc5-4efe75108e60
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FIRST_PATIENT_VISIT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e136a32-6329-4f09-a8d3-ab1cd37c671a
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FIRST_EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bfb0a1da-bdaa-4b09-9a45-2bc0b60dfb15
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_EVENT_ADMISSION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25efbd84-4a56-4248-9633-80994ce91ac7
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_EVENT_DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86c8116c-9538-423a-93a8-5d27048226df
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FIRST_HEALTHCARE_PROFESSIONAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a67e0570-9734-4f73-9eb6-10bb747bffeb
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FIRST_HEALTHCARE_PROFESSIONAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 46f9daa3-1544-4a9b-8f40-fbc66ffad6e0
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FIRST_SERVICE_POINT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f960141-5ce5-4ed2-ab84-3ef76bbf7b5f
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FIRST_SERVICE_POINT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f44e494-3124-4688-90ad-034a2cd0bf24
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FIRST_HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7bbbb29f-b9cb-4e9f-801c-c7f7b291f6bb
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FIRST_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5be286d2-963b-4396-9664-e822593bbf15
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LAST_PATIENT_VISIT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0a536be-f76a-4cab-aa22-4b38bf06de6e
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LAST_EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0721605c-ba0d-415e-ad7c-24836c347917
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_EVENT_ADMISSION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f215226c-4ab3-41d3-8e32-f05360284848
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_EVENT_DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01a1b702-21aa-40b6-8765-dccb4da1efa7
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LAST_HEALTHCARE_PROFESSIONAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74a85bd1-a446-4cd3-9d15-b62b2bd1dd1c
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LAST_HEALTHCARE_PROFESSIONAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e38ffe58-c30d-4afb-a99d-f37737dc677f
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LAST_SERVICE_POINT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b7fd77f-fa3b-4c5a-a34e-40ea7e747466
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LAST_SERVICE_POINT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 039190a7-9189-41d1-85e0-cc6b5f979770
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LAST_HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31828632-ef48-40fd-8c2b-bdbea24bb0ec
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LAST_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02547927-4791-4b9e-b4a4-266395b32c48
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: READMISSION_PATIENT_VISIT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc9e1107-8027-4dfe-8126-a1d1dca9f943
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 839944c5-0cea-40b4-83b7-d07777ba747e
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: READMISSION_EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 98c9bdfa-1455-4c81-8336-1fc71694c387
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86c2b2a1-6488-416a-a7ad-3e124f97ee13
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: READMISSION_EVENT_ADMISSION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a0d5a12-1979-4f2c-8064-624c175d8d47
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed87f494-96ba-40b3-8739-55e8e7343fc4
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: READMISSION_EVENT_DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00803c1f-550d-4585-a405-68dc2cd2130c
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c97742ea-ca69-4d3d-9185-20d0a3bc4f8b
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: READMISSION_HEALTHCARE_PROFESSIONAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7414b978-99c3-4a1a-b088-c60577fb71a4
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d7279c4-d4f5-4d57-a0b7-ae37da06a6c9
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: READMISSION_HEALTHCARE_PROFESSIONAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee055ddc-b67a-478a-bb2e-f4872f45c74b
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: READMISSION_SERVICE_POINT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee6c2a6a-8eea-41b0-a225-a6e82680d696
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee8b6ff2-8dc2-478d-9583-a845462bfe92
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: READMISSION_SERVICE_POINT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2555ef9-d604-45bc-a579-a520f95c79cf
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: READMISSION_HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8125995f-541e-414d-bab2-f4f5ca975862
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 345937e0-e3ff-4b0a-a431-5929b61b4fbe
          stepCounter: 7f78d0ce-908b-40bb-9c66-51fc1af45e15
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: READMISSION_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            SELECT cur.patnt_refno patient_reference_no,
                   cur.patient_NHI patient_NHI,
                   cur.patient_visit_seq_num cur_patient_visit_seq_num,
                   cur.event_encounter_id cur_event_encounter_id,
                   cur.admit_date cur_event_admission_date,
                   cur.disch_date cur_event_discharge_date,
                   cur.event_healthcare_professional_code cur_healthcare_professional_code,
                   cur.proca_refno cur_healthcare_professional_reference_no,
                   cur.event_service_point_code cur_service_point_code,
                   cur.spont_refno cur_service_point_reference_no,
                   cur.health_specialty_code cur_health_specialty_code,
                   cur.spect_refno cur_specialty_reference_no,
                   prv.patient_visit_seq_num prv_patient_visit_seq_num,
                   prv.event_encounter_id prv_event_encounter_id,
                   prv.admit_date prv_event_admission_date,
                   prv.disch_date prv_event_discharge_date,
                   prv.event_healthcare_professional_code prv_healthcare_professional_code,
                   prv.proca_refno prv_healthcare_professional_reference_no,
                   prv.event_service_point_code prv_service_point_code,
                   prv.spont_refno prv_service_point_reference_no,
                   prv.health_specialty_code prv_health_specialty_code,
                   prv.spect_refno prv_specialty_reference_no,
                   nxt.patient_visit_seq_num nxt_patient_visit_seq_num,
                   nxt.event_encounter_id nxt_event_encounter_id,
                   nxt.admit_date nxt_event_admission_date,
                   nxt.disch_date nxt_event_discharge_date,
                   nxt.event_healthcare_professional_code nxt_healthcare_professional_code,
                   nxt.proca_refno nxt_healthcare_professional_reference_no,
                   nxt.event_service_point_code nxt_service_point_code,
                   nxt.spont_refno nxt_service_point_reference_no,
                   nxt.health_specialty_code nxt_health_specialty_code,
                   nxt.spect_refno nxt_specialty_reference_no,
                   nxt.admission_method_code nxt_admission_method_code,
                   fst.patient_visit_seq_num first_patient_visit_seq_num,
                   fst.event_encounter_id first_event_encounter_id,
                   fst.admit_date first_event_admission_date,
                   fst.disch_date first_event_discharge_date,
                   fst.event_healthcare_professional_code first_healthcare_professional_code,
                   fst.proca_refno first_healthcare_professional_reference_no,
                   fst.event_service_point_code first_service_point_code,
                   fst.spont_refno first_service_point_reference_no,
                   fst.health_specialty_code first_health_specialty_code,
                   fst.spect_refno first_specialty_reference_no,
                   lst.patient_visit_seq_num last_patient_visit_seq_num,
                   lst.event_encounter_id last_event_encounter_id,
                   lst.admit_date last_event_admission_date,
                   lst.disch_date last_event_discharge_date,
                   lst.event_healthcare_professional_code last_healthcare_professional_code,
                   lst.proca_refno last_healthcare_professional_reference_no,
                   lst.event_service_point_code last_service_point_code,
                   lst.spont_refno last_service_point_reference_no,
                   lst.health_specialty_code last_health_specialty_code,
                   lst.spect_refno last_specialty_reference_no,
                   readm.patient_visit_seq_num readmission_patient_visit_seq_num,
                   readm.event_encounter_id readmission_event_encounter_id,
                   readm.admit_date readmission_event_admission_date,
                   readm.disch_date readmission_event_discharge_date,
                   readm.event_healthcare_professional_code readmission_healthcare_professional_code,
                   readm.proca_refno readmission_healthcare_professional_reference_no,
                   readm.event_service_point_code readmission_service_point_code,
                   readm.spont_refno readmission_service_point_reference_no,
                   readm.health_specialty_code readmission_health_specialty_code,
                   readm.spect_refno readmission_specialty_reference_no
              FROM s_inpatient_changes chg
              JOIN s_in_patient_event_05 cur
                ON chg.patnt_refno = cur.patnt_refno
              LEFT OUTER JOIN s_in_patient_event_05 prv
                ON prv.patnt_refno = cur.patnt_refno
               AND prv.patient_visit_seq_num = cur.patient_visit_seq_num - 1
              LEFT OUTER JOIN s_in_patient_event_05 nxt
                ON nxt.patnt_refno = cur.patnt_refno
               AND nxt.patient_visit_seq_num = cur.patient_visit_seq_num + 1
              LEFT OUTER JOIN s_in_patient_event_05 fst
                ON fst.patnt_refno = cur.patnt_refno
               AND fst.patient_visit_seq_num = 1
              LEFT OUTER JOIN s_in_patient_event_05 lst
                ON lst.patnt_refno = cur.patnt_refno
               AND lst.patient_visit_seq_num = lst.patient_visit_count
              LEFT OUTER JOIN s_in_patient_event_05 readm
                ON readm.patnt_refno = cur.patnt_refno
               AND readm.patient_visit_seq_num = cur.patient_visit_seq_num + 1
               AND readm.health_specialty_code = cur.health_specialty_code
               AND readm.readmission_type_code <> 'PLN'
               AND DATEDIFF(dd, cur.disch_date, readm.admit_date) <= 28
             WHERE chg.patnt_rownum = 1 -- Returns distinct list of patnt_refno values
        dependencies:
          - locationName: TGT
            nodeName: S_INPATIENT_CHANGES
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TGT','S_INPATIENT_CHANGES') }}
        name: S_IN_PATIENT_EVENT_PREV_NEXT_V
        noLinkRefs: []
  name: S_IN_PATIENT_EVENT_PREV_NEXT_V
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
