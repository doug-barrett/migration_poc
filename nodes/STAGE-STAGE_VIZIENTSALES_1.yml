fileVersion: 1
id: e546c03b-230d-45ed-9dd9-a904efc07818
name: STAGE_VIZIENTSALES_1
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "PART 1 ADDS MISSING CONTRACT COLUMNS FROM THE STAGING TABLE STAGE.VIZIENTCONTRACTS. THIS IS THE 1ST STAGING TABLE FOR VIZIENT SALES & REVENUE"
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53d7e30a-aa0f-47c7-a8ed-2fa9f7d32817
          stepCounter: e546c03b-230d-45ed-9dd9-a904efc07818
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 30a68024-3153-470c-b6ea-0b828dd7f207
                stepCounter: bb8aac06-6412-4e4f-8d02-808027957dff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b022808-31c5-42d6-8df4-552682cc73c5
          stepCounter: e546c03b-230d-45ed-9dd9-a904efc07818
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: TRANSACTIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7040a2a6-073b-4b88-b83e-57a451bfd089
                stepCounter: 5b874974-48a6-402f-bd27-262957ab4d61
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0205247-d412-47cb-8dc8-0fa99e70fab6
          stepCounter: e546c03b-230d-45ed-9dd9-a904efc07818
        config: {}
        dataType: INT
        defaultValue: ""
        description: UNIQUE IDENTIFIER FOR AN ACCOUNT. COMMONLY CALLED THE "FORCE ID"
        name: ACCOUNTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1e31f4f-e13b-492c-bc6a-b4e124974b43
                stepCounter: 12abbc82-3dff-4b9d-9604-d7a2bae8d6d0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e27a6afc-d1b3-4ec5-9946-1bae79c0f10b
          stepCounter: e546c03b-230d-45ed-9dd9-a904efc07818
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: REGISTRATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed1d413f-7bce-4edd-b90a-507ae6e6de3c
                stepCounter: bb8aac06-6412-4e4f-8d02-808027957dff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e95453d7-a3ec-4c74-a216-bd444d45354e
          stepCounter: e546c03b-230d-45ed-9dd9-a904efc07818
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: REPORTINGCUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33f27768-2833-44bb-875d-a09f5b8598c6
                stepCounter: bb8aac06-6412-4e4f-8d02-808027957dff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2dd6e0bf-4c18-4c86-812d-7458b09b3285
          stepCounter: e546c03b-230d-45ed-9dd9-a904efc07818
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CONTRACTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 15e90690-bebe-4a80-8ca4-f45e050cfac2
                stepCounter: 5b874974-48a6-402f-bd27-262957ab4d61
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f6988fd-6fc2-42f2-8566-0f7e332a90e2
          stepCounter: e546c03b-230d-45ed-9dd9-a904efc07818
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: RECEIPTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dac4663b-83d4-46b1-b992-04e73082be1e
                stepCounter: 5b874974-48a6-402f-bd27-262957ab4d61
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05975d0b-34fd-42e2-9c04-aae46bb6fda0
          stepCounter: e546c03b-230d-45ed-9dd9-a904efc07818
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: TRANSACTIONDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 785254fc-13b9-47be-9730-c087bd5c0d36
                stepCounter: 5b874974-48a6-402f-bd27-262957ab4d61
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 271e77c3-f092-4350-ac7b-f0cb90c4d1fc
          stepCounter: e546c03b-230d-45ed-9dd9-a904efc07818
        config: {}
        dataType: NUMERIC(19,4)
        defaultValue: ""
        description: ""
        name: SALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: df619b1b-a3ba-4aab-894d-2d344b49cb9a
                stepCounter: 5b874974-48a6-402f-bd27-262957ab4d61
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81d9346e-c1a8-48dd-be47-57919a8a1a32
          stepCounter: e546c03b-230d-45ed-9dd9-a904efc07818
        config: {}
        dataType: NUMERIC(19,4)
        defaultValue: ""
        description: ""
        name: REVENUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a9ede9cb-0920-4a6c-bb5a-b31bf5c8f425
                stepCounter: 5b874974-48a6-402f-bd27-262957ab4d61
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f38e3ab-6418-45e4-9c36-55c32dff6fd6
          stepCounter: e546c03b-230d-45ed-9dd9-a904efc07818
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: COMPANYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9ccef500-174b-4691-9469-450ac7d4af77
                stepCounter: 5b874974-48a6-402f-bd27-262957ab4d61
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0fd32c0-ce21-4f98-b298-e7bb27dd72e0
          stepCounter: e546c03b-230d-45ed-9dd9-a904efc07818
        config: {}
        dataType: INT
        defaultValue: ""
        description: THE ORIGINAL CUSTOMER ID ASSOCIATED WITH A TRANSACTION.
        name: ORIGINALCUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d83d28f5-2af9-43fe-8b78-420eddc43243
                stepCounter: 5b874974-48a6-402f-bd27-262957ab4d61
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6073836-c539-4607-a89b-95fd68e8d2d9
          stepCounter: e546c03b-230d-45ed-9dd9-a904efc07818
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LOFFICEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 904bd74e-b943-4980-a0aa-d0257d0a5f93
                stepCounter: 5b874974-48a6-402f-bd27-262957ab4d61
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef9e261f-7a13-4b7f-b518-0c5540c15e57
          stepCounter: e546c03b-230d-45ed-9dd9-a904efc07818
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: LOFFICENAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c8b254d1-8095-441d-aa4b-85589f5e4547
                stepCounter: 5b874974-48a6-402f-bd27-262957ab4d61
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9be8189c-eb63-49cd-92b4-a64926f5f76a
          stepCounter: e546c03b-230d-45ed-9dd9-a904efc07818
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SYSTEMID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a47a80cb-00d3-4848-b5ae-cb55aefb6c7e
                stepCounter: 5b874974-48a6-402f-bd27-262957ab4d61
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b769cc0-797a-426b-94ec-700216856160
          stepCounter: e546c03b-230d-45ed-9dd9-a904efc07818
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        name: ____END_COMMON_COLUMNS____
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 175e9cac-8c7a-4e49-abab-23cee9bd7d13
          stepCounter: e546c03b-230d-45ed-9dd9-a904efc07818
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d245744f-81da-4553-baa0-852fa5351c6a
                stepCounter: bb8aac06-6412-4e4f-8d02-808027957dff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a5660d9-9735-4a11-a148-a9208772cee0
          stepCounter: e546c03b-230d-45ed-9dd9-a904efc07818
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa77b7a4-9b01-45c3-ae5c-49022c989af7
                stepCounter: 365241ce-60a0-4d40-b5bd-f3b8ab4c77d2
            transform: COALESCE(DSSFDCSUPPLIER.SUPPLIERID,LOADVIZIENTSALES.VENDOR_ID)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 402f84bd-9599-4db7-90b3-4c3065ea50a8
          stepCounter: e546c03b-230d-45ed-9dd9-a904efc07818
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SUPPLIERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 214f8e8f-75cc-4b80-823e-ae65097fa1ea
                stepCounter: 365241ce-60a0-4d40-b5bd-f3b8ab4c77d2
            transform: COALESCE(DSSFDCSUPPLIER.SUPPLIERNAME,LOADVIZIENTSALES.VENDOR_NAME)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a19332d-abdc-498b-ab3d-8038be1cf6d3
          stepCounter: e546c03b-230d-45ed-9dd9-a904efc07818
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ISDIRECT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54e4adf1-64b4-4290-b3a2-195437fffece
          stepCounter: e546c03b-230d-45ed-9dd9-a904efc07818
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TERRITORYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7e27cd8-c1bf-45fb-99a4-b2df35625945
                stepCounter: bb8aac06-6412-4e4f-8d02-808027957dff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 615425fe-46c1-432c-8b90-3705ff71bedd
          stepCounter: e546c03b-230d-45ed-9dd9-a904efc07818
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TERRITORYIDFINANCIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 36c9e99b-0feb-4248-8eba-3df9bb463df2
                stepCounter: bb8aac06-6412-4e4f-8d02-808027957dff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ff063b6-d2da-41c6-9597-e19d0e855de5
          stepCounter: e546c03b-230d-45ed-9dd9-a904efc07818
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TERRITORYIDDIRECT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6780610a-5b2a-46c4-a2e3-fb9e5d5e6702
                stepCounter: bb8aac06-6412-4e4f-8d02-808027957dff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a042fbc-1a07-4110-ae67-e384a490fb30
          stepCounter: e546c03b-230d-45ed-9dd9-a904efc07818
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        name: ____END_APPENDED_BIZ_KEY_COLUMNS____
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b10177ea-165c-4e66-9671-07f7f7a8d52a
          stepCounter: e546c03b-230d-45ed-9dd9-a904efc07818
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: NON CONFORMED DIMENSION KEY
        isSurrogateKey: true
        name: DSS_SOURCE_SYSTEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bd038b3b-a69b-47f0-84d4-07313a6c82cb
                stepCounter: 5b874974-48a6-402f-bd27-262957ab4d61
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df211c44-2622-424a-baa4-e523e4268dfe
          stepCounter: e546c03b-230d-45ed-9dd9-a904efc07818
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d5c8f193-3af0-4d69-aab1-f1922d2132ce
                stepCounter: 5b874974-48a6-402f-bd27-262957ab4d61
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 667a4eb8-8f50-4b91-8695-17f7121f545b
          stepCounter: e546c03b-230d-45ed-9dd9-a904efc07818
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3c9ade02-70e1-4e83-96e2-e6a1e74044ee
                stepCounter: 5b874974-48a6-402f-bd27-262957ab4d61
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 52f993e7-62d9-4c4a-b654-74b26b021c1a
          stepCounter: e546c03b-230d-45ed-9dd9-a904efc07818
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d1905b9-9001-4db5-955c-1edf5ed58295
          stepCounter: e546c03b-230d-45ed-9dd9-a904efc07818
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DSSFDCSUPPLIER: 365241ce-60a0-4d40-b5bd-f3b8ab4c77d2
          DSCUSTOMERSEXTERNALIDXREF: 12abbc82-3dff-4b9d-9604-d7a2bae8d6d0
          DSACCOUNT: bb8aac06-6412-4e4f-8d02-808027957dff
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOAD_VIZIENTSALES
          - locationName: ODS
            nodeName: DSACCOUNT
          - locationName: ODS
            nodeName: DSCUSTOMERSEXTERNALIDXREF
          - locationName: ODS
            nodeName: DSSFDCSUPPLIER
          - locationName: UNKNOWN
            nodeName: LOADVIZIENTSALES
        join:
          joinCondition: |-
            FROM {{ ref('UNKNOWN','LOADVIZIENTSALES') }} LOADVIZIENTSALES
              LEFT JOIN {{ ref('ODS','DSSFDCSUPPLIER') }} DSSFDCSUPPLIER
                ON LOADVIZIENTSALES.VENDOR_ID = DSSFDCSUPPLIER.VIZIENTSUPPLIERID
              LEFT JOIN {{ ref('ODS','DSCUSTOMERSEXTERNALIDXREF') }} DSCUSTOMERSEXTERNALIDXREF
                ON LOADVIZIENTSALES.MEMBER_ID = DSCUSTOMERSEXTERNALIDXREF.EXTERNALCUSTOMERID
              LEFT JOIN {{ ref('ODS','DSACCOUNT') }} DSACCOUNT
                ON DSCUSTOMERSEXTERNALIDXREF.CUSTOMERID = DSACCOUNT.FORCEID
             WHERE DSCUSTOMERSEXTERNALIDXREF.SOURCEENTITY = 3 --PROCESS FOR ONLY VIZIENT SOURCE ENTITY
        name: STAGEVIZIENTSALES_1
        noLinkRefs: []
  name: STAGE_VIZIENTSALES_1
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
