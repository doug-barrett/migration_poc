fileVersion: 1
id: 296ded9a-7004-46c9-aae1-f57f13e99778
name: STAGE_VIZIENTSALES_1
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "PART 1 ADDS MISSING CONTRACT COLUMNS FROM THE STAGING TABLE STAGE.VIZIENTCONTRACTS. THIS IS THE 1ST STAGING TABLE FOR VIZIENT SALES & REVENUE"
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 908aeb0b-f032-4c3a-bf74-968f9828d046
          stepCounter: 296ded9a-7004-46c9-aae1-f57f13e99778
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c03972a9-6500-4826-9e37-649e24f97da9
                stepCounter: e1cf805b-9681-41e1-b3d5-7fedd3a7bf4b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c788e31d-ce8e-4867-ad71-e02eebbcc28a
          stepCounter: 296ded9a-7004-46c9-aae1-f57f13e99778
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: TRANSACTIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c50c92dc-7bc7-4da5-9c79-1a6b98674360
                stepCounter: a785b020-aca1-4517-b093-b14903dcfc56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c398034a-e00c-45f5-b255-d60b4bc8f923
          stepCounter: 296ded9a-7004-46c9-aae1-f57f13e99778
        config: {}
        dataType: INT
        defaultValue: ""
        description: UNIQUE IDENTIFIER FOR AN ACCOUNT. COMMONLY CALLED THE "FORCE ID"
        name: ACCOUNTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4d500e3f-72cb-4bde-a62d-f16c2d8cf0c5
                stepCounter: e2e12b62-fee8-43e9-a08c-ef5adf74b75f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 446ac45b-2287-414a-ac07-02f9e495db38
          stepCounter: 296ded9a-7004-46c9-aae1-f57f13e99778
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: REGISTRATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 89d8f928-4eb0-4e65-be9e-d8ab21f7b35f
                stepCounter: e1cf805b-9681-41e1-b3d5-7fedd3a7bf4b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d0bc17b3-b8b1-479b-b985-6a7b58c0501c
          stepCounter: 296ded9a-7004-46c9-aae1-f57f13e99778
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: REPORTINGCUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f633837-348a-489d-be05-84e9e3df6c27
                stepCounter: e1cf805b-9681-41e1-b3d5-7fedd3a7bf4b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5587951-7045-4e79-b475-ad4497960670
          stepCounter: 296ded9a-7004-46c9-aae1-f57f13e99778
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CONTRACTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f5f8a0c9-c4a3-4890-8745-fc300f71db21
                stepCounter: a785b020-aca1-4517-b093-b14903dcfc56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fcfc8a1f-a562-4952-9937-739845b84465
          stepCounter: 296ded9a-7004-46c9-aae1-f57f13e99778
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: RECEIPTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ad11b3a8-e72c-4c26-a2fc-dc35c6aa72d9
                stepCounter: a785b020-aca1-4517-b093-b14903dcfc56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f47b3d2-5930-44bb-a381-4a80fe911dba
          stepCounter: 296ded9a-7004-46c9-aae1-f57f13e99778
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: TRANSACTIONDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 652de088-477f-4d2a-9f3c-de8ec28346d3
                stepCounter: a785b020-aca1-4517-b093-b14903dcfc56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: def6ebdb-a44a-4bdd-a420-e016e453b5d6
          stepCounter: 296ded9a-7004-46c9-aae1-f57f13e99778
        config: {}
        dataType: NUMERIC(19,4)
        defaultValue: ""
        description: ""
        name: SALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c726f1be-abfe-4546-8331-ad2e310c2adb
                stepCounter: a785b020-aca1-4517-b093-b14903dcfc56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5bc65e2a-1017-4b70-bc7c-6d87d91f4e2d
          stepCounter: 296ded9a-7004-46c9-aae1-f57f13e99778
        config: {}
        dataType: NUMERIC(19,4)
        defaultValue: ""
        description: ""
        name: REVENUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e2b174c-6eb6-4e09-bcda-6b843513cd1b
                stepCounter: a785b020-aca1-4517-b093-b14903dcfc56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ff164ad-df43-4f9d-8723-c11a0c9eee08
          stepCounter: 296ded9a-7004-46c9-aae1-f57f13e99778
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: COMPANYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc4929a9-575b-4e2a-8217-2d05136c44f4
                stepCounter: a785b020-aca1-4517-b093-b14903dcfc56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b7bb74d-0191-4204-91de-cc81ca7d76ca
          stepCounter: 296ded9a-7004-46c9-aae1-f57f13e99778
        config: {}
        dataType: INT
        defaultValue: ""
        description: THE ORIGINAL CUSTOMER ID ASSOCIATED WITH A TRANSACTION.
        name: ORIGINALCUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 55756824-a390-4968-a459-dde2478d1c20
                stepCounter: a785b020-aca1-4517-b093-b14903dcfc56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb0e6f65-e06d-456b-a6df-5d045e46a798
          stepCounter: 296ded9a-7004-46c9-aae1-f57f13e99778
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LOFFICEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 81a77550-82b6-4e8a-af31-39bfc74f381e
                stepCounter: a785b020-aca1-4517-b093-b14903dcfc56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5903c34c-1a1d-40b8-8faa-b90584d1545b
          stepCounter: 296ded9a-7004-46c9-aae1-f57f13e99778
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: LOFFICENAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4206da14-7cec-49aa-9fa1-2ee384c27ed8
                stepCounter: a785b020-aca1-4517-b093-b14903dcfc56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6fa9e114-0dae-4b6c-8c67-a9ec7aa66d31
          stepCounter: 296ded9a-7004-46c9-aae1-f57f13e99778
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SYSTEMID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 651a4ed6-4785-416a-98fb-c76fd5159767
                stepCounter: a785b020-aca1-4517-b093-b14903dcfc56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 077ace39-ca26-4f5b-8820-16df51f0d740
          stepCounter: 296ded9a-7004-46c9-aae1-f57f13e99778
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        name: ____END_COMMON_COLUMNS____
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 782a4597-1c77-4f35-b4ec-bf55659cd23d
          stepCounter: 296ded9a-7004-46c9-aae1-f57f13e99778
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a78c434f-b316-478e-addf-cff350d7d5d3
                stepCounter: e1cf805b-9681-41e1-b3d5-7fedd3a7bf4b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4dc8156-f84e-4139-ab11-f087fa4c1333
          stepCounter: 296ded9a-7004-46c9-aae1-f57f13e99778
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1cabf1ad-61f2-452a-9251-a0f2733cfded
                stepCounter: a734c1b2-bf47-4f50-8460-67edb2fb531c
            transform: COALESCE(DSSFDCSUPPLIER.SUPPLIERID,LOADVIZIENTSALES.VENDOR_ID)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f424a97d-cf55-422e-b002-2e454cb5bdd7
          stepCounter: 296ded9a-7004-46c9-aae1-f57f13e99778
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: SUPPLIERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0e10a662-ec9a-489b-9b59-2825b08e037f
                stepCounter: a734c1b2-bf47-4f50-8460-67edb2fb531c
            transform: COALESCE(DSSFDCSUPPLIER.SUPPLIERNAME,LOADVIZIENTSALES.VENDOR_NAME)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bdd794a9-8fe8-456f-bcfb-66551ae8ec72
          stepCounter: 296ded9a-7004-46c9-aae1-f57f13e99778
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ISDIRECT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: adff6136-cc35-4932-b489-bf170afffd36
          stepCounter: 296ded9a-7004-46c9-aae1-f57f13e99778
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TERRITORYID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 58a35045-b266-419c-a0a5-c573c912768e
                stepCounter: e1cf805b-9681-41e1-b3d5-7fedd3a7bf4b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a404d24-bc18-449a-8e12-db789e67bb43
          stepCounter: 296ded9a-7004-46c9-aae1-f57f13e99778
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TERRITORYIDFINANCIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 745e3482-cb00-41b4-b41a-c160dc265644
                stepCounter: e1cf805b-9681-41e1-b3d5-7fedd3a7bf4b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8f80d82-377d-467b-bfcc-93a2ef9c4180
          stepCounter: 296ded9a-7004-46c9-aae1-f57f13e99778
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: TERRITORYIDDIRECT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8d73432-e0bd-41c8-8a3f-dfc48765900e
                stepCounter: e1cf805b-9681-41e1-b3d5-7fedd3a7bf4b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a723ba2-8997-4462-8b84-e24b96e8a679
          stepCounter: 296ded9a-7004-46c9-aae1-f57f13e99778
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        name: ____END_APPENDED_BIZ_KEY_COLUMNS____
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bae262ff-90c9-4237-9f0e-b8d9f288bc76
          stepCounter: 296ded9a-7004-46c9-aae1-f57f13e99778
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: NON CONFORMED DIMENSION KEY
        isSurrogateKey: true
        name: DSS_SOURCE_SYSTEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d39238b-1b47-4f80-985d-7bfcfcc6b20f
                stepCounter: a785b020-aca1-4517-b093-b14903dcfc56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e2e6a84-748a-4cc4-842d-95e021949ae4
          stepCounter: 296ded9a-7004-46c9-aae1-f57f13e99778
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b609e830-9438-498a-b8e1-9334d41bdb14
                stepCounter: a785b020-aca1-4517-b093-b14903dcfc56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70f49f28-1fbe-4e53-b4b0-05f1ebf4b40c
          stepCounter: 296ded9a-7004-46c9-aae1-f57f13e99778
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cf80fecc-8484-4f69-8141-fef8a7ebae1c
                stepCounter: a785b020-aca1-4517-b093-b14903dcfc56
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d6b75a5-e4b9-485b-8294-421631edec77
          stepCounter: 296ded9a-7004-46c9-aae1-f57f13e99778
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25296dbd-a2f5-4b3b-a776-0f170dbec91d
          stepCounter: 296ded9a-7004-46c9-aae1-f57f13e99778
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOAD_VIZIENTSALES: a785b020-aca1-4517-b093-b14903dcfc56
          DS_SFDCSUPPLIER: a734c1b2-bf47-4f50-8460-67edb2fb531c
          DS_CUSTOMERSEXTERNALIDXREF: e2e12b62-fee8-43e9-a08c-ef5adf74b75f
          DS_ACCOUNT: e1cf805b-9681-41e1-b3d5-7fedd3a7bf4b
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOAD_VIZIENTSALES
          - locationName: ODS
            nodeName: DS_ACCOUNT
          - locationName: ODS
            nodeName: DS_CUSTOMERSEXTERNALIDXREF
          - locationName: ODS
            nodeName: DS_SFDCSUPPLIER
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOAD_VIZIENTSALES') }} LOAD_VIZIENTSALES
              LEFT JOIN {{ ref('ODS','DS_SFDCSUPPLIER') }} DS_SFDCSUPPLIER
                ON LOAD_VIZIENTSALES.VENDOR_ID = DS_SFDCSUPPLIER.VIZIENTSUPPLIERID
              LEFT JOIN {{ ref('ODS','DS_CUSTOMERSEXTERNALIDXREF') }} DS_CUSTOMERSEXTERNALIDXREF
                ON LOAD_VIZIENTSALES.MEMBER_ID = DS_CUSTOMERSEXTERNALIDXREF.EXTERNALCUSTOMERID
              LEFT JOIN {{ ref('ODS','DS_ACCOUNT') }} DS_ACCOUNT
                ON DS_CUSTOMERSEXTERNALIDXREF.CUSTOMERID = DS_ACCOUNT.FORCEID
             WHERE DS_CUSTOMERSEXTERNALIDXREF.SOURCEENTITY = 3 --PROCESS FOR ONLY VIZIENT SOURCE ENTITY
        name: STAGEVIZIENTSALES_1
        noLinkRefs: []
  name: STAGE_VIZIENTSALES_1
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
