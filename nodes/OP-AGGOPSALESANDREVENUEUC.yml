fileVersion: 1
id: 84e28bc9-c572-4503-ac20-3ac66595a4cb
name: AGGOPSALESANDREVENUEUC
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "DOES NOT USE ANY DATA FROM UC SPEND CUBE...ONLY PULLS FROM OP SALES AND REVENUE."
  isMultisource: false
  locationName: OP
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17bd5a51-627c-4d80-ab74-d4397d9e808c
          stepCounter: 84e28bc9-c572-4503-ac20-3ac66595a4cb
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: CONTRACTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e8c8f83-6715-4a2e-86e2-3bae5428f6a1
                stepCounter: 35498798-8753-42e9-bc58-c54bc0c65138
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 351fc543-436a-401f-9bc6-09a2d7fdf3c4
          stepCounter: 84e28bc9-c572-4503-ac20-3ac66595a4cb
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: RECEIPTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0a0fb266-a188-45d6-a47b-484f2ad556bd
                stepCounter: 35498798-8753-42e9-bc58-c54bc0c65138
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ccc3c6e2-3c0f-4c1d-bddd-e29792d9384e
          stepCounter: 84e28bc9-c572-4503-ac20-3ac66595a4cb
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: SALES
        name: SALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a2458c7-c0c6-4612-8ab1-2a23e7ee2bd8
                stepCounter: 35498798-8753-42e9-bc58-c54bc0c65138
            transform: SUM(SALESANDREVENUE.SALES)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f38ffda5-1e34-42a6-a5c0-56b09a7554bb
          stepCounter: 84e28bc9-c572-4503-ac20-3ac66595a4cb
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: REVENUE TYPE (MOSTLY USED AS INPUT TO PREPARE NEXT YEAR'S BUDGET)
        isBusinessKey: true
        name: REVENUETYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d03167b-aff8-4f8e-9680-df5c84c83202
                stepCounter: 35498798-8753-42e9-bc58-c54bc0c65138
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f3fecb62-3f02-4640-8d79-6c524d9dda5f
          stepCounter: 84e28bc9-c572-4503-ac20-3ac66595a4cb
        config: {}
        dataType: INT
        defaultValue: ""
        description: FORCE ID
        isBusinessKey: true
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 95b87a91-3c77-4a67-a337-0bc215fcfb27
                stepCounter: 35498798-8753-42e9-bc58-c54bc0c65138
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1d63c86-ffad-4c55-b9b1-33c4ed017529
          stepCounter: 84e28bc9-c572-4503-ac20-3ac66595a4cb
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: MAXRECEIPTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6aeefac1-b13a-427e-8a7d-791514f804e6
                stepCounter: 35498798-8753-42e9-bc58-c54bc0c65138
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc5a2264-63df-414a-9366-f9b3f0cfc529
          stepCounter: 84e28bc9-c572-4503-ac20-3ac66595a4cb
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DW LOAD DATE
        name: LOADDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: CAST(CURRENT_TIMESTAMP AS TIMESTAMP)
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          SALESANDREVENUE: 35498798-8753-42e9-bc58-c54bc0c65138
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: FACT
            nodeName: SALESANDREVENUE
        join:
          joinCondition: |-
            FROM {{ ref('FACT','SALESANDREVENUE') }} SALESANDREVENUE
             WHERE DATEDIFF(MONTH,SALESANDREVENUE.RECEIPTDATE,SALESANDREVENUE.MAXRECEIPTDATE) BETWEEN 0 AND 35
               AND SALESANDREVENUE.REVENUETYPE LIKE 'UC %' --AND IFNULL(SALES,0) <> 0 GROUP BY SALESANDREVENUE.ACCOUNTID,
             SALESANDREVENUE.CONTRACTID,
                   SALESANDREVENUE.RECEIPTDATE,
                   SALESANDREVENUE.REVENUETYPE,
                   SALESANDREVENUE.MAXRECEIPTDATE
        name: AGGOPSALESANDREVENUEUC
        noLinkRefs: []
  name: AGGOPSALESANDREVENUEUC
  overrideSQL: false
  schema: ""
  sqlType: Agreggate
  type: sql
  version: 1
type: Node
