fileVersion: 1
id: b124b7f7-4fcc-49b4-9795-bd34236ec9ce
name: AGGACCOUNTPREV12MOSTATS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: REPORTS
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71910a27-1189-4e86-b27d-94a7b85290ad
          stepCounter: b124b7f7-4fcc-49b4-9795-bd34236ec9ce
        config: {}
        dataType: INT
        defaultValue: ""
        description: Parent Id for an account. Will be the same as ForceId if there is no parent or if this is the top-most account in a hierarchy
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: FORCEPARENTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aaa0b8ea-2737-4185-8d58-9eba3759bc29
                stepCounter: ec3fe8ff-dfc1-44ec-8476-adb6bb53e332
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c725af8-6235-4920-9693-0191983e5f81
          stepCounter: b124b7f7-4fcc-49b4-9795-bd34236ec9ce
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: Name of the Account's Parent. If there is no parent or this account is the top of the hierarchy then this will be the same as the Account Name.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ACCOUNTPARENTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de309bbb-e2d9-4c60-b88a-336eb195f986
                stepCounter: ec3fe8ff-dfc1-44ec-8476-adb6bb53e332
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa493f31-0352-4a64-b6a6-ef76f2141249
          stepCounter: b124b7f7-4fcc-49b4-9795-bd34236ec9ce
        config: {}
        dataType: INT
        defaultValue: ""
        description: Number of suppliers used in the previous 12 month period (months 13 - 24 ago). The count is based upon the field FinancialReportingSupplierName.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PREV12MONUMOFSUPPLIERSUSED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c053359-4233-4379-80c2-b22a0087cfdc
                stepCounter: ec3fe8ff-dfc1-44ec-8476-adb6bb53e332
            transform: COUNT (DISTINCT FinancialReportingSupplierName)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 12e1e5c3-499a-477c-a353-f075a5c7f2b2
          stepCounter: b124b7f7-4fcc-49b4-9795-bd34236ec9ce
        config: {}
        dataType: INT
        defaultValue: ""
        description: Number of contracts used in the previous 12 month period (months 13 - 24 ago). Count is based on PPAContractNumber
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PREV12MONUMOFCONTRACTSUSED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 917854bf-4f7d-4458-a52e-e73c35362d8d
                stepCounter: ec3fe8ff-dfc1-44ec-8476-adb6bb53e332
            transform: COUNT (DISTINCT PPAContractNumber)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 13972d84-04d9-4b2a-8831-2f53023219a9
          stepCounter: b124b7f7-4fcc-49b4-9795-bd34236ec9ce
        config: {}
        dataType: INT
        defaultValue: ""
        description: Number of contract categories used in the previous 12 month period (months 13 - 24 ago). Count is based on ContractCategory.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PREV12MONUMOFCATEGORIESUSED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 10cd6d5c-5ae7-4d92-928b-6fbd8e1a3c22
                stepCounter: ec3fe8ff-dfc1-44ec-8476-adb6bb53e332
            transform: COUNT (DISTINCT ContractCategory)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0918b9cc-0aa8-484b-b1b4-06280f01491a
          stepCounter: b124b7f7-4fcc-49b4-9795-bd34236ec9ce
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Last transaction date for account.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: LASTTRANSACTIONDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7424409b-6105-4f21-9301-f3dbfd96fdbb
                stepCounter: ec3fe8ff-dfc1-44ec-8476-adb6bb53e332
            transform: MAX(ReceiptDate)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a6973d5-89b9-4325-916b-5bb091859033
          stepCounter: b124b7f7-4fcc-49b4-9795-bd34236ec9ce
        config: {}
        dataType: INT
        defaultValue: ""
        description: Last transaction date for account.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: MONTHSSINCELASTTRANSACTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7424409b-6105-4f21-9301-f3dbfd96fdbb
                stepCounter: ec3fe8ff-dfc1-44ec-8476-adb6bb53e332
            transform: DATEDIFF(MONTH, MAX(TransactionDate), MAX(MaxReceiptDate))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 097d10c7-793a-43b8-ada1-95412dfe7957
          stepCounter: b124b7f7-4fcc-49b4-9795-bd34236ec9ce
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Last transaction date for account in the previous 12 month period (months 13 - 24 ago).
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PREV12MOLASTTRANSACTIONDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d419e78f-74ae-4c3e-944f-b79b22b35126
                stepCounter: ec3fe8ff-dfc1-44ec-8476-adb6bb53e332
            transform: MAX(TransactionDate)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ce59a13-248e-4476-934b-967a1fd3a514
          stepCounter: b124b7f7-4fcc-49b4-9795-bd34236ec9ce
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: Sum of Sales for the previous 12 month period (months 13 - 24 ago)
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PREV12MOSALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ead1eda-ce99-454b-9c29-673c6e5e55f3
                stepCounter: ec3fe8ff-dfc1-44ec-8476-adb6bb53e332
            transform: SUM(Sales)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c79e745a-6221-4d0c-a0ff-929dd78062e6
          stepCounter: b124b7f7-4fcc-49b4-9795-bd34236ec9ce
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: Sum of Revenue for the previous 12 month period (months 13 - 24 ago)
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PREV12MOREVENUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4648ed9d-37a6-4c20-a538-ffc915b05493
                stepCounter: ec3fe8ff-dfc1-44ec-8476-adb6bb53e332
            transform: SUM(Revenue)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e39ee97c-157f-4d5d-b902-2650c1673ba3
          stepCounter: b124b7f7-4fcc-49b4-9795-bd34236ec9ce
        config: {}
        dataType: INT
        defaultValue: ""
        description: New of new contracts used by account on a rolling 12 month basis for the previous 12 month period (months 13 - 24 ago)
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: PREV12MONUMOFNEWCONTRACTSUSED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: COUNT (DISTINCT CASE WHEN IsContractUseNewOrRecurringInTrailing12MonthsForForceParentId = 'New' THEN PPAcontractNumber END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0b1d44f-8aa3-42c2-a5db-adb323c68674
          stepCounter: b124b7f7-4fcc-49b4-9795-bd34236ec9ce
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03ab265c-bb00-428a-ac20-f416e4c00391
          stepCounter: b124b7f7-4fcc-49b4-9795-bd34236ec9ce
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VWSALESANDREVENUE: ec3fe8ff-dfc1-44ec-8476-adb6bb53e332
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: REPORTS
            nodeName: VWSALESANDREVENUE
        join:
          joinCondition: FROM {{ ref('REPORTS','VWSALESANDREVENUE') }}
        name: AGGACCOUNTPREV12MOSTATS
        noLinkRefs: []
  name: AGGACCOUNTPREV12MOSTATS
  overrideSQL: false
  schema: ""
  sqlType: Fact
  type: sql
  version: 1
type: Node
