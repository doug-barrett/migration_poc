fileVersion: 1
id: 7872d774-d5b4-4083-b696-8dc9594c6a02
name: AGGACCOUNTPREV12MOSTATS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: REPORTS
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bc3f34f9-4ea1-4f06-aedd-52c950f6fad0
          stepCounter: 7872d774-d5b4-4083-b696-8dc9594c6a02
        config: {}
        dataType: INT
        defaultValue: ""
        description: PARENT ID FOR AN ACCOUNT. WILL BE THE SAME AS FORCEID IF THERE IS NO PARENT OR IF THIS IS THE TOP-MOST ACCOUNT IN A HIERARCHY
        name: FORCEPARENTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4f11ac8-2f09-4f32-91da-67128dc80957
                stepCounter: 0ccbe0b4-ca53-4e05-93d5-a7c7292d1fa7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04330625-8087-473b-8fcc-05853618c14d
          stepCounter: 7872d774-d5b4-4083-b696-8dc9594c6a02
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: NAME OF THE ACCOUNT'S PARENT. IF THERE IS NO PARENT OR THIS ACCOUNT IS THE TOP OF THE HIERARCHY THEN THIS WILL BE THE SAME AS THE ACCOUNT NAME.
        name: ACCOUNTPARENTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: edf555bd-6a17-4b81-a7ab-4c0724bc41f3
                stepCounter: 0ccbe0b4-ca53-4e05-93d5-a7c7292d1fa7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 005671b0-f21b-481a-8c44-6fb2f076d07a
          stepCounter: 7872d774-d5b4-4083-b696-8dc9594c6a02
        config: {}
        dataType: INT
        defaultValue: ""
        description: NUMBER OF SUPPLIERS USED IN THE PREVIOUS 12 MONTH PERIOD (MONTHS 13 - 24 AGO). THE COUNT IS BASED UPON THE FIELD FINANCIALREPORTINGSUPPLIERNAME.
        name: PREV12MONUMOFSUPPLIERSUSED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 04ccaa47-4800-435d-b8cf-753c1ed20d28
                stepCounter: 0ccbe0b4-ca53-4e05-93d5-a7c7292d1fa7
            transform: COUNT (DISTINCT FINANCIALREPORTINGSUPPLIERNAME)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b10d79a9-1b64-41e0-aa75-887c9a1c2892
          stepCounter: 7872d774-d5b4-4083-b696-8dc9594c6a02
        config: {}
        dataType: INT
        defaultValue: ""
        description: NUMBER OF CONTRACTS USED IN THE PREVIOUS 12 MONTH PERIOD (MONTHS 13 - 24 AGO). COUNT IS BASED ON PPACONTRACTNUMBER
        name: PREV12MONUMOFCONTRACTSUSED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 117a3a07-053a-4dcb-83d7-831301f4ae5d
                stepCounter: 0ccbe0b4-ca53-4e05-93d5-a7c7292d1fa7
            transform: COUNT (DISTINCT PPACONTRACTNUMBER)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed3aeec5-f404-4019-bd8e-cae09cb3e8f4
          stepCounter: 7872d774-d5b4-4083-b696-8dc9594c6a02
        config: {}
        dataType: INT
        defaultValue: ""
        description: NUMBER OF CONTRACT CATEGORIES USED IN THE PREVIOUS 12 MONTH PERIOD (MONTHS 13 - 24 AGO). COUNT IS BASED ON CONTRACTCATEGORY.
        name: PREV12MONUMOFCATEGORIESUSED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b50031e9-aa0a-473d-acd3-bf8f5aaafd53
                stepCounter: 0ccbe0b4-ca53-4e05-93d5-a7c7292d1fa7
            transform: COUNT (DISTINCT CONTRACTCATEGORY)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 360d2cd7-5b6c-41e6-9535-0a3af9da95d6
          stepCounter: 7872d774-d5b4-4083-b696-8dc9594c6a02
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LAST TRANSACTION DATE FOR ACCOUNT.
        name: LASTTRANSACTIONDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b335c955-e1e7-4383-b7d0-663b5b7c86d1
                stepCounter: 0ccbe0b4-ca53-4e05-93d5-a7c7292d1fa7
            transform: MAX(RECEIPTDATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7cd2dde-2903-4629-bbfb-4b92441ecf73
          stepCounter: 7872d774-d5b4-4083-b696-8dc9594c6a02
        config: {}
        dataType: INT
        defaultValue: ""
        description: LAST TRANSACTION DATE FOR ACCOUNT.
        name: MONTHSSINCELASTTRANSACTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b335c955-e1e7-4383-b7d0-663b5b7c86d1
                stepCounter: 0ccbe0b4-ca53-4e05-93d5-a7c7292d1fa7
            transform: DATEDIFF(MONTH, MAX(TRANSACTIONDATE), MAX(MAXRECEIPTDATE))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05fb48b0-57b8-4a17-84e2-e6b106464e71
          stepCounter: 7872d774-d5b4-4083-b696-8dc9594c6a02
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LAST TRANSACTION DATE FOR ACCOUNT IN THE PREVIOUS 12 MONTH PERIOD (MONTHS 13 - 24 AGO).
        name: PREV12MOLASTTRANSACTIONDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 756e7aa7-086e-4853-bfc3-ae3e60d3b315
                stepCounter: 0ccbe0b4-ca53-4e05-93d5-a7c7292d1fa7
            transform: MAX(TRANSACTIONDATE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 421b037f-f56b-4bf6-9122-ef0657fb423f
          stepCounter: 7872d774-d5b4-4083-b696-8dc9594c6a02
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: SUM OF SALES FOR THE PREVIOUS 12 MONTH PERIOD (MONTHS 13 - 24 AGO)
        name: PREV12MOSALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f345370f-af43-43c9-9e1f-4d08472f5bb0
                stepCounter: 0ccbe0b4-ca53-4e05-93d5-a7c7292d1fa7
            transform: SUM(SALES)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd8c319d-85fe-43eb-988d-7ebab65df68b
          stepCounter: 7872d774-d5b4-4083-b696-8dc9594c6a02
        config: {}
        dataType: NUMERIC(18,4)
        defaultValue: ""
        description: SUM OF REVENUE FOR THE PREVIOUS 12 MONTH PERIOD (MONTHS 13 - 24 AGO)
        name: PREV12MOREVENUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: efde9b45-b831-4309-96d4-a0c3f61d81a7
                stepCounter: 0ccbe0b4-ca53-4e05-93d5-a7c7292d1fa7
            transform: SUM(REVENUE)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 353c02dc-8ed7-443e-a805-3fe73e131d65
          stepCounter: 7872d774-d5b4-4083-b696-8dc9594c6a02
        config: {}
        dataType: INT
        defaultValue: ""
        description: NEW OF NEW CONTRACTS USED BY ACCOUNT ON A ROLLING 12 MONTH BASIS FOR THE PREVIOUS 12 MONTH PERIOD (MONTHS 13 - 24 AGO)
        name: PREV12MONUMOFNEWCONTRACTSUSED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: COUNT (DISTINCT CASE WHEN ISCONTRACTUSENEWORRECURRINGINTRAILING12MONTHSFORFORCEPARENTID = 'NEW' THEN PPACONTRACTNUMBER END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53305383-cc17-48da-ac29-ddeebb1d79a7
          stepCounter: 7872d774-d5b4-4083-b696-8dc9594c6a02
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f059d8fb-494f-49f3-975d-31c27a2a138d
          stepCounter: 7872d774-d5b4-4083-b696-8dc9594c6a02
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VWSALESANDREVENUE: 0ccbe0b4-ca53-4e05-93d5-a7c7292d1fa7
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: REPORTS
            nodeName: VWSALESANDREVENUE
        join:
          joinCondition: FROM {{ ref('REPORTS','VWSALESANDREVENUE') }}
        name: AGGACCOUNTPREV12MOSTATS
        noLinkRefs: []
  name: AGGACCOUNTPREV12MOSTATS
  overrideSQL: false
  schema: ""
  sqlType: Fact
  type: sql
  version: 1
type: Node
