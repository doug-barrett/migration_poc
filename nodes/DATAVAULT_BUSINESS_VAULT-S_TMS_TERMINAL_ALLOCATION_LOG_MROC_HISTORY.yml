fileVersion: 1
id: 27e7463f-cb2d-47f7-bdc4-9134a46bdf93
name: S_TMS_TERMINAL_ALLOCATION_LOG_MROC_HISTORY
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DATAVAULT_BUSINESS_VAULT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e71018e-7bb0-4918-b9c1-521716760392
          stepCounter: 27e7463f-cb2d-47f7-bdc4-9134a46bdf93
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: ""
        name: HK_H_TMS_TERMINAL_ALLOCATION
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a25f312f-3fe0-452b-86a6-237adffe44bb
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3dfa544-7c4a-4856-84c6-31fe11022b9f
          stepCounter: 27e7463f-cb2d-47f7-bdc4-9134a46bdf93
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: Locale identifier
        isBusinessKey: true
        name: LOCALE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11ab311a-11ae-449c-acb9-19f103800aea
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c7d5a68-0f9c-47ad-a1a7-2ef5aa267e8f
          stepCounter: 27e7463f-cb2d-47f7-bdc4-9134a46bdf93
        config: {}
        dataType: VARCHAR(9)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: MERCHANT_NUMBER_ACI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8b1d72e-3ce7-470f-a218-04b56b0349ae
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 144237da-2a01-44ee-881c-339ba3444ddc
          stepCounter: 27e7463f-cb2d-47f7-bdc4-9134a46bdf93
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: FILE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c10d8afb-89b2-46ac-acc6-eea31ee44754
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8cff74a3-6e75-4681-b4ea-26bdb015349f
          stepCounter: 27e7463f-cb2d-47f7-bdc4-9134a46bdf93
        config: {}
        dataType: VARCHAR(19)
        defaultValue: ""
        description: ""
        name: DEVICE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84ad3997-7dce-444e-8cf7-967be7ebe79a
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8167f96-5fa2-4ffe-b90c-caab8df0cd33
          stepCounter: 27e7463f-cb2d-47f7-bdc4-9134a46bdf93
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Merchant number associated with the Locale
        name: MERCHANT_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a7de5359-4c7d-4239-bd9c-6275fa47887b
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2206f09-a0f9-4cd8-9239-afda9c0f0498
          stepCounter: 27e7463f-cb2d-47f7-bdc4-9134a46bdf93
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ACTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc70146a-3ee5-45c5-8ce7-99f9569c2b49
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb094b79-a4a5-4474-8107-70c7c05a6171
          stepCounter: 27e7463f-cb2d-47f7-bdc4-9134a46bdf93
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: USER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 61685951-e22a-4632-a4db-8791af7902ef
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f992a5a-0e30-4dda-a4bd-59d50d0f7446
          stepCounter: 27e7463f-cb2d-47f7-bdc4-9134a46bdf93
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: "Indicates the interface that performed the action:\n\n- 1: Terminal\n\n- 2: TMS Interface\n\n- 3: Merchant Direct\n\n- 4: Gift & Loyalty\n\n- 5: OMS-Boarding Interface\n\n- 6: Scheduler Interface\n\n- 7: GO Portal Interface\n\n- 8: MFS Interface\n\n- 9: Boarding Migration"
        name: RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a48e64f7-0acd-47a4-85b1-e0f6c0bf1b2d
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd41e142-c958-4d5d-a6aa-2e4d039aad0e
          stepCounter: 27e7463f-cb2d-47f7-bdc4-9134a46bdf93
        config: {}
        dataType: TIMESTAMP_NTZ(3)
        defaultValue: ""
        description: ""
        name: CREATION_TS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ae7f3c3b-ab1c-4bab-a6e1-bf88b0ea64f9
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8342bc80-27f3-406b-862f-f176ce84d1cc
          stepCounter: 27e7463f-cb2d-47f7-bdc4-9134a46bdf93
        config: {}
        dataType: NUMBER(38,0)
        defaultValue: ""
        description: ""
        name: DEVICE_SLOT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ecd9368-94a4-4582-b807-b2cd2a1c8225
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74f0d2b9-c001-4240-ad27-8a7c9508c534
          stepCounter: 27e7463f-cb2d-47f7-bdc4-9134a46bdf93
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CREATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f985a848-9454-4815-8a44-b159d2d64843
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70f588b1-ff9c-4e5c-82d4-042b2329e3bc
          stepCounter: 27e7463f-cb2d-47f7-bdc4-9134a46bdf93
        config: {}
        dataType: TIMESTAMP_NTZ(3)
        defaultValue: ""
        description: ""
        name: CREATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8d8c6412-6aae-40b3-8374-f117c234a265
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 099db21b-3246-4292-9ec3-49cdaedf86f3
          stepCounter: 27e7463f-cb2d-47f7-bdc4-9134a46bdf93
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: UPDATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db8a815d-6575-4e67-8ec8-d7f039a9abe3
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb58ed07-2e4e-41dd-9e87-f97d4c6b631e
          stepCounter: 27e7463f-cb2d-47f7-bdc4-9134a46bdf93
        config: {}
        dataType: TIMESTAMP_NTZ(3)
        defaultValue: ""
        description: ""
        name: UPDATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ebabe1f-6c31-4238-8c36-a33ab6f669ff
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8341fa9e-f03f-41e6-ada7-5e60acc2b844
          stepCounter: 27e7463f-cb2d-47f7-bdc4-9134a46bdf93
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: RUN_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6bfac010-f1f8-4a8c-942f-13c74c9f6a2f
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1293bf31-ff98-478b-b9f7-8f1c3bfb989e
          stepCounter: 27e7463f-cb2d-47f7-bdc4-9134a46bdf93
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: The changing hash
        name: DSS_CHANGE_HASH
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b000fc61-c70a-47b6-b0b1-232e9d2e917a
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c9b1eef-1009-48da-aa7b-cd4ebb9ae9d5
          stepCounter: 27e7463f-cb2d-47f7-bdc4-9134a46bdf93
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Record source
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 583bb1c7-23c5-4b23-b4d4-c8af6e40ef19
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79ce85f1-2862-40bc-ba51-4ce71c9f3ed3
          stepCounter: 27e7463f-cb2d-47f7-bdc4-9134a46bdf93
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was loaded in the data vault
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ede1ecce-402c-450a-8b4d-37dc297d3418
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66d1b33d-3f4d-46e5-9114-f58fba1141b5
          stepCounter: 27e7463f-cb2d-47f7-bdc4-9134a46bdf93
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row started in the data vault
        isSystemStartDate: true
        name: DSS_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90100557-6e5b-41ac-b39b-cccaa607f671
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab89876f-5d3d-4f2a-85bd-1b1c19421f14
          stepCounter: 27e7463f-cb2d-47f7-bdc4-9134a46bdf93
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: Version number of a business key in the data vault
        isSurrogateKey: true
        isSystemVersion: true
        name: DSS_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0bbd32e8-f916-4c09-b861-cc5a37e8564e
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14cb5847-7166-4176-86d6-95ab09def9d0
          stepCounter: 27e7463f-cb2d-47f7-bdc4-9134a46bdf93
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was inserted in the data vault
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed988546-dd18-461b-901b-7ed6accf7ebb
                stepCounter: feba6e7b-a930-467f-9825-95803431c2bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0616e1b2-1474-4765-9059-04231ea09153
          stepCounter: 27e7463f-cb2d-47f7-bdc4-9134a46bdf93
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: End date determined by the next Satellite change record dss_start_date
        isSystemEndDate: true
        name: DSS_END_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: LEAD(dss_start_date, 1, '9999-12-31') OVER(PARTITION BY hk_h_tms_terminal_allocation ORDER BY dss_start_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8310948d-ffdc-47f8-bcb0-54dc944888bb
          stepCounter: 27e7463f-cb2d-47f7-bdc4-9134a46bdf93
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: CurrentFlag 'N' unless next Satellite change record dss_start_date is null, indicating this is the most current record.
        isSurrogateKey: true
        isSystemCurrentFlag: true
        name: DSS_CURRENT_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN LEAD(dss_start_date, 1, NULL) OVER(PARTITION BY hk_h_tms_terminal_allocation ORDER BY dss_start_date) IS NULL THEN 'Y'
                          ELSE 'N'
                           END
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_TMS_TERMINAL_ALLOCATION_LOG_MROC: feba6e7b-a930-467f-9825-95803431c2bb
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATAVAULT_RAW_VAULT
            nodeName: S_TMS_TERMINAL_ALLOCATION_LOG_MROC
        join:
          joinCondition: FROM {{ ref('DATAVAULT_RAW_VAULT','S_TMS_TERMINAL_ALLOCATION_LOG_MROC') }} s_tms_terminal_allocation_log_mroc
        name: S_TMS_TERMINAL_ALLOCATION_LOG_MROC_HISTORY
        noLinkRefs: []
  name: S_TMS_TERMINAL_ALLOCATION_LOG_MROC_HISTORY
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
