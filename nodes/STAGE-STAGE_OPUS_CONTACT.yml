fileVersion: 1
id: f2657516-2f6b-4224-b937-9a83e5226195
name: STAGE_OPUS_CONTACT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 60506b5b-3459-47e6-815b-106f853ab476
          stepCounter: f2657516-2f6b-4224-b937-9a83e5226195
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CONTACTSALESFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 053af73e-6f7d-49e1-8254-b00192a3bdba
                stepCounter: 3baaa81f-cd03-421d-a8b3-088c2f024e93
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22755cb8-4e28-471a-abdb-fa7b6f75f70c
          stepCounter: f2657516-2f6b-4224-b937-9a83e5226195
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: LASTACTIVITYDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 71ff4260-eb5d-4699-bd7f-554943efed00
                stepCounter: 3baaa81f-cd03-421d-a8b3-088c2f024e93
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cba06279-33a5-4dd3-be0a-d4ad3e46389e
          stepCounter: f2657516-2f6b-4224-b937-9a83e5226195
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f5d064a8-ad1d-4383-936d-b52d959a7bdd
                stepCounter: eb2c8db8-1c15-4d15-b05b-67a9df256377
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 35c78ec4-bb07-4f0b-94a1-91580525cca7
          stepCounter: f2657516-2f6b-4224-b937-9a83e5226195
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 061f3d5b-206f-41b9-8f47-11ddb9538315
                stepCounter: eb2c8db8-1c15-4d15-b05b-67a9df256377
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0ad9569-5bb7-47d7-aa95-742cc0762b1f
          stepCounter: f2657516-2f6b-4224-b937-9a83e5226195
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: OPUS_ACCOUNT_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c75f3ee-9b76-4a20-aafb-b33f554f0d2b
                stepCounter: 6ef3db35-d520-4bb5-80a8-3fd40b82d18e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fda5b97d-b5de-422f-ae0c-d935ea46b5e1
          stepCounter: f2657516-2f6b-4224-b937-9a83e5226195
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE HIGHEST-LEVEL OF HIERARCHY FOR AN ACCOUNT
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2e90960f-79ae-4d02-ba8d-8e55ee3ae0d1
                stepCounter: 3baaa81f-cd03-421d-a8b3-088c2f024e93
            transform: IFNULL(TRY_CAST(STAGECONTACTS_1.LEVEL1FORCEID AS INT),0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8eefb16c-339e-4a07-9d45-16c92daada57
          stepCounter: f2657516-2f6b-4224-b937-9a83e5226195
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d5f9aa97-a8e6-401b-bc32-0f8942064ca2
                stepCounter: eb2c8db8-1c15-4d15-b05b-67a9df256377
            transform: IFNULL(TRY_CAST(LOADOPUS_CONTACT.FORCEID AS INT),0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c65b5de8-88a0-4fc0-80fc-555fa8bf2d67
          stepCounter: f2657516-2f6b-4224-b937-9a83e5226195
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2675d3ae-7709-41d8-bf03-dca758010de6
                stepCounter: eb2c8db8-1c15-4d15-b05b-67a9df256377
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75b724a9-31da-4c63-a28f-679812a14642
          stepCounter: f2657516-2f6b-4224-b937-9a83e5226195
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d279c6a8-465b-4920-9f39-f9a84151c2a8
                stepCounter: eb2c8db8-1c15-4d15-b05b-67a9df256377
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16591d56-7bbf-40c6-9659-6dade45ad3d2
          stepCounter: f2657516-2f6b-4224-b937-9a83e5226195
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CREATEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d6c371b9-2fc4-453c-a2d5-fee49fb76724
                stepCounter: eb2c8db8-1c15-4d15-b05b-67a9df256377
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39d320f1-18f1-4142-8921-3c3d592b845f
          stepCounter: f2657516-2f6b-4224-b937-9a83e5226195
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: EMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 32e73a83-8cb1-4097-84a7-9d59176dec91
                stepCounter: eb2c8db8-1c15-4d15-b05b-67a9df256377
            transform: LOWER(LOADOPUS_CONTACT.EMAIL)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03e71d35-d230-48b7-961c-3875a79dabdc
          stepCounter: f2657516-2f6b-4224-b937-9a83e5226195
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CREATEDWAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b8b5cf3-13b2-4ea8-8e0c-278ca45c3d18
                stepCounter: eb2c8db8-1c15-4d15-b05b-67a9df256377
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 89553f49-a433-4359-8379-3d25df31cf48
          stepCounter: f2657516-2f6b-4224-b937-9a83e5226195
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: HOWDIDYOUHEARABOUTOPUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4da92e2c-429e-407b-807d-7ca5ea95b199
                stepCounter: eb2c8db8-1c15-4d15-b05b-67a9df256377
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 557a4cff-7199-44ae-a22e-16cf30283344
          stepCounter: f2657516-2f6b-4224-b937-9a83e5226195
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ACCEPETEDTERMSANDCONDITIONS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2f57e596-0b25-49b0-bc05-1adaf37bcf89
                stepCounter: eb2c8db8-1c15-4d15-b05b-67a9df256377
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e6e8aae-8b32-4497-b9c3-6856bb4f67cc
          stepCounter: f2657516-2f6b-4224-b937-9a83e5226195
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: MODIFIEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 797a9d16-b541-41fe-a5ee-1e71e56b6484
                stepCounter: eb2c8db8-1c15-4d15-b05b-67a9df256377
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6f2a5a1-69ca-4361-a95a-17dd4985418d
          stepCounter: f2657516-2f6b-4224-b937-9a83e5226195
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e6cb5b3-8131-4b4f-8624-dbbc196763d9
                stepCounter: eb2c8db8-1c15-4d15-b05b-67a9df256377
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: efaa94d4-3a61-48f2-b4f4-2d24e2e2bafc
          stepCounter: f2657516-2f6b-4224-b937-9a83e5226195
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: LASTLOGINDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 71f7de1b-0fc1-4b10-bc9e-0ee68f548468
                stepCounter: eb2c8db8-1c15-4d15-b05b-67a9df256377
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 60ed2a31-1289-4cb5-8714-4c8780d51d26
          stepCounter: f2657516-2f6b-4224-b937-9a83e5226195
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: OPUSSUBSOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4bc06434-adfe-4dd3-9481-7813917734b2
                stepCounter: eb2c8db8-1c15-4d15-b05b-67a9df256377
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e9fbffa-e234-4fd7-a7b3-9929053e2d01
          stepCounter: f2657516-2f6b-4224-b937-9a83e5226195
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a29e201-63dd-4eca-8ecb-656fa535ec62
                stepCounter: eb2c8db8-1c15-4d15-b05b-67a9df256377
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 102e745a-ef46-403c-90bb-304e580c2d28
          stepCounter: f2657516-2f6b-4224-b937-9a83e5226195
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7aada92f-7371-4464-a153-96ba16293419
          stepCounter: f2657516-2f6b-4224-b937-9a83e5226195
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOAD_OPUS_CONTACT: eb2c8db8-1c15-4d15-b05b-67a9df256377
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOAD_OPUSACCOUNT
          - locationName: LOAD
            nodeName: LOAD_OPUS_CONTACT
          - locationName: STAGE
            nodeName: STAGE_CONTACTS_1
        join:
          joinCondition: |-
            FROM {{ ref('LOAD','LOAD_OPUS_CONTACT') }} LOAD_OPUS_CONTACT
              LEFT JOIN STAGE_.STAGE_ACCOUNT_2 STAGE_ACCOUNT_2
                ON TRY_CAST(LOAD_OPUS_CONTACT.FORCEID AS INT) = STAGE_ACCOUNT_2.FORCEID
              LEFT JOIN STAGE_.STAGE_CONTACTS_1 STAGE_CONTACTS_1
                ON STAGE_CONTACTS_1.EMAIL = LOAD_OPUS_CONTACT.EMAIL
               AND STAGE_CONTACTS_1.FORCEID = TRY_CAST(LOAD_OPUS_CONTACT.FORCEID AS INT)
              LEFT JOIN LOAD_.LOAD_OPUSACCOUNT
                ON LOAD_OPUS_CONTACT.ORGANIZATIONID=LOAD_OPUSACCOUNT.ORGANIZATIONID
        name: STAGEOPUS_CONTACT
        noLinkRefs: []
  name: STAGE_OPUS_CONTACT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
