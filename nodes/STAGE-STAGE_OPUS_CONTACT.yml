fileVersion: 1
id: a6e66945-de23-4d37-96d4-eca0e04775ef
name: STAGE_OPUS_CONTACT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e565f592-5b6e-431a-b69e-5f4d4aa0f718
          stepCounter: a6e66945-de23-4d37-96d4-eca0e04775ef
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: CONTACTSALESFORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0856e991-5b09-4f30-9581-966e6e5454c5
                stepCounter: 9cc9d874-fd56-456b-974f-2acae0380bcf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 921ef76e-872e-4855-9792-cf2081365fcd
          stepCounter: a6e66945-de23-4d37-96d4-eca0e04775ef
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: LASTACTIVITYDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0508e933-36f5-4ecf-a046-667f3b6eca36
                stepCounter: 9cc9d874-fd56-456b-974f-2acae0380bcf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb98ec72-bcab-4f62-8dcf-118c2a48ed12
          stepCounter: a6e66945-de23-4d37-96d4-eca0e04775ef
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CUSTOMERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77a5f33d-58bf-45b3-9d59-9b98cf03ff3d
                stepCounter: 48d29d54-131d-4bef-94b0-eb7c15c7d023
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f5ba1aa-ad0b-4cb2-bfba-a3bf5d3da969
          stepCounter: a6e66945-de23-4d37-96d4-eca0e04775ef
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: adcbe132-b817-4462-b96a-56af947bc00d
                stepCounter: 48d29d54-131d-4bef-94b0-eb7c15c7d023
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ea91720-609d-46b4-84a7-729ca20df420
          stepCounter: a6e66945-de23-4d37-96d4-eca0e04775ef
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: OPUS_ACCOUNT_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d392459-de36-42f1-a9ca-0e5e0cc60efe
                stepCounter: 94dc567e-fd85-495f-839a-08c79472cc51
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6d1fa69-37c2-42fc-a35b-aeadf98e9d42
          stepCounter: a6e66945-de23-4d37-96d4-eca0e04775ef
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE HIGHEST-LEVEL OF HIERARCHY FOR AN ACCOUNT
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c8cd7552-16dc-473f-9a95-337fd949386f
                stepCounter: 9cc9d874-fd56-456b-974f-2acae0380bcf
            transform: IFNULL(TRY_CAST(STAGECONTACTS_1.LEVEL1FORCEID AS INT),0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f18db8b-8dd7-4b94-9c7c-5b3e37283703
          stepCounter: a6e66945-de23-4d37-96d4-eca0e04775ef
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb50a164-0434-4877-b71f-455c6ae75560
                stepCounter: 48d29d54-131d-4bef-94b0-eb7c15c7d023
            transform: IFNULL(TRY_CAST(LOADOPUS_CONTACT.FORCEID AS INT),0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a477f9ad-5987-49d4-9401-05aee955c402
          stepCounter: a6e66945-de23-4d37-96d4-eca0e04775ef
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: ORGANIZATIONID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5437ca8c-8b0b-4532-baad-67f7b7eaedfd
                stepCounter: 48d29d54-131d-4bef-94b0-eb7c15c7d023
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed1df6ec-ae10-4331-affc-ff0be56a35ff
          stepCounter: a6e66945-de23-4d37-96d4-eca0e04775ef
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 249794df-33b6-43b8-bbe9-98b493679a6b
                stepCounter: 48d29d54-131d-4bef-94b0-eb7c15c7d023
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f3f42ef6-87b6-4fcd-aaec-2f005dce6043
          stepCounter: a6e66945-de23-4d37-96d4-eca0e04775ef
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CREATEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2154d8e-f553-4027-9e55-6f7312363621
                stepCounter: 48d29d54-131d-4bef-94b0-eb7c15c7d023
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af1512bd-0a4e-4145-bba7-d5c5d61a85c9
          stepCounter: a6e66945-de23-4d37-96d4-eca0e04775ef
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: EMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9508b9d5-0aaa-442b-b88d-7a73b4d3a43e
                stepCounter: 48d29d54-131d-4bef-94b0-eb7c15c7d023
            transform: LOWER(LOADOPUS_CONTACT.EMAIL)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4bd9b916-6694-4d1f-b5cc-23b88606bdc4
          stepCounter: a6e66945-de23-4d37-96d4-eca0e04775ef
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CREATEDWAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8195870f-091c-4229-91c7-0cda9b52c4d0
                stepCounter: 48d29d54-131d-4bef-94b0-eb7c15c7d023
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f9cbfdf-bb7a-428f-995f-d8b85da5bbd5
          stepCounter: a6e66945-de23-4d37-96d4-eca0e04775ef
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: HOWDIDYOUHEARABOUTOPUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9ab02503-4553-4ade-85bf-2b10c4f1c7c3
                stepCounter: 48d29d54-131d-4bef-94b0-eb7c15c7d023
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 593d4210-d462-4624-b41e-579fe79c95bc
          stepCounter: a6e66945-de23-4d37-96d4-eca0e04775ef
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        name: ACCEPETEDTERMSANDCONDITIONS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bdf90886-05c4-419a-bdb5-06639889d92e
                stepCounter: 48d29d54-131d-4bef-94b0-eb7c15c7d023
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a40d456-76e9-40af-a669-ace41b094da9
          stepCounter: a6e66945-de23-4d37-96d4-eca0e04775ef
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: MODIFIEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07a506cb-6325-4725-8f01-7de320bcb77f
                stepCounter: 48d29d54-131d-4bef-94b0-eb7c15c7d023
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d93e8ec-a361-4c63-b983-38abf3591a79
          stepCounter: a6e66945-de23-4d37-96d4-eca0e04775ef
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: RECORD SOURCE.
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d51418b2-c494-4ea3-8113-f17ffaaf1418
                stepCounter: 48d29d54-131d-4bef-94b0-eb7c15c7d023
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 839c46f0-beb0-4309-8e96-f3300f3284c0
          stepCounter: a6e66945-de23-4d37-96d4-eca0e04775ef
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: LASTLOGINDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc096822-4047-4dd4-9691-8d29231889ed
                stepCounter: 48d29d54-131d-4bef-94b0-eb7c15c7d023
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd21c5da-01fc-41e6-9b51-594110e2500b
          stepCounter: a6e66945-de23-4d37-96d4-eca0e04775ef
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: OPUSSUBSOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8caf8422-bb3f-49e9-900f-75cde084ead7
                stepCounter: 48d29d54-131d-4bef-94b0-eb7c15c7d023
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8183e870-b38d-4099-8ec7-c90284067dd4
          stepCounter: a6e66945-de23-4d37-96d4-eca0e04775ef
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: LOAD DATE.
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f84983d-56b4-4c22-a700-ec285bb494ce
                stepCounter: 48d29d54-131d-4bef-94b0-eb7c15c7d023
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8ecd9f5-82c1-424a-982b-031ce8a321dd
          stepCounter: a6e66945-de23-4d37-96d4-eca0e04775ef
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a71f1df2-204c-40cb-a543-652b44e1932d
          stepCounter: a6e66945-de23-4d37-96d4-eca0e04775ef
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOAD_OPUSACCOUNT
          - locationName: LOAD
            nodeName: LOAD_OPUS_CONTACT
          - locationName: STAGE
            nodeName: STAGE_CONTACTS_1
          - locationName: UNKNOWN
            nodeName: LOADOPUS_CONTACT
        join:
          joinCondition: |-
            FROM {{ ref('UNKNOWN','LOADOPUS_CONTACT') }} LOADOPUS_CONTACT
              LEFT JOIN STAGE.STAGEACCOUNT_2 STAGEACCOUNT_2
                ON TRY_CAST(LOADOPUS_CONTACT.FORCEID AS INT) = STAGEACCOUNT_2.FORCEID
              LEFT JOIN STAGE.STAGECONTACTS_1 STAGECONTACTS_1
                ON STAGECONTACTS_1.EMAIL = LOADOPUS_CONTACT.EMAIL
               AND STAGECONTACTS_1.FORCEID = TRY_CAST(LOADOPUS_CONTACT.FORCEID AS INT)
              LEFT JOIN LOAD.LOADOPUSACCOUNT
                ON LOADOPUS_CONTACT.ORGANIZATIONID=LOADOPUSACCOUNT.ORGANIZATIONID
        name: STAGEOPUS_CONTACT
        noLinkRefs: []
  name: STAGE_OPUS_CONTACT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
