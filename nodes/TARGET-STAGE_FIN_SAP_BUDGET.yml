fileVersion: 1
id: 34cf5c29-4a3a-4841-979e-205dfed40038
name: STAGE_FIN_SAP_BUDGET
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf723f21-358f-4479-bee9-45a80622dc6f
          stepCounter: 34cf5c29-4a3a-4841-979e-205dfed40038
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEDGER_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: af0a440c-8437-4811-a1c3-68aa38a3b0a0
                stepCounter: 231e86b2-e335-450f-b991-fc6aa2c2fe4c
            transform: NVL(DIM_LO_SAP_LEDGER.DIM_LEDGER_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 020013cd-5c07-4ed2-bc02-424784cef9f7
          stepCounter: 34cf5c29-4a3a-4841-979e-205dfed40038
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_COST_CENTER_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f9cd4561-df13-4a2c-9e91-edfcf7767bd5
                stepCounter: 99b4a618-454e-46de-874d-ad30b4d42108
            transform: NVL(DIM_LO_SAP_COST_CENTER.DIM_COST_CENTER_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b45cef4-b8f5-467b-8efa-714499f78082
          stepCounter: 34cf5c29-4a3a-4841-979e-205dfed40038
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_DEST_ORGANIZATION_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5cdadf22-7f44-45f1-a78d-060f129ef387
                stepCounter: c958411f-21aa-4192-bbb1-c20096a8bcd3
            transform: NVL(DIM_LO_SAP_DEST_ORGANIZATION.DIM_DEST_ORGANIZATION_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c40c4c7-2a62-4d6b-ae59-0007ab4d7081
          stepCounter: 34cf5c29-4a3a-4841-979e-205dfed40038
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GL_ACCOUNT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1bfac200-cf5f-4920-af2c-25aea984b61d
                stepCounter: eded27ac-fd68-4b41-8110-94b692c365d5
            transform: NVL(DIM_LO_SAP_GL_ACCOUNT.DIM_GL_ACCOUNT_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4bfd0b37-16bc-4627-811e-d5ddbe798e95
          stepCounter: 34cf5c29-4a3a-4841-979e-205dfed40038
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GROSS_NET_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2829c0ef-25f1-4706-9bef-2fe6fcf26e1d
                stepCounter: 592816dc-3717-40cf-ac36-2ff66c9e8146
            transform: NVL(DIM_LO_SAP_GROSS_NET.DIM_GROSS_NET_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ea3950f-2dc1-400c-bed9-a4b30f26ef99
          stepCounter: 34cf5c29-4a3a-4841-979e-205dfed40038
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 739b941e-c607-4803-994d-db4e17460ddc
                stepCounter: f1879670-70ca-4133-bc5d-193fd6cd9104
            transform: NVL(DIM_LO_SAP_AFE_TYPE.DIM_AFE_TYPE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c97fa92d-29af-453a-914c-46f7c6b6df29
          stepCounter: 34cf5c29-4a3a-4841-979e-205dfed40038
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_PRODUCT_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b89587af-fd5b-4cfb-b17d-a9946c3f7396
                stepCounter: e14ab72e-3f25-44f0-b70c-6a0192afcc50
            transform: NVL(DIM_LO_SAP_PRODUCT_TYPE.DIM_PRODUCT_TYPE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bff5a1f5-8b95-4282-9c5b-5efcee08576f
          stepCounter: 34cf5c29-4a3a-4841-979e-205dfed40038
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_ACTVY_PER_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18508ec0-f5a9-459b-8ad8-f0c28c526bfa
                stepCounter: 34296832-56af-448c-8aa3-b1417a68df43
            transform: nvl(TO_NUMBER(TO_CHAR(LOAD_BUDGET_T_BUDGET.ACTVY_PER_DATE, 'YYYYMMDD'), '99999999'),0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 255e2ba5-57e1-49a4-a532-8522622c0224
          stepCounter: 34cf5c29-4a3a-4841-979e-205dfed40038
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_ACCT_PER_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: baed450f-b9d5-4c24-b58b-70311d96cd52
                stepCounter: 34296832-56af-448c-8aa3-b1417a68df43
            transform: nvl(TO_NUMBER(TO_CHAR(LOAD_BUDGET_T_BUDGET.ACCT_PER_DATE, 'YYYYMMDD'), '99999999'),0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5fb6657-e927-47fe-a395-5f2b32f32d58
          stepCounter: 34cf5c29-4a3a-4841-979e-205dfed40038
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_BUDGET_VERSION_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5391c14a-774b-4ff5-b7c0-29fe72cd33aa
                stepCounter: 6efe8ffc-c95a-4cf3-b180-83431a167c10
            transform: NVL(DIM_LO_SAP_BUDGET_VERSION.DIM_BUDGET_VERSION_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e18391b3-bd14-4be2-907d-6939cae399e5
          stepCounter: 34cf5c29-4a3a-4841-979e-205dfed40038
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: DIM_ACTVY_PER_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18508ec0-f5a9-459b-8ad8-f0c28c526bfa
                stepCounter: 34296832-56af-448c-8aa3-b1417a68df43
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c757e1ec-c681-4182-8eac-8a04fdf73584
          stepCounter: 34cf5c29-4a3a-4841-979e-205dfed40038
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: DIM_ACCT_PER_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: baed450f-b9d5-4c24-b58b-70311d96cd52
                stepCounter: 34296832-56af-448c-8aa3-b1417a68df43
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 553eed05-5572-406c-be02-3e3f51d947ac
          stepCounter: 34cf5c29-4a3a-4841-979e-205dfed40038
        config: {}
        dataType: VARCHAR(38)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: LI_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f14b933-116a-4c69-a8c2-b6aee10d621b
                stepCounter: fbcf9530-e9fa-4ab2-9e8e-aec1fdcede50
            transform: "'BL'|| DIM_LO_SAP_DEST_ORGANIZATION.ORG_ID|| TO_CHAR(EXTRACT(YEAR FROM LOAD_BUDGET_R_VERSION.EFFECTIVE_DATE))|| RIGHT(TO_CHAR(LOAD_BUDGET_T_BUDGET.IDX), 20)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d61a4ed-b6a1-4051-a427-50c1228a0ec4
          stepCounter: 34cf5c29-4a3a-4841-979e-205dfed40038
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: GLOP_LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3f84c21-4ee9-4cae-88e0-9ce9656d3204
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6834b139-50f0-483d-bac1-7e50d6b59f14
          stepCounter: 34cf5c29-4a3a-4841-979e-205dfed40038
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: GLOP_AMT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eaf1dca2-9782-422e-85c5-da635ee6821c
                stepCounter: e0b535c4-f94e-4ac1-b685-dfdff6293176
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bbd8033f-4e33-49d9-9a73-8991b425bbc3
          stepCounter: 34cf5c29-4a3a-4841-979e-205dfed40038
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: ""
        name: GLOP_CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b1caede-1a51-4a8e-bf79-9b0f66123763
                stepCounter: 34296832-56af-448c-8aa3-b1417a68df43
            transform: LOAD_BUDGET_T_BUDGET.CAD_AMT * DIM_LO_SAP_LEASE_OPS_HIER.FLIPSIGN_BDGT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2cec4cd4-ae1f-49ff-9f54-ac2ef242e77c
          stepCounter: 34cf5c29-4a3a-4841-979e-205dfed40038
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: Translation of T_BUDGET.OP_FX (CAD to OP rate) to GLOP_EXCHANGE_RATE (OP to CAD rate)
        name: GLOP_EXCHANGE_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8217f803-c627-4842-8ebd-3d5a49c436e2
                stepCounter: 34296832-56af-448c-8aa3-b1417a68df43
            transform: 1/LOAD_BUDGET_T_BUDGET.OP_FX
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38e93975-f74e-4e66-b718-6b92f18fb778
          stepCounter: 34cf5c29-4a3a-4841-979e-205dfed40038
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: ""
        name: OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a944a6c1-d453-43e3-a4ca-d0910c229d9e
                stepCounter: 34296832-56af-448c-8aa3-b1417a68df43
            transform: LOAD_BUDGET_T_BUDGET.OP_AMT * DIM_LO_SAP_LEASE_OPS_HIER.FLIPSIGN_BDGT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e58b52c9-3101-4772-aad5-240c68cd75c5
          stepCounter: 34cf5c29-4a3a-4841-979e-205dfed40038
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dfb1095d-a4f5-45f3-8d82-f10b3f33f727
                stepCounter: 34296832-56af-448c-8aa3-b1417a68df43
            transform: LOAD_BUDGET_T_BUDGET.OP_CURR_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ab9894b-d0b7-4181-b2c9-ab9c079d1675
          stepCounter: 34cf5c29-4a3a-4841-979e-205dfed40038
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: Flipsign applied for GL/AFE items that are supplied as positives in the Budget process but negative in the Financial context
        name: CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b1caede-1a51-4a8e-bf79-9b0f66123763
                stepCounter: 34296832-56af-448c-8aa3-b1417a68df43
            transform: LOAD_BUDGET_T_BUDGET.CAD_AMT * DIM_LO_SAP_LEASE_OPS_HIER.FLIPSIGN_BDGT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5459662-bb98-4693-93c5-83362fad3568
          stepCounter: 34cf5c29-4a3a-4841-979e-205dfed40038
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: LI_VOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3039528e-cdb3-482b-8645-68b8722afd07
                stepCounter: 34296832-56af-448c-8aa3-b1417a68df43
            transform: LOAD_BUDGET_T_BUDGET.VOL * DIM_LO_SAP_LEASE_OPS_HIER.FLIPSIGN_BDGT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c29b2fd0-976f-43fa-b326-70c36df77ac3
          stepCounter: 34cf5c29-4a3a-4841-979e-205dfed40038
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: ""
        name: LI_VOL_UOM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4be6f579-4cc7-4ef7-8f68-efa800388b92
                stepCounter: 34296832-56af-448c-8aa3-b1417a68df43
            transform: LOAD_BUDGET_T_BUDGET.VOL_UOM_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 83f30e68-80bf-4772-9450-cc5588f12a09
          stepCounter: 34cf5c29-4a3a-4841-979e-205dfed40038
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3039528e-cdb3-482b-8645-68b8722afd07
                stepCounter: 34296832-56af-448c-8aa3-b1417a68df43
            transform: LOAD_BUDGET_T_BUDGET.VOL * LOAD_VET_FIN_SAP_CONVERSION.LI_TO_BOE * DIM_LO_SAP_LEASE_OPS_HIER.FLIPSIGN_BDGT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 00c1eb61-b6e6-4770-8e00-f12e75ccaef7
          stepCounter: 34cf5c29-4a3a-4841-979e-205dfed40038
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3039528e-cdb3-482b-8645-68b8722afd07
                stepCounter: 34296832-56af-448c-8aa3-b1417a68df43
            transform: LOAD_BUDGET_T_BUDGET.VOL * LOAD_VET_FIN_SAP_CONVERSION.LI_TO_GLOP_METRIC * DIM_LO_SAP_LEASE_OPS_HIER.FLIPSIGN_BDGT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8bcd2f96-251f-4e5b-8137-4200bb496b95
          stepCounter: 34cf5c29-4a3a-4841-979e-205dfed40038
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3039528e-cdb3-482b-8645-68b8722afd07
                stepCounter: 34296832-56af-448c-8aa3-b1417a68df43
            transform: LOAD_BUDGET_T_BUDGET.VOL * LOAD_VET_FIN_SAP_CONVERSION.LI_TO_GLOP_METRIC * DIM_LO_SAP_LEASE_OPS_HIER.FLIPSIGN_BDGT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 43c403cd-5c76-4077-b237-f7aaed2f405b
          stepCounter: 34cf5c29-4a3a-4841-979e-205dfed40038
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3039528e-cdb3-482b-8645-68b8722afd07
                stepCounter: 34296832-56af-448c-8aa3-b1417a68df43
            transform: LOAD_BUDGET_T_BUDGET.VOL * LOAD_VET_FIN_SAP_CONVERSION.LI_TO_GLOP_IMP * DIM_LO_SAP_LEASE_OPS_HIER.FLIPSIGN_BDGT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: afcadfd0-bcb8-4aeb-bfd9-1c07b43a64db
          stepCounter: 34cf5c29-4a3a-4841-979e-205dfed40038
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Indicates amounts are gross or net.
        name: GROSS_OR_NET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 626d2db0-4f67-43d4-be75-12c5d1844a3e
                stepCounter: 592816dc-3717-40cf-ac36-2ff66c9e8146
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7fcfdc5-8288-405e-bfca-0e06b1b6c1bb
          stepCounter: 34cf5c29-4a3a-4841-979e-205dfed40038
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: BU_SF_ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa9fccf0-4e6f-416f-be20-01e6e544d09c
                stepCounter: 2cca214d-2f7a-400c-a483-58b288ed6097
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOAD_BUDGET_T_BUDGET: 34296832-56af-448c-8aa3-b1417a68df43
          LOAD_BUDGET_R_SRC: fbcf9530-e9fa-4ab2-9e8e-aec1fdcede50
          LOAD_BUDGET_R_VERSION: a3d102cb-2314-4d5c-97e1-7fd9a978f1c9
          LOAD_VET_FIN_SAP_AFE_TYPE_ATTR: 8702aa25-7591-4f91-9bfe-26019e5744dc
          LOAD_VET_FIN_SAP_ACCOUNT_ATTR: 181145f3-06a6-4ad9-b836-9a574745c577
          LOAD_VET_FIN_SAP_CONVERSION: afdd1b22-0903-46c3-973a-2d9afcc2520c
          DIM_LO_SAP_BUDGET_VERSION: 6efe8ffc-c95a-4cf3-b180-83431a167c10
          DIM_LO_SAP_COST_CENTER: 99b4a618-454e-46de-874d-ad30b4d42108
          DIM_LO_SAP_DEST_ORGANIZATION: c958411f-21aa-4192-bbb1-c20096a8bcd3
          DIM_LO_SAP_GL_ACCOUNT: eded27ac-fd68-4b41-8110-94b692c365d5
          DIM_LO_SAP_GROSS_NET: 592816dc-3717-40cf-ac36-2ff66c9e8146
          DIM_LO_SAP_AFE_TYPE: f1879670-70ca-4133-bc5d-193fd6cd9104
          DIM_LO_SAP_PRODUCT_TYPE: e14ab72e-3f25-44f0-b70c-6a0192afcc50
          DIM_LO_SAP_LEASE_OPS_HIER: e0b535c4-f94e-4ac1-b685-dfdff6293176
          DIM_LO_SAP_CC_CORP_HIER_CURRENT: 2cca214d-2f7a-400c-a483-58b288ed6097
          DIM_LO_SAP_LEDGER: 231e86b2-e335-450f-b991-fc6aa2c2fe4c
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEDGER
          - locationName: TARGET
            nodeName: LOAD_BUDGET_T_BUDGET
          - locationName: TARGET
            nodeName: LOAD_BUDGET_R_SRC
          - locationName: TARGET
            nodeName: LOAD_BUDGET_R_VERSION
          - locationName: TARGET
            nodeName: LOAD_VET_FIN_SAP_AFE_TYPE_ATTR
          - locationName: TARGET
            nodeName: LOAD_VET_FIN_SAP_ACCOUNT_ATTR
          - locationName: TARGET
            nodeName: LOAD_VET_FIN_SAP_CONVERSION
          - locationName: TARGET
            nodeName: DIM_LO_SAP_BUDGET_VERSION
          - locationName: TARGET
            nodeName: DIM_LO_SAP_COST_CENTER
          - locationName: TARGET
            nodeName: DIM_LO_SAP_DEST_ORGANIZATION
          - locationName: TARGET
            nodeName: DIM_LO_SAP_GL_ACCOUNT
          - locationName: TARGET
            nodeName: DIM_LO_SAP_GROSS_NET
          - locationName: TARGET
            nodeName: DIM_LO_SAP_AFE_TYPE
          - locationName: TARGET
            nodeName: DIM_LO_SAP_PRODUCT_TYPE
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_HIER
          - locationName: TARGET
            nodeName: DIM_LO_SAP_CC_CORP_HIER_CURRENT
        join:
          joinCondition: |-
            FROM {{ ref('TARGET','LOAD_BUDGET_T_BUDGET') }} LOAD_BUDGET_T_BUDGET
              JOIN {{ ref('TARGET','LOAD_BUDGET_R_SRC') }} LOAD_BUDGET_R_SRC
                ON LOAD_BUDGET_T_BUDGET.FK_R_SRC_IDX = LOAD_BUDGET_R_SRC.IDX
              JOIN {{ ref('TARGET','LOAD_BUDGET_R_VERSION') }} LOAD_BUDGET_R_VERSION
                ON LOAD_BUDGET_T_BUDGET.FK_R_VERSION_IDX = LOAD_BUDGET_R_VERSION.IDX
              LEFT JOIN {{ ref('TARGET','LOAD_VET_FIN_SAP_AFE_TYPE_ATTR') }} LOAD_VET_FIN_SAP_AFE_TYPE_ATTR
                ON LOAD_BUDGET_T_BUDGET.AFE_TYPE = LOAD_VET_FIN_SAP_AFE_TYPE_ATTR.AFE_TYPE
              LEFT JOIN {{ ref('TARGET','LOAD_VET_FIN_SAP_ACCOUNT_ATTR') }} LOAD_VET_FIN_SAP_ACCOUNT_ATTR
                ON LOAD_BUDGET_T_BUDGET.ACCOUNT = LOAD_VET_FIN_SAP_ACCOUNT_ATTR.ACCOUNT
               AND LOAD_BUDGET_T_BUDGET.FUNCTIONAL_AREA = LOAD_VET_FIN_SAP_ACCOUNT_ATTR.FAREA
              LEFT JOIN {{ ref('TARGET','LOAD_VET_FIN_SAP_CONVERSION') }} LOAD_VET_FIN_SAP_CONVERSION
                ON LOAD_BUDGET_T_BUDGET.VOL_UOM_CODE = LOAD_VET_FIN_SAP_CONVERSION.LI_VOL_UOM
               AND LOAD_VET_FIN_SAP_ACCOUNT_ATTR.PROD_CODE = LOAD_VET_FIN_SAP_CONVERSION.LI_PROD_CODE
              JOIN {{ ref('TARGET','DIM_LO_SAP_BUDGET_VERSION') }} DIM_LO_SAP_BUDGET_VERSION
                ON LOAD_BUDGET_T_BUDGET.FK_R_VERSION_IDX = DIM_LO_SAP_BUDGET_VERSION.IDX
               AND DIM_LO_SAP_BUDGET_VERSION.VERSION_TYPE='BUDGET'
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_COST_CENTER') }} DIM_LO_SAP_COST_CENTER
                ON LOAD_BUDGET_T_BUDGET.COST_CENTRE = DIM_LO_SAP_COST_CENTER.CC_NUM
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_DEST_ORGANIZATION') }} DIM_LO_SAP_DEST_ORGANIZATION
                ON LOAD_BUDGET_T_BUDGET.DEST_ORG_ID = DIM_LO_SAP_DEST_ORGANIZATION.org_id
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_GL_ACCOUNT') }} DIM_LO_SAP_GL_ACCOUNT
                ON LOAD_BUDGET_T_BUDGET.ACCOUNT = DIM_LO_SAP_GL_ACCOUNT.ACCOUNT
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_GROSS_NET') }} DIM_LO_SAP_GROSS_NET
                ON LOAD_BUDGET_T_BUDGET.GROSS_OR_NET_CODE = DIM_LO_SAP_GROSS_NET.GROSS_OR_NET_CODE
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_AFE_TYPE') }} DIM_LO_SAP_AFE_TYPE
                ON LOAD_BUDGET_T_BUDGET.AFE_TYPE = DIM_LO_SAP_AFE_TYPE.AFE_TYPE
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_PRODUCT_TYPE') }} DIM_LO_SAP_PRODUCT_TYPE
                ON LOAD_VET_FIN_SAP_ACCOUNT_ATTR.PROD_CODE = DIM_LO_SAP_PRODUCT_TYPE.PROD_CODE
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_HIER') }} DIM_LO_SAP_LEASE_OPS_HIER
                ON COALESCE(LOAD_VET_FIN_SAP_ACCOUNT_ATTR.LINE_NO,LOAD_VET_FIN_SAP_AFE_TYPE_ATTR.LINE_NO) = DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_CC_CORP_HIER_CURRENT') }} DIM_LO_SAP_CC_CORP_HIER_CURRENT
                ON DIM_LO_SAP_COST_CENTER.DIM_CC_CORP_HIER_CURRENT_KEY=DIM_LO_SAP_CC_CORP_HIER_CURRENT.DIM_CC_CORP_HIER_CURRENT_KEY
             CROSS JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','DIM_LO_SAP_LEDGER') }}
                     WHERE LEDGER_CODE = '{{ parameters.SAP_LEADING_LEDGER_CODE }}'
                   ) DIM_LO_SAP_LEDGER
        name: STAGE_FIN_SAP_BUDGET
        noLinkRefs: []
  name: STAGE_FIN_SAP_BUDGET
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
