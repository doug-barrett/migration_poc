fileVersion: 1
id: 341a5910-426b-4b61-8cfc-01dbfc59e3f3
name: STAGE_FIN_SAP_BUDGET
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e963f6b7-75a3-4f0f-971b-74a8791231f2
          stepCounter: 341a5910-426b-4b61-8cfc-01dbfc59e3f3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_LEDGER_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a95e2d1c-75ca-40be-9561-3a563b611557
                stepCounter: e8524c23-d9e0-4d83-86ae-428803327912
            transform: NVL(DIM_LO_SAP_LEDGER.DIM_LEDGER_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d66131d2-ebd2-48aa-8e7d-556494f8d1ab
          stepCounter: 341a5910-426b-4b61-8cfc-01dbfc59e3f3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_COST_CENTER_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b116dc36-a893-4aee-bac6-660b69b80fe7
                stepCounter: f601baef-839f-49ab-b102-ee3fad93f21c
            transform: NVL(DIM_LO_SAP_COST_CENTER.DIM_COST_CENTER_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8df926b3-0545-45e9-9ca0-af2c4d7a4a9f
          stepCounter: 341a5910-426b-4b61-8cfc-01dbfc59e3f3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_DEST_ORGANIZATION_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a0d7283d-e92d-4ee0-8225-07d405212e15
                stepCounter: c39a02ca-a012-4752-ac49-7f679c9ff6e4
            transform: NVL(DIM_LO_SAP_DEST_ORGANIZATION.DIM_DEST_ORGANIZATION_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 837b1699-23ff-43dc-ae23-28664bc6dbab
          stepCounter: 341a5910-426b-4b61-8cfc-01dbfc59e3f3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GL_ACCOUNT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 81b0e0b7-59c3-4d21-a951-f953739615a8
                stepCounter: 435a18b2-1dc7-4fc8-b5d0-3eab3af614fd
            transform: NVL(DIM_LO_SAP_GL_ACCOUNT.DIM_GL_ACCOUNT_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6bf1fcdf-52d4-476b-9c61-2f1a632f4d33
          stepCounter: 341a5910-426b-4b61-8cfc-01dbfc59e3f3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_GROSS_NET_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eb169a24-d282-43b6-ade8-2177eeff938e
                stepCounter: 38bc0451-df93-413f-b149-93d0fd46c572
            transform: NVL(DIM_LO_SAP_GROSS_NET.DIM_GROSS_NET_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b03acdd-b3d4-4449-8340-a1c4413ae6f1
          stepCounter: 341a5910-426b-4b61-8cfc-01dbfc59e3f3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_AFE_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a431731-7890-4611-9bf0-533c6bd5b624
                stepCounter: f93a8e45-7804-49aa-b6a3-966e768997dc
            transform: NVL(DIM_LO_SAP_AFE_TYPE.DIM_AFE_TYPE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2d4abfc-3d2b-4e12-aa93-a3694b0ef5fb
          stepCounter: 341a5910-426b-4b61-8cfc-01dbfc59e3f3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_PRODUCT_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b67eb7a6-721a-4634-97dc-8549a0d1c04a
                stepCounter: af796a63-3184-4858-86cc-362cb792e537
            transform: NVL(DIM_LO_SAP_PRODUCT_TYPE.DIM_PRODUCT_TYPE_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8564114-747d-47b4-a7ed-d512f691f48a
          stepCounter: 341a5910-426b-4b61-8cfc-01dbfc59e3f3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_ACTVY_PER_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 571e373b-de8b-4551-8b62-2ed775a78443
                stepCounter: 2e5d2f4e-0c64-4364-9b6d-df174925af08
            transform: nvl(TO_NUMBER(TO_CHAR(LOAD_BUDGET_T_BUDGET.ACTVY_PER_DATE, 'YYYYMMDD'), '99999999'),0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 76c02a89-14ee-4871-a306-518c0988ccf3
          stepCounter: 341a5910-426b-4b61-8cfc-01dbfc59e3f3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_ACCT_PER_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eda27173-894d-4c50-9ef8-0120664b0c67
                stepCounter: 2e5d2f4e-0c64-4364-9b6d-df174925af08
            transform: nvl(TO_NUMBER(TO_CHAR(LOAD_BUDGET_T_BUDGET.ACCT_PER_DATE, 'YYYYMMDD'), '99999999'),0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9be4696-953a-4554-bfab-f9b4651f7d05
          stepCounter: 341a5910-426b-4b61-8cfc-01dbfc59e3f3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_BUDGET_VERSION_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 121393de-41a0-497b-b5aa-a3b5baf6ef3b
                stepCounter: 3972622f-c3a5-4137-8b0b-a139e8efd85c
            transform: NVL(DIM_LO_SAP_BUDGET_VERSION.DIM_BUDGET_VERSION_KEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9612e45-f0ec-4c4e-ba83-79471621949e
          stepCounter: 341a5910-426b-4b61-8cfc-01dbfc59e3f3
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: DIM_ACTVY_PER_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 571e373b-de8b-4551-8b62-2ed775a78443
                stepCounter: 2e5d2f4e-0c64-4364-9b6d-df174925af08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3e9bad7-f7d4-40e2-80f5-05585fd3bacf
          stepCounter: 341a5910-426b-4b61-8cfc-01dbfc59e3f3
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: DIM_ACCT_PER_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eda27173-894d-4c50-9ef8-0120664b0c67
                stepCounter: 2e5d2f4e-0c64-4364-9b6d-df174925af08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7cccfdd8-8661-49af-9249-782d6e8c9d81
          stepCounter: 341a5910-426b-4b61-8cfc-01dbfc59e3f3
        config: {}
        dataType: VARCHAR(38)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: LI_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 818fc5cc-2e48-4e52-9d26-909d27f8572b
                stepCounter: 472dfb51-dcd9-4e70-8b45-c83146f139ff
            transform: "'BL'|| DIM_LO_SAP_DEST_ORGANIZATION.ORG_ID|| TO_CHAR(EXTRACT(YEAR FROM LOAD_BUDGET_R_VERSION.EFFECTIVE_DATE))|| RIGHT(TO_CHAR(LOAD_BUDGET_T_BUDGET.IDX), 20)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff442195-a588-4681-af9c-8b4436a2f484
          stepCounter: 341a5910-426b-4b61-8cfc-01dbfc59e3f3
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: GLOP_LINE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1a83d4b-9af5-4a64-b5b2-f6f811cf7698
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11488a26-61e0-49a9-b159-676e81e2a517
          stepCounter: 341a5910-426b-4b61-8cfc-01dbfc59e3f3
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: GLOP_AMT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb502f0b-51ee-4921-9832-b1e05667ab62
                stepCounter: 82938641-7c51-4aff-ad3a-c7a56af30c01
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2221e10f-29c1-4cab-82f2-64641fdc8a4d
          stepCounter: 341a5910-426b-4b61-8cfc-01dbfc59e3f3
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: ""
        name: GLOP_CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b10cb356-2d6c-4fcb-87aa-03f0b23f06b7
                stepCounter: 2e5d2f4e-0c64-4364-9b6d-df174925af08
            transform: LOAD_BUDGET_T_BUDGET.CAD_AMT * DIM_LO_SAP_LEASE_OPS_HIER.FLIPSIGN_BDGT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f39df543-d6f9-43a9-9606-cf14b208c45a
          stepCounter: 341a5910-426b-4b61-8cfc-01dbfc59e3f3
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: Translation of T_BUDGET.OP_FX (CAD to OP rate) to GLOP_EXCHANGE_RATE (OP to CAD rate)
        name: GLOP_EXCHANGE_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ae08ac6e-73af-4ea3-a02c-701814c6b3e6
                stepCounter: 2e5d2f4e-0c64-4364-9b6d-df174925af08
            transform: 1/LOAD_BUDGET_T_BUDGET.OP_FX
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8fa462d-f906-4d84-b4f3-4455321ac799
          stepCounter: 341a5910-426b-4b61-8cfc-01dbfc59e3f3
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: ""
        name: OP_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1fee04c4-25ec-4158-8746-fcbb5685930e
                stepCounter: 2e5d2f4e-0c64-4364-9b6d-df174925af08
            transform: LOAD_BUDGET_T_BUDGET.OP_AMT * DIM_LO_SAP_LEASE_OPS_HIER.FLIPSIGN_BDGT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81726302-8c99-4aac-a3e5-4571b500fa6c
          stepCounter: 341a5910-426b-4b61-8cfc-01dbfc59e3f3
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OP_CURR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 61b138df-1cfe-44c9-b1f9-a24d72e1e964
                stepCounter: 2e5d2f4e-0c64-4364-9b6d-df174925af08
            transform: LOAD_BUDGET_T_BUDGET.OP_CURR_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b96b7760-2544-4af4-ac9c-62be80c68f47
          stepCounter: 341a5910-426b-4b61-8cfc-01dbfc59e3f3
        config: {}
        dataType: NUMBER(14,2)
        defaultValue: ""
        description: Flipsign applied for GL/AFE items that are supplied as positives in the Budget process but negative in the Financial context
        name: CAD_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b10cb356-2d6c-4fcb-87aa-03f0b23f06b7
                stepCounter: 2e5d2f4e-0c64-4364-9b6d-df174925af08
            transform: LOAD_BUDGET_T_BUDGET.CAD_AMT * DIM_LO_SAP_LEASE_OPS_HIER.FLIPSIGN_BDGT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ba404e1-8aca-4605-8b0a-001551ac4e1f
          stepCounter: 341a5910-426b-4b61-8cfc-01dbfc59e3f3
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: LI_VOL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3c653929-e5b3-43c8-aebb-a32cb4bdd0d9
                stepCounter: 2e5d2f4e-0c64-4364-9b6d-df174925af08
            transform: LOAD_BUDGET_T_BUDGET.VOL * DIM_LO_SAP_LEASE_OPS_HIER.FLIPSIGN_BDGT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a62e6019-5d5d-411c-bfcd-3c613a0085d1
          stepCounter: 341a5910-426b-4b61-8cfc-01dbfc59e3f3
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: ""
        name: LI_VOL_UOM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03c8b92e-0248-4234-b77d-100776e7ebae
                stepCounter: 2e5d2f4e-0c64-4364-9b6d-df174925af08
            transform: LOAD_BUDGET_T_BUDGET.VOL_UOM_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac93f452-716e-4427-b663-7a7f72ebc506
          stepCounter: 341a5910-426b-4b61-8cfc-01dbfc59e3f3
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: LI_VOL_BOE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3c653929-e5b3-43c8-aebb-a32cb4bdd0d9
                stepCounter: 2e5d2f4e-0c64-4364-9b6d-df174925af08
            transform: LOAD_BUDGET_T_BUDGET.VOL * LOAD_VET_FIN_SAP_CONVERSION.LI_TO_BOE * DIM_LO_SAP_LEASE_OPS_HIER.FLIPSIGN_BDGT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 23be33e6-9b7b-4fd9-86d0-0e74c6f52621
          stepCounter: 341a5910-426b-4b61-8cfc-01dbfc59e3f3
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: LI_VOL_M3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3c653929-e5b3-43c8-aebb-a32cb4bdd0d9
                stepCounter: 2e5d2f4e-0c64-4364-9b6d-df174925af08
            transform: LOAD_BUDGET_T_BUDGET.VOL * LOAD_VET_FIN_SAP_CONVERSION.LI_TO_GLOP_METRIC * DIM_LO_SAP_LEASE_OPS_HIER.FLIPSIGN_BDGT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1cc1012-2d91-47be-b04e-93ec6e156273
          stepCounter: 341a5910-426b-4b61-8cfc-01dbfc59e3f3
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: LI_VOL_NM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3c653929-e5b3-43c8-aebb-a32cb4bdd0d9
                stepCounter: 2e5d2f4e-0c64-4364-9b6d-df174925af08
            transform: LOAD_BUDGET_T_BUDGET.VOL * LOAD_VET_FIN_SAP_CONVERSION.LI_TO_GLOP_METRIC * DIM_LO_SAP_LEASE_OPS_HIER.FLIPSIGN_BDGT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 371cd1d4-c19e-4019-9ecb-e0fd691776ff
          stepCounter: 341a5910-426b-4b61-8cfc-01dbfc59e3f3
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        name: LI_VOL_IMPERIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3c653929-e5b3-43c8-aebb-a32cb4bdd0d9
                stepCounter: 2e5d2f4e-0c64-4364-9b6d-df174925af08
            transform: LOAD_BUDGET_T_BUDGET.VOL * LOAD_VET_FIN_SAP_CONVERSION.LI_TO_GLOP_IMP * DIM_LO_SAP_LEASE_OPS_HIER.FLIPSIGN_BDGT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 709b1b07-fa8b-4478-82fc-af763a77d12c
          stepCounter: 341a5910-426b-4b61-8cfc-01dbfc59e3f3
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: Indicates amounts are gross or net.
        name: GROSS_OR_NET_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a4f7236-91f6-4e68-9895-255b3c0dd346
                stepCounter: 38bc0451-df93-413f-b149-93d0fd46c572
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01db01ea-6098-4e74-8c44-64ae12500312
          stepCounter: 341a5910-426b-4b61-8cfc-01dbfc59e3f3
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: BU_SF_ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a8a2af3f-3c81-43f5-bed5-ffb6a448597f
                stepCounter: 067903b4-15b6-458b-abc2-85946f5a3432
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          LOAD_BUDGET_T_BUDGET: 2e5d2f4e-0c64-4364-9b6d-df174925af08
          LOAD_BUDGET_R_SRC: 472dfb51-dcd9-4e70-8b45-c83146f139ff
          LOAD_BUDGET_R_VERSION: d876a688-7405-416c-a8d2-c320880c01c1
          LOAD_VET_FIN_SAP_AFE_TYPE_ATTR: 89b6853d-ec92-4ce1-87b8-e50bebc37373
          LOAD_VET_FIN_SAP_ACCOUNT_ATTR: 95e4d277-8530-4e7c-b5fc-957bab063b60
          LOAD_VET_FIN_SAP_CONVERSION: 1403c7f4-03b4-4310-a62b-39ecaecfc517
          DIM_LO_SAP_BUDGET_VERSION: 3972622f-c3a5-4137-8b0b-a139e8efd85c
          DIM_LO_SAP_COST_CENTER: f601baef-839f-49ab-b102-ee3fad93f21c
          DIM_LO_SAP_DEST_ORGANIZATION: c39a02ca-a012-4752-ac49-7f679c9ff6e4
          DIM_LO_SAP_GL_ACCOUNT: 435a18b2-1dc7-4fc8-b5d0-3eab3af614fd
          DIM_LO_SAP_GROSS_NET: 38bc0451-df93-413f-b149-93d0fd46c572
          DIM_LO_SAP_AFE_TYPE: f93a8e45-7804-49aa-b6a3-966e768997dc
          DIM_LO_SAP_PRODUCT_TYPE: af796a63-3184-4858-86cc-362cb792e537
          DIM_LO_SAP_LEASE_OPS_HIER: 82938641-7c51-4aff-ad3a-c7a56af30c01
          DIM_LO_SAP_CC_CORP_HIER_CURRENT: 067903b4-15b6-458b-abc2-85946f5a3432
          DIM_LO_SAP_LEDGER: e8524c23-d9e0-4d83-86ae-428803327912
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEDGER
          - locationName: TARGET
            nodeName: LOAD_BUDGET_T_BUDGET
          - locationName: TARGET
            nodeName: LOAD_BUDGET_R_SRC
          - locationName: TARGET
            nodeName: LOAD_BUDGET_R_VERSION
          - locationName: TARGET
            nodeName: LOAD_VET_FIN_SAP_AFE_TYPE_ATTR
          - locationName: TARGET
            nodeName: LOAD_VET_FIN_SAP_ACCOUNT_ATTR
          - locationName: TARGET
            nodeName: LOAD_VET_FIN_SAP_CONVERSION
          - locationName: TARGET
            nodeName: DIM_LO_SAP_BUDGET_VERSION
          - locationName: TARGET
            nodeName: DIM_LO_SAP_COST_CENTER
          - locationName: TARGET
            nodeName: DIM_LO_SAP_DEST_ORGANIZATION
          - locationName: TARGET
            nodeName: DIM_LO_SAP_GL_ACCOUNT
          - locationName: TARGET
            nodeName: DIM_LO_SAP_GROSS_NET
          - locationName: TARGET
            nodeName: DIM_LO_SAP_AFE_TYPE
          - locationName: TARGET
            nodeName: DIM_LO_SAP_PRODUCT_TYPE
          - locationName: TARGET
            nodeName: DIM_LO_SAP_LEASE_OPS_HIER
          - locationName: TARGET
            nodeName: DIM_LO_SAP_CC_CORP_HIER_CURRENT
        join:
          joinCondition: |-
            FROM {{ ref('TARGET','LOAD_BUDGET_T_BUDGET') }} LOAD_BUDGET_T_BUDGET
              JOIN {{ ref('TARGET','LOAD_BUDGET_R_SRC') }} LOAD_BUDGET_R_SRC
                ON LOAD_BUDGET_T_BUDGET.FK_R_SRC_IDX = LOAD_BUDGET_R_SRC.IDX
              JOIN {{ ref('TARGET','LOAD_BUDGET_R_VERSION') }} LOAD_BUDGET_R_VERSION
                ON LOAD_BUDGET_T_BUDGET.FK_R_VERSION_IDX = LOAD_BUDGET_R_VERSION.IDX
              LEFT JOIN {{ ref('TARGET','LOAD_VET_FIN_SAP_AFE_TYPE_ATTR') }} LOAD_VET_FIN_SAP_AFE_TYPE_ATTR
                ON LOAD_BUDGET_T_BUDGET.AFE_TYPE = LOAD_VET_FIN_SAP_AFE_TYPE_ATTR.AFE_TYPE
              LEFT JOIN {{ ref('TARGET','LOAD_VET_FIN_SAP_ACCOUNT_ATTR') }} LOAD_VET_FIN_SAP_ACCOUNT_ATTR
                ON LOAD_BUDGET_T_BUDGET.ACCOUNT = LOAD_VET_FIN_SAP_ACCOUNT_ATTR.ACCOUNT
               AND LOAD_BUDGET_T_BUDGET.FUNCTIONAL_AREA = LOAD_VET_FIN_SAP_ACCOUNT_ATTR.FAREA
              LEFT JOIN {{ ref('TARGET','LOAD_VET_FIN_SAP_CONVERSION') }} LOAD_VET_FIN_SAP_CONVERSION
                ON LOAD_BUDGET_T_BUDGET.VOL_UOM_CODE = LOAD_VET_FIN_SAP_CONVERSION.LI_VOL_UOM
               AND LOAD_VET_FIN_SAP_ACCOUNT_ATTR.PROD_CODE = LOAD_VET_FIN_SAP_CONVERSION.LI_PROD_CODE
              JOIN {{ ref('TARGET','DIM_LO_SAP_BUDGET_VERSION') }} DIM_LO_SAP_BUDGET_VERSION
                ON LOAD_BUDGET_T_BUDGET.FK_R_VERSION_IDX = DIM_LO_SAP_BUDGET_VERSION.IDX
               AND DIM_LO_SAP_BUDGET_VERSION.VERSION_TYPE='BUDGET'
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_COST_CENTER') }} DIM_LO_SAP_COST_CENTER
                ON LOAD_BUDGET_T_BUDGET.COST_CENTRE = DIM_LO_SAP_COST_CENTER.CC_NUM
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_DEST_ORGANIZATION') }} DIM_LO_SAP_DEST_ORGANIZATION
                ON LOAD_BUDGET_T_BUDGET.DEST_ORG_ID = DIM_LO_SAP_DEST_ORGANIZATION.org_id
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_GL_ACCOUNT') }} DIM_LO_SAP_GL_ACCOUNT
                ON LOAD_BUDGET_T_BUDGET.ACCOUNT = DIM_LO_SAP_GL_ACCOUNT.ACCOUNT
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_GROSS_NET') }} DIM_LO_SAP_GROSS_NET
                ON LOAD_BUDGET_T_BUDGET.GROSS_OR_NET_CODE = DIM_LO_SAP_GROSS_NET.GROSS_OR_NET_CODE
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_AFE_TYPE') }} DIM_LO_SAP_AFE_TYPE
                ON LOAD_BUDGET_T_BUDGET.AFE_TYPE = DIM_LO_SAP_AFE_TYPE.AFE_TYPE
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_PRODUCT_TYPE') }} DIM_LO_SAP_PRODUCT_TYPE
                ON LOAD_VET_FIN_SAP_ACCOUNT_ATTR.PROD_CODE = DIM_LO_SAP_PRODUCT_TYPE.PROD_CODE
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_LEASE_OPS_HIER') }} DIM_LO_SAP_LEASE_OPS_HIER
                ON COALESCE(LOAD_VET_FIN_SAP_ACCOUNT_ATTR.LINE_NO,LOAD_VET_FIN_SAP_AFE_TYPE_ATTR.LINE_NO) = DIM_LO_SAP_LEASE_OPS_HIER.LINE_NO
              LEFT JOIN {{ ref('TARGET','DIM_LO_SAP_CC_CORP_HIER_CURRENT') }} DIM_LO_SAP_CC_CORP_HIER_CURRENT
                ON DIM_LO_SAP_COST_CENTER.DIM_CC_CORP_HIER_CURRENT_KEY=DIM_LO_SAP_CC_CORP_HIER_CURRENT.DIM_CC_CORP_HIER_CURRENT_KEY
             CROSS JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','DIM_LO_SAP_LEDGER') }}
                     WHERE LEDGER_CODE = '{{ parameters.SAP_LEADING_LEDGER_CODE }}'
                   ) DIM_LO_SAP_LEDGER
        name: STAGE_FIN_SAP_BUDGET
        noLinkRefs: []
  name: STAGE_FIN_SAP_BUDGET
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
