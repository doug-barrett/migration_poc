fileVersion: 1
id: 6ab7d13b-2145-4812-a9ae-585f429799b0
name: S_IN_PATIENT_EVENT_05_PROD
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Stage in-patient events"
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 010aee08-f8d6-4130-9d29-10443ab382fd
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59d3088d-97f2-4c53-9ebc-ae021c7b49e2
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: "'H'+CONVERT(varchar,ds_pims_provider_spells.prvsp_refno)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e92535b2-238f-401f-8594-d1876cb828ce
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'H'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2dfdf0b-c165-46e0-b059-0c76246000a9
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRVSP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59d3088d-97f2-4c53-9ebc-ae021c7b49e2
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 52cb292a-3ca1-499c-90fc-cd85106d9a0b
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Specailty of the first inapteitn professional carer episode
        name: ADMIT_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72c532b7-79a7-49aa-8bc0-c737daef331d
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e024bcc-ac05-44c6-bb11-42533a21fc77
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11ba3682-5d1a-4a53-bfaf-b4b646e6c99f
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92906647-ef9a-4676-8d12-95e6547480f3
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: HOSPITAL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c859f23e-870e-43b1-a6e4-7ff0f4ff7626
                stepCounter: 331048bb-7ff9-400f-b8c4-4ac7cc91d7e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97bbbe2f-c22c-4ef7-b3b7-d4e700cdf27f
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMET_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b9fc1ad-a8cc-4c29-bd6b-b55c9007f7ce
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3be28657-cc81-46bf-a1bc-aa08981a3f70
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: ADMISSION_METHOD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cfd358e5-689e-4542-a972-0aba002b02cf
                stepCounter: 469bfd7a-0084-4352-8ef5-69fd15a77ed4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e36024b-806f-4f57-b5bd-0ee07e1c90be
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: ADMISSION_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d98142f0-f261-4055-ad8c-581c6636e853
                stepCounter: 04c42cb2-f015-4d9e-ae6d-9feed9f13b97
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 99b92a8d-eb61-460b-94b1-4715f7ee00ec
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADSOR_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d682efad-8fd7-4911-beb0-f3a99784edd4
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aff65185-f285-4689-b422-9cf62ef45924
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: READM_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c018533-12b7-4065-b16b-5f92a9fb86f2
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ecb150e-d2b3-4a48-b26a-384593f7e051
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CLEVL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b37f4af8-553e-4dd4-9c1c-b8aa02f27b3d
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a1e28ec-39d0-46fc-a54c-5b24fd7102a0
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a06254d-d86c-4cf5-ab17-b37af0d69b0a
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f12382d-05fe-491a-9ca9-2db935c68383
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DISDE_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3f097725-1edd-4539-b340-14de489b6fa2
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1602003a-5717-40c3-8aef-6de21d626f15
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADCAT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4414ecc-4c91-49ec-a055-6affc8dbde9a
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb710ebe-c874-4ee6-8785-84c7cdbdb37c
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DISMT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a2db989-19c9-48be-ab15-47452de5e290
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1786544-96cd-4f20-b07a-e1f8e3ac14d6
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f7b850f-ce72-4e87-b4f3-6e2838f4dd0a
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 636f33ac-90fa-482b-8642-e09a6cea1183
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: DIM_PATIENT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9962a01b-5f3d-4c1a-b371-997edef38d0f
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d0da02b-2c58-4e0e-92bc-b14b4740aab7
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 985f0ba0-97cf-4152-a49b-7e86cb71409e
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eca38da0-3c2f-4c2e-a38f-e47ececb5b0f
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: DOMICILE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 13e3f44a-7125-438f-b00f-42c54a307c05
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16ce6f58-7c79-4d09-afa7-b2156c1b0a38
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: The date the patient was born
        name: PATIENT_DATE_OF_BIRTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f201416-ac35-4870-a0c1-0836d1b9e5b7
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2356027-3d30-470b-b895-82cc885eeff5
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1125cf7f-7027-45ac-acc8-b3a92505c4da
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: |-
              CASE WHEN ds_pims_provider_spells.admit_dttm IS NULL OR ds_pims_provider_spells.admit_dttm <= '1990-01-01' OR ds_pims_provider_spells.admit_dttm > GETDATE() THEN IFNULL(ds_pims_provider_spells.disch_dttm,CONVERT(date,GETDATE()))
                          ELSE ds_pims_provider_spells.admit_dttm
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 84543389-af77-4572-aec0-2c06c8a19f96
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMIT_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1125cf7f-7027-45ac-acc8-b3a92505c4da
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b546598f-db3d-45f7-bfcd-4f7debf77c94
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCH_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee3a67e8-1a53-44ab-aa64-cafc588de09c
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: |-
              CASE WHEN ds_pims_provider_spells.disch_dttm IS NULL OR ds_pims_provider_spells.disch_dttm <= '1990-01-01' OR ds_pims_provider_spells.disch_dttm > GETDATE() OR ds_pims_provider_spells.disch_dttm < ds_pims_provider_spells.admit_dttm THEN NULL
                          ELSE ds_pims_provider_spells.disch_dttm
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e377684f-9c0a-4143-9ba5-9cbccc5004e4
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCH_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee3a67e8-1a53-44ab-aa64-cafc588de09c
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16104d15-a7f0-42bb-9736-9d26e200c312
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFRL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 80e5eecf-b3fb-4fc8-b661-b39389f47738
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7b6ca6f-3ccd-405d-9b0b-8c44259228b7
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 80e5eecf-b3fb-4fc8-b661-b39389f47738
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: "'R' + CONVERT(varchar, ds_pims_provider_spells.refrl_refno)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02a3221c-2f3b-4290-bee5-94c1d46759f7
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: AEATT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3d60c752-dcc2-482d-b5d3-e8c11f77a74f
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d49342a-74fd-421d-9d06-fa0a0ce988f9
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ATTENDANCE_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3d60c752-dcc2-482d-b5d3-e8c11f77a74f
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: "'A' + CONVERT(varchar, ds_pims_provider_spells.aeatt_refno)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d0430e51-e856-4cce-afd0-563c44fa08e4
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: FIRST_REGULAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b9caf7d-206b-4215-923e-0a8fcf1d38fd
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 343b8b2c-ec80-4363-be02-1054b8299156
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: INMGT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76ce2d66-f620-4545-bd3f-71d1e5604f03
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20e5bdf6-d290-474f-bd28-894fe5cddbe6
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: EVENT_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bef5ae2c-aedb-4e25-babf-3fd1e9a8e6c9
                stepCounter: 3fdf4180-c40e-4f94-9cbb-852501d299b3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27c413f7-c959-41d2-b73c-3f1e7aab007f
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: EXPDS_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2a5a335e-f714-4f3e-a830-98ebf37f63e8
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c213c7a1-ece5-4fb0-8a80-07cf3ddd7f3c
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: DISABLED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19b4dc46-790d-4855-996e-74e704416106
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1f18867-8836-4701-9919-32d64b57b19c
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: CONFIDENTIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a6604579-0800-40b1-867d-e59c721e91d4
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b285519-7e8b-4055-b663-a116d9bbbe80
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: IDENTIFIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e7ce674-a689-4f6e-b177-025b020aa1ad
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e06df293-3aff-4b51-b3f5-471ebe0897b8
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WLIST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d1ddefc-a73c-4486-a6a2-280c2804408d
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 016562d5-e02d-493e-92e9-2f4336dde197
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: GASTROSCOPY_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 797dd318-f7d0-4dc0-a784-36dc88734183
                stepCounter: c7e465fb-5e39-471a-83ed-fa1d84af350b
            transform: IFNULL(s_gastroscopy_v.gastroscopy_flag,'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cca95669-2a34-47ae-b11a-88e6b8a761fb
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: COLONOSCOPY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78065313-cc33-4775-9b31-d66d35fa8c27
                stepCounter: 331bfe2b-b23c-40b7-ba48-ba184da8e020
            transform: IFNULL(s_colonoscopy_v.colonoscopy_flag,'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b86ee4e-1933-4bf4-b6e3-90300ff637b5
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: CYSTOSCOPY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 235cd63d-7888-4d8a-a65b-439b198e54c4
                stepCounter: 795446e9-9fb5-4494-a424-4697208d1f42
            transform: IFNULL(s_cystoscopy_v.cystoscopy_Flag,'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 225a27d7-99ca-4462-8f48-a6c9f39576a4
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: flags a list of theatre of procedures to indicate a uncoded skin lesion
        name: SKIN_LESION_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 234a0d7d-99ab-4ca7-b239-337e0e8114ff
                stepCounter: 752c13c7-edb1-4554-a80c-cdd62045c9b0
            transform: IFNULL(s_skin_lesion_v.skin_lesion_flag,'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f30ca7f9-d2d1-4b89-9a34-330f5bcc0f18
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: flags a list of theatre of procedures to indicate a colposcopy
        name: COLPOSCOPY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa086d05-7933-4e82-b0ea-0c288d45f38d
                stepCounter: 7dfea076-f05b-48db-b9eb-20749ed7eb56
            transform: IFNULL(s_colposcopy_v.colposcopy_Flag,'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31ad615a-5884-4658-b618-b6bdc1578909
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: flags a list of theatre of procedures to indicate a bronchoscopy
        name: BRONCHOSCOPY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7cb8a2cc-f9d4-4471-9128-24c2641ddedb
                stepCounter: 2696bece-78b1-4c6b-a213-e9c34d475a94
            transform: IFNULL(s_bronchoscopy_v.bronchoscopy_flag,'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 83f475d3-c79b-4a7a-a992-49d67dfdb6a2
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: flags a list of theatre of procedures to indicate a hysteroscopy
        name: HYSTEROSCOPY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f6ec790-b4fd-4995-a3b8-6d96820acd8b
                stepCounter: fb7dc215-cf5b-4db3-a85b-fe0d513dc822
            transform: IFNULL(s_hysteroscopy_v.hysteroscopy_flag,'N')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 540abb37-652e-41a8-86a6-a70cee8448da
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: FAST_TRACK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 474c4ea1-defd-43a9-bbcc-24c1a12f7605
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6523491f-2a9d-4395-b428-734d573cf93d
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: AGEBD_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ba2821a-4594-442f-9a59-e7629eb68743
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 364c5b69-7671-4db0-b998-8b2f4550d21d
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: NO_FUNDS_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: adaf7607-d34e-4c33-a149-678ed4d276ce
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ae5c032-1fcd-4dd2-9fa6-2e0d478991e2
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: PRVSN_START_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23a37a08-2f83-4370-9738-9133ff8e3c00
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d12f3f25-1469-4c7b-a687-d51d69b12c5b
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: PRVSN_END_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75adebc2-28b6-4c2e-81fe-a7029f349f41
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ae9b7b5-aa5f-4dc3-9c86-eba8c95a59d0
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CNTCT_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3dfd02a9-1ba2-4aa2-808e-04d07280dc1b
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8948e17-871b-42ba-9b08-540662983bc1
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MED_DISCH_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: adf2c303-3c4f-4246-a72c-d79692864825
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: |-
              CASE WHEN ds_pims_provider_spells.med_disch_dttm IS NULL OR ds_pims_provider_spells.med_disch_dttm <= '1990-01-01' OR ds_pims_provider_spells.med_disch_dttm > GETDATE() THEN ds_pims_provider_spells.disch_dttm
                          ELSE ds_pims_provider_spells.med_disch_dttm
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 500d7c22-2948-4888-a21c-3136b4845a6d
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MED_DISCH_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: adf2c303-3c4f-4246-a72c-d79692864825
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f82e0e1-8641-4f28-b87d-9441ba955573
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PMETD_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3644fefd-e190-4734-9fa9-5752d0cf61e4
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b2294845-a529-46e8-91b5-7ca2de506d35
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DSINF_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67295302-afd0-45b8-bd94-f3c17581dfa1
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a196ebf-0c6d-4912-978a-f590c08754b4
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: IDPAP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 610a8953-82f0-459f-be85-6fb303187454
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 62a49294-d0b9-4c26-a243-49c151820362
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: CONSENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 300e2654-6b58-4cf5-879e-85f966675fb4
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bfd25e0f-74e3-43c4-b863-171adf838859
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: GP_ADVISE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 620ed001-b626-4a15-8bc6-0946baba77e0
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ad92150-cacf-4e96-9bf1-88719051d2d2
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: IRADM_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 14ab4fe6-1fce-4b98-8199-a0a695c00493
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6fc77448-2ccd-4507-9654-29d4a6f4a2d0
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: MECH_VENT_HRS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1c99fd5-9431-4507-9aed-ed743ea80145
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fbb8c88d-f68e-49d1-b5fc-c49c708ec623
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: AMBULANCE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd844a44-4711-40f4-b299-8db19bad94f6
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82b2dd5a-1f52-49c2-8833-687facfb187c
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRIOR_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e87c7168-bf9d-43a0-aafd-bc2b4959d2dc
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 617f744e-965f-4211-b9ed-bf586015ace7
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: RELATED_ADMISSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 442b4b35-07d7-4d71-838f-176e081c31fa
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bcd5443a-ac7e-4b3c-8477-3dcd57e49632
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: READM_REHAB_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b45c7aa4-a942-4d04-80f4-f2a6d595fa4f
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 865f8239-5dee-46ff-846f-fca31a766b98
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SRTPC_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0d4d50fc-13d3-469c-9630-b41641ee3a7d
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b9f0f68-b419-4e1a-8e16-2171a3e944b0
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACAST_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64690faa-b9d5-4e60-9be7-eafc067d95aa
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1831bbe1-9732-4d85-bb58-936967811f11
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ACC_EXPIRY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 550e0fe6-5e63-4326-9718-c13735c22824
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba8c999b-6f31-4062-93a1-116d65e25a73
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REHAB_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a9233bee-8c08-4b7c-924e-7fff577e1ec1
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16c969eb-a7c8-4fb9-a3bb-ccd575ab1533
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CODING_ADMIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1fe7ef84-1dca-487e-affa-fe3c1e92e15a
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0814b9ce-de8d-4f36-925d-f0b099e532e7
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CODING_DISCH_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f6e8c6a-b20c-4b30-9522-15c66332156b
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8103d97f-41e7-4fdf-858c-ddb9554e6065
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: DRG_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a888a138-9840-4736-912c-e9bbecc170b1
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea971a89-5d2a-4091-8ea1-d8d330314c7e
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: NMDS_EVENT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dbd0c0df-350d-40ec-9506-fb0f852f6485
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 861774ea-f758-4e5b-9297-13cf163521c7
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: CODED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a888a138-9840-4736-912c-e9bbecc170b1
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: |-
              CASE WHEN ds_plato_event_details.drg IS NULL THEN 'N'
                          ELSE 'Y'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8bd1b24-256d-4aa5-a29f-dd2a228997cb
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: WLIST_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f993f650-d845-4c5d-be64-636ff53122f0
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16f0a718-e474-4e91-aaab-85b15203f117
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: WAITLIST_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f993f650-d845-4c5d-be64-636ff53122f0
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: "'W' + CONVERT(varchar, ds_pims_prof_carer_episodes.wlist_refno)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d45787df-42d3-4aa9-8b21-a377d8dcd892
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: Carer Episode Outcome
        name: CEOCM_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 37c6568a-2041-4be3-acb2-4c317fab46eb
                stepCounter: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 854d09cd-cf33-444c-85a6-ce9417653b7c
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: MDC_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bbfff9b7-6cdd-477d-aa95-451e49e98293
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 596c670c-91cf-4eea-b4c7-227522a05580
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DISCHARGE_HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 567bbd76-4341-4956-be24-c4e752cc1ea9
                stepCounter: 19f323a9-95a3-4efc-bdc1-7adc75cffc2a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a0c5e3b-36c9-4d80-932e-85a284b1b578
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Specialty of the last inpatient stay episode. Dsicharge Specialty
        name: SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f291f8f0-6f03-4c0e-8405-f495eec5081d
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: NUMERIC(19,5)
        defaultValue: ""
        description: ""
        name: WIES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b45e174c-eb7a-42b6-99e1-0f5aab799629
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5a74144-f6f3-426f-96b6-61bcb561cf30
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d251445f-9071-45c8-9852-33801fbc8496
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16602277-c10b-423d-b33b-c6aedc6783e4
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: EXCLUDED_PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 153c73dc-f731-43e8-9540-7e2a583b3d4d
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 262d800d-67ec-4d3c-b1fb-ccfdbde8f548
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_VISIT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f7b850f-ce72-4e87-b4f3-6e2838f4dd0a
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ROW_NUMBER() OVER (PARTITION BY ds_pims_provider_spells.patnt_refno ORDER BY ds_pims_provider_spells.admit_dttm)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22db5607-2faa-4d36-a1ba-a51b3c0ce5e6
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_VISIT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f7b850f-ce72-4e87-b4f3-6e2838f4dd0a
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: COUNT(1) OVER (PARTITION BY ds_pims_provider_spells.patnt_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f029e44d-4c06-4e93-b520-d6fe4ae2a406
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_STAYS_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '1'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 83b4f2e9-fcf8-4dcd-a3ed-bcece7e4d35f
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9fa58c0b-e217-4364-ae63-76c06b664a12
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c87630b6-e469-4834-bde6-b5fcdc32e02f
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d46d5d71-f9ed-4a34-b036-a6357ea34022
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01a40870-cf41-4e14-a650-65a58aecf702
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIFY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddce7ea8-e372-4d24-b23d-c90c5bdfaf39
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f570778c-9709-4670-8ccc-d083cb1c4c77
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MODIFY_USER_LOGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: affa354a-ceac-43e3-85b3-7511cf413cd9
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa49f1b8-99bb-46b9-996a-6ee67e5f3d13
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CODEDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de6a7f94-2e9f-4ef2-97eb-88a7041af0da
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03c02905-c040-4145-92a4-2edd2807084b
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 825a0fbe-d2ca-442e-8e51-3d2c9ff9b8da
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ce55c29-142a-4ef1-abfc-1974ebfa07c7
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CCL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3267cd08-5fed-4f36-9f84-b284df240080
                stepCounter: e36e158e-c610-4da5-92bc-412a178a9d7a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab27cfd3-33c9-4974-bbd5-5a634212fcbf
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DSS_DATA_QUALITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1969525b-c9dd-457f-ba6a-8c5e4a35a286
          stepCounter: 6ab7d13b-2145-4812-a9ae-585f429799b0
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DS_PIMS_PROF_CARER_EPISODES: cb8cd7bc-c5c1-4ee3-a1f5-2c0bda3624d5
          S_SPECIALTY_1: 19f323a9-95a3-4efc-bdc1-7adc75cffc2a
          S_CODING_GASTROSCOPY: 410f9d85-792c-4ca0-9c5b-9ea66fb59b49
          S_CODING_COLONOSCOPY: 1aee033f-c00a-48bf-be9a-bac8f07a3919
          S_CODING_CYSTOSCOPY: b418eb12-5181-4bb0-89df-93d3167c54b8
          S_CODING_SKIN_LESION: 9daf2e5e-224a-44d0-98b0-bd333856b1a8
          S_CODING_BRONCHOSCOPY: f495c0b8-cdce-4c81-81be-cea84ce66023
          S_CODING_HYSTEROSCOPY: 7174228d-efb8-4e30-a4d2-70eecba6f336
          S_CODING_COLPOSCOPY: eacf3215-b9e6-4d38-bd1b-5a34d6e02a33
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_PIMS_PROVIDER_SPELLS
          - locationName: TGT
            nodeName: DS_PIMS_PROF_CARER_EPISODES
          - locationName: TGT
            nodeName: S_SPECIALTY_1
          - locationName: TGT
            nodeName: S_CODING_GASTROSCOPY
          - locationName: TGT
            nodeName: S_CODING_COLONOSCOPY
          - locationName: TGT
            nodeName: S_CODING_CYSTOSCOPY
          - locationName: TGT
            nodeName: S_CODING_SKIN_LESION
          - locationName: TGT
            nodeName: S_CODING_BRONCHOSCOPY
          - locationName: TGT
            nodeName: S_CODING_HYSTEROSCOPY
          - locationName: TGT
            nodeName: S_CODING_COLPOSCOPY
        join:
          joinCondition: |-
            FROM ds_pims_provider_spells
              LEFT OUTER JOIN ds_plato_event_details
                ON 'H'+CONVERT(varchar(10),ds_pims_provider_spells.prvsp_refno) = ds_plato_event_details.pimsencounter
              LEFT OUTER JOIN {{ ref('TGT','DS_PIMS_PROF_CARER_EPISODES') }}
                ON ds_pims_provider_spells.prvsp_refno = ds_pims_prof_carer_episodes.prvsp_refno
               AND ds_pims_prof_carer_episodes.start_dttm = ds_pims_provider_spells.admit_dttm
               AND ds_pims_prof_carer_episodes.archv_flag= 'N'
              LEFT OUTER JOIN {{ ref('TGT','DS_PIMS_PROF_CARER_EPISODES') }} ds_pims_prof_carer_episodes_dx
                ON ds_pims_provider_spells.prvsp_refno = ds_pims_prof_carer_episodes_dx.prvsp_refno
               AND ds_pims_prof_carer_episodes_dx.end_dttm = ds_pims_provider_spells.disch_dttm
               AND ds_pims_prof_carer_episodes_dx.archv_flag= 'N'
              LEFT JOIN {{ ref('TGT','S_SPECIALTY_1') }}
                ON ds_pims_prof_carer_episodes_dx.spect_refno = s_specialty_1.specialty_reference_no
              LEFT OUTER JOIN {{ ref('TGT','S_CODING_GASTROSCOPY') }}[s_gastroscopy_v]
                ON ds_pims_provider_spells.prvsp_refno = s_gastroscopy_v.prvsp_refno
              LEFT OUTER JOIN {{ ref('TGT','S_CODING_COLONOSCOPY') }} [s_colonoscopy_v]
                ON ds_pims_provider_spells.prvsp_refno = s_colonoscopy_v.prvsp_refno
              LEFT OUTER JOIN {{ ref('TGT','S_CODING_CYSTOSCOPY') }} [s_cystoscopy_v]
                ON ds_pims_provider_spells.prvsp_refno = s_cystoscopy_v.prvsp_refno
              LEFT OUTER JOIN {{ ref('TGT','S_CODING_SKIN_LESION') }} [s_skin_lesion_v]
                ON ds_pims_provider_spells.prvsp_refno = s_skin_lesion_v.prvsp_refno
              LEFT OUTER JOIN {{ ref('TGT','S_CODING_BRONCHOSCOPY') }} [s_bronchoscopy_v]
                ON ds_pims_provider_spells.prvsp_refno = s_bronchoscopy_v.prvsp_refno
              LEFT OUTER JOIN {{ ref('TGT','S_CODING_HYSTEROSCOPY') }} [s_hysteroscopy_v]
                ON ds_pims_provider_spells.prvsp_refno = s_hysteroscopy_v.prvsp_refno
              LEFT OUTER JOIN {{ ref('TGT','S_CODING_COLPOSCOPY') }} [s_colposcopy_v]
                ON ds_pims_provider_spells.prvsp_refno = s_colposcopy_v.prvsp_refno
              LEFT OUTER JOIN dim.dim_patient
                ON ds_pims_provider_spells.patnt_refno = dim_patient.patient_reference_no
              LEFT OUTER JOIN dim.dim_service_point
                ON dim_service_point.service_point_reference_no = ds_pims_provider_spells.spont_refno
               AND dim_service_point.dss_current_flag = 'Y'
              LEFT OUTER JOIN dim.dim_event_type
                ON ds_pims_provider_spells.inmgt_refno = dim_event_type.intended_management_type_reference_no
              LEFT OUTER JOIN dim.dim_admission_method
                ON ds_pims_provider_spells.admet_refno = dim_admission_method.admission_method_reference_no
               AND dim_admission_method.dss_current_flag = 'Y'
              LEFT OUTER JOIN dim.dim_admission_type
                ON ds_pims_provider_spells.admet_refno = dim_admission_type.admission_method_reference_no
               AND dim_admission_method.dss_current_flag = 'Y'
             WHERE ds_pims_provider_spells.prvsn_start_flag = 'N'
        name: S_IN_PATIENT_EVENT_05_PROD
        noLinkRefs: []
  name: S_IN_PATIENT_EVENT_05_PROD
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
