fileVersion: 1
id: c326c63b-ec81-48ea-b6f7-40f02cd33f15
name: S_EVITALS_WARD_V
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20140df4-545e-484e-b6e0-0b33fa82ee42
          stepCounter: c326c63b-ec81-48ea-b6f7-40f02cd33f15
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PARNT_PK
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 35e9376a-22fb-4856-b3bf-7cca10d8b295
                stepCounter: 4c2abae1-25a2-436e-90c4-262ecc253c18
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b8b3b41-fcd8-4858-b1d9-8a5d43597a2e
          stepCounter: c326c63b-ec81-48ea-b6f7-40f02cd33f15
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: WARD_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: feeae5fe-b3af-4f8b-827f-52352f32ef24
                stepCounter: 4c2abae1-25a2-436e-90c4-262ecc253c18
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66cf5b9a-d967-47e8-bf7f-baaa215020b3
          stepCounter: c326c63b-ec81-48ea-b6f7-40f02cd33f15
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: WARD_CODE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 593187ae-2175-4837-8282-965fdb59655b
                stepCounter: 4c2abae1-25a2-436e-90c4-262ecc253c18
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a34f55f-8b03-49d8-8234-050897ef04c6
          stepCounter: c326c63b-ec81-48ea-b6f7-40f02cd33f15
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: WARD
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ff74b944-f95e-4358-a18c-7aa06a6e9ab8
                stepCounter: 4c2abae1-25a2-436e-90c4-262ecc253c18
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 417f4f48-250a-411e-99cb-6cee981a9a59
          stepCounter: c326c63b-ec81-48ea-b6f7-40f02cd33f15
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: HOSPITAL_CODE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 593187ae-2175-4837-8282-965fdb59655b
                stepCounter: 4c2abae1-25a2-436e-90c4-262ecc253c18
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a78c87e7-895d-4f8d-bdee-f9d79cdd0e28
          stepCounter: c326c63b-ec81-48ea-b6f7-40f02cd33f15
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: HOSPITAL_DESCRIPTION
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ff74b944-f95e-4358-a18c-7aa06a6e9ab8
                stepCounter: 4c2abae1-25a2-436e-90c4-262ecc253c18
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            SELECT it.parnt_pk -- ,it.HITEM_PK  Ward_id
            ,
                   it.rfval_pk Ward_id ,
                   it.item_code ward_code ,
                   it.item_description ward ,
                   par.item_code Hospital_code ,
                   par.item_description Hospital
              FROM l_Patientrack_HIERARCHY_ITEM it
             INNER JOIN l_Patientrack_HIERARCHY_ITEM par
                ON it.PARNT_PK =par.HITEM_PK
             WHERE it.deleted_flag = 0
               AND par.item_code NOT IN('PTRCK','MIGRATION')
        dependencies:
          - locationName: TGT
            nodeName: L_PATIENTRACK_HIERARCHY_ITEM
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TGT','L_PATIENTRACK_HIERARCHY_ITEM') }}
        name: S_EVITALS_WARD_V
        noLinkRefs: []
  name: S_EVITALS_WARD_V
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
