fileVersion: 1
id: 4f02523c-75d6-4223-9e76-75c379bfc667
name: S_PJ_JOURNEY_50
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Calculate the journey columns sourced from Allied Health."
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6ed0fb2-c783-4258-bdf2-e4a0fcc18280
          stepCounter: 4f02523c-75d6-4223-9e76-75c379bfc667
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Unique ID for a patient journey
        name: JOURNEY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 34d9d6c7-6ef8-43ba-9602-cafe251fe8a9
                stepCounter: 06488a2b-70c1-4dfe-ba3d-7e29c99d4d3f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94e6e332-39c6-443d-850e-2dad9b7bd78e
          stepCounter: 4f02523c-75d6-4223-9e76-75c379bfc667
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09411880-941d-48e9-b6ef-3b58b77ecf5c
                stepCounter: 06488a2b-70c1-4dfe-ba3d-7e29c99d4d3f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 85b438fc-720d-479e-8b9b-c0ca4aad8449
          stepCounter: 4f02523c-75d6-4223-9e76-75c379bfc667
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Journey number for the patient.
        name: JOURNEY_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a580def2-1d66-481f-b801-0e3d194c70f0
                stepCounter: 06488a2b-70c1-4dfe-ba3d-7e29c99d4d3f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07451ca3-59d7-451e-853d-4d20bcf9f7d8
          stepCounter: 4f02523c-75d6-4223-9e76-75c379bfc667
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: PT_ACTIVITY_START
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4433ea8b-bd2d-4e27-91e2-cea27a74c8ab
                stepCounter: 06488a2b-70c1-4dfe-ba3d-7e29c99d4d3f
            transform: MAX(CASE WHEN row_num = 1 AND discipline_code = 'PHY' THEN shift_date ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea6e0328-72ea-4ecb-893a-96d7474474e9
          stepCounter: 4f02523c-75d6-4223-9e76-75c379bfc667
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: OT_ACTIVITY_START
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4433ea8b-bd2d-4e27-91e2-cea27a74c8ab
                stepCounter: 06488a2b-70c1-4dfe-ba3d-7e29c99d4d3f
            transform: MAX(CASE WHEN row_num = 1 AND discipline_code = 'OCC' THEN shift_date ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad201126-e7f8-4f60-be78-5bbb59982dc5
          stepCounter: 4f02523c-75d6-4223-9e76-75c379bfc667
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: SLT_ACTIVITY_START
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4433ea8b-bd2d-4e27-91e2-cea27a74c8ab
                stepCounter: 06488a2b-70c1-4dfe-ba3d-7e29c99d4d3f
            transform: MAX(CASE WHEN row_num = 1 AND discipline_code = 'SPC' THEN shift_date ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ba86011-a3b6-44a8-baf2-b6b44b97ff08
          stepCounter: 4f02523c-75d6-4223-9e76-75c379bfc667
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: DT_ACTIVITY_START
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4433ea8b-bd2d-4e27-91e2-cea27a74c8ab
                stepCounter: 06488a2b-70c1-4dfe-ba3d-7e29c99d4d3f
            transform: MAX(CASE WHEN row_num = 1 AND discipline_code = 'DTN' THEN shift_date ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db398de9-58eb-4e78-844a-9ad5ad92c09b
          stepCounter: 4f02523c-75d6-4223-9e76-75c379bfc667
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: SW_ACTIVITY_START
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4433ea8b-bd2d-4e27-91e2-cea27a74c8ab
                stepCounter: 06488a2b-70c1-4dfe-ba3d-7e29c99d4d3f
            transform: MAX(CASE WHEN row_num = 1 AND discipline_code = 'SOC' THEN shift_date ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5091f5f-4cbc-4f0a-a7e7-7f066a2e16a4
          stepCounter: 4f02523c-75d6-4223-9e76-75c379bfc667
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: ""
        name: PT_ACTIVITY_MINS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bb35722b-ea5a-4457-9802-45fd997df0f3
                stepCounter: 06488a2b-70c1-4dfe-ba3d-7e29c99d4d3f
            transform: SUM(CASE WHEN discipline_code = 'PHY' THEN actual_activity_mins ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a46e0636-ac1b-4f4e-8ede-c56a26029f33
          stepCounter: 4f02523c-75d6-4223-9e76-75c379bfc667
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: ""
        name: OT_ACTIVITY_MINS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bb35722b-ea5a-4457-9802-45fd997df0f3
                stepCounter: 06488a2b-70c1-4dfe-ba3d-7e29c99d4d3f
            transform: SUM(CASE WHEN discipline_code = 'OCC' THEN actual_activity_mins ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 503ea600-c664-4348-b595-91faa2576d40
          stepCounter: 4f02523c-75d6-4223-9e76-75c379bfc667
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: ""
        name: SLT_ACTIVITY_MINS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bb35722b-ea5a-4457-9802-45fd997df0f3
                stepCounter: 06488a2b-70c1-4dfe-ba3d-7e29c99d4d3f
            transform: SUM(CASE WHEN discipline_code = 'SPC' THEN actual_activity_mins ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bc3057ce-7fae-4395-be8e-c4b873f4eefc
          stepCounter: 4f02523c-75d6-4223-9e76-75c379bfc667
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: ""
        name: DT_ACTIVITY_MINS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bb35722b-ea5a-4457-9802-45fd997df0f3
                stepCounter: 06488a2b-70c1-4dfe-ba3d-7e29c99d4d3f
            transform: SUM(CASE WHEN discipline_code = 'DTN' THEN actual_activity_mins ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0e6c42c-c42d-4694-b554-baa46646d25c
          stepCounter: 4f02523c-75d6-4223-9e76-75c379bfc667
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: ""
        name: SW_ACTIVITY_MINS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bb35722b-ea5a-4457-9802-45fd997df0f3
                stepCounter: 06488a2b-70c1-4dfe-ba3d-7e29c99d4d3f
            transform: SUM(CASE WHEN discipline_code = 'SOC' THEN actual_activity_mins ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53bca311-27a9-41f6-9a19-d8361d22cc3e
          stepCounter: 4f02523c-75d6-4223-9e76-75c379bfc667
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PT_ACTIVITY_FIRST_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eebf9964-be73-4d4c-a8e4-61daf85c7dec
                stepCounter: 06488a2b-70c1-4dfe-ba3d-7e29c99d4d3f
            transform: MAX(CASE WHEN row_num = 1 AND discipline_code = 'PHY' THEN allied_health_id ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bc0dc699-a3b7-46e2-ace9-901a0ae498fd
          stepCounter: 4f02523c-75d6-4223-9e76-75c379bfc667
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: OT_ACTIVITY_FIRST_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eebf9964-be73-4d4c-a8e4-61daf85c7dec
                stepCounter: 06488a2b-70c1-4dfe-ba3d-7e29c99d4d3f
            transform: MAX(CASE WHEN row_num = 1 AND discipline_code = 'OCC' THEN allied_health_id ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 83826582-0cd0-4335-b978-89dfc12c8d6f
          stepCounter: 4f02523c-75d6-4223-9e76-75c379bfc667
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SLT_ACTIVITY_FIRST_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eebf9964-be73-4d4c-a8e4-61daf85c7dec
                stepCounter: 06488a2b-70c1-4dfe-ba3d-7e29c99d4d3f
            transform: MAX(CASE WHEN row_num = 1 AND discipline_code = 'SPC' THEN allied_health_id ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59e1f23f-68e0-4dc5-9b06-a217ee700bd3
          stepCounter: 4f02523c-75d6-4223-9e76-75c379bfc667
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DT_ACTIVITY_FIRST_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eebf9964-be73-4d4c-a8e4-61daf85c7dec
                stepCounter: 06488a2b-70c1-4dfe-ba3d-7e29c99d4d3f
            transform: MAX(CASE WHEN row_num = 1 AND discipline_code = 'DTN' THEN allied_health_id ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be70caba-33ab-4476-9c54-cc744ccaa8de
          stepCounter: 4f02523c-75d6-4223-9e76-75c379bfc667
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SW_ACTIVITY_FIRST_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eebf9964-be73-4d4c-a8e4-61daf85c7dec
                stepCounter: 06488a2b-70c1-4dfe-ba3d-7e29c99d4d3f
            transform: MAX(CASE WHEN row_num = 1 AND discipline_code = 'SOC' THEN allied_health_id ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b854531-1e5e-4e3b-9673-b58f61d8fc8b
          stepCounter: 4f02523c-75d6-4223-9e76-75c379bfc667
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_PJ_ALLIED_HEALTH
        join:
          joinCondition: |-
            FROM s_PJ_allied_health
             GROUP BY journey_id,
                      patient_nhi,
                      journey_num
        name: S_PJ_JOURNEY_50
        noLinkRefs: []
  name: S_PJ_JOURNEY_50
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
