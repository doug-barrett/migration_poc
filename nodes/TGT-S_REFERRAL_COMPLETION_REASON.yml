fileVersion: 1
id: adfaec73-e63b-4fe1-9384-d1aaef7b9fde
name: S_REFERRAL_COMPLETION_REASON
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Referral Completion Reasons"
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 779dd23e-c24c-4b4e-b8b8-2131f92df6c6
          stepCounter: adfaec73-e63b-4fe1-9384-d1aaef7b9fde
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: referral_completion_reason_reference_no
        name: REFERRAL_COMPLETION_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 97aebd53-8994-45f0-9fea-1b3150a90054
                stepCounter: 06fa4241-360c-43d0-8e4a-8b860f92fc09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79f47cc5-ea4c-4b77-a0f3-af5a4159aa21
          stepCounter: adfaec73-e63b-4fe1-9384-d1aaef7b9fde
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: REFERRAL_COMPLETION_REASON_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fbb01e3b-4612-47c8-9a4a-5d6abddc60ef
                stepCounter: 06fa4241-360c-43d0-8e4a-8b860f92fc09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74ebd5ba-6d09-43e3-862b-118ee4ba246c
          stepCounter: adfaec73-e63b-4fe1-9384-d1aaef7b9fde
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: REFERRAL_COMPLETION_REASON_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 551f483d-a948-4558-87f8-d3e65fffac3c
                stepCounter: 06fa4241-360c-43d0-8e4a-8b860f92fc09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b9f17ae-9f0c-4e93-8732-73c7d5021775
          stepCounter: adfaec73-e63b-4fe1-9384-d1aaef7b9fde
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: referral_completion_reason_validity_start_date
        name: REFERRAL_COMPLETION_REASON_VALIDITY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d93e8a96-b2c6-4ecb-bd0a-f2f089d15d02
                stepCounter: 06fa4241-360c-43d0-8e4a-8b860f92fc09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 93d2ad74-4b5b-4ad4-9351-ed8e26fdd6f7
          stepCounter: adfaec73-e63b-4fe1-9384-d1aaef7b9fde
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: referral_completion_reason_validity_end_date
        name: REFERRAL_COMPLETION_REASON_VALIDITY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b83a3aaf-eb08-4e0f-b5c8-1be21d38ef47
                stepCounter: 06fa4241-360c-43d0-8e4a-8b860f92fc09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2605f0de-a584-4512-8189-b90fbf937205
          stepCounter: adfaec73-e63b-4fe1-9384-d1aaef7b9fde
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: referral_completion_reason_reference_code
        name: REFERRAL_COMPLETION_REASON_REFERENCE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc52b689-cd00-4eb4-ae6e-f2b338d8975a
                stepCounter: 06fa4241-360c-43d0-8e4a-8b860f92fc09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98b3796a-27c3-4874-9567-eca58400ebe9
          stepCounter: adfaec73-e63b-4fe1-9384-d1aaef7b9fde
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: PRIMHD_REFERRAL_TO_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db04ec54-9f0a-4aef-83c4-1a3ac4beec96
                stepCounter: 0c04f9e6-ed01-4c9d-8390-84528ffd65ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5f4d502-9e14-4e0c-87e1-093540a616da
          stepCounter: adfaec73-e63b-4fe1-9384-d1aaef7b9fde
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: PRIMHD_REFERRAL_TO_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1223ad4d-8b4f-49d4-bc1a-7527a240d88f
                stepCounter: 0c04f9e6-ed01-4c9d-8390-84528ffd65ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d034030-11c3-4c7a-bf2b-bbaea93ae105
          stepCounter: adfaec73-e63b-4fe1-9384-d1aaef7b9fde
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: PRIMHD_REFERRAL_END_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d4da7d78-b479-4e2e-9b8b-9a6f48f9ec9e
                stepCounter: 0c04f9e6-ed01-4c9d-8390-84528ffd65ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 35cf2f2d-e526-470d-971e-988be286f92b
          stepCounter: adfaec73-e63b-4fe1-9384-d1aaef7b9fde
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: PRIMHD_REFERRAL_END_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: faa0b3dc-5e86-4e6f-822d-1d867a2a13b7
                stepCounter: 0c04f9e6-ed01-4c9d-8390-84528ffd65ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a4878ba-a396-4a78-8f08-15ce98266164
          stepCounter: adfaec73-e63b-4fe1-9384-d1aaef7b9fde
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: This close reason will constitute an NPF closure reason if there is no activity
        name: NPF_TRANSFER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 89d58c38-5498-4c38-8e30-a5297a165174
                stepCounter: 0c04f9e6-ed01-4c9d-8390-84528ffd65ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59736176-7641-43b0-b907-c13559fd0b88
          stepCounter: adfaec73-e63b-4fe1-9384-d1aaef7b9fde
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: TRANSFER_TO_ORGANISATION_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 04b314a1-e3c7-4bbc-9cf9-71a935e6a839
                stepCounter: 0c04f9e6-ed01-4c9d-8390-84528ffd65ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be760061-959d-4db5-a2fb-ffd2ac913ef2
          stepCounter: adfaec73-e63b-4fe1-9384-d1aaef7b9fde
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: EXCEPTION_OUTCOME_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cf8c9473-9069-4937-a003-c532ddf9f610
                stepCounter: 0c04f9e6-ed01-4c9d-8390-84528ffd65ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6effeb57-d565-45ff-8532-975e587f3f1b
          stepCounter: adfaec73-e63b-4fe1-9384-d1aaef7b9fde
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: EXCEPTION_OUTCOME_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c3c9f74f-6002-41fc-956c-0c239409f120
                stepCounter: 868516a7-a8ad-4623-b272-3600113b2439
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ee2b1ae-1224-4324-8da4-7b5135745b00
          stepCounter: adfaec73-e63b-4fe1-9384-d1aaef7b9fde
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: EXCEPTION_OUTCOME_REASON_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a7c463fb-367e-45ab-bdf0-8acc40db49d6
                stepCounter: 0c04f9e6-ed01-4c9d-8390-84528ffd65ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b798151e-b33a-435c-a120-808b788d8f6c
          stepCounter: adfaec73-e63b-4fe1-9384-d1aaef7b9fde
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: EXCEPTION_OUTCOME_REASON_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ce08959-0ed9-4de4-add4-4bf4733ebb22
          stepCounter: adfaec73-e63b-4fe1-9384-d1aaef7b9fde
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MAPPING_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c0e087c4-d920-409f-83c9-a69487463fb6
                stepCounter: 0c04f9e6-ed01-4c9d-8390-84528ffd65ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32b3d073-1fcf-454b-9e15-f15aae2c7b94
          stepCounter: adfaec73-e63b-4fe1-9384-d1aaef7b9fde
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MAPPING_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 04894d6c-c738-427a-a962-579accff8710
                stepCounter: 0c04f9e6-ed01-4c9d-8390-84528ffd65ba
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 947fcb4c-638f-4297-9f3a-36421823820b
          stepCounter: adfaec73-e63b-4fe1-9384-d1aaef7b9fde
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          L_MAPPINGS_REFERRALCLOSEREASON: 0c04f9e6-ed01-4c9d-8390-84528ffd65ba
          L_REFERENCE_MOH_NPF_CODESETS: 868516a7-a8ad-4623-b272-3600113b2439
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_PIMS_REFERENCE_VALUES
          - locationName: TGT
            nodeName: L_MAPPINGS_REFERRALCLOSEREASON
          - locationName: TGT
            nodeName: L_REFERENCE_MOH_NPF_CODESETS
        join:
          joinCondition: |-
            FROM ds_pims_reference_values
              LEFT OUTER JOIN {{ ref('TGT','L_MAPPINGS_REFERRALCLOSEREASON') }}
                ON ds_pims_reference_values.rfval_refno = l_mappings_ReferralCloseReason.RFVAL_REFNO
              LEFT OUTER JOIN {{ ref('TGT','L_REFERENCE_MOH_NPF_CODESETS') }}
                ON l_mappings_ReferralCloseReason.exception_outcome_code = l_reference_MOH_NPF_codesets.Code
               AND [l_reference_MOH_NPF_codesets].codeset = 'EXCPOUT'
              LEFT OUTER JOIN {{ ref('TGT','L_REFERENCE_MOH_NPF_CODESETS') }} [l_reference_MOH_NPF_codesets_2]
                ON l_mappings_ReferralCloseReason.exception_outcome_reason_code = l_reference_MOH_NPF_codesets_2.Code
               AND [l_reference_MOH_NPF_codesets_2].codeset = 'EXCPREA'
             WHERE rfvdm_code = 'CLORS'
        name: S_REFERRAL_COMPLETION_REASON
        noLinkRefs: []
  name: S_REFERRAL_COMPLETION_REASON
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
