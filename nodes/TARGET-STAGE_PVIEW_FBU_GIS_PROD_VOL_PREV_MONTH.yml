fileVersion: 1
id: 182e5543-dced-4136-8da5-2ad88c09769b
name: STAGE_PVIEW_FBU_GIS_PROD_VOL_PREV_MONTH
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d55729a-a0bb-4272-99bb-1a17e9bb8776
          stepCounter: 182e5543-dced-4136-8da5-2ad88c09769b
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: IDFLOWNET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b278dac-b217-44ec-8228-1bf98ac2d1fe
                stepCounter: ab1d9a09-1b86-42e6-9277-bcf8596a81e0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c479934-d9c8-4bd5-b7d3-66a76e109d3d
          stepCounter: 182e5543-dced-4136-8da5-2ad88c09769b
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: IDREC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a5202e41-8cb7-4614-8f69-ee13905dce0d
                stepCounter: ab1d9a09-1b86-42e6-9277-bcf8596a81e0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b34adf1d-b391-4722-a235-08dabcee23e0
          stepCounter: 182e5543-dced-4136-8da5-2ad88c09769b
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: NUM_BEPH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 619d206a-e48b-4c60-ac8b-6acb8c4d4ed7
                stepCounter: ab1d9a09-1b86-42e6-9277-bcf8596a81e0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 955172e6-f7ea-4639-b645-9115be5a3597
          stepCounter: 182e5543-dced-4136-8da5-2ad88c09769b
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e22a68d-9dca-4285-9715-7b2f584b1dbd
                stepCounter: ab1d9a09-1b86-42e6-9277-bcf8596a81e0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45309479-a5ce-4f04-985f-b639f6c59b5b
          stepCounter: 182e5543-dced-4136-8da5-2ad88c09769b
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: PERIOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a07bd702-310d-430f-bafb-320a36b99c12
                stepCounter: ab1d9a09-1b86-42e6-9277-bcf8596a81e0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4f1d5cf-5266-46c5-bdf1-af072f599f4c
          stepCounter: 182e5543-dced-4136-8da5-2ad88c09769b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: HOURS_DOWN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03348e29-4017-4646-8a2e-29067cbe5731
                stepCounter: ab1d9a09-1b86-42e6-9277-bcf8596a81e0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 00cb78b3-d40c-4ffd-980e-79bea9246022
          stepCounter: 182e5543-dced-4136-8da5-2ad88c09769b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: HOURS_ON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91bfaaba-8129-42af-bc4c-6c30e40a1f55
                stepCounter: ab1d9a09-1b86-42e6-9277-bcf8596a81e0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ffcb1cf8-9072-465f-862d-edf6877a89e0
          stepCounter: 182e5543-dced-4136-8da5-2ad88c09769b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: PROD_OIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 714c835c-0ca3-438b-a956-9b7abb04edfb
                stepCounter: ab1d9a09-1b86-42e6-9277-bcf8596a81e0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6bef924a-fb52-46c7-bf13-ffb3793680ab
          stepCounter: 182e5543-dced-4136-8da5-2ad88c09769b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: PROD_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a15d27a-3264-4a29-93a6-d56f5d84e646
                stepCounter: ab1d9a09-1b86-42e6-9277-bcf8596a81e0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2aa08fbb-816d-464c-9630-dd1dc33db027
          stepCounter: 182e5543-dced-4136-8da5-2ad88c09769b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: PROD_WATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 177c7386-9aed-4fe5-b629-f363847790ce
                stepCounter: ab1d9a09-1b86-42e6-9277-bcf8596a81e0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 411c3a26-bb20-4688-995c-2b94e377e53b
          stepCounter: 182e5543-dced-4136-8da5-2ad88c09769b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: ALLOC_OIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50490388-5aa6-476e-9663-54738126936f
                stepCounter: ab1d9a09-1b86-42e6-9277-bcf8596a81e0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7674a930-e355-435d-932a-8636e5366978
          stepCounter: 182e5543-dced-4136-8da5-2ad88c09769b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: ALLOC_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e3eb8c17-9a3a-450d-a3bb-0f5cdfbc6563
                stepCounter: ab1d9a09-1b86-42e6-9277-bcf8596a81e0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d54f7c7-df1b-4c98-b2bb-dcebcea72d72
          stepCounter: 182e5543-dced-4136-8da5-2ad88c09769b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: ALLOC_WATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fbfc4d99-2a12-4b7f-b1a7-94040bdf0f06
                stepCounter: ab1d9a09-1b86-42e6-9277-bcf8596a81e0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 107aa903-72b9-41d3-a804-b0c0a704386c
          stepCounter: 182e5543-dced-4136-8da5-2ad88c09769b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: LOST_OIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e568a26-13a9-41eb-8060-81c0244f1cc3
                stepCounter: ab1d9a09-1b86-42e6-9277-bcf8596a81e0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f1efdbe2-1d81-44e3-913d-81c9f825a766
          stepCounter: 182e5543-dced-4136-8da5-2ad88c09769b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: LOST_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d76d1e16-79ba-446f-9861-ef904443803b
                stepCounter: ab1d9a09-1b86-42e6-9277-bcf8596a81e0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07988f0f-7378-446a-93e9-8aa62b64d180
          stepCounter: 182e5543-dced-4136-8da5-2ad88c09769b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: LOST_WATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 677f130a-5b02-4d8f-a409-daa48261815c
                stepCounter: ab1d9a09-1b86-42e6-9277-bcf8596a81e0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 580c6e65-4fde-4d55-9d7f-a3730ed51ed3
          stepCounter: 182e5543-dced-4136-8da5-2ad88c09769b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: INJ_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c508187-5c64-411f-80b1-e22c956e2150
                stepCounter: ab1d9a09-1b86-42e6-9277-bcf8596a81e0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3964c3c-be28-4ecd-8d67-9626c476d6d6
          stepCounter: 182e5543-dced-4136-8da5-2ad88c09769b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: INJ_OIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4fc27cb8-ecf1-4ab7-91bc-fd14bf228bf6
                stepCounter: ab1d9a09-1b86-42e6-9277-bcf8596a81e0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 539f3626-2915-4f37-a02c-613500c7c771
          stepCounter: 182e5543-dced-4136-8da5-2ad88c09769b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: INJ_WATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84149906-5238-47e5-bc19-8bf9bde2a535
                stepCounter: ab1d9a09-1b86-42e6-9277-bcf8596a81e0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 024aee5f-da15-466c-81c8-d4ff6f4ca763
          stepCounter: 182e5543-dced-4136-8da5-2ad88c09769b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: SALES_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 244c3513-a4ee-454b-ba29-22c5a9ec7ca7
                stepCounter: ab1d9a09-1b86-42e6-9277-bcf8596a81e0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bac3133a-444b-4661-b9e3-99eb63e58c93
          stepCounter: 182e5543-dced-4136-8da5-2ad88c09769b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: FUEL_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aff78cd3-c1e2-46c3-ad3a-73facac830d8
                stepCounter: ab1d9a09-1b86-42e6-9277-bcf8596a81e0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 502c285d-3e20-4fbf-9efa-4957ef971e52
          stepCounter: 182e5543-dced-4136-8da5-2ad88c09769b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: FLARE_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0df81e0e-bad2-4b39-a5f4-7547935ba162
                stepCounter: ab1d9a09-1b86-42e6-9277-bcf8596a81e0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff204bff-d67e-4035-a9c2-0601a6a20c45
          stepCounter: 182e5543-dced-4136-8da5-2ad88c09769b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: VENT_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7cdd962a-11ad-4ff4-893f-d6e5225c98f8
                stepCounter: ab1d9a09-1b86-42e6-9277-bcf8596a81e0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ef68528-d547-42cb-aacd-657755e987b3
          stepCounter: 182e5543-dced-4136-8da5-2ad88c09769b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: TONS_OIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7fb31af-2c32-46cb-9818-337c13e96d6f
                stepCounter: ab1d9a09-1b86-42e6-9277-bcf8596a81e0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dff4247c-47c9-42ce-865e-2aa535614606
          stepCounter: 182e5543-dced-4136-8da5-2ad88c09769b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: TEST_TOTAL_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c3045d8-9731-4fbb-92a5-d941ac183e5a
                stepCounter: ab1d9a09-1b86-42e6-9277-bcf8596a81e0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c7fb48e-1e36-493e-8015-396ca1b702e2
          stepCounter: 182e5543-dced-4136-8da5-2ad88c09769b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: TEST_OIL_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9f6a2f30-992d-43cb-a2cf-23310c53714e
                stepCounter: ab1d9a09-1b86-42e6-9277-bcf8596a81e0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c1b6ba2-57a6-4747-9720-fd8adba9d44a
          stepCounter: 182e5543-dced-4136-8da5-2ad88c09769b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: TEST_WATER_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1bba7fa5-ab58-458f-814b-44f0a45552df
                stepCounter: ab1d9a09-1b86-42e6-9277-bcf8596a81e0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8215fc0-10ac-49b3-9953-9e79d6a356ff
          stepCounter: 182e5543-dced-4136-8da5-2ad88c09769b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: TEST_BSW
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b615ed26-af23-4b08-bae8-10d57661b4b5
                stepCounter: ab1d9a09-1b86-42e6-9277-bcf8596a81e0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c160a4c3-202d-4ed5-91c4-6eb9d54798a2
          stepCounter: 182e5543-dced-4136-8da5-2ad88c09769b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: TUBING_PRES_BAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2a51b55-162c-4e6d-a284-0b0ceb8646ea
                stepCounter: ab1d9a09-1b86-42e6-9277-bcf8596a81e0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a826aae-8729-481c-8b17-e06cddc4c226
          stepCounter: 182e5543-dced-4136-8da5-2ad88c09769b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: CASING_PRES_BAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8dfd6e50-b18b-4125-a503-1c47ee85c42e
                stepCounter: ab1d9a09-1b86-42e6-9277-bcf8596a81e0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: caf5667b-7531-4f57-a311-2ecc14c4d798
          stepCounter: 182e5543-dced-4136-8da5-2ad88c09769b
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: SALINITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a44e196f-a6d0-4c8a-8541-ac2c7c517c6a
                stepCounter: ab1d9a09-1b86-42e6-9277-bcf8596a81e0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 152ce13e-9068-4e7c-887e-bb4bf6d6de4a
          stepCounter: 182e5543-dced-4136-8da5-2ad88c09769b
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FLOWDIRECTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fcccd1be-60e4-4ac1-893a-8d81c8c86d49
                stepCounter: ab1d9a09-1b86-42e6-9277-bcf8596a81e0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb771722-863b-482e-b82e-31678ace3288
          stepCounter: 182e5543-dced-4136-8da5-2ad88c09769b
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 615a720f-08e5-493b-8499-097b42d29ce3
                stepCounter: ab1d9a09-1b86-42e6-9277-bcf8596a81e0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98f214ec-2f4b-44f0-b861-3b58fd1c2fc9
          stepCounter: 182e5543-dced-4136-8da5-2ad88c09769b
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8dac05e2-ec92-45dc-a5b9-3ddc77d6ea58
                stepCounter: ab1d9a09-1b86-42e6-9277-bcf8596a81e0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67f0a571-19a0-4eb7-8cc4-ab1ef6e80307
          stepCounter: 182e5543-dced-4136-8da5-2ad88c09769b
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: BU_SF_ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 49b9f565-07b0-426b-afa3-c1ec3519ccf1
                stepCounter: ab1d9a09-1b86-42e6-9277-bcf8596a81e0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1d8ca80-9760-4f2a-a0c2-3221dcdb39cb
          stepCounter: 182e5543-dced-4136-8da5-2ad88c09769b
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: CAST(current_timestamp() AS timestamp_ntz)
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_PVIEW_GIS_MONTHLY: ab1d9a09-1b86-42e6-9277-bcf8596a81e0
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: VIEW_PVIEW_GIS_MONTHLY
        join:
          joinCondition: |-
            FROM {{ ref('TARGET','VIEW_PVIEW_GIS_MONTHLY') }}
             WHERE START_DATE < DATEADD(DAY, 1, LAST_DAY(DATEADD(MONTH, -1, CURRENT_DATE)))
               AND END_DATE = DATEADD(DAY, -1, DATE_TRUNC('month',CURRENT_DATE()))
               AND FLOWDIRECTION = 'production'
               AND REPLACE(REPLACE(REPLACE(BU_SF_ROLE,'_DEV',''),'_TEST',''),'_PROD','') = 'BI_BU_FBU'
               AND (NVL(PROD_GAS,0)+NVL(PROD_OIL,0)+NVL(PROD_WATER,0)) > 0
        name: STAGE_PVIEW_FBU_GIS_PROD_VOL_PREV_MONTH
        noLinkRefs: []
  name: STAGE_PVIEW_FBU_GIS_PROD_VOL_PREV_MONTH
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
