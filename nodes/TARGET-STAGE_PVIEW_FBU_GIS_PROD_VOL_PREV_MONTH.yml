fileVersion: 1
id: bf128f7c-9cf4-4338-9def-9ed73ba96f79
name: STAGE_PVIEW_FBU_GIS_PROD_VOL_PREV_MONTH
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2ee0218-80f7-4ce5-98f9-5a8f14e01e01
          stepCounter: bf128f7c-9cf4-4338-9def-9ed73ba96f79
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: IDFLOWNET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e9417b80-4489-4ab1-a2e4-ce422c3d8a95
                stepCounter: a9871cb9-6f67-4a19-92f1-6e7633ad4af1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2bd6d975-e541-4fc5-951a-5f4370bdcefa
          stepCounter: bf128f7c-9cf4-4338-9def-9ed73ba96f79
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: IDREC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: da244cb4-4c02-4995-8944-dafaa3dc7d4c
                stepCounter: a9871cb9-6f67-4a19-92f1-6e7633ad4af1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5744299d-1c53-4a53-ade4-441147e4dcea
          stepCounter: bf128f7c-9cf4-4338-9def-9ed73ba96f79
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: NUM_BEPH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 54dab8f3-23ad-4a0b-b7ee-8b38c6e25f83
                stepCounter: a9871cb9-6f67-4a19-92f1-6e7633ad4af1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1469decf-9da0-4396-9e50-24523ce6d131
          stepCounter: bf128f7c-9cf4-4338-9def-9ed73ba96f79
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e0489c3-6c3a-4619-a7b9-5cf5a9c2e156
                stepCounter: a9871cb9-6f67-4a19-92f1-6e7633ad4af1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed6ecf63-81b4-46eb-8d5b-e69d6626e1f0
          stepCounter: bf128f7c-9cf4-4338-9def-9ed73ba96f79
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: PERIOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e371a7ee-c0b9-4cb6-9452-46f88efb0e80
                stepCounter: a9871cb9-6f67-4a19-92f1-6e7633ad4af1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e2e2584-a04f-4170-8f06-bbaaeb2e0c52
          stepCounter: bf128f7c-9cf4-4338-9def-9ed73ba96f79
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: HOURS_DOWN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d1ff8b86-4261-45c2-8bbc-120239fb3eee
                stepCounter: a9871cb9-6f67-4a19-92f1-6e7633ad4af1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8cbfa407-7303-431a-a0fb-78a5e6884dc7
          stepCounter: bf128f7c-9cf4-4338-9def-9ed73ba96f79
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: HOURS_ON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 46cae1d8-8da7-4528-aeb9-ce27da003da7
                stepCounter: a9871cb9-6f67-4a19-92f1-6e7633ad4af1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c40297ae-6ae0-4e00-ad4d-fbb9ef3870b6
          stepCounter: bf128f7c-9cf4-4338-9def-9ed73ba96f79
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: PROD_OIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8e613d6-d6be-49d6-be63-d8099a1af1c4
                stepCounter: a9871cb9-6f67-4a19-92f1-6e7633ad4af1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5654f92e-5c40-4e38-9319-8e8cdffe3603
          stepCounter: bf128f7c-9cf4-4338-9def-9ed73ba96f79
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: PROD_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b27a167-3474-4429-866a-295fd867f924
                stepCounter: a9871cb9-6f67-4a19-92f1-6e7633ad4af1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c896bb37-5cf7-49a4-bfb8-215ef3248ae7
          stepCounter: bf128f7c-9cf4-4338-9def-9ed73ba96f79
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: PROD_WATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2838768e-20bc-4677-900e-ed6f3bc1550c
                stepCounter: a9871cb9-6f67-4a19-92f1-6e7633ad4af1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3da7baa9-f2b4-444c-bd79-70405de19c46
          stepCounter: bf128f7c-9cf4-4338-9def-9ed73ba96f79
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: ALLOC_OIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e963f12-5ee1-43f0-84d6-9d35129b2802
                stepCounter: a9871cb9-6f67-4a19-92f1-6e7633ad4af1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: caa52e62-44f9-4690-83b1-8f5a69175d1a
          stepCounter: bf128f7c-9cf4-4338-9def-9ed73ba96f79
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: ALLOC_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dfc8bda9-6f48-4687-822b-c25de33890be
                stepCounter: a9871cb9-6f67-4a19-92f1-6e7633ad4af1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d96466cc-902c-442d-b776-483982fa5ba3
          stepCounter: bf128f7c-9cf4-4338-9def-9ed73ba96f79
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: ALLOC_WATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6292291b-c542-47a3-b32d-4d87df3306cc
                stepCounter: a9871cb9-6f67-4a19-92f1-6e7633ad4af1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 539696b1-a364-4cde-bc5e-8e98f642304b
          stepCounter: bf128f7c-9cf4-4338-9def-9ed73ba96f79
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: LOST_OIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2f4d492-2748-4b26-b315-d5f627b92110
                stepCounter: a9871cb9-6f67-4a19-92f1-6e7633ad4af1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29df5141-16e8-4c99-bc54-4034e79077a9
          stepCounter: bf128f7c-9cf4-4338-9def-9ed73ba96f79
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: LOST_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e718a0e1-bd79-4144-be7c-08f030b579ce
                stepCounter: a9871cb9-6f67-4a19-92f1-6e7633ad4af1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cbe105d2-b9c3-45c5-a3b1-6baf41aa5d55
          stepCounter: bf128f7c-9cf4-4338-9def-9ed73ba96f79
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: LOST_WATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09c40d4c-1236-4a88-99bf-15323908cfd1
                stepCounter: a9871cb9-6f67-4a19-92f1-6e7633ad4af1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0bba7184-f429-47a6-93c2-e100f7bf2a22
          stepCounter: bf128f7c-9cf4-4338-9def-9ed73ba96f79
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: INJ_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24c6b8f8-1cbf-43a5-970f-ceb9b7811a7e
                stepCounter: a9871cb9-6f67-4a19-92f1-6e7633ad4af1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 805d1112-04ed-4f70-b46d-7ad29021bbc4
          stepCounter: bf128f7c-9cf4-4338-9def-9ed73ba96f79
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: INJ_OIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 44a65cde-0cdb-4656-96cd-61da113816cd
                stepCounter: a9871cb9-6f67-4a19-92f1-6e7633ad4af1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 89beb79d-fd16-4a1f-beee-0e4257bff973
          stepCounter: bf128f7c-9cf4-4338-9def-9ed73ba96f79
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: INJ_WATER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 74997cab-20d0-4573-917e-98493c80605c
                stepCounter: a9871cb9-6f67-4a19-92f1-6e7633ad4af1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2dfaa23c-9462-434d-9922-c9351d44aaf7
          stepCounter: bf128f7c-9cf4-4338-9def-9ed73ba96f79
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: SALES_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b412a9dd-a430-4f33-8a9f-2c4f2a6d9d3d
                stepCounter: a9871cb9-6f67-4a19-92f1-6e7633ad4af1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2fa36939-7911-4b7a-9cc9-44ba70f9aff9
          stepCounter: bf128f7c-9cf4-4338-9def-9ed73ba96f79
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: FUEL_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f0b7ffbc-e6ab-43d8-ac04-8bf7df691ac5
                stepCounter: a9871cb9-6f67-4a19-92f1-6e7633ad4af1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c9a8ba7-f1bc-4228-acef-c1ae598202e0
          stepCounter: bf128f7c-9cf4-4338-9def-9ed73ba96f79
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: FLARE_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51cb361b-0e44-4719-beb2-d1f94df06cae
                stepCounter: a9871cb9-6f67-4a19-92f1-6e7633ad4af1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67c97230-29d0-4cd2-a0a6-2841b88886c9
          stepCounter: bf128f7c-9cf4-4338-9def-9ed73ba96f79
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: VENT_GAS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 66ae9a05-1efd-4a44-9730-882945dbde60
                stepCounter: a9871cb9-6f67-4a19-92f1-6e7633ad4af1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09900711-c430-4f14-ae66-b4bd63f1cb3e
          stepCounter: bf128f7c-9cf4-4338-9def-9ed73ba96f79
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: TONS_OIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 469bc18f-8dc1-4078-a887-f96a1bc24676
                stepCounter: a9871cb9-6f67-4a19-92f1-6e7633ad4af1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 83def49d-a11d-450c-97bd-72b17e78cea3
          stepCounter: bf128f7c-9cf4-4338-9def-9ed73ba96f79
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: TEST_TOTAL_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd4b57c2-26a2-49ff-bc2a-47f664cbf1bb
                stepCounter: a9871cb9-6f67-4a19-92f1-6e7633ad4af1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bc036c7f-ccbd-483d-8289-c0ba7c09f52c
          stepCounter: bf128f7c-9cf4-4338-9def-9ed73ba96f79
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: TEST_OIL_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8766e74c-247a-4971-8970-187b52050349
                stepCounter: a9871cb9-6f67-4a19-92f1-6e7633ad4af1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 36a20b37-1125-4974-b2a7-4e19e2c4472c
          stepCounter: bf128f7c-9cf4-4338-9def-9ed73ba96f79
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: TEST_WATER_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b0f5e1e-e6ac-49fa-a532-45c00eeb2755
                stepCounter: a9871cb9-6f67-4a19-92f1-6e7633ad4af1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ffae64ca-d433-4c83-91b2-c06b09b8814c
          stepCounter: bf128f7c-9cf4-4338-9def-9ed73ba96f79
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: TEST_BSW
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d404082-654c-4605-ab0a-facb4f53e80a
                stepCounter: a9871cb9-6f67-4a19-92f1-6e7633ad4af1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3e8a7a0-1b56-4fbe-9d4d-1664b13d5d91
          stepCounter: bf128f7c-9cf4-4338-9def-9ed73ba96f79
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: TUBING_PRES_BAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9e21473f-0df5-4384-b762-b5b72433b6fb
                stepCounter: a9871cb9-6f67-4a19-92f1-6e7633ad4af1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad81799e-2e13-4f1d-ab1e-534d574d2812
          stepCounter: bf128f7c-9cf4-4338-9def-9ed73ba96f79
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: CASING_PRES_BAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90bbb285-5bfb-4d29-adfe-958fb830238c
                stepCounter: a9871cb9-6f67-4a19-92f1-6e7633ad4af1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7f2c1b0-0c56-4a63-8919-47cf6d3aa38f
          stepCounter: bf128f7c-9cf4-4338-9def-9ed73ba96f79
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: SALINITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76244e98-e0a1-46e1-8df3-cf7786ceda59
                stepCounter: a9871cb9-6f67-4a19-92f1-6e7633ad4af1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 141548e2-893e-4d21-8d1d-52473e4e1bf9
          stepCounter: bf128f7c-9cf4-4338-9def-9ed73ba96f79
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FLOWDIRECTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3198a779-c428-4ad5-903b-5b7b845ac0c6
                stepCounter: a9871cb9-6f67-4a19-92f1-6e7633ad4af1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bebe2539-3675-4e1b-815d-f5befbed1a06
          stepCounter: bf128f7c-9cf4-4338-9def-9ed73ba96f79
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6442fdab-3580-4745-99dc-22ffeb94f08f
                stepCounter: a9871cb9-6f67-4a19-92f1-6e7633ad4af1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40e77afb-5f11-4568-b526-12d43d19777a
          stepCounter: bf128f7c-9cf4-4338-9def-9ed73ba96f79
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f1b6701e-3405-4bfe-aaf9-bac7da4889ef
                stepCounter: a9871cb9-6f67-4a19-92f1-6e7633ad4af1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 017f57ef-b979-48e4-bf79-8bdc08ecb26e
          stepCounter: bf128f7c-9cf4-4338-9def-9ed73ba96f79
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: BU_SF_ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f1d5ed5b-3644-4d0b-9694-ee4f9d1430b9
                stepCounter: a9871cb9-6f67-4a19-92f1-6e7633ad4af1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82e49796-4b96-4380-a5f3-6c994f3371bb
          stepCounter: bf128f7c-9cf4-4338-9def-9ed73ba96f79
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: CAST(current_timestamp() AS timestamp_ntz)
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_PVIEW_GIS_MONTHLY: a9871cb9-6f67-4a19-92f1-6e7633ad4af1
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: VIEW_PVIEW_GIS_MONTHLY
        join:
          joinCondition: |-
            FROM {{ ref('TARGET','VIEW_PVIEW_GIS_MONTHLY') }}
             WHERE START_DATE < DATEADD(DAY, 1, LAST_DAY(DATEADD(MONTH, -1, CURRENT_DATE)))
               AND END_DATE = DATEADD(DAY, -1, DATE_TRUNC('month',CURRENT_DATE()))
               AND FLOWDIRECTION = 'production'
               AND REPLACE(REPLACE(REPLACE(BU_SF_ROLE,'_DEV',''),'_TEST',''),'_PROD','') = 'BI_BU_FBU'
               AND (NVL(PROD_GAS,0)+NVL(PROD_OIL,0)+NVL(PROD_WATER,0)) > 0
        name: STAGE_PVIEW_FBU_GIS_PROD_VOL_PREV_MONTH
        noLinkRefs: []
  name: STAGE_PVIEW_FBU_GIS_PROD_VOL_PREV_MONTH
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
