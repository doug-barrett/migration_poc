fileVersion: 1
id: 8742ff4c-8a97-4fe3-af12-21c1cb2aeba9
name: VIEW_PVIEW_VRL_AUS_WELLS_VW
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c6f507a-8c8c-4c2d-8d80-70a0bb45b765
          stepCounter: 8742ff4c-8a97-4fe3-af12-21c1cb2aeba9
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: IDFLOWNET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e58b7768-06e5-422d-8a5e-ba6256ff32b1
                stepCounter: 81e6b0b1-1728-45bf-932d-6356544cf13a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d550caa-1772-461e-ab50-7af23e9a3d0d
          stepCounter: 8742ff4c-8a97-4fe3-af12-21c1cb2aeba9
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8debe17-ff19-45b3-b1c5-9184c773354d
          stepCounter: 8742ff4c-8a97-4fe3-af12-21c1cb2aeba9
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: WELL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7d8e3b8-91c5-415f-b88b-5b502104d965
          stepCounter: 8742ff4c-8a97-4fe3-af12-21c1cb2aeba9
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: CHOKE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e0cf42e-9f0f-4201-b634-280b4b6f36fa
                stepCounter: 9108fb02-8d09-48b3-ba27-88a8ce494c39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8257e8e3-30d0-4d42-8b44-1b983f89b2a6
          stepCounter: 8742ff4c-8a97-4fe3-af12-21c1cb2aeba9
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: FTHP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ee6f2c1-12c9-4465-b37b-154bba143d3c
                stepCounter: 9108fb02-8d09-48b3-ba27-88a8ce494c39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d8eab94-884f-4922-963c-2ec3582ec290
          stepCounter: 8742ff4c-8a97-4fe3-af12-21c1cb2aeba9
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: QGL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67cf82f3-780b-4d68-879b-4d9c48ab3b45
                stepCounter: 79c9f452-8395-416a-93d1-1a1b09a2afa3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a5ce0c2-8af4-4900-ba2e-0ff33dde22a9
          stepCounter: 8742ff4c-8a97-4fe3-af12-21c1cb2aeba9
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: DOWNTIME_HRS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1af608eb-bb01-4ba2-831e-42ea0a141a8f
          stepCounter: 8742ff4c-8a97-4fe3-af12-21c1cb2aeba9
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODEDOWNTM1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 269aae4c-9084-45b4-97ed-b3ae64414ec6
                stepCounter: 74f44647-9ca6-45b0-bbe0-7eba25f1476b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77fc1b09-f9ae-4c33-b3b6-123c5f14fe14
          stepCounter: 8742ff4c-8a97-4fe3-af12-21c1cb2aeba9
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODEDOWNTM2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2344ad5-2de3-46d0-a994-6066b4da01c3
                stepCounter: 74f44647-9ca6-45b0-bbe0-7eba25f1476b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14861a4b-dbd4-4540-ab66-5b87103c6aa0
          stepCounter: 8742ff4c-8a97-4fe3-af12-21c1cb2aeba9
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODEDOWNTM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 87418533-315d-45d4-9a5b-86c249519bb9
                stepCounter: 74f44647-9ca6-45b0-bbe0-7eba25f1476b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 973bad8c-c3db-4c76-be69-818915ad1bc4
          stepCounter: 8742ff4c-8a97-4fe3-af12-21c1cb2aeba9
        config: {}
        dataType: VARCHAR(2000)
        defaultValue: ""
        description: ""
        name: COM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7fbb07b-eae0-461b-91dd-71b4fa3a3054
                stepCounter: 74f44647-9ca6-45b0-bbe0-7eba25f1476b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: faed9434-f133-4084-85f9-5101372102e2
          stepCounter: 8742ff4c-8a97-4fe3-af12-21c1cb2aeba9
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: BU_SF_ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2461b3f-8900-4460-9da7-dc1b4d0593bc
                stepCounter: a23239e4-617a-4ab9-a42c-1fd9220b7fb3
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_PVIEW_VRL_AUS_WELLS_VW: 8742ff4c-8a97-4fe3-af12-21c1cb2aeba9
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_PVIEW_VRL_AUS_WELLS_VW') }} AS SELECT c.idflownet,
                   CAST(p.dttm AS date) AS date,
                   c.completionname AS well,
                   param.szchoke * 1000 AS choke,
                   param.prestub AS fthp,
                   ge.volgascalc / 1000 AS qgl,
                   p.durdown * 24 AS downtime_hrs,
                   d.codedowntm1,
                   d.codedowntm2,
                   d.codedowntm3,
                   d.com,
                   WS_EDW.PVIEW_SYSSECURITYTYP_VET_BU_ROLE(h.SYSSECURITYTYP) AS BU_SF_ROLE
              FROM DS_PRODVIEW.PVT_pvunitcomp c
              LEFT JOIN DS_PRODVIEW.PVT_pvunitcompgathmonthcalc pm
                ON c.idrec = pm.idrecparent
              LEFT JOIN DS_PRODVIEW.PVT_pvunitcompgathmonthdaycalc p
                ON pm.idrec = p.idrecparent
              LEFT JOIN DS_PRODVIEW.PVT_pvunitcompparam param
                ON param.idrec = p.idrecparam
              LEFT JOIN DS_PRODVIEW.PVT_pvunitcompdowntm d
                ON c.idrec = d.idrecparent
               AND p.dttm = d.dttmstart
             INNER JOIN DS_PRODVIEW.PVT_pvunit u
                ON c.idrecparent = u.idrec
              LEFT JOIN DS_PRODVIEW.PVT_pvunitmeterpdgas g
                ON u.idrec = g.idrecparent
              LEFT JOIN DS_PRODVIEW.PVT_pvunitmeterpdgasentry ge
                ON g.idrec = ge.idrecparent
               AND ge.dttm = p.dttm
             INNER JOIN DS_PRODVIEW.PVT_pvflownetheader h
                ON h.idflownet = c.idflownet
             WHERE c.completionname not like 'WB10%'
        dependencies:
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITCOMP
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITCOMP') }}
        name: VIEW_PVIEW_VRL_AUS_WELLS_VW
        noLinkRefs: []
  name: VIEW_PVIEW_VRL_AUS_WELLS_VW
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
