fileVersion: 1
id: 1e085a2a-3897-48b3-9903-e5e0cd84d822
name: VIEW_PVIEW_VRL_AUS_WELLS_VW
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 360cf1d4-5362-47b2-9687-7da76e5c3c4d
          stepCounter: 1e085a2a-3897-48b3-9903-e5e0cd84d822
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: IDFLOWNET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0d575304-9ff0-4956-9447-f9399825b1e9
                stepCounter: b2609f15-a93c-4c5d-b86e-0898ad7558d0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3294dfbc-93d2-4ebb-ad15-f182d5b1118a
          stepCounter: 1e085a2a-3897-48b3-9903-e5e0cd84d822
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3522825-7ab6-497d-b48e-7ec46774b57b
          stepCounter: 1e085a2a-3897-48b3-9903-e5e0cd84d822
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: WELL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9dd5f11-de41-4530-b7a8-28caee298639
          stepCounter: 1e085a2a-3897-48b3-9903-e5e0cd84d822
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: CHOKE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83ea1ca3-6335-41e7-a9ea-5d9d9f134217
                stepCounter: 3c6f5981-3218-423d-b012-74039f0258fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 399261e7-935d-403b-b929-79d2676bc86f
          stepCounter: 1e085a2a-3897-48b3-9903-e5e0cd84d822
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: FTHP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c10af379-bdbe-42bc-b41b-1fb7bb49e843
                stepCounter: 3c6f5981-3218-423d-b012-74039f0258fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 061299e9-cc62-45c6-85c1-0958c8628316
          stepCounter: 1e085a2a-3897-48b3-9903-e5e0cd84d822
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: QGL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 44b7f470-73a4-46ca-ab8b-2ba1f70dd48a
                stepCounter: f463aa47-4bc3-4601-8f44-729101e921f0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de53e2e1-0569-4579-a90a-85a0f45f461b
          stepCounter: 1e085a2a-3897-48b3-9903-e5e0cd84d822
        config: {}
        dataType: DOUBLE(38)
        defaultValue: ""
        description: ""
        name: DOWNTIME_HRS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6bd03e41-a728-4868-ab9d-4e44f7fbc931
          stepCounter: 1e085a2a-3897-48b3-9903-e5e0cd84d822
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODEDOWNTM1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9f3c7124-cf15-45ac-b345-58434a1ea591
                stepCounter: 1cfae906-aa80-4fdd-86b2-b1b3da4133d3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa1c7228-19a4-44b2-b731-254ec8b8fb41
          stepCounter: 1e085a2a-3897-48b3-9903-e5e0cd84d822
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODEDOWNTM2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f62b7e5-2a9d-423a-950f-4106c2b28111
                stepCounter: 1cfae906-aa80-4fdd-86b2-b1b3da4133d3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: abaca32c-142d-421f-b96b-abc44b3d9218
          stepCounter: 1e085a2a-3897-48b3-9903-e5e0cd84d822
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: CODEDOWNTM3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b5d45b8b-cc48-45f6-9ca4-fd0ce63ce6fd
                stepCounter: 1cfae906-aa80-4fdd-86b2-b1b3da4133d3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 028038d2-0d41-46bb-8bae-ced15e5276b6
          stepCounter: 1e085a2a-3897-48b3-9903-e5e0cd84d822
        config: {}
        dataType: VARCHAR(2000)
        defaultValue: ""
        description: ""
        name: COM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 523c8ba2-6769-46bc-93e3-3db7a6045009
                stepCounter: 1cfae906-aa80-4fdd-86b2-b1b3da4133d3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 44a204a6-7c75-4760-859d-2c0c6180ee6e
          stepCounter: 1e085a2a-3897-48b3-9903-e5e0cd84d822
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: BU_SF_ROLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 748cdf05-5750-44bd-bb7a-77b0769f897d
                stepCounter: bd388a52-3d72-4c70-833d-7de7c6a8abd1
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_PVIEW_VRL_AUS_WELLS_VW: 1e085a2a-3897-48b3-9903-e5e0cd84d822
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_PVIEW_VRL_AUS_WELLS_VW') }} AS SELECT c.idflownet,
                   CAST(p.dttm AS date) AS date,
                   c.completionname AS well,
                   param.szchoke * 1000 AS choke,
                   param.prestub AS fthp,
                   ge.volgascalc / 1000 AS qgl,
                   p.durdown * 24 AS downtime_hrs,
                   d.codedowntm1,
                   d.codedowntm2,
                   d.codedowntm3,
                   d.com,
                   WS_EDW.PVIEW_SYSSECURITYTYP_VET_BU_ROLE(h.SYSSECURITYTYP) AS BU_SF_ROLE
              FROM DS_PRODVIEW.PVT_pvunitcomp c
              LEFT JOIN DS_PRODVIEW.PVT_pvunitcompgathmonthcalc pm
                ON c.idrec = pm.idrecparent
              LEFT JOIN DS_PRODVIEW.PVT_pvunitcompgathmonthdaycalc p
                ON pm.idrec = p.idrecparent
              LEFT JOIN DS_PRODVIEW.PVT_pvunitcompparam param
                ON param.idrec = p.idrecparam
              LEFT JOIN DS_PRODVIEW.PVT_pvunitcompdowntm d
                ON c.idrec = d.idrecparent
               AND p.dttm = d.dttmstart
             INNER JOIN DS_PRODVIEW.PVT_pvunit u
                ON c.idrecparent = u.idrec
              LEFT JOIN DS_PRODVIEW.PVT_pvunitmeterpdgas g
                ON u.idrec = g.idrecparent
              LEFT JOIN DS_PRODVIEW.PVT_pvunitmeterpdgasentry ge
                ON g.idrec = ge.idrecparent
               AND ge.dttm = p.dttm
             INNER JOIN DS_PRODVIEW.PVT_pvflownetheader h
                ON h.idflownet = c.idflownet
             WHERE c.completionname not like 'WB10%'
        dependencies:
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNITCOMP
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_PVIEW_PVT_PVUNITCOMP') }}
        name: VIEW_PVIEW_VRL_AUS_WELLS_VW
        noLinkRefs: []
  name: VIEW_PVIEW_VRL_AUS_WELLS_VW
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
