fileVersion: 1
id: 74560848-6964-491e-9f86-9d99fcb1f372
name: S_THEATRE_VISIT_DIAGNOSIS_PROCEDURE
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 739840fb-569c-4c5d-b2c6-4fc789b292f9
          stepCounter: 74560848-6964-491e-9f86-9d99fcb1f372
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: THEATRE_VISIT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b5ab558-a34e-4fd8-9b8e-311c0d96346a
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: "'T'+CONVERT(varchar,ds_pims_schedules.schdl_refno)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5af02d21-c926-4af0-8adc-9394fe55e41a
          stepCounter: 74560848-6964-491e-9f86-9d99fcb1f372
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: SCHEDULE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b5ab558-a34e-4fd8-9b8e-311c0d96346a
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a4c04e8-e08f-420f-9ed2-318f014c3edd
          stepCounter: 74560848-6964-491e-9f86-9d99fcb1f372
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: VISIT_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec8fa2c5-ca35-4bea-9290-bc50185e05e7
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7895c417-2b15-4f8c-93fb-b7ef2ff3a4ec
          stepCounter: 74560848-6964-491e-9f86-9d99fcb1f372
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_theatre_visit_diagnosis_procedure.CONVERT(date,ds_pims_schedules.start_dttm)=dim_visit_start_date.visit_start_calendar_date
        name: DIM_VISIT_START_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 13234e71-2519-473a-af0d-7f73325182c3
                stepCounter: 484fdf1d-550f-43b0-8050-5734ec05d67b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 10d15751-ddf9-40f0-b44e-34cd70e7014a
          stepCounter: 74560848-6964-491e-9f86-9d99fcb1f372
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: VISIT_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47aba488-a08d-44c7-a39c-dff4d9faf905
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0767676-099b-4d5b-96e5-5111a3cd3198
          stepCounter: 74560848-6964-491e-9f86-9d99fcb1f372
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_theatre_visit_diagnosis_procedure.CONVERT(date,ds_pims_schedules.end_dttm)=dim_visit_end_date.visit_end_calendar_date
        name: DIM_VISIT_END_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 08025052-688d-445e-bbd8-0354e67585c3
                stepCounter: 90bdc455-a671-42c7-840f-35c738a1f1f3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2313a954-8d0b-4ca2-baf4-cb13b2f2008d
          stepCounter: 74560848-6964-491e-9f86-9d99fcb1f372
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CODING_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d3ec50b-0cab-4f40-8ea9-6b0cdb3e4329
                stepCounter: 1b5b9711-ab0c-474a-a7f0-a18e233b291c
            transform: IFNULL(ds_pims_diagnosis_procedures.dgpro_dttm,ds_pims_schedules.end_dttm)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 90c76b0a-537e-4b3f-b098-d55627861663
          stepCounter: 74560848-6964-491e-9f86-9d99fcb1f372
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b97bdc6-cf45-46a3-b6b6-36dca9fe2232
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa0a93ba-230e-4966-8dc0-0e170ceeec7a
          stepCounter: 74560848-6964-491e-9f86-9d99fcb1f372
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 985f0ba0-97cf-4152-a49b-7e86cb71409e
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9d71b27-905f-49fa-ae67-ce627e973a81
          stepCounter: 74560848-6964-491e-9f86-9d99fcb1f372
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_theatre_visit_diagnosis_procedure.patient_reference_no=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9962a01b-5f3d-4c1a-b371-997edef38d0f
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f4259375-17ed-4af5-9b1c-7c9b1e441cf6
          stepCounter: 74560848-6964-491e-9f86-9d99fcb1f372
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: MEDICAL_PROBLEM_LEVEL_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7dcad9a6-52b1-402a-a292-1118300823b9
                stepCounter: 1b5b9711-ab0c-474a-a7f0-a18e233b291c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f88c8de1-c7b3-4395-ad6d-d497ef8de4ea
          stepCounter: 74560848-6964-491e-9f86-9d99fcb1f372
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: MEDICAL_PROBLEM_LEVEL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77b683c5-799a-4d68-8826-042a5688d595
          stepCounter: 74560848-6964-491e-9f86-9d99fcb1f372
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 271efe56-3d39-4d18-b5a7-7e1dcc80d250
                stepCounter: 1b5b9711-ab0c-474a-a7f0-a18e233b291c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a85f1ff3-c167-476b-8239-6ff937879c9f
          stepCounter: 74560848-6964-491e-9f86-9d99fcb1f372
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SPINE_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 271efe56-3d39-4d18-b5a7-7e1dcc80d250
                stepCounter: 1b5b9711-ab0c-474a-a7f0-a18e233b291c
            transform: |-
              CASE WHEN substring(diagnosis_procedure_code,2,2) = 'SP' THEN 1
                          ELSE 0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26d236d6-f227-4d25-bde9-cfd971b6884c
          stepCounter: 74560848-6964-491e-9f86-9d99fcb1f372
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: HIP_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 271efe56-3d39-4d18-b5a7-7e1dcc80d250
                stepCounter: 1b5b9711-ab0c-474a-a7f0-a18e233b291c
            transform: |-
              CASE WHEN substring(diagnosis_procedure_code,2,2) = 'HI' THEN 1
                          ELSE 0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac166f9f-bd94-4ccc-ae6d-a879acfe0181
          stepCounter: 74560848-6964-491e-9f86-9d99fcb1f372
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: KNEE_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 271efe56-3d39-4d18-b5a7-7e1dcc80d250
                stepCounter: 1b5b9711-ab0c-474a-a7f0-a18e233b291c
            transform: |-
              CASE WHEN substring(diagnosis_procedure_code,2,2) = 'KN' THEN 1
                          ELSE 0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1dfab19f-b5e1-4ad4-bc2f-aef33647e952
          stepCounter: 74560848-6964-491e-9f86-9d99fcb1f372
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_SUBTYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c328fcc-05f8-4aac-bb55-737559e9454d
          stepCounter: 74560848-6964-491e-9f86-9d99fcb1f372
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: CLINICAL_CLASSIFICATION_XREF_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ecc036db-91d2-4737-b93c-f3e449aa298e
                stepCounter: 1b5b9711-ab0c-474a-a7f0-a18e233b291c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 395780a7-9205-4074-8658-7d9ef6739390
          stepCounter: 74560848-6964-491e-9f86-9d99fcb1f372
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: CLINICAL_CLASSIFICATION_XREF_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9da27664-295d-4362-818b-c0381d9b147b
          stepCounter: 74560848-6964-491e-9f86-9d99fcb1f372
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ae1a398a-9c7b-4fad-b7e2-8e105705ec6f
                stepCounter: 1b5b9711-ab0c-474a-a7f0-a18e233b291c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8cdd8b98-d001-4920-8895-744149d82885
          stepCounter: 74560848-6964-491e-9f86-9d99fcb1f372
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_PROCEDURE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4c372ad-7e3b-459a-89ad-ec53d1b8cb49
                stepCounter: 1b5b9711-ab0c-474a-a7f0-a18e233b291c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47c5f8f4-4956-488b-bfdf-fc6f08a8f085
          stepCounter: 74560848-6964-491e-9f86-9d99fcb1f372
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_theatre_visit_diagnosis_procedure.diagnosis_procedure_reference_no=dim_diagnosis_procedure.diagnosis_procedure_reference_no
        name: DIM_DIAGNOSIS_PROCEDURE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24cebf11-1bcf-4240-a364-9b0f51cffc73
                stepCounter: 5c3dba16-610b-4df4-a82e-a17b4d31bb68
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d4b464d-932b-43a5-a5e0-31efa4401f24
          stepCounter: 74560848-6964-491e-9f86-9d99fcb1f372
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_diagnosis_procedure.diagnosis_procedure_reference_no=dim_diagnosis_procedure.diagnosis_procedure_reference_no
        name: PATIENT_DIAGNOSIS_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b97bdc6-cf45-46a3-b6b6-36dca9fe2232
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: |-
              CASE WHEN ds_pims_diagnosis_procedures.dptyp_code = 'DIAGN' THEN ROW_NUMBER() OVER (PARTITION BY ds_pims_schedules.patnt_refno, (CASE WHEN ds_pims_diagnosis_procedures.dptyp_code = 'DIAGN' THEN 1 ELSE NULL END) ORDER BY ds_pims_diagnosis_procedures.sort_order,ds_pims_schedules.start_dttm)
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d840335-1b2a-4ff3-99cb-2c5e662531bf
          stepCounter: 74560848-6964-491e-9f86-9d99fcb1f372
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_diagnosis_procedure.diagnosis_procedure_reference_no=dim_diagnosis_procedure.diagnosis_procedure_reference_no
        name: PATIENT_DIAGNOSIS_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b97bdc6-cf45-46a3-b6b6-36dca9fe2232
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: |-
              CASE WHEN ds_pims_diagnosis_procedures.dptyp_code = 'DIAGN' THEN COUNT(1) OVER (PARTITION BY ds_pims_schedules.patnt_refno, (CASE WHEN ds_pims_diagnosis_procedures.dptyp_code = 'DIAGN' THEN 1 ELSE NULL END))
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 454b5cfd-0458-4711-bddb-7ec9e50739ae
          stepCounter: 74560848-6964-491e-9f86-9d99fcb1f372
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_diagnosis_procedure.diagnosis_procedure_reference_no=dim_diagnosis_procedure.diagnosis_procedure_reference_no
        name: PATIENT_PROCEDURE_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b97bdc6-cf45-46a3-b6b6-36dca9fe2232
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: |-
              CASE WHEN ds_pims_diagnosis_procedures.dptyp_code = 'PROCE' THEN ROW_NUMBER() OVER (PARTITION BY ds_pims_schedules.patnt_refno, (CASE WHEN ds_pims_diagnosis_procedures.dptyp_code = 'PROCE' THEN 1 ELSE NULL END) ORDER BY ds_pims_diagnosis_procedures.sort_order,ds_pims_schedules.start_dttm)
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 765167a8-87ca-4d23-ae24-dd6a6b9c1344
          stepCounter: 74560848-6964-491e-9f86-9d99fcb1f372
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_outpatient_diagnosis_procedure.diagnosis_procedure_reference_no=dim_diagnosis_procedure.diagnosis_procedure_reference_no
        name: PATIENT_PROCEDURE_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b97bdc6-cf45-46a3-b6b6-36dca9fe2232
                stepCounter: 91a0e39f-bf7f-4006-bd7b-65a534f637a9
            transform: |-
              CASE WHEN ds_pims_diagnosis_procedures.dptyp_code = 'PROCE' THEN COUNT(1) OVER (PARTITION BY ds_pims_schedules.patnt_refno, (CASE WHEN ds_pims_diagnosis_procedures.dptyp_code = 'PROCE' THEN 1 ELSE NULL END))
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64e351c6-833f-4eb2-8dc6-a1d1e888c86a
          stepCounter: 74560848-6964-491e-9f86-9d99fcb1f372
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 614e95dd-dc83-4fb6-80e2-eae0b812a7b5
                stepCounter: 1b5b9711-ab0c-474a-a7f0-a18e233b291c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc729ca0-eac3-4197-8c6f-84099260a593
          stepCounter: 74560848-6964-491e-9f86-9d99fcb1f372
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9f2de421-29ae-4da9-a753-3f3076972d72
                stepCounter: 1b5b9711-ab0c-474a-a7f0-a18e233b291c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2158c7b6-d4d1-4b32-9c8c-ba7526b2d4d6
          stepCounter: 74560848-6964-491e-9f86-9d99fcb1f372
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_theatre_visit_diagnosis_procedure.create_user_login_code=dim_create_user_login.create_user_login_code
        name: DIM_CREATE_USER_LOGIN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2dfe5e14-cc2f-4748-8352-a6d1621289af
                stepCounter: 70bd6ed5-e21b-440f-9079-7fe305bc4f30
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24122b32-34d0-4998-9392-ed973fd99be6
          stepCounter: 74560848-6964-491e-9f86-9d99fcb1f372
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIFY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6decebff-eb31-4277-aa08-3a795ec793df
                stepCounter: 1b5b9711-ab0c-474a-a7f0-a18e233b291c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1886bd6e-fc4c-497b-ad97-bde29e1b6d53
          stepCounter: 74560848-6964-491e-9f86-9d99fcb1f372
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MODIFY_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0018f473-59d0-4576-9d88-96374fcf8639
                stepCounter: 1b5b9711-ab0c-474a-a7f0-a18e233b291c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa21d8f4-dd0c-4ff8-a043-942809e8bf61
          stepCounter: 74560848-6964-491e-9f86-9d99fcb1f372
        config: {}
        dataType: 'INTEGER '
        defaultValue: ""
        description: s_theatre_visit_diagnosis_procedure.modify_user_login_code=dim_modify_user_login.modify_user_login_code
        name: DIM_MODIFY_USER_LOGIN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ceaa34a6-dd0b-40fb-bc61-9df93cc05e7b
                stepCounter: bef0768d-dddb-4d02-af8d-03160de42b62
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e467b333-fc59-4760-9d5b-db2261c58cde
          stepCounter: 74560848-6964-491e-9f86-9d99fcb1f372
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_referral_30.modify_user_login_code=dim_modify_user_login.modify_user_login_code
        name: OUTPATIENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '1'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3eca32c-9a2e-4e19-a1de-e388379bf00e
          stepCounter: 74560848-6964-491e-9f86-9d99fcb1f372
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_PIMS_SCHEDULES
        join:
          joinCondition: |-
            FROM ds_pims_schedules
             INNER JOIN ds_pims_diagnosis_procedures
                ON ds_pims_diagnosis_procedures.sorce_refno = ds_pims_schedules.schdl_refno
               AND ds_pims_diagnosis_procedures.sorce_code = 'SCHDL' -------comment this code to populate full load ----  inner join s_shared_schedule_theatre_05  on s_shared_schedule_theatre_05.patient_reference_no = ds_pims_diagnosis_procedures.patnt_refno  ---------------------------------------    LEFT OUTER JOIN ds_pims_reference_values ds_pims_reference_values1     ON ds_pims_reference_values1.rfval_refno = ds_pims_diagnosis_procedures.mplev_refno       LEFT OUTER JOIN ds_pims_reference_values ds_pims_reference_values2     ON ds_pims_reference_values2.rfval_refno = ds_pims_diagnosis_procedures.cptyp_refno        LEFT OUTER JOIN ds_pims_reference_values ds_pims_reference_values3     ON ds_pims_reference_values3.main_code = ds_pims_diagnosis_procedures.CCSXT_Code     AND ds_pims_reference_values3.rfvdm_code = 'CCSXT'      WHERE ds_pims_schedules.sctyp_refno = 200122 --'THEAT'
        name: S_THEATRE_VISIT_DIAGNOSIS_PROCEDURE
        noLinkRefs: []
  name: S_THEATRE_VISIT_DIAGNOSIS_PROCEDURE
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
