fileVersion: 1
id: 83afafa7-1a83-4091-b54b-834fcd1db1fc
name: DIM_MOH_PATIENT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42721219-e6bb-4c0c-9510-ba532bae967c
          stepCounter: 83afafa7-1a83-4091-b54b-834fcd1db1fc
        config: {}
        dataType: INTEGER IDENTITY(1,1)
        defaultValue: ""
        description: Generated artificial key
        isSurrogateKey: true
        name: DIM_MOH_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c16ceb81-ea2a-4ea2-8385-fc709fb800b8
          stepCounter: 83afafa7-1a83-4091-b54b-834fcd1db1fc
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: PATIENT_NHI
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1289ee09-41aa-46f0-b640-3d9df79e8d0d
                stepCounter: 0d806481-eb0f-4fe5-b0ca-cda5c87eeda2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 886565dc-fc99-4926-b6cc-4783ff455351
          stepCounter: 83afafa7-1a83-4091-b54b-834fcd1db1fc
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SECONDARY_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c2906e8-4d96-4b54-b2fb-4503206c2f61
                stepCounter: 0d806481-eb0f-4fe5-b0ca-cda5c87eeda2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f1df8f72-64b6-4ad6-91bd-7deacd770c8c
          stepCounter: 83afafa7-1a83-4091-b54b-834fcd1db1fc
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: GENDER_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e0728ff0-79dc-42f8-b93a-82628ef7197e
                stepCounter: 0d806481-eb0f-4fe5-b0ca-cda5c87eeda2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 156fba9f-8e7d-4a74-b886-a0e6e914e619
          stepCounter: 83afafa7-1a83-4091-b54b-834fcd1db1fc
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: DATE_OF_BIRTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8a803eb6-52eb-4862-94d0-079028311449
                stepCounter: 0d806481-eb0f-4fe5-b0ca-cda5c87eeda2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7194aacf-d895-4f77-b5e6-c476f96456a6
          stepCounter: 83afafa7-1a83-4091-b54b-834fcd1db1fc
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: NZ_RESIDENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c2a92cda-5c8b-46c1-95d0-4b40408fe530
                stepCounter: 0d806481-eb0f-4fe5-b0ca-cda5c87eeda2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 08210d6d-608c-44ee-8ec2-530754feb3cd
          stepCounter: 83afafa7-1a83-4091-b54b-834fcd1db1fc
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: ETHNIC_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f565a97-86b2-4e14-80c4-a8893d16f1af
                stepCounter: 0d806481-eb0f-4fe5-b0ca-cda5c87eeda2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77e3ba59-c68f-448f-94df-53b6807d3888
          stepCounter: 83afafa7-1a83-4091-b54b-834fcd1db1fc
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: ETHNIC_CODE_2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7da44e0-dcdf-4492-b425-8add3505fdec
                stepCounter: 0d806481-eb0f-4fe5-b0ca-cda5c87eeda2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b39859ac-a0df-49a7-9e3d-b19d49cf788e
          stepCounter: 83afafa7-1a83-4091-b54b-834fcd1db1fc
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: ETHNIC_CODE_3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6562007c-c2b1-4fae-b547-b13dc0d25936
                stepCounter: 0d806481-eb0f-4fe5-b0ca-cda5c87eeda2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 189ec9f8-2f03-4314-9b5e-5ba43297de4f
          stepCounter: 83afafa7-1a83-4091-b54b-834fcd1db1fc
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: PRIORITISED_ETHNIC_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3216709d-7096-4379-8244-41e15564cea6
                stepCounter: 0d806481-eb0f-4fe5-b0ca-cda5c87eeda2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d32c3350-56d8-4ef0-a5dd-cdd6d1cf3b19
          stepCounter: 83afafa7-1a83-4091-b54b-834fcd1db1fc
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: OCCUPATION_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cf76d779-2a90-4bd0-b013-b8d9854bdaac
                stepCounter: 0d806481-eb0f-4fe5-b0ca-cda5c87eeda2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 336aff03-72f5-431a-aee1-60f7d50f0c28
          stepCounter: 83afafa7-1a83-4091-b54b-834fcd1db1fc
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: OCCUPATION_FREE_TEXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf2acc58-06bf-4a5c-aeef-56a0d151bc7b
                stepCounter: 0d806481-eb0f-4fe5-b0ca-cda5c87eeda2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ff24da0-d2fc-4640-b539-e74f2438822e
          stepCounter: 83afafa7-1a83-4091-b54b-834fcd1db1fc
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_MOH_PATIENT: 0d806481-eb0f-4fe5-b0ca-cda5c87eeda2
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_MOH_PATIENT
        join:
          joinCondition: |-
            FROM {{ ref('TGT','S_MOH_PATIENT') }} s_MOH_patient
             WHERE row_num = 1 -- Most recent row for each NHI
        name: DIM_MOH_PATIENT
        noLinkRefs: []
  name: DIM_MOH_PATIENT
  overrideSQL: false
  schema: ""
  sqlType: Dimension
  type: sql
  version: 1
type: Node
