fileVersion: 1
id: 20278c81-1956-42de-b78b-0cc943c5de59
name: S_PATIENT_CONSOLIDATION_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3675ce4-ab84-4833-9218-b775adbb0a44
          stepCounter: 20278c81-1956-42de-b78b-0cc943c5de59
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 28dbde4a-fef6-4246-9991-2f476671ff8c
                stepCounter: df9ea28f-65df-42d4-a6db-0f86dc5cfb39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d32ef020-0b04-4040-8532-6ca0310d3a2c
          stepCounter: 20278c81-1956-42de-b78b-0cc943c5de59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9962a01b-5f3d-4c1a-b371-997edef38d0f
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: IFNULL(dim_patient.dim_patient_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bcbec988-3cbb-4c43-b519-6e1f1463ffc6
          stepCounter: 20278c81-1956-42de-b78b-0cc943c5de59
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e0caacdd-61bd-4ec8-b88a-f7ef2dcac6af
                stepCounter: df9ea28f-65df-42d4-a6db-0f86dc5cfb39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6373091-5091-49c4-b15f-836720400b39
          stepCounter: 20278c81-1956-42de-b78b-0cc943c5de59
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FUNDED_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e15cede3-4a2f-484b-ae03-206bb956e5ae
                stepCounter: df9ea28f-65df-42d4-a6db-0f86dc5cfb39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8dbda32-eace-4b8b-94fe-acb9db227c5a
          stepCounter: 20278c81-1956-42de-b78b-0cc943c5de59
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1fd8e56-5369-49ea-9bc5-b2d05f16b15c
                stepCounter: df9ea28f-65df-42d4-a6db-0f86dc5cfb39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c248d9cd-e30f-47f4-bf04-6269fb85f5a4
          stepCounter: 20278c81-1956-42de-b78b-0cc943c5de59
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1783059-26de-492e-8e1b-290acb37e1bc
                stepCounter: df9ea28f-65df-42d4-a6db-0f86dc5cfb39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b3a7cd7-12ce-4a82-80a2-eb5158c936b9
          stepCounter: 20278c81-1956-42de-b78b-0cc943c5de59
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: START_DATE_ONLY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4c7e07a-08d4-4a7d-b846-02cd8142a5f9
                stepCounter: df9ea28f-65df-42d4-a6db-0f86dc5cfb39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38782d7a-b1d0-4e47-9f86-ce1bb40a3dbf
          stepCounter: 20278c81-1956-42de-b78b-0cc943c5de59
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: END_DATE_ONLY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c428eaa5-546e-4368-87b4-c946925fdcdd
                stepCounter: df9ea28f-65df-42d4-a6db-0f86dc5cfb39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bc5b522c-77e8-47ed-a305-4b3a92f94bf5
          stepCounter: 20278c81-1956-42de-b78b-0cc943c5de59
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 40208e60-b581-48bd-a051-36fa6fd6bcd4
                stepCounter: df9ea28f-65df-42d4-a6db-0f86dc5cfb39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f9522b9-b43a-45ff-bc9b-83ddcc9257ab
          stepCounter: 20278c81-1956-42de-b78b-0cc943c5de59
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: WAITLIST_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 61b0789c-8559-460c-b4bf-834c95d42917
                stepCounter: df9ea28f-65df-42d4-a6db-0f86dc5cfb39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21ba2185-b7c9-4400-aef1-62636c50b98f
          stepCounter: 20278c81-1956-42de-b78b-0cc943c5de59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_patient_consolidation_10.specialty_code=dim_MOH_health_specialty.health_specialty_code
        name: DIM_MOH_HEALTH_SPECIALTY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4d7df87-2df3-4b57-8f52-ed903baa503c
                stepCounter: ee36cf91-4a1a-41fe-bd9f-1a939711cdc0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f70f3d01-4afe-4872-a872-c632263875d2
          stepCounter: 20278c81-1956-42de-b78b-0cc943c5de59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DIM_MOH_FACILITY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 761d48f1-aa04-4e5a-b03c-2039350337cd
                stepCounter: c4cdadfb-e6b3-4a34-a7fa-90dba7f7b082
            transform: IFNULL(dim_MOH_facility.dim_MOH_facility_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 021318b5-d3ee-4225-93a2-419a9855e9c6
          stepCounter: 20278c81-1956-42de-b78b-0cc943c5de59
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: HOSPITAL_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e9ca820-28d6-4a61-9785-de68a54e3e8f
                stepCounter: df9ea28f-65df-42d4-a6db-0f86dc5cfb39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 823906db-8ca0-4980-979e-c1df60e7b04a
          stepCounter: 20278c81-1956-42de-b78b-0cc943c5de59
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: DIM_PURCHASE_UNIT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dfb729e0-453e-4042-a70b-e8e17db7038f
                stepCounter: df9ea28f-65df-42d4-a6db-0f86dc5cfb39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8fdd675e-065c-480d-a494-6abfa528fb1f
          stepCounter: 20278c81-1956-42de-b78b-0cc943c5de59
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d8c2902-8830-4eb7-a775-48ec7996f0f3
                stepCounter: df9ea28f-65df-42d4-a6db-0f86dc5cfb39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2ee492c-c72a-4571-9f30-0f6f45699ddb
          stepCounter: 20278c81-1956-42de-b78b-0cc943c5de59
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: PATIENT_TYPE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8001293a-1679-4807-b8cf-67cf8a541ad4
                stepCounter: df9ea28f-65df-42d4-a6db-0f86dc5cfb39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa39c98f-8a6d-4e36-8364-6ce4a0b12eca
          stepCounter: 20278c81-1956-42de-b78b-0cc943c5de59
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8baf84d5-899a-4151-835c-cb92133f8063
                stepCounter: df9ea28f-65df-42d4-a6db-0f86dc5cfb39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 85a85e80-a6c6-4a56-a433-7f903fa704e0
          stepCounter: 20278c81-1956-42de-b78b-0cc943c5de59
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_patient_consolidation_10.source=dim_patient_consolidation_source.consolidation_source
        name: DIM_PATIENT_CONSOLIDATION_SOURCE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 53c39351-4f72-4899-bcd5-6baa78cc14f0
                stepCounter: a3eea3d3-3a60-4cb0-836f-ffcaf83486da
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1cdf01d4-9c6b-41a8-9dc4-5228278f0258
          stepCounter: 20278c81-1956-42de-b78b-0cc943c5de59
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SOURCE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e3efdeb-a914-4e04-8da2-866661e3cb6b
                stepCounter: df9ea28f-65df-42d4-a6db-0f86dc5cfb39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b1b8e91-a034-4368-a0d3-93920121bd93
          stepCounter: 20278c81-1956-42de-b78b-0cc943c5de59
        config: {}
        dataType: BIT
        defaultValue: ""
        description: Was this a visit that has occured
        name: ATTENDED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 089ab10b-ed4a-4b82-b791-34501d49d1ce
                stepCounter: df9ea28f-65df-42d4-a6db-0f86dc5cfb39
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a793f48c-d00c-4e6f-ae64-571417227a11
          stepCounter: 20278c81-1956-42de-b78b-0cc943c5de59
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_PATIENT_CONSOLIDATION: df9ea28f-65df-42d4-a6db-0f86dc5cfb39
          DIM_PATIENT: d52dd438-7899-4242-9e38-539d2a1447df
          DIM_MOH_FACILITY: c4cdadfb-e6b3-4a34-a7fa-90dba7f7b082
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_PATIENT_CONSOLIDATION
          - locationName: TGT
            nodeName: DIM_PATIENT
          - locationName: TGT
            nodeName: DIM_MOH_FACILITY
        join:
          joinCondition: |-
            FROM {{ ref('TGT','S_PATIENT_CONSOLIDATION') }} s_patient_consolidation
              LEFT JOIN {{ ref('TGT','DIM_PATIENT') }} dim_patient
                ON s_patient_consolidation.patient_NHI = dim_patient.patient_NHI
               AND dim_patient.NHI_sequence = 1
              LEFT JOIN {{ ref('TGT','DIM_MOH_FACILITY') }} dim_MOH_facility
                ON s_patient_consolidation.hospital_id = dim_MOH_facility.facility_code
        name: S_PATIENT_CONSOLIDATION_10
        noLinkRefs: []
  name: S_PATIENT_CONSOLIDATION_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
