fileVersion: 1
id: 4eab76ba-7ed8-4976-a2a8-b2f9d2ba3cd5
name: S_THEATRE_IP_ENCOUNTER
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6bbdd630-7925-487c-9871-3daf2682aedf
          stepCounter: 4eab76ba-7ed8-4976-a2a8-b2f9d2ba3cd5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: rnth
        name: RNTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48e0d7a7-70d7-49bd-8604-6c08d643c52f
                stepCounter: 7087e09b-02da-461d-8d53-d191c657fed2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0119e5e8-c19f-4561-9ebd-c4b392993dd2
          stepCounter: 4eab76ba-7ed8-4976-a2a8-b2f9d2ba3cd5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: THEATRE_VISIT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a9ef6434-3c90-4512-a64e-35796b382005
                stepCounter: 7087e09b-02da-461d-8d53-d191c657fed2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9ad899a-02db-451e-9da1-16acf3035ba2
          stepCounter: 4eab76ba-7ed8-4976-a2a8-b2f9d2ba3cd5
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: IP_EVENT_ENCOUNTER_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a255f204-7771-4952-a19e-d47bc9ab32d9
                stepCounter: 9c497e95-bd86-4a4c-b8ef-b9733209a38b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17bbb2a5-b0f0-4e7b-beba-d58763285476
          stepCounter: 4eab76ba-7ed8-4976-a2a8-b2f9d2ba3cd5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6825eee5-05d1-4f53-8dfb-e90357cba8dc
                stepCounter: 7087e09b-02da-461d-8d53-d191c657fed2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0257f2c0-19e2-47ac-8b75-fc683e8b7a46
          stepCounter: 4eab76ba-7ed8-4976-a2a8-b2f9d2ba3cd5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: IP_STAY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bed568fe-6d8f-4b06-8287-0f73e9083e11
                stepCounter: 7087e09b-02da-461d-8d53-d191c657fed2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 545bf5a0-5457-47af-b805-ed1e4ae530f9
          stepCounter: 4eab76ba-7ed8-4976-a2a8-b2f9d2ba3cd5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: IP_WARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f1fd47c-3232-4d7d-98e5-d814c309e3a7
                stepCounter: 7087e09b-02da-461d-8d53-d191c657fed2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ded936c1-df5f-4112-846e-cee85f48a62d
          stepCounter: 4eab76ba-7ed8-4976-a2a8-b2f9d2ba3cd5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: IP_ADMISSION_METHOD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ae3cc14-fbbc-4ef7-b6f0-705963b943f0
                stepCounter: 7087e09b-02da-461d-8d53-d191c657fed2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ef1bdd0-1952-4001-9bfa-86b99f312c27
          stepCounter: 4eab76ba-7ed8-4976-a2a8-b2f9d2ba3cd5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: IP_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1f54d78-f295-4f31-8102-9f802977209c
                stepCounter: 7087e09b-02da-461d-8d53-d191c657fed2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a632a9dd-3c41-40e4-becd-352e30e4ae5e
          stepCounter: 4eab76ba-7ed8-4976-a2a8-b2f9d2ba3cd5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: IP_STAY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bb996e8a-d5d9-4f5d-aaf2-4d9c144b51bd
                stepCounter: 7087e09b-02da-461d-8d53-d191c657fed2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 192e4431-03c8-4d4b-8711-c53bf0e63f82
          stepCounter: 4eab76ba-7ed8-4976-a2a8-b2f9d2ba3cd5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: IP_STAY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84bfc060-7e14-4456-8eb8-6d63a4ee5a96
                stepCounter: 7087e09b-02da-461d-8d53-d191c657fed2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5bb07c33-9847-498f-b881-86c2a0f9c404
          stepCounter: 4eab76ba-7ed8-4976-a2a8-b2f9d2ba3cd5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: THEATRE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7838d04-e706-43cf-87d9-109b7a05c2dc
                stepCounter: 7087e09b-02da-461d-8d53-d191c657fed2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69e0c02f-5180-4502-b51e-ed1d6e837609
          stepCounter: 4eab76ba-7ed8-4976-a2a8-b2f9d2ba3cd5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: IP_STAY_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a6b32db7-f07e-4897-b01e-ababc0dfaca1
                stepCounter: 7087e09b-02da-461d-8d53-d191c657fed2
            transform: ROW_NUMBER() OVER (PARTITION BY theatre_visit_reference_no ORDER BY abs(DATEDIFF(MINUTE,IP_stay_start_date,THEATRE_DATE)) ASC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27284a5d-c222-400a-8cc6-8701fe0abbb1
          stepCounter: 4eab76ba-7ed8-4976-a2a8-b2f9d2ba3cd5
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ACC_CLAIM_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c53b389-b74c-4621-bb6b-1e873ed5d317
                stepCounter: 7087e09b-02da-461d-8d53-d191c657fed2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e45afe5-2927-4590-bc40-69c33e69cea7
          stepCounter: 4eab76ba-7ed8-4976-a2a8-b2f9d2ba3cd5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_THEATRE_IP_ENCOUNTER_V: 7087e09b-02da-461d-8d53-d191c657fed2
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_THEATRE_IP_ENCOUNTER_V
        join:
          joinCondition: FROM {{ ref('TGT','S_THEATRE_IP_ENCOUNTER_V') }}
        name: S_THEATRE_IP_ENCOUNTER
        noLinkRefs: []
  name: S_THEATRE_IP_ENCOUNTER
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
