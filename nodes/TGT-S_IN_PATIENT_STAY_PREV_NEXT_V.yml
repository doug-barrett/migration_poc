fileVersion: 1
id: 13865b20-f3fb-4ac9-9925-f919f95daf4a
name: S_IN_PATIENT_STAY_PREV_NEXT_V
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bbc04c24-dd17-4fd7-b5e9-5398edae460b
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_REFERENCE_NO
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cafc7a6d-c3f9-4208-8e6c-951e0be9e2e4
                stepCounter: 3574e047-03db-4aba-af69-06f8858b99cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ba4d1a4-d905-4ac5-91b8-14c37c9f7bd1
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6aa496c3-96ca-4dc0-b772-a92f509a3996
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e1ca368-690b-4719-98eb-6d768e4dec7c
                stepCounter: 3574e047-03db-4aba-af69-06f8858b99cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a89c4474-f413-4113-8b05-36284f2e539b
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2b1268ec-dbbe-4739-8ee2-b41617c17fbc
                stepCounter: 3574e047-03db-4aba-af69-06f8858b99cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 232d2613-7afb-4342-93c6-6c2c3073fc4e
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_STAY_SEQ_NUM
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c2d2fa9d-3a64-4562-9744-9ac898a1b57b
                stepCounter: 3574e047-03db-4aba-af69-06f8858b99cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 759d77d7-18f0-4f5a-8893-afc4a89b6bea
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CUR_STAY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0902932f-85ab-432f-b4c7-b4ba16e1672e
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CUR_STAY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b61474e-a4db-4976-a487-41f91a758fc2
                stepCounter: 3574e047-03db-4aba-af69-06f8858b99cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 534cc778-bbb0-4cf4-b96d-53027b9faa22
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CUR_STAY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 452bde5b-80ea-4630-80ea-516eda3c1ab9
                stepCounter: 3574e047-03db-4aba-af69-06f8858b99cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 886f1bfa-d4ec-4748-a4b3-466cf5e4e478
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: CUR_HEALTHCARE_PROFESSIONAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea8ab2cc-586a-4ce4-99c0-15e6562cc5ac
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CUR_HEALTHCARE_PROFESSIONAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d963f8bf-2e17-4a6b-aaa4-87371e6e7103
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: CUR_SERVICE_POINT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb65b24c-25a6-4eae-a92c-6248fa352ceb
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CUR_SERVICE_POINT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25711434-18d0-4f0c-9e34-5068d1eb4b72
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: CUR_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98ba6a23-6d9b-4c0b-bdd5-44f7409aff35
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CUR_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1730d78-91f1-4db9-8818-f798437109f9
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRV_STAY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f35c7139-8bab-4615-83ca-97f243d6abe1
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PRV_STAY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b61474e-a4db-4976-a487-41f91a758fc2
                stepCounter: 3574e047-03db-4aba-af69-06f8858b99cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0cc5b1cf-dc95-40f3-92a0-53003548ef1d
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PRV_STAY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 452bde5b-80ea-4630-80ea-516eda3c1ab9
                stepCounter: 3574e047-03db-4aba-af69-06f8858b99cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40ba1ca3-89c4-4abd-979d-b32d10d15f64
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PRV_HEALTHCARE_PROFESSIONAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8aac82d8-6d25-4f41-ba44-c9b7e4639bbf
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRV_HEALTHCARE_PROFESSIONAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c4bf101-a301-4a5e-9d25-617277a7fb64
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PRV_SERVICE_POINT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5548ba6-2a7e-4075-b22e-9d60947b8e03
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRV_SERVICE_POINT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c46fcf3-b25b-4425-8e76-874773d85b26
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PRV_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57b20b2d-9bb1-4c03-8d82-d571ab359449
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRV_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38d02b9d-d460-4f97-8389-3aef4722391e
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NXT_STAY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9068c035-5277-473f-be03-0ba3529b48c9
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NXT_STAY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b61474e-a4db-4976-a487-41f91a758fc2
                stepCounter: 3574e047-03db-4aba-af69-06f8858b99cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31364f22-6cdd-4e29-bd1e-8590ee274e4c
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: NXT_STAY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 452bde5b-80ea-4630-80ea-516eda3c1ab9
                stepCounter: 3574e047-03db-4aba-af69-06f8858b99cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d178bb0e-18e4-4b17-9ec1-ffd47d9cd5e9
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NXT_HEALTHCARE_PROFESSIONAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cfe48a51-4900-4505-aa63-296d47b5fc32
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NXT_HEALTHCARE_PROFESSIONAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed022b82-7083-4e22-b9e0-4637a7cca12f
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NXT_SERVICE_POINT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab213ce0-52e8-4cf7-9dfd-0f4a0b226f61
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NXT_SERVICE_POINT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5dc32e60-1a6d-4c88-abe9-a1c1143b4a09
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NXT_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f233693f-7440-4c0f-bd67-60da4577b552
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NXT_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a156c8e7-ca68-4c7f-bbc3-c1fc094d4d78
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FIRST_STAY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a16cd5dd-295e-4036-95f5-6078ea2def82
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_STAY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b61474e-a4db-4976-a487-41f91a758fc2
                stepCounter: 3574e047-03db-4aba-af69-06f8858b99cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6482345-6ac1-4c5d-8a77-844476288c3a
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_STAY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 452bde5b-80ea-4630-80ea-516eda3c1ab9
                stepCounter: 3574e047-03db-4aba-af69-06f8858b99cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e1d7ee0-0017-4fd7-82eb-2bfb9b8a19e5
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FIRST_HEALTHCARE_PROFESSIONAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 43a62410-5e43-4209-8415-6c6fe7d838ff
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FIRST_HEALTHCARE_PROFESSIONAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a20c3a79-e55a-477a-bc9b-fd45cb5bea84
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FIRST_SERVICE_POINT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0dd607bd-f3d5-42b4-943f-d1425fed5766
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FIRST_SERVICE_POINT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac052b48-c084-409a-b520-dfdc5f182a67
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FIRST_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b2aa1843-a212-44ab-8618-4e53db77947e
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FIRST_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ffc4a26f-b083-484f-9844-3eb1cc78459b
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LAST_STAY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b52b75e-9d4d-4e35-bc01-036880171568
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_STAY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b61474e-a4db-4976-a487-41f91a758fc2
                stepCounter: 3574e047-03db-4aba-af69-06f8858b99cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e330af2-7c4b-4f05-9a38-48e843084d3c
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_STAY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 452bde5b-80ea-4630-80ea-516eda3c1ab9
                stepCounter: 3574e047-03db-4aba-af69-06f8858b99cd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 219dfff9-f627-4920-9956-1b71cbb8f706
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LAST_HEALTHCARE_PROFESSIONAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 254bd4ce-b143-4279-a12b-ac8f010606fc
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LAST_HEALTHCARE_PROFESSIONAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 667b3f75-d384-4aac-9d98-201529ac3733
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LAST_SERVICE_POINT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5523c54-a374-44cc-a8f3-109bc1d275ae
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LAST_SERVICE_POINT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf802019-028e-407a-b343-8f9f1c893249
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: LAST_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3787794e-88ec-45ef-917d-2775e2c15f2b
          stepCounter: 13865b20-f3fb-4ac9-9925-f919f95daf4a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: LAST_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            SELECT cur.stay_patnt_refno patient_reference_no,
                   cur.patient_NHI patient_NHI,
                   cur.prvsp_refno event_reference_no,
                   cur.event_encounter_id event_encounter_id,
                   cur.event_stay_seq_num event_stay_seq_num,
                   cur.sstay_refno cur_stay_reference_no,
                   cur.stay_start_date cur_stay_start_date,
                   cur.stay_end_date cur_stay_end_date,
                   cur.stay_healthcare_professional_code cur_healthcare_professional_code,
                   cur.stay_proca_refno cur_healthcare_professional_reference_no,
                   cur.stay_service_point_code cur_service_point_code,
                   cur.stay_spont_refno cur_service_point_reference_no,
                   cur.event_health_specialty_code cur_specialty_code,
                   cur.event_spect_refno cur_specialty_reference_no,
                   prv.sstay_refno prv_stay_reference_no,
                   prv.stay_start_date prv_stay_start_date,
                   prv.stay_end_date prv_stay_end_date,
                   prv.stay_healthcare_professional_code prv_healthcare_professional_code,
                   prv.stay_proca_refno prv_healthcare_professional_reference_no,
                   prv.stay_service_point_code prv_service_point_code,
                   prv.stay_spont_refno prv_service_point_reference_no,
                   prv.event_health_specialty_code prv_specialty_code,
                   prv.event_spect_refno prv_specialty_reference_no,
                   nxt.sstay_refno nxt_stay_reference_no,
                   nxt.stay_start_date nxt_stay_start_date,
                   nxt.stay_end_date nxt_stay_end_date,
                   nxt.stay_healthcare_professional_code nxt_healthcare_professional_code,
                   nxt.stay_proca_refno nxt_healthcare_professional_reference_no,
                   nxt.stay_service_point_code nxt_service_point_code,
                   nxt.stay_spont_refno nxt_service_point_reference_no,
                   nxt.event_health_specialty_code nxt_specialty_code,
                   nxt.event_spect_refno nxt_specialty_reference_no,
                   fst.sstay_refno first_stay_reference_no,
                   fst.stay_start_date first_stay_start_date,
                   fst.stay_end_date first_stay_end_date,
                   fst.stay_healthcare_professional_code first_healthcare_professional_code,
                   fst.stay_proca_refno first_healthcare_professional_reference_no,
                   fst.stay_service_point_code first_service_point_code,
                   fst.stay_spont_refno first_service_point_reference_no,
                   fst.event_health_specialty_code first_specialty_code,
                   fst.event_spect_refno first_specialty_reference_no,
                   lst.sstay_refno last_stay_reference_no,
                   lst.stay_start_date last_stay_start_date,
                   lst.stay_end_date last_stay_end_date,
                   lst.stay_healthcare_professional_code last_healthcare_professional_code,
                   lst.stay_proca_refno last_healthcare_professional_reference_no,
                   lst.stay_service_point_code last_service_point_code,
                   lst.stay_spont_refno last_service_point_reference_no,
                   lst.event_health_specialty_code last_specialty_code,
                   lst.event_spect_refno last_specialty_reference_no
              FROM ds_shared_inpatient_stay cur
              LEFT OUTER JOIN ds_shared_inpatient_stay prv
                ON prv.prvsp_refno = cur.prvsp_refno
               AND prv.event_stay_seq_num = cur.event_stay_seq_num - 1
              LEFT OUTER JOIN ds_shared_inpatient_stay nxt
                ON nxt.prvsp_refno = cur.prvsp_refno
               AND nxt.event_stay_seq_num = cur.event_stay_seq_num + 1
              LEFT OUTER JOIN ds_shared_inpatient_stay fst
                ON fst.prvsp_refno = cur.prvsp_refno
               AND fst.event_stay_seq_num = 1
              LEFT OUTER JOIN ds_shared_inpatient_stay lst
                ON lst.prvsp_refno = cur.prvsp_refno
               AND lst.event_stay_seq_num = lst.event_stay_count
        dependencies:
          - locationName: TGT
            nodeName: DS_SHARED_INPATIENT_STAY
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TGT','DS_SHARED_INPATIENT_STAY') }}
        name: S_IN_PATIENT_STAY_PREV_NEXT_V
        noLinkRefs: []
  name: S_IN_PATIENT_STAY_PREV_NEXT_V
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
