fileVersion: 1
id: 0bc007f1-702d-40d2-8560-3969ac9a3798
name: S_EVITALS_ADMISSION_CHECK_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Group the form item rows for each Admittance Check List form (form_code = ADMCHKLST) into 1 row per form."
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 99554ed8-642b-4a35-a107-cff39f58ef2e
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f58abcc4-b66f-4cf5-8846-aad87d0100f1
                stepCounter: c1e0f526-d197-4a07-a7fc-86a7b5560d37
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 035ab457-9b9b-4c64-aea8-8d29a4e6bfec
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ADMISSION_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77ca8ea5-e9f6-4f89-b3c8-ea2abe78021b
                stepCounter: c1e0f526-d197-4a07-a7fc-86a7b5560d37
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 93964383-6862-4c8e-8cba-66c828fcc625
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMISSION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0a2a1061-14fd-48b4-94f8-ac2f9ca0bb8e
                stepCounter: c1e0f526-d197-4a07-a7fc-86a7b5560d37
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a758c19-1645-40e5-b614-9b73bcb1ca5b
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 71ac20c4-031b-4d38-becf-84c8a7167d10
                stepCounter: c1e0f526-d197-4a07-a7fc-86a7b5560d37
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b2598b2a-a631-4a9d-835d-bc28b5fc7d14
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: ""
        name: FORM_INSTANCE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e961b30-7660-4896-ab86-8161ffcc3b31
                stepCounter: c1e0f526-d197-4a07-a7fc-86a7b5560d37
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2bc6682-0a2f-4b66-b844-658ceeea042e
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_eVitals_form.form_definition_id=dim_eVitals_form.form_definition_id
        name: DIM_EVITALS_FORM_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c91f35e-c42c-4c26-b4da-c8ac9de247ee
                stepCounter: c1e0f526-d197-4a07-a7fc-86a7b5560d37
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc836262-605c-43eb-857d-71bc2ec44bde
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: INT
        defaultValue: ""
        description: s_eVitals_form.form_created_date=dim_form_created_date.form_created_date
        name: DIM_FORM_CREATED_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07f713fc-22a0-44a2-a579-a0b328f9bbf2
                stepCounter: c1e0f526-d197-4a07-a7fc-86a7b5560d37
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 65bb327b-d126-4229-99bd-802e7b14eaf0
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_eVitals_form.patient_reference_no=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33ca4635-0e49-4bcf-9492-885c130bf4a2
                stepCounter: c1e0f526-d197-4a07-a7fc-86a7b5560d37
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6a64a97-9b54-4659-a70c-0eb7c88d50c1
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: ""
        name: FORM_DEFINITION_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e20330ce-1cb6-467a-beb0-3cc0e3d7aa4a
                stepCounter: e80c53d8-6caa-491d-be7a-428dc8e68f53
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c38c3a36-004c-4cb8-bba7-a3d257bd686d
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: FORM_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 46bc904e-e335-476f-aeec-b290c8e258bd
                stepCounter: e80c53d8-6caa-491d-be7a-428dc8e68f53
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aba041f3-589d-4dbc-9eec-ec894aef8fa2
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Has the form been changed?
        name: IS_CHANGED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddc1ed36-8c8d-4a3c-8723-712dfaa69b8e
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: MAX(CASE WHEN control_label = 'isChanged' THEN entry_text ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aeea78c8-1c12-4c65-acac-35e5cb9ec99c
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: ID Bracelet Present?
        name: ID_BRACELET_PRESENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddc1ed36-8c8d-4a3c-8723-712dfaa69b8e
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: MAX(CASE WHEN control_label = 'idBraceletPresent' THEN CASE WHEN entry_text = 'Yes' THEN 1 ELSE 0 END ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fdfea706-1a45-4a7a-8329-2f140817afe2
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: ID Bracelet Correct?
        name: ID_BRACELET_CORRECT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddc1ed36-8c8d-4a3c-8723-712dfaa69b8e
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: MAX(CASE WHEN control_label = 'idBraceletCorrect' THEN CASE WHEN entry_text = 'Yes' THEN 1 ELSE 0 END ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f2cd6a2-6e50-46e5-be5e-45a01f688a64
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: ' Is name display or bedside handover appropriate?'
        name: IS_NAME_APPROPRIATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddc1ed36-8c8d-4a3c-8723-712dfaa69b8e
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: MAX(CASE WHEN control_label = 'isNameAppropriate' THEN CASE WHEN entry_text = 'Yes' THEN 1 ELSE 0 END ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6c72227-6888-4aab-8ef3-53b74e2b008c
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Emergency contact details correct?
        name: IS_EMY_CONTACT_CORRECT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddc1ed36-8c8d-4a3c-8723-712dfaa69b8e
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: MAX(CASE WHEN control_label = 'isEmyContactCorrect' THEN CASE WHEN entry_text = 'Yes' THEN 1 ELSE 0 END ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2bed65aa-1d2a-43c5-a5e8-ba85ef255be4
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Patient property disclaimer explained?
        name: PPD_EXPLAINED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddc1ed36-8c8d-4a3c-8723-712dfaa69b8e
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: MAX(CASE WHEN control_label = 'ppdExplained' THEN CASE WHEN entry_text = 'Yes' THEN 1 ELSE 0 END ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27de72f2-ba00-4f1f-a54c-80756adf8ace
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: False teeth required?
        name: FALSE_TEETH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddc1ed36-8c8d-4a3c-8723-712dfaa69b8e
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: MAX(CASE WHEN control_label = 'falseTeeth' THEN CASE WHEN entry_text = 'Yes' THEN 1 ELSE 0 END ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f5815c7-a665-423d-be30-5684b71e7cb7
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Are false teeth with the patient?
        name: FALSE_TEETH_WITH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddc1ed36-8c8d-4a3c-8723-712dfaa69b8e
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: MAX(CASE WHEN control_label = 'falseTeethWith' THEN CASE WHEN entry_text = 'Yes' THEN 1 ELSE 0 END ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab77cf16-4a65-4610-89f1-5c271b2b110d
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Patient's understanding of reason for admission is similar to the clinical reason?
        name: PT_USTD_ADM_REASON
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddc1ed36-8c8d-4a3c-8723-712dfaa69b8e
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: MAX(CASE WHEN control_label = 'ptUstdAdmReason' THEN CASE WHEN entry_text = 'Yes' THEN 1 ELSE 0 END ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39ceaef9-771f-48cc-bfdd-43a171bbaf5f
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Interpreter required?
        name: INTERPRETER_REQD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddc1ed36-8c8d-4a3c-8723-712dfaa69b8e
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: MAX(CASE WHEN control_label = 'interpreterRqd' THEN CASE WHEN entry_text = 'Yes' THEN 1 ELSE 0 END ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e095200b-b96b-4f6e-8b53-74b77071d7c9
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: Interpreter languages
        name: INTERPRETER_LANGUAGES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8348801a-2467-4c0f-b65a-31b7bbf051e4
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: IFNULL(MAX(CASE WHEN control_label = 'interpreterLanguages' THEN LEFT(entry_display_value, 50) ELSE NULL END), '')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f128ea73-7256-4601-8419-b548342ebcf6
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: Specify Language
        name: SPECIFY_LANGUAGE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8348801a-2467-4c0f-b65a-31b7bbf051e4
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: IFNULL(MAX(CASE WHEN control_label = 'specifyLanguage' THEN LEFT(entry_display_value, 50) ELSE NULL END), '')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff8cf7ab-a81a-422a-bf69-973f9e724a86
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Other communication impairment?
        name: COMM_IMPAIRMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddc1ed36-8c8d-4a3c-8723-712dfaa69b8e
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: MAX(CASE WHEN control_label = 'commImpairment' THEN CASE WHEN entry_text = 'Yes' THEN 1 ELSE 0 END ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 885f9d34-23a3-46fe-8819-af9839828a93
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Impairment?
        name: IMPAIRMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddc1ed36-8c8d-4a3c-8723-712dfaa69b8e
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: MAX(CASE WHEN control_label = 'Impairment' THEN CASE WHEN entry_text = '1' THEN 1 ELSE 0 END ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d188dc92-d988-4ba3-934b-217c04d1ce23
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Hearing Impaired?
        name: HEARING_IMPAIRED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d72b3e80-12b1-4247-9b65-dbcf9b9cc9ee
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: MAX(CASE WHEN control_label = 'hearingImpaired' THEN CONVERT(tinyint, entry_boolean) ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 83fe66c3-4128-4d17-a4de-db0bd3f281f0
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Hearing Aids Required?
        name: HEARING_AIDS_REQUIRED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddc1ed36-8c8d-4a3c-8723-712dfaa69b8e
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: MAX(CASE WHEN control_label = 'hearingAidsRequired' THEN CASE WHEN entry_text = 'Yes' THEN 1 ELSE 0 END ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc7b84a2-5f5d-4140-b352-f5033b1b8ce2
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Hearing Aid Present?
        name: HEARING_AID_PRESENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddc1ed36-8c8d-4a3c-8723-712dfaa69b8e
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: MAX(CASE WHEN control_label = 'hearingAidPresent' THEN CASE WHEN entry_text = 'Yes' THEN 1 ELSE 0 END ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31a1e21a-c944-4a51-82ec-65dcb7fa96c4
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Visually Impaired?
        name: VISUALLY_IMPAIRED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d72b3e80-12b1-4247-9b65-dbcf9b9cc9ee
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: MAX(CASE WHEN control_label = 'visuallyImpaired' THEN CONVERT(tinyint, entry_boolean) ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9bc8c0f-b766-4023-9377-f7443df91857
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Visual Aids Required?
        name: VISUAL_AIDS_REQUIRED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddc1ed36-8c8d-4a3c-8723-712dfaa69b8e
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: MAX(CASE WHEN control_label = 'visualAidsRequired' THEN CASE WHEN entry_text = 'Yes' THEN 1 ELSE 0 END ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3855aea7-6eb7-4431-8411-9ffbb1db408f
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Visual Aids Present?
        name: VISUAL_AIDS_PRESENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddc1ed36-8c8d-4a3c-8723-712dfaa69b8e
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: MAX(CASE WHEN control_label = 'visualAidsPresent' THEN CASE WHEN entry_text = 'Yes' THEN 1 ELSE 0 END ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 364547b2-a01d-471f-a1b2-3441bcdd5146
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Speech Impaired?
        name: SPEECH_IMPAIRED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d72b3e80-12b1-4247-9b65-dbcf9b9cc9ee
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: MAX(CASE WHEN control_label = 'speechImpaired' THEN CONVERT(tinyint, entry_boolean) ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d23fb376-87fa-432a-b575-5199c7ea9f3f
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Cognitively Impaired?
        name: COGNITIVELY_IMPAIRED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d72b3e80-12b1-4247-9b65-dbcf9b9cc9ee
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: MAX(CASE WHEN control_label = 'cognitivelyImpaired' THEN CONVERT(tinyint, entry_boolean) ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d25fd485-bd7a-490b-84f6-500d5798c792
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Other Impaired?
        name: OTHER_IMPAIRED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d72b3e80-12b1-4247-9b65-dbcf9b9cc9ee
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: MAX(CASE WHEN control_label = 'otherImpaired' THEN CONVERT(tinyint, entry_boolean) ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5460cc1-8e7c-4d47-9240-9d74b2d5bf6a
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: Specify Impairment
        name: SPECIFY_IMPAIRMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8348801a-2467-4c0f-b65a-31b7bbf051e4
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: IFNULL(MAX(CASE WHEN control_label = 'specifyImpairment' THEN LEFT(entry_display_value, 100) ELSE NULL END), '')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e572ba1b-2239-4478-b162-c9da683d316b
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Cultural or spiritual support services required?
        name: SUPPORT_SERVICES_REQD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8348801a-2467-4c0f-b65a-31b7bbf051e4
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: MAX(CASE WHEN control_label = 'supportServicesReq' THEN CASE WHEN entry_text = 'Yes' THEN 1 ELSE 0 END ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f05db197-2e00-4210-aabb-b520b9d12b96
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: Services required
        name: SERVICES_REQUIRED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8348801a-2467-4c0f-b65a-31b7bbf051e4
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: IFNULL(MAX(CASE WHEN control_label = 'servicesRequired' THEN LEFT(entry_display_value, 50) ELSE NULL END), '')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32eef1dd-fba2-49ba-b37e-3a392b88980f
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Ethnicity
        name: ETHNICITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8348801a-2467-4c0f-b65a-31b7bbf051e4
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: IFNULL(MAX(CASE WHEN control_label = 'ethnicity' THEN LEFT(entry_display_value, 20) ELSE NULL END), '')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0f77ca6-1d5e-40eb-83bd-53bec3006549
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Would this patient have a higher risk of harm if they fall?
        name: HAVE_HIGHER_RISK_HARM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8348801a-2467-4c0f-b65a-31b7bbf051e4
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: MAX(CASE WHEN control_label = 'haveHigherRiskOfHarm' THEN CASE WHEN entry_display_value = 'Yes' THEN 1 ELSE 0 END ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5bc92799-a15f-4789-b575-0f48d4118ec5
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Admitted post fall, or history of falls?
        name: ADMITTED_POST_FALL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8348801a-2467-4c0f-b65a-31b7bbf051e4
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: MAX(CASE WHEN control_label = 'admittedPostFall' THEN CASE WHEN entry_display_value = 'Yes' THEN 1 ELSE 0 END ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6512c1df-7247-4456-bf6a-69cf7c493c54
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Nursing concern of increased falls risk?
        name: INCREASED_FALLS_RISK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8348801a-2467-4c0f-b65a-31b7bbf051e4
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: MAX(CASE WHEN control_label = 'increasedFallsRisk' THEN CASE WHEN entry_display_value = 'Yes' THEN 1 ELSE 0 END ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9df4bce6-ca8a-4904-bedd-42baf187159c
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Is the patient mobile and independent?
        name: MOBILE_AND_INDEP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8348801a-2467-4c0f-b65a-31b7bbf051e4
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: MAX(CASE WHEN control_label = 'increasedFallsRisk' THEN CASE WHEN entry_display_value = 'Yes' THEN 1 ELSE 0 END ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 19a3e7b2-bdf1-48d5-9720-d15bcf0257ba
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Evidence of history of pressure injury?
        name: HISTORY_PRE_INJURY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8348801a-2467-4c0f-b65a-31b7bbf051e4
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: MAX(CASE WHEN control_label = 'historyOfPreInjury' THEN CASE WHEN entry_display_value = 'Yes' THEN 1 ELSE 0 END ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eaa63a48-2a6a-40e4-b7f0-8f202d2b32cc
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Evidence of poor nutrition or malnutrition?
        name: POOR_MALNUTRITION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8348801a-2467-4c0f-b65a-31b7bbf051e4
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: MAX(CASE WHEN control_label = 'poorOrMalNutrition' THEN CASE WHEN entry_display_value = 'Yes' THEN 1 ELSE 0 END ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4593f49e-b604-4b95-9ce0-35533e840903
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Limited mobility, bed bound or wheelchair dependent?
        name: LIMITED_MOBILITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8348801a-2467-4c0f-b65a-31b7bbf051e4
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: MAX(CASE WHEN control_label = 'limitedMobility' THEN CASE WHEN entry_display_value = 'Yes' THEN 1 ELSE 0 END ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a89e8325-244c-423f-b495-4152e3176e04
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Prolonged Theatre time > 6 hours or bedrest?
        name: PROLONGED_THEATRE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8348801a-2467-4c0f-b65a-31b7bbf051e4
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: MAX(CASE WHEN control_label = 'prolongedTheaTime' THEN CASE WHEN entry_display_value = 'Yes' THEN 1 ELSE 0 END ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8674b094-25c2-4c80-a250-0f37ed683e18
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Nursing clinical concern?
        name: CLINICAL_CONCERN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8348801a-2467-4c0f-b65a-31b7bbf051e4
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: MAX(CASE WHEN control_label = 'clinicalConcern' THEN CASE WHEN entry_display_value = 'Yes' THEN 1 ELSE 0 END ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 273e5820-cac3-49a9-85eb-0514034716c7
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: Delirium Screening
        name: DELIRIUM_SCREENING
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8348801a-2467-4c0f-b65a-31b7bbf051e4
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: IFNULL(MAX(CASE WHEN control_label = 'deliriumScreening' THEN LEFT(entry_display_value, 100) ELSE NULL END), '')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 35102ff6-697b-4d53-b0de-f58959e1642b
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: Delirium History
        name: DELIRIUM_HISTORY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8348801a-2467-4c0f-b65a-31b7bbf051e4
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: IFNULL(MAX(CASE WHEN control_label = 'deliriumHistory' THEN LEFT(entry_display_value, 100) ELSE NULL END), '')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aef38161-90b1-40ad-9d8c-31543ba48ee5
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Severe medical illness?
        name: SEVERE_MEDICAL_ILLNESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8348801a-2467-4c0f-b65a-31b7bbf051e4
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: MAX(CASE WHEN control_label = 'svrMedicalIllness' THEN CASE WHEN entry_display_value = 'Yes' THEN 1 ELSE 0 END ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8eebf02-05e7-4453-bb25-f9162ac24e08
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Surgical admission with general anaesthetic?
        name: SURGICAL_ADMISSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8348801a-2467-4c0f-b65a-31b7bbf051e4
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: MAX(CASE WHEN control_label = 'surgicalAdmission' THEN CASE WHEN entry_display_value = 'Yes' THEN 1 ELSE 0 END ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40d28b09-5c0c-4548-86b7-433278756e53
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Recent deterioration in function OR hospital admission within the last 3 months?
        name: PHYSICAL_FRAILTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8348801a-2467-4c0f-b65a-31b7bbf051e4
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: MAX(CASE WHEN control_label = 'physicalFrailty' THEN CASE WHEN entry_display_value = 'Yes' THEN 1 ELSE 0 END ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e4fe692b-c936-4299-b034-f06e74574ecf
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Identify polypharmacy (>= 6 regular medications).
        name: IDENTIFY_POLYPHARMACY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8348801a-2467-4c0f-b65a-31b7bbf051e4
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: MAX(CASE WHEN control_label = 'identifyPolypharmacy' THEN CASE WHEN entry_display_value = 'Yes' THEN 1 ELSE 0 END ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f8c5a71-888f-46f5-8ef9-5812c3b7f44e
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Lives in Rest home or Private hospital OR needs another person to help with ADLs
        name: REST_HOME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8348801a-2467-4c0f-b65a-31b7bbf051e4
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: MAX(CASE WHEN control_label = 'restHome' THEN CASE WHEN entry_display_value = 'Yes' THEN 1 ELSE 0 END ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 65682e2b-a6c7-487c-9344-f7626e8859d5
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Frailty Score
        name: FRAILTY_SCORE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddc1ed36-8c8d-4a3c-8723-712dfaa69b8e
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: MAX(CASE WHEN control_label = 'frailtyScore' THEN CONVERT(tinyint, NULLIF(entry_text, '')) ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07316373-31cd-44e0-a7db-7a7d6e5e7d73
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Total Score
        name: TOTAL_SCORE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddc1ed36-8c8d-4a3c-8723-712dfaa69b8e
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: IFNULL(MAX(CASE WHEN control_label = 'totalScore' THEN LEFT(entry_text, 20) ELSE NULL END), '')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 28351817-c185-433e-8c8f-1ff0ac12fd94
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: Patient Risk
        name: PATIENT_RISK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddc1ed36-8c8d-4a3c-8723-712dfaa69b8e
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: IFNULL(MAX(CASE WHEN control_label = 'patientRisk' THEN LEFT(entry_text, 50) ELSE NULL END), '')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 383af74f-3e17-4ec7-87a2-4dcaf95cbf70
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: PercentCompleted
        name: PERCENT_COMPLETED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddc1ed36-8c8d-4a3c-8723-712dfaa69b8e
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: MAX(CASE WHEN control_label = 'percentCompleted' THEN CONVERT(tinyint, NULLIF(entry_text, '')) ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03c972ac-ad9c-40b8-8ab3-3719798a1c37
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Schedule Morse Falls
        name: SCHEDULE_MORSE_FALLS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddc1ed36-8c8d-4a3c-8723-712dfaa69b8e
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: MAX(CASE WHEN control_label = 'scheduleMorseFalls' THEN CONVERT(tinyint, NULLIF(entry_text, '')) ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e51b0ed3-c527-44dd-9174-429d2af2b055
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Schedule Moving And H
        name: SCHEDULE_MOVING_AND_H
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddc1ed36-8c8d-4a3c-8723-712dfaa69b8e
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: MAX(CASE WHEN control_label = 'scheduleMovingAndH' THEN CONVERT(tinyint, NULLIF(entry_text, '')) ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf9a3d9c-3737-439a-b9a7-51882181f553
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Yes to any water low Qn
        name: YES_WATER_LOW_QN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddc1ed36-8c8d-4a3c-8723-712dfaa69b8e
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: MAX(CASE WHEN control_label = 'yesToAnyWaterlowQn' THEN CONVERT(tinyint, NULLIF(entry_text, '')) ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04f88172-6f1a-4756-9ebd-afdf868a1e45
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Schedule Must
        name: SCHEDULE_MUST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddc1ed36-8c8d-4a3c-8723-712dfaa69b8e
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: MAX(CASE WHEN control_label = 'scheduleMUST' THEN CONVERT(tinyint, NULLIF(entry_text, '')) ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b7ad712-3748-412b-8785-d795c82d5ab8
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: Version box
        name: VER_BOX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddc1ed36-8c8d-4a3c-8723-712dfaa69b8e
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: IFNULL(MAX(CASE WHEN control_label = 'ver_box' THEN LEFT(entry_text, 50) ELSE NULL END), '')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33dc7fcc-f0ad-414d-abd8-6834b6e91538
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: Version box2
        name: VER_BOX2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddc1ed36-8c8d-4a3c-8723-712dfaa69b8e
                stepCounter: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
            transform: IFNULL(MAX(CASE WHEN control_label = 'ver_box2' THEN LEFT(entry_text, 50) ELSE NULL END), '')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b5d85bc-3c96-43df-8da2-6a326760daf1
          stepCounter: 0bc007f1-702d-40d2-8560-3969ac9a3798
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          FACT_EVITALS_FORM: c1e0f526-d197-4a07-a7fc-86a7b5560d37
          DIM_EVITALS_FORM: e80c53d8-6caa-491d-be7a-428dc8e68f53
          FACT_EVITALS_FORM_ITEM: 99b1ceb2-561f-4117-9cd7-b5e8f04402fa
          DIM_EVITALS_FORM_ITEM: debfa89c-3f56-4fe8-bec0-e01d304d3b93
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: FACT_EVITALS_FORM
          - locationName: TGT
            nodeName: DIM_EVITALS_FORM
          - locationName: TGT
            nodeName: FACT_EVITALS_FORM_ITEM
          - locationName: TGT
            nodeName: DIM_EVITALS_FORM_ITEM
        join:
          joinCondition: |-
            FROM {{ ref('TGT','FACT_EVITALS_FORM') }}
              JOIN {{ ref('TGT','DIM_EVITALS_FORM') }}
                ON fact_eVitals_form.dim_eVitals_form_key = dim_eVitals_form.dim_eVitals_form_key
              JOIN {{ ref('TGT','FACT_EVITALS_FORM_ITEM') }}
                ON fact_eVitals_form.form_instance_id = fact_eVitals_form_item.form_instance_id
              JOIN {{ ref('TGT','DIM_EVITALS_FORM_ITEM') }}
                ON dim_eVitals_form_item.dim_eVitals_form_Item_key = fact_eVitals_form_item.dim_eVitals_form_Item_key
             WHERE dim_eVitals_form.form_code ='ADMCHKLST'
               AND fact_eVitals_form_item.entry_display_value <> 'missing'
             GROUP BY fact_eVitals_form.patient_nhi,
                      fact_eVitals_form.admission_id,
                      fact_eVitals_form.admission_date,
                      fact_eVitals_form.encounter_id,
                      fact_eVitals_form.form_instance_id,
                      fact_eVitals_form.dim_eVitals_form_key,
                      fact_eVitals_form.dim_form_created_date_key,
                      fact_eVitals_form.dim_patient_key,
                      dim_eVitals_form.form_definition_id,
                      dim_eVitals_form.form_code
        name: S_EVITALS_ADMISSION_CHECK_10
        noLinkRefs: []
  name: S_EVITALS_ADMISSION_CHECK_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
