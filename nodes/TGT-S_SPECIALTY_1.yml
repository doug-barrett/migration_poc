fileVersion: 1
id: 19f323a9-95a3-4efc-bdc1-7adc75cffc2a
name: S_SPECIALTY_1
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Stage table for specialty dimension."
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e4febab-caeb-4425-a0d4-656eedb5f215
          stepCounter: 19f323a9-95a3-4efc-bdc1-7adc75cffc2a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: PIMS Speciality Reference Number
        name: SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 819c41d7-96ae-4a82-8767-97972861b562
                stepCounter: ac3ba691-d98e-4eaf-90fd-8ead76242a08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fcc290ff-7879-470f-a848-5c672a66fc0d
          stepCounter: 19f323a9-95a3-4efc-bdc1-7adc75cffc2a
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Speciality Parent Reference Number
        name: SPECIALTY_PARENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 29da3fe2-fff2-4fb5-955b-50ec3103b0c9
                stepCounter: ac3ba691-d98e-4eaf-90fd-8ead76242a08
            transform: IFNULL(ds_pims_specialties.parnt_refno,1)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5556b11e-e766-408d-96ad-57ffc0017750
          stepCounter: 19f323a9-95a3-4efc-bdc1-7adc75cffc2a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Specialty Group Code
        name: SPECIALTY_GROUP_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 508072cb-ab76-4cb2-8a95-2def2f9952e6
          stepCounter: 19f323a9-95a3-4efc-bdc1-7adc75cffc2a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Specialty Group Description
        name: SPECIALTY_GROUP_DESC
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d01fc75-bb65-45c4-876e-86bef4628fb2
          stepCounter: 19f323a9-95a3-4efc-bdc1-7adc75cffc2a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Specialty Code
        isBusinessKey: true
        name: SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 599a368d-d53f-4343-92c1-d52acc0f5b36
                stepCounter: ac3ba691-d98e-4eaf-90fd-8ead76242a08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f30e73cb-5314-4304-8d2d-6868029dd9f8
          stepCounter: 19f323a9-95a3-4efc-bdc1-7adc75cffc2a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Specialty Description
        name: SPECIALTY_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 915b6b35-ef51-4003-b4a1-28656fd210f5
                stepCounter: ac3ba691-d98e-4eaf-90fd-8ead76242a08
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 567bbd76-4341-4956-be24-c4e752cc1ea9
          stepCounter: 19f323a9-95a3-4efc-bdc1-7adc75cffc2a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Health Specialty Code
        name: HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eb9f10c2-27db-445e-baee-c136d6d85afd
                stepCounter: 810f0140-d555-4744-97b7-398fe4ee4d78
            transform: IFNULL(s_health_specialty_v.ministry_specialty_code, 'N/A')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d6fece1-60bc-4c94-8ff2-47552aeba4a8
          stepCounter: 19f323a9-95a3-4efc-bdc1-7adc75cffc2a
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Health Specialty Decription
        name: HEALTH_SPECIALTY_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 20733f97-a878-4d43-8c2d-83f489059bcf
                stepCounter: 810f0140-d555-4744-97b7-398fe4ee4d78
            transform: IFNULL(s_health_specialty_v.ministry_specialty_desc, 'N/A')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 996db6e1-b81c-4b9d-9921-d6d13465524f
          stepCounter: 19f323a9-95a3-4efc-bdc1-7adc75cffc2a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Specialty Referral Path e.g. GP Referred or EM Referred.
        name: SPECIALTY_REFERRAL_PATH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 599a368d-d53f-4343-92c1-d52acc0f5b36
                stepCounter: ac3ba691-d98e-4eaf-90fd-8ead76242a08
            transform: |-
              CASE WHEN ds_pims_specialties.main_ident IN ('EMERG','EMMED','INMED') THEN 'EM Referred'
                          ELSE 'GP Referred'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f727e7c-8d93-45a9-a7e7-4f2aa5a2d81d
          stepCounter: 19f323a9-95a3-4efc-bdc1-7adc75cffc2a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Division Code
        name: DIVISION_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fbb01e3b-4612-47c8-9a4a-5d6abddc60ef
                stepCounter: 06fa4241-360c-43d0-8e4a-8b860f92fc09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7c7c42b-96f2-4aa0-92e7-4cb106949a4e
          stepCounter: 19f323a9-95a3-4efc-bdc1-7adc75cffc2a
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: Division Description
        name: DIVISION_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 551f483d-a948-4558-87f8-d3e65fffac3c
                stepCounter: 06fa4241-360c-43d0-8e4a-8b860f92fc09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e1a8995-2c0f-4f4c-91c6-f62a1e99398b
          stepCounter: 19f323a9-95a3-4efc-bdc1-7adc75cffc2a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: RESPONSIBILITY_CENTRE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 31653941-437c-47a9-97af-e3701ad36706
                stepCounter: 0330d8b1-f44b-455f-a9e8-e4f0ae5f7251
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9d85547-5936-434c-b02b-86dbc05a4514
          stepCounter: 19f323a9-95a3-4efc-bdc1-7adc75cffc2a
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MANAGINGSERVICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7dad9bbf-4aac-43fc-ab7e-8b431a25e6fb
                stepCounter: 0330d8b1-f44b-455f-a9e8-e4f0ae5f7251
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69c52a4e-79bf-4dc0-830a-c11b6398d87f
          stepCounter: 19f323a9-95a3-4efc-bdc1-7adc75cffc2a
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ESPI1_INCLUSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa6a60fd-50a8-4fd8-ae2e-83ea19649e60
                stepCounter: 0330d8b1-f44b-455f-a9e8-e4f0ae5f7251
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d258ee3-e063-47ef-ba2d-7b65dcfc0e79
          stepCounter: 19f323a9-95a3-4efc-bdc1-7adc75cffc2a
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: NPF_INCLUSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cfcda8b2-56a2-45e1-95b8-e67f58f2cea7
                stepCounter: 0330d8b1-f44b-455f-a9e8-e4f0ae5f7251
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd7bcb02-234d-4af6-b013-305fb2f7684a
          stepCounter: 19f323a9-95a3-4efc-bdc1-7adc75cffc2a
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: OPERATIONS_MANAGER_EMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d52ae96-ad7c-4ab4-9f3a-052d972dabf2
                stepCounter: 0330d8b1-f44b-455f-a9e8-e4f0ae5f7251
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c31dafe3-b67f-41cc-9e94-c108581fe0e3
          stepCounter: 19f323a9-95a3-4efc-bdc1-7adc75cffc2a
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: INCUDE_WARD_IN_FEEDER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 660020d6-84ae-43b0-abf8-d3119f63e4a0
                stepCounter: 0330d8b1-f44b-455f-a9e8-e4f0ae5f7251
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 46340dc3-61d6-4a70-987d-5a30028f73b1
          stepCounter: 19f323a9-95a3-4efc-bdc1-7adc75cffc2a
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: EDS_INCLUSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 88da2452-bd42-44e1-8f25-d880201d8903
                stepCounter: 0330d8b1-f44b-455f-a9e8-e4f0ae5f7251
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d1442659-3e92-421c-b467-12da1ce99fc8
          stepCounter: 19f323a9-95a3-4efc-bdc1-7adc75cffc2a
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: ONLINE_BOOKABLE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf31f74a-e573-4908-b24c-21e0900b34ca
                stepCounter: 0330d8b1-f44b-455f-a9e8-e4f0ae5f7251
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b15ac9bd-2b21-40ac-b7b3-df18b3ceda52
          stepCounter: 19f323a9-95a3-4efc-bdc1-7adc75cffc2a
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: INCLUDE_IN_COSTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6a9b59a0-db9d-40aa-97c7-cf9c6d7c2294
                stepCounter: 0330d8b1-f44b-455f-a9e8-e4f0ae5f7251
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34f8a691-2d47-4b31-a1d7-d1c965ef5896
          stepCounter: 19f323a9-95a3-4efc-bdc1-7adc75cffc2a
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: INCLUDE_CLINICIAN_TYPE_ON_FEEDER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0fb71ea3-c15a-40f2-9ff8-3ef7ccb6acf7
                stepCounter: 0330d8b1-f44b-455f-a9e8-e4f0ae5f7251
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 68bb3f77-af5e-47f8-8ba8-f44503d6f82d
          stepCounter: 19f323a9-95a3-4efc-bdc1-7adc75cffc2a
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_PIMS_SPECIALTIES
        join:
          joinCondition: |-
            FROM ds_pims_specialties AS ds_pims_specialties
              LEFT OUTER JOIN ds_pims_reference_values AS ds_pims_reference_values
                ON ds_pims_specialties.divsn_refno = ds_pims_reference_values.rfval_refno -- AND getdate() BETWEEN l_pims_reference_values.start_dttm AND IFNULL(l_pims_reference_values.end_dttm,getdate())      LEFT OUTER JOIN s_health_specialty_v    ON ds_pims_specialties.spect_refno = s_health_specialty_v.specialty_reference_no      LEFT OUTER JOIN l_mappings_specialties    ON ds_pims_specialties.spect_refno = l_mappings_specialties.spect_refno
        name: S_SPECIALTY_1
        noLinkRefs: []
  name: S_SPECIALTY_1
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
