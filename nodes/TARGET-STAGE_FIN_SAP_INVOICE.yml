fileVersion: 1
id: 954007c1-7b7d-4e00-a6c7-2c7c1ec5f749
name: STAGE_FIN_SAP_INVOICE
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5accde9b-b3f3-49b4-ad7a-29d7f3c5aafa
          stepCounter: 954007c1-7b7d-4e00-a6c7-2c7c1ec5f749
        config: {}
        dataType: VARCHAR(28)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: INVOICE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79f3ea5e-39dd-4ed8-9908-a532fa5febd4
                stepCounter: a0af4353-38fe-4b99-9582-f996832a6066
            transform: "'0L'|| ODS_SAP_BKPF.BUKRS|| TO_CHAR(ODS_SAP_BKPF.GJAHR)|| ODS_SAP_BKPF.BELNR"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f8c1a6c-09f0-4d7a-a52e-c854f3c82087
          stepCounter: 954007c1-7b7d-4e00-a6c7-2c7c1ec5f749
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: BUSINESS_ASSOCIATE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3af692a8-544c-44fe-a05e-b7fcf28f5f26
                stepCounter: d310660d-8d8d-4155-898e-2bc2c935b749
            transform: DECODE(ODS_SAP_BKPF.BLART,'DR', ODS_SAP_ACDOCA.KUNNR, ODS_SAP_ACDOCA.LIFNR)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 699a8811-140a-4a23-9a6f-7af2667385c8
          stepCounter: 954007c1-7b7d-4e00-a6c7-2c7c1ec5f749
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Name of a person, place or thing.
        name: BUSINESS_ASSOCIATE_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 177eb5ab-d19c-4715-a520-b53c0bd876f5
                stepCounter: f1956d67-b19f-496a-b50d-7925505f8e66
            transform: DECODE(ODS_SAP_BKPF.BLART,'DR', ODS_SAP_KNA1.NAME1, ODS_SAP_LFA1.NAME1)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04c306c2-0e6f-4ff2-9aad-bf7f21796776
          stepCounter: 954007c1-7b7d-4e00-a6c7-2c7c1ec5f749
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: INVOICE_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 998f2127-dfb8-4dcd-ba2e-ebeda516d4d3
                stepCounter: a0af4353-38fe-4b99-9582-f996832a6066
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f44a103d-a338-4913-80fb-a66d0677b289
          stepCounter: 954007c1-7b7d-4e00-a6c7-2c7c1ec5f749
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: INVOICE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 537ef8b5-ba80-42d8-898e-69ef89c148cc
                stepCounter: a0af4353-38fe-4b99-9582-f996832a6066
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df6f05f1-8ce0-47d9-9409-5847d3f71d9c
          stepCounter: 954007c1-7b7d-4e00-a6c7-2c7c1ec5f749
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: The valid invoice type.
        name: INVOICE_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b46d5483-7c50-48a1-9fc6-0d103f2d094c
                stepCounter: a0af4353-38fe-4b99-9582-f996832a6066
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 938d41cf-081c-4eb1-9a96-58d7233b3e58
          stepCounter: 954007c1-7b7d-4e00-a6c7-2c7c1ec5f749
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: Invoice type description.
        name: INVOICE_TYPE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e7f66ba-ebd8-4e7b-832e-b49b98ef948f
                stepCounter: 0f52032b-04ab-4efe-83b9-5ac56fc37323
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b378069b-dfc6-4516-bd1f-3b53dc2de2fd
          stepCounter: 954007c1-7b7d-4e00-a6c7-2c7c1ec5f749
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: The major portion of the control account.
        name: CTRL_MAJOR_ACCT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31794a64-e11f-4434-afb7-d860ed3bc0a9
          stepCounter: 954007c1-7b7d-4e00-a6c7-2c7c1ec5f749
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: The minor portion of the control account.
        name: CTRL_MINOR_ACCT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7eb3cca2-6433-459d-b078-bf7895923ff9
          stepCounter: 954007c1-7b7d-4e00-a6c7-2c7c1ec5f749
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ACCOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ODS_SAP_BKPF: a0af4353-38fe-4b99-9582-f996832a6066
          ODS_SAP_ACDOCA: d310660d-8d8d-4155-898e-2bc2c935b749
          ODS_SAP_KNA1: f1956d67-b19f-496a-b50d-7925505f8e66
          ODS_SAP_LFA1: c892d32c-02e4-4fdf-aca9-68ceeac5eebc
          ODS_SAP_T003T: 0f52032b-04ab-4efe-83b9-5ac56fc37323
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: ODS_SAP_BKPF
          - locationName: TARGET
            nodeName: ODS_SAP_ACDOCA
          - locationName: TARGET
            nodeName: ODS_SAP_KNA1
          - locationName: TARGET
            nodeName: ODS_SAP_LFA1
          - locationName: TARGET
            nodeName: ODS_SAP_T003T
        join:
          joinCondition: |-
            FROM (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_BKPF') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) ODS_SAP_BKPF
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_ACDOCA') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                       AND DOCLN = '000001'
                       AND RLDNR = '0L'
                   ) ODS_SAP_ACDOCA
                ON ODS_SAP_BKPF.BELNR = ODS_SAP_ACDOCA.BELNR
               AND ODS_SAP_BKPF.GJAHR = ODS_SAP_ACDOCA.GJAHR
               AND ODS_SAP_BKPF.BUKRS = ODS_SAP_ACDOCA.RBUKRS
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_KNA1') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) ODS_SAP_KNA1
                ON ODS_SAP_ACDOCA.KUNNR = ODS_SAP_KNA1.KUNNR
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_LFA1') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) ODS_SAP_LFA1
                ON ODS_SAP_ACDOCA.LIFNR = ODS_SAP_LFA1.LIFNR
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_T003T') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) ODS_SAP_T003T
                ON ODS_SAP_BKPF.BLART = ODS_SAP_T003T.BLART
               AND ODS_SAP_T003T.SPRAS = 'E'
             WHERE ODS_SAP_BKPF.BLART IN ('DR','KR','RE','OI','X5')
        name: STAGE_FIN_SAP_INVOICE
        noLinkRefs: []
  name: STAGE_FIN_SAP_INVOICE
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
