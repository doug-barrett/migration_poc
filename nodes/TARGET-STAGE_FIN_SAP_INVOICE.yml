fileVersion: 1
id: 68766beb-e16c-4a47-b87a-b4ebd1b7bdcc
name: STAGE_FIN_SAP_INVOICE
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0ee6234-bde7-475f-943f-851967250324
          stepCounter: 68766beb-e16c-4a47-b87a-b4ebd1b7bdcc
        config: {}
        dataType: VARCHAR(28)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: INVOICE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8cc57426-4046-47f1-ad44-b68d4e134b40
                stepCounter: fcf862a8-1642-409e-b4fd-c9257fbc2f70
            transform: "'0L'|| ODS_SAP_BKPF.BUKRS|| TO_CHAR(ODS_SAP_BKPF.GJAHR)|| ODS_SAP_BKPF.BELNR"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df7d1e33-3482-4f9a-af3e-777c67a4367d
          stepCounter: 68766beb-e16c-4a47-b87a-b4ebd1b7bdcc
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: BUSINESS_ASSOCIATE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9eb1f86a-7594-4c78-946e-16459545159f
                stepCounter: 0f008214-d701-47dc-8dec-ed7f400b3d52
            transform: DECODE(ODS_SAP_BKPF.BLART,'DR', ODS_SAP_ACDOCA.KUNNR, ODS_SAP_ACDOCA.LIFNR)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8bf56c3e-ce3d-4b3d-add6-ba43b4d4e9d0
          stepCounter: 68766beb-e16c-4a47-b87a-b4ebd1b7bdcc
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Name of a person, place or thing.
        name: BUSINESS_ASSOCIATE_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9bea0829-74c2-41e7-8230-716ce4105484
                stepCounter: 1139a90b-49ca-49e4-a333-3b6a7d4b942e
            transform: DECODE(ODS_SAP_BKPF.BLART,'DR', ODS_SAP_KNA1.NAME1, ODS_SAP_LFA1.NAME1)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ca040de-4bf9-43d9-8875-af617a9f2cf3
          stepCounter: 68766beb-e16c-4a47-b87a-b4ebd1b7bdcc
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: INVOICE_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bb86c72e-cd74-481b-8966-277ce0085bc7
                stepCounter: fcf862a8-1642-409e-b4fd-c9257fbc2f70
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f3a7d57-3037-4c38-a7f9-f23703975e1f
          stepCounter: 68766beb-e16c-4a47-b87a-b4ebd1b7bdcc
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: INVOICE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bd6c5511-5449-4c86-83bf-2852a5569aa8
                stepCounter: fcf862a8-1642-409e-b4fd-c9257fbc2f70
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 924d70db-1384-4246-9a52-1f704b1075dd
          stepCounter: 68766beb-e16c-4a47-b87a-b4ebd1b7bdcc
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: The valid invoice type.
        name: INVOICE_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c76f778-fd4b-4bdd-a1e6-0cdc4d4cafc1
                stepCounter: fcf862a8-1642-409e-b4fd-c9257fbc2f70
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c0d1a07-50df-456b-ac86-6db38086e128
          stepCounter: 68766beb-e16c-4a47-b87a-b4ebd1b7bdcc
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: Invoice type description.
        name: INVOICE_TYPE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76e56353-b57d-4458-8536-d29760de2a8f
                stepCounter: 4028fe37-da02-44aa-a813-94986ad0de40
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7b47653-400d-43ac-8003-e7fad1be175a
          stepCounter: 68766beb-e16c-4a47-b87a-b4ebd1b7bdcc
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: The major portion of the control account.
        name: CTRL_MAJOR_ACCT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03ba5910-4449-447b-9671-d400c1179352
          stepCounter: 68766beb-e16c-4a47-b87a-b4ebd1b7bdcc
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: The minor portion of the control account.
        name: CTRL_MINOR_ACCT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9ca541a-4ef1-474d-8839-bdcaf9fd418d
          stepCounter: 68766beb-e16c-4a47-b87a-b4ebd1b7bdcc
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ACCOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: 'NULL'
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          ODS_SAP_BKPF: fcf862a8-1642-409e-b4fd-c9257fbc2f70
          ODS_SAP_ACDOCA: 0f008214-d701-47dc-8dec-ed7f400b3d52
          ODS_SAP_KNA1: 1139a90b-49ca-49e4-a333-3b6a7d4b942e
          ODS_SAP_LFA1: aed3197e-2665-4161-89ab-43340a510880
          ODS_SAP_T003T: 4028fe37-da02-44aa-a813-94986ad0de40
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET
            nodeName: ODS_SAP_BKPF
          - locationName: TARGET
            nodeName: ODS_SAP_ACDOCA
          - locationName: TARGET
            nodeName: ODS_SAP_KNA1
          - locationName: TARGET
            nodeName: ODS_SAP_LFA1
          - locationName: TARGET
            nodeName: ODS_SAP_T003T
        join:
          joinCondition: |-
            FROM (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_BKPF') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) ODS_SAP_BKPF
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_ACDOCA') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                       AND DOCLN = '000001'
                       AND RLDNR = '0L'
                   ) ODS_SAP_ACDOCA
                ON ODS_SAP_BKPF.BELNR = ODS_SAP_ACDOCA.BELNR
               AND ODS_SAP_BKPF.GJAHR = ODS_SAP_ACDOCA.GJAHR
               AND ODS_SAP_BKPF.BUKRS = ODS_SAP_ACDOCA.RBUKRS
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_KNA1') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) ODS_SAP_KNA1
                ON ODS_SAP_ACDOCA.KUNNR = ODS_SAP_KNA1.KUNNR
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_LFA1') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) ODS_SAP_LFA1
                ON ODS_SAP_ACDOCA.LIFNR = ODS_SAP_LFA1.LIFNR
              LEFT JOIN (
                    SELECT *
                      FROM {{ ref('TARGET','ODS_SAP_T003T') }}
                     WHERE DSS_CURRENT_FLAG = 'Y'
                       AND DSS_DELETE_FLAG != 'Y'
                   ) ODS_SAP_T003T
                ON ODS_SAP_BKPF.BLART = ODS_SAP_T003T.BLART
               AND ODS_SAP_T003T.SPRAS = 'E'
             WHERE ODS_SAP_BKPF.BLART IN ('DR','KR','RE','OI','X5')
        name: STAGE_FIN_SAP_INVOICE
        noLinkRefs: []
  name: STAGE_FIN_SAP_INVOICE
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
