fileVersion: 1
id: 315e6acd-e3a6-456e-a1f3-db27b77bc34a
name: VIEW_CSLAND_BA_DETAIL
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9af1a5c0-2944-462c-9ce1-54d9b73e8c1e
          stepCounter: 315e6acd-e3a6-456e-a1f3-db27b77bc34a
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2e9be332-00db-4db9-b562-c90dae70bada
                stepCounter: 195380c1-f588-4c27-9c13-2d48662dc985
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7580b712-f1fb-4fd8-8ab9-3a8d814be424
          stepCounter: 315e6acd-e3a6-456e-a1f3-db27b77bc34a
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: FILE_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f3632d3b-64d6-4137-828f-ad87aae9d135
                stepCounter: 195380c1-f588-4c27-9c13-2d48662dc985
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53296078-04e9-492f-9ddc-b394e8a783e2
          stepCounter: 315e6acd-e3a6-456e-a1f3-db27b77bc34a
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: FILE_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 12524cae-0e9d-4398-acf1-7b997f08777b
                stepCounter: a5a508cc-a0a9-4853-b905-9e530e5a62c5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 436376eb-318b-4417-984e-27c8f0896658
          stepCounter: 315e6acd-e3a6-456e-a1f3-db27b77bc34a
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: ALT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 57b675c4-a277-4d33-a811-a81d23da92bd
                stepCounter: 195380c1-f588-4c27-9c13-2d48662dc985
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6034f262-2489-4bff-97db-9472ca64e5ad
          stepCounter: 315e6acd-e3a6-456e-a1f3-db27b77bc34a
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7cdfc49f-aa22-4a4a-ad06-6a087f45b67d
                stepCounter: 195380c1-f588-4c27-9c13-2d48662dc985
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fda1cd0a-bdc4-4993-a036-b6527bf20dce
          stepCounter: 315e6acd-e3a6-456e-a1f3-db27b77bc34a
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: ADDRESS_LINE_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 216dc966-65e9-4b4a-aa8c-ca6adf8ed742
                stepCounter: 195380c1-f588-4c27-9c13-2d48662dc985
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8001ee9f-75d7-42d9-a777-9c8010ce0e09
          stepCounter: 315e6acd-e3a6-456e-a1f3-db27b77bc34a
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: ADDRESS_LINE_2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 54b2d8ec-ed20-4bf2-a051-e930ffe1123a
                stepCounter: 195380c1-f588-4c27-9c13-2d48662dc985
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3023e7e9-aeb3-4df2-b8d7-05330311b338
          stepCounter: 315e6acd-e3a6-456e-a1f3-db27b77bc34a
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: ADDRESS_LINE_3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef4eea4e-b045-4069-8049-9bab1d376981
                stepCounter: 195380c1-f588-4c27-9c13-2d48662dc985
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d76e825-4686-4013-bad1-67c4522b36fa
          stepCounter: 315e6acd-e3a6-456e-a1f3-db27b77bc34a
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: ADDRESS_LINE_4
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 58e79a52-51a5-442d-9341-d5e0febae506
                stepCounter: 195380c1-f588-4c27-9c13-2d48662dc985
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a944423-3703-415c-91da-ae13f4199172
          stepCounter: 315e6acd-e3a6-456e-a1f3-db27b77bc34a
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: ADDRESS_LINE_5
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 636a4cb3-78ff-49d3-b00e-03aab036c3b5
                stepCounter: 195380c1-f588-4c27-9c13-2d48662dc985
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2bde288-0570-43f6-acc5-a3f9c99cbdc5
          stepCounter: 315e6acd-e3a6-456e-a1f3-db27b77bc34a
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: SHORT_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 98f7ff1f-9e38-40d6-abc5-37b8bb284ffd
                stepCounter: 195380c1-f588-4c27-9c13-2d48662dc985
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f52273b9-b435-4401-bc31-e54ea3e15efa
          stepCounter: 315e6acd-e3a6-456e-a1f3-db27b77bc34a
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: CONTACT_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7a19404-2b79-4b6c-8d35-442acfb11303
                stepCounter: 195380c1-f588-4c27-9c13-2d48662dc985
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c26f20b-07b5-4dd4-ae8d-156c253877d6
          stepCounter: 315e6acd-e3a6-456e-a1f3-db27b77bc34a
        config: {}
        dataType: VARCHAR(12)
        defaultValue: ""
        description: ""
        name: PHONE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 750574c3-090a-4d8f-b89a-95474e80cdc6
                stepCounter: 195380c1-f588-4c27-9c13-2d48662dc985
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba8923b8-851a-47ae-98d0-2da145be57cb
          stepCounter: 315e6acd-e3a6-456e-a1f3-db27b77bc34a
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: E_MAIL_ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4dae5e4f-46e2-44ca-966b-c51a51fc9ff1
                stepCounter: 195380c1-f588-4c27-9c13-2d48662dc985
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0089b667-9d15-4c3c-9dd8-b6cf6cc882d2
          stepCounter: 315e6acd-e3a6-456e-a1f3-db27b77bc34a
        config: {}
        dataType: VARCHAR(12)
        defaultValue: ""
        description: ""
        name: FAX_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 515c684d-9788-4f75-b825-cc666b666b28
                stepCounter: 195380c1-f588-4c27-9c13-2d48662dc985
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c66173a-8d81-4346-8287-ec57bac7c8db
          stepCounter: 315e6acd-e3a6-456e-a1f3-db27b77bc34a
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: COMBINE_RENTAL_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3dfdd680-fad1-45fc-bb37-dd9e44609a68
                stepCounter: 195380c1-f588-4c27-9c13-2d48662dc985
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82a5d263-04a3-47ec-ab5e-b22b9c863c7c
          stepCounter: 315e6acd-e3a6-456e-a1f3-db27b77bc34a
        config: {}
        dataType: DECIMAL(9,2)
        defaultValue: ""
        description: ""
        name: MIN_CHEQUE_AMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ef8a6bf-e10e-4bf4-8f39-e11d929dab3f
                stepCounter: 195380c1-f588-4c27-9c13-2d48662dc985
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7745bbeb-1f6b-4c56-b6be-6cc320e68db0
          stepCounter: 315e6acd-e3a6-456e-a1f3-db27b77bc34a
        config: {}
        dataType: DECIMAL(9,2)
        defaultValue: ""
        description: ""
        name: BANK_FEE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: efdea99e-3885-4a8d-8ce0-c0d8409403cf
                stepCounter: 195380c1-f588-4c27-9c13-2d48662dc985
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a8a9635-ce9e-4fd9-9972-3c6b1e737cff
          stepCounter: 315e6acd-e3a6-456e-a1f3-db27b77bc34a
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: CURRENCY_COUNTRY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c3eefa19-7fde-4a30-a832-b9114e9e1bb1
                stepCounter: 195380c1-f588-4c27-9c13-2d48662dc985
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d38b2950-21a0-48ea-845b-a10a0e381ae6
          stepCounter: 315e6acd-e3a6-456e-a1f3-db27b77bc34a
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: CURRENCY_COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 451c50a4-a195-40de-afef-db8f230919a5
                stepCounter: 916e00f9-5802-478f-9515-3222783c0a20
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d94b3f6-a494-4c80-be80-52512bc67f93
          stepCounter: 315e6acd-e3a6-456e-a1f3-db27b77bc34a
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: WTAX_COUNTRY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3f4b80ab-94a6-44ec-b4ff-f3155d8d390e
                stepCounter: 195380c1-f588-4c27-9c13-2d48662dc985
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf8c50a5-c5b8-4e37-b00a-c50da8468062
          stepCounter: 315e6acd-e3a6-456e-a1f3-db27b77bc34a
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: WTAX_COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 451c50a4-a195-40de-afef-db8f230919a5
                stepCounter: 916e00f9-5802-478f-9515-3222783c0a20
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa5257d8-8f08-491e-aec9-ff0d3586ee96
          stepCounter: 315e6acd-e3a6-456e-a1f3-db27b77bc34a
        config: {}
        dataType: DECIMAL(11,8)
        defaultValue: ""
        description: ""
        name: WTAX_PERCENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 059bae65-0745-40b7-a146-4edc3f378997
                stepCounter: 916e00f9-5802-478f-9515-3222783c0a20
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c683d95-30cb-4974-b1ac-968de05a8775
          stepCounter: 315e6acd-e3a6-456e-a1f3-db27b77bc34a
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: GST_REG_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d6beae1b-9a62-4591-aa4e-c0462651b66a
                stepCounter: 195380c1-f588-4c27-9c13-2d48662dc985
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53f79b74-9bfc-4d3c-bcde-081cd89cbca4
          stepCounter: 315e6acd-e3a6-456e-a1f3-db27b77bc34a
        config: {}
        dataType: VARCHAR(245)
        defaultValue: ""
        description: ""
        name: LABEL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7cdfc49f-aa22-4a4a-ad06-6a087f45b67d
                stepCounter: 195380c1-f588-4c27-9c13-2d48662dc985
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_CSLAND_BA_DETAIL: 315e6acd-e3a6-456e-a1f3-db27b77bc34a
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_CSLAND_BA_DETAIL') }} AS SELECT BA.PRIMARY_KEY "CODE",
                   BA.FILE_STATUS "FILE_STATUS_CODE",
                   TB.DESCRIPTION "FILE_STATUS",
                   BA.ALTERNATE_CODE "ALT_CODE",
                   BA.NAME,
                   BA.ADDRESS_LINE_1,
                   BA.ADDRESS_LINE_2,
                   BA.ADDRESS_LINE_3,
                   BA.ADDRESS_LINE_4,
                   BA.ADDRESS_LINE_5,
                   BA.SHORT_NAME,
                   BA.CONTACT_NAME,
                   BA.PHONE_NUMBER,
                   BA.E_MAIL_ADDRESS,
                   BA.FAX_NUMBER,
                   BA.COMBINE_RENTAL "COMBINE_RENTAL_FLAG",
                   BA.MIN_CHEQUE_AMOUNT,
                   BA.BANK_FEE,
                   BA.CURRENCY_COUNTRY "CURRENCY_COUNTRY_CODE",
                   TC1.DESCRIPTION "CURRENCY_COUNTRY",
                   BA.WTAX_COUNTRY "WTAX_COUNTRY_CODE",
                   TC2.DESCRIPTION "WTAX_COUNTRY",
                   TC2.WTAX_PERCENT,
                   BA.GST_REG_NO,
                   BA.NAME || DECODE(TRIM(BA.ADDRESS_LINE_1), NULL, '', chr(10) || BA.ADDRESS_LINE_1) || DECODE(TRIM(BA.ADDRESS_LINE_2), NULL, '', chr(10) || BA.ADDRESS_LINE_2) || DECODE(TRIM(BA.ADDRESS_LINE_3), NULL, '', chr(10) || BA.ADDRESS_LINE_3) || DECODE(TRIM(BA.ADDRESS_LINE_4), NULL, '', chr(10) || BA.ADDRESS_LINE_4) || DECODE(TRIM(BA.ADDRESS_LINE_5), NULL, '', chr(10) || BA.ADDRESS_LINE_5) "LABEL"
              FROM DS_CSLAND.BA_TABLE BA,
                   DS_CSLAND.T_BFSTATUS TB,
                   DS_CSLAND.T_COUNTRY TC1,
                   DS_CSLAND.T_COUNTRY TC2
             WHERE BA.FILE_STATUS = TB.CODE(+)
               AND BA.CURRENCY_COUNTRY = TC1.CODE(+)
               AND BA.WTAX_COUNTRY = TC2.CODE(+)
        dependencies:
          - locationName: TARGET
            nodeName: ODS_CSLAND_BA_TABLE
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_CSLAND_BA_TABLE') }}
        name: VIEW_CSLAND_BA_DETAIL
        noLinkRefs: []
  name: VIEW_CSLAND_BA_DETAIL
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
