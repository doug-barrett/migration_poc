fileVersion: 1
id: 521848ad-19c4-4e42-abc8-976c69a05b63
name: VIEW_CSLAND_BA_DETAIL
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74c5db67-dc14-40e0-9f1f-de2a7f1ae3c6
          stepCounter: 521848ad-19c4-4e42-abc8-976c69a05b63
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7335ff9d-6453-45df-8556-32e959857f2a
                stepCounter: 17e8c098-2969-4300-91b0-b858f6d02add
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb69e2f0-338f-40b5-9214-613a773077dc
          stepCounter: 521848ad-19c4-4e42-abc8-976c69a05b63
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: FILE_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c607ff20-5b4e-4a26-8da2-438d1e70d1c7
                stepCounter: 17e8c098-2969-4300-91b0-b858f6d02add
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b7c051b-d3be-4d03-82db-15642ed35b47
          stepCounter: 521848ad-19c4-4e42-abc8-976c69a05b63
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: FILE_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b465c94-fd7a-4a64-838a-97eed25896e5
                stepCounter: 53331caf-affd-4e7a-b37d-c13927f93d19
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f13e193-6b9c-4075-99af-ca1e1f6d097d
          stepCounter: 521848ad-19c4-4e42-abc8-976c69a05b63
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: ALT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3521ab93-5391-4b45-a1ad-05e2880e46b8
                stepCounter: 17e8c098-2969-4300-91b0-b858f6d02add
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11174f46-c641-406c-b639-de17334fb72d
          stepCounter: 521848ad-19c4-4e42-abc8-976c69a05b63
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e973675-26ea-41fb-9f8f-450a5924d092
                stepCounter: 17e8c098-2969-4300-91b0-b858f6d02add
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f4a218f-35d4-4c08-b415-71cc114000f4
          stepCounter: 521848ad-19c4-4e42-abc8-976c69a05b63
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: ADDRESS_LINE_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4d63673d-01a9-4195-a98d-c2b1d8f3c29f
                stepCounter: 17e8c098-2969-4300-91b0-b858f6d02add
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3418c784-dbe6-4c80-945d-19b3be96b9f6
          stepCounter: 521848ad-19c4-4e42-abc8-976c69a05b63
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: ADDRESS_LINE_2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8a8ee6fc-87c6-46de-b97d-d5e4ee1cb38a
                stepCounter: 17e8c098-2969-4300-91b0-b858f6d02add
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bed4c15f-9ac2-4121-8866-bbe922e5c037
          stepCounter: 521848ad-19c4-4e42-abc8-976c69a05b63
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: ADDRESS_LINE_3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddfa1ab8-f677-4740-83bc-fe84c9158135
                stepCounter: 17e8c098-2969-4300-91b0-b858f6d02add
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4339b055-569f-4654-bcd5-ce03395d2791
          stepCounter: 521848ad-19c4-4e42-abc8-976c69a05b63
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: ADDRESS_LINE_4
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 14ee28ea-6067-4e6f-80c8-9506ee8d620b
                stepCounter: 17e8c098-2969-4300-91b0-b858f6d02add
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7aefda8-46a6-4357-bdbe-3c18e1fcf872
          stepCounter: 521848ad-19c4-4e42-abc8-976c69a05b63
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: ADDRESS_LINE_5
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c92d3b43-e2ee-4720-8fc0-65afbb7ec03d
                stepCounter: 17e8c098-2969-4300-91b0-b858f6d02add
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e60b3fd-bea2-41e1-b121-684ea997bb15
          stepCounter: 521848ad-19c4-4e42-abc8-976c69a05b63
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: SHORT_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2082a02e-d02a-4bdf-8b15-8d29ef6eedf2
                stepCounter: 17e8c098-2969-4300-91b0-b858f6d02add
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 63ef0bff-511f-471b-ab0b-19565cdd31f4
          stepCounter: 521848ad-19c4-4e42-abc8-976c69a05b63
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: CONTACT_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 125f379c-0c6f-4824-939f-ce7f6fc61756
                stepCounter: 17e8c098-2969-4300-91b0-b858f6d02add
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 62b1f868-18b6-408c-80a1-7a142905669f
          stepCounter: 521848ad-19c4-4e42-abc8-976c69a05b63
        config: {}
        dataType: VARCHAR(12)
        defaultValue: ""
        description: ""
        name: PHONE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 49855e06-7850-4b57-87c1-c4146470c9d4
                stepCounter: 17e8c098-2969-4300-91b0-b858f6d02add
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5266bf14-d6a0-4c32-bff3-f06b84df0eb7
          stepCounter: 521848ad-19c4-4e42-abc8-976c69a05b63
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: E_MAIL_ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a17847f-a60a-4bfa-a171-e51434580995
                stepCounter: 17e8c098-2969-4300-91b0-b858f6d02add
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f407474-0b5f-4832-9455-58466ffabc72
          stepCounter: 521848ad-19c4-4e42-abc8-976c69a05b63
        config: {}
        dataType: VARCHAR(12)
        defaultValue: ""
        description: ""
        name: FAX_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 85238110-cc19-494d-8c62-58ffbac983e2
                stepCounter: 17e8c098-2969-4300-91b0-b858f6d02add
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9010f6b-847e-4bdd-a2fa-127768a7edb9
          stepCounter: 521848ad-19c4-4e42-abc8-976c69a05b63
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: COMBINE_RENTAL_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e85614e2-8642-4784-a704-98ebc7e6b323
                stepCounter: 17e8c098-2969-4300-91b0-b858f6d02add
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a934368-1c51-4cd0-bb9b-b5a99a26ff02
          stepCounter: 521848ad-19c4-4e42-abc8-976c69a05b63
        config: {}
        dataType: DECIMAL(9,2)
        defaultValue: ""
        description: ""
        name: MIN_CHEQUE_AMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91e4c8cd-42c7-4498-9882-427145655bfa
                stepCounter: 17e8c098-2969-4300-91b0-b858f6d02add
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de8c5c36-1749-43e1-b00c-d2939515ea5a
          stepCounter: 521848ad-19c4-4e42-abc8-976c69a05b63
        config: {}
        dataType: DECIMAL(9,2)
        defaultValue: ""
        description: ""
        name: BANK_FEE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1fcc50f7-930a-47cb-ac11-bf514966126b
                stepCounter: 17e8c098-2969-4300-91b0-b858f6d02add
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6746a16e-509c-4ba9-a7b8-d8f61da1af85
          stepCounter: 521848ad-19c4-4e42-abc8-976c69a05b63
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: CURRENCY_COUNTRY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 559beaf2-8c07-4084-a7be-e745d4eb818f
                stepCounter: 17e8c098-2969-4300-91b0-b858f6d02add
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50f5396e-5b3b-4adb-8e19-a3d05aff7095
          stepCounter: 521848ad-19c4-4e42-abc8-976c69a05b63
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: CURRENCY_COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0fd304d4-f706-46e2-a999-efe1107a358d
                stepCounter: c61b83d7-ea2a-43a4-bff3-24036c9a6bc8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bec0542d-ed3b-49c0-99a5-34e0a715f266
          stepCounter: 521848ad-19c4-4e42-abc8-976c69a05b63
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: WTAX_COUNTRY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2f305f7-a0a3-4d75-870f-35aa307619b0
                stepCounter: 17e8c098-2969-4300-91b0-b858f6d02add
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 312d4bda-7dde-418c-ba92-dd1a9508920d
          stepCounter: 521848ad-19c4-4e42-abc8-976c69a05b63
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: WTAX_COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0fd304d4-f706-46e2-a999-efe1107a358d
                stepCounter: c61b83d7-ea2a-43a4-bff3-24036c9a6bc8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c989ebcc-a539-4ca9-9e83-fef174f9b112
          stepCounter: 521848ad-19c4-4e42-abc8-976c69a05b63
        config: {}
        dataType: DECIMAL(11,8)
        defaultValue: ""
        description: ""
        name: WTAX_PERCENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9aec567d-db18-4872-b7f4-7139fcc3889b
                stepCounter: c61b83d7-ea2a-43a4-bff3-24036c9a6bc8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4068c6a-b6a4-4d85-a64c-4143b6e17f7a
          stepCounter: 521848ad-19c4-4e42-abc8-976c69a05b63
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: GST_REG_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72872400-76f3-42e4-bec9-888928701ef6
                stepCounter: 17e8c098-2969-4300-91b0-b858f6d02add
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ec7528b-497a-4e82-8e2a-558af15d8d4e
          stepCounter: 521848ad-19c4-4e42-abc8-976c69a05b63
        config: {}
        dataType: VARCHAR(245)
        defaultValue: ""
        description: ""
        name: LABEL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e973675-26ea-41fb-9f8f-450a5924d092
                stepCounter: 17e8c098-2969-4300-91b0-b858f6d02add
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_CSLAND_BA_DETAIL: 521848ad-19c4-4e42-abc8-976c69a05b63
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_CSLAND_BA_DETAIL') }} AS SELECT BA.PRIMARY_KEY "CODE",
                   BA.FILE_STATUS "FILE_STATUS_CODE",
                   TB.DESCRIPTION "FILE_STATUS",
                   BA.ALTERNATE_CODE "ALT_CODE",
                   BA.NAME,
                   BA.ADDRESS_LINE_1,
                   BA.ADDRESS_LINE_2,
                   BA.ADDRESS_LINE_3,
                   BA.ADDRESS_LINE_4,
                   BA.ADDRESS_LINE_5,
                   BA.SHORT_NAME,
                   BA.CONTACT_NAME,
                   BA.PHONE_NUMBER,
                   BA.E_MAIL_ADDRESS,
                   BA.FAX_NUMBER,
                   BA.COMBINE_RENTAL "COMBINE_RENTAL_FLAG",
                   BA.MIN_CHEQUE_AMOUNT,
                   BA.BANK_FEE,
                   BA.CURRENCY_COUNTRY "CURRENCY_COUNTRY_CODE",
                   TC1.DESCRIPTION "CURRENCY_COUNTRY",
                   BA.WTAX_COUNTRY "WTAX_COUNTRY_CODE",
                   TC2.DESCRIPTION "WTAX_COUNTRY",
                   TC2.WTAX_PERCENT,
                   BA.GST_REG_NO,
                   BA.NAME || DECODE(TRIM(BA.ADDRESS_LINE_1), NULL, '', chr(10) || BA.ADDRESS_LINE_1) || DECODE(TRIM(BA.ADDRESS_LINE_2), NULL, '', chr(10) || BA.ADDRESS_LINE_2) || DECODE(TRIM(BA.ADDRESS_LINE_3), NULL, '', chr(10) || BA.ADDRESS_LINE_3) || DECODE(TRIM(BA.ADDRESS_LINE_4), NULL, '', chr(10) || BA.ADDRESS_LINE_4) || DECODE(TRIM(BA.ADDRESS_LINE_5), NULL, '', chr(10) || BA.ADDRESS_LINE_5) "LABEL"
              FROM DS_CSLAND.BA_TABLE BA,
                   DS_CSLAND.T_BFSTATUS TB,
                   DS_CSLAND.T_COUNTRY TC1,
                   DS_CSLAND.T_COUNTRY TC2
             WHERE BA.FILE_STATUS = TB.CODE(+)
               AND BA.CURRENCY_COUNTRY = TC1.CODE(+)
               AND BA.WTAX_COUNTRY = TC2.CODE(+)
        dependencies:
          - locationName: TARGET
            nodeName: ODS_CSLAND_BA_TABLE
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_CSLAND_BA_TABLE') }}
        name: VIEW_CSLAND_BA_DETAIL
        noLinkRefs: []
  name: VIEW_CSLAND_BA_DETAIL
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
