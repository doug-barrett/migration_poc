fileVersion: 1
id: b4984065-8a0a-4d8a-862b-9787adf131ac
name: S_LKP_CURRENCY_RATE_MROC_HISTORY
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DATAVAULT_BUSINESS_VAULT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f8387ed-8928-4f1c-9afc-a968747d965c
          stepCounter: b4984065-8a0a-4d8a-862b-9787adf131ac
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: ""
        name: HK_H_LKP_CURRENCY_RATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 66474127-d198-40e0-80bd-2f6e2d963d85
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5964938-75d5-41c9-98ba-2153b89b09b3
          stepCounter: b4984065-8a0a-4d8a-862b-9787adf131ac
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: CRY_CDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fde63a89-bd51-45c8-8e95-f9dd771d3e0f
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da89ba48-9ffb-4c4e-8cde-78b2fb33bc32
          stepCounter: b4984065-8a0a-4d8a-862b-9787adf131ac
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: ITN_IDN_CDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fba1abda-51b1-4ab4-a7cc-22fc45611dc9
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 407f818a-4fba-473b-a225-28e60da5ded3
          stepCounter: b4984065-8a0a-4d8a-862b-9787adf131ac
        config: {}
        dataType: TIMESTAMP_NTZ(3)
        defaultValue: ""
        description: ""
        name: RTE_DTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b22d2d32-082a-4242-b691-c4f794992d33
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f512a91-e6f1-4073-8402-d1098e9faf70
          stepCounter: b4984065-8a0a-4d8a-862b-9787adf131ac
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: ""
        name: CVT_CRY_CDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b309241-883f-4b79-b090-97fd9c578219
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4101e9b3-64e4-4f39-9922-6a36429b7c32
          stepCounter: b4984065-8a0a-4d8a-862b-9787adf131ac
        config: {}
        dataType: NUMBER(19,0)
        defaultValue: ""
        description: ""
        name: CRY_RTE_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b79b74ac-8a7e-45a2-ae8a-8e16242f736b
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88b98d4e-aa12-424d-a68f-bf23fd5187de
          stepCounter: b4984065-8a0a-4d8a-862b-9787adf131ac
        config: {}
        dataType: NUMBER(38,0)
        defaultValue: ""
        description: ""
        name: RTE_ENT_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c60ec6c3-1083-4a20-80ae-1d72efd7c686
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9f2a7d9-0d00-413d-992e-1a9efc20b37b
          stepCounter: b4984065-8a0a-4d8a-862b-9787adf131ac
        config: {}
        dataType: TIMESTAMP_NTZ(3)
        defaultValue: ""
        description: ""
        name: LST_UPD_DTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 66c421cb-7264-417f-a0b6-6a48580e21d0
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: edbfb998-d7b3-436c-b43d-76652834ca63
          stepCounter: b4984065-8a0a-4d8a-862b-9787adf131ac
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: LST_UPD_TME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60c97486-3c3d-49d3-8e3b-f511483ae9b8
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aeeb7e41-1f4f-4653-8e85-1a23b7a0b496
          stepCounter: b4984065-8a0a-4d8a-862b-9787adf131ac
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: LST_UPD_UID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1fb41ca-b1ce-4887-aa33-730eb4fc2a50
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df340d28-8f98-4534-8b1c-4817cd5130c3
          stepCounter: b4984065-8a0a-4d8a-862b-9787adf131ac
        config: {}
        dataType: NUMBER(38,0)
        defaultValue: ""
        description: ""
        name: LST_UPD_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e3b58e6e-cc29-4aad-8466-046a127cfdc1
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 563b3436-07ea-451d-9599-f82ffa3965f4
          stepCounter: b4984065-8a0a-4d8a-862b-9787adf131ac
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CREATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ee11e99-7d68-4e54-83c5-51a7c78f8a26
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24b2c05e-5dbb-48b1-94f9-c9760c41fcf1
          stepCounter: b4984065-8a0a-4d8a-862b-9787adf131ac
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: CREATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe479cfe-faee-4c24-a66e-312ca914180f
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ce841db-bc74-4b7f-b2c2-df6cbf5b83ec
          stepCounter: b4984065-8a0a-4d8a-862b-9787adf131ac
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: UPDATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: df734a72-bdec-4541-a72b-0cdd7ee34703
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2726237-7040-489c-bd41-7a7aa0fb20f1
          stepCounter: b4984065-8a0a-4d8a-862b-9787adf131ac
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: UPDATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 695befde-80d2-4231-b9e4-ed36b47feee8
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01daa5c3-5a61-4a18-a858-1a23cd829e30
          stepCounter: b4984065-8a0a-4d8a-862b-9787adf131ac
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: RUN_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 326559fd-d281-4af9-a4d6-6ca783591ae6
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dcbeb525-d2b1-4a76-9b55-47cc460d24ee
          stepCounter: b4984065-8a0a-4d8a-862b-9787adf131ac
        config: {}
        dataType: TIMESTAMP_NTZ(3)
        defaultValue: ""
        description: ""
        name: FILE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4db56eb-8a9b-4442-8229-4061dd858149
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 735c3aad-faa7-4b24-ac29-9638dceecb63
          stepCounter: b4984065-8a0a-4d8a-862b-9787adf131ac
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: The changing hash
        name: DSS_CHANGE_HASH
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1b413c1-db89-4e02-8073-45eeb048bceb
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 991ed123-fcb8-4e44-9203-064d7499c22e
          stepCounter: b4984065-8a0a-4d8a-862b-9787adf131ac
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Record source
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 525bec70-c24b-4f5c-940d-c278d708b059
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b2a26adf-9444-4f7d-80dc-5f4492a44613
          stepCounter: b4984065-8a0a-4d8a-862b-9787adf131ac
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was loaded in the data vault
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bcde4bf1-8d46-4817-9d6e-06005e4dd436
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2c1f8fc-f4e6-4ebf-abae-7a099a029383
          stepCounter: b4984065-8a0a-4d8a-862b-9787adf131ac
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row started in the data vault
        isSystemStartDate: true
        name: DSS_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11a7c6a2-2e4e-47b5-89ac-f3727167c5ea
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d147441-fe4a-4cbf-94d5-ba562a03cf38
          stepCounter: b4984065-8a0a-4d8a-862b-9787adf131ac
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: Version number of a business key in the data vault
        isSurrogateKey: true
        isSystemVersion: true
        name: DSS_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9f3a4824-fbfa-4bb4-9396-9532eabf1319
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 443e6238-da01-4d27-9891-06f124e41e0c
          stepCounter: b4984065-8a0a-4d8a-862b-9787adf131ac
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was inserted in the data vault
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f5635a7-8f27-4a8f-91c7-67d291ccf914
                stepCounter: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 812e099b-41ac-4554-acfc-8753cd75abf1
          stepCounter: b4984065-8a0a-4d8a-862b-9787adf131ac
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: End date determined by the next Satellite change record dss_start_date
        isSystemEndDate: true
        name: DSS_END_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: LEAD(dss_start_date, 1, '9999-12-31') OVER(PARTITION BY hk_h_lkp_currency_rate ORDER BY dss_start_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a27a219d-b892-4d38-a101-d329d99d12ed
          stepCounter: b4984065-8a0a-4d8a-862b-9787adf131ac
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: CurrentFlag 'N' unless next Satellite change record dss_start_date is null, indicating this is the most current record.
        isSurrogateKey: true
        isSystemCurrentFlag: true
        name: DSS_CURRENT_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN LEAD(dss_start_date, 1, NULL) OVER(PARTITION BY hk_h_lkp_currency_rate ORDER BY dss_start_date) IS NULL THEN 'Y'
                          ELSE 'N'
                           END
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_LKP_CURRENCY_RATE_MROC: 2b3b6a84-1ee6-4cca-a88a-460ce62a124d
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATAVAULT_RAW_VAULT
            nodeName: S_LKP_CURRENCY_RATE_MROC
        join:
          joinCondition: FROM {{ ref('DATAVAULT_RAW_VAULT','S_LKP_CURRENCY_RATE_MROC') }} s_lkp_currency_rate_mroc
        name: S_LKP_CURRENCY_RATE_MROC_HISTORY
        noLinkRefs: []
  name: S_LKP_CURRENCY_RATE_MROC_HISTORY
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
