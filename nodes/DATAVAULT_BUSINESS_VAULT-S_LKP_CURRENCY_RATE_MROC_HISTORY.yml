fileVersion: 1
id: a211dc56-bdfe-437a-a824-929993bb6c46
name: S_LKP_CURRENCY_RATE_MROC_HISTORY
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DATAVAULT_BUSINESS_VAULT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a2aaee4-3495-4901-b6dd-652ab626ca7a
          stepCounter: a211dc56-bdfe-437a-a824-929993bb6c46
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: ""
        name: HK_H_LKP_CURRENCY_RATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a5122c6f-56fc-4b79-acb9-ba70a39573b3
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab3c7dc9-7131-427d-8e8d-bb4afc96d7c8
          stepCounter: a211dc56-bdfe-437a-a824-929993bb6c46
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: CRY_CDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3152089-653d-44a8-a87d-daa37776db8f
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81045ebd-041f-4cd5-879e-a231d19330e5
          stepCounter: a211dc56-bdfe-437a-a824-929993bb6c46
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: ITN_IDN_CDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 45532583-af86-405f-9333-ca206940f70a
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f40fbcb-b48c-4d48-9a7d-f43714a823d2
          stepCounter: a211dc56-bdfe-437a-a824-929993bb6c46
        config: {}
        dataType: TIMESTAMP_NTZ(3)
        defaultValue: ""
        description: ""
        name: RTE_DTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 701a2483-f932-462c-b58c-763363ce879d
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc3e6c7e-62ec-4b4d-b0a8-f5c0e7ef6e81
          stepCounter: a211dc56-bdfe-437a-a824-929993bb6c46
        config: {}
        dataType: VARCHAR(3)
        defaultValue: ""
        description: ""
        name: CVT_CRY_CDE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84896e62-9431-4afc-b480-685a590fdd84
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3bff5d4-4595-4988-8a16-b24ce0f442ba
          stepCounter: a211dc56-bdfe-437a-a824-929993bb6c46
        config: {}
        dataType: NUMBER(19,0)
        defaultValue: ""
        description: ""
        name: CRY_RTE_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a03a4bf-9f0e-4939-818c-1271eecaadd9
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 551c8667-40be-4704-be0a-f8e6d3df672e
          stepCounter: a211dc56-bdfe-437a-a824-929993bb6c46
        config: {}
        dataType: NUMBER(38,0)
        defaultValue: ""
        description: ""
        name: RTE_ENT_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9f5825b2-53fd-45c9-b51a-49e7002b1615
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f98e89a3-7c0a-42f0-baaf-da82e4e80f20
          stepCounter: a211dc56-bdfe-437a-a824-929993bb6c46
        config: {}
        dataType: TIMESTAMP_NTZ(3)
        defaultValue: ""
        description: ""
        name: LST_UPD_DTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1246b4cd-777c-4e46-988a-bd5dc8d41492
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 90a969d7-367e-4c1e-a962-8c67ee2f7309
          stepCounter: a211dc56-bdfe-437a-a824-929993bb6c46
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: LST_UPD_TME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1509eb8d-99b9-4e51-8e15-5cb2aa2a893f
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6684ecd-096e-48fa-90e2-257b9ced8b6b
          stepCounter: a211dc56-bdfe-437a-a824-929993bb6c46
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: LST_UPD_UID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b36aca6a-e61a-4f46-96f9-4de66f6ac018
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 936c8ec3-ee5e-4af7-b081-93f8afd5adc3
          stepCounter: a211dc56-bdfe-437a-a824-929993bb6c46
        config: {}
        dataType: NUMBER(38,0)
        defaultValue: ""
        description: ""
        name: LST_UPD_NBR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 70feba70-829e-4e67-9c34-ef39aec13338
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d452d5c-3ff6-4d75-bffc-6782dfb31fc4
          stepCounter: a211dc56-bdfe-437a-a824-929993bb6c46
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: CREATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6575d1cd-6542-4d66-bd99-d5269151c1c9
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a809ca6d-6e24-4e78-b340-f92cd0ee0cca
          stepCounter: a211dc56-bdfe-437a-a824-929993bb6c46
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: CREATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 125ca91b-3e75-48f0-9357-001330529f69
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21e816ce-65ea-4f14-80b3-6ae5cec898a5
          stepCounter: a211dc56-bdfe-437a-a824-929993bb6c46
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: UPDATED_BY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de78d8e9-0f8d-4efd-8bd0-f2ab1101259b
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8a395d5-4e13-4baa-813b-5de1df7b6ed1
          stepCounter: a211dc56-bdfe-437a-a824-929993bb6c46
        config: {}
        dataType: TIMESTAMP(9)
        defaultValue: ""
        description: ""
        name: UPDATED_AT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ec5acc4-2516-44de-b6a0-5e36b334a00d
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 953f75fe-9de5-47d0-9128-acf21b7e695d
          stepCounter: a211dc56-bdfe-437a-a824-929993bb6c46
        config: {}
        dataType: VARCHAR(500)
        defaultValue: ""
        description: ""
        name: RUN_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 61805f78-08ad-4c89-945a-bf29fa895a87
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9446133e-6f03-4083-8268-d5753d2dedf7
          stepCounter: a211dc56-bdfe-437a-a824-929993bb6c46
        config: {}
        dataType: TIMESTAMP_NTZ(3)
        defaultValue: ""
        description: ""
        name: FILE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 95f07f91-1a07-45f5-bb0f-4bd0c2df0928
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b22b707d-b3e5-43ce-ab68-fd8691c9f972
          stepCounter: a211dc56-bdfe-437a-a824-929993bb6c46
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: The changing hash
        name: DSS_CHANGE_HASH
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 830bc1de-ba79-4220-9056-63e0392bc49a
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1813af2-0817-41c5-acb4-5a6af9b40b7c
          stepCounter: a211dc56-bdfe-437a-a824-929993bb6c46
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Record source
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 605c6caa-72a3-47d7-9fca-268ed6041321
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 65ad416b-b534-46ff-b1b3-b77d3f04579c
          stepCounter: a211dc56-bdfe-437a-a824-929993bb6c46
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was loaded in the data vault
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c2161da2-8e68-4113-83e4-581baab058a9
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f5b3baa-3127-4c4b-b874-fd06af2ed739
          stepCounter: a211dc56-bdfe-437a-a824-929993bb6c46
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row started in the data vault
        isSystemStartDate: true
        name: DSS_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4dc5cf49-c753-478f-a9d3-596cab7d08b8
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f3a5ca3-3992-42a0-8e7b-9f7be0aba5bc
          stepCounter: a211dc56-bdfe-437a-a824-929993bb6c46
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: Version number of a business key in the data vault
        isSurrogateKey: true
        isSystemVersion: true
        name: DSS_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f603733-941a-4c74-a6b7-adcacfcdf5d3
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54c799cc-5713-4bc3-95c3-532411251e54
          stepCounter: a211dc56-bdfe-437a-a824-929993bb6c46
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was inserted in the data vault
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48e6fc11-386e-4640-a52c-6bb51e8e1214
                stepCounter: 1e5d6798-74eb-43c0-a254-8af6407928e6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d49c8c36-1e65-4c40-8047-f99a1644a7d3
          stepCounter: a211dc56-bdfe-437a-a824-929993bb6c46
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: End date determined by the next Satellite change record dss_start_date
        isSystemEndDate: true
        name: DSS_END_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: LEAD(dss_start_date, 1, '9999-12-31') OVER(PARTITION BY hk_h_lkp_currency_rate ORDER BY dss_start_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b1c924e-2fe5-47ee-be7b-ea557fe8bc55
          stepCounter: a211dc56-bdfe-437a-a824-929993bb6c46
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: CurrentFlag 'N' unless next Satellite change record dss_start_date is null, indicating this is the most current record.
        isSurrogateKey: true
        isSystemCurrentFlag: true
        name: DSS_CURRENT_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN LEAD(dss_start_date, 1, NULL) OVER(PARTITION BY hk_h_lkp_currency_rate ORDER BY dss_start_date) IS NULL THEN 'Y'
                          ELSE 'N'
                           END
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_LKP_CURRENCY_RATE_MROC: 1e5d6798-74eb-43c0-a254-8af6407928e6
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATAVAULT_RAW_VAULT
            nodeName: S_LKP_CURRENCY_RATE_MROC
        join:
          joinCondition: FROM {{ ref('DATAVAULT_RAW_VAULT','S_LKP_CURRENCY_RATE_MROC') }} s_lkp_currency_rate_mroc
        name: S_LKP_CURRENCY_RATE_MROC_HISTORY
        noLinkRefs: []
  name: S_LKP_CURRENCY_RATE_MROC_HISTORY
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
