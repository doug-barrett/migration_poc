fileVersion: 1
id: 5f12290d-98fc-4cac-a431-bf05d2c20893
name: S_DIAGNOSIS_PROCEDURES_2
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Stage Table to flatten Diagnosis and Procedure hierarchies.  NOTE: Uses Custom Update Procedure Only"
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 10d5b6c8-14fb-49aa-801d-5f3aa1bf5b64
          stepCounter: 5f12290d-98fc-4cac-a431-bf05d2c20893
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Diagnosis_Procedure_Level_Number
        name: DIAGNOSIS_PROCEDURE_LEVEL_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e43098f6-a6a0-40e5-93c2-7c2108fc2823
          stepCounter: 5f12290d-98fc-4cac-a431-bf05d2c20893
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Diagnosis_Procedure_Level_Name
        name: DIAGNOSIS_PROCEDURE_LEVEL_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: afa44779-c00c-4b69-9920-f704ec2b8b17
          stepCounter: 5f12290d-98fc-4cac-a431-bf05d2c20893
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Diagnosis_Procedure_Reference_Number
        name: DIAGNOSIS_PROCEDURE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60119e10-af24-4efe-a5ef-123808388cee
                stepCounter: 31880730-3200-47a1-9c4b-85139fb5438c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4eca5222-59a2-4bc0-921c-a68f8db2a785
          stepCounter: 5f12290d-98fc-4cac-a431-bf05d2c20893
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Diagnosis_Procedure_Parent_Reference_Number
        name: DIAGNOSIS_PROCEDURE_PARENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5285e0da-2746-4aeb-acc2-b16c90e2b169
                stepCounter: 31880730-3200-47a1-9c4b-85139fb5438c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 62559d52-1b0b-4e5f-9d17-47ab237f3326
          stepCounter: 5f12290d-98fc-4cac-a431-bf05d2c20893
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Diagnosis_Procedure_Code
        name: DIAGNOSIS_PROCEDURE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33dce19c-b567-43b3-b353-b46239fa7718
                stepCounter: 31880730-3200-47a1-9c4b-85139fb5438c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47586ee1-3023-437a-ae48-514ebecacb71
          stepCounter: 5f12290d-98fc-4cac-a431-bf05d2c20893
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Diagnosis_Procedure_Description
        name: DIAGNOSIS_PROCEDURE_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f5d888a-e3c0-41dc-83cf-eed480685d23
                stepCounter: 31880730-3200-47a1-9c4b-85139fb5438c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6467118f-0d25-4933-87d4-799b3ba976b2
          stepCounter: 5f12290d-98fc-4cac-a431-bf05d2c20893
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Diagnosis_Procedure_Supplementary_Code
        name: DIAGNOSIS_PROCEDURE_SUPPLEMENTARY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 32b8c4c1-a386-45fd-b896-4d375e817ab4
                stepCounter: 31880730-3200-47a1-9c4b-85139fb5438c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b633deeb-1561-4142-b0ec-1e2a2f440f41
          stepCounter: 5f12290d-98fc-4cac-a431-bf05d2c20893
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Diagnosis_Procedure_Supplementary_Description
        name: DIAGNOSIS_PROCEDURE_SUPPLEMENTARY_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5bc4a917-ae24-49ae-9cd7-77d7b5d0428c
                stepCounter: 31880730-3200-47a1-9c4b-85139fb5438c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b806027-d622-4a79-8fad-1d532180d79c
          stepCounter: 5f12290d-98fc-4cac-a431-bf05d2c20893
        config: {}
        dataType: VARCHAR(5)
        defaultValue: ""
        description: Diagnosis_Procedure_Supplementary_Type_Code
        name: DIAGNOSIS_PROCEDURE_SUPPLEMENTARY_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 251cce32-0edf-4ff1-a767-dbd9b28552e6
                stepCounter: 31880730-3200-47a1-9c4b-85139fb5438c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b1a5b89-8a28-4dd4-b77c-7eda2350d007
          stepCounter: 5f12290d-98fc-4cac-a431-bf05d2c20893
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Diagnosis_Procedure_Type1_Reference_Number
        name: DIAGNOSIS_PROCEDURE_TYPE1_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2ef1a91-6c69-4b88-8dd1-a5d42894c059
                stepCounter: 31880730-3200-47a1-9c4b-85139fb5438c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ebd4b7ea-3f2e-42e1-af2d-dccb570fde4c
          stepCounter: 5f12290d-98fc-4cac-a431-bf05d2c20893
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: Diagnosis_Procedure_Type1_Code
        name: DIAGNOSIS_PROCEDURE_TYPE1_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1aca545b-97dc-4e1e-a271-967fcc0b2b23
                stepCounter: 31880730-3200-47a1-9c4b-85139fb5438c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f43aeaf-e564-45d7-84d0-42be81502803
          stepCounter: 5f12290d-98fc-4cac-a431-bf05d2c20893
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: Diagnosis_Procedure_Type1_Description
        name: DIAGNOSIS_PROCEDURE_TYPE1_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bfd683e4-4de1-4e40-b2de-a4c93342f557
                stepCounter: 31880730-3200-47a1-9c4b-85139fb5438c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9e9283b-0e49-445b-977e-5ab754c27270
          stepCounter: 5f12290d-98fc-4cac-a431-bf05d2c20893
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: Diagnosis_Procedure_Type2_Code
        name: DIAGNOSIS_PROCEDURE_TYPE2_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ac9a17b-7b37-4801-85a8-4f7bb04fa78d
                stepCounter: 31880730-3200-47a1-9c4b-85139fb5438c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31ea7c1c-5743-4ab1-b615-5e1d1bff949a
          stepCounter: 5f12290d-98fc-4cac-a431-bf05d2c20893
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: Diagnosis_Procedure_Type2_Description
        name: DIAGNOSIS_PROCEDURE_TYPE2_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 37a38149-d093-491b-aa4a-cf145b6b0e9c
                stepCounter: 31880730-3200-47a1-9c4b-85139fb5438c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b643965-ba08-46cb-995f-01060bfc4432
          stepCounter: 5f12290d-98fc-4cac-a431-bf05d2c20893
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Diagnosis_Procedure_Level1_Code
        name: DIAGNOSIS_PROCEDURE_LEVEL1_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb6cfad7-7302-460a-8d54-f4c1462401fc
          stepCounter: 5f12290d-98fc-4cac-a431-bf05d2c20893
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Diagnosis_Procedure_Level1_Description
        name: DIAGNOSIS_PROCEDURE_LEVEL1_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92448a16-d1fc-4fcf-b244-41556603e695
          stepCounter: 5f12290d-98fc-4cac-a431-bf05d2c20893
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Diagnosis_Procedure_Level2_Code
        name: DIAGNOSIS_PROCEDURE_LEVEL2_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d27e3647-1a0f-4873-9339-ac87c7e7cfd0
          stepCounter: 5f12290d-98fc-4cac-a431-bf05d2c20893
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Diagnosis_Procedure_Level2_Description
        name: DIAGNOSIS_PROCEDURE_LEVEL2_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e864398-8fb6-4ac1-9487-6913034c8707
          stepCounter: 5f12290d-98fc-4cac-a431-bf05d2c20893
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Diagnosis_Procedure_Level3_Code
        name: DIAGNOSIS_PROCEDURE_LEVEL3_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a87fb50-f212-4f37-bc6c-c6e7756e7c12
          stepCounter: 5f12290d-98fc-4cac-a431-bf05d2c20893
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Diagnosis_Procedure_Level3_Description
        name: DIAGNOSIS_PROCEDURE_LEVEL3_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e518660f-5930-4ae2-826d-109f169fd617
          stepCounter: 5f12290d-98fc-4cac-a431-bf05d2c20893
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: ""
        name: ICD_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1581870a-fc29-4ca1-af56-cb791b4f8ece
                stepCounter: 31880730-3200-47a1-9c4b-85139fb5438c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3750cd6-f90b-45df-8aed-0123b8fca625
          stepCounter: 5f12290d-98fc-4cac-a431-bf05d2c20893
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: ICD_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 34708c9f-8956-4dac-9256-87f800301ae2
                stepCounter: 31880730-3200-47a1-9c4b-85139fb5438c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd57b1ec-316e-4540-9034-90597868a11a
          stepCounter: 5f12290d-98fc-4cac-a431-bf05d2c20893
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: ICD_FULL_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f411d784-104d-484c-8e66-c376e328008a
                stepCounter: 31880730-3200-47a1-9c4b-85139fb5438c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75e17864-2a78-493f-84f0-a78692cbe6f7
          stepCounter: 5f12290d-98fc-4cac-a431-bf05d2c20893
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: MAPPED_ICD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bab88032-3806-4176-ba07-76e93a860986
                stepCounter: 09259da2-dd4b-4547-9b99-07e0117522c4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b772711c-6fb6-4e48-9859-75703b3cc32f
          stepCounter: 5f12290d-98fc-4cac-a431-bf05d2c20893
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: MAPPED_ICD_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bab88032-3806-4176-ba07-76e93a860986
                stepCounter: 09259da2-dd4b-4547-9b99-07e0117522c4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ded45bb-7059-4887-8f1a-218613516176
          stepCounter: 5f12290d-98fc-4cac-a431-bf05d2c20893
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: MAPPED_ICD_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bab88032-3806-4176-ba07-76e93a860986
                stepCounter: 09259da2-dd4b-4547-9b99-07e0117522c4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ec81689-0698-43db-b30b-a3142979d89b
          stepCounter: 5f12290d-98fc-4cac-a431-bf05d2c20893
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SNOMEDCT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bab88032-3806-4176-ba07-76e93a860986
                stepCounter: 09259da2-dd4b-4547-9b99-07e0117522c4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be0b3edb-f694-4273-b96d-9d146603d8df
          stepCounter: 5f12290d-98fc-4cac-a431-bf05d2c20893
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: SNOMEDCT_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3027582f-c3d2-4e9c-8892-b400f6582ed2
                stepCounter: 09259da2-dd4b-4547-9b99-07e0117522c4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4164dad6-5288-4a65-a312-8be22a0189ab
          stepCounter: 5f12290d-98fc-4cac-a431-bf05d2c20893
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Diagnosis_Procedure_Validity_Start_Date
        name: DIAGNOSIS_PROCEDURE_VALIDITY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 97d4f04d-9bd0-48ac-8255-98f6785eaabf
                stepCounter: 31880730-3200-47a1-9c4b-85139fb5438c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac295d9f-c2fc-4fa6-bd87-6b2a466ce022
          stepCounter: 5f12290d-98fc-4cac-a431-bf05d2c20893
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Diagnosis_Procedure_Validity_End_Date
        name: DIAGNOSIS_PROCEDURE_VALIDITY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ff1f500-5b6d-412a-919b-ec3d0d7f060e
                stepCounter: 31880730-3200-47a1-9c4b-85139fb5438c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f97f3cea-abd3-4f68-b391-d1bddb2cbf2f
          stepCounter: 5f12290d-98fc-4cac-a431-bf05d2c20893
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: POINTS_ELECTIVE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 097f5d02-4b7e-4391-a17c-5f87a5bd7100
                stepCounter: 738b2481-41ad-4d63-b18a-7f46457dd125
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c98c56a3-ec01-4faa-9b54-d60e5da05a05
          stepCounter: 5f12290d-98fc-4cac-a431-bf05d2c20893
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: POINTS_ACUTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1aebaee-8f7a-4152-ae63-46693e3c7cee
                stepCounter: 738b2481-41ad-4d63-b18a-7f46457dd125
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa0322ed-4b31-4ac9-aff8-148fd21fecfe
          stepCounter: 5f12290d-98fc-4cac-a431-bf05d2c20893
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: HIPS_PROCEDURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f74d1cd0-a097-4da2-8325-1b3f3f28ce89
                stepCounter: 7dc187a5-fb13-4837-9524-153348c47931
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 677785fb-a35e-44d0-8565-e999c1bf0da8
          stepCounter: 5f12290d-98fc-4cac-a431-bf05d2c20893
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: KNEES_PROCEDURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e9e52ea2-c76d-4b1a-a038-c912280d366a
                stepCounter: 7dc187a5-fb13-4837-9524-153348c47931
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e83bd006-624d-4ebd-ac42-bffaec6dfde4
          stepCounter: 5f12290d-98fc-4cac-a431-bf05d2c20893
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: BARIATRIC_PROCEDURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c6d14b8e-3a6c-48c8-80d4-a5c89c2abeae
                stepCounter: 7dc187a5-fb13-4837-9524-153348c47931
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c59a21c2-60ce-47a7-9704-81bc4c771faf
          stepCounter: 5f12290d-98fc-4cac-a431-bf05d2c20893
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: BARIATRIC_DIAGNOSIS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: feb70ee3-c429-4274-b634-71ccfcf79f26
                stepCounter: 7dc187a5-fb13-4837-9524-153348c47931
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 28731469-458a-42bd-9d99-f793ddb837f7
          stepCounter: 5f12290d-98fc-4cac-a431-bf05d2c20893
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PELVIC_EXENTERATION_PROCEDURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 69345ad2-7362-4c7c-ac9c-ebc03a054bc7
                stepCounter: 7dc187a5-fb13-4837-9524-153348c47931
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e73178a5-4a10-415d-8501-6850695ecb32
          stepCounter: 5f12290d-98fc-4cac-a431-bf05d2c20893
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies: []
        join:
          joinCondition: FROM s_diagnosis_procedures_1
        name: S_DIAGNOSIS_PROCEDURES_2
        noLinkRefs: []
  name: S_DIAGNOSIS_PROCEDURES_2
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
