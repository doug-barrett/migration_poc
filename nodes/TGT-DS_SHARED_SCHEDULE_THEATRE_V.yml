fileVersion: 1
id: 41f9b4ea-d206-4ce4-945d-39b42549ddb5
name: DS_SHARED_SCHEDULE_THEATRE_V
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d4cb029-4902-46d5-9552-82b72816319c
          stepCounter: 41f9b4ea-d206-4ce4-945d-39b42549ddb5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SCHEDULE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 73522497-b3f9-4b96-9c59-36a707f27842
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55a85f5d-0a41-44b9-a057-f1784f0cdf27
          stepCounter: 41f9b4ea-d206-4ce4-945d-39b42549ddb5
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SESSION_INTO_THEATRE_SEQ_NUM
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN schedule_theatre_status_code <> 'C' AND into_theatre_date IS NOT NULL THEN ROW_NUMBER() OVER (PARTITION BY (CASE WHEN schedule_theatre_status_code <> 'C' AND into_theatre_date IS NOT NULL THEN service_point_session_reference_no ELSE NULL END) ORDER BY IFNULL(into_theatre_date,start_date),schedule_reference_no)
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3dddd756-5add-4a8d-ab85-7256f607d5dc
          stepCounter: 41f9b4ea-d206-4ce4-945d-39b42549ddb5
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: SESSION_INTO_THEATRE_COUNT
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN schedule_theatre_status_code <> 'C' AND into_theatre_date IS NOT NULL THEN COUNT(1) OVER (PARTITION BY (CASE WHEN schedule_theatre_status_code <> 'C' AND into_theatre_date IS NOT NULL THEN service_point_session_reference_no ELSE NULL END))
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a94d918-e134-4c82-a702-419fe57c8267
          stepCounter: 41f9b4ea-d206-4ce4-945d-39b42549ddb5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: INTO_THEATRE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94f1bef3-23d3-4719-9909-9fe059faed43
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45a66d14-300c-4613-80ae-83528a2149d6
          stepCounter: 41f9b4ea-d206-4ce4-945d-39b42549ddb5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: VISIT_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cc35ef61-dc52-49a2-ad90-fd31dd905d53
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07f7d1a5-a427-42de-8e33-36c1c74d4a7a
          stepCounter: 41f9b4ea-d206-4ce4-945d-39b42549ddb5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: OUT_OF_THEATRE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d1cc7e49-03a1-4b1a-91e6-bcd20f4aff6e
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78865417-335e-44dc-b48d-6ae53ab4842f
          stepCounter: 41f9b4ea-d206-4ce4-945d-39b42549ddb5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: INTO_POSTOP_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d1cc7e49-03a1-4b1a-91e6-bcd20f4aff6e
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b58fbc92-deae-4160-b43a-273e9eae1e6d
          stepCounter: 41f9b4ea-d206-4ce4-945d-39b42549ddb5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: VISIT_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d6cdf7cd-bfe6-460c-90a7-a303cd644d98
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db61068e-a988-4686-b4d4-0ac729c79bdb
          stepCounter: 41f9b4ea-d206-4ce4-945d-39b42549ddb5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SERVICE_POINT_SESSION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 73f114e0-536a-40f1-94a8-14b175e3b926
                stepCounter: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DS_SHARED_SCHEDULE: ab7b9f91-81b3-4d0a-bd4c-90aa5d071bb9
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_SHARED_SCHEDULE
        join:
          joinCondition: |-
            FROM {{ ref('TGT','DS_SHARED_SCHEDULE') }}
             WHERE 1=1
               AND schedule_type_code = 'THEAT'
        name: DS_SHARED_SCHEDULE_THEATRE_V
        noLinkRefs: []
  name: DS_SHARED_SCHEDULE_THEATRE_V
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
