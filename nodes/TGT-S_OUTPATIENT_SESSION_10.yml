fileVersion: 1
id: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
name: S_OUTPATIENT_SESSION_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e25c738-d6e3-4d13-b9c4-909cd29c4a8b
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OUTPATIENT_SESSION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a59682b-31ab-4f97-bcb8-c036691b29fe
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e215bef-4218-4c0b-8661-851332476663
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OUTPATIENT_CLINIC_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd91294d-fd26-4746-b606-84cc02fb8e27
                stepCounter: 29115072-f49d-4742-9992-07e36d9c7d0c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55ea7670-c8ba-4f16-aa5f-26ca0920ed85
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OUTPATIENT_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8a0cc70-96f5-4324-8b79-c7a34c24d7b2
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59a9192c-a24b-4ce0-a30e-78f85a543ab4
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OUTPATIENT_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d006aef-216d-4a18-9910-4afe86d742d9
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7849626-51ce-489b-88dd-35a789db9c34
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: HEALTH_ORGANISATION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb87680b-afb7-4430-89ad-a863bd3d0257
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e463646d-f6e2-4467-bbbf-5544fd9a01e2
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAFF_TEAM_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 99cebdcb-9562-4876-94c8-d61513187a37
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c773681-592e-494b-a6f0-bc1dade754dc
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SESSION_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7f5ad10-4dfd-412b-a55b-d390c000dd0e
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 928fe7b4-ef21-4eea-92e2-5d44c0c8a84b
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SESSION_END_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd6c4549-7991-4dd2-ab40-af39e3a4c06a
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ec1c6ec-6708-4d35-87d3-758bddfb1279
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SESSION_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 610c6ecd-7bf3-4ba6-a5cd-0d1fc2ee7bae
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d0e00965-0d2b-4a65-9c79-d7bf79ce431b
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SESSION_CANCEL_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c351b7c-7cad-481b-a7cd-27a86d729e26
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 61acef3c-c75d-4487-b38b-495fdbd70ff8
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c393f1c-4562-49c4-a9d0-5889aaa5021f
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e81b211-4160-4fa4-b440-39a9294a4e37
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e375c49a-5f37-4059-ae8f-465a05b2b38c
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9ed7e58-23a4-44de-8747-8107e0f08a4c
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SESSION_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f5bac63a-463c-4966-b7f5-7eae3a4e92b1
                stepCounter: c162f447-4367-47b0-93c5-31704ed2b3c6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07e4ff6b-b6ed-4500-a0ad-bc9a8583a342
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_CHANGE_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9cc9850-5950-4634-bf08-d6472441d233
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1e5e915-5620-48f1-b771-bf7b21b0f8d8
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CLINIC_PURPOSE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 35dd62dd-3127-473b-8141-064c4a844dbf
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8fa4dd96-bf03-4b40-986e-233c4e5f7aae
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CLINIC_FREQUENCY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 93ac740f-4fd8-4db4-8307-9cc8fdd244cf
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1115d864-f173-4d5d-a868-3021b6ae3fed
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CLINIC_FREQUENCY_OFFSET_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1609e09f-72b8-43d4-bf0a-4dde7ec92bc2
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de3b2ac7-575d-4ecd-b42e-3db04cd28df5
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_FREQUENCY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f5175c2-f177-4a41-acb8-09ab98d9e56b
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 00ce409c-af34-4a8f-a795-8c1764dd638a
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_FREQUENCY_OFFSET_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e96d8dbe-8823-4a19-a3c5-b56c087e0271
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 13b047b0-bd10-4a8e-ac44-2bdc87db3b29
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_CHANGE_REQUEST_BY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db583fc1-9894-430f-92c1-2aa9c39827cd
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82f2d3cf-2fb9-422b-96a6-d8cd2244b6d6
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_LATE_START_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ae3ab32-6ac8-4fbd-9fac-872ef21f5192
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e624ed67-28d1-4abb-9bd0-7ca422d7ff15
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SESSION_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ceebc46-5485-44cb-b87e-4b3ba4e1d255
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 742a48ee-d060-46a1-b8c7-cb4c2b5cef26
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: SESSION_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd033c8c-027f-4431-a721-00a7fa6a15f6
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: LEFT(ds_session_05.appointment_code+':'+IFNULL(ds_session_05.appointment_desc,''),255)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec8adb60-be02-4d2e-add9-476e69d179a6
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SESSION_DAY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ceebc46-5485-44cb-b87e-4b3ba4e1d255
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: |-
              CASE WHEN appointment_code LIKE '%AD%' THEN 'All Day'
                          WHEN appointment_code LIKE '%AM%' THEN 'AM'
                          WHEN appointment_code LIKE '%PM%' THEN 'PM'
                          ELSE 'Not Specified'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d10a48fb-0fc2-4dfb-827a-1fd7b393ca57
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: GROUP_CLINIC_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e8460039-6d66-4b35-8767-0d6bf7a2b3a0
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b9b85df5-0025-46c2-9dd7-c9e8f92232ac
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: EXCLUDE_HOLIDAYS_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 761a7771-0063-4483-b271-77a4fb93e3bd
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d853291d-dc8d-462f-8989-e322160cca61
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: FINAL_SESSION_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c714cc4-a97f-4ba6-9fe6-266f891e51e8
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c191ab2-c504-472f-97d5-da040a4859bd
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: CANCELLED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e375c49a-5f37-4059-ae8f-465a05b2b38c
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: |-
              CASE WHEN dim_session_status.session_status_code IN ('SESOH','SESCN')--('Session on Hold','Session Cancelled')
               THEN 'Y'
                          ELSE 'N'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2919f5bb-4189-4eb2-a9f0-fd07726be02d
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: If the template flag is No and there is no template linked this indicator is 'N'  If there is a template linked the value is 'Y' irrespective of the iPM template flag
        name: TEMPLATE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 036c249a-0b9d-4db0-987f-172839edcb21
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: |-
              CASE WHEN ds_session_05.template_flag= 'N' AND ds_session_05.template_reference_no IS NOT NULL THEN 'N'
                          ELSE 'Y'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 19f285c2-3e0e-439a-ab65-42a1dac1f374
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIRST_PATIENT_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ade0787-e1c4-4674-bb95-87cf380625ba
                stepCounter: 00f153d5-b2da-4d99-b747-0b83119eb4db
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4196cf5f-83c8-4234-b9bc-4addd980d18f
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: LAST_PATIENT_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4535b50f-9aa3-477d-9fc2-8e07b3067d30
                stepCounter: 00f153d5-b2da-4d99-b747-0b83119eb4db
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42f7c05a-2d47-41bf-8250-06b85e12cf1a
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: duration UOM
        name: DURATION_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'minute'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c3cc0cb-3777-48ea-b8a5-956f121e25ce
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_SLOT_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0da425b2-b819-4ef8-9d37-91cbd1e44952
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af7601e1-fb3b-4457-9a3c-971f7be1e9f4
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f3e4d6b5-7733-439d-b8c7-fc0fbb9bd521
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: IFNULL(ds_session_05.session_duration_mins,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22d7cdd6-2436-4f19-86fb-e97d17bb4a70
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_DURATION_CALC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 610c6ecd-7bf3-4ba6-a5cd-0d1fc2ee7bae
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: IFNULL(DATEDIFF(mi,ds_session_05.start_date,ds_session_05.end_date),0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7dc8a010-2f9d-4cc8-9006-ed503eef18a7
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_CLINICS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ceebc46-5485-44cb-b87e-4b3ba4e1d255
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: |-
              CASE WHEN appointment_code LIKE '%AD%'                                                                                                                          THEN 2
                          WHEN appointment_code LIKE '%AM%'                                                                                                                          THEN 1
                          WHEN appointment_code LIKE '%PM%'                                                                                                                          THEN 1
                          WHEN appointment_code NOT LIKE '%AD%' AND appointment_code NOT LIKE '%AM%' AND appointment_code NOT LIKE '%PM%' AND DATEDIFF(N,start_date,end_date) >= 270 THEN 2
                          WHEN appointment_code NOT LIKE '%AD%' AND appointment_code NOT LIKE '%AM%' AND appointment_code NOT LIKE '%PM%' AND DATEDIFF(N,start_date,end_date) <= 270 THEN 1
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5c5a590-d404-4d8e-bfce-17908b99936c
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_ACTUAL_SLOTS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IFNULL(ds_session_05.session_duration_mins / ds_session_05.slot_duration_mins,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c4cf10c-9dab-4d39-bc54-c3ac00da93ee
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_PLANNED_SLOTS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 17f9c2b3-c827-43e7-a3c0-417756b3b3ae
                stepCounter: 26e9d2a5-d387-4c66-b1ca-71c463e57593
            transform: IFNULL(s_service_point_time_slot.available_slots,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: efcb74b9-cd4e-434b-b718-e85254cfd418
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_PLANNED_NEW_SLOTS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a96d0f23-a067-4d09-876e-7d918637ade9
                stepCounter: 26e9d2a5-d387-4c66-b1ca-71c463e57593
            transform: |-
              CASE WHEN IFNULL(s_service_point_time_slot.FUP_slots,0) > 0 THEN 0
                          ELSE IFNULL(s_service_point_time_slot.new_slots,0)
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6633ec6-9524-4b28-9131-f22130e429a3
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_PLANNED_FUP_SLOTS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 80c3da51-adc9-4b9d-86d9-1e238be18034
                stepCounter: 26e9d2a5-d387-4c66-b1ca-71c463e57593
            transform: |-
              CASE WHEN IFNULL(s_service_point_time_slot.new_slots,0) > 0 THEN 0
                          ELSE IFNULL(s_service_point_time_slot.FUP_slots,0)
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75b923a3-9e61-4d84-9e89-440dc5168114
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_PLANNED_MIXED_SLOTS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 17f9c2b3-c827-43e7-a3c0-417756b3b3ae
                stepCounter: 26e9d2a5-d387-4c66-b1ca-71c463e57593
            transform: |-
              CASE WHEN IFNULL(s_service_point_time_slot.new_slots,0) + IFNULL(s_service_point_time_slot.fup_slots,0) > 1 OR (IFNULL(s_service_point_time_slot.new_slots,0) = 0 AND IFNULL(s_service_point_time_slot.fup_slots,0) = 0) THEN IFNULL(s_service_point_time_slot.available_slots,0)
                          ELSE 0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c350f1c-b967-4df3-a640-a7fdfedd7275
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_PATIENTS_MAX_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ae70232-46aa-433b-9122-f7f8727deca6
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: IFNULL(ds_session_05.max_patients,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3f74bae-405a-4c9d-a087-b959eaedb7cf
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_APPOINTMENTS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dd701644-eb8f-4efb-80e6-238805c3d580
                stepCounter: 00f153d5-b2da-4d99-b747-0b83119eb4db
            transform: IFNULL(s_outpatient_appointment_summary_v.appointments_num,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c8481da-2f38-45f8-9973-57b978bec06b
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NEW_ATTENDS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a43004f8-e53d-46a3-9f96-13a990b1f8d3
                stepCounter: 00f153d5-b2da-4d99-b747-0b83119eb4db
            transform: IFNULL(s_outpatient_appointment_summary_v.new_attends_num,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47cc9532-a283-4d12-b51c-83b2a234c6de
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NEW_DNA_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 37183bf1-97c2-41ca-9112-7e75049302da
                stepCounter: 00f153d5-b2da-4d99-b747-0b83119eb4db
            transform: IFNULL(s_outpatient_appointment_summary_v.new_DNA_num,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af54cb9f-94d4-4da7-85f3-41de8354b6b1
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NEW_INCOMPLETE_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39efc295-5e79-4f6f-8925-94fe63d0e797
                stepCounter: 00f153d5-b2da-4d99-b747-0b83119eb4db
            transform: IFNULL(s_outpatient_appointment_summary_v.new_incomplete_num,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f427caed-46aa-47b5-b1b4-c29d0d3e7944
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FUP_ATTENDS_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 81e151e8-2529-48b2-ac72-3e9ad78f5e46
                stepCounter: 00f153d5-b2da-4d99-b747-0b83119eb4db
            transform: IFNULL(s_outpatient_appointment_summary_v.FUP_attends_num,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d04bfe2e-353c-434c-9057-ad834d50f5d1
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FUP_DNA_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0e0c0265-b64a-45ed-b7f7-567c08e0ed6f
                stepCounter: 00f153d5-b2da-4d99-b747-0b83119eb4db
            transform: IFNULL(s_outpatient_appointment_summary_v.FUP_DNA_num,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97e75009-2443-4c28-bb3f-5c6698821825
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FUP_INCOMPLETE_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 73d7030a-8ad0-4e44-bdf8-6e0b6e53da4f
                stepCounter: 00f153d5-b2da-4d99-b747-0b83119eb4db
            transform: IFNULL(s_outpatient_appointment_summary_v.FUP_incomplete_num,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 933d22b7-745f-4f87-bc63-f34e13264d68
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CLINIC_SESSION_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 252b85d7-1e65-450a-ae6c-07a4527e4679
                stepCounter: 0800cfbd-02fc-4bd7-a656-513d65577485
            transform: |-
              -- ROW_NUMBER() OVER (PARTITION BY ds_session_05.service_point_session_reference_no
               -- ORDER BY ds_session_05.start_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2faaf856-a8dc-4b79-ad8e-7a53b2f803b0
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CLINIC_SESSION_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e6fc5f76-2fd8-42d8-b40e-c5cd6315dd69
                stepCounter: 0800cfbd-02fc-4bd7-a656-513d65577485
            transform: --COUNT(1) OVER (PARTITION BY ds_session_05.service_point_session_reference_no)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 76560853-c70a-4c66-b880-6bd802ec542c
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OUTPATIENT_SESSION_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: '1'
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2eb8c2d-3cfd-4d33-8205-ad0b34822b6c
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1efb711f-49d9-400d-bbbd-07d5d5c3b605
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2da069a1-2882-421e-a122-469dc769a23e
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: INSTRUCTIONS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2e098447-0b83-4139-822f-81be2cf5c01e
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9bc2ceb1-ff57-423f-9a1b-1f54b82cd6f0
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SESSION_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c30fe88d-9fb8-47e7-af3f-a3c8666106bd
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45bf29f0-7479-453f-85b9-d8a1ea606c51
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: SESSION_WEEKS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c14afd52-02ba-4835-bdd3-4373ef17b42b
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ddf7c05-f247-44f9-8a9c-0df5a773ffd5
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SESSION_DAYS_IN_WEEK1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f9c7ddda-255b-403f-a7fc-6891836b15bc
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b3cc760-894a-4054-8d81-fade83ccc1bf
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SESSION_DAYS_IN_WEEK2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f1c65e62-4820-4ad7-b61e-bfff35b986c3
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7bdeade4-4ddb-4fcd-b126-dead37de23f1
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SESSION_DAYS_IN_WEEK3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9be29faa-0217-4065-a6fc-4ad85be1b14b
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d5e3f99-e4dc-4932-9590-6bf4af6bb44f
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SESSION_DAYS_IN_WEEK4
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2524eb45-c51c-4493-a4e4-cf7de7bd5cf9
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9dd325cb-425c-42bd-b245-512f83f63b4c
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: SESSION_DAYS_IN_WEEK5
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ece71566-88e8-4a2f-88cb-2169dc2d76fb
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5aba8cb9-32ab-43c6-822c-5993023ee7fe
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: EXCLUDE_HOLS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 761a7771-0063-4483-b271-77a4fb93e3bd
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 292dd855-3ac2-4329-92c5-706ff5c5fa16
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78dbb840-d1d2-4edf-b95b-afb931fed1e4
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5bae6e7-3ba8-435b-a5f7-36b07dbcfa2c
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 97218b98-01b9-4ab1-b1d7-61cb38773a79
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4539d819-323e-4af4-b588-528229632242
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIFY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c14a53be-adc4-4e7b-9321-5fc149b4337d
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81aad630-e442-4eba-bcc7-9feb4c70f977
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MODIFY_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e3e95ab9-c06c-4314-abae-3114e47a7b54
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e02c5d8f-c8a3-4f2f-aa4f-d992946415ef
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DSS_DATA_QUALITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d72e9ff-6df0-40fa-b9d0-0533f111681c
                stepCounter: caa39b00-2a5b-4123-adae-e59884a2006d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc9e73a6-17a0-47b6-a9c1-795b99349e06
          stepCounter: 68b5c75b-dcd1-4f1e-b916-f5fe16ca54f5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_SESSION_05
        join:
          joinCondition: |-
            FROM ds_session_05
              JOIN ds_session_05_v
                ON ds_session_05_v.service_point_session_reference_no = ds_session_05.service_point_session_reference_no
             INNER JOIN dim.dim_clinic
                ON dim_clinic.clinic_reference_no = ds_session_05.service_point_reference_no
               AND ds_session_05.start_date BETWEEN dim_clinic.dss_start_date AND dim_clinic.dss_end_date
              LEFT OUTER JOIN dim.dim_session_status
                ON ds_session_05.session_status_reference_no = dim_session_status.session_status_reference_no
               AND IFNULL(dim_session_status.dss_start_date, GETDATE()-10000) <= ds_session_05.start_date
               AND IFNULL(dim_session_status.dss_end_date, GETDATE()+10000) >= ds_session_05.start_date
              LEFT OUTER JOIN s_service_point_time_slot
                ON ds_session_05.service_point_session_reference_no = s_service_point_time_slot.service_point_session_reference_no
              LEFT OUTER JOIN s_outpatient_appointment_summary_v
                ON ds_session_05.service_point_session_reference_no = s_outpatient_appointment_summary_v.outpatient_session_reference_no
              LEFT OUTER JOIN dim.dim_outpatient_session dim_outpatient_session
                ON dim_outpatient_session.session_code = ds_session_05.appointment_code
               AND dim_outpatient_session.session_desc = ds_session_05.appointment_desc
             WHERE 1=1
               AND ds_session_05.dss_update_time > @v_pa_outpatient_incremental
                OR dim_outpatient_session.session_code IS NULL
        name: S_OUTPATIENT_SESSION_10
        noLinkRefs: []
  name: S_OUTPATIENT_SESSION_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
