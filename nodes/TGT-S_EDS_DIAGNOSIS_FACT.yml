fileVersion: 1
id: 651d6250-9643-4dea-8107-bd9a210ab096
name: S_EDS_DIAGNOSIS_FACT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5da0f02-c3d9-4390-b2cd-dea24faff5e3
          stepCounter: 651d6250-9643-4dea-8107-bd9a210ab096
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: DIAGNOSIS_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe3c8893-4c09-41f8-b892-26e55232c0f8
                stepCounter: aaab4c91-623b-4d9e-8a54-1db3d396fc34
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8344b31c-def0-4b13-862d-c0834cdf87d9
          stepCounter: 651d6250-9643-4dea-8107-bd9a210ab096
        config: {}
        dataType: NVARCHAR(20)
        defaultValue: ""
        description: ""
        name: TEMPLATE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fe3c6ebd-cc14-4df3-b3f3-d73108c802d8
                stepCounter: aaab4c91-623b-4d9e-8a54-1db3d396fc34
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bff7cf6e-0bde-480c-8e1c-8ee94ef1aa6a
          stepCounter: 651d6250-9643-4dea-8107-bd9a210ab096
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: ""
        name: TEMPLATE_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f31b68c9-a4b8-4f3a-b095-84801f403215
                stepCounter: aaab4c91-623b-4d9e-8a54-1db3d396fc34
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3fa0bfb5-48e5-4a0a-b423-403655d0c911
          stepCounter: 651d6250-9643-4dea-8107-bd9a210ab096
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_EDS_diagnosis_fact.patient_reference_no=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9962a01b-5f3d-4c1a-b371-997edef38d0f
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6d9c579-a697-4e9b-85d1-d85b80ed0ecc
          stepCounter: 651d6250-9643-4dea-8107-bd9a210ab096
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_EDS_diagnosis_fact.template_version=dim_EDS_template_list.version  s_EDS_diagnosis_fact.template_code=dim_EDS_template_list.template_code
        name: DIM_EDS_TEMPLATE_LIST_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c6b99cc-e5b9-4661-9ed1-5e9aa81931cf
                stepCounter: 6fb94ddb-af66-4257-981e-21c45e3e1013
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 492f11b7-9f5c-4f7c-bfb7-aa7ee54953b3
          stepCounter: 651d6250-9643-4dea-8107-bd9a210ab096
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_EDS_diagnosis_fact.coding_system=dim_EDS_diagnosis.coding_system  s_EDS_diagnosis_fact.diagnosis_description=dim_EDS_diagnosis.diagnosis_description  s_EDS_diagnosis_fact.diagnosis_code_iPM_2=dim_EDS_diagnosis.diagnosis_code_iPM_2  s_EDS_diagnosis_fact.diagnosis_code_iPM=dim_EDS_diagnosis.diagnosis_code_iPM  s_EDS_diagnosis_fact.diagnosis_code_eds=dim_EDS_diagnosis.diagnosis_code_eds  s_EDS_diagnosis_fact.diagnosis_code=dim_EDS_diagnosis.diagnosis_code
        name: DIM_EDS_DIAGNOSIS_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5b528384-626d-42ce-b582-c65b6fc8d6ec
                stepCounter: 728d2f33-65a2-4956-9d7a-e2078e7fa74c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f91eb7b-5c74-45e8-a7f5-96c156884bc1
          stepCounter: 651d6250-9643-4dea-8107-bd9a210ab096
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: DISCHARGE_EVENT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e806e379-731b-4d9e-8741-7a7b10a24cf9
                stepCounter: aaab4c91-623b-4d9e-8a54-1db3d396fc34
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3897e5e7-a90b-4c2f-a95b-486db596ca34
          stepCounter: 651d6250-9643-4dea-8107-bd9a210ab096
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 69bfbb56-a985-4540-ba5a-2a7b81db6aa9
                stepCounter: aaab4c91-623b-4d9e-8a54-1db3d396fc34
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9542c6f8-5f68-47a8-a1ab-5fd4d99ee377
          stepCounter: 651d6250-9643-4dea-8107-bd9a210ab096
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: EVENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b8cdc254-6f54-4020-9901-149ab15b7fd0
                stepCounter: aaab4c91-623b-4d9e-8a54-1db3d396fc34
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 310e4c88-4b82-454e-b9b1-b5ead63f7d75
          stepCounter: 651d6250-9643-4dea-8107-bd9a210ab096
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ROW_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c818aa30-51b2-4e8f-94dd-bb5d4a01a14b
                stepCounter: aaab4c91-623b-4d9e-8a54-1db3d396fc34
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5969b20-32d3-4502-aa10-2a4979cca4c2
          stepCounter: 651d6250-9643-4dea-8107-bd9a210ab096
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 594941a3-ede1-4586-87f8-2eb11a165536
                stepCounter: aaab4c91-623b-4d9e-8a54-1db3d396fc34
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1063568-b194-47b0-9092-fad65731512f
          stepCounter: 651d6250-9643-4dea-8107-bd9a210ab096
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa76ac58-9076-46bd-b1b8-65753b1871a7
                stepCounter: aaab4c91-623b-4d9e-8a54-1db3d396fc34
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a13ab4a6-38eb-4696-afc4-06adf6f3d4ae
          stepCounter: 651d6250-9643-4dea-8107-bd9a210ab096
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a5d68a5e-1e4a-4642-b5e1-c64c5e8cbdb3
                stepCounter: aaab4c91-623b-4d9e-8a54-1db3d396fc34
            transform: dbo.[fn_convert_utc_datetime2](s_EDS_diagnosis_20.admit_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ff00b69-1ae9-4a68-8df6-cb5b744af3a3
          stepCounter: 651d6250-9643-4dea-8107-bd9a210ab096
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa675329-4f11-4313-be3f-08d57fdc5cdf
                stepCounter: aaab4c91-623b-4d9e-8a54-1db3d396fc34
            transform: dbo.[fn_convert_utc_datetime2](s_EDS_diagnosis_20.discharge_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f92c5ead-850d-467b-b782-c0f4f5f37af0
          stepCounter: 651d6250-9643-4dea-8107-bd9a210ab096
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: ODPCD_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0575dd1b-74ce-4d9d-b6c3-27550780c971
                stepCounter: aaab4c91-623b-4d9e-8a54-1db3d396fc34
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92e495b3-e865-48fb-85a6-afdcaf3a94ee
          stepCounter: 651d6250-9643-4dea-8107-bd9a210ab096
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 389717f0-9ea3-4e5f-acfa-32a203723262
                stepCounter: aaab4c91-623b-4d9e-8a54-1db3d396fc34
            transform: IFNULL(s_EDS_diagnosis_20.diagnosis_code,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33469be8-c27a-4487-994d-e53317055985
          stepCounter: 651d6250-9643-4dea-8107-bd9a210ab096
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_CODE_EDS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c1aa195-c4de-4607-bd9a-adbdea0f8db6
                stepCounter: aaab4c91-623b-4d9e-8a54-1db3d396fc34
            transform: IFNULL(s_EDS_diagnosis_20.diagnosis_code_eds,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad30dcad-a7b1-4da3-9ae8-b211677046fe
          stepCounter: 651d6250-9643-4dea-8107-bd9a210ab096
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_CODE_IPM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 586e906e-620a-4d71-a2db-9172b3f3de15
                stepCounter: aaab4c91-623b-4d9e-8a54-1db3d396fc34
            transform: IFNULL(s_EDS_diagnosis_20.diagnosis_code_iPM,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf5744bf-b1b2-4995-9fa0-3f2f0fcfb535
          stepCounter: 651d6250-9643-4dea-8107-bd9a210ab096
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_CODE_IPM_2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 40164967-ff4e-4f04-be8a-b8a44e55efcc
                stepCounter: aaab4c91-623b-4d9e-8a54-1db3d396fc34
            transform: IFNULL(s_EDS_diagnosis_20.diagnosis_code_iPM_2,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82f19618-0089-47e8-9e12-9d5bdbe7306d
          stepCounter: 651d6250-9643-4dea-8107-bd9a210ab096
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e910687-29ee-4bdf-b1fc-70cc15574754
                stepCounter: aaab4c91-623b-4d9e-8a54-1db3d396fc34
            transform: IFNULL(s_EDS_diagnosis_20.diagnosis_description,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22a16bd9-3906-475f-a01e-83cfdd7c24c7
          stepCounter: 651d6250-9643-4dea-8107-bd9a210ab096
        config: {}
        dataType: VARCHAR(250)
        defaultValue: ""
        description: ""
        name: CODING_SYSTEM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0eaf53aa-2fb7-4d4f-a04a-fd63d09e49d5
                stepCounter: aaab4c91-623b-4d9e-8a54-1db3d396fc34
            transform: IFNULL(s_EDS_diagnosis_20.coding_system,'')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b61f7fbe-2ab0-4283-a192-9b71a0dd2f41
          stepCounter: 651d6250-9643-4dea-8107-bd9a210ab096
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Y/N primary diagnosis indicator
        name: IS_PRIMARY_DIAGNOSIS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 12cde880-628f-46c8-b994-6fc4ac468f7d
                stepCounter: aaab4c91-623b-4d9e-8a54-1db3d396fc34
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f23c1860-d767-44b9-a3cd-789c2803150f
          stepCounter: 651d6250-9643-4dea-8107-bd9a210ab096
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DIAGNOSIS_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f32714e-6634-4fb3-9387-4a68280403a9
                stepCounter: aaab4c91-623b-4d9e-8a54-1db3d396fc34
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce79dd3b-1ffa-4544-982f-f2c093e8b1b5
          stepCounter: 651d6250-9643-4dea-8107-bd9a210ab096
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_EDS_DIAGNOSIS_20: aaab4c91-623b-4d9e-8a54-1db3d396fc34
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_EDS_DIAGNOSIS_20
        join:
          joinCondition: FROM {{ ref('TGT','S_EDS_DIAGNOSIS_20') }}
        name: S_EDS_DIAGNOSIS_FACT
        noLinkRefs: []
  name: S_EDS_DIAGNOSIS_FACT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
