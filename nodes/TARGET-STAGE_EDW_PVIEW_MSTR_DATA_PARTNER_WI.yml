fileVersion: 1
id: 10c7aebf-9766-4bf6-b271-9d16a76a1e28
name: STAGE_EDW_PVIEW_MSTR_DATA_PARTNER_WI
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: "Staging view for ProdView Master Data Integration"
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5dee2276-9952-42a0-ac1d-09d5b0c817c7
          stepCounter: 10c7aebf-9766-4bf6-b271-9d16a76a1e28
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        name: PVT_PVUNIT_IDREC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dfe22de8-f6e2-429b-90aa-91f793353b62
                stepCounter: d554b1ad-15ef-40f5-8fff-8a730cc8b68e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c4f8fa7-49e4-4e3b-81fa-bebdb0b020e2
          stepCounter: 10c7aebf-9766-4bf6-b271-9d16a76a1e28
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: PVT_PVUNIT_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50ee8568-df75-439d-b90f-a59a0ac2027c
                stepCounter: d554b1ad-15ef-40f5-8fff-8a730cc8b68e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee383887-d9e3-4d23-834e-a36eae28bbc2
          stepCounter: 10c7aebf-9766-4bf6-b271-9d16a76a1e28
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: PVT_PVUNITAGREEMENT_DTTMSTART
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d17862c0-d2d9-4810-9bd6-d08bcaaa0c61
                stepCounter: 7bcb7596-01b0-4e4c-ba92-80d520c65361
            transform: TO_CHAR(VIEW_CSLAND_PVIEW_PARTNERS.EFFECTIVE_DATE,'YYYYMMDD')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b55fef7b-f0e4-42cc-a01f-75a9ebdd01d8
          stepCounter: 10c7aebf-9766-4bf6-b271-9d16a76a1e28
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: PVT_PVPARTNER_PARTNERNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f580616-0373-423d-9155-124013b3df3f
                stepCounter: 7bcb7596-01b0-4e4c-ba92-80d520c65361
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70f13263-b0f2-464a-a459-b393af870c97
          stepCounter: 10c7aebf-9766-4bf6-b271-9d16a76a1e28
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PVT_PVUNITAGREEMENTPARTNER_INTEREST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7ab6046-f6a5-438c-8462-c40f9b4e4489
                stepCounter: 7bcb7596-01b0-4e4c-ba92-80d520c65361
            transform: TO_CHAR(VIEW_CSLAND_PVIEW_PARTNERS.PARTNER_PERCENT)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 63aaa243-f985-4d63-a9c2-de200550e88c
          stepCounter: 10c7aebf-9766-4bf6-b271-9d16a76a1e28
        config: {}
        dataType: VARCHAR(19)
        defaultValue: ""
        description: ""
        name: PVT_PVUNITAGREEMENTPARTNER_COM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f8404a54-456c-4e97-b857-db6c5edfa59f
                stepCounter: 7bcb7596-01b0-4e4c-ba92-80d520c65361
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGE_EDW_PVIEW_MSTR_DATA_PARTNER_WI: 10c7aebf-9766-4bf6-b271-9d16a76a1e28
          VIEW_CSLAND_PVIEW_PARTNERS: 7bcb7596-01b0-4e4c-ba92-80d520c65361
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','STAGE_EDW_PVIEW_MSTR_DATA_PARTNER_WI') }} AS (
                    SELECT PVT_PVUNIT.IDREC "PVT_PVUNIT_idrec",
                           PVT_PVUNIT.NAME "PVT_PVUNIT_name",
                           TO_CHAR(VIEW_CSLAND_PVIEW_PARTNERS.EFFECTIVE_DATE,'YYYYMMDD') "PVT_PVUNITAGREEMENT_dttmstart",
                           VIEW_CSLAND_PVIEW_PARTNERS.PARTNER_NAME "PVT_PVPARTNER_partnername",
                           TO_CHAR(VIEW_CSLAND_PVIEW_PARTNERS.PARTNER_PERCENT) "PVT_PVUNITAGREEMENTPARTNER_interest",
                           'CS file: ' || VIEW_CSLAND_PVIEW_PARTNERS.WELL_FILE_NUMBER "PVT_PVUNITAGREEMENTPARTNER_com"
                      FROM {{ ref('TARGET','VIEW_CSLAND_PVIEW_PARTNERS') }} VIEW_CSLAND_PVIEW_PARTNERS
                     INNER JOIN DS_PRODVIEW.PVT_PVUNITCOMP PVT_PVUNITCOMP
                        ON VIEW_CSLAND_PVIEW_PARTNERS.WELL_UWI = PVT_PVUNITCOMP.WELLIDREGULATORY
                     INNER JOIN DS_PRODVIEW.PVT_PVUNIT PVT_PVUNIT
                        ON PVT_PVUNITCOMP.IDRECPARENT = PVT_PVUNIT.IDREC
                   )
             UNION (
                    SELECT 'Partner Agreement' "PVT_PVUNIT_idrec",
                           NULL,
                           NULL,
                           NULL,
                           NULL,
                           NULL
                   )
             ORDER BY DECODE("PVT_PVUNIT_idrec",'Partner Agreement',0,1) ASC
        dependencies:
          - locationName: TARGET
            nodeName: ODS_PVIEW_PVT_PVUNIT
          - locationName: TARGET
            nodeName: VIEW_CSLAND_PVIEW_PARTNERS
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','ODS_PVIEW_PVT_PVUNIT') }}
            {{ ref('TARGET','VIEW_CSLAND_PVIEW_PARTNERS') }}
        name: STAGE_EDW_PVIEW_MSTR_DATA_PARTNER_WI
        noLinkRefs: []
  name: STAGE_EDW_PVIEW_MSTR_DATA_PARTNER_WI
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
