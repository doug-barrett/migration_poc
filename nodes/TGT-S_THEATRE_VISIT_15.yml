fileVersion: 1
id: 2911f98a-0d03-4465-b2ff-103449b58555
name: S_THEATRE_VISIT_15
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: adb8bfbf-aaff-4851-ac0e-87686df1a5c1
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: THEATRE_VISIT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 63a6e4b5-b1c5-411e-af31-cfa2250332bc
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9c50a7b-f632-4c1e-8053-f0d2e1a1d921
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: THEATRE_VISIT_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c3d6149-43a1-4f5d-94cb-7beeaec420bb
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6c002dd-6f3c-4a60-99d8-03491738f9d0
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: THEATRE_VISIT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 01483096-6291-4d81-9dd1-b476eecb6beb
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c54100d-9521-442c-91db-db2da8ff4171
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SCHEDULE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ba9777ff-70fb-406a-8e04-50ef425c9ec1
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6402309b-1dda-4258-b98f-c2890e355bb7
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: THEATRE_SESSION_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bb5d4164-337d-49db-b093-447f4bcd9808
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe05fea0-8339-4c07-84c7-812aa2e8a2aa
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e729c29-ce07-45e2-8e56-e0968815f0b9
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0728e049-ef43-46f1-b37a-753ce527bc46
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6348c28c-5cb8-46d4-845a-decc518ef76b
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c7bbed1-5a29-4807-8f1f-2053472c787d
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_AGE_ON_ARRIVAL_YEARS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f218e299-1014-44bc-9a9a-4afdf4e26610
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 388af103-cede-4b3d-af57-4d2c5c0eb8ab
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_AGE_ON_ARRIVAL_MONTHS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cef0d9d9-a955-457c-83f0-b1901b78b4b3
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 621be928-10e0-474f-bfff-dba54a1bdcfc
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ANAESTHETIC_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59ce3b55-5eb6-4ea3-ab89-8deb35f94e35
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d151d1d5-ca0a-497d-ab5c-4f08200cc830
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: ANTYP_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7b9a1c6-acf8-4b1e-91c5-13143d8693c9
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e00576b-7649-48f8-92d8-21abb264eb75
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SURGICAL_THEATRE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 34846642-4a88-4810-9d55-d0a0172a977d
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 12d92f1a-ea39-4dfc-987e-c8887814041b
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WARD_TRANSFER_FROM_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b7af24e-c54d-43e6-844a-6be1ba762968
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81a8f580-43cf-407d-9f10-8474527b7ec9
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WARD_TRANSFER_TO_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b7f33c2d-90a5-469c-af21-bd3a3704bf82
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77cdc872-aa36-475e-9548-811cac2f4544
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: THEATRE_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47d3126f-f54e-455e-b2e0-94f92dbc9940
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e399275-a2d3-48af-ade4-0d499f82ef26
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: REFERRAL_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 462a8519-8ed8-4978-9df5-d758e6e21e22
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: |-
              CASE WHEN s_in_patient_event_05.refrl_refno IS NULL THEN s_theatre_visit_10.referral_encounter_ID
                          ELSE 'R' + cast(s_in_patient_event_05.refrl_refno AS varchar)
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3245c1b1-a35f-4423-af9b-0a7cb2313db2
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: WAITLIST_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59e0947f-cea2-4eab-949c-3d4307c3c7c7
                stepCounter: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
            transform: |-
              CASE WHEN s_in_patient_event_05.wlist_refno IS NULL THEN 'W'+cast(s_theatre_visit_10.waitlist_reference_no AS varchar)
                          ELSE 'W'+cast(s_in_patient_event_05.wlist_refno AS varchar)
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cedb2c73-d8a9-4e6b-ab97-f27138918341
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: IP_EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea93c8c3-38ab-4680-81fa-6fd2eda7e70a
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db1c0776-e6e1-4d91-8da5-4f7743e3a8c5
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ED_ATTENDANCE_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e9816596-572b-4a54-8576-a216026dde76
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05cd5470-6d88-450a-83eb-e92c1de2bfff
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: OPERATION_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 57f7faa8-4d9e-4ea7-bf66-2726d58e45e5
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 659e3988-b501-4d5c-ae41-17851dc43772
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: THEATRE_REQUEST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b5dc2e9e-475d-48d4-a51e-5e7e1ae8c823
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1899e6a6-5cff-416f-8f44-d8cffe629a8c
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CALLED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33a60e32-7a58-437b-8cd9-1327ef734cfb
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4aa8a6be-1155-4533-94ed-826ba52878d3
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SENT_FOR_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c72d74d-2502-4807-a98e-36fa796ef1b6
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81823e6f-b35f-4085-affd-708b6eb6b2c9
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ARRIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d93bb85c-fe87-4b7b-851e-43e959ec4209
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c225c91a-a9b4-4305-9ce2-8c252d2f0e6b
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: VISIT_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e93ae615-02be-4aef-a33f-2c8880608f8d
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f8f47b57-2971-4513-bad9-e3279eb9f1dc
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SEEN_BY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77d3a576-11f2-4131-808c-16ea1212adc1
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed1b9c05-4fb4-4367-b6ab-7b81369ea849
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: READY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 327b6947-560d-4a99-b916-7c391a831a98
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20e50e7b-a113-4c2b-8452-95f14fb5d894
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: INTO_THEATRE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5de22b6b-a3f4-4b81-8afc-4a39fbda8ea9
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49336723-eeaa-4d8b-a52e-2a077c80d9a2
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ANAESTHETIC_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1c9cbb1-71f2-47bd-a91c-980e9ab8643b
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff8cbb17-fd94-4a61-a22b-c17a95d9f13b
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ANAESTHETIC_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d0490aa6-f35d-4bff-8c25-d3347ebd42a7
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5c6b807-725b-492e-91a3-24efa8b29c01
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SURGERY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 929cdc4b-08f5-415c-9cea-ddedf4e85bb0
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1847b3ae-b2a7-4b41-a63f-5e51390beb30
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SURGERY_COMPLETION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94d9fda6-c0dd-47d3-80e8-3fbe7e64dd54
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 668bc1ec-b64c-4761-946b-d053d34e944b
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: AWAKE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cc020cb7-ff42-49f1-9c6e-085b99baaaa4
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec1d437a-8f20-457b-a627-5dc400c3b5bd
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: OUT_OF_THEATRE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c8151c8-a852-447c-a186-1a2057d0f172
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b007e49e-4479-426c-9fd1-f2705c2f8e79
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: INTO_POSTOP_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2dd65234-2cb7-44b1-a39b-2e000eedd92e
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c13ef74-0ed7-42b7-a978-98ae6ece1462
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: INTO_RECOVERY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 133691f6-52b2-4652-b21b-396c62544756
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c07e1e55-047b-46e9-8fbe-1eb0a8d8ef88
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SECOND_RECOVERY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1caa49f5-ac5b-435f-a239-57661aa7c0da
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af01ad8a-3258-4b5a-817a-fdbb584a7e7d
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: OUT_OF_RECOVERY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56202483-c4c1-4922-9621-0241a713c219
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3da07946-9a35-48b3-ad27-918fd528c71a
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FIT_TO_RETURN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d421f21f-21fa-409e-ab72-3ea86d3353b7
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57bd1be8-12d0-4281-b57b-cea81acd1c84
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WARD_PHONED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eeed7002-c9a9-4943-8fa8-dc3fffa90c93
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 049b64a0-32bc-4de8-a846-0dec15c23822
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: VISIT_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c93ec6bf-7c8f-41f0-b896-323320df7708
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 273d3f25-1121-4982-b1aa-36fd10368896
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DEPARTED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 74c0bfba-839b-4cee-86e1-db2c7ca9d210
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e88eae3-fd46-4abd-9eda-5ab2d35407bf
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SESSION_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3cd11a58-90d1-41cd-b6f3-8760bf098502
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 084a8655-9094-425a-9eb1-6bc53f01bd88
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SESSION_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a949a46c-67ee-4bb7-be9e-373aa4801e82
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 459076d4-0884-4a2b-a702-b054f1e74f46
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SESSION_CANCEL_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bb083d4c-bac8-4ddc-a7e6-e676ff048f6d
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 36a2e80e-1cfc-47d2-99fd-12653c31c28a
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CANCELLATION_REASON_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4bee7d13-fc0a-4be6-adb9-2c8461546bc5
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34f1178b-e30c-4d4d-bef4-a1b372783866
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CANCELLATION_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1211577c-b7a9-469d-877b-d205de2536e8
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb9ee3cb-e066-401f-9a1a-0673a5ef1523
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CANCELLATION_BY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 358c28e4-f32c-45aa-bee2-14d60171c56b
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: afaef1cf-73d8-4d63-a6a6-cab91f4e6a59
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: THEATRE_VISIT_OUTCOME_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3bcfc4b3-535a-49f4-aed2-c9b286ae3a92
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6be53cb-7a37-4334-be93-87ea092cbd20
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: THEATRE_VISIT_OUTCOME_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf723cc5-4f18-47c8-96e0-03eed7907b9d
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 23a2bcdd-737d-46c3-90d2-5c98b26c3f8e
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: THEATRE_RECOVERY_ACUITY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ed9bf2f-d707-4f43-b7ba-3bcf6ea3913c
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 925fcb2c-a733-45d4-ab5b-0b5428376646
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: TOPA_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 270f68f7-02e3-4c77-ba36-313fa85a3e62
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a54cadc-538d-41ec-8e1a-ec1a610dabe4
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ASA_RATING_VALUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7da1215d-bdd1-49f9-a84b-00eccf985be8
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d032b10-926a-4b19-a5ca-de045f3f922c
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e3ad2ca0-0e73-473b-a2e3-9a88b5a76d55
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa419c9c-0a15-4cc4-b77c-acf710750d7f
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: THEATRE_VISIT_PRIORITY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78ade73e-fa79-4ce9-a6ac-980deb2eefcd
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 08481818-c08f-48c4-a7c0-916b6fb3a886
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: THEATRE_VISIT_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a5a458e2-b3b9-4081-aaf9-27576546755e
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55de6a6a-0bfe-4177-a905-bd308fc80d55
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Service Point Session Code "A=Actual No/Outcome", "P=Planned", "C=Cancelled"
        name: SESSION_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8855c620-a0d1-49e0-b152-6b403a526bcf
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4de84881-d4ed-4459-bdc8-dc09f9a02623
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: schedule_theatre_status_code, "A=Actual", "P=Planned", "C=Cancelled"
        name: SCHEDULE_STATUS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6de657cc-eff0-4662-949a-cb64d45b0944
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40d26b6a-8cc9-4159-8103-b08d166da560
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ATTENDANCE_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5b0b5927-691a-4975-b543-aca851da6652
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bffa0ad6-c93f-49d2-86a4-e99dc34e82a0
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DNA_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd8b1bd2-b2af-4423-80a6-2837d778e91e
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 00c7b481-4a1b-4af7-bd56-e30606679120
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMIN_CATEGORY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d6e72845-b5a6-41a7-b6de-e04d88e9b9ac
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d89c1e6-fd5f-41e2-8816-40dfcff0b678
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CODING_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 522cf696-7959-4f60-b8d1-4884d44cdbef
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4deec98c-6351-4a68-ad73-599f81ca21bc
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ACUTE_ONLIST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4db1cf78-ac88-4273-8f76-91b0d9008916
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 287cb38d-b00d-4303-895e-68433d33d8dc
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ACUTE_TARGET_OP_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00f33860-5c02-4764-9dd7-abd653a36766
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad78d410-abf9-49b8-aff2-463ff703f7e0
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACUTE_LIST_URGENCY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2e4f631-1966-423a-8aa1-19b56761bcae
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 63d306c2-181a-4970-97d3-72ac2597ffac
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: THEATRE_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51a2abef-3c02-47a2-b153-34ebe993e8a0
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf5e9b50-1429-4fe4-809b-a280e08bed38
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 45f36596-372d-40d4-9265-9a1253f6ef13
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5f2eb6a-0ae8-4bd7-a480-f1cf76d9c348
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: THEATRE_ANAESTHETIST_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 421efb41-527d-4000-90f8-0ca55ee40ebf
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 333945c2-6b73-4900-8bc7-33c9a486eab9
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRIMARY_SURGEON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 264e435d-1c43-4091-b440-60da5fc2ad1b
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88b75a8d-e73a-4bf4-af7b-74309495e9c5
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SECONDARY_SURGEON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1bf24c8f-da66-457b-93a3-c35f25c48dd2
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9acfd7b4-0f24-4e33-bbca-abda23874c66
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ASSISTANT_SURGEON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de842b58-4247-403a-b778-4b1214678dd4
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de396860-aef2-487e-bf5a-fc0d7b7d89d7
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRIMARY_ANAESTHETIST_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cae03734-5801-4af7-8490-3a5b133f02be
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25ddaf12-0654-4b15-ae53-822f8d713712
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SUPPORT_ANAESTHETIST_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 412ea66e-a463-4ec8-bdc7-ac13f0a29c7a
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1ef3a14-70a6-4d8e-b67c-02aa291caea0
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: TECHNICIAN_ANAESTHETIST_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c0aade5c-00da-4826-878c-6d4595c9afb3
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24563da0-54a5-4bd6-b261-7b74d660b294
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PRIMARY_PROCEDURE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f491acb2-c884-4586-8a32-b8a91614d31b
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f486617-19c3-4e95-b8ab-ae6f92e29da0
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_THEATRE_PRIMARY_PROCEDURE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IFNULL(dtp1.dim_theatre_procedure_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9492cdd9-a553-46fa-b9a3-787852002456
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: SECONDARY_PROCEDURE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ac301ca4-eced-41c2-9a37-a3fd9f81c56f
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dea7efdf-c6e0-4f1c-8f8b-ac35e5a1db83
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_THEATRE_SECONDARY_PROCEDURE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IFNULL(dtp2.dim_theatre_procedure_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5482abc2-2a15-4059-9332-0cc4e3fd9ae2
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: THIRD_PROCEDURE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e8147e49-4c15-4000-b117-07ed7da27617
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3948cab8-bc5f-4307-87de-14e261589e49
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_THEATRE_THIRD_PROCEDURE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IFNULL(dtp3.dim_theatre_procedure_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 52851fb1-9bd3-42f4-a5ff-be52d55bbc82
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: FOURTH_PROCEDURE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 10ef4c88-0cfb-4896-8c7d-b4eaddd418cc
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8f0d9020-66b7-44bb-9737-df28ceb17f4c
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_THEATRE_FOURTH_PROCEDURE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IFNULL(dtp4.dim_theatre_procedure_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 55b17a67-d697-4eaf-b249-22b621d9b8ef
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: FIFTH_PROCEDURE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: af02eeca-4192-405c-bab2-938956164376
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0310b98d-7a19-4705-84c9-d8ccf644d053
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_THEATRE_FIFTH_PROCEDURE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IFNULL(dtp5.dim_theatre_procedure_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e70b9aa-b601-4d74-8bf9-0c8620133e31
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: SIXTH_PROCEDURE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8828d2da-179d-49d0-b5f5-bb5fa74cd938
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6770e1b-a19e-400c-aebc-8574fa186dac
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_THEATRE_SIXTH_PROCEDURE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IFNULL(dtp6.dim_theatre_procedure_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 08aa7fdf-93c7-4749-a3e2-8136cc18d8ab
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: SEVENTH_PROCEDURE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e14dd83-a252-4474-a6fc-0f5d6833e956
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01c59994-afd8-4113-9e40-1c5f13611b91
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_THEATRE_SEVENTH_PROCEDURE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IFNULL(dtp7.dim_theatre_procedure_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d871d50-2010-4ac8-a95f-011e6c5fd55c
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: EIGHTH_PROCEDURE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2aecb94-d0d3-4f8c-b9fe-807daf4df34d
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2357636a-5197-48a2-a9c7-cd9e47da4eae
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_THEATRE_EIGHTH_PROCEDURE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IFNULL(dtp8.dim_theatre_procedure_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64367131-c288-4a3a-b358-9f7272ca3a4c
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: NINTH_PROCEDURE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5bacc4e5-bdd0-4b39-a6b8-fa661eb62f17
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b22368b-7cdc-4259-ae59-f49a9bee89e0
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Generated artificial key
        name: DIM_THEATRE_NINTH_PROCEDURE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: IFNULL(dtp9.dim_theatre_procedure_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 359f81c3-a98e-4026-b8e0-0e401b65c411
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: TENTH_PROCEDURE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d811a3f5-1431-4d9f-9ec9-eb8d947918b1
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e8679cb-cc53-4f9a-ba58-5543132223ca
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: IP_ADMISSION_ACUTE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ac79f00d-f539-43be-acea-00116a940e88
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 748af717-24f2-4e53-b7d1-f1d5a1c1918a
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ACUTE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4db1cf78-ac88-4273-8f76-91b0d9008916
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: |-
              CASE WHEN s_theatre_visit_10.acute_onlist_date IS NULL THEN CASE WHEN s_theatre_visit_10.IP_admission_acute_flag IS NULL THEN CASE s_theatre_visit_10.session_type_reference_no WHEN 203606 THEN 'N' WHEN 203607 THEN 'Y' ELSE 'N' END ELSE s_theatre_visit_10.IP_admission_acute_flag END
                          ELSE 'Y'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f39501c8-d9f0-41af-8bff-c90f6202a9c0
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: IN_HOURS_CASE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72e80eb3-4434-467d-b938-d4b5ea5f356d
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 419c501a-81fd-492d-866f-1e78b61b17ca
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: OVERUN_CASE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f45ff982-1815-43bf-bdc8-2359080a5e23
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc21479c-cbfa-499d-8e03-090f135a8617
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: TIMEOUT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 74320e73-6bd9-4bfc-86ab-d1bfa6d80f30
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0f5c33a-99b9-4c42-818a-27f3d01d5476
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: VARCHAR(800)
        defaultValue: ""
        description: ""
        name: SCHEDULE_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3cbde224-a082-4d4a-b21c-b3c603a9c625
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7908bc6-cf61-4682-ac20-1d2d7d16237d
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: IN_THEATRE_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2f4b5a1-7212-4565-9ce6-c6ade7adbc37
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9575185-fb3f-42d2-9bbb-25b8b7222b2f
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Schedule notes for the theatre visit
        name: THEATRE_NOTE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6154860c-f2da-4aa4-8a82-7c6816de4fa3
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff02e516-5733-4e6d-b4f0-496a7158f434
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Clinician notes for the encounter.
        name: THEATRE_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0a0772e6-2fb1-4ec4-814d-fa809b607a5d
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67ba696b-b43f-4499-958e-24e5ed8d51c9
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: RECOVERY_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d16605b2-d525-416b-b2c2-de650c5c9ff8
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: daf83370-5c3d-45df-b09b-8887834cc9a6
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DURATION_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 296120ac-8707-4836-8707-f0ca8bfd5b1d
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: "'minute'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 547e4ca7-afb9-466e-9119-b580f4bebe77
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: THEATRE_VISIT_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 296120ac-8707-4836-8707-f0ca8bfd5b1d
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2876828-a5b0-4e53-a232-e08395cbd524
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SCHEDULED_OPERATION_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03679ffd-1f52-46eb-a956-1aec81124023
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 471c0058-6363-43df-a1a3-3af820545c67
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SCHEDULED_ANAESTHETIC_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a6d9ff4-002f-4cfb-ba59-925eb61dae99
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b81e828-993e-4a00-a736-9ab6b3b4a268
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ANAESTHETIC_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 74fdde8d-c769-4dc1-bc98-ff9d89b26f50
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8bed692d-4200-464e-95dd-a3ded782f6bc
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: KNIFE_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 44b16e51-564d-4f66-9e9e-8c3f427702f9
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aeb3f61f-45a9-4278-83af-7b57cf0a65f1
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: IN_THEATRE_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b3db1b6e-b33d-4163-89f0-47ca48fe0277
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d5dd528-6be9-4ffb-a233-24386f79a341
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_INTO_THEATRE_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 836ebdf9-ec59-497f-a663-104f08a3f27f
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc5eba21-263d-4ed8-bb0b-c46cbae63045
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SESSION_INTO_THEATRE_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 04c94338-e8bb-4145-a27d-075b9ac02b2a
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8bed24fa-cfb1-4df0-96a5-0ed7fcbe85bb
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SESSION_FIRST_THEATRE_VISIT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6806ce5b-d2be-4c54-99d2-ba8208eac37f
                stepCounter: c9bb6f82-1b38-4237-8453-17e8f161a032
            transform: "'T'+CONVERT(varchar,s_shared_schedule_theatre_pev_next.session_first_theatre_visit_encounter_id)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6d9a45f-957c-4ba0-a3ac-82fd3c929018
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SESSION_LAST_THEATRE_VISIT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 63617700-4df1-4c68-a0de-1fc348cb169b
                stepCounter: c9bb6f82-1b38-4237-8453-17e8f161a032
            transform: "'T'+CONVERT(varchar,s_shared_schedule_theatre_pev_next.session_last_theatre_visit_encounter_id)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5aff029b-5cd7-44f9-979d-1d9426f97f3e
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SESSION_PREVIOUS_THEATRE_VISIT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: acb9a26a-f7a3-42f3-9c69-e4c938c9379c
                stepCounter: c9bb6f82-1b38-4237-8453-17e8f161a032
            transform: "'T'+CONVERT(varchar,s_shared_schedule_theatre_pev_next.session_previous_theatre_visit_encounter_id)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a0f09d5-4804-4a4c-b334-4ddfdfb2cdef
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: SESSION_NEXT_THEATRE_VISIT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f16bea9b-f539-4d95-9525-f5548456da34
                stepCounter: c9bb6f82-1b38-4237-8453-17e8f161a032
            transform: "'T'+CONVERT(varchar,s_shared_schedule_theatre_pev_next.session_next_theatre_visit_encounter_id)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3925fac-8701-488d-8e69-32cfa30ba28f
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SESSION_PREVIOUS_INTO_THEATRE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07d79a81-f6d8-4d01-ae44-db01d09246ba
                stepCounter: c9bb6f82-1b38-4237-8453-17e8f161a032
            transform: -- IFNULL(s_theatre_visit_prev.into_theatre_date,s_theatre_visit_prev.visit_start_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 56313a09-a2cd-4885-a3ad-1428ec9607db
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SESSION_PREVIOUS_OUT_OF_THEATRE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c396f821-5a38-4b69-89f9-b987b9dca171
                stepCounter: c9bb6f82-1b38-4237-8453-17e8f161a032
            transform: |-
              --CASE WHEN s_theatre_visit_10.session_into_theatre_seq_num = 1
               --  THEN s_theatre_visit_10.into_theatre_date
               --   ELSE COALESCE(s_theatre_visit_prev.out_of_theatre_date,s_theatre_visit_prev.into_postop_date,s_theatre_visit_prev.visit_end_date)
               --    END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce5501f1-d2e9-4a96-945c-c04aef99377a
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SESSION_NEXT_INTO_THEATRE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47e8c1d9-7488-4a1a-b000-fbcd6beec962
                stepCounter: c9bb6f82-1b38-4237-8453-17e8f161a032
            transform: --IFNULL(s_theatre_visit_next.into_theatre_date,s_theatre_visit_next.visit_start_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 977ce140-0425-4619-a2e4-bdcd0f71c6c7
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SESSION_NEXT_OUT_OF_THEATRE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 911dfb31-6071-4b13-b8c1-685c73919fc1
                stepCounter: c9bb6f82-1b38-4237-8453-17e8f161a032
            transform: -- COALESCE(s_theatre_visit_next.out_of_theatre_date,s_theatre_visit_next.into_postop_date,s_theatre_visit_next.visit_end_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ca30248-0235-481c-8be8-c4632159b1bd
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_THEATRE_VISIT_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f92d557-3bdc-453c-87f5-c9fe87b127a3
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 566adac6-b020-42ae-b6b5-07ab618eacdf
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_THEATRE_VISIT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0e072c7d-f467-4908-98b9-7711e233380d
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee5197a6-a4cd-4288-969d-21d979947946
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: BOOKED_START
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee078044-d250-4846-b84b-6eff484f190d
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 482b5199-9580-486b-b111-a3eb27e429d3
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: BOOKED_END
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bd9ca8e8-08a8-44be-b357-aee2ea2cff79
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 51439452-a614-4f56-a572-6d26d288c250
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ACC_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 34e72c42-bc7e-4d84-b463-d80d1645be78
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e6b167d-b073-46a2-bcaa-8e5efca36fc1
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: surgeon_duration
        name: SURGEON_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: datediff(mi, CASE WHEN s_theatre_visit_10.session_start_date >= s_theatre_visit_10.anaesthetic_start_date THEN s_theatre_visit_10.session_start_date ELSE s_theatre_visit_10.anaesthetic_start_date END, CASE WHEN s_theatre_visit_10.out_of_theatre_date >= s_theatre_visit_10.session_end_date THEN s_theatre_visit_10.session_end_date ELSE s_theatre_visit_10.out_of_theatre_date END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9956b49-0a93-4aaa-8d4d-bcdd36b430a3
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: source_system
        name: SOURCE_SYSTEM
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2a5795a-2edb-4fd6-acdc-917ef6775e33
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f6e42b13-174c-4c87-be2c-91c92a943a7d
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e8a039d-b8f4-414e-b209-50f14b757000
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7f46600-1462-40aa-af2c-9267da7a2d2e
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a13978ec-f1ba-4a39-bdaf-2e564c8716b9
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIFY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0a77e914-d565-4763-8dad-188b08ab9958
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a824a134-4a8b-4345-9d18-f93d79c2081b
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MODIFY_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f261586-2a9e-4ab6-b998-7b2d93f3f36c
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 216c1baf-4f44-4d71-afc4-4732b97bb5ec
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2e92e3cb-014a-4e6f-8f68-186f5fa63e30
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8573e16f-bc25-4fd6-a64c-b92d504b7b11
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: DSS_DATA_QUALITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e00e1a39-8066-429b-bca8-f3985f5d8542
                stepCounter: 623f163a-1ca2-4a73-90b2-7c045ad6da8f
            transform: |-
              CASE WHEN s_theatre_visit_10.theatre_visit_reference_no IS NULL THEN CASE WHEN s_theatre_visit_10.dss_data_quality_code IS NOT NULL THEN s_theatre_visit_10.dss_data_quality_code + ',THEVE' ELSE 'THEVE' END
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee033fc7-1857-4c12-a61b-4d701f29cee2
          stepCounter: 2911f98a-0d03-4465-b2ff-103449b58555
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DIM_THEATRE_PROCEDURE: 840b1a44-55c1-4cbc-9199-4415e254bce4
          S_IN_PATIENT_EVENT_05: f0fafd40-0f27-49a1-9550-5ecbe8b1e50f
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_THEATRE_VISIT_10
          - locationName: TGT
            nodeName: DIM_THEATRE_PROCEDURE
          - locationName: TGT
            nodeName: S_IN_PATIENT_EVENT_05
        join:
          joinCondition: |-
            FROM s_theatre_visit_10
              JOIN s_shared_schedule_theatre_pev_next
                ON 'T'+CONVERT(varchar,s_shared_schedule_theatre_pev_next.theatre_visit_encounter_id) = s_theatre_visit_10.theatre_visit_encounter_id --LEFT OUTER JOIN s_theatre_visit_10 s_theatre_visit_prev      --ON s_theatre_visit_10.theatre_session_reference_no = s_theatre_visit_prev.theatre_session_reference_no     -- AND s_theatre_visit_10.session_into_theatre_seq_num - 1 = s_theatre_visit_prev.session_into_theatre_seq_num         -- LEFT OUTER JOIN s_theatre_visit_10 s_theatre_visit_next    --  ON s_theatre_visit_10.theatre_session_reference_no = s_theatre_visit_next.theatre_session_reference_no     -- AND s_theatre_visit_10.session_into_theatre_seq_num + 1 = s_theatre_visit_next.session_into_theatre_seq_num        -- LEFT OUTER JOIN s_theatre_visit_10 s_theatre_visit_first    --  ON s_theatre_visit_10.theatre_session_reference_no = s_theatre_visit_first.theatre_session_reference_no     -- AND s_theatre_visit_first.session_into_theatre_seq_num = 1        --LEFT OUTER JOIN s_theatre_visit_10 s_theatre_visit_last      --ON s_theatre_visit_10.theatre_session_reference_no = s_theatre_visit_last.theatre_session_reference_no      --AND s_theatre_visit_last.session_into_theatre_seq_num = s_theatre_visit_last.session_into_theatre_count     LEFT OUTER JOIN {{ ref('TGT','DIM_THEATRE_PROCEDURE') }} dtp1  on s_theatre_visit_10.primary_Procedure_reference_no = dtp1.theatre_procedure_reference_no  and s_theatre_visit_10.visit_start_date between dtp1.dss_start_date and dtp1.dss_end_date  LEFT OUTER JOIN {{ ref('TGT','DIM_THEATRE_PROCEDURE') }} dtp2  on s_theatre_visit_10.secondary_Procedure_reference_no= dtp2.theatre_procedure_reference_no  and s_theatre_visit_10.visit_start_date between dtp2.dss_start_date and dtp2.dss_end_date  LEFT OUTER JOIN {{ ref('TGT','DIM_THEATRE_PROCEDURE') }} dtp3  on s_theatre_visit_10.third_Procedure_reference_no= dtp3.theatre_procedure_reference_no  and s_theatre_visit_10.visit_start_date between dtp3.dss_start_date and dtp3.dss_end_date  LEFT OUTER JOIN {{ ref('TGT','DIM_THEATRE_PROCEDURE') }} dtp4  on s_theatre_visit_10.fourth_Procedure_reference_no= dtp4.theatre_procedure_reference_no  and s_theatre_visit_10.visit_start_date between dtp4.dss_start_date and dtp4.dss_end_date  LEFT OUTER JOIN {{ ref('TGT','DIM_THEATRE_PROCEDURE') }} dtp5  on s_theatre_visit_10.fifth_Procedure_reference_no= dtp5.theatre_procedure_reference_no  and s_theatre_visit_10.visit_start_date between dtp5.dss_start_date and dtp5.dss_end_date  LEFT OUTER JOIN {{ ref('TGT','DIM_THEATRE_PROCEDURE') }} dtp6  on s_theatre_visit_10.sixth_Procedure_reference_no= dtp6.theatre_procedure_reference_no  and s_theatre_visit_10.visit_start_date between dtp6.dss_start_date and dtp6.dss_end_date  LEFT OUTER JOIN {{ ref('TGT','DIM_THEATRE_PROCEDURE') }} dtp7  on s_theatre_visit_10.seventh_Procedure_reference_no= dtp7.theatre_procedure_reference_no  and s_theatre_visit_10.visit_start_date between dtp7.dss_start_date and dtp7.dss_end_date  LEFT OUTER JOIN {{ ref('TGT','DIM_THEATRE_PROCEDURE') }} dtp8  on s_theatre_visit_10.eighth_Procedure_reference_no= dtp8.theatre_procedure_reference_no  and s_theatre_visit_10.visit_start_date between dtp8.dss_start_date and dtp8.dss_end_date  LEFT OUTER JOIN {{ ref('TGT','DIM_THEATRE_PROCEDURE') }} dtp9  on s_theatre_visit_10.ninth_Procedure_reference_no= dtp9.theatre_procedure_reference_no  and s_theatre_visit_10.visit_start_date between dtp9.dss_start_date and dtp9.dss_end_date    LEFT OUTER JOIN {{ ref('TGT','S_IN_PATIENT_EVENT_05') }}  ON s_theatre_visit_10.IP_event_encounter_id = s_in_patient_event_05.event_encounter_id
        name: S_THEATRE_VISIT_15
        noLinkRefs: []
  name: S_THEATRE_VISIT_15
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
