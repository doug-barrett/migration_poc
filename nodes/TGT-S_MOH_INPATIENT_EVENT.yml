fileVersion: 1
id: 4f3a140c-4538-475d-957c-8dba40572d60
name: S_MOH_INPATIENT_EVENT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 272a0c10-ab53-4e5a-b9a9-6c1ac5bb09f6
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: EVENT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 598a5e00-b7ea-415b-a74b-51bc84171ef6
                stepCounter: 78106b42-f7ca-41fe-bfbd-b17e6241f662
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f4d5c4b0-f2a4-43bc-801e-8545511480cd
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: PIMS unique event identifier.
        name: EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c0b3b7e2-ebaa-42b8-9db8-679dafe900f3
                stepCounter: 78106b42-f7ca-41fe-bfbd-b17e6241f662
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b504278f-9759-487b-89b7-e7f595ccdb72
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 58f3bc3c-9ca9-4445-b6b0-996eb40df49d
                stepCounter: 78106b42-f7ca-41fe-bfbd-b17e6241f662
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 179531c4-ff94-429f-906b-b28b81c72928
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: EVENT_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b0b19ea-4a9c-4fdf-905c-495db7ed08c7
                stepCounter: 78106b42-f7ca-41fe-bfbd-b17e6241f662
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e59ff7b-5f2d-4c08-8715-c7048046cdc2
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: EVENT_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ab00740-1a81-4666-af31-3c74b7f4475b
                stepCounter: 78106b42-f7ca-41fe-bfbd-b17e6241f662
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da71d6e7-b127-445a-8d34-158555c670a2
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: EVENT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 780dc236-90ce-4443-9163-6bc750ec9a0a
                stepCounter: 78106b42-f7ca-41fe-bfbd-b17e6241f662
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f6b2d0a-4c1d-4e5a-8ab9-be2c3c9591fe
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: EVENT_END_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48b8b9b1-67c7-44c7-85a1-384fad0ec608
                stepCounter: 78106b42-f7ca-41fe-bfbd-b17e6241f662
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 009d1d72-1d36-4761-9dba-687852e0e29e
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: LENGTH_OF_STAY_MINS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 123f1b6c-91e3-486e-afb1-4b2e4334339f
                stepCounter: 78106b42-f7ca-41fe-bfbd-b17e6241f662
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59dc661d-d865-4805-9996-0edbd12d4074
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: ""
        name: LENGTH_OF_STAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2680b220-7dd6-4fb0-a41b-98658b782ba8
                stepCounter: 78106b42-f7ca-41fe-bfbd-b17e6241f662
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c89f340-3fd9-41fc-832a-95f8a3355eaf
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: ADMISSION_SOURCE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec4c964e-2238-4ef4-a75c-11fd55d94d09
                stepCounter: 78106b42-f7ca-41fe-bfbd-b17e6241f662
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 364988e4-eadd-4734-995f-f2d18a5d32af
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: ADMISSION_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e20210ba-8edb-4e9e-9ae3-d189df2aaa10
                stepCounter: 78106b42-f7ca-41fe-bfbd-b17e6241f662
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dea2e436-cd8b-4cae-a093-b50bc5de2780
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: AGENCY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 647ea021-04cb-4ff4-9baf-02e099d44129
                stepCounter: 78106b42-f7ca-41fe-bfbd-b17e6241f662
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7de4df39-b2f1-4966-8f01-72e522b96104
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: DOMICILE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6cb9b146-4e69-43f6-880d-2741f9df8bb8
                stepCounter: 78106b42-f7ca-41fe-bfbd-b17e6241f662
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e8365e3-f270-44ff-a73a-d1551d588347
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: CCL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cc991e0a-7c24-41c6-b126-de6fa83be491
                stepCounter: 78106b42-f7ca-41fe-bfbd-b17e6241f662
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a07c83c-8488-4099-a3b6-63e775f4c948
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: PCCL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 29094f73-0381-4122-a254-301121ecdd7a
                stepCounter: 78106b42-f7ca-41fe-bfbd-b17e6241f662
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e8e8d4d-dc6d-4ebd-b164-e82d7fa9608f
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: NUMERIC(8,4)
        defaultValue: ""
        description: ""
        name: COST_WEIGHT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 811ae66a-422a-4ff5-9ea6-ef820865b2f4
                stepCounter: 78106b42-f7ca-41fe-bfbd-b17e6241f662
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d1f8fc90-2c1a-42fb-b830-e91c64ef29c3
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: COST_WEIGHT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 704550be-806f-4780-84fc-65eedef02e35
                stepCounter: 78106b42-f7ca-41fe-bfbd-b17e6241f662
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48e4e035-0c68-42ab-8555-6f4f491028ca
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: DRG_CODE_CURRENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 41face80-aa3c-4cc9-af4c-5a0f689325e7
                stepCounter: 78106b42-f7ca-41fe-bfbd-b17e6241f662
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dd410b35-174e-4f77-a652-cac65fccb740
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: DRG_GROUPER_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d7c5826-f1fd-4695-8908-640535623855
                stepCounter: 78106b42-f7ca-41fe-bfbd-b17e6241f662
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7cd348f-f61e-4c34-a921-7221b777a7ea
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: FACILITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ff49f36-e01b-47d6-a090-b1f6c64edf9f
                stepCounter: 78106b42-f7ca-41fe-bfbd-b17e6241f662
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3c6612c-e38b-4ef2-b541-e09eed791b0d
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: FACILITY_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b5f834b-08a1-48e7-80c8-402f2e18251f
                stepCounter: 78106b42-f7ca-41fe-bfbd-b17e6241f662
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01bb9359-2b24-44b9-ad56-fe36a694884d
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: FACILITY_TRANSFER_FROM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6b51b3c5-86d2-491a-b37a-6a19e48046f0
                stepCounter: 78106b42-f7ca-41fe-bfbd-b17e6241f662
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c38d9d8-3ca4-4e6f-b11f-5d601688167f
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: FACILITY_TRANSFER_TO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0650d912-8ea7-46f3-b607-203cc100848b
                stepCounter: 78106b42-f7ca-41fe-bfbd-b17e6241f662
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6aa1b88c-922f-4a4c-a505-22602290d50e
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: FUNDING_AGENCY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 89008c7e-6bf2-4048-ab19-6485a2c7a32a
                stepCounter: 78106b42-f7ca-41fe-bfbd-b17e6241f662
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e9d721d-3317-4a06-a16f-277c58cb55a0
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: PRIVATE_HOSPITAL_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6fadbcb-655e-4840-9110-febfb8ef2655
                stepCounter: 78106b42-f7ca-41fe-bfbd-b17e6241f662
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 00ac3519-71a9-4952-a56a-e894eb6c34c7
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: HEALTH_SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4da79427-1512-460f-a408-89ed76eca766
                stepCounter: 78106b42-f7ca-41fe-bfbd-b17e6241f662
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f236f68-8126-41cf-9491-d7442b7f1a97
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: MDC_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd081933-0bcb-437d-bd19-1c1ce399b899
                stepCounter: 78106b42-f7ca-41fe-bfbd-b17e6241f662
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04e268ba-7926-4ab4-966f-e05f0bde6554
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: MDC_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e59980be-e7bc-43bb-9718-c8648b2077e0
                stepCounter: 78106b42-f7ca-41fe-bfbd-b17e6241f662
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1be2a9f-6302-473a-91bc-8829046bc771
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: NZ_DRG_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa1898ff-f1b4-4581-9a6e-ead55ac027c3
                stepCounter: 78106b42-f7ca-41fe-bfbd-b17e6241f662
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2eb69fa9-4414-437c-86a4-dbeae6c16e51
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PRINCIPAL_DIAG_14_CLIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a89e071-dfeb-43c8-a4a5-d85c491933d1
                stepCounter: 78106b42-f7ca-41fe-bfbd-b17e6241f662
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b28a25f1-011b-4c93-9d71-70e809c97e4f
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: CLINICAL_CODE_SYSTEM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a89e071-dfeb-43c8-a4a5-d85c491933d1
                stepCounter: 78106b42-f7ca-41fe-bfbd-b17e6241f662
            transform: "'14'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b3c5542-d531-4d5c-8b18-0386a36e1ab8
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: VARCHAR(2)
        defaultValue: ""
        description: ""
        name: PURCHASER_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ba289f27-755d-4c7c-901e-a558bd21002d
                stepCounter: 78106b42-f7ca-41fe-bfbd-b17e6241f662
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e61db4a-fb17-45ed-b342-6015ee2b9102
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6c4ce36-ad28-4dab-a818-f8d8eec5b8e3
                stepCounter: 78106b42-f7ca-41fe-bfbd-b17e6241f662
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4fd4ccf-66aa-4d3a-a203-c0dfc2a724e9
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PURCHASE_UNIT_CODE_WDHB
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bd4036a8-3351-4a31-8baf-ac02b6a50af3
                stepCounter: 78106b42-f7ca-41fe-bfbd-b17e6241f662
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72dfbd72-ca1e-4b8a-b7bf-d7431b818b31
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: VARCHAR(8)
        defaultValue: ""
        description: ""
        name: EXCLU_PURCHASE_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0d3c76ae-ad41-4000-825d-5f46111b1646
                stepCounter: 78106b42-f7ca-41fe-bfbd-b17e6241f662
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 89c17b59-84b6-4ea8-876c-fc0d41b2b0e7
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: ACCIDENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a06c4c5d-0ac1-4eb8-ab36-ca16d3567226
                stepCounter: 78106b42-f7ca-41fe-bfbd-b17e6241f662
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b04bfebc-d5de-43dc-b935-8c95a9d764a1
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ACC_CLAIM_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4c87912-9cc5-4936-83de-86d4e86b949b
                stepCounter: 78106b42-f7ca-41fe-bfbd-b17e6241f662
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb8ee9c1-8cf3-4f76-b993-7fcd6042d360
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: BATCH_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83d453f6-76d8-49bc-9b32-6af70045b018
                stepCounter: 78106b42-f7ca-41fe-bfbd-b17e6241f662
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 181615b2-967f-4845-9c62-a30c29292f5e
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: CLIENT_SYSTEM_IDENTIFIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 866b875d-8bfc-4c8c-88f8-1d68860ce3ba
                stepCounter: 78106b42-f7ca-41fe-bfbd-b17e6241f662
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6de5fc82-9df1-4f83-86ac-12c56a574a48
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: TRANSACTION_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5362aab6-9a28-4e42-9982-e8cc10ae3db0
                stepCounter: 78106b42-f7ca-41fe-bfbd-b17e6241f662
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06d73646-30d3-4ddf-b796-607b3a2e24ac
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: LAST_UPDATED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a6d67c7-716a-4f0a-99ae-d7f3fa37ba65
                stepCounter: 78106b42-f7ca-41fe-bfbd-b17e6241f662
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3ada6ff-083d-4422-b647-230ac6fdd796
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_MOH_inpatient_event.event_start_date=dim_start_date.start_calendar_date
        name: DIM_START_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4e465c3-6432-4578-b9e4-7938382edf1c
                stepCounter: b5d2a386-b1bd-4a43-9c5e-529fea37aabc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ad2e891-3193-453b-884c-c7726598e030
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_MOH_inpatient_event.event_end_date=dim_end_date.end_calendar_date
        name: DIM_END_DATE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4d9153c2-cb24-4faa-b10e-532b545578f9
                stepCounter: 877af827-33b7-4837-bc4a-455508456121
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc2d43e0-b5b8-4e19-a6cb-11d517c42d25
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_MOH_inpatient_event.domicile_code=dim_domicile.domicile_code
        name: DIM_DOMICILE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e049fc8-a2a3-4bad-9b91-11b9d158b35e
                stepCounter: 330ad0aa-b8b1-4da9-ab37-b4fe8f889452
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc8b9d0f-3c63-4431-a2bf-3ec0c73523fc
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_MOH_inpatient_event.facility_code=dim_health_facility.health_facility_code
        name: DIM_HEALTH_FACILITY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6bf6bd17-b626-4e3a-ab8c-d3ff41850356
                stepCounter: 2f6f101b-8a09-4182-a969-06add4b17ff5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 46ccc551-190b-4e37-8e81-9ad771cb1629
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_MOH_inpatient_event.facility_transfer_from=dim_health_facility_from.from_health_facility_code
        name: DIM_HEALTH_FACILITY_FROM_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b5a90855-f242-42f3-bb9e-42761c1576f4
                stepCounter: 0c81e176-1f7a-43ab-8d68-82da6a43bf68
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8cc35eaa-a4fc-487d-b9f0-a0584e59890c
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_MOH_inpatient_event.facility_transfer_to=dim_health_facility_to.to_health_facility_code
        name: DIM_HEALTH_FACILITY_TO_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1266322f-c4c7-470f-b80c-8c041bd8e79d
                stepCounter: 508b5385-3583-4d08-8721-2b44f8715ad4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f1064f75-1d4c-4079-bf10-a6b7df2f0d8c
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_MOH_inpatient_event.facility_code=dim_hospital.health_org_reference_no
        name: DIM_HOSPITAL_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c1eff0c-fd0d-4a47-ad0f-2fd4a80c00a7
                stepCounter: ce5e5ba3-482d-46a9-a8ae-9f160067f51d
            transform: IFNULL(dim_hospital_key, 0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 12c642ba-628c-431d-9a0a-6348ce6a7b17
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_MOH_inpatient_event.patient_NHI=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9962a01b-5f3d-4c1a-b371-997edef38d0f
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: IFNULL(dim_patient_key, 0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 52b2ba2d-a29d-491b-9bbf-c86bce2d64d3
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_MOH_inpatient_event.purchase_unit_code_wdhb=dim_purchase_unit.purchase_unit_code
        name: DIM_PURCHASE_UNIT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d9c041f-76d6-44c7-8d88-936673dfd7a0
                stepCounter: d198650d-0f77-489d-92ec-0c0257cd5a43
            transform: IFNULL(dim_purchase_unit_key,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d48df5da-37ee-41f9-a62c-c84a2c040cb4
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_MOH_inpatient_event.domicile_code=dim_purchaser.purchaser_reference_no
        name: DIM_PURCHASER_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5359e9e9-a873-4f6d-8b70-005d22be8ed1
                stepCounter: 83d04de3-0551-4ba3-814b-2ca3e4840adf
            transform: IFNULL(dim_purchaser_key, 0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cab86f6d-bc63-427e-b35e-abfdbbcc7485
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_MOH_inpatient_event.admission_type=dim_MOH_admission_type.admission_type_code
        name: DIM_MOH_ADMISSION_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ece3d059-1d23-44cb-81f3-913d83843e5f
                stepCounter: 364dc965-e2be-40db-b284-328a39d4c07c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad2516cc-af52-4b29-9432-79d89a7987ce
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_MOH_inpatient_event.agency_code=dim_MOH_agency.agency_code
        name: DIM_MOH_AGENCY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4de1494-3392-4c56-9ab5-137dbdcadc3a
                stepCounter: 8fe8f9aa-3d04-4fb3-9aaa-8d00c730f585
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc4c3a04-11aa-4793-8a7b-3143cf847e38
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_MOH_inpatient_event.principal_diag_14_clin_code=dim_MOH_clinical_code.clinical_code  s_MOH_inpatient_event.clinical_code_system=dim_MOH_clinical_code.clinical_code_system
        name: DIM_MOH_CLINICAL_CODE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 61354441-9fd2-4e65-a584-6a24e7a8a39b
                stepCounter: 8d2822aa-df7e-4283-ad96-12476e3713a0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98103c02-feac-4257-8b93-761525e365ae
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_MOH_inpatient_event.drg_code_current=dim_MOH_DRG.drg_code  s_MOH_inpatient_event.drg_grouper_type=dim_MOH_DRG.drg_grouper_type
        name: DIM_MOH_DRG_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c848c9c-7c12-4cf4-b9c7-6feadbf87b9e
                stepCounter: caef4129-86b1-42c8-ac02-b940e4cff5aa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f006998-c6eb-4c66-8a29-faa5ce0e40ee
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_MOH_inpatient_event.event_type=dim_MOH_event_type.event_type
        name: DIM_MOH_EVENT_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b7f54e06-90db-4356-85d9-f7938b092e2c
                stepCounter: 6b8fad6b-df0f-406c-90a9-259147eb3fe9
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be0ffbbd-1312-45da-a8e8-677c15824938
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_MOH_inpatient_event.event_end_type=dim_MOH_event_end_type.Event_End_Type_Code
        name: DIM_MOH_EVENT_END_TYPE_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f3caec7f-57c2-4767-a51f-a827cb57f7e8
                stepCounter: f2522e0c-3a2e-4d57-92a5-41179d44fa82
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 888ae94f-e7b9-46ef-8fbd-f1926a91a91f
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_MOH_inpatient_event.agency_code=dim_MOH_facility.agency_code  s_MOH_inpatient_event.facility_code=dim_MOH_facility.facility_code
        name: DIM_MOH_FACILITY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 761d48f1-aa04-4e5a-b03c-2039350337cd
                stepCounter: c4cdadfb-e6b3-4a34-a7fa-90dba7f7b082
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07d2ad8c-6a01-4436-b5ae-e79b3be57ad8
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_MOH_inpatient_event.funding_agency_code=dim_MOH_funding_agency.funding_agency_code
        name: DIM_MOH_FUNDING_AGENCY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a52fb624-19cc-424e-b5fe-fea18375c003
                stepCounter: 46d041e9-5067-449a-82cf-baff7c97a211
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8888d754-8e3f-4ee1-86d5-6f7e40e34921
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_MOH_inpatient_event.health_specialty_code=dim_MOH_health_specialty.health_specialty_code
        name: DIM_MOH_HEALTH_SPECIALTY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4d7df87-2df3-4b57-8f52-ed903baa503c
                stepCounter: ee36cf91-4a1a-41fe-bd9f-1a939711cdc0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3436c047-66ac-4f01-8a07-ef4599d4f708
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_MOH_inpatient_event.patient_NHI=dim_MOH_patient.patient_NHI
        name: DIM_MOH_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 42721219-e6bb-4c0c-9510-ba532bae967c
                stepCounter: 83afafa7-1a83-4091-b54b-834fcd1db1fc
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c61dc8c-6c7d-4c99-a7a4-12b3692e48f9
          stepCounter: 4f3a140c-4538-475d-957c-8dba40572d60
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_MOH_INPATIENT_EVENT_10
        join:
          joinCondition: |-
            FROM s_MOH_inpatient_event_10
              LEFT OUTER JOIN dim.dim_hospital
                ON dim_hospital.hospital_id = s_MOH_inpatient_event_10.facility_code
               AND dim_hospital.dss_current_flag = 'Y'
              LEFT OUTER JOIN dim.dim_patient
                ON dim_patient.patient_NHI = s_MOH_inpatient_event_10.patient_NHI
               AND dim_patient.NHI_sequence = 1
              LEFT OUTER JOIN dim.dim_purchaser
                ON dim_purchaser.purchaser_code = s_MOH_inpatient_event_10.purchaser_code
               AND dim_purchaser.dss_current_flag = 'Y'
              LEFT OUTER JOIN dim.dim_purchase_unit
                ON dim_purchase_unit.purchase_unit_code = CASE WHEN s_MOH_inpatient_event_10.purchase_unit_code_wdhb ='EXCLU' THEN s_MOH_inpatient_event_10.exclu_purchase_unit
                        ELSE s_MOH_inpatient_event_10.purchase_unit_code_wdhb
                         END
               AND event_end_date BETWEEN dim_purchase_unit.validity_start_date AND dim_purchase_unit.validity_end_date
        name: S_MOH_INPATIENT_EVENT
        noLinkRefs: []
  name: S_MOH_INPATIENT_EVENT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
