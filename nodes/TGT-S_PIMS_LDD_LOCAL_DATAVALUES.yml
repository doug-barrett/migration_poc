fileVersion: 1
id: ab327c0c-c1f6-447f-9a93-8536f7688389
name: S_PIMS_LDD_LOCAL_DATAVALUES
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8599b99-94ca-43b2-aaec-f8ac41e5fe06
          stepCounter: ab327c0c-c1f6-447f-9a93-8536f7688389
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: LCLDA_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33cea034-3dbc-4d22-bebb-e7f89999e877
                stepCounter: e576884f-f915-4be8-9d8b-527b62d32310
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e70b457c-76ac-4814-9b77-18a4d68a679d
          stepCounter: ab327c0c-c1f6-447f-9a93-8536f7688389
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CONTACT_SEQUENCE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6b93db35-5f48-41f9-9a26-822c8a38197f
                stepCounter: e576884f-f915-4be8-9d8b-527b62d32310
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0cf5e53c-c39e-460c-9781-3a96af0a3df9
          stepCounter: ab327c0c-c1f6-447f-9a93-8536f7688389
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_pims_ldd_local_datavalues.usscr_refno=dim_lddi_Screen.user_screen_reference_no
        name: DIM_LDDI_SCREEN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b63aede-3f9f-48f9-9005-02adcc92000a
                stepCounter: 184ea643-dd12-499a-a4bf-7f76f67ea642
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29840419-6f50-4804-aca0-14894369d6f0
          stepCounter: ab327c0c-c1f6-447f-9a93-8536f7688389
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: 'The NHI is a unique 7-character identification number assigned to a healthcare user by the National Health Index (NHI) database.   There is a verification algorithm which ensures that the NHI number is in the correct format and is valid.     Also known as National Health Index, HCU identifier, NHI, HCU, HCU Number, Healthcare User identifier,   HCU identification number, NMPI number, Hospital Number, Patient Number.     '
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 985f0ba0-97cf-4152-a49b-7e86cb71409e
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa09617f-a3aa-4d61-9455-9e6b62d4d6db
          stepCounter: ab327c0c-c1f6-447f-9a93-8536f7688389
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_pims_ldd_local_datavalues.patnt_refno=dim_patient.patient_reference_no
        name: DIM_PATIENT_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9962a01b-5f3d-4c1a-b371-997edef38d0f
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25402e14-4d31-4324-889c-26238aaee7cd
          stepCounter: ab327c0c-c1f6-447f-9a93-8536f7688389
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: EVENT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a100632-cfef-40dd-b5fd-c25a24ed3751
                stepCounter: e576884f-f915-4be8-9d8b-527b62d32310
            transform: |-
              CASE s_pims_ldd_local_datavalues_20.sorce_code
                          WHEN 'REFRL'                              THEN 'Referral'
                          WHEN 'WLIST'                              THEN 'WaitingList'
                          WHEN 'AEATT'                              THEN 'Emergency'
                          WHEN 'SCHDL'                              THEN 'Outpatient'
                          ELSE 'Patient'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 40ab4259-0f03-4128-8235-13513dc21aa5
          stepCounter: ab327c0c-c1f6-447f-9a93-8536f7688389
        config: {}
        dataType: VARCHAR(12)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1e6ed5d-0f2f-4b3a-b209-0a86a23707a9
                stepCounter: e576884f-f915-4be8-9d8b-527b62d32310
            transform: |-
              CASE s_pims_ldd_local_datavalues_20.sorce_code
                          WHEN 'REFRL'                              THEN 'R'
                          WHEN 'WLIST'                              THEN 'W'
                          WHEN 'AEATT'                              THEN 'A'
                          WHEN 'SCHDL'                              THEN 'T'
                          ELSE ''
                           END + convert(varchar,s_pims_ldd_local_datavalues_20.sorce_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7dd08385-3d04-42a1-ab5e-68ca43b150fc
          stepCounter: ab327c0c-c1f6-447f-9a93-8536f7688389
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: PARENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3cf79200-e43b-4638-84f9-e36eff93fa52
                stepCounter: e576884f-f915-4be8-9d8b-527b62d32310
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1080053e-4418-427e-aca9-427c415f7494
          stepCounter: ab327c0c-c1f6-447f-9a93-8536f7688389
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: COLLECT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cfae599f-172d-44d1-9330-017fb903bf84
                stepCounter: e576884f-f915-4be8-9d8b-527b62d32310
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72162539-b13a-47b4-9586-68052d719f49
          stepCounter: ab327c0c-c1f6-447f-9a93-8536f7688389
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: VALUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1956943-51cf-4af0-9bb2-c94660db0ed6
                stepCounter: e576884f-f915-4be8-9d8b-527b62d32310
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3771bb65-997d-4932-a53e-6eb636f9c2dd
          stepCounter: ab327c0c-c1f6-447f-9a93-8536f7688389
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_pims_ldd_local_datavalues.Value=dim_lddi_reference_values.rfval_refno_varchar
        name: DIM_LDDI_REFERENCE_VALUES_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b846124e-2857-4e63-86e3-24371284dc9d
                stepCounter: 84f3bf19-950c-45a1-a818-91169f7f2489
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff134a37-3c88-4260-80f5-d17e20179449
          stepCounter: ab327c0c-c1f6-447f-9a93-8536f7688389
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DATE_VALUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 80d5fe01-dca3-4292-b25d-38794697a49e
                stepCounter: e576884f-f915-4be8-9d8b-527b62d32310
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9fb4a23-0d1e-4439-a8b2-f39e87b15d78
          stepCounter: ab327c0c-c1f6-447f-9a93-8536f7688389
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: MEMO_VALUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 99997ef6-a2e9-4ac3-b3e9-3285cf509ad8
                stepCounter: e576884f-f915-4be8-9d8b-527b62d32310
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f0bc1d7-3e1c-4292-bd1a-0fc2a3a520a7
          stepCounter: ab327c0c-c1f6-447f-9a93-8536f7688389
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        name: COLUMN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 45911bc6-13fc-4540-b0b2-a8c2d8dced34
                stepCounter: e576884f-f915-4be8-9d8b-527b62d32310
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80e9e6f2-752d-4fec-9521-9564f1b91c74
          stepCounter: ab327c0c-c1f6-447f-9a93-8536f7688389
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_pims_ldd_local_datavalues.usscr_refno=dim_lddi_ScreenItems.user_screen_reference_no  s_pims_ldd_local_datavalues.ColumnName=dim_lddi_ScreenItems.mapped_column
        name: DIM_LDDI_SCREENITEMS_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d73ce6cb-8c05-48db-b6ca-07919e1d9160
                stepCounter: 3726f43a-c1cf-46a0-adf4-ed54f9e33933
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4658face-da69-403e-b815-e249425f5fe5
          stepCounter: ab327c0c-c1f6-447f-9a93-8536f7688389
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: USSCR_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce0f6315-c116-4918-ab23-2dc9d327b9d4
                stepCounter: e576884f-f915-4be8-9d8b-527b62d32310
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 383d68a7-f559-41e1-a24e-f74790a13f47
          stepCounter: ab327c0c-c1f6-447f-9a93-8536f7688389
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: PATNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 911edc70-7b22-43b9-b002-7a06d2242fb4
                stepCounter: e576884f-f915-4be8-9d8b-527b62d32310
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66d510e1-6eb0-4369-8683-3f051b5e2c24
          stepCounter: ab327c0c-c1f6-447f-9a93-8536f7688389
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 254cc456-5cbb-41e8-a80d-7de634468332
                stepCounter: e576884f-f915-4be8-9d8b-527b62d32310
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2809df3b-6685-478b-960f-f0e79660a4c8
          stepCounter: ab327c0c-c1f6-447f-9a93-8536f7688389
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c04d601-1058-45dc-a90e-daaae6a0ec8e
                stepCounter: e576884f-f915-4be8-9d8b-527b62d32310
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7230ed1-6135-4aaa-a6fd-70b302195557
          stepCounter: ab327c0c-c1f6-447f-9a93-8536f7688389
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIF_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b045184e-f284-488e-89ad-1d765b49e7f3
                stepCounter: e576884f-f915-4be8-9d8b-527b62d32310
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 62d8b02e-bad7-4b54-8b0e-9cda950290de
          stepCounter: ab327c0c-c1f6-447f-9a93-8536f7688389
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: USER_CREATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c6218df6-a4c7-4b87-b2b2-3c307e799d7c
                stepCounter: e576884f-f915-4be8-9d8b-527b62d32310
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 542f49ad-d4db-4526-9fc8-b92f579e1dd0
          stepCounter: ab327c0c-c1f6-447f-9a93-8536f7688389
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_pims_ldd_local_datavalues.user_create=dim_create_user_login.create_user_login_code
        name: DIM_CREATE_USER_LOGIN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2dfe5e14-cc2f-4748-8352-a6d1621289af
                stepCounter: 70bd6ed5-e21b-440f-9079-7fe305bc4f30
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ed8edb0-be9c-4600-bc17-bfdc5f69ffb3
          stepCounter: ab327c0c-c1f6-447f-9a93-8536f7688389
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: USER_MODIF
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7f450aa-2525-4c75-ab7e-1c9f0d7c7f17
                stepCounter: e576884f-f915-4be8-9d8b-527b62d32310
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91277a82-dea6-461f-8cce-33462aa74e28
          stepCounter: ab327c0c-c1f6-447f-9a93-8536f7688389
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_pims_ldd_local_datavalues.user_modif=dim_modify_user_login.modify_user_login_code
        name: DIM_MODIFY_USER_LOGIN_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ceaa34a6-dd0b-40fb-bc61-9df93cc05e7b
                stepCounter: bef0768d-dddb-4d02-af8d-03160de42b62
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7e72192-823c-426e-9b07-c25cbc0d2f3b
          stepCounter: ab327c0c-c1f6-447f-9a93-8536f7688389
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_PIMS_LDD_LOCAL_DATAVALUES_20: e576884f-f915-4be8-9d8b-527b62d32310
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_PIMS_LDD_LOCAL_DATAVALUES_20
        join:
          joinCondition: FROM {{ ref('TGT','S_PIMS_LDD_LOCAL_DATAVALUES_20') }}
        name: S_PIMS_LDD_LOCAL_DATAVALUES
        noLinkRefs: []
  name: S_PIMS_LDD_LOCAL_DATAVALUES
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
