fileVersion: 1
id: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
name: S_PJ_JOURNEY_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Group the source table by journey_id so that thee is only one row per journey."
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15dbefba-904b-4b84-a2a2-ed523a968a08
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Unique ID for a patient journey
        name: JOURNEY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f7dd4ca-4b72-4471-8e15-dd1ec0a54c3c
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70753ad4-7f17-4546-b6bd-6a75dc7dd862
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7f60003-b7a5-4f17-92d1-b8cb3e8fce89
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 934ad6d9-4efb-465b-8d76-42bd4c3a3d72
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Journey number for the patient.
        name: JOURNEY_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e8017333-8bf1-48d8-ae28-60f8be1ba8fd
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0015874f-384a-4378-88d6-e2ad0688645d
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Total number of events for each journey.
        name: JOURNEY_EVENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5940244a-9550-42c3-8908-6f660639a08a
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc3e247b-d5f1-40fd-b968-eab653687d38
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Total number of ED events for the journey.
        name: ED_EVENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb9bf62e-9efd-415f-8d43-58d64f107f83
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: MAX(CASE WHEN event_source = 'ED' THEN journey_source_event_count ELSE 0 END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 273951e7-4a2b-4f85-b500-f869b308fde1
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Total number of Inpatient events for the journey.
        name: IP_EVENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb9bf62e-9efd-415f-8d43-58d64f107f83
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: MAX(CASE WHEN event_source = 'IP' THEN journey_source_event_count ELSE 0 END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9620d51-d0eb-4b83-9b77-2c70c3c1aa99
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Total number of theatre events for the journey.
        name: THEATRE_EVENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb9bf62e-9efd-415f-8d43-58d64f107f83
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: MAX(CASE WHEN event_source = 'Theatre' THEN journey_source_event_count ELSE 0 END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47925292-1f3b-423d-97fd-15602ee857ad
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: ""
        name: THEATRE_CANCELLED_EVENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ff723c5c-ee49-4448-8a7d-0e6371756083
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: SUM(s_PJ_event.theatre_cancelled_flag)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 30c2b167-bb00-4039-98bf-8ca41192b5a9
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Start date and time for the first event in the journey.
        name: FIRST_EVENT_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2621ef5d-f448-424a-98e0-cef8cd8fba05
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: MAX(CASE WHEN journey_event_seq_num = 1 THEN event_start_date ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e94eb695-e88e-4349-9987-726a9f4e7b83
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time when the event ended e.g. discharge time.
        name: LAST_EVENT_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4deb8dd-0a39-4fae-ab24-ca122be93cbf
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: MAX(s_PJ_event.event_end_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c73605e7-92c8-4073-846c-772d3f1f718e
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: First ED Encounter unique identifier
        name: FIRST_ED_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 92bb904c-7ff9-46a5-8541-9524d8c9df2d
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: MAX(CASE WHEN event_source = 'ED' AND journey_source_seq_num = 1 THEN ed_encounter_id ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6b90f61-81e4-451e-b774-c85369327df0
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: First IP Encounter unique identifier
        name: FIRST_IP_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d37cafeb-c7c3-49fa-8631-76458e42124c
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: MAX(CASE WHEN event_source = 'IP' AND journey_source_seq_num = 1 THEN ip_encounter_id ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a41a400-c5e3-4a6e-81a2-2fbb391430ec
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Admit date and time of the first IP event for the journey.
        name: FIRST_IP_ADMIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2621ef5d-f448-424a-98e0-cef8cd8fba05
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: MAX(CASE WHEN event_source = 'IP' AND journey_source_seq_num = 1 THEN event_start_date ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54b94b27-d205-47c7-a5f3-12d289185159
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: First theatre Encounter unique identifier
        name: FIRST_THEATRE_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 35fb20d6-42c4-4c6a-8019-6c87bdac4ac3
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: MAX(CASE WHEN event_source = 'Theatre' AND journey_source_seq_num = 1 THEN theatre_encounter_id ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ced4c02-5159-4a85-9080-63374c827762
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Start date and time for the first theatre event in the journey.
        name: FIRST_THEATRE_EVENT_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2621ef5d-f448-424a-98e0-cef8cd8fba05
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: MAX(CASE WHEN event_source = 'Theatre' AND journey_source_seq_num = 1 THEN event_start_date ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72171acb-4f3d-4c07-b947-2273b0047824
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Return theatre Encounter unique identifier
        name: RETURN_THEATRE_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 35fb20d6-42c4-4c6a-8019-6c87bdac4ac3
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: MAX(CASE WHEN return_theatre_seq_num = 1 THEN theatre_encounter_id ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5af0c582-d1af-4006-896c-61842a6098e1
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ID of the first IP event where discharge specialty = AT&R.
        name: FIRST_REHAB_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d37cafeb-c7c3-49fa-8631-76458e42124c
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: MAX(CASE WHEN rehab_event_seq_num = 1 THEN ip_encounter_id ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb909e00-06cb-47e3-b511-660b88308035
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: index IP Encounter unique identifier
        name: INDEX_IP_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d37cafeb-c7c3-49fa-8631-76458e42124c
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: MAX(CASE WHEN index_ip_event_flag = 1 THEN ip_encounter_id ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a26dc51-08d9-4a70-91e2-d6ea70e4e386
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Final IP Encounter unique identifier
        name: FINAL_IP_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d37cafeb-c7c3-49fa-8631-76458e42124c
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: MAX(CASE WHEN event_source = 'IP' AND journey_source_seq_num = journey_source_event_count THEN ip_encounter_id ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ba2de1e-0880-458c-9e57-63e3588f230f
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Discharge date and time of the final IP event for the journey.
        name: FINAL_IP_DISCHARGE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4deb8dd-0a39-4fae-ab24-ca122be93cbf
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: MAX(CASE WHEN event_source = 'IP' AND journey_source_seq_num = journey_source_event_count THEN event_end_date ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4496b03b-2b23-4f96-bbda-e430834f6337
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ID of the final IP event where discharge specialty = AT&R.
        name: FINAL_REHAB_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d37cafeb-c7c3-49fa-8631-76458e42124c
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: MAX(CASE WHEN rehab_event_seq_num = rehab_event_count THEN ip_encounter_id ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d269c37-b187-437f-89e3-c1bc1a0f92b9
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Set to 1 if the includes an IP event where there was a stay at a ward flagged as Interim Care.
        name: INTERIM_CARE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7789e72f-214b-47c4-b97c-a163413d8d88
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: MAX(s_PJ_event.interim_care_flag)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2dfc12df-9c2e-411b-a175-b5e1f8ea06f4
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Flag indicating whether this is an IP rehab event i.e. admission_specialty_level2_code = 'MHSSE'
        name: MH_EVENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d31858c0-a41f-4736-bb18-5af438ebee5c
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: MAX(s_PJ_event.mh_event_flag)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c21ed81f-d5d0-42ff-96ed-9a1a86338ff7
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Set to 1 if this is an acute readmission within 28 days of the previous IP event.
        name: ACUTE_READMIT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 272ab363-2d6f-4dfb-96c2-1b430c00e7c9
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: MAX(s_PJ_event.acute_readmit_flag)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ebae34f-1a31-43d2-8afa-fdadffd2e1a7
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Set to the encounter ID which caused acute_readmit_flag to be set.
        name: READMIT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d37cafeb-c7c3-49fa-8631-76458e42124c
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: MAX(CASE WHEN s_PJ_event.acute_readmit_flag = 1 THEN s_PJ_event.next_event_encounter_id ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0099526f-ad07-40b8-be94-0a9e946b0371
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Length of stay of all IP events where discharge specialty = AT&R.
        name: REHAB_LENGTH_OF_STAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 053feab2-6ff8-4e7d-bc49-86300bfd3b41
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: SUM(CASE WHEN rehab_event_flag = 1 THEN ip_event_length_of_stay ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 58814696-d025-4007-a6eb-4132996ccf29
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Length of stay of all IP events where discharge specialty in 'AAMHIP', 'ACMHICU', 'ACRMHCOM', 'AMHCOM', 'CHI&YMH', 'FOCOM', 'FOMAX', 'FOMED', 'PSGCO', 'PSGIP', 'RADS', 'SAAMHIP'
        name: MH_LENGTH_OF_STAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 053feab2-6ff8-4e7d-bc49-86300bfd3b41
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: SUM(CASE WHEN mh_event_flag = 1 THEN ip_event_length_of_stay ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d0f0199-c532-4ac3-8702-7c81dcf461a8
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Length of stay of all IP events where discharge specialty = D55
        name: INTERIM_CARE_LENGTH_OF_STAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 053feab2-6ff8-4e7d-bc49-86300bfd3b41
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: SUM(CASE WHEN s_PJ_event.interim_care_flag = 1 THEN ip_event_length_of_stay ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6de05f56-8c7a-4ef4-92ac-b5594913789c
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: NUMERIC(38,4)
        defaultValue: ""
        description: 'Total cost of all ED events.  '
        name: COST_ED_EVENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb88282b-27c6-4121-ae5e-b720943dc919
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: SUM(ed_actual_cost)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e277f78-b8b9-466a-b952-c0785f4fa5b6
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: NUMERIC(38,4)
        defaultValue: ""
        description: Cost of all IP events.
        name: COST_IP_EVENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b8ec4ac0-d119-4282-a9fb-40c55a2c73c0
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: SUM(CASE WHEN event_source = 'IP' THEN ip_actual_cost ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9790560-db42-4078-bbff-a71692906976
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: NUMERIC(38,4)
        defaultValue: ""
        description: Cost of the IP index event.
        name: COST_INDEX_EVENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b8ec4ac0-d119-4282-a9fb-40c55a2c73c0
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: SUM(CASE WHEN index_ip_event_flag = 1 THEN ip_actual_cost ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 83cd603a-2c1d-410c-99fc-0b7a7d2a1567
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: NUMERIC(38,4)
        defaultValue: ""
        description: Cost of IP rehab events.
        name: COST_REHAB_EVENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b8ec4ac0-d119-4282-a9fb-40c55a2c73c0
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: SUM(CASE WHEN rehab_event_flag = 1 THEN ip_actual_cost ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 43f8bae9-2381-4389-9a87-d70eacd758df
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: NUMERIC(38,4)
        defaultValue: ""
        description: Cost of IP non-rehab events.
        name: COST_OTHER_IP_EVENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b8ec4ac0-d119-4282-a9fb-40c55a2c73c0
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: SUM(CASE WHEN event_source = 'IP' AND rehab_event_flag = 0 THEN ip_actual_cost ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d06b7abb-5ea9-42a7-a27b-b654994092fc
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: NUMERIC(15,2)
        defaultValue: ""
        description: Cost of FSA (First Specialist Appointment).
        name: COST_FSA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f398439-49fb-4fa8-a840-5fcba63d8431
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: SUM(s_PJ_event.cost_FSA)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e43c27b0-7768-4d7c-8e0c-18dc5be0a87f
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: NUMERIC(15,2)
        defaultValue: ""
        description: Cost of outpatient Follow Up appointment.
        name: COST_OP_FUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d249868-9e1c-46f5-862c-eacc94b6a352
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: SUM(s_PJ_event.cost_OP_FUP)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d496bfca-59a0-4b87-937e-4a14f97d9780
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: 'Revenue from ED events.  '
        name: REVENUE_ED_EVENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c54d4a33-eba1-4b30-8377-bf4ab154e828
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: SUM(ed_revenue)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41009bb6-670a-4d17-be3d-0a6289d68645
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: Revenue from the IP index event.
        name: REVENUE_INDEX_EVENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 510b888f-4cb9-4e85-972f-27b93dc6bd03
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: SUM(CASE WHEN index_ip_event_flag = 1 THEN ip_revenue ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac31d30a-6839-4be7-9070-7cdf51ea4b13
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: Revenue from IP rehab events.
        name: REVENUE_REHAB_EVENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 510b888f-4cb9-4e85-972f-27b93dc6bd03
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: SUM(CASE WHEN rehab_event_flag = 1 THEN ip_revenue ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a65b01f1-067f-4d0d-bd1b-4f3366ee7a22
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: Revenue from IP non-rehab events.
        name: REVENUE_OTHER_IP_EVENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 510b888f-4cb9-4e85-972f-27b93dc6bd03
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: SUM(CASE WHEN event_source = 'IP' AND rehab_event_flag = 0 THEN ip_revenue ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69702223-2ae7-46e2-871e-f932b44d1ad5
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: Revenue from the OP FSA event.
        name: REVENUE_FSA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ded7e860-25dc-42e6-b824-7b0bd5a6b39c
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: SUM(s_PJ_event.revenue_FSA)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1192250c-310b-4049-92c1-b9ed3653606d
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: MONEY
        defaultValue: ""
        description: Revenue from the outpatient Follow Up appointment.
        name: REVENUE_OP_FUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d8e0fe22-4e95-4bac-aae2-73f07ec1af5c
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: SUM(s_PJ_event.revenue_OP_FUP)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cfff5477-7676-48ff-a2f5-fa27ec9227d4
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ID of the FSA event for the journey.
        name: FSA_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 96ce7c30-2ea5-478b-8413-43b2c86ff7c8
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: MAX(CASE WHEN FSA_outpatient_flag = 1 THEN op_encounter_id ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d48ae3b-5172-4cc2-88c3-0966dbaba496
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date of the FSA event for the journey.
        name: FSA_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2621ef5d-f448-424a-98e0-cef8cd8fba05
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: MAX(CASE WHEN FSA_outpatient_flag = 1 THEN event_start_date ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3228440c-2ad3-4874-ad3a-2cbb25edbfc9
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ID of the next FUP event for the journey.
        name: FUP_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 96ce7c30-2ea5-478b-8413-43b2c86ff7c8
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: MAX(CASE WHEN first_FUP_outpatient_flag = 1 THEN op_encounter_id ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39eef1ca-24f5-4a50-bf90-e1cceee20723
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date of the next FUP event for the journey.
        name: FUP_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2621ef5d-f448-424a-98e0-cef8cd8fba05
                stepCounter: 025cc51b-16d6-4445-83f7-5229e679b705
            transform: MAX(CASE WHEN first_FUP_outpatient_flag = 1 THEN event_start_date ELSE NULL END)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: adcd13b9-80f6-498c-a9f8-d108e1690311
          stepCounter: 8190dcc6-8301-47ab-9fd9-68b29ee91fde
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_PJ_EVENT
        join:
          joinCondition: |-
            FROM s_PJ_event
             GROUP BY journey_id,
                      patient_nhi,
                      journey_num,
                      journey_event_count
        name: S_PJ_JOURNEY_10
        noLinkRefs: []
  name: S_PJ_JOURNEY_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
