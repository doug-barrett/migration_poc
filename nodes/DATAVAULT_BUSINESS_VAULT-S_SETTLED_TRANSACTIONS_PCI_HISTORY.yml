fileVersion: 1
id: ca818b4d-9b44-45ac-89ef-96071dcc2db5
name: S_SETTLED_TRANSACTIONS_PCI_HISTORY
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DATAVAULT_BUSINESS_VAULT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a975ee6-82ca-4cf8-b75f-fcc82503d433
          stepCounter: ca818b4d-9b44-45ac-89ef-96071dcc2db5
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: ""
        name: HK_H_SETTLED_TRANSACTIONS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f915ac4-4c4a-47c3-aa40-8d6d558036e3
                stepCounter: e0dfdb7a-522a-4c99-a499-d0db6ace82a2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a6cb6814-bb7c-41a7-8af6-768d0b33e933
          stepCounter: ca818b4d-9b44-45ac-89ef-96071dcc2db5
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: RECID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2580e7c-c29b-444e-bcfa-175a03dce4d6
                stepCounter: e0dfdb7a-522a-4c99-a499-d0db6ace82a2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ffb76b36-b71a-415e-bcc8-8e28cd1856ec
          stepCounter: ca818b4d-9b44-45ac-89ef-96071dcc2db5
        config: {}
        dataType: DECIMAL(38,0)
        defaultValue: ""
        description: Identifies the Merchant who initially received the transaction.
        isBusinessKey: true
        name: TRANSACTION_MERCHANT_INTERNAL_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 80d57fee-a4e2-4032-8e01-c32893098c9a
                stepCounter: e0dfdb7a-522a-4c99-a499-d0db6ace82a2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7669f789-b972-4796-bf14-4af37db0d00e
          stepCounter: ca818b4d-9b44-45ac-89ef-96071dcc2db5
        config: {}
        dataType: VARCHAR(15)
        defaultValue: ""
        description: A description of the card identification (PAN Number) on which the transaction was made.
        name: CARD_IDENTIFICATION_TEXT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 962b2eb6-1342-4173-8db8-a3c70fc5a5db
                stepCounter: e0dfdb7a-522a-4c99-a499-d0db6ace82a2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c7b67062-1a01-4543-88ae-e04d295bdad7
          stepCounter: ca818b4d-9b44-45ac-89ef-96071dcc2db5
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: Identifies the card scheme associated with the transaction that has been derived from the PAN using the Interchange BIN table and the System Card Type Mapping table.
        name: CARD_SCHEME_ID_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72760714-b85d-469f-ba95-13c3fc23a212
                stepCounter: e0dfdb7a-522a-4c99-a499-d0db6ace82a2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41ae34ba-ddad-41e3-8c5d-bf7421de4e5d
          stepCounter: ca818b4d-9b44-45ac-89ef-96071dcc2db5
        config: {}
        dataType: BINARY(16)
        defaultValue: ""
        description: The changing hash
        name: DSS_CHANGE_HASH
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 584ab19e-f393-443b-9279-a0b38dacf59e
                stepCounter: e0dfdb7a-522a-4c99-a499-d0db6ace82a2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 43ce9e2c-227f-4190-850b-f2194224fed0
          stepCounter: ca818b4d-9b44-45ac-89ef-96071dcc2db5
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: Record source
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 96891799-ccc8-4b49-99b2-f71724e6a490
                stepCounter: e0dfdb7a-522a-4c99-a499-d0db6ace82a2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b1af672-c521-4ab5-a2ab-8725a1e63b9a
          stepCounter: ca818b4d-9b44-45ac-89ef-96071dcc2db5
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was loaded in the data vault
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 69396f86-6c04-45f2-9aeb-77582c979898
                stepCounter: e0dfdb7a-522a-4c99-a499-d0db6ace82a2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d739748a-8efc-4a75-92d9-e6133eaf96cb
          stepCounter: ca818b4d-9b44-45ac-89ef-96071dcc2db5
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row started in the data vault
        isSystemStartDate: true
        name: DSS_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea570de0-e48c-44c6-9e9f-46249fc1b406
                stepCounter: e0dfdb7a-522a-4c99-a499-d0db6ace82a2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b083098d-151d-4a1b-a82e-8a2bb97ef976
          stepCounter: ca818b4d-9b44-45ac-89ef-96071dcc2db5
        config: {}
        dataType: NUMBER(38)
        defaultValue: ""
        description: Version number of a business key in the data vault
        isSurrogateKey: true
        isSystemVersion: true
        name: DSS_VERSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11a79688-2fdb-4bfa-b6ac-26007172a9d6
                stepCounter: e0dfdb7a-522a-4c99-a499-d0db6ace82a2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 61d7178e-217b-4a4e-8a70-be42fe250a5d
          stepCounter: ca818b4d-9b44-45ac-89ef-96071dcc2db5
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was inserted in the data vault
        isSystemCreateDate: true
        name: DSS_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c21cb991-dc5e-403f-8004-5dcc6f04c0f3
                stepCounter: e0dfdb7a-522a-4c99-a499-d0db6ace82a2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1c45611-59f9-4392-8eea-ea3d18aa5d55
          stepCounter: ca818b4d-9b44-45ac-89ef-96071dcc2db5
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: End date determined by the next Satellite change record dss_start_date
        isSystemEndDate: true
        name: DSS_END_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: LEAD(dss_start_date, 1, '9999-12-31') OVER(PARTITION BY hk_h_settled_transactions ORDER BY dss_start_date)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: afe3f109-4edf-4511-8aa2-38d77eb497a0
          stepCounter: ca818b4d-9b44-45ac-89ef-96071dcc2db5
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: CurrentFlag 'N' unless next Satellite change record dss_start_date is null, indicating this is the most current record.
        isSurrogateKey: true
        isSystemCurrentFlag: true
        name: DSS_CURRENT_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN LEAD(dss_start_date, 1, NULL) OVER(PARTITION BY hk_h_settled_transactions ORDER BY dss_start_date) IS NULL THEN 'Y'
                          ELSE 'N'
                           END
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_SETTLED_TRANSACTIONS_PCI: e0dfdb7a-522a-4c99-a499-d0db6ace82a2
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATAVAULT_RAW_VAULT
            nodeName: S_SETTLED_TRANSACTIONS_PCI
        join:
          joinCondition: FROM {{ ref('DATAVAULT_RAW_VAULT','S_SETTLED_TRANSACTIONS_PCI') }} s_settled_transactions_pci
        name: S_SETTLED_TRANSACTIONS_PCI_HISTORY
        noLinkRefs: []
  name: S_SETTLED_TRANSACTIONS_PCI_HISTORY
  overrideSQL: false
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
