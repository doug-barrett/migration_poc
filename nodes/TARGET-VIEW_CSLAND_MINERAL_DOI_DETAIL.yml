fileVersion: 1
id: a2a31619-225a-4532-8914-2dd00a4c3bff
name: VIEW_CSLAND_MINERAL_DOI_DETAIL
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1b262aa-9a20-4299-9247-272c36375ee4
          stepCounter: a2a31619-225a-4532-8914-2dd00a4c3bff
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: MINERAL_FILE_SUB_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dca7273b-0cd5-426e-88b8-f556218d53c4
                stepCounter: 86bd702b-167e-4fc0-893e-6c74c18af4bb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ced3220-d0c5-4158-9cf1-f958dd4badb4
          stepCounter: a2a31619-225a-4532-8914-2dd00a4c3bff
        config: {}
        dataType: DECIMAL(7)
        defaultValue: ""
        description: ""
        name: DOI_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84ad3ac6-6986-4681-8c33-4a9b339d8cae
                stepCounter: 4c591dae-8cae-4462-b16e-495c5989ebb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4a63853-08d3-4da5-9da1-85b1bcad317d
          stepCounter: a2a31619-225a-4532-8914-2dd00a4c3bff
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DOI_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60964802-6912-4016-81d2-f68db88ca9e5
                stepCounter: 2666f026-1171-4402-99af-47c5ee6092ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b6920af-5f8c-4bde-b016-3e4720d15323
          stepCounter: a2a31619-225a-4532-8914-2dd00a4c3bff
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: DOI_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21679f94-12c3-464c-90ef-4897b957cf97
                stepCounter: d2bd2d6f-5926-4bb8-9642-b5aaafb48852
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5173680-a35e-44c6-86f2-8114b2c7b73f
          stepCounter: a2a31619-225a-4532-8914-2dd00a4c3bff
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CHANGED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 92a8b1ce-37ff-4860-892e-53a905e5faf4
                stepCounter: 2666f026-1171-4402-99af-47c5ee6092ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70505cd5-8844-444a-8b8b-f70e3df74a43
          stepCounter: a2a31619-225a-4532-8914-2dd00a4c3bff
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: MINERAL_DOI_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c90932ab-182d-43ee-b8d4-a0da56ab3f47
                stepCounter: 2666f026-1171-4402-99af-47c5ee6092ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8fbd51df-434c-4651-a034-44039718f1a3
          stepCounter: a2a31619-225a-4532-8914-2dd00a4c3bff
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: EFFECTIVE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8660bb6e-e159-45b6-8fc0-cd6924ef6efe
                stepCounter: 2666f026-1171-4402-99af-47c5ee6092ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9203b290-9a79-46f8-8fd7-1364aeb36714
          stepCounter: a2a31619-225a-4532-8914-2dd00a4c3bff
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: EXPIRY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de877534-23cf-4838-b856-3b01941db1fe
                stepCounter: 2666f026-1171-4402-99af-47c5ee6092ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 247ddc3a-5753-47f2-a316-95cc887de4e5
          stepCounter: a2a31619-225a-4532-8914-2dd00a4c3bff
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: OWNER_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5c38b63-f893-42fc-8def-b57710c6de20
                stepCounter: 2666f026-1171-4402-99af-47c5ee6092ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88ba4f81-f4d4-4a5d-a14f-df3967b4197b
          stepCounter: a2a31619-225a-4532-8914-2dd00a4c3bff
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: OWNER_IN_PENALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3970f27c-9b05-4aeb-a7a6-f07bcbb37a33
                stepCounter: 4c591dae-8cae-4462-b16e-495c5989ebb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 43d89fb8-4188-4cca-b41e-f80fbfcf6809
          stepCounter: a2a31619-225a-4532-8914-2dd00a4c3bff
        config: {}
        dataType: VARCHAR(60)
        defaultValue: ""
        description: Comments
        name: COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d9756c30-edae-44bc-a581-49cc8f3a6003
                stepCounter: 2666f026-1171-4402-99af-47c5ee6092ab
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d978f94c-7663-4b7c-a4fd-142720fafdd0
          stepCounter: a2a31619-225a-4532-8914-2dd00a4c3bff
        config: {}
        dataType: DECIMAL(6)
        defaultValue: ""
        description: ""
        name: PARTNER_OCCURRENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c40a795c-fd97-4c63-b7da-b198386529cc
                stepCounter: 4c591dae-8cae-4462-b16e-495c5989ebb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6eb7d43a-9d02-46be-8e4a-e55f57577adc
          stepCounter: a2a31619-225a-4532-8914-2dd00a4c3bff
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PARTNER_BA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05f2ec9a-e62a-42cc-aa20-5ba476d5cd21
                stepCounter: 4c591dae-8cae-4462-b16e-495c5989ebb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3902f04-e38d-42c3-833e-dc6094d3bebd
          stepCounter: a2a31619-225a-4532-8914-2dd00a4c3bff
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: PARTNER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7cdfc49f-aa22-4a4a-ad06-6a087f45b67d
                stepCounter: 195380c1-f588-4c27-9c13-2d48662dc985
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e224ea01-1f1e-4610-94b8-740b1e7188a9
          stepCounter: a2a31619-225a-4532-8914-2dd00a4c3bff
        config: {}
        dataType: DECIMAL(11,8)
        defaultValue: ""
        description: ""
        name: PARTNER_PERCENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f0286f0e-21c4-426a-8cee-a0d0b6882ac4
                stepCounter: 4c591dae-8cae-4462-b16e-495c5989ebb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8fb14165-b4c5-4a88-9e91-66ef375e15b6
          stepCounter: a2a31619-225a-4532-8914-2dd00a4c3bff
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: OWNING_PARTNER_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00b031bb-27e5-42ed-ae99-c37a1446a25e
                stepCounter: 001fcc0c-faa3-492e-990b-29437efcbbc0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 290d78b1-a429-4adf-a146-ebeec1875a33
          stepCounter: a2a31619-225a-4532-8914-2dd00a4c3bff
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: SILENT_PARTNER_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c8576b2-31e8-4733-b87d-15c8d262a64e
                stepCounter: 4c591dae-8cae-4462-b16e-495c5989ebb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de04458f-58ab-422b-9fa7-1b225caa9468
          stepCounter: a2a31619-225a-4532-8914-2dd00a4c3bff
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PARTNER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2b7896c-d3ee-452b-97f0-fc91c72bba7a
                stepCounter: 4c591dae-8cae-4462-b16e-495c5989ebb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 84dba9c3-a463-4446-8cbe-35b0a874ece4
          stepCounter: a2a31619-225a-4532-8914-2dd00a4c3bff
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: PARTNER_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c6fc463-d6b2-47af-a01c-0bccfc785465
                stepCounter: 61f17e1f-2d1c-4948-960a-7d2c86b563a2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1630d3c1-ee86-46c4-ad28-d009f0c7f41d
          stepCounter: a2a31619-225a-4532-8914-2dd00a4c3bff
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: PENALTY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3970f27c-9b05-4aeb-a7a6-f07bcbb37a33
                stepCounter: 4c591dae-8cae-4462-b16e-495c5989ebb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f68cd20-d16e-4a82-80e0-085997f36ef4
          stepCounter: a2a31619-225a-4532-8914-2dd00a4c3bff
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: SILENT_OWNER_BA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ccb9643-cdba-4b1c-877e-8d169c9a68ef
                stepCounter: 4c591dae-8cae-4462-b16e-495c5989ebb0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0d1f3c0-1edb-46aa-b5fa-23b61079b838
          stepCounter: a2a31619-225a-4532-8914-2dd00a4c3bff
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: SILENT_OWNER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7cdfc49f-aa22-4a4a-ad06-6a087f45b67d
                stepCounter: 195380c1-f588-4c27-9c13-2d48662dc985
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6875f5c0-bcb3-466e-a67d-01c65371e130
          stepCounter: a2a31619-225a-4532-8914-2dd00a4c3bff
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PARTNER_SUMMARY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05f2ec9a-e62a-42cc-aa20-5ba476d5cd21
                stepCounter: 4c591dae-8cae-4462-b16e-495c5989ebb0
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_CSLAND_MINERAL_DOI_DETAIL: a2a31619-225a-4532-8914-2dd00a4c3bff
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_CSLAND_MINERAL_DOI_DETAIL') }} AS SELECT TRIM(DX.FILE_NUMBER)||TRIM(DX.FILE_SUB) "MINERAL_FILE_SUB_KEY",
                   DD.DOI_ID,
                   DX.DOI_TYPE "DOI_TYPE_CODE",
                   TD.DESCRIPTION "DOI_TYPE",
                   DX.CHANGED_DATE,
                   DX.ACCOUNT_GROUP "MINERAL_DOI_TYPE",
                   DX.EFFECTIVE_DATE,
                   DX.EXPIRY_DATE,
                   DX.OWNER "OWNER_FLAG",
                   DECODE(MAX(DECODE(DECODE(TOW.OWNER,NULL,'N','Y')||NVL(DD.PENALTY,'N'),'YY',1,0)) OVER (PARTITION BY DD.DOI_ID, DD.PARTNER),1,'Y','N') "OWNER_IN_PENALTY",
                   DX.COMMENTS,
                   DD.OCCURRENCE "PARTNER_OCCURRENCE",
                   DD.PARTNER "PARTNER_BA",
                   BA1.NAME "PARTNER_NAME",
                   DD.PARTNER_PERCENT,
                   DECODE(TOW.OWNER,NULL,'N','Y') "OWNING_PARTNER_FLAG",
                   DD.SILENT_PARTNER "SILENT_PARTNER_FLAG",
                   DD.PARTNER_TYPE "PARTNER_TYPE_CODE",
                   TP.DESCRIPTION "PARTNER_TYPE",
                   DD.PENALTY "PENALTY_FLAG",
                   DD.SILENT_OWNER "SILENT_OWNER_BA",
                   BA2.NAME "SILENT_OWNER_NAME",
                   RPAD(BA1.NAME||'  ('||TRIM(DD.PARTNER)||')', 50, ' ') || LPAD(TO_CHAR(NVL(DD.PARTNER_PERCENT,0),'990.0000000'),12,' ') || '   ' || RPAD(NVL(DD.PARTNER_TYPE,' '),10,' ') || '   ' || 'Owner: '||DECODE(TOW.OWNER,NULL,'N','Y') || '   ' || 'Silent Partner: '||DECODE(DD.SILENT_PARTNER,'*','S',' ') || '   ' || 'Penalty: '||NVL(DD.PENALTY,'N') || '   ' || 'Silent Owner: '||RPAD(BA2.NAME||'  ('||TRIM(DD.SILENT_OWNER)||')', 50, ' ') "PARTNER_SUMMARY"
              FROM DS_CSLAND.D_XREF DX,
                   DS_CSLAND.D_DETAIL DD,
                   DS_CSLAND.T_OWNERS TOW,
                   DS_CSLAND.BA_TABLE BA1,
                   DS_CSLAND.BA_TABLE BA2,
                   DS_CSLAND.T_DOI TD,
                   DS_CSLAND.T_PTYPE TP
             WHERE DX.DOI_ID = DD.DOI_ID
               AND DD.PARTNER = TOW.OWNER(+)
               AND DX.EFFECTIVE_DATE <= CURRENT_TIMESTAMP
               AND DX.EXPIRY_DATE > CURRENT_TIMESTAMP
               AND DD.PARTNER = BA1.PRIMARY_KEY(+)
               AND DD.SILENT_OWNER = BA2.PRIMARY_KEY(+)
               AND DX.DOI_TYPE = TD.CODE(+)
               AND DD.PARTNER_TYPE = TP.CODE(+)
               AND DX.SUBSYSTEM = 'M'
        dependencies:
          - locationName: TARGET
            nodeName: VIEW_CSLAND_MINERAL_SUB_DETAIL
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','VIEW_CSLAND_MINERAL_SUB_DETAIL') }}
        name: VIEW_CSLAND_MINERAL_DOI_DETAIL
        noLinkRefs: []
  name: VIEW_CSLAND_MINERAL_DOI_DETAIL
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
