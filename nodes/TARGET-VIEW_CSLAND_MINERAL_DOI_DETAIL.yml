fileVersion: 1
id: 800c21de-7a73-4939-8b34-8988775652f8
name: VIEW_CSLAND_MINERAL_DOI_DETAIL
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  customOverride: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 403d996a-cab6-4b59-b5ce-8bd24fdc0603
          stepCounter: 800c21de-7a73-4939-8b34-8988775652f8
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: MINERAL_FILE_SUB_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 619e9f5c-ba35-42c3-bd67-52e12add5375
                stepCounter: 3577872d-5488-4ba6-9bef-8e18a1c7bd52
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9476b6c0-f191-4439-8481-8d732e92d20e
          stepCounter: 800c21de-7a73-4939-8b34-8988775652f8
        config: {}
        dataType: DECIMAL(7)
        defaultValue: ""
        description: ""
        name: DOI_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f841507-16ce-4612-80ff-8261367e7396
                stepCounter: 5d401374-6e3b-4e5f-b27a-ab979c40cb21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: efb519ba-dfdb-4d42-8c8d-b436552f31b0
          stepCounter: 800c21de-7a73-4939-8b34-8988775652f8
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: DOI_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 353fb880-be91-4706-8ff0-4c9fc93a1a3f
                stepCounter: 8a1aebb0-1dcf-4f1e-be95-93508ea7ab7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd9e47a7-3537-4e70-9de5-a15e1a3048b7
          stepCounter: 800c21de-7a73-4939-8b34-8988775652f8
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: DOI_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 469c271a-3b3f-43c4-99c1-c621b8c1d32a
                stepCounter: fc08e86c-5254-4f5e-97fc-e83555aefe1e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: abe8e6d1-c8b6-4f74-9bee-9316115da452
          stepCounter: 800c21de-7a73-4939-8b34-8988775652f8
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: CHANGED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc8fc0bb-41fd-4169-a46f-03db0ed56c7f
                stepCounter: 8a1aebb0-1dcf-4f1e-be95-93508ea7ab7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a488b82-72e9-49ae-93f3-de0dd6c44627
          stepCounter: 800c21de-7a73-4939-8b34-8988775652f8
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: MINERAL_DOI_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0abf96c0-1750-4523-a439-2a9c97feeaba
                stepCounter: 8a1aebb0-1dcf-4f1e-be95-93508ea7ab7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9011c2d1-3a8b-4ca3-9897-bd59cbac0217
          stepCounter: 800c21de-7a73-4939-8b34-8988775652f8
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: EFFECTIVE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dbba7f4f-8c90-4747-bbce-8099b28ea271
                stepCounter: 8a1aebb0-1dcf-4f1e-be95-93508ea7ab7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15bc88f4-b9da-4f72-b6f1-cf756f32aa0b
          stepCounter: 800c21de-7a73-4939-8b34-8988775652f8
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: EXPIRY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6510da05-a4fa-41d5-ba0f-2e995a04bf86
                stepCounter: 8a1aebb0-1dcf-4f1e-be95-93508ea7ab7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8a8cab6-51be-4847-87bb-b6a9d82718f5
          stepCounter: 800c21de-7a73-4939-8b34-8988775652f8
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: OWNER_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b19904c-a62a-4040-971d-0bdb22e62c05
                stepCounter: 8a1aebb0-1dcf-4f1e-be95-93508ea7ab7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4029b267-e38c-4c55-aea0-d2561cad70a3
          stepCounter: 800c21de-7a73-4939-8b34-8988775652f8
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: OWNER_IN_PENALTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa838ebf-6c6f-4617-9d3b-7a71ef98a87a
                stepCounter: 5d401374-6e3b-4e5f-b27a-ab979c40cb21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c18c1fe1-2756-4ffe-8628-c54892d3b633
          stepCounter: 800c21de-7a73-4939-8b34-8988775652f8
        config: {}
        dataType: VARCHAR(60)
        defaultValue: ""
        description: Comments
        name: COMMENTS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d469ab2-0795-4db4-ac98-b9cfd3a6af1f
                stepCounter: 8a1aebb0-1dcf-4f1e-be95-93508ea7ab7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 468d2d2d-58ce-45f4-8e34-2ff49826e104
          stepCounter: 800c21de-7a73-4939-8b34-8988775652f8
        config: {}
        dataType: DECIMAL(6)
        defaultValue: ""
        description: ""
        name: PARTNER_OCCURRENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3943edef-ae37-48bc-b3bf-f803a5e29470
                stepCounter: 5d401374-6e3b-4e5f-b27a-ab979c40cb21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9b0f135-da86-4317-9a3a-549f2452160f
          stepCounter: 800c21de-7a73-4939-8b34-8988775652f8
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: PARTNER_BA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8953a1e0-0998-4339-acdc-88c81059d248
                stepCounter: 5d401374-6e3b-4e5f-b27a-ab979c40cb21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9aaa462-8f7b-4374-aa8a-5e1e490e48b6
          stepCounter: 800c21de-7a73-4939-8b34-8988775652f8
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: PARTNER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e973675-26ea-41fb-9f8f-450a5924d092
                stepCounter: 17e8c098-2969-4300-91b0-b858f6d02add
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 65bc2775-1b49-4ece-8895-cdbcba3d46d9
          stepCounter: 800c21de-7a73-4939-8b34-8988775652f8
        config: {}
        dataType: DECIMAL(11,8)
        defaultValue: ""
        description: ""
        name: PARTNER_PERCENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4390719f-f647-4285-96c0-635bec86b40c
                stepCounter: 5d401374-6e3b-4e5f-b27a-ab979c40cb21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c3b985d8-12f1-43ea-9c7e-de5acb148adc
          stepCounter: 800c21de-7a73-4939-8b34-8988775652f8
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: OWNING_PARTNER_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 44d0ab4a-fac5-4653-9b8e-cec8e672afb9
                stepCounter: 7d1c0def-cbcd-49c8-bb14-0ee1ccba7672
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3208b09c-d04c-42be-b699-9741db379c9c
          stepCounter: 800c21de-7a73-4939-8b34-8988775652f8
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: SILENT_PARTNER_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77e72a62-cac0-40a8-81ba-90e06dd1591b
                stepCounter: 5d401374-6e3b-4e5f-b27a-ab979c40cb21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb3d4c4a-8fab-4d26-b1be-2deb4f37af0f
          stepCounter: 800c21de-7a73-4939-8b34-8988775652f8
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: PARTNER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a944f58a-7836-4f13-9526-46953ba1623a
                stepCounter: 5d401374-6e3b-4e5f-b27a-ab979c40cb21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4facfad5-4cfc-46df-938e-8eefc77457a8
          stepCounter: 800c21de-7a73-4939-8b34-8988775652f8
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: PARTNER_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1aedf7e7-d423-495f-8d9b-278728e3db5b
                stepCounter: 8257f393-4593-4b10-b20d-11d5bf639afd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da91fd70-58f6-4210-affc-8004db5668d4
          stepCounter: 800c21de-7a73-4939-8b34-8988775652f8
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: PENALTY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa838ebf-6c6f-4617-9d3b-7a71ef98a87a
                stepCounter: 5d401374-6e3b-4e5f-b27a-ab979c40cb21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb652e9d-9753-49d5-ac85-4967e9c85b64
          stepCounter: 800c21de-7a73-4939-8b34-8988775652f8
        config: {}
        dataType: VARCHAR(6)
        defaultValue: ""
        description: ""
        name: SILENT_OWNER_BA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de841b6a-76f6-4c20-9d40-c64fc14a99c1
                stepCounter: 5d401374-6e3b-4e5f-b27a-ab979c40cb21
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5abc1fba-5fa0-4dea-9c3a-524fd95770df
          stepCounter: 800c21de-7a73-4939-8b34-8988775652f8
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        name: SILENT_OWNER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e973675-26ea-41fb-9f8f-450a5924d092
                stepCounter: 17e8c098-2969-4300-91b0-b858f6d02add
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cc6f99f1-3fc7-4b72-b21b-94148e73d2fe
          stepCounter: 800c21de-7a73-4939-8b34-8988775652f8
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: PARTNER_SUMMARY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8953a1e0-0998-4339-acdc-88c81059d248
                stepCounter: 5d401374-6e3b-4e5f-b27a-ab979c40cb21
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VIEW_CSLAND_MINERAL_DOI_DETAIL: 800c21de-7a73-4939-8b34-8988775652f8
        customSQL:
          customSQL: |-
            {{ stage('SQL Override') }}
            CREATE OR REPLACE VIEW {{ ref_no_link('TARGET','VIEW_CSLAND_MINERAL_DOI_DETAIL') }} AS SELECT TRIM(DX.FILE_NUMBER)||TRIM(DX.FILE_SUB) "MINERAL_FILE_SUB_KEY",
                   DD.DOI_ID,
                   DX.DOI_TYPE "DOI_TYPE_CODE",
                   TD.DESCRIPTION "DOI_TYPE",
                   DX.CHANGED_DATE,
                   DX.ACCOUNT_GROUP "MINERAL_DOI_TYPE",
                   DX.EFFECTIVE_DATE,
                   DX.EXPIRY_DATE,
                   DX.OWNER "OWNER_FLAG",
                   DECODE(MAX(DECODE(DECODE(TOW.OWNER,NULL,'N','Y')||NVL(DD.PENALTY,'N'),'YY',1,0)) OVER (PARTITION BY DD.DOI_ID, DD.PARTNER),1,'Y','N') "OWNER_IN_PENALTY",
                   DX.COMMENTS,
                   DD.OCCURRENCE "PARTNER_OCCURRENCE",
                   DD.PARTNER "PARTNER_BA",
                   BA1.NAME "PARTNER_NAME",
                   DD.PARTNER_PERCENT,
                   DECODE(TOW.OWNER,NULL,'N','Y') "OWNING_PARTNER_FLAG",
                   DD.SILENT_PARTNER "SILENT_PARTNER_FLAG",
                   DD.PARTNER_TYPE "PARTNER_TYPE_CODE",
                   TP.DESCRIPTION "PARTNER_TYPE",
                   DD.PENALTY "PENALTY_FLAG",
                   DD.SILENT_OWNER "SILENT_OWNER_BA",
                   BA2.NAME "SILENT_OWNER_NAME",
                   RPAD(BA1.NAME||'  ('||TRIM(DD.PARTNER)||')', 50, ' ') || LPAD(TO_CHAR(NVL(DD.PARTNER_PERCENT,0),'990.0000000'),12,' ') || '   ' || RPAD(NVL(DD.PARTNER_TYPE,' '),10,' ') || '   ' || 'Owner: '||DECODE(TOW.OWNER,NULL,'N','Y') || '   ' || 'Silent Partner: '||DECODE(DD.SILENT_PARTNER,'*','S',' ') || '   ' || 'Penalty: '||NVL(DD.PENALTY,'N') || '   ' || 'Silent Owner: '||RPAD(BA2.NAME||'  ('||TRIM(DD.SILENT_OWNER)||')', 50, ' ') "PARTNER_SUMMARY"
              FROM DS_CSLAND.D_XREF DX,
                   DS_CSLAND.D_DETAIL DD,
                   DS_CSLAND.T_OWNERS TOW,
                   DS_CSLAND.BA_TABLE BA1,
                   DS_CSLAND.BA_TABLE BA2,
                   DS_CSLAND.T_DOI TD,
                   DS_CSLAND.T_PTYPE TP
             WHERE DX.DOI_ID = DD.DOI_ID
               AND DD.PARTNER = TOW.OWNER(+)
               AND DX.EFFECTIVE_DATE <= CURRENT_TIMESTAMP
               AND DX.EXPIRY_DATE > CURRENT_TIMESTAMP
               AND DD.PARTNER = BA1.PRIMARY_KEY(+)
               AND DD.SILENT_OWNER = BA2.PRIMARY_KEY(+)
               AND DX.DOI_TYPE = TD.CODE(+)
               AND DD.PARTNER_TYPE = TP.CODE(+)
               AND DX.SUBSYSTEM = 'M'
        dependencies:
          - locationName: TARGET
            nodeName: VIEW_CSLAND_MINERAL_SUB_DETAIL
        join:
          joinCondition: |-
            -- Nodes used in the SQL override:
            {{ ref('TARGET','VIEW_CSLAND_MINERAL_SUB_DETAIL') }}
        name: VIEW_CSLAND_MINERAL_DOI_DETAIL
        noLinkRefs: []
  name: VIEW_CSLAND_MINERAL_DOI_DETAIL
  overrideSQL: true
  schema: ""
  sqlType: View
  type: sql
  version: 1
type: Node
