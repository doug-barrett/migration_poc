fileVersion: 1
id: bd9cc559-d73c-43e5-89f5-129abddc9e86
name: S_WAITLIST_30
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c494277-71bf-406f-b94a-736ff2f7705a
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: WAITLIST_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cc71172b-00c5-4403-8d9f-50a1c8f16356
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0f5e6bc-a2b1-4872-bbc5-bae20adef2f4
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: WAITLIST_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eafc0b5c-ea1f-48d9-8e14-b385d11311aa
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15d736c2-ff2d-4c46-986d-d9b4d61eb132
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ffb5fbd-8aad-4d64-9d98-b117dba69e63
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e3b474a-6a35-46fe-8dc5-bcec89a791c5
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITLIST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2ef74ff-fdd9-482b-8bf5-9c74e28eb502
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c95fa96-b19f-4601-8c54-5d30fab5c46c
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date on which the referral/waitlist was prioritised.  For a NPF presenting referral this is the authorisation date.  Otherwise this is the waitlist start date.
        name: PRIORITISATION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94137555-3ff1-46c5-8917-5eb21177817c
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f38ed119-b14c-4b12-9255-53f4345fb973
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITING_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e09e7670-1fb1-48ba-b032-6e024a71284d
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 12022d62-1324-4a18-9f1a-935ef73620b8
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITING_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 14e0f294-789b-48c9-bcb2-729eda7fba07
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b573fc1-ce2f-4629-b289-710a0b9c0186
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITLIST_ACKNOWLEDGEMENT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d44c27c6-1bba-4488-9a3b-852aedc5fe2d
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64a92bdd-b918-4336-a456-07ede920b4ef
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Removal Date or Last Day of Current Month
        name: ESPI_COMPLIANCE_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 89464021-f33d-42a4-9df7-2e7408285d2b
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0f9210b-d062-4c5b-8e3e-67f9d15f4f06
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITLIST_SUSPENSION_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa810411-8107-4939-bccb-c3946cc92eab
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d20a9f8-8989-4172-a0ed-e9316c17ec51
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITLIST_REMOVAL_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c1a7d3a-c04e-454e-b07d-937ea5bbea92
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e283126-b8ba-4653-b96a-f21f96be3777
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: REFERRAL_RECEIVED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ee28429-dc61-4866-a6cd-f3c96d3a4e4b
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b1f5ac3-7833-4f60-aaf0-84638b4a9829
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d71338ca-c412-4b54-99be-27367b8c1e7f
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a0b2a31-6ef8-470b-ae44-c0ba03309545
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRED_BY_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9bc0cd3e-e8c6-4a51-a115-b6798e6a1a8d
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09e9fa4b-6dd2-4138-b812-0249d829e437
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRED_BY_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3ce4dd2a-9bd2-4b7f-85b9-c51521d0e1ac
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 37af5325-a9d0-4643-949f-933b222f3faf
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRED_TO_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d0aec14b-80e8-4424-b521-e2a3100d74da
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1826953-505b-4fa8-bc6b-cddacfa69779
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRED_TO_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d4c9d59-034d-4288-ae69-ad3c46c0b3e1
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0fae873-48fb-4da9-a7e8-58fd0bb6605c
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_RULE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a63ad320-5ed4-447b-9209-575922fefc53
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 821307c8-2797-4610-80d8-167c796ea11c
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: WAITLIST_SPECIALTY_FACILITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 241d983f-5cf2-4e8c-90da-db75da2bbeb9
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 438945b1-9617-4dc0-bd2b-e89c0700bc7c
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_LOCAL_RULE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9dc5360f-03ba-4074-908f-ded11549acfa
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aaa02aae-b5eb-4ddd-8a92-ec0a6043361b
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: WAITLIST_LOCAL_SPECIALTY_FACILITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b274f64-f0a4-419a-aa3c-434095cb147d
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53610b44-5b63-40cb-9255-d2aea4e66985
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 88ad5e79-ff88-4825-80a2-f3ed2462d401
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18b3c7b2-9af0-469c-b58f-c05a5fa66df3
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_HEALTHCARE_PROFESSIONAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d66b824-92e1-4045-9d70-c2a6de976593
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6b6d63e-d825-4a5f-9067-bbc9ed1d12ae
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f530dd73-1e2c-484d-b001-4128764cab2e
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b909a696-a23b-4450-aab2-9094bb21ab0e
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Patient National Health Index (NMPI)
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 985f0ba0-97cf-4152-a49b-7e86cb71409e
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: caa6ef1e-50ae-4c59-9993-a502d6bc243e
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: 'Used for planning at the facility level of NSH, WTK or outsourced OS '
        name: PRODUCTION_PLAN_FACILITY_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE WHEN hospital_id IN ('3215','3216') THEN hospital_id
                          ELSE 'OTHER'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc7d30f4-fc6e-4dd8-b9e0-5ac665efe0fd
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Patient_Date_Of_Birth
        name: PATIENT_DATE_OF_BIRTH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f201416-ac35-4870-a0c1-0836d1b9e5b7
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05f633ce-732f-412a-afd6-1f004120704e
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Patient_Date_Of_Death
        name: PATIENT_DATE_OF_DEATH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b5c2ff38-a66e-4814-80ba-d041584351af
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 247cca89-30d6-45fe-86fc-e82e5696ce79
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: patient_age_at_waitlist_years
        name: PATIENT_AGE_AT_WAITLIST_YEARS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f201416-ac35-4870-a0c1-0836d1b9e5b7
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: FLOOR(DATEDIFF(dd,dim_patient.patient_date_of_birth, CASE WHEN IFNULL(dim_patient.patient_date_of_death,s_waitlist_20.waitlist_date) < s_waitlist_20.waitlist_date THEN IFNULL(dim_patient.patient_date_of_death,s_waitlist_20.waitlist_date) ELSE s_waitlist_20.waitlist_date END) / 365.25)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57a71bcf-b7a8-456b-b8f4-cde1cf18af2a
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_PREVIOUS_WAITLIST_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf7760f4-ef86-4659-8532-24a3327e6fa9
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7eb2e7f6-6534-4616-8ba4-5cf204b6a4f3
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PATIENT_PREVIOUS_WAITLIST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 644b232b-3304-462c-ace4-0e7976a50d3c
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2cf4d43-7c16-45df-9924-3ea5be45f004
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_PREVIOUS_REFERRAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 26bcad47-0b02-42c4-9219-fec6da73d67f
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a47187be-f077-41d1-890e-5f13e06cd43a
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_PREVIOUS_WAITLIST_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d759a576-334e-4c52-ae03-d65d345fc46b
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 378f7c8a-4b44-4a5e-8a81-b56754a9e2b3
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_PREVIOUS_WAITLIST_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2f905cc9-b359-49d3-95b9-29b1db3adbb2
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bc05a575-546a-43c5-9fd0-23ac2a3c0f8a
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_NEXT_WAITLIST_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a533812-dd23-4eed-903d-134419162bd9
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4be50acf-a0ed-4340-a6d5-798430a5d7ce
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PATIENT_NEXT_WAITLIST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83dcb206-e14e-4f9a-af08-eb629eaf3497
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16800af8-522f-4fca-80bb-389f38da0b27
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_NEXT_REFERRAL_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2cbf5423-d6de-4efd-85de-14c77f869f1a
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5518236c-a605-47a7-9b9c-5567743f2c1d
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_NEXT_WAITLIST_SPECIALTY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47194309-8dd0-4731-87be-fc71ef71f764
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8c055ab-d0c9-4c14-9a2c-32bede2eef3b
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_NEXT_WAITLIST_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 31293fe4-9092-49a8-9678-7bebafd78495
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2cdf101-edc0-4e9e-a4f2-5b2fb9b508bd
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Clinical Priority Assessment Criteria reference_no
        name: CPAC_SCORING_CATEGORY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c3fa2d5-c630-42bf-9618-0f8acba963a4
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 833a23c6-e076-4b79-b906-17485a9baef6
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Clinical Priority Assessment Criteria Assessing Clinician
        name: CPAC_ASSESSING_CLINICIAN_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64512ec9-34b5-4d33-a015-5d249d668ba2
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59e6dfe6-fdb2-4abf-b8b1-7e80f7cc0645
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Clinical Priority Assessment Criteria assessment_date
        name: CPAC_ASSESSMENT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 62b3dd9a-ca2d-42bb-a3d7-42a392a8c97e
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3375a781-6384-458c-846f-8e769d9da3ca
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Clinical Priority Assessment Criteria Score
        name: CPAC_SCORE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 123473a0-2f4b-424e-a1b2-9c377ac4a774
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 745b5584-2df6-4a2f-9cfb-710f032bafc6
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMIN_CATEGORY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 01ce088b-f27b-4b26-a772-d71f6b7f625d
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9636346-5c20-479f-a5c9-00ec02f41da1
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_MANAGEMENT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6734fb22-8ef7-4b3d-9295-a2cd6b270651
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3886ffb-abf0-43a1-8286-0f4f7e70b3d8
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFERRAL_PRIORITY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bcb2708a-90cd-4f1b-be12-aa30785e54f7
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86cdec8c-1773-4061-9a39-728e0622f4ec
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5e96095-244e-439f-b584-15c7c508b8bd
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a8ae1af-5d04-4ef5-b7e9-8e5dc561aaf7
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_WARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 69ef1f9f-f1ca-42e2-b7a4-5aeef17afd45
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5fac7ec9-bd29-4462-9a1e-218976f8441f
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_TRANFER_WARD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d217f054-5a7a-4a54-a55f-2f1795ddbb96
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e7a442d8-e2a3-4975-b263-00a81ad2b27d
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_CONSULTANT_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a9157836-c408-4efa-909f-ad9306317327
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6bc19149-94c7-45fb-bfe8-a44d98771c3b
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_REMOVAL_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a7e17938-6e82-4aa0-89fa-cd87929f45b5
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f1e35ad3-7291-4555-bcb7-07b73f07fe3f
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_COMPLETION_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 08215a2f-6a55-41fc-9fe0-d17586f52b5f
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fdbb8f13-1324-44d1-b318-d11261586800
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ANAESTHETIC_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec966b38-aafe-4e8c-a273-8e5fe48723d3
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d2455d3-eda7-4352-ac53-49962c4c309f
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_BOOKING_STATUS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 12ecd335-54c8-42cd-8784-cf1460bdcadc
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fab9f4fd-cc65-45be-8a34-d0993664be7d
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITLIST_BOOKING_STATUS_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 15f309a9-66b1-44f2-8110-990951c6f2ac
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e33e1a8-df95-4fff-b9be-726020f96312
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_PROCEDURE_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 348da432-0ad6-4b12-972f-e36b2a11444f
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24d7591d-29f7-4a2e-baaf-42c8e1172818
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_MODE_OF_DELIVERY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d0cb9528-7b71-4411-9608-2e6180a06438
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b5cf5b66-7a5e-4501-ac89-1d832cef898b
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: VARCHAR(255)
        defaultValue: ""
        description: ""
        name: PLANNED_PROCEDURE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05d6392f-86bb-4fc2-ba7b-14e0a56d3dac
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 202328fe-399e-466b-8370-be18a0f3f256
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PLANNED_PROCEDURE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf26aa26-7867-49d0-a0ec-fcbf017a424e
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PLANNED_PROCEDURE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2b4e82d-3517-4a56-825a-60f39b822e62
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: PRINCIPAL_DIAGNOSIS_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d5d1e0a-08ed-40f5-b8c1-8064cebbcdcb
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRINCIPAL_DIAGNOSIS_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7145b809-5be6-4709-b84e-8bc303ae56fb
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMISSION_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0278a5a9-af07-4959-882c-a2dc812c81b2
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7fbd0637-b95c-44ad-b5af-26e990debfdf
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMISSION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77503c62-40ce-4a09-a729-5fb9e89673c3
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e256fb1-18f1-4816-8212-4cd1ff89fa01
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: PROPOSED_ADMISSION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d52f2b81-0717-4e01-8cf6-dc75ef496b9c
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0bdb1775-2131-4159-9433-c7dbe8538f08
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SURVEILLANCE_PERIOD_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf667e59-c7be-416e-bd3e-41311a840863
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e5894b2-d6c3-4ca2-a17b-406579458b6d
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: outsourced
        name: OUTSOURCED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d9d132cc-9fa2-4a27-9040-e8d682a75702
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 76cf7fa7-1a96-460b-a3f9-6d10097b83f1
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: date_outsourced
        name: DATE_OUTSOURCED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b0a1df5-8bd8-452b-abc6-c2cacd07252d
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 68c17a85-8738-4994-97ce-b1ff25f8bbc1
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: If outsourced the facility outsourced to.
        name: OUTSOURCED_FACILITY_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 948ebd6e-8baa-4f20-8a02-92d0afe2396f
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e9db68a-da20-4c19-aa9f-1feb8f3906db
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: OUTSOURCED_RETURN_REASON_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b87821a-deb9-4512-a133-2001c0e7c4df
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 637fb4d5-a1be-4b51-bd84-895510331e57
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: OUTSOURCED_RETURN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 15d18e78-2bc2-4397-b221-0a50f4ca7efd
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b1291ea-a107-4d29-865b-83e97a640ff7
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NBRS_PROCEDURE_TYPE_REFERENCE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75081974-c436-42b0-bcb9-d17c7e73ad62
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 10b37509-88b0-4c10-89ad-e23937555e95
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: NBRS_PROCEDURE_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c46b047-94ae-45fd-bc93-aa34fe632a0c
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff126306-1b0a-473e-b1ed-3fa752f2dacf
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: NBRS_PERIOD_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d467c5a3-4472-48e7-9cc1-2834f0129f6b
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7e53951-716f-4836-adb0-94d17b76963d
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: waitlist Due Date
        name: WAITLIST_DUE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 89464021-f33d-42a4-9df7-2e7408285d2b
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6b512c81-51b2-4ba0-8fbc-cbbe03cfa312
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITLIST_REASSESSMENT_DATE_MONTH4
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2f1f204a-b45b-4c86-b86d-9ebd87fc1883
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: |-
              --Interim field not updated as I don't think its used 
               CASE WHEN ESPI_type_no IN (6,9)                                                    THEN DATEADD(DAY,84,waitlist_clock_start_date) 
                          WHEN ESPI_type_no IN (7)                                                      THEN DATEADD(DAY,14,waitlist_clock_start_date) 
                          WHEN ESPI_type_no IN (8)                                                      THEN DATEADD(DAY,45,waitlist_clock_start_date) 
                          WHEN ESPI_type_no IN (1,2,5,16) AND waitlist_clock_start_date < '01-Feb-2013' THEN DATEADD(s,-1,DATEADD(mm,1,DATEADD(dd,180,waitlist_clock_start_date)))
                          WHEN ESPI_type_no IN (1,2,5,16)                                               THEN DATEADD(s,-1,DATEADD(mm,1,DATEADD(dd,120,waitlist_clock_start_date)))
                          ELSE NULL
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 46ddb3ed-2eda-48fc-a223-475d17070c0f
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITLIST_CLOCK_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2f1f204a-b45b-4c86-b86d-9ebd87fc1883
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c0b2e81-245f-41f5-ac85-bed4db4fca4d
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WAITLIST_CLOCK_STOP_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ba53590f-4c0d-49db-ad25-6bee9dcd15bc
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38c9183e-a9b8-4ad3-997d-32078fd09159
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: SURGICAL_THEATRE_BOOKING_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f633b3c5-39a3-403b-b296-730a02a1fc93
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78d1ccf5-5bdf-40be-b269-9f0dd8d2d976
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: OUTPATIENT_APPOINTMENT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 71b493cc-375d-4968-bd5c-148c0c78f2b3
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34af1abd-f052-4f63-85cd-c37504bdb4dc
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: BOOKING_DATE_DNA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 039bd3cd-08fc-4c8a-bc4d-5ed31aea2e83
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1fd49351-61ec-40d9-97ee-2f2fbdb6be4d
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: INPATIENT_ACTUAL_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1f7aa3e-49af-4517-9ece-7c806bebe861
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 575b8758-6e93-48f3-a1e6-506eeac2535b
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Is the patient currently admitted for theis waitlist episode
        name: CURRENT_INPATIENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db2e8c3e-71d5-4d96-8d71-2dc06155d6c9
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe529d95-32d0-4118-9466-adc705bac2ed
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CERTAINTY_GIVEN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 49cfe248-60e3-455f-84c2-8e8ffbd942e6
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bece39bb-b565-4931-849b-54bb64b06689
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CARE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b7b0a169-4395-433b-8ae1-2bfff688b054
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: caed160d-0492-4536-904c-f40c71844517
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: FSA_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27aa6124-471c-4fb8-b3b2-e38b71a82c37
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf26a3f8-edec-4303-bfa5-916eba915efb
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: TCI_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bfd0f9c6-efb7-4896-a509-f47fef4380df
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cbb98395-9b5b-44ef-8fed-6920735b9dc6
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: BOOKING_CREATED_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c9ae004b-bf73-4f93-8a8d-52e361aea883
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c60a9bb9-11d5-45b7-84cd-d22f743755f9
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ADMISSION_READY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1185844d-b811-4274-a057-2571f701b315
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 93732b88-5a33-4e08-9d77-813e70533916
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: SHORT_NOTICE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f3392a63-47e9-4d05-9359-7dc1c57cb17e
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 816d371b-4304-4efe-aaf2-df642a495cc0
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: WAITLIST_SUSPENSION_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9e9686be-aeed-4565-b075-ff1de45852d2
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 806c091a-6472-48ca-9703-0c9965833f92
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Provisional Attribute - Rules TBA
        name: CANCER_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6fe2d1cb-1235-4f3f-a0e8-cbe238478ea2
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7a98fb0-2097-4e09-b198-2445ec78c521
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ESPI_TYPE_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 982d4b53-1a0f-46bb-a92e-ade65b28d9b8
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6cf9bee-c100-4615-becf-2127d0dbacb3
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: VARCHAR(2000)
        defaultValue: ""
        description: ""
        name: WAITLIST_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: af521199-d4f8-4b01-933c-07dc2da55225
                stepCounter: d0578c3c-e29c-4bd7-adaa-6db6a10a08c3
            transform: LEFT(s_waitlist_note.note,2000)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a133245-9a89-492d-86af-22c87df7c8a9
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACTIVE_INDICATOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 139ce2dc-ac0d-494d-bfce-34d7f1995eae
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5862252-1885-4dd3-b6b3-0855116e4328
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SURGICAL_THEATRE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 82919a53-43e1-4ccd-a447-c9e675f2889f
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f968620-51fd-47a1-ac36-ea77feffcbc1
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_SUSPENSION_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3509f81-5e6b-4d84-ac11-9b103ebbe991
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ac2a5eb-a22d-4879-8752-db66baef1926
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: 'Days that the wailist has been suspended including any future suspension period '
        name: WAITLIST_SUSPENSION_DAYS_PLANNED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ac3436c-3e74-4ca0-b77d-6abc6a63b784
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5dca01a1-e60b-466d-8104-8813d1043ce8
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INT
        defaultValue: ""
        description: waitlist_days_to_breach relative to the clock start date
        name: WAITLIST_DAYS_TO_BREACH
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 16ba6647-0602-4dc3-8990-76025d032784
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54262bae-197d-478b-acd8-f82940616420
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: WAITLIST_WAITING_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e09e7670-1fb1-48ba-b032-6e024a71284d
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: |-
              CASE WHEN waitlist_clock_start_date >= IFNULL(waiting_end_date,waitlist_clock_start_date) AND waitlist_removal_reason_desc ='Revised priority' THEN 0 -- -   IFNULL(s_waitlist_20.waitlist_suspension_days,0)

                          WHEN s_waitlist_20.waitlist_clock_start_date > getdate()                                                                                  THEN DATEDIFF(dd,s_waitlist_20.waitlist_clock_start_date ,IFNULL(s_waitlist_20.waiting_end_date,s_waitlist_20.waitlist_clock_start_date)) - IFNULL(s_waitlist_20.waitlist_suspension_days,0)
                          ELSE DATEDIFF(dd,s_waitlist_20.waitlist_clock_start_date ,IFNULL(s_waitlist_20.waiting_end_date,getdate())) - IFNULL(s_waitlist_20.waitlist_suspension_days,0)
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31a800f4-98b3-4c6c-b101-b9ea00fc8251
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Days waited at the end of the current month, if waitlist still open
        name: WAITLIST_WAITING_MONTHEND_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 14e0f294-789b-48c9-bcb2-729eda7fba07
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: |-
              CASE WHEN s_waitlist_20.waiting_end_date IS NULL THEN (DATEDIFF(dd,s_waitlist_20.waitlist_clock_start_date,DATEADD(s,-1,DATEADD(mm,DATEDIFF(m,0,getdate())+1,0)))) - IFNULL(s_waitlist_20.waitlist_suspension_days,0)
                          ELSE 0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a755603-5dfb-431a-b895-e479b1440ff2
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: HOSPITAL_LENGTH_OF_STAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a0249d37-1a80-40e0-a108-737f73d064b7
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0efc8836-6ce6-4888-963f-bee9474fc6ec
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: Sequence of the waitlist withing a referral
        name: PATIENT_REFERRAL_WAITLIST_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3523d575-5640-42a7-a496-9f5014a8f0d8
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8fdde7fc-40e3-4ad3-8113-f64837a0100d
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_WAITLIST_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4773322d-95b8-434b-9ce9-c2f88d93c1ff
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa218dd4-cd76-41aa-8ee4-d66aae26ca1a
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Is this referral an National patient flow referral, Note this rule is currently the same as the ESPI1 rule over time it will evolve to include more data than ESPI 1.
        name: NPF_REFERRAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: accc4533-f7be-4c0f-ae19-e943d707d309
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d044fb4c-134b-4ad4-b47a-fde948072ec0
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Is this referral an National patient flow related referral, related referrals are all waitlists on a referral except the first.  The first is considered a presenting referral.
        name: NPF_RELATED_REFERRAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 689e9238-78c1-4b5c-98d8-c12e94b0411d
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 110aeaf4-4eae-4180-8274-18727d462f52
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: Is this waitlist a National patient flow preseting referral, presenting referrals are the first referral waitlist.  FSA waitlists can be recreated for DNAs so the last FSA waitlist on a referral is the only one counted for NPF.
        name: NPF_PRESENTING_REFERRAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7fc44b30-573a-4fbd-9476-17d540a9ade8
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 451bae99-f57a-4a13-b308-a447d52873d4
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INT
        defaultValue: ""
        description: Sequence to show reverse order of waitlist types within a referral.  Needed for NPF to identify the last FSA waitlist.
        name: NPF_SEQ_REV_ESPI_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab235337-2d6d-4d0a-be2d-fe48a0a188b0
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82d328cc-ea08-4dd4-a627-44fd8b1f13e7
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: WAITLIST_MAPPINGS_ROWID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e20051c8-bf01-4c0a-8f6f-267740c3b556
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f367845-cdf4-4a6c-ab38-76c367232e32
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: WAITLIST_APPOINTMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b43af6c5-c5ad-4dca-91f2-3f937fc0f447
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c7f24c1-07df-42a6-9a09-a1c1783b16fc
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: WAITLIST_ADMISSION_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05220a71-4156-4ac9-a296-69d20d4dde4c
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16b247cb-3a43-4c81-84d2-f453bb29ec26
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: WAITLIST_ATTENDED_APPOINTMENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 35c17829-cb40-42d2-8baa-87f3020b4bc4
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0777668-dd94-424e-98f6-37d4ccb0a291
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: CHAR(4)
        defaultValue: ""
        description: ""
        name: SERVICE_SUB_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8a97ee38-bbb5-4251-ab85-2f8881bf3b89
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f702389-0b89-4d64-b1ea-90c042f6de3d
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: SERVICE_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: db598fb2-d15c-445a-a6ad-454d78475e4d
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64c5fcf4-ac2d-4903-8764-943f6e6a56d5
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: ENCOUNTER_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27bca667-d215-4e22-835a-e842b9259343
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d60c3e6a-4802-4479-bcd3-748b11250ad4
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PATIENT_WAITLIST_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ed75f28-43af-4ae7-8ac9-4d842274bade
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8aba431-e8a9-4437-8d52-c7dc38b30cc6
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 647ad19c-fc4e-4031-9880-e95541471fca
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c26f18c9-4823-439c-afc5-befff8947b93
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: CREATE_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f5115acf-fa00-49cf-8076-29e4de8f4ff2
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39f0b00e-1274-435d-a8da-45f22e4b1b1e
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MODIFY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3de2efbc-817a-4273-933b-8354d8756632
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5fe8339-b0f1-418e-a107-c9513697c131
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: Grouping of ESPI types into a group representing the measure
        name: WAITLIST_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3c1a2b93-7fa0-4c37-be46-83d1240ec7ad
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bdb183d3-07c5-4b1d-a6f6-a72dd6ecd431
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: P1_BOOK_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6647dbdf-f2dc-4dda-a5a5-08faabfd2e53
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2e29ef7-aa49-4fbe-9e17-ef096a2485ce
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: P2_BOOK_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7451e0ba-3dc6-4e5f-8be9-74499d62f8a5
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b06abb3e-98b7-4db3-aeaf-89a958aca098
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: P3_BOOK_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 17116a65-a60d-4a72-b49d-afe1b88c38f0
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d1afd149-07c9-42d4-8299-740d982274d9
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INT
        defaultValue: ""
        description: Time from clock start to desired waiting time end.  Period type indicates if this number indicates days or months
        name: PERIOD_TO_BOOK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8bf8adcc-9298-4fd7-97bc-6caf2d01ad0f
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da77b7af-7020-4716-a5fc-cddab030b4df
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date by which you'd expect the patient to be seen.  Based on timings per priority provided by the services
        name: OPTIMAL_BOOKING_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b1c82af-63bf-4177-bb94-c58ce48873e0
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ff722f1-ee01-47fb-b27d-08bd65b7a639
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: INT
        defaultValue: ""
        description: A value is required here if the lead in time for booking is greater than the period of time to book
        name: ADVANCE_ALERT_FOR_BOOKING_DAYS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2f172194-0e4c-41ad-882f-bfdb6f279131
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5895443-a93d-4739-8b17-396f7f824d72
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: VARCHAR(30)
        defaultValue: ""
        description: ""
        name: MODIFY_USER_LOGIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27fbb800-1370-4cb4-b529-8ada40f9d639
                stepCounter: df89da50-5c82-4d59-8da2-abc1e37c3c02
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e471887-4c43-4303-987b-eb4e96d364f1
          stepCounter: bd9cc559-d73c-43e5-89f5-129abddc9e86
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_WAITLIST_20
        join:
          joinCondition: |-
            FROM s_waitlist_20
             INNER JOIN dim.dim_patient
                ON s_waitlist_20.patient_reference_no = dim_patient.patient_reference_no
              LEFT OUTER JOIN s_waitlist_diagnosis_procedure s_waitlist_diagnosis_procedure_p
                ON s_waitlist_20.waitlist_reference_no = s_waitlist_diagnosis_procedure_p.waitlist_reference_no
               AND s_waitlist_diagnosis_procedure_p.diagnosis_procedure_type_code = 'PROCE'
               AND s_waitlist_diagnosis_procedure_p.medical_problem_level_no = 1
              LEFT JOIN dim.dim_waitlist_removal_reason
                ON s_waitlist_20.waitlist_removal_reason_reference_no=dim_waitlist_removal_reason.waitlist_removal_reason_reference_no
              LEFT OUTER JOIN s_waitlist_diagnosis_procedure s_waitlist_diagnosis_procedure_d
                ON s_waitlist_20.waitlist_reference_no = s_waitlist_diagnosis_procedure_d.waitlist_reference_no
               AND s_waitlist_diagnosis_procedure_d.diagnosis_procedure_type_code = 'DIAGN'
               AND s_waitlist_diagnosis_procedure_d.medical_problem_level_no = 1
              LEFT OUTER JOIN s_waitlist_note
                ON s_waitlist_20.waitlist_reference_no = s_waitlist_note.sorce_refno
               AND s_waitlist_note.row_num = 1
              LEFT OUTER JOIN (
                    SELECT waitlist_encounter_id,
                           hospital_id,
                           ROW_NUMBER() OVER(PARTITION BY waitlist_encounter_id ORDER BY admit_date) duplicate
                      FROM s_in_patient_event_05
                   ) inpat
                ON inpat.waitlist_encounter_id = s_waitlist_20.waitlist_encounter_id
               AND inpat.duplicate = 1
        name: S_WAITLIST_30
        noLinkRefs: []
  name: S_WAITLIST_30
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
