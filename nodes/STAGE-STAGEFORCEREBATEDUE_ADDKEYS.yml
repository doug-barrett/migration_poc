fileVersion: 1
id: 163b2e8d-389c-4c6c-8770-e57cf556b4ae
name: STAGEFORCEREBATEDUE_ADDKEYS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0c043dec-7359-4c7a-a364-096c1cc2b068
          stepCounter: 163b2e8d-389c-4c6c-8770-e57cf556b4ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEFORCEREBATEDUE_ADDKEYS.FORCEREBATEDUEID=FORCEREBATEDUEDETAIL.FORCEREBATEDUEID
        name: FORCEREBATEDUEDETAILKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f5e7b80-997e-4634-9c38-dd069ad4f150
                stepCounter: c6f32108-0b07-46b0-b9e9-3e91800036e3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2ee51dc-28b8-4a13-af9b-d747543bffb7
          stepCounter: 163b2e8d-389c-4c6c-8770-e57cf556b4ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: AUTOGENERATED ID
        isBusinessKey: true
        name: FORCEREBATEDUEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 69a7e36a-943b-4d89-ac31-102b359f2460
                stepCounter: ced77a45-97fa-4287-bc36-4e5a65021192
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: daf276b1-6a54-4c97-a1ac-b6f2265af5b4
          stepCounter: 163b2e8d-389c-4c6c-8770-e57cf556b4ae
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER ID
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f37ffc1b-d588-400a-9c64-e93c467ed639
                stepCounter: ced77a45-97fa-4287-bc36-4e5a65021192
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f50a2d03-9a6a-4649-9bc6-4a8e79aa2d76
          stepCounter: 163b2e8d-389c-4c6c-8770-e57cf556b4ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEFORCEREBATEDUE_ADDKEYS.SUPPLIERID=SUPPLIER.SUPPLIERID
        name: SUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 29f4e3f6-d1f4-4347-909f-18969301d6f1
                stepCounter: f82e9572-e5ea-45e1-991d-83ad35997403
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77302bff-3b20-4d77-9f13-660a37eeefdf
          stepCounter: 163b2e8d-389c-4c6c-8770-e57cf556b4ae
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: CONTRACT ID
        name: CONTRACTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c4ba5b6-f487-4583-9bc2-5db86b59a402
                stepCounter: ced77a45-97fa-4287-bc36-4e5a65021192
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 749686c4-996e-4c88-981b-820475fc8c9b
          stepCounter: 163b2e8d-389c-4c6c-8770-e57cf556b4ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEFORCEREBATEDUE_ADDKEYS.CONTRACTSALESFORCEID=CONTRACT.CONTRACTSALESFORCEID
        name: CONTRACTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9eecd6c8-6720-4938-83f9-9ebbd7c72ec7
                stepCounter: 59cadb79-2e03-4a1c-9c6e-7e6588e89674
            transform: COALESCE(CONTRACT.CONTRACTKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ff5281e-8d54-4e99-8267-070eb232b36f
          stepCounter: 163b2e8d-389c-4c6c-8770-e57cf556b4ae
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: FORCE ID
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bedd1e94-def1-4fdd-97ff-ace3bee5402f
                stepCounter: ced77a45-97fa-4287-bc36-4e5a65021192
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 914319e5-00ce-4ef8-bd7f-671be9a7fcac
          stepCounter: 163b2e8d-389c-4c6c-8770-e57cf556b4ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEFORCEREBATEDUE_ADDKEYS.FORCEID=ACCOUNT.FORCEID
        name: ACCOUNTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd325e05-7e18-499b-bd60-b3144ec04cb9
                stepCounter: e6f00723-a598-4272-b25a-ed544e4c0a06
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df53a63a-6c95-4426-abb2-d7ca4877c101
          stepCounter: 163b2e8d-389c-4c6c-8770-e57cf556b4ae
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: CHECK ID
        name: CHECK_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ae29965a-1b87-4cf6-a5e7-344f69b58381
                stepCounter: ced77a45-97fa-4287-bc36-4e5a65021192
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa89225b-7da7-4e66-bbc3-0151125fbddf
          stepCounter: 163b2e8d-389c-4c6c-8770-e57cf556b4ae
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: MEMBER CODE
        name: MEMBER_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 044f3572-88ef-418c-a2d1-d2238ae87d41
                stepCounter: ced77a45-97fa-4287-bc36-4e5a65021192
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e125b0c-eb48-40d9-9d2b-07d177ffeaee
          stepCounter: 163b2e8d-389c-4c6c-8770-e57cf556b4ae
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: CYCLE START DATE
        name: CYCLE_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6fdc5ae6-ba0c-4c28-93e3-d75979da22d6
                stepCounter: ced77a45-97fa-4287-bc36-4e5a65021192
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1d1a90f-a0b9-4dc9-88ae-03a6cb488045
          stepCounter: 163b2e8d-389c-4c6c-8770-e57cf556b4ae
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: CYCLE END DATE
        name: CYCLE_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 58c405e2-9738-498f-9932-1361cb997367
                stepCounter: ced77a45-97fa-4287-bc36-4e5a65021192
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e439751e-8529-4581-8da5-5e48d98b45ab
          stepCounter: 163b2e8d-389c-4c6c-8770-e57cf556b4ae
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: CYCLE
        name: CYCLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4db8e080-9a83-4548-90cf-dfdf7196d413
                stepCounter: ced77a45-97fa-4287-bc36-4e5a65021192
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 526b7bd4-6671-4b22-9355-a0d2102ca3d8
          stepCounter: 163b2e8d-389c-4c6c-8770-e57cf556b4ae
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: TOTAL SALES
        name: TOTAL_SALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03076d4c-a04d-42f3-aca1-4ed4c8ff3a18
                stepCounter: ced77a45-97fa-4287-bc36-4e5a65021192
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5d6b279-6a51-44df-b135-07f7ba633181
          stepCounter: 163b2e8d-389c-4c6c-8770-e57cf556b4ae
        config: {}
        dataType: NUMBER(18,4)
        defaultValue: ""
        description: BASELINE ALLOCATION
        name: BASELINE_ALLOCATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e0012ce-693e-4e69-8ef4-3757d6f5f689
                stepCounter: ced77a45-97fa-4287-bc36-4e5a65021192
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1439c42-aabb-42ef-b31d-5db2c214f96e
          stepCounter: 163b2e8d-389c-4c6c-8770-e57cf556b4ae
        config: {}
        dataType: NUMBER(18,4)
        defaultValue: ""
        description: ELIGIBLE SPEND
        name: ELIGIBLE_SPEND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23af7792-50ac-4099-80d7-422c3df53a09
                stepCounter: ced77a45-97fa-4287-bc36-4e5a65021192
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3cd692f-4988-4d20-a5e8-a20ef0ce78f2
          stepCounter: 163b2e8d-389c-4c6c-8770-e57cf556b4ae
        config: {}
        dataType: NUMBER(18,4)
        defaultValue: ""
        description: REBATE TIER
        name: REBATE_TIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 20e4c202-7935-49e2-b626-f3a049f85ad8
                stepCounter: ced77a45-97fa-4287-bc36-4e5a65021192
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c97e980d-447b-42fd-bde1-bc26847c763d
          stepCounter: 163b2e8d-389c-4c6c-8770-e57cf556b4ae
        config: {}
        dataType: NUMBER(38,4)
        defaultValue: ""
        description: REBATE DUE
        name: REBATE_DUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f05e765-109a-4341-a1b9-5d3588ca5ccf
                stepCounter: ced77a45-97fa-4287-bc36-4e5a65021192
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b31e2a7c-2e25-4123-b5b8-d48402c7c39d
          stepCounter: 163b2e8d-389c-4c6c-8770-e57cf556b4ae
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: PAYOUT YEAR
        name: PAYOUT_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11b7156c-3a11-4685-baf6-32cfc9460979
                stepCounter: ced77a45-97fa-4287-bc36-4e5a65021192
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7749c7c5-3530-4aaa-ac2b-2fc8785a464c
          stepCounter: 163b2e8d-389c-4c6c-8770-e57cf556b4ae
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: PAYOUT PERIOD
        name: PAYOUT_PERIOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1dd0b5f-d3f0-46ba-8d45-e0eb577e1a38
                stepCounter: ced77a45-97fa-4287-bc36-4e5a65021192
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4cf6ba89-04cb-4a41-98b1-a44e6ca51170
          stepCounter: 163b2e8d-389c-4c6c-8770-e57cf556b4ae
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: IS POSTPONE
        name: IS_POSTPONE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 43e581a9-7230-45e3-803e-68f381d7e598
                stepCounter: ced77a45-97fa-4287-bc36-4e5a65021192
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a86019b5-ff92-4c94-8d22-0b89e9bb2604
          stepCounter: 163b2e8d-389c-4c6c-8770-e57cf556b4ae
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: IS ARCHIVED
        name: IS_ARCHIVED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: abf08826-4963-4fc7-b920-a865d1024861
                stepCounter: ced77a45-97fa-4287-bc36-4e5a65021192
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 56ed4dce-6e96-4cb5-b245-89e93a0a750f
          stepCounter: 163b2e8d-389c-4c6c-8770-e57cf556b4ae
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 68cae4c6-19fa-482e-9854-772ac442a42e
                stepCounter: ced77a45-97fa-4287-bc36-4e5a65021192
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 261927fe-f47b-4d2c-a405-fe033a250691
          stepCounter: 163b2e8d-389c-4c6c-8770-e57cf556b4ae
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DSS LOAD DATE
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76ab11ea-2449-4ff4-ae72-eff5225920a3
                stepCounter: ced77a45-97fa-4287-bc36-4e5a65021192
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02b30d67-e379-41f5-9c77-75e28cb90bd1
          stepCounter: 163b2e8d-389c-4c6c-8770-e57cf556b4ae
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 88fc6421-3dfb-4558-b62d-bdf447ddde22
          stepCounter: 163b2e8d-389c-4c6c-8770-e57cf556b4ae
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGEFORCEREBATEDUE_1: ced77a45-97fa-4287-bc36-4e5a65021192
          CONTRACT: 59cadb79-2e03-4a1c-9c6e-7e6588e89674
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: DIM
            nodeName: CONTRACT
          - locationName: DIM
            nodeName: FORCEREBATEDUEDETAIL
          - locationName: DIM
            nodeName: SUPPLIER
          - locationName: STAGE
            nodeName: STAGEFORCEREBATEDUE_1
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','STAGEFORCEREBATEDUE_1') }} STAGEFORCEREBATEDUE_1
              LEFT JOIN {{ ref('DIM','CONTRACT') }} CONTRACT
                ON STAGEFORCEREBATEDUE_1.CONTRACTID = CONTRACT.CONTRACTID
        name: STAGEFORCEREBATEDUE_ADDKEYS
        noLinkRefs: []
  name: STAGEFORCEREBATEDUE_ADDKEYS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
