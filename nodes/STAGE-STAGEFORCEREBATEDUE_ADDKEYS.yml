fileVersion: 1
id: 86964991-98e1-490f-9262-93daef22e0ae
name: STAGEFORCEREBATEDUE_ADDKEYS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c73e4d79-65b1-4a5a-a7d7-83e03dc61e43
          stepCounter: 86964991-98e1-490f-9262-93daef22e0ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEFORCEREBATEDUE_ADDKEYS.FORCEREBATEDUEID=FORCEREBATEDUEDETAIL.FORCEREBATEDUEID
        name: FORCEREBATEDUEDETAILKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91d4f5cd-d8e7-4742-8c0e-344da840019d
                stepCounter: e628ef2a-e8e6-4589-bb20-a308f44120ec
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4d8c29e-c34a-4c3e-8c6f-845bc5fa64a1
          stepCounter: 86964991-98e1-490f-9262-93daef22e0ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: AUTOGENERATED ID
        isBusinessKey: true
        name: FORCEREBATEDUEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3cfb6ad8-50e6-443c-a33d-674f779c294d
                stepCounter: a4258389-f06f-42d3-87e5-4f8e65247ca3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9bb95bb1-1d0b-4784-ada2-48540fd01212
          stepCounter: 86964991-98e1-490f-9262-93daef22e0ae
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER ID
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b378862-4e69-4ffe-a7bb-a53ebf3e7e2f
                stepCounter: a4258389-f06f-42d3-87e5-4f8e65247ca3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1bf037af-79b1-47f1-8c47-1dfeca3edbd6
          stepCounter: 86964991-98e1-490f-9262-93daef22e0ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEFORCEREBATEDUE_ADDKEYS.SUPPLIERID=SUPPLIER.SUPPLIERID
        name: SUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8af74fd2-6685-417f-ba69-54e34a59747a
                stepCounter: 46ab7310-f206-4d38-93fc-0dcfb497301d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29dc8888-c442-4064-ba87-accf9ba8ecac
          stepCounter: 86964991-98e1-490f-9262-93daef22e0ae
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: CONTRACT ID
        name: CONTRACTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c90eefb-9b15-4b86-a13f-6c62055472d8
                stepCounter: a4258389-f06f-42d3-87e5-4f8e65247ca3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df96032c-b5af-4bbc-81ae-9406ed8847c4
          stepCounter: 86964991-98e1-490f-9262-93daef22e0ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEFORCEREBATEDUE_ADDKEYS.CONTRACTSALESFORCEID=CONTRACT.CONTRACTSALESFORCEID
        name: CONTRACTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 012a8445-b992-4874-a802-ad1b6196a28d
                stepCounter: 930a330f-3276-4f21-bd05-9ed55fd63528
            transform: COALESCE(CONTRACT.CONTRACTKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e618097d-96b5-40a3-abda-9ecb2011ed9a
          stepCounter: 86964991-98e1-490f-9262-93daef22e0ae
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: FORCE ID
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 423fec55-d619-4c86-a197-dd104884579d
                stepCounter: a4258389-f06f-42d3-87e5-4f8e65247ca3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec32d111-169c-4e2a-a940-0a3eb063c7a1
          stepCounter: 86964991-98e1-490f-9262-93daef22e0ae
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEFORCEREBATEDUE_ADDKEYS.FORCEID=ACCOUNT.FORCEID
        name: ACCOUNTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51242f2b-12a0-45ea-bdfb-000fdb4c550a
                stepCounter: 96e8695b-6733-4729-8797-91b12c74cb7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a876a9a-430d-4fa4-91bb-07331b095f06
          stepCounter: 86964991-98e1-490f-9262-93daef22e0ae
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: CHECK ID
        name: CHECK_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea74fd3e-edb6-4b8c-b8f5-fa7cd20daf5e
                stepCounter: a4258389-f06f-42d3-87e5-4f8e65247ca3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21224f66-e14a-43c4-9af0-cc718de000a9
          stepCounter: 86964991-98e1-490f-9262-93daef22e0ae
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: MEMBER CODE
        name: MEMBER_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9779e3d2-dab8-43f2-95d7-6f33d3783e8d
                stepCounter: a4258389-f06f-42d3-87e5-4f8e65247ca3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07e678c0-2c90-466f-bccd-5010b631516b
          stepCounter: 86964991-98e1-490f-9262-93daef22e0ae
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: CYCLE START DATE
        name: CYCLE_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0d73343f-e801-409a-8789-5e3d0cf58a0e
                stepCounter: a4258389-f06f-42d3-87e5-4f8e65247ca3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b529eb3-4ae2-47dd-8b62-ac975b551138
          stepCounter: 86964991-98e1-490f-9262-93daef22e0ae
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: CYCLE END DATE
        name: CYCLE_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e19a305-8201-4430-adb3-acea2f5a0b45
                stepCounter: a4258389-f06f-42d3-87e5-4f8e65247ca3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9fa1dbe2-4c10-4cbf-91be-4a96499f94fa
          stepCounter: 86964991-98e1-490f-9262-93daef22e0ae
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: CYCLE
        name: CYCLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8575b33b-f5c2-414a-bc01-d27bbd581126
                stepCounter: a4258389-f06f-42d3-87e5-4f8e65247ca3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 58fe0291-dd1b-4f9a-8af7-537b13299e74
          stepCounter: 86964991-98e1-490f-9262-93daef22e0ae
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: TOTAL SALES
        name: TOTAL_SALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 851c38a7-8f21-47b6-87f1-0a46a841ef93
                stepCounter: a4258389-f06f-42d3-87e5-4f8e65247ca3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 196deab7-2375-4e8e-8ebb-675fcd19d230
          stepCounter: 86964991-98e1-490f-9262-93daef22e0ae
        config: {}
        dataType: NUMBER(18,4)
        defaultValue: ""
        description: BASELINE ALLOCATION
        name: BASELINE_ALLOCATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b747bd5-68d6-4a25-b4e9-357d5176b84b
                stepCounter: a4258389-f06f-42d3-87e5-4f8e65247ca3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aae82c0a-709d-4449-ac9a-7019ec68f9f4
          stepCounter: 86964991-98e1-490f-9262-93daef22e0ae
        config: {}
        dataType: NUMBER(18,4)
        defaultValue: ""
        description: ELIGIBLE SPEND
        name: ELIGIBLE_SPEND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a6ccd01-4221-4fa6-9fa7-695452e3e8c5
                stepCounter: a4258389-f06f-42d3-87e5-4f8e65247ca3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3f4f7446-6150-499c-a377-4930d16fb0bd
          stepCounter: 86964991-98e1-490f-9262-93daef22e0ae
        config: {}
        dataType: NUMBER(18,4)
        defaultValue: ""
        description: REBATE TIER
        name: REBATE_TIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 29de6be9-b11f-4a74-a2e5-f7cf0cd3b8af
                stepCounter: a4258389-f06f-42d3-87e5-4f8e65247ca3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0e57498-ee4b-48c6-96d6-d69046a80b55
          stepCounter: 86964991-98e1-490f-9262-93daef22e0ae
        config: {}
        dataType: NUMBER(38,4)
        defaultValue: ""
        description: REBATE DUE
        name: REBATE_DUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 30fec876-41b5-4bc4-aee0-af45bdb640a6
                stepCounter: a4258389-f06f-42d3-87e5-4f8e65247ca3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b3027aa0-7d69-42a3-9a5d-1782293f62c9
          stepCounter: 86964991-98e1-490f-9262-93daef22e0ae
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: PAYOUT YEAR
        name: PAYOUT_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79c7fa30-ce28-4ace-b579-8e719626bafa
                stepCounter: a4258389-f06f-42d3-87e5-4f8e65247ca3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d695dabd-e42d-47d9-97e0-5ca93e509779
          stepCounter: 86964991-98e1-490f-9262-93daef22e0ae
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: PAYOUT PERIOD
        name: PAYOUT_PERIOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4f91adc6-c23a-4c86-a62f-5249fabe8826
                stepCounter: a4258389-f06f-42d3-87e5-4f8e65247ca3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8bd97e2f-d7e5-4a67-84c0-f709870f072d
          stepCounter: 86964991-98e1-490f-9262-93daef22e0ae
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: IS POSTPONE
        name: IS_POSTPONE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e4c6609-1cb4-4cd2-85d4-48660bb3ae30
                stepCounter: a4258389-f06f-42d3-87e5-4f8e65247ca3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9b7d8d3-08a9-4553-a301-b741c820c70b
          stepCounter: 86964991-98e1-490f-9262-93daef22e0ae
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: IS ARCHIVED
        name: IS_ARCHIVED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8123f896-33ea-4e85-a78c-8d60df43406e
                stepCounter: a4258389-f06f-42d3-87e5-4f8e65247ca3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 313406f3-4459-4ef9-bc97-3a562f792220
          stepCounter: 86964991-98e1-490f-9262-93daef22e0ae
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e3cba0c0-e7b9-4072-aeb0-cb0951ddc838
                stepCounter: a4258389-f06f-42d3-87e5-4f8e65247ca3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7fcce3e1-9d21-4b60-896c-bdbd4e37937b
          stepCounter: 86964991-98e1-490f-9262-93daef22e0ae
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DSS LOAD DATE
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d8eaa21-f648-4d7d-a714-4baca468eb1b
                stepCounter: a4258389-f06f-42d3-87e5-4f8e65247ca3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd1945f8-a27f-4771-89e9-38cfaa8c79d9
          stepCounter: 86964991-98e1-490f-9262-93daef22e0ae
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 84f4d5a9-fc11-4b3f-85e2-5743c2539ddb
          stepCounter: 86964991-98e1-490f-9262-93daef22e0ae
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGEFORCEREBATEDUE_1: a4258389-f06f-42d3-87e5-4f8e65247ca3
          CONTRACT: 930a330f-3276-4f21-bd05-9ed55fd63528
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: DIM
            nodeName: CONTRACT
          - locationName: DIM
            nodeName: FORCEREBATEDUEDETAIL
          - locationName: DIM
            nodeName: SUPPLIER
          - locationName: STAGE
            nodeName: STAGEFORCEREBATEDUE_1
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','STAGEFORCEREBATEDUE_1') }} STAGEFORCEREBATEDUE_1
              LEFT JOIN {{ ref('DIM','CONTRACT') }} CONTRACT
                ON STAGEFORCEREBATEDUE_1.CONTRACTID = CONTRACT.CONTRACTID
        name: STAGEFORCEREBATEDUE_ADDKEYS
        noLinkRefs: []
  name: STAGEFORCEREBATEDUE_ADDKEYS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
