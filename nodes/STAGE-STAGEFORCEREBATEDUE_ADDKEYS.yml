fileVersion: 1
id: 44cb2ac8-fa55-4218-8ee5-501608427054
name: STAGEFORCEREBATEDUE_ADDKEYS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a351eb8-20cb-4eba-8d22-067fb3dd7bfb
          stepCounter: 44cb2ac8-fa55-4218-8ee5-501608427054
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEFORCEREBATEDUE_ADDKEYS.FORCEREBATEDUEID=FORCEREBATEDUEDETAIL.FORCEREBATEDUEID
        name: FORCEREBATEDUEDETAILKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de7a8bc7-043e-4767-a126-e0af2e0ceeab
                stepCounter: e10ed9b1-3071-4682-a20d-4bac5fb19cb8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b6ba62f3-88cb-41bb-ad2a-0ae2d481f708
          stepCounter: 44cb2ac8-fa55-4218-8ee5-501608427054
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: AUTOGENERATED ID
        isBusinessKey: true
        name: FORCEREBATEDUEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18dd7e66-60ad-4496-a76a-b76480e9acac
                stepCounter: 9dba85bb-d4b9-465c-9906-d52cf95ebf9a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a8f6f45-6278-42d8-bbed-f0d10e09d55b
          stepCounter: 44cb2ac8-fa55-4218-8ee5-501608427054
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: SUPPLIER ID
        name: SUPPLIERID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c26887f8-e625-435e-ab64-1e89291e93a9
                stepCounter: 9dba85bb-d4b9-465c-9906-d52cf95ebf9a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e54f807-b290-4174-9ea2-9dbd20063323
          stepCounter: 44cb2ac8-fa55-4218-8ee5-501608427054
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEFORCEREBATEDUE_ADDKEYS.SUPPLIERID=SUPPLIER.SUPPLIERID
        name: SUPPLIERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0dbe6791-e486-4323-9105-61ec34f45e59
                stepCounter: 8d733483-4c1e-4c52-8f3e-9f99b8022f6d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96b0d7e7-a573-46c3-99d7-140b48680bec
          stepCounter: 44cb2ac8-fa55-4218-8ee5-501608427054
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: CONTRACT ID
        name: CONTRACTID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dd4be1e4-617c-4305-91f4-a6a100f57560
                stepCounter: 9dba85bb-d4b9-465c-9906-d52cf95ebf9a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b98e2551-4783-400d-ba69-0c775898bb57
          stepCounter: 44cb2ac8-fa55-4218-8ee5-501608427054
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEFORCEREBATEDUE_ADDKEYS.CONTRACTSALESFORCEID=CONTRACT.CONTRACTSALESFORCEID
        name: CONTRACTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52c7aa26-2ad9-4bd6-9ffc-9fc8c0ecb6dc
                stepCounter: ab16115a-f5c7-4d24-bca6-41c596634f50
            transform: COALESCE(CONTRACT.CONTRACTKEY,0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a851174b-62f2-4c63-bc75-525f894ade19
          stepCounter: 44cb2ac8-fa55-4218-8ee5-501608427054
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: FORCE ID
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 647bb124-4b85-4d68-912a-fc889067a9c9
                stepCounter: 9dba85bb-d4b9-465c-9906-d52cf95ebf9a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb46914d-db30-45ce-9b12-8bd2b59012b5
          stepCounter: 44cb2ac8-fa55-4218-8ee5-501608427054
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEFORCEREBATEDUE_ADDKEYS.FORCEID=ACCOUNT.FORCEID
        name: ACCOUNTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bae9c318-63c2-4058-8e74-f5509f5b4522
                stepCounter: d5234d5a-eb19-45e2-9c42-47221579f347
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2afcb996-d2cb-45f9-8f70-7ab7cb503329
          stepCounter: 44cb2ac8-fa55-4218-8ee5-501608427054
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: CHECK ID
        name: CHECK_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e219d7a-88fd-434c-a169-08b7a326691c
                stepCounter: 9dba85bb-d4b9-465c-9906-d52cf95ebf9a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01e400bd-bb96-448b-a601-322e452e9879
          stepCounter: 44cb2ac8-fa55-4218-8ee5-501608427054
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: MEMBER CODE
        name: MEMBER_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1569d066-b88e-45f1-af41-99b57c7b0acf
                stepCounter: 9dba85bb-d4b9-465c-9906-d52cf95ebf9a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8a081e8-f673-4570-b5c4-c9a6b5028a4e
          stepCounter: 44cb2ac8-fa55-4218-8ee5-501608427054
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: CYCLE START DATE
        name: CYCLE_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ecdacbe-078f-4729-a910-bd4aa0210167
                stepCounter: 9dba85bb-d4b9-465c-9906-d52cf95ebf9a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ecbb584-d36a-46de-8207-f8a90c6d9487
          stepCounter: 44cb2ac8-fa55-4218-8ee5-501608427054
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: CYCLE END DATE
        name: CYCLE_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9ac2ec99-3811-4f03-8af5-95c92dcca542
                stepCounter: 9dba85bb-d4b9-465c-9906-d52cf95ebf9a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3be4601e-294c-41f4-be94-baed77b67757
          stepCounter: 44cb2ac8-fa55-4218-8ee5-501608427054
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: CYCLE
        name: CYCLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 04f2d86a-d9e1-4187-89eb-cf110b52f8df
                stepCounter: 9dba85bb-d4b9-465c-9906-d52cf95ebf9a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1bb3c6fe-7039-41f9-899c-9e25925fe301
          stepCounter: 44cb2ac8-fa55-4218-8ee5-501608427054
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: TOTAL SALES
        name: TOTAL_SALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1c43e9c-bd40-4af4-94b4-662ad23c4797
                stepCounter: 9dba85bb-d4b9-465c-9906-d52cf95ebf9a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 687b87cf-0032-45b1-8170-7895eb382d2a
          stepCounter: 44cb2ac8-fa55-4218-8ee5-501608427054
        config: {}
        dataType: NUMBER(18,4)
        defaultValue: ""
        description: BASELINE ALLOCATION
        name: BASELINE_ALLOCATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59025848-00e4-4545-962a-272697570723
                stepCounter: 9dba85bb-d4b9-465c-9906-d52cf95ebf9a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59799661-e1e3-4e7a-a370-4747c5e428f1
          stepCounter: 44cb2ac8-fa55-4218-8ee5-501608427054
        config: {}
        dataType: NUMBER(18,4)
        defaultValue: ""
        description: ELIGIBLE SPEND
        name: ELIGIBLE_SPEND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8dccd556-6d2b-4422-8dad-c18655dae6a4
                stepCounter: 9dba85bb-d4b9-465c-9906-d52cf95ebf9a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1001b2c7-cbd3-48e9-af60-7da026c46715
          stepCounter: 44cb2ac8-fa55-4218-8ee5-501608427054
        config: {}
        dataType: NUMBER(18,4)
        defaultValue: ""
        description: REBATE TIER
        name: REBATE_TIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de10e1f7-2d94-4897-8591-b5f82af1ad5b
                stepCounter: 9dba85bb-d4b9-465c-9906-d52cf95ebf9a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06ab6bf6-cc12-42a4-a08a-df55314f6092
          stepCounter: 44cb2ac8-fa55-4218-8ee5-501608427054
        config: {}
        dataType: NUMBER(38,4)
        defaultValue: ""
        description: REBATE DUE
        name: REBATE_DUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48f736fa-e638-4930-9d35-6573f31b3e20
                stepCounter: 9dba85bb-d4b9-465c-9906-d52cf95ebf9a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: acf49130-8a29-4f70-8d69-43fd0831f883
          stepCounter: 44cb2ac8-fa55-4218-8ee5-501608427054
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: PAYOUT YEAR
        name: PAYOUT_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7340f017-d4a8-4d90-97a1-b98a7142b2c7
                stepCounter: 9dba85bb-d4b9-465c-9906-d52cf95ebf9a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54e3eb95-f6bf-40d9-8f8c-26825f9a4525
          stepCounter: 44cb2ac8-fa55-4218-8ee5-501608427054
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: PAYOUT PERIOD
        name: PAYOUT_PERIOD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ba43af1-3896-455d-a3fe-bf3a8f330ec8
                stepCounter: 9dba85bb-d4b9-465c-9906-d52cf95ebf9a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32a7953b-ba50-496e-abc4-d784e4bba53d
          stepCounter: 44cb2ac8-fa55-4218-8ee5-501608427054
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: IS POSTPONE
        name: IS_POSTPONE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f367fb92-c9e2-4710-b18f-eee66f4dc07d
                stepCounter: 9dba85bb-d4b9-465c-9906-d52cf95ebf9a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d36a003-b02f-4e6c-b194-02453550503c
          stepCounter: 44cb2ac8-fa55-4218-8ee5-501608427054
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: IS ARCHIVED
        name: IS_ARCHIVED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e84fd5c8-7b41-46fd-bde5-fe6b125c996b
                stepCounter: 9dba85bb-d4b9-465c-9906-d52cf95ebf9a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ce18702-45d1-49d6-a168-c52c4f3528f9
          stepCounter: 44cb2ac8-fa55-4218-8ee5-501608427054
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: RECORD SOURCE
        name: DSS_RECORD_SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a464adcd-f555-4b63-9e2e-d116bd7e8ed7
                stepCounter: 9dba85bb-d4b9-465c-9906-d52cf95ebf9a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6eaaeb22-2861-4b0f-a42c-a26b17aa0ee7
          stepCounter: 44cb2ac8-fa55-4218-8ee5-501608427054
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DSS LOAD DATE
        name: DSS_LOAD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2f032dd9-4da5-4955-a26c-92ea0639843d
                stepCounter: 9dba85bb-d4b9-465c-9906-d52cf95ebf9a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74a6210d-5893-468d-ac95-9e8626edaadf
          stepCounter: 44cb2ac8-fa55-4218-8ee5-501608427054
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 786fdb58-3546-4e76-8e9b-9ce111f24f4f
          stepCounter: 44cb2ac8-fa55-4218-8ee5-501608427054
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STAGEFORCEREBATEDUE_1: 9dba85bb-d4b9-465c-9906-d52cf95ebf9a
          CONTRACT: ab16115a-f5c7-4d24-bca6-41c596634f50
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DIM
            nodeName: ACCOUNT
          - locationName: DIM
            nodeName: CONTRACT
          - locationName: DIM
            nodeName: FORCEREBATEDUEDETAIL
          - locationName: DIM
            nodeName: SUPPLIER
          - locationName: STAGE
            nodeName: STAGEFORCEREBATEDUE_1
        join:
          joinCondition: |-
            FROM {{ ref('STAGE','STAGEFORCEREBATEDUE_1') }} STAGEFORCEREBATEDUE_1
              LEFT JOIN {{ ref('DIM','CONTRACT') }} CONTRACT
                ON STAGEFORCEREBATEDUE_1.CONTRACTID = CONTRACT.CONTRACTID
        name: STAGEFORCEREBATEDUE_ADDKEYS
        noLinkRefs: []
  name: STAGEFORCEREBATEDUE_ADDKEYS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
