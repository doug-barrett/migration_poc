fileVersion: 1
id: 5dbad74b-4e9d-4a96-a197-e394c76335d3
name: S_PIMS_CLINICIAN_SPECIALTY_MAP
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50edd0be-f265-48ae-a763-d376bc75a4d0
          stepCounter: 5dbad74b-4e9d-4a96-a197-e394c76335d3
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a28ba196-8de0-4e5b-85a3-3fe942b819a0
                stepCounter: f3002d4e-c1be-4f89-ae8c-0e21648c2107
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dd81081a-b1d0-46b5-9ce8-7b3d8e706aec
          stepCounter: 5dbad74b-4e9d-4a96-a197-e394c76335d3
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9ab68460-3663-4150-ad72-5ef9a562b8e3
                stepCounter: f3002d4e-c1be-4f89-ae8c-0e21648c2107
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0336387f-65af-4509-9315-52f807169f19
          stepCounter: 5dbad74b-4e9d-4a96-a197-e394c76335d3
        config: {}
        dataType: DECIMAL(10)
        defaultValue: ""
        description: ""
        name: CSTYP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6dcf134b-6902-4612-8f95-91850c2ff2fe
                stepCounter: f3002d4e-c1be-4f89-ae8c-0e21648c2107
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0deb2aaa-057c-459c-994e-2f15202c1735
          stepCounter: 5dbad74b-4e9d-4a96-a197-e394c76335d3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: START_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d353b5b4-e98c-4150-a986-96b918216334
                stepCounter: f3002d4e-c1be-4f89-ae8c-0e21648c2107
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1fbe477-b74d-4f8f-b345-792a9e32f2e4
          stepCounter: 5dbad74b-4e9d-4a96-a197-e394c76335d3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: END_DTTM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d53d695-0bbb-4105-924c-04f53369af5c
                stepCounter: f3002d4e-c1be-4f89-ae8c-0e21648c2107
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 90e778de-82e3-4437-adee-5d1d3ffacbf6
          stepCounter: 5dbad74b-4e9d-4a96-a197-e394c76335d3
        config: {}
        dataType: VARCHAR(25)
        defaultValue: ""
        description: ""
        name: MAIN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fbb01e3b-4612-47c8-9a4a-5d6abddc60ef
                stepCounter: 06fa4241-360c-43d0-8e4a-8b860f92fc09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5d8b1a5-1113-4f1a-ac8a-74cea1d68802
          stepCounter: 5dbad74b-4e9d-4a96-a197-e394c76335d3
        config: {}
        dataType: VARCHAR(80)
        defaultValue: ""
        description: ""
        name: DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 551f483d-a948-4558-87f8-d3e65fffac3c
                stepCounter: 06fa4241-360c-43d0-8e4a-8b860f92fc09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03a0bd30-ce45-4aaa-91a6-0e96e244d7f7
          stepCounter: 5dbad74b-4e9d-4a96-a197-e394c76335d3
        config: {}
        dataType: DECIMAL(3)
        defaultValue: ""
        description: ""
        name: SORT_ORDER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f88be18b-8d47-4cb9-b4a4-50c78872a5c0
                stepCounter: 06fa4241-360c-43d0-8e4a-8b860f92fc09
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b51b71b-b5da-4347-b218-f9e87dd591d6
          stepCounter: 5dbad74b-4e9d-4a96-a197-e394c76335d3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_pims_clinician_specialty_map.proca_refno=dim_healthcare_professional.healthcare_professional_reference_no
        name: DIM_HEALTHCARE_PROFESSIONAL_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b3b22451-95b4-47f3-b7c1-48136447e09b
                stepCounter: 2b7fcd6a-6a5f-4454-9d5e-f87e946f60fa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a53fb3de-ab58-4f6d-817f-aab6e87f536f
          stepCounter: 5dbad74b-4e9d-4a96-a197-e394c76335d3
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Healthcare_Professional_Code
        name: HEALTHCARE_PROFESSIONAL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e393c87d-2bfd-47b3-a557-82745248467a
                stepCounter: 2b7fcd6a-6a5f-4454-9d5e-f87e946f60fa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2257fc4-e578-4be3-8b1a-d295b0e362fc
          stepCounter: 5dbad74b-4e9d-4a96-a197-e394c76335d3
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: s_pims_clinician_specialty_map.spect_refno=dim_specialty.specialty_reference_no
        name: DIM_SPECIALTY_KEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79aee918-ff6f-4b0a-a656-000827899f3e
                stepCounter: 4182a75e-d07b-4637-97fa-4c01e2878360
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70541a03-53a5-4beb-b9c7-434ec7295a16
          stepCounter: 5dbad74b-4e9d-4a96-a197-e394c76335d3
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Specialty Code
        name: SPECIALTY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: acf7c8b3-5813-4be7-a8ca-91b0073451b4
                stepCounter: 4182a75e-d07b-4637-97fa-4c01e2878360
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: adc622bb-a2a3-414d-84d7-154e930c0163
          stepCounter: 5dbad74b-4e9d-4a96-a197-e394c76335d3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_PIMS_PROF_CARER_SPECIALTIES
        join:
          joinCondition: |-
            FROM ds_pims_prof_carer_specialties
              JOIN ds_pims_reference_values
                ON ds_pims_prof_carer_specialties.cstyp_refno = ds_pims_reference_values.rfval_refno
             WHERE ds_pims_prof_carer_specialties.proca_refno NOT IN (1000005350, 1000009226) --Awaiting Allocation and NSP  AND   ds_pims_prof_carer_specialties.proca_refno IN   (SELECT proca_refno     FROM ds_pims_prof_carer_specialties    WHERE modif_dttm >= CONVERT(datetime, @v_pa_inpatient_incremental))  AND dim_healthcare_professional.dim_healthcare_professional_key > 0  AND dim_specialty.dim_specialty_key > 0
        name: S_PIMS_CLINICIAN_SPECIALTY_MAP
        noLinkRefs: []
  name: S_PIMS_CLINICIAN_SPECIALTY_MAP
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
