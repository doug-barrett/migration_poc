fileVersion: 1
id: 918bc0cc-cc27-47a0-86b6-afa5179bf6d3
name: S_LMC_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2280dc50-49e3-43c5-b76d-44847e2ae9cd
          stepCounter: 918bc0cc-cc27-47a0-86b6-afa5179bf6d3
        config: {}
        dataType: VARCHAR(256)
        defaultValue: ""
        description: Full Name
        name: NAME
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: IFNULL(l_hware_pers.GivenNames, '') + ' ' + IFNULL(l_hware_pers.FamilyName, '')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 90d9ef53-f24e-4cc8-b169-651e3c264159
          stepCounter: 918bc0cc-cc27-47a0-86b6-afa5179bf6d3
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: ""
        name: PERSTYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94bf04eb-a468-480b-9ef6-dced9940809d
                stepCounter: 5b5377bd-97bf-4cde-8f2e-a5fd4be1c23e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: efb7713f-d54a-4575-b58a-6c8ca6a9794c
          stepCounter: 918bc0cc-cc27-47a0-86b6-afa5179bf6d3
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: ""
        name: PERSLVL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a8d1ec9f-268e-4691-b7a6-25240ba96b04
                stepCounter: 5b5377bd-97bf-4cde-8f2e-a5fd4be1c23e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9c4995f-21de-4cbc-b31e-392080a85ea0
          stepCounter: 918bc0cc-cc27-47a0-86b6-afa5179bf6d3
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: ""
        name: ONSTAFF
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd12e154-8f59-47cc-9c06-86418f25a9af
                stepCounter: 5b5377bd-97bf-4cde-8f2e-a5fd4be1c23e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d0199d31-dea4-40d4-864f-ccef3603347d
          stepCounter: 918bc0cc-cc27-47a0-86b6-afa5179bf6d3
        config: {}
        dataType: VARCHAR(4)
        defaultValue: ""
        description: ""
        name: TEAM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4f153ae-ce1b-4fd2-8a85-8b6bff7cbbbf
                stepCounter: 5b5377bd-97bf-4cde-8f2e-a5fd4be1c23e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 83557f3d-3fad-44cd-b2f3-5e78f984d92c
          stepCounter: 918bc0cc-cc27-47a0-86b6-afa5179bf6d3
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: SID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb2f8d1b-0b12-41ce-b53e-f259c18612ec
                stepCounter: b42a6e6f-231d-4337-b13f-a35a047aaa25
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81bb85e2-6639-413f-b839-99812a8d9ff3
          stepCounter: 918bc0cc-cc27-47a0-86b6-afa5179bf6d3
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: ""
        isBusinessKey: true
        name: EPI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c1363c7e-2876-4ffe-ade8-b8d1f8eef483
                stepCounter: b42a6e6f-231d-4337-b13f-a35a047aaa25
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5e026cb-eb45-46e2-8421-d9523c173d32
          stepCounter: 918bc0cc-cc27-47a0-86b6-afa5179bf6d3
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: ""
        name: LMC_TYPE
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE l_hware_pers.perstype
                          WHEN 10               THEN 'Nurse'
                          WHEN 26               THEN 'Midwife'
                          WHEN 28               THEN 'Doctor'
                          WHEN 29               THEN 'GP'
                          WHEN 32               THEN 'Anaesthetist'
                          WHEN 33               THEN 'Obstetrician'
                          WHEN 34               THEN 'Paediatrician'
                          WHEN 35               THEN 'Radiologist'
                          WHEN 80               THEN 'Student'
                          WHEN 90               THEN 'Admin'
                          WHEN 92               THEN 'Technical Support'
                          WHEN 98               THEN 'Other'
                          ELSE 'Unknown'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5a4a40b-0fd8-418b-9f26-524c3657a0b7
          stepCounter: 918bc0cc-cc27-47a0-86b6-afa5179bf6d3
        config: {}
        dataType: VARCHAR(64)
        defaultValue: ""
        description: ""
        name: LMC_ROLE
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: |-
              CASE WHEN l_hware_pers.perslvl = 20 AND l_hware_pers.perstype = 26 THEN 'Charge Midwife'
                          WHEN l_hware_pers.perslvl = 21 AND l_hware_pers.perstype = 26 THEN 'Core Midwife'
                          WHEN l_hware_pers.perslvl = 22 AND l_hware_pers.perstype = 26 THEN 'CMT'
                          WHEN l_hware_pers.perslvl = 30 AND l_hware_pers.perstype = 26 THEN 'KYM'
                          WHEN l_hware_pers.perstype = 29                               THEN 'GP'
                          WHEN l_hware_pers.perstype = 33                               THEN 'Obstetrician'
                          ELSE 'Unknown'
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 05c25d6c-4e86-430b-9b6b-16cbb8a36733
          stepCounter: 918bc0cc-cc27-47a0-86b6-afa5179bf6d3
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: ROW
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: Row_number() OVER (PARTITION BY l_hware_LMC.sid, l_hware_LMC.epi ORDER BY l_hware_LMC.starttime DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18861f9c-427c-4e7d-b4b5-2ae9bf69a79d
          stepCounter: 918bc0cc-cc27-47a0-86b6-afa5179bf6d3
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          L_HWARE_LMC: b42a6e6f-231d-4337-b13f-a35a047aaa25
          L_HWARE_PERS: 5b5377bd-97bf-4cde-8f2e-a5fd4be1c23e
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: L_HWARE_LMC
          - locationName: TGT
            nodeName: L_HWARE_PERS
        join:
          joinCondition: |-
            FROM {{ ref('TGT','L_HWARE_LMC') }}
              JOIN {{ ref('TGT','L_HWARE_PERS') }}
                ON l_hware_LMC.LMC_name_s88 = l_hware_pers.SID
             WHERE l_hware_LMC.endtime IS NULL
        name: S_LMC_10
        noLinkRefs: []
  name: S_LMC_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
