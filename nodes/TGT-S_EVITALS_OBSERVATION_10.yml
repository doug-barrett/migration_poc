fileVersion: 1
id: c9024fde-6643-41d1-b4f4-d6d0019d9c5c
name: S_EVITALS_OBSERVATION_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Get details of all measures taken for each patient. One patient can have the same measure taken many times."
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec52db4e-c8ac-4d29-a295-385efb859009
          stepCounter: c9024fde-6643-41d1-b4f4-d6d0019d9c5c
        config: {}
        dataType: BIGINT
        defaultValue: ""
        description: ""
        name: ADMISSION_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3f68edb3-1e8d-48b7-8850-2400c40ab4f7
                stepCounter: 6866bc35-1164-43e9-9ff9-15b44d426855
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ed78f2d-513e-4d00-a41f-a44a8b25b5ee
          stepCounter: c9024fde-6643-41d1-b4f4-d6d0019d9c5c
        config: {}
        dataType: INT
        defaultValue: ""
        description: Integer ID that uniquely identifies an observation set in Patientrack. Sourced from obset_pk.
        name: OBSERVATION_SET_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e6b716d0-5197-4ac0-92af-0fb734c834ac
                stepCounter: 2988e8b8-1ea5-46f9-8504-e1b140f344fa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a4e309c3-78b9-454a-815b-d06a5442af72
          stepCounter: c9024fde-6643-41d1-b4f4-d6d0019d9c5c
        config: {}
        dataType: INT
        defaultValue: ""
        description: Integer ID that uniquely identifies a measure set in Patientrack. Sourced from msset_pk.
        name: MEASURE_SET_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ccfe588b-6c5c-4319-993e-cb435fbd4aad
                stepCounter: 287900af-c539-446d-903e-bf6181d741ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 535acfc6-3bb4-40b4-8ad4-69696b589400
          stepCounter: c9024fde-6643-41d1-b4f4-d6d0019d9c5c
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Set to 1 if the measure contributes towards the overall EWS for the set.
        name: EWS_CONTRIBUTOR_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ff204346-482b-4cc6-ad20-4521b19ad9d9
                stepCounter: 287900af-c539-446d-903e-bf6181d741ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9e7f952-a3ef-46c7-9d83-42f1af5370cf
          stepCounter: c9024fde-6643-41d1-b4f4-d6d0019d9c5c
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: The order in which measures within a set are listed.
        name: MEASURE_DISPLAY_ORDER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: efc0f30b-01a9-4157-89e2-5962b1a1a867
                stepCounter: 287900af-c539-446d-903e-bf6181d741ff
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6e082d3-a02d-45d9-b519-84a49b485369
          stepCounter: c9024fde-6643-41d1-b4f4-d6d0019d9c5c
        config: {}
        dataType: INT
        defaultValue: ""
        description: Integer ID that uniquely identifies a measure in Patientrack. Sourced from obmsr_pk.
        name: MEASURE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51a90dbe-9bcc-4175-a7c0-96ccd7787354
                stepCounter: 16479f0f-61d2-462f-b562-cf3d2250cd14
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3598db1c-f486-4405-ac57-1b6aaa369e01
          stepCounter: c9024fde-6643-41d1-b4f4-d6d0019d9c5c
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: Alphanumeric code that uniquely identifies a measure e.g. RESPR, MTEMP, O2SAT.
        name: MEASURE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 86e05a17-d9e0-483e-b660-0ae08f1a145c
                stepCounter: 16479f0f-61d2-462f-b562-cf3d2250cd14
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25efea4a-f43f-4341-9874-f9838ab08afb
          stepCounter: c9024fde-6643-41d1-b4f4-d6d0019d9c5c
        config: {}
        dataType: INT
        defaultValue: ""
        description: Integer ID that uniquely identifies an observation in Patientrack. Sourced from osdet_pk.
        name: OBSERVATION_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cf756a27-fb72-4c38-a566-1e204f9121a0
                stepCounter: 44de0712-ae1a-455f-a544-203ba41ec44f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 588a19a0-6f6c-41ec-82d8-7f74ef154349
          stepCounter: c9024fde-6643-41d1-b4f4-d6d0019d9c5c
        config: {}
        dataType: INT
        defaultValue: ""
        description: Measure result if it is recorded as an integer.
        name: RESULT_INTEGER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2a873d24-f5da-4273-bf2f-1df05344b31e
                stepCounter: 44de0712-ae1a-455f-a544-203ba41ec44f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29c355f7-af95-426c-bc08-ce26c784ee76
          stepCounter: c9024fde-6643-41d1-b4f4-d6d0019d9c5c
        config: {}
        dataType: NUMERIC(8,2)
        defaultValue: ""
        description: Measure result if it is recorded as an decimal.
        name: RESULT_DECIMAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2fa140c4-d031-4072-ad6b-ffadc6f8fdd9
                stepCounter: 44de0712-ae1a-455f-a544-203ba41ec44f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81eedac3-8ec7-44ad-aca4-da60e6606a7c
          stepCounter: c9024fde-6643-41d1-b4f4-d6d0019d9c5c
        config: {}
        dataType: INT
        defaultValue: ""
        description: PK value for REFERENCE_VALUE that holds a description of the measure result.
        name: RESULT_LIST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 140bf51b-6f9d-4e45-ab7d-2d2926241524
                stepCounter: 44de0712-ae1a-455f-a544-203ba41ec44f
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c06d856-2455-4dd0-ba4e-4a3894bcbc9b
          stepCounter: c9024fde-6643-41d1-b4f4-d6d0019d9c5c
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: Measure result if it is recorded as text.
        name: RESULT_CHAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1e6af49-d8c4-43cb-abf0-32e02215f095
                stepCounter: f6f252ab-0278-492b-8f5a-bc508fa6a440
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 13f2b0c8-e99b-41ef-b135-3e94c7d41370
          stepCounter: c9024fde-6643-41d1-b4f4-d6d0019d9c5c
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Early Warning Score for the observation.
        name: EWS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19fc8b69-6ffa-4fad-9d25-0a65db2f2bd0
                stepCounter: 4c06bd12-ba4c-4850-9efd-605b4d751466
            transform: IFNULL(ds_Patientrack_OBSERVATION_SET_RISK_INDEX.RISK_INDEX, 0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8dcd1dc-89d0-4b58-ac53-1307040ada8b
          stepCounter: c9024fde-6643-41d1-b4f4-d6d0019d9c5c
        config: {}
        dataType: TINYINT
        defaultValue: ""
        description: Set to 1 if the EWS for the observation is greater than the value of parameter eVitals_EWS_alert.
        name: EWS_ALERT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19fc8b69-6ffa-4fad-9d25-0a65db2f2bd0
                stepCounter: 4c06bd12-ba4c-4850-9efd-605b4d751466
            transform: |-
              CASE WHEN ds_Patientrack_OBSERVATION_SET_RISK_INDEX.RISK_INDEX > @v_eVitals_EWS_alert THEN 1
                          ELSE 0
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9dba058f-6b02-4e0d-99c9-c9952b3e1ef4
          stepCounter: c9024fde-6643-41d1-b4f4-d6d0019d9c5c
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: S_EVITALS_ADMISSION_CHANGES
        join:
          joinCondition: |-
            FROM s_eVitals_admission_changes
              JOIN ds_Patientrack_OBSERVATION_SET
                ON s_eVitals_admission_changes.admission_id = ds_Patientrack_OBSERVATION_SET.epsde_pk
              JOIN ds_Patientrack_OBSERVATION_SET_DETAIL
                ON ds_Patientrack_OBSERVATION_SET.OBSET_PK = ds_Patientrack_OBSERVATION_SET_DETAIL.OBSET_PK
              JOIN l_Patientrack_MEASURE_SET_ITEM
                ON ds_Patientrack_OBSERVATION_SET_DETAIL.MSITM_PK = l_Patientrack_MEASURE_SET_ITEM.MSITM_PK
              JOIN l_Patientrack_OBSERVATION_MEASURE
                ON l_Patientrack_MEASURE_SET_ITEM.OBMSR_PK = l_Patientrack_OBSERVATION_MEASURE.OBMSR_PK
              LEFT OUTER JOIN ds_Patientrack_OBSERVATION_SET_RISK_INDEX
                ON ds_Patientrack_OBSERVATION_SET_DETAIL.OSDET_PK = ds_Patientrack_OBSERVATION_SET_RISK_INDEX.OSDET_PK
              LEFT OUTER JOIN l_Patientrack_REFERENCE_VALUE
                ON ds_Patientrack_OBSERVATION_SET_DETAIL.MEASURE_LIST = l_Patientrack_REFERENCE_VALUE.RFVAL_PK
             WHERE ds_Patientrack_OBSERVATION_SET.current_obset_flag = 1
        name: S_EVITALS_OBSERVATION_10
        noLinkRefs: []
  name: S_EVITALS_OBSERVATION_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
