fileVersion: 1
id: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
name: S_IN_PATIENT_STAY_05_OLD
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: "Initial Stage Table for common use of In-Patient Attendance Stay data"
  isMultisource: false
  locationName: TGT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4fead636-5fa0-4de7-b3ad-c48c9aa8140b
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59d3088d-97f2-4c53-9ebc-ae021c7b49e2
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: "'H'+CONVERT(varchar,ds_pims_provider_spells.prvsp_refno)"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f8785390-36b7-4120-b0a7-754a75a5235f
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: VARCHAR(10)
        defaultValue: ""
        description: ""
        name: EVENT_ENCOUNTER_TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'H'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf3b29a7-30e8-4230-982c-1085c1132e74
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRVSP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59d3088d-97f2-4c53-9ebc-ae021c7b49e2
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 757eee7c-de75-4672-a5f0-78bff2b2e88b
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11ba3682-5d1a-4a53-bfaf-b4b646e6c99f
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ddf44df5-3c76-4944-bc16-da867059c954
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADMET_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b9fc1ad-a8cc-4c29-bd6b-b55c9007f7ce
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0cf3c08-c274-4cfe-9b24-fb0e51f76b68
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADSOR_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d682efad-8fd7-4911-beb0-f3a99784edd4
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9375fe33-ced9-4654-bdcd-532869d61e07
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: READM_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c018533-12b7-4065-b16b-5f92a9fb86f2
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 52e10f63-7746-4eca-a848-32275e9e53b9
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a06254d-d86c-4cf5-ab17-b37af0d69b0a
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e470ec54-8345-4131-8315-7b5359173fcb
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DISDE_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3f097725-1edd-4539-b340-14de489b6fa2
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ccce812-fc54-4747-ad11-884ba83dc008
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADCAT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4414ecc-4c91-49ec-a055-6affc8dbde9a
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b5ae7f6-a4fc-4fd1-a2eb-215df615d618
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DISMT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a2db989-19c9-48be-ab15-47452de5e290
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac93b25a-bf4d-40b2-ad22-496907c13d6b
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_PATNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f7b850f-ce72-4e87-b4f3-6e2838f4dd0a
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c5260a0-f2ab-4496-89d9-8e07318e90ce
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: 'The NHI is a unique 7-character identification number assigned to a healthcare user by the National Health Index (NHI) database.   There is a verification algorithm which ensures that the NHI number is in the correct format and is valid.     Also known as National Health Index, HCU identifier, NHI, HCU, HCU Number, Healthcare User identifier,   HCU identification number, NMPI number, Hospital Number, Patient Number.     '
        name: PATIENT_NHI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 985f0ba0-97cf-4152-a49b-7e86cb71409e
                stepCounter: d52dd438-7899-4242-9e38-539d2a1447df
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9fee89e2-cd89-41b3-b2c8-ae8ab18141a8
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SPELL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 393b69e1-de21-4623-b7d7-6f2de29ab3bd
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2517e982-e3a7-4a22-95b8-a513a355f16f
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: DISCH_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 86ed21a6-3045-4fea-965e-c903428d0444
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27eb61d3-99c5-4caa-86d6-970a1cf0055c
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMIT_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1125cf7f-7027-45ac-acc8-b3a92505c4da
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: |-
              CASE WHEN ds_pims_provider_spells.admit_dttm IS NULL OR ds_pims_provider_spells.admit_dttm <= '1990-01-01' OR ds_pims_provider_spells.admit_dttm > GETDATE() THEN IFNULL(ds_pims_provider_spells.disch_dttm,CONVERT(date,GETDATE()))
                          ELSE ds_pims_provider_spells.admit_dttm
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb7d04f7-b850-4cb2-abd9-ed9460a609b2
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ADMIT_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1125cf7f-7027-45ac-acc8-b3a92505c4da
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f9abe08-84f6-4e99-ad69-008bb837f382
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCH_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee3a67e8-1a53-44ab-aa64-cafc588de09c
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: |-
              CASE WHEN ds_pims_provider_spells.disch_dttm IS NULL OR ds_pims_provider_spells.disch_dttm <= '1990-01-01' OR ds_pims_provider_spells.disch_dttm > GETDATE() OR ds_pims_provider_spells.disch_dttm < ds_pims_provider_spells.admit_dttm THEN NULL
                          ELSE ds_pims_provider_spells.disch_dttm
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5dd478b7-2fae-4d38-ae45-c4c01c4f4bc0
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DISCH_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee3a67e8-1a53-44ab-aa64-cafc588de09c
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 538393c9-31aa-4e3b-b3d2-c65cbfabca27
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REFRL_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 80e5eecf-b3fb-4fc8-b661-b39389f47738
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: IFNULL(ds_pims_provider_spells.refrl_refno,s_pims_prof_carer_episodes.refrl_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d68ccc8-2747-4829-9ac7-0126e510cf4c
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: AEATT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3d60c752-dcc2-482d-b5d3-e8c11f77a74f
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98a74725-ec4f-44cd-bb99-c0cbfbeffc00
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: FIRST_REGULAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0b9caf7d-206b-4215-923e-0a8fcf1d38fd
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15981602-d878-4eda-96f5-af6e66d76b50
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: INMGT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76ce2d66-f620-4545-bd3f-71d1e5604f03
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ede8f07c-5a23-4b20-a777-59b5e954e427
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: EXPDS_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2a5a335e-f714-4f3e-a830-98ebf37f63e8
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 749de0fb-09cb-4c91-b9fa-275d64972c6a
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: DISABLED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19b4dc46-790d-4855-996e-74e704416106
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac5e1af1-059e-4be9-bd96-0c29ca60c102
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: CONFIDENTIAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a6604579-0800-40b1-867d-e59c721e91d4
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 290ae345-d5d3-48fa-a8b3-52f1c94c4993
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: SILNT_REFRL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 986b3049-fadf-49c3-8fc1-04e10d6a4d33
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cca77d56-bb14-410c-92ed-f6ff28606267
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: DTA_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eadd3bd3-cfe0-46d5-afed-4b33c2285c5a
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21b2791e-6b04-4df3-af8b-6f7ae5dcafaf
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WLIST_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d1ddefc-a73c-4486-a6a2-280c2804408d
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7fd7678-a795-44ab-aef6-4aaf718f31f4
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: FAST_TRACK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 474c4ea1-defd-43a9-bbcc-24c1a12f7605
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2ecd3aa-d3a7-4833-8059-ef99f03cf247
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: NO_FUNDS_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: adaf7607-d34e-4c33-a149-678ed4d276ce
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24e4ea59-12eb-4cba-bd22-b8f85df72755
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: PRVSN_START_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 23a37a08-2f83-4370-9738-9133ff8e3c00
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2cb9d29e-fbca-48e9-9696-225a5d12af44
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: PRVSN_END_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75adebc2-28b6-4c2e-81fe-a7029f349f41
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e15f940d-ff0d-4a20-afec-68f95a1b4c92
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CNTCT_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3dfd02a9-1ba2-4aa2-808e-04d07280dc1b
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 763ce7c9-b720-44e9-897e-bccb9f2e27a5
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: MED_DISCH_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: adf2c303-3c4f-4246-a72c-d79692864825
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7951c94-654c-42a3-a448-54171555cb1b
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PMETD_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3644fefd-e190-4734-9fa9-5752d0cf61e4
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db007955-1789-41b5-81a6-dfec07001e8e
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: RFECO_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e192eb22-8e23-43d9-a6a1-7ec546eb37f9
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f9b7f29-b691-4c14-b48d-55ace2bc6d8e
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: IDPAP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 610a8953-82f0-459f-be85-6fb303187454
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 65fc494e-6f2f-40d6-85bb-9dc0a2d99dc1
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: READD_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d148cfb-5932-4db9-9c47-425f101d8538
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 00c2b697-bebd-4c1e-9c21-12366fd1946d
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADTAC_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc37af32-4ed2-481d-94e6-53816f9c303b
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f61a43c-4f52-4a38-a0d2-f3af32e30770
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: FINSP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f765fc8-cd96-4aaf-bff2-4dff1293bd77
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b2886bb6-0d0c-45f3-ad63-a4820c74cb70
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: GASTROSCOPY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 797dd318-f7d0-4dc0-a784-36dc88734183
                stepCounter: c7e465fb-5e39-471a-83ed-fa1d84af350b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1642e7c7-d3a7-4657-9980-7b991f10905b
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EMPST_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f9205802-fe1d-46f9-a5c9-4b7919146d2a
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d54bfba-0455-4d76-b46d-9f3fa9480ab7
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PENST_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 32fc442b-f873-48aa-bf5b-1d62969675fc
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7758eef0-2117-4c8a-80ac-5e1e9dd74d1d
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: CONSENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 300e2654-6b58-4cf5-879e-85f966675fb4
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d4a7155-6efa-4ce3-8982-8626776303e5
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: GP_ADVISE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 620ed001-b626-4a15-8bc6-0946baba77e0
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ac7c119-7c4f-4d62-91be-53f0f44ee825
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: IRADM_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 14ab4fe6-1fce-4b98-8199-a0a695c00493
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6f49d94-41c3-44a4-8242-3e0e2295dcd8
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: RELATED_ADMISSION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 442b4b35-07d7-4d71-838f-176e081c31fa
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 51fd85fa-5651-420c-90c0-01652d41150a
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: CARAV_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b64bbbf9-4952-47ec-90fb-2c4bebc30331
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f094d30-19f5-4c0d-a2cf-3c12e3abed2a
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: RFRFC_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 560d28d8-dae6-4154-8f25-e0291e086c2e
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94fbe5d4-d3d7-4cab-b7bc-a70208ce35c0
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ONSET_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d92b3fe9-be48-45f7-a650-a62b267a07cc
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ddc0000c-6881-443c-aa38-ec5bfebbb013
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: READM_REHAB_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b45c7aa4-a942-4d04-80f4-f2a6d595fa4f
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f1c81131-9004-4cd0-b061-b21a8801394c
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SRTPC_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0d4d50fc-13d3-469c-9630-b41641ee3a7d
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e90a4e88-fe6b-4d27-9ce6-02f50973dd9e
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACAST_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64690faa-b9d5-4e60-9be7-eafc067d95aa
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 292c9be6-5b62-4027-8850-84b967ac5ecd
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: ACC_EXPIRY_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 550e0fe6-5e63-4326-9718-c13735c22824
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db4108ff-1cd5-4def-b404-54c3768c9d1e
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: EXPDS_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2f3f31c8-bbe1-4201-8de3-c084e0d5b519
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fc6651aa-48cc-4962-8090-9ccc6a779cb7
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: HARP_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f6798782-c3b7-4a0a-b5dd-a9f4bce8b9e8
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2abac38-7b95-4d1b-bb10-ad051a2766e3
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADPST_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 78105a79-1268-4eb0-9357-62669735e01b
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9707a2c3-9aad-4192-a90c-1aef91e599da
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72c532b7-79a7-49aa-8bc0-c737daef331d
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db2d80e2-0cd0-443e-97be-972a5183f0d6
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SSTAY_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 994c05bb-1549-47bb-9e51-2d055958323b
                stepCounter: 38405c60-4c8a-4671-b56d-502e2ef070ce
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e550c0c-4252-49a2-a95a-4e46d8713db0
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAY_PATNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 88dd1ce2-34ce-414b-9758-1cc9afe2b703
                stepCounter: 38405c60-4c8a-4671-b56d-502e2ef070ce
            transform: |-
              CASE WHEN s_pims_service_point_stays.patnt_refno IS NULL OR s_pims_service_point_stays.patnt_refno <> ds_pims_provider_spells.patnt_refno THEN ds_pims_provider_spells.patnt_refno
                          ELSE s_pims_service_point_stays.patnt_refno
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0886c74-4b4c-42f6-9e57-7230549e0fd5
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAY_PATNT_REFNO_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 88dd1ce2-34ce-414b-9758-1cc9afe2b703
                stepCounter: 38405c60-4c8a-4671-b56d-502e2ef070ce
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a919137-c237-4c8c-8501-1637f59e89f2
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: REHSC_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cfe0365f-8f88-4a8e-97d6-b4930e22975b
                stepCounter: 38405c60-4c8a-4671-b56d-502e2ef070ce
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 378739c0-8df1-4037-8587-2c21806fd55d
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: DELIV_FACILITIES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fab7821c-55c1-4e7c-82e3-60a7e5e4688c
                stepCounter: 38405c60-4c8a-4671-b56d-502e2ef070ce
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a76d542d-6d14-4e02-995a-942f49446025
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: STAY_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 509b80f9-66ce-426a-af45-ea90bbcbbacd
                stepCounter: 38405c60-4c8a-4671-b56d-502e2ef070ce
            transform: |-
              CASE WHEN s_pims_service_point_stays.start_dttm IS NULL OR s_pims_service_point_stays.start_dttm <= '1990-01-01' OR s_pims_service_point_stays.start_dttm > GETDATE() OR s_pims_service_point_stays.start_dttm > s_pims_service_point_stays.end_dttm OR s_pims_service_point_stays.start_dttm < CASE WHEN ds_pims_provider_spells.admit_dttm IS NULL OR ds_pims_provider_spells.admit_dttm <= '1990-01-01' OR ds_pims_provider_spells.admit_dttm > GETDATE() THEN ds_pims_provider_spells.disch_dttm ELSE ds_pims_provider_spells.admit_dttm END THEN CASE WHEN ds_pims_provider_spells.admit_dttm IS NULL OR ds_pims_provider_spells.admit_dttm <= '1990-01-01' OR ds_pims_provider_spells.admit_dttm > GETDATE() THEN ds_pims_provider_spells.disch_dttm ELSE ds_pims_provider_spells.admit_dttm END
                          ELSE s_pims_service_point_stays.start_dttm
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eb5e57f8-da0c-4ddf-a11c-6d7e3250e250
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: STAY_START_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 509b80f9-66ce-426a-af45-ea90bbcbbacd
                stepCounter: 38405c60-4c8a-4671-b56d-502e2ef070ce
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f4382ad-264a-4c00-9b4b-9575ff7667f7
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: STAY_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47a572d3-1186-4273-a8aa-0a166868d989
                stepCounter: 38405c60-4c8a-4671-b56d-502e2ef070ce
            transform: |-
              CASE WHEN s_pims_service_point_stays.end_dttm IS NULL OR s_pims_service_point_stays.end_dttm <= '1990-01-01' OR s_pims_service_point_stays.end_dttm > GETDATE() OR s_pims_service_point_stays.end_dttm < s_pims_service_point_stays.start_dttm OR s_pims_service_point_stays.end_dttm > CASE WHEN ds_pims_provider_spells.disch_dttm IS NULL OR ds_pims_provider_spells.disch_dttm <= '1990-01-01' OR ds_pims_provider_spells.disch_dttm > GETDATE() THEN GETDATE() ELSE ds_pims_provider_spells.disch_dttm END THEN CASE WHEN ds_pims_provider_spells.disch_dttm IS NULL OR ds_pims_provider_spells.disch_dttm <= '1990-01-01' OR ds_pims_provider_spells.disch_dttm > GETDATE() THEN DATEADD(ss,-1,CONVERT(datetime,CONVERT(date,GETDATE()+1))) ELSE ds_pims_provider_spells.disch_dttm END
                          ELSE s_pims_service_point_stays.end_dttm
                           END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d1282e55-3e57-4a8f-a240-195ceb2d6df7
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: STAY_END_DATE_ORIG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47a572d3-1186-4273-a8aa-0a166868d989
                stepCounter: 38405c60-4c8a-4671-b56d-502e2ef070ce
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f6be352-2e36-41a1-870d-9dc909aeea89
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: SSTYP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ad78b9e7-5af5-4bf0-8647-7baa541c8fd0
                stepCounter: 38405c60-4c8a-4671-b56d-502e2ef070ce
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d12035fe-e60c-42ea-9434-0506fe396731
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: HPSTP_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: badb8f34-dd3e-43c6-8294-ee86af788a3e
                stepCounter: 38405c60-4c8a-4671-b56d-502e2ef070ce
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab55aa66-4242-4011-a47a-bcb4a5605c62
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PERCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56e46950-8860-4cd9-87d8-15c002ce63eb
                stepCounter: 38405c60-4c8a-4671-b56d-502e2ef070ce
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c295ce61-6544-4c22-8ff6-2b0daf9a942a
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: PRVSN_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fbd0760f-8068-4d33-843b-1e8ee92917d8
                stepCounter: 38405c60-4c8a-4671-b56d-502e2ef070ce
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d782548f-5a63-4d93-ba58-656f6eb993ed
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAY_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 490c94de-57bc-4fd4-a545-45cd4721242c
                stepCounter: 38405c60-4c8a-4671-b56d-502e2ef070ce
            transform: COALESCE(s_pims_service_point_stays.proca_refno,ds_pims_provider_spells.proca_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 254c6a75-b460-4783-b9e5-8e7e5aea6a91
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: BDCAT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a123ed47-7b35-49c7-ae46-819b2d6a1e11
                stepCounter: 38405c60-4c8a-4671-b56d-502e2ef070ce
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af075cf8-624a-47dd-9b9e-a994e66a5d20
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: CHAPLAIN_VISIT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 30b1465c-c574-4628-a88c-4acc0c3e0230
                stepCounter: 38405c60-4c8a-4671-b56d-502e2ef070ce
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea194fce-7fc2-4944-8ac6-f248b4ead42c
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: CHAR(1)
        defaultValue: ""
        description: ""
        name: VISITORS_ALLOWED_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 045bf16d-56f1-42ea-bc57-d37f36446dee
                stepCounter: 38405c60-4c8a-4671-b56d-502e2ef070ce
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25f0f0fe-8cc1-45fd-97e1-33424df6e0da
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ACTIVE_INDICATOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 12815a40-4434-4970-914a-633cfe9c338e
                stepCounter: 38405c60-4c8a-4671-b56d-502e2ef070ce
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b6030f7-a594-481a-a696-83966499394c
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: WARD_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0baf64a7-0e6e-499a-aae9-e3daa536e09b
                stepCounter: 38405c60-4c8a-4671-b56d-502e2ef070ce
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9742858-9afc-45f5-b763-1b4a89452075
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: ADTPS_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd081e31-45ab-4fb0-8206-1cc6050797bd
                stepCounter: 38405c60-4c8a-4671-b56d-502e2ef070ce
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 591d1c4f-ea26-4a65-a9b6-4abf9586d0ce
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: STAY_SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e4bf41a4-e114-4682-84a1-5c7f85965650
                stepCounter: 38405c60-4c8a-4671-b56d-502e2ef070ce
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3328add4-bbdb-4bdc-a2fd-17e5e93820b3
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: Stay Service Point Code
        name: STAY_SERVICE_POINT_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd8b5dc7-5f8d-48f1-96e5-e9f85b2dc97c
                stepCounter: 331048bb-7ff9-400f-b8c4-4ac7cc91d7e8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 984c64fc-46dc-4183-9d08-76abb5dc52a8
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: PRCAE_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aaeb1c54-2eea-4ea3-a060-4eb467edcdd1
                stepCounter: 2713b13a-cea0-444e-9d26-c474c79089a1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 033707a2-3aae-4fe7-84d4-e234fdcc79ab
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EPISODE_WLIST_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: efc8f01b-0474-4be9-81e5-c78d70c8b28c
                stepCounter: 2713b13a-cea0-444e-9d26-c474c79089a1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b830703d-1182-4602-a8b1-2348eaac5b28
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EPISODE_SPONT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1c2cd9a-aa3a-4c68-abca-a358bb1c4d0f
                stepCounter: 2713b13a-cea0-444e-9d26-c474c79089a1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 882080cc-09a5-46a0-a377-a6cf389352e7
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EPISODE_PROCA_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 89e8d906-a8e0-46b8-8d33-0d406896710c
                stepCounter: 2713b13a-cea0-444e-9d26-c474c79089a1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a85dcb90-53d0-4b58-a18c-5abf207f9096
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EPISODE_SPECT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d8cd8f4f-10bf-4da6-a275-b18a809228f8
                stepCounter: 2713b13a-cea0-444e-9d26-c474c79089a1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6897938c-e4fb-4da3-879c-1da15a46f0e7
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EPISODE_PATNT_REFNO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00f1ba37-6530-4aff-9ab4-4a6c3a98bf4f
                stepCounter: 2713b13a-cea0-444e-9d26-c474c79089a1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17871081-1c58-4999-b21d-11e9f29692be
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: EPISODE_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02ed6b8f-ee32-46bd-a077-c7aa0d0ef666
                stepCounter: 2713b13a-cea0-444e-9d26-c474c79089a1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b1b9cc7-c042-4de9-9d88-4125f6dbda2f
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: ""
        name: EPISODE_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e900ad4-0ae9-4654-b0b0-67084a6a1e78
                stepCounter: 2713b13a-cea0-444e-9d26-c474c79089a1
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f39a36e-d038-4b19-8ffb-dbe318b9d371
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_STAY_SEQ_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59d3088d-97f2-4c53-9ebc-ae021c7b49e2
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: ROW_NUMBER() OVER (PARTITION BY ds_pims_provider_spells.prvsp_refno ORDER BY s_pims_service_point_stays.start_dttm)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 420e1f92-b29f-4443-9b4f-ecb363293e5b
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_STAY_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59d3088d-97f2-4c53-9ebc-ae021c7b49e2
                stepCounter: 1206df94-8ac6-4021-a171-232e071d9dc2
            transform: COUNT(1) OVER (PARTITION BY ds_pims_provider_spells.prvsp_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc1fec00-8fc5-48f6-bd05-1c907e9441ca
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_STAY_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47a572d3-1186-4273-a8aa-0a166868d989
                stepCounter: 38405c60-4c8a-4671-b56d-502e2ef070ce
            transform: DATEDIFF(mi,s_pims_service_point_stays.start_dttm,IFNULL(s_pims_service_point_stays.end_dttm,getdate()))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e6be9177-2976-4e48-b43d-773ab87ea953
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: ""
        name: EVENT_STAY_TOTAL_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 47a572d3-1186-4273-a8aa-0a166868d989
                stepCounter: 38405c60-4c8a-4671-b56d-502e2ef070ce
            transform: SUM(DATEDIFF(mi,s_pims_service_point_stays.start_dttm,IFNULL(s_pims_service_point_stays.end_dttm,getdate()))) OVER (PARTITION BY s_pims_service_point_stays.prvsp_refno)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 215fe79e-42ce-41cc-8fa1-b4e76ae09101
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: dss_data_quality_code
        name: DSS_DATA_QUALITY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 76584594-7144-4177-b45b-ed98ee6416af
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: VARCHAR(20)
        defaultValue: ""
        description: ""
        name: ACC_CLAIM_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 066f9341-1a0c-4123-8b72-7b2791365e3a
                stepCounter: 32661289-2246-4a7c-a2ad-9907fdccd6ac
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b3cc17d3-73ad-490f-93b3-4c402de0eb95
          stepCounter: 740c81cf-ce2f-48d9-8258-fc2956e38dc5
        config: {}
        dataType: DATETIME
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        isSystemUpdateDate: true
        name: DSS_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          S_GASTROSCOPY_V: c7e465fb-5e39-471a-83ed-fa1d84af350b
          DS_SHARED_REFERRAL: 32661289-2246-4a7c-a2ad-9907fdccd6ac
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TGT
            nodeName: DS_PIMS_PROVIDER_SPELLS
          - locationName: TGT
            nodeName: S_GASTROSCOPY_V
          - locationName: TGT
            nodeName: DS_SHARED_REFERRAL
        join:
          joinCondition: |-
            FROM s_pims_service_point_stays
              JOIN ds_pims_provider_spells
                ON ds_pims_provider_spells.prvsp_refno = s_pims_service_point_stays.prvsp_refno
              LEFT OUTER JOIN (SELECT (proca_refno) proca_refno,
                   (spect_refno) spect_refno,
                   (spont_refno) spont_refno,
                   (patnt_refno) patnt_refno,
                   (start_dttm) start_dttm,
                   (end_dttm) end_dttm,
                   (prcae_refno) prcae_refno,
                   (wlist_refno) wlist_refno,
                   (refrl_refno) refrl_refno,
                   prvsp_refno
              FROM s_pims_prof_carer_episodes --GROUP BY prvsp_refno    ) s_pims_prof_carer_episodes  ON  s_pims_prof_carer_episodes.prvsp_refno = s_pims_service_point_stays.prvsp_refno  AND coalesce(s_pims_service_point_stays.end_dttm ,s_pims_service_point_stays.start_dttm )       BETWEEN dateadd(s,1,s_pims_prof_carer_episodes.start_dttm)      AND coalesce(s_pims_prof_carer_episodes.end_dttm,ds_pims_provider_spells.disch_dttm,getdate())    LEFT OUTER JOIN {{ ref('TGT','S_GASTROSCOPY_V') }}  ON ds_pims_provider_spells.prvsp_refno = s_gastroscopy_v.prvsp_refno  LEFT OUTER JOIN {{ ref('TGT','DS_SHARED_REFERRAL') }}  ON ds_pims_provider_spells.refrl_refno = ds_shared_referral.refrl_refno  LEFT OUTER JOIN dim.dim_patient  ON ds_pims_provider_spells.patnt_refno = dim_patient.patient_reference_no  LEFT OUTER JOIN dim.dim_service_point  ON  dim_service_point.service_point_reference_no = s_pims_service_point_stays.spont_refno  AND dim_service_point.dss_current_flag = 'Y'    WHERE ds_pims_provider_spells.prvsn_start_flag = 'N'
        name: S_IN_PATIENT_STAY_05_OLD
        noLinkRefs: []
  name: S_IN_PATIENT_STAY_05_OLD
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
