fileVersion: 1
id: 9eb4e58c-9fc5-4061-98b1-5bc425833686
name: STAGEOPC_ACCOUNT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "FILTER ALL ACCOUNT RELATED EXCEPTIONS AT ONE PLACE."
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ab52fe8-fa83-4917-b121-8db8be6cb481
          stepCounter: 9eb4e58c-9fc5-4061-98b1-5bc425833686
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE HIGHEST-LEVEL OF HIERARCHY FOR AN ACCOUNT
        isBusinessKey: true
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 667852d6-2359-424d-8d9d-cd2a7d10bb6d
                stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0925fb4-57ae-43c5-87b4-95c458ca1a54
          stepCounter: 9eb4e58c-9fc5-4061-98b1-5bc425833686
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE UNIQUE IDENTIFIER FOR AN ACCOUNT
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a0c67b8-f809-4bfd-a87f-6669c341ef02
                stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df25d96d-95ee-4ba5-bba1-cc9a0b9181bb
          stepCounter: 9eb4e58c-9fc5-4061-98b1-5bc425833686
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE SAME VALUE AS THE ACCOUNTNAME COLUMN, BUT HAS BEEN RUN THROUGH A PROPERCASE FUNCTION
        name: DISPLAYACCOUNTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 05df5302-51b2-484f-ab2c-2b3753904f6f
                stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 991e956b-ecf7-411a-8c7c-f2143c6d3352
          stepCounter: 9eb4e58c-9fc5-4061-98b1-5bc425833686
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE TYPE, OR CLASSIFICATION, OF THE ACCOUNT
        name: ACCOUNTTYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1346dedc-5849-4c0b-9fd6-7a150730c82d
                stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d62c267-3ad2-48d1-8c77-d1479b65486d
          stepCounter: 9eb4e58c-9fc5-4061-98b1-5bc425833686
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE FIRST LINE OF THE ACCOUNT'S STREET ADDRESS
        name: ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 60390977-b407-4e0f-91b7-04cf3b3805fe
                stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c44c3100-c0c2-4aea-aa6c-0d46ea9f62c8
          stepCounter: 9eb4e58c-9fc5-4061-98b1-5bc425833686
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE SECOND LINE OF THE ACCOUNT'S STREET ADDRESS, USUALLY THE SUITE, BUILDING, OR FLOOR
        name: ADDRESS2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c86bb5e1-b3d7-4c68-9abb-baebb0c6c52b
                stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 84a8fcd0-819d-4ce5-86c1-6312cec7ae45
          stepCounter: 9eb4e58c-9fc5-4061-98b1-5bc425833686
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE NAME OF THE CITY THE ACCOUNT IS LOCATED IN
        name: CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dd659638-db08-4f93-a762-dac2aced04b8
                stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ee6f064-9990-4395-88af-b3e0b240d15f
          stepCounter: 9eb4e58c-9fc5-4061-98b1-5bc425833686
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE NAME OF THE COUNTY OR PARISH THE ACCOUNT IS LOCATED IN
        name: COUNTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4e40cfb-3d8c-4211-8464-70283e92a698
                stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bbf747a7-ae54-4be6-978b-2d523171f319
          stepCounter: 9eb4e58c-9fc5-4061-98b1-5bc425833686
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE STATE OR PROVINCE THE ACCOUNT IS LOCATED IN
        name: STATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc04b9de-4804-41bd-a23a-1e6250a379e9
                stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 261b0ffb-d653-4eb8-866a-8de4e42d5602
          stepCounter: 9eb4e58c-9fc5-4061-98b1-5bc425833686
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE POSTAL CODE FOR THE ACCOUNT
        name: ZIPCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a0e829e1-c161-4793-ad08-9c108b7d8785
                stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a39855c1-6b9a-4a51-94a9-6890ec2256f2
          stepCounter: 9eb4e58c-9fc5-4061-98b1-5bc425833686
        config: {}
        dataType: DATE
        defaultValue: ""
        description: IS THE DATE THAT THE ACCOUNT EITHER REGISTERED OR, IN THE EVENT WE DO NOT HAVE A REGISTRATION, WILL BE THE DATE OF FIRST PURCHASE
        name: STARTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9a34757-8ac9-429d-8bdd-002be654a9ca
                stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4793b20-7e90-459b-b6c3-36452327fc92
          stepCounter: 9eb4e58c-9fc5-4061-98b1-5bc425833686
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE TIER A LEVEL 1 ACCOUNT IS CLASSIFIED AS. BASICALLY, HOW MUCH ATTENTION ARE WE GOING TO GIVE THIS CUSTOMER.
        name: TIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3f648ad-0b7e-4b7a-9267-3aee6a30d094
                stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14b58014-3655-4549-9b79-de856927760c
          stepCounter: 9eb4e58c-9fc5-4061-98b1-5bc425833686
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE 9-DIGIT EIN (EMPLOYER IDENTIFICATION NUMBER) FOR THE ACCOUNT
        name: FEDERALTAXID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 34c5ebb3-b193-4a5a-bd65-44953be23551
                stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f749f4a6-7711-4b09-a0c8-89ca557d3986
          stepCounter: 9eb4e58c-9fc5-4061-98b1-5bc425833686
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE PRIMARY URL FOR THE ACCOUNT
        name: WEBSITE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 88af4975-240e-4040-bd6b-e1a32d081b52
                stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 90bf31c2-99c5-4834-b8eb-88d61bef59e5
          stepCounter: 9eb4e58c-9fc5-4061-98b1-5bc425833686
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: THE SIZE BAND ARE CATEGORIZED INTO DIFFERENT SIZE BAND CODE DEPENDING ON THE CUSTOMER SIZE AND THE ACCOUNTTYPES.
        name: CUSTOMER_SIZE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 327eb386-7159-4ede-ad2e-d3bf30401fa9
                stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d875132f-61ac-4feb-85cf-df0de6d8adf4
          stepCounter: 9eb4e58c-9fc5-4061-98b1-5bc425833686
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CUSTOMER_SIZE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ca442d69-7b41-453f-9e7f-a7d8581237b6
                stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 59844e37-b067-4727-afab-ba539e606b0c
          stepCounter: 9eb4e58c-9fc5-4061-98b1-5bc425833686
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: CUSTOMERSIZEBAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 24570ae5-4abb-4988-a87f-306b51953bf9
                stepCounter: bb755271-2e35-4786-9147-d43f139e223f
            transform: IFNULL(LOADOPC_CUSTOMER_SIZE_BAND.CUSTOMER_SIZE_BAND,'UNKNOWN')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1355581f-9d02-429c-b919-9193b714a213
          stepCounter: 9eb4e58c-9fc5-4061-98b1-5bc425833686
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "STAGEACCOUNT_ADDKEYS.ORGANIZATIONID=ACCOUNTGEOGRAPHY.ORGANIZATIONID\nSTAGEACCOUNT_ADDKEYS.FORCEID=ACCOUNTGEOGRAPHY.FORCEID"
        name: ACCOUNTGEOGRAPHYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc32eae0-53ee-44b1-82c8-8e64aed7beb6
                stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7523d5c1-327b-4a7c-b39e-38a1bde96a0d
          stepCounter: 9eb4e58c-9fc5-4061-98b1-5bc425833686
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "STAGEACCOUNT_ADDKEYS.ORGANIZATIONID=SALESTERRITORY.ORGANIZATIONID\nSTAGEACCOUNT_ADDKEYS.ACCOUNTTERRITORY=SALESTERRITORY.TERRITORYNAME"
        name: SALESTERRITORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1eafc440-3db5-46d5-bd1b-9334b6ab0179
                stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bea45ed7-c07c-48f1-ad76-3d8355b8ac0f
          stepCounter: 9eb4e58c-9fc5-4061-98b1-5bc425833686
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEOPC_ACCOUNT.LEVEL1FORCEID=OPC_ACCOUNT.LEVEL1FORCEID
        name: ACCOUNTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea0a24a7-b682-4577-8c61-62c8e0b45a33
                stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f459a4b1-c74f-484e-a358-fb52026f938b
          stepCounter: 9eb4e58c-9fc5-4061-98b1-5bc425833686
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEACCOUNT_ADDKEYS.SECTORID=SECTOR.SECTORID
        name: SECTORKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a8897eab-bf0c-47df-9f3a-78a60228fa84
                stepCounter: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e068fa0-f546-4a3c-af70-6ed02e5334ba
          stepCounter: 9eb4e58c-9fc5-4061-98b1-5bc425833686
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ac741ae-813f-4152-92b4-bd9107ab4224
          stepCounter: 9eb4e58c-9fc5-4061-98b1-5bc425833686
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          OPC_ACCOUNT: 2a9c6305-8932-4c0e-a4f0-601c0a643d92
          LOADOPC_CUSTOMER_SIZE_BAND: bb755271-2e35-4786-9147-d43f139e223f
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOADOPC_CUSTOMER_SIZE_BAND
          - locationName: OMNIA_CONNECT_OPC
            nodeName: OPC_ACCOUNT
        join:
          joinCondition: |-
            FROM {{ ref('OMNIA_CONNECT_OPC','OPC_ACCOUNT') }} OPC_ACCOUNT
              LEFT JOIN {{ ref('LOAD','LOADOPC_CUSTOMER_SIZE_BAND') }} LOADOPC_CUSTOMER_SIZE_BAND
                ON OPC_ACCOUNT.ACCOUNTTYPE = LOADOPC_CUSTOMER_SIZE_BAND.ACCOUNT_TYPE
               AND OPC_ACCOUNT.CUSTOMER_SIZE_CODE = LOADOPC_CUSTOMER_SIZE_BAND.CUSTOMER_SIZE_CODE
        name: STAGEOPC_ACCOUNT
        noLinkRefs: []
  name: STAGEOPC_ACCOUNT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
