fileVersion: 1
id: f0e379bd-fd12-4f94-85f5-091ae04f3cd1
name: STAGEOPC_ACCOUNT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "Filter all account related exceptions at one place."
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e302381-50a2-4892-99b3-29f83f5d12d0
          stepCounter: f0e379bd-fd12-4f94-85f5-091ae04f3cd1
        config: {}
        dataType: INT
        defaultValue: ""
        description: is the highest-level of hierarchy for an account
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21211ff2-8822-4e39-aae7-8f707fba7e37
                stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 371c5494-637d-42a1-93cc-90a31986e671
          stepCounter: f0e379bd-fd12-4f94-85f5-091ae04f3cd1
        config: {}
        dataType: INT
        defaultValue: ""
        description: is the unique identifier for an account
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5582b423-d45b-4fe9-9338-99c588e50b45
                stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69dd0eb3-f4fa-4977-ab11-0ac0540990a0
          stepCounter: f0e379bd-fd12-4f94-85f5-091ae04f3cd1
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the same value as the AccountName column, but has been run through a ProperCase function
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DISPLAYACCOUNTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: adcdda35-f145-4a49-81a5-8405e0edda62
                stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1688987d-4725-4eb6-bc7e-6b492a97cdfa
          stepCounter: f0e379bd-fd12-4f94-85f5-091ae04f3cd1
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the type, or classification, of the account
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ACCOUNTTYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f89edba-12b2-4f52-9b42-ca6b8bbafa39
                stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26c6c1c3-5f5c-4fa4-a047-250935480dab
          stepCounter: f0e379bd-fd12-4f94-85f5-091ae04f3cd1
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the first line of the account's street address
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d617ba24-0eda-433e-a888-fa1cea56ac1f
                stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1daa8b49-effe-4d7a-b214-92ad4d39b9b7
          stepCounter: f0e379bd-fd12-4f94-85f5-091ae04f3cd1
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the second line of the account's street address, usually the suite, building, or floor
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ADDRESS2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd0e29ce-eb35-401b-b0ed-5b5152404316
                stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 831ff9e4-f479-457e-bbde-7899c8d50647
          stepCounter: f0e379bd-fd12-4f94-85f5-091ae04f3cd1
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the name of the city the account is located in
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c47be048-d7ae-4dc6-b757-493a1623e952
                stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e83d5dc4-11ab-4644-a827-d6d7ef6cadb0
          stepCounter: f0e379bd-fd12-4f94-85f5-091ae04f3cd1
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the name of the county or parish the account is located in
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: COUNTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fabf4781-bd02-4505-99c0-764319218bf4
                stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 915624ba-f1f9-4c0c-8dd0-c7b11b57d1da
          stepCounter: f0e379bd-fd12-4f94-85f5-091ae04f3cd1
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the state or province the account is located in
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: STATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5710cf60-c842-4143-a509-897be92d6b3a
                stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24d7ca0c-0bba-47c6-8f6b-bc1bf4c87b70
          stepCounter: f0e379bd-fd12-4f94-85f5-091ae04f3cd1
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the postal code for the account
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ZIPCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f84ba1ed-fb7f-4cc9-be0e-600adf3a5314
                stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf592917-9d74-463f-b6e3-6c4ce6494fe0
          stepCounter: f0e379bd-fd12-4f94-85f5-091ae04f3cd1
        config: {}
        dataType: DATE
        defaultValue: ""
        description: is the date that the account either registered or, in the event we do not have a registration, will be the date of first purchase
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: STARTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f2de7fdd-9f2f-4c90-b41c-4ec64a884aba
                stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dcbb3884-92ab-4d15-ae6c-7507797d8c6a
          stepCounter: f0e379bd-fd12-4f94-85f5-091ae04f3cd1
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the tier a level 1 account is classified as. Basically, how much attention are we going to give this customer.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 034825fb-dd3c-46f0-ab47-1734e9a6c88b
                stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54dc2251-5c96-49d9-a3a3-a0d626673c26
          stepCounter: f0e379bd-fd12-4f94-85f5-091ae04f3cd1
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the 9-digit EIN (employer identification number) for the account
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: FEDERALTAXID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 855e2c28-c8f5-453f-a922-fb464c50b8ec
                stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c4b351f-c22d-4772-a0b8-06635e3603d7
          stepCounter: f0e379bd-fd12-4f94-85f5-091ae04f3cd1
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the primary URL for the account
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: WEBSITE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 154fc7bb-8c0e-4470-8563-ed9be43a77c3
                stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57ae78a7-a97b-4517-8ca7-77b4474caad3
          stepCounter: f0e379bd-fd12-4f94-85f5-091ae04f3cd1
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: The Size band are categorized into different Size Band Code depending on the customer size and the AccountTypes.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CUSTOMER_SIZE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 99e2a756-8b2c-4cfd-9716-422b5d519931
                stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b3954dd3-e3ac-410a-aa97-16cff20ced38
          stepCounter: f0e379bd-fd12-4f94-85f5-091ae04f3cd1
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CUSTOMER_SIZE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39c32a95-0e5d-4d61-b18d-584df26a74f1
                stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 009140d1-3622-4461-b31c-7f9dfc2e24b2
          stepCounter: f0e379bd-fd12-4f94-85f5-091ae04f3cd1
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CUSTOMERSIZEBAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ead962fb-d29d-4211-a90b-bed6afa5dd42
                stepCounter: 9bc5446e-998c-4946-b2c2-0dfec7c715b6
            transform: IFNULL(LoadOPC_CUSTOMER_SIZE_BAND.CUSTOMER_SIZE_BAND,'Unknown')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c955518-1bcd-485f-995f-502edcf5ed7e
          stepCounter: f0e379bd-fd12-4f94-85f5-091ae04f3cd1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "StageAccount_AddKeys.OrganizationId=AccountGeography.OrganizationId\nStageAccount_AddKeys.ForceId=AccountGeography.ForceId"
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ACCOUNTGEOGRAPHYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 73589d98-c008-4df4-870c-5da20585f6c5
                stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 416e6fd0-eaee-4503-82d5-4663f8ab1df2
          stepCounter: f0e379bd-fd12-4f94-85f5-091ae04f3cd1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "StageAccount_AddKeys.OrganizationId=SalesTerritory.OrganizationId\nStageAccount_AddKeys.AccountTerritory=SalesTerritory.TerritoryName"
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SALESTERRITORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd552a55-8607-4f88-a4e2-d4321704991d
                stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b774bc0b-8af7-400e-b621-63b50bba3be1
          stepCounter: f0e379bd-fd12-4f94-85f5-091ae04f3cd1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: StageOPC_Account.Level1ForceId=OPC_Account.Level1ForceId
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ACCOUNTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dd6b0231-7b7f-4a19-85e2-93af3ed439bc
                stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45033d13-4b3a-45c6-ac3e-819b544c9edb
          stepCounter: f0e379bd-fd12-4f94-85f5-091ae04f3cd1
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: StageAccount_AddKeys.SectorId=Sector.SectorId
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SECTORKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a01da3e7-8ea6-4927-8ba3-5b6f1f3ef8bb
                stepCounter: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a7108c9-7974-474f-a2e8-0665e4b56365
          stepCounter: f0e379bd-fd12-4f94-85f5-091ae04f3cd1
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d9e5320-6d27-464c-b772-692c7b72e841
          stepCounter: f0e379bd-fd12-4f94-85f5-091ae04f3cd1
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          OPC_ACCOUNT: 38444415-63a9-444d-bc6a-67f3d2fbc7e3
          LOADOPC_CUSTOMER_SIZE_BAND: 9bc5446e-998c-4946-b2c2-0dfec7c715b6
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOADOPC_CUSTOMER_SIZE_BAND
          - locationName: OMNIA_CONNECT_OPC
            nodeName: OPC_ACCOUNT
        join:
          joinCondition: |-
            FROM {{ ref('OMNIA_CONNECT_OPC','OPC_ACCOUNT') }} OPC_Account
              LEFT JOIN {{ ref('LOAD','LOADOPC_CUSTOMER_SIZE_BAND') }} LoadOPC_CUSTOMER_SIZE_BAND
                ON OPC_Account.AccountType = LoadOPC_CUSTOMER_SIZE_BAND.ACCOUNT_TYPE
               AND OPC_Account.Customer_Size_Code = LoadOPC_CUSTOMER_SIZE_BAND.CUSTOMER_SIZE_CODE
        name: STAGEOPC_ACCOUNT
        noLinkRefs: []
  name: STAGEOPC_ACCOUNT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
