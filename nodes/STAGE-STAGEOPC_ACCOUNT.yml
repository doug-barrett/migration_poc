fileVersion: 1
id: 52ff0317-5ee6-4fd6-8dd6-8324335b4f58
name: STAGEOPC_ACCOUNT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "FILTER ALL ACCOUNT RELATED EXCEPTIONS AT ONE PLACE."
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f143c67-e7a8-4ef8-8ba2-4c1cae22f15f
          stepCounter: 52ff0317-5ee6-4fd6-8dd6-8324335b4f58
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE HIGHEST-LEVEL OF HIERARCHY FOR AN ACCOUNT
        isBusinessKey: true
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b51c7309-985e-4d41-8f5c-c6f313af6bc4
                stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b49e0622-1deb-4400-ae2f-7c546d416a0b
          stepCounter: 52ff0317-5ee6-4fd6-8dd6-8324335b4f58
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE UNIQUE IDENTIFIER FOR AN ACCOUNT
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d435bd0a-2ba8-4bb8-8b52-552194c80662
                stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50845046-92e3-4af4-99b7-05cc91959ff8
          stepCounter: 52ff0317-5ee6-4fd6-8dd6-8324335b4f58
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE SAME VALUE AS THE ACCOUNTNAME COLUMN, BUT HAS BEEN RUN THROUGH A PROPERCASE FUNCTION
        name: DISPLAYACCOUNTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0dcdc149-395b-495b-a947-babe5c44c5a2
                stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5acc50c4-91d2-4465-a6cc-8a332de1d7ea
          stepCounter: 52ff0317-5ee6-4fd6-8dd6-8324335b4f58
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE TYPE, OR CLASSIFICATION, OF THE ACCOUNT
        name: ACCOUNTTYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc26ca61-a0e8-47c0-bcdd-b214ad2837fd
                stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e626414a-acd4-4ca0-a6b1-cf29fce529fb
          stepCounter: 52ff0317-5ee6-4fd6-8dd6-8324335b4f58
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE FIRST LINE OF THE ACCOUNT'S STREET ADDRESS
        name: ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d6bed20-1b1f-4a7a-83b8-b8d4e4c5dc1f
                stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d0686732-c5e8-44f9-a555-3d25dbfb2dac
          stepCounter: 52ff0317-5ee6-4fd6-8dd6-8324335b4f58
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE SECOND LINE OF THE ACCOUNT'S STREET ADDRESS, USUALLY THE SUITE, BUILDING, OR FLOOR
        name: ADDRESS2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8dfefaca-2a0f-4f23-a9bd-5acd2a0a34d7
                stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c599af4c-9a0a-4a1e-8f3e-6fba5a1cfd01
          stepCounter: 52ff0317-5ee6-4fd6-8dd6-8324335b4f58
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE NAME OF THE CITY THE ACCOUNT IS LOCATED IN
        name: CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f27aaaf-4eee-46db-a4d4-e9dd0bc44092
                stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ee5268f3-4d59-4bc6-82b4-7649f601bb80
          stepCounter: 52ff0317-5ee6-4fd6-8dd6-8324335b4f58
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE NAME OF THE COUNTY OR PARISH THE ACCOUNT IS LOCATED IN
        name: COUNTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ff11b315-61fb-469c-bfed-ce1ebae0ec5d
                stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e4dc826-85b1-4fbd-a567-82a7eacec8da
          stepCounter: 52ff0317-5ee6-4fd6-8dd6-8324335b4f58
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE STATE OR PROVINCE THE ACCOUNT IS LOCATED IN
        name: STATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21b8d3b4-bb71-4436-a467-00ab185d9231
                stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e136c9f-ce7b-458d-a7fb-88480ee285e5
          stepCounter: 52ff0317-5ee6-4fd6-8dd6-8324335b4f58
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE POSTAL CODE FOR THE ACCOUNT
        name: ZIPCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02b444d0-2e38-4f7e-8fcd-b99c1314191e
                stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c0e3d6f-72ce-4609-af96-0df8e306fe64
          stepCounter: 52ff0317-5ee6-4fd6-8dd6-8324335b4f58
        config: {}
        dataType: DATE
        defaultValue: ""
        description: IS THE DATE THAT THE ACCOUNT EITHER REGISTERED OR, IN THE EVENT WE DO NOT HAVE A REGISTRATION, WILL BE THE DATE OF FIRST PURCHASE
        name: STARTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: da0b98c9-5b8c-442d-958a-98c9e36b543f
                stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dede775a-ae98-474a-919f-986109d29605
          stepCounter: 52ff0317-5ee6-4fd6-8dd6-8324335b4f58
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE TIER A LEVEL 1 ACCOUNT IS CLASSIFIED AS. BASICALLY, HOW MUCH ATTENTION ARE WE GOING TO GIVE THIS CUSTOMER.
        name: TIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5a6c24a-8783-48b4-bfd8-57d2bf1cc0ce
                stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4acab1cc-dd52-4ade-a4f9-79d11e2d44d8
          stepCounter: 52ff0317-5ee6-4fd6-8dd6-8324335b4f58
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE 9-DIGIT EIN (EMPLOYER IDENTIFICATION NUMBER) FOR THE ACCOUNT
        name: FEDERALTAXID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4870c870-6bff-4774-a984-04619798e603
                stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6eaf1eae-f1cf-437b-937c-6415855f9f8e
          stepCounter: 52ff0317-5ee6-4fd6-8dd6-8324335b4f58
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE PRIMARY URL FOR THE ACCOUNT
        name: WEBSITE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: be970beb-9197-4ffe-b8ae-170c0c1ba852
                stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef20b972-609e-4d7b-8cde-68a0ff789ab9
          stepCounter: 52ff0317-5ee6-4fd6-8dd6-8324335b4f58
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: THE SIZE BAND ARE CATEGORIZED INTO DIFFERENT SIZE BAND CODE DEPENDING ON THE CUSTOMER SIZE AND THE ACCOUNTTYPES.
        name: CUSTOMER_SIZE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2e67de50-c9f3-47d0-b624-82bc6d95b3af
                stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8273cc43-7a8b-423e-8912-3fc15c53ff6a
          stepCounter: 52ff0317-5ee6-4fd6-8dd6-8324335b4f58
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CUSTOMER_SIZE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ff1486c1-7e5a-48a4-8c25-15626d9585b0
                stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dfa37dfb-4436-47b8-bb94-450f60cc4643
          stepCounter: 52ff0317-5ee6-4fd6-8dd6-8324335b4f58
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: CUSTOMERSIZEBAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d3e6a5c4-b665-4f0d-a76d-91e90c4b9174
                stepCounter: 8bf30b51-5725-4671-9d72-5d3df107c6b2
            transform: IFNULL(LOADOPC_CUSTOMER_SIZE_BAND.CUSTOMER_SIZE_BAND,'UNKNOWN')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15b93e6d-7ef9-4496-94f1-3d73dcb07f17
          stepCounter: 52ff0317-5ee6-4fd6-8dd6-8324335b4f58
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "STAGEACCOUNT_ADDKEYS.ORGANIZATIONID=ACCOUNTGEOGRAPHY.ORGANIZATIONID\nSTAGEACCOUNT_ADDKEYS.FORCEID=ACCOUNTGEOGRAPHY.FORCEID"
        name: ACCOUNTGEOGRAPHYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ede8832-73ca-4de8-a325-871dbf2f6bbf
                stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ebe9302-2a05-4422-9e45-2c66db759dba
          stepCounter: 52ff0317-5ee6-4fd6-8dd6-8324335b4f58
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "STAGEACCOUNT_ADDKEYS.ORGANIZATIONID=SALESTERRITORY.ORGANIZATIONID\nSTAGEACCOUNT_ADDKEYS.ACCOUNTTERRITORY=SALESTERRITORY.TERRITORYNAME"
        name: SALESTERRITORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 28761795-db39-430d-bd7e-0650e273d119
                stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 48a74b5b-ca1a-4a26-b888-fa1903d4df9d
          stepCounter: 52ff0317-5ee6-4fd6-8dd6-8324335b4f58
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEOPC_ACCOUNT.LEVEL1FORCEID=OPC_ACCOUNT.LEVEL1FORCEID
        name: ACCOUNTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3c880c11-a247-4db2-8cea-03706f8a87b6
                stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d0ab883b-2305-4575-875d-15106b47bac7
          stepCounter: 52ff0317-5ee6-4fd6-8dd6-8324335b4f58
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEACCOUNT_ADDKEYS.SECTORID=SECTOR.SECTORID
        name: SECTORKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a11aefa7-382c-4c99-83d8-40f4ffbac37b
                stepCounter: 36cf5555-b43d-45fa-a452-8b92590b7cdd
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38537e19-e37b-423b-acfd-b6c99f85c5fb
          stepCounter: 52ff0317-5ee6-4fd6-8dd6-8324335b4f58
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 125288d1-0c32-4d2a-b54c-913e90de92e0
          stepCounter: 52ff0317-5ee6-4fd6-8dd6-8324335b4f58
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          OPC_ACCOUNT: 36cf5555-b43d-45fa-a452-8b92590b7cdd
          LOADOPC_CUSTOMER_SIZE_BAND: 8bf30b51-5725-4671-9d72-5d3df107c6b2
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOADOPC_CUSTOMER_SIZE_BAND
          - locationName: OMNIACONNECT.OPC
            nodeName: OPC_ACCOUNT
        join:
          joinCondition: |-
            FROM {{ ref('OMNIACONNECT.OPC','OPC_ACCOUNT') }} OPC_ACCOUNT
              LEFT JOIN {{ ref('LOAD','LOADOPC_CUSTOMER_SIZE_BAND') }} LOADOPC_CUSTOMER_SIZE_BAND
                ON OPC_ACCOUNT.ACCOUNTTYPE = LOADOPC_CUSTOMER_SIZE_BAND.ACCOUNT_TYPE
               AND OPC_ACCOUNT.CUSTOMER_SIZE_CODE = LOADOPC_CUSTOMER_SIZE_BAND.CUSTOMER_SIZE_CODE
        name: STAGEOPC_ACCOUNT
        noLinkRefs: []
  name: STAGEOPC_ACCOUNT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
