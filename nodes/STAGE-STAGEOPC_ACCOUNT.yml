fileVersion: 1
id: cf9b1c67-15f7-441a-a292-4a223aff1dd9
name: STAGEOPC_ACCOUNT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "FILTER ALL ACCOUNT RELATED EXCEPTIONS AT ONE PLACE."
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5fc6e0b5-e9e2-4fd8-9e7a-1ac56a13d20c
          stepCounter: cf9b1c67-15f7-441a-a292-4a223aff1dd9
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE HIGHEST-LEVEL OF HIERARCHY FOR AN ACCOUNT
        isBusinessKey: true
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1062a46f-9698-4f69-ba87-c2b154446f3e
                stepCounter: 5337f5b8-e0e0-4710-ab6b-59644004c56c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2807537d-7af6-4296-acf9-5f744d7fa1cf
          stepCounter: cf9b1c67-15f7-441a-a292-4a223aff1dd9
        config: {}
        dataType: INT
        defaultValue: ""
        description: IS THE UNIQUE IDENTIFIER FOR AN ACCOUNT
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aae9ba09-9b0e-4c36-b7ab-8bcb9451e737
                stepCounter: 5337f5b8-e0e0-4710-ab6b-59644004c56c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 46eb0761-e0cd-430f-84cb-a56981411dc9
          stepCounter: cf9b1c67-15f7-441a-a292-4a223aff1dd9
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE SAME VALUE AS THE ACCOUNTNAME COLUMN, BUT HAS BEEN RUN THROUGH A PROPERCASE FUNCTION
        name: DISPLAYACCOUNTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b4bd88f0-f85f-41d0-8d6a-0dbdbfecb750
                stepCounter: 5337f5b8-e0e0-4710-ab6b-59644004c56c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5874cf7-d579-463e-8f0f-82eb35156a76
          stepCounter: cf9b1c67-15f7-441a-a292-4a223aff1dd9
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE TYPE, OR CLASSIFICATION, OF THE ACCOUNT
        name: ACCOUNTTYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b0559685-c0d2-45b0-87ac-44284635d691
                stepCounter: 5337f5b8-e0e0-4710-ab6b-59644004c56c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f52ba530-dc04-4019-bcc9-3a5b25864adf
          stepCounter: cf9b1c67-15f7-441a-a292-4a223aff1dd9
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE FIRST LINE OF THE ACCOUNT'S STREET ADDRESS
        name: ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f3085716-b48b-44f8-96d8-36e307e64052
                stepCounter: 5337f5b8-e0e0-4710-ab6b-59644004c56c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: adbe6215-975a-4d30-b806-66adb531208a
          stepCounter: cf9b1c67-15f7-441a-a292-4a223aff1dd9
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE SECOND LINE OF THE ACCOUNT'S STREET ADDRESS, USUALLY THE SUITE, BUILDING, OR FLOOR
        name: ADDRESS2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a08d4c50-0f7b-464d-9ff8-9d17b1332656
                stepCounter: 5337f5b8-e0e0-4710-ab6b-59644004c56c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f1956f0-b516-44d8-866b-df4c8001b791
          stepCounter: cf9b1c67-15f7-441a-a292-4a223aff1dd9
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE NAME OF THE CITY THE ACCOUNT IS LOCATED IN
        name: CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: afcd5f18-c70c-4952-8574-353aeb2cd6a7
                stepCounter: 5337f5b8-e0e0-4710-ab6b-59644004c56c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 081f555f-9d47-47f2-bc91-6975c550bcf2
          stepCounter: cf9b1c67-15f7-441a-a292-4a223aff1dd9
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE NAME OF THE COUNTY OR PARISH THE ACCOUNT IS LOCATED IN
        name: COUNTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f0c9fa9-9d6a-46c1-9e7d-942f02d4de42
                stepCounter: 5337f5b8-e0e0-4710-ab6b-59644004c56c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aea564c9-7968-4aa9-9081-21080ab53242
          stepCounter: cf9b1c67-15f7-441a-a292-4a223aff1dd9
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE STATE OR PROVINCE THE ACCOUNT IS LOCATED IN
        name: STATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 603852e9-b7f1-4351-bc61-f3489b01f5fe
                stepCounter: 5337f5b8-e0e0-4710-ab6b-59644004c56c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9723ea2b-6475-4459-b777-12876a01748c
          stepCounter: cf9b1c67-15f7-441a-a292-4a223aff1dd9
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE POSTAL CODE FOR THE ACCOUNT
        name: ZIPCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 32ca7377-18f8-4c53-b68d-c6729664eaf0
                stepCounter: 5337f5b8-e0e0-4710-ab6b-59644004c56c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2efa74bf-479b-4cf1-83a8-b96b1b3f5277
          stepCounter: cf9b1c67-15f7-441a-a292-4a223aff1dd9
        config: {}
        dataType: DATE
        defaultValue: ""
        description: IS THE DATE THAT THE ACCOUNT EITHER REGISTERED OR, IN THE EVENT WE DO NOT HAVE A REGISTRATION, WILL BE THE DATE OF FIRST PURCHASE
        name: STARTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fbb241a8-1c66-4d51-8e9d-2882aad5b346
                stepCounter: 5337f5b8-e0e0-4710-ab6b-59644004c56c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea827ea1-8547-4967-9c16-2e8922275503
          stepCounter: cf9b1c67-15f7-441a-a292-4a223aff1dd9
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE TIER A LEVEL 1 ACCOUNT IS CLASSIFIED AS. BASICALLY, HOW MUCH ATTENTION ARE WE GOING TO GIVE THIS CUSTOMER.
        name: TIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cea483bd-81f7-48a0-8f4f-a7307ee9638a
                stepCounter: 5337f5b8-e0e0-4710-ab6b-59644004c56c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9cf3af9c-5e90-4080-8fbb-71628b23e950
          stepCounter: cf9b1c67-15f7-441a-a292-4a223aff1dd9
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE 9-DIGIT EIN (EMPLOYER IDENTIFICATION NUMBER) FOR THE ACCOUNT
        name: FEDERALTAXID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a9e50206-9bf9-44bd-84e4-c1bf4627f374
                stepCounter: 5337f5b8-e0e0-4710-ab6b-59644004c56c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 65099eea-6136-421f-8d46-2bc3fb2975aa
          stepCounter: cf9b1c67-15f7-441a-a292-4a223aff1dd9
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: IS THE PRIMARY URL FOR THE ACCOUNT
        name: WEBSITE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7544b36-805d-4f2b-ae93-7335e6df5804
                stepCounter: 5337f5b8-e0e0-4710-ab6b-59644004c56c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 081ed3c8-22dd-4fc8-b25e-71fb3b42ac4d
          stepCounter: cf9b1c67-15f7-441a-a292-4a223aff1dd9
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: THE SIZE BAND ARE CATEGORIZED INTO DIFFERENT SIZE BAND CODE DEPENDING ON THE CUSTOMER SIZE AND THE ACCOUNTTYPES.
        name: CUSTOMER_SIZE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f683c5f-e11f-4e33-a69f-0432ff2c96b3
                stepCounter: 5337f5b8-e0e0-4710-ab6b-59644004c56c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39f49bc4-a68f-40f9-89f4-bfd53914e77a
          stepCounter: cf9b1c67-15f7-441a-a292-4a223aff1dd9
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        name: CUSTOMER_SIZE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d7ff5a7-2629-450e-9d1f-c67b93a68110
                stepCounter: 5337f5b8-e0e0-4710-ab6b-59644004c56c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2954b26-e996-4bca-8df6-47ef29c6b7aa
          stepCounter: cf9b1c67-15f7-441a-a292-4a223aff1dd9
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        name: CUSTOMERSIZEBAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 31d2d352-2599-47a2-9a34-64a822f9b2e3
                stepCounter: 49b9773c-39e5-48fc-9533-befe50cfd765
            transform: IFNULL(LOADOPC_CUSTOMER_SIZE_BAND.CUSTOMER_SIZE_BAND,'UNKNOWN')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e443be1-95ff-4a1e-a704-3dfe6adb9f49
          stepCounter: cf9b1c67-15f7-441a-a292-4a223aff1dd9
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "STAGEACCOUNT_ADDKEYS.ORGANIZATIONID=ACCOUNTGEOGRAPHY.ORGANIZATIONID\nSTAGEACCOUNT_ADDKEYS.FORCEID=ACCOUNTGEOGRAPHY.FORCEID"
        name: ACCOUNTGEOGRAPHYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 755b544b-1b12-40e1-b607-d1e51cf608eb
                stepCounter: 5337f5b8-e0e0-4710-ab6b-59644004c56c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2e016004-be30-46b1-984f-6872ba912bf8
          stepCounter: cf9b1c67-15f7-441a-a292-4a223aff1dd9
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "STAGEACCOUNT_ADDKEYS.ORGANIZATIONID=SALESTERRITORY.ORGANIZATIONID\nSTAGEACCOUNT_ADDKEYS.ACCOUNTTERRITORY=SALESTERRITORY.TERRITORYNAME"
        name: SALESTERRITORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9da7e2bc-857a-46e4-a5f8-0faf41857683
                stepCounter: 5337f5b8-e0e0-4710-ab6b-59644004c56c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8797a15a-03bf-4c35-a037-6e808b3d5de7
          stepCounter: cf9b1c67-15f7-441a-a292-4a223aff1dd9
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEOPC_ACCOUNT.LEVEL1FORCEID=OPC_ACCOUNT.LEVEL1FORCEID
        name: ACCOUNTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5bdff787-504f-4c0a-81e6-19e949876c30
                stepCounter: 5337f5b8-e0e0-4710-ab6b-59644004c56c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50aec612-a29e-4421-81ec-510f45808c63
          stepCounter: cf9b1c67-15f7-441a-a292-4a223aff1dd9
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: STAGEACCOUNT_ADDKEYS.SECTORID=SECTOR.SECTORID
        name: SECTORKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eccdaf74-5927-40e7-9322-d1c73f79ced0
                stepCounter: 5337f5b8-e0e0-4710-ab6b-59644004c56c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c798a4be-9b10-41c0-a97f-d1f49f372925
          stepCounter: cf9b1c67-15f7-441a-a292-4a223aff1dd9
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS CREATED IN THE DATA WAREHOUSE.
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 85e2c7b3-a6ff-498e-bad7-6e5a0704a353
          stepCounter: cf9b1c67-15f7-441a-a292-4a223aff1dd9
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: DATE AND TIME THE ROW WAS UPDATED IN THE DATA WAREHOUSE.
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          OPC_ACCOUNT: 5337f5b8-e0e0-4710-ab6b-59644004c56c
          LOADOPC_CUSTOMER_SIZE_BAND: 49b9773c-39e5-48fc-9533-befe50cfd765
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOADOPC_CUSTOMER_SIZE_BAND
          - locationName: OMNIA_CONNECT_OPC
            nodeName: OPC_ACCOUNT
        join:
          joinCondition: |-
            FROM {{ ref('OMNIA_CONNECT_OPC','OPC_ACCOUNT') }} OPC_ACCOUNT
              LEFT JOIN {{ ref('LOAD','LOADOPC_CUSTOMER_SIZE_BAND') }} LOADOPC_CUSTOMER_SIZE_BAND
                ON OPC_ACCOUNT.ACCOUNTTYPE = LOADOPC_CUSTOMER_SIZE_BAND.ACCOUNT_TYPE
               AND OPC_ACCOUNT.CUSTOMER_SIZE_CODE = LOADOPC_CUSTOMER_SIZE_BAND.CUSTOMER_SIZE_CODE
        name: STAGEOPC_ACCOUNT
        noLinkRefs: []
  name: STAGEOPC_ACCOUNT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
