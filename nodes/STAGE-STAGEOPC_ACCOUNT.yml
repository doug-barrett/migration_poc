fileVersion: 1
id: 74601912-9203-4268-bb98-b03b7b0261f6
name: STAGEOPC_ACCOUNT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: "Filter all account related exceptions at one place."
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8cbf9f22-e55a-4339-96a2-27c7ee9bc118
          stepCounter: 74601912-9203-4268-bb98-b03b7b0261f6
        config: {}
        dataType: INT
        defaultValue: ""
        description: is the highest-level of hierarchy for an account
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        isBusinessKey: true
        name: LEVEL1FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cf92bf6c-56fa-4e9d-b8cf-e06bf30d200a
                stepCounter: 29434de6-599c-4dd7-a66a-90bd1531218b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4b75c5b7-4998-49a1-968f-ed8baf1b7e16
          stepCounter: 74601912-9203-4268-bb98-b03b7b0261f6
        config: {}
        dataType: INT
        defaultValue: ""
        description: is the unique identifier for an account
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: FORCEID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7aa2a4ea-efbd-4257-9130-54d0555eb0fb
                stepCounter: 29434de6-599c-4dd7-a66a-90bd1531218b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9eea808b-1e3a-4dc7-a9cd-87f002c003ab
          stepCounter: 74601912-9203-4268-bb98-b03b7b0261f6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the same value as the AccountName column, but has been run through a ProperCase function
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DISPLAYACCOUNTNAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0f96cc61-e81c-400f-96e9-7ca6b32dde00
                stepCounter: 29434de6-599c-4dd7-a66a-90bd1531218b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 821a845d-3887-4620-a184-bdd450f9de6a
          stepCounter: 74601912-9203-4268-bb98-b03b7b0261f6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the type, or classification, of the account
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ACCOUNTTYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f9af0d4-daa9-4baf-a7ed-69de8e7375a7
                stepCounter: 29434de6-599c-4dd7-a66a-90bd1531218b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 390792a6-7524-4e6c-ba40-da761bd642ff
          stepCounter: 74601912-9203-4268-bb98-b03b7b0261f6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the first line of the account's street address
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33dd84c5-72b1-43b0-b1c4-33dda222d6a9
                stepCounter: 29434de6-599c-4dd7-a66a-90bd1531218b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f79fb577-8eaa-489c-bf81-105ee9d73ee9
          stepCounter: 74601912-9203-4268-bb98-b03b7b0261f6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the second line of the account's street address, usually the suite, building, or floor
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ADDRESS2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 280c5064-ab09-4542-b490-9c90696f6783
                stepCounter: 29434de6-599c-4dd7-a66a-90bd1531218b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec915995-390c-4efa-ace9-fa65f42ea69a
          stepCounter: 74601912-9203-4268-bb98-b03b7b0261f6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the name of the city the account is located in
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 97e2918c-6869-4081-a7e2-5aef3a8f5f42
                stepCounter: 29434de6-599c-4dd7-a66a-90bd1531218b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c6cbe72-e661-4775-8aac-2e09ffbdb59f
          stepCounter: 74601912-9203-4268-bb98-b03b7b0261f6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the name of the county or parish the account is located in
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: COUNTY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f6122ea7-52f4-434d-9a63-3c8ad3e2eac2
                stepCounter: 29434de6-599c-4dd7-a66a-90bd1531218b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ff8404b-4c3f-4457-87d4-822bdf8567ee
          stepCounter: 74601912-9203-4268-bb98-b03b7b0261f6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the state or province the account is located in
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: STATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b59ab7d3-2726-4ee8-914b-7300cc4decfc
                stepCounter: 29434de6-599c-4dd7-a66a-90bd1531218b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18c3640a-1ca2-4a1b-a3ba-26aaa22d2222
          stepCounter: 74601912-9203-4268-bb98-b03b7b0261f6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the postal code for the account
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ZIPCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64193d5e-98c1-476d-8499-bd3ece34818a
                stepCounter: 29434de6-599c-4dd7-a66a-90bd1531218b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b8bfb8c-1cbf-4df1-b91f-80d1f309219a
          stepCounter: 74601912-9203-4268-bb98-b03b7b0261f6
        config: {}
        dataType: DATE
        defaultValue: ""
        description: is the date that the account either registered or, in the event we do not have a registration, will be the date of first purchase
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: STARTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c1ec7299-a43a-45bf-a8a6-fe1372f81315
                stepCounter: 29434de6-599c-4dd7-a66a-90bd1531218b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c00c5ec-ddd9-46ed-9182-2e12fc6ee98a
          stepCounter: 74601912-9203-4268-bb98-b03b7b0261f6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the tier a level 1 account is classified as. Basically, how much attention are we going to give this customer.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: TIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0cf32bf0-7aaf-41ed-8579-049ff74fce77
                stepCounter: 29434de6-599c-4dd7-a66a-90bd1531218b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d57bd566-7da6-483a-b435-88ed5e920398
          stepCounter: 74601912-9203-4268-bb98-b03b7b0261f6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the 9-digit EIN (employer identification number) for the account
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: FEDERALTAXID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1e1e5123-3c37-48a6-9513-228c4c3c5d55
                stepCounter: 29434de6-599c-4dd7-a66a-90bd1531218b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: df5481f3-8699-47c8-87a2-255514c88c55
          stepCounter: 74601912-9203-4268-bb98-b03b7b0261f6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: is the primary URL for the account
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: WEBSITE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 15a7d211-7590-4a83-ac06-f08d2d648311
                stepCounter: 29434de6-599c-4dd7-a66a-90bd1531218b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 56f8bd94-d46d-463c-870f-cca72ff2fc3a
          stepCounter: 74601912-9203-4268-bb98-b03b7b0261f6
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: The Size band are categorized into different Size Band Code depending on the customer size and the AccountTypes.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CUSTOMER_SIZE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb1e3f4d-01f5-4186-837f-42d01e0bf563
                stepCounter: 29434de6-599c-4dd7-a66a-90bd1531218b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a107ef7-c3d6-461c-aa80-c6c6056cee81
          stepCounter: 74601912-9203-4268-bb98-b03b7b0261f6
        config: {}
        dataType: INT
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CUSTOMER_SIZE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b6e4c98-73ce-44f7-8d1d-a8c46c534630
                stepCounter: 29434de6-599c-4dd7-a66a-90bd1531218b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5593e68a-ee80-41d8-8d1b-4f180919839d
          stepCounter: 74601912-9203-4268-bb98-b03b7b0261f6
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: CUSTOMERSIZEBAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7fc55de-4512-48c6-91bb-d4271c116c5a
                stepCounter: 000d2004-22f1-443f-881d-b417876bb101
            transform: IFNULL(LoadOPC_CUSTOMER_SIZE_BAND.CUSTOMER_SIZE_BAND,'Unknown')
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3b6324a-2937-403a-95ee-413b6f44d707
          stepCounter: 74601912-9203-4268-bb98-b03b7b0261f6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "StageAccount_AddKeys.OrganizationId=AccountGeography.OrganizationId\nStageAccount_AddKeys.ForceId=AccountGeography.ForceId"
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ACCOUNTGEOGRAPHYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7fdb0529-1868-4144-aba2-c13e951d368f
                stepCounter: 29434de6-599c-4dd7-a66a-90bd1531218b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eef6e32d-eac5-4299-9176-3fcbc65679a4
          stepCounter: 74601912-9203-4268-bb98-b03b7b0261f6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: "StageAccount_AddKeys.OrganizationId=SalesTerritory.OrganizationId\nStageAccount_AddKeys.AccountTerritory=SalesTerritory.TerritoryName"
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SALESTERRITORYKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c300497-1773-45d2-af3a-02a874233532
                stepCounter: 29434de6-599c-4dd7-a66a-90bd1531218b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da14a672-cf81-4bb9-8864-df67ad60b987
          stepCounter: 74601912-9203-4268-bb98-b03b7b0261f6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: StageOPC_Account.Level1ForceId=OPC_Account.Level1ForceId
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: ACCOUNTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ef1119e-87e7-41f9-a55e-b263430f51a1
                stepCounter: 29434de6-599c-4dd7-a66a-90bd1531218b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04d3e068-a445-4767-a871-1678cc252433
          stepCounter: 74601912-9203-4268-bb98-b03b7b0261f6
        config: {}
        dataType: INTEGER
        defaultValue: ""
        description: StageAccount_AddKeys.SectorId=Sector.SectorId
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: SECTORKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 515027f4-a844-49ba-967f-7fcd6638e781
                stepCounter: 29434de6-599c-4dd7-a66a-90bd1531218b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77890dd9-83e1-454f-81e0-26c146ad07c2
          stepCounter: 74601912-9203-4268-bb98-b03b7b0261f6
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was created in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSCREATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06d59e09-e03c-422f-a34f-9c91e4aebf56
          stepCounter: 74601912-9203-4268-bb98-b03b7b0261f6
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: Date and time the row was updated in the data warehouse.
        hashDetails:
          hashAlgorithm: MD5
        hashedColumns:
          - column: "NULL"
        name: DSSUPDATETIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          OPC_ACCOUNT: 29434de6-599c-4dd7-a66a-90bd1531218b
          LOADOPC_CUSTOMER_SIZE_BAND: 000d2004-22f1-443f-881d-b417876bb101
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: LOAD
            nodeName: LOADOPC_CUSTOMER_SIZE_BAND
          - locationName: OMNIA_CONNECT_OPC
            nodeName: OPC_ACCOUNT
        join:
          joinCondition: |-
            FROM {{ ref('OMNIA_CONNECT_OPC','OPC_ACCOUNT') }} OPC_Account
              LEFT JOIN {{ ref('LOAD','LOADOPC_CUSTOMER_SIZE_BAND') }} LoadOPC_CUSTOMER_SIZE_BAND
                ON OPC_Account.AccountType = LoadOPC_CUSTOMER_SIZE_BAND.ACCOUNT_TYPE
               AND OPC_Account.Customer_Size_Code = LoadOPC_CUSTOMER_SIZE_BAND.CUSTOMER_SIZE_CODE
        name: STAGEOPC_ACCOUNT
        noLinkRefs: []
  name: STAGEOPC_ACCOUNT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
